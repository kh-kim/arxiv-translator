<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2311.12023] LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning</title><meta property="og:description" content="We propose a simple approach for memory-efficient adaptation of pretrained language models. Our approach uses an iterative algorithm to decompose each pretrained matrix into a high-precision low-rank component and a me…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2311.12023">

<!--Generated on Tue Dec  5 17:20:43 2023 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv.0.7.7.min.css"><link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv-site.0.2.1.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<math id="id1.1.m1.1" class="ltx_Math" alttext="\textbf{Han Guo}^{\dagger\star}" display="inline"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mtext mathvariant="bold" id="id1.1.m1.1.1.2" xref="id1.1.m1.1.1.2a.cmml">Han Guo</mtext><mrow id="id1.1.m1.1.1.3" xref="id1.1.m1.1.1.3.cmml"><mi id="id1.1.m1.1.1.3.2" xref="id1.1.m1.1.1.3.2.cmml"></mi><mo lspace="0.222em" rspace="0em" id="id1.1.m1.1.1.3.1" xref="id1.1.m1.1.1.3.1.cmml">†</mo><mo lspace="0em" id="id1.1.m1.1.1.3.3" xref="id1.1.m1.1.1.3.3.cmml">⋆</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><csymbol cd="ambiguous" id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1">superscript</csymbol><ci id="id1.1.m1.1.1.2a.cmml" xref="id1.1.m1.1.1.2"><mtext mathvariant="bold" id="id1.1.m1.1.1.2.cmml" xref="id1.1.m1.1.1.2">Han Guo</mtext></ci><apply id="id1.1.m1.1.1.3.cmml" xref="id1.1.m1.1.1.3"><ci id="id1.1.m1.1.1.3.1.cmml" xref="id1.1.m1.1.1.3.1">†</ci><csymbol cd="latexml" id="id1.1.m1.1.1.3.2.cmml" xref="id1.1.m1.1.1.3.2">absent</csymbol><ci id="id1.1.m1.1.1.3.3.cmml" xref="id1.1.m1.1.1.3.3">⋆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\textbf{Han Guo}^{\dagger\star}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">Han Guo start_POSTSUPERSCRIPT † ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <math id="id2.2.m2.1" class="ltx_Math" alttext="\textbf{Philip Greengard}^{\ddagger}" display="inline"><semantics id="id2.2.m2.1a"><msup id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml"><mtext mathvariant="bold" id="id2.2.m2.1.1.2" xref="id2.2.m2.1.1.2a.cmml">Philip Greengard</mtext><mo id="id2.2.m2.1.1.3" xref="id2.2.m2.1.1.3.cmml">‡</mo></msup><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><apply id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1"><csymbol cd="ambiguous" id="id2.2.m2.1.1.1.cmml" xref="id2.2.m2.1.1">superscript</csymbol><ci id="id2.2.m2.1.1.2a.cmml" xref="id2.2.m2.1.1.2"><mtext mathvariant="bold" id="id2.2.m2.1.1.2.cmml" xref="id2.2.m2.1.1.2">Philip Greengard</mtext></ci><ci id="id2.2.m2.1.1.3.cmml" xref="id2.2.m2.1.1.3">‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">\textbf{Philip Greengard}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.1d">Philip Greengard start_POSTSUPERSCRIPT ‡ end_POSTSUPERSCRIPT</annotation></semantics></math>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <math id="id3.3.m3.1" class="ltx_Math" alttext="\textbf{Eric P. Xing}^{\dagger\diamond}" display="inline"><semantics id="id3.3.m3.1a"><msup id="id3.3.m3.1.1" xref="id3.3.m3.1.1.cmml"><mtext mathvariant="bold" id="id3.3.m3.1.1.2" xref="id3.3.m3.1.1.2a.cmml">Eric P. Xing</mtext><mrow id="id3.3.m3.1.1.3" xref="id3.3.m3.1.1.3.cmml"><mi id="id3.3.m3.1.1.3.2" xref="id3.3.m3.1.1.3.2.cmml"></mi><mo lspace="0.222em" rspace="0em" id="id3.3.m3.1.1.3.1" xref="id3.3.m3.1.1.3.1.cmml">†</mo><mo lspace="0em" id="id3.3.m3.1.1.3.3" xref="id3.3.m3.1.1.3.3.cmml">⋄</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id3.3.m3.1b"><apply id="id3.3.m3.1.1.cmml" xref="id3.3.m3.1.1"><csymbol cd="ambiguous" id="id3.3.m3.1.1.1.cmml" xref="id3.3.m3.1.1">superscript</csymbol><ci id="id3.3.m3.1.1.2a.cmml" xref="id3.3.m3.1.1.2"><mtext mathvariant="bold" id="id3.3.m3.1.1.2.cmml" xref="id3.3.m3.1.1.2">Eric P. Xing</mtext></ci><apply id="id3.3.m3.1.1.3.cmml" xref="id3.3.m3.1.1.3"><ci id="id3.3.m3.1.1.3.1.cmml" xref="id3.3.m3.1.1.3.1">†</ci><csymbol cd="latexml" id="id3.3.m3.1.1.3.2.cmml" xref="id3.3.m3.1.1.3.2">absent</csymbol><ci id="id3.3.m3.1.1.3.3.cmml" xref="id3.3.m3.1.1.3.3">⋄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.1c">\textbf{Eric P. Xing}^{\dagger\diamond}</annotation><annotation encoding="application/x-llamapun" id="id3.3.m3.1d">Eric P. Xing start_POSTSUPERSCRIPT † ⋄ end_POSTSUPERSCRIPT</annotation></semantics></math>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <math id="id4.4.m4.1" class="ltx_Math" alttext="\textbf{Yoon Kim}^{\star}" display="inline"><semantics id="id4.4.m4.1a"><msup id="id4.4.m4.1.1" xref="id4.4.m4.1.1.cmml"><mtext mathvariant="bold" id="id4.4.m4.1.1.2" xref="id4.4.m4.1.1.2a.cmml">Yoon Kim</mtext><mo id="id4.4.m4.1.1.3" xref="id4.4.m4.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="id4.4.m4.1b"><apply id="id4.4.m4.1.1.cmml" xref="id4.4.m4.1.1"><csymbol cd="ambiguous" id="id4.4.m4.1.1.1.cmml" xref="id4.4.m4.1.1">superscript</csymbol><ci id="id4.4.m4.1.1.2a.cmml" xref="id4.4.m4.1.1.2"><mtext mathvariant="bold" id="id4.4.m4.1.1.2.cmml" xref="id4.4.m4.1.1.2">Yoon Kim</mtext></ci><ci id="id4.4.m4.1.1.3.cmml" xref="id4.4.m4.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.4.m4.1c">\textbf{Yoon Kim}^{\star}</annotation><annotation encoding="application/x-llamapun" id="id4.4.m4.1d">Yoon Kim start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math>  
<br class="ltx_break"><sup id="id5.5.1" class="ltx_sup"><math id="id5.5.1.m1.1" class="ltx_Math" alttext="\dagger" display="inline"><semantics id="id5.5.1.m1.1a"><mo id="id5.5.1.m1.1.1" xref="id5.5.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id5.5.1.m1.1b"><ci id="id5.5.1.m1.1.1.cmml" xref="id5.5.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id5.5.1.m1.1c">\dagger</annotation><annotation encoding="application/x-llamapun" id="id5.5.1.m1.1d">†</annotation></semantics></math></sup>Carnegie Mellon University,
<sup id="id6.6.2" class="ltx_sup"><math id="id6.6.2.m1.1" class="ltx_Math" alttext="\ddagger" display="inline"><semantics id="id6.6.2.m1.1a"><mo id="id6.6.2.m1.1.1" xref="id6.6.2.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="id6.6.2.m1.1b"><ci id="id6.6.2.m1.1.1.cmml" xref="id6.6.2.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="id6.6.2.m1.1c">\ddagger</annotation><annotation encoding="application/x-llamapun" id="id6.6.2.m1.1d">‡</annotation></semantics></math></sup>Columbia University 
<br class="ltx_break"><sup id="id7.7.3" class="ltx_sup"><math id="id7.7.3.m1.1" class="ltx_Math" alttext="\diamond" display="inline"><semantics id="id7.7.3.m1.1a"><mo id="id7.7.3.m1.1.1" xref="id7.7.3.m1.1.1.cmml">⋄</mo><annotation-xml encoding="MathML-Content" id="id7.7.3.m1.1b"><ci id="id7.7.3.m1.1.1.cmml" xref="id7.7.3.m1.1.1">⋄</ci></annotation-xml><annotation encoding="application/x-tex" id="id7.7.3.m1.1c">\diamond</annotation><annotation encoding="application/x-llamapun" id="id7.7.3.m1.1d">⋄</annotation></semantics></math></sup>Mohamed bin Zayed University of Artificial Intelligence, Petuum Inc. 
<br class="ltx_break"><sup id="id8.8.4" class="ltx_sup"><math id="id8.8.4.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="id8.8.4.m1.1a"><mo id="id8.8.4.m1.1.1" xref="id8.8.4.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="id8.8.4.m1.1b"><ci id="id8.8.4.m1.1.1.cmml" xref="id8.8.4.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="id8.8.4.m1.1c">\star</annotation><annotation encoding="application/x-llamapun" id="id8.8.4.m1.1d">⋆</annotation></semantics></math></sup>Massachusetts Institute of Technology 
<br class="ltx_break"><span id="id9.9.id1" class="ltx_text ltx_font_typewriter">hanguo@cs.cmu.edu</span>,    <span id="id10.10.id2" class="ltx_text ltx_font_typewriter">pg2118@columbia.edu</span>,   <span id="id11.11.id3" class="ltx_text ltx_font_typewriter">epxing@cs.cmu.edu</span>,    <span id="id12.12.id4" class="ltx_text ltx_font_typewriter">yoonkim@mit.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id13.id1">본 논문에서는 사전 학습된 언어 모델의 메모리 효율적인 적응을 위한 간단한 방법을 제안한다. 제안된 방법은 반복 알고리즘을 사용하여 사전 학습된 각 행렬을 고정밀 저순위 성분과 메모리 효율적인 양자화 성분으로 분해한다. 파인튜닝 동안, 양자화된 컴포넌트는 고정된 채로 유지되고 저순위 컴포넌트만이 업데이트된다. 전체 목표 메모리 버짓이 주어진 각 행렬에 대한 양자화 매개 변수(예: 비트 폭, 블록 크기)의 동적 구성을 가능하게 하는 양자화 성분의 정수 선형 프로그래밍 공식을 제시한다. 또한 피셔 정보 행렬의 근사치를 사용하여 행렬 분해 동안 재구성 목표에 가중치를 부여하는 알고리즘의 데이터 인식 버전을 추가로 탐구한다. RoBERTa와 LLaMA-2 (7B와 70B)를 적용한 실험 결과, 본 논문에서 제안한 저순위 플러스 양자화 행렬 분해 방법(LQ-LoRA)이 강한 QLoRA와 GPTQ-LoRA 기준선보다 우수한 성능을 보였으며, 더욱이 보다 적극적인 양자화를 가능하게 하였다. 예를 들어, OpenAssistant 벤치마크에서 LQ-LoRA는 4비트 QLoRA로 미세 조정된 모델과 경쟁적인 2.5비트 LLaMA-2 모델을 학습할 수 있다. 언어 모델링 교정 데이터 세트에서 미세 조정될 때 LQ-LoRA는 모델 압축에도 사용될 수 있으며, 이 설정에서 우리의 2.75비트 LLaMA-2-70B 모델(낮은 순위 구성 요소를 포함할 때 평균 2.85비트를 가지며 27GB의 GPU 메모리가 필요함)은 완전한 정밀도에서 원래 모델과 경쟁적이다. <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our code and models are available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/HanGuo97/lq-lora" target="_blank" title="">https://github.com/HanGuo97/lq-lora</a>. This work was completed while Han Guo was a visiting student at MIT.</span></span></span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p1.1">대규모 언어 모델(LLM)의 가용성 증가와 사전 훈련된 매개변수 <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="#bib.bib64" title="">2022</a>; Scao et al., <a class="ltx_ref" href="#bib.bib42" title="">2022</a>; Touvron et al., <a class="ltx_ref" href="#bib.bib50" title="">2023a</a>; <a class="ltx_ref" href="#bib.bib51" title="">b</a>)</cite>에도 불구하고, 완전한 미세 조정을 통해 새로운 데이터 세트에 적응하는 데 비용이 많이 든다. 이는 특히 비이상적인데, 이는 데이터 후속 명령에 대한 소량의 감독된 미세 조정이 일반적인 명령 <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="#bib.bib55" title="">2023</a>; Taori et al., <a class="ltx_ref" href="#bib.bib48" title="">2023</a>; Team, <a class="ltx_ref" href="#bib.bib49" title="">2023</a>; Zhou et al., <a class="ltx_ref" href="#bib.bib66" title="">2023</a>)</cite>를 따를 수 있는 대화형 에이전트를 학습하기 위한 효과적인 접근 방식인 것으로 나타났으며, 더욱이 인간 피드백 <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a class="ltx_ref" href="#bib.bib39" title="">2022</a>)</cite>를 사용한 강화 학습을 통해 미세 조정된 LLMs는 오늘날 존재하는 가장 유능한 AI 시스템 중 일부 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="#bib.bib38" title="">2023</a>; Bubeck et al., <a class="ltx_ref" href="#bib.bib2" title="">2023</a>)</cite>를 나타낸다. 따라서 LLM 미세조정의 메모리 효율성을 개선하는 것은 LLM이 실질적으로 적용될 수 있는 문제의 범위를 넓히는 핵심 단계로 남아 있다.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p2.6">메모리 효율적인 LLM 적응을 위한 한 가지 유망한 프레임워크는 파라미터 효율적인 미세 조정 방법을 통한 것으로, 일반적으로 더 작은 미세 조정 가능한 <em class="ltx_emph ltx_font_italic" id="S1.p2.6.1">extension</em>을 기본 사전 훈련 모델에 학습한다(설문 조사를 위해 <cite class="ltx_cite ltx_citemacro_citet">Ding et al. (<a class="ltx_ref" href="#bib.bib11" title="">2023</a>)</cite> 참조). 이러한 방법은 사전 훈련된 매개변수가 고정된 상태로 유지됨에 따라 미세 조정에 필요한 메모리의 양을 줄일 수 있으며, 따라서 이러한 매개변수에 대한 구배 및 최적화기 상태를 저장하기 위한 메모리를 할당할 필요성을 줄이는 반면 최적화해야 하는 새로운 매개변수의 수는 고정된 매개변수의 일부이다. 기존의 많은 파라미터 효율적인 미세 조정 방법 중 낮은 순위 적응 <cite class="ltx_cite ltx_citemacro_citep">(LoRA; Hu et al., <a class="ltx_ref" href="#bib.bib19" title="">2022</a>)</cite>가 효율적인 LLM 적응을 위한 인기 있는 기술로 부상했다. LoRA에서, 사전 훈련된 모델의 가중치 매트릭스 <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><mi id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><ci id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">bold_W</annotation></semantics></math>는 <math alttext="\mathbf{W}+\mathbf{L}_{1}\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S1.p2.2.m2.1"><semantics id="S1.p2.2.m2.1a"><mrow id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml"><mi id="S1.p2.2.m2.1.1.2" xref="S1.p2.2.m2.1.1.2.cmml">𝐖</mi><mo id="S1.p2.2.m2.1.1.1" xref="S1.p2.2.m2.1.1.1.cmml">+</mo><mrow id="S1.p2.2.m2.1.1.3" xref="S1.p2.2.m2.1.1.3.cmml"><msub id="S1.p2.2.m2.1.1.3.2" xref="S1.p2.2.m2.1.1.3.2.cmml"><mi id="S1.p2.2.m2.1.1.3.2.2" xref="S1.p2.2.m2.1.1.3.2.2.cmml">𝐋</mi><mn id="S1.p2.2.m2.1.1.3.2.3" xref="S1.p2.2.m2.1.1.3.2.3.cmml">1</mn></msub><mo id="S1.p2.2.m2.1.1.3.1" lspace="0px" rspace="0px" xref="S1.p2.2.m2.1.1.3.1.cmml"></mo><msub id="S1.p2.2.m2.1.1.3.3" xref="S1.p2.2.m2.1.1.3.3.cmml"><mi id="S1.p2.2.m2.1.1.3.3.2" xref="S1.p2.2.m2.1.1.3.3.2.cmml">𝐋</mi><mn id="S1.p2.2.m2.1.1.3.3.3" xref="S1.p2.2.m2.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><apply id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1"><plus id="S1.p2.2.m2.1.1.1.cmml" xref="S1.p2.2.m2.1.1.1"></plus><ci id="S1.p2.2.m2.1.1.2.cmml" xref="S1.p2.2.m2.1.1.2">𝐖</ci><apply id="S1.p2.2.m2.1.1.3.cmml" xref="S1.p2.2.m2.1.1.3"><times id="S1.p2.2.m2.1.1.3.1.cmml" xref="S1.p2.2.m2.1.1.3.1"></times><apply id="S1.p2.2.m2.1.1.3.2.cmml" xref="S1.p2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S1.p2.2.m2.1.1.3.2.1.cmml" xref="S1.p2.2.m2.1.1.3.2">subscript</csymbol><ci id="S1.p2.2.m2.1.1.3.2.2.cmml" xref="S1.p2.2.m2.1.1.3.2.2">𝐋</ci><cn id="S1.p2.2.m2.1.1.3.2.3.cmml" type="integer" xref="S1.p2.2.m2.1.1.3.2.3">1</cn></apply><apply id="S1.p2.2.m2.1.1.3.3.cmml" xref="S1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S1.p2.2.m2.1.1.3.3.1.cmml" xref="S1.p2.2.m2.1.1.3.3">subscript</csymbol><ci id="S1.p2.2.m2.1.1.3.3.2.cmml" xref="S1.p2.2.m2.1.1.3.3.2">𝐋</ci><cn id="S1.p2.2.m2.1.1.3.3.3.cmml" type="integer" xref="S1.p2.2.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">\mathbf{W}+\mathbf{L}_{1}\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.2.m2.1d">bold_W + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>와 같이 재매개화되고, <math alttext="\mathbf{L}_{1}" class="ltx_Math" display="inline" id="S1.p2.3.m3.1"><semantics id="S1.p2.3.m3.1a"><msub id="S1.p2.3.m3.1.1" xref="S1.p2.3.m3.1.1.cmml"><mi id="S1.p2.3.m3.1.1.2" xref="S1.p2.3.m3.1.1.2.cmml">𝐋</mi><mn id="S1.p2.3.m3.1.1.3" xref="S1.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.3.m3.1b"><apply id="S1.p2.3.m3.1.1.cmml" xref="S1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p2.3.m3.1.1.1.cmml" xref="S1.p2.3.m3.1.1">subscript</csymbol><ci id="S1.p2.3.m3.1.1.2.cmml" xref="S1.p2.3.m3.1.1.2">𝐋</ci><cn id="S1.p2.3.m3.1.1.3.cmml" type="integer" xref="S1.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.3.m3.1c">\mathbf{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.3.m3.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>와 <math alttext="\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S1.p2.4.m4.1"><semantics id="S1.p2.4.m4.1a"><msub id="S1.p2.4.m4.1.1" xref="S1.p2.4.m4.1.1.cmml"><mi id="S1.p2.4.m4.1.1.2" xref="S1.p2.4.m4.1.1.2.cmml">𝐋</mi><mn id="S1.p2.4.m4.1.1.3" xref="S1.p2.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.4.m4.1b"><apply id="S1.p2.4.m4.1.1.cmml" xref="S1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p2.4.m4.1.1.1.cmml" xref="S1.p2.4.m4.1.1">subscript</csymbol><ci id="S1.p2.4.m4.1.1.2.cmml" xref="S1.p2.4.m4.1.1.2">𝐋</ci><cn id="S1.p2.4.m4.1.1.3.cmml" type="integer" xref="S1.p2.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.4.m4.1c">\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.4.m4.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>만이 미세 조정된다. 최근의 연구들은 LoRA의 메모리 효율성을 양자화된 사전 훈련 모델에 적용함으로써, 즉, 재매개변수화 <math alttext="q(\mathbf{W})+\mathbf{L}_{1}\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S1.p2.5.m5.1"><semantics id="S1.p2.5.m5.1a"><mrow id="S1.p2.5.m5.1.2" xref="S1.p2.5.m5.1.2.cmml"><mrow id="S1.p2.5.m5.1.2.2" xref="S1.p2.5.m5.1.2.2.cmml"><mi id="S1.p2.5.m5.1.2.2.2" xref="S1.p2.5.m5.1.2.2.2.cmml">q</mi><mo id="S1.p2.5.m5.1.2.2.1" lspace="0px" rspace="0px" xref="S1.p2.5.m5.1.2.2.1.cmml"></mo><mrow id="S1.p2.5.m5.1.2.2.3.2" xref="S1.p2.5.m5.1.2.2.cmml"><mo id="S1.p2.5.m5.1.2.2.3.2.1" stretchy="false" xref="S1.p2.5.m5.1.2.2.cmml">(</mo><mi id="S1.p2.5.m5.1.1" xref="S1.p2.5.m5.1.1.cmml">𝐖</mi><mo id="S1.p2.5.m5.1.2.2.3.2.2" stretchy="false" xref="S1.p2.5.m5.1.2.2.cmml">)</mo></mrow></mrow><mo id="S1.p2.5.m5.1.2.1" xref="S1.p2.5.m5.1.2.1.cmml">+</mo><mrow id="S1.p2.5.m5.1.2.3" xref="S1.p2.5.m5.1.2.3.cmml"><msub id="S1.p2.5.m5.1.2.3.2" xref="S1.p2.5.m5.1.2.3.2.cmml"><mi id="S1.p2.5.m5.1.2.3.2.2" xref="S1.p2.5.m5.1.2.3.2.2.cmml">𝐋</mi><mn id="S1.p2.5.m5.1.2.3.2.3" xref="S1.p2.5.m5.1.2.3.2.3.cmml">1</mn></msub><mo id="S1.p2.5.m5.1.2.3.1" lspace="0px" rspace="0px" xref="S1.p2.5.m5.1.2.3.1.cmml"></mo><msub id="S1.p2.5.m5.1.2.3.3" xref="S1.p2.5.m5.1.2.3.3.cmml"><mi id="S1.p2.5.m5.1.2.3.3.2" xref="S1.p2.5.m5.1.2.3.3.2.cmml">𝐋</mi><mn id="S1.p2.5.m5.1.2.3.3.3" xref="S1.p2.5.m5.1.2.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.5.m5.1b"><apply id="S1.p2.5.m5.1.2.cmml" xref="S1.p2.5.m5.1.2"><plus id="S1.p2.5.m5.1.2.1.cmml" xref="S1.p2.5.m5.1.2.1"></plus><apply id="S1.p2.5.m5.1.2.2.cmml" xref="S1.p2.5.m5.1.2.2"><times id="S1.p2.5.m5.1.2.2.1.cmml" xref="S1.p2.5.m5.1.2.2.1"></times><ci id="S1.p2.5.m5.1.2.2.2.cmml" xref="S1.p2.5.m5.1.2.2.2">𝑞</ci><ci id="S1.p2.5.m5.1.1.cmml" xref="S1.p2.5.m5.1.1">𝐖</ci></apply><apply id="S1.p2.5.m5.1.2.3.cmml" xref="S1.p2.5.m5.1.2.3"><times id="S1.p2.5.m5.1.2.3.1.cmml" xref="S1.p2.5.m5.1.2.3.1"></times><apply id="S1.p2.5.m5.1.2.3.2.cmml" xref="S1.p2.5.m5.1.2.3.2"><csymbol cd="ambiguous" id="S1.p2.5.m5.1.2.3.2.1.cmml" xref="S1.p2.5.m5.1.2.3.2">subscript</csymbol><ci id="S1.p2.5.m5.1.2.3.2.2.cmml" xref="S1.p2.5.m5.1.2.3.2.2">𝐋</ci><cn id="S1.p2.5.m5.1.2.3.2.3.cmml" type="integer" xref="S1.p2.5.m5.1.2.3.2.3">1</cn></apply><apply id="S1.p2.5.m5.1.2.3.3.cmml" xref="S1.p2.5.m5.1.2.3.3"><csymbol cd="ambiguous" id="S1.p2.5.m5.1.2.3.3.1.cmml" xref="S1.p2.5.m5.1.2.3.3">subscript</csymbol><ci id="S1.p2.5.m5.1.2.3.3.2.cmml" xref="S1.p2.5.m5.1.2.3.3.2">𝐋</ci><cn id="S1.p2.5.m5.1.2.3.3.3.cmml" type="integer" xref="S1.p2.5.m5.1.2.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.5.m5.1c">q(\mathbf{W})+\mathbf{L}_{1}\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.5.m5.1d">italic_q ( bold_W ) + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>를 사용하고, 여기서 <math alttext="q(\cdot)" class="ltx_Math" display="inline" id="S1.p2.6.m6.1"><semantics id="S1.p2.6.m6.1a"><mrow id="S1.p2.6.m6.1.2" xref="S1.p2.6.m6.1.2.cmml"><mi id="S1.p2.6.m6.1.2.2" xref="S1.p2.6.m6.1.2.2.cmml">q</mi><mo id="S1.p2.6.m6.1.2.1" lspace="0px" rspace="0px" xref="S1.p2.6.m6.1.2.1.cmml"></mo><mrow id="S1.p2.6.m6.1.2.3.2" xref="S1.p2.6.m6.1.2.cmml"><mo id="S1.p2.6.m6.1.2.3.2.1" stretchy="false" xref="S1.p2.6.m6.1.2.cmml">(</mo><mo id="S1.p2.6.m6.1.1" lspace="0em" rspace="0em" xref="S1.p2.6.m6.1.1.cmml">⋅</mo><mo id="S1.p2.6.m6.1.2.3.2.2" stretchy="false" xref="S1.p2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.6.m6.1b"><apply id="S1.p2.6.m6.1.2.cmml" xref="S1.p2.6.m6.1.2"><times id="S1.p2.6.m6.1.2.1.cmml" xref="S1.p2.6.m6.1.2.1"></times><ci id="S1.p2.6.m6.1.2.2.cmml" xref="S1.p2.6.m6.1.2.2">𝑞</ci><ci id="S1.p2.6.m6.1.1.cmml" xref="S1.p2.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.6.m6.1c">q(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S1.p2.6.m6.1d">italic_q ( ⋅ )</annotation></semantics></math>는 일부 양자화 함수 <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et al., <a class="ltx_ref" href="#bib.bib9" title="">2023a</a>; Chai et al., <a class="ltx_ref" href="#bib.bib5" title="">2023</a>)</cite>이다.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p3.11">LoRA에서, <math alttext="\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><msub id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">𝐋</mi><mn id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">𝐋</ci><cn id="S1.p3.1.m1.1.1.3.cmml" type="integer" xref="S1.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>를 <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><mn id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><cn id="S1.p3.2.m2.1.1.cmml" type="integer" xref="S1.p3.2.m2.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">bold_0</annotation></semantics></math>로 초기화하여, 모델 출력이 파인튜닝의 시작(즉, <math alttext="\mathbf{X}(\mathbf{W}+\mathbf{L}_{1}\mathbf{L}_{2})=\mathbf{X}\mathbf{W}" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><mrow id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml"><mrow id="S1.p3.3.m3.1.1.1" xref="S1.p3.3.m3.1.1.1.cmml"><mi id="S1.p3.3.m3.1.1.1.3" xref="S1.p3.3.m3.1.1.1.3.cmml">𝐗</mi><mo id="S1.p3.3.m3.1.1.1.2" lspace="0px" rspace="0px" xref="S1.p3.3.m3.1.1.1.2.cmml"></mo><mrow id="S1.p3.3.m3.1.1.1.1.1" xref="S1.p3.3.m3.1.1.1.1.1.1.cmml"><mo id="S1.p3.3.m3.1.1.1.1.1.2" stretchy="false" xref="S1.p3.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p3.3.m3.1.1.1.1.1.1" xref="S1.p3.3.m3.1.1.1.1.1.1.cmml"><mi id="S1.p3.3.m3.1.1.1.1.1.1.2" xref="S1.p3.3.m3.1.1.1.1.1.1.2.cmml">𝐖</mi><mo id="S1.p3.3.m3.1.1.1.1.1.1.1" xref="S1.p3.3.m3.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S1.p3.3.m3.1.1.1.1.1.1.3" xref="S1.p3.3.m3.1.1.1.1.1.1.3.cmml"><msub id="S1.p3.3.m3.1.1.1.1.1.1.3.2" xref="S1.p3.3.m3.1.1.1.1.1.1.3.2.cmml"><mi id="S1.p3.3.m3.1.1.1.1.1.1.3.2.2" xref="S1.p3.3.m3.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S1.p3.3.m3.1.1.1.1.1.1.3.2.3" xref="S1.p3.3.m3.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S1.p3.3.m3.1.1.1.1.1.1.3.1" lspace="0px" rspace="0px" xref="S1.p3.3.m3.1.1.1.1.1.1.3.1.cmml"></mo><msub id="S1.p3.3.m3.1.1.1.1.1.1.3.3" xref="S1.p3.3.m3.1.1.1.1.1.1.3.3.cmml"><mi id="S1.p3.3.m3.1.1.1.1.1.1.3.3.2" xref="S1.p3.3.m3.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S1.p3.3.m3.1.1.1.1.1.1.3.3.3" xref="S1.p3.3.m3.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S1.p3.3.m3.1.1.1.1.1.3" stretchy="false" xref="S1.p3.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.p3.3.m3.1.1.2" xref="S1.p3.3.m3.1.1.2.cmml">=</mo><mi id="S1.p3.3.m3.1.1.3" xref="S1.p3.3.m3.1.1.3.cmml">𝐗𝐖</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><apply id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1"><eq id="S1.p3.3.m3.1.1.2.cmml" xref="S1.p3.3.m3.1.1.2"></eq><apply id="S1.p3.3.m3.1.1.1.cmml" xref="S1.p3.3.m3.1.1.1"><times id="S1.p3.3.m3.1.1.1.2.cmml" xref="S1.p3.3.m3.1.1.1.2"></times><ci id="S1.p3.3.m3.1.1.1.3.cmml" xref="S1.p3.3.m3.1.1.1.3">𝐗</ci><apply id="S1.p3.3.m3.1.1.1.1.1.1.cmml" xref="S1.p3.3.m3.1.1.1.1.1"><plus id="S1.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.1"></plus><ci id="S1.p3.3.m3.1.1.1.1.1.1.2.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.2">𝐖</ci><apply id="S1.p3.3.m3.1.1.1.1.1.1.3.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.3"><times id="S1.p3.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.3.1"></times><apply id="S1.p3.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.1.1.1.1.1.3.2.1.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S1.p3.3.m3.1.1.1.1.1.1.3.2.2.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.3.2.2">𝐋</ci><cn id="S1.p3.3.m3.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S1.p3.3.m3.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S1.p3.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.1.1.1.1.1.3.3.1.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S1.p3.3.m3.1.1.1.1.1.1.3.3.2.cmml" xref="S1.p3.3.m3.1.1.1.1.1.1.3.3.2">𝐋</ci><cn id="S1.p3.3.m3.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S1.p3.3.m3.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply><ci id="S1.p3.3.m3.1.1.3.cmml" xref="S1.p3.3.m3.1.1.3">𝐗𝐖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">\mathbf{X}(\mathbf{W}+\mathbf{L}_{1}\mathbf{L}_{2})=\mathbf{X}\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">bold_X ( bold_W + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) = bold_XW</annotation></semantics></math>)에서 미리 훈련된 모델과 동일한지 확인한다. 그러나, 사전 트레이닝된 매트릭스들이 실질적인 양자화 에러가 있는 정도까지 양자화된 경우(서브-4-비트 레짐들에서 발생하는 것으로 경험적으로 발견되었음), 제로 초기화는 <math alttext="q(\mathbf{W})+\mathbf{L}_{1}\mathbf{L}_{2}\neq\mathbf{W}" class="ltx_Math" display="inline" id="S1.p3.4.m4.1"><semantics id="S1.p3.4.m4.1a"><mrow id="S1.p3.4.m4.1.2" xref="S1.p3.4.m4.1.2.cmml"><mrow id="S1.p3.4.m4.1.2.2" xref="S1.p3.4.m4.1.2.2.cmml"><mrow id="S1.p3.4.m4.1.2.2.2" xref="S1.p3.4.m4.1.2.2.2.cmml"><mi id="S1.p3.4.m4.1.2.2.2.2" xref="S1.p3.4.m4.1.2.2.2.2.cmml">q</mi><mo id="S1.p3.4.m4.1.2.2.2.1" lspace="0px" rspace="0px" xref="S1.p3.4.m4.1.2.2.2.1.cmml"></mo><mrow id="S1.p3.4.m4.1.2.2.2.3.2" xref="S1.p3.4.m4.1.2.2.2.cmml"><mo id="S1.p3.4.m4.1.2.2.2.3.2.1" stretchy="false" xref="S1.p3.4.m4.1.2.2.2.cmml">(</mo><mi id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml">𝐖</mi><mo id="S1.p3.4.m4.1.2.2.2.3.2.2" stretchy="false" xref="S1.p3.4.m4.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S1.p3.4.m4.1.2.2.1" xref="S1.p3.4.m4.1.2.2.1.cmml">+</mo><mrow id="S1.p3.4.m4.1.2.2.3" xref="S1.p3.4.m4.1.2.2.3.cmml"><msub id="S1.p3.4.m4.1.2.2.3.2" xref="S1.p3.4.m4.1.2.2.3.2.cmml"><mi id="S1.p3.4.m4.1.2.2.3.2.2" xref="S1.p3.4.m4.1.2.2.3.2.2.cmml">𝐋</mi><mn id="S1.p3.4.m4.1.2.2.3.2.3" xref="S1.p3.4.m4.1.2.2.3.2.3.cmml">1</mn></msub><mo id="S1.p3.4.m4.1.2.2.3.1" lspace="0px" rspace="0px" xref="S1.p3.4.m4.1.2.2.3.1.cmml"></mo><msub id="S1.p3.4.m4.1.2.2.3.3" xref="S1.p3.4.m4.1.2.2.3.3.cmml"><mi id="S1.p3.4.m4.1.2.2.3.3.2" xref="S1.p3.4.m4.1.2.2.3.3.2.cmml">𝐋</mi><mn id="S1.p3.4.m4.1.2.2.3.3.3" xref="S1.p3.4.m4.1.2.2.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S1.p3.4.m4.1.2.1" xref="S1.p3.4.m4.1.2.1.cmml">≠</mo><mi id="S1.p3.4.m4.1.2.3" xref="S1.p3.4.m4.1.2.3.cmml">𝐖</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><apply id="S1.p3.4.m4.1.2.cmml" xref="S1.p3.4.m4.1.2"><neq id="S1.p3.4.m4.1.2.1.cmml" xref="S1.p3.4.m4.1.2.1"></neq><apply id="S1.p3.4.m4.1.2.2.cmml" xref="S1.p3.4.m4.1.2.2"><plus id="S1.p3.4.m4.1.2.2.1.cmml" xref="S1.p3.4.m4.1.2.2.1"></plus><apply id="S1.p3.4.m4.1.2.2.2.cmml" xref="S1.p3.4.m4.1.2.2.2"><times id="S1.p3.4.m4.1.2.2.2.1.cmml" xref="S1.p3.4.m4.1.2.2.2.1"></times><ci id="S1.p3.4.m4.1.2.2.2.2.cmml" xref="S1.p3.4.m4.1.2.2.2.2">𝑞</ci><ci id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1">𝐖</ci></apply><apply id="S1.p3.4.m4.1.2.2.3.cmml" xref="S1.p3.4.m4.1.2.2.3"><times id="S1.p3.4.m4.1.2.2.3.1.cmml" xref="S1.p3.4.m4.1.2.2.3.1"></times><apply id="S1.p3.4.m4.1.2.2.3.2.cmml" xref="S1.p3.4.m4.1.2.2.3.2"><csymbol cd="ambiguous" id="S1.p3.4.m4.1.2.2.3.2.1.cmml" xref="S1.p3.4.m4.1.2.2.3.2">subscript</csymbol><ci id="S1.p3.4.m4.1.2.2.3.2.2.cmml" xref="S1.p3.4.m4.1.2.2.3.2.2">𝐋</ci><cn id="S1.p3.4.m4.1.2.2.3.2.3.cmml" type="integer" xref="S1.p3.4.m4.1.2.2.3.2.3">1</cn></apply><apply id="S1.p3.4.m4.1.2.2.3.3.cmml" xref="S1.p3.4.m4.1.2.2.3.3"><csymbol cd="ambiguous" id="S1.p3.4.m4.1.2.2.3.3.1.cmml" xref="S1.p3.4.m4.1.2.2.3.3">subscript</csymbol><ci id="S1.p3.4.m4.1.2.2.3.3.2.cmml" xref="S1.p3.4.m4.1.2.2.3.3.2">𝐋</ci><cn id="S1.p3.4.m4.1.2.2.3.3.3.cmml" type="integer" xref="S1.p3.4.m4.1.2.2.3.3.3">2</cn></apply></apply></apply><ci id="S1.p3.4.m4.1.2.3.cmml" xref="S1.p3.4.m4.1.2.3">𝐖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">q(\mathbf{W})+\mathbf{L}_{1}\mathbf{L}_{2}\neq\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.1d">italic_q ( bold_W ) + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≠ bold_W</annotation></semantics></math>이기 때문에 최적이 아닐 수 있다. 본 논문에서는 LoRA가 양자화된 모델에 대한 저순위 업데이트만을 수행한다는 점을 이용하여 양자화 오차를 고려한 초기화 기법을 유도한다. 우리는 로버스트 PCA 문헌 <cite class="ltx_cite ltx_citemacro_citep">(Wright et al., <a class="ltx_ref" href="#bib.bib56" title="">2009</a>; Candès et al., <a class="ltx_ref" href="#bib.bib4" title="">2011</a>; Zhou &amp; Tao, <a class="ltx_ref" href="#bib.bib67" title="">2011</a>)</cite>에서 사용된 것과 유사한 반복 알고리즘을 사용하여 <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S1.p3.5.m5.1"><semantics id="S1.p3.5.m5.1a"><mi id="S1.p3.5.m5.1.1" xref="S1.p3.5.m5.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S1.p3.5.m5.1b"><ci id="S1.p3.5.m5.1.1.cmml" xref="S1.p3.5.m5.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m5.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.m5.1d">bold_W</annotation></semantics></math>를 <math alttext="\mathbf{W}\approx\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S1.p3.6.m6.1"><semantics id="S1.p3.6.m6.1a"><mrow id="S1.p3.6.m6.1.1" xref="S1.p3.6.m6.1.1.cmml"><mi id="S1.p3.6.m6.1.1.2" xref="S1.p3.6.m6.1.1.2.cmml">𝐖</mi><mo id="S1.p3.6.m6.1.1.1" xref="S1.p3.6.m6.1.1.1.cmml">≈</mo><mrow id="S1.p3.6.m6.1.1.3" xref="S1.p3.6.m6.1.1.3.cmml"><mi id="S1.p3.6.m6.1.1.3.2" xref="S1.p3.6.m6.1.1.3.2.cmml">𝐐</mi><mo id="S1.p3.6.m6.1.1.3.1" xref="S1.p3.6.m6.1.1.3.1.cmml">+</mo><mrow id="S1.p3.6.m6.1.1.3.3" xref="S1.p3.6.m6.1.1.3.3.cmml"><msub id="S1.p3.6.m6.1.1.3.3.2" xref="S1.p3.6.m6.1.1.3.3.2.cmml"><mi id="S1.p3.6.m6.1.1.3.3.2.2" xref="S1.p3.6.m6.1.1.3.3.2.2.cmml">𝐋</mi><mn id="S1.p3.6.m6.1.1.3.3.2.3" xref="S1.p3.6.m6.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S1.p3.6.m6.1.1.3.3.1" lspace="0px" rspace="0px" xref="S1.p3.6.m6.1.1.3.3.1.cmml"></mo><msub id="S1.p3.6.m6.1.1.3.3.3" xref="S1.p3.6.m6.1.1.3.3.3.cmml"><mi id="S1.p3.6.m6.1.1.3.3.3.2" xref="S1.p3.6.m6.1.1.3.3.3.2.cmml">𝐋</mi><mn id="S1.p3.6.m6.1.1.3.3.3.3" xref="S1.p3.6.m6.1.1.3.3.3.3.cmml">2</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.6.m6.1b"><apply id="S1.p3.6.m6.1.1.cmml" xref="S1.p3.6.m6.1.1"><approx id="S1.p3.6.m6.1.1.1.cmml" xref="S1.p3.6.m6.1.1.1"></approx><ci id="S1.p3.6.m6.1.1.2.cmml" xref="S1.p3.6.m6.1.1.2">𝐖</ci><apply id="S1.p3.6.m6.1.1.3.cmml" xref="S1.p3.6.m6.1.1.3"><plus id="S1.p3.6.m6.1.1.3.1.cmml" xref="S1.p3.6.m6.1.1.3.1"></plus><ci id="S1.p3.6.m6.1.1.3.2.cmml" xref="S1.p3.6.m6.1.1.3.2">𝐐</ci><apply id="S1.p3.6.m6.1.1.3.3.cmml" xref="S1.p3.6.m6.1.1.3.3"><times id="S1.p3.6.m6.1.1.3.3.1.cmml" xref="S1.p3.6.m6.1.1.3.3.1"></times><apply id="S1.p3.6.m6.1.1.3.3.2.cmml" xref="S1.p3.6.m6.1.1.3.3.2"><csymbol cd="ambiguous" id="S1.p3.6.m6.1.1.3.3.2.1.cmml" xref="S1.p3.6.m6.1.1.3.3.2">subscript</csymbol><ci id="S1.p3.6.m6.1.1.3.3.2.2.cmml" xref="S1.p3.6.m6.1.1.3.3.2.2">𝐋</ci><cn id="S1.p3.6.m6.1.1.3.3.2.3.cmml" type="integer" xref="S1.p3.6.m6.1.1.3.3.2.3">1</cn></apply><apply id="S1.p3.6.m6.1.1.3.3.3.cmml" xref="S1.p3.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S1.p3.6.m6.1.1.3.3.3.1.cmml" xref="S1.p3.6.m6.1.1.3.3.3">subscript</csymbol><ci id="S1.p3.6.m6.1.1.3.3.3.2.cmml" xref="S1.p3.6.m6.1.1.3.3.3.2">𝐋</ci><cn id="S1.p3.6.m6.1.1.3.3.3.3.cmml" type="integer" xref="S1.p3.6.m6.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m6.1c">\mathbf{W}\approx\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.6.m6.1d">bold_W ≈ bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>로 분해한다. 여기서 <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S1.p3.7.m7.1"><semantics id="S1.p3.7.m7.1a"><mi id="S1.p3.7.m7.1.1" xref="S1.p3.7.m7.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S1.p3.7.m7.1b"><ci id="S1.p3.7.m7.1.1.cmml" xref="S1.p3.7.m7.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.7.m7.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.7.m7.1d">bold_Q</annotation></semantics></math>는 고정된 상태로 유지되는 양자화된 성분이고 <math alttext="\mathbf{L}_{1}\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S1.p3.8.m8.1"><semantics id="S1.p3.8.m8.1a"><mrow id="S1.p3.8.m8.1.1" xref="S1.p3.8.m8.1.1.cmml"><msub id="S1.p3.8.m8.1.1.2" xref="S1.p3.8.m8.1.1.2.cmml"><mi id="S1.p3.8.m8.1.1.2.2" xref="S1.p3.8.m8.1.1.2.2.cmml">𝐋</mi><mn id="S1.p3.8.m8.1.1.2.3" xref="S1.p3.8.m8.1.1.2.3.cmml">1</mn></msub><mo id="S1.p3.8.m8.1.1.1" lspace="0px" rspace="0px" xref="S1.p3.8.m8.1.1.1.cmml"></mo><msub id="S1.p3.8.m8.1.1.3" xref="S1.p3.8.m8.1.1.3.cmml"><mi id="S1.p3.8.m8.1.1.3.2" xref="S1.p3.8.m8.1.1.3.2.cmml">𝐋</mi><mn id="S1.p3.8.m8.1.1.3.3" xref="S1.p3.8.m8.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.8.m8.1b"><apply id="S1.p3.8.m8.1.1.cmml" xref="S1.p3.8.m8.1.1"><times id="S1.p3.8.m8.1.1.1.cmml" xref="S1.p3.8.m8.1.1.1"></times><apply id="S1.p3.8.m8.1.1.2.cmml" xref="S1.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="S1.p3.8.m8.1.1.2.1.cmml" xref="S1.p3.8.m8.1.1.2">subscript</csymbol><ci id="S1.p3.8.m8.1.1.2.2.cmml" xref="S1.p3.8.m8.1.1.2.2">𝐋</ci><cn id="S1.p3.8.m8.1.1.2.3.cmml" type="integer" xref="S1.p3.8.m8.1.1.2.3">1</cn></apply><apply id="S1.p3.8.m8.1.1.3.cmml" xref="S1.p3.8.m8.1.1.3"><csymbol cd="ambiguous" id="S1.p3.8.m8.1.1.3.1.cmml" xref="S1.p3.8.m8.1.1.3">subscript</csymbol><ci id="S1.p3.8.m8.1.1.3.2.cmml" xref="S1.p3.8.m8.1.1.3.2">𝐋</ci><cn id="S1.p3.8.m8.1.1.3.3.cmml" type="integer" xref="S1.p3.8.m8.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.8.m8.1c">\mathbf{L}_{1}\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.8.m8.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>는 저순위 성분이다. 어댑테이션 동안에만 <math alttext="\mathbf{L}_{1}" class="ltx_Math" display="inline" id="S1.p3.9.m9.1"><semantics id="S1.p3.9.m9.1a"><msub id="S1.p3.9.m9.1.1" xref="S1.p3.9.m9.1.1.cmml"><mi id="S1.p3.9.m9.1.1.2" xref="S1.p3.9.m9.1.1.2.cmml">𝐋</mi><mn id="S1.p3.9.m9.1.1.3" xref="S1.p3.9.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.9.m9.1b"><apply id="S1.p3.9.m9.1.1.cmml" xref="S1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S1.p3.9.m9.1.1.1.cmml" xref="S1.p3.9.m9.1.1">subscript</csymbol><ci id="S1.p3.9.m9.1.1.2.cmml" xref="S1.p3.9.m9.1.1.2">𝐋</ci><cn id="S1.p3.9.m9.1.1.3.cmml" type="integer" xref="S1.p3.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.9.m9.1c">\mathbf{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.9.m9.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> 및 <math alttext="\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S1.p3.10.m10.1"><semantics id="S1.p3.10.m10.1a"><msub id="S1.p3.10.m10.1.1" xref="S1.p3.10.m10.1.1.cmml"><mi id="S1.p3.10.m10.1.1.2" xref="S1.p3.10.m10.1.1.2.cmml">𝐋</mi><mn id="S1.p3.10.m10.1.1.3" xref="S1.p3.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.10.m10.1b"><apply id="S1.p3.10.m10.1.1.cmml" xref="S1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S1.p3.10.m10.1.1.1.cmml" xref="S1.p3.10.m10.1.1">subscript</csymbol><ci id="S1.p3.10.m10.1.1.2.cmml" xref="S1.p3.10.m10.1.1.2">𝐋</ci><cn id="S1.p3.10.m10.1.1.3.cmml" type="integer" xref="S1.p3.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.10.m10.1c">\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.10.m10.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>(<math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S1.p3.11.m11.1"><semantics id="S1.p3.11.m11.1a"><mi id="S1.p3.11.m11.1.1" xref="S1.p3.11.m11.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S1.p3.11.m11.1b"><ci id="S1.p3.11.m11.1.1.cmml" xref="S1.p3.11.m11.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.11.m11.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.11.m11.1d">bold_W</annotation></semantics></math>의 고-분산 부분 공간을 캡처함)가 미세 조정된다. 모든 레이어에 동일한 양자화 구성을 적용하는 대신 정수 선형 프로그래밍을 사용하여 전체 목표 비트율이 주어진 각 매트릭스에 다른 구성(비트, 블록 크기 등)을 할당할 수 있는 혼합 양자화 전략을 찾는다. 마지막으로, 우리는 보정 샘플로부터 얻은 피셔 정보 행렬의 근사치로 분해 목적을 수정하는 알고리즘의 데이터 인식 버전을 탐색한다.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p4.1">LQ-LoRA를 적용하여 RoBERTa <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="#bib.bib34" title="">2019</a>)</cite>와 LLaMA-2 <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="#bib.bib51" title="">2023b</a>)</cite> 모델을 적용하였으며, 사용자가 목표 메모리 예산을 유연하게 설정할 수 있도록 하면서 강한 QLoRA <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et al., <a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite>와 GPTQ-LoRA <cite class="ltx_cite ltx_citemacro_citep">(Frantar et al., <a class="ltx_ref" href="#bib.bib13" title="">2022</a>; Chai et al., <a class="ltx_ref" href="#bib.bib5" title="">2023</a>)</cite> 기준선에서 의미 있게 개선할 수 있음을 확인하였다. LQ-LoRA는 또한 표준 언어 모델링 데이터 세트에 적용되어 가중치 전용 PTQ(post-training quantization) 방법의 역할을 할 수 있다. 이 환경에서 LLaMA-2-70B를 2.85비트로 압축할 수 있음을 알 수 있었다.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Low-rank Adaptation of Large Language Models</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S2.SS1.p1.11">큰 언어 모델 <cite class="ltx_cite ltx_citemacro_citep">(LoRA; Hu et al., <a class="ltx_ref" href="#bib.bib19" title="">2022</a>)</cite>의 낮은 순위 적응은 LLM 미세 조정 동안 메모리 풋프린트를 줄이기 위한 간단하지만 효과적인 접근법으로 부상했다. 사전 트레이닝된 선형 레이어의 매트릭스 <math alttext="\mathbf{W}\in\mathbb{R}^{d\times k}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">𝐖</mi><mo id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.3.2" xref="S2.SS1.p1.1.m1.1.1.3.3.2.cmml">d</mi><mo id="S2.SS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p1.1.m1.1.1.3.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><in id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></in><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝐖</ci><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S2.SS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3"><times id="S2.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S2.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.2">𝑑</ci><ci id="S2.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathbf{W}\in\mathbb{R}^{d\times k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>가 주어지면, LoRA는 <math alttext="\mathbf{L}_{1}\in\mathbb{R}^{d\times r},\mathbf{L}_{2}\in\mathbb{R}^{r\times k}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.2"><semantics id="S2.SS1.p1.2.m2.2a"><mrow id="S2.SS1.p1.2.m2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.3.cmml"><mrow id="S2.SS1.p1.2.m2.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.cmml"><msub id="S2.SS1.p1.2.m2.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.1.1.2.2.cmml">𝐋</mi><mn id="S2.SS1.p1.2.m2.1.1.1.1.2.3" xref="S2.SS1.p1.2.m2.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.2.m2.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.2.m2.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.2.m2.1.1.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.3.3.2" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.2.cmml">d</mi><mo id="S2.SS1.p1.2.m2.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p1.2.m2.1.1.1.1.3.3.3" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><mo id="S2.SS1.p1.2.m2.2.2.2.3" xref="S2.SS1.p1.2.m2.2.2.3a.cmml">,</mo><mrow id="S2.SS1.p1.2.m2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.2.cmml"><msub id="S2.SS1.p1.2.m2.2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.2.2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.2.2.2.cmml">𝐋</mi><mn id="S2.SS1.p1.2.m2.2.2.2.2.2.3" xref="S2.SS1.p1.2.m2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.2.m2.2.2.2.2.1" xref="S2.SS1.p1.2.m2.2.2.2.2.1.cmml">∈</mo><msup id="S2.SS1.p1.2.m2.2.2.2.2.3" xref="S2.SS1.p1.2.m2.2.2.2.2.3.cmml"><mi id="S2.SS1.p1.2.m2.2.2.2.2.3.2" xref="S2.SS1.p1.2.m2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.2.m2.2.2.2.2.3.3" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.cmml"><mi id="S2.SS1.p1.2.m2.2.2.2.2.3.3.2" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.2.cmml">r</mi><mo id="S2.SS1.p1.2.m2.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.1.cmml">×</mo><mi id="S2.SS1.p1.2.m2.2.2.2.2.3.3.3" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.3.cmml">k</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.2b"><apply id="S2.SS1.p1.2.m2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.3a.cmml" xref="S2.SS1.p1.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1"><in id="S2.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1"></in><apply id="S2.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.2.2">𝐋</ci><cn id="S2.SS1.p1.2.m2.1.1.1.1.2.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.1.1.1.1.2.3">1</cn></apply><apply id="S2.SS1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.2">ℝ</ci><apply id="S2.SS1.p1.2.m2.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3"><times id="S2.SS1.p1.2.m2.1.1.1.1.3.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.1"></times><ci id="S2.SS1.p1.2.m2.1.1.1.1.3.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.2">𝑑</ci><ci id="S2.SS1.p1.2.m2.1.1.1.1.3.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="S2.SS1.p1.2.m2.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2"><in id="S2.SS1.p1.2.m2.2.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.1"></in><apply id="S2.SS1.p1.2.m2.2.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2.2">𝐋</ci><cn id="S2.SS1.p1.2.m2.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.2.2.2.2.2.3">2</cn></apply><apply id="S2.SS1.p1.2.m2.2.2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.2.2.3.1.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3">superscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.2.2.3.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.2">ℝ</ci><apply id="S2.SS1.p1.2.m2.2.2.2.2.3.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3"><times id="S2.SS1.p1.2.m2.2.2.2.2.3.3.1.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.1"></times><ci id="S2.SS1.p1.2.m2.2.2.2.2.3.3.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.2">𝑟</ci><ci id="S2.SS1.p1.2.m2.2.2.2.2.3.3.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.2c">\mathbf{L}_{1}\in\mathbb{R}^{d\times r},\mathbf{L}_{2}\in\mathbb{R}^{r\times k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.2d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_r end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_r × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>를 <math alttext="r&lt;\min(d,k)" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.3"><semantics id="S2.SS1.p1.3.m3.3a"><mrow id="S2.SS1.p1.3.m3.3.4" xref="S2.SS1.p1.3.m3.3.4.cmml"><mi id="S2.SS1.p1.3.m3.3.4.2" xref="S2.SS1.p1.3.m3.3.4.2.cmml">r</mi><mo id="S2.SS1.p1.3.m3.3.4.1" xref="S2.SS1.p1.3.m3.3.4.1.cmml">&lt;</mo><mrow id="S2.SS1.p1.3.m3.3.4.3.2" xref="S2.SS1.p1.3.m3.3.4.3.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">min</mi><mo id="S2.SS1.p1.3.m3.3.4.3.2a" xref="S2.SS1.p1.3.m3.3.4.3.1.cmml">⁡</mo><mrow id="S2.SS1.p1.3.m3.3.4.3.2.1" xref="S2.SS1.p1.3.m3.3.4.3.1.cmml"><mo id="S2.SS1.p1.3.m3.3.4.3.2.1.1" stretchy="false" xref="S2.SS1.p1.3.m3.3.4.3.1.cmml">(</mo><mi id="S2.SS1.p1.3.m3.2.2" xref="S2.SS1.p1.3.m3.2.2.cmml">d</mi><mo id="S2.SS1.p1.3.m3.3.4.3.2.1.2" xref="S2.SS1.p1.3.m3.3.4.3.1.cmml">,</mo><mi id="S2.SS1.p1.3.m3.3.3" xref="S2.SS1.p1.3.m3.3.3.cmml">k</mi><mo id="S2.SS1.p1.3.m3.3.4.3.2.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.3b"><apply id="S2.SS1.p1.3.m3.3.4.cmml" xref="S2.SS1.p1.3.m3.3.4"><lt id="S2.SS1.p1.3.m3.3.4.1.cmml" xref="S2.SS1.p1.3.m3.3.4.1"></lt><ci id="S2.SS1.p1.3.m3.3.4.2.cmml" xref="S2.SS1.p1.3.m3.3.4.2">𝑟</ci><apply id="S2.SS1.p1.3.m3.3.4.3.1.cmml" xref="S2.SS1.p1.3.m3.3.4.3.2"><min id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"></min><ci id="S2.SS1.p1.3.m3.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2">𝑑</ci><ci id="S2.SS1.p1.3.m3.3.3.cmml" xref="S2.SS1.p1.3.m3.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.3c">r&lt;\min(d,k)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.3d">italic_r &lt; roman_min ( italic_d , italic_k )</annotation></semantics></math>로 두 개의 매트릭스 <math alttext="\mathbf{L}_{1}\in\mathbb{R}^{d\times r},\mathbf{L}_{2}\in\mathbb{R}^{r\times k}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.2"><semantics id="S2.SS1.p1.2.m2.2a"><mrow id="S2.SS1.p1.2.m2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.3.cmml"><mrow id="S2.SS1.p1.2.m2.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.cmml"><msub id="S2.SS1.p1.2.m2.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.1.1.2.2.cmml">𝐋</mi><mn id="S2.SS1.p1.2.m2.1.1.1.1.2.3" xref="S2.SS1.p1.2.m2.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.2.m2.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.2.m2.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.2.m2.1.1.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.3.3.2" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.2.cmml">d</mi><mo id="S2.SS1.p1.2.m2.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p1.2.m2.1.1.1.1.3.3.3" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><mo id="S2.SS1.p1.2.m2.2.2.2.3" xref="S2.SS1.p1.2.m2.2.2.3a.cmml">,</mo><mrow id="S2.SS1.p1.2.m2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.2.cmml"><msub id="S2.SS1.p1.2.m2.2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.2.2.2.2.2.2" xref="S2.SS1.p1.2.m2.2.2.2.2.2.2.cmml">𝐋</mi><mn id="S2.SS1.p1.2.m2.2.2.2.2.2.3" xref="S2.SS1.p1.2.m2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.2.m2.2.2.2.2.1" xref="S2.SS1.p1.2.m2.2.2.2.2.1.cmml">∈</mo><msup id="S2.SS1.p1.2.m2.2.2.2.2.3" xref="S2.SS1.p1.2.m2.2.2.2.2.3.cmml"><mi id="S2.SS1.p1.2.m2.2.2.2.2.3.2" xref="S2.SS1.p1.2.m2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.2.m2.2.2.2.2.3.3" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.cmml"><mi id="S2.SS1.p1.2.m2.2.2.2.2.3.3.2" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.2.cmml">r</mi><mo id="S2.SS1.p1.2.m2.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.1.cmml">×</mo><mi id="S2.SS1.p1.2.m2.2.2.2.2.3.3.3" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.3.cmml">k</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.2b"><apply id="S2.SS1.p1.2.m2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.3a.cmml" xref="S2.SS1.p1.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1"><in id="S2.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1"></in><apply id="S2.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.2.2">𝐋</ci><cn id="S2.SS1.p1.2.m2.1.1.1.1.2.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.1.1.1.1.2.3">1</cn></apply><apply id="S2.SS1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.2">ℝ</ci><apply id="S2.SS1.p1.2.m2.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3"><times id="S2.SS1.p1.2.m2.1.1.1.1.3.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.1"></times><ci id="S2.SS1.p1.2.m2.1.1.1.1.3.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.2">𝑑</ci><ci id="S2.SS1.p1.2.m2.1.1.1.1.3.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="S2.SS1.p1.2.m2.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2"><in id="S2.SS1.p1.2.m2.2.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.1"></in><apply id="S2.SS1.p1.2.m2.2.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.2.2">𝐋</ci><cn id="S2.SS1.p1.2.m2.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.2.2.2.2.2.3">2</cn></apply><apply id="S2.SS1.p1.2.m2.2.2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.2.2.3.1.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3">superscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.2.2.3.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.2">ℝ</ci><apply id="S2.SS1.p1.2.m2.2.2.2.2.3.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3"><times id="S2.SS1.p1.2.m2.2.2.2.2.3.3.1.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.1"></times><ci id="S2.SS1.p1.2.m2.2.2.2.2.3.3.2.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.2">𝑟</ci><ci id="S2.SS1.p1.2.m2.2.2.2.2.3.3.3.cmml" xref="S2.SS1.p1.2.m2.2.2.2.2.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.2c">\mathbf{L}_{1}\in\mathbb{R}^{d\times r},\mathbf{L}_{2}\in\mathbb{R}^{r\times k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.2d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_r end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_r × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>를 초기화하는데, 여기서 <math alttext="\mathbf{L}_{1}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">𝐋</mi><mn id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝐋</ci><cn id="S2.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\mathbf{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>는 가우시안 노이즈로 초기화되고 <math alttext="\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><msub id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">𝐋</mi><mn id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝐋</ci><cn id="S2.SS1.p1.5.m5.1.1.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>는 <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mn id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><cn id="S2.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S2.SS1.p1.6.m6.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">bold_0</annotation></semantics></math>로 초기화된다(훈련 시작시 <math alttext="\mathbf{L}_{1}\mathbf{L}_{2}=\mathbf{0}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mrow id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mrow id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml"><msub id="S2.SS1.p1.7.m7.1.1.2.2" xref="S2.SS1.p1.7.m7.1.1.2.2.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2.2.2" xref="S2.SS1.p1.7.m7.1.1.2.2.2.cmml">𝐋</mi><mn id="S2.SS1.p1.7.m7.1.1.2.2.3" xref="S2.SS1.p1.7.m7.1.1.2.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.7.m7.1.1.2.1" lspace="0px" rspace="0px" xref="S2.SS1.p1.7.m7.1.1.2.1.cmml"></mo><msub id="S2.SS1.p1.7.m7.1.1.2.3" xref="S2.SS1.p1.7.m7.1.1.2.3.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2.3.2" xref="S2.SS1.p1.7.m7.1.1.2.3.2.cmml">𝐋</mi><mn id="S2.SS1.p1.7.m7.1.1.2.3.3" xref="S2.SS1.p1.7.m7.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="S2.SS1.p1.7.m7.1.1.1" xref="S2.SS1.p1.7.m7.1.1.1.cmml">=</mo><mn id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><eq id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1.1"></eq><apply id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2"><times id="S2.SS1.p1.7.m7.1.1.2.1.cmml" xref="S2.SS1.p1.7.m7.1.1.2.1"></times><apply id="S2.SS1.p1.7.m7.1.1.2.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.2.2.1.cmml" xref="S2.SS1.p1.7.m7.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.2.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2.2.2">𝐋</ci><cn id="S2.SS1.p1.7.m7.1.1.2.2.3.cmml" type="integer" xref="S2.SS1.p1.7.m7.1.1.2.2.3">1</cn></apply><apply id="S2.SS1.p1.7.m7.1.1.2.3.cmml" xref="S2.SS1.p1.7.m7.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.2.3.1.cmml" xref="S2.SS1.p1.7.m7.1.1.2.3">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.3.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2.3.2">𝐋</ci><cn id="S2.SS1.p1.7.m7.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.p1.7.m7.1.1.2.3.3">2</cn></apply></apply><cn id="S2.SS1.p1.7.m7.1.1.3.cmml" type="integer" xref="S2.SS1.p1.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">\mathbf{L}_{1}\mathbf{L}_{2}=\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = bold_0</annotation></semantics></math>가 되도록 하기 위해서). 그런 다음 LoRA는 선형 계층을 <math alttext="\mathbf{X}(\mathbf{W}+\mathbf{L}_{1}\mathbf{L}_{2})" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><mrow id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">𝐗</mi><mo id="S2.SS1.p1.8.m8.1.1.2" lspace="0px" rspace="0px" xref="S2.SS1.p1.8.m8.1.1.2.cmml"></mo><mrow id="S2.SS1.p1.8.m8.1.1.1.1" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.8.m8.1.1.1.1.1" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.1.1.1.2" xref="S2.SS1.p1.8.m8.1.1.1.1.1.2.cmml">𝐖</mi><mo id="S2.SS1.p1.8.m8.1.1.1.1.1.1" xref="S2.SS1.p1.8.m8.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.SS1.p1.8.m8.1.1.1.1.1.3" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.cmml"><msub id="S2.SS1.p1.8.m8.1.1.1.1.1.3.2" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.cmml"><mi id="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.2" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.3" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.8.m8.1.1.1.1.1.3.1" lspace="0px" rspace="0px" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.1.cmml"></mo><msub id="S2.SS1.p1.8.m8.1.1.1.1.1.3.3" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.cmml"><mi id="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.2" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.3" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S2.SS1.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><times id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2"></times><ci id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3">𝐗</ci><apply id="S2.SS1.p1.8.m8.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1"><plus id="S2.SS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.1"></plus><ci id="S2.SS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.2">𝐖</ci><apply id="S2.SS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3"><times id="S2.SS1.p1.8.m8.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.1"></times><apply id="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.2.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.2">𝐋</ci><cn id="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.2.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.2">𝐋</ci><cn id="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">\mathbf{X}(\mathbf{W}+\mathbf{L}_{1}\mathbf{L}_{2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">bold_X ( bold_W + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>(여기서는 <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">bold_X</annotation></semantics></math>는 이전 계층의 활성화)로 재매개화하고 언어 모델 적응 동안 피네튠 <math alttext="\mathbf{L}_{1}" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><msub id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">𝐋</mi><mn id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝐋</ci><cn id="S2.SS1.p1.10.m10.1.1.3.cmml" type="integer" xref="S2.SS1.p1.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\mathbf{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> 및 <math alttext="\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.1"><semantics id="S2.SS1.p1.11.m11.1a"><msub id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2" xref="S2.SS1.p1.11.m11.1.1.2.cmml">𝐋</mi><mn id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2">𝐋</ci><cn id="S2.SS1.p1.11.m11.1.1.3.cmml" type="integer" xref="S2.SS1.p1.11.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>만 재매개화한다. (바이어스 벡터는 간결함을 위해 생략됨.)</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S2.SS1.p2.1">LoRA는 그래디언트들 및 연관된 최적화기 상태들(예를 들어, <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">bold_W</annotation></semantics></math>에 대한 Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a class="ltx_ref" href="#bib.bib22" title="">2015</a>)</cite>에서의 운동량 및 분산 통계)을 위해 GPU 메모리를 할당할 필요가 없기 때문에 풀 핀튜닝보다 메모리 효율이 더 높다. 또한 사전 학습된 모델(예: Adapters <cite class="ltx_cite ltx_citemacro_citep">(Houlsby et al., <a class="ltx_ref" href="#bib.bib17" title="">2019</a>)</cite> and Prompt Tuning <cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Liang, <a class="ltx_ref" href="#bib.bib28" title="">2021</a>; Lester et al., <a class="ltx_ref" href="#bib.bib27" title="">2021</a>)</cite>) 위에서 소수의 파라미터를 학습하는 메모리 효율적인 미세조정을 위한 다른 전략들(예: Adapters <cite class="ltx_cite ltx_citemacro_citep">(Houlsby et al., <a class="ltx_ref" href="#bib.bib17" title="">2019</a>)</cite> 및 Prompt Tuning <cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Liang, <a class="ltx_ref" href="#bib.bib28" title="">2021</a>; Lester et al., <a class="ltx_ref" href="#bib.bib27" title="">2021</a>)</cite>)에서 LoRA는 LLM의 적응, 특히 명령어 추종 벤치마크에 대한 지도 미세조정에 널리 보급되었다.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Weight Quantization of Large Language Models</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S2.SS2.p1.5">스케일링 팩터 <math alttext="s=\frac{\max(|\mathbf{u}|)}{2^{b-1}-1}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.3"><semantics id="S2.SS2.p1.2.m2.3a"><mrow id="S2.SS2.p1.2.m2.3.4" xref="S2.SS2.p1.2.m2.3.4.cmml"><mi id="S2.SS2.p1.2.m2.3.4.2" xref="S2.SS2.p1.2.m2.3.4.2.cmml">s</mi><mo id="S2.SS2.p1.2.m2.3.4.1" xref="S2.SS2.p1.2.m2.3.4.1.cmml">=</mo><mfrac id="S2.SS2.p1.2.m2.3.3" xref="S2.SS2.p1.2.m2.3.3.cmml"><mrow id="S2.SS2.p1.2.m2.3.3.3.3" xref="S2.SS2.p1.2.m2.3.3.3.4.cmml"><mi id="S2.SS2.p1.2.m2.2.2.2.2" xref="S2.SS2.p1.2.m2.2.2.2.2.cmml">max</mi><mo id="S2.SS2.p1.2.m2.3.3.3.3a" xref="S2.SS2.p1.2.m2.3.3.3.4.cmml">⁡</mo><mrow id="S2.SS2.p1.2.m2.3.3.3.3.1" xref="S2.SS2.p1.2.m2.3.3.3.4.cmml"><mo id="S2.SS2.p1.2.m2.3.3.3.3.1.2" stretchy="false" xref="S2.SS2.p1.2.m2.3.3.3.4.cmml">(</mo><mrow id="S2.SS2.p1.2.m2.3.3.3.3.1.1.2" xref="S2.SS2.p1.2.m2.3.3.3.3.1.1.1.cmml"><mo id="S2.SS2.p1.2.m2.3.3.3.3.1.1.2.1" stretchy="false" xref="S2.SS2.p1.2.m2.3.3.3.3.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p1.2.m2.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.cmml">𝐮</mi><mo id="S2.SS2.p1.2.m2.3.3.3.3.1.1.2.2" stretchy="false" xref="S2.SS2.p1.2.m2.3.3.3.3.1.1.1.1.cmml">|</mo></mrow><mo id="S2.SS2.p1.2.m2.3.3.3.3.1.3" stretchy="false" xref="S2.SS2.p1.2.m2.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S2.SS2.p1.2.m2.3.3.5" xref="S2.SS2.p1.2.m2.3.3.5.cmml"><msup id="S2.SS2.p1.2.m2.3.3.5.2" xref="S2.SS2.p1.2.m2.3.3.5.2.cmml"><mn id="S2.SS2.p1.2.m2.3.3.5.2.2" xref="S2.SS2.p1.2.m2.3.3.5.2.2.cmml">2</mn><mrow id="S2.SS2.p1.2.m2.3.3.5.2.3" xref="S2.SS2.p1.2.m2.3.3.5.2.3.cmml"><mi id="S2.SS2.p1.2.m2.3.3.5.2.3.2" xref="S2.SS2.p1.2.m2.3.3.5.2.3.2.cmml">b</mi><mo id="S2.SS2.p1.2.m2.3.3.5.2.3.1" xref="S2.SS2.p1.2.m2.3.3.5.2.3.1.cmml">−</mo><mn id="S2.SS2.p1.2.m2.3.3.5.2.3.3" xref="S2.SS2.p1.2.m2.3.3.5.2.3.3.cmml">1</mn></mrow></msup><mo id="S2.SS2.p1.2.m2.3.3.5.1" xref="S2.SS2.p1.2.m2.3.3.5.1.cmml">−</mo><mn id="S2.SS2.p1.2.m2.3.3.5.3" xref="S2.SS2.p1.2.m2.3.3.5.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.3b"><apply id="S2.SS2.p1.2.m2.3.4.cmml" xref="S2.SS2.p1.2.m2.3.4"><eq id="S2.SS2.p1.2.m2.3.4.1.cmml" xref="S2.SS2.p1.2.m2.3.4.1"></eq><ci id="S2.SS2.p1.2.m2.3.4.2.cmml" xref="S2.SS2.p1.2.m2.3.4.2">𝑠</ci><apply id="S2.SS2.p1.2.m2.3.3.cmml" xref="S2.SS2.p1.2.m2.3.3"><divide id="S2.SS2.p1.2.m2.3.3.4.cmml" xref="S2.SS2.p1.2.m2.3.3"></divide><apply id="S2.SS2.p1.2.m2.3.3.3.4.cmml" xref="S2.SS2.p1.2.m2.3.3.3.3"><max id="S2.SS2.p1.2.m2.2.2.2.2.cmml" xref="S2.SS2.p1.2.m2.2.2.2.2"></max><apply id="S2.SS2.p1.2.m2.3.3.3.3.1.1.1.cmml" xref="S2.SS2.p1.2.m2.3.3.3.3.1.1.2"><abs id="S2.SS2.p1.2.m2.3.3.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.3.3.3.3.1.1.2.1"></abs><ci id="S2.SS2.p1.2.m2.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1">𝐮</ci></apply></apply><apply id="S2.SS2.p1.2.m2.3.3.5.cmml" xref="S2.SS2.p1.2.m2.3.3.5"><minus id="S2.SS2.p1.2.m2.3.3.5.1.cmml" xref="S2.SS2.p1.2.m2.3.3.5.1"></minus><apply id="S2.SS2.p1.2.m2.3.3.5.2.cmml" xref="S2.SS2.p1.2.m2.3.3.5.2"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.5.2.1.cmml" xref="S2.SS2.p1.2.m2.3.3.5.2">superscript</csymbol><cn id="S2.SS2.p1.2.m2.3.3.5.2.2.cmml" type="integer" xref="S2.SS2.p1.2.m2.3.3.5.2.2">2</cn><apply id="S2.SS2.p1.2.m2.3.3.5.2.3.cmml" xref="S2.SS2.p1.2.m2.3.3.5.2.3"><minus id="S2.SS2.p1.2.m2.3.3.5.2.3.1.cmml" xref="S2.SS2.p1.2.m2.3.3.5.2.3.1"></minus><ci id="S2.SS2.p1.2.m2.3.3.5.2.3.2.cmml" xref="S2.SS2.p1.2.m2.3.3.5.2.3.2">𝑏</ci><cn id="S2.SS2.p1.2.m2.3.3.5.2.3.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.3.3.5.2.3.3">1</cn></apply></apply><cn id="S2.SS2.p1.2.m2.3.3.5.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.3.3.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.3c">s=\frac{\max(|\mathbf{u}|)}{2^{b-1}-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.3d">italic_s = divide start_ARG roman_max ( | bold_u | ) end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT - 1 end_ARG</annotation></semantics></math>와 비트 사이즈 <math alttext="b" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_b</annotation></semantics></math>로 가중치의 블록을 <math alttext="\mathbf{u}\approx s\times\operatorname{clamp}\left(\left\lfloor\frac{1}{s}\mathbf{u}\right\rceil;-2^{b-1},2^{b-1}-1\right)" class="ltx_math_unparsed" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1b"><mi id="S2.SS2.p1.1.m1.1.1">𝐮</mi><mo id="S2.SS2.p1.1.m1.1.2">≈</mo><mi id="S2.SS2.p1.1.m1.1.3">s</mi><mo id="S2.SS2.p1.1.m1.1.4" lspace="0.222em" rspace="0.222em">×</mo><mi id="S2.SS2.p1.1.m1.1.5">clamp</mi><mrow id="S2.SS2.p1.1.m1.1.6"><mo id="S2.SS2.p1.1.m1.1.6.1">(</mo><mrow id="S2.SS2.p1.1.m1.1.6.2"><mo id="S2.SS2.p1.1.m1.1.6.2.1">⌊</mo><mfrac id="S2.SS2.p1.1.m1.1.6.2.2"><mn id="S2.SS2.p1.1.m1.1.6.2.2.2">1</mn><mi id="S2.SS2.p1.1.m1.1.6.2.2.3">s</mi></mfrac><mi id="S2.SS2.p1.1.m1.1.6.2.3">𝐮</mi><mo id="S2.SS2.p1.1.m1.1.6.2.4">⌉</mo></mrow><mo id="S2.SS2.p1.1.m1.1.6.3" rspace="0em">;</mo><mo id="S2.SS2.p1.1.m1.1.6.4" lspace="0em">−</mo><msup id="S2.SS2.p1.1.m1.1.6.5"><mn id="S2.SS2.p1.1.m1.1.6.5.2">2</mn><mrow id="S2.SS2.p1.1.m1.1.6.5.3"><mi id="S2.SS2.p1.1.m1.1.6.5.3.2">b</mi><mo id="S2.SS2.p1.1.m1.1.6.5.3.1">−</mo><mn id="S2.SS2.p1.1.m1.1.6.5.3.3">1</mn></mrow></msup><mo id="S2.SS2.p1.1.m1.1.6.6">,</mo><msup id="S2.SS2.p1.1.m1.1.6.7"><mn id="S2.SS2.p1.1.m1.1.6.7.2">2</mn><mrow id="S2.SS2.p1.1.m1.1.6.7.3"><mi id="S2.SS2.p1.1.m1.1.6.7.3.2">b</mi><mo id="S2.SS2.p1.1.m1.1.6.7.3.1">−</mo><mn id="S2.SS2.p1.1.m1.1.6.7.3.3">1</mn></mrow></msup><mo id="S2.SS2.p1.1.m1.1.6.8">−</mo><mn id="S2.SS2.p1.1.m1.1.6.9">1</mn><mo id="S2.SS2.p1.1.m1.1.6.10">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\mathbf{u}\approx s\times\operatorname{clamp}\left(\left\lfloor\frac{1}{s}\mathbf{u}\right\rceil;-2^{b-1},2^{b-1}-1\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">bold_u ≈ italic_s × roman_clamp ( ⌊ divide start_ARG 1 end_ARG start_ARG italic_s end_ARG bold_u ⌉ ; - 2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT , 2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT - 1 )</annotation></semantics></math>로 양자화/역양자화하는 RTN(Standard round-to-nearest) 양자화는 사전 훈련된 LLM'의 가중치를 <math alttext="8" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><mn id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><cn id="S2.SS2.p1.4.m4.1.1.cmml" type="integer" xref="S2.SS2.p1.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">8</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">8</annotation></semantics></math>-bits <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="#bib.bib59" title="">2022</a>)</cite>로 양자화하는 데 효과적인 것으로 나타났다. 그러나, (sub) <math alttext="4" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><mn id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><cn id="S2.SS2.p1.5.m5.1.1.cmml" type="integer" xref="S2.SS2.p1.5.m5.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">4</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">4</annotation></semantics></math>-비트 양자화는 RTN에서는 어렵다는 것이 경험적으로 밝혀졌고, 최근의 방법들은 일반적으로 더 나은 가중치 양자화 <cite class="ltx_cite ltx_citemacro_citep">(Frantar et al., <a class="ltx_ref" href="#bib.bib13" title="">2022</a>; Dettmers et al., <a class="ltx_ref" href="#bib.bib8" title="">2022</a>; Xiao et al., <a class="ltx_ref" href="#bib.bib57" title="">2022</a>; Kim et al., <a class="ltx_ref" href="#bib.bib21" title="">2023b</a>; Lin et al., <a class="ltx_ref" href="#bib.bib31" title="">2023</a>; Dettmers et al., <a class="ltx_ref" href="#bib.bib10" title="">2023b</a>; Shao et al., <a class="ltx_ref" href="#bib.bib43" title="">2023</a>, <span class="ltx_text ltx_font_italic" id="S2.SS2.p1.5.1.1">inter alia</span>)</cite>를 얻기 위해 교정 샘플들을 사용하는 데이터 인식 전략을 채용한다.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.19" class="ltx_p">Our approach relies on the recently proposed NormalFloat (NF) quantization scheme <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et&nbsp;al., <a href="#bib.bib9" title="" class="ltx_ref">2023a</a>)</cite>, which exploits the fact that the distribution of the weights of a trained model is approximately Gaussian. Following the presentation from <cite class="ltx_cite ltx_citemacro_citet">Yoshida (<a href="#bib.bib62" title="" class="ltx_ref">2023</a>)</cite>, NF quantization calculates <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="2^{b-1}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msup id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mn id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">2</mn><mrow id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml"><mi id="S2.SS2.p2.1.m1.1.1.3.2" xref="S2.SS2.p2.1.m1.1.1.3.2.cmml">b</mi><mo id="S2.SS2.p2.1.m1.1.1.3.1" xref="S2.SS2.p2.1.m1.1.1.3.1.cmml">−</mo><mn id="S2.SS2.p2.1.m1.1.1.3.3" xref="S2.SS2.p2.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">superscript</csymbol><cn type="integer" id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">2</cn><apply id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3"><minus id="S2.SS2.p2.1.m1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.1.1.3.1"></minus><ci id="S2.SS2.p2.1.m1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.1.1.3.2">𝑏</ci><cn type="integer" id="S2.SS2.p2.1.m1.1.1.3.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">2^{b-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> evenly-spaced values from <math id="S2.SS2.p2.2.m2.2" class="ltx_Math" alttext="[\delta,\frac{1}{2}]" display="inline"><semantics id="S2.SS2.p2.2.m2.2a"><mrow id="S2.SS2.p2.2.m2.2.3.2" xref="S2.SS2.p2.2.m2.2.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.2.m2.2.3.2.1" xref="S2.SS2.p2.2.m2.2.3.1.cmml">[</mo><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">δ</mi><mo id="S2.SS2.p2.2.m2.2.3.2.2" xref="S2.SS2.p2.2.m2.2.3.1.cmml">,</mo><mfrac id="S2.SS2.p2.2.m2.2.2" xref="S2.SS2.p2.2.m2.2.2.cmml"><mn id="S2.SS2.p2.2.m2.2.2.2" xref="S2.SS2.p2.2.m2.2.2.2.cmml">1</mn><mn id="S2.SS2.p2.2.m2.2.2.3" xref="S2.SS2.p2.2.m2.2.2.3.cmml">2</mn></mfrac><mo stretchy="false" id="S2.SS2.p2.2.m2.2.3.2.3" xref="S2.SS2.p2.2.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.2b"><interval closure="closed" id="S2.SS2.p2.2.m2.2.3.1.cmml" xref="S2.SS2.p2.2.m2.2.3.2"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝛿</ci><apply id="S2.SS2.p2.2.m2.2.2.cmml" xref="S2.SS2.p2.2.m2.2.2"><divide id="S2.SS2.p2.2.m2.2.2.1.cmml" xref="S2.SS2.p2.2.m2.2.2"></divide><cn type="integer" id="S2.SS2.p2.2.m2.2.2.2.cmml" xref="S2.SS2.p2.2.m2.2.2.2">1</cn><cn type="integer" id="S2.SS2.p2.2.m2.2.2.3.cmml" xref="S2.SS2.p2.2.m2.2.2.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.2c">[\delta,\frac{1}{2}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.2d">[ italic_δ , divide start_ARG 1 end_ARG start_ARG 2 end_ARG ]</annotation></semantics></math>, and <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="2^{b-1}+1" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><msup id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml"><mn id="S2.SS2.p2.3.m3.1.1.2.2" xref="S2.SS2.p2.3.m3.1.1.2.2.cmml">2</mn><mrow id="S2.SS2.p2.3.m3.1.1.2.3" xref="S2.SS2.p2.3.m3.1.1.2.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2.3.2" xref="S2.SS2.p2.3.m3.1.1.2.3.2.cmml">b</mi><mo id="S2.SS2.p2.3.m3.1.1.2.3.1" xref="S2.SS2.p2.3.m3.1.1.2.3.1.cmml">−</mo><mn id="S2.SS2.p2.3.m3.1.1.2.3.3" xref="S2.SS2.p2.3.m3.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S2.SS2.p2.3.m3.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.cmml">+</mo><mn id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><plus id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1"></plus><apply id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.1.2">superscript</csymbol><cn type="integer" id="S2.SS2.p2.3.m3.1.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2.2">2</cn><apply id="S2.SS2.p2.3.m3.1.1.2.3.cmml" xref="S2.SS2.p2.3.m3.1.1.2.3"><minus id="S2.SS2.p2.3.m3.1.1.2.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.2.3.1"></minus><ci id="S2.SS2.p2.3.m3.1.1.2.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2.3.2">𝑏</ci><cn type="integer" id="S2.SS2.p2.3.m3.1.1.2.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.2.3.3">1</cn></apply></apply><cn type="integer" id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">2^{b-1}+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT + 1</annotation></semantics></math> evenly-spaced values from <math id="S2.SS2.p2.4.m4.2" class="ltx_Math" alttext="[\frac{1}{2},1-\delta]" display="inline"><semantics id="S2.SS2.p2.4.m4.2a"><mrow id="S2.SS2.p2.4.m4.2.2.1" xref="S2.SS2.p2.4.m4.2.2.2.cmml"><mo stretchy="false" id="S2.SS2.p2.4.m4.2.2.1.2" xref="S2.SS2.p2.4.m4.2.2.2.cmml">[</mo><mfrac id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mn id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">1</mn><mn id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">2</mn></mfrac><mo id="S2.SS2.p2.4.m4.2.2.1.3" xref="S2.SS2.p2.4.m4.2.2.2.cmml">,</mo><mrow id="S2.SS2.p2.4.m4.2.2.1.1" xref="S2.SS2.p2.4.m4.2.2.1.1.cmml"><mn id="S2.SS2.p2.4.m4.2.2.1.1.2" xref="S2.SS2.p2.4.m4.2.2.1.1.2.cmml">1</mn><mo id="S2.SS2.p2.4.m4.2.2.1.1.1" xref="S2.SS2.p2.4.m4.2.2.1.1.1.cmml">−</mo><mi id="S2.SS2.p2.4.m4.2.2.1.1.3" xref="S2.SS2.p2.4.m4.2.2.1.1.3.cmml">δ</mi></mrow><mo stretchy="false" id="S2.SS2.p2.4.m4.2.2.1.4" xref="S2.SS2.p2.4.m4.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.2b"><interval closure="closed" id="S2.SS2.p2.4.m4.2.2.2.cmml" xref="S2.SS2.p2.4.m4.2.2.1"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><divide id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"></divide><cn type="integer" id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">1</cn><cn type="integer" id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">2</cn></apply><apply id="S2.SS2.p2.4.m4.2.2.1.1.cmml" xref="S2.SS2.p2.4.m4.2.2.1.1"><minus id="S2.SS2.p2.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.p2.4.m4.2.2.1.1.1"></minus><cn type="integer" id="S2.SS2.p2.4.m4.2.2.1.1.2.cmml" xref="S2.SS2.p2.4.m4.2.2.1.1.2">1</cn><ci id="S2.SS2.p2.4.m4.2.2.1.1.3.cmml" xref="S2.SS2.p2.4.m4.2.2.1.1.3">𝛿</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.2c">[\frac{1}{2},1-\delta]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.2d">[ divide start_ARG 1 end_ARG start_ARG 2 end_ARG , 1 - italic_δ ]</annotation></semantics></math>, where <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="\delta=\frac{1}{2}(\frac{1}{30}+\frac{1}{32})" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mrow id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">δ</mi><mo id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">=</mo><mrow id="S2.SS2.p2.5.m5.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.cmml"><mfrac id="S2.SS2.p2.5.m5.1.1.1.3" xref="S2.SS2.p2.5.m5.1.1.1.3.cmml"><mn id="S2.SS2.p2.5.m5.1.1.1.3.2" xref="S2.SS2.p2.5.m5.1.1.1.3.2.cmml">1</mn><mn id="S2.SS2.p2.5.m5.1.1.1.3.3" xref="S2.SS2.p2.5.m5.1.1.1.3.3.cmml">2</mn></mfrac><mo id="S2.SS2.p2.5.m5.1.1.1.2" xref="S2.SS2.p2.5.m5.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow id="S2.SS2.p2.5.m5.1.1.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.5.m5.1.1.1.1.1.2" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.5.m5.1.1.1.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.cmml"><mfrac id="S2.SS2.p2.5.m5.1.1.1.1.1.1.2" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.cmml"><mn id="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.2" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.2.cmml">1</mn><mn id="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.3" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.3.cmml">30</mn></mfrac><mo id="S2.SS2.p2.5.m5.1.1.1.1.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.1.cmml">+</mo><mfrac id="S2.SS2.p2.5.m5.1.1.1.1.1.1.3" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.cmml"><mn id="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.2" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.2.cmml">1</mn><mn id="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.3" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.3.cmml">32</mn></mfrac></mrow><mo stretchy="false" id="S2.SS2.p2.5.m5.1.1.1.1.1.3" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><eq id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2"></eq><ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">𝛿</ci><apply id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1"><times id="S2.SS2.p2.5.m5.1.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.2"></times><apply id="S2.SS2.p2.5.m5.1.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.1.3"><divide id="S2.SS2.p2.5.m5.1.1.1.3.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.3"></divide><cn type="integer" id="S2.SS2.p2.5.m5.1.1.1.3.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.3.2">1</cn><cn type="integer" id="S2.SS2.p2.5.m5.1.1.1.3.3.cmml" xref="S2.SS2.p2.5.m5.1.1.1.3.3">2</cn></apply><apply id="S2.SS2.p2.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1"><plus id="S2.SS2.p2.5.m5.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.1"></plus><apply id="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.2"><divide id="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.2"></divide><cn type="integer" id="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.2">1</cn><cn type="integer" id="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.2.3">30</cn></apply><apply id="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.3"><divide id="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.3"></divide><cn type="integer" id="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.2">1</cn><cn type="integer" id="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.1.3.3">32</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">\delta=\frac{1}{2}(\frac{1}{30}+\frac{1}{32})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">italic_δ = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( divide start_ARG 1 end_ARG start_ARG 30 end_ARG + divide start_ARG 1 end_ARG start_ARG 32 end_ARG )</annotation></semantics></math>. This results in <math id="S2.SS2.p2.6.m6.1" class="ltx_Math" alttext="2^{b}" display="inline"><semantics id="S2.SS2.p2.6.m6.1a"><msup id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml"><mn id="S2.SS2.p2.6.m6.1.1.2" xref="S2.SS2.p2.6.m6.1.1.2.cmml">2</mn><mi id="S2.SS2.p2.6.m6.1.1.3" xref="S2.SS2.p2.6.m6.1.1.3.cmml">b</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><apply id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">superscript</csymbol><cn type="integer" id="S2.SS2.p2.6.m6.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1.2">2</cn><ci id="S2.SS2.p2.6.m6.1.1.3.cmml" xref="S2.SS2.p2.6.m6.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">2^{b}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m6.1d">2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT</annotation></semantics></math> probability values <math id="S2.SS2.p2.7.m7.3" class="ltx_Math" alttext="[p_{1},\dots,p_{2^{b}}]" display="inline"><semantics id="S2.SS2.p2.7.m7.3a"><mrow id="S2.SS2.p2.7.m7.3.3.2" xref="S2.SS2.p2.7.m7.3.3.3.cmml"><mo stretchy="false" id="S2.SS2.p2.7.m7.3.3.2.3" xref="S2.SS2.p2.7.m7.3.3.3.cmml">[</mo><msub id="S2.SS2.p2.7.m7.2.2.1.1" xref="S2.SS2.p2.7.m7.2.2.1.1.cmml"><mi id="S2.SS2.p2.7.m7.2.2.1.1.2" xref="S2.SS2.p2.7.m7.2.2.1.1.2.cmml">p</mi><mn id="S2.SS2.p2.7.m7.2.2.1.1.3" xref="S2.SS2.p2.7.m7.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.7.m7.3.3.2.4" xref="S2.SS2.p2.7.m7.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml">…</mi><mo id="S2.SS2.p2.7.m7.3.3.2.5" xref="S2.SS2.p2.7.m7.3.3.3.cmml">,</mo><msub id="S2.SS2.p2.7.m7.3.3.2.2" xref="S2.SS2.p2.7.m7.3.3.2.2.cmml"><mi id="S2.SS2.p2.7.m7.3.3.2.2.2" xref="S2.SS2.p2.7.m7.3.3.2.2.2.cmml">p</mi><msup id="S2.SS2.p2.7.m7.3.3.2.2.3" xref="S2.SS2.p2.7.m7.3.3.2.2.3.cmml"><mn id="S2.SS2.p2.7.m7.3.3.2.2.3.2" xref="S2.SS2.p2.7.m7.3.3.2.2.3.2.cmml">2</mn><mi id="S2.SS2.p2.7.m7.3.3.2.2.3.3" xref="S2.SS2.p2.7.m7.3.3.2.2.3.3.cmml">b</mi></msup></msub><mo stretchy="false" id="S2.SS2.p2.7.m7.3.3.2.6" xref="S2.SS2.p2.7.m7.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.3b"><list id="S2.SS2.p2.7.m7.3.3.3.cmml" xref="S2.SS2.p2.7.m7.3.3.2"><apply id="S2.SS2.p2.7.m7.2.2.1.1.cmml" xref="S2.SS2.p2.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.2.2.1.1.1.cmml" xref="S2.SS2.p2.7.m7.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m7.2.2.1.1.2.cmml" xref="S2.SS2.p2.7.m7.2.2.1.1.2">𝑝</ci><cn type="integer" id="S2.SS2.p2.7.m7.2.2.1.1.3.cmml" xref="S2.SS2.p2.7.m7.2.2.1.1.3">1</cn></apply><ci id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">…</ci><apply id="S2.SS2.p2.7.m7.3.3.2.2.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.3.3.2.2.1.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p2.7.m7.3.3.2.2.2.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2.2">𝑝</ci><apply id="S2.SS2.p2.7.m7.3.3.2.2.3.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.3.3.2.2.3.1.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2.3">superscript</csymbol><cn type="integer" id="S2.SS2.p2.7.m7.3.3.2.2.3.2.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2.3.2">2</cn><ci id="S2.SS2.p2.7.m7.3.3.2.2.3.3.cmml" xref="S2.SS2.p2.7.m7.3.3.2.2.3.3">𝑏</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.3c">[p_{1},\dots,p_{2^{b}}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m7.3d">[ italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math> where <math id="S2.SS2.p2.8.m8.2" class="ltx_Math" alttext="p_{1}=\delta,p_{2^{b-1}}=\frac{1}{2}" display="inline"><semantics id="S2.SS2.p2.8.m8.2a"><mrow id="S2.SS2.p2.8.m8.2.2.2" xref="S2.SS2.p2.8.m8.2.2.3.cmml"><mrow id="S2.SS2.p2.8.m8.1.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.1.cmml"><msub id="S2.SS2.p2.8.m8.1.1.1.1.2" xref="S2.SS2.p2.8.m8.1.1.1.1.2.cmml"><mi id="S2.SS2.p2.8.m8.1.1.1.1.2.2" xref="S2.SS2.p2.8.m8.1.1.1.1.2.2.cmml">p</mi><mn id="S2.SS2.p2.8.m8.1.1.1.1.2.3" xref="S2.SS2.p2.8.m8.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS2.p2.8.m8.1.1.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.cmml">=</mo><mi id="S2.SS2.p2.8.m8.1.1.1.1.3" xref="S2.SS2.p2.8.m8.1.1.1.1.3.cmml">δ</mi></mrow><mo id="S2.SS2.p2.8.m8.2.2.2.3" xref="S2.SS2.p2.8.m8.2.2.3a.cmml">,</mo><mrow id="S2.SS2.p2.8.m8.2.2.2.2" xref="S2.SS2.p2.8.m8.2.2.2.2.cmml"><msub id="S2.SS2.p2.8.m8.2.2.2.2.2" xref="S2.SS2.p2.8.m8.2.2.2.2.2.cmml"><mi id="S2.SS2.p2.8.m8.2.2.2.2.2.2" xref="S2.SS2.p2.8.m8.2.2.2.2.2.2.cmml">p</mi><msup id="S2.SS2.p2.8.m8.2.2.2.2.2.3" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.cmml"><mn id="S2.SS2.p2.8.m8.2.2.2.2.2.3.2" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.2.cmml">2</mn><mrow id="S2.SS2.p2.8.m8.2.2.2.2.2.3.3" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.cmml"><mi id="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.2" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.2.cmml">b</mi><mo id="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.1" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.1.cmml">−</mo><mn id="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.3" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.3.cmml">1</mn></mrow></msup></msub><mo id="S2.SS2.p2.8.m8.2.2.2.2.1" xref="S2.SS2.p2.8.m8.2.2.2.2.1.cmml">=</mo><mfrac id="S2.SS2.p2.8.m8.2.2.2.2.3" xref="S2.SS2.p2.8.m8.2.2.2.2.3.cmml"><mn id="S2.SS2.p2.8.m8.2.2.2.2.3.2" xref="S2.SS2.p2.8.m8.2.2.2.2.3.2.cmml">1</mn><mn id="S2.SS2.p2.8.m8.2.2.2.2.3.3" xref="S2.SS2.p2.8.m8.2.2.2.2.3.3.cmml">2</mn></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.2b"><apply id="S2.SS2.p2.8.m8.2.2.3.cmml" xref="S2.SS2.p2.8.m8.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.2.2.3a.cmml" xref="S2.SS2.p2.8.m8.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p2.8.m8.1.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1"><eq id="S2.SS2.p2.8.m8.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1"></eq><apply id="S2.SS2.p2.8.m8.1.1.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.8.m8.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.2.2">𝑝</ci><cn type="integer" id="S2.SS2.p2.8.m8.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.2.3">1</cn></apply><ci id="S2.SS2.p2.8.m8.1.1.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.3">𝛿</ci></apply><apply id="S2.SS2.p2.8.m8.2.2.2.2.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2"><eq id="S2.SS2.p2.8.m8.2.2.2.2.1.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.1"></eq><apply id="S2.SS2.p2.8.m8.2.2.2.2.2.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.2.2.2.2.2.1.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.8.m8.2.2.2.2.2.2.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2.2">𝑝</ci><apply id="S2.SS2.p2.8.m8.2.2.2.2.2.3.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.2.2.2.2.2.3.1.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3">superscript</csymbol><cn type="integer" id="S2.SS2.p2.8.m8.2.2.2.2.2.3.2.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.2">2</cn><apply id="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.3"><minus id="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.1.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.1"></minus><ci id="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.2.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.2">𝑏</ci><cn type="integer" id="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.3.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S2.SS2.p2.8.m8.2.2.2.2.3.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.3"><divide id="S2.SS2.p2.8.m8.2.2.2.2.3.1.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.3"></divide><cn type="integer" id="S2.SS2.p2.8.m8.2.2.2.2.3.2.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.3.2">1</cn><cn type="integer" id="S2.SS2.p2.8.m8.2.2.2.2.3.3.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.2c">p_{1}=\delta,p_{2^{b-1}}=\frac{1}{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m8.2d">italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_δ , italic_p start_POSTSUBSCRIPT 2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG 2 end_ARG</annotation></semantics></math>, and <math id="S2.SS2.p2.9.m9.1" class="ltx_Math" alttext="p_{2^{b}}=1-\delta" display="inline"><semantics id="S2.SS2.p2.9.m9.1a"><mrow id="S2.SS2.p2.9.m9.1.1" xref="S2.SS2.p2.9.m9.1.1.cmml"><msub id="S2.SS2.p2.9.m9.1.1.2" xref="S2.SS2.p2.9.m9.1.1.2.cmml"><mi id="S2.SS2.p2.9.m9.1.1.2.2" xref="S2.SS2.p2.9.m9.1.1.2.2.cmml">p</mi><msup id="S2.SS2.p2.9.m9.1.1.2.3" xref="S2.SS2.p2.9.m9.1.1.2.3.cmml"><mn id="S2.SS2.p2.9.m9.1.1.2.3.2" xref="S2.SS2.p2.9.m9.1.1.2.3.2.cmml">2</mn><mi id="S2.SS2.p2.9.m9.1.1.2.3.3" xref="S2.SS2.p2.9.m9.1.1.2.3.3.cmml">b</mi></msup></msub><mo id="S2.SS2.p2.9.m9.1.1.1" xref="S2.SS2.p2.9.m9.1.1.1.cmml">=</mo><mrow id="S2.SS2.p2.9.m9.1.1.3" xref="S2.SS2.p2.9.m9.1.1.3.cmml"><mn id="S2.SS2.p2.9.m9.1.1.3.2" xref="S2.SS2.p2.9.m9.1.1.3.2.cmml">1</mn><mo id="S2.SS2.p2.9.m9.1.1.3.1" xref="S2.SS2.p2.9.m9.1.1.3.1.cmml">−</mo><mi id="S2.SS2.p2.9.m9.1.1.3.3" xref="S2.SS2.p2.9.m9.1.1.3.3.cmml">δ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.1b"><apply id="S2.SS2.p2.9.m9.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1"><eq id="S2.SS2.p2.9.m9.1.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1.1"></eq><apply id="S2.SS2.p2.9.m9.1.1.2.cmml" xref="S2.SS2.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.1.1.2.1.cmml" xref="S2.SS2.p2.9.m9.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.9.m9.1.1.2.2.cmml" xref="S2.SS2.p2.9.m9.1.1.2.2">𝑝</ci><apply id="S2.SS2.p2.9.m9.1.1.2.3.cmml" xref="S2.SS2.p2.9.m9.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.1.1.2.3.1.cmml" xref="S2.SS2.p2.9.m9.1.1.2.3">superscript</csymbol><cn type="integer" id="S2.SS2.p2.9.m9.1.1.2.3.2.cmml" xref="S2.SS2.p2.9.m9.1.1.2.3.2">2</cn><ci id="S2.SS2.p2.9.m9.1.1.2.3.3.cmml" xref="S2.SS2.p2.9.m9.1.1.2.3.3">𝑏</ci></apply></apply><apply id="S2.SS2.p2.9.m9.1.1.3.cmml" xref="S2.SS2.p2.9.m9.1.1.3"><minus id="S2.SS2.p2.9.m9.1.1.3.1.cmml" xref="S2.SS2.p2.9.m9.1.1.3.1"></minus><cn type="integer" id="S2.SS2.p2.9.m9.1.1.3.2.cmml" xref="S2.SS2.p2.9.m9.1.1.3.2">1</cn><ci id="S2.SS2.p2.9.m9.1.1.3.3.cmml" xref="S2.SS2.p2.9.m9.1.1.3.3">𝛿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.1c">p_{2^{b}}=1-\delta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.9.m9.1d">italic_p start_POSTSUBSCRIPT 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = 1 - italic_δ</annotation></semantics></math>. These probabilities are converted into quantiles <math id="S2.SS2.p2.10.m10.3" class="ltx_Math" alttext="[q_{1},\dots,q_{2^{b}}]" display="inline"><semantics id="S2.SS2.p2.10.m10.3a"><mrow id="S2.SS2.p2.10.m10.3.3.2" xref="S2.SS2.p2.10.m10.3.3.3.cmml"><mo stretchy="false" id="S2.SS2.p2.10.m10.3.3.2.3" xref="S2.SS2.p2.10.m10.3.3.3.cmml">[</mo><msub id="S2.SS2.p2.10.m10.2.2.1.1" xref="S2.SS2.p2.10.m10.2.2.1.1.cmml"><mi id="S2.SS2.p2.10.m10.2.2.1.1.2" xref="S2.SS2.p2.10.m10.2.2.1.1.2.cmml">q</mi><mn id="S2.SS2.p2.10.m10.2.2.1.1.3" xref="S2.SS2.p2.10.m10.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.10.m10.3.3.2.4" xref="S2.SS2.p2.10.m10.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p2.10.m10.1.1" xref="S2.SS2.p2.10.m10.1.1.cmml">…</mi><mo id="S2.SS2.p2.10.m10.3.3.2.5" xref="S2.SS2.p2.10.m10.3.3.3.cmml">,</mo><msub id="S2.SS2.p2.10.m10.3.3.2.2" xref="S2.SS2.p2.10.m10.3.3.2.2.cmml"><mi id="S2.SS2.p2.10.m10.3.3.2.2.2" xref="S2.SS2.p2.10.m10.3.3.2.2.2.cmml">q</mi><msup id="S2.SS2.p2.10.m10.3.3.2.2.3" xref="S2.SS2.p2.10.m10.3.3.2.2.3.cmml"><mn id="S2.SS2.p2.10.m10.3.3.2.2.3.2" xref="S2.SS2.p2.10.m10.3.3.2.2.3.2.cmml">2</mn><mi id="S2.SS2.p2.10.m10.3.3.2.2.3.3" xref="S2.SS2.p2.10.m10.3.3.2.2.3.3.cmml">b</mi></msup></msub><mo stretchy="false" id="S2.SS2.p2.10.m10.3.3.2.6" xref="S2.SS2.p2.10.m10.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m10.3b"><list id="S2.SS2.p2.10.m10.3.3.3.cmml" xref="S2.SS2.p2.10.m10.3.3.2"><apply id="S2.SS2.p2.10.m10.2.2.1.1.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.2.2.1.1.1.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p2.10.m10.2.2.1.1.2.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1.2">𝑞</ci><cn type="integer" id="S2.SS2.p2.10.m10.2.2.1.1.3.cmml" xref="S2.SS2.p2.10.m10.2.2.1.1.3">1</cn></apply><ci id="S2.SS2.p2.10.m10.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1">…</ci><apply id="S2.SS2.p2.10.m10.3.3.2.2.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.3.3.2.2.1.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p2.10.m10.3.3.2.2.2.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.2">𝑞</ci><apply id="S2.SS2.p2.10.m10.3.3.2.2.3.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.3.3.2.2.3.1.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.3">superscript</csymbol><cn type="integer" id="S2.SS2.p2.10.m10.3.3.2.2.3.2.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.3.2">2</cn><ci id="S2.SS2.p2.10.m10.3.3.2.2.3.3.cmml" xref="S2.SS2.p2.10.m10.3.3.2.2.3.3">𝑏</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m10.3c">[q_{1},\dots,q_{2^{b}}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.10.m10.3d">[ italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_q start_POSTSUBSCRIPT 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math> where <math id="S2.SS2.p2.11.m11.1" class="ltx_Math" alttext="q_{i}=\Phi^{-1}(p_{i})" display="inline"><semantics id="S2.SS2.p2.11.m11.1a"><mrow id="S2.SS2.p2.11.m11.1.1" xref="S2.SS2.p2.11.m11.1.1.cmml"><msub id="S2.SS2.p2.11.m11.1.1.3" xref="S2.SS2.p2.11.m11.1.1.3.cmml"><mi id="S2.SS2.p2.11.m11.1.1.3.2" xref="S2.SS2.p2.11.m11.1.1.3.2.cmml">q</mi><mi id="S2.SS2.p2.11.m11.1.1.3.3" xref="S2.SS2.p2.11.m11.1.1.3.3.cmml">i</mi></msub><mo id="S2.SS2.p2.11.m11.1.1.2" xref="S2.SS2.p2.11.m11.1.1.2.cmml">=</mo><mrow id="S2.SS2.p2.11.m11.1.1.1" xref="S2.SS2.p2.11.m11.1.1.1.cmml"><msup id="S2.SS2.p2.11.m11.1.1.1.3" xref="S2.SS2.p2.11.m11.1.1.1.3.cmml"><mi mathvariant="normal" id="S2.SS2.p2.11.m11.1.1.1.3.2" xref="S2.SS2.p2.11.m11.1.1.1.3.2.cmml">Φ</mi><mrow id="S2.SS2.p2.11.m11.1.1.1.3.3" xref="S2.SS2.p2.11.m11.1.1.1.3.3.cmml"><mo id="S2.SS2.p2.11.m11.1.1.1.3.3a" xref="S2.SS2.p2.11.m11.1.1.1.3.3.cmml">−</mo><mn id="S2.SS2.p2.11.m11.1.1.1.3.3.2" xref="S2.SS2.p2.11.m11.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo id="S2.SS2.p2.11.m11.1.1.1.2" xref="S2.SS2.p2.11.m11.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow id="S2.SS2.p2.11.m11.1.1.1.1.1" xref="S2.SS2.p2.11.m11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.11.m11.1.1.1.1.1.2" xref="S2.SS2.p2.11.m11.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p2.11.m11.1.1.1.1.1.1" xref="S2.SS2.p2.11.m11.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.11.m11.1.1.1.1.1.1.2" xref="S2.SS2.p2.11.m11.1.1.1.1.1.1.2.cmml">p</mi><mi id="S2.SS2.p2.11.m11.1.1.1.1.1.1.3" xref="S2.SS2.p2.11.m11.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS2.p2.11.m11.1.1.1.1.1.3" xref="S2.SS2.p2.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.11.m11.1b"><apply id="S2.SS2.p2.11.m11.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1"><eq id="S2.SS2.p2.11.m11.1.1.2.cmml" xref="S2.SS2.p2.11.m11.1.1.2"></eq><apply id="S2.SS2.p2.11.m11.1.1.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.3.1.cmml" xref="S2.SS2.p2.11.m11.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.3.2.cmml" xref="S2.SS2.p2.11.m11.1.1.3.2">𝑞</ci><ci id="S2.SS2.p2.11.m11.1.1.3.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3.3">𝑖</ci></apply><apply id="S2.SS2.p2.11.m11.1.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1.1"><times id="S2.SS2.p2.11.m11.1.1.1.2.cmml" xref="S2.SS2.p2.11.m11.1.1.1.2"></times><apply id="S2.SS2.p2.11.m11.1.1.1.3.cmml" xref="S2.SS2.p2.11.m11.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.1.3.1.cmml" xref="S2.SS2.p2.11.m11.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.1.3.2.cmml" xref="S2.SS2.p2.11.m11.1.1.1.3.2">Φ</ci><apply id="S2.SS2.p2.11.m11.1.1.1.3.3.cmml" xref="S2.SS2.p2.11.m11.1.1.1.3.3"><minus id="S2.SS2.p2.11.m11.1.1.1.3.3.1.cmml" xref="S2.SS2.p2.11.m11.1.1.1.3.3"></minus><cn type="integer" id="S2.SS2.p2.11.m11.1.1.1.3.3.2.cmml" xref="S2.SS2.p2.11.m11.1.1.1.3.3.2">1</cn></apply></apply><apply id="S2.SS2.p2.11.m11.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.11.m11.1.1.1.1.1.1.2">𝑝</ci><ci id="S2.SS2.p2.11.m11.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.11.m11.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.11.m11.1c">q_{i}=\Phi^{-1}(p_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.11.m11.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = roman_Φ start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is the Gaussian quantile for <math id="S2.SS2.p2.12.m12.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S2.SS2.p2.12.m12.1a"><msub id="S2.SS2.p2.12.m12.1.1" xref="S2.SS2.p2.12.m12.1.1.cmml"><mi id="S2.SS2.p2.12.m12.1.1.2" xref="S2.SS2.p2.12.m12.1.1.2.cmml">p</mi><mi id="S2.SS2.p2.12.m12.1.1.3" xref="S2.SS2.p2.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.12.m12.1b"><apply id="S2.SS2.p2.12.m12.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.12.m12.1.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1">subscript</csymbol><ci id="S2.SS2.p2.12.m12.1.1.2.cmml" xref="S2.SS2.p2.12.m12.1.1.2">𝑝</ci><ci id="S2.SS2.p2.12.m12.1.1.3.cmml" xref="S2.SS2.p2.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.12.m12.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.12.m12.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and these quantiles are normalized to <math id="S2.SS2.p2.13.m13.2" class="ltx_Math" alttext="[-1,1]" display="inline"><semantics id="S2.SS2.p2.13.m13.2a"><mrow id="S2.SS2.p2.13.m13.2.2.1" xref="S2.SS2.p2.13.m13.2.2.2.cmml"><mo stretchy="false" id="S2.SS2.p2.13.m13.2.2.1.2" xref="S2.SS2.p2.13.m13.2.2.2.cmml">[</mo><mrow id="S2.SS2.p2.13.m13.2.2.1.1" xref="S2.SS2.p2.13.m13.2.2.1.1.cmml"><mo id="S2.SS2.p2.13.m13.2.2.1.1a" xref="S2.SS2.p2.13.m13.2.2.1.1.cmml">−</mo><mn id="S2.SS2.p2.13.m13.2.2.1.1.2" xref="S2.SS2.p2.13.m13.2.2.1.1.2.cmml">1</mn></mrow><mo id="S2.SS2.p2.13.m13.2.2.1.3" xref="S2.SS2.p2.13.m13.2.2.2.cmml">,</mo><mn id="S2.SS2.p2.13.m13.1.1" xref="S2.SS2.p2.13.m13.1.1.cmml">1</mn><mo stretchy="false" id="S2.SS2.p2.13.m13.2.2.1.4" xref="S2.SS2.p2.13.m13.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.13.m13.2b"><interval closure="closed" id="S2.SS2.p2.13.m13.2.2.2.cmml" xref="S2.SS2.p2.13.m13.2.2.1"><apply id="S2.SS2.p2.13.m13.2.2.1.1.cmml" xref="S2.SS2.p2.13.m13.2.2.1.1"><minus id="S2.SS2.p2.13.m13.2.2.1.1.1.cmml" xref="S2.SS2.p2.13.m13.2.2.1.1"></minus><cn type="integer" id="S2.SS2.p2.13.m13.2.2.1.1.2.cmml" xref="S2.SS2.p2.13.m13.2.2.1.1.2">1</cn></apply><cn type="integer" id="S2.SS2.p2.13.m13.1.1.cmml" xref="S2.SS2.p2.13.m13.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.13.m13.2c">[-1,1]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.13.m13.2d">[ - 1 , 1 ]</annotation></semantics></math> by <math id="S2.SS2.p2.14.m14.1" class="ltx_Math" alttext="\tilde{q}_{i}=\frac{q_{i}}{q_{2^{b}}}" display="inline"><semantics id="S2.SS2.p2.14.m14.1a"><mrow id="S2.SS2.p2.14.m14.1.1" xref="S2.SS2.p2.14.m14.1.1.cmml"><msub id="S2.SS2.p2.14.m14.1.1.2" xref="S2.SS2.p2.14.m14.1.1.2.cmml"><mover accent="true" id="S2.SS2.p2.14.m14.1.1.2.2" xref="S2.SS2.p2.14.m14.1.1.2.2.cmml"><mi id="S2.SS2.p2.14.m14.1.1.2.2.2" xref="S2.SS2.p2.14.m14.1.1.2.2.2.cmml">q</mi><mo id="S2.SS2.p2.14.m14.1.1.2.2.1" xref="S2.SS2.p2.14.m14.1.1.2.2.1.cmml">~</mo></mover><mi id="S2.SS2.p2.14.m14.1.1.2.3" xref="S2.SS2.p2.14.m14.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS2.p2.14.m14.1.1.1" xref="S2.SS2.p2.14.m14.1.1.1.cmml">=</mo><mfrac id="S2.SS2.p2.14.m14.1.1.3" xref="S2.SS2.p2.14.m14.1.1.3.cmml"><msub id="S2.SS2.p2.14.m14.1.1.3.2" xref="S2.SS2.p2.14.m14.1.1.3.2.cmml"><mi id="S2.SS2.p2.14.m14.1.1.3.2.2" xref="S2.SS2.p2.14.m14.1.1.3.2.2.cmml">q</mi><mi id="S2.SS2.p2.14.m14.1.1.3.2.3" xref="S2.SS2.p2.14.m14.1.1.3.2.3.cmml">i</mi></msub><msub id="S2.SS2.p2.14.m14.1.1.3.3" xref="S2.SS2.p2.14.m14.1.1.3.3.cmml"><mi id="S2.SS2.p2.14.m14.1.1.3.3.2" xref="S2.SS2.p2.14.m14.1.1.3.3.2.cmml">q</mi><msup id="S2.SS2.p2.14.m14.1.1.3.3.3" xref="S2.SS2.p2.14.m14.1.1.3.3.3.cmml"><mn id="S2.SS2.p2.14.m14.1.1.3.3.3.2" xref="S2.SS2.p2.14.m14.1.1.3.3.3.2.cmml">2</mn><mi id="S2.SS2.p2.14.m14.1.1.3.3.3.3" xref="S2.SS2.p2.14.m14.1.1.3.3.3.3.cmml">b</mi></msup></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.14.m14.1b"><apply id="S2.SS2.p2.14.m14.1.1.cmml" xref="S2.SS2.p2.14.m14.1.1"><eq id="S2.SS2.p2.14.m14.1.1.1.cmml" xref="S2.SS2.p2.14.m14.1.1.1"></eq><apply id="S2.SS2.p2.14.m14.1.1.2.cmml" xref="S2.SS2.p2.14.m14.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m14.1.1.2.1.cmml" xref="S2.SS2.p2.14.m14.1.1.2">subscript</csymbol><apply id="S2.SS2.p2.14.m14.1.1.2.2.cmml" xref="S2.SS2.p2.14.m14.1.1.2.2"><ci id="S2.SS2.p2.14.m14.1.1.2.2.1.cmml" xref="S2.SS2.p2.14.m14.1.1.2.2.1">~</ci><ci id="S2.SS2.p2.14.m14.1.1.2.2.2.cmml" xref="S2.SS2.p2.14.m14.1.1.2.2.2">𝑞</ci></apply><ci id="S2.SS2.p2.14.m14.1.1.2.3.cmml" xref="S2.SS2.p2.14.m14.1.1.2.3">𝑖</ci></apply><apply id="S2.SS2.p2.14.m14.1.1.3.cmml" xref="S2.SS2.p2.14.m14.1.1.3"><divide id="S2.SS2.p2.14.m14.1.1.3.1.cmml" xref="S2.SS2.p2.14.m14.1.1.3"></divide><apply id="S2.SS2.p2.14.m14.1.1.3.2.cmml" xref="S2.SS2.p2.14.m14.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m14.1.1.3.2.1.cmml" xref="S2.SS2.p2.14.m14.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p2.14.m14.1.1.3.2.2.cmml" xref="S2.SS2.p2.14.m14.1.1.3.2.2">𝑞</ci><ci id="S2.SS2.p2.14.m14.1.1.3.2.3.cmml" xref="S2.SS2.p2.14.m14.1.1.3.2.3">𝑖</ci></apply><apply id="S2.SS2.p2.14.m14.1.1.3.3.cmml" xref="S2.SS2.p2.14.m14.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m14.1.1.3.3.1.cmml" xref="S2.SS2.p2.14.m14.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p2.14.m14.1.1.3.3.2.cmml" xref="S2.SS2.p2.14.m14.1.1.3.3.2">𝑞</ci><apply id="S2.SS2.p2.14.m14.1.1.3.3.3.cmml" xref="S2.SS2.p2.14.m14.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m14.1.1.3.3.3.1.cmml" xref="S2.SS2.p2.14.m14.1.1.3.3.3">superscript</csymbol><cn type="integer" id="S2.SS2.p2.14.m14.1.1.3.3.3.2.cmml" xref="S2.SS2.p2.14.m14.1.1.3.3.3.2">2</cn><ci id="S2.SS2.p2.14.m14.1.1.3.3.3.3.cmml" xref="S2.SS2.p2.14.m14.1.1.3.3.3.3">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.14.m14.1c">\tilde{q}_{i}=\frac{q_{i}}{q_{2^{b}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.14.m14.1d">over~ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_q start_POSTSUBSCRIPT 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>. Then, given a block of weights <math id="S2.SS2.p2.15.m15.3" class="ltx_Math" alttext="\mathbf{u}=[u_{1},\dots,u_{B}]" display="inline"><semantics id="S2.SS2.p2.15.m15.3a"><mrow id="S2.SS2.p2.15.m15.3.3" xref="S2.SS2.p2.15.m15.3.3.cmml"><mi id="S2.SS2.p2.15.m15.3.3.4" xref="S2.SS2.p2.15.m15.3.3.4.cmml">𝐮</mi><mo id="S2.SS2.p2.15.m15.3.3.3" xref="S2.SS2.p2.15.m15.3.3.3.cmml">=</mo><mrow id="S2.SS2.p2.15.m15.3.3.2.2" xref="S2.SS2.p2.15.m15.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p2.15.m15.3.3.2.2.3" xref="S2.SS2.p2.15.m15.3.3.2.3.cmml">[</mo><msub id="S2.SS2.p2.15.m15.2.2.1.1.1" xref="S2.SS2.p2.15.m15.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.15.m15.2.2.1.1.1.2" xref="S2.SS2.p2.15.m15.2.2.1.1.1.2.cmml">u</mi><mn id="S2.SS2.p2.15.m15.2.2.1.1.1.3" xref="S2.SS2.p2.15.m15.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.15.m15.3.3.2.2.4" xref="S2.SS2.p2.15.m15.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p2.15.m15.1.1" xref="S2.SS2.p2.15.m15.1.1.cmml">…</mi><mo id="S2.SS2.p2.15.m15.3.3.2.2.5" xref="S2.SS2.p2.15.m15.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p2.15.m15.3.3.2.2.2" xref="S2.SS2.p2.15.m15.3.3.2.2.2.cmml"><mi id="S2.SS2.p2.15.m15.3.3.2.2.2.2" xref="S2.SS2.p2.15.m15.3.3.2.2.2.2.cmml">u</mi><mi id="S2.SS2.p2.15.m15.3.3.2.2.2.3" xref="S2.SS2.p2.15.m15.3.3.2.2.2.3.cmml">B</mi></msub><mo stretchy="false" id="S2.SS2.p2.15.m15.3.3.2.2.6" xref="S2.SS2.p2.15.m15.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.15.m15.3b"><apply id="S2.SS2.p2.15.m15.3.3.cmml" xref="S2.SS2.p2.15.m15.3.3"><eq id="S2.SS2.p2.15.m15.3.3.3.cmml" xref="S2.SS2.p2.15.m15.3.3.3"></eq><ci id="S2.SS2.p2.15.m15.3.3.4.cmml" xref="S2.SS2.p2.15.m15.3.3.4">𝐮</ci><list id="S2.SS2.p2.15.m15.3.3.2.3.cmml" xref="S2.SS2.p2.15.m15.3.3.2.2"><apply id="S2.SS2.p2.15.m15.2.2.1.1.1.cmml" xref="S2.SS2.p2.15.m15.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.15.m15.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.15.m15.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.15.m15.2.2.1.1.1.2">𝑢</ci><cn type="integer" id="S2.SS2.p2.15.m15.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.15.m15.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p2.15.m15.1.1.cmml" xref="S2.SS2.p2.15.m15.1.1">…</ci><apply id="S2.SS2.p2.15.m15.3.3.2.2.2.cmml" xref="S2.SS2.p2.15.m15.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.15.m15.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.15.m15.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.15.m15.3.3.2.2.2.2">𝑢</ci><ci id="S2.SS2.p2.15.m15.3.3.2.2.2.3.cmml" xref="S2.SS2.p2.15.m15.3.3.2.2.2.3">𝐵</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.15.m15.3c">\mathbf{u}=[u_{1},\dots,u_{B}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.15.m15.3d">bold_u = [ italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ]</annotation></semantics></math> and the absmax value <math id="S2.SS2.p2.16.m16.3" class="ltx_Math" alttext="s=\max(|\mathbf{u}|)" display="inline"><semantics id="S2.SS2.p2.16.m16.3a"><mrow id="S2.SS2.p2.16.m16.3.3" xref="S2.SS2.p2.16.m16.3.3.cmml"><mi id="S2.SS2.p2.16.m16.3.3.3" xref="S2.SS2.p2.16.m16.3.3.3.cmml">s</mi><mo id="S2.SS2.p2.16.m16.3.3.2" xref="S2.SS2.p2.16.m16.3.3.2.cmml">=</mo><mrow id="S2.SS2.p2.16.m16.3.3.1.1" xref="S2.SS2.p2.16.m16.3.3.1.2.cmml"><mi id="S2.SS2.p2.16.m16.2.2" xref="S2.SS2.p2.16.m16.2.2.cmml">max</mi><mo id="S2.SS2.p2.16.m16.3.3.1.1a" xref="S2.SS2.p2.16.m16.3.3.1.2.cmml">⁡</mo><mrow id="S2.SS2.p2.16.m16.3.3.1.1.1" xref="S2.SS2.p2.16.m16.3.3.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.16.m16.3.3.1.1.1.2" xref="S2.SS2.p2.16.m16.3.3.1.2.cmml">(</mo><mrow id="S2.SS2.p2.16.m16.3.3.1.1.1.1.2" xref="S2.SS2.p2.16.m16.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.16.m16.3.3.1.1.1.1.2.1" xref="S2.SS2.p2.16.m16.3.3.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p2.16.m16.1.1" xref="S2.SS2.p2.16.m16.1.1.cmml">𝐮</mi><mo stretchy="false" id="S2.SS2.p2.16.m16.3.3.1.1.1.1.2.2" xref="S2.SS2.p2.16.m16.3.3.1.1.1.1.1.1.cmml">|</mo></mrow><mo stretchy="false" id="S2.SS2.p2.16.m16.3.3.1.1.1.3" xref="S2.SS2.p2.16.m16.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.16.m16.3b"><apply id="S2.SS2.p2.16.m16.3.3.cmml" xref="S2.SS2.p2.16.m16.3.3"><eq id="S2.SS2.p2.16.m16.3.3.2.cmml" xref="S2.SS2.p2.16.m16.3.3.2"></eq><ci id="S2.SS2.p2.16.m16.3.3.3.cmml" xref="S2.SS2.p2.16.m16.3.3.3">𝑠</ci><apply id="S2.SS2.p2.16.m16.3.3.1.2.cmml" xref="S2.SS2.p2.16.m16.3.3.1.1"><max id="S2.SS2.p2.16.m16.2.2.cmml" xref="S2.SS2.p2.16.m16.2.2"></max><apply id="S2.SS2.p2.16.m16.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p2.16.m16.3.3.1.1.1.1.2"><abs id="S2.SS2.p2.16.m16.3.3.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.16.m16.3.3.1.1.1.1.2.1"></abs><ci id="S2.SS2.p2.16.m16.1.1.cmml" xref="S2.SS2.p2.16.m16.1.1">𝐮</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.16.m16.3c">s=\max(|\mathbf{u}|)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.16.m16.3d">italic_s = roman_max ( | bold_u | )</annotation></semantics></math> for that block, the weights <math id="S2.SS2.p2.17.m17.1" class="ltx_Math" alttext="u_{j}" display="inline"><semantics id="S2.SS2.p2.17.m17.1a"><msub id="S2.SS2.p2.17.m17.1.1" xref="S2.SS2.p2.17.m17.1.1.cmml"><mi id="S2.SS2.p2.17.m17.1.1.2" xref="S2.SS2.p2.17.m17.1.1.2.cmml">u</mi><mi id="S2.SS2.p2.17.m17.1.1.3" xref="S2.SS2.p2.17.m17.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.17.m17.1b"><apply id="S2.SS2.p2.17.m17.1.1.cmml" xref="S2.SS2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.17.m17.1.1.1.cmml" xref="S2.SS2.p2.17.m17.1.1">subscript</csymbol><ci id="S2.SS2.p2.17.m17.1.1.2.cmml" xref="S2.SS2.p2.17.m17.1.1.2">𝑢</ci><ci id="S2.SS2.p2.17.m17.1.1.3.cmml" xref="S2.SS2.p2.17.m17.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.17.m17.1c">u_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.17.m17.1d">italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in this block are quantized to the nearest quantile <math id="S2.SS2.p2.18.m18.1" class="ltx_Math" alttext="c_{j}" display="inline"><semantics id="S2.SS2.p2.18.m18.1a"><msub id="S2.SS2.p2.18.m18.1.1" xref="S2.SS2.p2.18.m18.1.1.cmml"><mi id="S2.SS2.p2.18.m18.1.1.2" xref="S2.SS2.p2.18.m18.1.1.2.cmml">c</mi><mi id="S2.SS2.p2.18.m18.1.1.3" xref="S2.SS2.p2.18.m18.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.18.m18.1b"><apply id="S2.SS2.p2.18.m18.1.1.cmml" xref="S2.SS2.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.18.m18.1.1.1.cmml" xref="S2.SS2.p2.18.m18.1.1">subscript</csymbol><ci id="S2.SS2.p2.18.m18.1.1.2.cmml" xref="S2.SS2.p2.18.m18.1.1.2">𝑐</ci><ci id="S2.SS2.p2.18.m18.1.1.3.cmml" xref="S2.SS2.p2.18.m18.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.18.m18.1c">c_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.18.m18.1d">italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, i.e., <math id="S2.SS2.p2.19.m19.4" class="ltx_Math" alttext="c_{j}=\operatornamewithlimits{arg\,min}_{i\in\{1,\dots,2^{b}\}}\left|\tilde{q_{i}}-\frac{u_{j}}{s}\right|" display="inline"><semantics id="S2.SS2.p2.19.m19.4a"><mrow id="S2.SS2.p2.19.m19.4.4" xref="S2.SS2.p2.19.m19.4.4.cmml"><msub id="S2.SS2.p2.19.m19.4.4.3" xref="S2.SS2.p2.19.m19.4.4.3.cmml"><mi id="S2.SS2.p2.19.m19.4.4.3.2" xref="S2.SS2.p2.19.m19.4.4.3.2.cmml">c</mi><mi id="S2.SS2.p2.19.m19.4.4.3.3" xref="S2.SS2.p2.19.m19.4.4.3.3.cmml">j</mi></msub><mo id="S2.SS2.p2.19.m19.4.4.2" xref="S2.SS2.p2.19.m19.4.4.2.cmml">=</mo><mrow id="S2.SS2.p2.19.m19.4.4.1" xref="S2.SS2.p2.19.m19.4.4.1.cmml"><munder id="S2.SS2.p2.19.m19.4.4.1.2" xref="S2.SS2.p2.19.m19.4.4.1.2.cmml"><mrow id="S2.SS2.p2.19.m19.4.4.1.2.2" xref="S2.SS2.p2.19.m19.4.4.1.2.2.cmml"><mi id="S2.SS2.p2.19.m19.4.4.1.2.2.2" xref="S2.SS2.p2.19.m19.4.4.1.2.2.2.cmml">arg</mi><mo lspace="0.170em" id="S2.SS2.p2.19.m19.4.4.1.2.2.1" xref="S2.SS2.p2.19.m19.4.4.1.2.2.1.cmml" rspace="0px"></mo><mi id="S2.SS2.p2.19.m19.4.4.1.2.2.3" xref="S2.SS2.p2.19.m19.4.4.1.2.2.3.cmml">min</mi></mrow><mrow id="S2.SS2.p2.19.m19.3.3.3" xref="S2.SS2.p2.19.m19.3.3.3.cmml"><mi id="S2.SS2.p2.19.m19.3.3.3.5" xref="S2.SS2.p2.19.m19.3.3.3.5.cmml">i</mi><mo id="S2.SS2.p2.19.m19.3.3.3.4" xref="S2.SS2.p2.19.m19.3.3.3.4.cmml">∈</mo><mrow id="S2.SS2.p2.19.m19.3.3.3.3.1" xref="S2.SS2.p2.19.m19.3.3.3.3.2.cmml"><mo stretchy="false" id="S2.SS2.p2.19.m19.3.3.3.3.1.2" xref="S2.SS2.p2.19.m19.3.3.3.3.2.cmml">{</mo><mn id="S2.SS2.p2.19.m19.1.1.1.1" xref="S2.SS2.p2.19.m19.1.1.1.1.cmml">1</mn><mo id="S2.SS2.p2.19.m19.3.3.3.3.1.3" xref="S2.SS2.p2.19.m19.3.3.3.3.2.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p2.19.m19.2.2.2.2" xref="S2.SS2.p2.19.m19.2.2.2.2.cmml">…</mi><mo id="S2.SS2.p2.19.m19.3.3.3.3.1.4" xref="S2.SS2.p2.19.m19.3.3.3.3.2.cmml">,</mo><msup id="S2.SS2.p2.19.m19.3.3.3.3.1.1" xref="S2.SS2.p2.19.m19.3.3.3.3.1.1.cmml"><mn id="S2.SS2.p2.19.m19.3.3.3.3.1.1.2" xref="S2.SS2.p2.19.m19.3.3.3.3.1.1.2.cmml">2</mn><mi id="S2.SS2.p2.19.m19.3.3.3.3.1.1.3" xref="S2.SS2.p2.19.m19.3.3.3.3.1.1.3.cmml">b</mi></msup><mo stretchy="false" id="S2.SS2.p2.19.m19.3.3.3.3.1.5" xref="S2.SS2.p2.19.m19.3.3.3.3.2.cmml">}</mo></mrow></mrow></munder><mo id="S2.SS2.p2.19.m19.4.4.1a" xref="S2.SS2.p2.19.m19.4.4.1.cmml">⁡</mo><mrow id="S2.SS2.p2.19.m19.4.4.1.1.1" xref="S2.SS2.p2.19.m19.4.4.1.1.2.cmml"><mo id="S2.SS2.p2.19.m19.4.4.1.1.1.2" xref="S2.SS2.p2.19.m19.4.4.1.1.2.1.cmml">|</mo><mrow id="S2.SS2.p2.19.m19.4.4.1.1.1.1" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.cmml"><mover accent="true" id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.cmml"><msub id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.cmml"><mi id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.2" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.2.cmml">q</mi><mi id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.3" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.1" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.1.cmml">~</mo></mover><mo id="S2.SS2.p2.19.m19.4.4.1.1.1.1.1" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.1.cmml">−</mo><mfrac id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.cmml"><msub id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.cmml"><mi id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.2" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.2.cmml">u</mi><mi id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.3" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.3.cmml">j</mi></msub><mi id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.3" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.3.cmml">s</mi></mfrac></mrow><mo id="S2.SS2.p2.19.m19.4.4.1.1.1.3" xref="S2.SS2.p2.19.m19.4.4.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.19.m19.4b"><apply id="S2.SS2.p2.19.m19.4.4.cmml" xref="S2.SS2.p2.19.m19.4.4"><eq id="S2.SS2.p2.19.m19.4.4.2.cmml" xref="S2.SS2.p2.19.m19.4.4.2"></eq><apply id="S2.SS2.p2.19.m19.4.4.3.cmml" xref="S2.SS2.p2.19.m19.4.4.3"><csymbol cd="ambiguous" id="S2.SS2.p2.19.m19.4.4.3.1.cmml" xref="S2.SS2.p2.19.m19.4.4.3">subscript</csymbol><ci id="S2.SS2.p2.19.m19.4.4.3.2.cmml" xref="S2.SS2.p2.19.m19.4.4.3.2">𝑐</ci><ci id="S2.SS2.p2.19.m19.4.4.3.3.cmml" xref="S2.SS2.p2.19.m19.4.4.3.3">𝑗</ci></apply><apply id="S2.SS2.p2.19.m19.4.4.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1"><apply id="S2.SS2.p2.19.m19.4.4.1.2.cmml" xref="S2.SS2.p2.19.m19.4.4.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.19.m19.4.4.1.2.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1.2">subscript</csymbol><apply id="S2.SS2.p2.19.m19.4.4.1.2.2.cmml" xref="S2.SS2.p2.19.m19.4.4.1.2.2"><times id="S2.SS2.p2.19.m19.4.4.1.2.2.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1.2.2.1"></times><ci id="S2.SS2.p2.19.m19.4.4.1.2.2.2.cmml" xref="S2.SS2.p2.19.m19.4.4.1.2.2.2">arg</ci><ci id="S2.SS2.p2.19.m19.4.4.1.2.2.3.cmml" xref="S2.SS2.p2.19.m19.4.4.1.2.2.3">min</ci></apply><apply id="S2.SS2.p2.19.m19.3.3.3.cmml" xref="S2.SS2.p2.19.m19.3.3.3"><in id="S2.SS2.p2.19.m19.3.3.3.4.cmml" xref="S2.SS2.p2.19.m19.3.3.3.4"></in><ci id="S2.SS2.p2.19.m19.3.3.3.5.cmml" xref="S2.SS2.p2.19.m19.3.3.3.5">𝑖</ci><set id="S2.SS2.p2.19.m19.3.3.3.3.2.cmml" xref="S2.SS2.p2.19.m19.3.3.3.3.1"><cn type="integer" id="S2.SS2.p2.19.m19.1.1.1.1.cmml" xref="S2.SS2.p2.19.m19.1.1.1.1">1</cn><ci id="S2.SS2.p2.19.m19.2.2.2.2.cmml" xref="S2.SS2.p2.19.m19.2.2.2.2">…</ci><apply id="S2.SS2.p2.19.m19.3.3.3.3.1.1.cmml" xref="S2.SS2.p2.19.m19.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.19.m19.3.3.3.3.1.1.1.cmml" xref="S2.SS2.p2.19.m19.3.3.3.3.1.1">superscript</csymbol><cn type="integer" id="S2.SS2.p2.19.m19.3.3.3.3.1.1.2.cmml" xref="S2.SS2.p2.19.m19.3.3.3.3.1.1.2">2</cn><ci id="S2.SS2.p2.19.m19.3.3.3.3.1.1.3.cmml" xref="S2.SS2.p2.19.m19.3.3.3.3.1.1.3">𝑏</ci></apply></set></apply></apply><apply id="S2.SS2.p2.19.m19.4.4.1.1.2.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1"><abs id="S2.SS2.p2.19.m19.4.4.1.1.2.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.2"></abs><apply id="S2.SS2.p2.19.m19.4.4.1.1.1.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1"><minus id="S2.SS2.p2.19.m19.4.4.1.1.1.1.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.1"></minus><apply id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2"><ci id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.1">~</ci><apply id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.2">𝑞</ci><ci id="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.3.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3"><divide id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3"></divide><apply id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.1.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.2.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.2">𝑢</ci><ci id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.3.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.2.3">𝑗</ci></apply><ci id="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.19.m19.4.4.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.19.m19.4c">c_{j}=\operatornamewithlimits{arg\,min}_{i\in\{1,\dots,2^{b}\}}\left|\tilde{q_{i}}-\frac{u_{j}}{s}\right|</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.19.m19.4d">italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_i ∈ { 1 , … , 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT } end_POSTSUBSCRIPT | over~ start_ARG italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG - divide start_ARG italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG italic_s end_ARG |</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S2.SS2.p3.4"><math alttext="d\times k" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1"><semantics id="S2.SS2.p3.1.m1.1a"><mrow id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml"><mi id="S2.SS2.p3.1.m1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.2.cmml">d</mi><mo id="S2.SS2.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p3.1.m1.1.1.1.cmml">×</mo><mi id="S2.SS2.p3.1.m1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1"><times id="S2.SS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1"></times><ci id="S2.SS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.2">𝑑</ci><ci id="S2.SS2.p3.1.m1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">d\times k</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">italic_d × italic_k</annotation></semantics></math> 행렬의 경우 <math alttext="\frac{dk}{B}" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.1"><semantics id="S2.SS2.p3.2.m2.1a"><mfrac id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml"><mrow id="S2.SS2.p3.2.m2.1.1.2" xref="S2.SS2.p3.2.m2.1.1.2.cmml"><mi id="S2.SS2.p3.2.m2.1.1.2.2" xref="S2.SS2.p3.2.m2.1.1.2.2.cmml">d</mi><mo id="S2.SS2.p3.2.m2.1.1.2.1" lspace="0px" rspace="0px" xref="S2.SS2.p3.2.m2.1.1.2.1.cmml"></mo><mi id="S2.SS2.p3.2.m2.1.1.2.3" xref="S2.SS2.p3.2.m2.1.1.2.3.cmml">k</mi></mrow><mi id="S2.SS2.p3.2.m2.1.1.3" xref="S2.SS2.p3.2.m2.1.1.3.cmml">B</mi></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><apply id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1"><divide id="S2.SS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1"></divide><apply id="S2.SS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.p3.2.m2.1.1.2"><times id="S2.SS2.p3.2.m2.1.1.2.1.cmml" xref="S2.SS2.p3.2.m2.1.1.2.1"></times><ci id="S2.SS2.p3.2.m2.1.1.2.2.cmml" xref="S2.SS2.p3.2.m2.1.1.2.2">𝑑</ci><ci id="S2.SS2.p3.2.m2.1.1.2.3.cmml" xref="S2.SS2.p3.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S2.SS2.p3.2.m2.1.1.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\frac{dk}{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">divide start_ARG italic_d italic_k end_ARG start_ARG italic_B end_ARG</annotation></semantics></math> 블록이 존재하므로 각 블록에 대한 absmax 값 <math alttext="s" class="ltx_Math" display="inline" id="S2.SS2.p3.3.m3.1"><semantics id="S2.SS2.p3.3.m3.1a"><mi id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.3.m3.1d">italic_s</annotation></semantics></math>를 저장하는 것은 작은 블록 크기로 실질적이 될 수 있다. <cite class="ltx_cite ltx_citemacro_citet">Dettmers et al. (<a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite>는 따라서 주어진 행렬에 대한 absmax 값들의 세트 <math alttext="[s_{1},\dots,s_{\frac{dk}{B}}]" class="ltx_Math" display="inline" id="S2.SS2.p3.4.m4.3"><semantics id="S2.SS2.p3.4.m4.3a"><mrow id="S2.SS2.p3.4.m4.3.3.2" xref="S2.SS2.p3.4.m4.3.3.3.cmml"><mo id="S2.SS2.p3.4.m4.3.3.2.3" stretchy="false" xref="S2.SS2.p3.4.m4.3.3.3.cmml">[</mo><msub id="S2.SS2.p3.4.m4.2.2.1.1" xref="S2.SS2.p3.4.m4.2.2.1.1.cmml"><mi id="S2.SS2.p3.4.m4.2.2.1.1.2" xref="S2.SS2.p3.4.m4.2.2.1.1.2.cmml">s</mi><mn id="S2.SS2.p3.4.m4.2.2.1.1.3" xref="S2.SS2.p3.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p3.4.m4.3.3.2.4" xref="S2.SS2.p3.4.m4.3.3.3.cmml">,</mo><mi id="S2.SS2.p3.4.m4.1.1" mathvariant="normal" xref="S2.SS2.p3.4.m4.1.1.cmml">…</mi><mo id="S2.SS2.p3.4.m4.3.3.2.5" xref="S2.SS2.p3.4.m4.3.3.3.cmml">,</mo><msub id="S2.SS2.p3.4.m4.3.3.2.2" xref="S2.SS2.p3.4.m4.3.3.2.2.cmml"><mi id="S2.SS2.p3.4.m4.3.3.2.2.2" xref="S2.SS2.p3.4.m4.3.3.2.2.2.cmml">s</mi><mfrac id="S2.SS2.p3.4.m4.3.3.2.2.3" xref="S2.SS2.p3.4.m4.3.3.2.2.3.cmml"><mrow id="S2.SS2.p3.4.m4.3.3.2.2.3.2" xref="S2.SS2.p3.4.m4.3.3.2.2.3.2.cmml"><mi id="S2.SS2.p3.4.m4.3.3.2.2.3.2.2" xref="S2.SS2.p3.4.m4.3.3.2.2.3.2.2.cmml">d</mi><mo id="S2.SS2.p3.4.m4.3.3.2.2.3.2.1" lspace="0px" rspace="0px" xref="S2.SS2.p3.4.m4.3.3.2.2.3.2.1.cmml"></mo><mi id="S2.SS2.p3.4.m4.3.3.2.2.3.2.3" xref="S2.SS2.p3.4.m4.3.3.2.2.3.2.3.cmml">k</mi></mrow><mi id="S2.SS2.p3.4.m4.3.3.2.2.3.3" xref="S2.SS2.p3.4.m4.3.3.2.2.3.3.cmml">B</mi></mfrac></msub><mo id="S2.SS2.p3.4.m4.3.3.2.6" stretchy="false" xref="S2.SS2.p3.4.m4.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.3b"><list id="S2.SS2.p3.4.m4.3.3.3.cmml" xref="S2.SS2.p3.4.m4.3.3.2"><apply id="S2.SS2.p3.4.m4.2.2.1.1.cmml" xref="S2.SS2.p3.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.p3.4.m4.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p3.4.m4.2.2.1.1.2.cmml" xref="S2.SS2.p3.4.m4.2.2.1.1.2">𝑠</ci><cn id="S2.SS2.p3.4.m4.2.2.1.1.3.cmml" type="integer" xref="S2.SS2.p3.4.m4.2.2.1.1.3">1</cn></apply><ci id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">…</ci><apply id="S2.SS2.p3.4.m4.3.3.2.2.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m4.3.3.2.2.1.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p3.4.m4.3.3.2.2.2.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2.2">𝑠</ci><apply id="S2.SS2.p3.4.m4.3.3.2.2.3.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2.3"><divide id="S2.SS2.p3.4.m4.3.3.2.2.3.1.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2.3"></divide><apply id="S2.SS2.p3.4.m4.3.3.2.2.3.2.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2.3.2"><times id="S2.SS2.p3.4.m4.3.3.2.2.3.2.1.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2.3.2.1"></times><ci id="S2.SS2.p3.4.m4.3.3.2.2.3.2.2.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2.3.2.2">𝑑</ci><ci id="S2.SS2.p3.4.m4.3.3.2.2.3.2.3.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2.3.2.3">𝑘</ci></apply><ci id="S2.SS2.p3.4.m4.3.3.2.2.3.3.cmml" xref="S2.SS2.p3.4.m4.3.3.2.2.3.3">𝐵</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.3c">[s_{1},\dots,s_{\frac{dk}{B}}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.4.m4.3d">[ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT divide start_ARG italic_d italic_k end_ARG start_ARG italic_B end_ARG end_POSTSUBSCRIPT ]</annotation></semantics></math>가 RTN을 통해 다시 양자화되는 이중 양자화 전략을 채용한다. 이 양자화 방식을 기반으로 <cite class="ltx_cite ltx_citemacro_citet">Dettmers et al. (<a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite>는 사전 훈련된 LLM에 대해 4비트로 NF 양자화를 수행하고 저순위 업데이트를 학습하는 QLoRA를 제안한다. QLoRA는 여러 벤치마크에 걸쳐 완전한 미세 조정으로 경쟁력이 있는 것으로 밝혀졌으며 따라서 현재 작업의 주요 기준선 역할을 한다.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method: LQ-LoRA</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.p1.1">이 방법은 사전 학습된 각 행렬을 저순위 행렬과 양자화된 행렬(§<a class="ltx_ref" href="#S3.SS1" title="3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">3.1</span></a>)로 분해하는 간단한 인수분해 기법에 의존하며, 여기서 파인튜닝 동안 저순위 성분만 적응된다. §<a class="ltx_ref" href="#S3.SS2" title="3.2 Mixed-Configuration Quantization via an Integer Linear Program ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">3.2</span></a>에서는 목표 평균 비트율이 주어진 계층에 걸쳐 동적 양자화를 허용하기 위해 정수 선형 프로그래밍을 통해 혼합 양자화 전략을 탐구한다. 우리는 행렬 인수분해(§<a class="ltx_ref" href="#S3.SS3" title="3.3 Data-Aware Matrix Decomposition via Fisher-weighted SVD ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">3.3</span></a>) 동안 재구성 목적에 가중치를 부여하기 위해 경험적 피셔 정보 행렬을 사용하여 LQ-LoRA의 데이터 인식 버전을 추가로 고려한다.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Low-rank Plus Quantized Matrix Decomposition</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS1.p1.8">§<a class="ltx_ref" href="#S2.SS1" title="2.1 Low-rank Adaptation of Large Language Models ‣ 2 Background ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">2.1</span></a>에 언급된 바와 같이, LoRA는 미리 훈련된 매트릭스를 <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_W</annotation></semantics></math>로서 <math alttext="\mathbf{W}+\mathbf{L}_{1}\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">𝐖</mi><mo id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">+</mo><mrow id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml"><msub id="S3.SS1.p1.2.m2.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.3.2.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3.2.2" xref="S3.SS1.p1.2.m2.1.1.3.2.2.cmml">𝐋</mi><mn id="S3.SS1.p1.2.m2.1.1.3.2.3" xref="S3.SS1.p1.2.m2.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.1.1.3.1" lspace="0px" rspace="0px" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml"></mo><msub id="S3.SS1.p1.2.m2.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3.3.2" xref="S3.SS1.p1.2.m2.1.1.3.3.2.cmml">𝐋</mi><mn id="S3.SS1.p1.2.m2.1.1.3.3.3" xref="S3.SS1.p1.2.m2.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><plus id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></plus><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝐖</ci><apply id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><times id="S3.SS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.1"></times><apply id="S3.SS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.3.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.3.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2.2">𝐋</ci><cn id="S3.SS1.p1.2.m2.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1.3.2.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3.2">𝐋</ci><cn id="S3.SS1.p1.2.m2.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathbf{W}+\mathbf{L}_{1}\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">bold_W + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>로 재매개화하고, 파인튜닝 전에 가우시안으로부터 <math alttext="\mathbf{L}_{1}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝐋</mi><mn id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝐋</ci><cn id="S3.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathbf{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>를, <math alttext="\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">𝐋</mi><mn id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝐋</ci><cn id="S3.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>로부터 <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mn id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><cn id="S3.SS1.p1.5.m5.1.1.cmml" type="integer" xref="S3.SS1.p1.5.m5.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">bold_0</annotation></semantics></math>로 초기화한다. 이것은 모델 출력이 파인튜닝의 시작에서 재매개변수화 전과 정확히 동일함을 보장하지만, 낮은 비트로 양자화할 때 <math alttext="\|\mathbf{W}-\operatorname{Quantize}(\mathbf{W})\|_{F}\gg 0" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.3"><semantics id="S3.SS1.p1.7.m7.3a"><mrow id="S3.SS1.p1.7.m7.3.3" xref="S3.SS1.p1.7.m7.3.3.cmml"><msub id="S3.SS1.p1.7.m7.3.3.1" xref="S3.SS1.p1.7.m7.3.3.1.cmml"><mrow id="S3.SS1.p1.7.m7.3.3.1.1.1" xref="S3.SS1.p1.7.m7.3.3.1.1.2.cmml"><mo id="S3.SS1.p1.7.m7.3.3.1.1.1.2" stretchy="false" xref="S3.SS1.p1.7.m7.3.3.1.1.2.1.cmml">‖</mo><mrow id="S3.SS1.p1.7.m7.3.3.1.1.1.1" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.cmml"><mi id="S3.SS1.p1.7.m7.3.3.1.1.1.1.2" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.cmml">𝐖</mi><mo id="S3.SS1.p1.7.m7.3.3.1.1.1.1.1" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.1.cmml">−</mo><mrow id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">Quantize</mi><mo id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2a" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2.1" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.1.cmml"><mo id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2.1.1" stretchy="false" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.1.cmml">(</mo><mi id="S3.SS1.p1.7.m7.2.2" xref="S3.SS1.p1.7.m7.2.2.cmml">𝐖</mi><mo id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2.1.2" stretchy="false" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS1.p1.7.m7.3.3.1.1.1.3" stretchy="false" xref="S3.SS1.p1.7.m7.3.3.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.SS1.p1.7.m7.3.3.1.3" xref="S3.SS1.p1.7.m7.3.3.1.3.cmml">F</mi></msub><mo id="S3.SS1.p1.7.m7.3.3.2" xref="S3.SS1.p1.7.m7.3.3.2.cmml">≫</mo><mn id="S3.SS1.p1.7.m7.3.3.3" xref="S3.SS1.p1.7.m7.3.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.3b"><apply id="S3.SS1.p1.7.m7.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3"><csymbol cd="latexml" id="S3.SS1.p1.7.m7.3.3.2.cmml" xref="S3.SS1.p1.7.m7.3.3.2">much-greater-than</csymbol><apply id="S3.SS1.p1.7.m7.3.3.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.1.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1">subscript</csymbol><apply id="S3.SS1.p1.7.m7.3.3.1.1.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.7.m7.3.3.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.2">norm</csymbol><apply id="S3.SS1.p1.7.m7.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1"><minus id="S3.SS1.p1.7.m7.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.1"></minus><ci id="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.2">𝐖</ci><apply id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">Quantize</ci><ci id="S3.SS1.p1.7.m7.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2">𝐖</ci></apply></apply></apply><ci id="S3.SS1.p1.7.m7.3.3.1.3.cmml" xref="S3.SS1.p1.7.m7.3.3.1.3">𝐹</ci></apply><cn id="S3.SS1.p1.7.m7.3.3.3.cmml" type="integer" xref="S3.SS1.p1.7.m7.3.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.3c">\|\mathbf{W}-\operatorname{Quantize}(\mathbf{W})\|_{F}\gg 0</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.3d">∥ bold_W - roman_Quantize ( bold_W ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ≫ 0</annotation></semantics></math>를 가질 수 있기 때문에 <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">bold_W</annotation></semantics></math>의 양자화된 버전으로 작업할 때 문제를 제시할 수 있다. 이 초기화는 적응할 하위 공간을 결정할 때 <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">bold_W</annotation></semantics></math>의 구조를 고려하지 않는다. 이 문제를 행렬 인수분해의 관점에서 접근하여 원래 행렬을 쉽게 양자화할 수 있는 성분과 고분산 방향을 포착하는 저순위 성분으로 인수분해하고,</p>
<table id="S3.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\operatornamewithlimits{arg\,min}_{\mathbf{Q},\mathbf{L}_{1},\mathbf{L}_{2}}\,\|\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2})\|_{F}," display="inline"><semantics id="S3.E1X.2.1.1.m1.4a"><mrow id="S3.E1X.2.1.1.m1.4.4.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E1X.2.1.1.m1.4.4.1.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.cmml"><munder id="S3.E1X.2.1.1.m1.4.4.1.1.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.2.cmml"><mrow id="S3.E1X.2.1.1.m1.4.4.1.1.2.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.2.2.cmml"><mi id="S3.E1X.2.1.1.m1.4.4.1.1.2.2.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.2.2.2.cmml">arg</mi><mo lspace="0.170em" id="S3.E1X.2.1.1.m1.4.4.1.1.2.2.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.2.2.1.cmml" rspace="0px"></mo><mi id="S3.E1X.2.1.1.m1.4.4.1.1.2.2.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.2.2.3.cmml">min</mi></mrow><mrow id="S3.E1X.2.1.1.m1.3.3.3.3" xref="S3.E1X.2.1.1.m1.3.3.3.4.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.1.cmml">𝐐</mi><mo id="S3.E1X.2.1.1.m1.3.3.3.3.3" xref="S3.E1X.2.1.1.m1.3.3.3.4.cmml">,</mo><msub id="S3.E1X.2.1.1.m1.2.2.2.2.1" xref="S3.E1X.2.1.1.m1.2.2.2.2.1.cmml"><mi id="S3.E1X.2.1.1.m1.2.2.2.2.1.2" xref="S3.E1X.2.1.1.m1.2.2.2.2.1.2.cmml">𝐋</mi><mn id="S3.E1X.2.1.1.m1.2.2.2.2.1.3" xref="S3.E1X.2.1.1.m1.2.2.2.2.1.3.cmml">1</mn></msub><mo id="S3.E1X.2.1.1.m1.3.3.3.3.4" xref="S3.E1X.2.1.1.m1.3.3.3.4.cmml">,</mo><msub id="S3.E1X.2.1.1.m1.3.3.3.3.2" xref="S3.E1X.2.1.1.m1.3.3.3.3.2.cmml"><mi id="S3.E1X.2.1.1.m1.3.3.3.3.2.2" xref="S3.E1X.2.1.1.m1.3.3.3.3.2.2.cmml">𝐋</mi><mn id="S3.E1X.2.1.1.m1.3.3.3.3.2.3" xref="S3.E1X.2.1.1.m1.3.3.3.3.2.3.cmml">2</mn></msub></mrow></munder><mo lspace="0.170em" id="S3.E1X.2.1.1.m1.4.4.1.1a" xref="S3.E1X.2.1.1.m1.4.4.1.1.cmml">⁡</mo><msub id="S3.E1X.2.1.1.m1.4.4.1.1.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.cmml"><mrow id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.3.cmml">𝐖</mi><mo id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msub id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.E1X.2.1.1.m1.4.4.1.1.1.3" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.3.cmml">F</mi></msub></mrow><mo id="S3.E1X.2.1.1.m1.4.4.1.2" xref="S3.E1X.2.1.1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.4b"><apply id="S3.E1X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1"><apply id="S3.E1X.2.1.1.m1.4.4.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.4.4.1.1.2.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.2">subscript</csymbol><apply id="S3.E1X.2.1.1.m1.4.4.1.1.2.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.2.2"><times id="S3.E1X.2.1.1.m1.4.4.1.1.2.2.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.2.2.1"></times><ci id="S3.E1X.2.1.1.m1.4.4.1.1.2.2.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.2.2.2">arg</ci><ci id="S3.E1X.2.1.1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.2.2.3">min</ci></apply><list id="S3.E1X.2.1.1.m1.3.3.3.4.cmml" xref="S3.E1X.2.1.1.m1.3.3.3.3"><ci id="S3.E1X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1.1">𝐐</ci><apply id="S3.E1X.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.E1X.2.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E1X.2.1.1.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.2.2.2.2.1.2.cmml" xref="S3.E1X.2.1.1.m1.2.2.2.2.1.2">𝐋</ci><cn type="integer" id="S3.E1X.2.1.1.m1.2.2.2.2.1.3.cmml" xref="S3.E1X.2.1.1.m1.2.2.2.2.1.3">1</cn></apply><apply id="S3.E1X.2.1.1.m1.3.3.3.3.2.cmml" xref="S3.E1X.2.1.1.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.3.3.3.3.2.1.cmml" xref="S3.E1X.2.1.1.m1.3.3.3.3.2">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.3.3.3.3.2.2.cmml" xref="S3.E1X.2.1.1.m1.3.3.3.3.2.2">𝐋</ci><cn type="integer" id="S3.E1X.2.1.1.m1.3.3.3.3.2.3.cmml" xref="S3.E1X.2.1.1.m1.3.3.3.3.2.3">2</cn></apply></list></apply><apply id="S3.E1X.2.1.1.m1.4.4.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.4.4.1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1">subscript</csymbol><apply id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1"><minus id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.2"></minus><ci id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.3">𝐖</ci><apply id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"><plus id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝐐</ci><apply id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3"><times id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn type="integer" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn type="integer" id="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><ci id="S3.E1X.2.1.1.m1.4.4.1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.4.4.1.1.1.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.4c">\displaystyle\operatornamewithlimits{arg\,min}_{\mathbf{Q},\mathbf{L}_{1},\mathbf{L}_{2}}\,\|\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2})\|_{F},</annotation><annotation encoding="application/x-llamapun" id="S3.E1X.2.1.1.m1.4d">start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT bold_Q , bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_W - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1X.4.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{where}\,\,\mathbf{Q}\in\mathbb{Q}_{b}^{d\times k},\mathbf{L}_{1}\in\mathbb{R}^{d\times r},\mathbf{L}_{2}\in\mathbb{R}^{r\times k}." display="inline"><semantics id="S3.E1X.4.1.1.m1.1a"><mrow id="S3.E1X.4.1.1.m1.1.1.1"><mrow id="S3.E1X.4.1.1.m1.1.1.1.1.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.3.cmml"><mrow id="S3.E1X.4.1.1.m1.1.1.1.1.1.1" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.cmml"><mtext id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.2a.cmml">where</mtext><mo lspace="0.330em" id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.1" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.1.cmml" rspace="0px"></mo><mi id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.3.cmml">𝐐</mi></mrow><mo id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.1" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.1.cmml">∈</mo><msubsup id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.2.cmml">ℚ</mi><mi id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.3.cmml">b</mi><mrow id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.1" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.1.cmml">×</mo><mi id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.3.cmml">k</mi></mrow></msubsup></mrow><mo id="S3.E1X.4.1.1.m1.1.1.1.1.2.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.cmml"><msub id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.cmml"><mi id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.2.cmml">𝐋</mi><mn id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.3.cmml">1</mn></msub><mo id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.1" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.1.cmml">∈</mo><msup id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mi id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.1" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.1.cmml">×</mo><mi id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><mo id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.cmml"><msub id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝐋</mi><mn id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.1" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.1.cmml">∈</mo><msup id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.2" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.2.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.1" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.1.cmml">×</mo><mi id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.3" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.3.cmml">k</mi></mrow></msup></mrow></mrow></mrow><mo lspace="0em" id="S3.E1X.4.1.1.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.4.1.1.m1.1b"><apply id="S3.E1X.4.1.1.m1.1.1.1.1.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.4.1.1.m1.1.1.1.1.3a.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1"><in id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.1"></in><apply id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2"><times id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.1"></times><ci id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.2"><mtext id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.2">where</mtext></ci><ci id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.2.3">𝐐</ci></apply><apply id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.2">ℚ</ci><ci id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.2.3">𝑏</ci></apply><apply id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3"><times id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.2">𝑑</ci><ci id="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.3a.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1"><in id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.1"></in><apply id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.2">𝐋</ci><cn type="integer" id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.2.3">1</cn></apply><apply id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3">superscript</csymbol><ci id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.2">ℝ</ci><apply id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3"><times id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.1"></times><ci id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.2">𝑑</ci><ci id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.1.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2"><in id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.1"></in><apply id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.2">𝐋</ci><cn type="integer" id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.2.3">2</cn></apply><apply id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.2">ℝ</ci><apply id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3"><times id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.1"></times><ci id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.2">𝑟</ci><ci id="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="S3.E1X.4.1.1.m1.1.1.1.1.2.2.2.2.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.4.1.1.m1.1c">\displaystyle\text{where}\,\,\mathbf{Q}\in\mathbb{Q}_{b}^{d\times k},\mathbf{L}_{1}\in\mathbb{R}^{d\times r},\mathbf{L}_{2}\in\mathbb{R}^{r\times k}.</annotation><annotation encoding="application/x-llamapun" id="S3.E1X.4.1.1.m1.1d">where bold_Q ∈ blackboard_Q start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d × italic_k end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_r end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_r × italic_k end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.16">여기서 <math alttext="\mathbb{Q}_{b}^{d\times k}\subset\mathbb{R}^{d\times k}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m1.1"><semantics id="S3.SS1.p1.9.m1.1a"><mrow id="S3.SS1.p1.9.m1.1.1" xref="S3.SS1.p1.9.m1.1.1.cmml"><msubsup id="S3.SS1.p1.9.m1.1.1.2" xref="S3.SS1.p1.9.m1.1.1.2.cmml"><mi id="S3.SS1.p1.9.m1.1.1.2.2.2" xref="S3.SS1.p1.9.m1.1.1.2.2.2.cmml">ℚ</mi><mi id="S3.SS1.p1.9.m1.1.1.2.2.3" xref="S3.SS1.p1.9.m1.1.1.2.2.3.cmml">b</mi><mrow id="S3.SS1.p1.9.m1.1.1.2.3" xref="S3.SS1.p1.9.m1.1.1.2.3.cmml"><mi id="S3.SS1.p1.9.m1.1.1.2.3.2" xref="S3.SS1.p1.9.m1.1.1.2.3.2.cmml">d</mi><mo id="S3.SS1.p1.9.m1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.9.m1.1.1.2.3.1.cmml">×</mo><mi id="S3.SS1.p1.9.m1.1.1.2.3.3" xref="S3.SS1.p1.9.m1.1.1.2.3.3.cmml">k</mi></mrow></msubsup><mo id="S3.SS1.p1.9.m1.1.1.1" xref="S3.SS1.p1.9.m1.1.1.1.cmml">⊂</mo><msup id="S3.SS1.p1.9.m1.1.1.3" xref="S3.SS1.p1.9.m1.1.1.3.cmml"><mi id="S3.SS1.p1.9.m1.1.1.3.2" xref="S3.SS1.p1.9.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.9.m1.1.1.3.3" xref="S3.SS1.p1.9.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.9.m1.1.1.3.3.2" xref="S3.SS1.p1.9.m1.1.1.3.3.2.cmml">d</mi><mo id="S3.SS1.p1.9.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.9.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.9.m1.1.1.3.3.3" xref="S3.SS1.p1.9.m1.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m1.1b"><apply id="S3.SS1.p1.9.m1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1"><subset id="S3.SS1.p1.9.m1.1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1.1"></subset><apply id="S3.SS1.p1.9.m1.1.1.2.cmml" xref="S3.SS1.p1.9.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m1.1.1.2.1.cmml" xref="S3.SS1.p1.9.m1.1.1.2">superscript</csymbol><apply id="S3.SS1.p1.9.m1.1.1.2.2.cmml" xref="S3.SS1.p1.9.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m1.1.1.2.2.1.cmml" xref="S3.SS1.p1.9.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.9.m1.1.1.2.2.2.cmml" xref="S3.SS1.p1.9.m1.1.1.2.2.2">ℚ</ci><ci id="S3.SS1.p1.9.m1.1.1.2.2.3.cmml" xref="S3.SS1.p1.9.m1.1.1.2.2.3">𝑏</ci></apply><apply id="S3.SS1.p1.9.m1.1.1.2.3.cmml" xref="S3.SS1.p1.9.m1.1.1.2.3"><times id="S3.SS1.p1.9.m1.1.1.2.3.1.cmml" xref="S3.SS1.p1.9.m1.1.1.2.3.1"></times><ci id="S3.SS1.p1.9.m1.1.1.2.3.2.cmml" xref="S3.SS1.p1.9.m1.1.1.2.3.2">𝑑</ci><ci id="S3.SS1.p1.9.m1.1.1.2.3.3.cmml" xref="S3.SS1.p1.9.m1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S3.SS1.p1.9.m1.1.1.3.cmml" xref="S3.SS1.p1.9.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m1.1.1.3.1.cmml" xref="S3.SS1.p1.9.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.9.m1.1.1.3.2.cmml" xref="S3.SS1.p1.9.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.9.m1.1.1.3.3.cmml" xref="S3.SS1.p1.9.m1.1.1.3.3"><times id="S3.SS1.p1.9.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.9.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.9.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.9.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS1.p1.9.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.9.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m1.1c">\mathbb{Q}_{b}^{d\times k}\subset\mathbb{R}^{d\times k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m1.1d">blackboard_Q start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d × italic_k end_POSTSUPERSCRIPT ⊂ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>는 <math alttext="b" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m2.1"><semantics id="S3.SS1.p1.10.m2.1a"><mi id="S3.SS1.p1.10.m2.1.1" xref="S3.SS1.p1.10.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m2.1b"><ci id="S3.SS1.p1.10.m2.1.1.cmml" xref="S3.SS1.p1.10.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m2.1d">italic_b</annotation></semantics></math>-bits로 무손실 NF 양자화가 가능한 행렬들의 집합이다. 이 최적화 문제는 행렬 <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m3.1"><semantics id="S3.SS1.p1.11.m3.1a"><mi id="S3.SS1.p1.11.m3.1.1" xref="S3.SS1.p1.11.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m3.1b"><ci id="S3.SS1.p1.11.m3.1.1.cmml" xref="S3.SS1.p1.11.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m3.1d">bold_W</annotation></semantics></math>를 <math alttext="\mathbf{L}+\mathbf{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m4.1"><semantics id="S3.SS1.p1.12.m4.1a"><mrow id="S3.SS1.p1.12.m4.1.1" xref="S3.SS1.p1.12.m4.1.1.cmml"><mi id="S3.SS1.p1.12.m4.1.1.2" xref="S3.SS1.p1.12.m4.1.1.2.cmml">𝐋</mi><mo id="S3.SS1.p1.12.m4.1.1.1" xref="S3.SS1.p1.12.m4.1.1.1.cmml">+</mo><mi id="S3.SS1.p1.12.m4.1.1.3" xref="S3.SS1.p1.12.m4.1.1.3.cmml">𝐒</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m4.1b"><apply id="S3.SS1.p1.12.m4.1.1.cmml" xref="S3.SS1.p1.12.m4.1.1"><plus id="S3.SS1.p1.12.m4.1.1.1.cmml" xref="S3.SS1.p1.12.m4.1.1.1"></plus><ci id="S3.SS1.p1.12.m4.1.1.2.cmml" xref="S3.SS1.p1.12.m4.1.1.2">𝐋</ci><ci id="S3.SS1.p1.12.m4.1.1.3.cmml" xref="S3.SS1.p1.12.m4.1.1.3">𝐒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m4.1c">\mathbf{L}+\mathbf{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m4.1d">bold_L + bold_S</annotation></semantics></math>로 분해하는 것을 목표로 하는 강력한 주성분 분석 <cite class="ltx_cite ltx_citemacro_citep">(RPCA; Wright et al., <a class="ltx_ref" href="#bib.bib56" title="">2009</a>; Candès et al., <a class="ltx_ref" href="#bib.bib4" title="">2011</a>)</cite>에서 직면한 문제와 유사하며, 여기서 <math alttext="\mathbf{L}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m5.1"><semantics id="S3.SS1.p1.13.m5.1a"><mi id="S3.SS1.p1.13.m5.1.1" xref="S3.SS1.p1.13.m5.1.1.cmml">𝐋</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m5.1b"><ci id="S3.SS1.p1.13.m5.1.1.cmml" xref="S3.SS1.p1.13.m5.1.1">𝐋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m5.1c">\mathbf{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m5.1d">bold_L</annotation></semantics></math>는 낮은 순위이고 <math alttext="\mathbf{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m6.1"><semantics id="S3.SS1.p1.14.m6.1a"><mi id="S3.SS1.p1.14.m6.1.1" xref="S3.SS1.p1.14.m6.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m6.1b"><ci id="S3.SS1.p1.14.m6.1.1.cmml" xref="S3.SS1.p1.14.m6.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m6.1c">\mathbf{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m6.1d">bold_S</annotation></semantics></math>는 <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.16.1">sparse</em>이다. RCPA<cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="#bib.bib32" title="">2010</a>; Zhou &amp; Tao, <a class="ltx_ref" href="#bib.bib67" title="">2011</a>)</cite>에 효과적인 것으로 나타난 반복 알고리즘에 따라 우리는 대략적으로 Eq. <math alttext="\mathbf{L}_{1}\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m7.1"><semantics id="S3.SS1.p1.15.m7.1a"><mrow id="S3.SS1.p1.15.m7.1.1" xref="S3.SS1.p1.15.m7.1.1.cmml"><msub id="S3.SS1.p1.15.m7.1.1.2" xref="S3.SS1.p1.15.m7.1.1.2.cmml"><mi id="S3.SS1.p1.15.m7.1.1.2.2" xref="S3.SS1.p1.15.m7.1.1.2.2.cmml">𝐋</mi><mn id="S3.SS1.p1.15.m7.1.1.2.3" xref="S3.SS1.p1.15.m7.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.p1.15.m7.1.1.1" lspace="0px" rspace="0px" xref="S3.SS1.p1.15.m7.1.1.1.cmml"></mo><msub id="S3.SS1.p1.15.m7.1.1.3" xref="S3.SS1.p1.15.m7.1.1.3.cmml"><mi id="S3.SS1.p1.15.m7.1.1.3.2" xref="S3.SS1.p1.15.m7.1.1.3.2.cmml">𝐋</mi><mn id="S3.SS1.p1.15.m7.1.1.3.3" xref="S3.SS1.p1.15.m7.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m7.1b"><apply id="S3.SS1.p1.15.m7.1.1.cmml" xref="S3.SS1.p1.15.m7.1.1"><times id="S3.SS1.p1.15.m7.1.1.1.cmml" xref="S3.SS1.p1.15.m7.1.1.1"></times><apply id="S3.SS1.p1.15.m7.1.1.2.cmml" xref="S3.SS1.p1.15.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m7.1.1.2.1.cmml" xref="S3.SS1.p1.15.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.15.m7.1.1.2.2.cmml" xref="S3.SS1.p1.15.m7.1.1.2.2">𝐋</ci><cn id="S3.SS1.p1.15.m7.1.1.2.3.cmml" type="integer" xref="S3.SS1.p1.15.m7.1.1.2.3">1</cn></apply><apply id="S3.SS1.p1.15.m7.1.1.3.cmml" xref="S3.SS1.p1.15.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m7.1.1.3.1.cmml" xref="S3.SS1.p1.15.m7.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.15.m7.1.1.3.2.cmml" xref="S3.SS1.p1.15.m7.1.1.3.2">𝐋</ci><cn id="S3.SS1.p1.15.m7.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.15.m7.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m7.1c">\mathbf{L}_{1}\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m7.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>와 <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m8.1"><semantics id="S3.SS1.p1.16.m8.1a"><mi id="S3.SS1.p1.16.m8.1.1" xref="S3.SS1.p1.16.m8.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m8.1b"><ci id="S3.SS1.p1.16.m8.1.1.cmml" xref="S3.SS1.p1.16.m8.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m8.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m8.1d">bold_Q</annotation></semantics></math>:<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>In practice we use randomized SVD instead of full SVD, which significantly reduced runtime for the SVD portion of the algorithm without much deterioration in performance.</span></span></span>의 교호를 통해<a class="ltx_ref" href="#S3.E1" title="In 3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">1</span></a></p>
<table id="S3.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\mathbf{L}_{1}^{(t)},\mathbf{L}_{2}^{(t)}" display="inline"><semantics id="S3.E2X.2.1.1.m1.4a"><mrow id="S3.E2X.2.1.1.m1.4.4.2" xref="S3.E2X.2.1.1.m1.4.4.3.cmml"><msubsup id="S3.E2X.2.1.1.m1.3.3.1.1" xref="S3.E2X.2.1.1.m1.3.3.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.3.3.1.1.2.2" xref="S3.E2X.2.1.1.m1.3.3.1.1.2.2.cmml">𝐋</mi><mn id="S3.E2X.2.1.1.m1.3.3.1.1.2.3" xref="S3.E2X.2.1.1.m1.3.3.1.1.2.3.cmml">1</mn><mrow id="S3.E2X.2.1.1.m1.1.1.1.3" xref="S3.E2X.2.1.1.m1.3.3.1.1.cmml"><mo stretchy="false" id="S3.E2X.2.1.1.m1.1.1.1.3.1" xref="S3.E2X.2.1.1.m1.3.3.1.1.cmml">(</mo><mi id="S3.E2X.2.1.1.m1.1.1.1.1" xref="S3.E2X.2.1.1.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E2X.2.1.1.m1.1.1.1.3.2" xref="S3.E2X.2.1.1.m1.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E2X.2.1.1.m1.4.4.2.3" xref="S3.E2X.2.1.1.m1.4.4.3.cmml">,</mo><msubsup id="S3.E2X.2.1.1.m1.4.4.2.2" xref="S3.E2X.2.1.1.m1.4.4.2.2.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.2.2.2.2" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.2.cmml">𝐋</mi><mn id="S3.E2X.2.1.1.m1.4.4.2.2.2.3" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.cmml">2</mn><mrow id="S3.E2X.2.1.1.m1.2.2.1.3" xref="S3.E2X.2.1.1.m1.4.4.2.2.cmml"><mo stretchy="false" id="S3.E2X.2.1.1.m1.2.2.1.3.1" xref="S3.E2X.2.1.1.m1.4.4.2.2.cmml">(</mo><mi id="S3.E2X.2.1.1.m1.2.2.1.1" xref="S3.E2X.2.1.1.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S3.E2X.2.1.1.m1.2.2.1.3.2" xref="S3.E2X.2.1.1.m1.4.4.2.2.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.4b"><list id="S3.E2X.2.1.1.m1.4.4.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.2"><apply id="S3.E2X.2.1.1.m1.3.3.1.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.3.3.1.1.2.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1.2.2">𝐋</ci><cn type="integer" id="S3.E2X.2.1.1.m1.3.3.1.1.2.3.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1.2.3">1</cn></apply><ci id="S3.E2X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E2X.2.1.1.m1.4.4.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.4.4.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.2">𝐋</ci><cn type="integer" id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.E2X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.1.1">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.4c">\displaystyle\mathbf{L}_{1}^{(t)},\mathbf{L}_{2}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.E2X.2.1.1.m1.4d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle\leftarrow\operatorname{SVD}(\mathbf{W}-\mathbf{Q}^{(t-1)},r)," display="inline"><semantics id="S3.E2X.3.2.2.m1.4a"><mrow id="S3.E2X.3.2.2.m1.4.4.1" xref="S3.E2X.3.2.2.m1.4.4.1.1.cmml"><mrow id="S3.E2X.3.2.2.m1.4.4.1.1" xref="S3.E2X.3.2.2.m1.4.4.1.1.cmml"><mi id="S3.E2X.3.2.2.m1.4.4.1.1.3" xref="S3.E2X.3.2.2.m1.4.4.1.1.3.cmml"></mi><mo stretchy="false" id="S3.E2X.3.2.2.m1.4.4.1.1.2" xref="S3.E2X.3.2.2.m1.4.4.1.1.2.cmml">←</mo><mrow id="S3.E2X.3.2.2.m1.4.4.1.1.1.1" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.2.cmml"><mi id="S3.E2X.3.2.2.m1.2.2" xref="S3.E2X.3.2.2.m1.2.2.cmml">SVD</mi><mo id="S3.E2X.3.2.2.m1.4.4.1.1.1.1a" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.2" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.2.cmml">(</mo><mrow id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.2" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.2.cmml">𝐖</mi><mo id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml">−</mo><msup id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.cmml">𝐐</mi><mrow id="S3.E2X.3.2.2.m1.1.1.1.1" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2X.3.2.2.m1.1.1.1.1.2" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2X.3.2.2.m1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S3.E2X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E2X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E2X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E2X.3.2.2.m1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow><mo id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.2.cmml">,</mo><mi id="S3.E2X.3.2.2.m1.3.3" xref="S3.E2X.3.2.2.m1.3.3.cmml">r</mi><mo stretchy="false" id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.4" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2X.3.2.2.m1.4.4.1.2" xref="S3.E2X.3.2.2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.3.2.2.m1.4b"><apply id="S3.E2X.3.2.2.m1.4.4.1.1.cmml" xref="S3.E2X.3.2.2.m1.4.4.1"><ci id="S3.E2X.3.2.2.m1.4.4.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.4.4.1.1.2">←</ci><csymbol cd="latexml" id="S3.E2X.3.2.2.m1.4.4.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.4.4.1.1.3">absent</csymbol><apply id="S3.E2X.3.2.2.m1.4.4.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1"><ci id="S3.E2X.3.2.2.m1.2.2.cmml" xref="S3.E2X.3.2.2.m1.2.2">SVD</ci><apply id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1"><minus id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.1"></minus><ci id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.2">𝐖</ci><apply id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E2X.3.2.2.m1.4.4.1.1.1.1.1.1.3.2">𝐐</ci><apply id="S3.E2X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.1.1.1.1"><minus id="S3.E2X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.1"></minus><ci id="S3.E2X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E2X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.1.1.1.1.1.3">1</cn></apply></apply></apply><ci id="S3.E2X.3.2.2.m1.3.3.cmml" xref="S3.E2X.3.2.2.m1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.3.2.2.m1.4c">\displaystyle\leftarrow\operatorname{SVD}(\mathbf{W}-\mathbf{Q}^{(t-1)},r),</annotation><annotation encoding="application/x-llamapun" id="S3.E2X.3.2.2.m1.4d">← roman_SVD ( bold_W - bold_Q start_POSTSUPERSCRIPT ( italic_t - 1 ) end_POSTSUPERSCRIPT , italic_r ) ,</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2X.5.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\hskip 14.22636pt{\color[rgb]{.5,.5,.5}=\operatornamewithlimits{arg\,min}_{\operatorname*{rank}(\mathbf{L})\leq r}\,\|\mathbf{W}-(\mathbf{Q}^{(t-1)}+\mathbf{L})\|_{F},}" display="inline"><semantics id="S3.E2X.5.1.1.m1.4a"><mrow id="S3.E2X.5.1.1.m1.4.4.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E2X.5.1.1.m1.4.4.1.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.cmml"><mi id="S3.E2X.5.1.1.m1.4.4.1.1.3" xref="S3.E2X.5.1.1.m1.4.4.1.1.3.cmml"></mi><mo lspace="1.698em" mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E2X.5.1.1.m1.4.4.1.1.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.cmml"><munder id="S3.E2X.5.1.1.m1.4.4.1.1.1.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2.cmml"><mrow id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.cmml"><mi mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.2.cmml">arg</mi><mo lspace="0.170em" mathcolor="black" id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.1.cmml" rspace="0px"></mo><mi mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.3" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.3.cmml">min</mi></mrow><mrow id="S3.E2X.5.1.1.m1.2.2.2" xref="S3.E2X.5.1.1.m1.2.2.2.cmml"><mrow id="S3.E2X.5.1.1.m1.2.2.2.4.2" xref="S3.E2X.5.1.1.m1.2.2.2.4.1.cmml"><mo mathcolor="#808080" rspace="0em" id="S3.E2X.5.1.1.m1.1.1.1.1" xref="S3.E2X.5.1.1.m1.1.1.1.1.cmml">rank</mo><mrow id="S3.E2X.5.1.1.m1.2.2.2.4.2.1" xref="S3.E2X.5.1.1.m1.2.2.2.4.1.cmml"><mo mathcolor="#808080" stretchy="false" id="S3.E2X.5.1.1.m1.2.2.2.4.2.1.1" xref="S3.E2X.5.1.1.m1.2.2.2.4.1.cmml">(</mo><mi mathcolor="#808080" id="S3.E2X.5.1.1.m1.2.2.2.2" xref="S3.E2X.5.1.1.m1.2.2.2.2.cmml">𝐋</mi><mo mathcolor="#808080" stretchy="false" id="S3.E2X.5.1.1.m1.2.2.2.4.2.1.2" xref="S3.E2X.5.1.1.m1.2.2.2.4.1.cmml">)</mo></mrow></mrow><mo mathcolor="#808080" id="S3.E2X.5.1.1.m1.2.2.2.3" xref="S3.E2X.5.1.1.m1.2.2.2.3.cmml">≤</mo><mi mathcolor="#808080" id="S3.E2X.5.1.1.m1.2.2.2.5" xref="S3.E2X.5.1.1.m1.2.2.2.5.cmml">r</mi></mrow></munder><mo mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.1a" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.cmml">⁡</mo><msub id="S3.E2X.5.1.1.m1.4.4.1.1.1.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.cmml"><mrow id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.2.cmml"><mo mathcolor="#808080" stretchy="false" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.3.cmml">𝐖</mi><mo mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo mathcolor="#808080" stretchy="false" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐐</mi><mrow id="S3.E2X.5.1.1.m1.3.3.1.1" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.cmml"><mo mathcolor="#808080" stretchy="false" id="S3.E2X.5.1.1.m1.3.3.1.1.2" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E2X.5.1.1.m1.3.3.1.1.1" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.cmml"><mi mathcolor="#808080" id="S3.E2X.5.1.1.m1.3.3.1.1.1.2" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.2.cmml">t</mi><mo mathcolor="#808080" id="S3.E2X.5.1.1.m1.3.3.1.1.1.1" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.1.cmml">−</mo><mn mathcolor="#808080" id="S3.E2X.5.1.1.m1.3.3.1.1.1.3" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo mathcolor="#808080" stretchy="false" id="S3.E2X.5.1.1.m1.3.3.1.1.3" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></msup><mo mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐋</mi></mrow><mo mathcolor="#808080" stretchy="false" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathcolor="#808080" stretchy="false" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.3" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.3" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.3.cmml">F</mi></msub></mrow></mrow><mo mathcolor="#808080" id="S3.E2X.5.1.1.m1.4.4.1.2" xref="S3.E2X.5.1.1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.5.1.1.m1.4b"><apply id="S3.E2X.5.1.1.m1.4.4.1.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1"><eq id="S3.E2X.5.1.1.m1.4.4.1.1.2.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.2"></eq><csymbol cd="latexml" id="S3.E2X.5.1.1.m1.4.4.1.1.3.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.3">absent</csymbol><apply id="S3.E2X.5.1.1.m1.4.4.1.1.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1"><apply id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2">subscript</csymbol><apply id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2"><times id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.1"></times><ci id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.2.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.2">arg</ci><ci id="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.3.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.2.2.3">min</ci></apply><apply id="S3.E2X.5.1.1.m1.2.2.2.cmml" xref="S3.E2X.5.1.1.m1.2.2.2"><leq id="S3.E2X.5.1.1.m1.2.2.2.3.cmml" xref="S3.E2X.5.1.1.m1.2.2.2.3"></leq><apply id="S3.E2X.5.1.1.m1.2.2.2.4.1.cmml" xref="S3.E2X.5.1.1.m1.2.2.2.4.2"><ci id="S3.E2X.5.1.1.m1.1.1.1.1.cmml" xref="S3.E2X.5.1.1.m1.1.1.1.1">rank</ci><ci id="S3.E2X.5.1.1.m1.2.2.2.2.cmml" xref="S3.E2X.5.1.1.m1.2.2.2.2">𝐋</ci></apply><ci id="S3.E2X.5.1.1.m1.2.2.2.5.cmml" xref="S3.E2X.5.1.1.m1.2.2.2.5">𝑟</ci></apply></apply><apply id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1">subscript</csymbol><apply id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1"><minus id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.2"></minus><ci id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.3">𝐖</ci><apply id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1"><plus id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2">𝐐</ci><apply id="S3.E2X.5.1.1.m1.3.3.1.1.1.cmml" xref="S3.E2X.5.1.1.m1.3.3.1.1"><minus id="S3.E2X.5.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.1"></minus><ci id="S3.E2X.5.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E2X.5.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.E2X.5.1.1.m1.3.3.1.1.1.3">1</cn></apply></apply><ci id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝐋</ci></apply></apply></apply><ci id="S3.E2X.5.1.1.m1.4.4.1.1.1.1.3.cmml" xref="S3.E2X.5.1.1.m1.4.4.1.1.1.1.3">𝐹</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.5.1.1.m1.4c">\displaystyle\hskip 14.22636pt{\color[rgb]{.5,.5,.5}=\operatornamewithlimits{arg\,min}_{\operatorname*{rank}(\mathbf{L})\leq r}\,\|\mathbf{W}-(\mathbf{Q}^{(t-1)}+\mathbf{L})\|_{F},}</annotation><annotation encoding="application/x-llamapun" id="S3.E2X.5.1.1.m1.4d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT roman_rank ( bold_L ) ≤ italic_r end_POSTSUBSCRIPT ∥ bold_W - ( bold_Q start_POSTSUPERSCRIPT ( italic_t - 1 ) end_POSTSUPERSCRIPT + bold_L ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S3.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{Q}^{(t)}" display="inline"><semantics id="S3.E2Xa.2.1.1.m1.1a"><msup id="S3.E2Xa.2.1.1.m1.1.2" xref="S3.E2Xa.2.1.1.m1.1.2.cmml"><mi id="S3.E2Xa.2.1.1.m1.1.2.2" xref="S3.E2Xa.2.1.1.m1.1.2.2.cmml">𝐐</mi><mrow id="S3.E2Xa.2.1.1.m1.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.E2Xa.2.1.1.m1.1.1.1.3.1" xref="S3.E2Xa.2.1.1.m1.1.2.cmml">(</mo><mi id="S3.E2Xa.2.1.1.m1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E2Xa.2.1.1.m1.1.1.1.3.2" xref="S3.E2Xa.2.1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.E2Xa.2.1.1.m1.1b"><apply id="S3.E2Xa.2.1.1.m1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.1.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.2">superscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.1.2.2">𝐐</ci><ci id="S3.E2Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.2.1.1.m1.1c">\displaystyle\mathbf{Q}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.E2Xa.2.1.1.m1.1d">bold_Q start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2Xa.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle\leftarrow\operatorname{Quantize}(\mathbf{W}-\mathbf{L}_{1}^{(t)}\mathbf{L}_{2}^{(t)})," display="inline"><semantics id="S3.E2Xa.3.2.2.m1.4a"><mrow id="S3.E2Xa.3.2.2.m1.4.4.1" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.cmml"><mrow id="S3.E2Xa.3.2.2.m1.4.4.1.1" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.cmml"><mi id="S3.E2Xa.3.2.2.m1.4.4.1.1.3" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.3.cmml"></mi><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.4.4.1.1.2" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.2.cmml">←</mo><mrow id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.2.cmml"><mi id="S3.E2Xa.3.2.2.m1.3.3" xref="S3.E2Xa.3.2.2.m1.3.3.cmml">Quantize</mi><mo id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1a" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.2" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.2.cmml">(</mo><mrow id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.2" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.2.cmml">𝐖</mi><mo id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.cmml"><msubsup id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.2" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.2.cmml">𝐋</mi><mn id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.3" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.3.cmml">1</mn><mrow id="S3.E2Xa.3.2.2.m1.1.1.1.3" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.cmml"><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.1.1.1.3.1" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.cmml">(</mo><mi id="S3.E2Xa.3.2.2.m1.1.1.1.1" xref="S3.E2Xa.3.2.2.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.1.1.1.3.2" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.cmml">)</mo></mrow></msubsup><mo id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.1" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msubsup id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.2" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.2.cmml">𝐋</mi><mn id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.3" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.3.cmml">2</mn><mrow id="S3.E2Xa.3.2.2.m1.2.2.1.3" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.2.2.1.3.1" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.cmml">(</mo><mi id="S3.E2Xa.3.2.2.m1.2.2.1.1" xref="S3.E2Xa.3.2.2.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.2.2.1.3.2" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.3" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2Xa.3.2.2.m1.4.4.1.2" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xa.3.2.2.m1.4b"><apply id="S3.E2Xa.3.2.2.m1.4.4.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1"><ci id="S3.E2Xa.3.2.2.m1.4.4.1.1.2.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.2">←</ci><csymbol cd="latexml" id="S3.E2Xa.3.2.2.m1.4.4.1.1.3.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.3">absent</csymbol><apply id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.2.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1"><ci id="S3.E2Xa.3.2.2.m1.3.3.cmml" xref="S3.E2Xa.3.2.2.m1.3.3">Quantize</ci><apply id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1"><minus id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1"></minus><ci id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.2">𝐖</ci><apply id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3"><times id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.1"></times><apply id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.2">𝐋</ci><cn type="integer" id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.2.2.3">1</cn></apply><ci id="S3.E2Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.2">𝐋</ci><cn type="integer" id="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E2Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.3.2.3">2</cn></apply><ci id="S3.E2Xa.3.2.2.m1.2.2.1.1.cmml" xref="S3.E2Xa.3.2.2.m1.2.2.1.1">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.3.2.2.m1.4c">\displaystyle\leftarrow\operatorname{Quantize}(\mathbf{W}-\mathbf{L}_{1}^{(t)}\mathbf{L}_{2}^{(t)}),</annotation><annotation encoding="application/x-llamapun" id="S3.E2Xa.3.2.2.m1.4d">← roman_Quantize ( bold_W - bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2Xa.5.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\hskip 14.22636pt{\color[rgb]{.5,.5,.5}\approx\operatornamewithlimits{arg\,min}_{\mathbf{Q}\in\mathbb{Q}^{d\times k}_{b}}\,\|\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}^{(t)}\mathbf{L}_{2}^{(t)})\|_{F},}" display="inline"><semantics id="S3.E2Xa.5.1.1.m1.3a"><mrow id="S3.E2Xa.5.1.1.m1.3.3.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.cmml"><mi id="S3.E2Xa.5.1.1.m1.3.3.1.1.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.3.cmml"></mi><mo lspace="1.698em" mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.2.cmml">≈</mo><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.cmml"><munder id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.cmml"><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.cmml"><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.2.cmml">arg</mi><mo lspace="0.170em" mathcolor="black" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.1.cmml" rspace="0px"></mo><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.3.cmml">min</mi></mrow><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.cmml"><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.2.cmml">𝐐</mi><mo mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.1.cmml">∈</mo><msubsup id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.cmml"><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.2.cmml">ℚ</mi><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.3.cmml">b</mi><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.cmml"><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.2.cmml">d</mi><mo lspace="0.222em" mathcolor="#808080" rspace="0.222em" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.1.cmml">×</mo><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.3.cmml">k</mi></mrow></msubsup></mrow></munder><mo mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1a" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.cmml">⁡</mo><msub id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mo mathcolor="#808080" stretchy="false" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">𝐖</mi><mo mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo mathcolor="#808080" stretchy="false" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><msubsup id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">𝐋</mi><mn mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">1</mn><mrow id="S3.E2Xa.5.1.1.m1.1.1.1.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mo mathcolor="#808080" stretchy="false" id="S3.E2Xa.5.1.1.m1.1.1.1.3.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">(</mo><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.1.1.1.1" xref="S3.E2Xa.5.1.1.m1.1.1.1.1.cmml">t</mi><mo mathcolor="#808080" stretchy="false" id="S3.E2Xa.5.1.1.m1.1.1.1.3.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">)</mo></mrow></msubsup><mo mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msubsup id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">𝐋</mi><mn mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">2</mn><mrow id="S3.E2Xa.5.1.1.m1.2.2.1.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mo mathcolor="#808080" stretchy="false" id="S3.E2Xa.5.1.1.m1.2.2.1.3.1" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">(</mo><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.2.2.1.1" xref="S3.E2Xa.5.1.1.m1.2.2.1.1.cmml">t</mi><mo mathcolor="#808080" stretchy="false" id="S3.E2Xa.5.1.1.m1.2.2.1.3.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo mathcolor="#808080" stretchy="false" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathcolor="#808080" stretchy="false" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.3" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.3.cmml">F</mi></msub></mrow></mrow><mo mathcolor="#808080" id="S3.E2Xa.5.1.1.m1.3.3.1.2" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xa.5.1.1.m1.3b"><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1"><approx id="S3.E2Xa.5.1.1.m1.3.3.1.1.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.2"></approx><csymbol cd="latexml" id="S3.E2Xa.5.1.1.m1.3.3.1.1.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.3">absent</csymbol><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1"><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2">subscript</csymbol><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2"><times id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.1"></times><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.2">arg</ci><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.2.3">min</ci></apply><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3"><in id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.1"></in><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.2">𝐐</ci><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3">subscript</csymbol><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3">superscript</csymbol><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.2">ℚ</ci><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3"><times id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.1"></times><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.2">𝑑</ci><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.2.3.3">𝑘</ci></apply></apply><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.2.3.3.3">𝑏</ci></apply></apply></apply><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1">subscript</csymbol><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1"><minus id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.2"></minus><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.3">𝐖</ci><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1"><plus id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝐐</ci><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝐋</ci><cn type="integer" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.3">1</cn></apply><ci id="S3.E2Xa.5.1.1.m1.1.1.1.1.cmml" xref="S3.E2Xa.5.1.1.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.2">𝐋</ci><cn type="integer" id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.2.3">2</cn></apply><ci id="S3.E2Xa.5.1.1.m1.2.2.1.1.cmml" xref="S3.E2Xa.5.1.1.m1.2.2.1.1">𝑡</ci></apply></apply></apply></apply></apply><ci id="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E2Xa.5.1.1.m1.3.3.1.1.1.1.3">𝐹</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.5.1.1.m1.3c">\displaystyle\hskip 14.22636pt{\color[rgb]{.5,.5,.5}\approx\operatornamewithlimits{arg\,min}_{\mathbf{Q}\in\mathbb{Q}^{d\times k}_{b}}\,\|\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}^{(t)}\mathbf{L}_{2}^{(t)})\|_{F},}</annotation><annotation encoding="application/x-llamapun" id="S3.E2Xa.5.1.1.m1.3d">≈ start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT bold_Q ∈ blackboard_Q start_POSTSUPERSCRIPT italic_d × italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_W - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.20">여기서 <math alttext="\mathbf{Q}^{(0)}" class="ltx_Math" display="inline" id="S3.SS1.p1.17.m1.1"><semantics id="S3.SS1.p1.17.m1.1a"><msup id="S3.SS1.p1.17.m1.1.2" xref="S3.SS1.p1.17.m1.1.2.cmml"><mi id="S3.SS1.p1.17.m1.1.2.2" xref="S3.SS1.p1.17.m1.1.2.2.cmml">𝐐</mi><mrow id="S3.SS1.p1.17.m1.1.1.1.3" xref="S3.SS1.p1.17.m1.1.2.cmml"><mo id="S3.SS1.p1.17.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.17.m1.1.2.cmml">(</mo><mn id="S3.SS1.p1.17.m1.1.1.1.1" xref="S3.SS1.p1.17.m1.1.1.1.1.cmml">0</mn><mo id="S3.SS1.p1.17.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.17.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m1.1b"><apply id="S3.SS1.p1.17.m1.1.2.cmml" xref="S3.SS1.p1.17.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m1.1.2.1.cmml" xref="S3.SS1.p1.17.m1.1.2">superscript</csymbol><ci id="S3.SS1.p1.17.m1.1.2.2.cmml" xref="S3.SS1.p1.17.m1.1.2.2">𝐐</ci><cn id="S3.SS1.p1.17.m1.1.1.1.1.cmml" type="integer" xref="S3.SS1.p1.17.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m1.1c">\mathbf{Q}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.17.m1.1d">bold_Q start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math>는 <math alttext="\mathbf{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.18.m2.1"><semantics id="S3.SS1.p1.18.m2.1a"><mn id="S3.SS1.p1.18.m2.1.1" xref="S3.SS1.p1.18.m2.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m2.1b"><cn id="S3.SS1.p1.18.m2.1.1.cmml" type="integer" xref="S3.SS1.p1.18.m2.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m2.1c">\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.18.m2.1d">bold_0</annotation></semantics></math>로 초기화된다. 이론적인 수렴 보장이 <cite class="ltx_cite ltx_citemacro_citep">(Ma &amp; Aybat, <a class="ltx_ref" href="#bib.bib35" title="">2018</a>)</cite>를 얻을 수 있는 (일부) RPCA 알고리즘과 달리 위의 알고리즘은 휴리스틱이다. 따라서 우리는 오류 <math alttext="\|\mathbf{W}-(\mathbf{Q}^{(t)}+\mathbf{L}_{1}^{(t)}\mathbf{L}_{2}^{(t)})\|_{F}" class="ltx_Math" display="inline" id="S3.SS1.p1.19.m3.4"><semantics id="S3.SS1.p1.19.m3.4a"><msub id="S3.SS1.p1.19.m3.4.4" xref="S3.SS1.p1.19.m3.4.4.cmml"><mrow id="S3.SS1.p1.19.m3.4.4.1.1" xref="S3.SS1.p1.19.m3.4.4.1.2.cmml"><mo id="S3.SS1.p1.19.m3.4.4.1.1.2" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.2.1.cmml">‖</mo><mrow id="S3.SS1.p1.19.m3.4.4.1.1.1" xref="S3.SS1.p1.19.m3.4.4.1.1.1.cmml"><mi id="S3.SS1.p1.19.m3.4.4.1.1.1.3" xref="S3.SS1.p1.19.m3.4.4.1.1.1.3.cmml">𝐖</mi><mo id="S3.SS1.p1.19.m3.4.4.1.1.1.2" xref="S3.SS1.p1.19.m3.4.4.1.1.1.2.cmml">−</mo><mrow id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.cmml"><msup id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.2.cmml">𝐐</mi><mrow id="S3.SS1.p1.19.m3.1.1.1.3" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.cmml"><mo id="S3.SS1.p1.19.m3.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p1.19.m3.1.1.1.1" xref="S3.SS1.p1.19.m3.1.1.1.1.cmml">t</mi><mo id="S3.SS1.p1.19.m3.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.1" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.cmml"><msubsup id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.2" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.2.cmml">𝐋</mi><mn id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.3" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.3.cmml">1</mn><mrow id="S3.SS1.p1.19.m3.2.2.1.3" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.cmml"><mo id="S3.SS1.p1.19.m3.2.2.1.3.1" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.cmml">(</mo><mi id="S3.SS1.p1.19.m3.2.2.1.1" xref="S3.SS1.p1.19.m3.2.2.1.1.cmml">t</mi><mo id="S3.SS1.p1.19.m3.2.2.1.3.2" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.1" lspace="0px" rspace="0px" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.1.cmml"></mo><msubsup id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.2" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.2.cmml">𝐋</mi><mn id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.3" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.3.cmml">2</mn><mrow id="S3.SS1.p1.19.m3.3.3.1.3" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.cmml"><mo id="S3.SS1.p1.19.m3.3.3.1.3.1" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.cmml">(</mo><mi id="S3.SS1.p1.19.m3.3.3.1.1" xref="S3.SS1.p1.19.m3.3.3.1.1.cmml">t</mi><mo id="S3.SS1.p1.19.m3.3.3.1.3.2" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.19.m3.4.4.1.1.3" stretchy="false" xref="S3.SS1.p1.19.m3.4.4.1.2.1.cmml">‖</mo></mrow><mi id="S3.SS1.p1.19.m3.4.4.3" xref="S3.SS1.p1.19.m3.4.4.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m3.4b"><apply id="S3.SS1.p1.19.m3.4.4.cmml" xref="S3.SS1.p1.19.m3.4.4"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m3.4.4.2.cmml" xref="S3.SS1.p1.19.m3.4.4">subscript</csymbol><apply id="S3.SS1.p1.19.m3.4.4.1.2.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1"><csymbol cd="latexml" id="S3.SS1.p1.19.m3.4.4.1.2.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.2">norm</csymbol><apply id="S3.SS1.p1.19.m3.4.4.1.1.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1"><minus id="S3.SS1.p1.19.m3.4.4.1.1.1.2.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.2"></minus><ci id="S3.SS1.p1.19.m3.4.4.1.1.1.3.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.3">𝐖</ci><apply id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1"><plus id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.1"></plus><apply id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.2.2">𝐐</ci><ci id="S3.SS1.p1.19.m3.1.1.1.1.cmml" xref="S3.SS1.p1.19.m3.1.1.1.1">𝑡</ci></apply><apply id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3"><times id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.1"></times><apply id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.2">𝐋</ci><cn id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.3.cmml" type="integer" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.2.2.3">1</cn></apply><ci id="S3.SS1.p1.19.m3.2.2.1.1.cmml" xref="S3.SS1.p1.19.m3.2.2.1.1">𝑡</ci></apply><apply id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.2">𝐋</ci><cn id="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS1.p1.19.m3.4.4.1.1.1.1.1.1.3.3.2.3">2</cn></apply><ci id="S3.SS1.p1.19.m3.3.3.1.1.cmml" xref="S3.SS1.p1.19.m3.3.3.1.1">𝑡</ci></apply></apply></apply></apply></apply><ci id="S3.SS1.p1.19.m3.4.4.3.cmml" xref="S3.SS1.p1.19.m3.4.4.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m3.4c">\|\mathbf{W}-(\mathbf{Q}^{(t)}+\mathbf{L}_{1}^{(t)}\mathbf{L}_{2}^{(t)})\|_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.19.m3.4d">∥ bold_W - ( bold_Q start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>를 추적하고 오류가 증가하면 알고리즘을 종료하는 간단한 중지 기준을 사용한다. 반복 분해 알고리즘은 Algorithm <a class="ltx_ref" href="#alg2" title="Algorithm 2 ‣ 3.2 Mixed-Configuration Quantization via an Integer Linear Program ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">2</span></a>에 나타나 있다. <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</sup><span class="ltx_tag ltx_tag_note">3</span>우리의 접근법의 단순성에도 불구하고, 우리는 낮은 순위 플러스 양자화 매트릭스 분해에 대한 선행 작업을 인식하지 못하고 있는데, 이는 양자화 <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="#bib.bib60" title="">2023</a>)</cite> 이후의 오류를 수정하기 위해 잔차 <math alttext="\mathbf{E}=\mathbf{W}-\operatorname{Quantize}(\mathbf{W})" class="ltx_Math" display="inline" id="footnote3.m1.2"><semantics id="footnote3.m1.2b"><mrow id="footnote3.m1.2.3" xref="footnote3.m1.2.3.cmml"><mi id="footnote3.m1.2.3.2" xref="footnote3.m1.2.3.2.cmml">𝐄</mi><mo id="footnote3.m1.2.3.1" xref="footnote3.m1.2.3.1.cmml">=</mo><mrow id="footnote3.m1.2.3.3" xref="footnote3.m1.2.3.3.cmml"><mi id="footnote3.m1.2.3.3.2" xref="footnote3.m1.2.3.3.2.cmml">𝐖</mi><mo id="footnote3.m1.2.3.3.1" xref="footnote3.m1.2.3.3.1.cmml">−</mo><mrow id="footnote3.m1.2.3.3.3.2" xref="footnote3.m1.2.3.3.3.1.cmml"><mi id="footnote3.m1.1.1" xref="footnote3.m1.1.1.cmml">Quantize</mi><mo id="footnote3.m1.2.3.3.3.2b" xref="footnote3.m1.2.3.3.3.1.cmml">⁡</mo><mrow id="footnote3.m1.2.3.3.3.2.1" xref="footnote3.m1.2.3.3.3.1.cmml"><mo id="footnote3.m1.2.3.3.3.2.1.1" stretchy="false" xref="footnote3.m1.2.3.3.3.1.cmml">(</mo><mi id="footnote3.m1.2.2" xref="footnote3.m1.2.2.cmml">𝐖</mi><mo id="footnote3.m1.2.3.3.3.2.1.2" stretchy="false" xref="footnote3.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m1.2c"><apply id="footnote3.m1.2.3.cmml" xref="footnote3.m1.2.3"><eq id="footnote3.m1.2.3.1.cmml" xref="footnote3.m1.2.3.1"></eq><ci id="footnote3.m1.2.3.2.cmml" xref="footnote3.m1.2.3.2">𝐄</ci><apply id="footnote3.m1.2.3.3.cmml" xref="footnote3.m1.2.3.3"><minus id="footnote3.m1.2.3.3.1.cmml" xref="footnote3.m1.2.3.3.1"></minus><ci id="footnote3.m1.2.3.3.2.cmml" xref="footnote3.m1.2.3.3.2">𝐖</ci><apply id="footnote3.m1.2.3.3.3.1.cmml" xref="footnote3.m1.2.3.3.3.2"><ci id="footnote3.m1.1.1.cmml" xref="footnote3.m1.1.1">Quantize</ci><ci id="footnote3.m1.2.2.cmml" xref="footnote3.m1.2.2">𝐖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m1.2d">\mathbf{E}=\mathbf{W}-\operatorname{Quantize}(\mathbf{W})</annotation><annotation encoding="application/x-llamapun" id="footnote3.m1.2e">bold_E = bold_W - roman_Quantize ( bold_W )</annotation></semantics></math>에 SVD를 수행하는 것을 제안하는 최근의 preprint를 제외한다. 이 접근법은 초기화 <math alttext="\mathbf{Q}^{(0)}=\operatorname{Quantize}(\mathbf{W})" class="ltx_Math" display="inline" id="footnote3.m2.3"><semantics id="footnote3.m2.3b"><mrow id="footnote3.m2.3.4" xref="footnote3.m2.3.4.cmml"><msup id="footnote3.m2.3.4.2" xref="footnote3.m2.3.4.2.cmml"><mi id="footnote3.m2.3.4.2.2" xref="footnote3.m2.3.4.2.2.cmml">𝐐</mi><mrow id="footnote3.m2.1.1.1.3" xref="footnote3.m2.3.4.2.cmml"><mo id="footnote3.m2.1.1.1.3.1" stretchy="false" xref="footnote3.m2.3.4.2.cmml">(</mo><mn id="footnote3.m2.1.1.1.1" xref="footnote3.m2.1.1.1.1.cmml">0</mn><mo id="footnote3.m2.1.1.1.3.2" stretchy="false" xref="footnote3.m2.3.4.2.cmml">)</mo></mrow></msup><mo id="footnote3.m2.3.4.1" xref="footnote3.m2.3.4.1.cmml">=</mo><mrow id="footnote3.m2.3.4.3.2" xref="footnote3.m2.3.4.3.1.cmml"><mi id="footnote3.m2.2.2" xref="footnote3.m2.2.2.cmml">Quantize</mi><mo id="footnote3.m2.3.4.3.2b" xref="footnote3.m2.3.4.3.1.cmml">⁡</mo><mrow id="footnote3.m2.3.4.3.2.1" xref="footnote3.m2.3.4.3.1.cmml"><mo id="footnote3.m2.3.4.3.2.1.1" stretchy="false" xref="footnote3.m2.3.4.3.1.cmml">(</mo><mi id="footnote3.m2.3.3" xref="footnote3.m2.3.3.cmml">𝐖</mi><mo id="footnote3.m2.3.4.3.2.1.2" stretchy="false" xref="footnote3.m2.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m2.3c"><apply id="footnote3.m2.3.4.cmml" xref="footnote3.m2.3.4"><eq id="footnote3.m2.3.4.1.cmml" xref="footnote3.m2.3.4.1"></eq><apply id="footnote3.m2.3.4.2.cmml" xref="footnote3.m2.3.4.2"><csymbol cd="ambiguous" id="footnote3.m2.3.4.2.1.cmml" xref="footnote3.m2.3.4.2">superscript</csymbol><ci id="footnote3.m2.3.4.2.2.cmml" xref="footnote3.m2.3.4.2.2">𝐐</ci><cn id="footnote3.m2.1.1.1.1.cmml" type="integer" xref="footnote3.m2.1.1.1.1">0</cn></apply><apply id="footnote3.m2.3.4.3.1.cmml" xref="footnote3.m2.3.4.3.2"><ci id="footnote3.m2.2.2.cmml" xref="footnote3.m2.2.2">Quantize</ci><ci id="footnote3.m2.3.3.cmml" xref="footnote3.m2.3.3">𝐖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m2.3d">\mathbf{Q}^{(0)}=\operatorname{Quantize}(\mathbf{W})</annotation><annotation encoding="application/x-llamapun" id="footnote3.m2.3e">bold_Q start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT = roman_Quantize ( bold_W )</annotation></semantics></math>로 반복 알고리즘의 단일 단계를 수행하는 것으로 볼 수 있다. 실험에서 <math alttext="\mathbf{Q}^{(0)}" class="ltx_Math" display="inline" id="footnote3.m3.1"><semantics id="footnote3.m3.1b"><msup id="footnote3.m3.1.2" xref="footnote3.m3.1.2.cmml"><mi id="footnote3.m3.1.2.2" xref="footnote3.m3.1.2.2.cmml">𝐐</mi><mrow id="footnote3.m3.1.1.1.3" xref="footnote3.m3.1.2.cmml"><mo id="footnote3.m3.1.1.1.3.1" stretchy="false" xref="footnote3.m3.1.2.cmml">(</mo><mn id="footnote3.m3.1.1.1.1" xref="footnote3.m3.1.1.1.1.cmml">0</mn><mo id="footnote3.m3.1.1.1.3.2" stretchy="false" xref="footnote3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="footnote3.m3.1c"><apply id="footnote3.m3.1.2.cmml" xref="footnote3.m3.1.2"><csymbol cd="ambiguous" id="footnote3.m3.1.2.1.cmml" xref="footnote3.m3.1.2">superscript</csymbol><ci id="footnote3.m3.1.2.2.cmml" xref="footnote3.m3.1.2.2">𝐐</ci><cn id="footnote3.m3.1.1.1.1.cmml" type="integer" xref="footnote3.m3.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m3.1d">\mathbf{Q}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="footnote3.m3.1e">bold_Q start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math>를 <math alttext="\operatorname{Quantize}(\mathbf{W})" class="ltx_Math" display="inline" id="footnote3.m4.2"><semantics id="footnote3.m4.2b"><mrow id="footnote3.m4.2.3.2" xref="footnote3.m4.2.3.1.cmml"><mi id="footnote3.m4.1.1" xref="footnote3.m4.1.1.cmml">Quantize</mi><mo id="footnote3.m4.2.3.2b" xref="footnote3.m4.2.3.1.cmml">⁡</mo><mrow id="footnote3.m4.2.3.2.1" xref="footnote3.m4.2.3.1.cmml"><mo id="footnote3.m4.2.3.2.1.1" stretchy="false" xref="footnote3.m4.2.3.1.cmml">(</mo><mi id="footnote3.m4.2.2" xref="footnote3.m4.2.2.cmml">𝐖</mi><mo id="footnote3.m4.2.3.2.1.2" stretchy="false" xref="footnote3.m4.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m4.2c"><apply id="footnote3.m4.2.3.1.cmml" xref="footnote3.m4.2.3.2"><ci id="footnote3.m4.1.1.cmml" xref="footnote3.m4.1.1">Quantize</ci><ci id="footnote3.m4.2.2.cmml" xref="footnote3.m4.2.2">𝐖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m4.2d">\operatorname{Quantize}(\mathbf{W})</annotation><annotation encoding="application/x-llamapun" id="footnote3.m4.2e">roman_Quantize ( bold_W )</annotation></semantics></math>로 초기화할 때 성능의 유의한 차이는 관찰되지 않았다. </span></span></span> 알고리즘의 각 단계(즉, 무작위화된 SVD 후 양자화)는 <math alttext="4096\times 4096" class="ltx_Math" display="inline" id="S3.SS1.p1.20.m4.1"><semantics id="S3.SS1.p1.20.m4.1a"><mrow id="S3.SS1.p1.20.m4.1.1" xref="S3.SS1.p1.20.m4.1.1.cmml"><mn id="S3.SS1.p1.20.m4.1.1.2" xref="S3.SS1.p1.20.m4.1.1.2.cmml">4096</mn><mo id="S3.SS1.p1.20.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.20.m4.1.1.1.cmml">×</mo><mn id="S3.SS1.p1.20.m4.1.1.3" xref="S3.SS1.p1.20.m4.1.1.3.cmml">4096</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m4.1b"><apply id="S3.SS1.p1.20.m4.1.1.cmml" xref="S3.SS1.p1.20.m4.1.1"><times id="S3.SS1.p1.20.m4.1.1.1.cmml" xref="S3.SS1.p1.20.m4.1.1.1"></times><cn id="S3.SS1.p1.20.m4.1.1.2.cmml" type="integer" xref="S3.SS1.p1.20.m4.1.1.2">4096</cn><cn id="S3.SS1.p1.20.m4.1.1.3.cmml" type="integer" xref="S3.SS1.p1.20.m4.1.1.3">4096</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m4.1c">4096\times 4096</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.20.m4.1d">4096 × 4096</annotation></semantics></math> 행렬에 대한 현대 GPU에서 몇 초가 걸린다.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2311.12023/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="647" height="252" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">도 1:</span>(Left) 분해 에러 <math alttext="\|\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2})\|_{F}" class="ltx_Math" display="inline" id="S3.F1.2.m1.1"><semantics id="S3.F1.2.m1.1b"><msub id="S3.F1.2.m1.1.1" xref="S3.F1.2.m1.1.1.cmml"><mrow id="S3.F1.2.m1.1.1.1.1" xref="S3.F1.2.m1.1.1.1.2.cmml"><mo id="S3.F1.2.m1.1.1.1.1.2" stretchy="false" xref="S3.F1.2.m1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.F1.2.m1.1.1.1.1.1" xref="S3.F1.2.m1.1.1.1.1.1.cmml"><mi id="S3.F1.2.m1.1.1.1.1.1.3" xref="S3.F1.2.m1.1.1.1.1.1.3.cmml">𝐖</mi><mo id="S3.F1.2.m1.1.1.1.1.1.2" xref="S3.F1.2.m1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.F1.2.m1.1.1.1.1.1.1.1" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.F1.2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.F1.2.m1.1.1.1.1.1.1.1.1" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.F1.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="S3.F1.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.1" lspace="0px" rspace="0px" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.1.cmml"></mo><msub id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.F1.2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.F1.2.m1.1.1.1.1.3" stretchy="false" xref="S3.F1.2.m1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.F1.2.m1.1.1.3" xref="S3.F1.2.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.2.m1.1c"><apply id="S3.F1.2.m1.1.1.cmml" xref="S3.F1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.F1.2.m1.1.1.2.cmml" xref="S3.F1.2.m1.1.1">subscript</csymbol><apply id="S3.F1.2.m1.1.1.1.2.cmml" xref="S3.F1.2.m1.1.1.1.1"><csymbol cd="latexml" id="S3.F1.2.m1.1.1.1.2.1.cmml" xref="S3.F1.2.m1.1.1.1.1.2">norm</csymbol><apply id="S3.F1.2.m1.1.1.1.1.1.cmml" xref="S3.F1.2.m1.1.1.1.1.1"><minus id="S3.F1.2.m1.1.1.1.1.1.2.cmml" xref="S3.F1.2.m1.1.1.1.1.1.2"></minus><ci id="S3.F1.2.m1.1.1.1.1.1.3.cmml" xref="S3.F1.2.m1.1.1.1.1.1.3">𝐖</ci><apply id="S3.F1.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1"><plus id="S3.F1.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.F1.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.2">𝐐</ci><apply id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3"><times id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn id="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.F1.2.m1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><ci id="S3.F1.2.m1.1.1.3.cmml" xref="S3.F1.2.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.2.m1.1d">\|\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2})\|_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.2.m1.1e">∥ bold_W - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math> LQ 단계 수의 함수로서 LLaMA-2-7B의 상이한 레이어에 대한 쿼리 프로젝션 매트릭스. (Center) 모든 레이어에 대한 NF-3 양자화에 대한 양자화 오차. (오른쪽) 랭크 = 64인 3비트 양자화에 대한 LQ 분해 에러. LQ 분해는 양자화 에러를 적게 초래한다.</figcaption>
</figure>
<section id="S3.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Preliminary experiments.</h4>

<div id="S3.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.1"><a class="ltx_ref" href="#S3.F1" title="Figure 1 ‣ 3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">1</span></a> (좌)에서 우리는 단계 수의 함수로서 LLaMA-2-7B의 몇 개의 레이어에 대한 분해 오차 <math alttext="\|\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2})\|_{F}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml">𝐖</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.1" lspace="0px" rspace="0px" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml"></mo><msub id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.2">norm</csymbol><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1"><minus id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.2"></minus><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.3">𝐖</ci><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1"><plus id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.2">𝐐</ci><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3"><times id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.m1.1c">\|\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2})\|_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.1.m1.1d">∥ bold_W - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>를 보여준다. 제안된 알고리즘은 휴리스틱(heuristic)이지만 경험적으로 효과적임을 알 수 있었다. 그림 <a class="ltx_ref" href="#S3.F1" title="Figure 1 ‣ 3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">1</span></a> (중심)에서는 모든 행렬에 대해 3비트 NF 양자화에 대한 양자화 오차를 보여주며, 그림 <a class="ltx_ref" href="#S3.F1" title="Figure 1 ‣ 3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">1</span></a> (오른쪽)에서는 LQ 분해에 대한 대응 오차를 보여준다. 두 접근법 모두 값 및 출력 투영 행렬은 더 깊은 층에서 양자화가 어려워지고 키 및 쿼리 행렬은 더 쉬워지지만, LQ 분해는 모든 층에서 바닐라 양자화에 따라 개선될 수 있음을 발견했다.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Mixed-Configuration Quantization via an Integer Linear Program</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.p1.2">LQ-LoRA는 <cite class="ltx_cite ltx_citemacro_citet">Dettmers et al. (<a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite>로부터 NormalFloat(NF) 양자화 방식을 사용하여 각 시간 단계에서 잔차 <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">bold_Q</annotation></semantics></math>를 양자화한다. NF-양자화는 이중 양자화를 위한 분위 빈 수, 블록 수, 비트 수와 같은 전체 압축률에 영향을 미치는 여러 파라미터를 갖는다. 이 논문에서 우리는 다음을 통해 매트릭스 <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_A</annotation></semantics></math>를 양자화하는 약간 다른 변형으로 작업한다:</p>
<table id="S3.Ex1" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S3.Ex1X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1X.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle\widehat{\mathbf{A}},\mathbf{s}=\operatorname{Quantize-NF}\left(\mathbf{A},b_{0},B_{0}\right),\,\,\,\,\,\,\,\," display="inline"><semantics id="S3.Ex1X.2.1.1.m1.5a"><mrow id="S3.Ex1X.2.1.1.m1.5.5.1" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.cmml"><mrow id="S3.Ex1X.2.1.1.m1.5.5.1.1" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.cmml"><mrow id="S3.Ex1X.2.1.1.m1.5.5.1.1.4.2" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.4.1.cmml"><mover accent="true" id="S3.Ex1X.2.1.1.m1.3.3" xref="S3.Ex1X.2.1.1.m1.3.3.cmml"><mi id="S3.Ex1X.2.1.1.m1.3.3.2" xref="S3.Ex1X.2.1.1.m1.3.3.2.cmml">𝐀</mi><mo id="S3.Ex1X.2.1.1.m1.3.3.1" xref="S3.Ex1X.2.1.1.m1.3.3.1.cmml">^</mo></mover><mo id="S3.Ex1X.2.1.1.m1.5.5.1.1.4.2.1" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.4.1.cmml">,</mo><mi id="S3.Ex1X.2.1.1.m1.4.4" xref="S3.Ex1X.2.1.1.m1.4.4.cmml">𝐬</mi></mrow><mo id="S3.Ex1X.2.1.1.m1.5.5.1.1.3" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.3.cmml"><mrow id="S3.Ex1X.2.1.1.m1.1.1" xref="S3.Ex1X.2.1.1.m1.1.1.cmml"><mi id="S3.Ex1X.2.1.1.m1.1.1.2" xref="S3.Ex1X.2.1.1.m1.1.1.2.cmml">Quantize</mi><mo id="S3.Ex1X.2.1.1.m1.1.1.1" xref="S3.Ex1X.2.1.1.m1.1.1.1.cmml">−</mo><mi id="S3.Ex1X.2.1.1.m1.1.1.3" xref="S3.Ex1X.2.1.1.m1.1.1.3.cmml">NF</mi></mrow><mo id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2a" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.3.cmml">⁡</mo><mrow id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.3.cmml"><mo id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.3" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.3.cmml">(</mo><mi id="S3.Ex1X.2.1.1.m1.2.2" xref="S3.Ex1X.2.1.1.m1.2.2.cmml">𝐀</mi><mo id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.4" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.3.cmml">,</mo><msub id="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.2" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">b</mi><mn id="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.3" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.5" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.3.cmml">,</mo><msub id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.2" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.2.cmml">B</mi><mn id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.3" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.3.cmml">0</mn></msub><mo id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.6" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1X.2.1.1.m1.5.5.1.2" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.2.1.1.m1.5b"><apply id="S3.Ex1X.2.1.1.m1.5.5.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1"><eq id="S3.Ex1X.2.1.1.m1.5.5.1.1.3.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.3"></eq><list id="S3.Ex1X.2.1.1.m1.5.5.1.1.4.1.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.4.2"><apply id="S3.Ex1X.2.1.1.m1.3.3.cmml" xref="S3.Ex1X.2.1.1.m1.3.3"><ci id="S3.Ex1X.2.1.1.m1.3.3.1.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.1">^</ci><ci id="S3.Ex1X.2.1.1.m1.3.3.2.cmml" xref="S3.Ex1X.2.1.1.m1.3.3.2">𝐀</ci></apply><ci id="S3.Ex1X.2.1.1.m1.4.4.cmml" xref="S3.Ex1X.2.1.1.m1.4.4">𝐬</ci></list><apply id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.3.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2"><apply id="S3.Ex1X.2.1.1.m1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.1.1"><minus id="S3.Ex1X.2.1.1.m1.1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.1.1.1"></minus><ci id="S3.Ex1X.2.1.1.m1.1.1.2.cmml" xref="S3.Ex1X.2.1.1.m1.1.1.2">Quantize</ci><ci id="S3.Ex1X.2.1.1.m1.1.1.3.cmml" xref="S3.Ex1X.2.1.1.m1.1.1.3">NF</ci></apply><ci id="S3.Ex1X.2.1.1.m1.2.2.cmml" xref="S3.Ex1X.2.1.1.m1.2.2">𝐀</ci><apply id="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.2">𝑏</ci><cn type="integer" id="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.2">𝐵</ci><cn type="integer" id="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.Ex1X.2.1.1.m1.5.5.1.1.2.2.2.2.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.2.1.1.m1.5c">\displaystyle\widehat{\mathbf{A}},\mathbf{s}=\operatorname{Quantize-NF}\left(\mathbf{A},b_{0},B_{0}\right),\,\,\,\,\,\,\,\,</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1X.2.1.1.m1.5d">over^ start_ARG bold_A end_ARG , bold_s = start_OPFUNCTION roman_Quantize - roman_NF end_OPFUNCTION ( bold_A , italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1X.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle\widehat{\mathbf{s}},\mathbf{v}=\operatorname{Quantize-INT}\left(\mathbf{s},b_{1},B_{1}\right)," display="inline"><semantics id="S3.Ex1X.3.2.2.m1.5a"><mrow id="S3.Ex1X.3.2.2.m1.5.5.1" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.cmml"><mrow id="S3.Ex1X.3.2.2.m1.5.5.1.1" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.cmml"><mrow id="S3.Ex1X.3.2.2.m1.5.5.1.1.4.2" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.4.1.cmml"><mover accent="true" id="S3.Ex1X.3.2.2.m1.3.3" xref="S3.Ex1X.3.2.2.m1.3.3.cmml"><mi id="S3.Ex1X.3.2.2.m1.3.3.2" xref="S3.Ex1X.3.2.2.m1.3.3.2.cmml">𝐬</mi><mo id="S3.Ex1X.3.2.2.m1.3.3.1" xref="S3.Ex1X.3.2.2.m1.3.3.1.cmml">^</mo></mover><mo id="S3.Ex1X.3.2.2.m1.5.5.1.1.4.2.1" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.4.1.cmml">,</mo><mi id="S3.Ex1X.3.2.2.m1.4.4" xref="S3.Ex1X.3.2.2.m1.4.4.cmml">𝐯</mi></mrow><mo id="S3.Ex1X.3.2.2.m1.5.5.1.1.3" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.3.cmml"><mrow id="S3.Ex1X.3.2.2.m1.1.1" xref="S3.Ex1X.3.2.2.m1.1.1.cmml"><mi id="S3.Ex1X.3.2.2.m1.1.1.2" xref="S3.Ex1X.3.2.2.m1.1.1.2.cmml">Quantize</mi><mo id="S3.Ex1X.3.2.2.m1.1.1.1" xref="S3.Ex1X.3.2.2.m1.1.1.1.cmml">−</mo><mi id="S3.Ex1X.3.2.2.m1.1.1.3" xref="S3.Ex1X.3.2.2.m1.1.1.3.cmml">INT</mi></mrow><mo id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2a" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.3.cmml">⁡</mo><mrow id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.3.cmml"><mo id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.3" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.3.cmml">(</mo><mi id="S3.Ex1X.3.2.2.m1.2.2" xref="S3.Ex1X.3.2.2.m1.2.2.cmml">𝐬</mi><mo id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.4" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.3.cmml">,</mo><msub id="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.2" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml">b</mi><mn id="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.3" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.5" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.3.cmml">,</mo><msub id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.2" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.cmml">B</mi><mn id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.3" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.6" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1X.3.2.2.m1.5.5.1.2" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.3.2.2.m1.5b"><apply id="S3.Ex1X.3.2.2.m1.5.5.1.1.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1"><eq id="S3.Ex1X.3.2.2.m1.5.5.1.1.3.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.3"></eq><list id="S3.Ex1X.3.2.2.m1.5.5.1.1.4.1.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.4.2"><apply id="S3.Ex1X.3.2.2.m1.3.3.cmml" xref="S3.Ex1X.3.2.2.m1.3.3"><ci id="S3.Ex1X.3.2.2.m1.3.3.1.cmml" xref="S3.Ex1X.3.2.2.m1.3.3.1">^</ci><ci id="S3.Ex1X.3.2.2.m1.3.3.2.cmml" xref="S3.Ex1X.3.2.2.m1.3.3.2">𝐬</ci></apply><ci id="S3.Ex1X.3.2.2.m1.4.4.cmml" xref="S3.Ex1X.3.2.2.m1.4.4">𝐯</ci></list><apply id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.3.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2"><apply id="S3.Ex1X.3.2.2.m1.1.1.cmml" xref="S3.Ex1X.3.2.2.m1.1.1"><minus id="S3.Ex1X.3.2.2.m1.1.1.1.cmml" xref="S3.Ex1X.3.2.2.m1.1.1.1"></minus><ci id="S3.Ex1X.3.2.2.m1.1.1.2.cmml" xref="S3.Ex1X.3.2.2.m1.1.1.2">Quantize</ci><ci id="S3.Ex1X.3.2.2.m1.1.1.3.cmml" xref="S3.Ex1X.3.2.2.m1.1.1.3">INT</ci></apply><ci id="S3.Ex1X.3.2.2.m1.2.2.cmml" xref="S3.Ex1X.3.2.2.m1.2.2">𝐬</ci><apply id="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.2">𝑏</ci><cn type="integer" id="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.2">𝐵</ci><cn type="integer" id="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.Ex1X.3.2.2.m1.5.5.1.1.2.2.2.2.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.3.2.2.m1.5c">\displaystyle\widehat{\mathbf{s}},\mathbf{v}=\operatorname{Quantize-INT}\left(\mathbf{s},b_{1},B_{1}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1X.3.2.2.m1.5d">over^ start_ARG bold_s end_ARG , bold_v = start_OPFUNCTION roman_Quantize - roman_INT end_OPFUNCTION ( bold_s , italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1X.5.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\widehat{\mathbf{v}}=\operatorname{cast}\left(\mathbf{v},b_{2}\right)." display="inline"><semantics id="S3.Ex1X.5.1.1.m1.3a"><mrow id="S3.Ex1X.5.1.1.m1.3.3.1" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.cmml"><mrow id="S3.Ex1X.5.1.1.m1.3.3.1.1" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.cmml"><mover accent="true" id="S3.Ex1X.5.1.1.m1.3.3.1.1.3" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.3.cmml"><mi id="S3.Ex1X.5.1.1.m1.3.3.1.1.3.2" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.3.2.cmml">𝐯</mi><mo id="S3.Ex1X.5.1.1.m1.3.3.1.1.3.1" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.3.1.cmml">^</mo></mover><mo id="S3.Ex1X.5.1.1.m1.3.3.1.1.2" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.2.cmml"><mi id="S3.Ex1X.5.1.1.m1.1.1" xref="S3.Ex1X.5.1.1.m1.1.1.cmml">cast</mi><mo id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1a" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.2.cmml"><mo id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.2.cmml">(</mo><mi id="S3.Ex1X.5.1.1.m1.2.2" xref="S3.Ex1X.5.1.1.m1.2.2.cmml">𝐯</mi><mo id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.2.cmml">,</mo><msub id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.2.cmml">b</mi><mn id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.4" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex1X.5.1.1.m1.3.3.1.2" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.5.1.1.m1.3b"><apply id="S3.Ex1X.5.1.1.m1.3.3.1.1.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1"><eq id="S3.Ex1X.5.1.1.m1.3.3.1.1.2.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.2"></eq><apply id="S3.Ex1X.5.1.1.m1.3.3.1.1.3.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.3"><ci id="S3.Ex1X.5.1.1.m1.3.3.1.1.3.1.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.3.1">^</ci><ci id="S3.Ex1X.5.1.1.m1.3.3.1.1.3.2.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.3.2">𝐯</ci></apply><apply id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1"><ci id="S3.Ex1X.5.1.1.m1.1.1.cmml" xref="S3.Ex1X.5.1.1.m1.1.1">cast</ci><ci id="S3.Ex1X.5.1.1.m1.2.2.cmml" xref="S3.Ex1X.5.1.1.m1.2.2">𝐯</ci><apply id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.2">𝑏</ci><cn type="integer" id="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.5.1.1.m1.3.3.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.5.1.1.m1.3c">\displaystyle\widehat{\mathbf{v}}=\operatorname{cast}\left(\mathbf{v},b_{2}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1X.5.1.1.m1.3d">over^ start_ARG bold_v end_ARG = roman_cast ( bold_v , italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.14">구체적으로, 먼저 비트 크기 <math alttext="b_{0}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m1.1"><semantics id="S3.SS2.p1.3.m1.1a"><msub id="S3.SS2.p1.3.m1.1.1" xref="S3.SS2.p1.3.m1.1.1.cmml"><mi id="S3.SS2.p1.3.m1.1.1.2" xref="S3.SS2.p1.3.m1.1.1.2.cmml">b</mi><mn id="S3.SS2.p1.3.m1.1.1.3" xref="S3.SS2.p1.3.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m1.1b"><apply id="S3.SS2.p1.3.m1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m1.1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m1.1.1.2.cmml" xref="S3.SS2.p1.3.m1.1.1.2">𝑏</ci><cn id="S3.SS2.p1.3.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m1.1c">b_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m1.1d">italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>와 버킷 크기 <math alttext="B_{0}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m2.1"><semantics id="S3.SS2.p1.4.m2.1a"><msub id="S3.SS2.p1.4.m2.1.1" xref="S3.SS2.p1.4.m2.1.1.cmml"><mi id="S3.SS2.p1.4.m2.1.1.2" xref="S3.SS2.p1.4.m2.1.1.2.cmml">B</mi><mn id="S3.SS2.p1.4.m2.1.1.3" xref="S3.SS2.p1.4.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m2.1b"><apply id="S3.SS2.p1.4.m2.1.1.cmml" xref="S3.SS2.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m2.1.1.1.cmml" xref="S3.SS2.p1.4.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m2.1.1.2.cmml" xref="S3.SS2.p1.4.m2.1.1.2">𝐵</ci><cn id="S3.SS2.p1.4.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m2.1c">B_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m2.1d">italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>로 NF-양자화를 적용하여 양자화된 매트릭스 <math alttext="\widehat{\mathbf{A}}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m3.1"><semantics id="S3.SS2.p1.5.m3.1a"><mover accent="true" id="S3.SS2.p1.5.m3.1.1" xref="S3.SS2.p1.5.m3.1.1.cmml"><mi id="S3.SS2.p1.5.m3.1.1.2" xref="S3.SS2.p1.5.m3.1.1.2.cmml">𝐀</mi><mo id="S3.SS2.p1.5.m3.1.1.1" xref="S3.SS2.p1.5.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m3.1b"><apply id="S3.SS2.p1.5.m3.1.1.cmml" xref="S3.SS2.p1.5.m3.1.1"><ci id="S3.SS2.p1.5.m3.1.1.1.cmml" xref="S3.SS2.p1.5.m3.1.1.1">^</ci><ci id="S3.SS2.p1.5.m3.1.1.2.cmml" xref="S3.SS2.p1.5.m3.1.1.2">𝐀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m3.1c">\widehat{\mathbf{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m3.1d">over^ start_ARG bold_A end_ARG</annotation></semantics></math>와 각 블록 <math alttext="\mathbf{s}=[s_{1},\dots,s_{\frac{dk}{B_{0}}}]" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m4.3"><semantics id="S3.SS2.p1.6.m4.3a"><mrow id="S3.SS2.p1.6.m4.3.3" xref="S3.SS2.p1.6.m4.3.3.cmml"><mi id="S3.SS2.p1.6.m4.3.3.4" xref="S3.SS2.p1.6.m4.3.3.4.cmml">𝐬</mi><mo id="S3.SS2.p1.6.m4.3.3.3" xref="S3.SS2.p1.6.m4.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.6.m4.3.3.2.2" xref="S3.SS2.p1.6.m4.3.3.2.3.cmml"><mo id="S3.SS2.p1.6.m4.3.3.2.2.3" stretchy="false" xref="S3.SS2.p1.6.m4.3.3.2.3.cmml">[</mo><msub id="S3.SS2.p1.6.m4.2.2.1.1.1" xref="S3.SS2.p1.6.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.6.m4.2.2.1.1.1.2" xref="S3.SS2.p1.6.m4.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS2.p1.6.m4.2.2.1.1.1.3" xref="S3.SS2.p1.6.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.6.m4.3.3.2.2.4" xref="S3.SS2.p1.6.m4.3.3.2.3.cmml">,</mo><mi id="S3.SS2.p1.6.m4.1.1" mathvariant="normal" xref="S3.SS2.p1.6.m4.1.1.cmml">…</mi><mo id="S3.SS2.p1.6.m4.3.3.2.2.5" xref="S3.SS2.p1.6.m4.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p1.6.m4.3.3.2.2.2" xref="S3.SS2.p1.6.m4.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.6.m4.3.3.2.2.2.2" xref="S3.SS2.p1.6.m4.3.3.2.2.2.2.cmml">s</mi><mfrac id="S3.SS2.p1.6.m4.3.3.2.2.2.3" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.cmml"><mrow id="S3.SS2.p1.6.m4.3.3.2.2.2.3.2" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.cmml"><mi id="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.2" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.2.cmml">d</mi><mo id="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.1" lspace="0px" rspace="0px" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.1.cmml"></mo><mi id="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.3" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.3.cmml">k</mi></mrow><msub id="S3.SS2.p1.6.m4.3.3.2.2.2.3.3" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.cmml"><mi id="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.2" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.2.cmml">B</mi><mn id="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.3" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.3.cmml">0</mn></msub></mfrac></msub><mo id="S3.SS2.p1.6.m4.3.3.2.2.6" stretchy="false" xref="S3.SS2.p1.6.m4.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m4.3b"><apply id="S3.SS2.p1.6.m4.3.3.cmml" xref="S3.SS2.p1.6.m4.3.3"><eq id="S3.SS2.p1.6.m4.3.3.3.cmml" xref="S3.SS2.p1.6.m4.3.3.3"></eq><ci id="S3.SS2.p1.6.m4.3.3.4.cmml" xref="S3.SS2.p1.6.m4.3.3.4">𝐬</ci><list id="S3.SS2.p1.6.m4.3.3.2.3.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2"><apply id="S3.SS2.p1.6.m4.2.2.1.1.1.cmml" xref="S3.SS2.p1.6.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.6.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.6.m4.2.2.1.1.1.2">𝑠</ci><cn id="S3.SS2.p1.6.m4.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.6.m4.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.6.m4.1.1.cmml" xref="S3.SS2.p1.6.m4.1.1">…</ci><apply id="S3.SS2.p1.6.m4.3.3.2.2.2.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m4.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.6.m4.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.2">𝑠</ci><apply id="S3.SS2.p1.6.m4.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3"><divide id="S3.SS2.p1.6.m4.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3"></divide><apply id="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.2"><times id="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.1.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.1"></times><ci id="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.2.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.2">𝑑</ci><ci id="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.3.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.2.3">𝑘</ci></apply><apply id="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.1.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.3">subscript</csymbol><ci id="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.2.cmml" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.2">𝐵</ci><cn id="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.3.cmml" type="integer" xref="S3.SS2.p1.6.m4.3.3.2.2.2.3.3.3">0</cn></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m4.3c">\mathbf{s}=[s_{1},\dots,s_{\frac{dk}{B_{0}}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m4.3d">bold_s = [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT divide start_ARG italic_d italic_k end_ARG start_ARG italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG end_POSTSUBSCRIPT ]</annotation></semantics></math>에 대한 absmax 값을 구한다( §<a class="ltx_ref" href="#S2.SS2" title="2.2 Weight Quantization of Large Language Models ‣ 2 Background ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">2.2</span></a> 참조). 이들 absmax 값은 버킷 크기 <math alttext="B_{1}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m6.1"><semantics id="S3.SS2.p1.8.m6.1a"><msub id="S3.SS2.p1.8.m6.1.1" xref="S3.SS2.p1.8.m6.1.1.cmml"><mi id="S3.SS2.p1.8.m6.1.1.2" xref="S3.SS2.p1.8.m6.1.1.2.cmml">B</mi><mn id="S3.SS2.p1.8.m6.1.1.3" xref="S3.SS2.p1.8.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m6.1b"><apply id="S3.SS2.p1.8.m6.1.1.cmml" xref="S3.SS2.p1.8.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m6.1.1.1.cmml" xref="S3.SS2.p1.8.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m6.1.1.2.cmml" xref="S3.SS2.p1.8.m6.1.1.2">𝐵</ci><cn id="S3.SS2.p1.8.m6.1.1.3.cmml" type="integer" xref="S3.SS2.p1.8.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m6.1c">B_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m6.1d">italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>를 갖는 균일한 정수 양자화를 통해 <math alttext="b_{1}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m5.1"><semantics id="S3.SS2.p1.7.m5.1a"><msub id="S3.SS2.p1.7.m5.1.1" xref="S3.SS2.p1.7.m5.1.1.cmml"><mi id="S3.SS2.p1.7.m5.1.1.2" xref="S3.SS2.p1.7.m5.1.1.2.cmml">b</mi><mn id="S3.SS2.p1.7.m5.1.1.3" xref="S3.SS2.p1.7.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m5.1b"><apply id="S3.SS2.p1.7.m5.1.1.cmml" xref="S3.SS2.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m5.1.1.1.cmml" xref="S3.SS2.p1.7.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m5.1.1.2.cmml" xref="S3.SS2.p1.7.m5.1.1.2">𝑏</ci><cn id="S3.SS2.p1.7.m5.1.1.3.cmml" type="integer" xref="S3.SS2.p1.7.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m5.1c">b_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m5.1d">italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> 비트로 더 양자화되어, <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m8.1"><semantics id="S3.SS2.p1.10.m8.1a"><mi id="S3.SS2.p1.10.m8.1.1" xref="S3.SS2.p1.10.m8.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m8.1b"><ci id="S3.SS2.p1.10.m8.1.1.cmml" xref="S3.SS2.p1.10.m8.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m8.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m8.1d">bold_s</annotation></semantics></math>, 즉 <math alttext="{\mathbf{v}}=[v_{1},\dots v_{\frac{dk}{B_{0}B_{1}}}]" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m9.2"><semantics id="S3.SS2.p1.11.m9.2a"><mrow id="S3.SS2.p1.11.m9.2.2" xref="S3.SS2.p1.11.m9.2.2.cmml"><mi id="S3.SS2.p1.11.m9.2.2.4" xref="S3.SS2.p1.11.m9.2.2.4.cmml">𝐯</mi><mo id="S3.SS2.p1.11.m9.2.2.3" xref="S3.SS2.p1.11.m9.2.2.3.cmml">=</mo><mrow id="S3.SS2.p1.11.m9.2.2.2.2" xref="S3.SS2.p1.11.m9.2.2.2.3.cmml"><mo id="S3.SS2.p1.11.m9.2.2.2.2.3" stretchy="false" xref="S3.SS2.p1.11.m9.2.2.2.3.cmml">[</mo><msub id="S3.SS2.p1.11.m9.1.1.1.1.1" xref="S3.SS2.p1.11.m9.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.11.m9.1.1.1.1.1.2" xref="S3.SS2.p1.11.m9.1.1.1.1.1.2.cmml">v</mi><mn id="S3.SS2.p1.11.m9.1.1.1.1.1.3" xref="S3.SS2.p1.11.m9.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.11.m9.2.2.2.2.4" xref="S3.SS2.p1.11.m9.2.2.2.3.cmml">,</mo><mrow id="S3.SS2.p1.11.m9.2.2.2.2.2" xref="S3.SS2.p1.11.m9.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.11.m9.2.2.2.2.2.2" mathvariant="normal" xref="S3.SS2.p1.11.m9.2.2.2.2.2.2.cmml">…</mi><mo id="S3.SS2.p1.11.m9.2.2.2.2.2.1" lspace="0px" rspace="0px" xref="S3.SS2.p1.11.m9.2.2.2.2.2.1.cmml"></mo><msub id="S3.SS2.p1.11.m9.2.2.2.2.2.3" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p1.11.m9.2.2.2.2.2.3.2" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.2.cmml">v</mi><mfrac id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.cmml"><mrow id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.cmml"><mi id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.2" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.2.cmml">d</mi><mo id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.1" lspace="0px" rspace="0px" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.1.cmml"></mo><mi id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.3" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.3.cmml">k</mi></mrow><mrow id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.cmml"><msub id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.cmml"><mi id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.2" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.2.cmml">B</mi><mn id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.3" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.3.cmml">0</mn></msub><mo id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.1" lspace="0px" rspace="0px" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.1.cmml"></mo><msub id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.cmml"><mi id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.2" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.2.cmml">B</mi><mn id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.3" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.3.cmml">1</mn></msub></mrow></mfrac></msub></mrow><mo id="S3.SS2.p1.11.m9.2.2.2.2.5" stretchy="false" xref="S3.SS2.p1.11.m9.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m9.2b"><apply id="S3.SS2.p1.11.m9.2.2.cmml" xref="S3.SS2.p1.11.m9.2.2"><eq id="S3.SS2.p1.11.m9.2.2.3.cmml" xref="S3.SS2.p1.11.m9.2.2.3"></eq><ci id="S3.SS2.p1.11.m9.2.2.4.cmml" xref="S3.SS2.p1.11.m9.2.2.4">𝐯</ci><interval closure="closed" id="S3.SS2.p1.11.m9.2.2.2.3.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2"><apply id="S3.SS2.p1.11.m9.1.1.1.1.1.cmml" xref="S3.SS2.p1.11.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m9.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.11.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.11.m9.1.1.1.1.1.2">𝑣</ci><cn id="S3.SS2.p1.11.m9.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.11.m9.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.11.m9.2.2.2.2.2.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2"><times id="S3.SS2.p1.11.m9.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.1"></times><ci id="S3.SS2.p1.11.m9.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.2">…</ci><apply id="S3.SS2.p1.11.m9.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m9.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS2.p1.11.m9.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.2">𝑣</ci><apply id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3"><divide id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.1.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3"></divide><apply id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2"><times id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.1.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.1"></times><ci id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.2.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.2">𝑑</ci><ci id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.3.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.2.3">𝑘</ci></apply><apply id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3"><times id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.1.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.1"></times><apply id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.1.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2">subscript</csymbol><ci id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.2.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.2">𝐵</ci><cn id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.3.cmml" type="integer" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.2.3">0</cn></apply><apply id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.1.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.2.cmml" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.2">𝐵</ci><cn id="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.3.cmml" type="integer" xref="S3.SS2.p1.11.m9.2.2.2.2.2.3.3.3.3.3">1</cn></apply></apply></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m9.2c">{\mathbf{v}}=[v_{1},\dots v_{\frac{dk}{B_{0}B_{1}}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m9.2d">bold_v = [ italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … italic_v start_POSTSUBSCRIPT divide start_ARG italic_d italic_k end_ARG start_ARG italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG end_POSTSUBSCRIPT ]</annotation></semantics></math>에 대한 absmax 값과 함께 양자화된 벡터 <math alttext="\widehat{\mathbf{s}}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m7.1"><semantics id="S3.SS2.p1.9.m7.1a"><mover accent="true" id="S3.SS2.p1.9.m7.1.1" xref="S3.SS2.p1.9.m7.1.1.cmml"><mi id="S3.SS2.p1.9.m7.1.1.2" xref="S3.SS2.p1.9.m7.1.1.2.cmml">𝐬</mi><mo id="S3.SS2.p1.9.m7.1.1.1" xref="S3.SS2.p1.9.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m7.1b"><apply id="S3.SS2.p1.9.m7.1.1.cmml" xref="S3.SS2.p1.9.m7.1.1"><ci id="S3.SS2.p1.9.m7.1.1.1.cmml" xref="S3.SS2.p1.9.m7.1.1.1">^</ci><ci id="S3.SS2.p1.9.m7.1.1.2.cmml" xref="S3.SS2.p1.9.m7.1.1.2">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m7.1c">\widehat{\mathbf{s}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m7.1d">over^ start_ARG bold_s end_ARG</annotation></semantics></math>를 얻는다. <span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content">4</sup><span class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>I.e., given <math alttext="v_{1}=\operatorname{absmax}([s_{1},\dots,s_{B_{1}}])" class="ltx_Math" display="inline" id="footnote4.m1.3"><semantics id="footnote4.m1.3b"><mrow id="footnote4.m1.3.3" xref="footnote4.m1.3.3.cmml"><msub id="footnote4.m1.3.3.3" xref="footnote4.m1.3.3.3.cmml"><mi id="footnote4.m1.3.3.3.2" xref="footnote4.m1.3.3.3.2.cmml">v</mi><mn id="footnote4.m1.3.3.3.3" xref="footnote4.m1.3.3.3.3.cmml">1</mn></msub><mo id="footnote4.m1.3.3.2" xref="footnote4.m1.3.3.2.cmml">=</mo><mrow id="footnote4.m1.3.3.1.1" xref="footnote4.m1.3.3.1.2.cmml"><mi id="footnote4.m1.2.2" xref="footnote4.m1.2.2.cmml">absmax</mi><mo id="footnote4.m1.3.3.1.1b" xref="footnote4.m1.3.3.1.2.cmml">⁡</mo><mrow id="footnote4.m1.3.3.1.1.1" xref="footnote4.m1.3.3.1.2.cmml"><mo id="footnote4.m1.3.3.1.1.1.2" stretchy="false" xref="footnote4.m1.3.3.1.2.cmml">(</mo><mrow id="footnote4.m1.3.3.1.1.1.1.2" xref="footnote4.m1.3.3.1.1.1.1.3.cmml"><mo id="footnote4.m1.3.3.1.1.1.1.2.3" stretchy="false" xref="footnote4.m1.3.3.1.1.1.1.3.cmml">[</mo><msub id="footnote4.m1.3.3.1.1.1.1.1.1" xref="footnote4.m1.3.3.1.1.1.1.1.1.cmml"><mi id="footnote4.m1.3.3.1.1.1.1.1.1.2" xref="footnote4.m1.3.3.1.1.1.1.1.1.2.cmml">s</mi><mn id="footnote4.m1.3.3.1.1.1.1.1.1.3" xref="footnote4.m1.3.3.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="footnote4.m1.3.3.1.1.1.1.2.4" xref="footnote4.m1.3.3.1.1.1.1.3.cmml">,</mo><mi id="footnote4.m1.1.1" mathvariant="normal" xref="footnote4.m1.1.1.cmml">…</mi><mo id="footnote4.m1.3.3.1.1.1.1.2.5" xref="footnote4.m1.3.3.1.1.1.1.3.cmml">,</mo><msub id="footnote4.m1.3.3.1.1.1.1.2.2" xref="footnote4.m1.3.3.1.1.1.1.2.2.cmml"><mi id="footnote4.m1.3.3.1.1.1.1.2.2.2" xref="footnote4.m1.3.3.1.1.1.1.2.2.2.cmml">s</mi><msub id="footnote4.m1.3.3.1.1.1.1.2.2.3" xref="footnote4.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="footnote4.m1.3.3.1.1.1.1.2.2.3.2" xref="footnote4.m1.3.3.1.1.1.1.2.2.3.2.cmml">B</mi><mn id="footnote4.m1.3.3.1.1.1.1.2.2.3.3" xref="footnote4.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></msub></msub><mo id="footnote4.m1.3.3.1.1.1.1.2.6" stretchy="false" xref="footnote4.m1.3.3.1.1.1.1.3.cmml">]</mo></mrow><mo id="footnote4.m1.3.3.1.1.1.3" stretchy="false" xref="footnote4.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote4.m1.3c"><apply id="footnote4.m1.3.3.cmml" xref="footnote4.m1.3.3"><eq id="footnote4.m1.3.3.2.cmml" xref="footnote4.m1.3.3.2"></eq><apply id="footnote4.m1.3.3.3.cmml" xref="footnote4.m1.3.3.3"><csymbol cd="ambiguous" id="footnote4.m1.3.3.3.1.cmml" xref="footnote4.m1.3.3.3">subscript</csymbol><ci id="footnote4.m1.3.3.3.2.cmml" xref="footnote4.m1.3.3.3.2">𝑣</ci><cn id="footnote4.m1.3.3.3.3.cmml" type="integer" xref="footnote4.m1.3.3.3.3">1</cn></apply><apply id="footnote4.m1.3.3.1.2.cmml" xref="footnote4.m1.3.3.1.1"><ci id="footnote4.m1.2.2.cmml" xref="footnote4.m1.2.2">absmax</ci><list id="footnote4.m1.3.3.1.1.1.1.3.cmml" xref="footnote4.m1.3.3.1.1.1.1.2"><apply id="footnote4.m1.3.3.1.1.1.1.1.1.cmml" xref="footnote4.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="footnote4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="footnote4.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="footnote4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="footnote4.m1.3.3.1.1.1.1.1.1.2">𝑠</ci><cn id="footnote4.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="footnote4.m1.3.3.1.1.1.1.1.1.3">1</cn></apply><ci id="footnote4.m1.1.1.cmml" xref="footnote4.m1.1.1">…</ci><apply id="footnote4.m1.3.3.1.1.1.1.2.2.cmml" xref="footnote4.m1.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="footnote4.m1.3.3.1.1.1.1.2.2.1.cmml" xref="footnote4.m1.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="footnote4.m1.3.3.1.1.1.1.2.2.2.cmml" xref="footnote4.m1.3.3.1.1.1.1.2.2.2">𝑠</ci><apply id="footnote4.m1.3.3.1.1.1.1.2.2.3.cmml" xref="footnote4.m1.3.3.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="footnote4.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="footnote4.m1.3.3.1.1.1.1.2.2.3">subscript</csymbol><ci id="footnote4.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="footnote4.m1.3.3.1.1.1.1.2.2.3.2">𝐵</ci><cn id="footnote4.m1.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="footnote4.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m1.3d">v_{1}=\operatorname{absmax}([s_{1},\dots,s_{B_{1}}])</annotation><annotation encoding="application/x-llamapun" id="footnote4.m1.3e">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = roman_absmax ( [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] )</annotation></semantics></math> for a group of size <math alttext="B_{1}" class="ltx_Math" display="inline" id="footnote4.m2.1"><semantics id="footnote4.m2.1b"><msub id="footnote4.m2.1.1" xref="footnote4.m2.1.1.cmml"><mi id="footnote4.m2.1.1.2" xref="footnote4.m2.1.1.2.cmml">B</mi><mn id="footnote4.m2.1.1.3" xref="footnote4.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="footnote4.m2.1c"><apply id="footnote4.m2.1.1.cmml" xref="footnote4.m2.1.1"><csymbol cd="ambiguous" id="footnote4.m2.1.1.1.cmml" xref="footnote4.m2.1.1">subscript</csymbol><ci id="footnote4.m2.1.1.2.cmml" xref="footnote4.m2.1.1.2">𝐵</ci><cn id="footnote4.m2.1.1.3.cmml" type="integer" xref="footnote4.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m2.1d">B_{1}</annotation><annotation encoding="application/x-llamapun" id="footnote4.m2.1e">italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> we have <math alttext="\hat{s}_{i}=\operatorname{clamp}\left(\lfloor\frac{s_{i}}{v_{1}}\rceil;0,2^{b_{1}-1}\right)" class="ltx_math_unparsed" display="inline" id="footnote4.m3.1"><semantics id="footnote4.m3.1b"><mrow id="footnote4.m3.1c"><msub id="footnote4.m3.1.1"><mover accent="true" id="footnote4.m3.1.1.2"><mi id="footnote4.m3.1.1.2.2">s</mi><mo id="footnote4.m3.1.1.2.1">^</mo></mover><mi id="footnote4.m3.1.1.3">i</mi></msub><mo id="footnote4.m3.1.2">=</mo><mi id="footnote4.m3.1.3">clamp</mi><mrow id="footnote4.m3.1.4"><mo id="footnote4.m3.1.4.1">(</mo><mrow id="footnote4.m3.1.4.2"><mo id="footnote4.m3.1.4.2.1" stretchy="false">⌊</mo><mfrac id="footnote4.m3.1.4.2.2"><msub id="footnote4.m3.1.4.2.2.2"><mi id="footnote4.m3.1.4.2.2.2.2">s</mi><mi id="footnote4.m3.1.4.2.2.2.3">i</mi></msub><msub id="footnote4.m3.1.4.2.2.3"><mi id="footnote4.m3.1.4.2.2.3.2">v</mi><mn id="footnote4.m3.1.4.2.2.3.3">1</mn></msub></mfrac><mo id="footnote4.m3.1.4.2.3" stretchy="false">⌉</mo></mrow><mo id="footnote4.m3.1.4.3">;</mo><mn id="footnote4.m3.1.4.4">0</mn><mo id="footnote4.m3.1.4.5">,</mo><msup id="footnote4.m3.1.4.6"><mn id="footnote4.m3.1.4.6.2">2</mn><mrow id="footnote4.m3.1.4.6.3"><msub id="footnote4.m3.1.4.6.3.2"><mi id="footnote4.m3.1.4.6.3.2.2">b</mi><mn id="footnote4.m3.1.4.6.3.2.3">1</mn></msub><mo id="footnote4.m3.1.4.6.3.1">−</mo><mn id="footnote4.m3.1.4.6.3.3">1</mn></mrow></msup><mo id="footnote4.m3.1.4.7">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="footnote4.m3.1d">\hat{s}_{i}=\operatorname{clamp}\left(\lfloor\frac{s_{i}}{v_{1}}\rceil;0,2^{b_{1}-1}\right)</annotation><annotation encoding="application/x-llamapun" id="footnote4.m3.1e">over^ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = roman_clamp ( ⌊ divide start_ARG italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG ⌉ ; 0 , 2 start_POSTSUPERSCRIPT italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT - 1 end_POSTSUPERSCRIPT )</annotation></semantics></math>. </span></span></span> 마지막으로 <math alttext="\mathbf{v}" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m10.1"><semantics id="S3.SS2.p1.12.m10.1a"><mi id="S3.SS2.p1.12.m10.1.1" xref="S3.SS2.p1.12.m10.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m10.1b"><ci id="S3.SS2.p1.12.m10.1.1.cmml" xref="S3.SS2.p1.12.m10.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m10.1c">\mathbf{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m10.1d">bold_v</annotation></semantics></math>를 <math alttext="b_{2}" class="ltx_Math" display="inline" id="S3.SS2.p1.13.m11.1"><semantics id="S3.SS2.p1.13.m11.1a"><msub id="S3.SS2.p1.13.m11.1.1" xref="S3.SS2.p1.13.m11.1.1.cmml"><mi id="S3.SS2.p1.13.m11.1.1.2" xref="S3.SS2.p1.13.m11.1.1.2.cmml">b</mi><mn id="S3.SS2.p1.13.m11.1.1.3" xref="S3.SS2.p1.13.m11.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m11.1b"><apply id="S3.SS2.p1.13.m11.1.1.cmml" xref="S3.SS2.p1.13.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m11.1.1.1.cmml" xref="S3.SS2.p1.13.m11.1.1">subscript</csymbol><ci id="S3.SS2.p1.13.m11.1.1.2.cmml" xref="S3.SS2.p1.13.m11.1.1.2">𝑏</ci><cn id="S3.SS2.p1.13.m11.1.1.3.cmml" type="integer" xref="S3.SS2.p1.13.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m11.1c">b_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.13.m11.1d">italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> 비트로 캐스팅하여 <math alttext="\widehat{\mathbf{s}_{1}}" class="ltx_Math" display="inline" id="S3.SS2.p1.14.m12.1"><semantics id="S3.SS2.p1.14.m12.1a"><mover accent="true" id="S3.SS2.p1.14.m12.1.1" xref="S3.SS2.p1.14.m12.1.1.cmml"><msub id="S3.SS2.p1.14.m12.1.1.2" xref="S3.SS2.p1.14.m12.1.1.2.cmml"><mi id="S3.SS2.p1.14.m12.1.1.2.2" xref="S3.SS2.p1.14.m12.1.1.2.2.cmml">𝐬</mi><mn id="S3.SS2.p1.14.m12.1.1.2.3" xref="S3.SS2.p1.14.m12.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.p1.14.m12.1.1.1" xref="S3.SS2.p1.14.m12.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m12.1b"><apply id="S3.SS2.p1.14.m12.1.1.cmml" xref="S3.SS2.p1.14.m12.1.1"><ci id="S3.SS2.p1.14.m12.1.1.1.cmml" xref="S3.SS2.p1.14.m12.1.1.1">^</ci><apply id="S3.SS2.p1.14.m12.1.1.2.cmml" xref="S3.SS2.p1.14.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m12.1.1.2.1.cmml" xref="S3.SS2.p1.14.m12.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.14.m12.1.1.2.2.cmml" xref="S3.SS2.p1.14.m12.1.1.2.2">𝐬</ci><cn id="S3.SS2.p1.14.m12.1.1.2.3.cmml" type="integer" xref="S3.SS2.p1.14.m12.1.1.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m12.1c">\widehat{\mathbf{s}_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.14.m12.1d">over^ start_ARG bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>를 얻는다. <span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content">5</sup><span class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>이 접근법은 <span class="ltx_text ltx_font_typewriter" id="footnote5.1">FP8</span>(이는 결과에 영향을 주지 않음)과 반대로 <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="footnote5.m1.1"><semantics id="footnote5.m1.1b"><mi id="footnote5.m1.1.1" xref="footnote5.m1.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="footnote5.m1.1c"><ci id="footnote5.m1.1.1.cmml" xref="footnote5.m1.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m1.1d">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="footnote5.m1.1e">bold_s</annotation></semantics></math>에 정수 양자화를 사용한다는 점에서 원래 접근법에서 벗어난다. 미세 조정 및 추론을 위해 즉석에서 필요한</span></span></span> Dequantization은 이 프로세스를 단순히 반전시킵니다.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.p2.4">이러한 양자화 방식은 <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">bold_A</annotation></semantics></math>를 표현하기 위해 <math alttext="\widehat{\mathbf{A}},\widehat{\mathbf{s}},\widehat{\mathbf{v}}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.3"><semantics id="S3.SS2.p2.1.m1.3a"><mrow id="S3.SS2.p2.1.m1.3.4.2" xref="S3.SS2.p2.1.m1.3.4.1.cmml"><mover accent="true" id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">𝐀</mi><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">^</mo></mover><mo id="S3.SS2.p2.1.m1.3.4.2.1" xref="S3.SS2.p2.1.m1.3.4.1.cmml">,</mo><mover accent="true" id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml"><mi id="S3.SS2.p2.1.m1.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.cmml">𝐬</mi><mo id="S3.SS2.p2.1.m1.2.2.1" xref="S3.SS2.p2.1.m1.2.2.1.cmml">^</mo></mover><mo id="S3.SS2.p2.1.m1.3.4.2.2" xref="S3.SS2.p2.1.m1.3.4.1.cmml">,</mo><mover accent="true" id="S3.SS2.p2.1.m1.3.3" xref="S3.SS2.p2.1.m1.3.3.cmml"><mi id="S3.SS2.p2.1.m1.3.3.2" xref="S3.SS2.p2.1.m1.3.3.2.cmml">𝐯</mi><mo id="S3.SS2.p2.1.m1.3.3.1" xref="S3.SS2.p2.1.m1.3.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.3b"><list id="S3.SS2.p2.1.m1.3.4.1.cmml" xref="S3.SS2.p2.1.m1.3.4.2"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><ci id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1">^</ci><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐀</ci></apply><apply id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2"><ci id="S3.SS2.p2.1.m1.2.2.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1">^</ci><ci id="S3.SS2.p2.1.m1.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2">𝐬</ci></apply><apply id="S3.SS2.p2.1.m1.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3"><ci id="S3.SS2.p2.1.m1.3.3.1.cmml" xref="S3.SS2.p2.1.m1.3.3.1">^</ci><ci id="S3.SS2.p2.1.m1.3.3.2.cmml" xref="S3.SS2.p2.1.m1.3.3.2">𝐯</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.3c">\widehat{\mathbf{A}},\widehat{\mathbf{s}},\widehat{\mathbf{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.3d">over^ start_ARG bold_A end_ARG , over^ start_ARG bold_s end_ARG , over^ start_ARG bold_v end_ARG</annotation></semantics></math>를 저장할 필요가 있다. 따라서 <math alttext="c=(b_{0},b_{1},b_{2},B_{0},B_{1})" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.5"><semantics id="S3.SS2.p2.4.m4.5a"><mrow id="S3.SS2.p2.4.m4.5.5" xref="S3.SS2.p2.4.m4.5.5.cmml"><mi id="S3.SS2.p2.4.m4.5.5.7" xref="S3.SS2.p2.4.m4.5.5.7.cmml">c</mi><mo id="S3.SS2.p2.4.m4.5.5.6" xref="S3.SS2.p2.4.m4.5.5.6.cmml">=</mo><mrow id="S3.SS2.p2.4.m4.5.5.5.5" xref="S3.SS2.p2.4.m4.5.5.5.6.cmml"><mo id="S3.SS2.p2.4.m4.5.5.5.5.6" stretchy="false" xref="S3.SS2.p2.4.m4.5.5.5.6.cmml">(</mo><msub id="S3.SS2.p2.4.m4.1.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.1.1.2" xref="S3.SS2.p2.4.m4.1.1.1.1.1.2.cmml">b</mi><mn id="S3.SS2.p2.4.m4.1.1.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.p2.4.m4.5.5.5.5.7" xref="S3.SS2.p2.4.m4.5.5.5.6.cmml">,</mo><msub id="S3.SS2.p2.4.m4.2.2.2.2.2" xref="S3.SS2.p2.4.m4.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.4.m4.2.2.2.2.2.2" xref="S3.SS2.p2.4.m4.2.2.2.2.2.2.cmml">b</mi><mn id="S3.SS2.p2.4.m4.2.2.2.2.2.3" xref="S3.SS2.p2.4.m4.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.p2.4.m4.5.5.5.5.8" xref="S3.SS2.p2.4.m4.5.5.5.6.cmml">,</mo><msub id="S3.SS2.p2.4.m4.3.3.3.3.3" xref="S3.SS2.p2.4.m4.3.3.3.3.3.cmml"><mi id="S3.SS2.p2.4.m4.3.3.3.3.3.2" xref="S3.SS2.p2.4.m4.3.3.3.3.3.2.cmml">b</mi><mn id="S3.SS2.p2.4.m4.3.3.3.3.3.3" xref="S3.SS2.p2.4.m4.3.3.3.3.3.3.cmml">2</mn></msub><mo id="S3.SS2.p2.4.m4.5.5.5.5.9" xref="S3.SS2.p2.4.m4.5.5.5.6.cmml">,</mo><msub id="S3.SS2.p2.4.m4.4.4.4.4.4" xref="S3.SS2.p2.4.m4.4.4.4.4.4.cmml"><mi id="S3.SS2.p2.4.m4.4.4.4.4.4.2" xref="S3.SS2.p2.4.m4.4.4.4.4.4.2.cmml">B</mi><mn id="S3.SS2.p2.4.m4.4.4.4.4.4.3" xref="S3.SS2.p2.4.m4.4.4.4.4.4.3.cmml">0</mn></msub><mo id="S3.SS2.p2.4.m4.5.5.5.5.10" xref="S3.SS2.p2.4.m4.5.5.5.6.cmml">,</mo><msub id="S3.SS2.p2.4.m4.5.5.5.5.5" xref="S3.SS2.p2.4.m4.5.5.5.5.5.cmml"><mi id="S3.SS2.p2.4.m4.5.5.5.5.5.2" xref="S3.SS2.p2.4.m4.5.5.5.5.5.2.cmml">B</mi><mn id="S3.SS2.p2.4.m4.5.5.5.5.5.3" xref="S3.SS2.p2.4.m4.5.5.5.5.5.3.cmml">1</mn></msub><mo id="S3.SS2.p2.4.m4.5.5.5.5.11" stretchy="false" xref="S3.SS2.p2.4.m4.5.5.5.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.5b"><apply id="S3.SS2.p2.4.m4.5.5.cmml" xref="S3.SS2.p2.4.m4.5.5"><eq id="S3.SS2.p2.4.m4.5.5.6.cmml" xref="S3.SS2.p2.4.m4.5.5.6"></eq><ci id="S3.SS2.p2.4.m4.5.5.7.cmml" xref="S3.SS2.p2.4.m4.5.5.7">𝑐</ci><vector id="S3.SS2.p2.4.m4.5.5.5.6.cmml" xref="S3.SS2.p2.4.m4.5.5.5.5"><apply id="S3.SS2.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.2">𝑏</ci><cn id="S3.SS2.p2.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.4.m4.1.1.1.1.1.3">0</cn></apply><apply id="S3.SS2.p2.4.m4.2.2.2.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2.2.2">𝑏</ci><cn id="S3.SS2.p2.4.m4.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.p2.4.m4.2.2.2.2.2.3">1</cn></apply><apply id="S3.SS2.p2.4.m4.3.3.3.3.3.cmml" xref="S3.SS2.p2.4.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.3.3.3.3.3.1.cmml" xref="S3.SS2.p2.4.m4.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p2.4.m4.3.3.3.3.3.2.cmml" xref="S3.SS2.p2.4.m4.3.3.3.3.3.2">𝑏</ci><cn id="S3.SS2.p2.4.m4.3.3.3.3.3.3.cmml" type="integer" xref="S3.SS2.p2.4.m4.3.3.3.3.3.3">2</cn></apply><apply id="S3.SS2.p2.4.m4.4.4.4.4.4.cmml" xref="S3.SS2.p2.4.m4.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.4.4.4.4.4.1.cmml" xref="S3.SS2.p2.4.m4.4.4.4.4.4">subscript</csymbol><ci id="S3.SS2.p2.4.m4.4.4.4.4.4.2.cmml" xref="S3.SS2.p2.4.m4.4.4.4.4.4.2">𝐵</ci><cn id="S3.SS2.p2.4.m4.4.4.4.4.4.3.cmml" type="integer" xref="S3.SS2.p2.4.m4.4.4.4.4.4.3">0</cn></apply><apply id="S3.SS2.p2.4.m4.5.5.5.5.5.cmml" xref="S3.SS2.p2.4.m4.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.5.5.5.5.5.1.cmml" xref="S3.SS2.p2.4.m4.5.5.5.5.5">subscript</csymbol><ci id="S3.SS2.p2.4.m4.5.5.5.5.5.2.cmml" xref="S3.SS2.p2.4.m4.5.5.5.5.5.2">𝐵</ci><cn id="S3.SS2.p2.4.m4.5.5.5.5.5.3.cmml" type="integer" xref="S3.SS2.p2.4.m4.5.5.5.5.5.3">1</cn></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.5c">c=(b_{0},b_{1},b_{2},B_{0},B_{1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.5d">italic_c = ( italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math>와 같은 구성이 주어진 <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">bold_A</annotation></semantics></math>를 저장하기 위한 저장 비용(비트 수)을 정량화할 수 있다.</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.6" class="ltx_Math" alttext="\operatorname{storage}(\mathbf{A},c)=\operatorname{sizeof}(\mathbf{A})\cdot\left(b_{0}+\frac{b_{1}}{B_{0}}+\frac{b_{2}}{B_{0}\cdot B_{1}}\right)." display="block"><semantics id="S3.E3.m1.6a"><mrow id="S3.E3.m1.6.6.1" xref="S3.E3.m1.6.6.1.1.cmml"><mrow id="S3.E3.m1.6.6.1.1" xref="S3.E3.m1.6.6.1.1.cmml"><mrow id="S3.E3.m1.6.6.1.1.3.2" xref="S3.E3.m1.6.6.1.1.3.1.cmml"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">storage</mi><mo id="S3.E3.m1.6.6.1.1.3.2a" xref="S3.E3.m1.6.6.1.1.3.1.cmml">⁡</mo><mrow id="S3.E3.m1.6.6.1.1.3.2.1" xref="S3.E3.m1.6.6.1.1.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.6.6.1.1.3.2.1.1" xref="S3.E3.m1.6.6.1.1.3.1.cmml">(</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝐀</mi><mo id="S3.E3.m1.6.6.1.1.3.2.1.2" xref="S3.E3.m1.6.6.1.1.3.1.cmml">,</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">c</mi><mo stretchy="false" id="S3.E3.m1.6.6.1.1.3.2.1.3" xref="S3.E3.m1.6.6.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.6.6.1.1.2" xref="S3.E3.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.6.6.1.1.1" xref="S3.E3.m1.6.6.1.1.1.cmml"><mrow id="S3.E3.m1.6.6.1.1.1.3.2" xref="S3.E3.m1.6.6.1.1.1.3.1.cmml"><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">sizeof</mi><mo id="S3.E3.m1.6.6.1.1.1.3.2a" xref="S3.E3.m1.6.6.1.1.1.3.1.cmml">⁡</mo><mrow id="S3.E3.m1.6.6.1.1.1.3.2.1" xref="S3.E3.m1.6.6.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.6.6.1.1.1.3.2.1.1" xref="S3.E3.m1.6.6.1.1.1.3.1.cmml">(</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">𝐀</mi><mo rspace="0.055em" stretchy="false" id="S3.E3.m1.6.6.1.1.1.3.2.1.2" xref="S3.E3.m1.6.6.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E3.m1.6.6.1.1.1.2" xref="S3.E3.m1.6.6.1.1.1.2.cmml">⋅</mo><mrow id="S3.E3.m1.6.6.1.1.1.1.1" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.6.6.1.1.1.1.1.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.6.6.1.1.1.1.1.1" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.6.6.1.1.1.1.1.1.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.6.6.1.1.1.1.1.1.2.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.2.2.cmml">b</mi><mn id="S3.E3.m1.6.6.1.1.1.1.1.1.2.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S3.E3.m1.6.6.1.1.1.1.1.1.1" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.cmml">+</mo><mfrac id="S3.E3.m1.6.6.1.1.1.1.1.1.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.cmml"><msub id="S3.E3.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.2.cmml">b</mi><mn id="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><msub id="S3.E3.m1.6.6.1.1.1.1.1.1.3.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.2.cmml">B</mi><mn id="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.3.cmml">0</mn></msub></mfrac><mo id="S3.E3.m1.6.6.1.1.1.1.1.1.1a" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1.cmml">+</mo><mfrac id="S3.E3.m1.6.6.1.1.1.1.1.1.4" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.cmml"><msub id="S3.E3.m1.6.6.1.1.1.1.1.1.4.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.2.cmml">b</mi><mn id="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.3.cmml">2</mn></msub><mrow id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.cmml"><msub id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.cmml"><mi id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.2.cmml">B</mi><mn id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.3.cmml">0</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.1" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.1.cmml">⋅</mo><msub id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.cmml"><mi id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.2.cmml">B</mi><mn id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.3.cmml">1</mn></msub></mrow></mfrac></mrow><mo id="S3.E3.m1.6.6.1.1.1.1.1.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.6.6.1.2" xref="S3.E3.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.6b"><apply id="S3.E3.m1.6.6.1.1.cmml" xref="S3.E3.m1.6.6.1"><eq id="S3.E3.m1.6.6.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.2"></eq><apply id="S3.E3.m1.6.6.1.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">storage</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝐀</ci><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑐</ci></apply><apply id="S3.E3.m1.6.6.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1"><ci id="S3.E3.m1.6.6.1.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.1.2">⋅</ci><apply id="S3.E3.m1.6.6.1.1.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.1.3.2"><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">sizeof</ci><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝐀</ci></apply><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1"><plus id="S3.E3.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.2.2">𝑏</ci><cn type="integer" id="S3.E3.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.2.3">0</cn></apply><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3"><divide id="S3.E3.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3"></divide><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.2">𝑏</ci><cn type="integer" id="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.2">𝐵</ci><cn type="integer" id="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.3.3.3">0</cn></apply></apply><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4"><divide id="S3.E3.m1.6.6.1.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4"></divide><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.2">𝑏</ci><cn type="integer" id="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.2.3">2</cn></apply><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3"><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.1">⋅</ci><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.2">𝐵</ci><cn type="integer" id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.2.3">0</cn></apply><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.2">𝐵</ci><cn type="integer" id="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.4.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.6c">\operatorname{storage}(\mathbf{A},c)=\operatorname{sizeof}(\mathbf{A})\cdot\left(b_{0}+\frac{b_{1}}{B_{0}}+\frac{b_{2}}{B_{0}\cdot B_{1}}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.6d">roman_storage ( bold_A , italic_c ) = roman_sizeof ( bold_A ) ⋅ ( italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + divide start_ARG italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG + divide start_ARG italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ⋅ italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.8" class="ltx_p">The original NF-<math id="S3.SS2.p2.5.m1.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S3.SS2.p2.5.m1.1a"><mn id="S3.SS2.p2.5.m1.1.1" xref="S3.SS2.p2.5.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m1.1b"><cn type="integer" id="S3.SS2.p2.5.m1.1.1.cmml" xref="S3.SS2.p2.5.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m1.1d">4</annotation></semantics></math> double quantization is a special case with <math id="S3.SS2.p2.6.m2.5" class="ltx_Math" alttext="c_{\operatorname{NF4}}=(4,8,\texttt{fp32},64,256)" display="inline"><semantics id="S3.SS2.p2.6.m2.5a"><mrow id="S3.SS2.p2.6.m2.5.6" xref="S3.SS2.p2.6.m2.5.6.cmml"><msub id="S3.SS2.p2.6.m2.5.6.2" xref="S3.SS2.p2.6.m2.5.6.2.cmml"><mi id="S3.SS2.p2.6.m2.5.6.2.2" xref="S3.SS2.p2.6.m2.5.6.2.2.cmml">c</mi><mi id="S3.SS2.p2.6.m2.5.6.2.3" xref="S3.SS2.p2.6.m2.5.6.2.3.cmml">NF4</mi></msub><mo id="S3.SS2.p2.6.m2.5.6.1" xref="S3.SS2.p2.6.m2.5.6.1.cmml">=</mo><mrow id="S3.SS2.p2.6.m2.5.6.3.2" xref="S3.SS2.p2.6.m2.5.6.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m2.5.6.3.2.1" xref="S3.SS2.p2.6.m2.5.6.3.1.cmml">(</mo><mn id="S3.SS2.p2.6.m2.1.1" xref="S3.SS2.p2.6.m2.1.1.cmml">4</mn><mo id="S3.SS2.p2.6.m2.5.6.3.2.2" xref="S3.SS2.p2.6.m2.5.6.3.1.cmml">,</mo><mn id="S3.SS2.p2.6.m2.2.2" xref="S3.SS2.p2.6.m2.2.2.cmml">8</mn><mo id="S3.SS2.p2.6.m2.5.6.3.2.3" xref="S3.SS2.p2.6.m2.5.6.3.1.cmml">,</mo><mtext id="S3.SS2.p2.6.m2.3.3" xref="S3.SS2.p2.6.m2.3.3a.cmml">𝚏𝚙𝟹𝟸</mtext><mo id="S3.SS2.p2.6.m2.5.6.3.2.4" xref="S3.SS2.p2.6.m2.5.6.3.1.cmml">,</mo><mn id="S3.SS2.p2.6.m2.4.4" xref="S3.SS2.p2.6.m2.4.4.cmml">64</mn><mo id="S3.SS2.p2.6.m2.5.6.3.2.5" xref="S3.SS2.p2.6.m2.5.6.3.1.cmml">,</mo><mn id="S3.SS2.p2.6.m2.5.5" xref="S3.SS2.p2.6.m2.5.5.cmml">256</mn><mo stretchy="false" id="S3.SS2.p2.6.m2.5.6.3.2.6" xref="S3.SS2.p2.6.m2.5.6.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m2.5b"><apply id="S3.SS2.p2.6.m2.5.6.cmml" xref="S3.SS2.p2.6.m2.5.6"><eq id="S3.SS2.p2.6.m2.5.6.1.cmml" xref="S3.SS2.p2.6.m2.5.6.1"></eq><apply id="S3.SS2.p2.6.m2.5.6.2.cmml" xref="S3.SS2.p2.6.m2.5.6.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m2.5.6.2.1.cmml" xref="S3.SS2.p2.6.m2.5.6.2">subscript</csymbol><ci id="S3.SS2.p2.6.m2.5.6.2.2.cmml" xref="S3.SS2.p2.6.m2.5.6.2.2">𝑐</ci><ci id="S3.SS2.p2.6.m2.5.6.2.3.cmml" xref="S3.SS2.p2.6.m2.5.6.2.3">NF4</ci></apply><vector id="S3.SS2.p2.6.m2.5.6.3.1.cmml" xref="S3.SS2.p2.6.m2.5.6.3.2"><cn type="integer" id="S3.SS2.p2.6.m2.1.1.cmml" xref="S3.SS2.p2.6.m2.1.1">4</cn><cn type="integer" id="S3.SS2.p2.6.m2.2.2.cmml" xref="S3.SS2.p2.6.m2.2.2">8</cn><ci id="S3.SS2.p2.6.m2.3.3a.cmml" xref="S3.SS2.p2.6.m2.3.3"><mtext id="S3.SS2.p2.6.m2.3.3.cmml" xref="S3.SS2.p2.6.m2.3.3">𝚏𝚙𝟹𝟸</mtext></ci><cn type="integer" id="S3.SS2.p2.6.m2.4.4.cmml" xref="S3.SS2.p2.6.m2.4.4">64</cn><cn type="integer" id="S3.SS2.p2.6.m2.5.5.cmml" xref="S3.SS2.p2.6.m2.5.5">256</cn></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m2.5c">c_{\operatorname{NF4}}=(4,8,\texttt{fp32},64,256)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m2.5d">italic_c start_POSTSUBSCRIPT NF4 end_POSTSUBSCRIPT = ( 4 , 8 , fp32 , 64 , 256 )</annotation></semantics></math> and <math id="S3.SS2.p2.7.m3.5" class="ltx_Math" alttext="\operatorname{storage}(\mathbf{A},c_{\operatorname{NF4}})=4.127\cdot\operatorname{sizeof}(\mathbf{A})" display="inline"><semantics id="S3.SS2.p2.7.m3.5a"><mrow id="S3.SS2.p2.7.m3.5.5" xref="S3.SS2.p2.7.m3.5.5.cmml"><mrow id="S3.SS2.p2.7.m3.5.5.1.1" xref="S3.SS2.p2.7.m3.5.5.1.2.cmml"><mi id="S3.SS2.p2.7.m3.1.1" xref="S3.SS2.p2.7.m3.1.1.cmml">storage</mi><mo id="S3.SS2.p2.7.m3.5.5.1.1a" xref="S3.SS2.p2.7.m3.5.5.1.2.cmml">⁡</mo><mrow id="S3.SS2.p2.7.m3.5.5.1.1.1" xref="S3.SS2.p2.7.m3.5.5.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.7.m3.5.5.1.1.1.2" xref="S3.SS2.p2.7.m3.5.5.1.2.cmml">(</mo><mi id="S3.SS2.p2.7.m3.2.2" xref="S3.SS2.p2.7.m3.2.2.cmml">𝐀</mi><mo id="S3.SS2.p2.7.m3.5.5.1.1.1.3" xref="S3.SS2.p2.7.m3.5.5.1.2.cmml">,</mo><msub id="S3.SS2.p2.7.m3.5.5.1.1.1.1" xref="S3.SS2.p2.7.m3.5.5.1.1.1.1.cmml"><mi id="S3.SS2.p2.7.m3.5.5.1.1.1.1.2" xref="S3.SS2.p2.7.m3.5.5.1.1.1.1.2.cmml">c</mi><mi id="S3.SS2.p2.7.m3.5.5.1.1.1.1.3" xref="S3.SS2.p2.7.m3.5.5.1.1.1.1.3.cmml">NF4</mi></msub><mo stretchy="false" id="S3.SS2.p2.7.m3.5.5.1.1.1.4" xref="S3.SS2.p2.7.m3.5.5.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.7.m3.5.5.2" xref="S3.SS2.p2.7.m3.5.5.2.cmml">=</mo><mrow id="S3.SS2.p2.7.m3.5.5.3" xref="S3.SS2.p2.7.m3.5.5.3.cmml"><mn id="S3.SS2.p2.7.m3.5.5.3.2" xref="S3.SS2.p2.7.m3.5.5.3.2.cmml">4.127</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.7.m3.5.5.3.1" xref="S3.SS2.p2.7.m3.5.5.3.1.cmml">⋅</mo><mrow id="S3.SS2.p2.7.m3.5.5.3.3.2" xref="S3.SS2.p2.7.m3.5.5.3.3.1.cmml"><mi id="S3.SS2.p2.7.m3.3.3" xref="S3.SS2.p2.7.m3.3.3.cmml">sizeof</mi><mo id="S3.SS2.p2.7.m3.5.5.3.3.2a" xref="S3.SS2.p2.7.m3.5.5.3.3.1.cmml">⁡</mo><mrow id="S3.SS2.p2.7.m3.5.5.3.3.2.1" xref="S3.SS2.p2.7.m3.5.5.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.7.m3.5.5.3.3.2.1.1" xref="S3.SS2.p2.7.m3.5.5.3.3.1.cmml">(</mo><mi id="S3.SS2.p2.7.m3.4.4" xref="S3.SS2.p2.7.m3.4.4.cmml">𝐀</mi><mo stretchy="false" id="S3.SS2.p2.7.m3.5.5.3.3.2.1.2" xref="S3.SS2.p2.7.m3.5.5.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m3.5b"><apply id="S3.SS2.p2.7.m3.5.5.cmml" xref="S3.SS2.p2.7.m3.5.5"><eq id="S3.SS2.p2.7.m3.5.5.2.cmml" xref="S3.SS2.p2.7.m3.5.5.2"></eq><apply id="S3.SS2.p2.7.m3.5.5.1.2.cmml" xref="S3.SS2.p2.7.m3.5.5.1.1"><ci id="S3.SS2.p2.7.m3.1.1.cmml" xref="S3.SS2.p2.7.m3.1.1">storage</ci><ci id="S3.SS2.p2.7.m3.2.2.cmml" xref="S3.SS2.p2.7.m3.2.2">𝐀</ci><apply id="S3.SS2.p2.7.m3.5.5.1.1.1.1.cmml" xref="S3.SS2.p2.7.m3.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m3.5.5.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m3.5.5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m3.5.5.1.1.1.1.2.cmml" xref="S3.SS2.p2.7.m3.5.5.1.1.1.1.2">𝑐</ci><ci id="S3.SS2.p2.7.m3.5.5.1.1.1.1.3.cmml" xref="S3.SS2.p2.7.m3.5.5.1.1.1.1.3">NF4</ci></apply></apply><apply id="S3.SS2.p2.7.m3.5.5.3.cmml" xref="S3.SS2.p2.7.m3.5.5.3"><ci id="S3.SS2.p2.7.m3.5.5.3.1.cmml" xref="S3.SS2.p2.7.m3.5.5.3.1">⋅</ci><cn type="float" id="S3.SS2.p2.7.m3.5.5.3.2.cmml" xref="S3.SS2.p2.7.m3.5.5.3.2">4.127</cn><apply id="S3.SS2.p2.7.m3.5.5.3.3.1.cmml" xref="S3.SS2.p2.7.m3.5.5.3.3.2"><ci id="S3.SS2.p2.7.m3.3.3.cmml" xref="S3.SS2.p2.7.m3.3.3">sizeof</ci><ci id="S3.SS2.p2.7.m3.4.4.cmml" xref="S3.SS2.p2.7.m3.4.4">𝐀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m3.5c">\operatorname{storage}(\mathbf{A},c_{\operatorname{NF4}})=4.127\cdot\operatorname{sizeof}(\mathbf{A})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m3.5d">roman_storage ( bold_A , italic_c start_POSTSUBSCRIPT NF4 end_POSTSUBSCRIPT ) = 4.127 ⋅ roman_sizeof ( bold_A )</annotation></semantics></math>, i.e., NF-<math id="S3.SS2.p2.8.m4.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S3.SS2.p2.8.m4.1a"><mn id="S3.SS2.p2.8.m4.1.1" xref="S3.SS2.p2.8.m4.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m4.1b"><cn type="integer" id="S3.SS2.p2.8.m4.1.1.cmml" xref="S3.SS2.p2.8.m4.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m4.1c">4</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m4.1d">4</annotation></semantics></math> requires on average 4.127 bits per parameter.</p>
</div>
<figure id="S3.SS2.fig1" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="S3.SS2.fig1.1" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_middle" style="width:190.8pt;">
<span id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <math id="alg1.2.m1.1" class="ltx_Math" alttext="\operatorname{LQ-LoRA}" display="inline"><semantics id="alg1.2.m1.1b"><mrow id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml"><mi id="alg1.2.m1.1.1.2" xref="alg1.2.m1.1.1.2.cmml">LQ</mi><mo id="alg1.2.m1.1.1.1" xref="alg1.2.m1.1.1.1.cmml">−</mo><mi id="alg1.2.m1.1.1.3" xref="alg1.2.m1.1.1.3.cmml">LoRA</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1c"><apply id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1"><minus id="alg1.2.m1.1.1.1.cmml" xref="alg1.2.m1.1.1.1"></minus><ci id="alg1.2.m1.1.1.2.cmml" xref="alg1.2.m1.1.1.2">LQ</ci><ci id="alg1.2.m1.1.1.3.cmml" xref="alg1.2.m1.1.1.3">LoRA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1d">\operatorname{LQ-LoRA}</annotation><annotation encoding="application/x-llamapun" id="alg1.2.m1.1e">roman_LQ - roman_LoRA</annotation></semantics></math> (Section&nbsp;<a href="#S3" title="3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)</span>
<span id="alg1.5" class="ltx_listing ltx_listing">
<span id="alg1.l1" class="ltx_listingline"><math id="alg1.l1.m1.3" class="ltx_Math" alttext="\{\mathbf{\mathbf{W}}^{(i)}\}_{i\in[N]}" display="inline"><semantics id="alg1.l1.m1.3a"><msub id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml"><mrow id="alg1.l1.m1.3.3.1.1" xref="alg1.l1.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.2" xref="alg1.l1.m1.3.3.1.2.cmml">{</mo><msup id="alg1.l1.m1.3.3.1.1.1" xref="alg1.l1.m1.3.3.1.1.1.cmml"><mi id="alg1.l1.m1.3.3.1.1.1.2" xref="alg1.l1.m1.3.3.1.1.1.2.cmml">𝐖</mi><mrow id="alg1.l1.m1.1.1.1.3" xref="alg1.l1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="alg1.l1.m1.1.1.1.3.1" xref="alg1.l1.m1.3.3.1.1.1.cmml">(</mo><mi id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l1.m1.1.1.1.3.2" xref="alg1.l1.m1.3.3.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l1.m1.3.3.1.1.3" xref="alg1.l1.m1.3.3.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m1.2.2.1" xref="alg1.l1.m1.2.2.1.cmml"><mi id="alg1.l1.m1.2.2.1.3" xref="alg1.l1.m1.2.2.1.3.cmml">i</mi><mo id="alg1.l1.m1.2.2.1.2" xref="alg1.l1.m1.2.2.1.2.cmml">∈</mo><mrow id="alg1.l1.m1.2.2.1.4.2" xref="alg1.l1.m1.2.2.1.4.1.cmml"><mo stretchy="false" id="alg1.l1.m1.2.2.1.4.2.1" xref="alg1.l1.m1.2.2.1.4.1.1.cmml">[</mo><mi id="alg1.l1.m1.2.2.1.1" xref="alg1.l1.m1.2.2.1.1.cmml">N</mi><mo stretchy="false" id="alg1.l1.m1.2.2.1.4.2.2" xref="alg1.l1.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.2.cmml" xref="alg1.l1.m1.3.3">subscript</csymbol><set id="alg1.l1.m1.3.3.1.2.cmml" xref="alg1.l1.m1.3.3.1.1"><apply id="alg1.l1.m1.3.3.1.1.1.cmml" xref="alg1.l1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.1.1.1.1.cmml" xref="alg1.l1.m1.3.3.1.1.1">superscript</csymbol><ci id="alg1.l1.m1.3.3.1.1.1.2.cmml" xref="alg1.l1.m1.3.3.1.1.1.2">𝐖</ci><ci id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1">𝑖</ci></apply></set><apply id="alg1.l1.m1.2.2.1.cmml" xref="alg1.l1.m1.2.2.1"><in id="alg1.l1.m1.2.2.1.2.cmml" xref="alg1.l1.m1.2.2.1.2"></in><ci id="alg1.l1.m1.2.2.1.3.cmml" xref="alg1.l1.m1.2.2.1.3">𝑖</ci><apply id="alg1.l1.m1.2.2.1.4.1.cmml" xref="alg1.l1.m1.2.2.1.4.2"><csymbol cd="latexml" id="alg1.l1.m1.2.2.1.4.1.1.cmml" xref="alg1.l1.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="alg1.l1.m1.2.2.1.1.cmml" xref="alg1.l1.m1.2.2.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\{\mathbf{\mathbf{W}}^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.3d">{ bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math>: Parameters 
</span>
<span id="alg1.l2" class="ltx_listingline">  &nbsp;<math id="alg1.l2.m1.3" class="ltx_Math" alttext="\{\mathbf{\mathbf{F}}^{(i)}\}_{i\in[N]}" display="inline"><semantics id="alg1.l2.m1.3a"><msub id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml"><mrow id="alg1.l2.m1.3.3.1.1" xref="alg1.l2.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg1.l2.m1.3.3.1.1.2" xref="alg1.l2.m1.3.3.1.2.cmml">{</mo><msup id="alg1.l2.m1.3.3.1.1.1" xref="alg1.l2.m1.3.3.1.1.1.cmml"><mi id="alg1.l2.m1.3.3.1.1.1.2" xref="alg1.l2.m1.3.3.1.1.1.2.cmml">𝐅</mi><mrow id="alg1.l2.m1.1.1.1.3" xref="alg1.l2.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.1.3.1" xref="alg1.l2.m1.3.3.1.1.1.cmml">(</mo><mi id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l2.m1.1.1.1.3.2" xref="alg1.l2.m1.3.3.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l2.m1.3.3.1.1.3" xref="alg1.l2.m1.3.3.1.2.cmml">}</mo></mrow><mrow id="alg1.l2.m1.2.2.1" xref="alg1.l2.m1.2.2.1.cmml"><mi id="alg1.l2.m1.2.2.1.3" xref="alg1.l2.m1.2.2.1.3.cmml">i</mi><mo id="alg1.l2.m1.2.2.1.2" xref="alg1.l2.m1.2.2.1.2.cmml">∈</mo><mrow id="alg1.l2.m1.2.2.1.4.2" xref="alg1.l2.m1.2.2.1.4.1.cmml"><mo stretchy="false" id="alg1.l2.m1.2.2.1.4.2.1" xref="alg1.l2.m1.2.2.1.4.1.1.cmml">[</mo><mi id="alg1.l2.m1.2.2.1.1" xref="alg1.l2.m1.2.2.1.1.cmml">N</mi><mo stretchy="false" id="alg1.l2.m1.2.2.1.4.2.2" xref="alg1.l2.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3"><csymbol cd="ambiguous" id="alg1.l2.m1.3.3.2.cmml" xref="alg1.l2.m1.3.3">subscript</csymbol><set id="alg1.l2.m1.3.3.1.2.cmml" xref="alg1.l2.m1.3.3.1.1"><apply id="alg1.l2.m1.3.3.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.3.3.1.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1">superscript</csymbol><ci id="alg1.l2.m1.3.3.1.1.1.2.cmml" xref="alg1.l2.m1.3.3.1.1.1.2">𝐅</ci><ci id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">𝑖</ci></apply></set><apply id="alg1.l2.m1.2.2.1.cmml" xref="alg1.l2.m1.2.2.1"><in id="alg1.l2.m1.2.2.1.2.cmml" xref="alg1.l2.m1.2.2.1.2"></in><ci id="alg1.l2.m1.2.2.1.3.cmml" xref="alg1.l2.m1.2.2.1.3">𝑖</ci><apply id="alg1.l2.m1.2.2.1.4.1.cmml" xref="alg1.l2.m1.2.2.1.4.2"><csymbol cd="latexml" id="alg1.l2.m1.2.2.1.4.1.1.cmml" xref="alg1.l2.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="alg1.l2.m1.2.2.1.1.cmml" xref="alg1.l2.m1.2.2.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">\{\mathbf{\mathbf{F}}^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.3d">{ bold_F start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math>:   Fisher information (optional) 
</span>
<span id="alg1.l3" class="ltx_listingline">  &nbsp;<math id="alg1.l3.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg1.l3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">caligraphic_C</annotation></semantics></math>: List of quantization configurations 
</span>
<span id="alg1.l4" class="ltx_listingline">  &nbsp;<math id="alg1.l4.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_r</annotation></semantics></math>: LoRA rank 
</span>
<span id="alg1.l5" class="ltx_listingline">  &nbsp;<math id="alg1.l5.m1.1" class="ltx_Math" alttext="B_{Q}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">B</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝐵</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">B_{Q}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_B start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>: Quantization budget

</span>
<span id="alg1.l6" class="ltx_listingline"><span id="alg1.l6.1" class="ltx_text" style="color:#808080;"># get quantization configurations (Section&nbsp;<a href="#S3.SS2" title="3.2 Mixed-Configuration Quantization via an Integer Linear Program ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>).</span>

</span>
<span id="alg1.l7" class="ltx_listingline"><math id="alg1.l7.m1.9" class="ltx_Math" alttext="\{c^{(i)}\}\leftarrow\operatorname{GetConfig}(\{\mathbf{\mathbf{W}}^{(i)},\mathbf{\mathbf{F}}^{(i)}\},\mathcal{C},r,B_{Q})" display="inline"><semantics id="alg1.l7.m1.9a"><mrow id="alg1.l7.m1.9.9" xref="alg1.l7.m1.9.9.cmml"><mrow id="alg1.l7.m1.7.7.1.1" xref="alg1.l7.m1.7.7.1.2.cmml"><mo stretchy="false" id="alg1.l7.m1.7.7.1.1.2" xref="alg1.l7.m1.7.7.1.2.cmml">{</mo><msup id="alg1.l7.m1.7.7.1.1.1" xref="alg1.l7.m1.7.7.1.1.1.cmml"><mi id="alg1.l7.m1.7.7.1.1.1.2" xref="alg1.l7.m1.7.7.1.1.1.2.cmml">c</mi><mrow id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.7.7.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.3.1" xref="alg1.l7.m1.7.7.1.1.1.cmml">(</mo><mi id="alg1.l7.m1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l7.m1.1.1.1.3.2" xref="alg1.l7.m1.7.7.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l7.m1.7.7.1.1.3" xref="alg1.l7.m1.7.7.1.2.cmml">}</mo></mrow><mo stretchy="false" id="alg1.l7.m1.9.9.4" xref="alg1.l7.m1.9.9.4.cmml">←</mo><mrow id="alg1.l7.m1.9.9.3.2" xref="alg1.l7.m1.9.9.3.3.cmml"><mi id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml">GetConfig</mi><mo id="alg1.l7.m1.9.9.3.2a" xref="alg1.l7.m1.9.9.3.3.cmml">⁡</mo><mrow id="alg1.l7.m1.9.9.3.2.2" xref="alg1.l7.m1.9.9.3.3.cmml"><mo stretchy="false" id="alg1.l7.m1.9.9.3.2.2.3" xref="alg1.l7.m1.9.9.3.3.cmml">(</mo><mrow id="alg1.l7.m1.8.8.2.1.1.1.2" xref="alg1.l7.m1.8.8.2.1.1.1.3.cmml"><mo stretchy="false" id="alg1.l7.m1.8.8.2.1.1.1.2.3" xref="alg1.l7.m1.8.8.2.1.1.1.3.cmml">{</mo><msup id="alg1.l7.m1.8.8.2.1.1.1.1.1" xref="alg1.l7.m1.8.8.2.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.8.8.2.1.1.1.1.1.2" xref="alg1.l7.m1.8.8.2.1.1.1.1.1.2.cmml">𝐖</mi><mrow id="alg1.l7.m1.2.2.1.3" xref="alg1.l7.m1.8.8.2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.2.2.1.3.1" xref="alg1.l7.m1.8.8.2.1.1.1.1.1.cmml">(</mo><mi id="alg1.l7.m1.2.2.1.1" xref="alg1.l7.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l7.m1.2.2.1.3.2" xref="alg1.l7.m1.8.8.2.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="alg1.l7.m1.8.8.2.1.1.1.2.4" xref="alg1.l7.m1.8.8.2.1.1.1.3.cmml">,</mo><msup id="alg1.l7.m1.8.8.2.1.1.1.2.2" xref="alg1.l7.m1.8.8.2.1.1.1.2.2.cmml"><mi id="alg1.l7.m1.8.8.2.1.1.1.2.2.2" xref="alg1.l7.m1.8.8.2.1.1.1.2.2.2.cmml">𝐅</mi><mrow id="alg1.l7.m1.3.3.1.3" xref="alg1.l7.m1.8.8.2.1.1.1.2.2.cmml"><mo stretchy="false" id="alg1.l7.m1.3.3.1.3.1" xref="alg1.l7.m1.8.8.2.1.1.1.2.2.cmml">(</mo><mi id="alg1.l7.m1.3.3.1.1" xref="alg1.l7.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l7.m1.3.3.1.3.2" xref="alg1.l7.m1.8.8.2.1.1.1.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg1.l7.m1.8.8.2.1.1.1.2.5" xref="alg1.l7.m1.8.8.2.1.1.1.3.cmml">}</mo></mrow><mo id="alg1.l7.m1.9.9.3.2.2.4" xref="alg1.l7.m1.9.9.3.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.5.5" xref="alg1.l7.m1.5.5.cmml">𝒞</mi><mo id="alg1.l7.m1.9.9.3.2.2.5" xref="alg1.l7.m1.9.9.3.3.cmml">,</mo><mi id="alg1.l7.m1.6.6" xref="alg1.l7.m1.6.6.cmml">r</mi><mo id="alg1.l7.m1.9.9.3.2.2.6" xref="alg1.l7.m1.9.9.3.3.cmml">,</mo><msub id="alg1.l7.m1.9.9.3.2.2.2" xref="alg1.l7.m1.9.9.3.2.2.2.cmml"><mi id="alg1.l7.m1.9.9.3.2.2.2.2" xref="alg1.l7.m1.9.9.3.2.2.2.2.cmml">B</mi><mi id="alg1.l7.m1.9.9.3.2.2.2.3" xref="alg1.l7.m1.9.9.3.2.2.2.3.cmml">Q</mi></msub><mo stretchy="false" id="alg1.l7.m1.9.9.3.2.2.7" xref="alg1.l7.m1.9.9.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.9b"><apply id="alg1.l7.m1.9.9.cmml" xref="alg1.l7.m1.9.9"><ci id="alg1.l7.m1.9.9.4.cmml" xref="alg1.l7.m1.9.9.4">←</ci><set id="alg1.l7.m1.7.7.1.2.cmml" xref="alg1.l7.m1.7.7.1.1"><apply id="alg1.l7.m1.7.7.1.1.1.cmml" xref="alg1.l7.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.7.7.1.1.1.1.cmml" xref="alg1.l7.m1.7.7.1.1.1">superscript</csymbol><ci id="alg1.l7.m1.7.7.1.1.1.2.cmml" xref="alg1.l7.m1.7.7.1.1.1.2">𝑐</ci><ci id="alg1.l7.m1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1">𝑖</ci></apply></set><apply id="alg1.l7.m1.9.9.3.3.cmml" xref="alg1.l7.m1.9.9.3.2"><ci id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4">GetConfig</ci><set id="alg1.l7.m1.8.8.2.1.1.1.3.cmml" xref="alg1.l7.m1.8.8.2.1.1.1.2"><apply id="alg1.l7.m1.8.8.2.1.1.1.1.1.cmml" xref="alg1.l7.m1.8.8.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.8.8.2.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.8.8.2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l7.m1.8.8.2.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.8.8.2.1.1.1.1.1.2">𝐖</ci><ci id="alg1.l7.m1.2.2.1.1.cmml" xref="alg1.l7.m1.2.2.1.1">𝑖</ci></apply><apply id="alg1.l7.m1.8.8.2.1.1.1.2.2.cmml" xref="alg1.l7.m1.8.8.2.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.8.8.2.1.1.1.2.2.1.cmml" xref="alg1.l7.m1.8.8.2.1.1.1.2.2">superscript</csymbol><ci id="alg1.l7.m1.8.8.2.1.1.1.2.2.2.cmml" xref="alg1.l7.m1.8.8.2.1.1.1.2.2.2">𝐅</ci><ci id="alg1.l7.m1.3.3.1.1.cmml" xref="alg1.l7.m1.3.3.1.1">𝑖</ci></apply></set><ci id="alg1.l7.m1.5.5.cmml" xref="alg1.l7.m1.5.5">𝒞</ci><ci id="alg1.l7.m1.6.6.cmml" xref="alg1.l7.m1.6.6">𝑟</ci><apply id="alg1.l7.m1.9.9.3.2.2.2.cmml" xref="alg1.l7.m1.9.9.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.9.9.3.2.2.2.1.cmml" xref="alg1.l7.m1.9.9.3.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.9.9.3.2.2.2.2.cmml" xref="alg1.l7.m1.9.9.3.2.2.2.2">𝐵</ci><ci id="alg1.l7.m1.9.9.3.2.2.2.3.cmml" xref="alg1.l7.m1.9.9.3.2.2.2.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.9c">\{c^{(i)}\}\leftarrow\operatorname{GetConfig}(\{\mathbf{\mathbf{W}}^{(i)},\mathbf{\mathbf{F}}^{(i)}\},\mathcal{C},r,B_{Q})</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.9d">{ italic_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } ← roman_GetConfig ( { bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_F start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } , caligraphic_C , italic_r , italic_B start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT )</annotation></semantics></math>

</span>
<span id="alg1.l8" class="ltx_listingline"><span id="alg1.l8.1" class="ltx_text ltx_font_bold">for</span>&nbsp;<math id="alg1.l8.m1.1" class="ltx_Math" alttext="i\leftarrow 1" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">i</mi><mo stretchy="false" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mn id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">i\leftarrow 1</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_i ← 1</annotation></semantics></math> to <math id="alg1.l8.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l8.m2.1a"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">italic_N</annotation></semantics></math>&nbsp;<span id="alg1.l8.2" class="ltx_text ltx_font_bold">do</span>

</span>
<span id="alg1.l9" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg1.l9.1" class="ltx_text" style="color:#808080;"># matrix decomposition (Section&nbsp;<a href="#S3.SS1" title="3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>).</span>

</span>
<span id="alg1.l10" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg1.l10.m1.15" class="ltx_Math" alttext="\mathbf{Q}^{(i)},\mathbf{L}_{1}^{(i)},\mathbf{L}_{2}^{(i)},\epsilon\leftarrow\operatorname{LQ}(\mathbf{W}^{(i)},\mathbf{F}^{(i)},c^{(i)},r)" display="inline"><semantics id="alg1.l10.m1.15a"><mrow id="alg1.l10.m1.15.15" xref="alg1.l10.m1.15.15.cmml"><mrow id="alg1.l10.m1.12.12.3.3" xref="alg1.l10.m1.12.12.3.4.cmml"><msup id="alg1.l10.m1.10.10.1.1.1" xref="alg1.l10.m1.10.10.1.1.1.cmml"><mi id="alg1.l10.m1.10.10.1.1.1.2" xref="alg1.l10.m1.10.10.1.1.1.2.cmml">𝐐</mi><mrow id="alg1.l10.m1.1.1.1.3" xref="alg1.l10.m1.10.10.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.1.1.1.3.1" xref="alg1.l10.m1.10.10.1.1.1.cmml">(</mo><mi id="alg1.l10.m1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l10.m1.1.1.1.3.2" xref="alg1.l10.m1.10.10.1.1.1.cmml">)</mo></mrow></msup><mo id="alg1.l10.m1.12.12.3.3.4" xref="alg1.l10.m1.12.12.3.4.cmml">,</mo><msubsup id="alg1.l10.m1.11.11.2.2.2" xref="alg1.l10.m1.11.11.2.2.2.cmml"><mi id="alg1.l10.m1.11.11.2.2.2.2.2" xref="alg1.l10.m1.11.11.2.2.2.2.2.cmml">𝐋</mi><mn id="alg1.l10.m1.11.11.2.2.2.2.3" xref="alg1.l10.m1.11.11.2.2.2.2.3.cmml">1</mn><mrow id="alg1.l10.m1.2.2.1.3" xref="alg1.l10.m1.11.11.2.2.2.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.1.3.1" xref="alg1.l10.m1.11.11.2.2.2.cmml">(</mo><mi id="alg1.l10.m1.2.2.1.1" xref="alg1.l10.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l10.m1.2.2.1.3.2" xref="alg1.l10.m1.11.11.2.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l10.m1.12.12.3.3.5" xref="alg1.l10.m1.12.12.3.4.cmml">,</mo><msubsup id="alg1.l10.m1.12.12.3.3.3" xref="alg1.l10.m1.12.12.3.3.3.cmml"><mi id="alg1.l10.m1.12.12.3.3.3.2.2" xref="alg1.l10.m1.12.12.3.3.3.2.2.cmml">𝐋</mi><mn id="alg1.l10.m1.12.12.3.3.3.2.3" xref="alg1.l10.m1.12.12.3.3.3.2.3.cmml">2</mn><mrow id="alg1.l10.m1.3.3.1.3" xref="alg1.l10.m1.12.12.3.3.3.cmml"><mo stretchy="false" id="alg1.l10.m1.3.3.1.3.1" xref="alg1.l10.m1.12.12.3.3.3.cmml">(</mo><mi id="alg1.l10.m1.3.3.1.1" xref="alg1.l10.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l10.m1.3.3.1.3.2" xref="alg1.l10.m1.12.12.3.3.3.cmml">)</mo></mrow></msubsup><mo id="alg1.l10.m1.12.12.3.3.6" xref="alg1.l10.m1.12.12.3.4.cmml">,</mo><mi id="alg1.l10.m1.9.9" xref="alg1.l10.m1.9.9.cmml">ϵ</mi></mrow><mo stretchy="false" id="alg1.l10.m1.15.15.7" xref="alg1.l10.m1.15.15.7.cmml">←</mo><mrow id="alg1.l10.m1.15.15.6.3" xref="alg1.l10.m1.15.15.6.4.cmml"><mi id="alg1.l10.m1.7.7" xref="alg1.l10.m1.7.7.cmml">LQ</mi><mo id="alg1.l10.m1.15.15.6.3a" xref="alg1.l10.m1.15.15.6.4.cmml">⁡</mo><mrow id="alg1.l10.m1.15.15.6.3.3" xref="alg1.l10.m1.15.15.6.4.cmml"><mo stretchy="false" id="alg1.l10.m1.15.15.6.3.3.4" xref="alg1.l10.m1.15.15.6.4.cmml">(</mo><msup id="alg1.l10.m1.13.13.4.1.1.1" xref="alg1.l10.m1.13.13.4.1.1.1.cmml"><mi id="alg1.l10.m1.13.13.4.1.1.1.2" xref="alg1.l10.m1.13.13.4.1.1.1.2.cmml">𝐖</mi><mrow id="alg1.l10.m1.4.4.1.3" xref="alg1.l10.m1.13.13.4.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.4.4.1.3.1" xref="alg1.l10.m1.13.13.4.1.1.1.cmml">(</mo><mi id="alg1.l10.m1.4.4.1.1" xref="alg1.l10.m1.4.4.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l10.m1.4.4.1.3.2" xref="alg1.l10.m1.13.13.4.1.1.1.cmml">)</mo></mrow></msup><mo id="alg1.l10.m1.15.15.6.3.3.5" xref="alg1.l10.m1.15.15.6.4.cmml">,</mo><msup id="alg1.l10.m1.14.14.5.2.2.2" xref="alg1.l10.m1.14.14.5.2.2.2.cmml"><mi id="alg1.l10.m1.14.14.5.2.2.2.2" xref="alg1.l10.m1.14.14.5.2.2.2.2.cmml">𝐅</mi><mrow id="alg1.l10.m1.5.5.1.3" xref="alg1.l10.m1.14.14.5.2.2.2.cmml"><mo stretchy="false" id="alg1.l10.m1.5.5.1.3.1" xref="alg1.l10.m1.14.14.5.2.2.2.cmml">(</mo><mi id="alg1.l10.m1.5.5.1.1" xref="alg1.l10.m1.5.5.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l10.m1.5.5.1.3.2" xref="alg1.l10.m1.14.14.5.2.2.2.cmml">)</mo></mrow></msup><mo id="alg1.l10.m1.15.15.6.3.3.6" xref="alg1.l10.m1.15.15.6.4.cmml">,</mo><msup id="alg1.l10.m1.15.15.6.3.3.3" xref="alg1.l10.m1.15.15.6.3.3.3.cmml"><mi id="alg1.l10.m1.15.15.6.3.3.3.2" xref="alg1.l10.m1.15.15.6.3.3.3.2.cmml">c</mi><mrow id="alg1.l10.m1.6.6.1.3" xref="alg1.l10.m1.15.15.6.3.3.3.cmml"><mo stretchy="false" id="alg1.l10.m1.6.6.1.3.1" xref="alg1.l10.m1.15.15.6.3.3.3.cmml">(</mo><mi id="alg1.l10.m1.6.6.1.1" xref="alg1.l10.m1.6.6.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l10.m1.6.6.1.3.2" xref="alg1.l10.m1.15.15.6.3.3.3.cmml">)</mo></mrow></msup><mo id="alg1.l10.m1.15.15.6.3.3.7" xref="alg1.l10.m1.15.15.6.4.cmml">,</mo><mi id="alg1.l10.m1.8.8" xref="alg1.l10.m1.8.8.cmml">r</mi><mo stretchy="false" id="alg1.l10.m1.15.15.6.3.3.8" xref="alg1.l10.m1.15.15.6.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.15b"><apply id="alg1.l10.m1.15.15.cmml" xref="alg1.l10.m1.15.15"><ci id="alg1.l10.m1.15.15.7.cmml" xref="alg1.l10.m1.15.15.7">←</ci><list id="alg1.l10.m1.12.12.3.4.cmml" xref="alg1.l10.m1.12.12.3.3"><apply id="alg1.l10.m1.10.10.1.1.1.cmml" xref="alg1.l10.m1.10.10.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.1.1.1.1.cmml" xref="alg1.l10.m1.10.10.1.1.1">superscript</csymbol><ci id="alg1.l10.m1.10.10.1.1.1.2.cmml" xref="alg1.l10.m1.10.10.1.1.1.2">𝐐</ci><ci id="alg1.l10.m1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1">𝑖</ci></apply><apply id="alg1.l10.m1.11.11.2.2.2.cmml" xref="alg1.l10.m1.11.11.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.11.11.2.2.2.1.cmml" xref="alg1.l10.m1.11.11.2.2.2">superscript</csymbol><apply id="alg1.l10.m1.11.11.2.2.2.2.cmml" xref="alg1.l10.m1.11.11.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.11.11.2.2.2.2.1.cmml" xref="alg1.l10.m1.11.11.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.11.11.2.2.2.2.2.cmml" xref="alg1.l10.m1.11.11.2.2.2.2.2">𝐋</ci><cn type="integer" id="alg1.l10.m1.11.11.2.2.2.2.3.cmml" xref="alg1.l10.m1.11.11.2.2.2.2.3">1</cn></apply><ci id="alg1.l10.m1.2.2.1.1.cmml" xref="alg1.l10.m1.2.2.1.1">𝑖</ci></apply><apply id="alg1.l10.m1.12.12.3.3.3.cmml" xref="alg1.l10.m1.12.12.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.12.12.3.3.3.1.cmml" xref="alg1.l10.m1.12.12.3.3.3">superscript</csymbol><apply id="alg1.l10.m1.12.12.3.3.3.2.cmml" xref="alg1.l10.m1.12.12.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.12.12.3.3.3.2.1.cmml" xref="alg1.l10.m1.12.12.3.3.3">subscript</csymbol><ci id="alg1.l10.m1.12.12.3.3.3.2.2.cmml" xref="alg1.l10.m1.12.12.3.3.3.2.2">𝐋</ci><cn type="integer" id="alg1.l10.m1.12.12.3.3.3.2.3.cmml" xref="alg1.l10.m1.12.12.3.3.3.2.3">2</cn></apply><ci id="alg1.l10.m1.3.3.1.1.cmml" xref="alg1.l10.m1.3.3.1.1">𝑖</ci></apply><ci id="alg1.l10.m1.9.9.cmml" xref="alg1.l10.m1.9.9">italic-ϵ</ci></list><apply id="alg1.l10.m1.15.15.6.4.cmml" xref="alg1.l10.m1.15.15.6.3"><ci id="alg1.l10.m1.7.7.cmml" xref="alg1.l10.m1.7.7">LQ</ci><apply id="alg1.l10.m1.13.13.4.1.1.1.cmml" xref="alg1.l10.m1.13.13.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.13.13.4.1.1.1.1.cmml" xref="alg1.l10.m1.13.13.4.1.1.1">superscript</csymbol><ci id="alg1.l10.m1.13.13.4.1.1.1.2.cmml" xref="alg1.l10.m1.13.13.4.1.1.1.2">𝐖</ci><ci id="alg1.l10.m1.4.4.1.1.cmml" xref="alg1.l10.m1.4.4.1.1">𝑖</ci></apply><apply id="alg1.l10.m1.14.14.5.2.2.2.cmml" xref="alg1.l10.m1.14.14.5.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.14.14.5.2.2.2.1.cmml" xref="alg1.l10.m1.14.14.5.2.2.2">superscript</csymbol><ci id="alg1.l10.m1.14.14.5.2.2.2.2.cmml" xref="alg1.l10.m1.14.14.5.2.2.2.2">𝐅</ci><ci id="alg1.l10.m1.5.5.1.1.cmml" xref="alg1.l10.m1.5.5.1.1">𝑖</ci></apply><apply id="alg1.l10.m1.15.15.6.3.3.3.cmml" xref="alg1.l10.m1.15.15.6.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.15.15.6.3.3.3.1.cmml" xref="alg1.l10.m1.15.15.6.3.3.3">superscript</csymbol><ci id="alg1.l10.m1.15.15.6.3.3.3.2.cmml" xref="alg1.l10.m1.15.15.6.3.3.3.2">𝑐</ci><ci id="alg1.l10.m1.6.6.1.1.cmml" xref="alg1.l10.m1.6.6.1.1">𝑖</ci></apply><ci id="alg1.l10.m1.8.8.cmml" xref="alg1.l10.m1.8.8">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.15c">\mathbf{Q}^{(i)},\mathbf{L}_{1}^{(i)},\mathbf{L}_{2}^{(i)},\epsilon\leftarrow\operatorname{LQ}(\mathbf{W}^{(i)},\mathbf{F}^{(i)},c^{(i)},r)</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.15d">bold_Q start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_ϵ ← roman_LQ ( bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_F start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_r )</annotation></semantics></math>

</span>
<span id="alg1.l11" class="ltx_listingline"><math id="alg1.l11.m1.7" class="ltx_Math" alttext="\{\mathbf{Q}^{(i)},\mathbf{L}_{1}^{(i)},\mathbf{L}_{2}^{(i)}\}_{i\in[N]}" display="inline"><semantics id="alg1.l11.m1.7a"><msub id="alg1.l11.m1.7.7" xref="alg1.l11.m1.7.7.cmml"><mrow id="alg1.l11.m1.7.7.3.3" xref="alg1.l11.m1.7.7.3.4.cmml"><mo stretchy="false" id="alg1.l11.m1.7.7.3.3.4" xref="alg1.l11.m1.7.7.3.4.cmml">{</mo><msup id="alg1.l11.m1.5.5.1.1.1" xref="alg1.l11.m1.5.5.1.1.1.cmml"><mi id="alg1.l11.m1.5.5.1.1.1.2" xref="alg1.l11.m1.5.5.1.1.1.2.cmml">𝐐</mi><mrow id="alg1.l11.m1.1.1.1.3" xref="alg1.l11.m1.5.5.1.1.1.cmml"><mo stretchy="false" id="alg1.l11.m1.1.1.1.3.1" xref="alg1.l11.m1.5.5.1.1.1.cmml">(</mo><mi id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l11.m1.1.1.1.3.2" xref="alg1.l11.m1.5.5.1.1.1.cmml">)</mo></mrow></msup><mo id="alg1.l11.m1.7.7.3.3.5" xref="alg1.l11.m1.7.7.3.4.cmml">,</mo><msubsup id="alg1.l11.m1.6.6.2.2.2" xref="alg1.l11.m1.6.6.2.2.2.cmml"><mi id="alg1.l11.m1.6.6.2.2.2.2.2" xref="alg1.l11.m1.6.6.2.2.2.2.2.cmml">𝐋</mi><mn id="alg1.l11.m1.6.6.2.2.2.2.3" xref="alg1.l11.m1.6.6.2.2.2.2.3.cmml">1</mn><mrow id="alg1.l11.m1.2.2.1.3" xref="alg1.l11.m1.6.6.2.2.2.cmml"><mo stretchy="false" id="alg1.l11.m1.2.2.1.3.1" xref="alg1.l11.m1.6.6.2.2.2.cmml">(</mo><mi id="alg1.l11.m1.2.2.1.1" xref="alg1.l11.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l11.m1.2.2.1.3.2" xref="alg1.l11.m1.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l11.m1.7.7.3.3.6" xref="alg1.l11.m1.7.7.3.4.cmml">,</mo><msubsup id="alg1.l11.m1.7.7.3.3.3" xref="alg1.l11.m1.7.7.3.3.3.cmml"><mi id="alg1.l11.m1.7.7.3.3.3.2.2" xref="alg1.l11.m1.7.7.3.3.3.2.2.cmml">𝐋</mi><mn id="alg1.l11.m1.7.7.3.3.3.2.3" xref="alg1.l11.m1.7.7.3.3.3.2.3.cmml">2</mn><mrow id="alg1.l11.m1.3.3.1.3" xref="alg1.l11.m1.7.7.3.3.3.cmml"><mo stretchy="false" id="alg1.l11.m1.3.3.1.3.1" xref="alg1.l11.m1.7.7.3.3.3.cmml">(</mo><mi id="alg1.l11.m1.3.3.1.1" xref="alg1.l11.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="alg1.l11.m1.3.3.1.3.2" xref="alg1.l11.m1.7.7.3.3.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l11.m1.7.7.3.3.7" xref="alg1.l11.m1.7.7.3.4.cmml">}</mo></mrow><mrow id="alg1.l11.m1.4.4.1" xref="alg1.l11.m1.4.4.1.cmml"><mi id="alg1.l11.m1.4.4.1.3" xref="alg1.l11.m1.4.4.1.3.cmml">i</mi><mo id="alg1.l11.m1.4.4.1.2" xref="alg1.l11.m1.4.4.1.2.cmml">∈</mo><mrow id="alg1.l11.m1.4.4.1.4.2" xref="alg1.l11.m1.4.4.1.4.1.cmml"><mo stretchy="false" id="alg1.l11.m1.4.4.1.4.2.1" xref="alg1.l11.m1.4.4.1.4.1.1.cmml">[</mo><mi id="alg1.l11.m1.4.4.1.1" xref="alg1.l11.m1.4.4.1.1.cmml">N</mi><mo stretchy="false" id="alg1.l11.m1.4.4.1.4.2.2" xref="alg1.l11.m1.4.4.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.7b"><apply id="alg1.l11.m1.7.7.cmml" xref="alg1.l11.m1.7.7"><csymbol cd="ambiguous" id="alg1.l11.m1.7.7.4.cmml" xref="alg1.l11.m1.7.7">subscript</csymbol><set id="alg1.l11.m1.7.7.3.4.cmml" xref="alg1.l11.m1.7.7.3.3"><apply id="alg1.l11.m1.5.5.1.1.1.cmml" xref="alg1.l11.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.5.5.1.1.1.1.cmml" xref="alg1.l11.m1.5.5.1.1.1">superscript</csymbol><ci id="alg1.l11.m1.5.5.1.1.1.2.cmml" xref="alg1.l11.m1.5.5.1.1.1.2">𝐐</ci><ci id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1">𝑖</ci></apply><apply id="alg1.l11.m1.6.6.2.2.2.cmml" xref="alg1.l11.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.6.6.2.2.2.1.cmml" xref="alg1.l11.m1.6.6.2.2.2">superscript</csymbol><apply id="alg1.l11.m1.6.6.2.2.2.2.cmml" xref="alg1.l11.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.6.6.2.2.2.2.1.cmml" xref="alg1.l11.m1.6.6.2.2.2">subscript</csymbol><ci id="alg1.l11.m1.6.6.2.2.2.2.2.cmml" xref="alg1.l11.m1.6.6.2.2.2.2.2">𝐋</ci><cn type="integer" id="alg1.l11.m1.6.6.2.2.2.2.3.cmml" xref="alg1.l11.m1.6.6.2.2.2.2.3">1</cn></apply><ci id="alg1.l11.m1.2.2.1.1.cmml" xref="alg1.l11.m1.2.2.1.1">𝑖</ci></apply><apply id="alg1.l11.m1.7.7.3.3.3.cmml" xref="alg1.l11.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="alg1.l11.m1.7.7.3.3.3.1.cmml" xref="alg1.l11.m1.7.7.3.3.3">superscript</csymbol><apply id="alg1.l11.m1.7.7.3.3.3.2.cmml" xref="alg1.l11.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="alg1.l11.m1.7.7.3.3.3.2.1.cmml" xref="alg1.l11.m1.7.7.3.3.3">subscript</csymbol><ci id="alg1.l11.m1.7.7.3.3.3.2.2.cmml" xref="alg1.l11.m1.7.7.3.3.3.2.2">𝐋</ci><cn type="integer" id="alg1.l11.m1.7.7.3.3.3.2.3.cmml" xref="alg1.l11.m1.7.7.3.3.3.2.3">2</cn></apply><ci id="alg1.l11.m1.3.3.1.1.cmml" xref="alg1.l11.m1.3.3.1.1">𝑖</ci></apply></set><apply id="alg1.l11.m1.4.4.1.cmml" xref="alg1.l11.m1.4.4.1"><in id="alg1.l11.m1.4.4.1.2.cmml" xref="alg1.l11.m1.4.4.1.2"></in><ci id="alg1.l11.m1.4.4.1.3.cmml" xref="alg1.l11.m1.4.4.1.3">𝑖</ci><apply id="alg1.l11.m1.4.4.1.4.1.cmml" xref="alg1.l11.m1.4.4.1.4.2"><csymbol cd="latexml" id="alg1.l11.m1.4.4.1.4.1.1.cmml" xref="alg1.l11.m1.4.4.1.4.2.1">delimited-[]</csymbol><ci id="alg1.l11.m1.4.4.1.1.cmml" xref="alg1.l11.m1.4.4.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.7c">\{\mathbf{Q}^{(i)},\mathbf{L}_{1}^{(i)},\mathbf{L}_{2}^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.7d">{ bold_Q start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math>

</span>
</span>
</span>
<span id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.4.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> <math id="alg2.2.m1.1" class="ltx_Math" alttext="\operatorname{LQ}" display="inline"><semantics id="alg2.2.m1.1b"><mi id="alg2.2.m1.1.1" xref="alg2.2.m1.1.1.cmml">LQ</mi><annotation-xml encoding="MathML-Content" id="alg2.2.m1.1c"><ci id="alg2.2.m1.1.1.cmml" xref="alg2.2.m1.1.1">LQ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m1.1d">\operatorname{LQ}</annotation><annotation encoding="application/x-llamapun" id="alg2.2.m1.1e">roman_LQ</annotation></semantics></math> (Section&nbsp;<a href="#S3.SS1" title="3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>)</span>
<span id="alg2.5" class="ltx_listing ltx_listing">
<span id="alg2.l1" class="ltx_listingline"><math id="alg2.l1.m1.1" class="ltx_Math" alttext="\mathbf{\mathbf{W}}" display="inline"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mathbf{\mathbf{W}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">bold_W</annotation></semantics></math>: Input weight matrix 
</span>
<span id="alg2.l2" class="ltx_listingline">  &nbsp;<math id="alg2.l2.m1.1" class="ltx_Math" alttext="\mathbf{F}" display="inline"><semantics id="alg2.l2.m1.1a"><mi id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">bold_F</annotation></semantics></math>: Fisher information (optional) 
</span>
<span id="alg2.l3" class="ltx_listingline">  &nbsp;<math id="alg2.l3.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg2.l3.m1.1a"><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">italic_c</annotation></semantics></math>: Quantization configuration 
</span>
<span id="alg2.l4" class="ltx_listingline">  &nbsp;<math id="alg2.l4.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg2.l4.m1.1a"><mi id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">italic_r</annotation></semantics></math>: Target rank

</span>
<span id="alg2.l5" class="ltx_listingline"><math id="alg2.l5.m1.1" class="ltx_Math" alttext="\text{Initialize }\mathbf{Q}\leftarrow\mathbf{0}" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mrow id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml"><mtext id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2a.cmml">Initialize&nbsp;</mtext><mo id="alg2.l5.m1.1.1.2.1" xref="alg2.l5.m1.1.1.2.1.cmml" lspace="0px" rspace="0px"></mo><mi id="alg2.l5.m1.1.1.2.3" xref="alg2.l5.m1.1.1.2.3.cmml">𝐐</mi></mrow><mo stretchy="false" id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">←</mo><mn id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><ci id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1">←</ci><apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"><times id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2.1"></times><ci id="alg2.l5.m1.1.1.2.2a.cmml" xref="alg2.l5.m1.1.1.2.2"><mtext id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">Initialize&nbsp;</mtext></ci><ci id="alg2.l5.m1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.2.3">𝐐</ci></apply><cn type="integer" id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\text{Initialize }\mathbf{Q}\leftarrow\mathbf{0}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">Initialize bold_Q ← bold_0</annotation></semantics></math> and <math id="alg2.l5.m2.1" class="ltx_Math" alttext="\epsilon_{0}\leftarrow\infty" display="inline"><semantics id="alg2.l5.m2.1a"><mrow id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><msub id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml"><mi id="alg2.l5.m2.1.1.2.2" xref="alg2.l5.m2.1.1.2.2.cmml">ϵ</mi><mn id="alg2.l5.m2.1.1.2.3" xref="alg2.l5.m2.1.1.2.3.cmml">0</mn></msub><mo stretchy="false" id="alg2.l5.m2.1.1.1" xref="alg2.l5.m2.1.1.1.cmml">←</mo><mi mathvariant="normal" id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><ci id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1.1">←</ci><apply id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m2.1.1.2.1.cmml" xref="alg2.l5.m2.1.1.2">subscript</csymbol><ci id="alg2.l5.m2.1.1.2.2.cmml" xref="alg2.l5.m2.1.1.2.2">italic-ϵ</ci><cn type="integer" id="alg2.l5.m2.1.1.2.3.cmml" xref="alg2.l5.m2.1.1.2.3">0</cn></apply><infinity id="alg2.l5.m2.1.1.3.cmml" xref="alg2.l5.m2.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">\epsilon_{0}\leftarrow\infty</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m2.1d">italic_ϵ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← ∞</annotation></semantics></math>

</span>
<span id="alg2.l6" class="ltx_listingline"><span id="alg2.l6.1" class="ltx_text ltx_font_bold">for</span>&nbsp;<math id="alg2.l6.m1.1" class="ltx_Math" alttext="t\leftarrow 1" display="inline"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">t</mi><mo stretchy="false" id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">←</mo><mn id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><ci id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1">←</ci><ci id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">𝑡</ci><cn type="integer" id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">t\leftarrow 1</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">italic_t ← 1</annotation></semantics></math> to <math id="alg2.l6.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg2.l6.m2.1a"><mi id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><ci id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m2.1d">italic_T</annotation></semantics></math>&nbsp;<span id="alg2.l6.2" class="ltx_text ltx_font_bold">do</span>

</span>
<span id="alg2.l7" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l7.m1.6" class="ltx_Math" alttext="\mathbf{L}_{1},\mathbf{L}_{2}\leftarrow\operatorname{Factorize}(\mathbf{W}-\mathbf{Q},\mathbf{F},r)" display="inline"><semantics id="alg2.l7.m1.6a"><mrow id="alg2.l7.m1.6.6" xref="alg2.l7.m1.6.6.cmml"><mrow id="alg2.l7.m1.5.5.2.2" xref="alg2.l7.m1.5.5.2.3.cmml"><msub id="alg2.l7.m1.4.4.1.1.1" xref="alg2.l7.m1.4.4.1.1.1.cmml"><mi id="alg2.l7.m1.4.4.1.1.1.2" xref="alg2.l7.m1.4.4.1.1.1.2.cmml">𝐋</mi><mn id="alg2.l7.m1.4.4.1.1.1.3" xref="alg2.l7.m1.4.4.1.1.1.3.cmml">1</mn></msub><mo id="alg2.l7.m1.5.5.2.2.3" xref="alg2.l7.m1.5.5.2.3.cmml">,</mo><msub id="alg2.l7.m1.5.5.2.2.2" xref="alg2.l7.m1.5.5.2.2.2.cmml"><mi id="alg2.l7.m1.5.5.2.2.2.2" xref="alg2.l7.m1.5.5.2.2.2.2.cmml">𝐋</mi><mn id="alg2.l7.m1.5.5.2.2.2.3" xref="alg2.l7.m1.5.5.2.2.2.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="alg2.l7.m1.6.6.4" xref="alg2.l7.m1.6.6.4.cmml">←</mo><mrow id="alg2.l7.m1.6.6.3.1" xref="alg2.l7.m1.6.6.3.2.cmml"><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">Factorize</mi><mo id="alg2.l7.m1.6.6.3.1a" xref="alg2.l7.m1.6.6.3.2.cmml">⁡</mo><mrow id="alg2.l7.m1.6.6.3.1.1" xref="alg2.l7.m1.6.6.3.2.cmml"><mo stretchy="false" id="alg2.l7.m1.6.6.3.1.1.2" xref="alg2.l7.m1.6.6.3.2.cmml">(</mo><mrow id="alg2.l7.m1.6.6.3.1.1.1" xref="alg2.l7.m1.6.6.3.1.1.1.cmml"><mi id="alg2.l7.m1.6.6.3.1.1.1.2" xref="alg2.l7.m1.6.6.3.1.1.1.2.cmml">𝐖</mi><mo id="alg2.l7.m1.6.6.3.1.1.1.1" xref="alg2.l7.m1.6.6.3.1.1.1.1.cmml">−</mo><mi id="alg2.l7.m1.6.6.3.1.1.1.3" xref="alg2.l7.m1.6.6.3.1.1.1.3.cmml">𝐐</mi></mrow><mo id="alg2.l7.m1.6.6.3.1.1.3" xref="alg2.l7.m1.6.6.3.2.cmml">,</mo><mi id="alg2.l7.m1.2.2" xref="alg2.l7.m1.2.2.cmml">𝐅</mi><mo id="alg2.l7.m1.6.6.3.1.1.4" xref="alg2.l7.m1.6.6.3.2.cmml">,</mo><mi id="alg2.l7.m1.3.3" xref="alg2.l7.m1.3.3.cmml">r</mi><mo stretchy="false" id="alg2.l7.m1.6.6.3.1.1.5" xref="alg2.l7.m1.6.6.3.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.6b"><apply id="alg2.l7.m1.6.6.cmml" xref="alg2.l7.m1.6.6"><ci id="alg2.l7.m1.6.6.4.cmml" xref="alg2.l7.m1.6.6.4">←</ci><list id="alg2.l7.m1.5.5.2.3.cmml" xref="alg2.l7.m1.5.5.2.2"><apply id="alg2.l7.m1.4.4.1.1.1.cmml" xref="alg2.l7.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.4.4.1.1.1.1.cmml" xref="alg2.l7.m1.4.4.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.4.4.1.1.1.2.cmml" xref="alg2.l7.m1.4.4.1.1.1.2">𝐋</ci><cn type="integer" id="alg2.l7.m1.4.4.1.1.1.3.cmml" xref="alg2.l7.m1.4.4.1.1.1.3">1</cn></apply><apply id="alg2.l7.m1.5.5.2.2.2.cmml" xref="alg2.l7.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="alg2.l7.m1.5.5.2.2.2.1.cmml" xref="alg2.l7.m1.5.5.2.2.2">subscript</csymbol><ci id="alg2.l7.m1.5.5.2.2.2.2.cmml" xref="alg2.l7.m1.5.5.2.2.2.2">𝐋</ci><cn type="integer" id="alg2.l7.m1.5.5.2.2.2.3.cmml" xref="alg2.l7.m1.5.5.2.2.2.3">2</cn></apply></list><apply id="alg2.l7.m1.6.6.3.2.cmml" xref="alg2.l7.m1.6.6.3.1"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">Factorize</ci><apply id="alg2.l7.m1.6.6.3.1.1.1.cmml" xref="alg2.l7.m1.6.6.3.1.1.1"><minus id="alg2.l7.m1.6.6.3.1.1.1.1.cmml" xref="alg2.l7.m1.6.6.3.1.1.1.1"></minus><ci id="alg2.l7.m1.6.6.3.1.1.1.2.cmml" xref="alg2.l7.m1.6.6.3.1.1.1.2">𝐖</ci><ci id="alg2.l7.m1.6.6.3.1.1.1.3.cmml" xref="alg2.l7.m1.6.6.3.1.1.1.3">𝐐</ci></apply><ci id="alg2.l7.m1.2.2.cmml" xref="alg2.l7.m1.2.2">𝐅</ci><ci id="alg2.l7.m1.3.3.cmml" xref="alg2.l7.m1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.6c">\mathbf{L}_{1},\mathbf{L}_{2}\leftarrow\operatorname{Factorize}(\mathbf{W}-\mathbf{Q},\mathbf{F},r)</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.6d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ← roman_Factorize ( bold_W - bold_Q , bold_F , italic_r )</annotation></semantics></math>

</span>
<span id="alg2.l8" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l8.m1.3" class="ltx_Math" alttext="\mathbf{Q}\leftarrow\operatorname{Quantize}\left({\mathbf{W}-\mathbf{L}_{1}\mathbf{L}_{2}},c\right)" display="inline"><semantics id="alg2.l8.m1.3a"><mrow id="alg2.l8.m1.3.3" xref="alg2.l8.m1.3.3.cmml"><mi id="alg2.l8.m1.3.3.3" xref="alg2.l8.m1.3.3.3.cmml">𝐐</mi><mo stretchy="false" id="alg2.l8.m1.3.3.2" xref="alg2.l8.m1.3.3.2.cmml">←</mo><mrow id="alg2.l8.m1.3.3.1.1" xref="alg2.l8.m1.3.3.1.2.cmml"><mi id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">Quantize</mi><mo id="alg2.l8.m1.3.3.1.1a" xref="alg2.l8.m1.3.3.1.2.cmml">⁡</mo><mrow id="alg2.l8.m1.3.3.1.1.1" xref="alg2.l8.m1.3.3.1.2.cmml"><mo id="alg2.l8.m1.3.3.1.1.1.2" xref="alg2.l8.m1.3.3.1.2.cmml">(</mo><mrow id="alg2.l8.m1.3.3.1.1.1.1" xref="alg2.l8.m1.3.3.1.1.1.1.cmml"><mi id="alg2.l8.m1.3.3.1.1.1.1.2" xref="alg2.l8.m1.3.3.1.1.1.1.2.cmml">𝐖</mi><mo id="alg2.l8.m1.3.3.1.1.1.1.1" xref="alg2.l8.m1.3.3.1.1.1.1.1.cmml">−</mo><mrow id="alg2.l8.m1.3.3.1.1.1.1.3" xref="alg2.l8.m1.3.3.1.1.1.1.3.cmml"><msub id="alg2.l8.m1.3.3.1.1.1.1.3.2" xref="alg2.l8.m1.3.3.1.1.1.1.3.2.cmml"><mi id="alg2.l8.m1.3.3.1.1.1.1.3.2.2" xref="alg2.l8.m1.3.3.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="alg2.l8.m1.3.3.1.1.1.1.3.2.3" xref="alg2.l8.m1.3.3.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="alg2.l8.m1.3.3.1.1.1.1.3.1" xref="alg2.l8.m1.3.3.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msub id="alg2.l8.m1.3.3.1.1.1.1.3.3" xref="alg2.l8.m1.3.3.1.1.1.1.3.3.cmml"><mi id="alg2.l8.m1.3.3.1.1.1.1.3.3.2" xref="alg2.l8.m1.3.3.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="alg2.l8.m1.3.3.1.1.1.1.3.3.3" xref="alg2.l8.m1.3.3.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="alg2.l8.m1.3.3.1.1.1.3" xref="alg2.l8.m1.3.3.1.2.cmml">,</mo><mi id="alg2.l8.m1.2.2" xref="alg2.l8.m1.2.2.cmml">c</mi><mo id="alg2.l8.m1.3.3.1.1.1.4" xref="alg2.l8.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.3b"><apply id="alg2.l8.m1.3.3.cmml" xref="alg2.l8.m1.3.3"><ci id="alg2.l8.m1.3.3.2.cmml" xref="alg2.l8.m1.3.3.2">←</ci><ci id="alg2.l8.m1.3.3.3.cmml" xref="alg2.l8.m1.3.3.3">𝐐</ci><apply id="alg2.l8.m1.3.3.1.2.cmml" xref="alg2.l8.m1.3.3.1.1"><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">Quantize</ci><apply id="alg2.l8.m1.3.3.1.1.1.1.cmml" xref="alg2.l8.m1.3.3.1.1.1.1"><minus id="alg2.l8.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.1"></minus><ci id="alg2.l8.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.2">𝐖</ci><apply id="alg2.l8.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3"><times id="alg2.l8.m1.3.3.1.1.1.1.3.1.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3.1"></times><apply id="alg2.l8.m1.3.3.1.1.1.1.3.2.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.3.3.1.1.1.1.3.2.1.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="alg2.l8.m1.3.3.1.1.1.1.3.2.2.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3.2.2">𝐋</ci><cn type="integer" id="alg2.l8.m1.3.3.1.1.1.1.3.2.3.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3.2.3">1</cn></apply><apply id="alg2.l8.m1.3.3.1.1.1.1.3.3.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.3.3.1.1.1.1.3.3.1.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="alg2.l8.m1.3.3.1.1.1.1.3.3.2.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3.3.2">𝐋</ci><cn type="integer" id="alg2.l8.m1.3.3.1.1.1.1.3.3.3.cmml" xref="alg2.l8.m1.3.3.1.1.1.1.3.3.3">2</cn></apply></apply></apply><ci id="alg2.l8.m1.2.2.cmml" xref="alg2.l8.m1.2.2">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.3c">\mathbf{Q}\leftarrow\operatorname{Quantize}\left({\mathbf{W}-\mathbf{L}_{1}\mathbf{L}_{2}},c\right)</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.3d">bold_Q ← roman_Quantize ( bold_W - bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_c )</annotation></semantics></math>

</span>
<span id="alg2.l9" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l9.1" class="ltx_text ltx_font_bold">if</span>&nbsp;<math id="alg2.l9.m1.1" class="ltx_Math" alttext="\mathbf{F}" display="inline"><semantics id="alg2.l9.m1.1a"><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">bold_F</annotation></semantics></math> is <math id="alg2.l9.m2.1" class="ltx_Math" alttext="\operatorname{None}" display="inline"><semantics id="alg2.l9.m2.1a"><mi id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml">None</mi><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.1b"><ci id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1">None</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.1c">\operatorname{None}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m2.1d">roman_None</annotation></semantics></math>&nbsp;<span id="alg2.l9.2" class="ltx_text ltx_font_bold">then</span>

</span>
<span id="alg2.l10" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l10.m1.1" class="ltx_Math" alttext="\epsilon_{t}\leftarrow\left\|\mathbf{W}{-}\left(\mathbf{Q}{+}\mathbf{L}_{1}\mathbf{L}_{2}\right)\right\|_{F}" display="inline"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><msub id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml"><mi id="alg2.l10.m1.1.1.3.2" xref="alg2.l10.m1.1.1.3.2.cmml">ϵ</mi><mi id="alg2.l10.m1.1.1.3.3" xref="alg2.l10.m1.1.1.3.3.cmml">t</mi></msub><mo stretchy="false" id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">←</mo><msub id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml"><mrow id="alg2.l10.m1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.2.cmml"><mo id="alg2.l10.m1.1.1.1.1.1.2" xref="alg2.l10.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="alg2.l10.m1.1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l10.m1.1.1.1.1.1.1.3" xref="alg2.l10.m1.1.1.1.1.1.1.3.cmml">𝐖</mi><mo id="alg2.l10.m1.1.1.1.1.1.1.2" xref="alg2.l10.m1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="alg2.l10.m1.1.1.1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l10.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l10.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.1" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msub id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="alg2.l10.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l10.m1.1.1.1.1.1.3" xref="alg2.l10.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="alg2.l10.m1.1.1.1.3" xref="alg2.l10.m1.1.1.1.3.cmml">F</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">←</ci><apply id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.1.cmml" xref="alg2.l10.m1.1.1.3">subscript</csymbol><ci id="alg2.l10.m1.1.1.3.2.cmml" xref="alg2.l10.m1.1.1.3.2">italic-ϵ</ci><ci id="alg2.l10.m1.1.1.3.3.cmml" xref="alg2.l10.m1.1.1.3.3">𝑡</ci></apply><apply id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1">subscript</csymbol><apply id="alg2.l10.m1.1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l10.m1.1.1.1.1.2.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.2">norm</csymbol><apply id="alg2.l10.m1.1.1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.1"><minus id="alg2.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.2"></minus><ci id="alg2.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.3">𝐖</ci><apply id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1"><plus id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.2">𝐐</ci><apply id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3"><times id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn type="integer" id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn type="integer" id="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><ci id="alg2.l10.m1.1.1.1.3.cmml" xref="alg2.l10.m1.1.1.1.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">\epsilon_{t}\leftarrow\left\|\mathbf{W}{-}\left(\mathbf{Q}{+}\mathbf{L}_{1}\mathbf{L}_{2}\right)\right\|_{F}</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">italic_ϵ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← ∥ bold_W - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>

</span>
<span id="alg2.l11" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l11.1" class="ltx_text ltx_font_bold">else</span>
</span>
<span id="alg2.l12" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l12.1" class="ltx_text" style="color:#808080;"># weighted error (Section&nbsp;<a href="#S3.SS3" title="3.3 Data-Aware Matrix Decomposition via Fisher-weighted SVD ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>).</span>

</span>
<span id="alg2.l13" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l13.m1.1" class="ltx_Math" alttext="\epsilon_{t}\leftarrow\left\|\sqrt{\mathbf{F}}\odot\left(\mathbf{W}{-}\left(\mathbf{Q}{+}\mathbf{L}_{1}\mathbf{L}_{2}\right)\right)\right\|_{F}" display="inline"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><msub id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml"><mi id="alg2.l13.m1.1.1.3.2" xref="alg2.l13.m1.1.1.3.2.cmml">ϵ</mi><mi id="alg2.l13.m1.1.1.3.3" xref="alg2.l13.m1.1.1.3.3.cmml">t</mi></msub><mo stretchy="false" id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml">←</mo><msub id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml"><mrow id="alg2.l13.m1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.2.cmml"><mo id="alg2.l13.m1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="alg2.l13.m1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.cmml"><msqrt id="alg2.l13.m1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.3.2" xref="alg2.l13.m1.1.1.1.1.1.1.3.2.cmml">𝐅</mi></msqrt><mo lspace="0.222em" rspace="0.222em" id="alg2.l13.m1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="alg2.l13.m1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l13.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.cmml">𝐖</mi><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msub id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l13.m1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="alg2.l13.m1.1.1.1.3" xref="alg2.l13.m1.1.1.1.3.cmml">F</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><ci id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2">←</ci><apply id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.3.1.cmml" xref="alg2.l13.m1.1.1.3">subscript</csymbol><ci id="alg2.l13.m1.1.1.3.2.cmml" xref="alg2.l13.m1.1.1.3.2">italic-ϵ</ci><ci id="alg2.l13.m1.1.1.3.3.cmml" xref="alg2.l13.m1.1.1.3.3">𝑡</ci></apply><apply id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1">subscript</csymbol><apply id="alg2.l13.m1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l13.m1.1.1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.2">norm</csymbol><apply id="alg2.l13.m1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="alg2.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.3"><root id="alg2.l13.m1.1.1.1.1.1.1.3a.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.3"></root><ci id="alg2.l13.m1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.3.2">𝐅</ci></apply><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1"><minus id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.2"></minus><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3">𝐖</ci><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1"><plus id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐐</ci><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn type="integer" id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn type="integer" id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></apply><ci id="alg2.l13.m1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">\epsilon_{t}\leftarrow\left\|\sqrt{\mathbf{F}}\odot\left(\mathbf{W}{-}\left(\mathbf{Q}{+}\mathbf{L}_{1}\mathbf{L}_{2}\right)\right)\right\|_{F}</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">italic_ϵ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← ∥ square-root start_ARG bold_F end_ARG ⊙ ( bold_W - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>
<span id="alg2.l14" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l14.1" class="ltx_text ltx_font_bold">if</span>&nbsp;<math id="alg2.l14.m1.1" class="ltx_Math" alttext="\epsilon_{t}>\epsilon_{t-1}" display="inline"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><msub id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml"><mi id="alg2.l14.m1.1.1.2.2" xref="alg2.l14.m1.1.1.2.2.cmml">ϵ</mi><mi id="alg2.l14.m1.1.1.2.3" xref="alg2.l14.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg2.l14.m1.1.1.1" xref="alg2.l14.m1.1.1.1.cmml">&gt;</mo><msub id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml"><mi id="alg2.l14.m1.1.1.3.2" xref="alg2.l14.m1.1.1.3.2.cmml">ϵ</mi><mrow id="alg2.l14.m1.1.1.3.3" xref="alg2.l14.m1.1.1.3.3.cmml"><mi id="alg2.l14.m1.1.1.3.3.2" xref="alg2.l14.m1.1.1.3.3.2.cmml">t</mi><mo id="alg2.l14.m1.1.1.3.3.1" xref="alg2.l14.m1.1.1.3.3.1.cmml">−</mo><mn id="alg2.l14.m1.1.1.3.3.3" xref="alg2.l14.m1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><gt id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1"></gt><apply id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.1.cmml" xref="alg2.l14.m1.1.1.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.2.2.cmml" xref="alg2.l14.m1.1.1.2.2">italic-ϵ</ci><ci id="alg2.l14.m1.1.1.2.3.cmml" xref="alg2.l14.m1.1.1.2.3">𝑡</ci></apply><apply id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.1.cmml" xref="alg2.l14.m1.1.1.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.2.cmml" xref="alg2.l14.m1.1.1.3.2">italic-ϵ</ci><apply id="alg2.l14.m1.1.1.3.3.cmml" xref="alg2.l14.m1.1.1.3.3"><minus id="alg2.l14.m1.1.1.3.3.1.cmml" xref="alg2.l14.m1.1.1.3.3.1"></minus><ci id="alg2.l14.m1.1.1.3.3.2.cmml" xref="alg2.l14.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg2.l14.m1.1.1.3.3.3.cmml" xref="alg2.l14.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">\epsilon_{t}&gt;\epsilon_{t-1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m1.1d">italic_ϵ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT &gt; italic_ϵ start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> <span id="alg2.l14.2" class="ltx_text ltx_font_bold">then</span>&nbsp;break

</span>
<span id="alg2.l15" class="ltx_listingline"><math id="alg2.l15.m1.4" class="ltx_Math" alttext="\mathbf{Q},\mathbf{L}_{1},\mathbf{L}_{2},\epsilon_{t}" display="inline"><semantics id="alg2.l15.m1.4a"><mrow id="alg2.l15.m1.4.4.3" xref="alg2.l15.m1.4.4.4.cmml"><mi id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml">𝐐</mi><mo id="alg2.l15.m1.4.4.3.4" xref="alg2.l15.m1.4.4.4.cmml">,</mo><msub id="alg2.l15.m1.2.2.1.1" xref="alg2.l15.m1.2.2.1.1.cmml"><mi id="alg2.l15.m1.2.2.1.1.2" xref="alg2.l15.m1.2.2.1.1.2.cmml">𝐋</mi><mn id="alg2.l15.m1.2.2.1.1.3" xref="alg2.l15.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="alg2.l15.m1.4.4.3.5" xref="alg2.l15.m1.4.4.4.cmml">,</mo><msub id="alg2.l15.m1.3.3.2.2" xref="alg2.l15.m1.3.3.2.2.cmml"><mi id="alg2.l15.m1.3.3.2.2.2" xref="alg2.l15.m1.3.3.2.2.2.cmml">𝐋</mi><mn id="alg2.l15.m1.3.3.2.2.3" xref="alg2.l15.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="alg2.l15.m1.4.4.3.6" xref="alg2.l15.m1.4.4.4.cmml">,</mo><msub id="alg2.l15.m1.4.4.3.3" xref="alg2.l15.m1.4.4.3.3.cmml"><mi id="alg2.l15.m1.4.4.3.3.2" xref="alg2.l15.m1.4.4.3.3.2.cmml">ϵ</mi><mi id="alg2.l15.m1.4.4.3.3.3" xref="alg2.l15.m1.4.4.3.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.4b"><list id="alg2.l15.m1.4.4.4.cmml" xref="alg2.l15.m1.4.4.3"><ci id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1">𝐐</ci><apply id="alg2.l15.m1.2.2.1.1.cmml" xref="alg2.l15.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.1.1.1.cmml" xref="alg2.l15.m1.2.2.1.1">subscript</csymbol><ci id="alg2.l15.m1.2.2.1.1.2.cmml" xref="alg2.l15.m1.2.2.1.1.2">𝐋</ci><cn type="integer" id="alg2.l15.m1.2.2.1.1.3.cmml" xref="alg2.l15.m1.2.2.1.1.3">1</cn></apply><apply id="alg2.l15.m1.3.3.2.2.cmml" xref="alg2.l15.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg2.l15.m1.3.3.2.2.1.cmml" xref="alg2.l15.m1.3.3.2.2">subscript</csymbol><ci id="alg2.l15.m1.3.3.2.2.2.cmml" xref="alg2.l15.m1.3.3.2.2.2">𝐋</ci><cn type="integer" id="alg2.l15.m1.3.3.2.2.3.cmml" xref="alg2.l15.m1.3.3.2.2.3">2</cn></apply><apply id="alg2.l15.m1.4.4.3.3.cmml" xref="alg2.l15.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg2.l15.m1.4.4.3.3.1.cmml" xref="alg2.l15.m1.4.4.3.3">subscript</csymbol><ci id="alg2.l15.m1.4.4.3.3.2.cmml" xref="alg2.l15.m1.4.4.3.3.2">italic-ϵ</ci><ci id="alg2.l15.m1.4.4.3.3.3.cmml" xref="alg2.l15.m1.4.4.3.3.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.4c">\mathbf{Q},\mathbf{L}_{1},\mathbf{L}_{2},\epsilon_{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.4d">bold_Q , bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_ϵ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>

</span>
</span>
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="S3.SS2.fig1.2" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_middle" style="width:198.7pt;">
<span id="alg3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.4.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span> <math id="alg3.2.m1.1" class="ltx_Math" alttext="\operatorname{GetConfig}" display="inline"><semantics id="alg3.2.m1.1b"><mi id="alg3.2.m1.1.1" xref="alg3.2.m1.1.1.cmml">GetConfig</mi><annotation-xml encoding="MathML-Content" id="alg3.2.m1.1c"><ci id="alg3.2.m1.1.1.cmml" xref="alg3.2.m1.1.1">GetConfig</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.2.m1.1d">\operatorname{GetConfig}</annotation><annotation encoding="application/x-llamapun" id="alg3.2.m1.1e">roman_GetConfig</annotation></semantics></math> (Section&nbsp;<a href="#S3.SS2" title="3.2 Mixed-Configuration Quantization via an Integer Linear Program ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>)</span>
<span id="alg3.5" class="ltx_listing ltx_listing">
<span id="alg3.l1" class="ltx_listingline"><math id="alg3.l1.m1.3" class="ltx_Math" alttext="\{\mathbf{\mathbf{W}}^{(i)}\}_{i\in[N]}" display="inline"><semantics id="alg3.l1.m1.3a"><msub id="alg3.l1.m1.3.3" xref="alg3.l1.m1.3.3.cmml"><mrow id="alg3.l1.m1.3.3.1.1" xref="alg3.l1.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg3.l1.m1.3.3.1.1.2" xref="alg3.l1.m1.3.3.1.2.cmml">{</mo><msup id="alg3.l1.m1.3.3.1.1.1" xref="alg3.l1.m1.3.3.1.1.1.cmml"><mi id="alg3.l1.m1.3.3.1.1.1.2" xref="alg3.l1.m1.3.3.1.1.1.2.cmml">𝐖</mi><mrow id="alg3.l1.m1.1.1.1.3" xref="alg3.l1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="alg3.l1.m1.1.1.1.3.1" xref="alg3.l1.m1.3.3.1.1.1.cmml">(</mo><mi id="alg3.l1.m1.1.1.1.1" xref="alg3.l1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l1.m1.1.1.1.3.2" xref="alg3.l1.m1.3.3.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg3.l1.m1.3.3.1.1.3" xref="alg3.l1.m1.3.3.1.2.cmml">}</mo></mrow><mrow id="alg3.l1.m1.2.2.1" xref="alg3.l1.m1.2.2.1.cmml"><mi id="alg3.l1.m1.2.2.1.3" xref="alg3.l1.m1.2.2.1.3.cmml">i</mi><mo id="alg3.l1.m1.2.2.1.2" xref="alg3.l1.m1.2.2.1.2.cmml">∈</mo><mrow id="alg3.l1.m1.2.2.1.4.2" xref="alg3.l1.m1.2.2.1.4.1.cmml"><mo stretchy="false" id="alg3.l1.m1.2.2.1.4.2.1" xref="alg3.l1.m1.2.2.1.4.1.1.cmml">[</mo><mi id="alg3.l1.m1.2.2.1.1" xref="alg3.l1.m1.2.2.1.1.cmml">N</mi><mo stretchy="false" id="alg3.l1.m1.2.2.1.4.2.2" xref="alg3.l1.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.3b"><apply id="alg3.l1.m1.3.3.cmml" xref="alg3.l1.m1.3.3"><csymbol cd="ambiguous" id="alg3.l1.m1.3.3.2.cmml" xref="alg3.l1.m1.3.3">subscript</csymbol><set id="alg3.l1.m1.3.3.1.2.cmml" xref="alg3.l1.m1.3.3.1.1"><apply id="alg3.l1.m1.3.3.1.1.1.cmml" xref="alg3.l1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m1.3.3.1.1.1.1.cmml" xref="alg3.l1.m1.3.3.1.1.1">superscript</csymbol><ci id="alg3.l1.m1.3.3.1.1.1.2.cmml" xref="alg3.l1.m1.3.3.1.1.1.2">𝐖</ci><ci id="alg3.l1.m1.1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1.1">𝑖</ci></apply></set><apply id="alg3.l1.m1.2.2.1.cmml" xref="alg3.l1.m1.2.2.1"><in id="alg3.l1.m1.2.2.1.2.cmml" xref="alg3.l1.m1.2.2.1.2"></in><ci id="alg3.l1.m1.2.2.1.3.cmml" xref="alg3.l1.m1.2.2.1.3">𝑖</ci><apply id="alg3.l1.m1.2.2.1.4.1.cmml" xref="alg3.l1.m1.2.2.1.4.2"><csymbol cd="latexml" id="alg3.l1.m1.2.2.1.4.1.1.cmml" xref="alg3.l1.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="alg3.l1.m1.2.2.1.1.cmml" xref="alg3.l1.m1.2.2.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.3c">\{\mathbf{\mathbf{W}}^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m1.3d">{ bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math>: Parameters 
</span>
<span id="alg3.l2" class="ltx_listingline">  &nbsp;<math id="alg3.l2.m1.3" class="ltx_Math" alttext="\{\mathbf{\mathbf{F}}^{(i)}\}_{i\in[N]}" display="inline"><semantics id="alg3.l2.m1.3a"><msub id="alg3.l2.m1.3.3" xref="alg3.l2.m1.3.3.cmml"><mrow id="alg3.l2.m1.3.3.1.1" xref="alg3.l2.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg3.l2.m1.3.3.1.1.2" xref="alg3.l2.m1.3.3.1.2.cmml">{</mo><msup id="alg3.l2.m1.3.3.1.1.1" xref="alg3.l2.m1.3.3.1.1.1.cmml"><mi id="alg3.l2.m1.3.3.1.1.1.2" xref="alg3.l2.m1.3.3.1.1.1.2.cmml">𝐅</mi><mrow id="alg3.l2.m1.1.1.1.3" xref="alg3.l2.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="alg3.l2.m1.1.1.1.3.1" xref="alg3.l2.m1.3.3.1.1.1.cmml">(</mo><mi id="alg3.l2.m1.1.1.1.1" xref="alg3.l2.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l2.m1.1.1.1.3.2" xref="alg3.l2.m1.3.3.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg3.l2.m1.3.3.1.1.3" xref="alg3.l2.m1.3.3.1.2.cmml">}</mo></mrow><mrow id="alg3.l2.m1.2.2.1" xref="alg3.l2.m1.2.2.1.cmml"><mi id="alg3.l2.m1.2.2.1.3" xref="alg3.l2.m1.2.2.1.3.cmml">i</mi><mo id="alg3.l2.m1.2.2.1.2" xref="alg3.l2.m1.2.2.1.2.cmml">∈</mo><mrow id="alg3.l2.m1.2.2.1.4.2" xref="alg3.l2.m1.2.2.1.4.1.cmml"><mo stretchy="false" id="alg3.l2.m1.2.2.1.4.2.1" xref="alg3.l2.m1.2.2.1.4.1.1.cmml">[</mo><mi id="alg3.l2.m1.2.2.1.1" xref="alg3.l2.m1.2.2.1.1.cmml">N</mi><mo stretchy="false" id="alg3.l2.m1.2.2.1.4.2.2" xref="alg3.l2.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.3b"><apply id="alg3.l2.m1.3.3.cmml" xref="alg3.l2.m1.3.3"><csymbol cd="ambiguous" id="alg3.l2.m1.3.3.2.cmml" xref="alg3.l2.m1.3.3">subscript</csymbol><set id="alg3.l2.m1.3.3.1.2.cmml" xref="alg3.l2.m1.3.3.1.1"><apply id="alg3.l2.m1.3.3.1.1.1.cmml" xref="alg3.l2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l2.m1.3.3.1.1.1.1.cmml" xref="alg3.l2.m1.3.3.1.1.1">superscript</csymbol><ci id="alg3.l2.m1.3.3.1.1.1.2.cmml" xref="alg3.l2.m1.3.3.1.1.1.2">𝐅</ci><ci id="alg3.l2.m1.1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1.1">𝑖</ci></apply></set><apply id="alg3.l2.m1.2.2.1.cmml" xref="alg3.l2.m1.2.2.1"><in id="alg3.l2.m1.2.2.1.2.cmml" xref="alg3.l2.m1.2.2.1.2"></in><ci id="alg3.l2.m1.2.2.1.3.cmml" xref="alg3.l2.m1.2.2.1.3">𝑖</ci><apply id="alg3.l2.m1.2.2.1.4.1.cmml" xref="alg3.l2.m1.2.2.1.4.2"><csymbol cd="latexml" id="alg3.l2.m1.2.2.1.4.1.1.cmml" xref="alg3.l2.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="alg3.l2.m1.2.2.1.1.cmml" xref="alg3.l2.m1.2.2.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.3c">\{\mathbf{\mathbf{F}}^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m1.3d">{ bold_F start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math>:   Fisher information (optional) 
</span>
<span id="alg3.l3" class="ltx_listingline">  &nbsp;<math id="alg3.l3.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg3.l3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.l3.m1.1.1" xref="alg3.l3.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.1b"><ci id="alg3.l3.m1.1.1.cmml" xref="alg3.l3.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg3.l3.m1.1d">caligraphic_C</annotation></semantics></math>: List of quantization configurations 
</span>
<span id="alg3.l4" class="ltx_listingline">  &nbsp;<math id="alg3.l4.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg3.l4.m1.1a"><mi id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><ci id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg3.l4.m1.1d">italic_r</annotation></semantics></math>: Target rank 
</span>
<span id="alg3.l5" class="ltx_listingline">  &nbsp;<math id="alg3.l5.m1.1" class="ltx_Math" alttext="B_{Q}" display="inline"><semantics id="alg3.l5.m1.1a"><msub id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml"><mi id="alg3.l5.m1.1.1.2" xref="alg3.l5.m1.1.1.2.cmml">B</mi><mi id="alg3.l5.m1.1.1.3" xref="alg3.l5.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><apply id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.1.cmml" xref="alg3.l5.m1.1.1">subscript</csymbol><ci id="alg3.l5.m1.1.1.2.cmml" xref="alg3.l5.m1.1.1.2">𝐵</ci><ci id="alg3.l5.m1.1.1.3.cmml" xref="alg3.l5.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">B_{Q}</annotation><annotation encoding="application/x-llamapun" id="alg3.l5.m1.1d">italic_B start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>: Quantization budget

</span>
<span id="alg3.l6" class="ltx_listingline"><math id="alg3.l6.m1.6" class="ltx_Math" alttext="\mathbf{E},\mathbf{S}\leftarrow\operatorname{zeros}(N,|\mathcal{C}|)" display="inline"><semantics id="alg3.l6.m1.6a"><mrow id="alg3.l6.m1.6.6" xref="alg3.l6.m1.6.6.cmml"><mrow id="alg3.l6.m1.6.6.3.2" xref="alg3.l6.m1.6.6.3.1.cmml"><mi id="alg3.l6.m1.4.4" xref="alg3.l6.m1.4.4.cmml">𝐄</mi><mo id="alg3.l6.m1.6.6.3.2.1" xref="alg3.l6.m1.6.6.3.1.cmml">,</mo><mi id="alg3.l6.m1.5.5" xref="alg3.l6.m1.5.5.cmml">𝐒</mi></mrow><mo stretchy="false" id="alg3.l6.m1.6.6.2" xref="alg3.l6.m1.6.6.2.cmml">←</mo><mrow id="alg3.l6.m1.6.6.1.1" xref="alg3.l6.m1.6.6.1.2.cmml"><mi id="alg3.l6.m1.2.2" xref="alg3.l6.m1.2.2.cmml">zeros</mi><mo id="alg3.l6.m1.6.6.1.1a" xref="alg3.l6.m1.6.6.1.2.cmml">⁡</mo><mrow id="alg3.l6.m1.6.6.1.1.1" xref="alg3.l6.m1.6.6.1.2.cmml"><mo stretchy="false" id="alg3.l6.m1.6.6.1.1.1.2" xref="alg3.l6.m1.6.6.1.2.cmml">(</mo><mi id="alg3.l6.m1.3.3" xref="alg3.l6.m1.3.3.cmml">N</mi><mo id="alg3.l6.m1.6.6.1.1.1.3" xref="alg3.l6.m1.6.6.1.2.cmml">,</mo><mrow id="alg3.l6.m1.6.6.1.1.1.1.2" xref="alg3.l6.m1.6.6.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l6.m1.6.6.1.1.1.1.2.1" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg3.l6.m1.1.1" xref="alg3.l6.m1.1.1.cmml">𝒞</mi><mo stretchy="false" id="alg3.l6.m1.6.6.1.1.1.1.2.2" xref="alg3.l6.m1.6.6.1.1.1.1.1.1.cmml">|</mo></mrow><mo stretchy="false" id="alg3.l6.m1.6.6.1.1.1.4" xref="alg3.l6.m1.6.6.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.6b"><apply id="alg3.l6.m1.6.6.cmml" xref="alg3.l6.m1.6.6"><ci id="alg3.l6.m1.6.6.2.cmml" xref="alg3.l6.m1.6.6.2">←</ci><list id="alg3.l6.m1.6.6.3.1.cmml" xref="alg3.l6.m1.6.6.3.2"><ci id="alg3.l6.m1.4.4.cmml" xref="alg3.l6.m1.4.4">𝐄</ci><ci id="alg3.l6.m1.5.5.cmml" xref="alg3.l6.m1.5.5">𝐒</ci></list><apply id="alg3.l6.m1.6.6.1.2.cmml" xref="alg3.l6.m1.6.6.1.1"><ci id="alg3.l6.m1.2.2.cmml" xref="alg3.l6.m1.2.2">zeros</ci><ci id="alg3.l6.m1.3.3.cmml" xref="alg3.l6.m1.3.3">𝑁</ci><apply id="alg3.l6.m1.6.6.1.1.1.1.1.cmml" xref="alg3.l6.m1.6.6.1.1.1.1.2"><abs id="alg3.l6.m1.6.6.1.1.1.1.1.1.cmml" xref="alg3.l6.m1.6.6.1.1.1.1.2.1"></abs><ci id="alg3.l6.m1.1.1.cmml" xref="alg3.l6.m1.1.1">𝒞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.6c">\mathbf{E},\mathbf{S}\leftarrow\operatorname{zeros}(N,|\mathcal{C}|)</annotation><annotation encoding="application/x-llamapun" id="alg3.l6.m1.6d">bold_E , bold_S ← roman_zeros ( italic_N , | caligraphic_C | )</annotation></semantics></math> <span id="alg3.l6.1" class="ltx_text" style="color:#808080;"># initialize error and storage</span>

</span>
<span id="alg3.l7" class="ltx_listingline"><span id="alg3.l7.1" class="ltx_text ltx_font_bold">for</span>&nbsp;<math id="alg3.l7.m1.1" class="ltx_Math" alttext="i\leftarrow 1" display="inline"><semantics id="alg3.l7.m1.1a"><mrow id="alg3.l7.m1.1.1" xref="alg3.l7.m1.1.1.cmml"><mi id="alg3.l7.m1.1.1.2" xref="alg3.l7.m1.1.1.2.cmml">i</mi><mo stretchy="false" id="alg3.l7.m1.1.1.1" xref="alg3.l7.m1.1.1.1.cmml">←</mo><mn id="alg3.l7.m1.1.1.3" xref="alg3.l7.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l7.m1.1b"><apply id="alg3.l7.m1.1.1.cmml" xref="alg3.l7.m1.1.1"><ci id="alg3.l7.m1.1.1.1.cmml" xref="alg3.l7.m1.1.1.1">←</ci><ci id="alg3.l7.m1.1.1.2.cmml" xref="alg3.l7.m1.1.1.2">𝑖</ci><cn type="integer" id="alg3.l7.m1.1.1.3.cmml" xref="alg3.l7.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m1.1c">i\leftarrow 1</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.m1.1d">italic_i ← 1</annotation></semantics></math> to <math id="alg3.l7.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg3.l7.m2.1a"><mi id="alg3.l7.m2.1.1" xref="alg3.l7.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg3.l7.m2.1b"><ci id="alg3.l7.m2.1.1.cmml" xref="alg3.l7.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.m2.1d">italic_N</annotation></semantics></math>&nbsp;<span id="alg3.l7.2" class="ltx_text ltx_font_bold">do</span>

</span>
<span id="alg3.l8" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg3.l8.1" class="ltx_text ltx_font_bold">for</span>&nbsp;<math id="alg3.l8.m1.1" class="ltx_Math" alttext="c\in\mathcal{C}" display="inline"><semantics id="alg3.l8.m1.1a"><mrow id="alg3.l8.m1.1.1" xref="alg3.l8.m1.1.1.cmml"><mi id="alg3.l8.m1.1.1.2" xref="alg3.l8.m1.1.1.2.cmml">c</mi><mo id="alg3.l8.m1.1.1.1" xref="alg3.l8.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg3.l8.m1.1.1.3" xref="alg3.l8.m1.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l8.m1.1b"><apply id="alg3.l8.m1.1.1.cmml" xref="alg3.l8.m1.1.1"><in id="alg3.l8.m1.1.1.1.cmml" xref="alg3.l8.m1.1.1.1"></in><ci id="alg3.l8.m1.1.1.2.cmml" xref="alg3.l8.m1.1.1.2">𝑐</ci><ci id="alg3.l8.m1.1.1.3.cmml" xref="alg3.l8.m1.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m1.1c">c\in\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg3.l8.m1.1d">italic_c ∈ caligraphic_C</annotation></semantics></math>&nbsp;<span id="alg3.l8.2" class="ltx_text ltx_font_bold">do</span>

</span>
<span id="alg3.l9" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg3.l9.m1.14" class="ltx_Math" alttext="\mathbf{Q}^{(i)},\mathbf{L}_{1}^{(i)},\mathbf{L}_{2}^{(i)},\epsilon\leftarrow\operatorname{LQ}(\mathbf{W}^{(i)},\mathbf{F}^{(i)},c,r)" display="inline"><semantics id="alg3.l9.m1.14a"><mrow id="alg3.l9.m1.14.14" xref="alg3.l9.m1.14.14.cmml"><mrow id="alg3.l9.m1.12.12.3.3" xref="alg3.l9.m1.12.12.3.4.cmml"><msup id="alg3.l9.m1.10.10.1.1.1" xref="alg3.l9.m1.10.10.1.1.1.cmml"><mi id="alg3.l9.m1.10.10.1.1.1.2" xref="alg3.l9.m1.10.10.1.1.1.2.cmml">𝐐</mi><mrow id="alg3.l9.m1.1.1.1.3" xref="alg3.l9.m1.10.10.1.1.1.cmml"><mo stretchy="false" id="alg3.l9.m1.1.1.1.3.1" xref="alg3.l9.m1.10.10.1.1.1.cmml">(</mo><mi id="alg3.l9.m1.1.1.1.1" xref="alg3.l9.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l9.m1.1.1.1.3.2" xref="alg3.l9.m1.10.10.1.1.1.cmml">)</mo></mrow></msup><mo id="alg3.l9.m1.12.12.3.3.4" xref="alg3.l9.m1.12.12.3.4.cmml">,</mo><msubsup id="alg3.l9.m1.11.11.2.2.2" xref="alg3.l9.m1.11.11.2.2.2.cmml"><mi id="alg3.l9.m1.11.11.2.2.2.2.2" xref="alg3.l9.m1.11.11.2.2.2.2.2.cmml">𝐋</mi><mn id="alg3.l9.m1.11.11.2.2.2.2.3" xref="alg3.l9.m1.11.11.2.2.2.2.3.cmml">1</mn><mrow id="alg3.l9.m1.2.2.1.3" xref="alg3.l9.m1.11.11.2.2.2.cmml"><mo stretchy="false" id="alg3.l9.m1.2.2.1.3.1" xref="alg3.l9.m1.11.11.2.2.2.cmml">(</mo><mi id="alg3.l9.m1.2.2.1.1" xref="alg3.l9.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l9.m1.2.2.1.3.2" xref="alg3.l9.m1.11.11.2.2.2.cmml">)</mo></mrow></msubsup><mo id="alg3.l9.m1.12.12.3.3.5" xref="alg3.l9.m1.12.12.3.4.cmml">,</mo><msubsup id="alg3.l9.m1.12.12.3.3.3" xref="alg3.l9.m1.12.12.3.3.3.cmml"><mi id="alg3.l9.m1.12.12.3.3.3.2.2" xref="alg3.l9.m1.12.12.3.3.3.2.2.cmml">𝐋</mi><mn id="alg3.l9.m1.12.12.3.3.3.2.3" xref="alg3.l9.m1.12.12.3.3.3.2.3.cmml">2</mn><mrow id="alg3.l9.m1.3.3.1.3" xref="alg3.l9.m1.12.12.3.3.3.cmml"><mo stretchy="false" id="alg3.l9.m1.3.3.1.3.1" xref="alg3.l9.m1.12.12.3.3.3.cmml">(</mo><mi id="alg3.l9.m1.3.3.1.1" xref="alg3.l9.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l9.m1.3.3.1.3.2" xref="alg3.l9.m1.12.12.3.3.3.cmml">)</mo></mrow></msubsup><mo id="alg3.l9.m1.12.12.3.3.6" xref="alg3.l9.m1.12.12.3.4.cmml">,</mo><mi id="alg3.l9.m1.9.9" xref="alg3.l9.m1.9.9.cmml">ϵ</mi></mrow><mo stretchy="false" id="alg3.l9.m1.14.14.6" xref="alg3.l9.m1.14.14.6.cmml">←</mo><mrow id="alg3.l9.m1.14.14.5.2" xref="alg3.l9.m1.14.14.5.3.cmml"><mi id="alg3.l9.m1.6.6" xref="alg3.l9.m1.6.6.cmml">LQ</mi><mo id="alg3.l9.m1.14.14.5.2a" xref="alg3.l9.m1.14.14.5.3.cmml">⁡</mo><mrow id="alg3.l9.m1.14.14.5.2.2" xref="alg3.l9.m1.14.14.5.3.cmml"><mo stretchy="false" id="alg3.l9.m1.14.14.5.2.2.3" xref="alg3.l9.m1.14.14.5.3.cmml">(</mo><msup id="alg3.l9.m1.13.13.4.1.1.1" xref="alg3.l9.m1.13.13.4.1.1.1.cmml"><mi id="alg3.l9.m1.13.13.4.1.1.1.2" xref="alg3.l9.m1.13.13.4.1.1.1.2.cmml">𝐖</mi><mrow id="alg3.l9.m1.4.4.1.3" xref="alg3.l9.m1.13.13.4.1.1.1.cmml"><mo stretchy="false" id="alg3.l9.m1.4.4.1.3.1" xref="alg3.l9.m1.13.13.4.1.1.1.cmml">(</mo><mi id="alg3.l9.m1.4.4.1.1" xref="alg3.l9.m1.4.4.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l9.m1.4.4.1.3.2" xref="alg3.l9.m1.13.13.4.1.1.1.cmml">)</mo></mrow></msup><mo id="alg3.l9.m1.14.14.5.2.2.4" xref="alg3.l9.m1.14.14.5.3.cmml">,</mo><msup id="alg3.l9.m1.14.14.5.2.2.2" xref="alg3.l9.m1.14.14.5.2.2.2.cmml"><mi id="alg3.l9.m1.14.14.5.2.2.2.2" xref="alg3.l9.m1.14.14.5.2.2.2.2.cmml">𝐅</mi><mrow id="alg3.l9.m1.5.5.1.3" xref="alg3.l9.m1.14.14.5.2.2.2.cmml"><mo stretchy="false" id="alg3.l9.m1.5.5.1.3.1" xref="alg3.l9.m1.14.14.5.2.2.2.cmml">(</mo><mi id="alg3.l9.m1.5.5.1.1" xref="alg3.l9.m1.5.5.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l9.m1.5.5.1.3.2" xref="alg3.l9.m1.14.14.5.2.2.2.cmml">)</mo></mrow></msup><mo id="alg3.l9.m1.14.14.5.2.2.5" xref="alg3.l9.m1.14.14.5.3.cmml">,</mo><mi id="alg3.l9.m1.7.7" xref="alg3.l9.m1.7.7.cmml">c</mi><mo id="alg3.l9.m1.14.14.5.2.2.6" xref="alg3.l9.m1.14.14.5.3.cmml">,</mo><mi id="alg3.l9.m1.8.8" xref="alg3.l9.m1.8.8.cmml">r</mi><mo stretchy="false" id="alg3.l9.m1.14.14.5.2.2.7" xref="alg3.l9.m1.14.14.5.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.m1.14b"><apply id="alg3.l9.m1.14.14.cmml" xref="alg3.l9.m1.14.14"><ci id="alg3.l9.m1.14.14.6.cmml" xref="alg3.l9.m1.14.14.6">←</ci><list id="alg3.l9.m1.12.12.3.4.cmml" xref="alg3.l9.m1.12.12.3.3"><apply id="alg3.l9.m1.10.10.1.1.1.cmml" xref="alg3.l9.m1.10.10.1.1.1"><csymbol cd="ambiguous" id="alg3.l9.m1.10.10.1.1.1.1.cmml" xref="alg3.l9.m1.10.10.1.1.1">superscript</csymbol><ci id="alg3.l9.m1.10.10.1.1.1.2.cmml" xref="alg3.l9.m1.10.10.1.1.1.2">𝐐</ci><ci id="alg3.l9.m1.1.1.1.1.cmml" xref="alg3.l9.m1.1.1.1.1">𝑖</ci></apply><apply id="alg3.l9.m1.11.11.2.2.2.cmml" xref="alg3.l9.m1.11.11.2.2.2"><csymbol cd="ambiguous" id="alg3.l9.m1.11.11.2.2.2.1.cmml" xref="alg3.l9.m1.11.11.2.2.2">superscript</csymbol><apply id="alg3.l9.m1.11.11.2.2.2.2.cmml" xref="alg3.l9.m1.11.11.2.2.2"><csymbol cd="ambiguous" id="alg3.l9.m1.11.11.2.2.2.2.1.cmml" xref="alg3.l9.m1.11.11.2.2.2">subscript</csymbol><ci id="alg3.l9.m1.11.11.2.2.2.2.2.cmml" xref="alg3.l9.m1.11.11.2.2.2.2.2">𝐋</ci><cn type="integer" id="alg3.l9.m1.11.11.2.2.2.2.3.cmml" xref="alg3.l9.m1.11.11.2.2.2.2.3">1</cn></apply><ci id="alg3.l9.m1.2.2.1.1.cmml" xref="alg3.l9.m1.2.2.1.1">𝑖</ci></apply><apply id="alg3.l9.m1.12.12.3.3.3.cmml" xref="alg3.l9.m1.12.12.3.3.3"><csymbol cd="ambiguous" id="alg3.l9.m1.12.12.3.3.3.1.cmml" xref="alg3.l9.m1.12.12.3.3.3">superscript</csymbol><apply id="alg3.l9.m1.12.12.3.3.3.2.cmml" xref="alg3.l9.m1.12.12.3.3.3"><csymbol cd="ambiguous" id="alg3.l9.m1.12.12.3.3.3.2.1.cmml" xref="alg3.l9.m1.12.12.3.3.3">subscript</csymbol><ci id="alg3.l9.m1.12.12.3.3.3.2.2.cmml" xref="alg3.l9.m1.12.12.3.3.3.2.2">𝐋</ci><cn type="integer" id="alg3.l9.m1.12.12.3.3.3.2.3.cmml" xref="alg3.l9.m1.12.12.3.3.3.2.3">2</cn></apply><ci id="alg3.l9.m1.3.3.1.1.cmml" xref="alg3.l9.m1.3.3.1.1">𝑖</ci></apply><ci id="alg3.l9.m1.9.9.cmml" xref="alg3.l9.m1.9.9">italic-ϵ</ci></list><apply id="alg3.l9.m1.14.14.5.3.cmml" xref="alg3.l9.m1.14.14.5.2"><ci id="alg3.l9.m1.6.6.cmml" xref="alg3.l9.m1.6.6">LQ</ci><apply id="alg3.l9.m1.13.13.4.1.1.1.cmml" xref="alg3.l9.m1.13.13.4.1.1.1"><csymbol cd="ambiguous" id="alg3.l9.m1.13.13.4.1.1.1.1.cmml" xref="alg3.l9.m1.13.13.4.1.1.1">superscript</csymbol><ci id="alg3.l9.m1.13.13.4.1.1.1.2.cmml" xref="alg3.l9.m1.13.13.4.1.1.1.2">𝐖</ci><ci id="alg3.l9.m1.4.4.1.1.cmml" xref="alg3.l9.m1.4.4.1.1">𝑖</ci></apply><apply id="alg3.l9.m1.14.14.5.2.2.2.cmml" xref="alg3.l9.m1.14.14.5.2.2.2"><csymbol cd="ambiguous" id="alg3.l9.m1.14.14.5.2.2.2.1.cmml" xref="alg3.l9.m1.14.14.5.2.2.2">superscript</csymbol><ci id="alg3.l9.m1.14.14.5.2.2.2.2.cmml" xref="alg3.l9.m1.14.14.5.2.2.2.2">𝐅</ci><ci id="alg3.l9.m1.5.5.1.1.cmml" xref="alg3.l9.m1.5.5.1.1">𝑖</ci></apply><ci id="alg3.l9.m1.7.7.cmml" xref="alg3.l9.m1.7.7">𝑐</ci><ci id="alg3.l9.m1.8.8.cmml" xref="alg3.l9.m1.8.8">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m1.14c">\mathbf{Q}^{(i)},\mathbf{L}_{1}^{(i)},\mathbf{L}_{2}^{(i)},\epsilon\leftarrow\operatorname{LQ}(\mathbf{W}^{(i)},\mathbf{F}^{(i)},c,r)</annotation><annotation encoding="application/x-llamapun" id="alg3.l9.m1.14d">bold_Q start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_ϵ ← roman_LQ ( bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_F start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_c , italic_r )</annotation></semantics></math>

</span>
<span id="alg3.l10" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg3.l10.m1.2" class="ltx_Math" alttext="\mathbf{E}[i,c]\leftarrow\epsilon^{2}" display="inline"><semantics id="alg3.l10.m1.2a"><mrow id="alg3.l10.m1.2.3" xref="alg3.l10.m1.2.3.cmml"><mrow id="alg3.l10.m1.2.3.2" xref="alg3.l10.m1.2.3.2.cmml"><mi id="alg3.l10.m1.2.3.2.2" xref="alg3.l10.m1.2.3.2.2.cmml">𝐄</mi><mo id="alg3.l10.m1.2.3.2.1" xref="alg3.l10.m1.2.3.2.1.cmml" lspace="0px" rspace="0px"></mo><mrow id="alg3.l10.m1.2.3.2.3.2" xref="alg3.l10.m1.2.3.2.3.1.cmml"><mo stretchy="false" id="alg3.l10.m1.2.3.2.3.2.1" xref="alg3.l10.m1.2.3.2.3.1.cmml">[</mo><mi id="alg3.l10.m1.1.1" xref="alg3.l10.m1.1.1.cmml">i</mi><mo id="alg3.l10.m1.2.3.2.3.2.2" xref="alg3.l10.m1.2.3.2.3.1.cmml">,</mo><mi id="alg3.l10.m1.2.2" xref="alg3.l10.m1.2.2.cmml">c</mi><mo stretchy="false" id="alg3.l10.m1.2.3.2.3.2.3" xref="alg3.l10.m1.2.3.2.3.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="alg3.l10.m1.2.3.1" xref="alg3.l10.m1.2.3.1.cmml">←</mo><msup id="alg3.l10.m1.2.3.3" xref="alg3.l10.m1.2.3.3.cmml"><mi id="alg3.l10.m1.2.3.3.2" xref="alg3.l10.m1.2.3.3.2.cmml">ϵ</mi><mn id="alg3.l10.m1.2.3.3.3" xref="alg3.l10.m1.2.3.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="alg3.l10.m1.2b"><apply id="alg3.l10.m1.2.3.cmml" xref="alg3.l10.m1.2.3"><ci id="alg3.l10.m1.2.3.1.cmml" xref="alg3.l10.m1.2.3.1">←</ci><apply id="alg3.l10.m1.2.3.2.cmml" xref="alg3.l10.m1.2.3.2"><times id="alg3.l10.m1.2.3.2.1.cmml" xref="alg3.l10.m1.2.3.2.1"></times><ci id="alg3.l10.m1.2.3.2.2.cmml" xref="alg3.l10.m1.2.3.2.2">𝐄</ci><interval closure="closed" id="alg3.l10.m1.2.3.2.3.1.cmml" xref="alg3.l10.m1.2.3.2.3.2"><ci id="alg3.l10.m1.1.1.cmml" xref="alg3.l10.m1.1.1">𝑖</ci><ci id="alg3.l10.m1.2.2.cmml" xref="alg3.l10.m1.2.2">𝑐</ci></interval></apply><apply id="alg3.l10.m1.2.3.3.cmml" xref="alg3.l10.m1.2.3.3"><csymbol cd="ambiguous" id="alg3.l10.m1.2.3.3.1.cmml" xref="alg3.l10.m1.2.3.3">superscript</csymbol><ci id="alg3.l10.m1.2.3.3.2.cmml" xref="alg3.l10.m1.2.3.3.2">italic-ϵ</ci><cn type="integer" id="alg3.l10.m1.2.3.3.3.cmml" xref="alg3.l10.m1.2.3.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m1.2c">\mathbf{E}[i,c]\leftarrow\epsilon^{2}</annotation><annotation encoding="application/x-llamapun" id="alg3.l10.m1.2d">bold_E [ italic_i , italic_c ] ← italic_ϵ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>

</span>
<span id="alg3.l11" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg3.l11.m1.6" class="ltx_Math" alttext="\mathbf{S}[i,c]\leftarrow\operatorname{storage}(\mathbf{W}^{(i)},c)" display="inline"><semantics id="alg3.l11.m1.6a"><mrow id="alg3.l11.m1.6.6" xref="alg3.l11.m1.6.6.cmml"><mrow id="alg3.l11.m1.6.6.3" xref="alg3.l11.m1.6.6.3.cmml"><mi id="alg3.l11.m1.6.6.3.2" xref="alg3.l11.m1.6.6.3.2.cmml">𝐒</mi><mo id="alg3.l11.m1.6.6.3.1" xref="alg3.l11.m1.6.6.3.1.cmml" lspace="0px" rspace="0px"></mo><mrow id="alg3.l11.m1.6.6.3.3.2" xref="alg3.l11.m1.6.6.3.3.1.cmml"><mo stretchy="false" id="alg3.l11.m1.6.6.3.3.2.1" xref="alg3.l11.m1.6.6.3.3.1.cmml">[</mo><mi id="alg3.l11.m1.2.2" xref="alg3.l11.m1.2.2.cmml">i</mi><mo id="alg3.l11.m1.6.6.3.3.2.2" xref="alg3.l11.m1.6.6.3.3.1.cmml">,</mo><mi id="alg3.l11.m1.3.3" xref="alg3.l11.m1.3.3.cmml">c</mi><mo stretchy="false" id="alg3.l11.m1.6.6.3.3.2.3" xref="alg3.l11.m1.6.6.3.3.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="alg3.l11.m1.6.6.2" xref="alg3.l11.m1.6.6.2.cmml">←</mo><mrow id="alg3.l11.m1.6.6.1.1" xref="alg3.l11.m1.6.6.1.2.cmml"><mi id="alg3.l11.m1.4.4" xref="alg3.l11.m1.4.4.cmml">storage</mi><mo id="alg3.l11.m1.6.6.1.1a" xref="alg3.l11.m1.6.6.1.2.cmml">⁡</mo><mrow id="alg3.l11.m1.6.6.1.1.1" xref="alg3.l11.m1.6.6.1.2.cmml"><mo stretchy="false" id="alg3.l11.m1.6.6.1.1.1.2" xref="alg3.l11.m1.6.6.1.2.cmml">(</mo><msup id="alg3.l11.m1.6.6.1.1.1.1" xref="alg3.l11.m1.6.6.1.1.1.1.cmml"><mi id="alg3.l11.m1.6.6.1.1.1.1.2" xref="alg3.l11.m1.6.6.1.1.1.1.2.cmml">𝐖</mi><mrow id="alg3.l11.m1.1.1.1.3" xref="alg3.l11.m1.6.6.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l11.m1.1.1.1.3.1" xref="alg3.l11.m1.6.6.1.1.1.1.cmml">(</mo><mi id="alg3.l11.m1.1.1.1.1" xref="alg3.l11.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l11.m1.1.1.1.3.2" xref="alg3.l11.m1.6.6.1.1.1.1.cmml">)</mo></mrow></msup><mo id="alg3.l11.m1.6.6.1.1.1.3" xref="alg3.l11.m1.6.6.1.2.cmml">,</mo><mi id="alg3.l11.m1.5.5" xref="alg3.l11.m1.5.5.cmml">c</mi><mo stretchy="false" id="alg3.l11.m1.6.6.1.1.1.4" xref="alg3.l11.m1.6.6.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l11.m1.6b"><apply id="alg3.l11.m1.6.6.cmml" xref="alg3.l11.m1.6.6"><ci id="alg3.l11.m1.6.6.2.cmml" xref="alg3.l11.m1.6.6.2">←</ci><apply id="alg3.l11.m1.6.6.3.cmml" xref="alg3.l11.m1.6.6.3"><times id="alg3.l11.m1.6.6.3.1.cmml" xref="alg3.l11.m1.6.6.3.1"></times><ci id="alg3.l11.m1.6.6.3.2.cmml" xref="alg3.l11.m1.6.6.3.2">𝐒</ci><interval closure="closed" id="alg3.l11.m1.6.6.3.3.1.cmml" xref="alg3.l11.m1.6.6.3.3.2"><ci id="alg3.l11.m1.2.2.cmml" xref="alg3.l11.m1.2.2">𝑖</ci><ci id="alg3.l11.m1.3.3.cmml" xref="alg3.l11.m1.3.3">𝑐</ci></interval></apply><apply id="alg3.l11.m1.6.6.1.2.cmml" xref="alg3.l11.m1.6.6.1.1"><ci id="alg3.l11.m1.4.4.cmml" xref="alg3.l11.m1.4.4">storage</ci><apply id="alg3.l11.m1.6.6.1.1.1.1.cmml" xref="alg3.l11.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l11.m1.6.6.1.1.1.1.1.cmml" xref="alg3.l11.m1.6.6.1.1.1.1">superscript</csymbol><ci id="alg3.l11.m1.6.6.1.1.1.1.2.cmml" xref="alg3.l11.m1.6.6.1.1.1.1.2">𝐖</ci><ci id="alg3.l11.m1.1.1.1.1.cmml" xref="alg3.l11.m1.1.1.1.1">𝑖</ci></apply><ci id="alg3.l11.m1.5.5.cmml" xref="alg3.l11.m1.5.5">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m1.6c">\mathbf{S}[i,c]\leftarrow\operatorname{storage}(\mathbf{W}^{(i)},c)</annotation><annotation encoding="application/x-llamapun" id="alg3.l11.m1.6d">bold_S [ italic_i , italic_c ] ← roman_storage ( bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_c )</annotation></semantics></math>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>
<span id="alg3.l12" class="ltx_listingline"><span id="alg3.l12.1" class="ltx_text" style="color:#808080;"># get optimal configuration given budget with ILP.</span>

</span>
<span id="alg3.l13" class="ltx_listingline"><math id="alg3.l13.m1.7" class="ltx_Math" alttext="\{c^{(i)}\}_{i\in[N]}\leftarrow\operatorname{ILPSolve}(\mathbf{S},\mathbf{E},B_{Q})" display="inline"><semantics id="alg3.l13.m1.7a"><mrow id="alg3.l13.m1.7.7" xref="alg3.l13.m1.7.7.cmml"><msub id="alg3.l13.m1.6.6.1" xref="alg3.l13.m1.6.6.1.cmml"><mrow id="alg3.l13.m1.6.6.1.1.1" xref="alg3.l13.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="alg3.l13.m1.6.6.1.1.1.2" xref="alg3.l13.m1.6.6.1.1.2.cmml">{</mo><msup id="alg3.l13.m1.6.6.1.1.1.1" xref="alg3.l13.m1.6.6.1.1.1.1.cmml"><mi id="alg3.l13.m1.6.6.1.1.1.1.2" xref="alg3.l13.m1.6.6.1.1.1.1.2.cmml">c</mi><mrow id="alg3.l13.m1.1.1.1.3" xref="alg3.l13.m1.6.6.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l13.m1.1.1.1.3.1" xref="alg3.l13.m1.6.6.1.1.1.1.cmml">(</mo><mi id="alg3.l13.m1.1.1.1.1" xref="alg3.l13.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l13.m1.1.1.1.3.2" xref="alg3.l13.m1.6.6.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg3.l13.m1.6.6.1.1.1.3" xref="alg3.l13.m1.6.6.1.1.2.cmml">}</mo></mrow><mrow id="alg3.l13.m1.2.2.1" xref="alg3.l13.m1.2.2.1.cmml"><mi id="alg3.l13.m1.2.2.1.3" xref="alg3.l13.m1.2.2.1.3.cmml">i</mi><mo id="alg3.l13.m1.2.2.1.2" xref="alg3.l13.m1.2.2.1.2.cmml">∈</mo><mrow id="alg3.l13.m1.2.2.1.4.2" xref="alg3.l13.m1.2.2.1.4.1.cmml"><mo stretchy="false" id="alg3.l13.m1.2.2.1.4.2.1" xref="alg3.l13.m1.2.2.1.4.1.1.cmml">[</mo><mi id="alg3.l13.m1.2.2.1.1" xref="alg3.l13.m1.2.2.1.1.cmml">N</mi><mo stretchy="false" id="alg3.l13.m1.2.2.1.4.2.2" xref="alg3.l13.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></msub><mo stretchy="false" id="alg3.l13.m1.7.7.3" xref="alg3.l13.m1.7.7.3.cmml">←</mo><mrow id="alg3.l13.m1.7.7.2.1" xref="alg3.l13.m1.7.7.2.2.cmml"><mi id="alg3.l13.m1.3.3" xref="alg3.l13.m1.3.3.cmml">ILPSolve</mi><mo id="alg3.l13.m1.7.7.2.1a" xref="alg3.l13.m1.7.7.2.2.cmml">⁡</mo><mrow id="alg3.l13.m1.7.7.2.1.1" xref="alg3.l13.m1.7.7.2.2.cmml"><mo stretchy="false" id="alg3.l13.m1.7.7.2.1.1.2" xref="alg3.l13.m1.7.7.2.2.cmml">(</mo><mi id="alg3.l13.m1.4.4" xref="alg3.l13.m1.4.4.cmml">𝐒</mi><mo id="alg3.l13.m1.7.7.2.1.1.3" xref="alg3.l13.m1.7.7.2.2.cmml">,</mo><mi id="alg3.l13.m1.5.5" xref="alg3.l13.m1.5.5.cmml">𝐄</mi><mo id="alg3.l13.m1.7.7.2.1.1.4" xref="alg3.l13.m1.7.7.2.2.cmml">,</mo><msub id="alg3.l13.m1.7.7.2.1.1.1" xref="alg3.l13.m1.7.7.2.1.1.1.cmml"><mi id="alg3.l13.m1.7.7.2.1.1.1.2" xref="alg3.l13.m1.7.7.2.1.1.1.2.cmml">B</mi><mi id="alg3.l13.m1.7.7.2.1.1.1.3" xref="alg3.l13.m1.7.7.2.1.1.1.3.cmml">Q</mi></msub><mo stretchy="false" id="alg3.l13.m1.7.7.2.1.1.5" xref="alg3.l13.m1.7.7.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l13.m1.7b"><apply id="alg3.l13.m1.7.7.cmml" xref="alg3.l13.m1.7.7"><ci id="alg3.l13.m1.7.7.3.cmml" xref="alg3.l13.m1.7.7.3">←</ci><apply id="alg3.l13.m1.6.6.1.cmml" xref="alg3.l13.m1.6.6.1"><csymbol cd="ambiguous" id="alg3.l13.m1.6.6.1.2.cmml" xref="alg3.l13.m1.6.6.1">subscript</csymbol><set id="alg3.l13.m1.6.6.1.1.2.cmml" xref="alg3.l13.m1.6.6.1.1.1"><apply id="alg3.l13.m1.6.6.1.1.1.1.cmml" xref="alg3.l13.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l13.m1.6.6.1.1.1.1.1.cmml" xref="alg3.l13.m1.6.6.1.1.1.1">superscript</csymbol><ci id="alg3.l13.m1.6.6.1.1.1.1.2.cmml" xref="alg3.l13.m1.6.6.1.1.1.1.2">𝑐</ci><ci id="alg3.l13.m1.1.1.1.1.cmml" xref="alg3.l13.m1.1.1.1.1">𝑖</ci></apply></set><apply id="alg3.l13.m1.2.2.1.cmml" xref="alg3.l13.m1.2.2.1"><in id="alg3.l13.m1.2.2.1.2.cmml" xref="alg3.l13.m1.2.2.1.2"></in><ci id="alg3.l13.m1.2.2.1.3.cmml" xref="alg3.l13.m1.2.2.1.3">𝑖</ci><apply id="alg3.l13.m1.2.2.1.4.1.cmml" xref="alg3.l13.m1.2.2.1.4.2"><csymbol cd="latexml" id="alg3.l13.m1.2.2.1.4.1.1.cmml" xref="alg3.l13.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="alg3.l13.m1.2.2.1.1.cmml" xref="alg3.l13.m1.2.2.1.1">𝑁</ci></apply></apply></apply><apply id="alg3.l13.m1.7.7.2.2.cmml" xref="alg3.l13.m1.7.7.2.1"><ci id="alg3.l13.m1.3.3.cmml" xref="alg3.l13.m1.3.3">ILPSolve</ci><ci id="alg3.l13.m1.4.4.cmml" xref="alg3.l13.m1.4.4">𝐒</ci><ci id="alg3.l13.m1.5.5.cmml" xref="alg3.l13.m1.5.5">𝐄</ci><apply id="alg3.l13.m1.7.7.2.1.1.1.cmml" xref="alg3.l13.m1.7.7.2.1.1.1"><csymbol cd="ambiguous" id="alg3.l13.m1.7.7.2.1.1.1.1.cmml" xref="alg3.l13.m1.7.7.2.1.1.1">subscript</csymbol><ci id="alg3.l13.m1.7.7.2.1.1.1.2.cmml" xref="alg3.l13.m1.7.7.2.1.1.1.2">𝐵</ci><ci id="alg3.l13.m1.7.7.2.1.1.1.3.cmml" xref="alg3.l13.m1.7.7.2.1.1.1.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.m1.7c">\{c^{(i)}\}_{i\in[N]}\leftarrow\operatorname{ILPSolve}(\mathbf{S},\mathbf{E},B_{Q})</annotation><annotation encoding="application/x-llamapun" id="alg3.l13.m1.7d">{ italic_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT ← roman_ILPSolve ( bold_S , bold_E , italic_B start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT )</annotation></semantics></math>

</span>
<span id="alg3.l14" class="ltx_listingline"><math id="alg3.l14.m1.3" class="ltx_Math" alttext="\{c^{(i)}\}_{i\in[N]}" display="inline"><semantics id="alg3.l14.m1.3a"><msub id="alg3.l14.m1.3.3" xref="alg3.l14.m1.3.3.cmml"><mrow id="alg3.l14.m1.3.3.1.1" xref="alg3.l14.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg3.l14.m1.3.3.1.1.2" xref="alg3.l14.m1.3.3.1.2.cmml">{</mo><msup id="alg3.l14.m1.3.3.1.1.1" xref="alg3.l14.m1.3.3.1.1.1.cmml"><mi id="alg3.l14.m1.3.3.1.1.1.2" xref="alg3.l14.m1.3.3.1.1.1.2.cmml">c</mi><mrow id="alg3.l14.m1.1.1.1.3" xref="alg3.l14.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="alg3.l14.m1.1.1.1.3.1" xref="alg3.l14.m1.3.3.1.1.1.cmml">(</mo><mi id="alg3.l14.m1.1.1.1.1" xref="alg3.l14.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg3.l14.m1.1.1.1.3.2" xref="alg3.l14.m1.3.3.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg3.l14.m1.3.3.1.1.3" xref="alg3.l14.m1.3.3.1.2.cmml">}</mo></mrow><mrow id="alg3.l14.m1.2.2.1" xref="alg3.l14.m1.2.2.1.cmml"><mi id="alg3.l14.m1.2.2.1.3" xref="alg3.l14.m1.2.2.1.3.cmml">i</mi><mo id="alg3.l14.m1.2.2.1.2" xref="alg3.l14.m1.2.2.1.2.cmml">∈</mo><mrow id="alg3.l14.m1.2.2.1.4.2" xref="alg3.l14.m1.2.2.1.4.1.cmml"><mo stretchy="false" id="alg3.l14.m1.2.2.1.4.2.1" xref="alg3.l14.m1.2.2.1.4.1.1.cmml">[</mo><mi id="alg3.l14.m1.2.2.1.1" xref="alg3.l14.m1.2.2.1.1.cmml">N</mi><mo stretchy="false" id="alg3.l14.m1.2.2.1.4.2.2" xref="alg3.l14.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="alg3.l14.m1.3b"><apply id="alg3.l14.m1.3.3.cmml" xref="alg3.l14.m1.3.3"><csymbol cd="ambiguous" id="alg3.l14.m1.3.3.2.cmml" xref="alg3.l14.m1.3.3">subscript</csymbol><set id="alg3.l14.m1.3.3.1.2.cmml" xref="alg3.l14.m1.3.3.1.1"><apply id="alg3.l14.m1.3.3.1.1.1.cmml" xref="alg3.l14.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg3.l14.m1.3.3.1.1.1.1.cmml" xref="alg3.l14.m1.3.3.1.1.1">superscript</csymbol><ci id="alg3.l14.m1.3.3.1.1.1.2.cmml" xref="alg3.l14.m1.3.3.1.1.1.2">𝑐</ci><ci id="alg3.l14.m1.1.1.1.1.cmml" xref="alg3.l14.m1.1.1.1.1">𝑖</ci></apply></set><apply id="alg3.l14.m1.2.2.1.cmml" xref="alg3.l14.m1.2.2.1"><in id="alg3.l14.m1.2.2.1.2.cmml" xref="alg3.l14.m1.2.2.1.2"></in><ci id="alg3.l14.m1.2.2.1.3.cmml" xref="alg3.l14.m1.2.2.1.3">𝑖</ci><apply id="alg3.l14.m1.2.2.1.4.1.cmml" xref="alg3.l14.m1.2.2.1.4.2"><csymbol cd="latexml" id="alg3.l14.m1.2.2.1.4.1.1.cmml" xref="alg3.l14.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="alg3.l14.m1.2.2.1.1.cmml" xref="alg3.l14.m1.2.2.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l14.m1.3c">\{c^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="alg3.l14.m1.3d">{ italic_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math>

</span>
</span>
</span>
<span id="alg4" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg4.4.1.1" class="ltx_text ltx_font_bold">Algorithm 4</span> </span> <math id="alg4.2.m1.1" class="ltx_Math" alttext="\operatorname{Factorize}" display="inline"><semantics id="alg4.2.m1.1b"><mi id="alg4.2.m1.1.1" xref="alg4.2.m1.1.1.cmml">Factorize</mi><annotation-xml encoding="MathML-Content" id="alg4.2.m1.1c"><ci id="alg4.2.m1.1.1.cmml" xref="alg4.2.m1.1.1">Factorize</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.2.m1.1d">\operatorname{Factorize}</annotation><annotation encoding="application/x-llamapun" id="alg4.2.m1.1e">roman_Factorize</annotation></semantics></math> (Section&nbsp;<a href="#S3.SS3" title="3.3 Data-Aware Matrix Decomposition via Fisher-weighted SVD ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>)</span>
<span id="alg4.5" class="ltx_listing ltx_listing">
<span id="alg4.l1" class="ltx_listingline"><math id="alg4.l1.m1.1" class="ltx_Math" alttext="\mathbf{\mathbf{A}}" display="inline"><semantics id="alg4.l1.m1.1a"><mi id="alg4.l1.m1.1.1" xref="alg4.l1.m1.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m1.1b"><ci id="alg4.l1.m1.1.1.cmml" xref="alg4.l1.m1.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m1.1c">\mathbf{\mathbf{A}}</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m1.1d">bold_A</annotation></semantics></math>: Input matrix 
</span>
<span id="alg4.l2" class="ltx_listingline">  &nbsp;<math id="alg4.l2.m1.1" class="ltx_Math" alttext="\mathbf{F}" display="inline"><semantics id="alg4.l2.m1.1a"><mi id="alg4.l2.m1.1.1" xref="alg4.l2.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="alg4.l2.m1.1b"><ci id="alg4.l2.m1.1.1.cmml" xref="alg4.l2.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l2.m1.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="alg4.l2.m1.1d">bold_F</annotation></semantics></math>: SVD weighting matrix (optional) 
</span>
<span id="alg4.l3" class="ltx_listingline">  &nbsp;<math id="alg4.l3.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg4.l3.m1.1a"><mi id="alg4.l3.m1.1.1" xref="alg4.l3.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg4.l3.m1.1b"><ci id="alg4.l3.m1.1.1.cmml" xref="alg4.l3.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg4.l3.m1.1d">italic_r</annotation></semantics></math>: Target rank

</span>
<span id="alg4.l4" class="ltx_listingline"><span id="alg4.l4.1" class="ltx_text ltx_font_bold">if</span>&nbsp;<math id="alg4.l4.m1.1" class="ltx_Math" alttext="\mathbf{F}" display="inline"><semantics id="alg4.l4.m1.1a"><mi id="alg4.l4.m1.1.1" xref="alg4.l4.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="alg4.l4.m1.1b"><ci id="alg4.l4.m1.1.1.cmml" xref="alg4.l4.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m1.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="alg4.l4.m1.1d">bold_F</annotation></semantics></math> is <math id="alg4.l4.m2.1" class="ltx_Math" alttext="\operatorname{None}" display="inline"><semantics id="alg4.l4.m2.1a"><mi id="alg4.l4.m2.1.1" xref="alg4.l4.m2.1.1.cmml">None</mi><annotation-xml encoding="MathML-Content" id="alg4.l4.m2.1b"><ci id="alg4.l4.m2.1.1.cmml" xref="alg4.l4.m2.1.1">None</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m2.1c">\operatorname{None}</annotation><annotation encoding="application/x-llamapun" id="alg4.l4.m2.1d">roman_None</annotation></semantics></math>&nbsp;<span id="alg4.l4.2" class="ltx_text ltx_font_bold">then</span>

</span>
<span id="alg4.l5" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg4.l5.2" class="ltx_text" style="color:#808080;"># (randomized) SVD with target rank</span><span id="alg4.l5.1" class="ltx_text" style="color:#808080;"> <math id="alg4.l5.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg4.l5.1.m1.1a"><mi mathcolor="#808080" id="alg4.l5.1.m1.1.1" xref="alg4.l5.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg4.l5.1.m1.1b"><ci id="alg4.l5.1.m1.1.1.cmml" xref="alg4.l5.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg4.l5.1.m1.1d">italic_r</annotation></semantics></math></span>

</span>
<span id="alg4.l6" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg4.l6.m1.6" class="ltx_Math" alttext="[\mathbf{U},\mathbf{\Sigma},\mathbf{V}^{\top}]\leftarrow\operatorname{SVD}(\mathbf{A},r)" display="inline"><semantics id="alg4.l6.m1.6a"><mrow id="alg4.l6.m1.6.6" xref="alg4.l6.m1.6.6.cmml"><mrow id="alg4.l6.m1.6.6.1.1" xref="alg4.l6.m1.6.6.1.2.cmml"><mo stretchy="false" id="alg4.l6.m1.6.6.1.1.2" xref="alg4.l6.m1.6.6.1.2.cmml">[</mo><mi id="alg4.l6.m1.1.1" xref="alg4.l6.m1.1.1.cmml">𝐔</mi><mo id="alg4.l6.m1.6.6.1.1.3" xref="alg4.l6.m1.6.6.1.2.cmml">,</mo><mi id="alg4.l6.m1.2.2" xref="alg4.l6.m1.2.2.cmml">𝚺</mi><mo id="alg4.l6.m1.6.6.1.1.4" xref="alg4.l6.m1.6.6.1.2.cmml">,</mo><msup id="alg4.l6.m1.6.6.1.1.1" xref="alg4.l6.m1.6.6.1.1.1.cmml"><mi id="alg4.l6.m1.6.6.1.1.1.2" xref="alg4.l6.m1.6.6.1.1.1.2.cmml">𝐕</mi><mo id="alg4.l6.m1.6.6.1.1.1.3" xref="alg4.l6.m1.6.6.1.1.1.3.cmml">⊤</mo></msup><mo stretchy="false" id="alg4.l6.m1.6.6.1.1.5" xref="alg4.l6.m1.6.6.1.2.cmml">]</mo></mrow><mo stretchy="false" id="alg4.l6.m1.6.6.2" xref="alg4.l6.m1.6.6.2.cmml">←</mo><mrow id="alg4.l6.m1.6.6.3.2" xref="alg4.l6.m1.6.6.3.1.cmml"><mi id="alg4.l6.m1.3.3" xref="alg4.l6.m1.3.3.cmml">SVD</mi><mo id="alg4.l6.m1.6.6.3.2a" xref="alg4.l6.m1.6.6.3.1.cmml">⁡</mo><mrow id="alg4.l6.m1.6.6.3.2.1" xref="alg4.l6.m1.6.6.3.1.cmml"><mo stretchy="false" id="alg4.l6.m1.6.6.3.2.1.1" xref="alg4.l6.m1.6.6.3.1.cmml">(</mo><mi id="alg4.l6.m1.4.4" xref="alg4.l6.m1.4.4.cmml">𝐀</mi><mo id="alg4.l6.m1.6.6.3.2.1.2" xref="alg4.l6.m1.6.6.3.1.cmml">,</mo><mi id="alg4.l6.m1.5.5" xref="alg4.l6.m1.5.5.cmml">r</mi><mo stretchy="false" id="alg4.l6.m1.6.6.3.2.1.3" xref="alg4.l6.m1.6.6.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l6.m1.6b"><apply id="alg4.l6.m1.6.6.cmml" xref="alg4.l6.m1.6.6"><ci id="alg4.l6.m1.6.6.2.cmml" xref="alg4.l6.m1.6.6.2">←</ci><list id="alg4.l6.m1.6.6.1.2.cmml" xref="alg4.l6.m1.6.6.1.1"><ci id="alg4.l6.m1.1.1.cmml" xref="alg4.l6.m1.1.1">𝐔</ci><ci id="alg4.l6.m1.2.2.cmml" xref="alg4.l6.m1.2.2">𝚺</ci><apply id="alg4.l6.m1.6.6.1.1.1.cmml" xref="alg4.l6.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="alg4.l6.m1.6.6.1.1.1.1.cmml" xref="alg4.l6.m1.6.6.1.1.1">superscript</csymbol><ci id="alg4.l6.m1.6.6.1.1.1.2.cmml" xref="alg4.l6.m1.6.6.1.1.1.2">𝐕</ci><csymbol cd="latexml" id="alg4.l6.m1.6.6.1.1.1.3.cmml" xref="alg4.l6.m1.6.6.1.1.1.3">top</csymbol></apply></list><apply id="alg4.l6.m1.6.6.3.1.cmml" xref="alg4.l6.m1.6.6.3.2"><ci id="alg4.l6.m1.3.3.cmml" xref="alg4.l6.m1.3.3">SVD</ci><ci id="alg4.l6.m1.4.4.cmml" xref="alg4.l6.m1.4.4">𝐀</ci><ci id="alg4.l6.m1.5.5.cmml" xref="alg4.l6.m1.5.5">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.m1.6c">[\mathbf{U},\mathbf{\Sigma},\mathbf{V}^{\top}]\leftarrow\operatorname{SVD}(\mathbf{A},r)</annotation><annotation encoding="application/x-llamapun" id="alg4.l6.m1.6d">[ bold_U , bold_Σ , bold_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] ← roman_SVD ( bold_A , italic_r )</annotation></semantics></math>

</span>
<span id="alg4.l7" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg4.l7.m1.1" class="ltx_Math" alttext="\mathbf{L}_{1}\leftarrow\mathbf{U}\sqrt{\mathbf{\Sigma}}" display="inline"><semantics id="alg4.l7.m1.1a"><mrow id="alg4.l7.m1.1.1" xref="alg4.l7.m1.1.1.cmml"><msub id="alg4.l7.m1.1.1.2" xref="alg4.l7.m1.1.1.2.cmml"><mi id="alg4.l7.m1.1.1.2.2" xref="alg4.l7.m1.1.1.2.2.cmml">𝐋</mi><mn id="alg4.l7.m1.1.1.2.3" xref="alg4.l7.m1.1.1.2.3.cmml">1</mn></msub><mo stretchy="false" id="alg4.l7.m1.1.1.1" xref="alg4.l7.m1.1.1.1.cmml">←</mo><mrow id="alg4.l7.m1.1.1.3" xref="alg4.l7.m1.1.1.3.cmml"><mi id="alg4.l7.m1.1.1.3.2" xref="alg4.l7.m1.1.1.3.2.cmml">𝐔</mi><mo id="alg4.l7.m1.1.1.3.1" xref="alg4.l7.m1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msqrt id="alg4.l7.m1.1.1.3.3" xref="alg4.l7.m1.1.1.3.3.cmml"><mi id="alg4.l7.m1.1.1.3.3.2" xref="alg4.l7.m1.1.1.3.3.2.cmml">𝚺</mi></msqrt></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l7.m1.1b"><apply id="alg4.l7.m1.1.1.cmml" xref="alg4.l7.m1.1.1"><ci id="alg4.l7.m1.1.1.1.cmml" xref="alg4.l7.m1.1.1.1">←</ci><apply id="alg4.l7.m1.1.1.2.cmml" xref="alg4.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg4.l7.m1.1.1.2.1.cmml" xref="alg4.l7.m1.1.1.2">subscript</csymbol><ci id="alg4.l7.m1.1.1.2.2.cmml" xref="alg4.l7.m1.1.1.2.2">𝐋</ci><cn type="integer" id="alg4.l7.m1.1.1.2.3.cmml" xref="alg4.l7.m1.1.1.2.3">1</cn></apply><apply id="alg4.l7.m1.1.1.3.cmml" xref="alg4.l7.m1.1.1.3"><times id="alg4.l7.m1.1.1.3.1.cmml" xref="alg4.l7.m1.1.1.3.1"></times><ci id="alg4.l7.m1.1.1.3.2.cmml" xref="alg4.l7.m1.1.1.3.2">𝐔</ci><apply id="alg4.l7.m1.1.1.3.3.cmml" xref="alg4.l7.m1.1.1.3.3"><root id="alg4.l7.m1.1.1.3.3a.cmml" xref="alg4.l7.m1.1.1.3.3"></root><ci id="alg4.l7.m1.1.1.3.3.2.cmml" xref="alg4.l7.m1.1.1.3.3.2">𝚺</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l7.m1.1c">\mathbf{L}_{1}\leftarrow\mathbf{U}\sqrt{\mathbf{\Sigma}}</annotation><annotation encoding="application/x-llamapun" id="alg4.l7.m1.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ← bold_U square-root start_ARG bold_Σ end_ARG</annotation></semantics></math>, <math id="alg4.l7.m2.1" class="ltx_Math" alttext="\,\,\mathbf{L}_{2}\leftarrow\sqrt{\mathbf{\Sigma}}\mathbf{V}^{\top}" display="inline"><semantics id="alg4.l7.m2.1a"><mrow id="alg4.l7.m2.1.1" xref="alg4.l7.m2.1.1.cmml"><msub id="alg4.l7.m2.1.1.2" xref="alg4.l7.m2.1.1.2.cmml"><mi id="alg4.l7.m2.1.1.2.2" xref="alg4.l7.m2.1.1.2.2.cmml">𝐋</mi><mn id="alg4.l7.m2.1.1.2.3" xref="alg4.l7.m2.1.1.2.3.cmml">2</mn></msub><mo stretchy="false" id="alg4.l7.m2.1.1.1" xref="alg4.l7.m2.1.1.1.cmml">←</mo><mrow id="alg4.l7.m2.1.1.3" xref="alg4.l7.m2.1.1.3.cmml"><msqrt id="alg4.l7.m2.1.1.3.2" xref="alg4.l7.m2.1.1.3.2.cmml"><mi id="alg4.l7.m2.1.1.3.2.2" xref="alg4.l7.m2.1.1.3.2.2.cmml">𝚺</mi></msqrt><mo id="alg4.l7.m2.1.1.3.1" xref="alg4.l7.m2.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msup id="alg4.l7.m2.1.1.3.3" xref="alg4.l7.m2.1.1.3.3.cmml"><mi id="alg4.l7.m2.1.1.3.3.2" xref="alg4.l7.m2.1.1.3.3.2.cmml">𝐕</mi><mo id="alg4.l7.m2.1.1.3.3.3" xref="alg4.l7.m2.1.1.3.3.3.cmml">⊤</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l7.m2.1b"><apply id="alg4.l7.m2.1.1.cmml" xref="alg4.l7.m2.1.1"><ci id="alg4.l7.m2.1.1.1.cmml" xref="alg4.l7.m2.1.1.1">←</ci><apply id="alg4.l7.m2.1.1.2.cmml" xref="alg4.l7.m2.1.1.2"><csymbol cd="ambiguous" id="alg4.l7.m2.1.1.2.1.cmml" xref="alg4.l7.m2.1.1.2">subscript</csymbol><ci id="alg4.l7.m2.1.1.2.2.cmml" xref="alg4.l7.m2.1.1.2.2">𝐋</ci><cn type="integer" id="alg4.l7.m2.1.1.2.3.cmml" xref="alg4.l7.m2.1.1.2.3">2</cn></apply><apply id="alg4.l7.m2.1.1.3.cmml" xref="alg4.l7.m2.1.1.3"><times id="alg4.l7.m2.1.1.3.1.cmml" xref="alg4.l7.m2.1.1.3.1"></times><apply id="alg4.l7.m2.1.1.3.2.cmml" xref="alg4.l7.m2.1.1.3.2"><root id="alg4.l7.m2.1.1.3.2a.cmml" xref="alg4.l7.m2.1.1.3.2"></root><ci id="alg4.l7.m2.1.1.3.2.2.cmml" xref="alg4.l7.m2.1.1.3.2.2">𝚺</ci></apply><apply id="alg4.l7.m2.1.1.3.3.cmml" xref="alg4.l7.m2.1.1.3.3"><csymbol cd="ambiguous" id="alg4.l7.m2.1.1.3.3.1.cmml" xref="alg4.l7.m2.1.1.3.3">superscript</csymbol><ci id="alg4.l7.m2.1.1.3.3.2.cmml" xref="alg4.l7.m2.1.1.3.3.2">𝐕</ci><csymbol cd="latexml" id="alg4.l7.m2.1.1.3.3.3.cmml" xref="alg4.l7.m2.1.1.3.3.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l7.m2.1c">\,\,\mathbf{L}_{2}\leftarrow\sqrt{\mathbf{\Sigma}}\mathbf{V}^{\top}</annotation><annotation encoding="application/x-llamapun" id="alg4.l7.m2.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ← square-root start_ARG bold_Σ end_ARG bold_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>

</span>
<span id="alg4.l8" class="ltx_listingline"><span id="alg4.l8.1" class="ltx_text ltx_font_bold">else</span>&nbsp;&nbsp;&nbsp;&nbsp; <span id="alg4.l8.2" class="ltx_text" style="color:#808080;"># weighted SVD (Section&nbsp;<a href="#S3.SS3" title="3.3 Data-Aware Matrix Decomposition via Fisher-weighted SVD ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>).</span>

</span>
<span id="alg4.l9" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg4.l9.m1.2" class="ltx_Math" alttext="\mathbf{D}_{\text{row}}\leftarrow\operatorname{RowAverage}(\mathbf{F})" display="inline"><semantics id="alg4.l9.m1.2a"><mrow id="alg4.l9.m1.2.3" xref="alg4.l9.m1.2.3.cmml"><msub id="alg4.l9.m1.2.3.2" xref="alg4.l9.m1.2.3.2.cmml"><mi id="alg4.l9.m1.2.3.2.2" xref="alg4.l9.m1.2.3.2.2.cmml">𝐃</mi><mtext id="alg4.l9.m1.2.3.2.3" xref="alg4.l9.m1.2.3.2.3a.cmml">row</mtext></msub><mo stretchy="false" id="alg4.l9.m1.2.3.1" xref="alg4.l9.m1.2.3.1.cmml">←</mo><mrow id="alg4.l9.m1.2.3.3.2" xref="alg4.l9.m1.2.3.3.1.cmml"><mi id="alg4.l9.m1.1.1" xref="alg4.l9.m1.1.1.cmml">RowAverage</mi><mo id="alg4.l9.m1.2.3.3.2a" xref="alg4.l9.m1.2.3.3.1.cmml">⁡</mo><mrow id="alg4.l9.m1.2.3.3.2.1" xref="alg4.l9.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg4.l9.m1.2.3.3.2.1.1" xref="alg4.l9.m1.2.3.3.1.cmml">(</mo><mi id="alg4.l9.m1.2.2" xref="alg4.l9.m1.2.2.cmml">𝐅</mi><mo stretchy="false" id="alg4.l9.m1.2.3.3.2.1.2" xref="alg4.l9.m1.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l9.m1.2b"><apply id="alg4.l9.m1.2.3.cmml" xref="alg4.l9.m1.2.3"><ci id="alg4.l9.m1.2.3.1.cmml" xref="alg4.l9.m1.2.3.1">←</ci><apply id="alg4.l9.m1.2.3.2.cmml" xref="alg4.l9.m1.2.3.2"><csymbol cd="ambiguous" id="alg4.l9.m1.2.3.2.1.cmml" xref="alg4.l9.m1.2.3.2">subscript</csymbol><ci id="alg4.l9.m1.2.3.2.2.cmml" xref="alg4.l9.m1.2.3.2.2">𝐃</ci><ci id="alg4.l9.m1.2.3.2.3a.cmml" xref="alg4.l9.m1.2.3.2.3"><mtext mathsize="70%" id="alg4.l9.m1.2.3.2.3.cmml" xref="alg4.l9.m1.2.3.2.3">row</mtext></ci></apply><apply id="alg4.l9.m1.2.3.3.1.cmml" xref="alg4.l9.m1.2.3.3.2"><ci id="alg4.l9.m1.1.1.cmml" xref="alg4.l9.m1.1.1">RowAverage</ci><ci id="alg4.l9.m1.2.2.cmml" xref="alg4.l9.m1.2.2">𝐅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l9.m1.2c">\mathbf{D}_{\text{row}}\leftarrow\operatorname{RowAverage}(\mathbf{F})</annotation><annotation encoding="application/x-llamapun" id="alg4.l9.m1.2d">bold_D start_POSTSUBSCRIPT row end_POSTSUBSCRIPT ← roman_RowAverage ( bold_F )</annotation></semantics></math>

</span>
<span id="alg4.l10" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg4.l10.m1.2" class="ltx_Math" alttext="\mathbf{D}_{\text{col}}\,\leftarrow\operatorname{ColAverage}(\mathbf{F})" display="inline"><semantics id="alg4.l10.m1.2a"><mrow id="alg4.l10.m1.2.3" xref="alg4.l10.m1.2.3.cmml"><msub id="alg4.l10.m1.2.3.2" xref="alg4.l10.m1.2.3.2.cmml"><mi id="alg4.l10.m1.2.3.2.2" xref="alg4.l10.m1.2.3.2.2.cmml">𝐃</mi><mtext id="alg4.l10.m1.2.3.2.3" xref="alg4.l10.m1.2.3.2.3a.cmml">col</mtext></msub><mo lspace="0.448em" stretchy="false" id="alg4.l10.m1.2.3.1" xref="alg4.l10.m1.2.3.1.cmml">←</mo><mrow id="alg4.l10.m1.2.3.3.2" xref="alg4.l10.m1.2.3.3.1.cmml"><mi id="alg4.l10.m1.1.1" xref="alg4.l10.m1.1.1.cmml">ColAverage</mi><mo id="alg4.l10.m1.2.3.3.2a" xref="alg4.l10.m1.2.3.3.1.cmml">⁡</mo><mrow id="alg4.l10.m1.2.3.3.2.1" xref="alg4.l10.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg4.l10.m1.2.3.3.2.1.1" xref="alg4.l10.m1.2.3.3.1.cmml">(</mo><mi id="alg4.l10.m1.2.2" xref="alg4.l10.m1.2.2.cmml">𝐅</mi><mo stretchy="false" id="alg4.l10.m1.2.3.3.2.1.2" xref="alg4.l10.m1.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l10.m1.2b"><apply id="alg4.l10.m1.2.3.cmml" xref="alg4.l10.m1.2.3"><ci id="alg4.l10.m1.2.3.1.cmml" xref="alg4.l10.m1.2.3.1">←</ci><apply id="alg4.l10.m1.2.3.2.cmml" xref="alg4.l10.m1.2.3.2"><csymbol cd="ambiguous" id="alg4.l10.m1.2.3.2.1.cmml" xref="alg4.l10.m1.2.3.2">subscript</csymbol><ci id="alg4.l10.m1.2.3.2.2.cmml" xref="alg4.l10.m1.2.3.2.2">𝐃</ci><ci id="alg4.l10.m1.2.3.2.3a.cmml" xref="alg4.l10.m1.2.3.2.3"><mtext mathsize="70%" id="alg4.l10.m1.2.3.2.3.cmml" xref="alg4.l10.m1.2.3.2.3">col</mtext></ci></apply><apply id="alg4.l10.m1.2.3.3.1.cmml" xref="alg4.l10.m1.2.3.3.2"><ci id="alg4.l10.m1.1.1.cmml" xref="alg4.l10.m1.1.1">ColAverage</ci><ci id="alg4.l10.m1.2.2.cmml" xref="alg4.l10.m1.2.2">𝐅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.m1.2c">\mathbf{D}_{\text{col}}\,\leftarrow\operatorname{ColAverage}(\mathbf{F})</annotation><annotation encoding="application/x-llamapun" id="alg4.l10.m1.2d">bold_D start_POSTSUBSCRIPT col end_POSTSUBSCRIPT ← roman_ColAverage ( bold_F )</annotation></semantics></math>

</span>
<span id="alg4.l11" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg4.l11.m1.6" class="ltx_Math" alttext="[\mathbf{U},\mathbf{\Sigma},\mathbf{V}^{\top}]\leftarrow\operatorname{SVD}(\mathbf{D}_{\text{row}}\mathbf{A}\mathbf{D}_{\text{col}},r)" display="inline"><semantics id="alg4.l11.m1.6a"><mrow id="alg4.l11.m1.6.6" xref="alg4.l11.m1.6.6.cmml"><mrow id="alg4.l11.m1.5.5.1.1" xref="alg4.l11.m1.5.5.1.2.cmml"><mo stretchy="false" id="alg4.l11.m1.5.5.1.1.2" xref="alg4.l11.m1.5.5.1.2.cmml">[</mo><mi id="alg4.l11.m1.1.1" xref="alg4.l11.m1.1.1.cmml">𝐔</mi><mo id="alg4.l11.m1.5.5.1.1.3" xref="alg4.l11.m1.5.5.1.2.cmml">,</mo><mi id="alg4.l11.m1.2.2" xref="alg4.l11.m1.2.2.cmml">𝚺</mi><mo id="alg4.l11.m1.5.5.1.1.4" xref="alg4.l11.m1.5.5.1.2.cmml">,</mo><msup id="alg4.l11.m1.5.5.1.1.1" xref="alg4.l11.m1.5.5.1.1.1.cmml"><mi id="alg4.l11.m1.5.5.1.1.1.2" xref="alg4.l11.m1.5.5.1.1.1.2.cmml">𝐕</mi><mo id="alg4.l11.m1.5.5.1.1.1.3" xref="alg4.l11.m1.5.5.1.1.1.3.cmml">⊤</mo></msup><mo stretchy="false" id="alg4.l11.m1.5.5.1.1.5" xref="alg4.l11.m1.5.5.1.2.cmml">]</mo></mrow><mo stretchy="false" id="alg4.l11.m1.6.6.3" xref="alg4.l11.m1.6.6.3.cmml">←</mo><mrow id="alg4.l11.m1.6.6.2.1" xref="alg4.l11.m1.6.6.2.2.cmml"><mi id="alg4.l11.m1.3.3" xref="alg4.l11.m1.3.3.cmml">SVD</mi><mo id="alg4.l11.m1.6.6.2.1a" xref="alg4.l11.m1.6.6.2.2.cmml">⁡</mo><mrow id="alg4.l11.m1.6.6.2.1.1" xref="alg4.l11.m1.6.6.2.2.cmml"><mo stretchy="false" id="alg4.l11.m1.6.6.2.1.1.2" xref="alg4.l11.m1.6.6.2.2.cmml">(</mo><mrow id="alg4.l11.m1.6.6.2.1.1.1" xref="alg4.l11.m1.6.6.2.1.1.1.cmml"><msub id="alg4.l11.m1.6.6.2.1.1.1.2" xref="alg4.l11.m1.6.6.2.1.1.1.2.cmml"><mi id="alg4.l11.m1.6.6.2.1.1.1.2.2" xref="alg4.l11.m1.6.6.2.1.1.1.2.2.cmml">𝐃</mi><mtext id="alg4.l11.m1.6.6.2.1.1.1.2.3" xref="alg4.l11.m1.6.6.2.1.1.1.2.3a.cmml">row</mtext></msub><mo id="alg4.l11.m1.6.6.2.1.1.1.1" xref="alg4.l11.m1.6.6.2.1.1.1.1.cmml" lspace="0px" rspace="0px"></mo><msub id="alg4.l11.m1.6.6.2.1.1.1.3" xref="alg4.l11.m1.6.6.2.1.1.1.3.cmml"><mi id="alg4.l11.m1.6.6.2.1.1.1.3.2" xref="alg4.l11.m1.6.6.2.1.1.1.3.2.cmml">𝐀𝐃</mi><mtext id="alg4.l11.m1.6.6.2.1.1.1.3.3" xref="alg4.l11.m1.6.6.2.1.1.1.3.3a.cmml">col</mtext></msub></mrow><mo id="alg4.l11.m1.6.6.2.1.1.3" xref="alg4.l11.m1.6.6.2.2.cmml">,</mo><mi id="alg4.l11.m1.4.4" xref="alg4.l11.m1.4.4.cmml">r</mi><mo stretchy="false" id="alg4.l11.m1.6.6.2.1.1.4" xref="alg4.l11.m1.6.6.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l11.m1.6b"><apply id="alg4.l11.m1.6.6.cmml" xref="alg4.l11.m1.6.6"><ci id="alg4.l11.m1.6.6.3.cmml" xref="alg4.l11.m1.6.6.3">←</ci><list id="alg4.l11.m1.5.5.1.2.cmml" xref="alg4.l11.m1.5.5.1.1"><ci id="alg4.l11.m1.1.1.cmml" xref="alg4.l11.m1.1.1">𝐔</ci><ci id="alg4.l11.m1.2.2.cmml" xref="alg4.l11.m1.2.2">𝚺</ci><apply id="alg4.l11.m1.5.5.1.1.1.cmml" xref="alg4.l11.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg4.l11.m1.5.5.1.1.1.1.cmml" xref="alg4.l11.m1.5.5.1.1.1">superscript</csymbol><ci id="alg4.l11.m1.5.5.1.1.1.2.cmml" xref="alg4.l11.m1.5.5.1.1.1.2">𝐕</ci><csymbol cd="latexml" id="alg4.l11.m1.5.5.1.1.1.3.cmml" xref="alg4.l11.m1.5.5.1.1.1.3">top</csymbol></apply></list><apply id="alg4.l11.m1.6.6.2.2.cmml" xref="alg4.l11.m1.6.6.2.1"><ci id="alg4.l11.m1.3.3.cmml" xref="alg4.l11.m1.3.3">SVD</ci><apply id="alg4.l11.m1.6.6.2.1.1.1.cmml" xref="alg4.l11.m1.6.6.2.1.1.1"><times id="alg4.l11.m1.6.6.2.1.1.1.1.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.1"></times><apply id="alg4.l11.m1.6.6.2.1.1.1.2.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.2"><csymbol cd="ambiguous" id="alg4.l11.m1.6.6.2.1.1.1.2.1.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.2">subscript</csymbol><ci id="alg4.l11.m1.6.6.2.1.1.1.2.2.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.2.2">𝐃</ci><ci id="alg4.l11.m1.6.6.2.1.1.1.2.3a.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.2.3"><mtext mathsize="70%" id="alg4.l11.m1.6.6.2.1.1.1.2.3.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.2.3">row</mtext></ci></apply><apply id="alg4.l11.m1.6.6.2.1.1.1.3.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.3"><csymbol cd="ambiguous" id="alg4.l11.m1.6.6.2.1.1.1.3.1.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.3">subscript</csymbol><ci id="alg4.l11.m1.6.6.2.1.1.1.3.2.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.3.2">𝐀𝐃</ci><ci id="alg4.l11.m1.6.6.2.1.1.1.3.3a.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.3.3"><mtext mathsize="70%" id="alg4.l11.m1.6.6.2.1.1.1.3.3.cmml" xref="alg4.l11.m1.6.6.2.1.1.1.3.3">col</mtext></ci></apply></apply><ci id="alg4.l11.m1.4.4.cmml" xref="alg4.l11.m1.4.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l11.m1.6c">[\mathbf{U},\mathbf{\Sigma},\mathbf{V}^{\top}]\leftarrow\operatorname{SVD}(\mathbf{D}_{\text{row}}\mathbf{A}\mathbf{D}_{\text{col}},r)</annotation><annotation encoding="application/x-llamapun" id="alg4.l11.m1.6d">[ bold_U , bold_Σ , bold_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] ← roman_SVD ( bold_D start_POSTSUBSCRIPT row end_POSTSUBSCRIPT bold_AD start_POSTSUBSCRIPT col end_POSTSUBSCRIPT , italic_r )</annotation></semantics></math>

</span>
<span id="alg4.l12" class="ltx_listingline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg4.l12.m1.1" class="ltx_Math" alttext="\mathbf{L}_{1}\leftarrow\mathbf{D}_{\text{row}}^{-1}\mathbf{U}\sqrt{\mathbf{\Sigma}}" display="inline"><semantics id="alg4.l12.m1.1a"><mrow id="alg4.l12.m1.1.1" xref="alg4.l12.m1.1.1.cmml"><msub id="alg4.l12.m1.1.1.2" xref="alg4.l12.m1.1.1.2.cmml"><mi id="alg4.l12.m1.1.1.2.2" xref="alg4.l12.m1.1.1.2.2.cmml">𝐋</mi><mn id="alg4.l12.m1.1.1.2.3" xref="alg4.l12.m1.1.1.2.3.cmml">1</mn></msub><mo stretchy="false" id="alg4.l12.m1.1.1.1" xref="alg4.l12.m1.1.1.1.cmml">←</mo><mrow id="alg4.l12.m1.1.1.3" xref="alg4.l12.m1.1.1.3.cmml"><msubsup id="alg4.l12.m1.1.1.3.2" xref="alg4.l12.m1.1.1.3.2.cmml"><mi id="alg4.l12.m1.1.1.3.2.2.2" xref="alg4.l12.m1.1.1.3.2.2.2.cmml">𝐃</mi><mtext id="alg4.l12.m1.1.1.3.2.2.3" xref="alg4.l12.m1.1.1.3.2.2.3a.cmml">row</mtext><mrow id="alg4.l12.m1.1.1.3.2.3" xref="alg4.l12.m1.1.1.3.2.3.cmml"><mo id="alg4.l12.m1.1.1.3.2.3a" xref="alg4.l12.m1.1.1.3.2.3.cmml">−</mo><mn id="alg4.l12.m1.1.1.3.2.3.2" xref="alg4.l12.m1.1.1.3.2.3.2.cmml">1</mn></mrow></msubsup><mo id="alg4.l12.m1.1.1.3.1" xref="alg4.l12.m1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><mi id="alg4.l12.m1.1.1.3.3" xref="alg4.l12.m1.1.1.3.3.cmml">𝐔</mi><mo id="alg4.l12.m1.1.1.3.1a" xref="alg4.l12.m1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msqrt id="alg4.l12.m1.1.1.3.4" xref="alg4.l12.m1.1.1.3.4.cmml"><mi id="alg4.l12.m1.1.1.3.4.2" xref="alg4.l12.m1.1.1.3.4.2.cmml">𝚺</mi></msqrt></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.m1.1b"><apply id="alg4.l12.m1.1.1.cmml" xref="alg4.l12.m1.1.1"><ci id="alg4.l12.m1.1.1.1.cmml" xref="alg4.l12.m1.1.1.1">←</ci><apply id="alg4.l12.m1.1.1.2.cmml" xref="alg4.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.2.1.cmml" xref="alg4.l12.m1.1.1.2">subscript</csymbol><ci id="alg4.l12.m1.1.1.2.2.cmml" xref="alg4.l12.m1.1.1.2.2">𝐋</ci><cn type="integer" id="alg4.l12.m1.1.1.2.3.cmml" xref="alg4.l12.m1.1.1.2.3">1</cn></apply><apply id="alg4.l12.m1.1.1.3.cmml" xref="alg4.l12.m1.1.1.3"><times id="alg4.l12.m1.1.1.3.1.cmml" xref="alg4.l12.m1.1.1.3.1"></times><apply id="alg4.l12.m1.1.1.3.2.cmml" xref="alg4.l12.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.3.2.1.cmml" xref="alg4.l12.m1.1.1.3.2">superscript</csymbol><apply id="alg4.l12.m1.1.1.3.2.2.cmml" xref="alg4.l12.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.3.2.2.1.cmml" xref="alg4.l12.m1.1.1.3.2">subscript</csymbol><ci id="alg4.l12.m1.1.1.3.2.2.2.cmml" xref="alg4.l12.m1.1.1.3.2.2.2">𝐃</ci><ci id="alg4.l12.m1.1.1.3.2.2.3a.cmml" xref="alg4.l12.m1.1.1.3.2.2.3"><mtext mathsize="70%" id="alg4.l12.m1.1.1.3.2.2.3.cmml" xref="alg4.l12.m1.1.1.3.2.2.3">row</mtext></ci></apply><apply id="alg4.l12.m1.1.1.3.2.3.cmml" xref="alg4.l12.m1.1.1.3.2.3"><minus id="alg4.l12.m1.1.1.3.2.3.1.cmml" xref="alg4.l12.m1.1.1.3.2.3"></minus><cn type="integer" id="alg4.l12.m1.1.1.3.2.3.2.cmml" xref="alg4.l12.m1.1.1.3.2.3.2">1</cn></apply></apply><ci id="alg4.l12.m1.1.1.3.3.cmml" xref="alg4.l12.m1.1.1.3.3">𝐔</ci><apply id="alg4.l12.m1.1.1.3.4.cmml" xref="alg4.l12.m1.1.1.3.4"><root id="alg4.l12.m1.1.1.3.4a.cmml" xref="alg4.l12.m1.1.1.3.4"></root><ci id="alg4.l12.m1.1.1.3.4.2.cmml" xref="alg4.l12.m1.1.1.3.4.2">𝚺</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m1.1c">\mathbf{L}_{1}\leftarrow\mathbf{D}_{\text{row}}^{-1}\mathbf{U}\sqrt{\mathbf{\Sigma}}</annotation><annotation encoding="application/x-llamapun" id="alg4.l12.m1.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ← bold_D start_POSTSUBSCRIPT row end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_U square-root start_ARG bold_Σ end_ARG</annotation></semantics></math>, <math id="alg4.l12.m2.1" class="ltx_Math" alttext="\,\,\mathbf{L}_{2}\leftarrow\sqrt{\mathbf{\Sigma}}\mathbf{V}^{\top}\mathbf{D}_{\text{col}}^{-1}" display="inline"><semantics id="alg4.l12.m2.1a"><mrow id="alg4.l12.m2.1.1" xref="alg4.l12.m2.1.1.cmml"><msub id="alg4.l12.m2.1.1.2" xref="alg4.l12.m2.1.1.2.cmml"><mi id="alg4.l12.m2.1.1.2.2" xref="alg4.l12.m2.1.1.2.2.cmml">𝐋</mi><mn id="alg4.l12.m2.1.1.2.3" xref="alg4.l12.m2.1.1.2.3.cmml">2</mn></msub><mo stretchy="false" id="alg4.l12.m2.1.1.1" xref="alg4.l12.m2.1.1.1.cmml">←</mo><mrow id="alg4.l12.m2.1.1.3" xref="alg4.l12.m2.1.1.3.cmml"><msqrt id="alg4.l12.m2.1.1.3.2" xref="alg4.l12.m2.1.1.3.2.cmml"><mi id="alg4.l12.m2.1.1.3.2.2" xref="alg4.l12.m2.1.1.3.2.2.cmml">𝚺</mi></msqrt><mo id="alg4.l12.m2.1.1.3.1" xref="alg4.l12.m2.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msup id="alg4.l12.m2.1.1.3.3" xref="alg4.l12.m2.1.1.3.3.cmml"><mi id="alg4.l12.m2.1.1.3.3.2" xref="alg4.l12.m2.1.1.3.3.2.cmml">𝐕</mi><mo id="alg4.l12.m2.1.1.3.3.3" xref="alg4.l12.m2.1.1.3.3.3.cmml">⊤</mo></msup><mo id="alg4.l12.m2.1.1.3.1a" xref="alg4.l12.m2.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msubsup id="alg4.l12.m2.1.1.3.4" xref="alg4.l12.m2.1.1.3.4.cmml"><mi id="alg4.l12.m2.1.1.3.4.2.2" xref="alg4.l12.m2.1.1.3.4.2.2.cmml">𝐃</mi><mtext id="alg4.l12.m2.1.1.3.4.2.3" xref="alg4.l12.m2.1.1.3.4.2.3a.cmml">col</mtext><mrow id="alg4.l12.m2.1.1.3.4.3" xref="alg4.l12.m2.1.1.3.4.3.cmml"><mo id="alg4.l12.m2.1.1.3.4.3a" xref="alg4.l12.m2.1.1.3.4.3.cmml">−</mo><mn id="alg4.l12.m2.1.1.3.4.3.2" xref="alg4.l12.m2.1.1.3.4.3.2.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.m2.1b"><apply id="alg4.l12.m2.1.1.cmml" xref="alg4.l12.m2.1.1"><ci id="alg4.l12.m2.1.1.1.cmml" xref="alg4.l12.m2.1.1.1">←</ci><apply id="alg4.l12.m2.1.1.2.cmml" xref="alg4.l12.m2.1.1.2"><csymbol cd="ambiguous" id="alg4.l12.m2.1.1.2.1.cmml" xref="alg4.l12.m2.1.1.2">subscript</csymbol><ci id="alg4.l12.m2.1.1.2.2.cmml" xref="alg4.l12.m2.1.1.2.2">𝐋</ci><cn type="integer" id="alg4.l12.m2.1.1.2.3.cmml" xref="alg4.l12.m2.1.1.2.3">2</cn></apply><apply id="alg4.l12.m2.1.1.3.cmml" xref="alg4.l12.m2.1.1.3"><times id="alg4.l12.m2.1.1.3.1.cmml" xref="alg4.l12.m2.1.1.3.1"></times><apply id="alg4.l12.m2.1.1.3.2.cmml" xref="alg4.l12.m2.1.1.3.2"><root id="alg4.l12.m2.1.1.3.2a.cmml" xref="alg4.l12.m2.1.1.3.2"></root><ci id="alg4.l12.m2.1.1.3.2.2.cmml" xref="alg4.l12.m2.1.1.3.2.2">𝚺</ci></apply><apply id="alg4.l12.m2.1.1.3.3.cmml" xref="alg4.l12.m2.1.1.3.3"><csymbol cd="ambiguous" id="alg4.l12.m2.1.1.3.3.1.cmml" xref="alg4.l12.m2.1.1.3.3">superscript</csymbol><ci id="alg4.l12.m2.1.1.3.3.2.cmml" xref="alg4.l12.m2.1.1.3.3.2">𝐕</ci><csymbol cd="latexml" id="alg4.l12.m2.1.1.3.3.3.cmml" xref="alg4.l12.m2.1.1.3.3.3">top</csymbol></apply><apply id="alg4.l12.m2.1.1.3.4.cmml" xref="alg4.l12.m2.1.1.3.4"><csymbol cd="ambiguous" id="alg4.l12.m2.1.1.3.4.1.cmml" xref="alg4.l12.m2.1.1.3.4">superscript</csymbol><apply id="alg4.l12.m2.1.1.3.4.2.cmml" xref="alg4.l12.m2.1.1.3.4"><csymbol cd="ambiguous" id="alg4.l12.m2.1.1.3.4.2.1.cmml" xref="alg4.l12.m2.1.1.3.4">subscript</csymbol><ci id="alg4.l12.m2.1.1.3.4.2.2.cmml" xref="alg4.l12.m2.1.1.3.4.2.2">𝐃</ci><ci id="alg4.l12.m2.1.1.3.4.2.3a.cmml" xref="alg4.l12.m2.1.1.3.4.2.3"><mtext mathsize="70%" id="alg4.l12.m2.1.1.3.4.2.3.cmml" xref="alg4.l12.m2.1.1.3.4.2.3">col</mtext></ci></apply><apply id="alg4.l12.m2.1.1.3.4.3.cmml" xref="alg4.l12.m2.1.1.3.4.3"><minus id="alg4.l12.m2.1.1.3.4.3.1.cmml" xref="alg4.l12.m2.1.1.3.4.3"></minus><cn type="integer" id="alg4.l12.m2.1.1.3.4.3.2.cmml" xref="alg4.l12.m2.1.1.3.4.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m2.1c">\,\,\mathbf{L}_{2}\leftarrow\sqrt{\mathbf{\Sigma}}\mathbf{V}^{\top}\mathbf{D}_{\text{col}}^{-1}</annotation><annotation encoding="application/x-llamapun" id="alg4.l12.m2.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ← square-root start_ARG bold_Σ end_ARG bold_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_D start_POSTSUBSCRIPT col end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>

</span>
<span id="alg4.l13" class="ltx_listingline"><math id="alg4.l13.m1.2" class="ltx_Math" alttext="\mathbf{L}_{1},\mathbf{L}_{2}" display="inline"><semantics id="alg4.l13.m1.2a"><mrow id="alg4.l13.m1.2.2.2" xref="alg4.l13.m1.2.2.3.cmml"><msub id="alg4.l13.m1.1.1.1.1" xref="alg4.l13.m1.1.1.1.1.cmml"><mi id="alg4.l13.m1.1.1.1.1.2" xref="alg4.l13.m1.1.1.1.1.2.cmml">𝐋</mi><mn id="alg4.l13.m1.1.1.1.1.3" xref="alg4.l13.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg4.l13.m1.2.2.2.3" xref="alg4.l13.m1.2.2.3.cmml">,</mo><msub id="alg4.l13.m1.2.2.2.2" xref="alg4.l13.m1.2.2.2.2.cmml"><mi id="alg4.l13.m1.2.2.2.2.2" xref="alg4.l13.m1.2.2.2.2.2.cmml">𝐋</mi><mn id="alg4.l13.m1.2.2.2.2.3" xref="alg4.l13.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg4.l13.m1.2b"><list id="alg4.l13.m1.2.2.3.cmml" xref="alg4.l13.m1.2.2.2"><apply id="alg4.l13.m1.1.1.1.1.cmml" xref="alg4.l13.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l13.m1.1.1.1.1.1.cmml" xref="alg4.l13.m1.1.1.1.1">subscript</csymbol><ci id="alg4.l13.m1.1.1.1.1.2.cmml" xref="alg4.l13.m1.1.1.1.1.2">𝐋</ci><cn type="integer" id="alg4.l13.m1.1.1.1.1.3.cmml" xref="alg4.l13.m1.1.1.1.1.3">1</cn></apply><apply id="alg4.l13.m1.2.2.2.2.cmml" xref="alg4.l13.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l13.m1.2.2.2.2.1.cmml" xref="alg4.l13.m1.2.2.2.2">subscript</csymbol><ci id="alg4.l13.m1.2.2.2.2.2.cmml" xref="alg4.l13.m1.2.2.2.2.2">𝐋</ci><cn type="integer" id="alg4.l13.m1.2.2.2.2.3.cmml" xref="alg4.l13.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg4.l13.m1.2c">\mathbf{L}_{1},\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="alg4.l13.m1.2d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>

</span>
</span>
</span></span></div>
</div>
</figure>
<section id="S3.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Dynamic quantization configurations.</h4>

<div id="S3.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.1">LLM 양자화에 대한 이전 작업은 일반적으로 사용자의 다양한 리소스 제약에 적응할 수 없고 일부 행렬이 다른 행렬보다 양자화하기 어려울 수 있다는 점을 감안할 때 차선책일 수 있는 각 행렬에 동일한 양자화 전략을 적용하는 데 중점을 두었다. 사용자 정의 목표 비트율이 주어진 각 행렬에 서로 다른 구성을 할당할 수 있는 정수 선형 프로그래밍 <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="#bib.bib58" title="">2021</a>; Tang et al., <a class="ltx_ref" href="#bib.bib47" title="">2022</a>; Kundu et al., <a class="ltx_ref" href="#bib.bib23" title="">2022</a>)</cite> 기반의 혼합 정밀도 양자화 전략을 탐색한다.</p>
</div>
<div id="S3.SS2.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.2"><math alttext="c=(b_{0},b_{1},b_{2},B_{0},B_{1})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.1.m1.5"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.5a"><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.5.5" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.7" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.7.cmml">c</mi><mo id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.6" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.6.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.6.cmml"><mo id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.6" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.6.cmml">(</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml">b</mi><mn id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.7" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.6.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2.cmml">b</mi><mn id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.8" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.6.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.2.cmml">b</mi><mn id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.cmml">2</mn></msub><mo id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.9" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.6.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.2.cmml">B</mi><mn id="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.3.cmml">0</mn></msub><mo id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.10" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.6.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.2.cmml">B</mi><mn id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.11" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.5b"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5"><eq id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.6.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.6"></eq><ci id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.7.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.7">𝑐</ci><vector id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.6.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2">𝑏</ci><cn id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3">0</cn></apply><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2">𝑏</ci><cn id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3">1</cn></apply><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.2">𝑏</ci><cn id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3">2</cn></apply><apply id="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.2">𝐵</ci><cn id="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.1.m1.4.4.4.4.4.3">0</cn></apply><apply id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.2">𝐵</ci><cn id="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.1.m1.5.5.5.5.5.3">1</cn></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.5c">c=(b_{0},b_{1},b_{2},B_{0},B_{1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.1.m1.5d">italic_c = ( italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math>를 구성 파라미터로 하고, 나아가 <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.2.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.2.m2.1d">caligraphic_C</annotation></semantics></math>를 사용자에 의해 특정되는 가능한 구성의 집합으로 한다(본 작업에서 고려하는 설정에 대해서는 표<a class="ltx_ref" href="#S3.T1" title="Table 1 ‣ Dynamic quantization configurations. ‣ 3.2 Mixed-Configuration Quantization via an Integer Linear Program ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">1</span></a> 참조).</p>
</div>
<figure id="S3.T1" class="ltx_table ltx_align_floatright">
<table id="S3.T1.10" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody><tr id="S3.T1.10.11" class="ltx_tr">
<td id="S3.T1.10.11.1" class="ltx_td ltx_border_tt"></td>
<td id="S3.T1.10.11.2" class="ltx_td ltx_align_left ltx_border_tt">Configuration grid</td>
</tr>
<tr id="S3.T1.2.2" class="ltx_tr">
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="b_{0}" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><msub id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.m1.1.1.2.cmml">b</mi><mn id="S3.T1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.m1.1.1.2">𝑏</ci><cn type="integer" id="S3.T1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">b_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_left ltx_border_t"><math id="S3.T1.2.2.2.m1.3" class="ltx_Math" alttext="\{2,3,4\}" display="inline"><semantics id="S3.T1.2.2.2.m1.3a"><mrow id="S3.T1.2.2.2.m1.3.4.2" xref="S3.T1.2.2.2.m1.3.4.1.cmml"><mo stretchy="false" id="S3.T1.2.2.2.m1.3.4.2.1" xref="S3.T1.2.2.2.m1.3.4.1.cmml">{</mo><mn id="S3.T1.2.2.2.m1.1.1" xref="S3.T1.2.2.2.m1.1.1.cmml">2</mn><mo id="S3.T1.2.2.2.m1.3.4.2.2" xref="S3.T1.2.2.2.m1.3.4.1.cmml">,</mo><mn id="S3.T1.2.2.2.m1.2.2" xref="S3.T1.2.2.2.m1.2.2.cmml">3</mn><mo id="S3.T1.2.2.2.m1.3.4.2.3" xref="S3.T1.2.2.2.m1.3.4.1.cmml">,</mo><mn id="S3.T1.2.2.2.m1.3.3" xref="S3.T1.2.2.2.m1.3.3.cmml">4</mn><mo stretchy="false" id="S3.T1.2.2.2.m1.3.4.2.4" xref="S3.T1.2.2.2.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m1.3b"><set id="S3.T1.2.2.2.m1.3.4.1.cmml" xref="S3.T1.2.2.2.m1.3.4.2"><cn type="integer" id="S3.T1.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1">2</cn><cn type="integer" id="S3.T1.2.2.2.m1.2.2.cmml" xref="S3.T1.2.2.2.m1.2.2">3</cn><cn type="integer" id="S3.T1.2.2.2.m1.3.3.cmml" xref="S3.T1.2.2.2.m1.3.3">4</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m1.3c">\{2,3,4\}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.2.m1.3d">{ 2 , 3 , 4 }</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.4.4" class="ltx_tr">
<td id="S3.T1.3.3.1" class="ltx_td ltx_align_center"><math id="S3.T1.3.3.1.m1.1" class="ltx_Math" alttext="b_{1}" display="inline"><semantics id="S3.T1.3.3.1.m1.1a"><msub id="S3.T1.3.3.1.m1.1.1" xref="S3.T1.3.3.1.m1.1.1.cmml"><mi id="S3.T1.3.3.1.m1.1.1.2" xref="S3.T1.3.3.1.m1.1.1.2.cmml">b</mi><mn id="S3.T1.3.3.1.m1.1.1.3" xref="S3.T1.3.3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.m1.1b"><apply id="S3.T1.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.3.1.m1.1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.3.3.1.m1.1.1.2.cmml" xref="S3.T1.3.3.1.m1.1.1.2">𝑏</ci><cn type="integer" id="S3.T1.3.3.1.m1.1.1.3.cmml" xref="S3.T1.3.3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.m1.1c">b_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.1.m1.1d">italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td id="S3.T1.4.4.2" class="ltx_td ltx_align_left"><math id="S3.T1.4.4.2.m1.3" class="ltx_Math" alttext="\{2,3,4\}" display="inline"><semantics id="S3.T1.4.4.2.m1.3a"><mrow id="S3.T1.4.4.2.m1.3.4.2" xref="S3.T1.4.4.2.m1.3.4.1.cmml"><mo stretchy="false" id="S3.T1.4.4.2.m1.3.4.2.1" xref="S3.T1.4.4.2.m1.3.4.1.cmml">{</mo><mn id="S3.T1.4.4.2.m1.1.1" xref="S3.T1.4.4.2.m1.1.1.cmml">2</mn><mo id="S3.T1.4.4.2.m1.3.4.2.2" xref="S3.T1.4.4.2.m1.3.4.1.cmml">,</mo><mn id="S3.T1.4.4.2.m1.2.2" xref="S3.T1.4.4.2.m1.2.2.cmml">3</mn><mo id="S3.T1.4.4.2.m1.3.4.2.3" xref="S3.T1.4.4.2.m1.3.4.1.cmml">,</mo><mn id="S3.T1.4.4.2.m1.3.3" xref="S3.T1.4.4.2.m1.3.3.cmml">4</mn><mo stretchy="false" id="S3.T1.4.4.2.m1.3.4.2.4" xref="S3.T1.4.4.2.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.2.m1.3b"><set id="S3.T1.4.4.2.m1.3.4.1.cmml" xref="S3.T1.4.4.2.m1.3.4.2"><cn type="integer" id="S3.T1.4.4.2.m1.1.1.cmml" xref="S3.T1.4.4.2.m1.1.1">2</cn><cn type="integer" id="S3.T1.4.4.2.m1.2.2.cmml" xref="S3.T1.4.4.2.m1.2.2">3</cn><cn type="integer" id="S3.T1.4.4.2.m1.3.3.cmml" xref="S3.T1.4.4.2.m1.3.3">4</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.2.m1.3c">\{2,3,4\}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.2.m1.3d">{ 2 , 3 , 4 }</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.6.6" class="ltx_tr">
<td id="S3.T1.5.5.1" class="ltx_td ltx_align_center"><math id="S3.T1.5.5.1.m1.1" class="ltx_Math" alttext="b_{2}" display="inline"><semantics id="S3.T1.5.5.1.m1.1a"><msub id="S3.T1.5.5.1.m1.1.1" xref="S3.T1.5.5.1.m1.1.1.cmml"><mi id="S3.T1.5.5.1.m1.1.1.2" xref="S3.T1.5.5.1.m1.1.1.2.cmml">b</mi><mn id="S3.T1.5.5.1.m1.1.1.3" xref="S3.T1.5.5.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b"><apply id="S3.T1.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.5.1.m1.1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1">subscript</csymbol><ci id="S3.T1.5.5.1.m1.1.1.2.cmml" xref="S3.T1.5.5.1.m1.1.1.2">𝑏</ci><cn type="integer" id="S3.T1.5.5.1.m1.1.1.3.cmml" xref="S3.T1.5.5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">b_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.1.m1.1d">italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td id="S3.T1.6.6.2" class="ltx_td ltx_align_left"><math id="S3.T1.6.6.2.m1.3" class="ltx_Math" alttext="\{\texttt{bf16},\texttt{fp16},\texttt{fp32}\}" display="inline"><semantics id="S3.T1.6.6.2.m1.3a"><mrow id="S3.T1.6.6.2.m1.3.4.2" xref="S3.T1.6.6.2.m1.3.4.1.cmml"><mo stretchy="false" id="S3.T1.6.6.2.m1.3.4.2.1" xref="S3.T1.6.6.2.m1.3.4.1.cmml">{</mo><mtext id="S3.T1.6.6.2.m1.1.1" xref="S3.T1.6.6.2.m1.1.1a.cmml">𝚋𝚏𝟷𝟼</mtext><mo id="S3.T1.6.6.2.m1.3.4.2.2" xref="S3.T1.6.6.2.m1.3.4.1.cmml">,</mo><mtext id="S3.T1.6.6.2.m1.2.2" xref="S3.T1.6.6.2.m1.2.2a.cmml">𝚏𝚙𝟷𝟼</mtext><mo id="S3.T1.6.6.2.m1.3.4.2.3" xref="S3.T1.6.6.2.m1.3.4.1.cmml">,</mo><mtext id="S3.T1.6.6.2.m1.3.3" xref="S3.T1.6.6.2.m1.3.3a.cmml">𝚏𝚙𝟹𝟸</mtext><mo stretchy="false" id="S3.T1.6.6.2.m1.3.4.2.4" xref="S3.T1.6.6.2.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.2.m1.3b"><set id="S3.T1.6.6.2.m1.3.4.1.cmml" xref="S3.T1.6.6.2.m1.3.4.2"><ci id="S3.T1.6.6.2.m1.1.1a.cmml" xref="S3.T1.6.6.2.m1.1.1"><mtext id="S3.T1.6.6.2.m1.1.1.cmml" xref="S3.T1.6.6.2.m1.1.1">𝚋𝚏𝟷𝟼</mtext></ci><ci id="S3.T1.6.6.2.m1.2.2a.cmml" xref="S3.T1.6.6.2.m1.2.2"><mtext id="S3.T1.6.6.2.m1.2.2.cmml" xref="S3.T1.6.6.2.m1.2.2">𝚏𝚙𝟷𝟼</mtext></ci><ci id="S3.T1.6.6.2.m1.3.3a.cmml" xref="S3.T1.6.6.2.m1.3.3"><mtext id="S3.T1.6.6.2.m1.3.3.cmml" xref="S3.T1.6.6.2.m1.3.3">𝚏𝚙𝟹𝟸</mtext></ci></set></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.2.m1.3c">\{\texttt{bf16},\texttt{fp16},\texttt{fp32}\}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.2.m1.3d">{ bf16 , fp16 , fp32 }</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.8.8" class="ltx_tr">
<td id="S3.T1.7.7.1" class="ltx_td ltx_align_center"><math id="S3.T1.7.7.1.m1.1" class="ltx_Math" alttext="B_{0}" display="inline"><semantics id="S3.T1.7.7.1.m1.1a"><msub id="S3.T1.7.7.1.m1.1.1" xref="S3.T1.7.7.1.m1.1.1.cmml"><mi id="S3.T1.7.7.1.m1.1.1.2" xref="S3.T1.7.7.1.m1.1.1.2.cmml">B</mi><mn id="S3.T1.7.7.1.m1.1.1.3" xref="S3.T1.7.7.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.1.m1.1b"><apply id="S3.T1.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.7.7.1.m1.1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1">subscript</csymbol><ci id="S3.T1.7.7.1.m1.1.1.2.cmml" xref="S3.T1.7.7.1.m1.1.1.2">𝐵</ci><cn type="integer" id="S3.T1.7.7.1.m1.1.1.3.cmml" xref="S3.T1.7.7.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.1.m1.1c">B_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.1.m1.1d">italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td id="S3.T1.8.8.2" class="ltx_td ltx_align_left"><math id="S3.T1.8.8.2.m1.3" class="ltx_Math" alttext="\{16,32,64\}" display="inline"><semantics id="S3.T1.8.8.2.m1.3a"><mrow id="S3.T1.8.8.2.m1.3.4.2" xref="S3.T1.8.8.2.m1.3.4.1.cmml"><mo stretchy="false" id="S3.T1.8.8.2.m1.3.4.2.1" xref="S3.T1.8.8.2.m1.3.4.1.cmml">{</mo><mn id="S3.T1.8.8.2.m1.1.1" xref="S3.T1.8.8.2.m1.1.1.cmml">16</mn><mo id="S3.T1.8.8.2.m1.3.4.2.2" xref="S3.T1.8.8.2.m1.3.4.1.cmml">,</mo><mn id="S3.T1.8.8.2.m1.2.2" xref="S3.T1.8.8.2.m1.2.2.cmml">32</mn><mo id="S3.T1.8.8.2.m1.3.4.2.3" xref="S3.T1.8.8.2.m1.3.4.1.cmml">,</mo><mn id="S3.T1.8.8.2.m1.3.3" xref="S3.T1.8.8.2.m1.3.3.cmml">64</mn><mo stretchy="false" id="S3.T1.8.8.2.m1.3.4.2.4" xref="S3.T1.8.8.2.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.2.m1.3b"><set id="S3.T1.8.8.2.m1.3.4.1.cmml" xref="S3.T1.8.8.2.m1.3.4.2"><cn type="integer" id="S3.T1.8.8.2.m1.1.1.cmml" xref="S3.T1.8.8.2.m1.1.1">16</cn><cn type="integer" id="S3.T1.8.8.2.m1.2.2.cmml" xref="S3.T1.8.8.2.m1.2.2">32</cn><cn type="integer" id="S3.T1.8.8.2.m1.3.3.cmml" xref="S3.T1.8.8.2.m1.3.3">64</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.2.m1.3c">\{16,32,64\}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.2.m1.3d">{ 16 , 32 , 64 }</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.10.10" class="ltx_tr">
<td id="S3.T1.9.9.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S3.T1.9.9.1.m1.1" class="ltx_Math" alttext="B_{1}" display="inline"><semantics id="S3.T1.9.9.1.m1.1a"><msub id="S3.T1.9.9.1.m1.1.1" xref="S3.T1.9.9.1.m1.1.1.cmml"><mi id="S3.T1.9.9.1.m1.1.1.2" xref="S3.T1.9.9.1.m1.1.1.2.cmml">B</mi><mn id="S3.T1.9.9.1.m1.1.1.3" xref="S3.T1.9.9.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.1.m1.1b"><apply id="S3.T1.9.9.1.m1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.9.1.m1.1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1">subscript</csymbol><ci id="S3.T1.9.9.1.m1.1.1.2.cmml" xref="S3.T1.9.9.1.m1.1.1.2">𝐵</ci><cn type="integer" id="S3.T1.9.9.1.m1.1.1.3.cmml" xref="S3.T1.9.9.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.1.m1.1c">B_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.1.m1.1d">italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td id="S3.T1.10.10.2" class="ltx_td ltx_align_left ltx_border_bb"><math id="S3.T1.10.10.2.m1.3" class="ltx_Math" alttext="\{16,64,256\}" display="inline"><semantics id="S3.T1.10.10.2.m1.3a"><mrow id="S3.T1.10.10.2.m1.3.4.2" xref="S3.T1.10.10.2.m1.3.4.1.cmml"><mo stretchy="false" id="S3.T1.10.10.2.m1.3.4.2.1" xref="S3.T1.10.10.2.m1.3.4.1.cmml">{</mo><mn id="S3.T1.10.10.2.m1.1.1" xref="S3.T1.10.10.2.m1.1.1.cmml">16</mn><mo id="S3.T1.10.10.2.m1.3.4.2.2" xref="S3.T1.10.10.2.m1.3.4.1.cmml">,</mo><mn id="S3.T1.10.10.2.m1.2.2" xref="S3.T1.10.10.2.m1.2.2.cmml">64</mn><mo id="S3.T1.10.10.2.m1.3.4.2.3" xref="S3.T1.10.10.2.m1.3.4.1.cmml">,</mo><mn id="S3.T1.10.10.2.m1.3.3" xref="S3.T1.10.10.2.m1.3.3.cmml">256</mn><mo stretchy="false" id="S3.T1.10.10.2.m1.3.4.2.4" xref="S3.T1.10.10.2.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.2.m1.3b"><set id="S3.T1.10.10.2.m1.3.4.1.cmml" xref="S3.T1.10.10.2.m1.3.4.2"><cn type="integer" id="S3.T1.10.10.2.m1.1.1.cmml" xref="S3.T1.10.10.2.m1.1.1">16</cn><cn type="integer" id="S3.T1.10.10.2.m1.2.2.cmml" xref="S3.T1.10.10.2.m1.2.2">64</cn><cn type="integer" id="S3.T1.10.10.2.m1.3.3.cmml" xref="S3.T1.10.10.2.m1.3.3">256</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.2.m1.3c">\{16,64,256\}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.2.m1.3d">{ 16 , 64 , 256 }</annotation></semantics></math></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 1: </span>Search space <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S3.T1.12.m1.1"><semantics id="S3.T1.12.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S3.T1.12.m1.1.1" xref="S3.T1.12.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.T1.12.m1.1c"><ci id="S3.T1.12.m1.1.1.cmml" xref="S3.T1.12.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.m1.1d">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.m1.1e">caligraphic_C</annotation></semantics></math> for the NF quantization configurations.</figcaption>
</figure>
<div id="S3.SS2.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS0.Px1.p3.3" class="ltx_p">Letting <math id="S3.SS2.SSS0.Px1.p3.1.m1.3" class="ltx_Math" alttext="\{\mathbf{W}^{(i)}\}_{i\in[N]}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.1.m1.3a"><msub id="S3.SS2.SSS0.Px1.p3.1.m1.3.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.2.cmml">{</mo><msup id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.2.cmml">𝐖</mi><mrow id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.3.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.2.cmml">∈</mo><mrow id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.2.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.1.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.1.cmml">N</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.2.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.1.m1.3b"><apply id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3">subscript</csymbol><set id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1"><apply id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.3.3.1.1.1.2">𝐖</ci><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.1">𝑖</ci></apply></set><apply id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1"><in id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.2"></in><ci id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.3">𝑖</ci><apply id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.2"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.2.2.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.1.m1.3c">\{\mathbf{W}^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.1.m1.3d">{ bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math> be the set of <math id="S3.SS2.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.2.m2.1a"><mi id="S3.SS2.SSS0.Px1.p3.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.2.m2.1b"><ci id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.2.m2.1d">italic_N</annotation></semantics></math> matrices in an LM, our goal is to find an assignment matrix <math id="S3.SS2.SSS0.Px1.p3.3.m3.3" class="ltx_Math" alttext="\mathbf{X}\in\{0,1\}^{N\times|\mathcal{C}|}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.3.m3.3a"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.3.4" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.2.cmml">𝐗</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.2.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.1.cmml">{</mo><mn id="S3.SS2.SSS0.Px1.p3.3.m3.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.cmml">0</mn><mo id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p3.3.m3.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.cmml">1</mn><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.2.cmml">×</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.2.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.1.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.3.m3.3b"><apply id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4"><in id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.1"></in><ci id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.2">𝐗</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3">superscript</csymbol><set id="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.4.3.2.2"><cn type="integer" id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2">0</cn><cn type="integer" id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3">1</cn></set><apply id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1"><times id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.2"></times><ci id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.3">𝑁</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.2"><abs id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.4.2.1"></abs><ci id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1">𝒞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.3.m3.3c">\mathbf{X}\in\{0,1\}^{N\times|\mathcal{C}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.3.m3.3d">bold_X ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_N × | caligraphic_C | end_POSTSUPERSCRIPT</annotation></semantics></math> that minimizes the Frobenius norm between the matrices before and after low-rank plus quantized decomposition, while respecting a target memory budget. One way to approach this optimization problem is through the following integer linear program,<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>Here we overload <math id="footnote6.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="footnote6.m1.1b"><mi id="footnote6.m1.1.1" xref="footnote6.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="footnote6.m1.1c"><ci id="footnote6.m1.1.1.cmml" xref="footnote6.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote6.m1.1d">c</annotation><annotation encoding="application/x-llamapun" id="footnote6.m1.1e">italic_c</annotation></semantics></math> to refer to both its tuple representation <math id="footnote6.m2.1" class="ltx_Math" alttext="c\in\mathcal{C}" display="inline"><semantics id="footnote6.m2.1b"><mrow id="footnote6.m2.1.1" xref="footnote6.m2.1.1.cmml"><mi id="footnote6.m2.1.1.2" xref="footnote6.m2.1.1.2.cmml">c</mi><mo id="footnote6.m2.1.1.1" xref="footnote6.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="footnote6.m2.1.1.3" xref="footnote6.m2.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="footnote6.m2.1c"><apply id="footnote6.m2.1.1.cmml" xref="footnote6.m2.1.1"><in id="footnote6.m2.1.1.1.cmml" xref="footnote6.m2.1.1.1"></in><ci id="footnote6.m2.1.1.2.cmml" xref="footnote6.m2.1.1.2">𝑐</ci><ci id="footnote6.m2.1.1.3.cmml" xref="footnote6.m2.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote6.m2.1d">c\in\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="footnote6.m2.1e">italic_c ∈ caligraphic_C</annotation></semantics></math> and its index representation <math id="footnote6.m3.2" class="ltx_Math" alttext="c\in[|\mathcal{C}|]." display="inline"><semantics id="footnote6.m3.2b"><mrow id="footnote6.m3.2.2.1" xref="footnote6.m3.2.2.1.1.cmml"><mrow id="footnote6.m3.2.2.1.1" xref="footnote6.m3.2.2.1.1.cmml"><mi id="footnote6.m3.2.2.1.1.3" xref="footnote6.m3.2.2.1.1.3.cmml">c</mi><mo id="footnote6.m3.2.2.1.1.2" xref="footnote6.m3.2.2.1.1.2.cmml">∈</mo><mrow id="footnote6.m3.2.2.1.1.1.1" xref="footnote6.m3.2.2.1.1.1.2.cmml"><mo stretchy="false" id="footnote6.m3.2.2.1.1.1.1.2" xref="footnote6.m3.2.2.1.1.1.2.1.cmml">[</mo><mrow id="footnote6.m3.2.2.1.1.1.1.1.2" xref="footnote6.m3.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="footnote6.m3.2.2.1.1.1.1.1.2.1" xref="footnote6.m3.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="footnote6.m3.1.1" xref="footnote6.m3.1.1.cmml">𝒞</mi><mo stretchy="false" id="footnote6.m3.2.2.1.1.1.1.1.2.2" xref="footnote6.m3.2.2.1.1.1.1.1.1.1.cmml">|</mo></mrow><mo stretchy="false" id="footnote6.m3.2.2.1.1.1.1.3" xref="footnote6.m3.2.2.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo lspace="0em" id="footnote6.m3.2.2.1.2" xref="footnote6.m3.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="footnote6.m3.2c"><apply id="footnote6.m3.2.2.1.1.cmml" xref="footnote6.m3.2.2.1"><in id="footnote6.m3.2.2.1.1.2.cmml" xref="footnote6.m3.2.2.1.1.2"></in><ci id="footnote6.m3.2.2.1.1.3.cmml" xref="footnote6.m3.2.2.1.1.3">𝑐</ci><apply id="footnote6.m3.2.2.1.1.1.2.cmml" xref="footnote6.m3.2.2.1.1.1.1"><csymbol cd="latexml" id="footnote6.m3.2.2.1.1.1.2.1.cmml" xref="footnote6.m3.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="footnote6.m3.2.2.1.1.1.1.1.1.cmml" xref="footnote6.m3.2.2.1.1.1.1.1.2"><abs id="footnote6.m3.2.2.1.1.1.1.1.1.1.cmml" xref="footnote6.m3.2.2.1.1.1.1.1.2.1"></abs><ci id="footnote6.m3.1.1.cmml" xref="footnote6.m3.1.1">𝒞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote6.m3.2d">c\in[|\mathcal{C}|].</annotation><annotation encoding="application/x-llamapun" id="footnote6.m3.2e">italic_c ∈ [ | caligraphic_C | ] .</annotation></semantics></math></span></span></span></p>
<table id="S3.Ex2" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S3.Ex2X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\min_{\mathbf{X}\in\{0,1\}^{N\times|\mathcal{C}|}}" display="inline"><semantics id="S3.Ex2X.2.1.1.m1.3a"><munder id="S3.Ex2X.2.1.1.m1.3.4" xref="S3.Ex2X.2.1.1.m1.3.4.cmml"><mi id="S3.Ex2X.2.1.1.m1.3.4.2" xref="S3.Ex2X.2.1.1.m1.3.4.2.cmml">min</mi><mrow id="S3.Ex2X.2.1.1.m1.3.3.3" xref="S3.Ex2X.2.1.1.m1.3.3.3.cmml"><mi id="S3.Ex2X.2.1.1.m1.3.3.3.5" xref="S3.Ex2X.2.1.1.m1.3.3.3.5.cmml">𝐗</mi><mo id="S3.Ex2X.2.1.1.m1.3.3.3.4" xref="S3.Ex2X.2.1.1.m1.3.3.3.4.cmml">∈</mo><msup id="S3.Ex2X.2.1.1.m1.3.3.3.6" xref="S3.Ex2X.2.1.1.m1.3.3.3.6.cmml"><mrow id="S3.Ex2X.2.1.1.m1.3.3.3.6.2.2" xref="S3.Ex2X.2.1.1.m1.3.3.3.6.2.1.cmml"><mo stretchy="false" id="S3.Ex2X.2.1.1.m1.3.3.3.6.2.2.1" xref="S3.Ex2X.2.1.1.m1.3.3.3.6.2.1.cmml">{</mo><mn id="S3.Ex2X.2.1.1.m1.2.2.2.2" xref="S3.Ex2X.2.1.1.m1.2.2.2.2.cmml">0</mn><mo id="S3.Ex2X.2.1.1.m1.3.3.3.6.2.2.2" xref="S3.Ex2X.2.1.1.m1.3.3.3.6.2.1.cmml">,</mo><mn id="S3.Ex2X.2.1.1.m1.3.3.3.3" xref="S3.Ex2X.2.1.1.m1.3.3.3.3.cmml">1</mn><mo stretchy="false" id="S3.Ex2X.2.1.1.m1.3.3.3.6.2.2.3" xref="S3.Ex2X.2.1.1.m1.3.3.3.6.2.1.cmml">}</mo></mrow><mrow id="S3.Ex2X.2.1.1.m1.1.1.1.1.1" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.3" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.3.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.2" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.2.cmml">×</mo><mrow id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.2" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.2.1" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.1" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.2.2" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.1.1.cmml">|</mo></mrow></mrow></msup></mrow></munder><annotation-xml encoding="MathML-Content" id="S3.Ex2X.2.1.1.m1.3b"><apply id="S3.Ex2X.2.1.1.m1.3.4.cmml" xref="S3.Ex2X.2.1.1.m1.3.4"><csymbol cd="ambiguous" id="S3.Ex2X.2.1.1.m1.3.4.1.cmml" xref="S3.Ex2X.2.1.1.m1.3.4">subscript</csymbol><min id="S3.Ex2X.2.1.1.m1.3.4.2.cmml" xref="S3.Ex2X.2.1.1.m1.3.4.2"></min><apply id="S3.Ex2X.2.1.1.m1.3.3.3.cmml" xref="S3.Ex2X.2.1.1.m1.3.3.3"><in id="S3.Ex2X.2.1.1.m1.3.3.3.4.cmml" xref="S3.Ex2X.2.1.1.m1.3.3.3.4"></in><ci id="S3.Ex2X.2.1.1.m1.3.3.3.5.cmml" xref="S3.Ex2X.2.1.1.m1.3.3.3.5">𝐗</ci><apply id="S3.Ex2X.2.1.1.m1.3.3.3.6.cmml" xref="S3.Ex2X.2.1.1.m1.3.3.3.6"><csymbol cd="ambiguous" id="S3.Ex2X.2.1.1.m1.3.3.3.6.1.cmml" xref="S3.Ex2X.2.1.1.m1.3.3.3.6">superscript</csymbol><set id="S3.Ex2X.2.1.1.m1.3.3.3.6.2.1.cmml" xref="S3.Ex2X.2.1.1.m1.3.3.3.6.2.2"><cn type="integer" id="S3.Ex2X.2.1.1.m1.2.2.2.2.cmml" xref="S3.Ex2X.2.1.1.m1.2.2.2.2">0</cn><cn type="integer" id="S3.Ex2X.2.1.1.m1.3.3.3.3.cmml" xref="S3.Ex2X.2.1.1.m1.3.3.3.3">1</cn></set><apply id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1"><times id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.3">𝑁</ci><apply id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.1.cmml" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.2"><abs id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.1.1.cmml" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.4.2.1"></abs><ci id="S3.Ex2X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2X.2.1.1.m1.1.1.1.1.1.1">𝒞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2X.2.1.1.m1.3c">\displaystyle\min_{\mathbf{X}\in\{0,1\}^{N\times|\mathcal{C}|}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2X.2.1.1.m1.3d">roman_min start_POSTSUBSCRIPT bold_X ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_N × | caligraphic_C | end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2X.4.1.1.m1.7" class="ltx_Math" alttext="\displaystyle\sum_{i\in[N]}\sum_{c\in\mathcal{C}}\operatorname{error}(\mathbf{A}^{(i)},c)\cdot\mathbf{X}[i,c]," display="inline"><semantics id="S3.Ex2X.4.1.1.m1.7a"><mrow id="S3.Ex2X.4.1.1.m1.7.7.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.cmml"><mrow id="S3.Ex2X.4.1.1.m1.7.7.1.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex2X.4.1.1.m1.7.7.1.1.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.2.cmml"><munder id="S3.Ex2X.4.1.1.m1.7.7.1.1.2a" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex2X.4.1.1.m1.7.7.1.1.2.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex2X.4.1.1.m1.1.1.1" xref="S3.Ex2X.4.1.1.m1.1.1.1.cmml"><mi id="S3.Ex2X.4.1.1.m1.1.1.1.3" xref="S3.Ex2X.4.1.1.m1.1.1.1.3.cmml">i</mi><mo id="S3.Ex2X.4.1.1.m1.1.1.1.2" xref="S3.Ex2X.4.1.1.m1.1.1.1.2.cmml">∈</mo><mrow id="S3.Ex2X.4.1.1.m1.1.1.1.4.2" xref="S3.Ex2X.4.1.1.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.Ex2X.4.1.1.m1.1.1.1.4.2.1" xref="S3.Ex2X.4.1.1.m1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.Ex2X.4.1.1.m1.1.1.1.1" xref="S3.Ex2X.4.1.1.m1.1.1.1.1.cmml">N</mi><mo stretchy="false" id="S3.Ex2X.4.1.1.m1.1.1.1.4.2.2" xref="S3.Ex2X.4.1.1.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder></mstyle><mrow id="S3.Ex2X.4.1.1.m1.7.7.1.1.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.cmml"><munder id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2a" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.cmml"><mi id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.2.cmml">c</mi><mo id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.3" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.3.cmml">𝒞</mi></mrow></munder></mstyle><mrow id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.cmml"><mrow id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.cmml"><mrow id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2X.4.1.1.m1.3.3" xref="S3.Ex2X.4.1.1.m1.3.3.cmml">error</mi><mo id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1a" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">(</mo><msup id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">𝐀</mi><mrow id="S3.Ex2X.4.1.1.m1.2.2.1.3" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2X.4.1.1.m1.2.2.1.3.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex2X.4.1.1.m1.2.2.1.1" xref="S3.Ex2X.4.1.1.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.Ex2X.4.1.1.m1.2.2.1.3.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex2X.4.1.1.m1.4.4" xref="S3.Ex2X.4.1.1.m1.4.4.cmml">c</mi><mo rspace="0.055em" stretchy="false" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.4" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.2.cmml">⋅</mo><mi id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.3" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.3.cmml">𝐗</mi></mrow><mo id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.2.1" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.1.cmml">[</mo><mi id="S3.Ex2X.4.1.1.m1.5.5" xref="S3.Ex2X.4.1.1.m1.5.5.cmml">i</mi><mo id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.2.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.1.cmml">,</mo><mi id="S3.Ex2X.4.1.1.m1.6.6" xref="S3.Ex2X.4.1.1.m1.6.6.cmml">c</mi><mo stretchy="false" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.2.3" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex2X.4.1.1.m1.7.7.1.2" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2X.4.1.1.m1.7b"><apply id="S3.Ex2X.4.1.1.m1.7.7.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1"><apply id="S3.Ex2X.4.1.1.m1.7.7.1.1.2.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2X.4.1.1.m1.7.7.1.1.2.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.2">subscript</csymbol><sum id="S3.Ex2X.4.1.1.m1.7.7.1.1.2.2.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.2.2"></sum><apply id="S3.Ex2X.4.1.1.m1.1.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.1.1.1"><in id="S3.Ex2X.4.1.1.m1.1.1.1.2.cmml" xref="S3.Ex2X.4.1.1.m1.1.1.1.2"></in><ci id="S3.Ex2X.4.1.1.m1.1.1.1.3.cmml" xref="S3.Ex2X.4.1.1.m1.1.1.1.3">𝑖</ci><apply id="S3.Ex2X.4.1.1.m1.1.1.1.4.1.cmml" xref="S3.Ex2X.4.1.1.m1.1.1.1.4.2"><csymbol cd="latexml" id="S3.Ex2X.4.1.1.m1.1.1.1.4.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.Ex2X.4.1.1.m1.1.1.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.1.1.1.1">𝑁</ci></apply></apply></apply><apply id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1"><apply id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2">subscript</csymbol><sum id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.2.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.2"></sum><apply id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3"><in id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.1"></in><ci id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.2.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.2">𝑐</ci><ci id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.3.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.2.3.3">𝒞</ci></apply></apply><apply id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1"><times id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.2.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.2"></times><apply id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1"><ci id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.2">⋅</ci><apply id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1"><ci id="S3.Ex2X.4.1.1.m1.3.3.cmml" xref="S3.Ex2X.4.1.1.m1.3.3">error</ci><apply id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.2">𝐀</ci><ci id="S3.Ex2X.4.1.1.m1.2.2.1.1.cmml" xref="S3.Ex2X.4.1.1.m1.2.2.1.1">𝑖</ci></apply><ci id="S3.Ex2X.4.1.1.m1.4.4.cmml" xref="S3.Ex2X.4.1.1.m1.4.4">𝑐</ci></apply><ci id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.3.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.1.3">𝐗</ci></apply><interval closure="closed" id="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.1.cmml" xref="S3.Ex2X.4.1.1.m1.7.7.1.1.1.1.3.2"><ci id="S3.Ex2X.4.1.1.m1.5.5.cmml" xref="S3.Ex2X.4.1.1.m1.5.5">𝑖</ci><ci id="S3.Ex2X.4.1.1.m1.6.6.cmml" xref="S3.Ex2X.4.1.1.m1.6.6">𝑐</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2X.4.1.1.m1.7c">\displaystyle\sum_{i\in[N]}\sum_{c\in\mathcal{C}}\operatorname{error}(\mathbf{A}^{(i)},c)\cdot\mathbf{X}[i,c],</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2X.4.1.1.m1.7d">∑ start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_c ∈ caligraphic_C end_POSTSUBSCRIPT roman_error ( bold_A start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_c ) ⋅ bold_X [ italic_i , italic_c ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span id="S3.Ex2Xa.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">subject to</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2Xa.4.1.1.m1.7" class="ltx_Math" alttext="\displaystyle\sum_{i\in[N]}\sum_{c\in\mathcal{C}}\operatorname{storage}(\mathbf{A}^{(i)},c)\cdot\mathbf{X}[i,c]\leq\text{budget}," display="inline"><semantics id="S3.Ex2Xa.4.1.1.m1.7a"><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.cmml"><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.cmml"><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2.cmml"><munder id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2a" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex2Xa.4.1.1.m1.1.1.1" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.cmml"><mi id="S3.Ex2Xa.4.1.1.m1.1.1.1.3" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.3.cmml">i</mi><mo id="S3.Ex2Xa.4.1.1.m1.1.1.1.2" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.2.cmml">∈</mo><mrow id="S3.Ex2Xa.4.1.1.m1.1.1.1.4.2" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.Ex2Xa.4.1.1.m1.1.1.1.4.2.1" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.Ex2Xa.4.1.1.m1.1.1.1.1" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.1.cmml">N</mi><mo stretchy="false" id="S3.Ex2Xa.4.1.1.m1.1.1.1.4.2.2" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder></mstyle><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.cmml"><munder id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2a" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.cmml"><mi id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.2.cmml">c</mi><mo id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.3" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.3.cmml">𝒞</mi></mrow></munder></mstyle><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.cmml"><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2Xa.4.1.1.m1.3.3" xref="S3.Ex2Xa.4.1.1.m1.3.3.cmml">storage</mi><mo id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1a" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.2.cmml">(</mo><msup id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐀</mi><mrow id="S3.Ex2Xa.4.1.1.m1.2.2.1.3" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2Xa.4.1.1.m1.2.2.1.3.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex2Xa.4.1.1.m1.2.2.1.1" xref="S3.Ex2Xa.4.1.1.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.Ex2Xa.4.1.1.m1.2.2.1.3.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex2Xa.4.1.1.m1.4.4" xref="S3.Ex2Xa.4.1.1.m1.4.4.cmml">c</mi><mo rspace="0.055em" stretchy="false" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.4" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">⋅</mo><mi id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.3" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.3.cmml">𝐗</mi></mrow><mo id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.2.1" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.1.cmml">[</mo><mi id="S3.Ex2Xa.4.1.1.m1.5.5" xref="S3.Ex2Xa.4.1.1.m1.5.5.cmml">i</mi><mo id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.2.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.Ex2Xa.4.1.1.m1.6.6" xref="S3.Ex2Xa.4.1.1.m1.6.6.cmml">c</mi><mo stretchy="false" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.2.3" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.2.cmml">≤</mo><mtext id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.3" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.3a.cmml">budget</mtext></mrow><mo id="S3.Ex2Xa.4.1.1.m1.7.7.1.2" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2Xa.4.1.1.m1.7b"><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1"><leq id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.2"></leq><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1"><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2">subscript</csymbol><sum id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.2.2"></sum><apply id="S3.Ex2Xa.4.1.1.m1.1.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.1.1.1"><in id="S3.Ex2Xa.4.1.1.m1.1.1.1.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.2"></in><ci id="S3.Ex2Xa.4.1.1.m1.1.1.1.3.cmml" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.3">𝑖</ci><apply id="S3.Ex2Xa.4.1.1.m1.1.1.1.4.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.4.2"><csymbol cd="latexml" id="S3.Ex2Xa.4.1.1.m1.1.1.1.4.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.Ex2Xa.4.1.1.m1.1.1.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.1.1.1.1">𝑁</ci></apply></apply></apply><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1"><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.2"></sum><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3"><in id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.1"></in><ci id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.2">𝑐</ci><ci id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.3.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.2.3.3">𝒞</ci></apply></apply><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1"><times id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.2"></times><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1"><ci id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.2">⋅</ci><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1"><ci id="S3.Ex2Xa.4.1.1.m1.3.3.cmml" xref="S3.Ex2Xa.4.1.1.m1.3.3">storage</ci><apply id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">𝐀</ci><ci id="S3.Ex2Xa.4.1.1.m1.2.2.1.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.2.2.1.1">𝑖</ci></apply><ci id="S3.Ex2Xa.4.1.1.m1.4.4.cmml" xref="S3.Ex2Xa.4.1.1.m1.4.4">𝑐</ci></apply><ci id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.1.3">𝐗</ci></apply><interval closure="closed" id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.1.1.1.3.2"><ci id="S3.Ex2Xa.4.1.1.m1.5.5.cmml" xref="S3.Ex2Xa.4.1.1.m1.5.5">𝑖</ci><ci id="S3.Ex2Xa.4.1.1.m1.6.6.cmml" xref="S3.Ex2Xa.4.1.1.m1.6.6">𝑐</ci></interval></apply></apply></apply><ci id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.3a.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.3"><mtext id="S3.Ex2Xa.4.1.1.m1.7.7.1.1.3.cmml" xref="S3.Ex2Xa.4.1.1.m1.7.7.1.1.3">budget</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2Xa.4.1.1.m1.7c">\displaystyle\sum_{i\in[N]}\sum_{c\in\mathcal{C}}\operatorname{storage}(\mathbf{A}^{(i)},c)\cdot\mathbf{X}[i,c]\leq\text{budget},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2Xa.4.1.1.m1.7d">∑ start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_c ∈ caligraphic_C end_POSTSUBSCRIPT roman_storage ( bold_A start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_c ) ⋅ bold_X [ italic_i , italic_c ] ≤ budget ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2Xb"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2Xb.3.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\sum_{c\in\mathcal{C}}\mathbf{X}[i,c]=1,\quad\forall i\in[N]." display="inline"><semantics id="S3.Ex2Xb.3.1.1.m1.4a"><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1"><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.3.cmml"><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.cmml"><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.cmml"><munder id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1a" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.cmml"><mo movablelimits="false" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.cmml"><mi id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.2.cmml">c</mi><mo id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.1" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.3" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.3.cmml">𝒞</mi></mrow></munder></mstyle><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.cmml"><mi id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.2.cmml">𝐗</mi><mo id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.1" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.1.cmml" lspace="0px" rspace="0px"></mo><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.2.1" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.1.cmml">[</mo><mi id="S3.Ex2Xb.3.1.1.m1.1.1" xref="S3.Ex2Xb.3.1.1.m1.1.1.cmml">i</mi><mo id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.2.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.1.cmml">,</mo><mi id="S3.Ex2Xb.3.1.1.m1.2.2" xref="S3.Ex2Xb.3.1.1.m1.2.2.cmml">c</mi><mo stretchy="false" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.2.3" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.1" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.1.cmml">=</mo><mn id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.3" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="1.167em" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.3" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.cmml"><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.1" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.1.cmml">∀</mo><mi id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.2.cmml">i</mi></mrow><mo id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.1" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.1.cmml">∈</mo><mrow id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.2.1" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.1.1.cmml">[</mo><mi id="S3.Ex2Xb.3.1.1.m1.3.3" xref="S3.Ex2Xb.3.1.1.m1.3.3.cmml">N</mi><mo stretchy="false" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.2.2" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex2Xb.3.1.1.m1.4.4.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2Xb.3.1.1.m1.4b"><apply id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.3.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.3a.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1"><eq id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.1"></eq><apply id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2"><apply id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1">subscript</csymbol><sum id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.2.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.2"></sum><apply id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3"><in id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.1"></in><ci id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.2.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.2">𝑐</ci><ci id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.3.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.1.3.3">𝒞</ci></apply></apply><apply id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2"><times id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.1"></times><ci id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.2">𝐗</ci><interval closure="closed" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.2.2.3.2"><ci id="S3.Ex2Xb.3.1.1.m1.1.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.1.1">𝑖</ci><ci id="S3.Ex2Xb.3.1.1.m1.2.2.cmml" xref="S3.Ex2Xb.3.1.1.m1.2.2">𝑐</ci></interval></apply></apply><cn type="integer" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.3.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.1.1.3">1</cn></apply><apply id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2"><in id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.1"></in><apply id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2"><csymbol cd="latexml" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.1">for-all</csymbol><ci id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.2.2">𝑖</ci></apply><apply id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.2"><csymbol cd="latexml" id="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.1.1.cmml" xref="S3.Ex2Xb.3.1.1.m1.4.4.1.1.2.2.3.2.1">delimited-[]</csymbol><ci id="S3.Ex2Xb.3.1.1.m1.3.3.cmml" xref="S3.Ex2Xb.3.1.1.m1.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2Xb.3.1.1.m1.4c">\displaystyle\sum_{c\in\mathcal{C}}\mathbf{X}[i,c]=1,\quad\forall i\in[N].</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2Xb.3.1.1.m1.4d">∑ start_POSTSUBSCRIPT italic_c ∈ caligraphic_C end_POSTSUBSCRIPT bold_X [ italic_i , italic_c ] = 1 , ∀ italic_i ∈ [ italic_N ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright" colspan="3"></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px1.p3.13" class="ltx_p">Here <math id="S3.SS2.SSS0.Px1.p3.4.m1.6" class="ltx_Math" alttext="\operatorname{error}(\mathbf{W}^{(i)},c)=\|\mathbf{W}^{(i)}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2})\|_{F}^{2}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.4.m1.6a"><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.6.6" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m1.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.3.3.cmml">error</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1a" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.2.cmml">⁡</mo><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.2.cmml">(</mo><msup id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.2.cmml">𝐖</mi><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.2.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m1.4.4" xref="S3.SS2.SSS0.Px1.p3.4.m1.4.4.cmml">c</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.4" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.3.cmml">=</mo><msubsup id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.2.1.cmml">‖</mo><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.cmml"><msup id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.2.cmml">𝐖</mi><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.2.2.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.2.2.1.3.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.4.m1.2.2.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.2.2.1.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.cmml">)</mo></mrow></msup><mo id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.2.cmml">−</mo><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.cmml"><msub id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msub id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.3.cmml">F</mi><mn id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.3" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.4.m1.6b"><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6"><eq id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.3"></eq><apply id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1"><ci id="S3.SS2.SSS0.Px1.p3.4.m1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.3.3">error</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.5.5.1.1.1.1.2">𝐖</ci><ci id="S3.SS2.SSS0.Px1.p3.4.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p3.4.m1.4.4.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.4.4">𝑐</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.2">norm</csymbol><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1"><minus id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.2"></minus><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.3.2">𝐖</ci><ci id="S3.SS2.SSS0.Px1.p3.4.m1.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1"><plus id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.1"></plus><ci id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.2">𝐐</ci><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3"><times id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.1"></times><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><ci id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.1.3">𝐹</ci></apply><cn type="integer" id="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m1.6.6.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.4.m1.6c">\operatorname{error}(\mathbf{W}^{(i)},c)=\|\mathbf{W}^{(i)}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2})\|_{F}^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.4.m1.6d">roman_error ( bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_c ) = ∥ bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> is the reconstruction error after running the iterative algorithm from Sec.&nbsp;<a href="#S3.SS1" title="3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> where the <math id="S3.SS2.SSS0.Px1.p3.5.m2.1" class="ltx_Math" alttext="\operatorname{Quantize}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.5.m2.1a"><mi id="S3.SS2.SSS0.Px1.p3.5.m2.1.1" xref="S3.SS2.SSS0.Px1.p3.5.m2.1.1.cmml">Quantize</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.5.m2.1b"><ci id="S3.SS2.SSS0.Px1.p3.5.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m2.1.1">Quantize</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.5.m2.1c">\operatorname{Quantize}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.5.m2.1d">roman_Quantize</annotation></semantics></math> function uses configuration <math id="S3.SS2.SSS0.Px1.p3.6.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.6.m3.1a"><mi id="S3.SS2.SSS0.Px1.p3.6.m3.1.1" xref="S3.SS2.SSS0.Px1.p3.6.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.6.m3.1b"><ci id="S3.SS2.SSS0.Px1.p3.6.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.6.m3.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.6.m3.1d">italic_c</annotation></semantics></math>. To approximately solve this ILP we pre-compute the errors for all matrices and quantization configurations (<math id="S3.SS2.SSS0.Px1.p3.7.m4.1" class="ltx_Math" alttext="|\mathcal{C}|=3^{5}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.7.m4.1a"><mrow id="S3.SS2.SSS0.Px1.p3.7.m4.1.2" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.2.1" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p3.7.m4.1.1" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.1.cmml">𝒞</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.1" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.1.cmml">=</mo><msup id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.cmml"><mn id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.2" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.2.cmml">3</mn><mn id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.3" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.7.m4.1b"><apply id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2"><eq id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.2"><abs id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.2.2.1"></abs><ci id="S3.SS2.SSS0.Px1.p3.7.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.1">𝒞</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3">superscript</csymbol><cn type="integer" id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.2">3</cn><cn type="integer" id="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m4.1.2.3.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.7.m4.1c">|\mathcal{C}|=3^{5}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.7.m4.1d">| caligraphic_C | = 3 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math>) and use an off-the-shelf solver,<span id="footnote7" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span><a target="_blank" href="https://www.gurobi.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.gurobi.com/</a></span></span></span> as shown in Algorithm&nbsp;<a href="#alg3" title="Algorithm 3 ‣ 3.2 Mixed-Configuration Quantization via an Integer Linear Program ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The pre-computation is a one-time process and takes a few hours when parallelized across four A100 GPUs for LLaMA-2-7B. Once the (approximately) optimal configuration <math id="S3.SS2.SSS0.Px1.p3.8.m5.1" class="ltx_Math" alttext="c^{(i)}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.8.m5.1a"><msup id="S3.SS2.SSS0.Px1.p3.8.m5.1.2" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.8.m5.1.2.2" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.2.2.cmml">c</mi><mrow id="S3.SS2.SSS0.Px1.p3.8.m5.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.8.m5.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.8.m5.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.8.m5.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.8.m5.1b"><apply id="S3.SS2.SSS0.Px1.p3.8.m5.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.8.m5.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.8.m5.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.2.2">𝑐</ci><ci id="S3.SS2.SSS0.Px1.p3.8.m5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.8.m5.1c">c^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.8.m5.1d">italic_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is found, we apply the decomposition on <math id="S3.SS2.SSS0.Px1.p3.9.m6.1" class="ltx_Math" alttext="\mathbf{W}^{(i)}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.9.m6.1a"><msup id="S3.SS2.SSS0.Px1.p3.9.m6.1.2" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.9.m6.1.2.2" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.2.2.cmml">𝐖</mi><mrow id="S3.SS2.SSS0.Px1.p3.9.m6.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.9.m6.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.9.m6.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.9.m6.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.9.m6.1b"><apply id="S3.SS2.SSS0.Px1.p3.9.m6.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.9.m6.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.9.m6.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.2.2">𝐖</ci><ci id="S3.SS2.SSS0.Px1.p3.9.m6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m6.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.9.m6.1c">\mathbf{W}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.9.m6.1d">bold_W start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> one more time with <math id="S3.SS2.SSS0.Px1.p3.10.m7.1" class="ltx_Math" alttext="c^{(i)}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.10.m7.1a"><msup id="S3.SS2.SSS0.Px1.p3.10.m7.1.2" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.10.m7.1.2.2" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.2.2.cmml">c</mi><mrow id="S3.SS2.SSS0.Px1.p3.10.m7.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.10.m7.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.10.m7.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.10.m7.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.10.m7.1b"><apply id="S3.SS2.SSS0.Px1.p3.10.m7.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.10.m7.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.10.m7.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.2.2">𝑐</ci><ci id="S3.SS2.SSS0.Px1.p3.10.m7.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.10.m7.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.10.m7.1c">c^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.10.m7.1d">italic_c start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> to obtain the final matrices <math id="S3.SS2.SSS0.Px1.p3.11.m8.1" class="ltx_Math" alttext="\mathbf{Q}^{(i)}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.11.m8.1a"><msup id="S3.SS2.SSS0.Px1.p3.11.m8.1.2" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.11.m8.1.2.2" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.2.2.cmml">𝐐</mi><mrow id="S3.SS2.SSS0.Px1.p3.11.m8.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.11.m8.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.11.m8.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.11.m8.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.11.m8.1b"><apply id="S3.SS2.SSS0.Px1.p3.11.m8.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.11.m8.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.11.m8.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.2.2">𝐐</ci><ci id="S3.SS2.SSS0.Px1.p3.11.m8.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m8.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.11.m8.1c">\mathbf{Q}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.11.m8.1d">bold_Q start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, <math id="S3.SS2.SSS0.Px1.p3.12.m9.4" class="ltx_Math" alttext="\mathbf{L}_{1}^{(i)},\mathbf{L}^{(i)}_{2}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.12.m9.4a"><mrow id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.3.cmml"><msubsup id="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.2.cmml">𝐋</mi><mn id="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.3.cmml">1</mn><mrow id="S3.SS2.SSS0.Px1.p3.12.m9.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.12.m9.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.12.m9.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.12.m9.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.12.m9.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.3" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.2.2.cmml">𝐋</mi><mn id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.3" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.3.cmml">2</mn><mrow id="S3.SS2.SSS0.Px1.p3.12.m9.2.2.1.3" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.12.m9.2.2.1.3.1" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.12.m9.2.2.1.1" xref="S3.SS2.SSS0.Px1.p3.12.m9.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.12.m9.2.2.1.3.2" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.12.m9.4b"><list id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.3.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2"><apply id="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.2">𝐋</ci><cn type="integer" id="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.3.3.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p3.12.m9.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.1.1.1.1">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.2.2">𝐋</ci><ci id="S3.SS2.SSS0.Px1.p3.12.m9.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.2.2.1.1">𝑖</ci></apply><cn type="integer" id="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.12.m9.4.4.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.12.m9.4c">\mathbf{L}_{1}^{(i)},\mathbf{L}^{(i)}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.12.m9.4d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_L start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> for <math id="S3.SS2.SSS0.Px1.p3.13.m10.1" class="ltx_Math" alttext="i\in[N]" display="inline"><semantics id="S3.SS2.SSS0.Px1.p3.13.m10.1a"><mrow id="S3.SS2.SSS0.Px1.p3.13.m10.1.2" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.2" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.2.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.1" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.1.cmml">∈</mo><mrow id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.2" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.2.1" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.1.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p3.13.m10.1.1" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.1.cmml">N</mi><mo stretchy="false" id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.2.2" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.13.m10.1b"><apply id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2"><in id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.1"></in><ci id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.2">𝑖</ci><apply id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.2"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p3.13.m10.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.13.m10.1.1">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.13.m10.1c">i\in[N]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.13.m10.1d">italic_i ∈ [ italic_N ]</annotation></semantics></math> (see Algorithm&nbsp;<a href="#alg1" title="Algorithm 1 ‣ 3.2 Mixed-Configuration Quantization via an Integer Linear Program ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
<section id="S3.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Implementation.</h4>

<div id="S3.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.1">기존의 가중치 전용 양자화 구현들은 종종 특정 양자화 구성에 의존하는 커스텀 CUDA 확장들을 사용하여, 혼합 양자화 전략들로 확장하는 것을 어렵게 한다. 구현은 유연한 실험과 구현을 위해 PyTorch를 기반으로 한다. PyTorch의 <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS0.Px2.p1.1.1">__torch_dispatch__</span> 기능을 duck-type <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS0.Px2.p1.1.2">torch.Tensor</span>에 사용합니다. 이를 통해 행렬 곱셈과 같은 PyTorch 연산에 과부하를 주어 정시간 역양자화를 수행할 수 있다. 그런 다음 PyTorch의 (전체 그래프) 컴파일러를 사용하여 비트 풀 패킹, 역양자화, 기타 선형 대수 연산을 컴파일한다. 배치 크기 <math alttext="&gt;" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><mo id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><gt id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">&gt;</annotation></semantics></math> 1의 경우, 이 PyTorch 기반 구현(컴파일에 따라 수행됨)은 <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS0.Px2.p1.1.3">bitsandbytes</span>과 같은 일부 사용자 지정 CUDA 구현만큼 빨랐다. <span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/TimDettmers/bitsandbytes" target="_blank" title="">https://github.com/TimDettmers/bitsandbytes</a></span></span></span> 자세한 내용 및 속도 비교는 부록 <a class="ltx_ref" href="#A1" title="Appendix A Implementation Details ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">A</span></a>에 나와 있습니다.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Data-Aware Matrix Decomposition via Fisher-weighted SVD</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS3.p1.6">§<a class="ltx_ref" href="#S3.SS1" title="3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">3.1</span></a>에서 고려되는 분해 목적은 <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">bold_W</annotation></semantics></math>의 각 항목을 인수분해 동안 재구성에 동등하게 중요한 것으로 처리하는 한 데이터에 영향을 미치지 않는다. LLMs <cite class="ltx_cite ltx_citemacro_citep">(Frantar et al., <a class="ltx_ref" href="#bib.bib13" title="">2022</a>; Lin et al., <a class="ltx_ref" href="#bib.bib31" title="">2023</a>; Kim et al., <a class="ltx_ref" href="#bib.bib21" title="">2023b</a>)</cite>를 정량화하기 위해 교정 데이터를 사용하는 것의 중요성을 입증한 최근 연구에 이어, 재구성 목표에 가중치를 부여하기 위해 피셔 정보 행렬의 대각 근사를 사용하여 접근 방식의 데이터 인식 버전을 고려한다. <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">bold_W</annotation></semantics></math>에 대한 (대각선) 경험적 피셔 정보 행렬은 <math alttext="\mathbf{F}\in\mathbb{R}^{d\times k}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">𝐅</mi><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.2" xref="S3.SS3.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.3.m3.1.1.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.3.2" xref="S3.SS3.p1.3.m3.1.1.3.3.2.cmml">d</mi><mo id="S3.SS3.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.3.m3.1.1.3.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><in id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1"></in><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝐅</ci><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3"><times id="S3.SS3.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\mathbf{F}\in\mathbb{R}^{d\times k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">bold_F ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>에 의해 주어지며, 행렬의 각 엔트리는 <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_D</annotation></semantics></math> 샘플에 대한 도함수의 평균 제곱, 즉 <math alttext="\mathbf{F}_{ij}=\frac{1}{D}\sum_{d=1}^{D}\left(\frac{\partial}{\partial\mathbf{W}_{ij}}\log p_{\text{LM}}\left(\mathbf{x}^{(d)}\right)\right)^{2}." class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.2"><semantics id="S3.SS3.p1.5.m5.2a"><mrow id="S3.SS3.p1.5.m5.2.2.1" xref="S3.SS3.p1.5.m5.2.2.1.1.cmml"><mrow id="S3.SS3.p1.5.m5.2.2.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.cmml"><msub id="S3.SS3.p1.5.m5.2.2.1.1.3" xref="S3.SS3.p1.5.m5.2.2.1.1.3.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.3.2" xref="S3.SS3.p1.5.m5.2.2.1.1.3.2.cmml">𝐅</mi><mrow id="S3.SS3.p1.5.m5.2.2.1.1.3.3" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.3.3.2" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3.2.cmml">i</mi><mo id="S3.SS3.p1.5.m5.2.2.1.1.3.3.1" lspace="0px" rspace="0px" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3.1.cmml"></mo><mi id="S3.SS3.p1.5.m5.2.2.1.1.3.3.3" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.p1.5.m5.2.2.1.1.2" xref="S3.SS3.p1.5.m5.2.2.1.1.2.cmml">=</mo><mrow id="S3.SS3.p1.5.m5.2.2.1.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.cmml"><mfrac id="S3.SS3.p1.5.m5.2.2.1.1.1.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.3.cmml"><mn id="S3.SS3.p1.5.m5.2.2.1.1.1.3.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.3.2.cmml">1</mn><mi id="S3.SS3.p1.5.m5.2.2.1.1.1.3.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.3.3.cmml">D</mi></mfrac><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.2" lspace="0px" rspace="0px" xref="S3.SS3.p1.5.m5.2.2.1.1.1.2.cmml"></mo><mrow id="S3.SS3.p1.5.m5.2.2.1.1.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.cmml"><msubsup id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.cmml"><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.2" rspace="0em" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.2.cmml">d</mi><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.3.cmml">D</mi></msubsup><msup id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.cmml"><mrow id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.cmml"><mfrac id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.2.cmml">∂</mo><mrow id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.1" rspace="0em" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><msub id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.2.cmml">𝐖</mi><mrow id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml">i</mi><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.1" lspace="0px" rspace="0px" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.1.cmml"></mo><mi id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mfrac><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.2" lspace="0.167em" rspace="0px" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.2.cmml"></mo><mrow id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.1.cmml">log</mi><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4a" lspace="0.167em" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.cmml">⁡</mo><msub id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.2.cmml">p</mi><mtext id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.3a.cmml">LM</mtext></msub></mrow><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.2a" lspace="0px" rspace="0px" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.2.cmml"></mo><mrow id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S3.SS3.p1.5.m5.1.1.1.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.p1.5.m5.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.cmml">d</mi><mo id="S3.SS3.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.3" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S3.SS3.p1.5.m5.2.2.1.2" lspace="0em" xref="S3.SS3.p1.5.m5.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.2b"><apply id="S3.SS3.p1.5.m5.2.2.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1"><eq id="S3.SS3.p1.5.m5.2.2.1.1.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.2"></eq><apply id="S3.SS3.p1.5.m5.2.2.1.1.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.2.2.1.1.3.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.5.m5.2.2.1.1.3.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3.2">𝐅</ci><apply id="S3.SS3.p1.5.m5.2.2.1.1.3.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3"><times id="S3.SS3.p1.5.m5.2.2.1.1.3.3.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3.1"></times><ci id="S3.SS3.p1.5.m5.2.2.1.1.3.3.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3.2">𝑖</ci><ci id="S3.SS3.p1.5.m5.2.2.1.1.3.3.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1"><times id="S3.SS3.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.2"></times><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.3"><divide id="S3.SS3.p1.5.m5.2.2.1.1.1.3.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.3"></divide><cn id="S3.SS3.p1.5.m5.2.2.1.1.1.3.2.cmml" type="integer" xref="S3.SS3.p1.5.m5.2.2.1.1.1.3.2">1</cn><ci id="S3.SS3.p1.5.m5.2.2.1.1.1.3.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.3.3">𝐷</ci></apply><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1"><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.2"></sum><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3"><eq id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.2">𝑑</ci><cn id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.2.3">𝐷</ci></apply><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1"><times id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.2"></times><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3"><divide id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3"></divide><partialdiff id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.2"></partialdiff><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3"><partialdiff id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.1"></partialdiff><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.2">𝐖</ci><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3"><times id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.1"></times><ci id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.2">𝑖</ci><ci id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.3.3.2.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4"><log id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.1"></log><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.2">𝑝</ci><ci id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.3a.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.3"><mtext id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.3.cmml" mathsize="70%" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.3">LM</mtext></ci></apply></apply><apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS3.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">𝑑</ci></apply></apply><cn id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.2c">\mathbf{F}_{ij}=\frac{1}{D}\sum_{d=1}^{D}\left(\frac{\partial}{\partial\mathbf{W}_{ij}}\log p_{\text{LM}}\left(\mathbf{x}^{(d)}\right)\right)^{2}.</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.2d">bold_F start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_D end_ARG ∑ start_POSTSUBSCRIPT italic_d = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ( divide start_ARG ∂ end_ARG start_ARG ∂ bold_W start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_ARG roman_log italic_p start_POSTSUBSCRIPT LM end_POSTSUBSCRIPT ( bold_x start_POSTSUPERSCRIPT ( italic_d ) end_POSTSUPERSCRIPT ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math>에 대해 직관적으로, 이 메트릭은 모델의 출력이 각 파라미터의 섭동에 얼마나 민감한지를 측정하고, 이전에 사전 훈련된 언어 모델의 저순위 압축 <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a class="ltx_ref" href="#bib.bib18" title="">2022</a>)</cite> 및 양자화 <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a class="ltx_ref" href="#bib.bib21" title="">2023b</a>)</cite>를 개선하기 위해 이용되었다. 마찬가지로 <math alttext="\mathbf{F}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">bold_F</annotation></semantics></math>를 이용하여 분해목적에 가중치를 부여하고,</p>
<table id="S3.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\left\|{\sqrt{\mathbf{F}}\,\odot}\left(\mathbf{W}-\left(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2}\right)\right)\right\|_{F}^{2}," display="inline"><semantics id="S3.E4X.2.1.1.m1.1a"><mrow id="S3.E4X.2.1.1.m1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.cmml"><msubsup id="S3.E4X.2.1.1.m1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msqrt id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐅</mi></msqrt><mo lspace="0.392em" rspace="0.222em" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐖</mi><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msub id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.E4X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.3.cmml">F</mi><mn id="S3.E4X.2.1.1.m1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S3.E4X.2.1.1.m1.1.1.1.2" xref="S3.E4X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.1b"><apply id="S3.E4X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1">superscript</csymbol><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1">subscript</csymbol><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3"><root id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3"></root><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝐅</ci></apply><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"></minus><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝐖</ci><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐐</ci><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn type="integer" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn type="integer" id="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></apply><ci id="S3.E4X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.1.3">𝐹</ci></apply><cn type="integer" id="S3.E4X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.1c">\displaystyle\left\|{\sqrt{\mathbf{F}}\,\odot}\left(\mathbf{W}-\left(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2}\right)\right)\right\|_{F}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.2.1.1.m1.1d">∥ square-root start_ARG bold_F end_ARG ⊙ ( bold_W - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.11">여기서 <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m1.1"><semantics id="S3.SS3.p1.7.m1.1a"><mo id="S3.SS3.p1.7.m1.1.1" xref="S3.SS3.p1.7.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m1.1b"><csymbol cd="latexml" id="S3.SS3.p1.7.m1.1.1.cmml" xref="S3.SS3.p1.7.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m1.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m1.1d">⊙</annotation></semantics></math>는 Hadamard product이다. §<a class="ltx_ref" href="#S3.SS1" title="3.1 Low-rank Plus Quantized Matrix Decomposition ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">3.1</span></a>로부터 LQ 분해 알고리즘에 적용되면, 이는 다음의 가중된 SVD 문제를 초래하며, 여기서 주어진 <math alttext="\mathbf{E}:=\mathbf{W}-\mathbf{Q}" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m2.1"><semantics id="S3.SS3.p1.8.m2.1a"><mrow id="S3.SS3.p1.8.m2.1.1" xref="S3.SS3.p1.8.m2.1.1.cmml"><mi id="S3.SS3.p1.8.m2.1.1.2" xref="S3.SS3.p1.8.m2.1.1.2.cmml">𝐄</mi><mo id="S3.SS3.p1.8.m2.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.p1.8.m2.1.1.1.cmml">:=</mo><mrow id="S3.SS3.p1.8.m2.1.1.3" xref="S3.SS3.p1.8.m2.1.1.3.cmml"><mi id="S3.SS3.p1.8.m2.1.1.3.2" xref="S3.SS3.p1.8.m2.1.1.3.2.cmml">𝐖</mi><mo id="S3.SS3.p1.8.m2.1.1.3.1" xref="S3.SS3.p1.8.m2.1.1.3.1.cmml">−</mo><mi id="S3.SS3.p1.8.m2.1.1.3.3" xref="S3.SS3.p1.8.m2.1.1.3.3.cmml">𝐐</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m2.1b"><apply id="S3.SS3.p1.8.m2.1.1.cmml" xref="S3.SS3.p1.8.m2.1.1"><csymbol cd="latexml" id="S3.SS3.p1.8.m2.1.1.1.cmml" xref="S3.SS3.p1.8.m2.1.1.1">assign</csymbol><ci id="S3.SS3.p1.8.m2.1.1.2.cmml" xref="S3.SS3.p1.8.m2.1.1.2">𝐄</ci><apply id="S3.SS3.p1.8.m2.1.1.3.cmml" xref="S3.SS3.p1.8.m2.1.1.3"><minus id="S3.SS3.p1.8.m2.1.1.3.1.cmml" xref="S3.SS3.p1.8.m2.1.1.3.1"></minus><ci id="S3.SS3.p1.8.m2.1.1.3.2.cmml" xref="S3.SS3.p1.8.m2.1.1.3.2">𝐖</ci><ci id="S3.SS3.p1.8.m2.1.1.3.3.cmml" xref="S3.SS3.p1.8.m2.1.1.3.3">𝐐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m2.1c">\mathbf{E}:=\mathbf{W}-\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m2.1d">bold_E := bold_W - bold_Q</annotation></semantics></math> 및 가중 매트릭스 <math alttext="\mathbf{F}" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m3.1"><semantics id="S3.SS3.p1.9.m3.1a"><mi id="S3.SS3.p1.9.m3.1.1" xref="S3.SS3.p1.9.m3.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m3.1b"><ci id="S3.SS3.p1.9.m3.1.1.cmml" xref="S3.SS3.p1.9.m3.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m3.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m3.1d">bold_F</annotation></semantics></math>, 우리는 최상의 랭크-<math alttext="r" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m5.1"><semantics id="S3.SS3.p1.11.m5.1a"><mi id="S3.SS3.p1.11.m5.1.1" xref="S3.SS3.p1.11.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m5.1b"><ci id="S3.SS3.p1.11.m5.1.1.cmml" xref="S3.SS3.p1.11.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m5.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m5.1d">italic_r</annotation></semantics></math> 근사치를 형성하는 매트릭스 <math alttext="\mathbf{L}_{1}\in\mathbb{R}^{d\times r},\mathbf{L}_{2}\in\mathbb{R}^{r\times k}" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m4.2"><semantics id="S3.SS3.p1.10.m4.2a"><mrow id="S3.SS3.p1.10.m4.2.2.2" xref="S3.SS3.p1.10.m4.2.2.3.cmml"><mrow id="S3.SS3.p1.10.m4.1.1.1.1" xref="S3.SS3.p1.10.m4.1.1.1.1.cmml"><msub id="S3.SS3.p1.10.m4.1.1.1.1.2" xref="S3.SS3.p1.10.m4.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.10.m4.1.1.1.1.2.2" xref="S3.SS3.p1.10.m4.1.1.1.1.2.2.cmml">𝐋</mi><mn id="S3.SS3.p1.10.m4.1.1.1.1.2.3" xref="S3.SS3.p1.10.m4.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS3.p1.10.m4.1.1.1.1.1" xref="S3.SS3.p1.10.m4.1.1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.10.m4.1.1.1.1.3" xref="S3.SS3.p1.10.m4.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.10.m4.1.1.1.1.3.2" xref="S3.SS3.p1.10.m4.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.10.m4.1.1.1.1.3.3" xref="S3.SS3.p1.10.m4.1.1.1.1.3.3.cmml"><mi id="S3.SS3.p1.10.m4.1.1.1.1.3.3.2" xref="S3.SS3.p1.10.m4.1.1.1.1.3.3.2.cmml">d</mi><mo id="S3.SS3.p1.10.m4.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.10.m4.1.1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.10.m4.1.1.1.1.3.3.3" xref="S3.SS3.p1.10.m4.1.1.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><mo id="S3.SS3.p1.10.m4.2.2.2.3" xref="S3.SS3.p1.10.m4.2.2.3a.cmml">,</mo><mrow id="S3.SS3.p1.10.m4.2.2.2.2" xref="S3.SS3.p1.10.m4.2.2.2.2.cmml"><msub id="S3.SS3.p1.10.m4.2.2.2.2.2" xref="S3.SS3.p1.10.m4.2.2.2.2.2.cmml"><mi id="S3.SS3.p1.10.m4.2.2.2.2.2.2" xref="S3.SS3.p1.10.m4.2.2.2.2.2.2.cmml">𝐋</mi><mn id="S3.SS3.p1.10.m4.2.2.2.2.2.3" xref="S3.SS3.p1.10.m4.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p1.10.m4.2.2.2.2.1" xref="S3.SS3.p1.10.m4.2.2.2.2.1.cmml">∈</mo><msup id="S3.SS3.p1.10.m4.2.2.2.2.3" xref="S3.SS3.p1.10.m4.2.2.2.2.3.cmml"><mi id="S3.SS3.p1.10.m4.2.2.2.2.3.2" xref="S3.SS3.p1.10.m4.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.10.m4.2.2.2.2.3.3" xref="S3.SS3.p1.10.m4.2.2.2.2.3.3.cmml"><mi id="S3.SS3.p1.10.m4.2.2.2.2.3.3.2" xref="S3.SS3.p1.10.m4.2.2.2.2.3.3.2.cmml">r</mi><mo id="S3.SS3.p1.10.m4.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.10.m4.2.2.2.2.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.10.m4.2.2.2.2.3.3.3" xref="S3.SS3.p1.10.m4.2.2.2.2.3.3.3.cmml">k</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m4.2b"><apply id="S3.SS3.p1.10.m4.2.2.3.cmml" xref="S3.SS3.p1.10.m4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m4.2.2.3a.cmml" xref="S3.SS3.p1.10.m4.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS3.p1.10.m4.1.1.1.1.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1"><in id="S3.SS3.p1.10.m4.1.1.1.1.1.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.1"></in><apply id="S3.SS3.p1.10.m4.1.1.1.1.2.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m4.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.10.m4.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.2.2">𝐋</ci><cn id="S3.SS3.p1.10.m4.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS3.p1.10.m4.1.1.1.1.2.3">1</cn></apply><apply id="S3.SS3.p1.10.m4.1.1.1.1.3.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m4.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.10.m4.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p1.10.m4.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.3.3"><times id="S3.SS3.p1.10.m4.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.3.3.1"></times><ci id="S3.SS3.p1.10.m4.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.p1.10.m4.1.1.1.1.3.3.3.cmml" xref="S3.SS3.p1.10.m4.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="S3.SS3.p1.10.m4.2.2.2.2.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2"><in id="S3.SS3.p1.10.m4.2.2.2.2.1.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.1"></in><apply id="S3.SS3.p1.10.m4.2.2.2.2.2.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m4.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.10.m4.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.2.2">𝐋</ci><cn id="S3.SS3.p1.10.m4.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.p1.10.m4.2.2.2.2.2.3">2</cn></apply><apply id="S3.SS3.p1.10.m4.2.2.2.2.3.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m4.2.2.2.2.3.1.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.3">superscript</csymbol><ci id="S3.SS3.p1.10.m4.2.2.2.2.3.2.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.3.2">ℝ</ci><apply id="S3.SS3.p1.10.m4.2.2.2.2.3.3.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.3.3"><times id="S3.SS3.p1.10.m4.2.2.2.2.3.3.1.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.3.3.1"></times><ci id="S3.SS3.p1.10.m4.2.2.2.2.3.3.2.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.3.3.2">𝑟</ci><ci id="S3.SS3.p1.10.m4.2.2.2.2.3.3.3.cmml" xref="S3.SS3.p1.10.m4.2.2.2.2.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m4.2c">\mathbf{L}_{1}\in\mathbb{R}^{d\times r},\mathbf{L}_{2}\in\mathbb{R}^{r\times k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m4.2d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_r end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_r × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>를 찾아야 하고,</p>
<table id="S3.Ex3" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S3.Ex3X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex3X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\mathbf{L}_{1},\mathbf{L}_{2}=\operatornamewithlimits{arg\,min}_{\mathbf{L}_{1},\mathbf{L}_{2}}\;\left\|\sqrt{\mathbf{F}}\odot\left(\mathbf{E}-\mathbf{L}_{1}\mathbf{L}_{2}\right)\right\|_{F}^{2}." display="inline"><semantics id="S3.Ex3X.2.1.1.m1.3a"><mrow id="S3.Ex3X.2.1.1.m1.3.3.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.Ex3X.2.1.1.m1.3.3.1.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.3.cmml"><msub id="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">𝐋</mi><mn id="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.3.cmml">,</mo><msub id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.2.cmml">𝐋</mi><mn id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.3.cmml">2</mn></msub></mrow><mo id="S3.Ex3X.2.1.1.m1.3.3.1.1.4" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.Ex3X.2.1.1.m1.3.3.1.1.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.cmml"><munder id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.cmml"><mrow id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.2.cmml">arg</mi><mo lspace="0.170em" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.1.cmml" rspace="0px"></mo><mi id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.3.cmml">min</mi></mrow><mrow id="S3.Ex3X.2.1.1.m1.2.2.2.2" xref="S3.Ex3X.2.1.1.m1.2.2.2.3.cmml"><msub id="S3.Ex3X.2.1.1.m1.1.1.1.1.1" xref="S3.Ex3X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.Ex3X.2.1.1.m1.1.1.1.1.1.2" xref="S3.Ex3X.2.1.1.m1.1.1.1.1.1.2.cmml">𝐋</mi><mn id="S3.Ex3X.2.1.1.m1.1.1.1.1.1.3" xref="S3.Ex3X.2.1.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex3X.2.1.1.m1.2.2.2.2.3" xref="S3.Ex3X.2.1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.Ex3X.2.1.1.m1.2.2.2.2.2" xref="S3.Ex3X.2.1.1.m1.2.2.2.2.2.cmml"><mi id="S3.Ex3X.2.1.1.m1.2.2.2.2.2.2" xref="S3.Ex3X.2.1.1.m1.2.2.2.2.2.2.cmml">𝐋</mi><mn id="S3.Ex3X.2.1.1.m1.2.2.2.2.2.3" xref="S3.Ex3X.2.1.1.m1.2.2.2.2.2.3.cmml">2</mn></msub></mrow></munder><mo id="S3.Ex3X.2.1.1.m1.3.3.1.1.3a" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.cmml">⁡</mo><msubsup id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.cmml"><mrow id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.2.cmml"><mo id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.2.1.cmml">‖</mo><mrow id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.cmml"><msqrt id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3.cmml"><mi id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3.2.cmml">𝐅</mi></msqrt><mo lspace="0.222em" rspace="0.222em" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.2.cmml">⊙</mo><mrow id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.2.cmml">𝐄</mi><mo id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msub id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.3.cmml">F</mi><mn id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.3" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.3.cmml">2</mn></msubsup></mrow></mrow><mo lspace="0em" id="S3.Ex3X.2.1.1.m1.3.3.1.2" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3X.2.1.1.m1.3b"><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1"><eq id="S3.Ex3X.2.1.1.m1.3.3.1.1.4.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.4"></eq><list id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2"><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.2">𝐋</ci><cn type="integer" id="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.2">𝐋</ci><cn type="integer" id="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.2.2.2.3">2</cn></apply></list><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3"><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2">subscript</csymbol><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2"><times id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.1"></times><ci id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.2">arg</ci><ci id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.2.2.3">min</ci></apply><list id="S3.Ex3X.2.1.1.m1.2.2.2.3.cmml" xref="S3.Ex3X.2.1.1.m1.2.2.2.2"><apply id="S3.Ex3X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.Ex3X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex3X.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex3X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex3X.2.1.1.m1.1.1.1.1.1.2">𝐋</ci><cn type="integer" id="S3.Ex3X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.Ex3X.2.1.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex3X.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.Ex3X.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex3X.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S3.Ex3X.2.1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex3X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.Ex3X.2.1.1.m1.2.2.2.2.2.2">𝐋</ci><cn type="integer" id="S3.Ex3X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.Ex3X.2.1.1.m1.2.2.2.2.2.3">2</cn></apply></list></apply><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1">subscript</csymbol><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.2.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.2">norm</csymbol><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3"><root id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3a.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3"></root><ci id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.3.2">𝐅</ci></apply><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1"><minus id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.2">𝐄</ci><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3"><times id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn type="integer" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn type="integer" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><ci id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.1.3">𝐹</ci></apply><cn type="integer" id="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.3.cmml" xref="S3.Ex3X.2.1.1.m1.3.3.1.1.3.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3X.2.1.1.m1.3c">\displaystyle\mathbf{L}_{1},\mathbf{L}_{2}=\operatornamewithlimits{arg\,min}_{\mathbf{L}_{1},\mathbf{L}_{2}}\;\left\|\sqrt{\mathbf{F}}\odot\left(\mathbf{E}-\mathbf{L}_{1}\mathbf{L}_{2}\right)\right\|_{F}^{2}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3X.2.1.1.m1.3d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ square-root start_ARG bold_F end_ARG ⊙ ( bold_E - bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.12">이 문제는 일반적으로 다루기 어려운 <cite class="ltx_cite ltx_citemacro_citep">(and in fact NP-hard; Razenshteyn et al., <a class="ltx_ref" href="#bib.bib40" title="">2016</a>)</cite>이며 일반적으로 근사 방법 <cite class="ltx_cite ltx_citemacro_citep">(Srebro &amp; Jaakkola, <a class="ltx_ref" href="#bib.bib44" title="">2003</a>; Li et al., <a class="ltx_ref" href="#bib.bib30" title="">2016</a>; Tuzhilina &amp; Hastie, <a class="ltx_ref" href="#bib.bib53" title="">2021</a>)</cite>를 통해 해결된다. 그러나, 가중치 행렬 <math alttext="\mathbf{F}" class="ltx_Math" display="inline" id="S3.SS3.p1.12.m1.1"><semantics id="S3.SS3.p1.12.m1.1a"><mi id="S3.SS3.p1.12.m1.1.1" xref="S3.SS3.p1.12.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m1.1b"><ci id="S3.SS3.p1.12.m1.1.1.cmml" xref="S3.SS3.p1.12.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m1.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.12.m1.1d">bold_F</annotation></semantics></math>의 행 또는 열 중 어느 하나가 동일한 값을 갖는다고 가정하면, 다음과 같은 동일성을 갖게 되고,</p>
<table id="S3.Ex4" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S3.Ex4X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex4X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{L}_{1},\mathbf{L}_{2}" display="inline"><semantics id="S3.Ex4X.2.1.1.m1.2a"><mrow id="S3.Ex4X.2.1.1.m1.2.2.2" xref="S3.Ex4X.2.1.1.m1.2.2.3.cmml"><msub id="S3.Ex4X.2.1.1.m1.1.1.1.1" xref="S3.Ex4X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.Ex4X.2.1.1.m1.1.1.1.1.2" xref="S3.Ex4X.2.1.1.m1.1.1.1.1.2.cmml">𝐋</mi><mn id="S3.Ex4X.2.1.1.m1.1.1.1.1.3" xref="S3.Ex4X.2.1.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex4X.2.1.1.m1.2.2.2.3" xref="S3.Ex4X.2.1.1.m1.2.2.3.cmml">,</mo><msub id="S3.Ex4X.2.1.1.m1.2.2.2.2" xref="S3.Ex4X.2.1.1.m1.2.2.2.2.cmml"><mi id="S3.Ex4X.2.1.1.m1.2.2.2.2.2" xref="S3.Ex4X.2.1.1.m1.2.2.2.2.2.cmml">𝐋</mi><mn id="S3.Ex4X.2.1.1.m1.2.2.2.2.3" xref="S3.Ex4X.2.1.1.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4X.2.1.1.m1.2b"><list id="S3.Ex4X.2.1.1.m1.2.2.3.cmml" xref="S3.Ex4X.2.1.1.m1.2.2.2"><apply id="S3.Ex4X.2.1.1.m1.1.1.1.1.cmml" xref="S3.Ex4X.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.Ex4X.2.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.Ex4X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.Ex4X.2.1.1.m1.1.1.1.1.2">𝐋</ci><cn type="integer" id="S3.Ex4X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.Ex4X.2.1.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex4X.2.1.1.m1.2.2.2.2.cmml" xref="S3.Ex4X.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex4X.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.Ex4X.2.1.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.Ex4X.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.Ex4X.2.1.1.m1.2.2.2.2.2">𝐋</ci><cn type="integer" id="S3.Ex4X.2.1.1.m1.2.2.2.2.3.cmml" xref="S3.Ex4X.2.1.1.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4X.2.1.1.m1.2c">\displaystyle\mathbf{L}_{1},\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4X.2.1.1.m1.2d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex4X.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\operatornamewithlimits{arg\,min}_{\mathbf{L}_{1},\mathbf{L}_{2}}\;\left\|\sqrt{\mathbf{F}}\odot\left(\mathbf{E}-\mathbf{L}_{1}\mathbf{L}_{2}\right)\right\|_{F}^{2}" display="inline"><semantics id="S3.Ex4X.3.2.2.m1.3a"><mrow id="S3.Ex4X.3.2.2.m1.3.3" xref="S3.Ex4X.3.2.2.m1.3.3.cmml"><mi id="S3.Ex4X.3.2.2.m1.3.3.3" xref="S3.Ex4X.3.2.2.m1.3.3.3.cmml"></mi><mo id="S3.Ex4X.3.2.2.m1.3.3.2" xref="S3.Ex4X.3.2.2.m1.3.3.2.cmml">=</mo><mrow id="S3.Ex4X.3.2.2.m1.3.3.1" xref="S3.Ex4X.3.2.2.m1.3.3.1.cmml"><munder id="S3.Ex4X.3.2.2.m1.3.3.1.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.2.cmml"><mrow id="S3.Ex4X.3.2.2.m1.3.3.1.2.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.2.2.cmml"><mi id="S3.Ex4X.3.2.2.m1.3.3.1.2.2.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.2.2.2.cmml">arg</mi><mo lspace="0.170em" id="S3.Ex4X.3.2.2.m1.3.3.1.2.2.1" xref="S3.Ex4X.3.2.2.m1.3.3.1.2.2.1.cmml" rspace="0px"></mo><mi id="S3.Ex4X.3.2.2.m1.3.3.1.2.2.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.2.2.3.cmml">min</mi></mrow><mrow id="S3.Ex4X.3.2.2.m1.2.2.2.2" xref="S3.Ex4X.3.2.2.m1.2.2.2.3.cmml"><msub id="S3.Ex4X.3.2.2.m1.1.1.1.1.1" xref="S3.Ex4X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S3.Ex4X.3.2.2.m1.1.1.1.1.1.2" xref="S3.Ex4X.3.2.2.m1.1.1.1.1.1.2.cmml">𝐋</mi><mn id="S3.Ex4X.3.2.2.m1.1.1.1.1.1.3" xref="S3.Ex4X.3.2.2.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex4X.3.2.2.m1.2.2.2.2.3" xref="S3.Ex4X.3.2.2.m1.2.2.2.3.cmml">,</mo><msub id="S3.Ex4X.3.2.2.m1.2.2.2.2.2" xref="S3.Ex4X.3.2.2.m1.2.2.2.2.2.cmml"><mi id="S3.Ex4X.3.2.2.m1.2.2.2.2.2.2" xref="S3.Ex4X.3.2.2.m1.2.2.2.2.2.2.cmml">𝐋</mi><mn id="S3.Ex4X.3.2.2.m1.2.2.2.2.2.3" xref="S3.Ex4X.3.2.2.m1.2.2.2.2.2.3.cmml">2</mn></msub></mrow></munder><mo id="S3.Ex4X.3.2.2.m1.3.3.1a" xref="S3.Ex4X.3.2.2.m1.3.3.1.cmml">⁡</mo><msubsup id="S3.Ex4X.3.2.2.m1.3.3.1.1" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><msqrt id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.cmml">𝐅</mi></msqrt><mo lspace="0.222em" rspace="0.222em" id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">𝐄</mi><mo id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msub id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.3.cmml">F</mi><mn id="S3.Ex4X.3.2.2.m1.3.3.1.1.3" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4X.3.2.2.m1.3b"><apply id="S3.Ex4X.3.2.2.m1.3.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3"><eq id="S3.Ex4X.3.2.2.m1.3.3.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.2"></eq><csymbol cd="latexml" id="S3.Ex4X.3.2.2.m1.3.3.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.3">absent</csymbol><apply id="S3.Ex4X.3.2.2.m1.3.3.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1"><apply id="S3.Ex4X.3.2.2.m1.3.3.1.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.Ex4X.3.2.2.m1.3.3.1.2.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.2">subscript</csymbol><apply id="S3.Ex4X.3.2.2.m1.3.3.1.2.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.2.2"><times id="S3.Ex4X.3.2.2.m1.3.3.1.2.2.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.2.2.1"></times><ci id="S3.Ex4X.3.2.2.m1.3.3.1.2.2.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.2.2.2">arg</ci><ci id="S3.Ex4X.3.2.2.m1.3.3.1.2.2.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.2.2.3">min</ci></apply><list id="S3.Ex4X.3.2.2.m1.2.2.2.3.cmml" xref="S3.Ex4X.3.2.2.m1.2.2.2.2"><apply id="S3.Ex4X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.Ex4X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex4X.3.2.2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex4X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.Ex4X.3.2.2.m1.1.1.1.1.1.2">𝐋</ci><cn type="integer" id="S3.Ex4X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.Ex4X.3.2.2.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex4X.3.2.2.m1.2.2.2.2.2.cmml" xref="S3.Ex4X.3.2.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex4X.3.2.2.m1.2.2.2.2.2.1.cmml" xref="S3.Ex4X.3.2.2.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex4X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S3.Ex4X.3.2.2.m1.2.2.2.2.2.2">𝐋</ci><cn type="integer" id="S3.Ex4X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S3.Ex4X.3.2.2.m1.2.2.2.2.2.3">2</cn></apply></list></apply><apply id="S3.Ex4X.3.2.2.m1.3.3.1.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.Ex4X.3.2.2.m1.3.3.1.1.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1">superscript</csymbol><apply id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1">subscript</csymbol><apply id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.2">norm</csymbol><apply id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3"><root id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3a.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3"></root><ci id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.3.2">𝐅</ci></apply><apply id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1"><minus id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝐄</ci><apply id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn type="integer" id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn type="integer" id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><ci id="S3.Ex4X.3.2.2.m1.3.3.1.1.1.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.1.3">𝐹</ci></apply><cn type="integer" id="S3.Ex4X.3.2.2.m1.3.3.1.1.3.cmml" xref="S3.Ex4X.3.2.2.m1.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4X.3.2.2.m1.3c">\displaystyle=\operatornamewithlimits{arg\,min}_{\mathbf{L}_{1},\mathbf{L}_{2}}\;\left\|\sqrt{\mathbf{F}}\odot\left(\mathbf{E}-\mathbf{L}_{1}\mathbf{L}_{2}\right)\right\|_{F}^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4X.3.2.2.m1.3d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ square-root start_ARG bold_F end_ARG ⊙ ( bold_E - bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex4X.5.1.1.m1.3" class="ltx_Math" alttext="\displaystyle=\operatornamewithlimits{arg\,min}_{\mathbf{L}_{1},\mathbf{L}_{2}}\;\left\|\mathbf{D}_{\text{row}}\left(\mathbf{E}-\mathbf{L}_{1}\mathbf{L}_{2}\right)\mathbf{D}_{\text{col}}\right\|_{F}^{2}," display="inline"><semantics id="S3.Ex4X.5.1.1.m1.3a"><mrow id="S3.Ex4X.5.1.1.m1.3.3.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.cmml"><mrow id="S3.Ex4X.5.1.1.m1.3.3.1.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.cmml"><mi id="S3.Ex4X.5.1.1.m1.3.3.1.1.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.3.cmml"></mi><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.Ex4X.5.1.1.m1.3.3.1.1.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.cmml"><munder id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.cmml"><mrow id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.cmml"><mi id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.2.cmml">arg</mi><mo lspace="0.170em" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.1.cmml" rspace="0px"></mo><mi id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.3.cmml">min</mi></mrow><mrow id="S3.Ex4X.5.1.1.m1.2.2.2.2" xref="S3.Ex4X.5.1.1.m1.2.2.2.3.cmml"><msub id="S3.Ex4X.5.1.1.m1.1.1.1.1.1" xref="S3.Ex4X.5.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.Ex4X.5.1.1.m1.1.1.1.1.1.2" xref="S3.Ex4X.5.1.1.m1.1.1.1.1.1.2.cmml">𝐋</mi><mn id="S3.Ex4X.5.1.1.m1.1.1.1.1.1.3" xref="S3.Ex4X.5.1.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex4X.5.1.1.m1.2.2.2.2.3" xref="S3.Ex4X.5.1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.Ex4X.5.1.1.m1.2.2.2.2.2" xref="S3.Ex4X.5.1.1.m1.2.2.2.2.2.cmml"><mi id="S3.Ex4X.5.1.1.m1.2.2.2.2.2.2" xref="S3.Ex4X.5.1.1.m1.2.2.2.2.2.2.cmml">𝐋</mi><mn id="S3.Ex4X.5.1.1.m1.2.2.2.2.2.3" xref="S3.Ex4X.5.1.1.m1.2.2.2.2.2.3.cmml">2</mn></msub></mrow></munder><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.1a" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.cmml">⁡</mo><msubsup id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.cmml"><mrow id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">𝐃</mi><mtext id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3a.cmml">row</mtext></msub><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐄</mi><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msub id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.2a" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><msub id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml">𝐃</mi><mtext id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3a.cmml">col</mtext></msub></mrow><mo id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.3.cmml">F</mi><mn id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.3" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.Ex4X.5.1.1.m1.3.3.1.2" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4X.5.1.1.m1.3b"><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1"><eq id="S3.Ex4X.5.1.1.m1.3.3.1.1.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.Ex4X.5.1.1.m1.3.3.1.1.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.3">absent</csymbol><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1"><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2">subscript</csymbol><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2"><times id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.1"></times><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.2">arg</ci><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.2.2.3">min</ci></apply><list id="S3.Ex4X.5.1.1.m1.2.2.2.3.cmml" xref="S3.Ex4X.5.1.1.m1.2.2.2.2"><apply id="S3.Ex4X.5.1.1.m1.1.1.1.1.1.cmml" xref="S3.Ex4X.5.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4X.5.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex4X.5.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex4X.5.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex4X.5.1.1.m1.1.1.1.1.1.2">𝐋</ci><cn type="integer" id="S3.Ex4X.5.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.Ex4X.5.1.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex4X.5.1.1.m1.2.2.2.2.2.cmml" xref="S3.Ex4X.5.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex4X.5.1.1.m1.2.2.2.2.2.1.cmml" xref="S3.Ex4X.5.1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex4X.5.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.Ex4X.5.1.1.m1.2.2.2.2.2.2">𝐋</ci><cn type="integer" id="S3.Ex4X.5.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.Ex4X.5.1.1.m1.2.2.2.2.2.3">2</cn></apply></list></apply><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1">superscript</csymbol><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1">subscript</csymbol><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1"><times id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝐃</ci><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3">row</mtext></ci></apply><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><minus id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝐄</ci><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn type="integer" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn type="integer" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.2">𝐃</ci><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3a.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3"><mtext mathsize="70%" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3">col</mtext></ci></apply></apply></apply><ci id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.1.3">𝐹</ci></apply><cn type="integer" id="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.Ex4X.5.1.1.m1.3.3.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4X.5.1.1.m1.3c">\displaystyle=\operatornamewithlimits{arg\,min}_{\mathbf{L}_{1},\mathbf{L}_{2}}\;\left\|\mathbf{D}_{\text{row}}\left(\mathbf{E}-\mathbf{L}_{1}\mathbf{L}_{2}\right)\mathbf{D}_{\text{col}}\right\|_{F}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4X.5.1.1.m1.3d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_D start_POSTSUBSCRIPT row end_POSTSUBSCRIPT ( bold_E - bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) bold_D start_POSTSUBSCRIPT col end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.16">여기서, <math alttext="\mathbf{D}_{\text{row}}" class="ltx_Math" display="inline" id="S3.SS3.p1.13.m1.1"><semantics id="S3.SS3.p1.13.m1.1a"><msub id="S3.SS3.p1.13.m1.1.1" xref="S3.SS3.p1.13.m1.1.1.cmml"><mi id="S3.SS3.p1.13.m1.1.1.2" xref="S3.SS3.p1.13.m1.1.1.2.cmml">𝐃</mi><mtext id="S3.SS3.p1.13.m1.1.1.3" xref="S3.SS3.p1.13.m1.1.1.3a.cmml">row</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m1.1b"><apply id="S3.SS3.p1.13.m1.1.1.cmml" xref="S3.SS3.p1.13.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m1.1.1.1.cmml" xref="S3.SS3.p1.13.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.13.m1.1.1.2.cmml" xref="S3.SS3.p1.13.m1.1.1.2">𝐃</ci><ci id="S3.SS3.p1.13.m1.1.1.3a.cmml" xref="S3.SS3.p1.13.m1.1.1.3"><mtext id="S3.SS3.p1.13.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p1.13.m1.1.1.3">row</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m1.1c">\mathbf{D}_{\text{row}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.13.m1.1d">bold_D start_POSTSUBSCRIPT row end_POSTSUBSCRIPT</annotation></semantics></math>는 대각 행렬이 <math alttext="\sqrt{\mathbf{F}}" class="ltx_Math" display="inline" id="S3.SS3.p1.14.m2.1"><semantics id="S3.SS3.p1.14.m2.1a"><msqrt id="S3.SS3.p1.14.m2.1.1" xref="S3.SS3.p1.14.m2.1.1.cmml"><mi id="S3.SS3.p1.14.m2.1.1.2" xref="S3.SS3.p1.14.m2.1.1.2.cmml">𝐅</mi></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m2.1b"><apply id="S3.SS3.p1.14.m2.1.1.cmml" xref="S3.SS3.p1.14.m2.1.1"><root id="S3.SS3.p1.14.m2.1.1a.cmml" xref="S3.SS3.p1.14.m2.1.1"></root><ci id="S3.SS3.p1.14.m2.1.1.2.cmml" xref="S3.SS3.p1.14.m2.1.1.2">𝐅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m2.1c">\sqrt{\mathbf{F}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.14.m2.1d">square-root start_ARG bold_F end_ARG</annotation></semantics></math>의 행-수단으로 구성되고, <math alttext="\mathbf{D}_{\text{col}}" class="ltx_Math" display="inline" id="S3.SS3.p1.15.m3.1"><semantics id="S3.SS3.p1.15.m3.1a"><msub id="S3.SS3.p1.15.m3.1.1" xref="S3.SS3.p1.15.m3.1.1.cmml"><mi id="S3.SS3.p1.15.m3.1.1.2" xref="S3.SS3.p1.15.m3.1.1.2.cmml">𝐃</mi><mtext id="S3.SS3.p1.15.m3.1.1.3" xref="S3.SS3.p1.15.m3.1.1.3a.cmml">col</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m3.1b"><apply id="S3.SS3.p1.15.m3.1.1.cmml" xref="S3.SS3.p1.15.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m3.1.1.1.cmml" xref="S3.SS3.p1.15.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.15.m3.1.1.2.cmml" xref="S3.SS3.p1.15.m3.1.1.2">𝐃</ci><ci id="S3.SS3.p1.15.m3.1.1.3a.cmml" xref="S3.SS3.p1.15.m3.1.1.3"><mtext id="S3.SS3.p1.15.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p1.15.m3.1.1.3">col</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m3.1c">\mathbf{D}_{\text{col}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.15.m3.1d">bold_D start_POSTSUBSCRIPT col end_POSTSUBSCRIPT</annotation></semantics></math>는 <math alttext="\sqrt{\mathbf{F}}" class="ltx_Math" display="inline" id="S3.SS3.p1.16.m4.1"><semantics id="S3.SS3.p1.16.m4.1a"><msqrt id="S3.SS3.p1.16.m4.1.1" xref="S3.SS3.p1.16.m4.1.1.cmml"><mi id="S3.SS3.p1.16.m4.1.1.2" xref="S3.SS3.p1.16.m4.1.1.2.cmml">𝐅</mi></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m4.1b"><apply id="S3.SS3.p1.16.m4.1.1.cmml" xref="S3.SS3.p1.16.m4.1.1"><root id="S3.SS3.p1.16.m4.1.1a.cmml" xref="S3.SS3.p1.16.m4.1.1"></root><ci id="S3.SS3.p1.16.m4.1.1.2.cmml" xref="S3.SS3.p1.16.m4.1.1.2">𝐅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m4.1c">\sqrt{\mathbf{F}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.16.m4.1d">square-root start_ARG bold_F end_ARG</annotation></semantics></math>의 열-수단으로 구성된 대각 행렬, 즉,</p>
<table id="S3.Ex5" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S3.Ex5X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex5X.2.1.1.m1.17" class="ltx_Math" alttext="\displaystyle\mathbf{D}_{\text{row}}{=}\operatorname{diag}\left(\left[\operatorname{avg}(\sqrt{\mathbf{F}_{1,\cdot}}),\dots,\operatorname{avg}(\sqrt{\mathbf{F}_{d,\cdot}})\right]\right),\mathbf{D}_{\text{col}}{=}\operatorname{diag}\left(\left[\operatorname{avg}(\sqrt{\mathbf{F}_{\cdot,1}}),\dots,\operatorname{avg}(\sqrt{\mathbf{F}_{\cdot,k}})\right]\right)." display="inline"><semantics id="S3.Ex5X.2.1.1.m1.17a"><mrow id="S3.Ex5X.2.1.1.m1.17.17.1"><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.3.cmml"><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.cmml"><msub id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.cmml"><mi id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.2.cmml">𝐃</mi><mtext id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.3" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.3a.cmml">row</mtext></msub><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.2.cmml"><mi id="S3.Ex5X.2.1.1.m1.12.12" xref="S3.Ex5X.2.1.1.m1.12.12.cmml">diag</mi><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1a" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.2.cmml"><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.3.cmml">[</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex5X.2.1.1.m1.9.9" xref="S3.Ex5X.2.1.1.m1.9.9.cmml">avg</mi><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.2a" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msqrt id="S3.Ex5X.2.1.1.m1.2.2" xref="S3.Ex5X.2.1.1.m1.2.2.cmml"><msub id="S3.Ex5X.2.1.1.m1.2.2.2" xref="S3.Ex5X.2.1.1.m1.2.2.2.cmml"><mi id="S3.Ex5X.2.1.1.m1.2.2.2.4" xref="S3.Ex5X.2.1.1.m1.2.2.2.4.cmml">𝐅</mi><mrow id="S3.Ex5X.2.1.1.m1.2.2.2.2.2.4" xref="S3.Ex5X.2.1.1.m1.2.2.2.2.2.3.cmml"><mn id="S3.Ex5X.2.1.1.m1.1.1.1.1.1.1" xref="S3.Ex5X.2.1.1.m1.1.1.1.1.1.1.cmml">1</mn><mo rspace="0em" id="S3.Ex5X.2.1.1.m1.2.2.2.2.2.4.1" xref="S3.Ex5X.2.1.1.m1.2.2.2.2.2.3.cmml">,</mo><mo lspace="0em" id="S3.Ex5X.2.1.1.m1.2.2.2.2.2.2" xref="S3.Ex5X.2.1.1.m1.2.2.2.2.2.2.cmml">⋅</mo></mrow></msub></msqrt><mo stretchy="false" id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.2.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.4" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S3.Ex5X.2.1.1.m1.11.11" xref="S3.Ex5X.2.1.1.m1.11.11.cmml">…</mi><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.5" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.3.cmml">,</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.1.cmml"><mi id="S3.Ex5X.2.1.1.m1.10.10" xref="S3.Ex5X.2.1.1.m1.10.10.cmml">avg</mi><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.2a" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.1.cmml">⁡</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.1.cmml"><mo stretchy="false" id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.1.cmml">(</mo><msqrt id="S3.Ex5X.2.1.1.m1.4.4" xref="S3.Ex5X.2.1.1.m1.4.4.cmml"><msub id="S3.Ex5X.2.1.1.m1.4.4.2" xref="S3.Ex5X.2.1.1.m1.4.4.2.cmml"><mi id="S3.Ex5X.2.1.1.m1.4.4.2.4" xref="S3.Ex5X.2.1.1.m1.4.4.2.4.cmml">𝐅</mi><mrow id="S3.Ex5X.2.1.1.m1.4.4.2.2.2.4" xref="S3.Ex5X.2.1.1.m1.4.4.2.2.2.3.cmml"><mi id="S3.Ex5X.2.1.1.m1.3.3.1.1.1.1" xref="S3.Ex5X.2.1.1.m1.3.3.1.1.1.1.cmml">d</mi><mo rspace="0em" id="S3.Ex5X.2.1.1.m1.4.4.2.2.2.4.1" xref="S3.Ex5X.2.1.1.m1.4.4.2.2.2.3.cmml">,</mo><mo lspace="0em" id="S3.Ex5X.2.1.1.m1.4.4.2.2.2.2" xref="S3.Ex5X.2.1.1.m1.4.4.2.2.2.2.cmml">⋅</mo></mrow></msub></msqrt><mo stretchy="false" id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.2.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.6" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.3" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.3" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.3a.cmml">,</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.cmml"><msub id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.cmml"><mi id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.2.cmml">𝐃</mi><mtext id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.3" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.3a.cmml">col</mtext></msub><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.2.cmml">=</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.2.cmml"><mi id="S3.Ex5X.2.1.1.m1.16.16" xref="S3.Ex5X.2.1.1.m1.16.16.cmml">diag</mi><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1a" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.2.cmml">⁡</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.2.cmml"><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.2.cmml">(</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.3.cmml"><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.3" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.3.cmml">[</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex5X.2.1.1.m1.13.13" xref="S3.Ex5X.2.1.1.m1.13.13.cmml">avg</mi><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.2a" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.2.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.2.1.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msqrt id="S3.Ex5X.2.1.1.m1.6.6" xref="S3.Ex5X.2.1.1.m1.6.6.cmml"><msub id="S3.Ex5X.2.1.1.m1.6.6.2" xref="S3.Ex5X.2.1.1.m1.6.6.2.cmml"><mi id="S3.Ex5X.2.1.1.m1.6.6.2.4" xref="S3.Ex5X.2.1.1.m1.6.6.2.4.cmml">𝐅</mi><mrow id="S3.Ex5X.2.1.1.m1.6.6.2.2.2.4" xref="S3.Ex5X.2.1.1.m1.6.6.2.2.2.3.cmml"><mo rspace="0em" id="S3.Ex5X.2.1.1.m1.5.5.1.1.1.1" xref="S3.Ex5X.2.1.1.m1.5.5.1.1.1.1.cmml">⋅</mo><mo id="S3.Ex5X.2.1.1.m1.6.6.2.2.2.4.1" xref="S3.Ex5X.2.1.1.m1.6.6.2.2.2.3.cmml">,</mo><mn id="S3.Ex5X.2.1.1.m1.6.6.2.2.2.2" xref="S3.Ex5X.2.1.1.m1.6.6.2.2.2.2.cmml">1</mn></mrow></msub></msqrt><mo stretchy="false" id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.2.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.4" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S3.Ex5X.2.1.1.m1.15.15" xref="S3.Ex5X.2.1.1.m1.15.15.cmml">…</mi><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.5" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.3.cmml">,</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.1.cmml"><mi id="S3.Ex5X.2.1.1.m1.14.14" xref="S3.Ex5X.2.1.1.m1.14.14.cmml">avg</mi><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.2a" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.1.cmml">⁡</mo><mrow id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.2.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.1.cmml"><mo stretchy="false" id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.2.1.1" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.1.cmml">(</mo><msqrt id="S3.Ex5X.2.1.1.m1.8.8" xref="S3.Ex5X.2.1.1.m1.8.8.cmml"><msub id="S3.Ex5X.2.1.1.m1.8.8.2" xref="S3.Ex5X.2.1.1.m1.8.8.2.cmml"><mi id="S3.Ex5X.2.1.1.m1.8.8.2.4" xref="S3.Ex5X.2.1.1.m1.8.8.2.4.cmml">𝐅</mi><mrow id="S3.Ex5X.2.1.1.m1.8.8.2.2.2.4" xref="S3.Ex5X.2.1.1.m1.8.8.2.2.2.3.cmml"><mo rspace="0em" id="S3.Ex5X.2.1.1.m1.7.7.1.1.1.1" xref="S3.Ex5X.2.1.1.m1.7.7.1.1.1.1.cmml">⋅</mo><mo id="S3.Ex5X.2.1.1.m1.8.8.2.2.2.4.1" xref="S3.Ex5X.2.1.1.m1.8.8.2.2.2.3.cmml">,</mo><mi id="S3.Ex5X.2.1.1.m1.8.8.2.2.2.2" xref="S3.Ex5X.2.1.1.m1.8.8.2.2.2.2.cmml">k</mi></mrow></msub></msqrt><mo stretchy="false" id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.2.1.2" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.6" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.3" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex5X.2.1.1.m1.17.17.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5X.2.1.1.m1.17b"><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.3.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5X.2.1.1.m1.17.17.1.1.3a.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1"><eq id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.2.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.2"></eq><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.1.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.2.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.2">𝐃</ci><ci id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.3a.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.3.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.3.3">row</mtext></ci></apply><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.2.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1"><ci id="S3.Ex5X.2.1.1.m1.12.12.cmml" xref="S3.Ex5X.2.1.1.m1.12.12">diag</ci><list id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2"><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.Ex5X.2.1.1.m1.9.9.cmml" xref="S3.Ex5X.2.1.1.m1.9.9">avg</ci><apply id="S3.Ex5X.2.1.1.m1.2.2.cmml" xref="S3.Ex5X.2.1.1.m1.2.2"><root id="S3.Ex5X.2.1.1.m1.2.2a.cmml" xref="S3.Ex5X.2.1.1.m1.2.2"></root><apply id="S3.Ex5X.2.1.1.m1.2.2.2.cmml" xref="S3.Ex5X.2.1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex5X.2.1.1.m1.2.2.2.3.cmml" xref="S3.Ex5X.2.1.1.m1.2.2.2">subscript</csymbol><ci id="S3.Ex5X.2.1.1.m1.2.2.2.4.cmml" xref="S3.Ex5X.2.1.1.m1.2.2.2.4">𝐅</ci><list id="S3.Ex5X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.Ex5X.2.1.1.m1.2.2.2.2.2.4"><cn type="integer" id="S3.Ex5X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex5X.2.1.1.m1.1.1.1.1.1.1">1</cn><ci id="S3.Ex5X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.Ex5X.2.1.1.m1.2.2.2.2.2.2">⋅</ci></list></apply></apply></apply><ci id="S3.Ex5X.2.1.1.m1.11.11.cmml" xref="S3.Ex5X.2.1.1.m1.11.11">…</ci><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.1.1.1.1.1.1.2.2.2"><ci id="S3.Ex5X.2.1.1.m1.10.10.cmml" xref="S3.Ex5X.2.1.1.m1.10.10">avg</ci><apply id="S3.Ex5X.2.1.1.m1.4.4.cmml" xref="S3.Ex5X.2.1.1.m1.4.4"><root id="S3.Ex5X.2.1.1.m1.4.4a.cmml" xref="S3.Ex5X.2.1.1.m1.4.4"></root><apply id="S3.Ex5X.2.1.1.m1.4.4.2.cmml" xref="S3.Ex5X.2.1.1.m1.4.4.2"><csymbol cd="ambiguous" id="S3.Ex5X.2.1.1.m1.4.4.2.3.cmml" xref="S3.Ex5X.2.1.1.m1.4.4.2">subscript</csymbol><ci id="S3.Ex5X.2.1.1.m1.4.4.2.4.cmml" xref="S3.Ex5X.2.1.1.m1.4.4.2.4">𝐅</ci><list id="S3.Ex5X.2.1.1.m1.4.4.2.2.2.3.cmml" xref="S3.Ex5X.2.1.1.m1.4.4.2.2.2.4"><ci id="S3.Ex5X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.Ex5X.2.1.1.m1.3.3.1.1.1.1">𝑑</ci><ci id="S3.Ex5X.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S3.Ex5X.2.1.1.m1.4.4.2.2.2.2">⋅</ci></list></apply></apply></apply></list></apply></apply><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2"><eq id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.2.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.2"></eq><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.1.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3">subscript</csymbol><ci id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.2.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.2">𝐃</ci><ci id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.3a.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.3"><mtext mathsize="70%" id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.3.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.3.3">col</mtext></ci></apply><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.2.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1"><ci id="S3.Ex5X.2.1.1.m1.16.16.cmml" xref="S3.Ex5X.2.1.1.m1.16.16">diag</ci><list id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.3.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2"><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.1.1.2"><ci id="S3.Ex5X.2.1.1.m1.13.13.cmml" xref="S3.Ex5X.2.1.1.m1.13.13">avg</ci><apply id="S3.Ex5X.2.1.1.m1.6.6.cmml" xref="S3.Ex5X.2.1.1.m1.6.6"><root id="S3.Ex5X.2.1.1.m1.6.6a.cmml" xref="S3.Ex5X.2.1.1.m1.6.6"></root><apply id="S3.Ex5X.2.1.1.m1.6.6.2.cmml" xref="S3.Ex5X.2.1.1.m1.6.6.2"><csymbol cd="ambiguous" id="S3.Ex5X.2.1.1.m1.6.6.2.3.cmml" xref="S3.Ex5X.2.1.1.m1.6.6.2">subscript</csymbol><ci id="S3.Ex5X.2.1.1.m1.6.6.2.4.cmml" xref="S3.Ex5X.2.1.1.m1.6.6.2.4">𝐅</ci><list id="S3.Ex5X.2.1.1.m1.6.6.2.2.2.3.cmml" xref="S3.Ex5X.2.1.1.m1.6.6.2.2.2.4"><ci id="S3.Ex5X.2.1.1.m1.5.5.1.1.1.1.cmml" xref="S3.Ex5X.2.1.1.m1.5.5.1.1.1.1">⋅</ci><cn type="integer" id="S3.Ex5X.2.1.1.m1.6.6.2.2.2.2.cmml" xref="S3.Ex5X.2.1.1.m1.6.6.2.2.2.2">1</cn></list></apply></apply></apply><ci id="S3.Ex5X.2.1.1.m1.15.15.cmml" xref="S3.Ex5X.2.1.1.m1.15.15">…</ci><apply id="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.Ex5X.2.1.1.m1.17.17.1.1.2.2.1.1.1.1.2.2.2"><ci id="S3.Ex5X.2.1.1.m1.14.14.cmml" xref="S3.Ex5X.2.1.1.m1.14.14">avg</ci><apply id="S3.Ex5X.2.1.1.m1.8.8.cmml" xref="S3.Ex5X.2.1.1.m1.8.8"><root id="S3.Ex5X.2.1.1.m1.8.8a.cmml" xref="S3.Ex5X.2.1.1.m1.8.8"></root><apply id="S3.Ex5X.2.1.1.m1.8.8.2.cmml" xref="S3.Ex5X.2.1.1.m1.8.8.2"><csymbol cd="ambiguous" id="S3.Ex5X.2.1.1.m1.8.8.2.3.cmml" xref="S3.Ex5X.2.1.1.m1.8.8.2">subscript</csymbol><ci id="S3.Ex5X.2.1.1.m1.8.8.2.4.cmml" xref="S3.Ex5X.2.1.1.m1.8.8.2.4">𝐅</ci><list id="S3.Ex5X.2.1.1.m1.8.8.2.2.2.3.cmml" xref="S3.Ex5X.2.1.1.m1.8.8.2.2.2.4"><ci id="S3.Ex5X.2.1.1.m1.7.7.1.1.1.1.cmml" xref="S3.Ex5X.2.1.1.m1.7.7.1.1.1.1">⋅</ci><ci id="S3.Ex5X.2.1.1.m1.8.8.2.2.2.2.cmml" xref="S3.Ex5X.2.1.1.m1.8.8.2.2.2.2">𝑘</ci></list></apply></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5X.2.1.1.m1.17c">\displaystyle\mathbf{D}_{\text{row}}{=}\operatorname{diag}\left(\left[\operatorname{avg}(\sqrt{\mathbf{F}_{1,\cdot}}),\dots,\operatorname{avg}(\sqrt{\mathbf{F}_{d,\cdot}})\right]\right),\mathbf{D}_{\text{col}}{=}\operatorname{diag}\left(\left[\operatorname{avg}(\sqrt{\mathbf{F}_{\cdot,1}}),\dots,\operatorname{avg}(\sqrt{\mathbf{F}_{\cdot,k}})\right]\right).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5X.2.1.1.m1.17d">bold_D start_POSTSUBSCRIPT row end_POSTSUBSCRIPT = roman_diag ( [ roman_avg ( square-root start_ARG bold_F start_POSTSUBSCRIPT 1 , ⋅ end_POSTSUBSCRIPT end_ARG ) , … , roman_avg ( square-root start_ARG bold_F start_POSTSUBSCRIPT italic_d , ⋅ end_POSTSUBSCRIPT end_ARG ) ] ) , bold_D start_POSTSUBSCRIPT col end_POSTSUBSCRIPT = roman_diag ( [ roman_avg ( square-root start_ARG bold_F start_POSTSUBSCRIPT ⋅ , 1 end_POSTSUBSCRIPT end_ARG ) , … , roman_avg ( square-root start_ARG bold_F start_POSTSUBSCRIPT ⋅ , italic_k end_POSTSUBSCRIPT end_ARG ) ] ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.20">이 경우, 상기 문제는 표준 SVD에 의해 정확하게 해결될 수 있고,</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\mathbf{U},\mathbf{\Sigma},\mathbf{V}^{\top}\leftarrow\operatorname{SVD}(\mathbf{D}_{\text{row}}\mathbf{A}\mathbf{D}_{\text{col}}),\,\,\,\,\," display="inline"><semantics id="S3.E5X.2.1.1.m1.4a"><mrow id="S3.E5X.2.1.1.m1.4.4.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E5X.2.1.1.m1.4.4.1.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E5X.2.1.1.m1.4.4.1.1.1.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.2.cmml"><mi id="S3.E5X.2.1.1.m1.2.2" xref="S3.E5X.2.1.1.m1.2.2.cmml">𝐔</mi><mo id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.2" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.2.cmml">,</mo><mi id="S3.E5X.2.1.1.m1.3.3" xref="S3.E5X.2.1.1.m1.3.3.cmml">𝚺</mi><mo id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.2.cmml">,</mo><msup id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.2" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">𝐕</mi><mo id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.3" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.3.cmml">⊤</mo></msup></mrow><mo stretchy="false" id="S3.E5X.2.1.1.m1.4.4.1.1.3" xref="S3.E5X.2.1.1.m1.4.4.1.1.3.cmml">←</mo><mrow id="S3.E5X.2.1.1.m1.4.4.1.1.2.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.2.cmml"><mi id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml">SVD</mi><mo id="S3.E5X.2.1.1.m1.4.4.1.1.2.1a" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.2.cmml">⁡</mo><mrow id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.2.cmml"><mo stretchy="false" id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.2" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.2.cmml">(</mo><mrow id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.cmml"><msub id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.cmml"><mi id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.2" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.2.cmml">𝐃</mi><mtext id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.3" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.3a.cmml">row</mtext></msub><mo id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.1" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.1.cmml" lspace="0px" rspace="0px"></mo><msub id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.cmml"><mi id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.2" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.2.cmml">𝐀𝐃</mi><mtext id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.3" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.3a.cmml">col</mtext></msub></mrow><mo stretchy="false" id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.3" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5X.2.1.1.m1.4.4.1.2" xref="S3.E5X.2.1.1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.4b"><apply id="S3.E5X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1"><ci id="S3.E5X.2.1.1.m1.4.4.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.3">←</ci><list id="S3.E5X.2.1.1.m1.4.4.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1"><ci id="S3.E5X.2.1.1.m1.2.2.cmml" xref="S3.E5X.2.1.1.m1.2.2">𝐔</ci><ci id="S3.E5X.2.1.1.m1.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3">𝚺</ci><apply id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1">superscript</csymbol><ci id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.2">𝐕</ci><csymbol cd="latexml" id="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.1.1.1.3">top</csymbol></apply></list><apply id="S3.E5X.2.1.1.m1.4.4.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1"><ci id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1">SVD</ci><apply id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1"><times id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.1"></times><apply id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.2">𝐃</ci><ci id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.3a.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.3"><mtext mathsize="70%" id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.3.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.2.3">row</mtext></ci></apply><apply id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.1.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.2.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.2">𝐀𝐃</ci><ci id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.3a.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.3"><mtext mathsize="70%" id="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.3.cmml" xref="S3.E5X.2.1.1.m1.4.4.1.1.2.1.1.1.3.3">col</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.4c">\displaystyle\mathbf{U},\mathbf{\Sigma},\mathbf{V}^{\top}\leftarrow\operatorname{SVD}(\mathbf{D}_{\text{row}}\mathbf{A}\mathbf{D}_{\text{col}}),\,\,\,\,\,</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.2.1.1.m1.4d">bold_U , bold_Σ , bold_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ← roman_SVD ( bold_D start_POSTSUBSCRIPT row end_POSTSUBSCRIPT bold_AD start_POSTSUBSCRIPT col end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{L}_{1}\leftarrow\mathbf{D}_{\text{row}}^{-1}\mathbf{U}\sqrt{\mathbf{\Sigma}}," display="inline"><semantics id="S3.E5X.3.2.2.m1.1a"><mrow id="S3.E5X.3.2.2.m1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml"><msub id="S3.E5X.3.2.2.m1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2.cmml">𝐋</mi><mn id="S3.E5X.3.2.2.m1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.3.cmml">1</mn></msub><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml">←</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.cmml"><msubsup id="S3.E5X.3.2.2.m1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.2.cmml">𝐃</mi><mtext id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.3a.cmml">row</mtext><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3.cmml"><mo id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3a" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3.cmml">−</mo><mn id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3.2.cmml">1</mn></mrow></msubsup><mo id="S3.E5X.3.2.2.m1.1.1.1.1.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.3.cmml">𝐔</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.3.1a" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msqrt id="S3.E5X.3.2.2.m1.1.1.1.1.3.4" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.4.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.3.4.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.4.2.cmml">𝚺</mi></msqrt></mrow></mrow><mo id="S3.E5X.3.2.2.m1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.1b"><apply id="S3.E5X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1"><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1">←</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.2">𝐋</ci><cn type="integer" id="S3.E5X.3.2.2.m1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3"><times id="S3.E5X.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.1"></times><apply id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.2">𝐃</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.3a.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.3"><mtext mathsize="70%" id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.2.3">row</mtext></ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3"><minus id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3"></minus><cn type="integer" id="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.2.3.2">1</cn></apply></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.3">𝐔</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.1.3.4.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.4"><root id="S3.E5X.3.2.2.m1.1.1.1.1.3.4a.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.4"></root><ci id="S3.E5X.3.2.2.m1.1.1.1.1.3.4.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.4.2">𝚺</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.1c">\displaystyle\mathbf{L}_{1}\leftarrow\mathbf{D}_{\text{row}}^{-1}\mathbf{U}\sqrt{\mathbf{\Sigma}},</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.3.2.2.m1.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ← bold_D start_POSTSUBSCRIPT row end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_U square-root start_ARG bold_Σ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.5.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\,\,\,\,\,\mathbf{L}_{2}\leftarrow\sqrt{\mathbf{\Sigma}}\mathbf{V}^{\top}\mathbf{D}_{\text{col}}^{-1}." display="inline"><semantics id="S3.E5X.5.1.1.m1.1a"><mrow id="S3.E5X.5.1.1.m1.1.1.1" xref="S3.E5X.5.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E5X.5.1.1.m1.1.1.1.1" xref="S3.E5X.5.1.1.m1.1.1.1.1.cmml"><msub id="S3.E5X.5.1.1.m1.1.1.1.1.2" xref="S3.E5X.5.1.1.m1.1.1.1.1.2.cmml"><mi id="S3.E5X.5.1.1.m1.1.1.1.1.2.2" xref="S3.E5X.5.1.1.m1.1.1.1.1.2.2.cmml">𝐋</mi><mn id="S3.E5X.5.1.1.m1.1.1.1.1.2.3" xref="S3.E5X.5.1.1.m1.1.1.1.1.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.E5X.5.1.1.m1.1.1.1.1.1" xref="S3.E5X.5.1.1.m1.1.1.1.1.1.cmml">←</mo><mrow id="S3.E5X.5.1.1.m1.1.1.1.1.3" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.cmml"><msqrt id="S3.E5X.5.1.1.m1.1.1.1.1.3.2" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.2.cmml"><mi id="S3.E5X.5.1.1.m1.1.1.1.1.3.2.2" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.2.2.cmml">𝚺</mi></msqrt><mo id="S3.E5X.5.1.1.m1.1.1.1.1.3.1" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msup id="S3.E5X.5.1.1.m1.1.1.1.1.3.3" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5X.5.1.1.m1.1.1.1.1.3.3.2" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.3.2.cmml">𝐕</mi><mo id="S3.E5X.5.1.1.m1.1.1.1.1.3.3.3" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.3.3.cmml">⊤</mo></msup><mo id="S3.E5X.5.1.1.m1.1.1.1.1.3.1a" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><msubsup id="S3.E5X.5.1.1.m1.1.1.1.1.3.4" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.cmml"><mi id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.2" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.2.cmml">𝐃</mi><mtext id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.3" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.3a.cmml">col</mtext><mrow id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3.cmml"><mo id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3a" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3.cmml">−</mo><mn id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3.2" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3.2.cmml">1</mn></mrow></msubsup></mrow></mrow><mo lspace="0em" id="S3.E5X.5.1.1.m1.1.1.1.2" xref="S3.E5X.5.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.5.1.1.m1.1b"><apply id="S3.E5X.5.1.1.m1.1.1.1.1.cmml" xref="S3.E5X.5.1.1.m1.1.1.1"><ci id="S3.E5X.5.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.1">←</ci><apply id="S3.E5X.5.1.1.m1.1.1.1.1.2.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.5.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5X.5.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.2.2">𝐋</ci><cn type="integer" id="S3.E5X.5.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.2.3">2</cn></apply><apply id="S3.E5X.5.1.1.m1.1.1.1.1.3.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3"><times id="S3.E5X.5.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.1"></times><apply id="S3.E5X.5.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.2"><root id="S3.E5X.5.1.1.m1.1.1.1.1.3.2a.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.2"></root><ci id="S3.E5X.5.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.2.2">𝚺</ci></apply><apply id="S3.E5X.5.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5X.5.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E5X.5.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.3.2">𝐕</ci><csymbol cd="latexml" id="S3.E5X.5.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.3.3">top</csymbol></apply><apply id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.1.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4">superscript</csymbol><apply id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.1.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.2.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.2">𝐃</ci><ci id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.3a.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.3"><mtext mathsize="70%" id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.3.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.2.3">col</mtext></ci></apply><apply id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3"><minus id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3"></minus><cn type="integer" id="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E5X.5.1.1.m1.1.1.1.1.3.4.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.5.1.1.m1.1c">\displaystyle\,\,\,\,\,\mathbf{L}_{2}\leftarrow\sqrt{\mathbf{\Sigma}}\mathbf{V}^{\top}\mathbf{D}_{\text{col}}^{-1}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.5.1.1.m1.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ← square-root start_ARG bold_Σ end_ARG bold_V start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_D start_POSTSUBSCRIPT col end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.19">(알고리즘 <a class="ltx_ref" href="#alg4" title="Algorithm 4 ‣ 3.2 Mixed-Configuration Quantization via an Integer Linear Program ‣ 3 Method: LQ-LoRA ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">4</span></a> 참조.) 동일한 행/열 가정이 <math alttext="\mathbf{F}" class="ltx_Math" display="inline" id="S3.SS3.p1.17.m1.1"><semantics id="S3.SS3.p1.17.m1.1a"><mi id="S3.SS3.p1.17.m1.1.1" xref="S3.SS3.p1.17.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.17.m1.1b"><ci id="S3.SS3.p1.17.m1.1.1.cmml" xref="S3.SS3.p1.17.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.17.m1.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.17.m1.1d">bold_F</annotation></semantics></math>에 대해 분명히 성립하지 않지만, 우리는 이 접근법이 실제로 잘 작동한다는 것을 발견했다. <span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>In preliminary experiments we also explored a version of data-aware LQ-LoRA where we approximately minimized <math alttext="\|\mathbf{X}(\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2}))\|_{F}" class="ltx_Math" display="inline" id="footnote9.m1.1"><semantics id="footnote9.m1.1b"><msub id="footnote9.m1.1.1" xref="footnote9.m1.1.1.cmml"><mrow id="footnote9.m1.1.1.1.1" xref="footnote9.m1.1.1.1.2.cmml"><mo id="footnote9.m1.1.1.1.1.2" stretchy="false" xref="footnote9.m1.1.1.1.2.1.cmml">‖</mo><mrow id="footnote9.m1.1.1.1.1.1" xref="footnote9.m1.1.1.1.1.1.cmml"><mi id="footnote9.m1.1.1.1.1.1.3" xref="footnote9.m1.1.1.1.1.1.3.cmml">𝐗</mi><mo id="footnote9.m1.1.1.1.1.1.2" lspace="0px" rspace="0px" xref="footnote9.m1.1.1.1.1.1.2.cmml"></mo><mrow id="footnote9.m1.1.1.1.1.1.1.1" xref="footnote9.m1.1.1.1.1.1.1.1.1.cmml"><mo id="footnote9.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="footnote9.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="footnote9.m1.1.1.1.1.1.1.1.1" xref="footnote9.m1.1.1.1.1.1.1.1.1.cmml"><mi id="footnote9.m1.1.1.1.1.1.1.1.1.3" xref="footnote9.m1.1.1.1.1.1.1.1.1.3.cmml">𝐖</mi><mo id="footnote9.m1.1.1.1.1.1.1.1.1.2" xref="footnote9.m1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="footnote9.m1.1.1.1.1.1.1.1.1.1.1" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.1" lspace="0px" rspace="0px" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"></mo><msub id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="footnote9.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="footnote9.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="footnote9.m1.1.1.1.1.3" stretchy="false" xref="footnote9.m1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="footnote9.m1.1.1.3" xref="footnote9.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="footnote9.m1.1c"><apply id="footnote9.m1.1.1.cmml" xref="footnote9.m1.1.1"><csymbol cd="ambiguous" id="footnote9.m1.1.1.2.cmml" xref="footnote9.m1.1.1">subscript</csymbol><apply id="footnote9.m1.1.1.1.2.cmml" xref="footnote9.m1.1.1.1.1"><csymbol cd="latexml" id="footnote9.m1.1.1.1.2.1.cmml" xref="footnote9.m1.1.1.1.1.2">norm</csymbol><apply id="footnote9.m1.1.1.1.1.1.cmml" xref="footnote9.m1.1.1.1.1.1"><times id="footnote9.m1.1.1.1.1.1.2.cmml" xref="footnote9.m1.1.1.1.1.1.2"></times><ci id="footnote9.m1.1.1.1.1.1.3.cmml" xref="footnote9.m1.1.1.1.1.1.3">𝐗</ci><apply id="footnote9.m1.1.1.1.1.1.1.1.1.cmml" xref="footnote9.m1.1.1.1.1.1.1.1"><minus id="footnote9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.2"></minus><ci id="footnote9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.3">𝐖</ci><apply id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1"><plus id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝐐</ci><apply id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn id="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="footnote9.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></apply><ci id="footnote9.m1.1.1.3.cmml" xref="footnote9.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote9.m1.1d">\|\mathbf{X}(\mathbf{W}-(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2}))\|_{F}</annotation><annotation encoding="application/x-llamapun" id="footnote9.m1.1e">∥ bold_X ( bold_W - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math> using activations <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="footnote9.m2.1"><semantics id="footnote9.m2.1b"><mi id="footnote9.m2.1.1" xref="footnote9.m2.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="footnote9.m2.1c"><ci id="footnote9.m2.1.1.cmml" xref="footnote9.m2.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote9.m2.1d">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="footnote9.m2.1e">bold_X</annotation></semantics></math> from calibration data, instead the Fisher information matrix. 그러나 우리는 이것이 피셔 접근법의 성능을 저하시킨다는 것을 발견했다. </span></span></span> 우리는 이 근사치가 가중된 SVD에서 <math alttext="\mathbf{D}_{\text{row}}" class="ltx_Math" display="inline" id="S3.SS3.p1.18.m2.1"><semantics id="S3.SS3.p1.18.m2.1a"><msub id="S3.SS3.p1.18.m2.1.1" xref="S3.SS3.p1.18.m2.1.1.cmml"><mi id="S3.SS3.p1.18.m2.1.1.2" xref="S3.SS3.p1.18.m2.1.1.2.cmml">𝐃</mi><mtext id="S3.SS3.p1.18.m2.1.1.3" xref="S3.SS3.p1.18.m2.1.1.3a.cmml">row</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.18.m2.1b"><apply id="S3.SS3.p1.18.m2.1.1.cmml" xref="S3.SS3.p1.18.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.18.m2.1.1.1.cmml" xref="S3.SS3.p1.18.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.18.m2.1.1.2.cmml" xref="S3.SS3.p1.18.m2.1.1.2">𝐃</ci><ci id="S3.SS3.p1.18.m2.1.1.3a.cmml" xref="S3.SS3.p1.18.m2.1.1.3"><mtext id="S3.SS3.p1.18.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p1.18.m2.1.1.3">row</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.18.m2.1c">\mathbf{D}_{\text{row}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.18.m2.1d">bold_D start_POSTSUBSCRIPT row end_POSTSUBSCRIPT</annotation></semantics></math>를 사용하지만 <math alttext="\mathbf{D}_{\text{col}}" class="ltx_Math" display="inline" id="S3.SS3.p1.19.m3.1"><semantics id="S3.SS3.p1.19.m3.1a"><msub id="S3.SS3.p1.19.m3.1.1" xref="S3.SS3.p1.19.m3.1.1.cmml"><mi id="S3.SS3.p1.19.m3.1.1.2" xref="S3.SS3.p1.19.m3.1.1.2.cmml">𝐃</mi><mtext id="S3.SS3.p1.19.m3.1.1.3" xref="S3.SS3.p1.19.m3.1.1.3a.cmml">col</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.19.m3.1b"><apply id="S3.SS3.p1.19.m3.1.1.cmml" xref="S3.SS3.p1.19.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m3.1.1.1.cmml" xref="S3.SS3.p1.19.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.19.m3.1.1.2.cmml" xref="S3.SS3.p1.19.m3.1.1.2">𝐃</ci><ci id="S3.SS3.p1.19.m3.1.1.3a.cmml" xref="S3.SS3.p1.19.m3.1.1.3"><mtext id="S3.SS3.p1.19.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p1.19.m3.1.1.3">col</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.19.m3.1c">\mathbf{D}_{\text{col}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.19.m3.1d">bold_D start_POSTSUBSCRIPT col end_POSTSUBSCRIPT</annotation></semantics></math>를 사용하지 않는 <cite class="ltx_cite ltx_citemacro_citet">Hsu et al. (<a class="ltx_ref" href="#bib.bib18" title="">2022</a>)</cite>의 단순한 확장이라는 점에 주목한다(우리는 행-평균과 열-평균을 모두 사용하는 것이 약간 더 잘 수행됨을 발견했다).</p>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Discussion.</h4>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.3">이 LQ-LoRA의 데이터 인식 버전은 피셔 행렬 <math alttext="\{\mathbf{F}^{(i)}\}_{i\in[N]}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.1.m1.3"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.3a"><msub id="S3.SS3.SSS0.Px1.p1.1.m1.3.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.2.cmml">{</mo><msup id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.2.cmml">𝐅</mi><mrow id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.3.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.2.cmml">∈</mo><mrow id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.2.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.1.1.cmml">[</mo><mi id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.1.cmml">N</mi><mo id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.2.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.3b"><apply id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3">subscript</csymbol><set id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1"><apply id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.3.3.1.1.1.2">𝐅</ci><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.1">𝑖</ci></apply></set><apply id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1"><in id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.2"></in><ci id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.3">𝑖</ci><apply id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.2"><csymbol cd="latexml" id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.2.2.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.3c">\{\mathbf{F}^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.1.m1.3d">{ bold_F start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math>를 얻기 위해 미리 훈련된 LM을 통해 역전파할 수 있어야 하며, 이는 어떤 의미에서 완전한 미세 조정이 가능하지 않은 메모리 효율적인 적응 방법이 목표로 하는 설정에 반한다. 이것은 유효한 점이며, 따라서 우리는 경험적 연구에서 LQ-LoRA의 두 버전을 모두 연구한다. 그러나 일부 일반 텍스트 데이터를 기반으로 <math alttext="\{\mathbf{F}^{(i)}\}_{i\in[N]}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.2.m2.3"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.3a"><msub id="S3.SS3.SSS0.Px1.p1.2.m2.3.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.2.cmml">{</mo><msup id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.2.cmml">𝐅</mi><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.3.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.2.cmml">∈</mo><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.2.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.1.1.cmml">[</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.1.cmml">N</mi><mo id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.2.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.3b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3">subscript</csymbol><set id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.3.3.1.1.1.2">𝐅</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.1">𝑖</ci></apply></set><apply id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1"><in id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.2"></in><ci id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.3">𝑖</ci><apply id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.2"><csymbol cd="latexml" id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.3c">\{\mathbf{F}^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.2.m2.3d">{ bold_F start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math>를 계산하여 LQ-LoRA 초기화 <math alttext="\{\mathbf{Q}^{(i)},\mathbf{L}_{1}^{(i)},\mathbf{L}_{2}^{(i)}\}_{i\in[N]}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.3.m3.7"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.7a"><msub id="S3.SS3.SSS0.Px1.p1.3.m3.7.7" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.4.cmml"><mo id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.4" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.4.cmml">{</mo><msup id="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.2.cmml">𝐐</mi><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.5" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.4.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.2.cmml">𝐋</mi><mn id="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.3.cmml">1</mn><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.2.2.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.3.m3.2.2.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.3.m3.2.2.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.2.2.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.3.m3.2.2.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.6" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.4.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.2.cmml">𝐋</mi><mn id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.3.cmml">2</mn><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.3.3.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.cmml"><mo id="S3.SS3.SSS0.Px1.p1.3.m3.3.3.1.3.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.3.m3.3.3.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.3.3.1.1.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.3.m3.3.3.1.3.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.7" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.4.cmml">}</mo></mrow><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.3.cmml">i</mi><mo id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.2.cmml">∈</mo><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.2.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.1.1.cmml">[</mo><mi id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.1.cmml">N</mi><mo id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.2.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.1.1.cmml">]</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.7b"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.4.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7">subscript</csymbol><set id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.5.5.1.1.1.2">𝐐</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.2">𝐋</ci><cn id="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.3.m3.6.6.2.2.2.2.3">1</cn></apply><ci id="S3.SS3.SSS0.Px1.p1.3.m3.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.2.2.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.2">𝐋</ci><cn id="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.3.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.3.m3.7.7.3.3.3.2.3">2</cn></apply><ci id="S3.SS3.SSS0.Px1.p1.3.m3.3.3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.3.3.1.1">𝑖</ci></apply></set><apply id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1"><in id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.2"></in><ci id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.3">𝑖</ci><apply id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.2"><csymbol cd="latexml" id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.4.4.1.1">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.7c">\{\mathbf{Q}^{(i)},\mathbf{L}_{1}^{(i)},\mathbf{L}_{2}^{(i)}\}_{i\in[N]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.3.m3.7d">{ bold_Q start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i ∈ [ italic_N ] end_POSTSUBSCRIPT</annotation></semantics></math>를 얻고, 다른 다운스트림 작업에 대해 <em class="ltx_emph ltx_font_italic" id="S3.SS3.SSS0.Px1.p1.3.1">same</em> 초기화를 사용한다는 점에 유의한다. 이것은 피셔 계산과 행렬 분해가 (비데이터 인식 버전에서와 같이) 한 번만 수행되어야 하기 때문에 데이터 인식 접근법을 실용적으로 만든다.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Empirical Study</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.p1.1">LQ-LoRA는 (1) C4 학습 데이터에 대한 연속 언어 모델링, (2) OpenAssistant 데이터셋 <cite class="ltx_cite ltx_citemacro_citep">(Köpf et al., <a class="ltx_ref" href="#bib.bib25" title="">2023</a>)</cite>, (3) GLUE <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="#bib.bib54" title="">2018</a>)</cite>에 대한 명령어 튜닝의 세 가지 설정에 걸쳐 실험을 수행한다. (1) 및 (2)의 경우 LLaMA-2 모델 <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="#bib.bib51" title="">2023b</a>)</cite>로 작업하는 반면, (3)의 경우 RoBERTa-Large <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="#bib.bib34" title="">2019</a>)</cite>를 사용한다. 우리의 설정은 <cite class="ltx_cite ltx_citemacro_citet">Dettmers et al. (<a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite>로부터의 설정을 밀접하게 따른다. LQ-LoRA의 피셔 가중치 버전은 C4 훈련 세트에서 무작위로 샘플링된 서열을 사용하며, RoBERTa-Large의 경우 피셔 매트릭스를 얻기 위해 마스킹 언어 모델링 목적(C4에서도)을 사용한다.</p>
</div>
<section id="S4.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Baselines.</h4>

<div id="S4.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.1">우리의 주요 기준으로는 QLoRA <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et al., <a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite>와 GPTQ-LoRA가 있다. 두 접근법 모두 적응을 위해 양자화된 모델에 대한 저순위 업데이트를 학습하기 전에 사전 훈련된 모델에 대해 PTQ를 수행하고; QLoRA는 NF-양자화를 사용하는 반면, GPTQ-LoRA는 <math alttext="\operatornamewithlimits{arg\,min}_{\hat{\mathbf{W}}\in\mathbb{Q}_{b}^{d\times k}}\|\mathbf{X}\mathbf{W}-\mathbf{X}\ \hat{\mathbf{W}}\|_{F}" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><munder id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mrow id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.2.cmml">arg</mi><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.1" lspace="0.170em" rspace="0px" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.1.cmml"></mo><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.3.cmml">min</mi></mrow><mrow id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.cmml"><mover accent="true" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.2.cmml">𝐖</mi><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.1.cmml">^</mo></mover><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.1.cmml">∈</mo><msubsup id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.2.cmml">ℚ</mi><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.3.cmml">b</mi><mrow id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.2.cmml">d</mi><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.1.cmml">×</mo><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.3.cmml">k</mi></mrow></msubsup></mrow></munder><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1a" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">⁡</mo><msub id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml"><mrow id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.2.cmml"><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.2.cmml">𝐗𝐖</mi><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.2.cmml">𝐗</mi><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.1" lspace="0.500em" rspace="0px" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.1.cmml"></mo><mover accent="true" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.2.cmml">𝐖</mi><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.1.cmml">^</mo></mover></mrow></mrow><mo id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.cmml">F</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1"><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2">subscript</csymbol><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2"><times id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.1"></times><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.2">arg</ci><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.3">min</ci></apply><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3"><in id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.1"></in><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2"><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.1">^</ci><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.2.2">𝐖</ci></apply><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3">superscript</csymbol><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3">subscript</csymbol><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.2">ℚ</ci><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.2.3">𝑏</ci></apply><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3"><times id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.1"></times><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.2">𝑑</ci><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.3.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1">subscript</csymbol><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1"><minus id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.1"></minus><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.2">𝐗𝐖</ci><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3"><times id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.1"></times><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.2">𝐗</ci><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3"><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.1">^</ci><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.3.3.2">𝐖</ci></apply></apply></apply></apply><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.3.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.1.m1.1c">\operatornamewithlimits{arg\,min}_{\hat{\mathbf{W}}\in\mathbb{Q}_{b}^{d\times k}}\|\mathbf{X}\mathbf{W}-\mathbf{X}\ \hat{\mathbf{W}}\|_{F}</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p1.1.m1.1d">start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT over^ start_ARG bold_W end_ARG ∈ blackboard_Q start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d × italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∥ bold_XW - bold_X over^ start_ARG bold_W end_ARG ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Frantar &amp; Alistarh, <a class="ltx_ref" href="#bib.bib12" title="">2022</a>; Frantar et al., <a class="ltx_ref" href="#bib.bib13" title="">2022</a>)</cite>를 해결하기 위해 근사 2차 정보를 사용한다. 원본 논문은 LLaMA-1 <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="#bib.bib50" title="">2023a</a>)</cite>의 상단에 적용되었으며, 공정한 비교를 위해 LLaMA-2의 상단에 이러한 기준선을 다시 구현했다. 주요 실험을 위해 <cite class="ltx_cite ltx_citemacro_citet">Dettmers et al. (<a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite>를 사용하여 순위 = 64를 따르고 분석 섹션의 순위를 삭제한다.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Evaluation.</h4>

<div id="S4.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p1.4">C4에서 훈련된 모델을 평가하기 위해 C4 검증에 대한 복잡도, WikiText-2 <cite class="ltx_cite ltx_citemacro_citep">(Merity et al., <a class="ltx_ref" href="#bib.bib37" title="">2016</a>)</cite>, 5-shot MMLU 정확도 <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et al., <a class="ltx_ref" href="#bib.bib15" title="">2021</a>)</cite>의 세 가지 메트릭을 사용하여 성능을 측정한다. WikiText-2에 대한 평가는 LoRA 미세 조정을 통해 언어 모델이 C4 데이터 세트에 과도하게 적합하지 않도록 하기 위한 것이다. 명령어 조정 모델의 경우, <span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note">10</span>We did not include GPTQ-LoRA in instruction-tuning experiments because the training was unstable.</span></span></span> 우리는 Vicuna 스타일의 자동 평가 <cite class="ltx_cite ltx_citemacro_citep">(Team, <a class="ltx_ref" href="#bib.bib49" title="">2023</a>)</cite>를 사용합니다. 이것은 GPT-<math alttext="4" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS0.SSS0.Px2.p1.1.m1.1a"><mn id="S4.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.1.m1.1b"><cn id="S4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.1.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px2.p1.1.m1.1d">4</annotation></semantics></math>를 질문하여 그 출력과 GPT-<math alttext="3.5" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS0.SSS0.Px2.p1.2.m2.1a"><mn id="S4.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">3.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.2.m2.1b"><cn id="S4.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" type="float" xref="S4.SS0.SSS0.Px2.p1.2.m2.1.1">3.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.2.m2.1c">3.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px2.p1.2.m2.1d">3.5</annotation></semantics></math>(동점 가능성 있음)의 출력과 <math alttext="80" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS0.SSS0.Px2.p1.3.m3.1a"><mn id="S4.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.3.m3.1b"><cn id="S4.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px2.p1.3.m3.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.3.m3.1c">80</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px2.p1.3.m3.1d">80</annotation></semantics></math> 큐레이션된 질문 간의 쌍대 비교를 하는 것을 포함한다. <cite class="ltx_cite ltx_citemacro_citet">Dettmers et al. (<a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite>의 권장 설정에 따라 <math alttext="10" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px2.p1.4.m4.1"><semantics id="S4.SS0.SSS0.Px2.p1.4.m4.1a"><mn id="S4.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS0.SSS0.Px2.p1.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.4.m4.1b"><cn id="S4.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px2.p1.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.4.m4.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px2.p1.4.m4.1d">10</annotation></semantics></math>-포인트 등급 체계보다 이 평가 체계를 선택했다. <span class="ltx_note ltx_role_footnote" id="footnote11"><sup class="ltx_note_mark">11</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">11</sup><span class="ltx_tag ltx_tag_note">11</span>However we do not use an ELO-style rating system (which would require evaluations across all possible pairs) due to the large number of models involved.</span></span></span> GLUE 벤치마크의 경우 모든 작업에 걸쳐 평균 메트릭을 보여 줍니다.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Training details.</h4>

<div id="S4.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS0.SSS0.Px3.p1.5">달리 명시되지 않는 한, 우리는 몇 가지 예외를 제외하고 <math alttext="64" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS0.SSS0.Px3.p1.1.m1.1a"><mn id="S4.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.1.m1.1b"><cn id="S4.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px3.p1.1.m1.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.1.m1.1c">64</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p1.1.m1.1d">64</annotation></semantics></math>, LoRA 드롭아웃 없음 및 <math alttext="2\times 10^{-5}" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS0.SSS0.Px3.p1.2.m2.1a"><mrow id="S4.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.cmml"><mn id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.2" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml">2</mn><mo id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml">×</mo><msup id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml"><mn id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.2" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.cmml"><mo id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3a" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.2" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1"><times id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.1"></times><cn id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.2">2</cn><apply id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3">superscript</csymbol><cn id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.2">10</cn><apply id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3"><minus id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3"></minus><cn id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.2.m2.1c">2\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p1.2.m2.1d">2 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>의 기본 학습률을 사용한다. 연속 언어 모델링을 위해 훈련과 평가 모두에 대해 <math alttext="1024" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px3.p1.3.m3.1"><semantics id="S4.SS0.SSS0.Px3.p1.3.m3.1a"><mn id="S4.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px3.p1.3.m3.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.3.m3.1b"><cn id="S4.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px3.p1.3.m3.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.3.m3.1c">1024</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p1.3.m3.1d">1024</annotation></semantics></math>의 시퀀스 길이를 사용하여 C4 데이터의 한 파티션에서 반 에포크 동안 훈련한다. 피셔를 추정하기 위해, 시퀀스 길이가 <math alttext="1024" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px3.p1.5.m5.1"><semantics id="S4.SS0.SSS0.Px3.p1.5.m5.1a"><mn id="S4.SS0.SSS0.Px3.p1.5.m5.1.1" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.5.m5.1b"><cn id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.5.m5.1c">1024</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p1.5.m5.1d">1024</annotation></semantics></math>인 C4로부터의 <math alttext="10000" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px3.p1.4.m4.1"><semantics id="S4.SS0.SSS0.Px3.p1.4.m4.1a"><mn id="S4.SS0.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS0.SSS0.Px3.p1.4.m4.1.1.cmml">10000</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.4.m4.1b"><cn id="S4.SS0.SSS0.Px3.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px3.p1.4.m4.1.1">10000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.4.m4.1c">10000</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p1.4.m4.1d">10000</annotation></semantics></math> 샘플을 사용한다. GLUE 작업의 경우 유사한 설정을 사용하지만 C4에서 마스킹된 언어 모델링 목표를 사용합니다.</p>
</div>
<div id="S4.SS0.SSS0.Px3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS0.SSS0.Px3.p2.1">명령어 튜닝을 위해, 우리는 <cite class="ltx_cite ltx_citemacro_citet">Dettmers et al. (<a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite> (LoRA dropout 제외)에서 제안한 하이퍼파라미터를 사용한다. GLUE 미세조정의 경우 QLoRA 기준선에 대해 <cite class="ltx_cite ltx_citemacro_citet">Hu et al. (<a class="ltx_ref" href="#bib.bib19" title="">2022</a>)</cite>에서 권장하는 학습률과 epoch 수를 따른다. 그러나 MNLI 및 QQP의 경우 크기 때문에 <math alttext="5" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px3.p2.1.m1.1"><semantics id="S4.SS0.SSS0.Px3.p2.1.m1.1a"><mn id="S4.SS0.SSS0.Px3.p2.1.m1.1.1" xref="S4.SS0.SSS0.Px3.p2.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p2.1.m1.1b"><cn id="S4.SS0.SSS0.Px3.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS0.SSS0.Px3.p2.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p2.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p2.1.m1.1d">5</annotation></semantics></math> epoch에 대한 모델만 미세 조정한다.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2311.12023/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="723" height="425" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2:</span>LQ-LoRA LLaMA-2 models with rank = 64. C4/Wikipedia/MMLU results is based on finetuning on C4. Vicuna eval is based on the OpenAssistant dataset. QLoRA <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et al., <a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite> 및 GPTQ-LoRA <cite class="ltx_cite ltx_citemacro_citep">(Chai et al., <a class="ltx_ref" href="#bib.bib5" title="">2023</a>)</cite>는 자체 재구현을 기반으로 한다. 치밀도는 명령어 튜닝 실험을 제외하고 양자화되지 않은 모델(훈련 없음)을 의미한다. 후자의 경우, 밀집도는 완전 미세 조정(7B 모델만, 70B를 위한 OOM)을 지칭한다.</figcaption>
</figure>
</section>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Results</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS1.p1.1">그림 <a class="ltx_ref" href="#S4.F2" title="Figure 2 ‣ Training details. ‣ 4 Empirical Study ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">2</span></a>는 다양한 모델 크기와 메트릭에 걸쳐 LLaMA-2에 대한 언어 모델링 및 명령어 튜닝의 결과를 보여준다. 표 <a class="ltx_ref" href="#A2.T5" title="Table 5 ‣ Appendix B Full Results ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">5</span></a>의 전체 숫자 결과는 부록 <a class="ltx_ref" href="#A2" title="Appendix B Full Results ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">B</span></a>이다. 일반적으로 유사한 비트 예산에서 LQ-LoRA가 거의 항상 QLoRA와 GPTQ-LoRA보다 우수하다는 것을 알 수 있다. 예를 들어, 3.5 비트(피셔) LQ-LoRA는 일반적으로 NF-4-비트 QLoRA(4.127 비트/파라미를 필요로 함); 유사하게, 2.75-비트 LQ-LoRA는 NF-3-비트 QLoRA(3.127 비트/파라미를 필요로 함)와 경쟁적이다. 이러한 비교는 이러한 혼합 전략이 ILP 없이 발견되지 않았을 것이기 때문에 혼합 양자화 계획의 유용성을 강조한다. 그러나 <math alttext="2.5" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">2.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn id="S4.SS1.p1.1.m1.1.1.cmml" type="float" xref="S4.SS1.p1.1.m1.1.1">2.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">2.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">2.5</annotation></semantics></math>-비트 범위에 접근하면 성능이 크게 저하되기 시작한다는 점에 유의해야 한다. 더 작은 7B 규모에서 LQ-LoRA의 피셔 가중 버전은 모든 목표 비트 폭에서 상당한 마진만큼 비가중 버전을 능가한다. 그러나 이러한 불일치는 70B 척도에서 축소된다.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS1.p2.1">표 <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ 4.2 LQ-LoRA for Model Compression ‣ 4 Empirical Study ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">2</span></a>는 RoBERTa-Large를 사용한 GLUE 벤치마크 성능을 보여주며, 여기서 유사한 경향을 관찰한다: LQ-LoRA는 유사한 비트 폭에서 QLoRA보다 우수하며, Fisher-weighted LQ-LoRA는 2.5비트에서 특히 효과적이다. 이러한 결과는 LQ-LoRA가 다양한 모델 패밀리에 일반화할 수 있는 광범위하게 적용할 수 있는 기술임을 나타낸다.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>LQ-LoRA for Model Compression</h3>

<figure id="S4.T2" class="ltx_table ltx_align_floatright">
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody><tr id="S4.T2.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_left ltx_border_tt">Method</td>
<td id="S4.T2.1.1.2" class="ltx_td ltx_align_left ltx_border_tt">Bits</td>
<td id="S4.T2.1.1.3" class="ltx_td ltx_align_left ltx_border_tt">GLUE</td>
</tr>
<tr id="S4.T2.1.2" class="ltx_tr">
<td id="S4.T2.1.2.1" class="ltx_td ltx_align_left ltx_border_t">Full FT</td>
<td id="S4.T2.1.2.2" class="ltx_td ltx_align_left ltx_border_t">16</td>
<td id="S4.T2.1.2.3" class="ltx_td ltx_align_left ltx_border_t">88.5</td>
</tr>
<tr id="S4.T2.1.3" class="ltx_tr">
<td id="S4.T2.1.3.1" class="ltx_td ltx_align_left">QLoRA 3-bit</td>
<td id="S4.T2.1.3.2" class="ltx_td ltx_align_left">3.127</td>
<td id="S4.T2.1.3.3" class="ltx_td ltx_align_left">86.1</td>
</tr>
<tr id="S4.T2.1.4" class="ltx_tr">
<td id="S4.T2.1.4.1" class="ltx_td ltx_align_left">QLoRA 4-bit</td>
<td id="S4.T2.1.4.2" class="ltx_td ltx_align_left">4.127</td>
<td id="S4.T2.1.4.3" class="ltx_td ltx_align_left">88.8</td>
</tr>
<tr id="S4.T2.1.5" class="ltx_tr">
<td id="S4.T2.1.5.1" class="ltx_td ltx_align_left ltx_border_t">QLoRA</td>
<td id="S4.T2.1.5.2" class="ltx_td ltx_align_left ltx_border_t">2.5</td>
<td id="S4.T2.1.5.3" class="ltx_td ltx_align_left ltx_border_t">75.4</td>
</tr>
<tr id="S4.T2.1.6" class="ltx_tr">
<td id="S4.T2.1.6.1" class="ltx_td ltx_align_left">(ILP)</td>
<td id="S4.T2.1.6.2" class="ltx_td ltx_align_left">2.75</td>
<td id="S4.T2.1.6.3" class="ltx_td ltx_align_left">80.7</td>
</tr>
<tr id="S4.T2.1.7" class="ltx_tr">
<td id="S4.T2.1.7.1" class="ltx_td"></td>
<td id="S4.T2.1.7.2" class="ltx_td ltx_align_left">3.0</td>
<td id="S4.T2.1.7.3" class="ltx_td ltx_align_left">85.5</td>
</tr>
<tr id="S4.T2.1.8" class="ltx_tr">
<td id="S4.T2.1.8.1" class="ltx_td"></td>
<td id="S4.T2.1.8.2" class="ltx_td ltx_align_left">3.25</td>
<td id="S4.T2.1.8.3" class="ltx_td ltx_align_left">86.1</td>
</tr>
<tr id="S4.T2.1.9" class="ltx_tr">
<td id="S4.T2.1.9.1" class="ltx_td ltx_align_left ltx_border_t">LQ-LoRA</td>
<td id="S4.T2.1.9.2" class="ltx_td ltx_align_left ltx_border_t">2.5</td>
<td id="S4.T2.1.9.3" class="ltx_td ltx_align_left ltx_border_t">85.7</td>
</tr>
<tr id="S4.T2.1.10" class="ltx_tr">
<td id="S4.T2.1.10.1" class="ltx_td"></td>
<td id="S4.T2.1.10.2" class="ltx_td ltx_align_left">2.75</td>
<td id="S4.T2.1.10.3" class="ltx_td ltx_align_left">87.1</td>
</tr>
<tr id="S4.T2.1.11" class="ltx_tr">
<td id="S4.T2.1.11.1" class="ltx_td"></td>
<td id="S4.T2.1.11.2" class="ltx_td ltx_align_left">3.0</td>
<td id="S4.T2.1.11.3" class="ltx_td ltx_align_left">87.3</td>
</tr>
<tr id="S4.T2.1.12" class="ltx_tr">
<td id="S4.T2.1.12.1" class="ltx_td"></td>
<td id="S4.T2.1.12.2" class="ltx_td ltx_align_left">3.25</td>
<td id="S4.T2.1.12.3" class="ltx_td ltx_align_left">88.1</td>
</tr>
<tr id="S4.T2.1.13" class="ltx_tr">
<td id="S4.T2.1.13.1" class="ltx_td ltx_align_left ltx_border_t">LQ-LoRA</td>
<td id="S4.T2.1.13.2" class="ltx_td ltx_align_left ltx_border_t">2.5</td>
<td id="S4.T2.1.13.3" class="ltx_td ltx_align_left ltx_border_t">87.3</td>
</tr>
<tr id="S4.T2.1.14" class="ltx_tr">
<td id="S4.T2.1.14.1" class="ltx_td ltx_align_left">(Fisher)</td>
<td id="S4.T2.1.14.2" class="ltx_td ltx_align_left">2.75</td>
<td id="S4.T2.1.14.3" class="ltx_td ltx_align_left">86.4</td>
</tr>
<tr id="S4.T2.1.15" class="ltx_tr">
<td id="S4.T2.1.15.1" class="ltx_td"></td>
<td id="S4.T2.1.15.2" class="ltx_td ltx_align_left">3.0</td>
<td id="S4.T2.1.15.3" class="ltx_td ltx_align_left">87.3</td>
</tr>
<tr id="S4.T2.1.16" class="ltx_tr">
<td id="S4.T2.1.16.1" class="ltx_td ltx_border_bb"></td>
<td id="S4.T2.1.16.2" class="ltx_td ltx_align_left ltx_border_bb">3.25</td>
<td id="S4.T2.1.16.3" class="ltx_td ltx_align_left ltx_border_bb">88.3</td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 2:</span>Performance on GLUE with RoBERTa-Large.</figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS2.p1.4">LQ-LoRA의 지속적인 언어 모델링에 대한 유망한 결과를 감안할 때, 우리는 다음으로 대규모 언어 모델링이 결과를 더욱 개선하고 모델 압축을 위한 실행 가능한 기술로 LQ-LoRA를 사용할 수 있는지 여부를 실험한다. 구체적으로, LQ-LoRA(Fisher, <math alttext="2.75" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">2.75</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><cn id="S4.SS2.p1.1.m1.1.1.cmml" type="float" xref="S4.SS2.p1.1.m1.1.1">2.75</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">2.75</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">2.75</annotation></semantics></math>-bits, <math alttext="64" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><cn id="S4.SS2.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">64</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">64</annotation></semantics></math>-rank)를 취하고, <math alttext="2048" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mn id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><cn id="S4.SS2.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">2048</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">2048</annotation></semantics></math>의 시퀀스 길이를 사용하여 두 개의 C4 파티션과 WikiText-2의 더 큰 교정 데이터세트에서 미세 조정한다. 훈련 후 NF-<math alttext="8" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mn id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><cn id="S4.SS2.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS2.p1.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">8</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">8</annotation></semantics></math> 구성을 사용하여 저순위 성분 자체를 추가로 양자화한다. <span class="ltx_note ltx_role_footnote" id="footnote12"><sup class="ltx_note_mark">12</sup><span class="ltx_note_outer"><span class="ltx_note_content">12</sup><span class="ltx_note_mark">12</sup><span class="ltx_tag ltx_tag_note">12</span>NF-8은 원래의 NF-4의 첫 번째 레벨 양자화를 <math alttext="8" class="ltx_Math" display="inline" id="footnote12.m1.1"><semantics id="footnote12.m1.1b"><mn id="footnote12.m1.1.1" xref="footnote12.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="footnote12.m1.1c"><cn id="footnote12.m1.1.1.cmml" type="integer" xref="footnote12.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="footnote12.m1.1d">8</annotation><annotation encoding="application/x-llamapun" id="footnote12.m1.1e">8</annotation></semantics></math>-bits로 대체한다. </span></span></span></p>
</div>
<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">표 <a class="ltx_ref" href="#S4.T3" title="Table 3 ‣ Results. ‣ 4.2 LQ-LoRA for Model Compression ‣ 4 Empirical Study ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">3</span></a>는 C4 및 WikiText에 대한 결과를 보여주며, 여기서는 이전 PTQ 작업 <cite class="ltx_cite ltx_citemacro_citep">(Frantar et al., <a class="ltx_ref" href="#bib.bib13" title="">2022</a>; Shao et al., <a class="ltx_ref" href="#bib.bib43" title="">2023</a>)</cite>를 따르고 데이터의 특정 하위 집합에 대한 C4 및 WikiText-2 perplexity를 통해 성능을 측정한다. 2.75 비트를 갖는 LQ-LoRA는 LoRA 컴포넌트들을 고려할 때, 7B 및 70B 모델들에 대해 각각 2.95 비트 및 2.85 비트의 평균 비트/파라미를 초래한다(표<a class="ltx_ref" href="#S4.T3" title="Table 3 ‣ Results. ‣ 4.2 LQ-LoRA for Model Compression ‣ 4 Empirical Study ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">3</span></a>의 “유효 비트들”). 우리는 이것이 일반적으로 사전 훈련된 모델을 양자화하기 위해 교정 데이터를 사용하는 다른 하위 4비트 PTQ 방법보다 우수하다는 것을 발견했다.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 3: </span>LQ-LoRA 비교를 다른 sub-4-bit PTQ 방법들과 비교한다. 우리는 LLaMA-2(하단)에서 LQ-LoRA만을 실험하지만, 대부분의 이전 작업들이 LLaMA-1에 초점을 맞추었기 때문에 결과를 보정하기 위해 LLaMA-1(상단)에서 다른 PTQ 결과들을 보여준다. "효과적인 비트들"은 양자화 파라미터들(예를 들어, 스케일링 팩터들)을 저장하는 데 필요한 여분의 저장소를 고려한다. LQ-LoRA에서 이것은 LoRA 컴포넌트들을 포함하며, 이 컴포넌트들은 그 자체로 8비트로 양자화된다. 다른 방법의 경우 3비트 양자화와 그룹 크기 128(가능하면 가장 가까운 것)이 있는 설정에 해당하는 결과를 취한다. SpQR과 LQ-LoRA의 유효 비트는 모델 크기에 의존하므로 두 설정 모두에 대한 유효 비트를 보여준다.</figcaption>
<math id="S4.T3.3.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.3.m1.1b"><msup id="S4.T3.3.m1.1.1" xref="S4.T3.3.m1.1.1.cmml"><mi id="S4.T3.3.m1.1.1b" xref="S4.T3.3.m1.1.1.cmml"></mi><mo id="S4.T3.3.m1.1.1.1" xref="S4.T3.3.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.3.m1.1c"><apply id="S4.T3.3.m1.1.1.cmml" xref="S4.T3.3.m1.1.1"><ci id="S4.T3.3.m1.1.1.1.cmml" xref="S4.T3.3.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.m1.1d">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.m1.1e">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>Results from&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Shao et&nbsp;al. (<a href="#bib.bib43" title="" class="ltx_ref">2023</a>)</cite>. <math id="S4.T3.4.m2.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="S4.T3.4.m2.1b"><msup id="S4.T3.4.m2.1.1" xref="S4.T3.4.m2.1.1.cmml"><mi id="S4.T3.4.m2.1.1b" xref="S4.T3.4.m2.1.1.cmml"></mi><mo id="S4.T3.4.m2.1.1.1" xref="S4.T3.4.m2.1.1.1.cmml">‡</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.4.m2.1c"><apply id="S4.T3.4.m2.1.1.cmml" xref="S4.T3.4.m2.1.1"><ci id="S4.T3.4.m2.1.1.1.cmml" xref="S4.T3.4.m2.1.1.1">‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.m2.1d">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.m2.1e">start_FLOATSUPERSCRIPT ‡ end_FLOATSUPERSCRIPT</annotation></semantics></math>For OWQ, we take the 3.1-bits results instead of 3.01-bits with a group size of 128 because the latter performed worse.
</figcaption>
<table id="S4.T3.17" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody><tr id="S4.T3.17.14" class="ltx_tr">
<td id="S4.T3.17.14.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S4.T3.17.14.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S4.T3.17.14.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T3.17.14.2.1" class="ltx_text ltx_font_bold">Effective Bits</span></td>
<td id="S4.T3.17.14.3" class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" colspan="2">
<span id="S4.T3.17.14.3.1" class="ltx_text ltx_font_bold">C4</span></td>
<td id="S4.T3.17.14.4" class="ltx_td ltx_align_right ltx_border_tt" colspan="2">
<span id="S4.T3.17.14.4.1" class="ltx_text ltx_font_bold">WikiText</span></td>
</tr>
<tr id="S4.T3.17.15" class="ltx_tr">
<td id="S4.T3.17.15.1" class="ltx_td"></td>
<td id="S4.T3.17.15.2" class="ltx_td ltx_align_left ltx_border_r">(7B, 65B/70B)</td>
<td id="S4.T3.17.15.3" class="ltx_td ltx_align_right">7B</td>
<td id="S4.T3.17.15.4" class="ltx_td ltx_align_right ltx_border_r">65B/70B</td>
<td id="S4.T3.17.15.5" class="ltx_td ltx_align_right">7B</td>
<td id="S4.T3.17.15.6" class="ltx_td ltx_align_right">65B/70B</td>
</tr>
<tr id="S4.T3.5.1" class="ltx_tr">
<td id="S4.T3.5.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.5.1.1.1" class="ltx_text ltx_font_italic">LLaMA-1 Uncompressed<math id="S4.T3.5.1.1.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.5.1.1.1.m1.1a"><msup id="S4.T3.5.1.1.1.m1.1.1" xref="S4.T3.5.1.1.1.m1.1.1.cmml"><mi id="S4.T3.5.1.1.1.m1.1.1a" xref="S4.T3.5.1.1.1.m1.1.1.cmml"></mi><mo mathvariant="normal" id="S4.T3.5.1.1.1.m1.1.1.1" xref="S4.T3.5.1.1.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.5.1.1.1.m1.1b"><apply id="S4.T3.5.1.1.1.m1.1.1.cmml" xref="S4.T3.5.1.1.1.m1.1.1"><ci id="S4.T3.5.1.1.1.m1.1.1.1.cmml" xref="S4.T3.5.1.1.1.m1.1.1.1">normal-†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.1.1.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.1.1.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math></span></td>
<td id="S4.T3.5.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T3.5.1.2.1" class="ltx_text ltx_font_italic">16</span></td>
<td id="S4.T3.5.1.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S4.T3.5.1.3.1" class="ltx_text ltx_font_italic">7.08</span></td>
<td id="S4.T3.5.1.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t"><span id="S4.T3.5.1.4.1" class="ltx_text ltx_font_italic">5.62</span></td>
<td id="S4.T3.5.1.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S4.T3.5.1.5.1" class="ltx_text ltx_font_italic">5.68</span></td>
<td id="S4.T3.5.1.6" class="ltx_td ltx_align_right ltx_border_t"><span id="S4.T3.5.1.6.1" class="ltx_text ltx_font_italic">3.53</span></td>
</tr>
<tr id="S4.T3.17.16" class="ltx_tr">
<td id="S4.T3.17.16.1" class="ltx_td ltx_align_left">  SpQR&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dettmers et&nbsp;al., <a href="#bib.bib10" title="" class="ltx_ref">2023b</a>)</cite>
</td>
<td id="S4.T3.17.16.2" class="ltx_td ltx_align_left ltx_border_r">3.94, 3.90</td>
<td id="S4.T3.17.16.3" class="ltx_td ltx_align_right">7.28</td>
<td id="S4.T3.17.16.4" class="ltx_td ltx_align_right ltx_border_r">5.70</td>
<td id="S4.T3.17.16.5" class="ltx_td ltx_align_right">5.87</td>
<td id="S4.T3.17.16.6" class="ltx_td ltx_align_right">3.68</td>
</tr>
<tr id="S4.T3.6.2" class="ltx_tr">
<td id="S4.T3.6.2.1" class="ltx_td ltx_align_left">  RTN&nbsp;(<span id="S4.T3.6.2.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)<math id="S4.T3.6.2.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.6.2.1.m1.1a"><msup id="S4.T3.6.2.1.m1.1.1" xref="S4.T3.6.2.1.m1.1.1.cmml"><mi id="S4.T3.6.2.1.m1.1.1a" xref="S4.T3.6.2.1.m1.1.1.cmml"></mi><mo id="S4.T3.6.2.1.m1.1.1.1" xref="S4.T3.6.2.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.6.2.1.m1.1b"><apply id="S4.T3.6.2.1.m1.1.1.cmml" xref="S4.T3.6.2.1.m1.1.1"><ci id="S4.T3.6.2.1.m1.1.1.1.cmml" xref="S4.T3.6.2.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.2.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.2.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.6.2.2" class="ltx_td ltx_align_left ltx_border_r">3.15</td>
<td id="S4.T3.6.2.3" class="ltx_td ltx_align_right">8.62</td>
<td id="S4.T3.6.2.4" class="ltx_td ltx_align_right ltx_border_r">6.10</td>
<td id="S4.T3.6.2.5" class="ltx_td ltx_align_right">7.01</td>
<td id="S4.T3.6.2.6" class="ltx_td ltx_align_right">4.24</td>
</tr>
<tr id="S4.T3.7.3" class="ltx_tr">
<td id="S4.T3.7.3.1" class="ltx_td ltx_align_left">  GPTQ (<span id="S4.T3.7.3.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Frantar et&nbsp;al., <a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite><math id="S4.T3.7.3.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.7.3.1.m1.1a"><msup id="S4.T3.7.3.1.m1.1.1" xref="S4.T3.7.3.1.m1.1.1.cmml"><mi id="S4.T3.7.3.1.m1.1.1a" xref="S4.T3.7.3.1.m1.1.1.cmml"></mi><mo id="S4.T3.7.3.1.m1.1.1.1" xref="S4.T3.7.3.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.7.3.1.m1.1b"><apply id="S4.T3.7.3.1.m1.1.1.cmml" xref="S4.T3.7.3.1.m1.1.1"><ci id="S4.T3.7.3.1.m1.1.1.1.cmml" xref="S4.T3.7.3.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.3.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.3.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.7.3.2" class="ltx_td ltx_align_left ltx_border_r">3.15</td>
<td id="S4.T3.7.3.3" class="ltx_td ltx_align_right">7.85</td>
<td id="S4.T3.7.3.4" class="ltx_td ltx_align_right ltx_border_r">6.00</td>
<td id="S4.T3.7.3.5" class="ltx_td ltx_align_right">6.55</td>
<td id="S4.T3.7.3.6" class="ltx_td ltx_align_right">4.17</td>
</tr>
<tr id="S4.T3.8.4" class="ltx_tr">
<td id="S4.T3.8.4.1" class="ltx_td ltx_align_left">  AWQ (<span id="S4.T3.8.4.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a href="#bib.bib31" title="" class="ltx_ref">2023</a>)</cite><math id="S4.T3.8.4.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.8.4.1.m1.1a"><msup id="S4.T3.8.4.1.m1.1.1" xref="S4.T3.8.4.1.m1.1.1.cmml"><mi id="S4.T3.8.4.1.m1.1.1a" xref="S4.T3.8.4.1.m1.1.1.cmml"></mi><mo id="S4.T3.8.4.1.m1.1.1.1" xref="S4.T3.8.4.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.8.4.1.m1.1b"><apply id="S4.T3.8.4.1.m1.1.1.cmml" xref="S4.T3.8.4.1.m1.1.1"><ci id="S4.T3.8.4.1.m1.1.1.1.cmml" xref="S4.T3.8.4.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.4.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.4.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.8.4.2" class="ltx_td ltx_align_left ltx_border_r">3.15</td>
<td id="S4.T3.8.4.3" class="ltx_td ltx_align_right">7.92</td>
<td id="S4.T3.8.4.4" class="ltx_td ltx_align_right ltx_border_r">5.94</td>
<td id="S4.T3.8.4.5" class="ltx_td ltx_align_right">6.46</td>
<td id="S4.T3.8.4.6" class="ltx_td ltx_align_right">3.99</td>
</tr>
<tr id="S4.T3.17.17" class="ltx_tr">
<td id="S4.T3.17.17.1" class="ltx_td ltx_align_left">  PEQA (<span id="S4.T3.17.17.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kim et&nbsp;al., <a href="#bib.bib20" title="" class="ltx_ref">2023a</a>)</cite>
</td>
<td id="S4.T3.17.17.2" class="ltx_td ltx_align_left ltx_border_r">3.15</td>
<td id="S4.T3.17.17.3" class="ltx_td ltx_align_right">-</td>
<td id="S4.T3.17.17.4" class="ltx_td ltx_align_right ltx_border_r">-</td>
<td id="S4.T3.17.17.5" class="ltx_td ltx_align_right">5.91</td>
<td id="S4.T3.17.17.6" class="ltx_td ltx_align_right">-</td>
</tr>
<tr id="S4.T3.9.5" class="ltx_tr">
<td id="S4.T3.9.5.1" class="ltx_td ltx_align_left">  OWQ (<span id="S4.T3.9.5.1.1" class="ltx_text ltx_font_typewriter">3-bits</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lee et&nbsp;al., <a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite><math id="S4.T3.9.5.1.m1.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="S4.T3.9.5.1.m1.1a"><msup id="S4.T3.9.5.1.m1.1.1" xref="S4.T3.9.5.1.m1.1.1.cmml"><mi id="S4.T3.9.5.1.m1.1.1a" xref="S4.T3.9.5.1.m1.1.1.cmml"></mi><mo id="S4.T3.9.5.1.m1.1.1.1" xref="S4.T3.9.5.1.m1.1.1.1.cmml">‡</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.9.5.1.m1.1b"><apply id="S4.T3.9.5.1.m1.1.1.cmml" xref="S4.T3.9.5.1.m1.1.1"><ci id="S4.T3.9.5.1.m1.1.1.1.cmml" xref="S4.T3.9.5.1.m1.1.1.1">‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.5.1.m1.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.5.1.m1.1d">start_FLOATSUPERSCRIPT ‡ end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.9.5.2" class="ltx_td ltx_align_left ltx_border_r">3.1</td>
<td id="S4.T3.9.5.3" class="ltx_td ltx_align_right">8.15</td>
<td id="S4.T3.9.5.4" class="ltx_td ltx_align_right ltx_border_r">6.16</td>
<td id="S4.T3.9.5.5" class="ltx_td ltx_align_right">6.39</td>
<td id="S4.T3.9.5.6" class="ltx_td ltx_align_right">4.08</td>
</tr>
<tr id="S4.T3.17.18" class="ltx_tr">
<td id="S4.T3.17.18.1" class="ltx_td ltx_align_left">  SqueezeLLM (<span id="S4.T3.17.18.1.1" class="ltx_text ltx_font_typewriter">3-bits, 0.45%</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kim et&nbsp;al., <a href="#bib.bib21" title="" class="ltx_ref">2023b</a>)</cite>
</td>
<td id="S4.T3.17.18.2" class="ltx_td ltx_align_left ltx_border_r">3.24</td>
<td id="S4.T3.17.18.3" class="ltx_td ltx_align_right">7.56</td>
<td id="S4.T3.17.18.4" class="ltx_td ltx_align_right ltx_border_r">-</td>
<td id="S4.T3.17.18.5" class="ltx_td ltx_align_right">6.13</td>
<td id="S4.T3.17.18.6" class="ltx_td ltx_align_right">-</td>
</tr>
<tr id="S4.T3.17.19" class="ltx_tr">
<td id="S4.T3.17.19.1" class="ltx_td ltx_align_left">  SqueezeLLM (<span id="S4.T3.17.19.1.1" class="ltx_text ltx_font_typewriter">3-bits</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kim et&nbsp;al., <a href="#bib.bib21" title="" class="ltx_ref">2023b</a>)</cite>
</td>
<td id="S4.T3.17.19.2" class="ltx_td ltx_align_left ltx_border_r">3.02</td>
<td id="S4.T3.17.19.3" class="ltx_td ltx_align_right">7.75</td>
<td id="S4.T3.17.19.4" class="ltx_td ltx_align_right ltx_border_r">-</td>
<td id="S4.T3.17.19.5" class="ltx_td ltx_align_right">6.32</td>
<td id="S4.T3.17.19.6" class="ltx_td ltx_align_right">-</td>
</tr>
<tr id="S4.T3.10.6" class="ltx_tr">
<td id="S4.T3.10.6.1" class="ltx_td ltx_align_left">  OmniQuant (<span id="S4.T3.10.6.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a href="#bib.bib43" title="" class="ltx_ref">2023</a>)</cite><math id="S4.T3.10.6.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.10.6.1.m1.1a"><msup id="S4.T3.10.6.1.m1.1.1" xref="S4.T3.10.6.1.m1.1.1.cmml"><mi id="S4.T3.10.6.1.m1.1.1a" xref="S4.T3.10.6.1.m1.1.1.cmml"></mi><mo id="S4.T3.10.6.1.m1.1.1.1" xref="S4.T3.10.6.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.10.6.1.m1.1b"><apply id="S4.T3.10.6.1.m1.1.1.cmml" xref="S4.T3.10.6.1.m1.1.1"><ci id="S4.T3.10.6.1.m1.1.1.1.cmml" xref="S4.T3.10.6.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.6.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.10.6.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.10.6.2" class="ltx_td ltx_align_left ltx_border_r">3.15</td>
<td id="S4.T3.10.6.3" class="ltx_td ltx_align_right">7.75</td>
<td id="S4.T3.10.6.4" class="ltx_td ltx_align_right ltx_border_r">5.93</td>
<td id="S4.T3.10.6.5" class="ltx_td ltx_align_right">6.15</td>
<td id="S4.T3.10.6.6" class="ltx_td ltx_align_right">3.94</td>
</tr>
<tr id="S4.T3.11.7" class="ltx_tr">
<td id="S4.T3.11.7.1" class="ltx_td ltx_align_left">  OmniQuant (<span id="S4.T3.11.7.1.1" class="ltx_text ltx_font_typewriter">2-bits, g64</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a href="#bib.bib43" title="" class="ltx_ref">2023</a>)</cite><math id="S4.T3.11.7.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.11.7.1.m1.1a"><msup id="S4.T3.11.7.1.m1.1.1" xref="S4.T3.11.7.1.m1.1.1.cmml"><mi id="S4.T3.11.7.1.m1.1.1a" xref="S4.T3.11.7.1.m1.1.1.cmml"></mi><mo id="S4.T3.11.7.1.m1.1.1.1" xref="S4.T3.11.7.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.11.7.1.m1.1b"><apply id="S4.T3.11.7.1.m1.1.1.cmml" xref="S4.T3.11.7.1.m1.1.1"><ci id="S4.T3.11.7.1.m1.1.1.1.cmml" xref="S4.T3.11.7.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.7.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.11.7.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.11.7.2" class="ltx_td ltx_align_left ltx_border_r">2.28</td>
<td id="S4.T3.11.7.3" class="ltx_td ltx_align_right">11.78</td>
<td id="S4.T3.11.7.4" class="ltx_td ltx_align_right ltx_border_r">7.60</td>
<td id="S4.T3.11.7.5" class="ltx_td ltx_align_right">8.90</td>
<td id="S4.T3.11.7.6" class="ltx_td ltx_align_right">5.65</td>
</tr>
<tr id="S4.T3.17.20" class="ltx_tr">
<td id="S4.T3.17.20.1" class="ltx_td ltx_align_left">  LREC (<span id="S4.T3.17.20.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chai et&nbsp;al., <a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite>
</td>
<td id="S4.T3.17.20.2" class="ltx_td ltx_align_left ltx_border_r">3.35</td>
<td id="S4.T3.17.20.3" class="ltx_td ltx_align_right">8.24</td>
<td id="S4.T3.17.20.4" class="ltx_td ltx_align_right ltx_border_r">-</td>
<td id="S4.T3.17.20.5" class="ltx_td ltx_align_right">5.52</td>
<td id="S4.T3.17.20.6" class="ltx_td ltx_align_right">-</td>
</tr>
<tr id="S4.T3.17.21" class="ltx_tr">
<td id="S4.T3.17.21.1" class="ltx_td ltx_align_left">  LREC (<span id="S4.T3.17.21.1.1" class="ltx_text ltx_font_typewriter">2-bits, g128</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chai et&nbsp;al., <a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite>
</td>
<td id="S4.T3.17.21.2" class="ltx_td ltx_align_left ltx_border_r">2.24</td>
<td id="S4.T3.17.21.3" class="ltx_td ltx_align_right">12.52</td>
<td id="S4.T3.17.21.4" class="ltx_td ltx_align_right ltx_border_r">-</td>
<td id="S4.T3.17.21.5" class="ltx_td ltx_align_right">8.74</td>
<td id="S4.T3.17.21.6" class="ltx_td ltx_align_right">-</td>
</tr>
<tr id="S4.T3.12.8" class="ltx_tr">
<td id="S4.T3.12.8.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T3.12.8.1.1" class="ltx_text ltx_font_italic">LLaMA-2 Uncompressed<math id="S4.T3.12.8.1.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.12.8.1.1.m1.1a"><msup id="S4.T3.12.8.1.1.m1.1.1" xref="S4.T3.12.8.1.1.m1.1.1.cmml"><mi id="S4.T3.12.8.1.1.m1.1.1a" xref="S4.T3.12.8.1.1.m1.1.1.cmml"></mi><mo mathvariant="normal" id="S4.T3.12.8.1.1.m1.1.1.1" xref="S4.T3.12.8.1.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.12.8.1.1.m1.1b"><apply id="S4.T3.12.8.1.1.m1.1.1.cmml" xref="S4.T3.12.8.1.1.m1.1.1"><ci id="S4.T3.12.8.1.1.m1.1.1.1.cmml" xref="S4.T3.12.8.1.1.m1.1.1.1">normal-†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.8.1.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.12.8.1.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math></span></td>
<td id="S4.T3.12.8.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T3.12.8.2.1" class="ltx_text ltx_font_italic">16</span></td>
<td id="S4.T3.12.8.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S4.T3.12.8.3.1" class="ltx_text ltx_font_italic">6.97</span></td>
<td id="S4.T3.12.8.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t"><span id="S4.T3.12.8.4.1" class="ltx_text ltx_font_italic">5.52</span></td>
<td id="S4.T3.12.8.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S4.T3.12.8.5.1" class="ltx_text ltx_font_italic">5.47</span></td>
<td id="S4.T3.12.8.6" class="ltx_td ltx_align_right ltx_border_t"><span id="S4.T3.12.8.6.1" class="ltx_text ltx_font_italic">3.31</span></td>
</tr>
<tr id="S4.T3.13.9" class="ltx_tr">
<td id="S4.T3.13.9.1" class="ltx_td ltx_align_left">  RTN&nbsp;(<span id="S4.T3.13.9.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)<math id="S4.T3.13.9.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.13.9.1.m1.1a"><msup id="S4.T3.13.9.1.m1.1.1" xref="S4.T3.13.9.1.m1.1.1.cmml"><mi id="S4.T3.13.9.1.m1.1.1a" xref="S4.T3.13.9.1.m1.1.1.cmml"></mi><mo id="S4.T3.13.9.1.m1.1.1.1" xref="S4.T3.13.9.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.13.9.1.m1.1b"><apply id="S4.T3.13.9.1.m1.1.1.cmml" xref="S4.T3.13.9.1.m1.1.1"><ci id="S4.T3.13.9.1.m1.1.1.1.cmml" xref="S4.T3.13.9.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.9.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.13.9.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.13.9.2" class="ltx_td ltx_align_left ltx_border_r">3.15</td>
<td id="S4.T3.13.9.3" class="ltx_td ltx_align_right">8.40</td>
<td id="S4.T3.13.9.4" class="ltx_td ltx_align_right ltx_border_r">6.02</td>
<td id="S4.T3.13.9.5" class="ltx_td ltx_align_right">6.66</td>
<td id="S4.T3.13.9.6" class="ltx_td ltx_align_right">3.97</td>
</tr>
<tr id="S4.T3.14.10" class="ltx_tr">
<td id="S4.T3.14.10.1" class="ltx_td ltx_align_left">  GPTQ (<span id="S4.T3.14.10.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Frantar et&nbsp;al., <a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite><math id="S4.T3.14.10.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.14.10.1.m1.1a"><msup id="S4.T3.14.10.1.m1.1.1" xref="S4.T3.14.10.1.m1.1.1.cmml"><mi id="S4.T3.14.10.1.m1.1.1a" xref="S4.T3.14.10.1.m1.1.1.cmml"></mi><mo id="S4.T3.14.10.1.m1.1.1.1" xref="S4.T3.14.10.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.14.10.1.m1.1b"><apply id="S4.T3.14.10.1.m1.1.1.cmml" xref="S4.T3.14.10.1.m1.1.1"><ci id="S4.T3.14.10.1.m1.1.1.1.cmml" xref="S4.T3.14.10.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.10.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.14.10.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.14.10.2" class="ltx_td ltx_align_left ltx_border_r">3.15</td>
<td id="S4.T3.14.10.3" class="ltx_td ltx_align_right">7.89</td>
<td id="S4.T3.14.10.4" class="ltx_td ltx_align_right ltx_border_r"><span id="S4.T3.14.10.4.1" class="ltx_text ltx_font_bold">5.85</span></td>
<td id="S4.T3.14.10.5" class="ltx_td ltx_align_right">6.29</td>
<td id="S4.T3.14.10.6" class="ltx_td ltx_align_right">3.85</td>
</tr>
<tr id="S4.T3.15.11" class="ltx_tr">
<td id="S4.T3.15.11.1" class="ltx_td ltx_align_left">  AWQ (<span id="S4.T3.15.11.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a href="#bib.bib31" title="" class="ltx_ref">2023</a>)</cite><math id="S4.T3.15.11.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.15.11.1.m1.1a"><msup id="S4.T3.15.11.1.m1.1.1" xref="S4.T3.15.11.1.m1.1.1.cmml"><mi id="S4.T3.15.11.1.m1.1.1a" xref="S4.T3.15.11.1.m1.1.1.cmml"></mi><mo id="S4.T3.15.11.1.m1.1.1.1" xref="S4.T3.15.11.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.15.11.1.m1.1b"><apply id="S4.T3.15.11.1.m1.1.1.cmml" xref="S4.T3.15.11.1.m1.1.1"><ci id="S4.T3.15.11.1.m1.1.1.1.cmml" xref="S4.T3.15.11.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.11.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.15.11.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.15.11.2" class="ltx_td ltx_align_left ltx_border_r">3.15</td>
<td id="S4.T3.15.11.3" class="ltx_td ltx_align_right">7.84</td>
<td id="S4.T3.15.11.4" class="ltx_td ltx_align_right ltx_border_r">-</td>
<td id="S4.T3.15.11.5" class="ltx_td ltx_align_right">6.24</td>
<td id="S4.T3.15.11.6" class="ltx_td ltx_align_right">-</td>
</tr>
<tr id="S4.T3.16.12" class="ltx_tr">
<td id="S4.T3.16.12.1" class="ltx_td ltx_align_left">  OmniQuant (<span id="S4.T3.16.12.1.1" class="ltx_text ltx_font_typewriter">3-bits, g128</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a href="#bib.bib43" title="" class="ltx_ref">2023</a>)</cite><math id="S4.T3.16.12.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.16.12.1.m1.1a"><msup id="S4.T3.16.12.1.m1.1.1" xref="S4.T3.16.12.1.m1.1.1.cmml"><mi id="S4.T3.16.12.1.m1.1.1a" xref="S4.T3.16.12.1.m1.1.1.cmml"></mi><mo id="S4.T3.16.12.1.m1.1.1.1" xref="S4.T3.16.12.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.16.12.1.m1.1b"><apply id="S4.T3.16.12.1.m1.1.1.cmml" xref="S4.T3.16.12.1.m1.1.1"><ci id="S4.T3.16.12.1.m1.1.1.1.cmml" xref="S4.T3.16.12.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.16.12.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.16.12.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.16.12.2" class="ltx_td ltx_align_left ltx_border_r">3.15</td>
<td id="S4.T3.16.12.3" class="ltx_td ltx_align_right">7.75</td>
<td id="S4.T3.16.12.4" class="ltx_td ltx_align_right ltx_border_r"><span id="S4.T3.16.12.4.1" class="ltx_text ltx_font_bold">5.85</span></td>
<td id="S4.T3.16.12.5" class="ltx_td ltx_align_right">6.03</td>
<td id="S4.T3.16.12.6" class="ltx_td ltx_align_right">3.78</td>
</tr>
<tr id="S4.T3.17.13" class="ltx_tr">
<td id="S4.T3.17.13.1" class="ltx_td ltx_align_left">  OmniQuant (<span id="S4.T3.17.13.1.1" class="ltx_text ltx_font_typewriter">2-bits, g64</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a href="#bib.bib43" title="" class="ltx_ref">2023</a>)</cite><math id="S4.T3.17.13.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="S4.T3.17.13.1.m1.1a"><msup id="S4.T3.17.13.1.m1.1.1" xref="S4.T3.17.13.1.m1.1.1.cmml"><mi id="S4.T3.17.13.1.m1.1.1a" xref="S4.T3.17.13.1.m1.1.1.cmml"></mi><mo id="S4.T3.17.13.1.m1.1.1.1" xref="S4.T3.17.13.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T3.17.13.1.m1.1b"><apply id="S4.T3.17.13.1.m1.1.1.cmml" xref="S4.T3.17.13.1.m1.1.1"><ci id="S4.T3.17.13.1.m1.1.1.1.cmml" xref="S4.T3.17.13.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.17.13.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.17.13.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S4.T3.17.13.2" class="ltx_td ltx_align_left ltx_border_r">2.28</td>
<td id="S4.T3.17.13.3" class="ltx_td ltx_align_right">12.72</td>
<td id="S4.T3.17.13.4" class="ltx_td ltx_align_right ltx_border_r">7.88</td>
<td id="S4.T3.17.13.5" class="ltx_td ltx_align_right">9.62</td>
<td id="S4.T3.17.13.6" class="ltx_td ltx_align_right">6.11</td>
</tr>
<tr id="S4.T3.17.22" class="ltx_tr">
<td id="S4.T3.17.22.1" class="ltx_td ltx_align_left ltx_border_bb">  LQ-LoRA (<span id="S4.T3.17.22.1.1" class="ltx_text ltx_font_typewriter">2.75-bits, g128, 64-rank, Fisher</span>)</td>
<td id="S4.T3.17.22.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">2.95, 2.85</td>
<td id="S4.T3.17.22.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="S4.T3.17.22.3.1" class="ltx_text ltx_font_bold">7.60</span></td>
<td id="S4.T3.17.22.4" class="ltx_td ltx_align_right ltx_border_bb ltx_border_r">5.88</td>
<td id="S4.T3.17.22.5" class="ltx_td ltx_align_right ltx_border_bb"><span id="S4.T3.17.22.5.1" class="ltx_text ltx_font_bold">5.67</span></td>
<td id="S4.T3.17.22.6" class="ltx_td ltx_align_right ltx_border_bb"><span id="S4.T3.17.22.6.1" class="ltx_text ltx_font_bold">3.65</span></td>
</tr>
</tbody></table>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Analysis</h3>

<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Mixed-configuration quantization.</h4>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.1">우리는 주어진 행렬에 대한 매개변수당 평균 비트로 측정된 양자화 구성의 할당을 그림 <a class="ltx_ref" href="#S4.F4" title="Figure 4 ‣ Memory requirements. ‣ 4.3 Analysis ‣ 4 Empirical Study ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">4</span></a>에서 보여준다. 각 플롯은 <math alttext="2.75" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><mn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">2.75</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><cn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1">2.75</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">2.75</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.1.m1.1d">2.75</annotation></semantics></math> 목표 비트 레이트에 대한 ILP의 결정을 표시한다. ILP는 서로 다른 구성을 서로 다른 매트릭스에 할당할 수 있으며 이 결정은 실제로 피셔 가중 변형과 비피셔 가중 변형 간에 다르다.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">LoRA ranks.</h4>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.1">우리는 표 <a class="ltx_ref" href="#S5.T4" title="Table 4 ‣ 5 Discussion and Limitations ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">4</span></a>에서 LLaMA-2-7b 모델을 사용하여 LoRA 랭크가 양자화 구성을 NF-3(즉, 3.127 bits/param)에 미치는 영향을 조사한다. QLoRA는 LoRA 순위에 상대적으로 둔감하다. 그러나 LQ-LoRA는 초기화의 오류를 최소화하기 위해 추가 랭크를 "더 나은"으로 사용할 수 있으며, 이는 다운스트림 성능을 향상시킨다.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Memory requirements.</h4>

<div id="S4.SS3.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS3.SSS0.Px3.p1.1">그림 <a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ Memory requirements. ‣ 4.3 Analysis ‣ 4 Empirical Study ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">3</span></a>에서 우리는 서로 다른 비트율에 대해 모델을 저장하는 데 필요한 메모리를 보여주며, 양자화되지 않은 성분, 양자화된 성분 및 LoRA 파라미터에 의해 분해된다. 서브-3-비트로의 양자화는 모델을 실행하는 데 필요한 메모리를 크게 감소시킨다. 서브-3 비트에서, 40GB를 갖는 단일 GPU 상에서 70B 모델을 실행하는 것이 가능해진다. 파인튜닝은 활성화 및 LoRA 구배/최적화 상태에 필요한 메모리로 인해 더 많은 메모리를 필요로 한다. 그러나 배치 크기 2 및 시퀀스 길이 2048의 단일 80GB GPU에서 하위 3비트 70B 모델에서 전체 순방향/후방 패스를 실행할 수 있다.</p>
</div>
<figure id="S4.F3" class="ltx_figure ltx_align_floatright"><img src="https://ar5iv.labs.arxiv.org/html/2311.12023/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="342" height="171" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 3:</span>Storage in GB (y-axis) vs. 비트(x축), 양자화된 파라미터, LoRA 파라미터 및 기타(예를 들어, 임베딩)에 의해 분해된다. 16비트의 LLAMA-2 7B와 70B는 각각 14GB와 139GB가 필요하다.</figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2311.12023/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="753" height="160" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 4:</span>ILP가 할당한 비트/param의 Visualization of the bits/param broken down by matrix type. y축은 비트/파라미터이고, x축은 레이어 번호를 나타낸다. 목표 비트율 2.75비트에 대한 QLoRA, LQ-LoRA 및 Fisher-weighted LQ-LoRA의 할당을 보인다.</figcaption>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion and Limitations</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S5.p1.1">우리의 간단한 반복 알고리즘은 경험적으로 효과적이나 궁극적으로 휴리스틱한 것으로 밝혀졌으며, 더 이론적으로 원칙화된 최적화 알고리즘이 도출될 수 있는지 보는 것은 흥미로울 것이다. 그리고 QLoRA와 비교를 가능하게 하기 위해 NF 양자화에 초점을 맞추었지만, 다른 양자화 접근법에 LQ 분해를 적용하면 추가 이득이 발생할 수 있다. 또한 ILP 기반 혼합 정밀도 양자화 분해를 혼합 정밀도 양자화 <em class="ltx_emph ltx_font_italic" id="S5.p1.1.1"> 및</em> 혼합 순위 분해로 확장하여 각 매트릭스에 서로 다른 랭크를 할당할 수 있도록 하는 것도 가능하다. <span class="ltx_note ltx_role_footnote" id="footnote13"><sup class="ltx_note_mark">13</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">13</sup><span class="ltx_tag ltx_tag_note">13</span>However, this may be suboptimal since the ILP only minimizes decomposition error, and not the final downstream performance. This could be addressed by weighting the LoRA parameters as less costly (since the finetunable parameters contribute more for downstream performance) in the ILP.</span></span></span></p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S5.p2.3">또한 LQ-LoRA의 한계뿐만 아니라 몇 가지 부정적인 결과에 대해서도 논의한다. 우리는 매 <math alttext="K" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><mi id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><ci id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">italic_K</annotation></semantics></math> 그래디언트 단계들 후에 (예를 들어, 매 <math alttext="K" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><mi id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><ci id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">italic_K</annotation></semantics></math> 그래디언트 단계들 후에) 주기적으로 매트릭스를 재팩토라이징하는 것이 개선들을 산출하지 않는다는 것을 발견했다. <math alttext="\mathbf{L}_{1}" class="ltx_Math" display="inline" id="S5.p2.2.m2.1"><semantics id="S5.p2.2.m2.1a"><msub id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml"><mi id="S5.p2.2.m2.1.1.2" xref="S5.p2.2.m2.1.1.2.cmml">𝐋</mi><mn id="S5.p2.2.m2.1.1.3" xref="S5.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><apply id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p2.2.m2.1.1.1.cmml" xref="S5.p2.2.m2.1.1">subscript</csymbol><ci id="S5.p2.2.m2.1.1.2.cmml" xref="S5.p2.2.m2.1.1.2">𝐋</ci><cn id="S5.p2.2.m2.1.1.3.cmml" type="integer" xref="S5.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">\mathbf{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S5.p2.2.m2.1d">bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> 및 <math alttext="\mathbf{L}_{2}" class="ltx_Math" display="inline" id="S5.p2.3.m3.1"><semantics id="S5.p2.3.m3.1a"><msub id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml"><mi id="S5.p2.3.m3.1.1.2" xref="S5.p2.3.m3.1.1.2.cmml">𝐋</mi><mn id="S5.p2.3.m3.1.1.3" xref="S5.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.1b"><apply id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p2.3.m3.1.1.1.cmml" xref="S5.p2.3.m3.1.1">subscript</csymbol><ci id="S5.p2.3.m3.1.1.2.cmml" xref="S5.p2.3.m3.1.1.2">𝐋</ci><cn id="S5.p2.3.m3.1.1.3.cmml" type="integer" xref="S5.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.3.m3.1c">\mathbf{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S5.p2.3.m3.1d">bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>의 초기화가 당면한 작업에 최적이 아닐 수 있는 방식으로 모델을 스스로 적응하도록 배향할 수 있는 한, 저순위 컴포넌트의 "랭크"의 절반은 LQ-LoRA에서 오고, 나머지 절반은 표준 LoRA 초기화에서 오는 하이브리드 접근법을 시도했지만 결과를 개선하기 위해 이것을 찾지 못했다. 우리의 접근법은 또한 적응이 낮은 순위 업데이트를 통해 발생할 것이라는 사실에 크게 의존하므로 일반적으로 다른 매개변수 효율적인 미세 조정 방법에는 적용할 수 없다.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 4:</span>C4 및 WikiText perplexity as a function of LoRA ranks. QLoRA와 LQ-LoRA 모두에 대해 우리는 모든 레이어에 고정된 NF-3 구성을 사용했으며, 이는 평균 3.127비트/파라미터의 비용을 발생시킨다. 가장 오른쪽 열은 LLaMA-2-7b의 모든 행렬에 걸친 오차의 합을 나타내며, 이는 QLoRA의 경우 <math alttext="\left\|\mathbf{W}-\operatorname{Quantize}(\mathbf{W})\right\|_{F}^{2}" class="ltx_Math" display="inline" id="S5.T4.3.m1.3"><semantics id="S5.T4.3.m1.3b"><msubsup id="S5.T4.3.m1.3.3" xref="S5.T4.3.m1.3.3.cmml"><mrow id="S5.T4.3.m1.3.3.1.1.1" xref="S5.T4.3.m1.3.3.1.1.2.cmml"><mo id="S5.T4.3.m1.3.3.1.1.1.2" xref="S5.T4.3.m1.3.3.1.1.2.1.cmml">‖</mo><mrow id="S5.T4.3.m1.3.3.1.1.1.1" xref="S5.T4.3.m1.3.3.1.1.1.1.cmml"><mi id="S5.T4.3.m1.3.3.1.1.1.1.2" xref="S5.T4.3.m1.3.3.1.1.1.1.2.cmml">𝐖</mi><mo id="S5.T4.3.m1.3.3.1.1.1.1.1" xref="S5.T4.3.m1.3.3.1.1.1.1.1.cmml">−</mo><mrow id="S5.T4.3.m1.3.3.1.1.1.1.3.2" xref="S5.T4.3.m1.3.3.1.1.1.1.3.1.cmml"><mi id="S5.T4.3.m1.1.1" xref="S5.T4.3.m1.1.1.cmml">Quantize</mi><mo id="S5.T4.3.m1.3.3.1.1.1.1.3.2b" xref="S5.T4.3.m1.3.3.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S5.T4.3.m1.3.3.1.1.1.1.3.2.1" xref="S5.T4.3.m1.3.3.1.1.1.1.3.1.cmml"><mo id="S5.T4.3.m1.3.3.1.1.1.1.3.2.1.1" stretchy="false" xref="S5.T4.3.m1.3.3.1.1.1.1.3.1.cmml">(</mo><mi id="S5.T4.3.m1.2.2" xref="S5.T4.3.m1.2.2.cmml">𝐖</mi><mo id="S5.T4.3.m1.3.3.1.1.1.1.3.2.1.2" stretchy="false" xref="S5.T4.3.m1.3.3.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.T4.3.m1.3.3.1.1.1.3" xref="S5.T4.3.m1.3.3.1.1.2.1.cmml">‖</mo></mrow><mi id="S5.T4.3.m1.3.3.1.3" xref="S5.T4.3.m1.3.3.1.3.cmml">F</mi><mn id="S5.T4.3.m1.3.3.3" xref="S5.T4.3.m1.3.3.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S5.T4.3.m1.3c"><apply id="S5.T4.3.m1.3.3.cmml" xref="S5.T4.3.m1.3.3"><csymbol cd="ambiguous" id="S5.T4.3.m1.3.3.2.cmml" xref="S5.T4.3.m1.3.3">superscript</csymbol><apply id="S5.T4.3.m1.3.3.1.cmml" xref="S5.T4.3.m1.3.3"><csymbol cd="ambiguous" id="S5.T4.3.m1.3.3.1.2.cmml" xref="S5.T4.3.m1.3.3">subscript</csymbol><apply id="S5.T4.3.m1.3.3.1.1.2.cmml" xref="S5.T4.3.m1.3.3.1.1.1"><csymbol cd="latexml" id="S5.T4.3.m1.3.3.1.1.2.1.cmml" xref="S5.T4.3.m1.3.3.1.1.1.2">norm</csymbol><apply id="S5.T4.3.m1.3.3.1.1.1.1.cmml" xref="S5.T4.3.m1.3.3.1.1.1.1"><minus id="S5.T4.3.m1.3.3.1.1.1.1.1.cmml" xref="S5.T4.3.m1.3.3.1.1.1.1.1"></minus><ci id="S5.T4.3.m1.3.3.1.1.1.1.2.cmml" xref="S5.T4.3.m1.3.3.1.1.1.1.2">𝐖</ci><apply id="S5.T4.3.m1.3.3.1.1.1.1.3.1.cmml" xref="S5.T4.3.m1.3.3.1.1.1.1.3.2"><ci id="S5.T4.3.m1.1.1.cmml" xref="S5.T4.3.m1.1.1">Quantize</ci><ci id="S5.T4.3.m1.2.2.cmml" xref="S5.T4.3.m1.2.2">𝐖</ci></apply></apply></apply><ci id="S5.T4.3.m1.3.3.1.3.cmml" xref="S5.T4.3.m1.3.3.1.3">𝐹</ci></apply><cn id="S5.T4.3.m1.3.3.3.cmml" type="integer" xref="S5.T4.3.m1.3.3.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.m1.3d">\left\|\mathbf{W}-\operatorname{Quantize}(\mathbf{W})\right\|_{F}^{2}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.3.m1.3e">∥ bold_W - roman_Quantize ( bold_W ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>에 해당하고 LQ-LoRA의 경우 <math alttext="\left\|\mathbf{W}-\left(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2}\right)\right\|_{F}^{2}" class="ltx_Math" display="inline" id="S5.T4.4.m2.1"><semantics id="S5.T4.4.m2.1b"><msubsup id="S5.T4.4.m2.1.1" xref="S5.T4.4.m2.1.1.cmml"><mrow id="S5.T4.4.m2.1.1.1.1.1" xref="S5.T4.4.m2.1.1.1.1.2.cmml"><mo id="S5.T4.4.m2.1.1.1.1.1.2" xref="S5.T4.4.m2.1.1.1.1.2.1.cmml">‖</mo><mrow id="S5.T4.4.m2.1.1.1.1.1.1" xref="S5.T4.4.m2.1.1.1.1.1.1.cmml"><mi id="S5.T4.4.m2.1.1.1.1.1.1.3" xref="S5.T4.4.m2.1.1.1.1.1.1.3.cmml">𝐖</mi><mo id="S5.T4.4.m2.1.1.1.1.1.1.2" xref="S5.T4.4.m2.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S5.T4.4.m2.1.1.1.1.1.1.1.1" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S5.T4.4.m2.1.1.1.1.1.1.1.1.2" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.2" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.1" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐋</mi><mn id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.3" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.1" lspace="0px" rspace="0px" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.1.cmml"></mo><msub id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.2" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐋</mi><mn id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.3" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S5.T4.4.m2.1.1.1.1.1.1.1.1.3" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.T4.4.m2.1.1.1.1.1.3" xref="S5.T4.4.m2.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S5.T4.4.m2.1.1.1.3" xref="S5.T4.4.m2.1.1.1.3.cmml">F</mi><mn id="S5.T4.4.m2.1.1.3" xref="S5.T4.4.m2.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S5.T4.4.m2.1c"><apply id="S5.T4.4.m2.1.1.cmml" xref="S5.T4.4.m2.1.1"><csymbol cd="ambiguous" id="S5.T4.4.m2.1.1.2.cmml" xref="S5.T4.4.m2.1.1">superscript</csymbol><apply id="S5.T4.4.m2.1.1.1.cmml" xref="S5.T4.4.m2.1.1"><csymbol cd="ambiguous" id="S5.T4.4.m2.1.1.1.2.cmml" xref="S5.T4.4.m2.1.1">subscript</csymbol><apply id="S5.T4.4.m2.1.1.1.1.2.cmml" xref="S5.T4.4.m2.1.1.1.1.1"><csymbol cd="latexml" id="S5.T4.4.m2.1.1.1.1.2.1.cmml" xref="S5.T4.4.m2.1.1.1.1.1.2">norm</csymbol><apply id="S5.T4.4.m2.1.1.1.1.1.1.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1"><minus id="S5.T4.4.m2.1.1.1.1.1.1.2.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.2"></minus><ci id="S5.T4.4.m2.1.1.1.1.1.1.3.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.3">𝐖</ci><apply id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1"><plus id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.2">𝐐</ci><apply id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3"><times id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.2">𝐋</ci><cn id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.2">𝐋</ci><cn id="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S5.T4.4.m2.1.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><ci id="S5.T4.4.m2.1.1.1.3.cmml" xref="S5.T4.4.m2.1.1.1.3">𝐹</ci></apply><cn id="S5.T4.4.m2.1.1.3.cmml" type="integer" xref="S5.T4.4.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.m2.1d">\left\|\mathbf{W}-\left(\mathbf{Q}+\mathbf{L}_{1}\mathbf{L}_{2}\right)\right\|_{F}^{2}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.4.m2.1e">∥ bold_W - ( bold_Q + bold_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>에 해당한다.</figcaption>
<table id="S5.T4.8" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody><tr id="S5.T4.8.5" class="ltx_tr">
<td id="S5.T4.8.5.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S5.T4.8.5.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S5.T4.8.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S5.T4.8.5.2.1" class="ltx_text ltx_font_bold">LoRA rank</span></td>
<td id="S5.T4.8.5.3" class="ltx_td ltx_align_right ltx_border_tt"><span id="S5.T4.8.5.3.1" class="ltx_text ltx_font_bold">C4</span></td>
<td id="S5.T4.8.5.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_tt"><span id="S5.T4.8.5.4.1" class="ltx_text ltx_font_bold">WikiText</span></td>
<td id="S5.T4.8.5.5" class="ltx_td ltx_align_right ltx_border_tt"><span id="S5.T4.8.5.5.1" class="ltx_text ltx_font_bold">Error</span></td>
</tr>
<tr id="S5.T4.8.6" class="ltx_tr">
<td id="S5.T4.8.6.1" class="ltx_td ltx_align_left ltx_border_t">QLoRA 3-bit</td>
<td id="S5.T4.8.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">32</td>
<td id="S5.T4.8.6.3" class="ltx_td ltx_align_right ltx_border_t">8.21</td>
<td id="S5.T4.8.6.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">6.75</td>
<td id="S5.T4.8.6.5" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S5.T4.5.1" class="ltx_tr">
<td id="S5.T4.5.1.2" class="ltx_td ltx_align_left">(3.127 bits/param)</td>
<td id="S5.T4.5.1.3" class="ltx_td ltx_align_left ltx_border_r">64</td>
<td id="S5.T4.5.1.4" class="ltx_td ltx_align_right">8.21</td>
<td id="S5.T4.5.1.5" class="ltx_td ltx_align_right ltx_border_r">6.76</td>
<td id="S5.T4.5.1.1" class="ltx_td ltx_align_right"><math id="S5.T4.5.1.1.m1.1" class="ltx_Math" alttext="9.83\times 10^{4}" display="inline"><semantics id="S5.T4.5.1.1.m1.1a"><mrow id="S5.T4.5.1.1.m1.1.1" xref="S5.T4.5.1.1.m1.1.1.cmml"><mn id="S5.T4.5.1.1.m1.1.1.2" xref="S5.T4.5.1.1.m1.1.1.2.cmml">9.83</mn><mo lspace="0.222em" rspace="0.222em" id="S5.T4.5.1.1.m1.1.1.1" xref="S5.T4.5.1.1.m1.1.1.1.cmml">×</mo><msup id="S5.T4.5.1.1.m1.1.1.3" xref="S5.T4.5.1.1.m1.1.1.3.cmml"><mn id="S5.T4.5.1.1.m1.1.1.3.2" xref="S5.T4.5.1.1.m1.1.1.3.2.cmml">10</mn><mn id="S5.T4.5.1.1.m1.1.1.3.3" xref="S5.T4.5.1.1.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.5.1.1.m1.1b"><apply id="S5.T4.5.1.1.m1.1.1.cmml" xref="S5.T4.5.1.1.m1.1.1"><times id="S5.T4.5.1.1.m1.1.1.1.cmml" xref="S5.T4.5.1.1.m1.1.1.1"></times><cn type="float" id="S5.T4.5.1.1.m1.1.1.2.cmml" xref="S5.T4.5.1.1.m1.1.1.2">9.83</cn><apply id="S5.T4.5.1.1.m1.1.1.3.cmml" xref="S5.T4.5.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T4.5.1.1.m1.1.1.3.1.cmml" xref="S5.T4.5.1.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S5.T4.5.1.1.m1.1.1.3.2.cmml" xref="S5.T4.5.1.1.m1.1.1.3.2">10</cn><cn type="integer" id="S5.T4.5.1.1.m1.1.1.3.3.cmml" xref="S5.T4.5.1.1.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.1.1.m1.1c">9.83\times 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.5.1.1.m1.1d">9.83 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr id="S5.T4.8.7" class="ltx_tr">
<td id="S5.T4.8.7.1" class="ltx_td"></td>
<td id="S5.T4.8.7.2" class="ltx_td ltx_align_left ltx_border_r">128</td>
<td id="S5.T4.8.7.3" class="ltx_td ltx_align_right">8.21</td>
<td id="S5.T4.8.7.4" class="ltx_td ltx_align_right ltx_border_r">6.76</td>
<td id="S5.T4.8.7.5" class="ltx_td"></td>
</tr>
<tr id="S5.T4.6.2" class="ltx_tr">
<td id="S5.T4.6.2.2" class="ltx_td ltx_align_left ltx_border_t">LQ-LoRA 3-bit</td>
<td id="S5.T4.6.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">32</td>
<td id="S5.T4.6.2.4" class="ltx_td ltx_align_right ltx_border_t">8.02</td>
<td id="S5.T4.6.2.5" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">6.61</td>
<td id="S5.T4.6.2.1" class="ltx_td ltx_align_right ltx_border_t"><math id="S5.T4.6.2.1.m1.1" class="ltx_Math" alttext="7.99\times 10^{4}" display="inline"><semantics id="S5.T4.6.2.1.m1.1a"><mrow id="S5.T4.6.2.1.m1.1.1" xref="S5.T4.6.2.1.m1.1.1.cmml"><mn id="S5.T4.6.2.1.m1.1.1.2" xref="S5.T4.6.2.1.m1.1.1.2.cmml">7.99</mn><mo lspace="0.222em" rspace="0.222em" id="S5.T4.6.2.1.m1.1.1.1" xref="S5.T4.6.2.1.m1.1.1.1.cmml">×</mo><msup id="S5.T4.6.2.1.m1.1.1.3" xref="S5.T4.6.2.1.m1.1.1.3.cmml"><mn id="S5.T4.6.2.1.m1.1.1.3.2" xref="S5.T4.6.2.1.m1.1.1.3.2.cmml">10</mn><mn id="S5.T4.6.2.1.m1.1.1.3.3" xref="S5.T4.6.2.1.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.6.2.1.m1.1b"><apply id="S5.T4.6.2.1.m1.1.1.cmml" xref="S5.T4.6.2.1.m1.1.1"><times id="S5.T4.6.2.1.m1.1.1.1.cmml" xref="S5.T4.6.2.1.m1.1.1.1"></times><cn type="float" id="S5.T4.6.2.1.m1.1.1.2.cmml" xref="S5.T4.6.2.1.m1.1.1.2">7.99</cn><apply id="S5.T4.6.2.1.m1.1.1.3.cmml" xref="S5.T4.6.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T4.6.2.1.m1.1.1.3.1.cmml" xref="S5.T4.6.2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S5.T4.6.2.1.m1.1.1.3.2.cmml" xref="S5.T4.6.2.1.m1.1.1.3.2">10</cn><cn type="integer" id="S5.T4.6.2.1.m1.1.1.3.3.cmml" xref="S5.T4.6.2.1.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.2.1.m1.1c">7.99\times 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.6.2.1.m1.1d">7.99 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr id="S5.T4.7.3" class="ltx_tr">
<td id="S5.T4.7.3.2" class="ltx_td ltx_align_left">(3.127 bits/param)</td>
<td id="S5.T4.7.3.3" class="ltx_td ltx_align_left ltx_border_r">64</td>
<td id="S5.T4.7.3.4" class="ltx_td ltx_align_right">7.93</td>
<td id="S5.T4.7.3.5" class="ltx_td ltx_align_right ltx_border_r">6.51</td>
<td id="S5.T4.7.3.1" class="ltx_td ltx_align_right"><math id="S5.T4.7.3.1.m1.1" class="ltx_Math" alttext="7.12\times 10^{4}" display="inline"><semantics id="S5.T4.7.3.1.m1.1a"><mrow id="S5.T4.7.3.1.m1.1.1" xref="S5.T4.7.3.1.m1.1.1.cmml"><mn id="S5.T4.7.3.1.m1.1.1.2" xref="S5.T4.7.3.1.m1.1.1.2.cmml">7.12</mn><mo lspace="0.222em" rspace="0.222em" id="S5.T4.7.3.1.m1.1.1.1" xref="S5.T4.7.3.1.m1.1.1.1.cmml">×</mo><msup id="S5.T4.7.3.1.m1.1.1.3" xref="S5.T4.7.3.1.m1.1.1.3.cmml"><mn id="S5.T4.7.3.1.m1.1.1.3.2" xref="S5.T4.7.3.1.m1.1.1.3.2.cmml">10</mn><mn id="S5.T4.7.3.1.m1.1.1.3.3" xref="S5.T4.7.3.1.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.7.3.1.m1.1b"><apply id="S5.T4.7.3.1.m1.1.1.cmml" xref="S5.T4.7.3.1.m1.1.1"><times id="S5.T4.7.3.1.m1.1.1.1.cmml" xref="S5.T4.7.3.1.m1.1.1.1"></times><cn type="float" id="S5.T4.7.3.1.m1.1.1.2.cmml" xref="S5.T4.7.3.1.m1.1.1.2">7.12</cn><apply id="S5.T4.7.3.1.m1.1.1.3.cmml" xref="S5.T4.7.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T4.7.3.1.m1.1.1.3.1.cmml" xref="S5.T4.7.3.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S5.T4.7.3.1.m1.1.1.3.2.cmml" xref="S5.T4.7.3.1.m1.1.1.3.2">10</cn><cn type="integer" id="S5.T4.7.3.1.m1.1.1.3.3.cmml" xref="S5.T4.7.3.1.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.7.3.1.m1.1c">7.12\times 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.7.3.1.m1.1d">7.12 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr id="S5.T4.8.4" class="ltx_tr">
<td id="S5.T4.8.4.2" class="ltx_td ltx_border_bb"></td>
<td id="S5.T4.8.4.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">128</td>
<td id="S5.T4.8.4.4" class="ltx_td ltx_align_right ltx_border_bb">7.84</td>
<td id="S5.T4.8.4.5" class="ltx_td ltx_align_right ltx_border_bb ltx_border_r">6.46</td>
<td id="S5.T4.8.4.1" class="ltx_td ltx_align_right ltx_border_bb"><math id="S5.T4.8.4.1.m1.1" class="ltx_Math" alttext="5.98\times 10^{4}" display="inline"><semantics id="S5.T4.8.4.1.m1.1a"><mrow id="S5.T4.8.4.1.m1.1.1" xref="S5.T4.8.4.1.m1.1.1.cmml"><mn id="S5.T4.8.4.1.m1.1.1.2" xref="S5.T4.8.4.1.m1.1.1.2.cmml">5.98</mn><mo lspace="0.222em" rspace="0.222em" id="S5.T4.8.4.1.m1.1.1.1" xref="S5.T4.8.4.1.m1.1.1.1.cmml">×</mo><msup id="S5.T4.8.4.1.m1.1.1.3" xref="S5.T4.8.4.1.m1.1.1.3.cmml"><mn id="S5.T4.8.4.1.m1.1.1.3.2" xref="S5.T4.8.4.1.m1.1.1.3.2.cmml">10</mn><mn id="S5.T4.8.4.1.m1.1.1.3.3" xref="S5.T4.8.4.1.m1.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.8.4.1.m1.1b"><apply id="S5.T4.8.4.1.m1.1.1.cmml" xref="S5.T4.8.4.1.m1.1.1"><times id="S5.T4.8.4.1.m1.1.1.1.cmml" xref="S5.T4.8.4.1.m1.1.1.1"></times><cn type="float" id="S5.T4.8.4.1.m1.1.1.2.cmml" xref="S5.T4.8.4.1.m1.1.1.2">5.98</cn><apply id="S5.T4.8.4.1.m1.1.1.3.cmml" xref="S5.T4.8.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T4.8.4.1.m1.1.1.3.1.cmml" xref="S5.T4.8.4.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S5.T4.8.4.1.m1.1.1.3.2.cmml" xref="S5.T4.8.4.1.m1.1.1.3.2">10</cn><cn type="integer" id="S5.T4.8.4.1.m1.1.1.3.3.cmml" xref="S5.T4.8.4.1.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.8.4.1.m1.1c">5.98\times 10^{4}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.8.4.1.m1.1d">5.98 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody></table>
</figure>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2>

<section id="S6.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Parameter-efficient finetuning.</h4>

<div id="S6.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S6.SS0.SSS0.Px1.p1.1">우리의 작업은 매개변수 효율적인 미세 조정과 밀접하게 관련되어 있다. 인기 있는 방법에는 훈련 가능한 레이어를 삽입하는 Adapters <cite class="ltx_cite ltx_citemacro_citep">(Houlsby et al., <a class="ltx_ref" href="#bib.bib17" title="">2019</a>; Mahabadi et al., <a class="ltx_ref" href="#bib.bib36" title="">2021</a>)</cite>, 연속 프롬프트를 최적화하는 프롬프트 튜닝 <cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Liang, <a class="ltx_ref" href="#bib.bib28" title="">2021</a>; Lester et al., <a class="ltx_ref" href="#bib.bib27" title="">2021</a>)</cite>, 파라미터 벡터 <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="#bib.bib14" title="">2021</a>; Zaken et al., <a class="ltx_ref" href="#bib.bib63" title="">2022</a>; Sung et al., <a class="ltx_ref" href="#bib.bib45" title="">2021</a>; Hu et al., <a class="ltx_ref" href="#bib.bib19" title="">2022</a>)</cite>의 하위 부분을 업데이트하는 다른 방법이 있다. (일부) 파라미터-효율적인 미세조정 방법들은 고정된 파라미터들과 연관된 최적화기 상태들을 저장할 필요가 없기 때문에 미세조정에 필요한 GPU 메모리를 감소시킬 수 있다. 최근 연구에서는 매개 변수 효율적인 미세 조정 방법을 양자화 <cite class="ltx_cite ltx_citemacro_citep">(Kwon et al., <a class="ltx_ref" href="#bib.bib24" title="">2022</a>; Dettmers et al., <a class="ltx_ref" href="#bib.bib9" title="">2023a</a>; Chai et al., <a class="ltx_ref" href="#bib.bib5" title="">2023</a>)</cite>와 결합했다.</p>
</div>
</section>
<section id="S6.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Low-rank plus sparse/quantized matrix decomposition.</h4>

<div id="S6.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S6.SS0.SSS0.Px2.p1.1">데이터 매트릭스를 낮은 순위 매트릭스와 희소 매트릭스(강력한 PCA라고도 함)로 분해하는 것은 이론 및 적용된 관점들 <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="#bib.bib32" title="">2010</a>; Zhou &amp; Tao, <a class="ltx_ref" href="#bib.bib67" title="">2011</a>; <a class="ltx_ref" href="#bib.bib68" title="">2013</a>; Liu et al., <a class="ltx_ref" href="#bib.bib33" title="">2013</a>; Aravkin et al., <a class="ltx_ref" href="#bib.bib1" title="">2014</a>; Hintermuller &amp; Wu, <a class="ltx_ref" href="#bib.bib16" title="">2014</a>; Yi et al., <a class="ltx_ref" href="#bib.bib61" title="">2016</a>; Zhang &amp; Yang, <a class="ltx_ref" href="#bib.bib65" title="">2017</a>, <span class="ltx_text ltx_font_italic" id="S6.SS0.SSS0.Px2.p1.1.1.1">inter alia</span>)</cite> 모두에서 잘 연구된다. 딥러닝 내에서 강력한 PCA는 이전에 100M 미만의 매개변수 <cite class="ltx_cite ltx_citemacro_citep">(Chen &amp; Ranftl, <a class="ltx_ref" href="#bib.bib6" title="">2018</a>; Cai et al., <a class="ltx_ref" href="#bib.bib3" title="">2021</a>)</cite>를 가진 더 작은 모델을 압축하는 데 적용되었다. citetsaha2023matrix는 사전 훈련된 행렬의 양자화된 저순위 근사치를 얻기 위해 스케치 기법을 사용한다. 최근 동시대 작업 <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="#bib.bib29" title="">2023</a>)</cite>도 LLM 적응을 위해 저순위 플러스 양자화 분해를 수행한다.</p>
</div>
</section>
<section id="S6.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">LLM compression.</h4>

<div id="S6.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S6.SS0.SSS0.Px3.p1.1">1B 미만의 매개변수 <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="#bib.bib7" title="">2021</a>; Tukan et al., <a class="ltx_ref" href="#bib.bib52" title="">2021</a>; Tahaei et al., <a class="ltx_ref" href="#bib.bib46" title="">2021</a>)</cite>를 갖는 더 작은 LLM의 저순위 압축에 대한 많은 연구가 있었지만, 1B+ LLM에 대한 저순위 접근법은 아직 분석되지 않은 상태로 남아 있는데, 이는 LLM의 사전 훈련된 행렬의 특이값이 천천히 <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="#bib.bib7" title="">2021</a>)</cite>로 붕괴되는 것으로 발견되었기 때문일 수 있다. 따라서 LLM 압축을 위한 기존의 접근법들은 일반적으로 양자화에 초점을 맞추었다. 최근 많은 연구가 데이터 인식 양자화 전략 <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et al., <a class="ltx_ref" href="#bib.bib8" title="">2022</a>; Xiao et al., <a class="ltx_ref" href="#bib.bib57" title="">2022</a>; Dettmers et al., <a class="ltx_ref" href="#bib.bib10" title="">2023b</a>; Frantar et al., <a class="ltx_ref" href="#bib.bib13" title="">2022</a>; Kim et al., <a class="ltx_ref" href="#bib.bib21" title="">2023b</a>; Lin et al., <a class="ltx_ref" href="#bib.bib31" title="">2023</a>)</cite>에 초점을 맞추고 있다.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S7.p1.1">본 논문에서는 미리 훈련된 행렬들을 낮은 계층과 양자화된 성분으로 분해하는 LoRA의 간단한 확장을 제안한다. 여기서 양자화 성분은 동적 구성 전략을 사용할 수 있다. 언어 모델링, 명령어 튜닝 및 GLUE 벤치마크에 걸쳐 주어진 양자화 수준에 대해 강한 기준선에 비해 의미 있는 개선을 산출하기 위해 이 낮은 순위 플러스 양자화 분해 접근법을 관찰했다.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="Sx1.p1.1">허민영, 왕홍이, 이샤푸리, 현대42닷 연구팀원들이 도움이 되는 댓글과 토론에 감사드린다. 우리는 또한 옴니퀀트에 관한 명확한 질문들에 대해 멍자오 첸에게 감사한다. 에릭 싱과 한궈는 마이크로소프트 박사 펠로우십, NGA HM04762010002, NSF IIS1955532, NSF CNS2008248, NIGMS R01GM140467, NSF IIS2123952, NSF BCS2040381, 아마존 연구상, NSF IIS2311990, DARPA ECOLE HR00112390063의 지원을 인정한다. 이 연구는 현대 자동차 그룹과 MIT-IBM 왓슨 AI의 기금으로 지원되었다.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aravkin et&nbsp;al. (2014)</span>
<span class="ltx_bibblock">
A.&nbsp;Aravkin, S.&nbsp;Becker, V.&nbsp;Cevher, and P.&nbsp;Olsen.

</span>
<span class="ltx_bibblock">A variational approach to stable principal component pursuit.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Conference on Uncertainty in Artificial Intelligence (UAI)</em>,
July 2014.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bubeck et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Sébastien Bubeck, Varun Chandrasekaran, Ronen Eldan, Johannes Gehrke, Eric
Horvitz, Ece Kamar, Peter Lee, Yin&nbsp;Tat Lee, Yuanzhi Li, Scott Lundberg,
Harsha Nori, Hamid Palangi, Marco&nbsp;Tulio Ribeiro, and Yi&nbsp;Zhang.

</span>
<span class="ltx_bibblock">Sparks of Artificial General Intelligence: Early experiments with
GPT-4.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv:2303.12712</em>, 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
HanQin Cai, Jialin Liu, and Wotao Yin.

</span>
<span class="ltx_bibblock">Learned Robust PCA: A Scalable Deep Unfolding Approach for
High-Dimensional Outlier Detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv:2110.05649</em>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Candès et&nbsp;al. (2011)</span>
<span class="ltx_bibblock">
Emmanuel&nbsp;J Candès, Xiaodong Li, Yi&nbsp;Ma, and John Wright.

</span>
<span class="ltx_bibblock">Robust principal component analysis?

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Journal of the ACM (JACM)</em>, 58(3):1–37,
2011.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chai et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Yuji Chai, John Gkountouras, Glenn&nbsp;G Ko, David Brooks, and Gu-Yeon Wei.

</span>
<span class="ltx_bibblock">Int2. 1: Towards fine-tunable quantized large language models with
error correction through low-rank adaptation.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.08162</em>, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen &amp; Ranftl (2018)</span>
<span class="ltx_bibblock">
Jiahao Chen and Rene Ranftl.

</span>
<span class="ltx_bibblock">Deep robust pca using convolutional autoencoders.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">2018 IEEE International Conference on Acoustics, Speech and
Signal Processing (ICASSP)</em>, pp.&nbsp; 2836–2840. IEEE, 2018.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Patrick Chen, Hsiang-Fu Yu, Inderjit Dhillon, and Cho-Jui Hsieh.

</span>
<span class="ltx_bibblock">DRONE: Data-aware Low-rank Compression for Large NLP Models.

</span>
<span class="ltx_bibblock">In M.&nbsp;Ranzato, A.&nbsp;Beygelzimer, Y.&nbsp;Dauphin, P.S. Liang, and J.&nbsp;Wortman
Vaughan (eds.), <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume&nbsp;34, pp.&nbsp; 29321–29334. Curran Associates, Inc., 2021.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Tim Dettmers, Mike Lewis, Younes Belkada, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">LLM.int8(): 8-bit Matrix Multiplication for Transformers at Scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv:2208.07339</em>, 2022.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
Tim Dettmers, Artidoro Pagnoni, Ari Holtzman, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Qlora: Efficient finetuning of quantized llms.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.14314</em>, 2023a.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
Tim Dettmers, Ruslan Svirschevski, Vage Egiazarian, Denis Kuznedelev, Elias
Frantar, Saleh Ashkboos, Alexander Borzunov, Torsten Hoefler, and Dan
Alistarh.

</span>
<span class="ltx_bibblock">Spqr: A sparse-quantized representation for near-lossless llm weight
compression.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.03078</em>, 2023b.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Ning Ding, Yujia Qin, Guang Yang, Fuchao Wei, Zonghan Yang, Yusheng Su,
Shengding Hu, Yulin Chen, Chi-Min Chan, Weize Chen, Jing Yi, Weilin Zhao,
Xiaozhi Wang, Zhiyuan Liu, Hai-Tao Zheng, Jianfei Chen, Yang Liu, Jie Tang,
Juanzi Li, and Maosong Sun.

</span>
<span class="ltx_bibblock">Parameter-efficient fine-tuning of large-scale pre-trained language
models.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Nature Machine Intelligence</em>, 2023.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar &amp; Alistarh (2022)</span>
<span class="ltx_bibblock">
Elias Frantar and Dan Alistarh.

</span>
<span class="ltx_bibblock">Optimal brain compression: A framework for accurate post-training
quantization and pruning.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
35:4475–4488, 2022.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and Dan Alistarh.

</span>
<span class="ltx_bibblock">GPTQ: Accurate post-training compression for generative pretrained
transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.17323</em>, 2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Demi Guo, Alexander&nbsp;M. Rush, and Yoon Kim.

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning with diff pruning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of ACL</em>, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn
Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=d7KBjmI3GmQ" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=d7KBjmI3GmQ</a>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hintermuller &amp; Wu (2014)</span>
<span class="ltx_bibblock">
Michael Hintermuller and Tao Wu.

</span>
<span class="ltx_bibblock">Robust Principal Component Pursuit via Inexact Alternating
Minimization on Matrix Manifolds.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Journal of Mathematical Imaging</em>, 51:361–377, 2014.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Neil Houlsby, Andrei Giurgiu, Stanislaw Jastrzebski, Bruna Morrone, Quentin
De&nbsp;Laroussilhe, Andrea Gesmundo, Mona Attariyan, and Sylvain Gelly.

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning for nlp.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp;2790–2799. PMLR, 2019.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Yen-Chang Hsu, Ting Hua, Sungen Chang, Qian Lou, Yilin Shen, and Hongxia Jin.

</span>
<span class="ltx_bibblock">Language model compression with weighted low-rank factorization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Edward&nbsp;J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean
Wang, Lu&nbsp;Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">LoRA: Low-Rank Adaptation of Large Language Models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
Jeonghoon Kim, Jung&nbsp;Hyun Lee, Sungdong Kim, Joonsuk Park, Kang&nbsp;Min Yoo, Se&nbsp;Jung
Kwon, and Dongsoo Lee.

</span>
<span class="ltx_bibblock">Memory-efficient fine-tuning of compressed large language models via
sub-4-bit integer quantization.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.14152</em>, 2023a.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
Sehoon Kim, Coleman Hooper, Amir Gholami, Zhen Dong, Xiuyu Li, Sheng Shen,
Michael&nbsp;W Mahoney, and Kurt Keutzer.

</span>
<span class="ltx_bibblock">Squeezellm: Dense-and-sparse quantization.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.07629</em>, 2023b.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2015)</span>
<span class="ltx_bibblock">
Diederik&nbsp;P. Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A Method for Stochastic Optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of ICLR</em>, 2015.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kundu et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Souvik Kundu, Shikai Wang, Qirui Sun, Peter&nbsp;A Beerel, and Massoud Pedram.

</span>
<span class="ltx_bibblock">Bmpq: bit-gradient sensitivity-driven mixed-precision quantization of
dnns from scratch.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">2022 Design, Automation &amp; Test in Europe Conference &amp;
Exhibition (DATE)</em>, pp.&nbsp; 588–591. IEEE, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwon et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Se&nbsp;Jung Kwon, Jeonghoon Kim, Jeongin Bae, Kang&nbsp;Min Yoo, Jin-Hwa Kim, Baeseong
Park, Byeongwook Kim, Jung-Woo Ha, Nako Sung, and Dongsoo Lee.

</span>
<span class="ltx_bibblock">AlphaTuning: Quantization-aware parameter-efficient adaptation of
large-scale pre-trained language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics:
EMNLP 2022</em>, pp.&nbsp; 3288–3305, Abu Dhabi, United Arab Emirates, December
2022. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/2022.findings-emnlp.240" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2022.findings-emnlp.240</a>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Köpf et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Andreas Köpf, Yannic Kilcher, Dimitri von Rütte, Sotiris Anagnostidis,
Zhi-Rui Tam, Keith Stevens, Abdullah Barhoum, Nguyen&nbsp;Minh Duc, Oliver
Stanley, Richárd Nagyfi, Shahul ES, Sameer Suri, David Glushkov, Arnav
Dantuluri, Andrew Maguire, Christoph Schuhmann, Huu Nguyen, and Alexander
Mattick.

</span>
<span class="ltx_bibblock">OpenAssistant Conversations – Democratizing Large Language Model
Alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv:2304.07327</em>, 2023.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Changhun Lee, Jungyu Jin, Taesu Kim, Hyungjun Kim, and Eunhyeok Park.

</span>
<span class="ltx_bibblock">Owq: Lessons learned from activation outliers for weight quantization
in large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.02272</em>, 2023.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Brian Lester, Rami Al-Rfou, and Noah Constant.

</span>
<span class="ltx_bibblock">The power of scale for parameter-efficient prompt tuning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2021 Conference on Empirical Methods in
Natural Language Processing</em>, pp.&nbsp; 3045–3059, Online and Punta Cana,
Dominican Republic, November 2021. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/2021.emnlp-main.243" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2021.emnlp-main.243</a>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li &amp; Liang (2021)</span>
<span class="ltx_bibblock">
Xiang&nbsp;Lisa Li and Percy Liang.

</span>
<span class="ltx_bibblock">Prefix-tuning: Optimizing continuous prompts for generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of ACL</em>, August 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Yixiao Li, Yifan Yu, Chen Liang, Pengcheng He, Nikos Karampatziakis, Weizhu
Chen, and Tuo Zhao.

</span>
<span class="ltx_bibblock">Loftq: Lora-fine-tuning-aware quantization for large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.08659</em>, 2023.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2016)</span>
<span class="ltx_bibblock">
Yuanzhi Li, Yingyu Liang, and Andrej Risteski.

</span>
<span class="ltx_bibblock">Recovery guarantee of weighted low-rank approximation via alternating
minimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp;2358–2367. PMLR, 2016.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Ji&nbsp;Lin, Jiaming Tang, Haotian Tang, Shang Yang, Xingyu Dang, and Song Han.

</span>
<span class="ltx_bibblock">Awq: Activation-aware weight quantization for llm compression and
acceleration.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.00978</em>, 2023.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2010)</span>
<span class="ltx_bibblock">
Zhouchen Lin, Minming Chen, and Yi&nbsp;Ma.

</span>
<span class="ltx_bibblock">The Augmented Lagrange Multiplier Method for Exact Recovery of
Corrupted Low-Rank Matrices.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv:1009.5055</em>, 2010.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2013)</span>
<span class="ltx_bibblock">
Guangcan Liu, Zhouchen Lin, Shuicheng Yan, Ju&nbsp;Sun, Yong Yu, and Yi&nbsp;Ma.

</span>
<span class="ltx_bibblock">Robust recovery of subspace structures by low-rank representation.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine
Intelligence</em>, 35(1):171–184, 2013.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer
Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov.

</span>
<span class="ltx_bibblock">Roberta: A robustly optimized bert pretraining approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1907.11692</em>, 2019.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma &amp; Aybat (2018)</span>
<span class="ltx_bibblock">
Shiqian Ma and Necdet&nbsp;Serhat Aybat.

</span>
<span class="ltx_bibblock">Efficient Optimization Algorithms for Robust Principal Component
Analysis and Its Variants.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv:1806.03430</em>, 2018.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mahabadi et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Rabeeh&nbsp;Karimi Mahabadi, Sebastian Ruder, Mostafa Dehghani, and James Henderson.

</span>
<span class="ltx_bibblock">Parameter-efficient multi-task fine-tuning for transformers via
shared hypernetworks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 59th Annual Meeting of the Association
for Computational Linguistics and the 11th International Joint Conference on
Natural Language Processing (Volume 1: Long Papers)</em>, pp.&nbsp; 565–576, 2021.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Merity et&nbsp;al. (2016)</span>
<span class="ltx_bibblock">
Stephen Merity, Caiming Xiong, James Bradbury, and Richard Socher.

</span>
<span class="ltx_bibblock">Pointer sentinel mixture models, 2016.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">GPT-4 Technical Report.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv:2303.08774</em>, 2023.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeff Wu, Xu&nbsp;Jiang, Diogo Almeida, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human
feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv:2203.02155</em>, 2022.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Razenshteyn et&nbsp;al. (2016)</span>
<span class="ltx_bibblock">
Ilya Razenshteyn, Zhao Song, and David&nbsp;P Woodruff.

</span>
<span class="ltx_bibblock">Weighted low rank approximations with provable guarantees.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the forty-eighth annual ACM symposium on
Theory of Computing</em>, pp.&nbsp; 250–263, 2016.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Jie Ren, Samyam Rajbhandari, Reza&nbsp;Yazdani Aminabadi, Olatunji Ruwase, Shuangyan
Yang, Minjia Zhang, Dong Li, and Yuxiong He.

</span>
<span class="ltx_bibblock"><math id="bib.bib41.1.m1.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="bib.bib41.1.m1.1a"><mo stretchy="false" id="bib.bib41.1.m1.1.1" xref="bib.bib41.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib41.1.m1.1b"><ci id="bib.bib41.1.m1.1.1.cmml" xref="bib.bib41.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib41.1.m1.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib41.1.m1.1d">{</annotation></semantics></math>ZeRO-Offload<math id="bib.bib41.2.m2.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="bib.bib41.2.m2.1a"><mo stretchy="false" id="bib.bib41.2.m2.1.1" xref="bib.bib41.2.m2.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib41.2.m2.1b"><ci id="bib.bib41.2.m2.1.1.cmml" xref="bib.bib41.2.m2.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib41.2.m2.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib41.2.m2.1d">}</annotation></semantics></math>: Democratizing <math id="bib.bib41.3.m3.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="bib.bib41.3.m3.1a"><mo stretchy="false" id="bib.bib41.3.m3.1.1" xref="bib.bib41.3.m3.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib41.3.m3.1b"><ci id="bib.bib41.3.m3.1.1.cmml" xref="bib.bib41.3.m3.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib41.3.m3.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib41.3.m3.1d">{</annotation></semantics></math>Billion-Scale<math id="bib.bib41.4.m4.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="bib.bib41.4.m4.1a"><mo stretchy="false" id="bib.bib41.4.m4.1.1" xref="bib.bib41.4.m4.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib41.4.m4.1b"><ci id="bib.bib41.4.m4.1.1.cmml" xref="bib.bib41.4.m4.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib41.4.m4.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib41.4.m4.1d">}</annotation></semantics></math> model
training.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.5.1" class="ltx_emph ltx_font_italic">2021 USENIX Annual Technical Conference (USENIX ATC 21)</em>,
pp.&nbsp; 551–564, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Scao et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Teven&nbsp;Le Scao, Angela Fan, Christopher Akiki, Ellie Pavlick, et&nbsp;al.

</span>
<span class="ltx_bibblock">BLOOM: A 176B-Parameter Open-Access Multilingual Language Model.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv:2211.05100</em>, 2022.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Wenqi Shao, Mengzhao Chen, Zhaoyang Zhang, Peng Xu, Lirui Zhao, Zhiqian Li,
Kaipeng Zhang, Peng Gao, Yu&nbsp;Qiao, and Ping Luo.

</span>
<span class="ltx_bibblock">Omniquant: Omnidirectionally calibrated quantization for large
language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.13137</em>, 2023.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srebro &amp; Jaakkola (2003)</span>
<span class="ltx_bibblock">
Nathan Srebro and Tommi Jaakkola.

</span>
<span class="ltx_bibblock">Weighted low-rank approximations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th international conference on machine
learning (ICML-03)</em>, pp.&nbsp; 720–727, 2003.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sung et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Yi-Lin Sung, Varun Nair, and Colin&nbsp;A Raffel.

</span>
<span class="ltx_bibblock">Training neural networks with fixed sparse masks.

</span>
<span class="ltx_bibblock">In M.&nbsp;Ranzato, A.&nbsp;Beygelzimer, Y.&nbsp;Dauphin, P.S. Liang, and J.&nbsp;Wortman
Vaughan (eds.), <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume&nbsp;34, pp.&nbsp; 24193–24205. Curran Associates, Inc., 2021.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://proceedings.neurips.cc/paper/2021/file/cb2653f548f8709598e8b5156738cc51-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2021/file/cb2653f548f8709598e8b5156738cc51-Paper.pdf</a>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tahaei et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Marzieh&nbsp;S. Tahaei, Ella Charlaix, Vahid&nbsp;Partovi Nia, Ali Ghodsi, and Mehdi
Rezagholizadeh.

</span>
<span class="ltx_bibblock">KroneckerBERT: Learning Kronecker Decomposition for Pre-trained
Language Models via Knowledge Distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">arXiv:2109.06243</em>, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Chen Tang, Kai Ouyang, Zhi Wang, Yifei Zhu, Wen Ji, Yaowei Wang, and Wenwu Zhu.

</span>
<span class="ltx_bibblock">Mixed-precision neural network quantization via learned layer-wise
importance.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>, pp.&nbsp; 259–275.
Springer, 2022.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taori et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos
Guestrin, Percy Liang, and Tatsunori&nbsp;B. Hashimoto.

</span>
<span class="ltx_bibblock">Stanford alpaca: An instruction-following llama model.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/tatsu-lab/stanford_alpaca" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/tatsu-lab/stanford_alpaca</a>, 2023.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Team (2023)</span>
<span class="ltx_bibblock">
The&nbsp;Vicuna Team.

</span>
<span class="ltx_bibblock">Vicuna: An Open-Source Chatbot Impressing GPT-4 with 90%* ChatGPT
Quality.

</span>
<span class="ltx_bibblock">2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://lmsys.org/blog/2023-03-30-vicuna/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://lmsys.org/blog/2023-03-30-vicuna/</a>.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne
Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro,
Faisal Azhar, Aurelien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume
Lample.

</span>
<span class="ltx_bibblock">LLaMA: Open and Efficient Foundation Language Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">arXiv:2302.13971</em>, 2023a.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em>, 2023b.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tukan et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Murad Tukan, Alaa Maalouf, Matan Weksler, and Dan Feldman.

</span>
<span class="ltx_bibblock">No fine-tuning, no cry: Robust svd for compressing deep networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Sensors</em>, 21(16):5599, August 2021.

</span>
<span class="ltx_bibblock">ISSN 1424-3210.

</span>
<span class="ltx_bibblock">doi: <a href="10.3390/s21165599" title="" class="ltx_ref ltx_Url">10.3390/s21165599</a>.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tuzhilina &amp; Hastie (2021)</span>
<span class="ltx_bibblock">
Elena Tuzhilina and Trevor Hastie.

</span>
<span class="ltx_bibblock">Weighted low rank matrix approximation and acceleration.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.11057</em>, 2021.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
Alex Wang, Amanpreet Singh, Julian Michael, Felix Hill, Omer Levy, and Samuel&nbsp;R
Bowman.

</span>
<span class="ltx_bibblock">Glue: A multi-task benchmark and analysis platform for natural
language understanding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Yizhong Wang, Yeganeh Kordi, Swaroop Mishra, Alisa Liu, Noah&nbsp;A. Smith, Daniel
Khashabi, and Hannaneh Hajishirzi.

</span>
<span class="ltx_bibblock">Self-instruct: Aligning language models with self-generated
instructions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 61st Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pp.&nbsp; 13484–13508,
Toronto, Canada, July 2023.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wright et&nbsp;al. (2009)</span>
<span class="ltx_bibblock">
John Wright, Arvind Ganesh, Shankar Rao, Yigang Peng, and Yi&nbsp;Ma.

</span>
<span class="ltx_bibblock">Robust principal component analysis: Exact recovery of corrupted
low-rank matrices via convex optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume&nbsp;22, pp.&nbsp; 2080–2088, 2009.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Guangxuan Xiao, Ji&nbsp;Lin, Mickael Seznec, Hao Wu, Julien Demouth, and Song Han.

</span>
<span class="ltx_bibblock">SmoothQuant: Accurate and Efficient Post-Training Quantization for
Large Language Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv:2211.10438</em>, 2022.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Zhewei Yao, Zhen Dong, Zhangcheng Zheng, Amir Gholami, Jiali Yu, Eric Tan,
Leyuan Wang, Qijing Huang, Yida Wang, Michael Mahoney, et&nbsp;al.

</span>
<span class="ltx_bibblock">Hawq-v3: Dyadic neural network quantization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp;11875–11886. PMLR, 2021.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Zhewei Yao, Reza&nbsp;Yazdani Aminabadi, Minjia Zhang, Xiaoxia Wu, Conglong Li, and
Yuxiong He.

</span>
<span class="ltx_bibblock">ZeroQuant: Efficient and Affordable Post-Training Quantization for
Large-Scale Transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">arXiv:2206.01861</em>, 2022.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Zhewei Yao, Xiaoxia Wu, Cheng Li, Stephen Youn, and Yuxiong He.

</span>
<span class="ltx_bibblock">Zeroquant-v2: Exploring post-training quantization in llms from
comprehensive study to low rank compensation.

</span>
<span class="ltx_bibblock"><em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.08302</em>, 2023.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et&nbsp;al. (2016)</span>
<span class="ltx_bibblock">
Xinyang Yi, Dohyung Park, Yudong Chen, and Constantine Caramanis.

</span>
<span class="ltx_bibblock">Fast Algorithms for Robust PCA via Gradient Descent.

</span>
<span class="ltx_bibblock"><em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">arXiv:1605.07784</em>, 2016.

</span>
<span class="ltx_bibblock">v1, last revised v2.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yoshida (2023)</span>
<span class="ltx_bibblock">
Davis Yoshida.

</span>
<span class="ltx_bibblock">Nf4 isn’t information theoretically optimal (and that’s good).

</span>
<span class="ltx_bibblock"><em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.06965</em>, 2023.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zaken et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Elad&nbsp;Ben Zaken, Yoav Goldberg, and Shauli Ravfogel.

</span>
<span class="ltx_bibblock">Bitfit: Simple parameter-efficient fine-tuning for transformer-based
masked language-models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association
for Computational Linguistics (Volume 2: Short Papers)</em>, pp.&nbsp; 1–9, 2022.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Susan Zhang, Stephen Roller, Naman Goyal, Mikel Artetxe, et&nbsp;al.

</span>
<span class="ltx_bibblock">Opt: Open pre-trained transformer language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">arXiv:2205.01068</em>, 2022.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang &amp; Yang (2017)</span>
<span class="ltx_bibblock">
Teng Zhang and Yi&nbsp;Yang.

</span>
<span class="ltx_bibblock">Robust PCA by Manifold Optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">arXiv:1708.00257</em>, 2017.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Chunting Zhou, Pengfei Liu, Puxin Xu, Srini Iyer, Jiao Sun, Yuning Mao, Xuezhe
Ma, Avia Efrat, Ping Yu, Lili Yu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Lima: Less is more for alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.11206</em>, 2023.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou &amp; Tao (2011)</span>
<span class="ltx_bibblock">
Tianyi Zhou and Dacheng Tao.

</span>
<span class="ltx_bibblock">Godec: Randomized low-rank &amp; sparse matrix decomposition in noisy
case.

</span>
<span class="ltx_bibblock"><em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 28th International Conference on Machine
Learning (ICML-11)</em>, 2011.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou &amp; Tao (2013)</span>
<span class="ltx_bibblock">
Tianyi Zhou and Dacheng Tao.

</span>
<span class="ltx_bibblock">Greedy bilateral sketch, completion &amp; smoothing.

</span>
<span class="ltx_bibblock">In Carlos&nbsp;M. Carvalho and Pradeep Ravikumar (eds.), <em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the Sixteenth International Conference on Artificial Intelligence and
Statistics</em>, volume&nbsp;31, 2013.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation Details</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A1.p1.1">여기서 우리는 LQ-LoRA를 효율적으로 구현하기 위한 몇 가지 구현 세부 사항에 대해 논의한다.</p>
</div>
<figure id="A1.F5" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<figure id="A1.F5.sf1" class="ltx_figure ltx_flex_size_1 ltx_align_center"><img src="https://ar5iv.labs.arxiv.org/html/2311.12023/assets/x5.png" id="A1.F5.sf1.g1" class="ltx_graphics ltx_img_landscape" width="830" height="199" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a)</span>Run-times on A100 GPU</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<figure id="A1.F5.sf2" class="ltx_figure ltx_flex_size_1 ltx_align_center"><img src="https://ar5iv.labs.arxiv.org/html/2311.12023/assets/x6.png" id="A1.F5.sf2.g1" class="ltx_graphics ltx_img_landscape" width="830" height="199" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b)</span>Run-times on A6000 GPU</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 5:</span></figcaption>
A100/A6000 GPU runtime to perform <math id="A1.F5.4.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A1.F5.4.m1.1b"><mn id="A1.F5.4.m1.1.1" xref="A1.F5.4.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.F5.4.m1.1c"><cn type="integer" id="A1.F5.4.m1.1.1.cmml" xref="A1.F5.4.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F5.4.m1.1d">100</annotation><annotation encoding="application/x-llamapun" id="A1.F5.4.m1.1e">100</annotation></semantics></math> matrix-matrix multiplications in <span id="A1.F5.10.1" class="ltx_text ltx_font_typewriter">fp32</span> between input data and quantized matrices (which involves on the fly dequantization). <span id="A1.F5.11.2" class="ltx_text ltx_font_typewriter">bitsandbytes</span> (<span id="A1.F5.12.3" class="ltx_text ltx_font_typewriter">bnb</span>)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dettmers et&nbsp;al., <a href="#bib.bib9" title="" class="ltx_ref">2023a</a>)</cite> has separate implementations for training and for inference (matrix-vector multiplications, leftmost figure). We use the same quantization configuration as NF-<math id="A1.F5.5.m2.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A1.F5.5.m2.1b"><mn id="A1.F5.5.m2.1.1" xref="A1.F5.5.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.F5.5.m2.1c"><cn type="integer" id="A1.F5.5.m2.1.1.cmml" xref="A1.F5.5.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F5.5.m2.1d">4</annotation><annotation encoding="application/x-llamapun" id="A1.F5.5.m2.1e">4</annotation></semantics></math> and vary the first-level bits (<math id="A1.F5.6.m3.4" class="ltx_Math" alttext="2,3,4,8" display="inline"><semantics id="A1.F5.6.m3.4b"><mrow id="A1.F5.6.m3.4.5.2" xref="A1.F5.6.m3.4.5.1.cmml"><mn id="A1.F5.6.m3.1.1" xref="A1.F5.6.m3.1.1.cmml">2</mn><mo id="A1.F5.6.m3.4.5.2.1" xref="A1.F5.6.m3.4.5.1.cmml">,</mo><mn id="A1.F5.6.m3.2.2" xref="A1.F5.6.m3.2.2.cmml">3</mn><mo id="A1.F5.6.m3.4.5.2.2" xref="A1.F5.6.m3.4.5.1.cmml">,</mo><mn id="A1.F5.6.m3.3.3" xref="A1.F5.6.m3.3.3.cmml">4</mn><mo id="A1.F5.6.m3.4.5.2.3" xref="A1.F5.6.m3.4.5.1.cmml">,</mo><mn id="A1.F5.6.m3.4.4" xref="A1.F5.6.m3.4.4.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F5.6.m3.4c"><list id="A1.F5.6.m3.4.5.1.cmml" xref="A1.F5.6.m3.4.5.2"><cn type="integer" id="A1.F5.6.m3.1.1.cmml" xref="A1.F5.6.m3.1.1">2</cn><cn type="integer" id="A1.F5.6.m3.2.2.cmml" xref="A1.F5.6.m3.2.2">3</cn><cn type="integer" id="A1.F5.6.m3.3.3.cmml" xref="A1.F5.6.m3.3.3">4</cn><cn type="integer" id="A1.F5.6.m3.4.4.cmml" xref="A1.F5.6.m3.4.4">8</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.F5.6.m3.4d">2,3,4,8</annotation><annotation encoding="application/x-llamapun" id="A1.F5.6.m3.4e">2 , 3 , 4 , 8</annotation></semantics></math>) for consistent comparisons.
</figcaption>
</figure>
<section id="A1.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">PyTorch-based mixed-quantization.</h4>

<div id="A1.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A1.SS0.SSS0.Px1.p1.1">가중치 전용 양자화 기술은 일반적으로 하위 8비트 행렬을 기본적으로 지원되는 데이터 형식(예: <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px1.p1.1.1">int8</span>)으로 패킹한 다음, 역양자화 동안 float-point 형식으로 패키징을 풀어야 합니다. 이와 같이, 기존의 구현들은 종종 특정 양자화 구성에 의존하는 커스텀 CUDA 확장을 요구하여, 혼합 양자화 전략들로 확장하는 것을 어렵게 한다. 우리의 구현은 빠른 실험과 동적 양자화 전략의 구현을 위해 전적으로 PyTorch를 기반으로 한다. PyTorch의 <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px1.p1.1.2">__torch_dispatch__</span> 기능을 사용하여 duck-type <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px1.p1.1.3">torch.Tensor</span>,<span class="ltx_note ltx_role_footnote" id="footnote14"><sup class="ltx_note_mark">14</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">14</sup><span class="ltx_tag ltx_tag_note">14</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://dev-discuss.pytorch.org/t/what-and-why-is-torch-dispatch/557" target="_blank" title="">https://dev-discuss.pytorch.org/t/what-and-why-is-torch-dispatch/557</a></span></span></span>을 사용하여 PyTorch 연산에서 추가 및 행렬 곱셈과 같은 동작을 재정의합니다. 그런 다음 PyTorch의 (풀 그래프) 컴파일러를 사용하여 다음 작업을 컴파일합니다. (1) 비트-언패킹, (2) 역양자화, (3) <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px1.p1.1.4">add</span> 및 <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px1.p1.1.5">matmul</span> 및 (4) 트랜스포즈 및 캐스팅(<span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px1.p1.1.6">bf16</span> 트레이닝의 경우). LoRA 핀튜닝을 위해, 우리는 이 PyTorch 기반 구현(컴파일에 의해 후속)이 QLoRA의 <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px1.p1.1.7">bitsandbytes</span> 구현,<span class="ltx_note ltx_role_footnote" id="footnote15"><sup class="ltx_note_mark">15</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">15</sup><span class="ltx_tag ltx_tag_note">15</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/TimDettmers/bitsandbytes" target="_blank" title="">https://github.com/TimDettmers/bitsandbytes</a></span></span></span>은 4비트 NF 양자화에 맞춰진 CUDA 확장에 크게 의존하는 것을 관찰했다.</p>
</div>
</section>
<section id="A1.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">LoRA optimizer offloading.</h4>

<div id="A1.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A1.SS0.SSS0.Px2.p1.2">또한 우리는 선택적으로 CPU 기반 최적화기 <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a class="ltx_ref" href="#bib.bib41" title="">2021</a>)</cite>와 함께 작업하며, 이는 <cite class="ltx_cite ltx_citemacro_citet">Dettmers et al. (<a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite>에서 제안된 페이지 가능 최적화기를 확장한다. 이 구현은 LoRA에서 파라미터의 작은 부분만이 훈련될 필요가 있고, 이는 CPU에 대한 계산뿐만 아니라 CPU와 GPU 사이의 데이터 이동을 비교적 관리할 수 있게 한다는 사실을 이용한다. 우리는 CPU에서 훈련 가능한 파라미터의 복사본을 유지하고, CPU에서 파라미터 복사본을 최적화 단계를 실행하기 전에 GPU에서 CPU로 기울기를 오프로드하고, 이를 다시 GPU로 복사한다. 매트릭스당 최적화 단계와 CPU를 비동기 복사를 통해 GPU 이동과 겹친다. 가장 큰 700억 개의 파라미터 모델에서, 우리는 이 전략을 사용한 훈련 속도의 한계(<math alttext="{&lt;}2" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="A1.SS0.SSS0.Px2.p1.2.m2.1a"><mrow id="A1.SS0.SSS0.Px2.p1.2.m2.1.1" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="A1.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml"></mi><mo id="A1.SS0.SSS0.Px2.p1.2.m2.1.1.1" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml">&lt;</mo><mn id="A1.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="A1.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1"><lt id="A1.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1.1"></lt><csymbol cd="latexml" id="A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1.2">absent</csymbol><cn id="A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.p1.2.m2.1c">{&lt;}2</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px2.p1.2.m2.1d">&lt; 2</annotation></semantics></math>%) 증가만으로 <math alttext="14" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="A1.SS0.SSS0.Px2.p1.1.m1.1a"><mn id="A1.SS0.SSS0.Px2.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">14</mn><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.p1.1.m1.1b"><cn id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" type="integer" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1">14</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.p1.1.m1.1c">14</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px2.p1.1.m1.1d">14</annotation></semantics></math>% 메모리 절약에 주목했다.</p>
</div>
</section>
<section id="A1.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Runtimes.</h4>

<div id="A1.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A1.SS0.SSS0.Px3.p1.1">그림 <a class="ltx_ref" href="#A1.F5" title="Figure 5 ‣ Appendix A Implementation Details ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">5</span></a>는 <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px3.p1.1.1">FP32</span> 입력 데이터와 양자화된 행렬 간의 행렬 곱셈의 런-타임을 표시합니다. <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px3.p1.1.2">matmul</span>, 따라서 런타임은 <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px3.p1.1.3">FP32</span> <span class="ltx_text ltx_font_typewriter" id="A1.SS0.SSS0.Px3.p1.1.4">matmul</span> (dense)에 의해 하위 경계가 지정됩니다. 특히, 역양자화 오버헤드는 상당히 크기가 큰 행렬에 대해 상대적으로 작다.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Full Results</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A2.p1.1"><a class="ltx_ref" href="#A2.T5" title="Table 5 ‣ Appendix B Full Results ‣ LQ-LoRA: Low-rank Plus Quantized Matrix Decomposition for Efficient Language Model Finetuning"><span class="ltx_text ltx_ref_tag">5</span></a>는 LQ-LoRA vs. QLoRA와 GPT-LoRA.</p>
</div>
<figure id="A2.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 5: </span>LQ-LoRA LLaMA-2 models with rank = 64. C4/Wikipedia/MMLU results is based on finetuning on C4. Vicuna eval is based on the OpenAssistant dataset. QLoRA <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et al., <a class="ltx_ref" href="#bib.bib9" title="">2023a</a>)</cite> 및 GPTQ-LoRA는 자체 재구현을 기반으로 합니다.</figcaption>
<table id="A2.T5.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody><tr id="A2.T5.1.1" class="ltx_tr">
<td id="A2.T5.1.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="A2.T5.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="A2.T5.1.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="A2.T5.1.1.2.1" class="ltx_text ltx_font_bold">Bits per</span></td>
<td id="A2.T5.1.1.3" class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" colspan="2">
<span id="A2.T5.1.1.3.1" class="ltx_text ltx_font_bold">C4 (PPL) </span></td>
<td id="A2.T5.1.1.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" colspan="2">
<span id="A2.T5.1.1.4.1" class="ltx_text ltx_font_bold">WikiText (PPL)</span></td>
<td id="A2.T5.1.1.5" class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" colspan="2">
<span id="A2.T5.1.1.5.1" class="ltx_text ltx_font_bold">MMLU (acc.)</span></td>
<td id="A2.T5.1.1.6" class="ltx_td ltx_align_right ltx_border_tt" colspan="2">
<span id="A2.T5.1.1.6.1" class="ltx_text ltx_font_bold">Vicuna Eval</span></td>
</tr>
<tr id="A2.T5.1.2" class="ltx_tr">
<td id="A2.T5.1.2.1" class="ltx_td"></td>
<td id="A2.T5.1.2.2" class="ltx_td ltx_align_left ltx_border_r"><span id="A2.T5.1.2.2.1" class="ltx_text ltx_font_bold">param</span></td>
<td id="A2.T5.1.2.3" class="ltx_td ltx_align_right">70B</td>
<td id="A2.T5.1.2.4" class="ltx_td ltx_align_right ltx_border_r">7B</td>
<td id="A2.T5.1.2.5" class="ltx_td ltx_align_right">70B</td>
<td id="A2.T5.1.2.6" class="ltx_td ltx_align_right ltx_border_r">7B</td>
<td id="A2.T5.1.2.7" class="ltx_td ltx_align_right">70B</td>
<td id="A2.T5.1.2.8" class="ltx_td ltx_align_right ltx_border_r">7B</td>
<td id="A2.T5.1.2.9" class="ltx_td ltx_align_right">70B</td>
<td id="A2.T5.1.2.10" class="ltx_td ltx_align_right">7B</td>
</tr>
<tr id="A2.T5.1.3" class="ltx_tr">
<td id="A2.T5.1.3.1" class="ltx_td ltx_align_left ltx_border_t">Dense (no training)</td>
<td id="A2.T5.1.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">-</td>
<td id="A2.T5.1.3.3" class="ltx_td ltx_align_right ltx_border_t">6.50</td>
<td id="A2.T5.1.3.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">8.22</td>
<td id="A2.T5.1.3.5" class="ltx_td ltx_align_right ltx_border_t">3.68</td>
<td id="A2.T5.1.3.6" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">6.10</td>
<td id="A2.T5.1.3.7" class="ltx_td ltx_align_right ltx_border_t">0.70</td>
<td id="A2.T5.1.3.8" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.46</td>
<td id="A2.T5.1.3.9" class="ltx_td ltx_align_right ltx_border_t">-</td>
<td id="A2.T5.1.3.10" class="ltx_td ltx_align_right ltx_border_t">-</td>
</tr>
<tr id="A2.T5.1.4" class="ltx_tr">
<td id="A2.T5.1.4.1" class="ltx_td ltx_align_left">Dense (full finetuning)</td>
<td id="A2.T5.1.4.2" class="ltx_td ltx_align_left ltx_border_r">-</td>
<td id="A2.T5.1.4.3" class="ltx_td ltx_align_right">-</td>
<td id="A2.T5.1.4.4" class="ltx_td ltx_align_right ltx_border_r">-</td>
<td id="A2.T5.1.4.5" class="ltx_td ltx_align_right">-</td>
<td id="A2.T5.1.4.6" class="ltx_td ltx_align_right ltx_border_r">-</td>
<td id="A2.T5.1.4.7" class="ltx_td ltx_align_right">-</td>
<td id="A2.T5.1.4.8" class="ltx_td ltx_align_right ltx_border_r">-</td>
<td id="A2.T5.1.4.9" class="ltx_td ltx_align_right">OOM</td>
<td id="A2.T5.1.4.10" class="ltx_td ltx_align_right">0.41</td>
</tr>
<tr id="A2.T5.1.5" class="ltx_tr">
<td id="A2.T5.1.5.1" class="ltx_td ltx_align_left ltx_border_t">QLoRA 3-bit</td>
<td id="A2.T5.1.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">3.127</td>
<td id="A2.T5.1.5.3" class="ltx_td ltx_align_right ltx_border_t">6.23</td>
<td id="A2.T5.1.5.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">8.21</td>
<td id="A2.T5.1.5.5" class="ltx_td ltx_align_right ltx_border_t">4.12</td>
<td id="A2.T5.1.5.6" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">6.76</td>
<td id="A2.T5.1.5.7" class="ltx_td ltx_align_right ltx_border_t">0.68</td>
<td id="A2.T5.1.5.8" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.43</td>
<td id="A2.T5.1.5.9" class="ltx_td ltx_align_right ltx_border_t">0.46</td>
<td id="A2.T5.1.5.10" class="ltx_td ltx_align_right ltx_border_t">0.33</td>
</tr>
<tr id="A2.T5.1.6" class="ltx_tr">
<td id="A2.T5.1.6.1" class="ltx_td ltx_align_left">QLoRA 4-bit</td>
<td id="A2.T5.1.6.2" class="ltx_td ltx_align_left ltx_border_r">4.127</td>
<td id="A2.T5.1.6.3" class="ltx_td ltx_align_right">6.01</td>
<td id="A2.T5.1.6.4" class="ltx_td ltx_align_right ltx_border_r">7.61</td>
<td id="A2.T5.1.6.5" class="ltx_td ltx_align_right">3.78</td>
<td id="A2.T5.1.6.6" class="ltx_td ltx_align_right ltx_border_r">6.25</td>
<td id="A2.T5.1.6.7" class="ltx_td ltx_align_right">0.70</td>
<td id="A2.T5.1.6.8" class="ltx_td ltx_align_right ltx_border_r">0.46</td>
<td id="A2.T5.1.6.9" class="ltx_td ltx_align_right">0.47</td>
<td id="A2.T5.1.6.10" class="ltx_td ltx_align_right">0.41</td>
</tr>
<tr id="A2.T5.1.7" class="ltx_tr">
<td id="A2.T5.1.7.1" class="ltx_td ltx_align_left ltx_border_t">GPTQ-LoRA 3-bit</td>
<td id="A2.T5.1.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">3.148</td>
<td id="A2.T5.1.7.3" class="ltx_td ltx_align_right ltx_border_t">6.34</td>
<td id="A2.T5.1.7.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">8.48</td>
<td id="A2.T5.1.7.5" class="ltx_td ltx_align_right ltx_border_t">4.33</td>
<td id="A2.T5.1.7.6" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">7.09</td>
<td id="A2.T5.1.7.7" class="ltx_td ltx_align_right ltx_border_t">0.67</td>
<td id="A2.T5.1.7.8" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.39</td>
<td id="A2.T5.1.7.9" class="ltx_td ltx_align_right ltx_border_t">-</td>
<td id="A2.T5.1.7.10" class="ltx_td ltx_align_right ltx_border_t">-</td>
</tr>
<tr id="A2.T5.1.8" class="ltx_tr">
<td id="A2.T5.1.8.1" class="ltx_td ltx_align_left">GPTQ-LoRA 4-bit</td>
<td id="A2.T5.1.8.2" class="ltx_td ltx_align_left ltx_border_r">4.156</td>
<td id="A2.T5.1.8.3" class="ltx_td ltx_align_right">6.03</td>
<td id="A2.T5.1.8.4" class="ltx_td ltx_align_right ltx_border_r">7.68</td>
<td id="A2.T5.1.8.5" class="ltx_td ltx_align_right">3.82</td>
<td id="A2.T5.1.8.6" class="ltx_td ltx_align_right ltx_border_r">6.29</td>
<td id="A2.T5.1.8.7" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.8.8" class="ltx_td ltx_align_right ltx_border_r">0.45</td>
<td id="A2.T5.1.8.9" class="ltx_td ltx_align_right">-</td>
<td id="A2.T5.1.8.10" class="ltx_td ltx_align_right">-</td>
</tr>
<tr id="A2.T5.1.9" class="ltx_tr">
<td id="A2.T5.1.9.1" class="ltx_td ltx_align_left ltx_align_top ltx_border_t" rowspan="7"><span id="A2.T5.1.9.1.1" class="ltx_text">QLoRA + ILP</span></td>
<td id="A2.T5.1.9.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">2.50</td>
<td id="A2.T5.1.9.3" class="ltx_td ltx_align_right ltx_border_t">2223.2</td>
<td id="A2.T5.1.9.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">2996.3</td>
<td id="A2.T5.1.9.5" class="ltx_td ltx_align_right ltx_border_t">3319.4</td>
<td id="A2.T5.1.9.6" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">4084.3</td>
<td id="A2.T5.1.9.7" class="ltx_td ltx_align_right ltx_border_t">0.23</td>
<td id="A2.T5.1.9.8" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.23</td>
<td id="A2.T5.1.9.9" class="ltx_td ltx_align_right ltx_border_t">0.00</td>
<td id="A2.T5.1.9.10" class="ltx_td ltx_align_right ltx_border_t">0.00</td>
</tr>
<tr id="A2.T5.1.10" class="ltx_tr">
<td id="A2.T5.1.10.1" class="ltx_td ltx_align_left ltx_border_r">2.75</td>
<td id="A2.T5.1.10.2" class="ltx_td ltx_align_right">2193.9</td>
<td id="A2.T5.1.10.3" class="ltx_td ltx_align_right ltx_border_r">2736.5</td>
<td id="A2.T5.1.10.4" class="ltx_td ltx_align_right">3292.6</td>
<td id="A2.T5.1.10.5" class="ltx_td ltx_align_right ltx_border_r">3932.2</td>
<td id="A2.T5.1.10.6" class="ltx_td ltx_align_right">0.23</td>
<td id="A2.T5.1.10.7" class="ltx_td ltx_align_right ltx_border_r">0.27</td>
<td id="A2.T5.1.10.8" class="ltx_td ltx_align_right">0.00</td>
<td id="A2.T5.1.10.9" class="ltx_td ltx_align_right">0.00</td>
</tr>
<tr id="A2.T5.1.11" class="ltx_tr">
<td id="A2.T5.1.11.1" class="ltx_td ltx_align_left ltx_border_r">3.00</td>
<td id="A2.T5.1.11.2" class="ltx_td ltx_align_right">1781.5</td>
<td id="A2.T5.1.11.3" class="ltx_td ltx_align_right ltx_border_r">1969.3</td>
<td id="A2.T5.1.11.4" class="ltx_td ltx_align_right">2587.0</td>
<td id="A2.T5.1.11.5" class="ltx_td ltx_align_right ltx_border_r">3091.0</td>
<td id="A2.T5.1.11.6" class="ltx_td ltx_align_right">0.23</td>
<td id="A2.T5.1.11.7" class="ltx_td ltx_align_right ltx_border_r">0.23</td>
<td id="A2.T5.1.11.8" class="ltx_td ltx_align_right">0.44</td>
<td id="A2.T5.1.11.9" class="ltx_td ltx_align_right">0.33</td>
</tr>
<tr id="A2.T5.1.12" class="ltx_tr">
<td id="A2.T5.1.12.1" class="ltx_td ltx_align_left ltx_border_r">3.25</td>
<td id="A2.T5.1.12.2" class="ltx_td ltx_align_right">6.15</td>
<td id="A2.T5.1.12.3" class="ltx_td ltx_align_right ltx_border_r">8.04</td>
<td id="A2.T5.1.12.4" class="ltx_td ltx_align_right">3.99</td>
<td id="A2.T5.1.12.5" class="ltx_td ltx_align_right ltx_border_r">6.66</td>
<td id="A2.T5.1.12.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.12.7" class="ltx_td ltx_align_right ltx_border_r">0.44</td>
<td id="A2.T5.1.12.8" class="ltx_td ltx_align_right">0.50</td>
<td id="A2.T5.1.12.9" class="ltx_td ltx_align_right">0.41</td>
</tr>
<tr id="A2.T5.1.13" class="ltx_tr">
<td id="A2.T5.1.13.1" class="ltx_td ltx_align_left ltx_border_r">3.50</td>
<td id="A2.T5.1.13.2" class="ltx_td ltx_align_right">6.10</td>
<td id="A2.T5.1.13.3" class="ltx_td ltx_align_right ltx_border_r">7.91</td>
<td id="A2.T5.1.13.4" class="ltx_td ltx_align_right">3.93</td>
<td id="A2.T5.1.13.5" class="ltx_td ltx_align_right ltx_border_r">6.51</td>
<td id="A2.T5.1.13.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.13.7" class="ltx_td ltx_align_right ltx_border_r">0.45</td>
<td id="A2.T5.1.13.8" class="ltx_td ltx_align_right">0.47</td>
<td id="A2.T5.1.13.9" class="ltx_td ltx_align_right">0.36</td>
</tr>
<tr id="A2.T5.1.14" class="ltx_tr">
<td id="A2.T5.1.14.1" class="ltx_td ltx_align_left ltx_border_r">3.75</td>
<td id="A2.T5.1.14.2" class="ltx_td ltx_align_right">6.06</td>
<td id="A2.T5.1.14.3" class="ltx_td ltx_align_right ltx_border_r">7.76</td>
<td id="A2.T5.1.14.4" class="ltx_td ltx_align_right">3.85</td>
<td id="A2.T5.1.14.5" class="ltx_td ltx_align_right ltx_border_r">6.39</td>
<td id="A2.T5.1.14.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.14.7" class="ltx_td ltx_align_right ltx_border_r">0.44</td>
<td id="A2.T5.1.14.8" class="ltx_td ltx_align_right">0.55</td>
<td id="A2.T5.1.14.9" class="ltx_td ltx_align_right">0.35</td>
</tr>
<tr id="A2.T5.1.15" class="ltx_tr">
<td id="A2.T5.1.15.1" class="ltx_td ltx_align_left ltx_border_r">4.00</td>
<td id="A2.T5.1.15.2" class="ltx_td ltx_align_right">6.02</td>
<td id="A2.T5.1.15.3" class="ltx_td ltx_align_right ltx_border_r">7.65</td>
<td id="A2.T5.1.15.4" class="ltx_td ltx_align_right">3.80</td>
<td id="A2.T5.1.15.5" class="ltx_td ltx_align_right ltx_border_r">6.29</td>
<td id="A2.T5.1.15.6" class="ltx_td ltx_align_right">0.70</td>
<td id="A2.T5.1.15.7" class="ltx_td ltx_align_right ltx_border_r">0.45</td>
<td id="A2.T5.1.15.8" class="ltx_td ltx_align_right">0.49</td>
<td id="A2.T5.1.15.9" class="ltx_td ltx_align_right">0.49</td>
</tr>
<tr id="A2.T5.1.16" class="ltx_tr">
<td id="A2.T5.1.16.1" class="ltx_td ltx_align_left ltx_align_top ltx_border_t" rowspan="7"><span id="A2.T5.1.16.1.1" class="ltx_text">LQ-LoRA</span></td>
<td id="A2.T5.1.16.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">2.50</td>
<td id="A2.T5.1.16.3" class="ltx_td ltx_align_right ltx_border_t">6.83</td>
<td id="A2.T5.1.16.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">10.00</td>
<td id="A2.T5.1.16.5" class="ltx_td ltx_align_right ltx_border_t">4.95</td>
<td id="A2.T5.1.16.6" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">8.44</td>
<td id="A2.T5.1.16.7" class="ltx_td ltx_align_right ltx_border_t">0.62</td>
<td id="A2.T5.1.16.8" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.31</td>
<td id="A2.T5.1.16.9" class="ltx_td ltx_align_right ltx_border_t">0.57</td>
<td id="A2.T5.1.16.10" class="ltx_td ltx_align_right ltx_border_t">0.23</td>
</tr>
<tr id="A2.T5.1.17" class="ltx_tr">
<td id="A2.T5.1.17.1" class="ltx_td ltx_align_left ltx_border_r">2.75</td>
<td id="A2.T5.1.17.2" class="ltx_td ltx_align_right">6.42</td>
<td id="A2.T5.1.17.3" class="ltx_td ltx_align_right ltx_border_r">8.95</td>
<td id="A2.T5.1.17.4" class="ltx_td ltx_align_right">4.44</td>
<td id="A2.T5.1.17.5" class="ltx_td ltx_align_right ltx_border_r">7.55</td>
<td id="A2.T5.1.17.6" class="ltx_td ltx_align_right">0.66</td>
<td id="A2.T5.1.17.7" class="ltx_td ltx_align_right ltx_border_r">0.31</td>
<td id="A2.T5.1.17.8" class="ltx_td ltx_align_right">0.56</td>
<td id="A2.T5.1.17.9" class="ltx_td ltx_align_right">0.38</td>
</tr>
<tr id="A2.T5.1.18" class="ltx_tr">
<td id="A2.T5.1.18.1" class="ltx_td ltx_align_left ltx_border_r">3.00</td>
<td id="A2.T5.1.18.2" class="ltx_td ltx_align_right">6.18</td>
<td id="A2.T5.1.18.3" class="ltx_td ltx_align_right ltx_border_r">8.09</td>
<td id="A2.T5.1.18.4" class="ltx_td ltx_align_right">4.08</td>
<td id="A2.T5.1.18.5" class="ltx_td ltx_align_right ltx_border_r">6.73</td>
<td id="A2.T5.1.18.6" class="ltx_td ltx_align_right">0.68</td>
<td id="A2.T5.1.18.7" class="ltx_td ltx_align_right ltx_border_r">0.41</td>
<td id="A2.T5.1.18.8" class="ltx_td ltx_align_right">0.59</td>
<td id="A2.T5.1.18.9" class="ltx_td ltx_align_right">0.47</td>
</tr>
<tr id="A2.T5.1.19" class="ltx_tr">
<td id="A2.T5.1.19.1" class="ltx_td ltx_align_left ltx_border_r">3.25</td>
<td id="A2.T5.1.19.2" class="ltx_td ltx_align_right">6.10</td>
<td id="A2.T5.1.19.3" class="ltx_td ltx_align_right ltx_border_r">7.83</td>
<td id="A2.T5.1.19.4" class="ltx_td ltx_align_right">3.95</td>
<td id="A2.T5.1.19.5" class="ltx_td ltx_align_right ltx_border_r">6.44</td>
<td id="A2.T5.1.19.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.19.7" class="ltx_td ltx_align_right ltx_border_r">0.44</td>
<td id="A2.T5.1.19.8" class="ltx_td ltx_align_right">0.56</td>
<td id="A2.T5.1.19.9" class="ltx_td ltx_align_right">0.56</td>
</tr>
<tr id="A2.T5.1.20" class="ltx_tr">
<td id="A2.T5.1.20.1" class="ltx_td ltx_align_left ltx_border_r">3.50</td>
<td id="A2.T5.1.20.2" class="ltx_td ltx_align_right">6.06</td>
<td id="A2.T5.1.20.3" class="ltx_td ltx_align_right ltx_border_r">7.75</td>
<td id="A2.T5.1.20.4" class="ltx_td ltx_align_right">3.88</td>
<td id="A2.T5.1.20.5" class="ltx_td ltx_align_right ltx_border_r">6.39</td>
<td id="A2.T5.1.20.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.20.7" class="ltx_td ltx_align_right ltx_border_r">0.46</td>
<td id="A2.T5.1.20.8" class="ltx_td ltx_align_right">0.55</td>
<td id="A2.T5.1.20.9" class="ltx_td ltx_align_right">0.45</td>
</tr>
<tr id="A2.T5.1.21" class="ltx_tr">
<td id="A2.T5.1.21.1" class="ltx_td ltx_align_left ltx_border_r">3.75</td>
<td id="A2.T5.1.21.2" class="ltx_td ltx_align_right">6.02</td>
<td id="A2.T5.1.21.3" class="ltx_td ltx_align_right ltx_border_r">7.64</td>
<td id="A2.T5.1.21.4" class="ltx_td ltx_align_right">3.80</td>
<td id="A2.T5.1.21.5" class="ltx_td ltx_align_right ltx_border_r">6.27</td>
<td id="A2.T5.1.21.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.21.7" class="ltx_td ltx_align_right ltx_border_r">0.45</td>
<td id="A2.T5.1.21.8" class="ltx_td ltx_align_right">0.65</td>
<td id="A2.T5.1.21.9" class="ltx_td ltx_align_right">0.40</td>
</tr>
<tr id="A2.T5.1.22" class="ltx_tr">
<td id="A2.T5.1.22.1" class="ltx_td ltx_align_left ltx_border_r">4.00</td>
<td id="A2.T5.1.22.2" class="ltx_td ltx_align_right">5.99</td>
<td id="A2.T5.1.22.3" class="ltx_td ltx_align_right ltx_border_r">7.57</td>
<td id="A2.T5.1.22.4" class="ltx_td ltx_align_right">3.77</td>
<td id="A2.T5.1.22.5" class="ltx_td ltx_align_right ltx_border_r">6.23</td>
<td id="A2.T5.1.22.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.22.7" class="ltx_td ltx_align_right ltx_border_r">0.46</td>
<td id="A2.T5.1.22.8" class="ltx_td ltx_align_right">0.66</td>
<td id="A2.T5.1.22.9" class="ltx_td ltx_align_right">0.44</td>
</tr>
<tr id="A2.T5.1.23" class="ltx_tr">
<td id="A2.T5.1.23.1" class="ltx_td ltx_align_left ltx_align_top ltx_border_bb ltx_border_t" rowspan="7"><span id="A2.T5.1.23.1.1" class="ltx_text">LQ-LoRA (Fisher)</span></td>
<td id="A2.T5.1.23.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">2.50</td>
<td id="A2.T5.1.23.3" class="ltx_td ltx_align_right ltx_border_t">6.72</td>
<td id="A2.T5.1.23.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">9.03</td>
<td id="A2.T5.1.23.5" class="ltx_td ltx_align_right ltx_border_t">4.80</td>
<td id="A2.T5.1.23.6" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">7.42</td>
<td id="A2.T5.1.23.7" class="ltx_td ltx_align_right ltx_border_t">0.67</td>
<td id="A2.T5.1.23.8" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.39</td>
<td id="A2.T5.1.23.9" class="ltx_td ltx_align_right ltx_border_t">0.59</td>
<td id="A2.T5.1.23.10" class="ltx_td ltx_align_right ltx_border_t">0.45</td>
</tr>
<tr id="A2.T5.1.24" class="ltx_tr">
<td id="A2.T5.1.24.1" class="ltx_td ltx_align_left ltx_border_r">2.75</td>
<td id="A2.T5.1.24.2" class="ltx_td ltx_align_right">6.35</td>
<td id="A2.T5.1.24.3" class="ltx_td ltx_align_right ltx_border_r">8.25</td>
<td id="A2.T5.1.24.4" class="ltx_td ltx_align_right">4.32</td>
<td id="A2.T5.1.24.5" class="ltx_td ltx_align_right ltx_border_r">6.78</td>
<td id="A2.T5.1.24.6" class="ltx_td ltx_align_right">0.67</td>
<td id="A2.T5.1.24.7" class="ltx_td ltx_align_right ltx_border_r">0.43</td>
<td id="A2.T5.1.24.8" class="ltx_td ltx_align_right">0.56</td>
<td id="A2.T5.1.24.9" class="ltx_td ltx_align_right">0.44</td>
</tr>
<tr id="A2.T5.1.25" class="ltx_tr">
<td id="A2.T5.1.25.1" class="ltx_td ltx_align_left ltx_border_r">3.00</td>
<td id="A2.T5.1.25.2" class="ltx_td ltx_align_right">6.14</td>
<td id="A2.T5.1.25.3" class="ltx_td ltx_align_right ltx_border_r">7.88</td>
<td id="A2.T5.1.25.4" class="ltx_td ltx_align_right">4.02</td>
<td id="A2.T5.1.25.5" class="ltx_td ltx_align_right ltx_border_r">6.48</td>
<td id="A2.T5.1.25.6" class="ltx_td ltx_align_right">0.68</td>
<td id="A2.T5.1.25.7" class="ltx_td ltx_align_right ltx_border_r">0.44</td>
<td id="A2.T5.1.25.8" class="ltx_td ltx_align_right">0.65</td>
<td id="A2.T5.1.25.9" class="ltx_td ltx_align_right">0.51</td>
</tr>
<tr id="A2.T5.1.26" class="ltx_tr">
<td id="A2.T5.1.26.1" class="ltx_td ltx_align_left ltx_border_r">3.25</td>
<td id="A2.T5.1.26.2" class="ltx_td ltx_align_right">6.08</td>
<td id="A2.T5.1.26.3" class="ltx_td ltx_align_right ltx_border_r">7.76</td>
<td id="A2.T5.1.26.4" class="ltx_td ltx_align_right">3.92</td>
<td id="A2.T5.1.26.5" class="ltx_td ltx_align_right ltx_border_r">6.40</td>
<td id="A2.T5.1.26.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.26.7" class="ltx_td ltx_align_right ltx_border_r">0.46</td>
<td id="A2.T5.1.26.8" class="ltx_td ltx_align_right">0.54</td>
<td id="A2.T5.1.26.9" class="ltx_td ltx_align_right">0.49</td>
</tr>
<tr id="A2.T5.1.27" class="ltx_tr">
<td id="A2.T5.1.27.1" class="ltx_td ltx_align_left ltx_border_r">3.50</td>
<td id="A2.T5.1.27.2" class="ltx_td ltx_align_right">6.04</td>
<td id="A2.T5.1.27.3" class="ltx_td ltx_align_right ltx_border_r">7.66</td>
<td id="A2.T5.1.27.4" class="ltx_td ltx_align_right">3.86</td>
<td id="A2.T5.1.27.5" class="ltx_td ltx_align_right ltx_border_r">6.31</td>
<td id="A2.T5.1.27.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.27.7" class="ltx_td ltx_align_right ltx_border_r">0.45</td>
<td id="A2.T5.1.27.8" class="ltx_td ltx_align_right">0.62</td>
<td id="A2.T5.1.27.9" class="ltx_td ltx_align_right">0.49</td>
</tr>
<tr id="A2.T5.1.28" class="ltx_tr">
<td id="A2.T5.1.28.1" class="ltx_td ltx_align_left ltx_border_r">3.75</td>
<td id="A2.T5.1.28.2" class="ltx_td ltx_align_right">6.01</td>
<td id="A2.T5.1.28.3" class="ltx_td ltx_align_right ltx_border_r">7.57</td>
<td id="A2.T5.1.28.4" class="ltx_td ltx_align_right">3.80</td>
<td id="A2.T5.1.28.5" class="ltx_td ltx_align_right ltx_border_r">6.24</td>
<td id="A2.T5.1.28.6" class="ltx_td ltx_align_right">0.69</td>
<td id="A2.T5.1.28.7" class="ltx_td ltx_align_right ltx_border_r">0.47</td>
<td id="A2.T5.1.28.8" class="ltx_td ltx_align_right">0.59</td>
<td id="A2.T5.1.28.9" class="ltx_td ltx_align_right">0.47</td>
</tr>
<tr id="A2.T5.1.29" class="ltx_tr">
<td id="A2.T5.1.29.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">4.00</td>
<td id="A2.T5.1.29.2" class="ltx_td ltx_align_right ltx_border_bb">5.98</td>
<td id="A2.T5.1.29.3" class="ltx_td ltx_align_right ltx_border_bb ltx_border_r">7.53</td>
<td id="A2.T5.1.29.4" class="ltx_td ltx_align_right ltx_border_bb">3.76</td>
<td id="A2.T5.1.29.5" class="ltx_td ltx_align_right ltx_border_bb ltx_border_r">6.20</td>
<td id="A2.T5.1.29.6" class="ltx_td ltx_align_right ltx_border_bb">0.70</td>
<td id="A2.T5.1.29.7" class="ltx_td ltx_align_right ltx_border_bb ltx_border_r">0.46</td>
<td id="A2.T5.1.29.8" class="ltx_td ltx_align_right ltx_border_bb">0.66</td>
<td id="A2.T5.1.29.9" class="ltx_td ltx_align_right ltx_border_bb">0.51</td>
</tr>
</tbody></table>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="https://ar5iv.labs.arxiv.org/html/2311.12022" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="https://ar5iv.labs.arxiv.org/"><img height="40" alt="ar5iv homepage" src="https://ar5iv.labs.arxiv.org/assets/ar5iv.png"></a>
    <a href="https://ar5iv.labs.arxiv.org/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="https://ar5iv.labs.arxiv.org/log/2311.12023" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+2311.12023">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2311.12023" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="https://ar5iv.labs.arxiv.org/html/2311.12024" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Dec  5 17:20:43 2023 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>