<html lang="en" data-theme="light"><head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models</title>
<!--Generated on Thu Jan 11 17:23:00 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2401.06066v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2401.06066v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
        <span class="color-scheme-icon" aria-label="Light mode"></span>
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="#myForm" onclick="event.preventDefault(); var modal = document.getElementById('myForm'); modal.style.display = 'block'; bugReportState.setInitiateWay('Header');">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2401.06066v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2401.06066v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
          <span class="color-scheme-icon"></span>
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S1" title="1 Introduction ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S2" title="2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries: Mixture-of-Experts for Transformers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="#S3" title="3 DeepSeekMoE Architecture ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>DeepSeekMoE Architecture</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#S3.SS1" title="3.1 Fine-Grained Expert Segmentation ‣ 3 DeepSeekMoE Architecture ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Fine-Grained Expert Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#S3.SS2" title="3.2 Shared Expert Isolation ‣ 3 DeepSeekMoE Architecture ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Shared Expert Isolation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S3.SS3" title="3.3 Load Balance Consideration ‣ 3 DeepSeekMoE Architecture ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Load Balance Consideration</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S3.SS3.SSS0.Px1" title="Expert-Level Balance Loss. ‣ 3.3 Load Balance Consideration ‣ 3 DeepSeekMoE Architecture ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Expert-Level Balance Loss.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S3.SS3.SSS0.Px2" title="Device-Level Balance Loss. ‣ 3.3 Load Balance Consideration ‣ 3 DeepSeekMoE Architecture ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Device-Level Balance Loss.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="#S4" title="4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Validation Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S4.SS1" title="4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S4.SS1.SSS1" title="4.1.1 Training Data and Tokenization ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Training Data and Tokenization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S4.SS1.SSS2" title="4.1.2 Infrastructures ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Infrastructures</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="#S4.SS1.SSS3" title="4.1.3 Hyper-Parameters ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.3 </span>Hyper-Parameters</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS1.SSS3.Px1" title="Model Settings. ‣ 4.1.3 Hyper-Parameters ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Model Settings.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS1.SSS3.Px2" title="Training Settings. ‣ 4.1.3 Hyper-Parameters ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Training Settings.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="#S4.SS1.SSS4" title="4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.4 </span>Evaluation Benchmarks</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS1.SSS4.Px1" title="Language Modeling. ‣ 4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Language Modeling.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS1.SSS4.Px2" title="Language Understanding and Reasoning. ‣ 4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Language Understanding and Reasoning.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS1.SSS4.Px3" title="Reading Comprehension. ‣ 4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Reading Comprehension.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS1.SSS4.Px4" title="Code Generation. ‣ 4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Code Generation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS1.SSS4.Px5" title="Closed-Book Question Answering. ‣ 4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Closed-Book Question Answering.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S4.SS2" title="4.2 Evaluations ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Evaluations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS2.SSS0.Px1" title="Baselines. ‣ 4.2 Evaluations ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS2.SSS0.Px2" title="Results. ‣ 4.2 Evaluations ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S4.SS3" title="4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>DeepSeekMoE Aligns Closely with the upper bound of MoE Models</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS3.SSS0.Px1" title="Comparison with GShard×1.5. ‣ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Comparison with GShard<math alttext="\times 1.5" class="ltx_Math" display="inline"><semantics><mrow><mi></mi><mo lspace="0.222em" rspace="0.222em">×</mo><mn>1.5</mn></mrow><annotation-xml encoding="MathML-Content"><apply><times></times><csymbol cd="latexml">absent</csymbol><cn type="float">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex">\times 1.5</annotation><annotation encoding="application/x-llamapun">× 1.5</annotation></semantics></math>.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS3.SSS0.Px2" title="Comparison with Dense×16. ‣ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Comparison with Dense<math alttext="\times 16" class="ltx_Math" display="inline"><semantics><mrow><mi></mi><mo lspace="0.222em" rspace="0.222em">×</mo><mn>16</mn></mrow><annotation-xml encoding="MathML-Content"><apply><times></times><csymbol cd="latexml">absent</csymbol><cn type="integer">16</cn></apply></annotation-xml><annotation encoding="application/x-tex">\times 16</annotation><annotation encoding="application/x-llamapun">× 16</annotation></semantics></math>.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S4.SS4" title="4.4 Ablation Studies ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Ablation Studies</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS4.SSS0.Px1" title="Shared Expert Isolation. ‣ 4.4 Ablation Studies ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Shared Expert Isolation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS4.SSS0.Px2" title="Fine-Grained Expert Segmentation. ‣ 4.4 Ablation Studies ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Fine-Grained Expert Segmentation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS4.SSS0.Px3" title="Ratios Between Shared and Routed Experts. ‣ 4.4 Ablation Studies ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Ratios Between Shared and Routed Experts.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S4.SS5" title="4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Analysis on Expert Specialization</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS5.SSS0.Px1" title="DeepSeekMoE Exhibits Lower Redundancy Among Routed Experts. ‣ 4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">DeepSeekMoE Exhibits Lower Redundancy Among Routed Experts.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS5.SSS0.Px2" title="Shared Experts Are Irreplaceable by Routed Experts. ‣ 4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Shared Experts Are Irreplaceable by Routed Experts.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S4.SS5.SSS0.Px3" title="DeepSeekMoE Acquires Knowledge More Accurately. ‣ 4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">DeepSeekMoE Acquires Knowledge More Accurately.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="#S5" title="5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Scaling up to DeepSeekMoE 16B</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S5.SS1" title="5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S5.SS1.SSS1" title="5.1.1 Training Data and Tokenization ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Training Data and Tokenization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="#S5.SS1.SSS2" title="5.1.2 Hyper-Parameters ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Hyper-Parameters</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS1.SSS2.Px1" title="Model Settings. ‣ 5.1.2 Hyper-Parameters ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Model Settings.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS1.SSS2.Px2" title="Training Settings. ‣ 5.1.2 Hyper-Parameters ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Training Settings.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="#S5.SS1.SSS3" title="5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span>Evaluation Benchmarks</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS1.SSS3.Px1" title="Language Modeling. ‣ 5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Language Modeling.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS1.SSS3.Px2" title="Reading Comprehension. ‣ 5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Reading Comprehension.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS1.SSS3.Px3" title="Math Reasoning. ‣ 5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Math Reasoning.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS1.SSS3.Px4" title="Multi-Subject Multiple-Choice. ‣ 5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Multi-Subject Multiple-Choice.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS1.SSS3.Px5" title="Disambiguation. ‣ 5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Disambiguation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS1.SSS3.Px6" title="Chinese Benchmarks. ‣ 5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Chinese Benchmarks.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS1.SSS3.Px7" title="Open LLM Leaderboard. ‣ 5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Open LLM Leaderboard.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S5.SS2" title="5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Evaluations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S5.SS2.SSS1" title="5.2.1 Internal Comparison with DeepSeek 7B ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.1 </span>Internal Comparison with DeepSeek 7B</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="#S5.SS2.SSS2" title="5.2.2 Comparison with Open Source Models ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.2 </span>Comparison with Open Source Models</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS2.SSS2.Px1" title="Internal Comparison with LLaMA2 7B. ‣ 5.2.2 Comparison with Open Source Models ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Internal Comparison with LLaMA2 7B.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S5.SS2.SSS2.Px2" title="Evaluation on Open LLM Leaderboard. ‣ 5.2.2 Comparison with Open Source Models ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Evaluation on Open LLM Leaderboard.</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="#S6" title="6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Alignment for DeepSeekMoE 16B</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S6.SS1" title="6.1 Experimental Setup ‣ 6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S6.SS1.SSS0.Px1" title="Training Data. ‣ 6.1 Experimental Setup ‣ 6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Training Data.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S6.SS1.SSS0.Px2" title="Hyper-Parameters. ‣ 6.1 Experimental Setup ‣ 6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Hyper-Parameters.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S6.SS1.SSS0.Px3" title="Evaluation Benchmarks. ‣ 6.1 Experimental Setup ‣ 6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Evaluation Benchmarks.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S6.SS2" title="6.2 Evaluations ‣ 6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Evaluations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S6.SS2.SSS0.Px1" title="Baselines. ‣ 6.2 Evaluations ‣ 6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S6.SS2.SSS0.Px2" title="Results. ‣ 6.2 Evaluations ‣ 6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="#S7" title="7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>DeepSeekMoE 145B Ongoing</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S7.SS1" title="7.1 Experimental Setup ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S7.SS1.SSS0.Px1" title="Training Data and Tokenization. ‣ 7.1 Experimental Setup ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Training Data and Tokenization.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S7.SS1.SSS0.Px2" title="Model Settings. ‣ 7.1 Experimental Setup ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Model Settings.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S7.SS1.SSS0.Px3" title="Training Settings. ‣ 7.1 Experimental Setup ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Training Settings.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S7.SS1.SSS0.Px4" title="Evaluation Benchmarks. ‣ 7.1 Experimental Setup ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Evaluation Benchmarks.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S7.SS2" title="7.2 Evaluations ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2 </span>Evaluations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S7.SS2.SSS0.Px1" title="Baselines. ‣ 7.2 Evaluations ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="#S7.SS2.SSS0.Px2" title="Results. ‣ 7.2 Evaluations ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S8" title="8 Related Work ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S9" title="9 Conclusion ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="#A1" title="Appendix A Overview of Hyper-Parameters ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Overview of Hyper-Parameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Comparing DeepSeekMoE with Larger Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="#A3" title="Appendix C Training Benchmark Curves of DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Training Benchmark Curves of DeepSeekMoE 16B</span></a></li>
</ol></nav>

<div class="ltx_page_content">
<div aria-label="”Conversion" been="" class="package-alerts ltx_document" errors="" found”="" have="" role="“status”">
<button aria-label="Dismiss alert" onclick="closePopup()">
<span aria-hidden="true"><svg aria-hidden="true" focusable="false" height="20" role="presentation" viewBox="0 0 44 44" width="20">
<path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
<path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
</svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button></span>
</button>
<p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul arial-label="Unsupported packages used in this paper">
<li>failed: dramatist</li>
</ul>
<p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div><div class="section" id="target-section"><div id="license-tr">License: arXiv.org perpetual non-exclusive license</div><div id="watermark-tr">arXiv:2401.06066v1 [cs.CL] 11 Jan 2024</div></div>
<script>
            function closePopup() {
                document.querySelector('.package-alerts').style.display = 'none';
            }
        </script>
<article class="ltx_document ltx_authors_1line"><span class="ltx_ERROR undefined" id="id1">\reportnumber</span>
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">001 


<span class="ltx_ERROR undefined" id="p1.1.1">\correspondingauthor</span>Contribution during internship at DeepSeek-AI.
















































































































































































 


































</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<h1 class="ltx_title ltx_title_document">
DeepSeekMoE: Towards Ultimate Expert Specialization in

<br class="ltx_break">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mixture-of-Experts Language Models
</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span class="ltx_text" id="id1.1.1" style="font-size:90%;">Damai Dai<math alttext="{}^{*1,2}" class="ltx_Math" display="inline" id="id1.1.1.m1.2"><semantics id="id1.1.1.m1.2a"><msup id="id1.1.1.m1.2.2" xref="id1.1.1.m1.2.2.cmml"><mi id="id1.1.1.m1.2.2a" xref="id1.1.1.m1.2.2.cmml"></mi><mrow id="id1.1.1.m1.2.2.2.2" xref="id1.1.1.m1.2.2.2.3.cmml"><mrow id="id1.1.1.m1.2.2.2.2.1" xref="id1.1.1.m1.2.2.2.2.1.cmml"><mi id="id1.1.1.m1.2.2.2.2.1.2" xref="id1.1.1.m1.2.2.2.2.1.2.cmml"></mi><mo id="id1.1.1.m1.2.2.2.2.1.1" lspace="0.222em" rspace="0.222em" xref="id1.1.1.m1.2.2.2.2.1.1.cmml">*</mo><mn id="id1.1.1.m1.2.2.2.2.1.3" xref="id1.1.1.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="id1.1.1.m1.2.2.2.2.2" xref="id1.1.1.m1.2.2.2.3.cmml">,</mo><mn id="id1.1.1.m1.1.1.1.1" xref="id1.1.1.m1.1.1.1.1.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id1.1.1.m1.2b"><apply id="id1.1.1.m1.2.2.cmml" xref="id1.1.1.m1.2.2"><list id="id1.1.1.m1.2.2.2.3.cmml" xref="id1.1.1.m1.2.2.2.2"><apply id="id1.1.1.m1.2.2.2.2.1.cmml" xref="id1.1.1.m1.2.2.2.2.1"><times id="id1.1.1.m1.2.2.2.2.1.1.cmml" xref="id1.1.1.m1.2.2.2.2.1.1"></times><csymbol cd="latexml" id="id1.1.1.m1.2.2.2.2.1.2.cmml" xref="id1.1.1.m1.2.2.2.2.1.2">absent</csymbol><cn id="id1.1.1.m1.2.2.2.2.1.3.cmml" type="integer" xref="id1.1.1.m1.2.2.2.2.1.3">1</cn></apply><cn id="id1.1.1.m1.1.1.1.1.cmml" type="integer" xref="id1.1.1.m1.1.1.1.1">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.1.m1.2c">{}^{*1,2}</annotation><annotation encoding="application/x-llamapun" id="id1.1.1.m1.2d">start_FLOATSUPERSCRIPT * 1 , 2 end_FLOATSUPERSCRIPT</annotation></semantics></math></span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chengqi Deng<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id2.1.m1.1"><semantics id="id2.1.m1.1a"><msup id="id2.1.m1.1.1" xref="id2.1.m1.1.1.cmml"><mi id="id2.1.m1.1.1a" xref="id2.1.m1.1.1.cmml"></mi><mn id="id2.1.m1.1.1.1" xref="id2.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id2.1.m1.1b"><apply id="id2.1.m1.1.1.cmml" xref="id2.1.m1.1.1"><cn id="id2.1.m1.1.1.1.cmml" type="integer" xref="id2.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id2.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chenggang Zhao<math alttext="{}^{*1,3}" class="ltx_Math" display="inline" id="id3.1.m1.2"><semantics id="id3.1.m1.2a"><msup id="id3.1.m1.2.2" xref="id3.1.m1.2.2.cmml"><mi id="id3.1.m1.2.2a" xref="id3.1.m1.2.2.cmml"></mi><mrow id="id3.1.m1.2.2.2.2" xref="id3.1.m1.2.2.2.3.cmml"><mrow id="id3.1.m1.2.2.2.2.1" xref="id3.1.m1.2.2.2.2.1.cmml"><mi id="id3.1.m1.2.2.2.2.1.2" xref="id3.1.m1.2.2.2.2.1.2.cmml"></mi><mo id="id3.1.m1.2.2.2.2.1.1" lspace="0.222em" rspace="0.222em" xref="id3.1.m1.2.2.2.2.1.1.cmml">*</mo><mn id="id3.1.m1.2.2.2.2.1.3" xref="id3.1.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="id3.1.m1.2.2.2.2.2" xref="id3.1.m1.2.2.2.3.cmml">,</mo><mn id="id3.1.m1.1.1.1.1" xref="id3.1.m1.1.1.1.1.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id3.1.m1.2b"><apply id="id3.1.m1.2.2.cmml" xref="id3.1.m1.2.2"><list id="id3.1.m1.2.2.2.3.cmml" xref="id3.1.m1.2.2.2.2"><apply id="id3.1.m1.2.2.2.2.1.cmml" xref="id3.1.m1.2.2.2.2.1"><times id="id3.1.m1.2.2.2.2.1.1.cmml" xref="id3.1.m1.2.2.2.2.1.1"></times><csymbol cd="latexml" id="id3.1.m1.2.2.2.2.1.2.cmml" xref="id3.1.m1.2.2.2.2.1.2">absent</csymbol><cn id="id3.1.m1.2.2.2.2.1.3.cmml" type="integer" xref="id3.1.m1.2.2.2.2.1.3">1</cn></apply><cn id="id3.1.m1.1.1.1.1.cmml" type="integer" xref="id3.1.m1.1.1.1.1">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.1.m1.2c">{}^{*1,3}</annotation><annotation encoding="application/x-llamapun" id="id3.1.m1.2d">start_FLOATSUPERSCRIPT * 1 , 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
R.X. Xu<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id4.1.m1.1"><semantics id="id4.1.m1.1a"><msup id="id4.1.m1.1.1" xref="id4.1.m1.1.1.cmml"><mi id="id4.1.m1.1.1a" xref="id4.1.m1.1.1.cmml"></mi><mn id="id4.1.m1.1.1.1" xref="id4.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id4.1.m1.1b"><apply id="id4.1.m1.1.1.cmml" xref="id4.1.m1.1.1"><cn id="id4.1.m1.1.1.1.cmml" type="integer" xref="id4.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id4.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Huazuo Gao<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id5.1.m1.1"><semantics id="id5.1.m1.1a"><msup id="id5.1.m1.1.1" xref="id5.1.m1.1.1.cmml"><mi id="id5.1.m1.1.1a" xref="id5.1.m1.1.1.cmml"></mi><mn id="id5.1.m1.1.1.1" xref="id5.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id5.1.m1.1b"><apply id="id5.1.m1.1.1.cmml" xref="id5.1.m1.1.1"><cn id="id5.1.m1.1.1.1.cmml" type="integer" xref="id5.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id5.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Deli Chen<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id6.1.m1.1"><semantics id="id6.1.m1.1a"><msup id="id6.1.m1.1.1" xref="id6.1.m1.1.1.cmml"><mi id="id6.1.m1.1.1a" xref="id6.1.m1.1.1.cmml"></mi><mn id="id6.1.m1.1.1.1" xref="id6.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id6.1.m1.1b"><apply id="id6.1.m1.1.1.cmml" xref="id6.1.m1.1.1"><cn id="id6.1.m1.1.1.1.cmml" type="integer" xref="id6.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id6.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jiashi Li<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id7.1.m1.1"><semantics id="id7.1.m1.1a"><msup id="id7.1.m1.1.1" xref="id7.1.m1.1.1.cmml"><mi id="id7.1.m1.1.1a" xref="id7.1.m1.1.1.cmml"></mi><mn id="id7.1.m1.1.1.1" xref="id7.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id7.1.m1.1b"><apply id="id7.1.m1.1.1.cmml" xref="id7.1.m1.1.1"><cn id="id7.1.m1.1.1.1.cmml" type="integer" xref="id7.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id7.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wangding Zeng<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id8.1.m1.1"><semantics id="id8.1.m1.1a"><msup id="id8.1.m1.1.1" xref="id8.1.m1.1.1.cmml"><mi id="id8.1.m1.1.1a" xref="id8.1.m1.1.1.cmml"></mi><mn id="id8.1.m1.1.1.1" xref="id8.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id8.1.m1.1b"><apply id="id8.1.m1.1.1.cmml" xref="id8.1.m1.1.1"><cn id="id8.1.m1.1.1.1.cmml" type="integer" xref="id8.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id8.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xingkai Yu<math alttext="{}^{*1,4}" class="ltx_Math" display="inline" id="id9.1.m1.2"><semantics id="id9.1.m1.2a"><msup id="id9.1.m1.2.2" xref="id9.1.m1.2.2.cmml"><mi id="id9.1.m1.2.2a" xref="id9.1.m1.2.2.cmml"></mi><mrow id="id9.1.m1.2.2.2.2" xref="id9.1.m1.2.2.2.3.cmml"><mrow id="id9.1.m1.2.2.2.2.1" xref="id9.1.m1.2.2.2.2.1.cmml"><mi id="id9.1.m1.2.2.2.2.1.2" xref="id9.1.m1.2.2.2.2.1.2.cmml"></mi><mo id="id9.1.m1.2.2.2.2.1.1" lspace="0.222em" rspace="0.222em" xref="id9.1.m1.2.2.2.2.1.1.cmml">*</mo><mn id="id9.1.m1.2.2.2.2.1.3" xref="id9.1.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="id9.1.m1.2.2.2.2.2" xref="id9.1.m1.2.2.2.3.cmml">,</mo><mn id="id9.1.m1.1.1.1.1" xref="id9.1.m1.1.1.1.1.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id9.1.m1.2b"><apply id="id9.1.m1.2.2.cmml" xref="id9.1.m1.2.2"><list id="id9.1.m1.2.2.2.3.cmml" xref="id9.1.m1.2.2.2.2"><apply id="id9.1.m1.2.2.2.2.1.cmml" xref="id9.1.m1.2.2.2.2.1"><times id="id9.1.m1.2.2.2.2.1.1.cmml" xref="id9.1.m1.2.2.2.2.1.1"></times><csymbol cd="latexml" id="id9.1.m1.2.2.2.2.1.2.cmml" xref="id9.1.m1.2.2.2.2.1.2">absent</csymbol><cn id="id9.1.m1.2.2.2.2.1.3.cmml" type="integer" xref="id9.1.m1.2.2.2.2.1.3">1</cn></apply><cn id="id9.1.m1.1.1.1.1.cmml" type="integer" xref="id9.1.m1.1.1.1.1">4</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id9.1.m1.2c">{}^{*1,4}</annotation><annotation encoding="application/x-llamapun" id="id9.1.m1.2d">start_FLOATSUPERSCRIPT * 1 , 4 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Y. Wu<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id10.1.m1.1"><semantics id="id10.1.m1.1a"><msup id="id10.1.m1.1.1" xref="id10.1.m1.1.1.cmml"><mi id="id10.1.m1.1.1a" xref="id10.1.m1.1.1.cmml"></mi><mn id="id10.1.m1.1.1.1" xref="id10.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id10.1.m1.1b"><apply id="id10.1.m1.1.1.cmml" xref="id10.1.m1.1.1"><cn id="id10.1.m1.1.1.1.cmml" type="integer" xref="id10.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id10.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id10.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Zhenda Xie<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id11.1.m1.1"><semantics id="id11.1.m1.1a"><msup id="id11.1.m1.1.1" xref="id11.1.m1.1.1.cmml"><mi id="id11.1.m1.1.1a" xref="id11.1.m1.1.1.cmml"></mi><mn id="id11.1.m1.1.1.1" xref="id11.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id11.1.m1.1b"><apply id="id11.1.m1.1.1.cmml" xref="id11.1.m1.1.1"><cn id="id11.1.m1.1.1.1.cmml" type="integer" xref="id11.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id11.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id11.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Y.K. Li<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id12.1.m1.1"><semantics id="id12.1.m1.1a"><msup id="id12.1.m1.1.1" xref="id12.1.m1.1.1.cmml"><mi id="id12.1.m1.1.1a" xref="id12.1.m1.1.1.cmml"></mi><mn id="id12.1.m1.1.1.1" xref="id12.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id12.1.m1.1b"><apply id="id12.1.m1.1.1.cmml" xref="id12.1.m1.1.1"><cn id="id12.1.m1.1.1.1.cmml" type="integer" xref="id12.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id12.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id12.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Panpan Huang<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id13.1.m1.1"><semantics id="id13.1.m1.1a"><msup id="id13.1.m1.1.1" xref="id13.1.m1.1.1.cmml"><mi id="id13.1.m1.1.1a" xref="id13.1.m1.1.1.cmml"></mi><mn id="id13.1.m1.1.1.1" xref="id13.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id13.1.m1.1b"><apply id="id13.1.m1.1.1.cmml" xref="id13.1.m1.1.1"><cn id="id13.1.m1.1.1.1.cmml" type="integer" xref="id13.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id13.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id13.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Fuli Luo<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id14.1.m1.1"><semantics id="id14.1.m1.1a"><msup id="id14.1.m1.1.1" xref="id14.1.m1.1.1.cmml"><mi id="id14.1.m1.1.1a" xref="id14.1.m1.1.1.cmml"></mi><mn id="id14.1.m1.1.1.1" xref="id14.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id14.1.m1.1b"><apply id="id14.1.m1.1.1.cmml" xref="id14.1.m1.1.1"><cn id="id14.1.m1.1.1.1.cmml" type="integer" xref="id14.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id14.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id14.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chong Ruan<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id15.1.m1.1"><semantics id="id15.1.m1.1a"><msup id="id15.1.m1.1.1" xref="id15.1.m1.1.1.cmml"><mi id="id15.1.m1.1.1a" xref="id15.1.m1.1.1.cmml"></mi><mn id="id15.1.m1.1.1.1" xref="id15.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id15.1.m1.1b"><apply id="id15.1.m1.1.1.cmml" xref="id15.1.m1.1.1"><cn id="id15.1.m1.1.1.1.cmml" type="integer" xref="id15.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id15.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id15.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<br class="ltx_break">Zhifang Sui<math alttext="{}^{2}" class="ltx_Math" display="inline" id="id16.1.m1.1"><semantics id="id16.1.m1.1a"><msup id="id16.1.m1.1.1" xref="id16.1.m1.1.1.cmml"><mi id="id16.1.m1.1.1a" xref="id16.1.m1.1.1.cmml"></mi><mn id="id16.1.m1.1.1.1" xref="id16.1.m1.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id16.1.m1.1b"><apply id="id16.1.m1.1.1.cmml" xref="id16.1.m1.1.1"><cn id="id16.1.m1.1.1.1.cmml" type="integer" xref="id16.1.m1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id16.1.m1.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id16.1.m1.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wenfeng Liang<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id17.1.m1.1"><semantics id="id17.1.m1.1a"><msup id="id17.1.m1.1.1" xref="id17.1.m1.1.1.cmml"><mi id="id17.1.m1.1.1a" xref="id17.1.m1.1.1.cmml"></mi><mn id="id17.1.m1.1.1.1" xref="id17.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id17.1.m1.1b"><apply id="id17.1.m1.1.1.cmml" xref="id17.1.m1.1.1"><cn id="id17.1.m1.1.1.1.cmml" type="integer" xref="id17.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id17.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id17.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
<br class="ltx_break"><math alttext="{}^{1}" class="ltx_Math" display="inline" id="id18.2.m2.1"><semantics id="id18.2.m2.1a"><msup id="id18.2.m2.1.1" xref="id18.2.m2.1.1.cmml"><mi id="id18.2.m2.1.1a" xref="id18.2.m2.1.1.cmml"></mi><mn id="id18.2.m2.1.1.1" mathsize="90%" xref="id18.2.m2.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id18.2.m2.1b"><apply id="id18.2.m2.1.1.cmml" xref="id18.2.m2.1.1"><cn id="id18.2.m2.1.1.1.cmml" type="integer" xref="id18.2.m2.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id18.2.m2.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id18.2.m2.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="id19.3.1" style="font-size:90%;">DeepSeek-AI 
<br class="ltx_break"><math alttext="{}^{2}" class="ltx_Math" display="inline" id="id19.3.1.m1.1"><semantics id="id19.3.1.m1.1a"><msup id="id19.3.1.m1.1.1" xref="id19.3.1.m1.1.1.cmml"><mi id="id19.3.1.m1.1.1a" xref="id19.3.1.m1.1.1.cmml"></mi><mn id="id19.3.1.m1.1.1.1" xref="id19.3.1.m1.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id19.3.1.m1.1b"><apply id="id19.3.1.m1.1.1.cmml" xref="id19.3.1.m1.1.1"><cn id="id19.3.1.m1.1.1.1.cmml" type="integer" xref="id19.3.1.m1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id19.3.1.m1.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id19.3.1.m1.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>National Key Laboratory for Multimedia Information Processing</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Peking University 
<br class="ltx_break"><math alttext="{}^{3}" class="ltx_Math" display="inline" id="id20.1.m1.1"><semantics id="id20.1.m1.1a"><msup id="id20.1.m1.1.1" xref="id20.1.m1.1.1.cmml"><mi id="id20.1.m1.1.1a" xref="id20.1.m1.1.1.cmml"></mi><mn id="id20.1.m1.1.1.1" mathsize="90%" xref="id20.1.m1.1.1.1.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id20.1.m1.1b"><apply id="id20.1.m1.1.1.cmml" xref="id20.1.m1.1.1"><cn id="id20.1.m1.1.1.1.cmml" type="integer" xref="id20.1.m1.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id20.1.m1.1c">{}^{3}</annotation><annotation encoding="application/x-llamapun" id="id20.1.m1.1d">start_FLOATSUPERSCRIPT 3 end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="id28.2.id1" style="font-size:90%;">Institute for Interdisciplinary Information Sciences</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Tsinghua University 
<br class="ltx_break"><math alttext="{}^{4}" class="ltx_Math" display="inline" id="id21.1.m1.1"><semantics id="id21.1.m1.1a"><msup id="id21.1.m1.1.1" xref="id21.1.m1.1.1.cmml"><mi id="id21.1.m1.1.1a" xref="id21.1.m1.1.1.cmml"></mi><mn id="id21.1.m1.1.1.1" mathsize="90%" xref="id21.1.m1.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="id21.1.m1.1b"><apply id="id21.1.m1.1.1.cmml" xref="id21.1.m1.1.1"><cn id="id21.1.m1.1.1.1.cmml" type="integer" xref="id21.1.m1.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id21.1.m1.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="id21.1.m1.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="id29.2.id1" style="font-size:90%;">National Key Laboratory for Novel Software Technology</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Nanjing University 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id30.1.id1" style="font-size:90%;">{daidamai, szf}@pku.edu.cn</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span class="ltx_text ltx_font_typewriter" id="id31.1.id1" style="font-size:90%;">{wenfeng.liang}@deepseek.com<span class="ltx_text ltx_font_serif" id="id31.1.id1.1">
<br class="ltx_break"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/deepseek-ai/DeepSeek-MoE" title="">https://github.com/deepseek-ai/DeepSeek-MoE</a>
</span></span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id27.6">In the era of large language models, Mixture-of-Experts (MoE) is a promising architecture for managing computational costs when scaling up model parameters.
However, conventional MoE architectures like GShard, which activate the top-<math alttext="K" class="ltx_Math" display="inline" id="id22.1.m1.1"><semantics id="id22.1.m1.1a"><mi id="id22.1.m1.1.1" xref="id22.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="id22.1.m1.1b"><ci id="id22.1.m1.1.1.cmml" xref="id22.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="id22.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="id22.1.m1.1d">italic_K</annotation></semantics></math> out of <math alttext="N" class="ltx_Math" display="inline" id="id23.2.m2.1"><semantics id="id23.2.m2.1a"><mi id="id23.2.m2.1.1" xref="id23.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="id23.2.m2.1b"><ci id="id23.2.m2.1.1.cmml" xref="id23.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="id23.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="id23.2.m2.1d">italic_N</annotation></semantics></math> experts, face challenges in ensuring expert specialization, i.e. each expert acquires non-overlapping and focused knowledge.
In response, we propose the <span class="ltx_text ltx_font_bold" id="id27.6.1">DeepSeekMoE</span> architecture towards ultimate expert specialization.
It involves two principal strategies:
(1) finely segmenting the experts into <math alttext="mN" class="ltx_Math" display="inline" id="id24.3.m3.1"><semantics id="id24.3.m3.1a"><mrow id="id24.3.m3.1.1" xref="id24.3.m3.1.1.cmml"><mi id="id24.3.m3.1.1.2" xref="id24.3.m3.1.1.2.cmml">m</mi><mo id="id24.3.m3.1.1.1" xref="id24.3.m3.1.1.1.cmml">⁢</mo><mi id="id24.3.m3.1.1.3" xref="id24.3.m3.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="id24.3.m3.1b"><apply id="id24.3.m3.1.1.cmml" xref="id24.3.m3.1.1"><times id="id24.3.m3.1.1.1.cmml" xref="id24.3.m3.1.1.1"></times><ci id="id24.3.m3.1.1.2.cmml" xref="id24.3.m3.1.1.2">𝑚</ci><ci id="id24.3.m3.1.1.3.cmml" xref="id24.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id24.3.m3.1c">mN</annotation><annotation encoding="application/x-llamapun" id="id24.3.m3.1d">italic_m italic_N</annotation></semantics></math> ones and activating <math alttext="mK" class="ltx_Math" display="inline" id="id25.4.m4.1"><semantics id="id25.4.m4.1a"><mrow id="id25.4.m4.1.1" xref="id25.4.m4.1.1.cmml"><mi id="id25.4.m4.1.1.2" xref="id25.4.m4.1.1.2.cmml">m</mi><mo id="id25.4.m4.1.1.1" xref="id25.4.m4.1.1.1.cmml">⁢</mo><mi id="id25.4.m4.1.1.3" xref="id25.4.m4.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="id25.4.m4.1b"><apply id="id25.4.m4.1.1.cmml" xref="id25.4.m4.1.1"><times id="id25.4.m4.1.1.1.cmml" xref="id25.4.m4.1.1.1"></times><ci id="id25.4.m4.1.1.2.cmml" xref="id25.4.m4.1.1.2">𝑚</ci><ci id="id25.4.m4.1.1.3.cmml" xref="id25.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id25.4.m4.1c">mK</annotation><annotation encoding="application/x-llamapun" id="id25.4.m4.1d">italic_m italic_K</annotation></semantics></math> from them, allowing for a more flexible combination of activated experts;
(2) isolating <math alttext="K_{s}" class="ltx_Math" display="inline" id="id26.5.m5.1"><semantics id="id26.5.m5.1a"><msub id="id26.5.m5.1.1" xref="id26.5.m5.1.1.cmml"><mi id="id26.5.m5.1.1.2" xref="id26.5.m5.1.1.2.cmml">K</mi><mi id="id26.5.m5.1.1.3" xref="id26.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="id26.5.m5.1b"><apply id="id26.5.m5.1.1.cmml" xref="id26.5.m5.1.1"><csymbol cd="ambiguous" id="id26.5.m5.1.1.1.cmml" xref="id26.5.m5.1.1">subscript</csymbol><ci id="id26.5.m5.1.1.2.cmml" xref="id26.5.m5.1.1.2">𝐾</ci><ci id="id26.5.m5.1.1.3.cmml" xref="id26.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id26.5.m5.1c">K_{s}</annotation><annotation encoding="application/x-llamapun" id="id26.5.m5.1d">italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> experts as shared ones, aiming at capturing common knowledge and mitigating redundancy in routed experts.
Starting from a modest scale with 2B parameters, we demonstrate that DeepSeekMoE 2B achieves comparable performance with GShard 2.9B, which has 1.5<math alttext="\times" class="ltx_Math" display="inline" id="id27.6.m6.1"><semantics id="id27.6.m6.1a"><mo id="id27.6.m6.1.1" xref="id27.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="id27.6.m6.1b"><times id="id27.6.m6.1.1.cmml" xref="id27.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id27.6.m6.1c">\times</annotation><annotation encoding="application/x-llamapun" id="id27.6.m6.1d">×</annotation></semantics></math> expert parameters and computation.
In addition, DeepSeekMoE 2B nearly approaches the performance of its dense counterpart with the same number of total parameters, which set the upper bound of MoE models.
Subsequently, we scale up DeepSeekMoE to 16B parameters and show that it achieves comparable performance with LLaMA2 7B, with only about 40% of computations.
Further, our preliminary efforts to scale up DeepSeekMoE to 145B parameters consistently validate its substantial advantages over the GShard architecture, and show its performance comparable with DeepSeek 67B, using only 28.5% (maybe even 18.2%) of computations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S0.F1" lang="en"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="415" id="S0.F1.g1" src="x1.png" width="581">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
Comparison between DeepSeekMoE 16B and open source models on the Open LLM Leaderboard.
The red dashed line is linearly fitted from data points of all models except DeepSeekMoE 16B.
DeepSeekMoE 16B consistently outperforms models with a similar number of activated parameters by a large margin, and achieves comparable performance with LLaMA2 7B, which has approximately 2.5 times the activated parameters.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_section" id="S1" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recent research and practices have empirically demonstrated that, with sufficient training data available, scaling language models with increased parameters and computational budgets can yield remarkably stronger models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Brown et&nbsp;al., <a class="ltx_ref" href="#bib.bib7" title="">2020</a>; OpenAI, <a class="ltx_ref" href="#bib.bib38" title="">2023</a>; Touvron et&nbsp;al., <a class="ltx_ref" href="#bib.bib53" title="">2023a</a>; Hoffmann et&nbsp;al., <a class="ltx_ref" href="#bib.bib24" title="">2022</a>)</cite>.
It is imperative to acknowledge, however, that the endeavor to scale models to an extremely large scale is also associated with exceedingly high computational costs.
Considering the substantial costs, the Mixture-of-Experts&nbsp;(MoE) architecture&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Jacobs et&nbsp;al., <a class="ltx_ref" href="#bib.bib26" title="">1991</a>; Jordan and Jacobs, <a class="ltx_ref" href="#bib.bib27" title="">1994</a>; Shazeer et&nbsp;al., <a class="ltx_ref" href="#bib.bib47" title="">2017</a>)</cite> has emerged as a popular solution.
It can enable parameter scaling, while concurrently keeping computational costs at a modest level.
Recent applications of MoE architectures in Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a class="ltx_ref" href="#bib.bib55" title="">2017</a>)</cite> have yielded successful attempts at scaling language models to a substantial size&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Fedus et&nbsp;al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>; Lepikhin et&nbsp;al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>; Du et&nbsp;al., <a class="ltx_ref" href="#bib.bib14" title="">2022</a>; Zoph, <a class="ltx_ref" href="#bib.bib63" title="">2022</a>)</cite>, accompanied with remarkable performance.
These achievements underscore the considerable potential and promise of MoE language models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite the promising potential of MoE architectures, existing MoE architectures potentially suffer from issues of knowledge hybridity and knowledge redundancy, which limit the expert specialization, i.e., each expert acquires non-overlapping and focused knowledge.
Conventional MoE architectures substitute the Feed-Forward Networks (FFNs) in a Transformer with MoE layers.
Each MoE layer consists of multiple experts, with each structurally identical to a standard FFN, and each token is assigned to one&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Fedus et&nbsp;al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite> or two&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et&nbsp;al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> experts.
This architecture manifests two potential issues:
(1)
<span class="ltx_text ltx_font_bold" id="S1.p2.1.1">Knowledge Hybridity</span>: existing MoE practices often employ a limited number of experts (e.g., 8 or 16), and thus tokens assigned to a specific expert will be likely to cover diverse knowledge.
Consequently, the designated expert will intend to assemble vastly different types of knowledge in its parameters, which are hard to utilize simultaneously.
(2)
<span class="ltx_text ltx_font_bold" id="S1.p2.1.2">Knowledge Redundancy</span>: tokens assigned to different experts may require common knowledge.
As a result, multiple experts may converge in acquiring shared knowledge in their respective parameters, thereby leading to redundancy in expert parameters.
These issues collectively hinder the expert specialization in existing MoE practices, preventing them from reaching the theoretical upper-bound performance of MoE models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In response to the aforementioned issues, we introduce <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">DeepSeekMoE</span>, an innovative MoE architecture specifically designed towards ultimate expert specialization.
Our architecture involves two principal strategies:
(1) <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">Fine-Grained Expert Segmentation:</span>
while maintaining the number of parameters constant, we segment the experts into a finer grain by splitting the FFN intermediate hidden dimension.
Correspondingly, keeping a constant computational cost, we also activate more fine-grained experts to enable a more flexible and adaptable combination of activated experts.
Fine-grained expert segmentation allows diverse knowledge to be decomposed more finely and be learned more precisely into different experts, where each expert will retain a higher level of specialization.
In addition, the increased flexibility in combining activated experts also contributes to a more accurate and targeted knowledge acquisition.
(2) <span class="ltx_text ltx_font_bold" id="S1.p3.1.3">Shared Expert Isolation:</span>
we isolate certain experts to serve as shared experts that are always activated, aiming at capturing and consolidating common knowledge across varying contexts.
Through compressing common knowledge into these shared experts, redundancy among other routed experts will be mitigated.
This can enhance the parameter efficiency and ensure that each routed expert retains specialized by focusing on distinctive aspects.
These architectural innovations in DeepSeekMoE offer opportunities to train a parameter-efficient MoE language model where each expert is highly specialized.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Starting from a modest scale with 2B parameters, we validate the advantages of the DeepSeekMoE architecture.
We conduct evaluations on 12 zero-shot or few-shot benchmarks spanning diverse tasks.
Empirical results indicate that DeepSeekMoE 2B surpasses GShard 2B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et&nbsp;al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> by a substantial margin, and even matches GShard 2.9B, a larger MoE model with 1.5<math alttext="\times" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mo id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><times id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">×</annotation></semantics></math> expert parameters and computation.
Remarkably, we find that DeepSeekMoE 2B nearly approaches the performance of its dense counterpart with an equivalent number of parameters, which sets the strict upper bound of MoE language models.
In pursuit of deeper insights, we conduct elaborate ablation studies and analysis on the expert specialization for DeepSeekMoE.
These studies validate the effectiveness of fine-grained expert segmentation and shared expert isolation, and provide empirical evidence supporting the assertion that DeepSeekMoE can achieve a high level of expert specialization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Leveraging our architecture, we subsequently scale up the model parameters to 16B and train DeepSeekMoE 16B on a large-scale corpus with 2T tokens.
Evaluation results reveal that with only about 40% of computations, DeepSeekMoE 16B achieves comparable performance with DeepSeek 7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(DeepSeek-AI, <a class="ltx_ref" href="#bib.bib13" title="">2024</a>)</cite>, a dense model trained on the same 2T corpus.
We also compare DeepSeekMoE with open source models and the evaluations demonstrate that DeepSeekMoE 16B consistently outperforms models with a similar number of activated parameters by a large margin, and achieves comparable performance with LLaMA2 7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="#bib.bib54" title="">2023b</a>)</cite>, which has approximately 2.5 times the activated parameters.
Figure&nbsp;<a class="ltx_ref" href="#S0.F1" title="Figure 1 ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> demonstrates the evaluation results on the Open LLM Leaderboard<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard</span></span></span>.
Additionally, we conduct supervised fine-tuning&nbsp;(SFT) for alignment, transforming the model into a chat model.
Evaluation results show that DeepSeekMoE Chat 16B also achieves comparable performance with DeepSeek Chat 7B and LLaMA2 SFT 7B in the chat setting.
Encouraged by these results, we further undertake a preliminary endeavor to scale up DeepSeekMoE to 145B.
The experimental results still validate its substantial advantages over the GShard architecture consistently.
In addition, it shows performance comparable with DeepSeek 67B, using only 28.5% (maybe even 18.2%) of computations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our contributions are summarized as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Architectural Innovation.</span>
We introduce DeepSeekMoE, an innovative MoE architecture aiming at achieving ultimate expert specialization, which employs two principal strategies of fine-grained expert segmentation and shared expert isolation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Empirical Validation.</span>
We conduct extensive experiments to empirically validate the effectiveness of the DeepSeekMoE architecture.
Experimental results validate the high level of expert specialization in DeepSeekMoE 2B, and indicate that DeepSeekMoE 2B can nearly approach the upper bound performance for MoE models</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Scalability.</span>
We scale up DeepSeekMoE to train a 16B model and show that with only about 40% of computations, DeepSeekMoE 16B achieves comparable performance with DeepSeek 7B and LLaMA2 7B.
We also undertake a preliminary endeavor to scale up DeepSeekMoE to 145B, highlighting its consistent advantages over the GShard architecture and showing a comparable performance with DeepSeek 67B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">Alignment for MoE.</span>
We successfully perform supervised fine-tuning on DeepSeekMoE 16B to create an aligned chat model, showcasing the adaptability and versatility of DeepSeekMoE 16B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i5.p1">
<p class="ltx_p" id="S1.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i5.p1.1.1">Public Release.</span>
In the spirit of open research, we release the model checkpoint of DeepSeekMoE 16B to the public.
Notably, this model can be deployed on a single GPU with 40GB of memory without the need for quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries: Mixture-of-Experts for Transformers</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">We first introduce a generic MoE architecture commonly used in Transformer language models.
A standard Transformer language model is constructed by stacking <math alttext="L" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_L</annotation></semantics></math> layers of standard Transformer blocks, where each block can be represented as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx1">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{u}_{1:T}^{l}" class="ltx_Math" display="inline" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><msubsup id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mi id="S2.E1.m1.1.1.2.2" xref="S2.E1.m1.1.1.2.2.cmml">𝐮</mi><mrow id="S2.E1.m1.1.1.2.3" xref="S2.E1.m1.1.1.2.3.cmml"><mn id="S2.E1.m1.1.1.2.3.2" xref="S2.E1.m1.1.1.2.3.2.cmml">1</mn><mo id="S2.E1.m1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m1.1.1.2.3.1.cmml">:</mo><mi id="S2.E1.m1.1.1.2.3.3" xref="S2.E1.m1.1.1.2.3.3.cmml">T</mi></mrow><mi id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1">superscript</csymbol><apply id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.1.cmml" xref="S2.E1.m1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.2.2">𝐮</ci><apply id="S2.E1.m1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.2.3"><ci id="S2.E1.m1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.2.3.1">:</ci><cn id="S2.E1.m1.1.1.2.3.2.cmml" type="integer" xref="S2.E1.m1.1.1.2.3.2">1</cn><ci id="S2.E1.m1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\displaystyle\mathbf{u}_{1:T}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">bold_u start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Self-Att}\left(\mathbf{h}_{1:T}^{l-1}\right)+%
\mathbf{h}_{1:T}^{l-1}," class="ltx_Math" display="inline" id="S2.E1.m2.2"><semantics id="S2.E1.m2.2a"><mrow id="S2.E1.m2.2.2.1" xref="S2.E1.m2.2.2.1.1.cmml"><mrow id="S2.E1.m2.2.2.1.1" xref="S2.E1.m2.2.2.1.1.cmml"><mi id="S2.E1.m2.2.2.1.1.3" xref="S2.E1.m2.2.2.1.1.3.cmml"></mi><mo id="S2.E1.m2.2.2.1.1.2" xref="S2.E1.m2.2.2.1.1.2.cmml">=</mo><mrow id="S2.E1.m2.2.2.1.1.1" xref="S2.E1.m2.2.2.1.1.1.cmml"><mrow id="S2.E1.m2.2.2.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml"><mrow id="S2.E1.m2.1.1" xref="S2.E1.m2.1.1.cmml"><mi id="S2.E1.m2.1.1.2" xref="S2.E1.m2.1.1.2.cmml">Self</mi><mo id="S2.E1.m2.1.1.1" xref="S2.E1.m2.1.1.1.cmml">−</mo><mi id="S2.E1.m2.1.1.3" xref="S2.E1.m2.1.1.3.cmml">Att</mi></mrow><mo id="S2.E1.m2.2.2.1.1.1.1.1a" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m2.2.2.1.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml"><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.2" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml">(</mo><msubsup id="S2.E1.m2.2.2.1.1.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mrow id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.cmml"><mn id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow><mrow id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m2.2.2.1.1.1.2" xref="S2.E1.m2.2.2.1.1.1.2.cmml">+</mo><msubsup id="S2.E1.m2.2.2.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.3.cmml"><mi id="S2.E1.m2.2.2.1.1.1.3.2.2" xref="S2.E1.m2.2.2.1.1.1.3.2.2.cmml">𝐡</mi><mrow id="S2.E1.m2.2.2.1.1.1.3.2.3" xref="S2.E1.m2.2.2.1.1.1.3.2.3.cmml"><mn id="S2.E1.m2.2.2.1.1.1.3.2.3.2" xref="S2.E1.m2.2.2.1.1.1.3.2.3.2.cmml">1</mn><mo id="S2.E1.m2.2.2.1.1.1.3.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E1.m2.2.2.1.1.1.3.2.3.1.cmml">:</mo><mi id="S2.E1.m2.2.2.1.1.1.3.2.3.3" xref="S2.E1.m2.2.2.1.1.1.3.2.3.3.cmml">T</mi></mrow><mrow id="S2.E1.m2.2.2.1.1.1.3.3" xref="S2.E1.m2.2.2.1.1.1.3.3.cmml"><mi id="S2.E1.m2.2.2.1.1.1.3.3.2" xref="S2.E1.m2.2.2.1.1.1.3.3.2.cmml">l</mi><mo id="S2.E1.m2.2.2.1.1.1.3.3.1" xref="S2.E1.m2.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E1.m2.2.2.1.1.1.3.3.3" xref="S2.E1.m2.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo id="S2.E1.m2.2.2.1.2" xref="S2.E1.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m2.2b"><apply id="S2.E1.m2.2.2.1.1.cmml" xref="S2.E1.m2.2.2.1"><eq id="S2.E1.m2.2.2.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S2.E1.m2.2.2.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.3">absent</csymbol><apply id="S2.E1.m2.2.2.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1"><plus id="S2.E1.m2.2.2.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.2"></plus><apply id="S2.E1.m2.2.2.1.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1"><apply id="S2.E1.m2.1.1.cmml" xref="S2.E1.m2.1.1"><minus id="S2.E1.m2.1.1.1.cmml" xref="S2.E1.m2.1.1.1"></minus><ci id="S2.E1.m2.1.1.2.cmml" xref="S2.E1.m2.1.1.2">Self</ci><ci id="S2.E1.m2.1.1.3.cmml" xref="S2.E1.m2.1.1.3">Att</ci></apply><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2">𝐡</ci><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3"><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1">:</ci><cn id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3"><minus id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2">𝑙</ci><cn id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S2.E1.m2.2.2.1.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3">superscript</csymbol><apply id="S2.E1.m2.2.2.1.1.1.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.3.2.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E1.m2.2.2.1.1.1.3.2.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.2">𝐡</ci><apply id="S2.E1.m2.2.2.1.1.1.3.2.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3"><ci id="S2.E1.m2.2.2.1.1.1.3.2.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3.1">:</ci><cn id="S2.E1.m2.2.2.1.1.1.3.2.3.2.cmml" type="integer" xref="S2.E1.m2.2.2.1.1.1.3.2.3.2">1</cn><ci id="S2.E1.m2.2.2.1.1.1.3.2.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3.3">𝑇</ci></apply></apply><apply id="S2.E1.m2.2.2.1.1.1.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3"><minus id="S2.E1.m2.2.2.1.1.1.3.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3.1"></minus><ci id="S2.E1.m2.2.2.1.1.1.3.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3.2">𝑙</ci><cn id="S2.E1.m2.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S2.E1.m2.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m2.2c">\displaystyle=\operatorname{Self-Att}\left(\mathbf{h}_{1:T}^{l-1}\right)+%
\mathbf{h}_{1:T}^{l-1},</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m2.2d">= start_OPFUNCTION roman_Self - roman_Att end_OPFUNCTION ( bold_h start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT ) + bold_h start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{t}^{l}" class="ltx_Math" display="inline" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><msubsup id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mi id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">𝐡</mi><mi id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml">t</mi><mi id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1">superscript</csymbol><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">𝐡</ci><ci id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">bold_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{FFN}\left(\mathbf{u}_{t}^{l}\right)+\mathbf{u}_{t}%
^{l}," class="ltx_Math" display="inline" id="S2.E2.m2.2"><semantics id="S2.E2.m2.2a"><mrow id="S2.E2.m2.2.2.1" xref="S2.E2.m2.2.2.1.1.cmml"><mrow id="S2.E2.m2.2.2.1.1" xref="S2.E2.m2.2.2.1.1.cmml"><mi id="S2.E2.m2.2.2.1.1.3" xref="S2.E2.m2.2.2.1.1.3.cmml"></mi><mo id="S2.E2.m2.2.2.1.1.2" xref="S2.E2.m2.2.2.1.1.2.cmml">=</mo><mrow id="S2.E2.m2.2.2.1.1.1" xref="S2.E2.m2.2.2.1.1.1.cmml"><mrow id="S2.E2.m2.2.2.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml"><mi id="S2.E2.m2.1.1" xref="S2.E2.m2.1.1.cmml">FFN</mi><mo id="S2.E2.m2.2.2.1.1.1.1.1a" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E2.m2.2.2.1.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml"><mo id="S2.E2.m2.2.2.1.1.1.1.1.1.2" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml">(</mo><msubsup id="S2.E2.m2.2.2.1.1.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐮</mi><mi id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.E2.m2.2.2.1.1.1.1.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.E2.m2.2.2.1.1.1.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m2.2.2.1.1.1.2" xref="S2.E2.m2.2.2.1.1.1.2.cmml">+</mo><msubsup id="S2.E2.m2.2.2.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.3.cmml"><mi id="S2.E2.m2.2.2.1.1.1.3.2.2" xref="S2.E2.m2.2.2.1.1.1.3.2.2.cmml">𝐮</mi><mi id="S2.E2.m2.2.2.1.1.1.3.2.3" xref="S2.E2.m2.2.2.1.1.1.3.2.3.cmml">t</mi><mi id="S2.E2.m2.2.2.1.1.1.3.3" xref="S2.E2.m2.2.2.1.1.1.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S2.E2.m2.2.2.1.2" xref="S2.E2.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.2b"><apply id="S2.E2.m2.2.2.1.1.cmml" xref="S2.E2.m2.2.2.1"><eq id="S2.E2.m2.2.2.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S2.E2.m2.2.2.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.3">absent</csymbol><apply id="S2.E2.m2.2.2.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1"><plus id="S2.E2.m2.2.2.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.2"></plus><apply id="S2.E2.m2.2.2.1.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1"><ci id="S2.E2.m2.1.1.cmml" xref="S2.E2.m2.1.1">FFN</ci><apply id="S2.E2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2">𝐮</ci><ci id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S2.E2.m2.2.2.1.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.3.1.cmml" xref="S2.E2.m2.2.2.1.1.1.3">superscript</csymbol><apply id="S2.E2.m2.2.2.1.1.1.3.2.cmml" xref="S2.E2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.3.2.1.cmml" xref="S2.E2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E2.m2.2.2.1.1.1.3.2.2.cmml" xref="S2.E2.m2.2.2.1.1.1.3.2.2">𝐮</ci><ci id="S2.E2.m2.2.2.1.1.1.3.2.3.cmml" xref="S2.E2.m2.2.2.1.1.1.3.2.3">𝑡</ci></apply><ci id="S2.E2.m2.2.2.1.1.1.3.3.cmml" xref="S2.E2.m2.2.2.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.2c">\displaystyle=\operatorname{FFN}\left(\mathbf{u}_{t}^{l}\right)+\mathbf{u}_{t}%
^{l},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m2.2d">= roman_FFN ( bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) + bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.9">where <math alttext="T" class="ltx_Math" display="inline" id="S2.p1.2.m1.1"><semantics id="S2.p1.2.m1.1a"><mi id="S2.p1.2.m1.1.1" xref="S2.p1.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m1.1b"><ci id="S2.p1.2.m1.1.1.cmml" xref="S2.p1.2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m1.1d">italic_T</annotation></semantics></math> denotes the sequence length,
<math alttext="\operatorname{Self-Att}(\cdot)" class="ltx_Math" display="inline" id="S2.p1.3.m2.2"><semantics id="S2.p1.3.m2.2a"><mrow id="S2.p1.3.m2.2.3.2" xref="S2.p1.3.m2.2.3.1.cmml"><mrow id="S2.p1.3.m2.1.1" xref="S2.p1.3.m2.1.1.cmml"><mi id="S2.p1.3.m2.1.1.2" xref="S2.p1.3.m2.1.1.2.cmml">Self</mi><mo id="S2.p1.3.m2.1.1.1" xref="S2.p1.3.m2.1.1.1.cmml">−</mo><mi id="S2.p1.3.m2.1.1.3" xref="S2.p1.3.m2.1.1.3.cmml">Att</mi></mrow><mo id="S2.p1.3.m2.2.3.2a" xref="S2.p1.3.m2.2.3.1.cmml">⁡</mo><mrow id="S2.p1.3.m2.2.3.2.1" xref="S2.p1.3.m2.2.3.1.cmml"><mo id="S2.p1.3.m2.2.3.2.1.1" stretchy="false" xref="S2.p1.3.m2.2.3.1.cmml">(</mo><mo id="S2.p1.3.m2.2.2" lspace="0em" rspace="0em" xref="S2.p1.3.m2.2.2.cmml">⋅</mo><mo id="S2.p1.3.m2.2.3.2.1.2" stretchy="false" xref="S2.p1.3.m2.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m2.2b"><apply id="S2.p1.3.m2.2.3.1.cmml" xref="S2.p1.3.m2.2.3.2"><apply id="S2.p1.3.m2.1.1.cmml" xref="S2.p1.3.m2.1.1"><minus id="S2.p1.3.m2.1.1.1.cmml" xref="S2.p1.3.m2.1.1.1"></minus><ci id="S2.p1.3.m2.1.1.2.cmml" xref="S2.p1.3.m2.1.1.2">Self</ci><ci id="S2.p1.3.m2.1.1.3.cmml" xref="S2.p1.3.m2.1.1.3">Att</ci></apply><ci id="S2.p1.3.m2.2.2.cmml" xref="S2.p1.3.m2.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m2.2c">\operatorname{Self-Att}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m2.2d">start_OPFUNCTION roman_Self - roman_Att end_OPFUNCTION ( ⋅ )</annotation></semantics></math> denotes the self-attention module,
<math alttext="\operatorname{FFN}(\cdot)" class="ltx_Math" display="inline" id="S2.p1.4.m3.2"><semantics id="S2.p1.4.m3.2a"><mrow id="S2.p1.4.m3.2.3.2" xref="S2.p1.4.m3.2.3.1.cmml"><mi id="S2.p1.4.m3.1.1" xref="S2.p1.4.m3.1.1.cmml">FFN</mi><mo id="S2.p1.4.m3.2.3.2a" xref="S2.p1.4.m3.2.3.1.cmml">⁡</mo><mrow id="S2.p1.4.m3.2.3.2.1" xref="S2.p1.4.m3.2.3.1.cmml"><mo id="S2.p1.4.m3.2.3.2.1.1" stretchy="false" xref="S2.p1.4.m3.2.3.1.cmml">(</mo><mo id="S2.p1.4.m3.2.2" lspace="0em" rspace="0em" xref="S2.p1.4.m3.2.2.cmml">⋅</mo><mo id="S2.p1.4.m3.2.3.2.1.2" stretchy="false" xref="S2.p1.4.m3.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m3.2b"><apply id="S2.p1.4.m3.2.3.1.cmml" xref="S2.p1.4.m3.2.3.2"><ci id="S2.p1.4.m3.1.1.cmml" xref="S2.p1.4.m3.1.1">FFN</ci><ci id="S2.p1.4.m3.2.2.cmml" xref="S2.p1.4.m3.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m3.2c">\operatorname{FFN}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m3.2d">roman_FFN ( ⋅ )</annotation></semantics></math> denotes the Feed-Forward Network&nbsp;(FFN),
<math alttext="\mathbf{u}_{1:T}^{l}\in\mathbb{R}^{T\times d}" class="ltx_Math" display="inline" id="S2.p1.5.m4.1"><semantics id="S2.p1.5.m4.1a"><mrow id="S2.p1.5.m4.1.1" xref="S2.p1.5.m4.1.1.cmml"><msubsup id="S2.p1.5.m4.1.1.2" xref="S2.p1.5.m4.1.1.2.cmml"><mi id="S2.p1.5.m4.1.1.2.2.2" xref="S2.p1.5.m4.1.1.2.2.2.cmml">𝐮</mi><mrow id="S2.p1.5.m4.1.1.2.2.3" xref="S2.p1.5.m4.1.1.2.2.3.cmml"><mn id="S2.p1.5.m4.1.1.2.2.3.2" xref="S2.p1.5.m4.1.1.2.2.3.2.cmml">1</mn><mo id="S2.p1.5.m4.1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S2.p1.5.m4.1.1.2.2.3.1.cmml">:</mo><mi id="S2.p1.5.m4.1.1.2.2.3.3" xref="S2.p1.5.m4.1.1.2.2.3.3.cmml">T</mi></mrow><mi id="S2.p1.5.m4.1.1.2.3" xref="S2.p1.5.m4.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.p1.5.m4.1.1.1" xref="S2.p1.5.m4.1.1.1.cmml">∈</mo><msup id="S2.p1.5.m4.1.1.3" xref="S2.p1.5.m4.1.1.3.cmml"><mi id="S2.p1.5.m4.1.1.3.2" xref="S2.p1.5.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p1.5.m4.1.1.3.3" xref="S2.p1.5.m4.1.1.3.3.cmml"><mi id="S2.p1.5.m4.1.1.3.3.2" xref="S2.p1.5.m4.1.1.3.3.2.cmml">T</mi><mo id="S2.p1.5.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p1.5.m4.1.1.3.3.1.cmml">×</mo><mi id="S2.p1.5.m4.1.1.3.3.3" xref="S2.p1.5.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m4.1b"><apply id="S2.p1.5.m4.1.1.cmml" xref="S2.p1.5.m4.1.1"><in id="S2.p1.5.m4.1.1.1.cmml" xref="S2.p1.5.m4.1.1.1"></in><apply id="S2.p1.5.m4.1.1.2.cmml" xref="S2.p1.5.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.2.1.cmml" xref="S2.p1.5.m4.1.1.2">superscript</csymbol><apply id="S2.p1.5.m4.1.1.2.2.cmml" xref="S2.p1.5.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.2.2.1.cmml" xref="S2.p1.5.m4.1.1.2">subscript</csymbol><ci id="S2.p1.5.m4.1.1.2.2.2.cmml" xref="S2.p1.5.m4.1.1.2.2.2">𝐮</ci><apply id="S2.p1.5.m4.1.1.2.2.3.cmml" xref="S2.p1.5.m4.1.1.2.2.3"><ci id="S2.p1.5.m4.1.1.2.2.3.1.cmml" xref="S2.p1.5.m4.1.1.2.2.3.1">:</ci><cn id="S2.p1.5.m4.1.1.2.2.3.2.cmml" type="integer" xref="S2.p1.5.m4.1.1.2.2.3.2">1</cn><ci id="S2.p1.5.m4.1.1.2.2.3.3.cmml" xref="S2.p1.5.m4.1.1.2.2.3.3">𝑇</ci></apply></apply><ci id="S2.p1.5.m4.1.1.2.3.cmml" xref="S2.p1.5.m4.1.1.2.3">𝑙</ci></apply><apply id="S2.p1.5.m4.1.1.3.cmml" xref="S2.p1.5.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.3.1.cmml" xref="S2.p1.5.m4.1.1.3">superscript</csymbol><ci id="S2.p1.5.m4.1.1.3.2.cmml" xref="S2.p1.5.m4.1.1.3.2">ℝ</ci><apply id="S2.p1.5.m4.1.1.3.3.cmml" xref="S2.p1.5.m4.1.1.3.3"><times id="S2.p1.5.m4.1.1.3.3.1.cmml" xref="S2.p1.5.m4.1.1.3.3.1"></times><ci id="S2.p1.5.m4.1.1.3.3.2.cmml" xref="S2.p1.5.m4.1.1.3.3.2">𝑇</ci><ci id="S2.p1.5.m4.1.1.3.3.3.cmml" xref="S2.p1.5.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m4.1c">\mathbf{u}_{1:T}^{l}\in\mathbb{R}^{T\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m4.1d">bold_u start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_T × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are the hidden states of all tokens after the <math alttext="l" class="ltx_Math" display="inline" id="S2.p1.6.m5.1"><semantics id="S2.p1.6.m5.1a"><mi id="S2.p1.6.m5.1.1" xref="S2.p1.6.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m5.1b"><ci id="S2.p1.6.m5.1.1.cmml" xref="S2.p1.6.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m5.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m5.1d">italic_l</annotation></semantics></math>-th attention module,
and <math alttext="\mathbf{h}_{t}^{l}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.p1.7.m6.1"><semantics id="S2.p1.7.m6.1a"><mrow id="S2.p1.7.m6.1.1" xref="S2.p1.7.m6.1.1.cmml"><msubsup id="S2.p1.7.m6.1.1.2" xref="S2.p1.7.m6.1.1.2.cmml"><mi id="S2.p1.7.m6.1.1.2.2.2" xref="S2.p1.7.m6.1.1.2.2.2.cmml">𝐡</mi><mi id="S2.p1.7.m6.1.1.2.2.3" xref="S2.p1.7.m6.1.1.2.2.3.cmml">t</mi><mi id="S2.p1.7.m6.1.1.2.3" xref="S2.p1.7.m6.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.p1.7.m6.1.1.1" xref="S2.p1.7.m6.1.1.1.cmml">∈</mo><msup id="S2.p1.7.m6.1.1.3" xref="S2.p1.7.m6.1.1.3.cmml"><mi id="S2.p1.7.m6.1.1.3.2" xref="S2.p1.7.m6.1.1.3.2.cmml">ℝ</mi><mi id="S2.p1.7.m6.1.1.3.3" xref="S2.p1.7.m6.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m6.1b"><apply id="S2.p1.7.m6.1.1.cmml" xref="S2.p1.7.m6.1.1"><in id="S2.p1.7.m6.1.1.1.cmml" xref="S2.p1.7.m6.1.1.1"></in><apply id="S2.p1.7.m6.1.1.2.cmml" xref="S2.p1.7.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p1.7.m6.1.1.2.1.cmml" xref="S2.p1.7.m6.1.1.2">superscript</csymbol><apply id="S2.p1.7.m6.1.1.2.2.cmml" xref="S2.p1.7.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p1.7.m6.1.1.2.2.1.cmml" xref="S2.p1.7.m6.1.1.2">subscript</csymbol><ci id="S2.p1.7.m6.1.1.2.2.2.cmml" xref="S2.p1.7.m6.1.1.2.2.2">𝐡</ci><ci id="S2.p1.7.m6.1.1.2.2.3.cmml" xref="S2.p1.7.m6.1.1.2.2.3">𝑡</ci></apply><ci id="S2.p1.7.m6.1.1.2.3.cmml" xref="S2.p1.7.m6.1.1.2.3">𝑙</ci></apply><apply id="S2.p1.7.m6.1.1.3.cmml" xref="S2.p1.7.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p1.7.m6.1.1.3.1.cmml" xref="S2.p1.7.m6.1.1.3">superscript</csymbol><ci id="S2.p1.7.m6.1.1.3.2.cmml" xref="S2.p1.7.m6.1.1.3.2">ℝ</ci><ci id="S2.p1.7.m6.1.1.3.3.cmml" xref="S2.p1.7.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m6.1c">\mathbf{h}_{t}^{l}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m6.1d">bold_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the output hidden state of the <math alttext="t" class="ltx_Math" display="inline" id="S2.p1.8.m7.1"><semantics id="S2.p1.8.m7.1a"><mi id="S2.p1.8.m7.1.1" xref="S2.p1.8.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m7.1b"><ci id="S2.p1.8.m7.1.1.cmml" xref="S2.p1.8.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m7.1d">italic_t</annotation></semantics></math>-th token after the <math alttext="l" class="ltx_Math" display="inline" id="S2.p1.9.m8.1"><semantics id="S2.p1.9.m8.1a"><mi id="S2.p1.9.m8.1.1" xref="S2.p1.9.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m8.1b"><ci id="S2.p1.9.m8.1.1.cmml" xref="S2.p1.9.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m8.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.p1.9.m8.1d">italic_l</annotation></semantics></math>-th Transformer block.
For brevity, we omit the layer normalization in the above formulations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.2">A typical practice to construct an MoE language model usually substitutes FFNs in a Transformer with MoE layers at specified intervals&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Fedus et&nbsp;al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>; Lepikhin et&nbsp;al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>; Du et&nbsp;al., <a class="ltx_ref" href="#bib.bib14" title="">2022</a>; Zoph, <a class="ltx_ref" href="#bib.bib63" title="">2022</a>)</cite>.
An MoE layer is composed of multiple experts, where each expert is structurally identical to a standard FFN.
Then, each token will be assigned to one&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Fedus et&nbsp;al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite> or two&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et&nbsp;al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> experts.
If the <math alttext="l" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_l</annotation></semantics></math>-th FFN is substituted with an MoE layer, the computation for its output hidden state <math alttext="\mathbf{h}_{t}^{l}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><msubsup id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2.2" xref="S2.p2.2.m2.1.1.2.2.cmml">𝐡</mi><mi id="S2.p2.2.m2.1.1.2.3" xref="S2.p2.2.m2.1.1.2.3.cmml">t</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">superscript</csymbol><apply id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.2.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.2.cmml" xref="S2.p2.2.m2.1.1.2.2">𝐡</ci><ci id="S2.p2.2.m2.1.1.2.3.cmml" xref="S2.p2.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathbf{h}_{t}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">bold_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is expressed as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx2">
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{t}^{l}" class="ltx_Math" display="inline" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><msubsup id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mi id="S2.E3.m1.1.1.2.2" xref="S2.E3.m1.1.1.2.2.cmml">𝐡</mi><mi id="S2.E3.m1.1.1.2.3" xref="S2.E3.m1.1.1.2.3.cmml">t</mi><mi id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1">superscript</csymbol><apply id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.1.cmml" xref="S2.E3.m1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.2.2">𝐡</ci><ci id="S2.E3.m1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">bold_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{i=1}^{N}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{%
u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l}," class="ltx_Math" display="inline" id="S2.E3.m2.3"><semantics id="S2.E3.m2.3a"><mrow id="S2.E3.m2.3.3.1" xref="S2.E3.m2.3.3.1.1.cmml"><mrow id="S2.E3.m2.3.3.1.1" xref="S2.E3.m2.3.3.1.1.cmml"><mi id="S2.E3.m2.3.3.1.1.3" xref="S2.E3.m2.3.3.1.1.3.cmml"></mi><mo id="S2.E3.m2.3.3.1.1.2" xref="S2.E3.m2.3.3.1.1.2.cmml">=</mo><mrow id="S2.E3.m2.3.3.1.1.1" xref="S2.E3.m2.3.3.1.1.1.cmml"><mrow id="S2.E3.m2.3.3.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3.m2.3.3.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.2.cmml"><munderover id="S2.E3.m2.3.3.1.1.1.1.2a" xref="S2.E3.m2.3.3.1.1.1.1.2.cmml"><mo id="S2.E3.m2.3.3.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E3.m2.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.2.2.3" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.2.2.3.2" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E3.m2.3.3.1.1.1.1.2.2.3.1" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m2.3.3.1.1.1.1.2.2.3.3" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m2.3.3.1.1.1.1.2.3" xref="S2.E3.m2.3.3.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="S2.E3.m2.2.2.2.4" xref="S2.E3.m2.2.2.2.3.cmml"><mi id="S2.E3.m2.1.1.1.1" xref="S2.E3.m2.1.1.1.1.cmml">i</mi><mo id="S2.E3.m2.2.2.2.4.1" xref="S2.E3.m2.2.2.2.3.cmml">,</mo><mi id="S2.E3.m2.2.2.2.2" xref="S2.E3.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.3" lspace="0.167em" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2a" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml">𝐮</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml">t</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m2.3.3.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.2.cmml">+</mo><msubsup id="S2.E3.m2.3.3.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.3.cmml"><mi id="S2.E3.m2.3.3.1.1.1.3.2.2" xref="S2.E3.m2.3.3.1.1.1.3.2.2.cmml">𝐮</mi><mi id="S2.E3.m2.3.3.1.1.1.3.2.3" xref="S2.E3.m2.3.3.1.1.1.3.2.3.cmml">t</mi><mi id="S2.E3.m2.3.3.1.1.1.3.3" xref="S2.E3.m2.3.3.1.1.1.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S2.E3.m2.3.3.1.2" xref="S2.E3.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.3b"><apply id="S2.E3.m2.3.3.1.1.cmml" xref="S2.E3.m2.3.3.1"><eq id="S2.E3.m2.3.3.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S2.E3.m2.3.3.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.3">absent</csymbol><apply id="S2.E3.m2.3.3.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1"><plus id="S2.E3.m2.3.3.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.2"></plus><apply id="S2.E3.m2.3.3.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1"><apply id="S2.E3.m2.3.3.1.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.1.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.2"></sum><apply id="S2.E3.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3"><eq id="S2.E3.m2.3.3.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m2.3.3.1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S2.E3.m2.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m2.3.3.1.1.1.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1"><times id="S2.E3.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.3"></times><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2">𝑔</ci><list id="S2.E3.m2.2.2.2.3.cmml" xref="S2.E3.m2.2.2.2.4"><ci id="S2.E3.m2.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1">𝑖</ci><ci id="S2.E3.m2.2.2.2.2.cmml" xref="S2.E3.m2.2.2.2.2">𝑡</ci></list></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2"><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2">FFN</ci><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">superscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2">𝐮</ci><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3">𝑡</ci></apply><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S2.E3.m2.3.3.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.3.1.cmml" xref="S2.E3.m2.3.3.1.1.1.3">superscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.3.2.cmml" xref="S2.E3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.3.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.3.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.3.2.2">𝐮</ci><ci id="S2.E3.m2.3.3.1.1.1.3.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.3.2.3">𝑡</ci></apply><ci id="S2.E3.m2.3.3.1.1.1.3.3.cmml" xref="S2.E3.m2.3.3.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.3c">\displaystyle=\sum_{i=1}^{N}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{%
u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l},</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m2.3d">= ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( italic_g start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT roman_FFN start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ) + bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle g_{i,t}" class="ltx_Math" display="inline" id="S2.E4.m1.2"><semantics id="S2.E4.m1.2a"><msub id="S2.E4.m1.2.3" xref="S2.E4.m1.2.3.cmml"><mi id="S2.E4.m1.2.3.2" xref="S2.E4.m1.2.3.2.cmml">g</mi><mrow id="S2.E4.m1.2.2.2.4" xref="S2.E4.m1.2.2.2.3.cmml"><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">i</mi><mo id="S2.E4.m1.2.2.2.4.1" xref="S2.E4.m1.2.2.2.3.cmml">,</mo><mi id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.3.cmml" xref="S2.E4.m1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.3.1.cmml" xref="S2.E4.m1.2.3">subscript</csymbol><ci id="S2.E4.m1.2.3.2.cmml" xref="S2.E4.m1.2.3.2">𝑔</ci><list id="S2.E4.m1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.4"><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑖</ci><ci id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\displaystyle g_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.2d">italic_g start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1%
\leqslant j\leqslant N\},K),\\
0,&amp;\text{otherwise},\end{cases}" class="ltx_Math" display="inline" id="S2.E4.m2.4"><semantics id="S2.E4.m2.4a"><mrow id="S2.E4.m2.4.5" xref="S2.E4.m2.4.5.cmml"><mi id="S2.E4.m2.4.5.2" xref="S2.E4.m2.4.5.2.cmml"></mi><mo id="S2.E4.m2.4.5.1" xref="S2.E4.m2.4.5.1.cmml">=</mo><mrow id="S2.E4.m2.4.4a" xref="S2.E4.m2.4.5.3.1.cmml"><mo id="S2.E4.m2.4.4a.5" xref="S2.E4.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S2.E4.m2.4.4.4a" rowspacing="0pt" xref="S2.E4.m2.4.5.3.1.cmml"><mtr id="S2.E4.m2.4.4.4aa" xref="S2.E4.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4ab" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.1.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.1.3.1.cmml"><msub id="S2.E4.m2.1.1.1.1.1.1.3.1" xref="S2.E4.m2.1.1.1.1.1.1.3.1.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.3.1.2" xref="S2.E4.m2.1.1.1.1.1.1.3.1.2.cmml">s</mi><mrow id="S2.E4.m2.1.1.1.1.1.1.2.2.4" xref="S2.E4.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S2.E4.m2.1.1.1.1.1.1.2.2.4.1" xref="S2.E4.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S2.E4.m2.1.1.1.1.1.1.2.2.2" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S2.E4.m2.1.1.1.1.1.1.3.2" xref="S2.E4.m2.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4ac" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.2.2.2.2.2.1.7" xref="S2.E4.m2.2.2.2.2.2.1.7.1.cmml"><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.cmml"><msub id="S2.E4.m2.2.2.2.2.2.1.7.1.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.3.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3.2.cmml">s</mi><mrow id="S2.E4.m2.2.2.2.2.2.1.2.2.4" xref="S2.E4.m2.2.2.2.2.2.1.2.2.3.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.1.1.1.cmml">i</mi><mo id="S2.E4.m2.2.2.2.2.2.1.2.2.4.1" xref="S2.E4.m2.2.2.2.2.2.1.2.2.3.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2.2.1.2.2.2" xref="S2.E4.m2.2.2.2.2.2.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.2.cmml">∈</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.5" xref="S2.E4.m2.2.2.2.2.2.1.5.cmml">Topk</mi><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1a" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">⁡</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml"><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.2" stretchy="false" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">(</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.cmml"><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3" stretchy="false" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml">{</mo><msub id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S2.E4.m2.2.2.2.2.2.1.4.2.4" xref="S2.E4.m2.2.2.2.2.2.1.4.2.3.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.3.1.1" xref="S2.E4.m2.2.2.2.2.2.1.3.1.1.cmml">j</mi><mo id="S2.E4.m2.2.2.2.2.2.1.4.2.4.1" xref="S2.E4.m2.2.2.2.2.2.1.4.2.3.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2.2.1.4.2.2" xref="S2.E4.m2.2.2.2.2.2.1.4.2.2.cmml">t</mi></mrow></msub><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.4" lspace="0em" rspace="0em" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.cmml"><mn id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2.cmml">1</mn><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3.cmml">⩽</mo><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4.cmml">j</mi><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5.cmml">⩽</mo><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6.cmml">N</mi></mrow><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.5" stretchy="false" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2.2.1.6" xref="S2.E4.m2.2.2.2.2.2.1.6.cmml">K</mi><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.4" stretchy="false" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m2.2.2.2.2.2.1.7.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S2.E4.m2.4.4.4ad" xref="S2.E4.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4ae" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.3.3.3.3.1.1.3" xref="S2.E4.m2.4.5.3.1.cmml"><mn id="S2.E4.m2.3.3.3.3.1.1.1" xref="S2.E4.m2.3.3.3.3.1.1.1.cmml">0</mn><mo id="S2.E4.m2.3.3.3.3.1.1.3.1" xref="S2.E4.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4af" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.4.4.4.4.2.1.3" xref="S2.E4.m2.4.4.4.4.2.1.1a.cmml"><mtext id="S2.E4.m2.4.4.4.4.2.1.1" xref="S2.E4.m2.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S2.E4.m2.4.4.4.4.2.1.3.1" xref="S2.E4.m2.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.4b"><apply id="S2.E4.m2.4.5.cmml" xref="S2.E4.m2.4.5"><eq id="S2.E4.m2.4.5.1.cmml" xref="S2.E4.m2.4.5.1"></eq><csymbol cd="latexml" id="S2.E4.m2.4.5.2.cmml" xref="S2.E4.m2.4.5.2">absent</csymbol><apply id="S2.E4.m2.4.5.3.1.cmml" xref="S2.E4.m2.4.4a"><csymbol cd="latexml" id="S2.E4.m2.4.5.3.1.1.cmml" xref="S2.E4.m2.4.4a.5">cases</csymbol><apply id="S2.E4.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.1.3.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.1.1.3.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3.1.2">𝑠</ci><list id="S2.E4.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.4"><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1">𝑖</ci><ci id="S2.E4.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2">𝑡</ci></list></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7"><in id="S2.E4.m2.2.2.2.2.2.1.7.1.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.2"></in><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.2.2.2.1.7.1.3.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3">subscript</csymbol><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.3.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3.2">𝑠</ci><list id="S2.E4.m2.2.2.2.2.2.1.2.2.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.2.2.4"><ci id="S2.E4.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.1.1.1">𝑖</ci><ci id="S2.E4.m2.2.2.2.2.2.1.2.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.2.2.2">𝑡</ci></list></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1"><ci id="S2.E4.m2.2.2.2.2.2.1.5.cmml" xref="S2.E4.m2.2.2.2.2.2.1.5">Topk</ci><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2">𝑠</ci><list id="S2.E4.m2.2.2.2.2.2.1.4.2.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.4.2.4"><ci id="S2.E4.m2.2.2.2.2.2.1.3.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.3.1.1">𝑗</ci><ci id="S2.E4.m2.2.2.2.2.2.1.4.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.4.2.2">𝑡</ci></list></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"><and id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2a.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"></and><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2b.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"><leq id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3"></leq><cn id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2.cmml" type="integer" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2">1</cn><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4">𝑗</ci></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2c.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"><leq id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5"></leq><share href="#S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4.cmml" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2d.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"></share><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6">𝑁</ci></apply></apply></apply><ci id="S2.E4.m2.2.2.2.2.2.1.6.cmml" xref="S2.E4.m2.2.2.2.2.2.1.6">𝐾</ci></apply></apply><cn id="S2.E4.m2.3.3.3.3.1.1.1.cmml" type="integer" xref="S2.E4.m2.3.3.3.3.1.1.1">0</cn><ci id="S2.E4.m2.4.4.4.4.2.1.1a.cmml" xref="S2.E4.m2.4.4.4.4.2.1.3"><mtext id="S2.E4.m2.4.4.4.4.2.1.1.cmml" xref="S2.E4.m2.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.4c">\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1%
\leqslant j\leqslant N\},K),\\
0,&amp;\text{otherwise},\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m2.4d">= { start_ROW start_CELL italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT , end_CELL start_CELL italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ∈ roman_Topk ( { italic_s start_POSTSUBSCRIPT italic_j , italic_t end_POSTSUBSCRIPT | 1 ⩽ italic_j ⩽ italic_N } , italic_K ) , end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL otherwise , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle s_{i,t}" class="ltx_Math" display="inline" id="S2.E5.m1.2"><semantics id="S2.E5.m1.2a"><msub id="S2.E5.m1.2.3" xref="S2.E5.m1.2.3.cmml"><mi id="S2.E5.m1.2.3.2" xref="S2.E5.m1.2.3.2.cmml">s</mi><mrow id="S2.E5.m1.2.2.2.4" xref="S2.E5.m1.2.2.2.3.cmml"><mi id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">i</mi><mo id="S2.E5.m1.2.2.2.4.1" xref="S2.E5.m1.2.2.2.3.cmml">,</mo><mi id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.3.cmml" xref="S2.E5.m1.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.3.1.cmml" xref="S2.E5.m1.2.3">subscript</csymbol><ci id="S2.E5.m1.2.3.2.cmml" xref="S2.E5.m1.2.3.2">𝑠</ci><list id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.4"><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">𝑖</ci><ci id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">\displaystyle s_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.2d">italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{%
e}_{i}^{l}\right)," class="ltx_Math" display="inline" id="S2.E5.m2.1"><semantics id="S2.E5.m2.1a"><mrow id="S2.E5.m2.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.4" xref="S2.E5.m2.1.1.1.1.4.cmml"></mi><mo id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.3.cmml">=</mo><mrow id="S2.E5.m2.1.1.1.1.2.2" xref="S2.E5.m2.1.1.1.1.2.3.cmml"><msub id="S2.E5.m2.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.1.1.2.cmml">Softmax</mi><mi id="S2.E5.m2.1.1.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E5.m2.1.1.1.1.2.2a" xref="S2.E5.m2.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S2.E5.m2.1.1.1.1.2.2.2" xref="S2.E5.m2.1.1.1.1.2.3.cmml"><mo id="S2.E5.m2.1.1.1.1.2.2.2.2" xref="S2.E5.m2.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.E5.m2.1.1.1.1.2.2.2.1" xref="S2.E5.m2.1.1.1.1.2.2.2.1.cmml"><mmultiscripts id="S2.E5.m2.1.1.1.1.2.2.2.1.2" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.cmml"><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml">𝐮</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml">t</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3.cmml">l</mi><mrow id="S2.E5.m2.1.1.1.1.2.2.2.1.2a" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.cmml"></mrow><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.3.cmml">T</mi></mmultiscripts><mo id="S2.E5.m2.1.1.1.1.2.2.2.1.1" xref="S2.E5.m2.1.1.1.1.2.2.2.1.1.cmml">⁢</mo><msubsup id="S2.E5.m2.1.1.1.1.2.2.2.1.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.cmml"><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2.cmml">𝐞</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.3.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S2.E5.m2.1.1.1.1.2.2.2.3" xref="S2.E5.m2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m2.1.1.1.2" xref="S2.E5.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.1b"><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1"><eq id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.4.cmml" xref="S2.E5.m2.1.1.1.1.4">absent</csymbol><apply id="S2.E5.m2.1.1.1.1.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2"><apply id="S2.E5.m2.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.2">Softmax</ci><ci id="S2.E5.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1"><times id="S2.E5.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.1"></times><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2">𝐮</ci><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3">𝑡</ci></apply><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3">𝑙</ci></apply><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.3">𝑇</ci></apply><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.3.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2">𝐞</ci><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3">𝑖</ci></apply><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.3.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.1c">\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{%
e}_{i}^{l}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m2.1d">= roman_Softmax start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p2.19">where <math alttext="N" class="ltx_Math" display="inline" id="S2.p2.3.m1.1"><semantics id="S2.p2.3.m1.1a"><mi id="S2.p2.3.m1.1.1" xref="S2.p2.3.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m1.1b"><ci id="S2.p2.3.m1.1.1.cmml" xref="S2.p2.3.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m1.1d">italic_N</annotation></semantics></math> denotes the total number of experts,
<math alttext="\operatorname{FFN}_{i}(\cdot)" class="ltx_Math" display="inline" id="S2.p2.4.m2.2"><semantics id="S2.p2.4.m2.2a"><mrow id="S2.p2.4.m2.2.2.1" xref="S2.p2.4.m2.2.2.2.cmml"><msub id="S2.p2.4.m2.2.2.1.1" xref="S2.p2.4.m2.2.2.1.1.cmml"><mi id="S2.p2.4.m2.2.2.1.1.2" xref="S2.p2.4.m2.2.2.1.1.2.cmml">FFN</mi><mi id="S2.p2.4.m2.2.2.1.1.3" xref="S2.p2.4.m2.2.2.1.1.3.cmml">i</mi></msub><mo id="S2.p2.4.m2.2.2.1a" xref="S2.p2.4.m2.2.2.2.cmml">⁡</mo><mrow id="S2.p2.4.m2.2.2.1.2" xref="S2.p2.4.m2.2.2.2.cmml"><mo id="S2.p2.4.m2.2.2.1.2.1" stretchy="false" xref="S2.p2.4.m2.2.2.2.cmml">(</mo><mo id="S2.p2.4.m2.1.1" lspace="0em" rspace="0em" xref="S2.p2.4.m2.1.1.cmml">⋅</mo><mo id="S2.p2.4.m2.2.2.1.2.2" stretchy="false" xref="S2.p2.4.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m2.2b"><apply id="S2.p2.4.m2.2.2.2.cmml" xref="S2.p2.4.m2.2.2.1"><apply id="S2.p2.4.m2.2.2.1.1.cmml" xref="S2.p2.4.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m2.2.2.1.1.1.cmml" xref="S2.p2.4.m2.2.2.1.1">subscript</csymbol><ci id="S2.p2.4.m2.2.2.1.1.2.cmml" xref="S2.p2.4.m2.2.2.1.1.2">FFN</ci><ci id="S2.p2.4.m2.2.2.1.1.3.cmml" xref="S2.p2.4.m2.2.2.1.1.3">𝑖</ci></apply><ci id="S2.p2.4.m2.1.1.cmml" xref="S2.p2.4.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m2.2c">\operatorname{FFN}_{i}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m2.2d">roman_FFN start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> is the <math alttext="i" class="ltx_Math" display="inline" id="S2.p2.5.m3.1"><semantics id="S2.p2.5.m3.1a"><mi id="S2.p2.5.m3.1.1" xref="S2.p2.5.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.5.m3.1b"><ci id="S2.p2.5.m3.1.1.cmml" xref="S2.p2.5.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m3.1d">italic_i</annotation></semantics></math>-th expert FFN,
<math alttext="g_{i,t}" class="ltx_Math" display="inline" id="S2.p2.6.m4.2"><semantics id="S2.p2.6.m4.2a"><msub id="S2.p2.6.m4.2.3" xref="S2.p2.6.m4.2.3.cmml"><mi id="S2.p2.6.m4.2.3.2" xref="S2.p2.6.m4.2.3.2.cmml">g</mi><mrow id="S2.p2.6.m4.2.2.2.4" xref="S2.p2.6.m4.2.2.2.3.cmml"><mi id="S2.p2.6.m4.1.1.1.1" xref="S2.p2.6.m4.1.1.1.1.cmml">i</mi><mo id="S2.p2.6.m4.2.2.2.4.1" xref="S2.p2.6.m4.2.2.2.3.cmml">,</mo><mi id="S2.p2.6.m4.2.2.2.2" xref="S2.p2.6.m4.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.6.m4.2b"><apply id="S2.p2.6.m4.2.3.cmml" xref="S2.p2.6.m4.2.3"><csymbol cd="ambiguous" id="S2.p2.6.m4.2.3.1.cmml" xref="S2.p2.6.m4.2.3">subscript</csymbol><ci id="S2.p2.6.m4.2.3.2.cmml" xref="S2.p2.6.m4.2.3.2">𝑔</ci><list id="S2.p2.6.m4.2.2.2.3.cmml" xref="S2.p2.6.m4.2.2.2.4"><ci id="S2.p2.6.m4.1.1.1.1.cmml" xref="S2.p2.6.m4.1.1.1.1">𝑖</ci><ci id="S2.p2.6.m4.2.2.2.2.cmml" xref="S2.p2.6.m4.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m4.2c">g_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m4.2d">italic_g start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the gate value for the <math alttext="i" class="ltx_Math" display="inline" id="S2.p2.7.m5.1"><semantics id="S2.p2.7.m5.1a"><mi id="S2.p2.7.m5.1.1" xref="S2.p2.7.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m5.1b"><ci id="S2.p2.7.m5.1.1.cmml" xref="S2.p2.7.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m5.1d">italic_i</annotation></semantics></math>-th expert,
<math alttext="s_{i,t}" class="ltx_Math" display="inline" id="S2.p2.8.m6.2"><semantics id="S2.p2.8.m6.2a"><msub id="S2.p2.8.m6.2.3" xref="S2.p2.8.m6.2.3.cmml"><mi id="S2.p2.8.m6.2.3.2" xref="S2.p2.8.m6.2.3.2.cmml">s</mi><mrow id="S2.p2.8.m6.2.2.2.4" xref="S2.p2.8.m6.2.2.2.3.cmml"><mi id="S2.p2.8.m6.1.1.1.1" xref="S2.p2.8.m6.1.1.1.1.cmml">i</mi><mo id="S2.p2.8.m6.2.2.2.4.1" xref="S2.p2.8.m6.2.2.2.3.cmml">,</mo><mi id="S2.p2.8.m6.2.2.2.2" xref="S2.p2.8.m6.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.8.m6.2b"><apply id="S2.p2.8.m6.2.3.cmml" xref="S2.p2.8.m6.2.3"><csymbol cd="ambiguous" id="S2.p2.8.m6.2.3.1.cmml" xref="S2.p2.8.m6.2.3">subscript</csymbol><ci id="S2.p2.8.m6.2.3.2.cmml" xref="S2.p2.8.m6.2.3.2">𝑠</ci><list id="S2.p2.8.m6.2.2.2.3.cmml" xref="S2.p2.8.m6.2.2.2.4"><ci id="S2.p2.8.m6.1.1.1.1.cmml" xref="S2.p2.8.m6.1.1.1.1">𝑖</ci><ci id="S2.p2.8.m6.2.2.2.2.cmml" xref="S2.p2.8.m6.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m6.2c">s_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.8.m6.2d">italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the token-to-expert affinity,
<math alttext="\operatorname{Topk}(\cdot,K)" class="ltx_Math" display="inline" id="S2.p2.9.m7.3"><semantics id="S2.p2.9.m7.3a"><mrow id="S2.p2.9.m7.3.4.2" xref="S2.p2.9.m7.3.4.1.cmml"><mi id="S2.p2.9.m7.1.1" xref="S2.p2.9.m7.1.1.cmml">Topk</mi><mo id="S2.p2.9.m7.3.4.2a" xref="S2.p2.9.m7.3.4.1.cmml">⁡</mo><mrow id="S2.p2.9.m7.3.4.2.1" xref="S2.p2.9.m7.3.4.1.cmml"><mo id="S2.p2.9.m7.3.4.2.1.1" stretchy="false" xref="S2.p2.9.m7.3.4.1.cmml">(</mo><mo id="S2.p2.9.m7.2.2" lspace="0em" rspace="0em" xref="S2.p2.9.m7.2.2.cmml">⋅</mo><mo id="S2.p2.9.m7.3.4.2.1.2" xref="S2.p2.9.m7.3.4.1.cmml">,</mo><mi id="S2.p2.9.m7.3.3" xref="S2.p2.9.m7.3.3.cmml">K</mi><mo id="S2.p2.9.m7.3.4.2.1.3" stretchy="false" xref="S2.p2.9.m7.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m7.3b"><apply id="S2.p2.9.m7.3.4.1.cmml" xref="S2.p2.9.m7.3.4.2"><ci id="S2.p2.9.m7.1.1.cmml" xref="S2.p2.9.m7.1.1">Topk</ci><ci id="S2.p2.9.m7.2.2.cmml" xref="S2.p2.9.m7.2.2">⋅</ci><ci id="S2.p2.9.m7.3.3.cmml" xref="S2.p2.9.m7.3.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m7.3c">\operatorname{Topk}(\cdot,K)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.9.m7.3d">roman_Topk ( ⋅ , italic_K )</annotation></semantics></math> denotes the set comprising <math alttext="K" class="ltx_Math" display="inline" id="S2.p2.10.m8.1"><semantics id="S2.p2.10.m8.1a"><mi id="S2.p2.10.m8.1.1" xref="S2.p2.10.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.10.m8.1b"><ci id="S2.p2.10.m8.1.1.cmml" xref="S2.p2.10.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.p2.10.m8.1d">italic_K</annotation></semantics></math> highest affinity scores among those calculated for the <math alttext="t" class="ltx_Math" display="inline" id="S2.p2.11.m9.1"><semantics id="S2.p2.11.m9.1a"><mi id="S2.p2.11.m9.1.1" xref="S2.p2.11.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p2.11.m9.1b"><ci id="S2.p2.11.m9.1.1.cmml" xref="S2.p2.11.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p2.11.m9.1d">italic_t</annotation></semantics></math>-th token and all <math alttext="N" class="ltx_Math" display="inline" id="S2.p2.12.m10.1"><semantics id="S2.p2.12.m10.1a"><mi id="S2.p2.12.m10.1.1" xref="S2.p2.12.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.12.m10.1b"><ci id="S2.p2.12.m10.1.1.cmml" xref="S2.p2.12.m10.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m10.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p2.12.m10.1d">italic_N</annotation></semantics></math> experts,
and <math alttext="\mathbf{e}_{i}^{l}" class="ltx_Math" display="inline" id="S2.p2.13.m11.1"><semantics id="S2.p2.13.m11.1a"><msubsup id="S2.p2.13.m11.1.1" xref="S2.p2.13.m11.1.1.cmml"><mi id="S2.p2.13.m11.1.1.2.2" xref="S2.p2.13.m11.1.1.2.2.cmml">𝐞</mi><mi id="S2.p2.13.m11.1.1.2.3" xref="S2.p2.13.m11.1.1.2.3.cmml">i</mi><mi id="S2.p2.13.m11.1.1.3" xref="S2.p2.13.m11.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.13.m11.1b"><apply id="S2.p2.13.m11.1.1.cmml" xref="S2.p2.13.m11.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m11.1.1.1.cmml" xref="S2.p2.13.m11.1.1">superscript</csymbol><apply id="S2.p2.13.m11.1.1.2.cmml" xref="S2.p2.13.m11.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m11.1.1.2.1.cmml" xref="S2.p2.13.m11.1.1">subscript</csymbol><ci id="S2.p2.13.m11.1.1.2.2.cmml" xref="S2.p2.13.m11.1.1.2.2">𝐞</ci><ci id="S2.p2.13.m11.1.1.2.3.cmml" xref="S2.p2.13.m11.1.1.2.3">𝑖</ci></apply><ci id="S2.p2.13.m11.1.1.3.cmml" xref="S2.p2.13.m11.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m11.1c">\mathbf{e}_{i}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.13.m11.1d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is the centroid of the <math alttext="i" class="ltx_Math" display="inline" id="S2.p2.14.m12.1"><semantics id="S2.p2.14.m12.1a"><mi id="S2.p2.14.m12.1.1" xref="S2.p2.14.m12.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.14.m12.1b"><ci id="S2.p2.14.m12.1.1.cmml" xref="S2.p2.14.m12.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.14.m12.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p2.14.m12.1d">italic_i</annotation></semantics></math>-th expert in the <math alttext="l" class="ltx_Math" display="inline" id="S2.p2.15.m13.1"><semantics id="S2.p2.15.m13.1a"><mi id="S2.p2.15.m13.1.1" xref="S2.p2.15.m13.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p2.15.m13.1b"><ci id="S2.p2.15.m13.1.1.cmml" xref="S2.p2.15.m13.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.15.m13.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.p2.15.m13.1d">italic_l</annotation></semantics></math>-th layer.
Note that <math alttext="g_{i,t}" class="ltx_Math" display="inline" id="S2.p2.16.m14.2"><semantics id="S2.p2.16.m14.2a"><msub id="S2.p2.16.m14.2.3" xref="S2.p2.16.m14.2.3.cmml"><mi id="S2.p2.16.m14.2.3.2" xref="S2.p2.16.m14.2.3.2.cmml">g</mi><mrow id="S2.p2.16.m14.2.2.2.4" xref="S2.p2.16.m14.2.2.2.3.cmml"><mi id="S2.p2.16.m14.1.1.1.1" xref="S2.p2.16.m14.1.1.1.1.cmml">i</mi><mo id="S2.p2.16.m14.2.2.2.4.1" xref="S2.p2.16.m14.2.2.2.3.cmml">,</mo><mi id="S2.p2.16.m14.2.2.2.2" xref="S2.p2.16.m14.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.16.m14.2b"><apply id="S2.p2.16.m14.2.3.cmml" xref="S2.p2.16.m14.2.3"><csymbol cd="ambiguous" id="S2.p2.16.m14.2.3.1.cmml" xref="S2.p2.16.m14.2.3">subscript</csymbol><ci id="S2.p2.16.m14.2.3.2.cmml" xref="S2.p2.16.m14.2.3.2">𝑔</ci><list id="S2.p2.16.m14.2.2.2.3.cmml" xref="S2.p2.16.m14.2.2.2.4"><ci id="S2.p2.16.m14.1.1.1.1.cmml" xref="S2.p2.16.m14.1.1.1.1">𝑖</ci><ci id="S2.p2.16.m14.2.2.2.2.cmml" xref="S2.p2.16.m14.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.16.m14.2c">g_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.16.m14.2d">italic_g start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is sparse, indicating that only <math alttext="K" class="ltx_Math" display="inline" id="S2.p2.17.m15.1"><semantics id="S2.p2.17.m15.1a"><mi id="S2.p2.17.m15.1.1" xref="S2.p2.17.m15.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.17.m15.1b"><ci id="S2.p2.17.m15.1.1.cmml" xref="S2.p2.17.m15.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.17.m15.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.p2.17.m15.1d">italic_K</annotation></semantics></math> out of <math alttext="N" class="ltx_Math" display="inline" id="S2.p2.18.m16.1"><semantics id="S2.p2.18.m16.1a"><mi id="S2.p2.18.m16.1.1" xref="S2.p2.18.m16.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.18.m16.1b"><ci id="S2.p2.18.m16.1.1.cmml" xref="S2.p2.18.m16.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.18.m16.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p2.18.m16.1d">italic_N</annotation></semantics></math> gate values are nonzero.
This sparsity property ensures computational efficiency within an MoE layer, i.e., each token will be assigned to and computed in only <math alttext="K" class="ltx_Math" display="inline" id="S2.p2.19.m17.1"><semantics id="S2.p2.19.m17.1a"><mi id="S2.p2.19.m17.1.1" xref="S2.p2.19.m17.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.19.m17.1b"><ci id="S2.p2.19.m17.1.1.cmml" xref="S2.p2.19.m17.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.19.m17.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.p2.19.m17.1d">italic_K</annotation></semantics></math> experts.
Also, in the above formulations, we omit the layer normalization operation for brevity.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="398" id="S2.F2.g1" src="x2.png" width="822">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>
Illustration of DeepSeekMoE.
Subfigure (a) showcases an MoE layer with the conventional top-2 routing strategy.
Subfigure (b) illustrates the fine-grained expert segmentation strategy.
Subsequently, subfigure (c) demonstrates the integration of the shared expert isolation strategy, constituting the complete DeepSeekMoE architecture.
It is noteworthy that across these three architectures, the number of expert parameters and computational costs remain constant.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_section" id="S3" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>DeepSeekMoE Architecture</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">On top of the generic MoE architecture outlined in Section&nbsp;<a class="ltx_ref" href="#S2" title="2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>, we introduce DeepSeekMoE, which is specifically designed to exploit the potential of expert specialization.
As illustrated in Figure&nbsp;<a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>, our architecture incorporates two principal strategies: fine-grained expert segmentation and shared expert isolation.
Both of these strategies are designed to elevate the level of expert specialization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Fine-Grained Expert Segmentation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">In scenarios where the number of experts is limited, tokens assigned to a particular expert will be more likely to cover diverse types of knowledge.
As a consequence, the designated expert will intend to learn vastly different types of knowledge in its parameters, and they are hard to be simultaneously utilized.
However, if each token can be routed to more experts, diverse knowledge will gain the potential to be decomposed and learned in different experts respectively.
In this context, each expert can still retain a high level of expert specialization, contributing to a more focused knowledge distribution across experts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.3">In pursuit of the goal, while maintaining a consistent number of expert parameters and computational cost, we segment the experts with a finer grain.
The finer expert segmentation enables a more flexible and adaptable combination of activated experts.
To be specific, on top of a typical MoE architecture shown in Figure&nbsp;<a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(a), we segment each expert FFN into <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_m</annotation></semantics></math> smaller experts by reducing the FFN intermediate hidden dimension to <math alttext="\frac{1}{m}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mfrac id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mn id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">1</mn><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">m</mi></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><divide id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"></divide><cn id="S3.SS1.p2.2.m2.1.1.2.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.2">1</cn><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\frac{1}{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">divide start_ARG 1 end_ARG start_ARG italic_m end_ARG</annotation></semantics></math> times its original size.
Since each expert becomes smaller, in response, we also increase the number of activated experts to <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_m</annotation></semantics></math> times to keep the same computation cost, as illustrated in Figure&nbsp;<a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(b).
With the fine-grained expert segmentation, the output of an MoE layer can be expressed as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx3">
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{t}^{l}" class="ltx_Math" display="inline" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><msubsup id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3.cmml">t</mi><mi id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1">superscript</csymbol><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2">𝐡</ci><ci id="S3.E6.m1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">bold_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{i=1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf%
{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l}," class="ltx_Math" display="inline" id="S3.E6.m2.3"><semantics id="S3.E6.m2.3a"><mrow id="S3.E6.m2.3.3.1" xref="S3.E6.m2.3.3.1.1.cmml"><mrow id="S3.E6.m2.3.3.1.1" xref="S3.E6.m2.3.3.1.1.cmml"><mi id="S3.E6.m2.3.3.1.1.3" xref="S3.E6.m2.3.3.1.1.3.cmml"></mi><mo id="S3.E6.m2.3.3.1.1.2" xref="S3.E6.m2.3.3.1.1.2.cmml">=</mo><mrow id="S3.E6.m2.3.3.1.1.1" xref="S3.E6.m2.3.3.1.1.1.cmml"><mrow id="S3.E6.m2.3.3.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E6.m2.3.3.1.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.1.2.cmml"><munderover id="S3.E6.m2.3.3.1.1.1.1.2a" xref="S3.E6.m2.3.3.1.1.1.1.2.cmml"><mo id="S3.E6.m2.3.3.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E6.m2.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.2.2.3" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.2.2.3.2" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E6.m2.3.3.1.1.1.1.2.2.3.1" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m2.3.3.1.1.1.1.2.2.3.3" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m2.3.3.1.1.1.1.2.3" xref="S3.E6.m2.3.3.1.1.1.1.2.3.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.2.3.2" xref="S3.E6.m2.3.3.1.1.1.1.2.3.2.cmml">m</mi><mo id="S3.E6.m2.3.3.1.1.1.1.2.3.1" xref="S3.E6.m2.3.3.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m2.3.3.1.1.1.1.2.3.3" xref="S3.E6.m2.3.3.1.1.1.1.2.3.3.cmml">N</mi></mrow></munderover></mstyle><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="S3.E6.m2.2.2.2.4" xref="S3.E6.m2.2.2.2.3.cmml"><mi id="S3.E6.m2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml">i</mi><mo id="S3.E6.m2.2.2.2.4.1" xref="S3.E6.m2.2.2.2.3.cmml">,</mo><mi id="S3.E6.m2.2.2.2.2" xref="S3.E6.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.3" lspace="0.167em" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2a" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml">𝐮</mi><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml">t</mi><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m2.3.3.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.2.cmml">+</mo><msubsup id="S3.E6.m2.3.3.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.3.cmml"><mi id="S3.E6.m2.3.3.1.1.1.3.2.2" xref="S3.E6.m2.3.3.1.1.1.3.2.2.cmml">𝐮</mi><mi id="S3.E6.m2.3.3.1.1.1.3.2.3" xref="S3.E6.m2.3.3.1.1.1.3.2.3.cmml">t</mi><mi id="S3.E6.m2.3.3.1.1.1.3.3" xref="S3.E6.m2.3.3.1.1.1.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S3.E6.m2.3.3.1.2" xref="S3.E6.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.3b"><apply id="S3.E6.m2.3.3.1.1.cmml" xref="S3.E6.m2.3.3.1"><eq id="S3.E6.m2.3.3.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E6.m2.3.3.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.3">absent</csymbol><apply id="S3.E6.m2.3.3.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1"><plus id="S3.E6.m2.3.3.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.2"></plus><apply id="S3.E6.m2.3.3.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1"><apply id="S3.E6.m2.3.3.1.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E6.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E6.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3"><eq id="S3.E6.m2.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m2.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E6.m2.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E6.m2.3.3.1.1.1.1.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3"><times id="S3.E6.m2.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3.1"></times><ci id="S3.E6.m2.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3.2">𝑚</ci><ci id="S3.E6.m2.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3.3">𝑁</ci></apply></apply><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1"><times id="S3.E6.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.3"></times><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2">𝑔</ci><list id="S3.E6.m2.2.2.2.3.cmml" xref="S3.E6.m2.2.2.2.4"><ci id="S3.E6.m2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1">𝑖</ci><ci id="S3.E6.m2.2.2.2.2.cmml" xref="S3.E6.m2.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2"><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2">FFN</ci><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">superscript</csymbol><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2">𝐮</ci><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3">𝑡</ci></apply><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.E6.m2.3.3.1.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.3.1.cmml" xref="S3.E6.m2.3.3.1.1.1.3">superscript</csymbol><apply id="S3.E6.m2.3.3.1.1.1.3.2.cmml" xref="S3.E6.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.3.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.3.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.3.2.2">𝐮</ci><ci id="S3.E6.m2.3.3.1.1.1.3.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E6.m2.3.3.1.1.1.3.3.cmml" xref="S3.E6.m2.3.3.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.3c">\displaystyle=\sum_{i=1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf%
{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m2.3d">= ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m italic_N end_POSTSUPERSCRIPT ( italic_g start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT roman_FFN start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ) + bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle g_{i,t}" class="ltx_Math" display="inline" id="S3.E7.m1.2"><semantics id="S3.E7.m1.2a"><msub id="S3.E7.m1.2.3" xref="S3.E7.m1.2.3.cmml"><mi id="S3.E7.m1.2.3.2" xref="S3.E7.m1.2.3.2.cmml">g</mi><mrow id="S3.E7.m1.2.2.2.4" xref="S3.E7.m1.2.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.2.2.2.4.1" xref="S3.E7.m1.2.2.2.3.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.3.cmml" xref="S3.E7.m1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.1.cmml" xref="S3.E7.m1.2.3">subscript</csymbol><ci id="S3.E7.m1.2.3.2.cmml" xref="S3.E7.m1.2.3.2">𝑔</ci><list id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.4"><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑖</ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\displaystyle g_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.2d">italic_g start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1%
\leqslant j\leqslant mN\},mK),\\
0,&amp;\text{otherwise},\end{cases}" class="ltx_Math" display="inline" id="S3.E7.m2.4"><semantics id="S3.E7.m2.4a"><mrow id="S3.E7.m2.4.5" xref="S3.E7.m2.4.5.cmml"><mi id="S3.E7.m2.4.5.2" xref="S3.E7.m2.4.5.2.cmml"></mi><mo id="S3.E7.m2.4.5.1" xref="S3.E7.m2.4.5.1.cmml">=</mo><mrow id="S3.E7.m2.4.4a" xref="S3.E7.m2.4.5.3.1.cmml"><mo id="S3.E7.m2.4.4a.5" xref="S3.E7.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S3.E7.m2.4.4.4a" rowspacing="0pt" xref="S3.E7.m2.4.5.3.1.cmml"><mtr id="S3.E7.m2.4.4.4aa" xref="S3.E7.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4ab" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.1.1.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.1.1.3.1.cmml"><msub id="S3.E7.m2.1.1.1.1.1.1.3.1" xref="S3.E7.m2.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.3.1.2" xref="S3.E7.m2.1.1.1.1.1.1.3.1.2.cmml">s</mi><mrow id="S3.E7.m2.1.1.1.1.1.1.2.2.4" xref="S3.E7.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m2.1.1.1.1.1.1.2.2.4.1" xref="S3.E7.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S3.E7.m2.1.1.1.1.1.1.2.2.2" xref="S3.E7.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E7.m2.1.1.1.1.1.1.3.2" xref="S3.E7.m2.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4ac" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.2.2.2.2.2.1.6" xref="S3.E7.m2.2.2.2.2.2.1.6.1.cmml"><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.cmml"><msub id="S3.E7.m2.2.2.2.2.2.1.6.1.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.4.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4.2.cmml">s</mi><mrow id="S3.E7.m2.2.2.2.2.2.1.2.2.4" xref="S3.E7.m2.2.2.2.2.2.1.2.2.3.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.1.1.1" xref="S3.E7.m2.2.2.2.2.2.1.1.1.1.cmml">i</mi><mo id="S3.E7.m2.2.2.2.2.2.1.2.2.4.1" xref="S3.E7.m2.2.2.2.2.2.1.2.2.3.cmml">,</mo><mi id="S3.E7.m2.2.2.2.2.2.1.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.3.cmml">∈</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.5" xref="S3.E7.m2.2.2.2.2.2.1.5.cmml">Topk</mi><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2a" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">⁡</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.3" stretchy="false" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">(</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml"><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3" stretchy="false" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">{</mo><msub id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E7.m2.2.2.2.2.2.1.4.2.4" xref="S3.E7.m2.2.2.2.2.2.1.4.2.3.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.3.1.1" xref="S3.E7.m2.2.2.2.2.2.1.3.1.1.cmml">j</mi><mo id="S3.E7.m2.2.2.2.2.2.1.4.2.4.1" xref="S3.E7.m2.2.2.2.2.2.1.4.2.3.cmml">,</mo><mi id="S3.E7.m2.2.2.2.2.2.1.4.2.2" xref="S3.E7.m2.2.2.2.2.2.1.4.2.2.cmml">t</mi></mrow></msub><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.4" lspace="0em" rspace="0em" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml"><mn id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml">1</mn><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml">⩽</mo><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml">j</mi><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml">⩽</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml">m</mi><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml">⁢</mo><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml">N</mi></mrow></mrow><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.5" stretchy="false" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">,</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml">m</mi><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml">K</mi></mrow><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.5" stretchy="false" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m2.2.2.2.2.2.1.6.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E7.m2.4.4.4ad" xref="S3.E7.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4ae" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.3.3.3.3.1.1.3" xref="S3.E7.m2.4.5.3.1.cmml"><mn id="S3.E7.m2.3.3.3.3.1.1.1" xref="S3.E7.m2.3.3.3.3.1.1.1.cmml">0</mn><mo id="S3.E7.m2.3.3.3.3.1.1.3.1" xref="S3.E7.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4af" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.4.4.4.4.2.1.3" xref="S3.E7.m2.4.4.4.4.2.1.1a.cmml"><mtext id="S3.E7.m2.4.4.4.4.2.1.1" xref="S3.E7.m2.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S3.E7.m2.4.4.4.4.2.1.3.1" xref="S3.E7.m2.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.4b"><apply id="S3.E7.m2.4.5.cmml" xref="S3.E7.m2.4.5"><eq id="S3.E7.m2.4.5.1.cmml" xref="S3.E7.m2.4.5.1"></eq><csymbol cd="latexml" id="S3.E7.m2.4.5.2.cmml" xref="S3.E7.m2.4.5.2">absent</csymbol><apply id="S3.E7.m2.4.5.3.1.cmml" xref="S3.E7.m2.4.4a"><csymbol cd="latexml" id="S3.E7.m2.4.5.3.1.1.cmml" xref="S3.E7.m2.4.4a.5">cases</csymbol><apply id="S3.E7.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m2.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3.1.2">𝑠</ci><list id="S3.E7.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.2.4"><ci id="S3.E7.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E7.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.2.2">𝑡</ci></list></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6"><in id="S3.E7.m2.2.2.2.2.2.1.6.1.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.3"></in><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.4.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4"><csymbol cd="ambiguous" id="S3.E7.m2.2.2.2.2.2.1.6.1.4.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4">subscript</csymbol><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.4.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4.2">𝑠</ci><list id="S3.E7.m2.2.2.2.2.2.1.2.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.2.2.4"><ci id="S3.E7.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.1.1.1">𝑖</ci><ci id="S3.E7.m2.2.2.2.2.2.1.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.2.2.2">𝑡</ci></list></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2"><ci id="S3.E7.m2.2.2.2.2.2.1.5.cmml" xref="S3.E7.m2.2.2.2.2.2.1.5">Topk</ci><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2">𝑠</ci><list id="S3.E7.m2.2.2.2.2.2.1.4.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.4.2.4"><ci id="S3.E7.m2.2.2.2.2.2.1.3.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.3.1.1">𝑗</ci><ci id="S3.E7.m2.2.2.2.2.2.1.4.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.4.2.2">𝑡</ci></list></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><and id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2a.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></and><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2b.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3"></leq><cn id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml" type="integer" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2">1</cn><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4">𝑗</ci></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2c.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5"></leq><share href="#S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2d.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></share><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6"><times id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1"></times><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2">𝑚</ci><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3">𝑁</ci></apply></apply></apply></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2"><times id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1"></times><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2">𝑚</ci><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3">𝐾</ci></apply></apply></apply><cn id="S3.E7.m2.3.3.3.3.1.1.1.cmml" type="integer" xref="S3.E7.m2.3.3.3.3.1.1.1">0</cn><ci id="S3.E7.m2.4.4.4.4.2.1.1a.cmml" xref="S3.E7.m2.4.4.4.4.2.1.3"><mtext id="S3.E7.m2.4.4.4.4.2.1.1.cmml" xref="S3.E7.m2.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.4c">\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1%
\leqslant j\leqslant mN\},mK),\\
0,&amp;\text{otherwise},\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m2.4d">= { start_ROW start_CELL italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT , end_CELL start_CELL italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ∈ roman_Topk ( { italic_s start_POSTSUBSCRIPT italic_j , italic_t end_POSTSUBSCRIPT | 1 ⩽ italic_j ⩽ italic_m italic_N } , italic_m italic_K ) , end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL otherwise , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle s_{i,t}" class="ltx_Math" display="inline" id="S3.E8.m1.2"><semantics id="S3.E8.m1.2a"><msub id="S3.E8.m1.2.3" xref="S3.E8.m1.2.3.cmml"><mi id="S3.E8.m1.2.3.2" xref="S3.E8.m1.2.3.2.cmml">s</mi><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">i</mi><mo id="S3.E8.m1.2.2.2.4.1" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.3.cmml" xref="S3.E8.m1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.1.cmml" xref="S3.E8.m1.2.3">subscript</csymbol><ci id="S3.E8.m1.2.3.2.cmml" xref="S3.E8.m1.2.3.2">𝑠</ci><list id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.4"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑖</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">\displaystyle s_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.2d">italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{%
e}_{i}^{l}\right)," class="ltx_Math" display="inline" id="S3.E8.m2.1"><semantics id="S3.E8.m2.1a"><mrow id="S3.E8.m2.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mrow id="S3.E8.m2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.4" xref="S3.E8.m2.1.1.1.1.4.cmml"></mi><mo id="S3.E8.m2.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E8.m2.1.1.1.1.2.2" xref="S3.E8.m2.1.1.1.1.2.3.cmml"><msub id="S3.E8.m2.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.1.1.2.cmml">Softmax</mi><mi id="S3.E8.m2.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m2.1.1.1.1.2.2a" xref="S3.E8.m2.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2" xref="S3.E8.m2.1.1.1.1.2.3.cmml"><mo id="S3.E8.m2.1.1.1.1.2.2.2.2" xref="S3.E8.m2.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2.1" xref="S3.E8.m2.1.1.1.1.2.2.2.1.cmml"><mmultiscripts id="S3.E8.m2.1.1.1.1.2.2.2.1.2" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml">𝐮</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml">t</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3.cmml">l</mi><mrow id="S3.E8.m2.1.1.1.1.2.2.2.1.2a" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.cmml"></mrow><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.3.cmml">T</mi></mmultiscripts><mo id="S3.E8.m2.1.1.1.1.2.2.2.1.1" xref="S3.E8.m2.1.1.1.1.2.2.2.1.1.cmml">⁢</mo><msubsup id="S3.E8.m2.1.1.1.1.2.2.2.1.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2.cmml">𝐞</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.3.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S3.E8.m2.1.1.1.1.2.2.2.3" xref="S3.E8.m2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m2.1.1.1.2" xref="S3.E8.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.1b"><apply id="S3.E8.m2.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1"><eq id="S3.E8.m2.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E8.m2.1.1.1.1.4.cmml" xref="S3.E8.m2.1.1.1.1.4">absent</csymbol><apply id="S3.E8.m2.1.1.1.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2"><apply id="S3.E8.m2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.2">Softmax</ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1"><times id="S3.E8.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.1"></times><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2">𝐮</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3">𝑡</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3">𝑙</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.3">𝑇</ci></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.3.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2">𝐞</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3">𝑖</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.3.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.1c">\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{%
e}_{i}^{l}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m2.1d">= roman_Softmax start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.6">where the total number of expert parameters is equal to <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m1.1"><semantics id="S3.SS1.p2.4.m1.1a"><mi id="S3.SS1.p2.4.m1.1.1" xref="S3.SS1.p2.4.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m1.1b"><ci id="S3.SS1.p2.4.m1.1.1.cmml" xref="S3.SS1.p2.4.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m1.1d">italic_N</annotation></semantics></math> times the number of parameters in a standard FFN, and <math alttext="mN" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m2.1"><semantics id="S3.SS1.p2.5.m2.1a"><mrow id="S3.SS1.p2.5.m2.1.1" xref="S3.SS1.p2.5.m2.1.1.cmml"><mi id="S3.SS1.p2.5.m2.1.1.2" xref="S3.SS1.p2.5.m2.1.1.2.cmml">m</mi><mo id="S3.SS1.p2.5.m2.1.1.1" xref="S3.SS1.p2.5.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p2.5.m2.1.1.3" xref="S3.SS1.p2.5.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m2.1b"><apply id="S3.SS1.p2.5.m2.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1"><times id="S3.SS1.p2.5.m2.1.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1.1"></times><ci id="S3.SS1.p2.5.m2.1.1.2.cmml" xref="S3.SS1.p2.5.m2.1.1.2">𝑚</ci><ci id="S3.SS1.p2.5.m2.1.1.3.cmml" xref="S3.SS1.p2.5.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m2.1c">mN</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m2.1d">italic_m italic_N</annotation></semantics></math> denotes the total number of fine-grained experts.
With the fine-grained expert segmentation strategy, the number of nonzero gates will also increases to <math alttext="mK" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m3.1"><semantics id="S3.SS1.p2.6.m3.1a"><mrow id="S3.SS1.p2.6.m3.1.1" xref="S3.SS1.p2.6.m3.1.1.cmml"><mi id="S3.SS1.p2.6.m3.1.1.2" xref="S3.SS1.p2.6.m3.1.1.2.cmml">m</mi><mo id="S3.SS1.p2.6.m3.1.1.1" xref="S3.SS1.p2.6.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p2.6.m3.1.1.3" xref="S3.SS1.p2.6.m3.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m3.1b"><apply id="S3.SS1.p2.6.m3.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1"><times id="S3.SS1.p2.6.m3.1.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1.1"></times><ci id="S3.SS1.p2.6.m3.1.1.2.cmml" xref="S3.SS1.p2.6.m3.1.1.2">𝑚</ci><ci id="S3.SS1.p2.6.m3.1.1.3.cmml" xref="S3.SS1.p2.6.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m3.1c">mK</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m3.1d">italic_m italic_K</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.4">From a combinatorial perspective, the fine-grained expert segmentation strategy substantially enhances the combinatorial flexibility of activated experts.
As an illustrative example, we consider the case where <math alttext="N=16" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">N</mi><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><eq id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></eq><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑁</ci><cn id="S3.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">N=16</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_N = 16</annotation></semantics></math>.
A typical top-2 routing strategy can yield <math alttext="\binom{16}{2}=120" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.2"><semantics id="S3.SS1.p3.2.m2.2a"><mrow id="S3.SS1.p3.2.m2.2.3" xref="S3.SS1.p3.2.m2.2.3.cmml"><mrow id="S3.SS1.p3.2.m2.2.2.4" xref="S3.SS1.p3.2.m2.2.2.3.cmml"><mo id="S3.SS1.p3.2.m2.2.2.4.1" xref="S3.SS1.p3.2.m2.2.2.3.1.cmml">(</mo><mfrac id="S3.SS1.p3.2.m2.2.2.2.2" linethickness="0pt" xref="S3.SS1.p3.2.m2.2.2.3.cmml"><mn id="S3.SS1.p3.2.m2.1.1.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.cmml">16</mn><mn id="S3.SS1.p3.2.m2.2.2.2.2.2.1" xref="S3.SS1.p3.2.m2.2.2.2.2.2.1.cmml">2</mn></mfrac><mo id="S3.SS1.p3.2.m2.2.2.4.2" xref="S3.SS1.p3.2.m2.2.2.3.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.2.m2.2.3.1" xref="S3.SS1.p3.2.m2.2.3.1.cmml">=</mo><mn id="S3.SS1.p3.2.m2.2.3.2" xref="S3.SS1.p3.2.m2.2.3.2.cmml">120</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.2b"><apply id="S3.SS1.p3.2.m2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.3"><eq id="S3.SS1.p3.2.m2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.3.1"></eq><apply id="S3.SS1.p3.2.m2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.4"><csymbol cd="latexml" id="S3.SS1.p3.2.m2.2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.2.4.1">binomial</csymbol><cn id="S3.SS1.p3.2.m2.1.1.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1">16</cn><cn id="S3.SS1.p3.2.m2.2.2.2.2.2.1.cmml" type="integer" xref="S3.SS1.p3.2.m2.2.2.2.2.2.1">2</cn></apply><cn id="S3.SS1.p3.2.m2.2.3.2.cmml" type="integer" xref="S3.SS1.p3.2.m2.2.3.2">120</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">\binom{16}{2}=120</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.2d">( FRACOP start_ARG 16 end_ARG start_ARG 2 end_ARG ) = 120</annotation></semantics></math> possible combinations.
By contrast, if each expert is split into <math alttext="4" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mn id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><cn id="S3.SS1.p3.3.m3.1.1.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">4</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">4</annotation></semantics></math> smaller experts, the fine-grained routing strategy can yield <math alttext="\binom{64}{8}=4,426,165,368" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.6"><semantics id="S3.SS1.p3.4.m4.6a"><mrow id="S3.SS1.p3.4.m4.6.7" xref="S3.SS1.p3.4.m4.6.7.cmml"><mrow id="S3.SS1.p3.4.m4.2.2.4" xref="S3.SS1.p3.4.m4.2.2.3.cmml"><mo id="S3.SS1.p3.4.m4.2.2.4.1" xref="S3.SS1.p3.4.m4.2.2.3.1.cmml">(</mo><mfrac id="S3.SS1.p3.4.m4.2.2.2.2" linethickness="0pt" xref="S3.SS1.p3.4.m4.2.2.3.cmml"><mn id="S3.SS1.p3.4.m4.1.1.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml">64</mn><mn id="S3.SS1.p3.4.m4.2.2.2.2.2.1" xref="S3.SS1.p3.4.m4.2.2.2.2.2.1.cmml">8</mn></mfrac><mo id="S3.SS1.p3.4.m4.2.2.4.2" xref="S3.SS1.p3.4.m4.2.2.3.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.4.m4.6.7.1" xref="S3.SS1.p3.4.m4.6.7.1.cmml">=</mo><mrow id="S3.SS1.p3.4.m4.6.7.2.2" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml"><mn id="S3.SS1.p3.4.m4.3.3" xref="S3.SS1.p3.4.m4.3.3.cmml">4</mn><mo id="S3.SS1.p3.4.m4.6.7.2.2.1" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml">,</mo><mn id="S3.SS1.p3.4.m4.4.4" xref="S3.SS1.p3.4.m4.4.4.cmml">426</mn><mo id="S3.SS1.p3.4.m4.6.7.2.2.2" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml">,</mo><mn id="S3.SS1.p3.4.m4.5.5" xref="S3.SS1.p3.4.m4.5.5.cmml">165</mn><mo id="S3.SS1.p3.4.m4.6.7.2.2.3" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml">,</mo><mn id="S3.SS1.p3.4.m4.6.6" xref="S3.SS1.p3.4.m4.6.6.cmml">368</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.6b"><apply id="S3.SS1.p3.4.m4.6.7.cmml" xref="S3.SS1.p3.4.m4.6.7"><eq id="S3.SS1.p3.4.m4.6.7.1.cmml" xref="S3.SS1.p3.4.m4.6.7.1"></eq><apply id="S3.SS1.p3.4.m4.2.2.3.cmml" xref="S3.SS1.p3.4.m4.2.2.4"><csymbol cd="latexml" id="S3.SS1.p3.4.m4.2.2.3.1.cmml" xref="S3.SS1.p3.4.m4.2.2.4.1">binomial</csymbol><cn id="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1">64</cn><cn id="S3.SS1.p3.4.m4.2.2.2.2.2.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.2.2.2.2.2.1">8</cn></apply><list id="S3.SS1.p3.4.m4.6.7.2.1.cmml" xref="S3.SS1.p3.4.m4.6.7.2.2"><cn id="S3.SS1.p3.4.m4.3.3.cmml" type="integer" xref="S3.SS1.p3.4.m4.3.3">4</cn><cn id="S3.SS1.p3.4.m4.4.4.cmml" type="integer" xref="S3.SS1.p3.4.m4.4.4">426</cn><cn id="S3.SS1.p3.4.m4.5.5.cmml" type="integer" xref="S3.SS1.p3.4.m4.5.5">165</cn><cn id="S3.SS1.p3.4.m4.6.6.cmml" type="integer" xref="S3.SS1.p3.4.m4.6.6">368</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.6c">\binom{64}{8}=4,426,165,368</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.6d">( FRACOP start_ARG 64 end_ARG start_ARG 8 end_ARG ) = 4 , 426 , 165 , 368</annotation></semantics></math> potential combinations.
The surge in combinatorial flexibility enhances the potential for achieving more accurate and targeted knowledge acquisition.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Shared Expert Isolation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">With a conventional routing strategy, tokens assigned to different experts may necessitate some common knowledge or information.
As a result, multiple experts may converge in acquiring shared knowledge in their respective parameters, thereby resulting in redundancy in expert parameters.
However, if there are shared experts dedicated to capturing and consolidating common knowledge across varying contexts, the parameter redundancy among other routed experts will be alleviated.
This alleviation of redundancy will contribute to a more parameter-efficient model with more specialized experts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2">Towards this objective, in addition to the fine-grained expert segmentation strategy, we further isolate <math alttext="K_{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐾</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">K_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> experts to serve as shared experts.
Regardless of the router module, each token will be deterministically assigned to these shared experts.
In order to maintain a constant computational cost, the number of activated experts among the other routed experts will be decreased by <math alttext="K_{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐾</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">K_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, as depicted in Figure&nbsp;<a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(c).
With the shared expert isolation strategy integrated, an MoE layer in the complete DeepSeekMoE architecture is formulated as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx4">
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{t}^{l}" class="ltx_Math" display="inline" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><msubsup id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mi id="S3.E9.m1.1.1.2.2" xref="S3.E9.m1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E9.m1.1.1.2.3" xref="S3.E9.m1.1.1.2.3.cmml">t</mi><mi id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1">superscript</csymbol><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2.2">𝐡</ci><ci id="S3.E9.m1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">bold_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{i=1}^{K_{s}}{\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l%
}\right)}+\sum_{i=K_{s}+1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(%
\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l}," class="ltx_Math" display="inline" id="S3.E9.m2.3"><semantics id="S3.E9.m2.3a"><mrow id="S3.E9.m2.3.3.1" xref="S3.E9.m2.3.3.1.1.cmml"><mrow id="S3.E9.m2.3.3.1.1" xref="S3.E9.m2.3.3.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.5" xref="S3.E9.m2.3.3.1.1.5.cmml"></mi><mo id="S3.E9.m2.3.3.1.1.4" xref="S3.E9.m2.3.3.1.1.4.cmml">=</mo><mrow id="S3.E9.m2.3.3.1.1.3" xref="S3.E9.m2.3.3.1.1.3.cmml"><mrow id="S3.E9.m2.3.3.1.1.2.2" xref="S3.E9.m2.3.3.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E9.m2.3.3.1.1.2.2.3" xref="S3.E9.m2.3.3.1.1.2.2.3.cmml"><munderover id="S3.E9.m2.3.3.1.1.2.2.3a" xref="S3.E9.m2.3.3.1.1.2.2.3.cmml"><mo id="S3.E9.m2.3.3.1.1.2.2.3.2.2" movablelimits="false" xref="S3.E9.m2.3.3.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E9.m2.3.3.1.1.2.2.3.2.3" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.2.2.3.2.3.2" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E9.m2.3.3.1.1.2.2.3.2.3.1" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E9.m2.3.3.1.1.2.2.3.2.3.3" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E9.m2.3.3.1.1.2.2.3.3" xref="S3.E9.m2.3.3.1.1.2.2.3.3.cmml"><mi id="S3.E9.m2.3.3.1.1.2.2.3.3.2" xref="S3.E9.m2.3.3.1.1.2.2.3.3.2.cmml">K</mi><mi id="S3.E9.m2.3.3.1.1.2.2.3.3.3" xref="S3.E9.m2.3.3.1.1.2.2.3.3.3.cmml">s</mi></msub></munderover></mstyle><mrow id="S3.E9.m2.3.3.1.1.2.2.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml"><msub id="S3.E9.m2.3.3.1.1.1.1.1.1.1" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.1.1.1.1.1.2" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S3.E9.m2.3.3.1.1.1.1.1.1.1.3" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m2.3.3.1.1.2.2.2.2a" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E9.m2.3.3.1.1.2.2.2.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml"><mo id="S3.E9.m2.3.3.1.1.2.2.2.2.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.cmml"><mi id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2.cmml">𝐮</mi><mi id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3.cmml">t</mi><mi id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S3.E9.m2.3.3.1.1.2.2.2.2.2.3" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m2.3.3.1.1.3.4" xref="S3.E9.m2.3.3.1.1.3.4.cmml">+</mo><mrow id="S3.E9.m2.3.3.1.1.3.3" xref="S3.E9.m2.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E9.m2.3.3.1.1.3.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.cmml"><munderover id="S3.E9.m2.3.3.1.1.3.3.2a" xref="S3.E9.m2.3.3.1.1.3.3.2.cmml"><mo id="S3.E9.m2.3.3.1.1.3.3.2.2.2" movablelimits="false" xref="S3.E9.m2.3.3.1.1.3.3.2.2.2.cmml">∑</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.2.2.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.2.2.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.2.cmml">i</mi><mo id="S3.E9.m2.3.3.1.1.3.3.2.2.3.1" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.1.cmml">=</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.cmml"><msub id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2.cmml">K</mi><mi id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3.cmml">s</mi></msub><mo id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1.cmml">+</mo><mn id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3.cmml">1</mn></mrow></mrow><mrow id="S3.E9.m2.3.3.1.1.3.3.2.3" xref="S3.E9.m2.3.3.1.1.3.3.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.2.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.3.2.cmml">m</mi><mo id="S3.E9.m2.3.3.1.1.3.3.2.3.1" xref="S3.E9.m2.3.3.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m2.3.3.1.1.3.3.2.3.3" xref="S3.E9.m2.3.3.1.1.3.3.2.3.3.cmml">N</mi></mrow></munderover></mstyle><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml"><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml"><msub id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2.cmml">g</mi><mrow id="S3.E9.m2.2.2.2.4" xref="S3.E9.m2.2.2.2.3.cmml"><mi id="S3.E9.m2.1.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml">i</mi><mo id="S3.E9.m2.2.2.2.4.1" xref="S3.E9.m2.2.2.2.3.cmml">,</mo><mi id="S3.E9.m2.2.2.2.2" xref="S3.E9.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.3" lspace="0.167em" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.3.cmml">⁢</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml"><msub id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2a" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml"><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2.cmml">𝐮</mi><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3.cmml">t</mi><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m2.3.3.1.1.3.4a" xref="S3.E9.m2.3.3.1.1.3.4.cmml">+</mo><msubsup id="S3.E9.m2.3.3.1.1.3.5" xref="S3.E9.m2.3.3.1.1.3.5.cmml"><mi id="S3.E9.m2.3.3.1.1.3.5.2.2" xref="S3.E9.m2.3.3.1.1.3.5.2.2.cmml">𝐮</mi><mi id="S3.E9.m2.3.3.1.1.3.5.2.3" xref="S3.E9.m2.3.3.1.1.3.5.2.3.cmml">t</mi><mi id="S3.E9.m2.3.3.1.1.3.5.3" xref="S3.E9.m2.3.3.1.1.3.5.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S3.E9.m2.3.3.1.2" xref="S3.E9.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.3b"><apply id="S3.E9.m2.3.3.1.1.cmml" xref="S3.E9.m2.3.3.1"><eq id="S3.E9.m2.3.3.1.1.4.cmml" xref="S3.E9.m2.3.3.1.1.4"></eq><csymbol cd="latexml" id="S3.E9.m2.3.3.1.1.5.cmml" xref="S3.E9.m2.3.3.1.1.5">absent</csymbol><apply id="S3.E9.m2.3.3.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3"><plus id="S3.E9.m2.3.3.1.1.3.4.cmml" xref="S3.E9.m2.3.3.1.1.3.4"></plus><apply id="S3.E9.m2.3.3.1.1.2.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2"><apply id="S3.E9.m2.3.3.1.1.2.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.2.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3">subscript</csymbol><sum id="S3.E9.m2.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.2"></sum><apply id="S3.E9.m2.3.3.1.1.2.2.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3"><eq id="S3.E9.m2.3.3.1.1.2.2.3.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S3.E9.m2.3.3.1.1.2.2.3.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.2">𝑖</ci><cn id="S3.E9.m2.3.3.1.1.2.2.3.2.3.3.cmml" type="integer" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E9.m2.3.3.1.1.2.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.3.3.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.2.2.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3.2">𝐾</ci><ci id="S3.E9.m2.3.3.1.1.2.2.3.3.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3.3">𝑠</ci></apply></apply><apply id="S3.E9.m2.3.3.1.1.2.2.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2"><apply id="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.2">FFN</ci><ci id="S3.E9.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2">𝐮</ci><ci id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3">𝑡</ci></apply><ci id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3">𝑙</ci></apply></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3"><apply id="S3.E9.m2.3.3.1.1.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2">subscript</csymbol><sum id="S3.E9.m2.3.3.1.1.3.3.2.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.2"></sum><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3"><eq id="S3.E9.m2.3.3.1.1.3.3.2.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.1"></eq><ci id="S3.E9.m2.3.3.1.1.3.3.2.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.2">𝑖</ci><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3"><plus id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1"></plus><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2">𝐾</ci><ci id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3">𝑠</ci></apply><cn id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3.cmml" type="integer" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3"><times id="S3.E9.m2.3.3.1.1.3.3.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3.1"></times><ci id="S3.E9.m2.3.3.1.1.3.3.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3.2">𝑚</ci><ci id="S3.E9.m2.3.3.1.1.3.3.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3.3">𝑁</ci></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1"><times id="S3.E9.m2.3.3.1.1.3.3.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.3"></times><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2">𝑔</ci><list id="S3.E9.m2.2.2.2.3.cmml" xref="S3.E9.m2.2.2.2.4"><ci id="S3.E9.m2.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1">𝑖</ci><ci id="S3.E9.m2.2.2.2.2.cmml" xref="S3.E9.m2.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2"><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2">FFN</ci><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2">𝐮</ci><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3">𝑡</ci></apply><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.5.cmml" xref="S3.E9.m2.3.3.1.1.3.5"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.5.1.cmml" xref="S3.E9.m2.3.3.1.1.3.5">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.3.5.2.cmml" xref="S3.E9.m2.3.3.1.1.3.5"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.5.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.5">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.5.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.5.2.2">𝐮</ci><ci id="S3.E9.m2.3.3.1.1.3.5.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.5.2.3">𝑡</ci></apply><ci id="S3.E9.m2.3.3.1.1.3.5.3.cmml" xref="S3.E9.m2.3.3.1.1.3.5.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.3c">\displaystyle=\sum_{i=1}^{K_{s}}{\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l%
}\right)}+\sum_{i=K_{s}+1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(%
\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m2.3d">= ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUPERSCRIPT roman_FFN start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_i = italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m italic_N end_POSTSUPERSCRIPT ( italic_g start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT roman_FFN start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ) + bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle g_{i,t}" class="ltx_Math" display="inline" id="S3.E10.m1.2"><semantics id="S3.E10.m1.2a"><msub id="S3.E10.m1.2.3" xref="S3.E10.m1.2.3.cmml"><mi id="S3.E10.m1.2.3.2" xref="S3.E10.m1.2.3.2.cmml">g</mi><mrow id="S3.E10.m1.2.2.2.4" xref="S3.E10.m1.2.2.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">i</mi><mo id="S3.E10.m1.2.2.2.4.1" xref="S3.E10.m1.2.2.2.3.cmml">,</mo><mi id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.3.cmml" xref="S3.E10.m1.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.3.1.cmml" xref="S3.E10.m1.2.3">subscript</csymbol><ci id="S3.E10.m1.2.3.2.cmml" xref="S3.E10.m1.2.3.2">𝑔</ci><list id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.4"><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">𝑖</ci><ci id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\displaystyle g_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.2d">italic_g start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|K_%
{s}+1\leqslant j\leqslant mN\},mK-K_{s}),\\
0,&amp;\text{otherwise},\end{cases}" class="ltx_Math" display="inline" id="S3.E10.m2.4"><semantics id="S3.E10.m2.4a"><mrow id="S3.E10.m2.4.5" xref="S3.E10.m2.4.5.cmml"><mi id="S3.E10.m2.4.5.2" xref="S3.E10.m2.4.5.2.cmml"></mi><mo id="S3.E10.m2.4.5.1" xref="S3.E10.m2.4.5.1.cmml">=</mo><mrow id="S3.E10.m2.4.4a" xref="S3.E10.m2.4.5.3.1.cmml"><mo id="S3.E10.m2.4.4a.5" xref="S3.E10.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S3.E10.m2.4.4.4a" rowspacing="0pt" xref="S3.E10.m2.4.5.3.1.cmml"><mtr id="S3.E10.m2.4.4.4aa" xref="S3.E10.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4ab" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.1.1.1.1.1.1.3" xref="S3.E10.m2.1.1.1.1.1.1.3.1.cmml"><msub id="S3.E10.m2.1.1.1.1.1.1.3.1" xref="S3.E10.m2.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E10.m2.1.1.1.1.1.1.3.1.2" xref="S3.E10.m2.1.1.1.1.1.1.3.1.2.cmml">s</mi><mrow id="S3.E10.m2.1.1.1.1.1.1.2.2.4" xref="S3.E10.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E10.m2.1.1.1.1.1.1.1.1.1" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E10.m2.1.1.1.1.1.1.2.2.4.1" xref="S3.E10.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S3.E10.m2.1.1.1.1.1.1.2.2.2" xref="S3.E10.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E10.m2.1.1.1.1.1.1.3.2" xref="S3.E10.m2.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4ac" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6" xref="S3.E10.m2.2.2.2.2.2.1.6.1.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.cmml"><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.4.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4.2.cmml">s</mi><mrow id="S3.E10.m2.2.2.2.2.2.1.2.2.4" xref="S3.E10.m2.2.2.2.2.2.1.2.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.1.1.1" xref="S3.E10.m2.2.2.2.2.2.1.1.1.1.cmml">i</mi><mo id="S3.E10.m2.2.2.2.2.2.1.2.2.4.1" xref="S3.E10.m2.2.2.2.2.2.1.2.2.3.cmml">,</mo><mi id="S3.E10.m2.2.2.2.2.2.1.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.3.cmml">∈</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.5" xref="S3.E10.m2.2.2.2.2.2.1.5.cmml">Topk</mi><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2a" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">⁡</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.3" stretchy="false" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">(</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml"><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3" stretchy="false" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">{</mo><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E10.m2.2.2.2.2.2.1.4.2.4" xref="S3.E10.m2.2.2.2.2.2.1.4.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.3.1.1" xref="S3.E10.m2.2.2.2.2.2.1.3.1.1.cmml">j</mi><mo id="S3.E10.m2.2.2.2.2.2.1.4.2.4.1" xref="S3.E10.m2.2.2.2.2.2.1.4.2.3.cmml">,</mo><mi id="S3.E10.m2.2.2.2.2.2.1.4.2.2" xref="S3.E10.m2.2.2.2.2.2.1.4.2.2.cmml">t</mi></mrow></msub><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.4" lspace="0em" rspace="0em" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml"><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2.cmml">K</mi><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3.cmml">s</mi></msub><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1.cmml">+</mo><mn id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3.cmml">1</mn></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml">⩽</mo><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml">j</mi><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml">⩽</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml">m</mi><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml">⁢</mo><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml">N</mi></mrow></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.5" stretchy="false" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">,</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2.cmml">m</mi><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3.cmml">K</mi></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml">−</mo><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2.cmml">K</mi><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3.cmml">s</mi></msub></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.5" stretchy="false" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E10.m2.4.4.4ad" xref="S3.E10.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4ae" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.3.3.3.3.1.1.3" xref="S3.E10.m2.4.5.3.1.cmml"><mn id="S3.E10.m2.3.3.3.3.1.1.1" xref="S3.E10.m2.3.3.3.3.1.1.1.cmml">0</mn><mo id="S3.E10.m2.3.3.3.3.1.1.3.1" xref="S3.E10.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4af" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.4.4.4.4.2.1.3" xref="S3.E10.m2.4.4.4.4.2.1.1a.cmml"><mtext id="S3.E10.m2.4.4.4.4.2.1.1" xref="S3.E10.m2.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S3.E10.m2.4.4.4.4.2.1.3.1" xref="S3.E10.m2.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m2.4b"><apply id="S3.E10.m2.4.5.cmml" xref="S3.E10.m2.4.5"><eq id="S3.E10.m2.4.5.1.cmml" xref="S3.E10.m2.4.5.1"></eq><csymbol cd="latexml" id="S3.E10.m2.4.5.2.cmml" xref="S3.E10.m2.4.5.2">absent</csymbol><apply id="S3.E10.m2.4.5.3.1.cmml" xref="S3.E10.m2.4.4a"><csymbol cd="latexml" id="S3.E10.m2.4.5.3.1.1.cmml" xref="S3.E10.m2.4.4a.5">cases</csymbol><apply id="S3.E10.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m2.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3.1.2">𝑠</ci><list id="S3.E10.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.2.2.4"><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E10.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.2.2.2">𝑡</ci></list></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6"><in id="S3.E10.m2.2.2.2.2.2.1.6.1.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.3"></in><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.4.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.4.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.4.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4.2">𝑠</ci><list id="S3.E10.m2.2.2.2.2.2.1.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.2.2.4"><ci id="S3.E10.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.1.1.1">𝑖</ci><ci id="S3.E10.m2.2.2.2.2.2.1.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.2.2.2">𝑡</ci></list></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2"><ci id="S3.E10.m2.2.2.2.2.2.1.5.cmml" xref="S3.E10.m2.2.2.2.2.2.1.5">Topk</ci><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2">𝑠</ci><list id="S3.E10.m2.2.2.2.2.2.1.4.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.4.2.4"><ci id="S3.E10.m2.2.2.2.2.2.1.3.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.3.1.1">𝑗</ci><ci id="S3.E10.m2.2.2.2.2.2.1.4.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.4.2.2">𝑡</ci></list></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><and id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2a.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></and><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2b.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3"></leq><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2"><plus id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1"></plus><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2">𝐾</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3">𝑠</ci></apply><cn id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3">1</cn></apply><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4">𝑗</ci></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2c.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5"></leq><share href="#S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2d.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></share><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6"><times id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1"></times><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2">𝑚</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3">𝑁</ci></apply></apply></apply></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2"><minus id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1"></minus><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2"><times id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1"></times><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2">𝑚</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2">𝐾</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3">𝑠</ci></apply></apply></apply></apply><cn id="S3.E10.m2.3.3.3.3.1.1.1.cmml" type="integer" xref="S3.E10.m2.3.3.3.3.1.1.1">0</cn><ci id="S3.E10.m2.4.4.4.4.2.1.1a.cmml" xref="S3.E10.m2.4.4.4.4.2.1.3"><mtext id="S3.E10.m2.4.4.4.4.2.1.1.cmml" xref="S3.E10.m2.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m2.4c">\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|K_%
{s}+1\leqslant j\leqslant mN\},mK-K_{s}),\\
0,&amp;\text{otherwise},\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m2.4d">= { start_ROW start_CELL italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT , end_CELL start_CELL italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ∈ roman_Topk ( { italic_s start_POSTSUBSCRIPT italic_j , italic_t end_POSTSUBSCRIPT | italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + 1 ⩽ italic_j ⩽ italic_m italic_N } , italic_m italic_K - italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) , end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL otherwise , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle s_{i,t}" class="ltx_Math" display="inline" id="S3.E11.m1.2"><semantics id="S3.E11.m1.2a"><msub id="S3.E11.m1.2.3" xref="S3.E11.m1.2.3.cmml"><mi id="S3.E11.m1.2.3.2" xref="S3.E11.m1.2.3.2.cmml">s</mi><mrow id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">i</mi><mo id="S3.E11.m1.2.2.2.4.1" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.3.cmml" xref="S3.E11.m1.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.3.1.cmml" xref="S3.E11.m1.2.3">subscript</csymbol><ci id="S3.E11.m1.2.3.2.cmml" xref="S3.E11.m1.2.3.2">𝑠</ci><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.4"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑖</ci><ci id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\displaystyle s_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.2d">italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{%
e}_{i}^{l}\right)." class="ltx_Math" display="inline" id="S3.E11.m2.1"><semantics id="S3.E11.m2.1a"><mrow id="S3.E11.m2.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mrow id="S3.E11.m2.1.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mi id="S3.E11.m2.1.1.1.1.4" xref="S3.E11.m2.1.1.1.1.4.cmml"></mi><mo id="S3.E11.m2.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E11.m2.1.1.1.1.2.2" xref="S3.E11.m2.1.1.1.1.2.3.cmml"><msub id="S3.E11.m2.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m2.1.1.1.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.1.1.1.2.cmml">Softmax</mi><mi id="S3.E11.m2.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E11.m2.1.1.1.1.2.2a" xref="S3.E11.m2.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E11.m2.1.1.1.1.2.2.2" xref="S3.E11.m2.1.1.1.1.2.3.cmml"><mo id="S3.E11.m2.1.1.1.1.2.2.2.2" xref="S3.E11.m2.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E11.m2.1.1.1.1.2.2.2.1" xref="S3.E11.m2.1.1.1.1.2.2.2.1.cmml"><mmultiscripts id="S3.E11.m2.1.1.1.1.2.2.2.1.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.cmml"><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml">𝐮</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml">t</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3.cmml">l</mi><mrow id="S3.E11.m2.1.1.1.1.2.2.2.1.2a" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.cmml"></mrow><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.3.cmml">T</mi></mmultiscripts><mo id="S3.E11.m2.1.1.1.1.2.2.2.1.1" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml">⁢</mo><msubsup id="S3.E11.m2.1.1.1.1.2.2.2.1.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.cmml"><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2.cmml">𝐞</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.3.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S3.E11.m2.1.1.1.1.2.2.2.3" xref="S3.E11.m2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E11.m2.1.1.1.2" lspace="0em" xref="S3.E11.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m2.1b"><apply id="S3.E11.m2.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1"><eq id="S3.E11.m2.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E11.m2.1.1.1.1.4.cmml" xref="S3.E11.m2.1.1.1.1.4">absent</csymbol><apply id="S3.E11.m2.1.1.1.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2"><apply id="S3.E11.m2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.2">Softmax</ci><ci id="S3.E11.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1"><times id="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1"></times><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2">𝐮</ci><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3">𝑡</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3">𝑙</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.3">𝑇</ci></apply><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.3.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2">𝐞</ci><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3">𝑖</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.3.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m2.1c">\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{%
e}_{i}^{l}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m2.1d">= roman_Softmax start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.5">Finally, in DeepSeekMoE, the number of shared expert is <math alttext="K_{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m1.1"><semantics id="S3.SS2.p2.3.m1.1a"><msub id="S3.SS2.p2.3.m1.1.1" xref="S3.SS2.p2.3.m1.1.1.cmml"><mi id="S3.SS2.p2.3.m1.1.1.2" xref="S3.SS2.p2.3.m1.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.3.m1.1.1.3" xref="S3.SS2.p2.3.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m1.1b"><apply id="S3.SS2.p2.3.m1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m1.1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m1.1.1.2.cmml" xref="S3.SS2.p2.3.m1.1.1.2">𝐾</ci><ci id="S3.SS2.p2.3.m1.1.1.3.cmml" xref="S3.SS2.p2.3.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m1.1c">K_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m1.1d">italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>,
the total number of routed experts is <math alttext="mN-K_{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m2.1"><semantics id="S3.SS2.p2.4.m2.1a"><mrow id="S3.SS2.p2.4.m2.1.1" xref="S3.SS2.p2.4.m2.1.1.cmml"><mrow id="S3.SS2.p2.4.m2.1.1.2" xref="S3.SS2.p2.4.m2.1.1.2.cmml"><mi id="S3.SS2.p2.4.m2.1.1.2.2" xref="S3.SS2.p2.4.m2.1.1.2.2.cmml">m</mi><mo id="S3.SS2.p2.4.m2.1.1.2.1" xref="S3.SS2.p2.4.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p2.4.m2.1.1.2.3" xref="S3.SS2.p2.4.m2.1.1.2.3.cmml">N</mi></mrow><mo id="S3.SS2.p2.4.m2.1.1.1" xref="S3.SS2.p2.4.m2.1.1.1.cmml">−</mo><msub id="S3.SS2.p2.4.m2.1.1.3" xref="S3.SS2.p2.4.m2.1.1.3.cmml"><mi id="S3.SS2.p2.4.m2.1.1.3.2" xref="S3.SS2.p2.4.m2.1.1.3.2.cmml">K</mi><mi id="S3.SS2.p2.4.m2.1.1.3.3" xref="S3.SS2.p2.4.m2.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m2.1b"><apply id="S3.SS2.p2.4.m2.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1"><minus id="S3.SS2.p2.4.m2.1.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1.1"></minus><apply id="S3.SS2.p2.4.m2.1.1.2.cmml" xref="S3.SS2.p2.4.m2.1.1.2"><times id="S3.SS2.p2.4.m2.1.1.2.1.cmml" xref="S3.SS2.p2.4.m2.1.1.2.1"></times><ci id="S3.SS2.p2.4.m2.1.1.2.2.cmml" xref="S3.SS2.p2.4.m2.1.1.2.2">𝑚</ci><ci id="S3.SS2.p2.4.m2.1.1.2.3.cmml" xref="S3.SS2.p2.4.m2.1.1.2.3">𝑁</ci></apply><apply id="S3.SS2.p2.4.m2.1.1.3.cmml" xref="S3.SS2.p2.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m2.1.1.3.1.cmml" xref="S3.SS2.p2.4.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.4.m2.1.1.3.2.cmml" xref="S3.SS2.p2.4.m2.1.1.3.2">𝐾</ci><ci id="S3.SS2.p2.4.m2.1.1.3.3.cmml" xref="S3.SS2.p2.4.m2.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m2.1c">mN-K_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m2.1d">italic_m italic_N - italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>,
and the number of nonzero gates is <math alttext="mK-K_{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m3.1"><semantics id="S3.SS2.p2.5.m3.1a"><mrow id="S3.SS2.p2.5.m3.1.1" xref="S3.SS2.p2.5.m3.1.1.cmml"><mrow id="S3.SS2.p2.5.m3.1.1.2" xref="S3.SS2.p2.5.m3.1.1.2.cmml"><mi id="S3.SS2.p2.5.m3.1.1.2.2" xref="S3.SS2.p2.5.m3.1.1.2.2.cmml">m</mi><mo id="S3.SS2.p2.5.m3.1.1.2.1" xref="S3.SS2.p2.5.m3.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p2.5.m3.1.1.2.3" xref="S3.SS2.p2.5.m3.1.1.2.3.cmml">K</mi></mrow><mo id="S3.SS2.p2.5.m3.1.1.1" xref="S3.SS2.p2.5.m3.1.1.1.cmml">−</mo><msub id="S3.SS2.p2.5.m3.1.1.3" xref="S3.SS2.p2.5.m3.1.1.3.cmml"><mi id="S3.SS2.p2.5.m3.1.1.3.2" xref="S3.SS2.p2.5.m3.1.1.3.2.cmml">K</mi><mi id="S3.SS2.p2.5.m3.1.1.3.3" xref="S3.SS2.p2.5.m3.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m3.1b"><apply id="S3.SS2.p2.5.m3.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1"><minus id="S3.SS2.p2.5.m3.1.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1.1"></minus><apply id="S3.SS2.p2.5.m3.1.1.2.cmml" xref="S3.SS2.p2.5.m3.1.1.2"><times id="S3.SS2.p2.5.m3.1.1.2.1.cmml" xref="S3.SS2.p2.5.m3.1.1.2.1"></times><ci id="S3.SS2.p2.5.m3.1.1.2.2.cmml" xref="S3.SS2.p2.5.m3.1.1.2.2">𝑚</ci><ci id="S3.SS2.p2.5.m3.1.1.2.3.cmml" xref="S3.SS2.p2.5.m3.1.1.2.3">𝐾</ci></apply><apply id="S3.SS2.p2.5.m3.1.1.3.cmml" xref="S3.SS2.p2.5.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m3.1.1.3.1.cmml" xref="S3.SS2.p2.5.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.5.m3.1.1.3.2.cmml" xref="S3.SS2.p2.5.m3.1.1.3.2">𝐾</ci><ci id="S3.SS2.p2.5.m3.1.1.3.3.cmml" xref="S3.SS2.p2.5.m3.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m3.1c">mK-K_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m3.1d">italic_m italic_K - italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">It is worth noting that the prototype of shared expert isolation can be credited to <cite class="ltx_cite ltx_citemacro_citet">Rajbhandari et&nbsp;al. (<a class="ltx_ref" href="#bib.bib40" title="">2022</a>)</cite>.
The key distinction lies in the fact that they derive this strategy from an engineering perspective, while we approach it from an algorithmic standpoint.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Load Balance Consideration</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Automatically learned routing strategies may encounter the issue of load imbalance, which manifests two notable defects.
Firstly, there is a risk of routing collapse&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shazeer et&nbsp;al., <a class="ltx_ref" href="#bib.bib47" title="">2017</a>)</cite>, i.e., the model always selects only a few experts, preventing other experts from sufficient training.
Secondly, if experts are distributed across multiple devices, load imbalance can exacerbate computation bottlenecks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Expert-Level Balance Loss.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.7">In order to mitigate the risk of routing collapse, we also employ an expert-level balance loss.
The computation of the balance loss is as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx5">
<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\mathrm{ExpBal}}" class="ltx_Math" display="inline" id="S3.E12.m1.1"><semantics id="S3.E12.m1.1a"><msub id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml">ℒ</mi><mi id="S3.E12.m1.1.1.3" xref="S3.E12.m1.1.1.3.cmml">ExpBal</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.cmml" xref="S3.E12.m1.1.1">subscript</csymbol><ci id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2">ℒ</ci><ci id="S3.E12.m1.1.1.3.cmml" xref="S3.E12.m1.1.1.3">ExpBal</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\displaystyle\mathcal{L}_{\mathrm{ExpBal}}</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_ExpBal end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\alpha_{1}\sum_{i=1}^{N^{\prime}}{f_{i}P_{i}}," class="ltx_Math" display="inline" id="S3.E12.m2.1"><semantics id="S3.E12.m2.1a"><mrow id="S3.E12.m2.1.1.1" xref="S3.E12.m2.1.1.1.1.cmml"><mrow id="S3.E12.m2.1.1.1.1" xref="S3.E12.m2.1.1.1.1.cmml"><mi id="S3.E12.m2.1.1.1.1.2" xref="S3.E12.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E12.m2.1.1.1.1.1" xref="S3.E12.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E12.m2.1.1.1.1.3" xref="S3.E12.m2.1.1.1.1.3.cmml"><msub id="S3.E12.m2.1.1.1.1.3.2" xref="S3.E12.m2.1.1.1.1.3.2.cmml"><mi id="S3.E12.m2.1.1.1.1.3.2.2" xref="S3.E12.m2.1.1.1.1.3.2.2.cmml">α</mi><mn id="S3.E12.m2.1.1.1.1.3.2.3" xref="S3.E12.m2.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.E12.m2.1.1.1.1.3.1" xref="S3.E12.m2.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E12.m2.1.1.1.1.3.3" xref="S3.E12.m2.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E12.m2.1.1.1.1.3.3.1" xref="S3.E12.m2.1.1.1.1.3.3.1.cmml"><munderover id="S3.E12.m2.1.1.1.1.3.3.1a" xref="S3.E12.m2.1.1.1.1.3.3.1.cmml"><mo id="S3.E12.m2.1.1.1.1.3.3.1.2.2" movablelimits="false" xref="S3.E12.m2.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E12.m2.1.1.1.1.3.3.1.2.3" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.1.2.3.2" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E12.m2.1.1.1.1.3.3.1.2.3.1" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E12.m2.1.1.1.1.3.3.1.2.3.3" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><msup id="S3.E12.m2.1.1.1.1.3.3.1.3" xref="S3.E12.m2.1.1.1.1.3.3.1.3.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.1.3.2" xref="S3.E12.m2.1.1.1.1.3.3.1.3.2.cmml">N</mi><mo id="S3.E12.m2.1.1.1.1.3.3.1.3.3" xref="S3.E12.m2.1.1.1.1.3.3.1.3.3.cmml">′</mo></msup></munderover></mstyle><mrow id="S3.E12.m2.1.1.1.1.3.3.2" xref="S3.E12.m2.1.1.1.1.3.3.2.cmml"><msub id="S3.E12.m2.1.1.1.1.3.3.2.2" xref="S3.E12.m2.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.2.2.2" xref="S3.E12.m2.1.1.1.1.3.3.2.2.2.cmml">f</mi><mi id="S3.E12.m2.1.1.1.1.3.3.2.2.3" xref="S3.E12.m2.1.1.1.1.3.3.2.2.3.cmml">i</mi></msub><mo id="S3.E12.m2.1.1.1.1.3.3.2.1" xref="S3.E12.m2.1.1.1.1.3.3.2.1.cmml">⁢</mo><msub id="S3.E12.m2.1.1.1.1.3.3.2.3" xref="S3.E12.m2.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.2.3.2" xref="S3.E12.m2.1.1.1.1.3.3.2.3.2.cmml">P</mi><mi id="S3.E12.m2.1.1.1.1.3.3.2.3.3" xref="S3.E12.m2.1.1.1.1.3.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo id="S3.E12.m2.1.1.1.2" xref="S3.E12.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m2.1b"><apply id="S3.E12.m2.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1"><eq id="S3.E12.m2.1.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E12.m2.1.1.1.1.2.cmml" xref="S3.E12.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E12.m2.1.1.1.1.3.cmml" xref="S3.E12.m2.1.1.1.1.3"><times id="S3.E12.m2.1.1.1.1.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.1"></times><apply id="S3.E12.m2.1.1.1.1.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.2.2">𝛼</ci><cn id="S3.E12.m2.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E12.m2.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.E12.m2.1.1.1.1.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3"><apply id="S3.E12.m2.1.1.1.1.3.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.1.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1">superscript</csymbol><apply id="S3.E12.m2.1.1.1.1.3.3.1.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.1.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E12.m2.1.1.1.1.3.3.1.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.2"></sum><apply id="S3.E12.m2.1.1.1.1.3.3.1.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3"><eq id="S3.E12.m2.1.1.1.1.3.3.1.2.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E12.m2.1.1.1.1.3.3.1.2.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S3.E12.m2.1.1.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E12.m2.1.1.1.1.3.3.1.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.1.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3">superscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.3.1.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3.2">𝑁</ci><ci id="S3.E12.m2.1.1.1.1.3.3.1.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3.3">′</ci></apply></apply><apply id="S3.E12.m2.1.1.1.1.3.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2"><times id="S3.E12.m2.1.1.1.1.3.3.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.1"></times><apply id="S3.E12.m2.1.1.1.1.3.3.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2.2">𝑓</ci><ci id="S3.E12.m2.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="S3.E12.m2.1.1.1.1.3.3.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3.2">𝑃</ci><ci id="S3.E12.m2.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m2.1c">\displaystyle=\alpha_{1}\sum_{i=1}^{N^{\prime}}{f_{i}P_{i}},</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m2.1d">= italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f_{i}" class="ltx_Math" display="inline" id="S3.E13.m1.1"><semantics id="S3.E13.m1.1a"><msub id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><mi id="S3.E13.m1.1.1.2" xref="S3.E13.m1.1.1.2.cmml">f</mi><mi id="S3.E13.m1.1.1.3" xref="S3.E13.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1">subscript</csymbol><ci id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1.2">𝑓</ci><ci id="S3.E13.m1.1.1.3.cmml" xref="S3.E13.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\displaystyle f_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.1d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{N^{\prime}}{K^{\prime}T}\sum_{t=1}^{T}{\mathds{1}(\text{%
Token $t$ selects Expert $i$})}," class="ltx_Math" display="inline" id="S3.E13.m2.3"><semantics id="S3.E13.m2.3a"><mrow id="S3.E13.m2.3.3.1" xref="S3.E13.m2.3.3.1.1.cmml"><mrow id="S3.E13.m2.3.3.1.1" xref="S3.E13.m2.3.3.1.1.cmml"><mi id="S3.E13.m2.3.3.1.1.2" xref="S3.E13.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E13.m2.3.3.1.1.1" xref="S3.E13.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E13.m2.3.3.1.1.3" xref="S3.E13.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E13.m2.3.3.1.1.3.2" xref="S3.E13.m2.3.3.1.1.3.2.cmml"><mfrac id="S3.E13.m2.3.3.1.1.3.2a" xref="S3.E13.m2.3.3.1.1.3.2.cmml"><msup id="S3.E13.m2.3.3.1.1.3.2.2" xref="S3.E13.m2.3.3.1.1.3.2.2.cmml"><mi id="S3.E13.m2.3.3.1.1.3.2.2.2" xref="S3.E13.m2.3.3.1.1.3.2.2.2.cmml">N</mi><mo id="S3.E13.m2.3.3.1.1.3.2.2.3" xref="S3.E13.m2.3.3.1.1.3.2.2.3.cmml">′</mo></msup><mrow id="S3.E13.m2.3.3.1.1.3.2.3" xref="S3.E13.m2.3.3.1.1.3.2.3.cmml"><msup id="S3.E13.m2.3.3.1.1.3.2.3.2" xref="S3.E13.m2.3.3.1.1.3.2.3.2.cmml"><mi id="S3.E13.m2.3.3.1.1.3.2.3.2.2" xref="S3.E13.m2.3.3.1.1.3.2.3.2.2.cmml">K</mi><mo id="S3.E13.m2.3.3.1.1.3.2.3.2.3" xref="S3.E13.m2.3.3.1.1.3.2.3.2.3.cmml">′</mo></msup><mo id="S3.E13.m2.3.3.1.1.3.2.3.1" xref="S3.E13.m2.3.3.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E13.m2.3.3.1.1.3.2.3.3" xref="S3.E13.m2.3.3.1.1.3.2.3.3.cmml">T</mi></mrow></mfrac></mstyle><mo id="S3.E13.m2.3.3.1.1.3.1" xref="S3.E13.m2.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E13.m2.3.3.1.1.3.3" xref="S3.E13.m2.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E13.m2.3.3.1.1.3.3.1" xref="S3.E13.m2.3.3.1.1.3.3.1.cmml"><munderover id="S3.E13.m2.3.3.1.1.3.3.1a" xref="S3.E13.m2.3.3.1.1.3.3.1.cmml"><mo id="S3.E13.m2.3.3.1.1.3.3.1.2.2" movablelimits="false" xref="S3.E13.m2.3.3.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E13.m2.3.3.1.1.3.3.1.2.3" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.cmml"><mi id="S3.E13.m2.3.3.1.1.3.3.1.2.3.2" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.2.cmml">t</mi><mo id="S3.E13.m2.3.3.1.1.3.3.1.2.3.1" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E13.m2.3.3.1.1.3.3.1.2.3.3" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E13.m2.3.3.1.1.3.3.1.3" xref="S3.E13.m2.3.3.1.1.3.3.1.3.cmml">T</mi></munderover></mstyle><mrow id="S3.E13.m2.3.3.1.1.3.3.2" xref="S3.E13.m2.3.3.1.1.3.3.2.cmml"><mn id="S3.E13.m2.3.3.1.1.3.3.2.2" xref="S3.E13.m2.3.3.1.1.3.3.2.2.cmml">𝟙</mn><mo id="S3.E13.m2.3.3.1.1.3.3.2.1" xref="S3.E13.m2.3.3.1.1.3.3.2.1.cmml">⁢</mo><mrow id="S3.E13.m2.3.3.1.1.3.3.2.3.2" xref="S3.E13.m2.2.2.2ac.cmml"><mo id="S3.E13.m2.3.3.1.1.3.3.2.3.2.1" stretchy="false" xref="S3.E13.m2.2.2.2ac.cmml">(</mo><mrow id="S3.E13.m2.2.2.2a" xref="S3.E13.m2.2.2.2ac.cmml"><mtext id="S3.E13.m2.2.2.2aa" xref="S3.E13.m2.2.2.2aa.cmml">Token&nbsp;</mtext><mi id="S3.E13.m2.1.1.1.m1.1.1" xref="S3.E13.m2.1.1.1.m1.1.1.cmml">t</mi><mtext id="S3.E13.m2.2.2.2ab" xref="S3.E13.m2.2.2.2aa.cmml">&nbsp;selects Expert&nbsp;</mtext><mi id="S3.E13.m2.2.2.2.m2.1.1" xref="S3.E13.m2.2.2.2.m2.1.1.cmml">i</mi></mrow><mo id="S3.E13.m2.3.3.1.1.3.3.2.3.2.2" stretchy="false" xref="S3.E13.m2.2.2.2ac.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E13.m2.3.3.1.2" xref="S3.E13.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m2.3b"><apply id="S3.E13.m2.3.3.1.1.cmml" xref="S3.E13.m2.3.3.1"><eq id="S3.E13.m2.3.3.1.1.1.cmml" xref="S3.E13.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E13.m2.3.3.1.1.2.cmml" xref="S3.E13.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E13.m2.3.3.1.1.3.cmml" xref="S3.E13.m2.3.3.1.1.3"><times id="S3.E13.m2.3.3.1.1.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.1"></times><apply id="S3.E13.m2.3.3.1.1.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2"><divide id="S3.E13.m2.3.3.1.1.3.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2"></divide><apply id="S3.E13.m2.3.3.1.1.3.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.2.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2">superscript</csymbol><ci id="S3.E13.m2.3.3.1.1.3.2.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2.2">𝑁</ci><ci id="S3.E13.m2.3.3.1.1.3.2.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2.3">′</ci></apply><apply id="S3.E13.m2.3.3.1.1.3.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3"><times id="S3.E13.m2.3.3.1.1.3.2.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.1"></times><apply id="S3.E13.m2.3.3.1.1.3.2.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.2.3.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2">superscript</csymbol><ci id="S3.E13.m2.3.3.1.1.3.2.3.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2.2">𝐾</ci><ci id="S3.E13.m2.3.3.1.1.3.2.3.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2.3">′</ci></apply><ci id="S3.E13.m2.3.3.1.1.3.2.3.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.3">𝑇</ci></apply></apply><apply id="S3.E13.m2.3.3.1.1.3.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3"><apply id="S3.E13.m2.3.3.1.1.3.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.3.1.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1">superscript</csymbol><apply id="S3.E13.m2.3.3.1.1.3.3.1.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.3.1.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E13.m2.3.3.1.1.3.3.1.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.2"></sum><apply id="S3.E13.m2.3.3.1.1.3.3.1.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3"><eq id="S3.E13.m2.3.3.1.1.3.3.1.2.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S3.E13.m2.3.3.1.1.3.3.1.2.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.2">𝑡</ci><cn id="S3.E13.m2.3.3.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E13.m2.3.3.1.1.3.3.1.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.3">𝑇</ci></apply><apply id="S3.E13.m2.3.3.1.1.3.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2"><times id="S3.E13.m2.3.3.1.1.3.3.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.1"></times><cn id="S3.E13.m2.3.3.1.1.3.3.2.2.cmml" type="integer" xref="S3.E13.m2.3.3.1.1.3.3.2.2">1</cn><ci id="S3.E13.m2.2.2.2ac.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.3.2"><mrow id="S3.E13.m2.2.2.2a.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.3.2"><mtext id="S3.E13.m2.2.2.2aa.cmml" xref="S3.E13.m2.2.2.2aa">Token&nbsp;</mtext><mi id="S3.E13.m2.1.1.1.m1.1.1.cmml" xref="S3.E13.m2.1.1.1.m1.1.1">t</mi><mtext id="S3.E13.m2.2.2.2ab.cmml" xref="S3.E13.m2.2.2.2aa">&nbsp;selects Expert&nbsp;</mtext><mi id="S3.E13.m2.2.2.2.m2.1.1.cmml" xref="S3.E13.m2.2.2.2.m2.1.1">i</mi></mrow></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m2.3c">\displaystyle=\frac{N^{\prime}}{K^{\prime}T}\sum_{t=1}^{T}{\mathds{1}(\text{%
Token $t$ selects Expert $i$})},</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m2.3d">= divide start_ARG italic_N start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_ARG start_ARG italic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_T end_ARG ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT blackboard_1 ( Token italic_t selects Expert italic_i ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle P_{i}" class="ltx_Math" display="inline" id="S3.E14.m1.1"><semantics id="S3.E14.m1.1a"><msub id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml"><mi id="S3.E14.m1.1.1.2" xref="S3.E14.m1.1.1.2.cmml">P</mi><mi id="S3.E14.m1.1.1.3" xref="S3.E14.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.cmml" xref="S3.E14.m1.1.1">subscript</csymbol><ci id="S3.E14.m1.1.1.2.cmml" xref="S3.E14.m1.1.1.2">𝑃</ci><ci id="S3.E14.m1.1.1.3.cmml" xref="S3.E14.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\displaystyle P_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.1d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{T}\sum_{t=1}^{T}{s_{i,t}}," class="ltx_Math" display="inline" id="S3.E14.m2.3"><semantics id="S3.E14.m2.3a"><mrow id="S3.E14.m2.3.3.1" xref="S3.E14.m2.3.3.1.1.cmml"><mrow id="S3.E14.m2.3.3.1.1" xref="S3.E14.m2.3.3.1.1.cmml"><mi id="S3.E14.m2.3.3.1.1.2" xref="S3.E14.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E14.m2.3.3.1.1.1" xref="S3.E14.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E14.m2.3.3.1.1.3" xref="S3.E14.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E14.m2.3.3.1.1.3.2" xref="S3.E14.m2.3.3.1.1.3.2.cmml"><mfrac id="S3.E14.m2.3.3.1.1.3.2a" xref="S3.E14.m2.3.3.1.1.3.2.cmml"><mn id="S3.E14.m2.3.3.1.1.3.2.2" xref="S3.E14.m2.3.3.1.1.3.2.2.cmml">1</mn><mi id="S3.E14.m2.3.3.1.1.3.2.3" xref="S3.E14.m2.3.3.1.1.3.2.3.cmml">T</mi></mfrac></mstyle><mo id="S3.E14.m2.3.3.1.1.3.1" xref="S3.E14.m2.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E14.m2.3.3.1.1.3.3" xref="S3.E14.m2.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E14.m2.3.3.1.1.3.3.1" xref="S3.E14.m2.3.3.1.1.3.3.1.cmml"><munderover id="S3.E14.m2.3.3.1.1.3.3.1a" xref="S3.E14.m2.3.3.1.1.3.3.1.cmml"><mo id="S3.E14.m2.3.3.1.1.3.3.1.2.2" movablelimits="false" xref="S3.E14.m2.3.3.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E14.m2.3.3.1.1.3.3.1.2.3" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.cmml"><mi id="S3.E14.m2.3.3.1.1.3.3.1.2.3.2" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.2.cmml">t</mi><mo id="S3.E14.m2.3.3.1.1.3.3.1.2.3.1" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E14.m2.3.3.1.1.3.3.1.2.3.3" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E14.m2.3.3.1.1.3.3.1.3" xref="S3.E14.m2.3.3.1.1.3.3.1.3.cmml">T</mi></munderover></mstyle><msub id="S3.E14.m2.3.3.1.1.3.3.2" xref="S3.E14.m2.3.3.1.1.3.3.2.cmml"><mi id="S3.E14.m2.3.3.1.1.3.3.2.2" xref="S3.E14.m2.3.3.1.1.3.3.2.2.cmml">s</mi><mrow id="S3.E14.m2.2.2.2.4" xref="S3.E14.m2.2.2.2.3.cmml"><mi id="S3.E14.m2.1.1.1.1" xref="S3.E14.m2.1.1.1.1.cmml">i</mi><mo id="S3.E14.m2.2.2.2.4.1" xref="S3.E14.m2.2.2.2.3.cmml">,</mo><mi id="S3.E14.m2.2.2.2.2" xref="S3.E14.m2.2.2.2.2.cmml">t</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E14.m2.3.3.1.2" xref="S3.E14.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m2.3b"><apply id="S3.E14.m2.3.3.1.1.cmml" xref="S3.E14.m2.3.3.1"><eq id="S3.E14.m2.3.3.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E14.m2.3.3.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E14.m2.3.3.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.3"><times id="S3.E14.m2.3.3.1.1.3.1.cmml" xref="S3.E14.m2.3.3.1.1.3.1"></times><apply id="S3.E14.m2.3.3.1.1.3.2.cmml" xref="S3.E14.m2.3.3.1.1.3.2"><divide id="S3.E14.m2.3.3.1.1.3.2.1.cmml" xref="S3.E14.m2.3.3.1.1.3.2"></divide><cn id="S3.E14.m2.3.3.1.1.3.2.2.cmml" type="integer" xref="S3.E14.m2.3.3.1.1.3.2.2">1</cn><ci id="S3.E14.m2.3.3.1.1.3.2.3.cmml" xref="S3.E14.m2.3.3.1.1.3.2.3">𝑇</ci></apply><apply id="S3.E14.m2.3.3.1.1.3.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3"><apply id="S3.E14.m2.3.3.1.1.3.3.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.3.3.1.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1">superscript</csymbol><apply id="S3.E14.m2.3.3.1.1.3.3.1.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.3.3.1.2.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E14.m2.3.3.1.1.3.3.1.2.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.2"></sum><apply id="S3.E14.m2.3.3.1.1.3.3.1.2.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3"><eq id="S3.E14.m2.3.3.1.1.3.3.1.2.3.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S3.E14.m2.3.3.1.1.3.3.1.2.3.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.2">𝑡</ci><cn id="S3.E14.m2.3.3.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E14.m2.3.3.1.1.3.3.1.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.3">𝑇</ci></apply><apply id="S3.E14.m2.3.3.1.1.3.3.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.3.3.2.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.2">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.3.3.2.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.2.2">𝑠</ci><list id="S3.E14.m2.2.2.2.3.cmml" xref="S3.E14.m2.2.2.2.4"><ci id="S3.E14.m2.1.1.1.1.cmml" xref="S3.E14.m2.1.1.1.1">𝑖</ci><ci id="S3.E14.m2.2.2.2.2.cmml" xref="S3.E14.m2.2.2.2.2">𝑡</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m2.3c">\displaystyle=\frac{1}{T}\sum_{t=1}^{T}{s_{i,t}},</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m2.3d">= divide start_ARG 1 end_ARG start_ARG italic_T end_ARG ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.6">where <math alttext="\alpha_{1}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">α</mi><mn id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2">𝛼</ci><cn id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">\alpha_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.1.m1.1d">italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is a hyper-parameter called expert-level balance factor,
<math alttext="N^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><msup id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">N</mi><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2">𝑁</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">N^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.2.m2.1d">italic_N start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is equal to <math alttext="(mN-K_{s})" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2.cmml">m</mi><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml">−</mo><msub id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2.cmml">K</mi><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1"><minus id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1"></minus><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2"><times id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1"></times><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2">𝐾</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.1c">(mN-K_{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.3.m3.1d">( italic_m italic_N - italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="K^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS3.SSS0.Px1.p1.4.m4.1a"><msup id="S3.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml">K</mi><mo id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2">𝐾</ci><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.4.m4.1c">K^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.4.m4.1d">italic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is equal to <math alttext="(mK-K_{s})" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS3.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2.cmml">m</mi><mo id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3.cmml">K</mi></mrow><mo id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml">−</mo><msub id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2.cmml">K</mi><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.3" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1"><minus id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1"></minus><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2"><times id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1"></times><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3">𝐾</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2">𝐾</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.5.m5.1c">(mK-K_{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.5.m5.1d">( italic_m italic_K - italic_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math> for brevity.
<math alttext="\mathds{1}(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.6.m6.1"><semantics id="S3.SS3.SSS0.Px1.p1.6.m6.1a"><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.1.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml"><mn id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2.cmml">𝟙</mn><mo id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml"><mo id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml">(</mo><mo id="S3.SS3.SSS0.Px1.p1.6.m6.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml">⋅</mo><mo id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2"><times id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1"></times><cn id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2">1</cn><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.6.m6.1c">\mathds{1}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.6.m6.1d">blackboard_1 ( ⋅ )</annotation></semantics></math> denotes the indicator function.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Device-Level Balance Loss.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.2">In addition to the expert-level balance loss, we introduce a device-level balance loss.
When aiming to alleviate computation bottlenecks, it becomes unnecessary to enforce strict balance constraints at the expert level, because excessive constraints on load balance will compromise model performance.
Instead, our primary objective is to ensure balanced computation across the devices.
If we partition all routed experts into <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.1.m1.1d">italic_D</annotation></semantics></math> groups <math alttext="\{\mathcal{E}_{1},\mathcal{E}_{2},...,\mathcal{E}_{D}\}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.2.m2.4"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.4a"><mrow id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml"><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.4" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">{</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml">ℰ</mi><mn id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.5" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2.cmml">ℰ</mi><mn id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.6" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.7" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2.cmml">ℰ</mi><mi id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3.cmml">D</mi></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.8" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.4b"><set id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3"><apply id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2">ℰ</ci><cn id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2">ℰ</ci><cn id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2">ℰ</ci><ci id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3">𝐷</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.4c">\{\mathcal{E}_{1},\mathcal{E}_{2},...,\mathcal{E}_{D}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.2.m2.4d">{ caligraphic_E start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_E start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , caligraphic_E start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT }</annotation></semantics></math>, and deploy each group on a single device, the device-level balance loss is computed as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx6">
<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\mathrm{DevBal}}" class="ltx_Math" display="inline" id="S3.E15.m1.1"><semantics id="S3.E15.m1.1a"><msub id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.1.1.2" xref="S3.E15.m1.1.1.2.cmml">ℒ</mi><mi id="S3.E15.m1.1.1.3" xref="S3.E15.m1.1.1.3.cmml">DevBal</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E15.m1.1b"><apply id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.cmml" xref="S3.E15.m1.1.1">subscript</csymbol><ci id="S3.E15.m1.1.1.2.cmml" xref="S3.E15.m1.1.1.2">ℒ</ci><ci id="S3.E15.m1.1.1.3.cmml" xref="S3.E15.m1.1.1.3">DevBal</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.1c">\displaystyle\mathcal{L}_{\mathrm{DevBal}}</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_DevBal end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\alpha_{2}\sum_{i=1}^{D}{f_{i}^{\prime}P_{i}^{\prime}}," class="ltx_Math" display="inline" id="S3.E15.m2.1"><semantics id="S3.E15.m2.1a"><mrow id="S3.E15.m2.1.1.1" xref="S3.E15.m2.1.1.1.1.cmml"><mrow id="S3.E15.m2.1.1.1.1" xref="S3.E15.m2.1.1.1.1.cmml"><mi id="S3.E15.m2.1.1.1.1.2" xref="S3.E15.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E15.m2.1.1.1.1.1" xref="S3.E15.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E15.m2.1.1.1.1.3" xref="S3.E15.m2.1.1.1.1.3.cmml"><msub id="S3.E15.m2.1.1.1.1.3.2" xref="S3.E15.m2.1.1.1.1.3.2.cmml"><mi id="S3.E15.m2.1.1.1.1.3.2.2" xref="S3.E15.m2.1.1.1.1.3.2.2.cmml">α</mi><mn id="S3.E15.m2.1.1.1.1.3.2.3" xref="S3.E15.m2.1.1.1.1.3.2.3.cmml">2</mn></msub><mo id="S3.E15.m2.1.1.1.1.3.1" xref="S3.E15.m2.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E15.m2.1.1.1.1.3.3" xref="S3.E15.m2.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E15.m2.1.1.1.1.3.3.1" xref="S3.E15.m2.1.1.1.1.3.3.1.cmml"><munderover id="S3.E15.m2.1.1.1.1.3.3.1a" xref="S3.E15.m2.1.1.1.1.3.3.1.cmml"><mo id="S3.E15.m2.1.1.1.1.3.3.1.2.2" movablelimits="false" xref="S3.E15.m2.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E15.m2.1.1.1.1.3.3.1.2.3" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.cmml"><mi id="S3.E15.m2.1.1.1.1.3.3.1.2.3.2" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E15.m2.1.1.1.1.3.3.1.2.3.1" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E15.m2.1.1.1.1.3.3.1.2.3.3" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E15.m2.1.1.1.1.3.3.1.3" xref="S3.E15.m2.1.1.1.1.3.3.1.3.cmml">D</mi></munderover></mstyle><mrow id="S3.E15.m2.1.1.1.1.3.3.2" xref="S3.E15.m2.1.1.1.1.3.3.2.cmml"><msubsup id="S3.E15.m2.1.1.1.1.3.3.2.2" xref="S3.E15.m2.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E15.m2.1.1.1.1.3.3.2.2.2.2" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.2.cmml">f</mi><mi id="S3.E15.m2.1.1.1.1.3.3.2.2.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.3.cmml">i</mi><mo id="S3.E15.m2.1.1.1.1.3.3.2.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.2.3.cmml">′</mo></msubsup><mo id="S3.E15.m2.1.1.1.1.3.3.2.1" xref="S3.E15.m2.1.1.1.1.3.3.2.1.cmml">⁢</mo><msubsup id="S3.E15.m2.1.1.1.1.3.3.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E15.m2.1.1.1.1.3.3.2.3.2.2" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.2.cmml">P</mi><mi id="S3.E15.m2.1.1.1.1.3.3.2.3.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.3.cmml">i</mi><mo id="S3.E15.m2.1.1.1.1.3.3.2.3.3" xref="S3.E15.m2.1.1.1.1.3.3.2.3.3.cmml">′</mo></msubsup></mrow></mrow></mrow></mrow><mo id="S3.E15.m2.1.1.1.2" xref="S3.E15.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m2.1b"><apply id="S3.E15.m2.1.1.1.1.cmml" xref="S3.E15.m2.1.1.1"><eq id="S3.E15.m2.1.1.1.1.1.cmml" xref="S3.E15.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E15.m2.1.1.1.1.2.cmml" xref="S3.E15.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E15.m2.1.1.1.1.3.cmml" xref="S3.E15.m2.1.1.1.1.3"><times id="S3.E15.m2.1.1.1.1.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.1"></times><apply id="S3.E15.m2.1.1.1.1.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E15.m2.1.1.1.1.3.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.2.2">𝛼</ci><cn id="S3.E15.m2.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E15.m2.1.1.1.1.3.2.3">2</cn></apply><apply id="S3.E15.m2.1.1.1.1.3.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3"><apply id="S3.E15.m2.1.1.1.1.3.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.1.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1">superscript</csymbol><apply id="S3.E15.m2.1.1.1.1.3.3.1.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.1.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E15.m2.1.1.1.1.3.3.1.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.2"></sum><apply id="S3.E15.m2.1.1.1.1.3.3.1.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3"><eq id="S3.E15.m2.1.1.1.1.3.3.1.2.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E15.m2.1.1.1.1.3.3.1.2.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S3.E15.m2.1.1.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E15.m2.1.1.1.1.3.3.1.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.3">𝐷</ci></apply><apply id="S3.E15.m2.1.1.1.1.3.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2"><times id="S3.E15.m2.1.1.1.1.3.3.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.1"></times><apply id="S3.E15.m2.1.1.1.1.3.3.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2">superscript</csymbol><apply id="S3.E15.m2.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.2.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E15.m2.1.1.1.1.3.3.2.2.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.2">𝑓</ci><ci id="S3.E15.m2.1.1.1.1.3.3.2.2.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E15.m2.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2.3">′</ci></apply><apply id="S3.E15.m2.1.1.1.1.3.3.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E15.m2.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.3.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E15.m2.1.1.1.1.3.3.2.3.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.2">𝑃</ci><ci id="S3.E15.m2.1.1.1.1.3.3.2.3.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E15.m2.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m2.1c">\displaystyle=\alpha_{2}\sum_{i=1}^{D}{f_{i}^{\prime}P_{i}^{\prime}},</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m2.1d">= italic_α start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
<tbody id="S3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f_{i}^{\prime}" class="ltx_Math" display="inline" id="S3.E16.m1.1"><semantics id="S3.E16.m1.1a"><msubsup id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml"><mi id="S3.E16.m1.1.1.2.2" xref="S3.E16.m1.1.1.2.2.cmml">f</mi><mi id="S3.E16.m1.1.1.2.3" xref="S3.E16.m1.1.1.2.3.cmml">i</mi><mo id="S3.E16.m1.1.1.3" xref="S3.E16.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.E16.m1.1b"><apply id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.cmml" xref="S3.E16.m1.1.1">superscript</csymbol><apply id="S3.E16.m1.1.1.2.cmml" xref="S3.E16.m1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.2.1.cmml" xref="S3.E16.m1.1.1">subscript</csymbol><ci id="S3.E16.m1.1.1.2.2.cmml" xref="S3.E16.m1.1.1.2.2">𝑓</ci><ci id="S3.E16.m1.1.1.2.3.cmml" xref="S3.E16.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.E16.m1.1.1.3.cmml" xref="S3.E16.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.1c">\displaystyle f_{i}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.E16.m1.1d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{|\mathcal{E}_{i}|}\sum_{j\in\mathcal{E}_{i}}{f_{j}}," class="ltx_Math" display="inline" id="S3.E16.m2.2"><semantics id="S3.E16.m2.2a"><mrow id="S3.E16.m2.2.2.1" xref="S3.E16.m2.2.2.1.1.cmml"><mrow id="S3.E16.m2.2.2.1.1" xref="S3.E16.m2.2.2.1.1.cmml"><mi id="S3.E16.m2.2.2.1.1.2" xref="S3.E16.m2.2.2.1.1.2.cmml"></mi><mo id="S3.E16.m2.2.2.1.1.1" xref="S3.E16.m2.2.2.1.1.1.cmml">=</mo><mrow id="S3.E16.m2.2.2.1.1.3" xref="S3.E16.m2.2.2.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E16.m2.1.1" xref="S3.E16.m2.1.1.cmml"><mfrac id="S3.E16.m2.1.1a" xref="S3.E16.m2.1.1.cmml"><mn id="S3.E16.m2.1.1.3" xref="S3.E16.m2.1.1.3.cmml">1</mn><mrow id="S3.E16.m2.1.1.1.1" xref="S3.E16.m2.1.1.1.2.cmml"><mo id="S3.E16.m2.1.1.1.1.2" stretchy="false" xref="S3.E16.m2.1.1.1.2.1.cmml">|</mo><msub id="S3.E16.m2.1.1.1.1.1" xref="S3.E16.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m2.1.1.1.1.1.2" xref="S3.E16.m2.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S3.E16.m2.1.1.1.1.1.3" xref="S3.E16.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E16.m2.1.1.1.1.3" stretchy="false" xref="S3.E16.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S3.E16.m2.2.2.1.1.3.1" xref="S3.E16.m2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E16.m2.2.2.1.1.3.2" xref="S3.E16.m2.2.2.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E16.m2.2.2.1.1.3.2.1" xref="S3.E16.m2.2.2.1.1.3.2.1.cmml"><munder id="S3.E16.m2.2.2.1.1.3.2.1a" xref="S3.E16.m2.2.2.1.1.3.2.1.cmml"><mo id="S3.E16.m2.2.2.1.1.3.2.1.2" movablelimits="false" xref="S3.E16.m2.2.2.1.1.3.2.1.2.cmml">∑</mo><mrow id="S3.E16.m2.2.2.1.1.3.2.1.3" xref="S3.E16.m2.2.2.1.1.3.2.1.3.cmml"><mi id="S3.E16.m2.2.2.1.1.3.2.1.3.2" xref="S3.E16.m2.2.2.1.1.3.2.1.3.2.cmml">j</mi><mo id="S3.E16.m2.2.2.1.1.3.2.1.3.1" xref="S3.E16.m2.2.2.1.1.3.2.1.3.1.cmml">∈</mo><msub id="S3.E16.m2.2.2.1.1.3.2.1.3.3" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m2.2.2.1.1.3.2.1.3.3.2" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.2.cmml">ℰ</mi><mi id="S3.E16.m2.2.2.1.1.3.2.1.3.3.3" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><msub id="S3.E16.m2.2.2.1.1.3.2.2" xref="S3.E16.m2.2.2.1.1.3.2.2.cmml"><mi id="S3.E16.m2.2.2.1.1.3.2.2.2" xref="S3.E16.m2.2.2.1.1.3.2.2.2.cmml">f</mi><mi id="S3.E16.m2.2.2.1.1.3.2.2.3" xref="S3.E16.m2.2.2.1.1.3.2.2.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S3.E16.m2.2.2.1.2" xref="S3.E16.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m2.2b"><apply id="S3.E16.m2.2.2.1.1.cmml" xref="S3.E16.m2.2.2.1"><eq id="S3.E16.m2.2.2.1.1.1.cmml" xref="S3.E16.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S3.E16.m2.2.2.1.1.2.cmml" xref="S3.E16.m2.2.2.1.1.2">absent</csymbol><apply id="S3.E16.m2.2.2.1.1.3.cmml" xref="S3.E16.m2.2.2.1.1.3"><times id="S3.E16.m2.2.2.1.1.3.1.cmml" xref="S3.E16.m2.2.2.1.1.3.1"></times><apply id="S3.E16.m2.1.1.cmml" xref="S3.E16.m2.1.1"><divide id="S3.E16.m2.1.1.2.cmml" xref="S3.E16.m2.1.1"></divide><cn id="S3.E16.m2.1.1.3.cmml" type="integer" xref="S3.E16.m2.1.1.3">1</cn><apply id="S3.E16.m2.1.1.1.2.cmml" xref="S3.E16.m2.1.1.1.1"><abs id="S3.E16.m2.1.1.1.2.1.cmml" xref="S3.E16.m2.1.1.1.1.2"></abs><apply id="S3.E16.m2.1.1.1.1.1.cmml" xref="S3.E16.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m2.1.1.1.1.1.1.cmml" xref="S3.E16.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.E16.m2.1.1.1.1.1.2.cmml" xref="S3.E16.m2.1.1.1.1.1.2">ℰ</ci><ci id="S3.E16.m2.1.1.1.1.1.3.cmml" xref="S3.E16.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E16.m2.2.2.1.1.3.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2"><apply id="S3.E16.m2.2.2.1.1.3.2.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.1.1.3.2.1.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1">subscript</csymbol><sum id="S3.E16.m2.2.2.1.1.3.2.1.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.2"></sum><apply id="S3.E16.m2.2.2.1.1.3.2.1.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3"><in id="S3.E16.m2.2.2.1.1.3.2.1.3.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.1"></in><ci id="S3.E16.m2.2.2.1.1.3.2.1.3.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.2">𝑗</ci><apply id="S3.E16.m2.2.2.1.1.3.2.1.3.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.1.1.3.2.1.3.3.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3">subscript</csymbol><ci id="S3.E16.m2.2.2.1.1.3.2.1.3.3.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.2">ℰ</ci><ci id="S3.E16.m2.2.2.1.1.3.2.1.3.3.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E16.m2.2.2.1.1.3.2.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.1.1.3.2.2.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E16.m2.2.2.1.1.3.2.2.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2.2">𝑓</ci><ci id="S3.E16.m2.2.2.1.1.3.2.2.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m2.2c">\displaystyle=\frac{1}{|\mathcal{E}_{i}|}\sum_{j\in\mathcal{E}_{i}}{f_{j}},</annotation><annotation encoding="application/x-llamapun" id="S3.E16.m2.2d">= divide start_ARG 1 end_ARG start_ARG | caligraphic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="S3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle P_{i}^{\prime}" class="ltx_Math" display="inline" id="S3.E17.m1.1"><semantics id="S3.E17.m1.1a"><msubsup id="S3.E17.m1.1.1" xref="S3.E17.m1.1.1.cmml"><mi id="S3.E17.m1.1.1.2.2" xref="S3.E17.m1.1.1.2.2.cmml">P</mi><mi id="S3.E17.m1.1.1.2.3" xref="S3.E17.m1.1.1.2.3.cmml">i</mi><mo id="S3.E17.m1.1.1.3" xref="S3.E17.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.E17.m1.1b"><apply id="S3.E17.m1.1.1.cmml" xref="S3.E17.m1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.1.cmml" xref="S3.E17.m1.1.1">superscript</csymbol><apply id="S3.E17.m1.1.1.2.cmml" xref="S3.E17.m1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.2.1.cmml" xref="S3.E17.m1.1.1">subscript</csymbol><ci id="S3.E17.m1.1.1.2.2.cmml" xref="S3.E17.m1.1.1.2.2">𝑃</ci><ci id="S3.E17.m1.1.1.2.3.cmml" xref="S3.E17.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.E17.m1.1.1.3.cmml" xref="S3.E17.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.1c">\displaystyle P_{i}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.E17.m1.1d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{j\in\mathcal{E}_{i}}{P_{j}}," class="ltx_Math" display="inline" id="S3.E17.m2.1"><semantics id="S3.E17.m2.1a"><mrow id="S3.E17.m2.1.1.1" xref="S3.E17.m2.1.1.1.1.cmml"><mrow id="S3.E17.m2.1.1.1.1" xref="S3.E17.m2.1.1.1.1.cmml"><mi id="S3.E17.m2.1.1.1.1.2" xref="S3.E17.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E17.m2.1.1.1.1.1" xref="S3.E17.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E17.m2.1.1.1.1.3" xref="S3.E17.m2.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E17.m2.1.1.1.1.3.1" xref="S3.E17.m2.1.1.1.1.3.1.cmml"><munder id="S3.E17.m2.1.1.1.1.3.1a" xref="S3.E17.m2.1.1.1.1.3.1.cmml"><mo id="S3.E17.m2.1.1.1.1.3.1.2" movablelimits="false" xref="S3.E17.m2.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E17.m2.1.1.1.1.3.1.3" xref="S3.E17.m2.1.1.1.1.3.1.3.cmml"><mi id="S3.E17.m2.1.1.1.1.3.1.3.2" xref="S3.E17.m2.1.1.1.1.3.1.3.2.cmml">j</mi><mo id="S3.E17.m2.1.1.1.1.3.1.3.1" xref="S3.E17.m2.1.1.1.1.3.1.3.1.cmml">∈</mo><msub id="S3.E17.m2.1.1.1.1.3.1.3.3" xref="S3.E17.m2.1.1.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E17.m2.1.1.1.1.3.1.3.3.2" xref="S3.E17.m2.1.1.1.1.3.1.3.3.2.cmml">ℰ</mi><mi id="S3.E17.m2.1.1.1.1.3.1.3.3.3" xref="S3.E17.m2.1.1.1.1.3.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><msub id="S3.E17.m2.1.1.1.1.3.2" xref="S3.E17.m2.1.1.1.1.3.2.cmml"><mi id="S3.E17.m2.1.1.1.1.3.2.2" xref="S3.E17.m2.1.1.1.1.3.2.2.cmml">P</mi><mi id="S3.E17.m2.1.1.1.1.3.2.3" xref="S3.E17.m2.1.1.1.1.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E17.m2.1.1.1.2" xref="S3.E17.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m2.1b"><apply id="S3.E17.m2.1.1.1.1.cmml" xref="S3.E17.m2.1.1.1"><eq id="S3.E17.m2.1.1.1.1.1.cmml" xref="S3.E17.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E17.m2.1.1.1.1.2.cmml" xref="S3.E17.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E17.m2.1.1.1.1.3.cmml" xref="S3.E17.m2.1.1.1.1.3"><apply id="S3.E17.m2.1.1.1.1.3.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E17.m2.1.1.1.1.3.1.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E17.m2.1.1.1.1.3.1.2.cmml" xref="S3.E17.m2.1.1.1.1.3.1.2"></sum><apply id="S3.E17.m2.1.1.1.1.3.1.3.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3"><in id="S3.E17.m2.1.1.1.1.3.1.3.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.1"></in><ci id="S3.E17.m2.1.1.1.1.3.1.3.2.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.2">𝑗</ci><apply id="S3.E17.m2.1.1.1.1.3.1.3.3.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E17.m2.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3">subscript</csymbol><ci id="S3.E17.m2.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3.2">ℰ</ci><ci id="S3.E17.m2.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E17.m2.1.1.1.1.3.2.cmml" xref="S3.E17.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E17.m2.1.1.1.1.3.2.1.cmml" xref="S3.E17.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E17.m2.1.1.1.1.3.2.2.cmml" xref="S3.E17.m2.1.1.1.1.3.2.2">𝑃</ci><ci id="S3.E17.m2.1.1.1.1.3.2.3.cmml" xref="S3.E17.m2.1.1.1.1.3.2.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m2.1c">\displaystyle=\sum_{j\in\mathcal{E}_{i}}{P_{j}},</annotation><annotation encoding="application/x-llamapun" id="S3.E17.m2.1d">= ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.3">where <math alttext="\alpha_{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.3.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.3.m1.1a"><msub id="S3.SS3.SSS0.Px2.p1.3.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2.cmml">α</mi><mn id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2">𝛼</ci><cn id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m1.1c">\alpha_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.3.m1.1d">italic_α start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is a hyper-parameter called device-level balance factor.
In practice, we set a small expert-level balance factor to mitigate the risk of routing collapse, and meanwhile set a larger device-level balance factor to promote balanced computation across the devices.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Validation Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Training Data and Tokenization</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">Our training data is sampled from a large-scale multilingual corpus created by DeepSeek-AI.
The corpus primarily focuses on English and Chinese but also encompasses other languages.
It is derived from diverse sources, including web text, mathematical material, coding scripts, published literature, and various other textual materials.
For the purpose of validation experiments, we sample a subset containing 100B tokens from the corpus to train our models.
For tokenization, we utilize the HuggingFace Tokenizer<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://github.com/huggingface/tokenizers</span></span></span> tools to train byte pair encoding (BPE)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sennrich et&nbsp;al., <a class="ltx_ref" href="#bib.bib45" title="">2016</a>)</cite> tokenizers on a smaller subset of the training corpus.
In the validation experiments, we prepare a tokenizer with a vocabulary size of 8K, and the vocabulary size will be scaled up when training larger models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Infrastructures</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">We conduct experiments based on HAI-LLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(High-Flyer, <a class="ltx_ref" href="#bib.bib22" title="">2023</a>)</cite>, an efficient and light-weight training framework which integrates multiple parallelism strategies, including tensor parallelism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shoeybi et&nbsp;al., <a class="ltx_ref" href="#bib.bib49" title="">2019</a>; Narayanan et&nbsp;al., <a class="ltx_ref" href="#bib.bib37" title="">2021</a>; Korthikanti et&nbsp;al., <a class="ltx_ref" href="#bib.bib29" title="">2023</a>)</cite>, ZeRO data parallelism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rajbhandari et&nbsp;al., <a class="ltx_ref" href="#bib.bib39" title="">2020</a>)</cite>, PipeDream pipeline parallelism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Harlap et&nbsp;al., <a class="ltx_ref" href="#bib.bib19" title="">2018</a>)</cite>, and more specifically, expert parallelism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et&nbsp;al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> by combining data and tensor parallelism.
In order to optimize performance, we develop GPU kernels with CUDA and Triton&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Tillet et&nbsp;al., <a class="ltx_ref" href="#bib.bib51" title="">2019</a>)</cite> for gating algorithms and fusing computations across linear layers in different experts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.SSS2.p2">
<p class="ltx_p" id="S4.SS1.SSS2.p2.1">All experiments are carried out on clusters equipped with NVIDIA A100 or H800 GPUs.
Each node in the A100 cluster contains 8 GPUs connected pairwise via the NVLink bridge.
The H800 cluster also features 8 GPUs per node, interconnected using NVLink and NVSwitch within nodes.
For both A100 and H800 clusters, InfiniBand interconnects are utilized to facilitate communication across nodes.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3 </span>Hyper-Parameters</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S4.SS1.SSS3.Px1">
<h5 class="ltx_title ltx_title_paragraph">Model Settings.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS3.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS3.Px1.p1.1">In the validation experiments, we set the number of Transformer layers to 9 and the hidden dimension to 1280.
We employ the multi-head attention mechanism with a total of 10 attention heads, where each head has a dimension of 128.
For initialization, all learnable parameters are randomly initialized with a standard deviation of 0.006.
We substitute all FFNs with MoE layers, and ensure that the total number of expert parameters equals 16 times that of a standard FFN.
Additionally, we keep the activated expert parameters, including shared expert parameters and activated routed expert parameters, as 2 times that of a standard FFN.
Under this configuration, each MoE model has approximately 2B total parameters, with the number of activated parameters around 0.3B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS3.Px2">
<h5 class="ltx_title ltx_title_paragraph">Training Settings.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS3.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS3.Px2.p1.4">We employ the AdamW optimizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite> with hyper-parameters set to <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.1.m1.1"><semantics id="S4.SS1.SSS3.Px2.p1.1.m1.1a"><mrow id="S4.SS1.SSS3.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.cmml"><msub id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2.cmml">β</mi><mn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.1.m1.1b"><apply id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1"><eq id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1"></eq><apply id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2">𝛽</ci><cn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.1.m1.1c">\beta_{1}=0.9</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.Px2.p1.1.m1.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.95" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.2.m2.1"><semantics id="S4.SS1.SSS3.Px2.p1.2.m2.1a"><mrow id="S4.SS1.SSS3.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.cmml"><msub id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2.cmml">β</mi><mn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.2.m2.1b"><apply id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1"><eq id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1"></eq><apply id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2">𝛽</ci><cn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.2.m2.1c">\beta_{2}=0.95</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.Px2.p1.2.m2.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.95</annotation></semantics></math>, and <math alttext="\mathrm{weight\_decay}=0.1" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.3.m3.1"><semantics id="S4.SS1.SSS3.Px2.p1.3.m3.1a"><mrow id="S4.SS1.SSS3.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.cmml"><mrow id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.cmml"><mi id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2.cmml">weight</mi><mo id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1a" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4.cmml">decay</mi></mrow><mo id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.3.m3.1b"><apply id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1"><eq id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1"></eq><apply id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2"><times id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1"></times><ci id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2">weight</ci><ci id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3">_</ci><ci id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4">decay</ci></apply><cn id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.3.m3.1c">\mathrm{weight\_decay}=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.Px2.p1.3.m3.1d">roman_weight _ roman_decay = 0.1</annotation></semantics></math>.
The learning rate is scheduled using a warmup-and-step-decay strategy.
Initially, the learning rate linearly increases from 0 to the maximum value during the first 2K steps.
Subsequently, the learning rate is multiplied by 0.316 at 80% of the training steps, and again by 0.316 at 90% of the training steps.
The maximum learning rate for validation experiments is set to <math alttext="1.08\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.4.m4.1"><semantics id="S4.SS1.SSS3.Px2.p1.4.m4.1a"><mrow id="S4.SS1.SSS3.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.cmml"><mn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2.cmml">1.08</mn><mo id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1.cmml">×</mo><msup id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.cmml"><mn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.cmml"><mo id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3a" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.4.m4.1b"><apply id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1"><times id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1"></times><cn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2">1.08</cn><apply id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3">superscript</csymbol><cn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2">10</cn><apply id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3"><minus id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3"></minus><cn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.4.m4.1c">1.08\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.Px2.p1.4.m4.1d">1.08 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, and the gradient clipping norm is set to 1.0.
The batch size is set to 2K, and with a maximum sequence length of 2K, each training batch contains 4M tokens.
Correspondingly, the total number of training steps is set to 25,000 to achieve 100B training tokens.
Due to the abundance of training data, we do not use dropout during training.
Given the relatively small model size, all parameters, including expert parameters, are deployed on a single GPU device to avoid unbalanced computation.
Correspondingly, we do not drop any tokens during training and do not employ the device-level balance loss.
In order to prevent routing collapse, we set an expert-level balance factor of 0.01.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.Px2.p2">
<p class="ltx_p" id="S4.SS1.SSS3.Px2.p2.1">For readability, we also present an overview table of hyper-parameters for DeepSeekMoE across different sizes in Appendix&nbsp;<a class="ltx_ref" href="#A1" title="Appendix A Overview of Hyper-Parameters ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">A</span></a>.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.4 </span>Evaluation Benchmarks</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS4.p1">
<p class="ltx_p" id="S4.SS1.SSS4.p1.1">We conduct evaluations on a wide range of benchmarks covering various types of tasks.
We list the benchmarks as follows.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS4.Px1">
<h5 class="ltx_title ltx_title_paragraph">Language Modeling.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS4.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS4.Px1.p1.1">For language modeling, we evaluate the models on the test set of Pile&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="#bib.bib17" title="">2020</a>)</cite>, and the evaluation metric is the cross-entropy loss.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS4.Px2">
<h5 class="ltx_title ltx_title_paragraph">Language Understanding and Reasoning.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS4.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS4.Px2.p1.1">For language understanding and reasoning, we consider HellaSwag&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zellers et&nbsp;al., <a class="ltx_ref" href="#bib.bib59" title="">2019</a>)</cite>, PIQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bisk et&nbsp;al., <a class="ltx_ref" href="#bib.bib5" title="">2020</a>)</cite>, ARC-challenge and ARC-easy&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clark et&nbsp;al., <a class="ltx_ref" href="#bib.bib9" title="">2018</a>)</cite>.
The evaluation metric for these tasks is accuracy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS4.Px3">
<h5 class="ltx_title ltx_title_paragraph">Reading Comprehension.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS4.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS4.Px3.p1.1">For reading comprehension, we use RACE-high and RACE-middle <cite class="ltx_cite ltx_citemacro_cite">Lai et&nbsp;al. (<a class="ltx_ref" href="#bib.bib31" title="">2017</a>)</cite>, and the evaluation metric is accuracy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS4.Px4">
<h5 class="ltx_title ltx_title_paragraph">Code Generation.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS4.Px4.p1">
<p class="ltx_p" id="S4.SS1.SSS4.Px4.p1.1">For code generation, we evaluate the models on HumanEval&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="#bib.bib8" title="">2021</a>)</cite> and MBPP&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Austin et&nbsp;al., <a class="ltx_ref" href="#bib.bib3" title="">2021</a>)</cite>.
The evaluation metric is Pass@1, which represents the pass rate for only one generation attempt.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS4.Px5">
<h5 class="ltx_title ltx_title_paragraph">Closed-Book Question Answering.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS4.Px5.p1">
<p class="ltx_p" id="S4.SS1.SSS4.Px5.p1.1">For closed-book question answering, we consider TriviaQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Joshi et&nbsp;al., <a class="ltx_ref" href="#bib.bib28" title="">2017</a>)</cite> and NaturalQuestions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski et&nbsp;al., <a class="ltx_ref" href="#bib.bib30" title="">2019</a>)</cite>.
The evaluation metric is the Exactly Matching&nbsp;(EM) rate.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T1.1.1.1.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">Metric</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.1.1.1.2" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.2.1"># Shot</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.3.1">Dense</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.4" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.4.1">Hash Layer</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.1.1.1.5" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.5.1">Switch</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.6" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.6.1">GShard</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.7.1">DeepSeekMoE</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.2.2.1" style="padding-left:5.0pt;padding-right:5.0pt;"># Total Params</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.2.2.2" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.4" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.2.2.5" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.6" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.7" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.3">
<td class="ltx_td ltx_align_left" id="S4.T1.1.3.3.1" style="padding-left:5.0pt;padding-right:5.0pt;"># Activated Params</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.3.3.2" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.3.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.3.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.3.3.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.3.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.3B</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.3.7" style="padding-left:5.0pt;padding-right:5.0pt;">0.3B</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.4">
<td class="ltx_td ltx_align_left" id="S4.T1.1.4.4.1" style="padding-left:5.0pt;padding-right:5.0pt;">FLOPs per 2K Tokens</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.4.4.2" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.3" style="padding-left:5.0pt;padding-right:5.0pt;">2.9T</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.4" style="padding-left:5.0pt;padding-right:5.0pt;">2.9T</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.4.4.5" style="padding-left:5.0pt;padding-right:5.0pt;">2.9T</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.6" style="padding-left:5.0pt;padding-right:5.0pt;">4.3T</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.7" style="padding-left:5.0pt;padding-right:5.0pt;">4.3T</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.5.5">
<td class="ltx_td ltx_align_left" id="S4.T1.1.5.5.1" style="padding-left:5.0pt;padding-right:5.0pt;"># Training Tokens</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.5.5.2" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.3" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.4" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.5.5.5" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.6" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.7" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.6.6.1" style="padding-left:5.0pt;padding-right:5.0pt;">Pile&nbsp;(Loss)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.6.6.2" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.6.6.3" style="padding-left:5.0pt;padding-right:5.0pt;">2.060</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.6.6.4" style="padding-left:5.0pt;padding-right:5.0pt;">1.932</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.6.6.5" style="padding-left:5.0pt;padding-right:5.0pt;">1.881</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.6.6.6" style="padding-left:5.0pt;padding-right:5.0pt;">1.867</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.6.6.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.6.6.7.1">1.808</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.7.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.7.7.1" style="padding-left:5.0pt;padding-right:5.0pt;">HellaSwag&nbsp;(Acc.)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.7.7.2" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.7.7.3" style="padding-left:5.0pt;padding-right:5.0pt;">38.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.7.7.4" style="padding-left:5.0pt;padding-right:5.0pt;">46.2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.7.7.5" style="padding-left:5.0pt;padding-right:5.0pt;">49.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.7.7.6" style="padding-left:5.0pt;padding-right:5.0pt;">50.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.7.7.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.7.7.7.1">54.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.8.8">
<td class="ltx_td ltx_align_left" id="S4.T1.1.8.8.1" style="padding-left:5.0pt;padding-right:5.0pt;">PIQA&nbsp;(Acc.)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.8.8.2" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.3" style="padding-left:5.0pt;padding-right:5.0pt;">66.8</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.4" style="padding-left:5.0pt;padding-right:5.0pt;">68.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.8.8.5" style="padding-left:5.0pt;padding-right:5.0pt;">70.5</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.6" style="padding-left:5.0pt;padding-right:5.0pt;">70.6</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.8.8.7.1">72.3</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.9.9">
<td class="ltx_td ltx_align_left" id="S4.T1.1.9.9.1" style="padding-left:5.0pt;padding-right:5.0pt;">ARC-easy&nbsp;(Acc.)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.9.9.2" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.3" style="padding-left:5.0pt;padding-right:5.0pt;">41.0</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.4" style="padding-left:5.0pt;padding-right:5.0pt;">45.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.9.9.5" style="padding-left:5.0pt;padding-right:5.0pt;">45.9</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.6" style="padding-left:5.0pt;padding-right:5.0pt;">43.9</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.9.9.7.1">49.4</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.10.10">
<td class="ltx_td ltx_align_left" id="S4.T1.1.10.10.1" style="padding-left:5.0pt;padding-right:5.0pt;">ARC-challenge&nbsp;(Acc.)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.10.10.2" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.3" style="padding-left:5.0pt;padding-right:5.0pt;">26.0</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.4" style="padding-left:5.0pt;padding-right:5.0pt;">28.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.10.10.5" style="padding-left:5.0pt;padding-right:5.0pt;">30.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.6" style="padding-left:5.0pt;padding-right:5.0pt;">31.6</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.10.10.7.1">34.3</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.11.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.11.11.1" style="padding-left:5.0pt;padding-right:5.0pt;">RACE-middle&nbsp;(Acc.)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.11.11.2" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.11.11.3" style="padding-left:5.0pt;padding-right:5.0pt;">38.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.11.11.4" style="padding-left:5.0pt;padding-right:5.0pt;">38.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.11.11.5" style="padding-left:5.0pt;padding-right:5.0pt;">43.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.11.11.6" style="padding-left:5.0pt;padding-right:5.0pt;">42.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.11.11.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.11.11.7.1">44.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.12.12">
<td class="ltx_td ltx_align_left" id="S4.T1.1.12.12.1" style="padding-left:5.0pt;padding-right:5.0pt;">RACE-high&nbsp;(Acc.)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.12.12.2" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.3" style="padding-left:5.0pt;padding-right:5.0pt;">29.0</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.4" style="padding-left:5.0pt;padding-right:5.0pt;">30.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.12.12.5" style="padding-left:5.0pt;padding-right:5.0pt;">30.9</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.6" style="padding-left:5.0pt;padding-right:5.0pt;">30.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.12.12.7.1">31.7</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.13.13">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.13.13.1" style="padding-left:5.0pt;padding-right:5.0pt;">HumanEval&nbsp;(Pass@1)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.13.13.2" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.13.13.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.13.13.4" style="padding-left:5.0pt;padding-right:5.0pt;">1.2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.13.13.5" style="padding-left:5.0pt;padding-right:5.0pt;">2.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.13.13.6" style="padding-left:5.0pt;padding-right:5.0pt;">3.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.13.13.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.13.13.7.1">4.9</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.14.14">
<td class="ltx_td ltx_align_left" id="S4.T1.1.14.14.1" style="padding-left:5.0pt;padding-right:5.0pt;">MBPP&nbsp;(Pass@1)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.14.14.2" style="padding-left:5.0pt;padding-right:5.0pt;">3-shot</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.14.14.5" style="padding-left:5.0pt;padding-right:5.0pt;">0.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.6" style="padding-left:5.0pt;padding-right:5.0pt;">0.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.14.14.7.1">2.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.15.15">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.15.15.1" style="padding-left:5.0pt;padding-right:5.0pt;">TriviaQA&nbsp;(EM)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.15.15.2" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.15.15.3" style="padding-left:5.0pt;padding-right:5.0pt;">4.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.15.15.4" style="padding-left:5.0pt;padding-right:5.0pt;">6.5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.15.15.5" style="padding-left:5.0pt;padding-right:5.0pt;">8.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.15.15.6" style="padding-left:5.0pt;padding-right:5.0pt;">10.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.15.15.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.15.15.7.1">16.6</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.16.16">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.1.16.16.1" style="padding-left:5.0pt;padding-right:5.0pt;">NaturalQuestions&nbsp;(EM)</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.1.16.16.2" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.16.16.3" style="padding-left:5.0pt;padding-right:5.0pt;">1.4</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.16.16.4" style="padding-left:5.0pt;padding-right:5.0pt;">1.4</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.1.16.16.5" style="padding-left:5.0pt;padding-right:5.0pt;">2.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.16.16.6" style="padding-left:5.0pt;padding-right:5.0pt;">3.2</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.16.16.7" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.16.16.7.1">5.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>
Evaluation results for validation experiments.
<span class="ltx_text ltx_font_bold" id="S4.T1.3.1">Bold</span> font indicates the best.
Compared with other MoE architectures, DeepSeekMoE exhibits a substantial performance advantage.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Evaluations</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">Including DeepSeekMoE, we compare five models for validation experiments.
<span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.1">Dense</span> denotes a standard dense Transformer language model with 0.2B total parameters.
<span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.2">Hash Layer</span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Roller et&nbsp;al., <a class="ltx_ref" href="#bib.bib42" title="">2021</a>)</cite> is an MoE architecture based on top-1 hash routing, with 2.0B total parameters and 0.2B activated parameters, aligned with the dense baseline.
<span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.3">Switch Transformer</span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Fedus et&nbsp;al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite> is another well-known MoE architecture based on top-1 learnable routing, with total parameters and activated parameters the same as Hash Layer.
<span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.4">GShard</span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et&nbsp;al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> employs a top-2 learnable routing strategy, with 2.0B total parameters and 0.3B activated parameters since one more expert is activated compared to top-1 routing methods.
<span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.5">DeepSeekMoE</span> has 1 shared expert and 63 routed experts, where each expert is 0.25 times the size of a standard FFN.
Including DeepSeekMoE, all compared models share the same training corpus and training hyper-parameters.
All compared MoE models have the same number of total parameters, and GShard has the same number of activated parameters as DeepSeekMoE.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">We present the evaluation results in Table&nbsp;<a class="ltx_ref" href="#S4.T1" title="Table 1 ‣ Closed-Book Question Answering. ‣ 4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>.
For all demonstrated models, we report the final evaluation results after training on 100B tokens.
From the table, we make the following observations:
(1) With sparse architectures and more total parameters, Hash Layer and Switch Transformer achieve significantly stronger performance than the dense baseline with the same number of activated parameters.
(2) Compared with Hash Layer and Switch Transformer, GShard has more activated parameters and achieves slightly better performance than Switch Transformer.
(3) With the same number of total parameters and activated parameters, DeepSeekMoE demonstrates overwhelming advantages over GShard.
These results showcase the superiority of our DeepSeekMoE architecture within the existing landscape of MoE architectures.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T2.2.2.3" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.3.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.2.2.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.4.1"># Shot</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1">GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml"></mi><mo id="S4.T2.1.1.1.1.m1.1.1.1" lspace="0.222em" mathvariant="normal" rspace="0.222em" xref="S4.T2.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="S4.T2.1.1.1.1.m1.1.1.3" mathvariant="normal" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><times id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">absent</csymbol><cn id="S4.T2.1.1.1.1.m1.1.1.3.cmml" type="float" xref="S4.T2.1.1.1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.1d">× 1.5</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.2" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.2.1">Dense<math alttext="\times 16" class="ltx_Math" display="inline" id="S4.T2.2.2.2.1.m1.1"><semantics id="S4.T2.2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.cmml"><mi id="S4.T2.2.2.2.1.m1.1.1.2" xref="S4.T2.2.2.2.1.m1.1.1.2.cmml"></mi><mo id="S4.T2.2.2.2.1.m1.1.1.1" lspace="0.222em" mathvariant="normal" rspace="0.222em" xref="S4.T2.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="S4.T2.2.2.2.1.m1.1.1.3" mathvariant="normal" xref="S4.T2.2.2.2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.1.m1.1b"><apply id="S4.T2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1"><times id="S4.T2.2.2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T2.2.2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2">absent</csymbol><cn id="S4.T2.2.2.2.1.m1.1.1.3.cmml" type="integer" xref="S4.T2.2.2.2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.1.m1.1c">\times 16</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.1.m1.1d">× 16</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.5.1">DeepSeekMoE</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.3.1.1" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.3.1.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.3" style="padding-left:8.0pt;padding-right:8.0pt;">1.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.4" style="padding-left:8.0pt;padding-right:8.0pt;">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.5" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.4.2.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.4.2.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.3" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.4" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.5" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.5.3.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.5.3.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.3" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.4" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.5" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.6.4.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.6.4.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.3" style="padding-left:8.0pt;padding-right:8.0pt;">2.83B</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.4" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.5" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.7.5.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.7.5.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.7.5.3" style="padding-left:8.0pt;padding-right:8.0pt;">0.35B</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.7.5.4" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.7.5.5" style="padding-left:8.0pt;padding-right:8.0pt;">0.24B</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.8.6.1" style="padding-left:8.0pt;padding-right:8.0pt;">FLOPs per 2K Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.8.6.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.8.6.3" style="padding-left:8.0pt;padding-right:8.0pt;">5.8T</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.8.6.4" style="padding-left:8.0pt;padding-right:8.0pt;">24.6T</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.8.6.5" style="padding-left:8.0pt;padding-right:8.0pt;">4.3T</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.9.7.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.9.7.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.3" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.4" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.5" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.10.8.1" style="padding-left:8.0pt;padding-right:8.0pt;">Pile&nbsp;(Loss)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.10.8.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.10.8.3" style="padding-left:8.0pt;padding-right:8.0pt;">1.808</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.10.8.4" style="padding-left:8.0pt;padding-right:8.0pt;">1.806</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.10.8.5" style="padding-left:8.0pt;padding-right:8.0pt;">1.808</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.11.9.1" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.11.9.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.11.9.3" style="padding-left:8.0pt;padding-right:8.0pt;">54.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.11.9.4" style="padding-left:8.0pt;padding-right:8.0pt;">55.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.11.9.5" style="padding-left:8.0pt;padding-right:8.0pt;">54.8</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.12.10.1" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.12.10.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.12.10.3" style="padding-left:8.0pt;padding-right:8.0pt;">71.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.12.10.4" style="padding-left:8.0pt;padding-right:8.0pt;">71.9</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.12.10.5" style="padding-left:8.0pt;padding-right:8.0pt;">72.3</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.13.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.13.11.1" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.13.11.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.13.11.3" style="padding-left:8.0pt;padding-right:8.0pt;">47.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.13.11.4" style="padding-left:8.0pt;padding-right:8.0pt;">51.9</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.13.11.5" style="padding-left:8.0pt;padding-right:8.0pt;">49.4</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.14.12.1" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.14.12.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.14.12.3" style="padding-left:8.0pt;padding-right:8.0pt;">34.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.14.12.4" style="padding-left:8.0pt;padding-right:8.0pt;">33.8</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.14.12.5" style="padding-left:8.0pt;padding-right:8.0pt;">34.3</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.15.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.15.13.1" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.15.13.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.15.13.3" style="padding-left:8.0pt;padding-right:8.0pt;">46.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.15.13.4" style="padding-left:8.0pt;padding-right:8.0pt;">46.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.15.13.5" style="padding-left:8.0pt;padding-right:8.0pt;">44.0</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.16.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.16.14.1" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.16.14.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.16.14.3" style="padding-left:8.0pt;padding-right:8.0pt;">32.4</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.16.14.4" style="padding-left:8.0pt;padding-right:8.0pt;">33.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.16.14.5" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.17.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.17.15.1" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.17.15.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.17.15.3" style="padding-left:8.0pt;padding-right:8.0pt;">3.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.17.15.4" style="padding-left:8.0pt;padding-right:8.0pt;">4.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.17.15.5" style="padding-left:8.0pt;padding-right:8.0pt;">4.9</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.18.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.18.16.1" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.18.16.2" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.18.16.3" style="padding-left:8.0pt;padding-right:8.0pt;">2.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.18.16.4" style="padding-left:8.0pt;padding-right:8.0pt;">2.2</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.18.16.5" style="padding-left:8.0pt;padding-right:8.0pt;">2.2</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.19.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.19.17.1" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.19.17.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.19.17.3" style="padding-left:8.0pt;padding-right:8.0pt;">15.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.19.17.4" style="padding-left:8.0pt;padding-right:8.0pt;">16.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.19.17.5" style="padding-left:8.0pt;padding-right:8.0pt;">16.6</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.20.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T2.2.20.18.1" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.2.20.18.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.20.18.3" style="padding-left:8.0pt;padding-right:8.0pt;">4.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.20.18.4" style="padding-left:8.0pt;padding-right:8.0pt;">6.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.20.18.5" style="padding-left:8.0pt;padding-right:8.0pt;">5.7</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>
Comparisons among DeepSeekMoE, larger GShard models, and larger dense models.
In the line of “# Experts”, <math alttext="a" class="ltx_Math" display="inline" id="S4.T2.11.m1.1"><semantics id="S4.T2.11.m1.1b"><mi id="S4.T2.11.m1.1.1" xref="S4.T2.11.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.11.m1.1c"><ci id="S4.T2.11.m1.1.1.cmml" xref="S4.T2.11.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.m1.1d">a</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.m1.1e">italic_a</annotation></semantics></math> + <math alttext="b" class="ltx_Math" display="inline" id="S4.T2.12.m2.1"><semantics id="S4.T2.12.m2.1b"><mi id="S4.T2.12.m2.1.1" xref="S4.T2.12.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.12.m2.1c"><ci id="S4.T2.12.m2.1.1.cmml" xref="S4.T2.12.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.m2.1d">b</annotation><annotation encoding="application/x-llamapun" id="S4.T2.12.m2.1e">italic_b</annotation></semantics></math> denotes <math alttext="a" class="ltx_Math" display="inline" id="S4.T2.13.m3.1"><semantics id="S4.T2.13.m3.1b"><mi id="S4.T2.13.m3.1.1" xref="S4.T2.13.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.13.m3.1c"><ci id="S4.T2.13.m3.1.1.cmml" xref="S4.T2.13.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.m3.1d">a</annotation><annotation encoding="application/x-llamapun" id="S4.T2.13.m3.1e">italic_a</annotation></semantics></math> shared experts and <math alttext="b" class="ltx_Math" display="inline" id="S4.T2.14.m4.1"><semantics id="S4.T2.14.m4.1b"><mi id="S4.T2.14.m4.1.1" xref="S4.T2.14.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.14.m4.1c"><ci id="S4.T2.14.m4.1.1.cmml" xref="S4.T2.14.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.m4.1d">b</annotation><annotation encoding="application/x-llamapun" id="S4.T2.14.m4.1e">italic_b</annotation></semantics></math> routed experts.
In the line of “# Activated Experts”, <math alttext="a" class="ltx_Math" display="inline" id="S4.T2.15.m5.1"><semantics id="S4.T2.15.m5.1b"><mi id="S4.T2.15.m5.1.1" xref="S4.T2.15.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.15.m5.1c"><ci id="S4.T2.15.m5.1.1.cmml" xref="S4.T2.15.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.m5.1d">a</annotation><annotation encoding="application/x-llamapun" id="S4.T2.15.m5.1e">italic_a</annotation></semantics></math> + <math alttext="b" class="ltx_Math" display="inline" id="S4.T2.16.m6.1"><semantics id="S4.T2.16.m6.1b"><mi id="S4.T2.16.m6.1.1" xref="S4.T2.16.m6.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.16.m6.1c"><ci id="S4.T2.16.m6.1.1.cmml" xref="S4.T2.16.m6.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.m6.1d">b</annotation><annotation encoding="application/x-llamapun" id="S4.T2.16.m6.1e">italic_b</annotation></semantics></math> denotes <math alttext="a" class="ltx_Math" display="inline" id="S4.T2.17.m7.1"><semantics id="S4.T2.17.m7.1b"><mi id="S4.T2.17.m7.1.1" xref="S4.T2.17.m7.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.17.m7.1c"><ci id="S4.T2.17.m7.1.1.cmml" xref="S4.T2.17.m7.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.m7.1d">a</annotation><annotation encoding="application/x-llamapun" id="S4.T2.17.m7.1e">italic_a</annotation></semantics></math> activated shared experts and <math alttext="b" class="ltx_Math" display="inline" id="S4.T2.18.m8.1"><semantics id="S4.T2.18.m8.1b"><mi id="S4.T2.18.m8.1.1" xref="S4.T2.18.m8.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.18.m8.1c"><ci id="S4.T2.18.m8.1.1.cmml" xref="S4.T2.18.m8.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.m8.1d">b</annotation><annotation encoding="application/x-llamapun" id="S4.T2.18.m8.1e">italic_b</annotation></semantics></math> activated routed experts.
DeepSeekMoE achieves comparable performance with a GShard model containing 1.5 times expert parameters and computation.
In addition, DeepSeekMoE nearly approaches the performance of a dense model with 16 times FFN parameters, which sets the upper bound for MoE models in terms of the model capacity.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>DeepSeekMoE Aligns Closely with the upper bound of MoE Models</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We have demonstrated that DeepSeekMoE outperforms the dense baseline and other MoE architectures.
In order to provide a more precise understanding of the performance of DeepSeekMoE, we compare it with larger baselines with more total parameters or activated parameters.
The comparisons enable us to estimate the required model size of GShard or dense baselines to achieve equivalent performance to DeepSeekMoE.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Comparison with GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.1.m1.1b"><mrow id="S4.SS3.SSS0.Px1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.1.m1.1c"><apply id="S4.SS3.SSS0.Px1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.1.m1.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.1.m1.1d">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.1.m1.1e">× 1.5</annotation></semantics></math>.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.3">Table&nbsp;<a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ Results. ‣ 4.2 Evaluations ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> shows the comparison between DeepSeekMoE and a larger GShard model with 1.5 times the expert size, which results in 1.5 times both expert parameters and expert computation.
Overall, we observe that DeepSeekMoE achieves comparable performance with GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.1.m1.1d">× 1.5</annotation></semantics></math>, underscoring the significant advantage inherent in the DeepSeekMoE architecture.
In addition to the comparison with GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1"><times id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m2.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.2.m2.1d">× 1.5</annotation></semantics></math>, we also show the comparison with GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS3.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1"><times id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.3.m3.1c">\times 1.2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p1.3.m3.1d">× 1.2</annotation></semantics></math> in Appendix&nbsp;<a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS3.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p2.3">Furthermore, we increase the number of total parameters of DeepSeekMoE to 13.3B and compare it with GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p2.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.1.m1.1c">\times 1.2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p2.1.m1.1d">× 1.2</annotation></semantics></math> and GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS3.SSS0.Px1.p2.2.m2.1a"><mrow id="S4.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1"><times id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.2.m2.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p2.2.m2.1d">× 1.5</annotation></semantics></math> with 15.9B and 19.8B total parameters, respectively.
We find that at a larger scale, DeepSeekMoE can even outperform GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS3.SSS0.Px1.p2.3.m3.1a"><mrow id="S4.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.3.m3.1b"><apply id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1"><times id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.3.m3.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p2.3.m3.1d">× 1.5</annotation></semantics></math> distinctly.
These results are also provided in Appendix&nbsp;<a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Comparison with Dense<math alttext="\times 16" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.1.m1.1"><semantics id="S4.SS3.SSS0.Px2.1.m1.1b"><mrow id="S4.SS3.SSS0.Px2.1.m1.1.1" xref="S4.SS3.SSS0.Px2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px2.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.1.m1.1c"><apply id="S4.SS3.SSS0.Px2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1"><times id="S4.SS3.SSS0.Px2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.1.m1.1d">\times 16</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.1.m1.1e">× 16</annotation></semantics></math>.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.2">Table&nbsp;<a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ Results. ‣ 4.2 Evaluations ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> also shows the comparison between DeepSeekMoE and larger dense models.
For a fair comparison, we do not use the widely used ratio (1:2) between the attention and FFN parameters.
Instead, we configure 16 shared experts where each expert has the same number of parameters as a standard FFN.
This architecture mimics a dense model with 16 times standard FFN parameters.
From the table, we find that DeepSeekMoE nearly approaches the performance of Dense<math alttext="\times 16" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1"><times id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">\times 16</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.1.m1.1d">× 16</annotation></semantics></math>, which sets the strict upper bound of MoE models in terms of the model capacity.
These results suggest that, <span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS3.SSS0.Px2.p1.2.1">at least at the scale of about 2B parameters and 100B training tokens, the performance of DeepSeekMoE aligns closely with the theoretical upper bound of MoE models</span>.
Also, we provide additional comparisons with Dense<math alttext="\times 4" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px2.p1.2.m2.1a"><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1"><times id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m2.1c">\times 4</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.2.m2.1d">× 4</annotation></semantics></math> in Appendix&nbsp;<a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="379" id="S4.F3.g1" src="x3.png" width="822">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
Ablation studies for DeepSeekMoE.
The performance is normalized by the best performance for clarity in presentation.
All compared models have the same number of parameters and activated parameters.
We can find that fine-grained expert segmentation and shared expert isolation both contribute to stronger overall performance.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation Studies</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In order to substantiate the effectiveness of the fine-grained expert segmentation and shared expert isolation strategies, we conduct ablation studies for DeepSeekMoE and present the results in Figure&nbsp;<a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ Comparison with Dense×16. ‣ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>.
For a fair comparison, we ensure all models included in the comparison have the same number of total parameters and activated parameters.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Shared Expert Isolation.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px1.p1.1">In order to evaluate the influence of the shared expert isolation strategy, we isolate one expert as the shared one based on GShard.
From Figure&nbsp;<a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ Comparison with Dense×16. ‣ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, we observe that compared with GShard, the intentional isolation of a shared expert yields improved performance across a majority of benchmarks.
These results support the proposition that the shared expert isolation strategy contributes to a stronger model performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Fine-Grained Expert Segmentation.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px2.p1.1">In order to assess the effectiveness of the fine-grained expert segmentation strategy, we conduct a more detailed comparison by further segmenting the experts into a finer grain.
To be specific, we segment each expert into 2 or 4 smaller experts, resulting in a total of 32 (1 shared + 31 routed) or 64 (1 shared + 63 routed) experts.
Figure&nbsp;<a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ Comparison with Dense×16. ‣ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> reveals a consistent trend that the continuous refinement of expert segmentation granularity corresponds to a continuous enhancement in overall model performance.
These findings provide empirical substantiation for the effectiveness of the fine-grained expert segmentation strategy.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Ratios Between Shared and Routed Experts.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px3.p1.1">In addition, we investigate the best ratio of shared experts and routed experts.
Based on the finest granularity with 64 total experts and keeping the number of total experts and activated experts constant, we attempt to isolate 1, 2, and 4 experts as shared ones.
We find that different ratios of the shared experts and routed experts do not significantly impact the performance, and 1, 2, and 4 shared experts achieve a Pile loss of 1.808, 1.806, and 1.811, respectively.
Considering that the ratio of 1:3 yields a marginally better Pile loss, when scaling up DeepSeekMoE, we keep the ratio between shared experts and activated routed experts as 1:3.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Analysis on Expert Specialization</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">In this section, we conduct an empirical analysis on the expert specialization of DeepSeekMoE 2B.
DeepSeekMoE 2B in this section refers to the model reported in Table&nbsp;<a class="ltx_ref" href="#S4.T1" title="Table 1 ‣ Closed-Book Question Answering. ‣ 4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>, i.e., comprising 2.0B total parameters, with 1 shared expert and 7 out of 63 routed experts being activated.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="356" id="S4.F4.g1" src="x4.png" width="498">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
Pile loss with regard to different ratios of disabled top routed experts.
Notably, DeepSeekMoE exhibits greater sensitivity to the ratio of disabled top routed experts, indicating lower redundancy among routed experts in DeepSeekMoE.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S4.SS5.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">DeepSeekMoE Exhibits Lower Redundancy Among Routed Experts.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p1.3">In order to assess the redundancy among routed experts, we disable varying ratios of top routed experts and evaluate the Pile loss.
To be specific, for each token, we mask a certain ratio of experts with the highest routing probability, and then select top-K experts from the remaining routed experts.
For fairness, we compare DeepSeekMoE with GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS5.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS5.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1"><times id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.1.m1.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p1.1.m1.1d">× 1.5</annotation></semantics></math> since they have the same Pile loss when no experts are disabled.
As shown in Figure&nbsp;<a class="ltx_ref" href="#S4.F4" title="Figure 4 ‣ 4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, compared with GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS5.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS5.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1"><times id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.2.m2.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p1.2.m2.1d">× 1.5</annotation></semantics></math>, DeepSeekMoE is more sensitive to the disabling of top routed experts.
This sensitivity suggests a lower level of parameter redundancy in DeepSeekMoE, since each routed expert is more irreplaceable.
In contrast, GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS5.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS5.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml"></mi><mo id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1"><times id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1"></times><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2">absent</csymbol><cn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.3.m3.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.SSS0.Px1.p1.3.m3.1d">× 1.5</annotation></semantics></math> exhibits greater redundancy among its expert parameters, so it can buffer the performance drop when top routed experts are disabled.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS5.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Shared Experts Are Irreplaceable by Routed Experts.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS5.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS5.SSS0.Px2.p1.1">In order to investigate the role of the shared expert in DeepSeekMoE, we disable it and activate one more routed expert.
The evaluation on Pile shows a significant increase in the Pile loss, rising from 1.808 to 2.414, even though we maintain the same computational cost.
This result highlights the crucial function of the shared expert and indicates that the shared expert captures fundamental and essential knowledge not shared with routed experts, making it irreplaceable by routed ones.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="356" id="S4.F5.g1" src="x5.png" width="498">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>
Pile loss with regard to different numbers of activated routed experts in DeepSeekMoE.
With only 4 routed experts activated, DeepSeekMoE achieves a Pile loss comparable with GShard.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="379" id="S4.F6.g1" src="x6.png" width="822">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>
Comparison between GShard and DeepSeekMoE with half the activated experts (trained from scratch).
With the same total expert parameters and only half of the activated expert parameters, DeepSeekMoE still outperforms GShard.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S4.SS5.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">DeepSeekMoE Acquires Knowledge More Accurately.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS5.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS5.SSS0.Px3.p1.1">In order to validate our claim that higher flexibility in combining activated experts contributes to a more accurate and targeted knowledge acquisition, we investigate whether DeepSeekMoE can acquire requisite knowledge with fewer activated experts.
To be specific, we vary the number of activated routed experts from 3 to 7 and evaluate the resulting Pile loss.
As demonstrated in Figure&nbsp;<a class="ltx_ref" href="#S4.F5" title="Figure 5 ‣ Shared Experts Are Irreplaceable by Routed Experts. ‣ 4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, even with only 4 routed experts activated, DeepSeekMoE achieves a Pile loss comparable with GShard.
This observation supports the proposition that DeepSeekMoE can acquire requisite knowledge more accurately and efficiently.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS5.SSS0.Px3.p2">
<p class="ltx_p" id="S4.SS5.SSS0.Px3.p2.1">Encouraged by these findings, in order to validate the expert specialization and accurate knowledge acquisition of DeepSeekMoE more rigorously, we train a new model from scratch.
This model comprises 1 shared expert and 63 routed experts, where only 3 routed experts are activated.
The evaluation results shown in Figure&nbsp;<a class="ltx_ref" href="#S4.F6" title="Figure 6 ‣ Shared Experts Are Irreplaceable by Routed Experts. ‣ 4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> demonstrate that, even with the same total expert parameters and only half of the activated expert parameters, DeepSeekMoE still outperforms GShard.
This highlights the ability of DeepSeekMoE to leverage expert parameters more efficiently, i.e., the proportion of effective parameters in the activated experts is much higher than that of GShard.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Scaling up to DeepSeekMoE 16B</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">With the DeepSeekMoE architecture, we scale up our MoE model to a larger scale with 16B total parameters and train it on 2T tokens.
Our results demonstrate that compared with LLaMA2 7B, DeepSeekMoE 16B achieves superior performance with only about 40% of computations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Training Data and Tokenization</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">We sample the training data from the same corpus as described in Section&nbsp;<a class="ltx_ref" href="#S4.SS1.SSS1" title="4.1.1 Training Data and Tokenization ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4.1.1</span></a>.
Different from the validation experiments, we sample a larger amount of data with 2T tokens, aligning with the number of training tokens of LLaMA2 7B.
We also use the HuggingFace Tokenizer tools to train a BPE tokenizer, but the vocabulary size is set to 100K for DeepSeekMoE 16B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Hyper-Parameters</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S5.SS1.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Model Settings.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS2.Px1.p1">
<p class="ltx_p" id="S5.SS1.SSS2.Px1.p1.1">For DeepSeekMoE 16B, we set the number of Transformer layers to 28 and the hidden dimension to 2048.
We employ the multi-head attention mechanism with a total of 16 attention heads, where each head has a dimension of 128.
As for initialization, all learnable parameters are randomly initialized with a standard deviation of 0.006.
We substitute all FFNs except for the first layer with MoE layers, since we observe that the load balance status converges especially slower for the first layer.
Each MoE layer consists of 2 shared experts and 64 routed experts, where each expert is 0.25 times the size of a standard FFN.
Each token will be routed to these 2 shared experts and 6 out of 64 routed experts.
An even finer expert segmentation granularity is not employed due to the potential reduction in computational efficiency associated with excessively small expert sizes.
At a larger scale over 16B, a finer granularity can still be employed.
Under our configuration, DeepSeekMoE 16B has approximately 16.4B total parameters, with the number of activated parameters around 2.8B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS2.Px2">
<h5 class="ltx_title ltx_title_paragraph">Training Settings.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS2.Px2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.Px2.p1.4">We employ the AdamW optimizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite> with hyper-parameters set to <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.1.m1.1"><semantics id="S5.SS1.SSS2.Px2.p1.1.m1.1a"><mrow id="S5.SS1.SSS2.Px2.p1.1.m1.1.1" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.cmml"><msub id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.cmml"><mi id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2.cmml">β</mi><mn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.1.m1.1b"><apply id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1"><eq id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1"></eq><apply id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.1.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2">𝛽</ci><cn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.1.m1.1c">\beta_{1}=0.9</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.Px2.p1.1.m1.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.95" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.2.m2.1"><semantics id="S5.SS1.SSS2.Px2.p1.2.m2.1a"><mrow id="S5.SS1.SSS2.Px2.p1.2.m2.1.1" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.cmml"><msub id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.cmml"><mi id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2.cmml">β</mi><mn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.2.m2.1b"><apply id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1"><eq id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1"></eq><apply id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.1.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2">𝛽</ci><cn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.2.m2.1c">\beta_{2}=0.95</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.Px2.p1.2.m2.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.95</annotation></semantics></math>, and <math alttext="\mathrm{weight\_decay}=0.1" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.3.m3.1"><semantics id="S5.SS1.SSS2.Px2.p1.3.m3.1a"><mrow id="S5.SS1.SSS2.Px2.p1.3.m3.1.1" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.cmml"><mrow id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.cmml"><mi id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2.cmml">weight</mi><mo id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1a" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4.cmml">decay</mi></mrow><mo id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.3.m3.1b"><apply id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1"><eq id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1"></eq><apply id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2"><times id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1"></times><ci id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2">weight</ci><ci id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3">_</ci><ci id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4">decay</ci></apply><cn id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.3.m3.1c">\mathrm{weight\_decay}=0.1</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.Px2.p1.3.m3.1d">roman_weight _ roman_decay = 0.1</annotation></semantics></math>.
The learning rate is also scheduled using a warmup-and-step-decay strategy.
Initially, the learning rate linearly increases from 0 to the maximum value during the first 2K steps.
Subsequently, the learning rate is multiplied by 0.316 at 80% of the training steps, and again by 0.316 at 90% of the training steps.
The maximum learning rate for DeepSeekMoE 16B is set to <math alttext="4.2\times 10^{-4}" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.4.m4.1"><semantics id="S5.SS1.SSS2.Px2.p1.4.m4.1a"><mrow id="S5.SS1.SSS2.Px2.p1.4.m4.1.1" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.cmml"><mn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2.cmml">4.2</mn><mo id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1.cmml">×</mo><msup id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.cmml"><mn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.cmml"><mo id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3a" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.4.m4.1b"><apply id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1"><times id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1"></times><cn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2">4.2</cn><apply id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3">superscript</csymbol><cn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2">10</cn><apply id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3"><minus id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3"></minus><cn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.4.m4.1c">4.2\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.Px2.p1.4.m4.1d">4.2 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, and the gradient clipping norm is set to 1.0.
The batch size is set to 4.5K, and with a maximum sequence length of 4K, each training batch contains 18M tokens.
Correspondingly, the total number of training steps is set to 106,449 to achieve 2T training tokens.
Due to the abundance of training data, we do not use dropout during training.
We leverage pipeline parallelism to deploy different layers of a model on different devices, and for each layer, all the experts will be deployed on the same device.
Therefore, we also do not drop any tokens during training and do not employ the device-level balance loss.
In order to prevent routing collapse, we set a quite small expert-level balance factor of 0.001 because we find that under our parallelization strategy, a higher expert-level balance factor cannot increase the computation efficiency, but instead, it will compromise the model performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>Evaluation Benchmarks</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1">In addition to the benchmarks used in the validation experiments, we incorporate additional benchmarks for a more comprehensive evaluation.
We introduce the distinctions from the benchmarks used in validation experiments as follows.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S5.SS1.SSS3.Px1">
<h5 class="ltx_title ltx_title_paragraph">Language Modeling.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS3.Px1.p1">
<p class="ltx_p" id="S5.SS1.SSS3.Px1.p1.1">For language modeling, we also evaluate the models on the test set of Pile&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="#bib.bib17" title="">2020</a>)</cite>.
Since the tokenizer used in DeepSeekMoE 16B is different from that used in LLaMA2 7B.
For a fair comparison, we use bits per byte (BPB) as the evaluation metric.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS3.Px2">
<h5 class="ltx_title ltx_title_paragraph">Reading Comprehension.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS3.Px2.p1">
<p class="ltx_p" id="S5.SS1.SSS3.Px2.p1.1">For reading comprehension, we additionally consider DROP&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dua et&nbsp;al., <a class="ltx_ref" href="#bib.bib15" title="">2019</a>)</cite>.
The evaluation metric is the Exactly Matching&nbsp;(EM) rate.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS3.Px3">
<h5 class="ltx_title ltx_title_paragraph">Math Reasoning.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS3.Px3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.Px3.p1.1">For math reasoning, we additionally incorporate GSM8K&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Cobbe et&nbsp;al., <a class="ltx_ref" href="#bib.bib10" title="">2021</a>)</cite> and MATH&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et&nbsp;al., <a class="ltx_ref" href="#bib.bib21" title="">2021</a>)</cite>, using EM as the evaluation metric.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS3.Px4">
<h5 class="ltx_title ltx_title_paragraph">Multi-Subject Multiple-Choice.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS3.Px4.p1">
<p class="ltx_p" id="S5.SS1.SSS3.Px4.p1.1">For multi-subject multiple-choice, we additionally evaluate the models on MMLU&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et&nbsp;al., <a class="ltx_ref" href="#bib.bib20" title="">2020</a>)</cite>.
The evaluation metric is accuracy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS3.Px5">
<h5 class="ltx_title ltx_title_paragraph">Disambiguation.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS3.Px5.p1">
<p class="ltx_p" id="S5.SS1.SSS3.Px5.p1.1">For disambiguation, we additionally consider WinoGrande&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi et&nbsp;al., <a class="ltx_ref" href="#bib.bib43" title="">2019</a>)</cite> and the evaluation metric is accuracy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS3.Px6">
<h5 class="ltx_title ltx_title_paragraph">Chinese Benchmarks.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS3.Px6.p1">
<p class="ltx_p" id="S5.SS1.SSS3.Px6.p1.1">Since DeepSeekMoE 16B is pretrained on a bilingual corpus, we also evaluate it on four Chinese benchmarks.
CLUEWSC&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xu et&nbsp;al., <a class="ltx_ref" href="#bib.bib57" title="">2020</a>)</cite> is a Chinese disambiguation benchmark.
CEval&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Huang et&nbsp;al., <a class="ltx_ref" href="#bib.bib25" title="">2023</a>)</cite> and CMMLU&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Li et&nbsp;al., <a class="ltx_ref" href="#bib.bib33" title="">2023</a>)</cite> are two Chinese multi-subject multiple-choice benchmarks with a similar form to MMLU.
CHID&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zheng et&nbsp;al., <a class="ltx_ref" href="#bib.bib61" title="">2019</a>)</cite> is a Chinese idiom completion benchmark, aiming to evaluate the understanding of Chinese culture.
The evaluation metrics for the aforementioned Chinese benchmarks are accuracy or EM.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS3.Px7">
<h5 class="ltx_title ltx_title_paragraph">Open LLM Leaderboard.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS3.Px7.p1">
<p class="ltx_p" id="S5.SS1.SSS3.Px7.p1.1">We evaluate all of the aforementioned benchmarks based on our internal evaluation framework.
In order to compare DeepSeekMoE 16B with open source models fairly and conveniently, we additionally evaluate DeepSeekMoE 16B on the Open LLM Leaderboard.
The Open LLM Leaderboard is a public leaderboard supported by HuggingFace, it consists of six tasks: ARC&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clark et&nbsp;al., <a class="ltx_ref" href="#bib.bib9" title="">2018</a>)</cite>, HellaSwag&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zellers et&nbsp;al., <a class="ltx_ref" href="#bib.bib59" title="">2019</a>)</cite>, MMLU&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et&nbsp;al., <a class="ltx_ref" href="#bib.bib20" title="">2020</a>)</cite>, TruthfulQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="#bib.bib35" title="">2022</a>)</cite>, Winogrande&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi et&nbsp;al., <a class="ltx_ref" href="#bib.bib43" title="">2019</a>)</cite>, and GSM8K&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Cobbe et&nbsp;al., <a class="ltx_ref" href="#bib.bib10" title="">2021</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Evaluations</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T3.1.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.1.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T3.1.1.1.2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.2.1"># Shot</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.1.1.1.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.3.1">DeepSeek 7B (Dense)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.1.1.1.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.4.1">DeepSeekMoE 16B</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.2.2.1" style="padding-left:4.0pt;padding-right:4.0pt;"># Total Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.2.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.2.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">6.9B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.2.2.4" style="padding-left:4.0pt;padding-right:4.0pt;">16.4B</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.3.3.1" style="padding-left:4.0pt;padding-right:4.0pt;"># Activated Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.3.3.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.3.3.3" style="padding-left:4.0pt;padding-right:4.0pt;">6.9B</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.3.3.4" style="padding-left:4.0pt;padding-right:4.0pt;">2.8B</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.4.4.1" style="padding-left:4.0pt;padding-right:4.0pt;">FLOPs per 4K Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.4.4.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.4.3" style="padding-left:4.0pt;padding-right:4.0pt;">183.5T</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.4.4" style="padding-left:4.0pt;padding-right:4.0pt;">74.4T</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.5.5.1" style="padding-left:4.0pt;padding-right:4.0pt;"># Training Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.5.5.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.5.3" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.5.4" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.6.6.1" style="padding-left:4.0pt;padding-right:4.0pt;">Pile&nbsp;(BPB)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.6.6.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.6.6.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.6.6.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.6.4.1">0.74</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.7.7.1" style="padding-left:4.0pt;padding-right:4.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.7.7.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.7.7.3" style="padding-left:4.0pt;padding-right:4.0pt;">75.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.7.7.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.7.7.4.1">77.1</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.8.8.1" style="padding-left:4.0pt;padding-right:4.0pt;">PIQA&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.8.8.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.8.8.3" style="padding-left:4.0pt;padding-right:4.0pt;">79.2</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.8.8.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.8.4.1">80.2</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.9.9.1" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.9.9.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.9.9.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.9.9.3.1">67.9</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.9.9.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.9.9.4.1">68.1</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.10.10.1" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.10.10.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.10.10.3" style="padding-left:4.0pt;padding-right:4.0pt;">48.1</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.10.10.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.10.10.4.1">49.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.11.11.1" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.11.11.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.11.11.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.11.11.3.1">63.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.11.11.4" style="padding-left:4.0pt;padding-right:4.0pt;">61.9</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.12.12.1" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-high&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.12.12.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.12.12.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.12.12.3.1">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.12.12.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.12.12.4.1">46.4</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.13.13.1" style="padding-left:4.0pt;padding-right:4.0pt;">DROP&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.13.13.2" style="padding-left:4.0pt;padding-right:4.0pt;">1-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.13.13.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.13.13.3.1">34.9</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.13.13.4" style="padding-left:4.0pt;padding-right:4.0pt;">32.9</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.14.14.1" style="padding-left:4.0pt;padding-right:4.0pt;">GSM8K&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.14.14.2" style="padding-left:4.0pt;padding-right:4.0pt;">8-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.14.14.3" style="padding-left:4.0pt;padding-right:4.0pt;">17.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.14.14.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.14.14.4.1">18.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.15.15.1" style="padding-left:4.0pt;padding-right:4.0pt;">MATH&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.15.15.2" style="padding-left:4.0pt;padding-right:4.0pt;">4-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.15.15.3" style="padding-left:4.0pt;padding-right:4.0pt;">3.3</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.15.15.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.15.15.4.1">4.3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.16.16.1" style="padding-left:4.0pt;padding-right:4.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.16.16.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.16.16.3" style="padding-left:4.0pt;padding-right:4.0pt;">26.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.16.16.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.16.16.4.1">26.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.17.17.1" style="padding-left:4.0pt;padding-right:4.0pt;">MBPP&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.17.17.2" style="padding-left:4.0pt;padding-right:4.0pt;">3-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.17.17.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.17.17.3.1">39.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.17.17.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.17.17.4.1">39.2</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.18.18.1" style="padding-left:4.0pt;padding-right:4.0pt;">TriviaQA&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.18.18.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.18.18.3" style="padding-left:4.0pt;padding-right:4.0pt;">59.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.18.18.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.18.18.4.1">64.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.19.19.1" style="padding-left:4.0pt;padding-right:4.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.19.19.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.19.19.3" style="padding-left:4.0pt;padding-right:4.0pt;">22.2</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.19.19.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.19.19.4.1">25.5</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.20.20.1" style="padding-left:4.0pt;padding-right:4.0pt;">MMLU&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.20.20.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.20.20.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.20.20.3.1">48.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.20.20.4" style="padding-left:4.0pt;padding-right:4.0pt;">45.0</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.21.21.1" style="padding-left:4.0pt;padding-right:4.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.21.21.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.21.21.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.21.21.3.1">70.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.21.21.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.21.21.4.1">70.2</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T3.1.22.22.1" style="padding-left:4.0pt;padding-right:4.0pt;">CLUEWSC&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T3.1.22.22.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.1.22.22.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.22.22.3.1">73.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.1.22.22.4" style="padding-left:4.0pt;padding-right:4.0pt;">72.1</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.23.23.1" style="padding-left:4.0pt;padding-right:4.0pt;">CEval&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.23.23.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.23.23.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.23.23.3.1">45.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.23.23.4" style="padding-left:4.0pt;padding-right:4.0pt;">40.6</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.24.24.1" style="padding-left:4.0pt;padding-right:4.0pt;">CMMLU&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.24.24.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.24.24.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.24.24.3.1">47.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.24.24.4" style="padding-left:4.0pt;padding-right:4.0pt;">42.5</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T3.1.25.25.1" style="padding-left:4.0pt;padding-right:4.0pt;">CHID&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T3.1.25.25.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.25.25.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.25.25.3.1">89.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.25.25.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.25.25.4.1">89.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>
Comparison between DeepSeek 7B and DeepSeekMoE 16B.
<span class="ltx_text ltx_font_bold" id="S5.T3.3.1">Bold</span> font indicates the best or near the best.
With only 40.5% of computations, DeepSeekMoE 16B achieves comparable performance with DeepSeek 7B.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S5.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1 </span>Internal Comparison with DeepSeek 7B</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.SSS1.p1">
<p class="ltx_p" id="S5.SS2.SSS1.p1.1">We first conduct an internal comparison between DeepSeekMoE 16B and DeepSeek 7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(DeepSeek-AI, <a class="ltx_ref" href="#bib.bib13" title="">2024</a>)</cite>, a dense language model with 6.9B parameters.
Ensuring fairness, both models are trained on the same corpus with 2T tokens.
This enables an accurate assessment of the effectiveness of our MoE architecture, independent of the influence of the training data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S5.SS2.SSS1.p2">
<p class="ltx_p" id="S5.SS2.SSS1.p2.1">The evaluation results are presented in Table&nbsp;<a class="ltx_ref" href="#S5.T3" title="Table 3 ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, yielding the following observations:
(1) On the whole, with about only 40% of the computations, DeepSeekMoE 16B achieves comparable performance with DeepSeek 7B.
(2) DeepSeekMoE 16B exhibits notable strengths in language modeling and knowledge-intensive tasks such as Pile, HellaSwag, TriviaQA, and NaturalQuestions.
Given that in an MoE model, FFN parameters are much heavier than attention parameters, these outcomes align with the proposition that FFNs in Transformers exhibit the capability for knowledge memorization&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a class="ltx_ref" href="#bib.bib11" title="">2022a</a>)</cite>.
(3) Compared with the excellent performance on other tasks, DeepSeekMoE exhibits limitations in addressing multiple-choice tasks.
This inadequacy stems from the limited attention parameters in DeepSeekMoE 16B (DeepSeekMoE 16B has only about 0.5B attention parameters, while DeepSeek 7B has 2.5B attention parameters).
Our earlier investigation on DeepSeek 7B reveals a positive correlation between the attention capacity and performance on multiple-choice tasks.
For example, DeepSeek 7B MQA, which is equipped with the multi-query attention mechanism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shazeer, <a class="ltx_ref" href="#bib.bib46" title="">2019</a>)</cite>, also struggled in MMLU-like tasks.
In addition, for a more comprehensive understanding of the training process of DeepSeekMoE 16B, we also provide the benchmark curves of DeepSeekMoE 16B and DeepSeek 7B (Dense) during training in Appendix&nbsp;<a class="ltx_ref" href="#A3" title="Appendix C Training Benchmark Curves of DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">C</span></a> for reference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S5.SS2.SSS1.p3">
<p class="ltx_p" id="S5.SS2.SSS1.p3.1">Critically, due to the modest number of parameters in DeepSeekMoE 16B, it enables single-device deployment on a GPU with 40GB of memory.
With appropriate operator optimizations, it can achieve nearly 2.5 times the inference speed of a 7B dense model.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T4.1.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.1.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T4.1.1.1.2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.2.1"># Shot</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.1.1.1.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.3.1">LLaMA2 7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.1.1.1.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.4.1">DeepSeekMoE 16B</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.2.2.1" style="padding-left:4.0pt;padding-right:4.0pt;"># Total Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.2.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">6.7B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.2.4" style="padding-left:4.0pt;padding-right:4.0pt;">16.4B</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.3.3.1" style="padding-left:4.0pt;padding-right:4.0pt;"># Activated Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.3.3.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.3.3" style="padding-left:4.0pt;padding-right:4.0pt;">6.7B</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.3.4" style="padding-left:4.0pt;padding-right:4.0pt;">2.8B</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.4.4.1" style="padding-left:4.0pt;padding-right:4.0pt;">FLOPs per 4K Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.4.4.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.4.3" style="padding-left:4.0pt;padding-right:4.0pt;">187.9T</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.4.4" style="padding-left:4.0pt;padding-right:4.0pt;">74.4T</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.5.5.1" style="padding-left:4.0pt;padding-right:4.0pt;"># Training Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.5.5.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.5.5.3" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.5.5.4" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.6.6.1" style="padding-left:4.0pt;padding-right:4.0pt;">Pile&nbsp;(BPB)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.6.6.2" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.6.6.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.76</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.6.6.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.6.6.4.1">0.74</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.7.7.1" style="padding-left:4.0pt;padding-right:4.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.7.7.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.7.7.3" style="padding-left:4.0pt;padding-right:4.0pt;">75.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.7.7.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.7.7.4.1">77.1</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.8.8.1" style="padding-left:4.0pt;padding-right:4.0pt;">PIQA&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.8.8.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.8.8.3" style="padding-left:4.0pt;padding-right:4.0pt;">78.0</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.8.8.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.8.8.4.1">80.2</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.9.9.1" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.9.9.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.9.9.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.9.9.3.1">69.1</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.9.9.4" style="padding-left:4.0pt;padding-right:4.0pt;">68.1</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.10.10.1" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.10.10.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.10.10.3" style="padding-left:4.0pt;padding-right:4.0pt;">49.0</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.10.10.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.10.10.4.1">49.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.11.11.1" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.11.11.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.11.11.3" style="padding-left:4.0pt;padding-right:4.0pt;">60.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.11.11.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.11.11.4.1">61.9</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.12.12.1" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-high&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.12.12.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.12.12.3" style="padding-left:4.0pt;padding-right:4.0pt;">45.8</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.12.12.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.12.12.4.1">46.4</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.13.13.1" style="padding-left:4.0pt;padding-right:4.0pt;">DROP&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.13.13.2" style="padding-left:4.0pt;padding-right:4.0pt;">1-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.13.13.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.13.13.3.1">34.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.13.13.4" style="padding-left:4.0pt;padding-right:4.0pt;">32.9</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.14.14.1" style="padding-left:4.0pt;padding-right:4.0pt;">GSM8K&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.14.14.2" style="padding-left:4.0pt;padding-right:4.0pt;">8-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.14.14.3" style="padding-left:4.0pt;padding-right:4.0pt;">15.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.14.14.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.14.14.4.1">18.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.15.15.1" style="padding-left:4.0pt;padding-right:4.0pt;">MATH&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.15.15.2" style="padding-left:4.0pt;padding-right:4.0pt;">4-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.15.15.3" style="padding-left:4.0pt;padding-right:4.0pt;">2.6</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.15.15.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.15.15.4.1">4.3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.16.16.1" style="padding-left:4.0pt;padding-right:4.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.16.16.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.16.16.3" style="padding-left:4.0pt;padding-right:4.0pt;">14.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.16.16.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.16.16.4.1">26.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.17.17.1" style="padding-left:4.0pt;padding-right:4.0pt;">MBPP&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.17.17.2" style="padding-left:4.0pt;padding-right:4.0pt;">3-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.17.17.3" style="padding-left:4.0pt;padding-right:4.0pt;">21.8</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.17.17.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.17.17.4.1">39.2</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.18.18.1" style="padding-left:4.0pt;padding-right:4.0pt;">TriviaQA&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.18.18.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.18.18.3" style="padding-left:4.0pt;padding-right:4.0pt;">63.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.18.18.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.18.18.4.1">64.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.19.19.1" style="padding-left:4.0pt;padding-right:4.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.19.19.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.19.19.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.19.19.3.1">25.5</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.19.19.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.19.19.4.1">25.5</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.20.20.1" style="padding-left:4.0pt;padding-right:4.0pt;">MMLU&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.20.20.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.20.20.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.20.20.3.1">45.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.20.20.4" style="padding-left:4.0pt;padding-right:4.0pt;">45.0</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T4.1.21.21.1" style="padding-left:4.0pt;padding-right:4.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.21.21.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.21.21.3" style="padding-left:4.0pt;padding-right:4.0pt;">69.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.21.21.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.21.21.4.1">70.2</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T4.1.22.22.1" style="padding-left:4.0pt;padding-right:4.0pt;">CLUEWSC&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T4.1.22.22.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.1.22.22.3" style="padding-left:4.0pt;padding-right:4.0pt;">64.0</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.1.22.22.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.22.22.4.1">72.1</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.23.23.1" style="padding-left:4.0pt;padding-right:4.0pt;">CEval&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.23.23.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.23.23.3" style="padding-left:4.0pt;padding-right:4.0pt;">33.9</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.23.23.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.23.23.4.1">40.6</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.1.24.24.1" style="padding-left:4.0pt;padding-right:4.0pt;">CMMLU&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.24.24.2" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.24.24.3" style="padding-left:4.0pt;padding-right:4.0pt;">32.6</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.24.24.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.24.24.4.1">42.5</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T4.1.25.25.1" style="padding-left:4.0pt;padding-right:4.0pt;">CHID&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T4.1.25.25.2" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.25.25.3" style="padding-left:4.0pt;padding-right:4.0pt;">37.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.25.25.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.25.25.4.1">89.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>
Comparison between LLaMA2 7B and DeepSeekMoE 16B.
With only 39.6% of computations, DeepSeekMoE 16B outperforms LLaMA2 7B on the majority of benchmarks.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsubsection" id="S5.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2 </span>Comparison with Open Source Models</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S5.SS2.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Internal Comparison with LLaMA2 7B.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.SSS2.Px1.p1">
<p class="ltx_p" id="S5.SS2.SSS2.Px1.p1.1">In the realm of open source models, we mainly compare DeepSeekMoE 16B with LLaMA2 7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="#bib.bib54" title="">2023b</a>)</cite>, a well-known and strong open source language model with 6.7B parameters.
Both DeepSeekMoE 16B and LLaMA2 7B are pretrained on 2T tokens.
Compared with LLaMA2 7B, DeepSeekMoE has 245% of total parameters but only needs 39.6% of computations.
The results on our internal benchmarks are presented in Table&nbsp;<a class="ltx_ref" href="#S5.T4" title="Table 4 ‣ 5.2.1 Internal Comparison with DeepSeek 7B ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, leading to the following observations.
(1) Among the evaluated benchmarks, with only about 40% of computations, DeepSeekMoE 16B outperforms LLaMA2 7B on the majority of benchmarks.
(2) The math reasoning and code generation capabilities of DeepSeekMoE 16B are stronger than LLaMA2 7B, attributed to the enriched presence of mathematical and code-related text in our pretraining corpus.
(3) Given the presence of Chinese texts in our pretraining corpus, DeepSeekMoE 16B exhibits a substantial performance advantage over LLaMA2 7B on Chinese benchmarks.
(4) Despite being trained on fewer English texts, DeepSeekMoE 16B achieves comparable or better performance compared with LLaMA2 7B on English understanding or knowledge-intensive benchmarks, which demonstrates the exceptional capabilities of DeepSeekMoE 16B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS2.Px2">
<h5 class="ltx_title ltx_title_paragraph">Evaluation on Open LLM Leaderboard.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.SSS2.Px2.p1">
<p class="ltx_p" id="S5.SS2.SSS2.Px2.p1.1">Beyond our internal evaluations, we also evaluate DeepSeekMoE 16B on the Open LLM Leaderboard and compare it with other open source models.
In addition to LLaMA2 7B, we take a broader set of open source models into consideration, including LLaMA 7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="#bib.bib53" title="">2023a</a>)</cite>, Falcon 7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Almazrouei et&nbsp;al., <a class="ltx_ref" href="#bib.bib1" title="">2023</a>)</cite>, GPT-J 6B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wang and Komatsuzaki, <a class="ltx_ref" href="#bib.bib56" title="">2021</a>)</cite>, RedPajama-INCITE 7B and 3B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Together-AI, <a class="ltx_ref" href="#bib.bib52" title="">2023</a>)</cite>, Open LLaMA 7B and 3B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Geng and Liu, <a class="ltx_ref" href="#bib.bib18" title="">2023</a>)</cite>, OPT 2.7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="#bib.bib60" title="">2022</a>)</cite>, Pythia 2.8B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Biderman et&nbsp;al., <a class="ltx_ref" href="#bib.bib4" title="">2023</a>)</cite>, GPT-neo 2.7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Black et&nbsp;al., <a class="ltx_ref" href="#bib.bib6" title="">2021</a>)</cite>, and BLOOM 3B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Scao et&nbsp;al., <a class="ltx_ref" href="#bib.bib44" title="">2022</a>)</cite>.
The evaluation results, as presented in Figure&nbsp;<a class="ltx_ref" href="#S0.F1" title="Figure 1 ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>, show that DeepSeekMoE 16B consistently outperforms models with similar activated parameters by a large margin.
Moreover, it achieves comparable performance with LLaMA2 7B, which has approximately 2.5 times the activated parameters.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
</section>
<section class="ltx_section" id="S6" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Alignment for DeepSeekMoE 16B</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">Previous research indicates that MoE models typically do not emerge significant gains from fine-tuning&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Fedus et&nbsp;al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>; Artetxe et&nbsp;al., <a class="ltx_ref" href="#bib.bib2" title="">2022</a>)</cite>.
However, <cite class="ltx_cite ltx_citemacro_citet">Shen et&nbsp;al. (<a class="ltx_ref" href="#bib.bib48" title="">2023</a>)</cite> present findings suggesting that MoE models can indeed benefit from instruction tuning.
In order to assess whether DeepSeekMoE 16B can benefit from fine-tuning, we conduct supervised fine-tuning to construct a chat model based on DeepSeekMoE 16B.
The experimental results reveal that DeepSeekMoE Chat 16B also achieves comparable performance with LLaMA2 SFT 7B and DeepSeek Chat 7B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Experimental Setup</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S6.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Training Data.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS1.SSS0.Px1.p1.1">For training the chat model, we conduct supervised fine-tuning&nbsp;(SFT) on our in-house curated data, comprising 1.4M training examples.
This dataset spans a broad range of categories including math, code, writing, question answering, reasoning, summarization, and more.
The majority of our SFT training data is in English and Chinese, rendering the chat model versatile and applicable in bilingual scenarios.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Hyper-Parameters.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS1.SSS0.Px2.p1.1">During supervised fine-tuning, we set the batch size to 1024 examples and conduct training over 8 epochs using the AdamW optimizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite>.
We employ a maximum sequence length of 4K, and pack the training examples as densely as possible until reaching the sequence length limit.
We do not use dropout for supervised fine-tuning, and simply set a constant learning rate of <math alttext="10^{-5}" class="ltx_Math" display="inline" id="S6.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S6.SS1.SSS0.Px2.p1.1.m1.1a"><msup id="S6.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">10</mn><mrow id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mo id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3a" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">−</mo><mn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><cn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" type="integer" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2">10</cn><apply id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3"><minus id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3"></minus><cn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS0.Px2.p1.1.m1.1c">10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS0.Px2.p1.1.m1.1d">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> without incorporating any learning rate scheduling strategy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Evaluation Benchmarks.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS1.SSS0.Px3.p1.1">For the evaluation of the chat models, we employ benchmarks similar to those used in Section&nbsp;<a class="ltx_ref" href="#S5.SS1.SSS3" title="5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5.1.3</span></a>, with the following adjustments:
(1) We exclude Pile&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="#bib.bib17" title="">2020</a>)</cite> since chat models are seldom employed for pure language modeling.
(2) We exclude CHID&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zheng et&nbsp;al., <a class="ltx_ref" href="#bib.bib61" title="">2019</a>)</cite> due to the observed instability of results, hindering the derivation of solid conclusions.
(3) We additionally include BBH&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Suzgun et&nbsp;al., <a class="ltx_ref" href="#bib.bib50" title="">2022</a>)</cite> to provide a more comprehensive assessment of the reasoning ability of the chat models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S6.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S6.T5.1.1.1.1" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text" id="S6.T5.1.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T5.1.1.1.1.1.1">
<span class="ltx_tr" id="S6.T5.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_center" id="S6.T5.1.1.1.1.1.1.1.1" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.1.1.1.1.1.1">Metric</span></span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T5.1.1.1.2" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text" id="S6.T5.1.1.1.2.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T5.1.1.1.2.1.1">
<span class="ltx_tr" id="S6.T5.1.1.1.2.1.1.1">
<span class="ltx_td ltx_align_center" id="S6.T5.1.1.1.2.1.1.1.1" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.2.1.1.1.1.1"># Shot</span></span></span>
</span></span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.1.1.3" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text" id="S6.T5.1.1.1.3.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T5.1.1.1.3.1.1">
<span class="ltx_tr" id="S6.T5.1.1.1.3.1.1.1">
<span class="ltx_td ltx_align_center" id="S6.T5.1.1.1.3.1.1.1.1" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.3.1.1.1.1.1">LLaMA2</span></span></span>
<span class="ltx_tr" id="S6.T5.1.1.1.3.1.1.2">
<span class="ltx_td ltx_align_center" id="S6.T5.1.1.1.3.1.1.2.1" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.3.1.1.2.1.1">SFT 7B</span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.1.1.4" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text" id="S6.T5.1.1.1.4.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T5.1.1.1.4.1.1">
<span class="ltx_tr" id="S6.T5.1.1.1.4.1.1.1">
<span class="ltx_td ltx_align_center" id="S6.T5.1.1.1.4.1.1.1.1" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.4.1.1.1.1.1">DeepSeek</span></span></span>
<span class="ltx_tr" id="S6.T5.1.1.1.4.1.1.2">
<span class="ltx_td ltx_align_center" id="S6.T5.1.1.1.4.1.1.2.1" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.4.1.1.2.1.1">Chat 7B</span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.1.1.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text" id="S6.T5.1.1.1.5.1">
<span class="ltx_tabular ltx_align_middle" id="S6.T5.1.1.1.5.1.1">
<span class="ltx_tr" id="S6.T5.1.1.1.5.1.1.1">
<span class="ltx_td ltx_align_center" id="S6.T5.1.1.1.5.1.1.1.1" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.5.1.1.1.1.1">DeepSeekMoE</span></span></span>
<span class="ltx_tr" id="S6.T5.1.1.1.5.1.1.2">
<span class="ltx_td ltx_align_center" id="S6.T5.1.1.1.5.1.1.2.1" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.5.1.1.2.1.1">Chat 16B</span></span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.2.2.1" style="padding-left:10.0pt;padding-right:10.0pt;"># Total Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.2.2.2" style="padding-left:10.0pt;padding-right:10.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.2.3" style="padding-left:10.0pt;padding-right:10.0pt;">6.7B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.2.4" style="padding-left:10.0pt;padding-right:10.0pt;">6.9B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.2.5" style="padding-left:10.0pt;padding-right:10.0pt;">16.4B</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.3.3.1" style="padding-left:10.0pt;padding-right:10.0pt;"># Activated Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.3.3.2" style="padding-left:10.0pt;padding-right:10.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.3.3" style="padding-left:10.0pt;padding-right:10.0pt;">6.7B</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.3.4" style="padding-left:10.0pt;padding-right:10.0pt;">6.9B</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.3.5" style="padding-left:10.0pt;padding-right:10.0pt;">2.8B</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.4.4.1" style="padding-left:10.0pt;padding-right:10.0pt;">FLOPs per 4K Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.4.4.2" style="padding-left:10.0pt;padding-right:10.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4.3" style="padding-left:10.0pt;padding-right:10.0pt;">187.9T</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4.4" style="padding-left:10.0pt;padding-right:10.0pt;">183.5T</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4.5" style="padding-left:10.0pt;padding-right:10.0pt;">74.4T</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.5.5.1" style="padding-left:10.0pt;padding-right:10.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.5.5.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.5.5.3" style="padding-left:10.0pt;padding-right:10.0pt;">67.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.5.5.4" style="padding-left:10.0pt;padding-right:10.0pt;">71.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.5.5.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.5.5.5.1">72.2</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.6.6.1" style="padding-left:10.0pt;padding-right:10.0pt;">PIQA&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.6.6.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6.3" style="padding-left:10.0pt;padding-right:10.0pt;">76.9</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6.4" style="padding-left:10.0pt;padding-right:10.0pt;">78.4</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.6.6.5.1">79.7</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.7.7.1" style="padding-left:10.0pt;padding-right:10.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.7.7.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.7.3" style="padding-left:10.0pt;padding-right:10.0pt;">69.7</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.7.4" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.7.7.4.1">70.2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.7.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.7.7.5.1">69.9</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.8.8.1" style="padding-left:10.0pt;padding-right:10.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.8.8.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.8.8.3" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.8.8.3.1">50.8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.8.8.4" style="padding-left:10.0pt;padding-right:10.0pt;">50.2</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.8.8.5" style="padding-left:10.0pt;padding-right:10.0pt;">50.0</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.9.9.1" style="padding-left:10.0pt;padding-right:10.0pt;">BBH&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.9.9.2" style="padding-left:10.0pt;padding-right:10.0pt;">3-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.9.9.3" style="padding-left:10.0pt;padding-right:10.0pt;">39.3</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.9.9.4" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.9.9.4.1">43.1</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.9.9.5" style="padding-left:10.0pt;padding-right:10.0pt;">42.2</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.10.10.1" style="padding-left:10.0pt;padding-right:10.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.10.10.2" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.10.10.3" style="padding-left:10.0pt;padding-right:10.0pt;">63.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.10.10.4" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.10.10.4.1">66.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.10.10.5" style="padding-left:10.0pt;padding-right:10.0pt;">64.8</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.11.11.1" style="padding-left:10.0pt;padding-right:10.0pt;">RACE-high&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.11.11.2" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.11.11.3" style="padding-left:10.0pt;padding-right:10.0pt;">49.6</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.11.11.4" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.11.11.4.1">50.8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.11.11.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.11.11.5.1">50.6</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.12.12.1" style="padding-left:10.0pt;padding-right:10.0pt;">DROP&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.12.12.2" style="padding-left:10.0pt;padding-right:10.0pt;">1-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.12.12.3" style="padding-left:10.0pt;padding-right:10.0pt;">40.0</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.12.12.4" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.12.12.4.1">41.7</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.12.12.5" style="padding-left:10.0pt;padding-right:10.0pt;">33.8</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.13.13.1" style="padding-left:10.0pt;padding-right:10.0pt;">GSM8K&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.13.13.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.13.13.3" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.13.13.3.1">63.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.13.13.4" style="padding-left:10.0pt;padding-right:10.0pt;">62.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.13.13.5" style="padding-left:10.0pt;padding-right:10.0pt;">62.2</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.14.14.1" style="padding-left:10.0pt;padding-right:10.0pt;">MATH&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.14.14.2" style="padding-left:10.0pt;padding-right:10.0pt;">4-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.14.14.3" style="padding-left:10.0pt;padding-right:10.0pt;">13.5</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.14.14.4" style="padding-left:10.0pt;padding-right:10.0pt;">14.7</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.14.14.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.14.14.5.1">15.2</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.15.15.1" style="padding-left:10.0pt;padding-right:10.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.15.15.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.15.15.3" style="padding-left:10.0pt;padding-right:10.0pt;">35.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.15.15.4" style="padding-left:10.0pt;padding-right:10.0pt;">45.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.15.15.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.15.15.5.1">45.7</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.16.16.1" style="padding-left:10.0pt;padding-right:10.0pt;">MBPP&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.16.16.2" style="padding-left:10.0pt;padding-right:10.0pt;">3-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.16.16.3" style="padding-left:10.0pt;padding-right:10.0pt;">27.8</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.16.16.4" style="padding-left:10.0pt;padding-right:10.0pt;">39.0</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.16.16.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.16.16.5.1">46.2</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.17.17.1" style="padding-left:10.0pt;padding-right:10.0pt;">TriviaQA&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.17.17.2" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.17.17.3" style="padding-left:10.0pt;padding-right:10.0pt;">60.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.17.17.4" style="padding-left:10.0pt;padding-right:10.0pt;">59.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.17.17.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.17.17.5.1">63.3</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.18.18.1" style="padding-left:10.0pt;padding-right:10.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.18.18.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.18.18.3" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.18.18.3.1">35.2</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.18.18.4" style="padding-left:10.0pt;padding-right:10.0pt;">32.7</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.18.18.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.18.18.5.1">35.1</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.19.19.1" style="padding-left:10.0pt;padding-right:10.0pt;">MMLU&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.19.19.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.19.19.3" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.19.19.3.1">50.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.19.19.4" style="padding-left:10.0pt;padding-right:10.0pt;">49.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.19.19.5" style="padding-left:10.0pt;padding-right:10.0pt;">47.2</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.20.20.1" style="padding-left:10.0pt;padding-right:10.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S6.T5.1.20.20.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.20.20.3" style="padding-left:10.0pt;padding-right:10.0pt;">65.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.20.20.4" style="padding-left:10.0pt;padding-right:10.0pt;">68.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.20.20.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.20.20.5.1">69.0</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S6.T5.1.21.21.1" style="padding-left:10.0pt;padding-right:10.0pt;">CLUEWSC&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.T5.1.21.21.2" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.21.21.3" style="padding-left:10.0pt;padding-right:10.0pt;">48.4</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.21.21.4" style="padding-left:10.0pt;padding-right:10.0pt;">66.2</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.21.21.5" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.21.21.5.1">68.2</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.22.22.1" style="padding-left:10.0pt;padding-right:10.0pt;">CEval&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S6.T5.1.22.22.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.22.22.3" style="padding-left:10.0pt;padding-right:10.0pt;">35.1</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.22.22.4" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.22.22.4.1">44.7</span></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.22.22.5" style="padding-left:10.0pt;padding-right:10.0pt;">40.0</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T5.1.23.23.1" style="padding-left:10.0pt;padding-right:10.0pt;">CMMLU&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S6.T5.1.23.23.2" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.23.23.3" style="padding-left:10.0pt;padding-right:10.0pt;">36.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.23.23.4" style="padding-left:10.0pt;padding-right:10.0pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.23.23.4.1">51.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.23.23.5" style="padding-left:10.0pt;padding-right:10.0pt;">49.3</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>
Comparison among LLaMA2 SFT 7B, DeepSeek Chat 7B and DeepSeekMoE Chat 16B, with all of these three models fine-tuned on the same SFT data.
Compared with both 7B dense models, DeepSeekMoE Chat 16B still achieves comparable or better performance on the majority of benchmarks with only 40% of computations.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Evaluations</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S6.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS2.SSS0.Px1.p1.1">In order to validate the potential of DeepSeekMoE 16B after alignment, we conduct supervised fine-tuning for LLaMA2 7B, DeepSeek 7B, and DeepSeekMoE 16B, where we utilize totally the same fine-tuning data to ensure fairness.
Correspondingly, we construct three chat models, including LLaMA2 SFT 7B<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We use LLaMA2 SFT to distinguish from the official LLaMA2 Chat&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="#bib.bib54" title="">2023b</a>)</cite> model.</span></span></span>, DeepSeek Chat 7B, and DeepSeekMoE Chat 16B.
Subsequently, we compare DeepSeekMoE Chat 16B with the other two dense chat models (with about 2.5 times the FLOPs) across a wide range of downstream tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS2.SSS0.Px2.p1.1">The evaluation results are presented in Table&nbsp;<a class="ltx_ref" href="#S6.T5" title="Table 5 ‣ Evaluation Benchmarks. ‣ 6.1 Experimental Setup ‣ 6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>.
Our key observations include:
(1) DeepSeekMoE Chat 16B, while consuming nearly 40% of computations, achieves comparable performance with 7B dense models across language understanding and reasoning (PIQA, ARC, BBH), machine reading comprehension (RACE), mathematical (GSM8K, MATH), and knowledge-intensive tasks (TriviaQA, NaturalQuestions).
(2) On code generation tasks, DeepSeekMoE Chat 16B significantly outperforms LLaMA2 SFT 7B, demonstrating notable improvements on HumanEval and MBPP.
In addition, it also surpasses DeepSeek Chat 7B.
(3) On multiple-choice question answering benchmarks including MMLU, CEval, and CMMLU, DeepSeekMoE Chat 16B still falls behind DeepSeek Chat 7B, consistent with the observations for the base model&nbsp;(Section&nbsp;<a class="ltx_ref" href="#S5.SS2.SSS1" title="5.2.1 Internal Comparison with DeepSeek 7B ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5.2.1</span></a>).
However, it is worth noting that, after supervised fine-tuning, the performance gap between DeepSeekMoE 16B and DeepSeek 7B is narrowed.
(4) Benefiting from the pretraining on a bilingual corpus, DeepSeekMoE Chat 16B notably outperforms LLaMA2 SFT 7B on all Chinese benchmarks.
These results demonstrate the balanced capabilities of DeepSeekMoE 16B in both Chinese and English, enhancing its versatility and applicability in diverse scenarios.
In conclusion, the evaluation for the chat models highlights the potential of DeepSeekMoE 16B in benefiting from alignment, and validates its consistent advantages in achieving comparable performance with dense models while using only about 40% of computations.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S7" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>DeepSeekMoE 145B Ongoing</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">Encouraged by the outstanding performance of DeepSeekMoE 16B, we further undertake a preliminary endeavor to scale up DeepSeekMoE to 145B.
In this initial study, DeepSeekMoE 145B is trained on 245B tokens, but it has demonstrated consistent advantages over the GShard architecture and shown promise to match or exceed the performance of DeepSeek 67B (Dense).
Furthermore, upon the completion of the final version and full training of DeepSeekMoE 145B, we also plan to make it publicly available.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Experimental Setup</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S7.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Training Data and Tokenization.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S7.SS1.SSS0.Px1.p1.1">For DeepSeekMoE 145B, we employ exactly the same training corpus and tokenizer as DeepSeekMoE 16B, with the only difference being that DeepSeekMoE 145B is trained on 245B tokens for an initial study.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S7.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Model Settings.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S7.SS1.SSS0.Px2.p1.1">For DeepSeekMoE 145B, we set the number of Transformer layers to 62 and the hidden dimension to 4096.
We employ the multi-head attention mechanism with a total of 32 attention heads, where each head has a dimension of 128.
As for initialization, all learnable parameters are randomly initialized with a standard deviation of 0.006.
As in DeepSeekMoE 16B, we also substitute all FFNs except for the first layer with MoE layers.
Each MoE layer consists of 4 shared experts and 128 routed experts, where each expert is 0.125 times the size of a standard FFN.
Each token will be routed to these 4 shared experts and 12 out of 128 routed experts.
Under this configuration, DeepSeekMoE 145 has approximately 144.6B total parameters, with the number of activated parameters around 22.2B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S7.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Training Settings.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S7.SS1.SSS0.Px3.p1.4">We employ the AdamW optimizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite> with hyper-parameters set to <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S7.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S7.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><msub id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml"><mi id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2.cmml">β</mi><mn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1"><eq id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1"></eq><apply id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.1.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2">𝛽</ci><cn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.1.m1.1c">\beta_{1}=0.9</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.SSS0.Px3.p1.1.m1.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.95" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.2.m2.1"><semantics id="S7.SS1.SSS0.Px3.p1.2.m2.1a"><mrow id="S7.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.cmml"><msub id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml"><mi id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2.cmml">β</mi><mn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.2.m2.1b"><apply id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1"><eq id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1"></eq><apply id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.1.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2">subscript</csymbol><ci id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2">𝛽</ci><cn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.2.m2.1c">\beta_{2}=0.95</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.SSS0.Px3.p1.2.m2.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.95</annotation></semantics></math>, and <math alttext="\mathrm{weight\_decay}=0.1" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.3.m3.1"><semantics id="S7.SS1.SSS0.Px3.p1.3.m3.1a"><mrow id="S7.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.cmml"><mrow id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml"><mi id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2.cmml">weight</mi><mo id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1a" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4.cmml">decay</mi></mrow><mo id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.3.m3.1b"><apply id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1"><eq id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1"></eq><apply id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2"><times id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1"></times><ci id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2">weight</ci><ci id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3">_</ci><ci id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4">decay</ci></apply><cn id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.3.m3.1c">\mathrm{weight\_decay}=0.1</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.SSS0.Px3.p1.3.m3.1d">roman_weight _ roman_decay = 0.1</annotation></semantics></math>.
For the preliminary study of DeepSeekMoE 145B, we employ a warmup-and-constant learning rate scheduler.
Initially, the learning rate linearly increases from 0 to the maximum value during the first 2K steps.
Subsequently, the learning rate keeps constant during the remaining training process.
The maximum learning rate for DeepSeekMoE 145B is set to <math alttext="3.0\times 10^{-4}" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.4.m4.1"><semantics id="S7.SS1.SSS0.Px3.p1.4.m4.1a"><mrow id="S7.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.cmml"><mn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml">3.0</mn><mo id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml">×</mo><msup id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml"><mn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml"><mo id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3a" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.4.m4.1b"><apply id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1"><times id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1"></times><cn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2">3.0</cn><apply id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3">superscript</csymbol><cn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2">10</cn><apply id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3"><minus id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3"></minus><cn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.4.m4.1c">3.0\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.SSS0.Px3.p1.4.m4.1d">3.0 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, and the gradient clipping norm is set to 1.0.
The batch size is set to 4.5K, and with a maximum sequence length of 4K, each training batch contains 18M tokens.
We train DeepSeekMoE 145B for 13,000 steps, achieving 245B training tokens.
Also, we do not use dropout during training.
We leverage pipeline parallelism to deploy different layers of a model on different devices, and for each layer, all the routed experts will be uniformly deployed on 4 devices (i.e., expert parallelism combined with data parallelism).
Since we employ expert parallelism for DeepSeekMoE 145B, the device-level load balance should be considered to reduce the computational bottleneck.
In response, we set the device-level balance factor to 0.05 to encourage balanced computation across devices.
Also, we still set a small expert-level balance factor of 0.003 to prevent routing collapse.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S7.SS1.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Evaluation Benchmarks.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S7.SS1.SSS0.Px4.p1.1">We evaluate DeepSeekMoE 145B on exactly the same internal benchmarks as used for DeepSeekMoE 16B&nbsp;(see Section&nbsp;<a class="ltx_ref" href="#S5.SS1.SSS3" title="5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5.1.3</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S7.T6">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T6.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T6.9.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S7.T6.9.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S7.T6.9.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S7.T6.9.1.1.1.1.1">
<span class="ltx_tr" id="S7.T6.9.1.1.1.1.1.1">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.1.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.1.1.1.1.1.1">Metric</span></span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S7.T6.9.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S7.T6.9.1.1.2.1">
<span class="ltx_tabular ltx_align_middle" id="S7.T6.9.1.1.2.1.1">
<span class="ltx_tr" id="S7.T6.9.1.1.2.1.1.1">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.2.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.2.1.1.1.1.1"># Shot</span></span></span>
</span></span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T6.9.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S7.T6.9.1.1.3.1">
<span class="ltx_tabular ltx_align_middle" id="S7.T6.9.1.1.3.1.1">
<span class="ltx_tr" id="S7.T6.9.1.1.3.1.1.1">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.3.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.3.1.1.1.1.1">DeepSeek</span></span></span>
<span class="ltx_tr" id="S7.T6.9.1.1.3.1.1.2">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.3.1.1.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.3.1.1.2.1.1">67B (Dense)</span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T6.9.1.1.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S7.T6.9.1.1.4.1">
<span class="ltx_tabular ltx_align_middle" id="S7.T6.9.1.1.4.1.1">
<span class="ltx_tr" id="S7.T6.9.1.1.4.1.1.1">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.4.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.4.1.1.1.1.1">GShard</span></span></span>
<span class="ltx_tr" id="S7.T6.9.1.1.4.1.1.2">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.4.1.1.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.4.1.1.2.1.1">137B</span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S7.T6.9.1.1.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S7.T6.9.1.1.5.1">
<span class="ltx_tabular ltx_align_middle" id="S7.T6.9.1.1.5.1.1">
<span class="ltx_tr" id="S7.T6.9.1.1.5.1.1.1">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.5.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.5.1.1.1.1.1">DeepSeekMoE</span></span></span>
<span class="ltx_tr" id="S7.T6.9.1.1.5.1.1.2">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.5.1.1.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.5.1.1.2.1.1">145B</span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T6.9.1.1.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S7.T6.9.1.1.6.1">
<span class="ltx_tabular ltx_align_middle" id="S7.T6.9.1.1.6.1.1">
<span class="ltx_tr" id="S7.T6.9.1.1.6.1.1.1">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.6.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.6.1.1.1.1.1">DeepSeekMoE 142B</span></span></span>
<span class="ltx_tr" id="S7.T6.9.1.1.6.1.1.2">
<span class="ltx_td ltx_align_center" id="S7.T6.9.1.1.6.1.1.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.1.1.6.1.1.2.1.1">(Half Activated)</span></span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T6.9.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"># Total Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T6.9.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">67.4B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.2.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">136.5B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T6.9.2.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">144.6B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.2.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">142.3B</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"># Activated Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.3.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">67.4B</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">21.6B</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.3.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">22.2B</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.3.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">12.2B</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">Relative Expert Size</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.4.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.4.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.125</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.4.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.125</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.5.5.1" style="padding-left:3.0pt;padding-right:3.0pt;"># Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.5.5.3" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.5.5.4" style="padding-left:3.0pt;padding-right:3.0pt;">0 + 16</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">4 + 128</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.5.5.6" style="padding-left:3.0pt;padding-right:3.0pt;">2 + 128</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.6.6.1" style="padding-left:3.0pt;padding-right:3.0pt;"># Activated Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.6.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.6.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.6.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">0 + 2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.6.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">4 + 12</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">2 + 6</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.7.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">FLOPs per 4K Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.7.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.7.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">2057.5T</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.7.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">572.7T</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.7.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">585.6T</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.7.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">374.6T</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.8.8.1" style="padding-left:3.0pt;padding-right:3.0pt;"># Training Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.8.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.8.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.8.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.8.8.5" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.8.8.6" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T6.9.9.9.1" style="padding-left:3.0pt;padding-right:3.0pt;">Pile&nbsp;(Loss.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T6.9.9.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.9.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">1.905</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.9.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">1.961</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T6.9.9.9.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.9.9.5.1">1.876</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.9.9.6" style="padding-left:3.0pt;padding-right:3.0pt;">1.888</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T6.9.10.10.1" style="padding-left:3.0pt;padding-right:3.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T6.9.10.10.2" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.10.10.3" style="padding-left:3.0pt;padding-right:3.0pt;">74.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.10.10.4" style="padding-left:3.0pt;padding-right:3.0pt;">72.0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T6.9.10.10.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.10.10.5.1">75.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.10.10.6" style="padding-left:3.0pt;padding-right:3.0pt;">74.9</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.11.11.1" style="padding-left:3.0pt;padding-right:3.0pt;">PIQA&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.11.11.2" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.11.11.3" style="padding-left:3.0pt;padding-right:3.0pt;">79.8</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.11.11.4" style="padding-left:3.0pt;padding-right:3.0pt;">77.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.11.11.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.11.11.5.1">80.7</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.11.11.6" style="padding-left:3.0pt;padding-right:3.0pt;">80.2</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.12.12.1" style="padding-left:3.0pt;padding-right:3.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.12.12.2" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.12.12.3" style="padding-left:3.0pt;padding-right:3.0pt;">69.0</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.12.12.4" style="padding-left:3.0pt;padding-right:3.0pt;">64.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.12.12.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.12.12.5.1">69.7</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.12.12.6" style="padding-left:3.0pt;padding-right:3.0pt;">67.9</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.13.13.1" style="padding-left:3.0pt;padding-right:3.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.13.13.2" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.13.13.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.13.13.3.1">50.4</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.13.13.4" style="padding-left:3.0pt;padding-right:3.0pt;">45.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.13.13.5" style="padding-left:3.0pt;padding-right:3.0pt;">48.8</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.13.13.6" style="padding-left:3.0pt;padding-right:3.0pt;">49.0</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T6.9.14.14.1" style="padding-left:3.0pt;padding-right:3.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T6.9.14.14.2" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.14.14.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.14.14.3.1">63.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.14.14.4" style="padding-left:3.0pt;padding-right:3.0pt;">59.2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T6.9.14.14.5" style="padding-left:3.0pt;padding-right:3.0pt;">62.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.14.14.6" style="padding-left:3.0pt;padding-right:3.0pt;">59.5</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.15.15.1" style="padding-left:3.0pt;padding-right:3.0pt;">RACE-high&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.15.15.2" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.15.15.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.15.15.3.1">46.9</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.15.15.4" style="padding-left:3.0pt;padding-right:3.0pt;">43.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.15.15.5" style="padding-left:3.0pt;padding-right:3.0pt;">45.5</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.15.15.6" style="padding-left:3.0pt;padding-right:3.0pt;">42.6</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.16.16.1" style="padding-left:3.0pt;padding-right:3.0pt;">DROP&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.16.16.2" style="padding-left:3.0pt;padding-right:3.0pt;">1-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.16.16.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.16.16.3.1">27.5</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.16.16.4" style="padding-left:3.0pt;padding-right:3.0pt;">21.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.16.16.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.16.16.5.1">27.8</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.16.16.6" style="padding-left:3.0pt;padding-right:3.0pt;">28.9</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.17.17.1" style="padding-left:3.0pt;padding-right:3.0pt;">GSM8K&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.17.17.2" style="padding-left:3.0pt;padding-right:3.0pt;">8-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.17.17.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.17.17.3.1">11.8</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.17.17.4" style="padding-left:3.0pt;padding-right:3.0pt;">6.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.17.17.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.17.17.5.1">12.2</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.17.17.6" style="padding-left:3.0pt;padding-right:3.0pt;">13.8</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.18.18.1" style="padding-left:3.0pt;padding-right:3.0pt;">MATH&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.18.18.2" style="padding-left:3.0pt;padding-right:3.0pt;">4-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.18.18.3" style="padding-left:3.0pt;padding-right:3.0pt;">2.1</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.18.18.4" style="padding-left:3.0pt;padding-right:3.0pt;">1.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.18.18.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.18.18.5.1">3.1</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.18.18.6" style="padding-left:3.0pt;padding-right:3.0pt;">2.8</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T6.9.19.19.1" style="padding-left:3.0pt;padding-right:3.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T6.9.19.19.2" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.19.19.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.19.19.3.1">23.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.19.19.4" style="padding-left:3.0pt;padding-right:3.0pt;">17.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T6.9.19.19.5" style="padding-left:3.0pt;padding-right:3.0pt;">19.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.19.19.6" style="padding-left:3.0pt;padding-right:3.0pt;">23.2</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.20.20.1" style="padding-left:3.0pt;padding-right:3.0pt;">MBPP&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.20.20.2" style="padding-left:3.0pt;padding-right:3.0pt;">3-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.20.20.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.20.20.3.1">33.6</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.20.20.4" style="padding-left:3.0pt;padding-right:3.0pt;">27.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.20.20.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.20.20.5.1">33.2</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.20.20.6" style="padding-left:3.0pt;padding-right:3.0pt;">32.0</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T6.9.21.21.1" style="padding-left:3.0pt;padding-right:3.0pt;">TriviaQA&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T6.9.21.21.2" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.21.21.3" style="padding-left:3.0pt;padding-right:3.0pt;">57.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.21.21.4" style="padding-left:3.0pt;padding-right:3.0pt;">52.5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T6.9.21.21.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.21.21.5.1">61.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.21.21.6" style="padding-left:3.0pt;padding-right:3.0pt;">59.8</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.22.22.1" style="padding-left:3.0pt;padding-right:3.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.22.22.2" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.22.22.3" style="padding-left:3.0pt;padding-right:3.0pt;">22.6</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.22.22.4" style="padding-left:3.0pt;padding-right:3.0pt;">19.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.22.22.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.22.22.5.1">25.0</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.22.22.6" style="padding-left:3.0pt;padding-right:3.0pt;">23.5</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T6.9.23.23.1" style="padding-left:3.0pt;padding-right:3.0pt;">MMLU&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T6.9.23.23.2" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.23.23.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.23.23.3.1">45.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.23.23.4" style="padding-left:3.0pt;padding-right:3.0pt;">26.3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T6.9.23.23.5" style="padding-left:3.0pt;padding-right:3.0pt;">39.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.23.23.6" style="padding-left:3.0pt;padding-right:3.0pt;">37.5</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T6.9.24.24.1" style="padding-left:3.0pt;padding-right:3.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T6.9.24.24.2" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.24.24.3" style="padding-left:3.0pt;padding-right:3.0pt;">70.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.24.24.4" style="padding-left:3.0pt;padding-right:3.0pt;">67.6</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T6.9.24.24.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.24.24.5.1">71.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.9.24.24.6" style="padding-left:3.0pt;padding-right:3.0pt;">70.8</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S7.T6.9.25.25.1" style="padding-left:3.0pt;padding-right:3.0pt;">CLUEWSC&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S7.T6.9.25.25.2" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T6.9.25.25.3" style="padding-left:3.0pt;padding-right:3.0pt;">69.1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T6.9.25.25.4" style="padding-left:3.0pt;padding-right:3.0pt;">65.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S7.T6.9.25.25.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.25.25.5.1">71.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T6.9.25.25.6" style="padding-left:3.0pt;padding-right:3.0pt;">72.6</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.26.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.26.26.1" style="padding-left:3.0pt;padding-right:3.0pt;">CEval&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.26.26.2" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.26.26.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.26.26.3.1">40.3</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.26.26.4" style="padding-left:3.0pt;padding-right:3.0pt;">26.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.26.26.5" style="padding-left:3.0pt;padding-right:3.0pt;">37.1</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.26.26.6" style="padding-left:3.0pt;padding-right:3.0pt;">32.8</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.27.27">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.9.27.27.1" style="padding-left:3.0pt;padding-right:3.0pt;">CMMLU&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T6.9.27.27.2" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="S7.T6.9.27.27.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.27.27.3.1">40.6</span></td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.27.27.4" style="padding-left:3.0pt;padding-right:3.0pt;">25.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T6.9.27.27.5" style="padding-left:3.0pt;padding-right:3.0pt;">35.9</td>
<td class="ltx_td ltx_align_center" id="S7.T6.9.27.27.6" style="padding-left:3.0pt;padding-right:3.0pt;">31.9</td>
</tr>
<tr class="ltx_tr" id="S7.T6.9.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S7.T6.9.28.28.1" style="padding-left:3.0pt;padding-right:3.0pt;">CHID&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S7.T6.9.28.28.2" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T6.9.28.28.3" style="padding-left:3.0pt;padding-right:3.0pt;">88.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T6.9.28.28.4" style="padding-left:3.0pt;padding-right:3.0pt;">86.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S7.T6.9.28.28.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S7.T6.9.28.28.5.1">90.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T6.9.28.28.6" style="padding-left:3.0pt;padding-right:3.0pt;">88.3</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>
Comparison among DeepSeek 67B (Dense) and MoE models at the scale of about 140B total parameters.
In the lines of “# Experts” and “# Activated Experts”, <math alttext="a" class="ltx_Math" display="inline" id="S7.T6.5.m1.1"><semantics id="S7.T6.5.m1.1b"><mi id="S7.T6.5.m1.1.1" xref="S7.T6.5.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S7.T6.5.m1.1c"><ci id="S7.T6.5.m1.1.1.cmml" xref="S7.T6.5.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.5.m1.1d">a</annotation><annotation encoding="application/x-llamapun" id="S7.T6.5.m1.1e">italic_a</annotation></semantics></math> + <math alttext="b" class="ltx_Math" display="inline" id="S7.T6.6.m2.1"><semantics id="S7.T6.6.m2.1b"><mi id="S7.T6.6.m2.1.1" xref="S7.T6.6.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S7.T6.6.m2.1c"><ci id="S7.T6.6.m2.1.1.cmml" xref="S7.T6.6.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.6.m2.1d">b</annotation><annotation encoding="application/x-llamapun" id="S7.T6.6.m2.1e">italic_b</annotation></semantics></math> denotes <math alttext="a" class="ltx_Math" display="inline" id="S7.T6.7.m3.1"><semantics id="S7.T6.7.m3.1b"><mi id="S7.T6.7.m3.1.1" xref="S7.T6.7.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S7.T6.7.m3.1c"><ci id="S7.T6.7.m3.1.1.cmml" xref="S7.T6.7.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.7.m3.1d">a</annotation><annotation encoding="application/x-llamapun" id="S7.T6.7.m3.1e">italic_a</annotation></semantics></math> shared experts and <math alttext="b" class="ltx_Math" display="inline" id="S7.T6.8.m4.1"><semantics id="S7.T6.8.m4.1b"><mi id="S7.T6.8.m4.1.1" xref="S7.T6.8.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S7.T6.8.m4.1c"><ci id="S7.T6.8.m4.1.1.cmml" xref="S7.T6.8.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.8.m4.1d">b</annotation><annotation encoding="application/x-llamapun" id="S7.T6.8.m4.1e">italic_b</annotation></semantics></math> routed experts, respectively.
<span class="ltx_text ltx_font_bold" id="S7.T6.11.1">Bold</span> font indicates the best or near the best performance excluding the last column.
DeepSeekMoE 145B, and even DeepSeekMoE 142B (Half Activated) that has only a half of activated expert parameters, outperform GShard 137B by a large margin.
Moreover, with 28.5% of computations, DeepSeekMoE 145B achieves comparable performance with DeepSeek 67B.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Evaluations</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S7.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S7.SS2.SSS0.Px1.p1.1">Apart from <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.1">DeepSeekMoE 145B</span>, we consider three additional models for comparison.
<span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.2">DeepSeek 67B (Dense)</span> is a dense model with 67.4B total parameters (refer to <cite class="ltx_cite ltx_citemacro_citet">DeepSeek-AI (<a class="ltx_ref" href="#bib.bib13" title="">2024</a>)</cite> for the model and training details).
<span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.3">GShard 137B</span> shares the same hidden dimension and number of layers as DeepSeekMoE 145B, but follows the GShard architecture.
Note that DeepSeekMoE 145B aligns the intermediate hidden dimension in each expert to a multiple of 64 for computation efficiency, so its model size is 6% larger than GShard 137B.
<span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.4">DeepSeekMoE 142B (Half Activated)</span> has a similar architecture to DeepSeekMoE 145B, but it contains only 2 shared experts, and only 6 out of 128 routed experts are activated.
It is noteworthy that all compared models, including DeepSeekMoE 145B, share the same training corpus.
In addition, all MoE models in the comparison are trained from scratch and share the same training hyper-parameters.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S7.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S7.SS2.SSS0.Px2.p1.1">From the evaluation results presented in Table&nbsp;<a class="ltx_ref" href="#S7.T6" title="Table 6 ‣ Evaluation Benchmarks. ‣ 7.1 Experimental Setup ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>, we have the following observations:
(1)
Despite having comparable total parameters and computations, DeepSeekMoE 145B significantly outperforms GShard 137B, highlighting the advantages of the DeepSeekMoE architecture again.
(2)
On the whole, with only 28.5% of computations, DeepSeekMoE 145B achieves comparable performance with DeepSeek 67B (Dense).
Consistent with the findings from DeepSeekMoE 16B, DeepSeekMoE 145B exhibits remarkable strengths in language modeling and knowledge-intensive tasks, but with limitations in multiple-choice tasks.
(3)
At a larger scale, the performance of DeepSeekMoE 142B (Half Activated) does not lag behind too much from DeepSeekMoE 145B.
In addition, despite having only a half of activated expert parameters, DeepSeekMoE 142B (Half Activated) still match the performance of DeepSeek 67B (Dense), with only 18.2% of computations.
It also outperforms GShard 137B, which aligns with the conclusion from Section&nbsp;<a class="ltx_ref" href="#S4.SS5" title="4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4.5</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S8" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">The Mixture of Experts&nbsp;(MoE) technique is first proposed by <cite class="ltx_cite ltx_citemacro_citet">Jacobs et&nbsp;al. (<a class="ltx_ref" href="#bib.bib26" title="">1991</a>); Jordan and Jacobs (<a class="ltx_ref" href="#bib.bib27" title="">1994</a>)</cite> to deal with different samples with independent expert modules.
<cite class="ltx_cite ltx_citemacro_citet">Shazeer et&nbsp;al. (<a class="ltx_ref" href="#bib.bib47" title="">2017</a>)</cite> introduce MoE into language model training and build a large-scale LSTM-based&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and Schmidhuber, <a class="ltx_ref" href="#bib.bib23" title="">1997</a>)</cite> MoE models.
As Transformer become the most popular architecture for NLP, many attempts extend FFNs in a Transformer as MoE layers to build MoE language models.
GShard&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et&nbsp;al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> and Switch Transformer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Fedus et&nbsp;al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite> are pioneers which employ learnable top-2 or top-1 routing strategies to scale the MoE language models to an extremely large scale.
Hash Layer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Roller et&nbsp;al., <a class="ltx_ref" href="#bib.bib42" title="">2021</a>)</cite> and StableMoE&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a class="ltx_ref" href="#bib.bib12" title="">2022b</a>)</cite> use fixed routing strategies for more stable routing and training.
<cite class="ltx_cite ltx_citemacro_citet">Zhou et&nbsp;al. (<a class="ltx_ref" href="#bib.bib62" title="">2022</a>)</cite> propose an expert-choice routing strategy, where each token can be assigned to different numbers of experts.
<cite class="ltx_cite ltx_citemacro_citet">Zoph (<a class="ltx_ref" href="#bib.bib63" title="">2022</a>)</cite> focus on the issues of training instability and fine-tuning difficulty in MoE models, and propose ST-MoE to overcome these challenges.
In addition to research on MoE architectures and training strategies, recent years have also witnessed the emergence of numerous large-scale language or multimodal models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="#bib.bib34" title="">2021</a>; Du et&nbsp;al., <a class="ltx_ref" href="#bib.bib14" title="">2022</a>; Ren et&nbsp;al., <a class="ltx_ref" href="#bib.bib41" title="">2023</a>; Xue et&nbsp;al., <a class="ltx_ref" href="#bib.bib58" title="">2023</a>)</cite> based on existing MoE architectures.
By and large, most of the previous MoE models are based on conventional top-1 or top-2 routing strategies, leaving large room for improving expert specialization.
In response, our DeepSeekMoE architecture aims to improve the expert specialization to the utmost extent.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S9" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S9.p1">
<p class="ltx_p" id="S9.p1.1">In this paper, we introduce the DeepSeekMoE architecture for MoE language models, with the objective of achieving ultimate expert specialization.
Through fine-grained expert segmentation and shared expert isolation, DeepSeekMoE achieves significantly higher expert specialization and performance compared with prevailing MoE architectures.
Starting with a modest scale of 2B parameters, we validate the advantages of DeepSeekMoE, demonstrating its capability to approach the upper bound performance for MoE models.
Furthermore, we provide empirical evidence to show that DeepSeekMoE has a higher level of expert specialization than GShard.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S9.p2">
<p class="ltx_p" id="S9.p2.1">Scaling up to a larger scale of 16B total parameters, we train DeepSeekMoE 16B on 2T tokens and demonstrate its outstanding performance comparable with DeepSeek 7B and LLaMA2 7B, with only about 40% of computations.
Additionally, supervised fine-tuning is conducted for alignment to construct an MoE chat model based on DeepSeekMoE 16B, further showing its adaptability and versatility.
Further, we perform a preliminary exploration to scale DeepSeekMoE to 145B parameters.
We find that DeepSeekMoE 145B still keeps substantial advantages over the GShard architecture, and demonstrates comparable performance with DeepSeek 67B, using only 28.5% (maybe even 18.2%) of computations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S9.p3">
<p class="ltx_p" id="S9.p3.1">For research purposes, we release the model checkpoint of DeepSeekMoE 16B to the public, which can be deployed on a single GPU with 40GB of memory.
We aspire for this work to provide valuable insights for both academia and industry, and contribute to the accelerated advancement of large-scale language models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib" lang="en">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Almazrouei et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
E.&nbsp;Almazrouei, H.&nbsp;Alobeidli, A.&nbsp;Alshamsi, A.&nbsp;Cappelli, R.&nbsp;Cojocaru, M.&nbsp;Debbah, E.&nbsp;Goffinet, D.&nbsp;Heslow, J.&nbsp;Launay, Q.&nbsp;Malartic, B.&nbsp;Noune, B.&nbsp;Pannier, and G.&nbsp;Penedo.

</span>
<span class="ltx_bibblock">Falcon-40B: an open large language model with state-of-the-art performance, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Artetxe et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
M.&nbsp;Artetxe, S.&nbsp;Bhosale, N.&nbsp;Goyal, T.&nbsp;Mihaylov, M.&nbsp;Ott, S.&nbsp;Shleifer, X.&nbsp;V. Lin, J.&nbsp;Du, S.&nbsp;Iyer, R.&nbsp;Pasunuru, G.&nbsp;Anantharaman, X.&nbsp;Li, S.&nbsp;Chen, H.&nbsp;Akin, M.&nbsp;Baines, L.&nbsp;Martin, X.&nbsp;Zhou, P.&nbsp;S. Koura, B.&nbsp;O’Horo, J.&nbsp;Wang, L.&nbsp;Zettlemoyer, M.&nbsp;T. Diab, Z.&nbsp;Kozareva, and V.&nbsp;Stoyanov.

</span>
<span class="ltx_bibblock">Efficient large scale language modeling with mixtures of experts.

</span>
<span class="ltx_bibblock">In Y.&nbsp;Goldberg, Z.&nbsp;Kozareva, and Y.&nbsp;Zhang, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing, EMNLP 2022, Abu Dhabi, United Arab Emirates, December 7-11, 2022</em>, pages 11699–11732. Association for Computational Linguistics, 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/V1/2022.EMNLP-MAIN.804" title="">10.18653/V1/2022.EMNLP-MAIN.804</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/2022.emnlp-main.804" title="">https://doi.org/10.18653/v1/2022.emnlp-main.804</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Austin et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
J.&nbsp;Austin, A.&nbsp;Odena, M.&nbsp;Nye, M.&nbsp;Bosma, H.&nbsp;Michalewski, D.&nbsp;Dohan, E.&nbsp;Jiang, C.&nbsp;Cai, M.&nbsp;Terry, Q.&nbsp;Le, et&nbsp;al.

</span>
<span class="ltx_bibblock">Program synthesis with large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2108.07732</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Biderman, H.&nbsp;Schoelkopf, Q.&nbsp;G. Anthony, H.&nbsp;Bradley, K.&nbsp;O’Brien, E.&nbsp;Hallahan, M.&nbsp;A. Khan, S.&nbsp;Purohit, U.&nbsp;S. Prashanth, E.&nbsp;Raff, A.&nbsp;Skowron, L.&nbsp;Sutawika, and O.&nbsp;van&nbsp;der Wal.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In A.&nbsp;Krause, E.&nbsp;Brunskill, K.&nbsp;Cho, B.&nbsp;Engelhardt, S.&nbsp;Sabato, and J.&nbsp;Scarlett, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">International Conference on Machine Learning, ICML 2023, 23-29 July 2023, Honolulu, Hawaii, USA</em>, volume 202 of <em class="ltx_emph ltx_font_italic" id="bib.bib4.2.2">Proceedings of Machine Learning Research</em>, pages 2397–2430. PMLR, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v202/biderman23a.html" title="">https://proceedings.mlr.press/v202/biderman23a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Y.&nbsp;Bisk, R.&nbsp;Zellers, R.&nbsp;L. Bras, J.&nbsp;Gao, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">PIQA: reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">The Thirty-Fourth AAAI Conference on Artificial Intelligence, AAAI 2020, The Thirty-Second Innovative Applications of Artificial Intelligence Conference, IAAI 2020, The Tenth AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI 2020, New York, NY, USA, February 7-12, 2020</em>, pages 7432–7439. AAAI Press, 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.1609/aaai.v34i05.6239" title="">10.1609/aaai.v34i05.6239</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1609/aaai.v34i05.6239" title="">https://doi.org/10.1609/aaai.v34i05.6239</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Black et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Black, L.&nbsp;Gao, P.&nbsp;Wang, C.&nbsp;Leahy, and S.&nbsp;Biderman.

</span>
<span class="ltx_bibblock">GPT-Neo: Large Scale Autoregressive Language Modeling with Mesh-Tensorflow, Mar. 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.5281/zenodo.5297715" title="">https://doi.org/10.5281/zenodo.5297715</a>.

</span>
<span class="ltx_bibblock">If you use this misc, please cite it using these metadata.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
T.&nbsp;B. Brown, B.&nbsp;Mann, N.&nbsp;Ryder, M.&nbsp;Subbiah, J.&nbsp;Kaplan, P.&nbsp;Dhariwal, A.&nbsp;Neelakantan, P.&nbsp;Shyam, G.&nbsp;Sastry, A.&nbsp;Askell, S.&nbsp;Agarwal, A.&nbsp;Herbert-Voss, G.&nbsp;Krueger, T.&nbsp;Henighan, R.&nbsp;Child, A.&nbsp;Ramesh, D.&nbsp;M. Ziegler, J.&nbsp;Wu, C.&nbsp;Winter, C.&nbsp;Hesse, M.&nbsp;Chen, E.&nbsp;Sigler, M.&nbsp;Litwin, S.&nbsp;Gray, B.&nbsp;Chess, J.&nbsp;Clark, C.&nbsp;Berner, S.&nbsp;McCandlish, A.&nbsp;Radford, I.&nbsp;Sutskever, and D.&nbsp;Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper/2020/hash/1457c0d6bfcb4967418bfb8ac142f64a-Abstract.html" title="">https://proceedings.neurips.cc/paper/2020/hash/1457c0d6bfcb4967418bfb8ac142f64a-Abstract.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
M.&nbsp;Chen, J.&nbsp;Tworek, H.&nbsp;Jun, Q.&nbsp;Yuan, H.&nbsp;P. de&nbsp;Oliveira&nbsp;Pinto, J.&nbsp;Kaplan, H.&nbsp;Edwards, Y.&nbsp;Burda, N.&nbsp;Joseph, G.&nbsp;Brockman, A.&nbsp;Ray, R.&nbsp;Puri, G.&nbsp;Krueger, M.&nbsp;Petrov, H.&nbsp;Khlaaf, G.&nbsp;Sastry, P.&nbsp;Mishkin, B.&nbsp;Chan, S.&nbsp;Gray, N.&nbsp;Ryder, M.&nbsp;Pavlov, A.&nbsp;Power, L.&nbsp;Kaiser, M.&nbsp;Bavarian, C.&nbsp;Winter, P.&nbsp;Tillet, F.&nbsp;P. Such, D.&nbsp;Cummings, M.&nbsp;Plappert, F.&nbsp;Chantzis, E.&nbsp;Barnes, A.&nbsp;Herbert-Voss, W.&nbsp;H. Guss, A.&nbsp;Nichol, A.&nbsp;Paino, N.&nbsp;Tezak, J.&nbsp;Tang, I.&nbsp;Babuschkin, S.&nbsp;Balaji, S.&nbsp;Jain, W.&nbsp;Saunders, C.&nbsp;Hesse, A.&nbsp;N. Carr, J.&nbsp;Leike, J.&nbsp;Achiam, V.&nbsp;Misra, E.&nbsp;Morikawa, A.&nbsp;Radford, M.&nbsp;Knight, M.&nbsp;Brundage, M.&nbsp;Murati, K.&nbsp;Mayer, P.&nbsp;Welinder, B.&nbsp;McGrew, D.&nbsp;Amodei, S.&nbsp;McCandlish, I.&nbsp;Sutskever, and W.&nbsp;Zaremba.

</span>
<span class="ltx_bibblock">Evaluating large language models trained on code.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">CoRR</em>, abs/2107.03374, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2107.03374" title="">https://arxiv.org/abs/2107.03374</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
P.&nbsp;Clark, I.&nbsp;Cowhey, O.&nbsp;Etzioni, T.&nbsp;Khot, A.&nbsp;Sabharwal, C.&nbsp;Schoenick, and O.&nbsp;Tafjord.

</span>
<span class="ltx_bibblock">Think you have solved question answering? try arc, the AI2 reasoning challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">CoRR</em>, abs/1803.05457, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1803.05457" title="">http://arxiv.org/abs/1803.05457</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cobbe et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
K.&nbsp;Cobbe, V.&nbsp;Kosaraju, M.&nbsp;Bavarian, M.&nbsp;Chen, H.&nbsp;Jun, L.&nbsp;Kaiser, M.&nbsp;Plappert, J.&nbsp;Tworek, J.&nbsp;Hilton, R.&nbsp;Nakano, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training verifiers to solve math word problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2110.14168</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2022a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Dai, L.&nbsp;Dong, Y.&nbsp;Hao, Z.&nbsp;Sui, B.&nbsp;Chang, and F.&nbsp;Wei.

</span>
<span class="ltx_bibblock">Knowledge neurons in pretrained transformers.

</span>
<span class="ltx_bibblock">In S.&nbsp;Muresan, P.&nbsp;Nakov, and A.&nbsp;Villavicencio, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 8493–8502. Association for Computational Linguistics, 2022a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/V1/2022.ACL-LONG.581" title="">10.18653/V1/2022.ACL-LONG.581</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/2022.acl-long.581" title="">https://doi.org/10.18653/v1/2022.acl-long.581</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2022b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Dai, L.&nbsp;Dong, S.&nbsp;Ma, B.&nbsp;Zheng, Z.&nbsp;Sui, B.&nbsp;Chang, and F.&nbsp;Wei.

</span>
<span class="ltx_bibblock">Stablemoe: Stable routing strategy for mixture of experts.

</span>
<span class="ltx_bibblock">In S.&nbsp;Muresan, P.&nbsp;Nakov, and A.&nbsp;Villavicencio, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 7085–7095. Association for Computational Linguistics, 2022b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/V1/2022.ACL-LONG.489" title="">10.18653/V1/2022.ACL-LONG.489</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/2022.acl-long.489" title="">https://doi.org/10.18653/v1/2022.acl-long.489</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">DeepSeek-AI (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
DeepSeek-AI.

</span>
<span class="ltx_bibblock">Deepseek llm: Scaling open-source language models with longtermism.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2401.02954</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
N.&nbsp;Du, Y.&nbsp;Huang, A.&nbsp;M. Dai, S.&nbsp;Tong, D.&nbsp;Lepikhin, Y.&nbsp;Xu, M.&nbsp;Krikun, Y.&nbsp;Zhou, A.&nbsp;W. Yu, O.&nbsp;Firat, B.&nbsp;Zoph, L.&nbsp;Fedus, M.&nbsp;P. Bosma, Z.&nbsp;Zhou, T.&nbsp;Wang, Y.&nbsp;E. Wang, K.&nbsp;Webster, M.&nbsp;Pellat, K.&nbsp;Robinson, K.&nbsp;S. Meier-Hellstern, T.&nbsp;Duke, L.&nbsp;Dixon, K.&nbsp;Zhang, Q.&nbsp;V. Le, Y.&nbsp;Wu, Z.&nbsp;Chen, and C.&nbsp;Cui.

</span>
<span class="ltx_bibblock">Glam: Efficient scaling of language models with mixture-of-experts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">International Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</em>, volume 162 of <em class="ltx_emph ltx_font_italic" id="bib.bib14.2.2">Proceedings of Machine Learning Research</em>, pages 5547–5569. PMLR, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v162/du22c.html" title="">https://proceedings.mlr.press/v162/du22c.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dua et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Dua, Y.&nbsp;Wang, P.&nbsp;Dasigi, G.&nbsp;Stanovsky, S.&nbsp;Singh, and M.&nbsp;Gardner.

</span>
<span class="ltx_bibblock">DROP: A reading comprehension benchmark requiring discrete reasoning over paragraphs.

</span>
<span class="ltx_bibblock">In J.&nbsp;Burstein, C.&nbsp;Doran, and T.&nbsp;Solorio, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, NAACL-HLT 2019, Minneapolis, MN, USA, June 2-7, 2019, Volume 1 (Long and Short Papers)</em>, pages 2368–2378. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/V1/N19-1246" title="">10.18653/V1/N19-1246</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/n19-1246" title="">https://doi.org/10.18653/v1/n19-1246</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fedus et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
W.&nbsp;Fedus, B.&nbsp;Zoph, and N.&nbsp;Shazeer.

</span>
<span class="ltx_bibblock">Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">CoRR</em>, abs/2101.03961, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2101.03961" title="">https://arxiv.org/abs/2101.03961</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
L.&nbsp;Gao, S.&nbsp;Biderman, S.&nbsp;Black, L.&nbsp;Golding, T.&nbsp;Hoppe, C.&nbsp;Foster, J.&nbsp;Phang, H.&nbsp;He, A.&nbsp;Thite, N.&nbsp;Nabeshima, et&nbsp;al.

</span>
<span class="ltx_bibblock">The Pile: An 800GB dataset of diverse text for language modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2101.00027</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng and Liu (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
X.&nbsp;Geng and H.&nbsp;Liu.

</span>
<span class="ltx_bibblock">Openllama: An open reproduction of llama, May 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/openlm-research/open_llama" title="">https://github.com/openlm-research/open_llama</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harlap et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A.&nbsp;Harlap, D.&nbsp;Narayanan, A.&nbsp;Phanishayee, V.&nbsp;Seshadri, N.&nbsp;R. Devanur, G.&nbsp;R. Ganger, and P.&nbsp;B. Gibbons.

</span>
<span class="ltx_bibblock">Pipedream: Fast and efficient pipeline parallel DNN training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">CoRR</em>, abs/1806.03377, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1806.03377" title="">http://arxiv.org/abs/1806.03377</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Hendrycks, C.&nbsp;Burns, S.&nbsp;Basart, A.&nbsp;Zou, M.&nbsp;Mazeika, D.&nbsp;Song, and J.&nbsp;Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2009.03300</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Hendrycks, C.&nbsp;Burns, S.&nbsp;Kadavath, A.&nbsp;Arora, S.&nbsp;Basart, E.&nbsp;Tang, D.&nbsp;Song, and J.&nbsp;Steinhardt.

</span>
<span class="ltx_bibblock">Measuring mathematical problem solving with the math dataset, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">High-Flyer (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
High-Flyer.

</span>
<span class="ltx_bibblock">Hai-llm: An efficient and lightweight tool for training large models, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.high-flyer.cn/en/blog/hai-llm" title="">https://www.high-flyer.cn/en/blog/hai-llm</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter and Schmidhuber (1997)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Hochreiter and J.&nbsp;Schmidhuber.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Neural Computing</em>, 9(8):1735–1780, 1997.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1162/neco.1997.9.8.1735" title="">https://doi.org/10.1162/neco.1997.9.8.1735</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
J.&nbsp;Hoffmann, S.&nbsp;Borgeaud, A.&nbsp;Mensch, E.&nbsp;Buchatskaya, T.&nbsp;Cai, E.&nbsp;Rutherford, D.&nbsp;de&nbsp;Las&nbsp;Casas, L.&nbsp;A. Hendricks, J.&nbsp;Welbl, A.&nbsp;Clark, T.&nbsp;Hennigan, E.&nbsp;Noland, K.&nbsp;Millican, G.&nbsp;van&nbsp;den Driessche, B.&nbsp;Damoc, A.&nbsp;Guy, S.&nbsp;Osindero, K.&nbsp;Simonyan, E.&nbsp;Elsen, J.&nbsp;W. Rae, O.&nbsp;Vinyals, and L.&nbsp;Sifre.

</span>
<span class="ltx_bibblock">Training compute-optimal large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">CoRR</em>, abs/2203.15556, 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.48550/arXiv.2203.15556" title="">10.48550/arXiv.2203.15556</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2203.15556" title="">https://doi.org/10.48550/arXiv.2203.15556</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Y.&nbsp;Huang, Y.&nbsp;Bai, Z.&nbsp;Zhu, J.&nbsp;Zhang, J.&nbsp;Zhang, T.&nbsp;Su, J.&nbsp;Liu, C.&nbsp;Lv, Y.&nbsp;Zhang, J.&nbsp;Lei, et&nbsp;al.

</span>
<span class="ltx_bibblock">C-Eval: A multi-level multi-discipline chinese evaluation suite for foundation models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2305.08322</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jacobs et&nbsp;al. (1991)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;A. Jacobs, M.&nbsp;I. Jordan, S.&nbsp;J. Nowlan, and G.&nbsp;E. Hinton.

</span>
<span class="ltx_bibblock">Adaptive mixtures of local experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Neural Computing</em>, 3(1):79–87, 1991.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1162/neco.1991.3.1.79" title="">https://doi.org/10.1162/neco.1991.3.1.79</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jordan and Jacobs (1994)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
M.&nbsp;I. Jordan and R.&nbsp;A. Jacobs.

</span>
<span class="ltx_bibblock">Hierarchical mixtures of experts and the EM algorithm.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Neural Computing</em>, 6(2):181–214, 1994.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1162/neco.1994.6.2.181" title="">https://doi.org/10.1162/neco.1994.6.2.181</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
M.&nbsp;Joshi, E.&nbsp;Choi, D.&nbsp;Weld, and L.&nbsp;Zettlemoyer.

</span>
<span class="ltx_bibblock">triviaqa: A Large Scale Distantly Supervised Challenge Dataset for Reading Comprehension.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv e-prints</em>, art. arXiv:1705.03551, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Korthikanti et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
V.&nbsp;A. Korthikanti, J.&nbsp;Casper, S.&nbsp;Lym, L.&nbsp;McAfee, M.&nbsp;Andersch, M.&nbsp;Shoeybi, and B.&nbsp;Catanzaro.

</span>
<span class="ltx_bibblock">Reducing activation recomputation in large transformer models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of Machine Learning and Systems</em>, 5, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
T.&nbsp;Kwiatkowski, J.&nbsp;Palomaki, O.&nbsp;Redfield, M.&nbsp;Collins, A.&nbsp;Parikh, C.&nbsp;Alberti, D.&nbsp;Epstein, I.&nbsp;Polosukhin, M.&nbsp;Kelcey, J.&nbsp;Devlin, K.&nbsp;Lee, K.&nbsp;N. Toutanova, L.&nbsp;Jones, M.-W. Chang, A.&nbsp;Dai, J.&nbsp;Uszkoreit, Q.&nbsp;Le, and S.&nbsp;Petrov.

</span>
<span class="ltx_bibblock">Natural questions: a benchmark for question answering research.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Transactions of the Association of Computational Linguistics</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lai et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
G.&nbsp;Lai, Q.&nbsp;Xie, H.&nbsp;Liu, Y.&nbsp;Yang, and E.&nbsp;H. Hovy.

</span>
<span class="ltx_bibblock">RACE: large-scale reading comprehension dataset from examinations.

</span>
<span class="ltx_bibblock">In M.&nbsp;Palmer, R.&nbsp;Hwa, and S.&nbsp;Riedel, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing, EMNLP 2017, Copenhagen, Denmark, September 9-11, 2017</em>, pages 785–794. Association for Computational Linguistics, 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/V1/D17-1082" title="">10.18653/V1/D17-1082</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/d17-1082" title="">https://doi.org/10.18653/v1/d17-1082</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lepikhin et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Lepikhin, H.&nbsp;Lee, Y.&nbsp;Xu, D.&nbsp;Chen, O.&nbsp;Firat, Y.&nbsp;Huang, M.&nbsp;Krikun, N.&nbsp;Shazeer, and Z.&nbsp;Chen.

</span>
<span class="ltx_bibblock">Gshard: Scaling giant models with conditional computation and automatic sharding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">9th International Conference on Learning Representations, ICLR 2021</em>. OpenReview.net, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=qrwe7XHTmYb" title="">https://openreview.net/forum?id=qrwe7XHTmYb</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
H.&nbsp;Li, Y.&nbsp;Zhang, F.&nbsp;Koto, Y.&nbsp;Yang, H.&nbsp;Zhao, Y.&nbsp;Gong, N.&nbsp;Duan, and T.&nbsp;Baldwin.

</span>
<span class="ltx_bibblock">CMMLU: Measuring massive multitask language understanding in Chinese.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2306.09212</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
J.&nbsp;Lin, R.&nbsp;Men, A.&nbsp;Yang, C.&nbsp;Zhou, M.&nbsp;Ding, Y.&nbsp;Zhang, P.&nbsp;Wang, A.&nbsp;Wang, L.&nbsp;Jiang, X.&nbsp;Jia, J.&nbsp;Zhang, J.&nbsp;Zhang, X.&nbsp;Zou, Z.&nbsp;Li, X.&nbsp;Deng, J.&nbsp;Liu, J.&nbsp;Xue, H.&nbsp;Zhou, J.&nbsp;Ma, J.&nbsp;Yu, Y.&nbsp;Li, W.&nbsp;Lin, J.&nbsp;Zhou, J.&nbsp;Tang, and H.&nbsp;Yang.

</span>
<span class="ltx_bibblock">M6: A chinese multimodal pretrainer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">CoRR</em>, abs/2103.00823, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2103.00823" title="">https://arxiv.org/abs/2103.00823</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Lin, J.&nbsp;Hilton, and O.&nbsp;Evans.

</span>
<span class="ltx_bibblock">Truthfulqa: Measuring how models mimic human falsehoods.

</span>
<span class="ltx_bibblock">In S.&nbsp;Muresan, P.&nbsp;Nakov, and A.&nbsp;Villavicencio, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 3214–3252. Association for Computational Linguistics, 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/V1/2022.ACL-LONG.229" title="">10.18653/V1/2022.ACL-LONG.229</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/2022.acl-long.229" title="">https://doi.org/10.18653/v1/2022.acl-long.229</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
I.&nbsp;Loshchilov and F.&nbsp;Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">7th International Conference on Learning Representations, ICLR 2019, New Orleans, LA, USA, May 6-9, 2019</em>. OpenReview.net, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=Bkg6RiCqY7" title="">https://openreview.net/forum?id=Bkg6RiCqY7</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayanan et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Narayanan, M.&nbsp;Shoeybi, J.&nbsp;Casper, P.&nbsp;LeGresley, M.&nbsp;Patwary, V.&nbsp;Korthikanti, D.&nbsp;Vainbrand, P.&nbsp;Kashinkunti, J.&nbsp;Bernauer, B.&nbsp;Catanzaro, et&nbsp;al.

</span>
<span class="ltx_bibblock">Efficient large-scale language model training on gpu clusters using megatron-lm.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the International Conference for High Performance Computing, Networking, Storage and Analysis</em>, pages 1–15, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">GPT-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">CoRR</em>, abs/2303.08774, 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.48550/arXiv.2303.08774" title="">10.48550/arXiv.2303.08774</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2303.08774" title="">https://doi.org/10.48550/arXiv.2303.08774</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajbhandari et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Rajbhandari, J.&nbsp;Rasley, O.&nbsp;Ruwase, and Y.&nbsp;He.

</span>
<span class="ltx_bibblock">Zero: memory optimizations toward training trillion parameter models.

</span>
<span class="ltx_bibblock">In C.&nbsp;Cuicchi, I.&nbsp;Qualters, and W.&nbsp;T. Kramer, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the International Conference for High Performance Computing, Networking, Storage and Analysis, SC 2020, Virtual Event / Atlanta, Georgia, USA, November 9-19, 2020</em>, page&nbsp;20. IEEE/ACM, 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.1109/SC41405.2020.00024" title="">10.1109/SC41405.2020.00024</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/SC41405.2020.00024" title="">https://doi.org/10.1109/SC41405.2020.00024</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajbhandari et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Rajbhandari, C.&nbsp;Li, Z.&nbsp;Yao, M.&nbsp;Zhang, R.&nbsp;Y. Aminabadi, A.&nbsp;A. Awan, J.&nbsp;Rasley, and Y.&nbsp;He.

</span>
<span class="ltx_bibblock">Deepspeed-moe: Advancing mixture-of-experts inference and training to power next-generation AI scale.

</span>
<span class="ltx_bibblock">In K.&nbsp;Chaudhuri, S.&nbsp;Jegelka, L.&nbsp;Song, C.&nbsp;Szepesvári, G.&nbsp;Niu, and S.&nbsp;Sabato, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">International Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</em>, volume 162 of <em class="ltx_emph ltx_font_italic" id="bib.bib40.2.2">Proceedings of Machine Learning Research</em>, pages 18332–18346. PMLR, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v162/rajbhandari22a.html" title="">https://proceedings.mlr.press/v162/rajbhandari22a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
X.&nbsp;Ren, P.&nbsp;Zhou, X.&nbsp;Meng, X.&nbsp;Huang, Y.&nbsp;Wang, W.&nbsp;Wang, P.&nbsp;Li, X.&nbsp;Zhang, A.&nbsp;Podolskiy, G.&nbsp;Arshinov, A.&nbsp;Bout, I.&nbsp;Piontkovskaya, J.&nbsp;Wei, X.&nbsp;Jiang, T.&nbsp;Su, Q.&nbsp;Liu, and J.&nbsp;Yao.

</span>
<span class="ltx_bibblock">Pangu-<math alttext="\Sigma" class="ltx_Math" display="inline" id="bib.bib41.1.m1.1"><semantics id="bib.bib41.1.m1.1a"><mi id="bib.bib41.1.m1.1.1" mathvariant="normal" xref="bib.bib41.1.m1.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="bib.bib41.1.m1.1b"><ci id="bib.bib41.1.m1.1.1.cmml" xref="bib.bib41.1.m1.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib41.1.m1.1c">\Sigma</annotation><annotation encoding="application/x-llamapun" id="bib.bib41.1.m1.1d">roman_Σ</annotation></semantics></math>: Towards trillion parameter language model with sparse heterogeneous computing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.2.1">CoRR</em>, abs/2303.10845, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2303.10845" title="">https://doi.org/10.48550/arXiv.2303.10845</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roller et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Roller, S.&nbsp;Sukhbaatar, A.&nbsp;Szlam, and J.&nbsp;Weston.

</span>
<span class="ltx_bibblock">Hash layers for large sparse models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">CoRR</em>, abs/2106.04426, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2106.04426" title="">https://arxiv.org/abs/2106.04426</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakaguchi et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
K.&nbsp;Sakaguchi, R.&nbsp;L. Bras, C.&nbsp;Bhagavatula, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">Winogrande: An adversarial winograd schema challenge at scale, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Scao et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
T.&nbsp;L. Scao, A.&nbsp;Fan, C.&nbsp;Akiki, E.&nbsp;Pavlick, S.&nbsp;Ilic, D.&nbsp;Hesslow, R.&nbsp;Castagné, A.&nbsp;S. Luccioni, F.&nbsp;Yvon, M.&nbsp;Gallé, J.&nbsp;Tow, A.&nbsp;M. Rush, S.&nbsp;Biderman, A.&nbsp;Webson, P.&nbsp;S. Ammanamanchi, T.&nbsp;Wang, B.&nbsp;Sagot, N.&nbsp;Muennighoff, A.&nbsp;V. del Moral, O.&nbsp;Ruwase, R.&nbsp;Bawden, S.&nbsp;Bekman, A.&nbsp;McMillan-Major, I.&nbsp;Beltagy, H.&nbsp;Nguyen, L.&nbsp;Saulnier, S.&nbsp;Tan, P.&nbsp;O. Suarez, V.&nbsp;Sanh, H.&nbsp;Laurençon, Y.&nbsp;Jernite, J.&nbsp;Launay, M.&nbsp;Mitchell, C.&nbsp;Raffel, A.&nbsp;Gokaslan, A.&nbsp;Simhi, A.&nbsp;Soroa, A.&nbsp;F. Aji, A.&nbsp;Alfassy, A.&nbsp;Rogers, A.&nbsp;K. Nitzav, C.&nbsp;Xu, C.&nbsp;Mou, C.&nbsp;Emezue, C.&nbsp;Klamm, C.&nbsp;Leong, D.&nbsp;van Strien, D.&nbsp;I. Adelani, and et&nbsp;al.

</span>
<span class="ltx_bibblock">BLOOM: A 176b-parameter open-access multilingual language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">CoRR</em>, abs/2211.05100, 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.48550/ARXIV.2211.05100" title="">10.48550/ARXIV.2211.05100</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2211.05100" title="">https://doi.org/10.48550/arXiv.2211.05100</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;Sennrich, B.&nbsp;Haddow, and A.&nbsp;Birch.

</span>
<span class="ltx_bibblock">Neural machine translation of rare words with subword units.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics, ACL 2016, August 7-12, 2016, Berlin, Germany, Volume 1: Long Papers</em>. The Association for Computer Linguistics, 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/V1/P16-1162" title="">10.18653/V1/P16-1162</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/p16-1162" title="">https://doi.org/10.18653/v1/p16-1162</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
N.&nbsp;Shazeer.

</span>
<span class="ltx_bibblock">Fast transformer decoding: One write-head is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">CoRR</em>, abs/1911.02150, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1911.02150" title="">http://arxiv.org/abs/1911.02150</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
N.&nbsp;Shazeer, A.&nbsp;Mirhoseini, K.&nbsp;Maziarz, A.&nbsp;Davis, Q.&nbsp;V. Le, G.&nbsp;E. Hinton, and J.&nbsp;Dean.

</span>
<span class="ltx_bibblock">Outrageously large neural networks: The sparsely-gated mixture-of-experts layer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">5th International Conference on Learning Representations, ICLR 2017</em>. OpenReview.net, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=B1ckMDqlg" title="">https://openreview.net/forum?id=B1ckMDqlg</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Shen, L.&nbsp;Hou, Y.&nbsp;Zhou, N.&nbsp;Du, S.&nbsp;Longpre, J.&nbsp;Wei, H.&nbsp;W. Chung, B.&nbsp;Zoph, W.&nbsp;Fedus, X.&nbsp;Chen, T.&nbsp;Vu, Y.&nbsp;Wu, W.&nbsp;Chen, A.&nbsp;Webson, Y.&nbsp;Li, V.&nbsp;Zhao, H.&nbsp;Yu, K.&nbsp;Keutzer, T.&nbsp;Darrell, and D.&nbsp;Zhou.

</span>
<span class="ltx_bibblock">Flan-moe: Scaling instruction-finetuned language models with sparse mixture of experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">CoRR</em>, abs/2305.14705, 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.48550/ARXIV.2305.14705" title="">10.48550/ARXIV.2305.14705</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2305.14705" title="">https://doi.org/10.48550/arXiv.2305.14705</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shoeybi et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
M.&nbsp;Shoeybi, M.&nbsp;Patwary, R.&nbsp;Puri, P.&nbsp;LeGresley, J.&nbsp;Casper, and B.&nbsp;Catanzaro.

</span>
<span class="ltx_bibblock">Megatron-lm: Training multi-billion parameter language models using model parallelism.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">arXiv preprint arXiv:1909.08053</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suzgun et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
M.&nbsp;Suzgun, N.&nbsp;Scales, N.&nbsp;Schärli, S.&nbsp;Gehrmann, Y.&nbsp;Tay, H.&nbsp;W. Chung, A.&nbsp;Chowdhery, Q.&nbsp;V. Le, E.&nbsp;H. Chi, D.&nbsp;Zhou, et&nbsp;al.

</span>
<span class="ltx_bibblock">Challenging big-bench tasks and whether chain-of-thought can solve them.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:2210.09261</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tillet et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
P.&nbsp;Tillet, H.&nbsp;T. Kung, and D.&nbsp;Cox.

</span>
<span class="ltx_bibblock">Triton: An intermediate language and compiler for tiled neural network computations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of the 3rd ACM SIGPLAN International Workshop on Machine Learning and Programming Languages</em>, MAPL 2019, page 10–19, New York, NY, USA, 2019. Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450367196.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.1145/3315508.3329973" title="">10.1145/3315508.3329973</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3315508.3329973" title="">https://doi.org/10.1145/3315508.3329973</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Together-AI (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Together-AI.

</span>
<span class="ltx_bibblock">Redpajama-data: An open source recipe to reproduce llama training dataset, April 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/togethercomputer/RedPajama-Data" title="">https://github.com/togethercomputer/RedPajama-Data</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
H.&nbsp;Touvron, T.&nbsp;Lavril, G.&nbsp;Izacard, X.&nbsp;Martinet, M.&nbsp;Lachaux, T.&nbsp;Lacroix, B.&nbsp;Rozière, N.&nbsp;Goyal, E.&nbsp;Hambro, F.&nbsp;Azhar, A.&nbsp;Rodriguez, A.&nbsp;Joulin, E.&nbsp;Grave, and G.&nbsp;Lample.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">CoRR</em>, abs/2302.13971, 2023a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.48550/arXiv.2302.13971" title="">10.48550/arXiv.2302.13971</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2302.13971" title="">https://doi.org/10.48550/arXiv.2302.13971</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
H.&nbsp;Touvron, L.&nbsp;Martin, K.&nbsp;Stone, P.&nbsp;Albert, A.&nbsp;Almahairi, Y.&nbsp;Babaei, N.&nbsp;Bashlykov, S.&nbsp;Batra, P.&nbsp;Bhargava, S.&nbsp;Bhosale, D.&nbsp;Bikel, L.&nbsp;Blecher, C.&nbsp;Canton-Ferrer, M.&nbsp;Chen, G.&nbsp;Cucurull, D.&nbsp;Esiobu, J.&nbsp;Fernandes, J.&nbsp;Fu, W.&nbsp;Fu, B.&nbsp;Fuller, C.&nbsp;Gao, V.&nbsp;Goswami, N.&nbsp;Goyal, A.&nbsp;Hartshorn, S.&nbsp;Hosseini, R.&nbsp;Hou, H.&nbsp;Inan, M.&nbsp;Kardas, V.&nbsp;Kerkez, M.&nbsp;Khabsa, I.&nbsp;Kloumann, A.&nbsp;Korenev, P.&nbsp;S. Koura, M.&nbsp;Lachaux, T.&nbsp;Lavril, J.&nbsp;Lee, D.&nbsp;Liskovich, Y.&nbsp;Lu, Y.&nbsp;Mao, X.&nbsp;Martinet, T.&nbsp;Mihaylov, P.&nbsp;Mishra, I.&nbsp;Molybog, Y.&nbsp;Nie, A.&nbsp;Poulton, J.&nbsp;Reizenstein, R.&nbsp;Rungta, K.&nbsp;Saladi, A.&nbsp;Schelten, R.&nbsp;Silva, E.&nbsp;M. Smith, R.&nbsp;Subramanian, X.&nbsp;E. Tan, B.&nbsp;Tang, R.&nbsp;Taylor, A.&nbsp;Williams, J.&nbsp;X. Kuan, P.&nbsp;Xu, Z.&nbsp;Yan, I.&nbsp;Zarov, Y.&nbsp;Zhang, A.&nbsp;Fan, M.&nbsp;Kambadur, S.&nbsp;Narang, A.&nbsp;Rodriguez, R.&nbsp;Stojnic, S.&nbsp;Edunov, and T.&nbsp;Scialom.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">CoRR</em>, abs/2307.09288, 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.48550/arXiv.2307.09288" title="">10.48550/arXiv.2307.09288</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2307.09288" title="">https://doi.org/10.48550/arXiv.2307.09288</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A.&nbsp;Vaswani, N.&nbsp;Shazeer, N.&nbsp;Parmar, J.&nbsp;Uszkoreit, L.&nbsp;Jones, A.&nbsp;N. Gomez, L.&nbsp;Kaiser, and I.&nbsp;Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">Advances in Neural Information Processing Systems 30: Annual Conference on Neural Information Processing Systems 2017</em>, pages 5998–6008, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" title="">https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Komatsuzaki (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
B.&nbsp;Wang and A.&nbsp;Komatsuzaki.

</span>
<span class="ltx_bibblock">GPT-J-6B: A 6 Billion Parameter Autoregressive Language Model.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/kingoflolz/mesh-transformer-jax" title="">https://github.com/kingoflolz/mesh-transformer-jax</a>, May 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
L.&nbsp;Xu, H.&nbsp;Hu, X.&nbsp;Zhang, L.&nbsp;Li, C.&nbsp;Cao, Y.&nbsp;Li, Y.&nbsp;Xu, K.&nbsp;Sun, D.&nbsp;Yu, C.&nbsp;Yu, Y.&nbsp;Tian, Q.&nbsp;Dong, W.&nbsp;Liu, B.&nbsp;Shi, Y.&nbsp;Cui, J.&nbsp;Li, J.&nbsp;Zeng, R.&nbsp;Wang, W.&nbsp;Xie, Y.&nbsp;Li, Y.&nbsp;Patterson, Z.&nbsp;Tian, Y.&nbsp;Zhang, H.&nbsp;Zhou, S.&nbsp;Liu, Z.&nbsp;Zhao, Q.&nbsp;Zhao, C.&nbsp;Yue, X.&nbsp;Zhang, Z.&nbsp;Yang, K.&nbsp;Richardson, and Z.&nbsp;Lan.

</span>
<span class="ltx_bibblock">CLUE: A chinese language understanding evaluation benchmark.

</span>
<span class="ltx_bibblock">In D.&nbsp;Scott, N.&nbsp;Bel, and C.&nbsp;Zong, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">Proceedings of the 28th International Conference on Computational Linguistics, COLING 2020, Barcelona, Spain (Online), December 8-13, 2020</em>, pages 4762–4772. International Committee on Computational Linguistics, 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/V1/2020.COLING-MAIN.419" title="">10.18653/V1/2020.COLING-MAIN.419</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/2020.coling-main.419" title="">https://doi.org/10.18653/v1/2020.coling-main.419</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xue et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
F.&nbsp;Xue, Z.&nbsp;Zheng, Y.&nbsp;Fu, J.&nbsp;Ni, Z.&nbsp;Zheng, W.&nbsp;Zhou, and Y.&nbsp;You.

</span>
<span class="ltx_bibblock">Openmoe: Open mixture-of-experts language models.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/XueFuzhao/OpenMoE" title="">https://github.com/XueFuzhao/OpenMoE</a>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;Zellers, A.&nbsp;Holtzman, Y.&nbsp;Bisk, A.&nbsp;Farhadi, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">HellaSwag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock">In A.&nbsp;Korhonen, D.&nbsp;R. Traum, and L.&nbsp;Màrquez, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">Proceedings of the 57th Conference of the Association for Computational Linguistics, ACL 2019, Florence, Italy, July 28- August 2, 2019, Volume 1: Long Papers</em>, pages 4791–4800. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/v1/p19-1472" title="">10.18653/v1/p19-1472</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/p19-1472" title="">https://doi.org/10.18653/v1/p19-1472</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Zhang, S.&nbsp;Roller, N.&nbsp;Goyal, M.&nbsp;Artetxe, M.&nbsp;Chen, S.&nbsp;Chen, C.&nbsp;Dewan, M.&nbsp;Diab, X.&nbsp;Li, X.&nbsp;V. Lin, T.&nbsp;Mihaylov, M.&nbsp;Ott, S.&nbsp;Shleifer, K.&nbsp;Shuster, D.&nbsp;Simig, P.&nbsp;S. Koura, A.&nbsp;Sridhar, T.&nbsp;Wang, and L.&nbsp;Zettlemoyer.

</span>
<span class="ltx_bibblock">Opt: Open pre-trained transformer language models, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
C.&nbsp;Zheng, M.&nbsp;Huang, and A.&nbsp;Sun.

</span>
<span class="ltx_bibblock">Chid: A large-scale chinese idiom dataset for cloze test.

</span>
<span class="ltx_bibblock">In A.&nbsp;Korhonen, D.&nbsp;R. Traum, and L.&nbsp;Màrquez, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Proceedings of the 57th Conference of the Association for Computational Linguistics, ACL 2019, Florence, Italy, July 28- August 2, 2019, Volume 1: Long Papers</em>, pages 778–787. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/V1/P19-1075" title="">10.18653/V1/P19-1075</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/p19-1075" title="">https://doi.org/10.18653/v1/p19-1075</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Y.&nbsp;Zhou, T.&nbsp;Lei, H.&nbsp;Liu, N.&nbsp;Du, Y.&nbsp;Huang, V.&nbsp;Zhao, A.&nbsp;M. Dai, Z.&nbsp;Chen, Q.&nbsp;V. Le, and J.&nbsp;Laudon.

</span>
<span class="ltx_bibblock">Mixture-of-experts with expert choice routing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">NeurIPS</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://papers.nips.cc/paper_files/paper/2022/hash/2f00ecd787b432c1d36f3de9800728eb-Abstract-Conference.html" title="">http://papers.nips.cc/paper_files/paper/2022/hash/2f00ecd787b432c1d36f3de9800728eb-Abstract-Conference.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zoph (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
B.&nbsp;Zoph.

</span>
<span class="ltx_bibblock">Designing effective sparse expert models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">IEEE International Parallel and Distributed Processing Symposium, IPDPS Workshops 2022, Lyon, France, May 30 - June 3, 2022</em>, page 1044. IEEE, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/IPDPSW55747.2022.00171" title="">https://doi.org/10.1109/IPDPSW55747.2022.00171</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1" lang="en">
<h2 class="ltx_title ltx_title_appendix">Appendices</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A1" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Overview of Hyper-Parameters</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">We present the overview of hyper-parameters for DeepSeekMoE across various sizes in Table&nbsp;<a class="ltx_ref" href="#A1.T7" title="Table 7 ‣ Appendix A Overview of Hyper-Parameters ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A1.T7">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T7.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.1.1" style="font-size:80%;"># Params</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.2.1" style="font-size:80%;"># Layers</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.3.1" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="A1.T7.1.1.1.3.1.1">
<span class="ltx_tr" id="A1.T7.1.1.1.3.1.1.1">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.3.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">Hidden</span></span>
<span class="ltx_tr" id="A1.T7.1.1.1.3.1.1.2">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.3.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Size</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.4.1" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="A1.T7.1.1.1.4.1.1">
<span class="ltx_tr" id="A1.T7.1.1.1.4.1.1.1">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.4.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"># Attn</span></span>
<span class="ltx_tr" id="A1.T7.1.1.1.4.1.1.2">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.4.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Heads</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.5.1" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="A1.T7.1.1.1.5.1.1">
<span class="ltx_tr" id="A1.T7.1.1.1.5.1.1.1">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.5.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"># Shared</span></span>
<span class="ltx_tr" id="A1.T7.1.1.1.5.1.1.2">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.5.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Experts</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.6.1" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="A1.T7.1.1.1.6.1.1">
<span class="ltx_tr" id="A1.T7.1.1.1.6.1.1.1">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.6.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"># Routed</span></span>
<span class="ltx_tr" id="A1.T7.1.1.1.6.1.1.2">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.6.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Experts</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.7.1" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="A1.T7.1.1.1.7.1.1">
<span class="ltx_tr" id="A1.T7.1.1.1.7.1.1.1">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.7.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">Relative</span></span>
<span class="ltx_tr" id="A1.T7.1.1.1.7.1.1.2">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.7.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Expert Size</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.8" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.8.1" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="A1.T7.1.1.1.8.1.1">
<span class="ltx_tr" id="A1.T7.1.1.1.8.1.1.1">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.8.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">Sequence</span></span>
<span class="ltx_tr" id="A1.T7.1.1.1.8.1.1.2">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.8.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Length</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.9" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.9.1" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="A1.T7.1.1.1.9.1.1">
<span class="ltx_tr" id="A1.T7.1.1.1.9.1.1.1">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.9.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">Batch Size</span></span>
<span class="ltx_tr" id="A1.T7.1.1.1.9.1.1.2">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.9.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">(Sequence)</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.10" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.1.1.10.1" style="font-size:80%;">
<span class="ltx_tabular ltx_align_middle" id="A1.T7.1.1.1.10.1.1">
<span class="ltx_tr" id="A1.T7.1.1.1.10.1.1.1">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.10.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">Learning</span></span>
<span class="ltx_tr" id="A1.T7.1.1.1.10.1.1.2">
<span class="ltx_td ltx_align_center" id="A1.T7.1.1.1.10.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Rate</span></span>
</span></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T7.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.1.1" style="font-size:80%;">&nbsp;&nbsp;&nbsp;&nbsp;2.0B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.2.1" style="font-size:80%;">9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.3.1" style="font-size:80%;">1280</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.4.1" style="font-size:80%;">10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.5.1" style="font-size:80%;">1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.6.1" style="font-size:80%;">63 (7 activated)</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.7.1" style="font-size:80%;">0.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.8" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.8.1" style="font-size:80%;">2048</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.9" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.9.1" style="font-size:80%;">2048</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.10" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.2.1.10.1" style="font-size:80%;">1.08e-3</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.3.2">
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.1.1" style="font-size:80%;">&nbsp;&nbsp;16.4B</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.2.1" style="font-size:80%;">28</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.3.1" style="font-size:80%;">2048</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.4.1" style="font-size:80%;">16</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.5.1" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.6.1" style="font-size:80%;">64 (6 activated)</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.7.1" style="font-size:80%;">0.25</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.8" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.8.1" style="font-size:80%;">4096</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.9" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.9.1" style="font-size:80%;">4608</span></td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.10" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.3.2.10.1" style="font-size:80%;">&nbsp;&nbsp;4.2e-4</span></td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.1.1" style="font-size:80%;">144.6B</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.2.1" style="font-size:80%;">62</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.3.1" style="font-size:80%;">4096</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.4.1" style="font-size:80%;">32</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.5.1" style="font-size:80%;">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.6.1" style="font-size:80%;">128 (12 activated)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.7.1" style="font-size:80%;">0.125</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.8" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.8.1" style="font-size:80%;">4096</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.9" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.9.1" style="font-size:80%;">4608</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.4.3.10" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A1.T7.1.4.3.10.1" style="font-size:80%;">&nbsp;&nbsp;3.0e-4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 7: </span>
Overview of hyper-parameters for DeepSeekMoE across various sizes.
The relative expert size is in comparison to a standard FFN.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A2" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Comparing DeepSeekMoE with Larger Models</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.4">Comparisons among DeepSeekMoE, GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="A2.p1.1.m1.1"><semantics id="A2.p1.1.m1.1a"><mrow id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mi id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml"></mi><mo id="A2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p1.1.m1.1.1.1.cmml">×</mo><mn id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><times id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2">absent</csymbol><cn id="A2.p1.1.m1.1.1.3.cmml" type="float" xref="A2.p1.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">\times 1.2</annotation><annotation encoding="application/x-llamapun" id="A2.p1.1.m1.1d">× 1.2</annotation></semantics></math>, and GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="A2.p1.2.m2.1"><semantics id="A2.p1.2.m2.1a"><mrow id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mi id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml"></mi><mo id="A2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p1.2.m2.1.1.1.cmml">×</mo><mn id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><times id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2">absent</csymbol><cn id="A2.p1.2.m2.1.1.3.cmml" type="float" xref="A2.p1.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="A2.p1.2.m2.1d">× 1.5</annotation></semantics></math> are shown in Table&nbsp;<a class="ltx_ref" href="#A2.T8" title="Table 8 ‣ Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">8</span></a>.
Comparisons among DeepSeekMoE, Dense<math alttext="\times 4" class="ltx_Math" display="inline" id="A2.p1.3.m3.1"><semantics id="A2.p1.3.m3.1a"><mrow id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml"><mi id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml"></mi><mo id="A2.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p1.3.m3.1.1.1.cmml">×</mo><mn id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1"><times id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1.1"></times><csymbol cd="latexml" id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2">absent</csymbol><cn id="A2.p1.3.m3.1.1.3.cmml" type="integer" xref="A2.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">\times 4</annotation><annotation encoding="application/x-llamapun" id="A2.p1.3.m3.1d">× 4</annotation></semantics></math>, and Dense<math alttext="\times 16" class="ltx_Math" display="inline" id="A2.p1.4.m4.1"><semantics id="A2.p1.4.m4.1a"><mrow id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml"><mi id="A2.p1.4.m4.1.1.2" xref="A2.p1.4.m4.1.1.2.cmml"></mi><mo id="A2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p1.4.m4.1.1.1.cmml">×</mo><mn id="A2.p1.4.m4.1.1.3" xref="A2.p1.4.m4.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><apply id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1"><times id="A2.p1.4.m4.1.1.1.cmml" xref="A2.p1.4.m4.1.1.1"></times><csymbol cd="latexml" id="A2.p1.4.m4.1.1.2.cmml" xref="A2.p1.4.m4.1.1.2">absent</csymbol><cn id="A2.p1.4.m4.1.1.3.cmml" type="integer" xref="A2.p1.4.m4.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">\times 16</annotation><annotation encoding="application/x-llamapun" id="A2.p1.4.m4.1d">× 16</annotation></semantics></math> are shown in Table&nbsp;<a class="ltx_ref" href="#A2.T9" title="Table 9 ‣ Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">9</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A2.T8">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T8.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T8.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A2.T8.2.2.3" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.2.3.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A2.T8.2.2.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.2.4.1"># Shot</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.1.1.1" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.1">GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="A2.T8.1.1.1.1.m1.1"><semantics id="A2.T8.1.1.1.1.m1.1a"><mrow id="A2.T8.1.1.1.1.m1.1.1" xref="A2.T8.1.1.1.1.m1.1.1.cmml"><mi id="A2.T8.1.1.1.1.m1.1.1.2" xref="A2.T8.1.1.1.1.m1.1.1.2.cmml"></mi><mo id="A2.T8.1.1.1.1.m1.1.1.1" lspace="0.222em" mathvariant="normal" rspace="0.222em" xref="A2.T8.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A2.T8.1.1.1.1.m1.1.1.3" mathvariant="normal" xref="A2.T8.1.1.1.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T8.1.1.1.1.m1.1b"><apply id="A2.T8.1.1.1.1.m1.1.1.cmml" xref="A2.T8.1.1.1.1.m1.1.1"><times id="A2.T8.1.1.1.1.m1.1.1.1.cmml" xref="A2.T8.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T8.1.1.1.1.m1.1.1.2.cmml" xref="A2.T8.1.1.1.1.m1.1.1.2">absent</csymbol><cn id="A2.T8.1.1.1.1.m1.1.1.3.cmml" type="float" xref="A2.T8.1.1.1.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T8.1.1.1.1.m1.1c">\times 1.2</annotation><annotation encoding="application/x-llamapun" id="A2.T8.1.1.1.1.m1.1d">× 1.2</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.2.2.2" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.2.2.1">GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="A2.T8.2.2.2.1.m1.1"><semantics id="A2.T8.2.2.2.1.m1.1a"><mrow id="A2.T8.2.2.2.1.m1.1.1" xref="A2.T8.2.2.2.1.m1.1.1.cmml"><mi id="A2.T8.2.2.2.1.m1.1.1.2" xref="A2.T8.2.2.2.1.m1.1.1.2.cmml"></mi><mo id="A2.T8.2.2.2.1.m1.1.1.1" lspace="0.222em" mathvariant="normal" rspace="0.222em" xref="A2.T8.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A2.T8.2.2.2.1.m1.1.1.3" mathvariant="normal" xref="A2.T8.2.2.2.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T8.2.2.2.1.m1.1b"><apply id="A2.T8.2.2.2.1.m1.1.1.cmml" xref="A2.T8.2.2.2.1.m1.1.1"><times id="A2.T8.2.2.2.1.m1.1.1.1.cmml" xref="A2.T8.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T8.2.2.2.1.m1.1.1.2.cmml" xref="A2.T8.2.2.2.1.m1.1.1.2">absent</csymbol><cn id="A2.T8.2.2.2.1.m1.1.1.3.cmml" type="float" xref="A2.T8.2.2.2.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T8.2.2.2.1.m1.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="A2.T8.2.2.2.1.m1.1d">× 1.5</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.2.2.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.2.5.1">DeepSeekMoE</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T8.2.3.1.1" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T8.2.3.1.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.3.1.3" style="padding-left:8.0pt;padding-right:8.0pt;">1.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.3.1.4" style="padding-left:8.0pt;padding-right:8.0pt;">1.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.3.1.5" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.4.2.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.4.2.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.4.2.3" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.4.2.4" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.4.2.5" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.5.3.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.5.3.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.5.3.3" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.5.3.4" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.5.3.5" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.6.4.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.6.4.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.6.4.3" style="padding-left:8.0pt;padding-right:8.0pt;">2.3B</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.6.4.4" style="padding-left:8.0pt;padding-right:8.0pt;">2.8B</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.6.4.5" style="padding-left:8.0pt;padding-right:8.0pt;">1.9B</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.7.5.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.7.5.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.7.5.3" style="padding-left:8.0pt;padding-right:8.0pt;">0.28B</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.7.5.4" style="padding-left:8.0pt;padding-right:8.0pt;">0.35B</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.7.5.5" style="padding-left:8.0pt;padding-right:8.0pt;">0.24B</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.8.6.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.8.6.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.8.6.3" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.8.6.4" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.8.6.5" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T8.2.9.7.1" style="padding-left:8.0pt;padding-right:8.0pt;">Pile&nbsp;(Loss)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T8.2.9.7.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.9.7.3" style="padding-left:8.0pt;padding-right:8.0pt;">1.824</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.9.7.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.9.7.4.1">1.808</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.9.7.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.9.7.5.1">1.808</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T8.2.10.8.1" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T8.2.10.8.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.10.8.3" style="padding-left:8.0pt;padding-right:8.0pt;">53.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.10.8.4" style="padding-left:8.0pt;padding-right:8.0pt;">54.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.10.8.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.10.8.5.1">54.8</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.11.9.1" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.11.9.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.11.9.3" style="padding-left:8.0pt;padding-right:8.0pt;">71.8</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.11.9.4" style="padding-left:8.0pt;padding-right:8.0pt;">71.1</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.11.9.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.11.9.5.1">72.3</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.12.10.1" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.12.10.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.12.10.3" style="padding-left:8.0pt;padding-right:8.0pt;">46.8</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.12.10.4" style="padding-left:8.0pt;padding-right:8.0pt;">47.3</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.12.10.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.12.10.5.1">49.4</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.13.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.13.11.1" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.13.11.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.13.11.3" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.13.11.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.13.11.4.1">34.1</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.13.11.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.13.11.5.1">34.3</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T8.2.14.12.1" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T8.2.14.12.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.14.12.3" style="padding-left:8.0pt;padding-right:8.0pt;">43.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.14.12.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.14.12.4.1">46.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.14.12.5" style="padding-left:8.0pt;padding-right:8.0pt;">44.0</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.15.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.15.13.1" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.15.13.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.15.13.3" style="padding-left:8.0pt;padding-right:8.0pt;">31.9</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.15.13.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.15.13.4.1">32.4</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.15.13.5" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.16.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T8.2.16.14.1" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T8.2.16.14.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.16.14.3" style="padding-left:8.0pt;padding-right:8.0pt;">3.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.16.14.4" style="padding-left:8.0pt;padding-right:8.0pt;">3.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.16.14.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.16.14.5.1">4.9</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.17.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T8.2.17.15.1" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.17.15.2" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.17.15.3" style="padding-left:8.0pt;padding-right:8.0pt;">2.4</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.17.15.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.17.15.4.1">2.6</span></td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.17.15.5" style="padding-left:8.0pt;padding-right:8.0pt;">2.2</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.18.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T8.2.18.16.1" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T8.2.18.16.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.18.16.3" style="padding-left:8.0pt;padding-right:8.0pt;">15.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.18.16.4" style="padding-left:8.0pt;padding-right:8.0pt;">15.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.18.16.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.18.16.5.1">16.6</span></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.19.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T8.2.19.17.1" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T8.2.19.17.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.2.19.17.3" style="padding-left:8.0pt;padding-right:8.0pt;">4.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.2.19.17.4" style="padding-left:8.0pt;padding-right:8.0pt;">4.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.2.19.17.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T8.2.19.17.5.1">5.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>
Comparison between DeepSeekMoE and larger GShard models.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A2.T9">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T9.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T9.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A2.T9.2.2.3" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.2.3.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A2.T9.2.2.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.2.4.1"># Shot</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T9.1.1.1" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.1.1.1.1">Dense<math alttext="\times 4" class="ltx_Math" display="inline" id="A2.T9.1.1.1.1.m1.1"><semantics id="A2.T9.1.1.1.1.m1.1a"><mrow id="A2.T9.1.1.1.1.m1.1.1" xref="A2.T9.1.1.1.1.m1.1.1.cmml"><mi id="A2.T9.1.1.1.1.m1.1.1.2" xref="A2.T9.1.1.1.1.m1.1.1.2.cmml"></mi><mo id="A2.T9.1.1.1.1.m1.1.1.1" lspace="0.222em" mathvariant="normal" rspace="0.222em" xref="A2.T9.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A2.T9.1.1.1.1.m1.1.1.3" mathvariant="normal" xref="A2.T9.1.1.1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.1.1.1.1.m1.1b"><apply id="A2.T9.1.1.1.1.m1.1.1.cmml" xref="A2.T9.1.1.1.1.m1.1.1"><times id="A2.T9.1.1.1.1.m1.1.1.1.cmml" xref="A2.T9.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T9.1.1.1.1.m1.1.1.2.cmml" xref="A2.T9.1.1.1.1.m1.1.1.2">absent</csymbol><cn id="A2.T9.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="A2.T9.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.1.1.1.1.m1.1c">\times 4</annotation><annotation encoding="application/x-llamapun" id="A2.T9.1.1.1.1.m1.1d">× 4</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T9.2.2.2" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.2.2.1">Dense<math alttext="\times 16" class="ltx_Math" display="inline" id="A2.T9.2.2.2.1.m1.1"><semantics id="A2.T9.2.2.2.1.m1.1a"><mrow id="A2.T9.2.2.2.1.m1.1.1" xref="A2.T9.2.2.2.1.m1.1.1.cmml"><mi id="A2.T9.2.2.2.1.m1.1.1.2" xref="A2.T9.2.2.2.1.m1.1.1.2.cmml"></mi><mo id="A2.T9.2.2.2.1.m1.1.1.1" lspace="0.222em" mathvariant="normal" rspace="0.222em" xref="A2.T9.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A2.T9.2.2.2.1.m1.1.1.3" mathvariant="normal" xref="A2.T9.2.2.2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.2.2.2.1.m1.1b"><apply id="A2.T9.2.2.2.1.m1.1.1.cmml" xref="A2.T9.2.2.2.1.m1.1.1"><times id="A2.T9.2.2.2.1.m1.1.1.1.cmml" xref="A2.T9.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T9.2.2.2.1.m1.1.1.2.cmml" xref="A2.T9.2.2.2.1.m1.1.1.2">absent</csymbol><cn id="A2.T9.2.2.2.1.m1.1.1.3.cmml" type="integer" xref="A2.T9.2.2.2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.2.2.2.1.m1.1c">\times 16</annotation><annotation encoding="application/x-llamapun" id="A2.T9.2.2.2.1.m1.1d">× 16</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T9.2.2.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.2.5.1">DeepSeekMoE</span></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T9.2.3.1.1" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T9.2.3.1.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.3.1.3" style="padding-left:8.0pt;padding-right:8.0pt;">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.3.1.4" style="padding-left:8.0pt;padding-right:8.0pt;">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.3.1.5" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.4.2.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.4.2.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.4.2.3" style="padding-left:8.0pt;padding-right:8.0pt;">4 + 0</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.4.2.4" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.4.2.5" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.5.3.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.5.3.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.5.3.3" style="padding-left:8.0pt;padding-right:8.0pt;">4 + 0</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.5.3.4" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.5.3.5" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.6.4.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.6.4.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.6.4.3" style="padding-left:8.0pt;padding-right:8.0pt;">0.47B</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.6.4.4" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.6.4.5" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.7.5.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.7.5.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.7.5.3" style="padding-left:8.0pt;padding-right:8.0pt;">0.47B</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.7.5.4" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.7.5.5" style="padding-left:8.0pt;padding-right:8.0pt;">0.24B</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.8.6.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.8.6.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.8.6.3" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.8.6.4" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.8.6.5" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T9.2.9.7.1" style="padding-left:8.0pt;padding-right:8.0pt;">Pile&nbsp;(Loss)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T9.2.9.7.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.9.7.3" style="padding-left:8.0pt;padding-right:8.0pt;">1.908</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.9.7.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.9.7.4.1">1.806</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.9.7.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.9.7.5.1">1.808</span></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T9.2.10.8.1" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T9.2.10.8.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.10.8.3" style="padding-left:8.0pt;padding-right:8.0pt;">47.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.10.8.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.10.8.4.1">55.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.10.8.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.10.8.5.1">54.8</span></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.11.9.1" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.11.9.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.11.9.3" style="padding-left:8.0pt;padding-right:8.0pt;">70.0</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.11.9.4" style="padding-left:8.0pt;padding-right:8.0pt;">71.9</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.11.9.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.11.9.5.1">72.3</span></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.12.10.1" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.12.10.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.12.10.3" style="padding-left:8.0pt;padding-right:8.0pt;">43.9</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.12.10.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.12.10.4.1">51.9</span></td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.12.10.5" style="padding-left:8.0pt;padding-right:8.0pt;">49.4</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.13.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.13.11.1" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.13.11.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.13.11.3" style="padding-left:8.0pt;padding-right:8.0pt;">30.5</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.13.11.4" style="padding-left:8.0pt;padding-right:8.0pt;">33.8</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.13.11.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.13.11.5.1">34.3</span></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T9.2.14.12.1" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T9.2.14.12.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.14.12.3" style="padding-left:8.0pt;padding-right:8.0pt;">42.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.14.12.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.14.12.4.1">46.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.14.12.5" style="padding-left:8.0pt;padding-right:8.0pt;">44.0</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.15.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.15.13.1" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.15.13.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.15.13.3" style="padding-left:8.0pt;padding-right:8.0pt;">30.7</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.15.13.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.15.13.4.1">33.0</span></td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.15.13.5" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.16.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T9.2.16.14.1" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T9.2.16.14.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.16.14.3" style="padding-left:8.0pt;padding-right:8.0pt;">1.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.16.14.4" style="padding-left:8.0pt;padding-right:8.0pt;">4.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.16.14.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.16.14.5.1">4.9</span></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.17.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T9.2.17.15.1" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.17.15.2" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.17.15.3" style="padding-left:8.0pt;padding-right:8.0pt;">0.2</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.17.15.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.17.15.4.1">2.2</span></td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.17.15.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.17.15.5.1">2.2</span></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.18.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T9.2.18.16.1" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T9.2.18.16.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.18.16.3" style="padding-left:8.0pt;padding-right:8.0pt;">9.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.18.16.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.18.16.4.1">16.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.18.16.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.18.16.5.1">16.6</span></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.19.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T9.2.19.17.1" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T9.2.19.17.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.2.19.17.3" style="padding-left:8.0pt;padding-right:8.0pt;">3.0</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.2.19.17.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T9.2.19.17.4.1">6.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.2.19.17.5" style="padding-left:8.0pt;padding-right:8.0pt;">5.7</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>
Comparison between DeepSeekMoE and larger dense baselines.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.p2">
<p class="ltx_p" id="A2.p2.3">At a larger scale of 13B total parameters, we also compare DeepSeekMoE with GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="A2.p2.1.m1.1"><semantics id="A2.p2.1.m1.1a"><mrow id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml"><mi id="A2.p2.1.m1.1.1.2" xref="A2.p2.1.m1.1.1.2.cmml"></mi><mo id="A2.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.1.m1.1.1.1.cmml">×</mo><mn id="A2.p2.1.m1.1.1.3" xref="A2.p2.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><apply id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1"><times id="A2.p2.1.m1.1.1.1.cmml" xref="A2.p2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.p2.1.m1.1.1.2.cmml" xref="A2.p2.1.m1.1.1.2">absent</csymbol><cn id="A2.p2.1.m1.1.1.3.cmml" type="float" xref="A2.p2.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\times 1.2</annotation><annotation encoding="application/x-llamapun" id="A2.p2.1.m1.1d">× 1.2</annotation></semantics></math> and GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="A2.p2.2.m2.1"><semantics id="A2.p2.2.m2.1a"><mrow id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml"><mi id="A2.p2.2.m2.1.1.2" xref="A2.p2.2.m2.1.1.2.cmml"></mi><mo id="A2.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.2.m2.1.1.1.cmml">×</mo><mn id="A2.p2.2.m2.1.1.3" xref="A2.p2.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><apply id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1"><times id="A2.p2.2.m2.1.1.1.cmml" xref="A2.p2.2.m2.1.1.1"></times><csymbol cd="latexml" id="A2.p2.2.m2.1.1.2.cmml" xref="A2.p2.2.m2.1.1.2">absent</csymbol><cn id="A2.p2.2.m2.1.1.3.cmml" type="float" xref="A2.p2.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="A2.p2.2.m2.1d">× 1.5</annotation></semantics></math>, and show results in Table&nbsp;<a class="ltx_ref" href="#A2.T10" title="Table 10 ‣ Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">10</span></a>.
At a larger scale, DeepSeekMoE even outperforms GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="A2.p2.3.m3.1"><semantics id="A2.p2.3.m3.1a"><mrow id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml"><mi id="A2.p2.3.m3.1.1.2" xref="A2.p2.3.m3.1.1.2.cmml"></mi><mo id="A2.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.3.m3.1.1.1.cmml">×</mo><mn id="A2.p2.3.m3.1.1.3" xref="A2.p2.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.1b"><apply id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1"><times id="A2.p2.3.m3.1.1.1.cmml" xref="A2.p2.3.m3.1.1.1"></times><csymbol cd="latexml" id="A2.p2.3.m3.1.1.2.cmml" xref="A2.p2.3.m3.1.1.2">absent</csymbol><cn id="A2.p2.3.m3.1.1.3.cmml" type="float" xref="A2.p2.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="A2.p2.3.m3.1d">× 1.5</annotation></semantics></math> distinctly.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A2.T10">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T10.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T10.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A2.T10.2.2.3" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.2.3.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A2.T10.2.2.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.2.4.1"># Shot</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T10.1.1.1" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.1.1.1.1">GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="A2.T10.1.1.1.1.m1.1"><semantics id="A2.T10.1.1.1.1.m1.1a"><mrow id="A2.T10.1.1.1.1.m1.1.1" xref="A2.T10.1.1.1.1.m1.1.1.cmml"><mi id="A2.T10.1.1.1.1.m1.1.1.2" xref="A2.T10.1.1.1.1.m1.1.1.2.cmml"></mi><mo id="A2.T10.1.1.1.1.m1.1.1.1" lspace="0.222em" mathvariant="normal" rspace="0.222em" xref="A2.T10.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A2.T10.1.1.1.1.m1.1.1.3" mathvariant="normal" xref="A2.T10.1.1.1.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.1.1.1.1.m1.1b"><apply id="A2.T10.1.1.1.1.m1.1.1.cmml" xref="A2.T10.1.1.1.1.m1.1.1"><times id="A2.T10.1.1.1.1.m1.1.1.1.cmml" xref="A2.T10.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T10.1.1.1.1.m1.1.1.2.cmml" xref="A2.T10.1.1.1.1.m1.1.1.2">absent</csymbol><cn id="A2.T10.1.1.1.1.m1.1.1.3.cmml" type="float" xref="A2.T10.1.1.1.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.1.1.1.1.m1.1c">\times 1.2</annotation><annotation encoding="application/x-llamapun" id="A2.T10.1.1.1.1.m1.1d">× 1.2</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T10.2.2.2" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.2.2.1">GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="A2.T10.2.2.2.1.m1.1"><semantics id="A2.T10.2.2.2.1.m1.1a"><mrow id="A2.T10.2.2.2.1.m1.1.1" xref="A2.T10.2.2.2.1.m1.1.1.cmml"><mi id="A2.T10.2.2.2.1.m1.1.1.2" xref="A2.T10.2.2.2.1.m1.1.1.2.cmml"></mi><mo id="A2.T10.2.2.2.1.m1.1.1.1" lspace="0.222em" mathvariant="normal" rspace="0.222em" xref="A2.T10.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A2.T10.2.2.2.1.m1.1.1.3" mathvariant="normal" xref="A2.T10.2.2.2.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.2.2.2.1.m1.1b"><apply id="A2.T10.2.2.2.1.m1.1.1.cmml" xref="A2.T10.2.2.2.1.m1.1.1"><times id="A2.T10.2.2.2.1.m1.1.1.1.cmml" xref="A2.T10.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T10.2.2.2.1.m1.1.1.2.cmml" xref="A2.T10.2.2.2.1.m1.1.1.2">absent</csymbol><cn id="A2.T10.2.2.2.1.m1.1.1.3.cmml" type="float" xref="A2.T10.2.2.2.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.2.2.2.1.m1.1c">\times 1.5</annotation><annotation encoding="application/x-llamapun" id="A2.T10.2.2.2.1.m1.1d">× 1.5</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T10.2.2.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.2.5.1">DeepSeekMoE</span></td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T10.2.3.1.1" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T10.2.3.1.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.3.1.3" style="padding-left:8.0pt;padding-right:8.0pt;">1.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.3.1.4" style="padding-left:8.0pt;padding-right:8.0pt;">1.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.3.1.5" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.4.2.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.4.2.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.4.2.3" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.4.2.4" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.4.2.5" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.5.3.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.5.3.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.5.3.3" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.5.3.4" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.5.3.5" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.6.4.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.6.4.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.6.4.3" style="padding-left:8.0pt;padding-right:8.0pt;">15.9B</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.6.4.4" style="padding-left:8.0pt;padding-right:8.0pt;">19.8B</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.6.4.5" style="padding-left:8.0pt;padding-right:8.0pt;">13.3B</td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.7.5.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.7.5.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.7.5.3" style="padding-left:8.0pt;padding-right:8.0pt;">2.37B</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.7.5.4" style="padding-left:8.0pt;padding-right:8.0pt;">2.82B</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.7.5.5" style="padding-left:8.0pt;padding-right:8.0pt;">2.05B</td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.8.6.1" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.8.6.2" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.8.6.3" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.8.6.4" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.8.6.5" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T10.2.9.7.1" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T10.2.9.7.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.9.7.3" style="padding-left:8.0pt;padding-right:8.0pt;">66.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.9.7.4" style="padding-left:8.0pt;padding-right:8.0pt;">67.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.9.7.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.9.7.5.1">69.1</span></td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.10.8.1" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.10.8.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.10.8.3" style="padding-left:8.0pt;padding-right:8.0pt;">75.6</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.10.8.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.10.8.4.1">76.0</span></td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.10.8.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.10.8.5.1">75.7</span></td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.11.9.1" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.11.9.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.11.9.3" style="padding-left:8.0pt;padding-right:8.0pt;">56.8</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.11.9.4" style="padding-left:8.0pt;padding-right:8.0pt;">56.8</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.11.9.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.11.9.5.1">58.8</span></td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.12.10.1" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.12.10.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.12.10.3" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.12.10.3.1">39.9</span></td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.12.10.4" style="padding-left:8.0pt;padding-right:8.0pt;">37.6</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.12.10.5" style="padding-left:8.0pt;padding-right:8.0pt;">38.5</td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.13.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T10.2.13.11.1" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T10.2.13.11.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.13.11.3" style="padding-left:8.0pt;padding-right:8.0pt;">51.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.13.11.4" style="padding-left:8.0pt;padding-right:8.0pt;">50.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.13.11.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.13.11.5.1">52.4</span></td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.14.12.1" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.14.12.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.14.12.3" style="padding-left:8.0pt;padding-right:8.0pt;">37.4</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.14.12.4" style="padding-left:8.0pt;padding-right:8.0pt;">36.3</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.14.12.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.14.12.5.1">38.5</span></td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.15.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T10.2.15.13.1" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T10.2.15.13.2" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.15.13.3" style="padding-left:8.0pt;padding-right:8.0pt;">6.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.15.13.4" style="padding-left:8.0pt;padding-right:8.0pt;">6.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.15.13.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.15.13.5.1">9.8</span></td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.16.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T10.2.16.14.1" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A2.T10.2.16.14.2" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td class="ltx_td ltx_align_center" id="A2.T10.2.16.14.3" style="padding-left:8.0pt;padding-right:8.0pt;">7.0</td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.16.14.4" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.16.14.4.1">11.6</span></td>
<td class="ltx_td ltx_align_center" id="A2.T10.2.16.14.5" style="padding-left:8.0pt;padding-right:8.0pt;">10.6</td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.17.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T10.2.17.15.1" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T10.2.17.15.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.17.15.3" style="padding-left:8.0pt;padding-right:8.0pt;">36.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.17.15.4" style="padding-left:8.0pt;padding-right:8.0pt;">36.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T10.2.17.15.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.17.15.5.1">38.2</span></td>
</tr>
<tr class="ltx_tr" id="A2.T10.2.18.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T10.2.18.16.1" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T10.2.18.16.2" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T10.2.18.16.3" style="padding-left:8.0pt;padding-right:8.0pt;">12.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T10.2.18.16.4" style="padding-left:8.0pt;padding-right:8.0pt;">12.1</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T10.2.18.16.5" style="padding-left:8.0pt;padding-right:8.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T10.2.18.16.5.1">13.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span>
Comparison between DeepSeekMoE and larger GShard models at a larger scale.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A3" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Training Benchmark Curves of DeepSeekMoE 16B</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">We present the benchmark curves during training of DeepSeekMoE 16B and DeepSeek 7B (Dense) in Figure&nbsp;<a class="ltx_ref" href="#A3.F7" title="Figure 7 ‣ Appendix C Training Benchmark Curves of DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">7</span></a> for reference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A3.F7"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="1096" id="A3.F7.g1" src="x7.png" width="822">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>
Benchmark curves during training of DeepSeekMoE 16B and DeepSeek 7B (Dense).
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>

</div>


<div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated on Wed Dec 14 18:01:44 2022 by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer><button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button></body></html>