<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2401.06066] DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models</title><meta property="og:description" content="In the era of large language models, Mixture-of-Experts (MoE) is a promising architecture for managing computational costs when scaling up model parameters.
However, conventional MoE architectures like GShard, which ac…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2401.06066">

<!--Generated on Tue Feb 27 09:57:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv-fonts.0.7.9.min.css"><link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv.0.7.9.min.css"><link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\reportnumber</span>
<p class="ltx_p" id="p1.2">001    <span class="ltx_ERROR undefined" id="p1.2.1">\correspondingauthor</span>Contribution during internship at DeepSeek-AI.</p>
</div>
<h1 class="ltx_title ltx_title_document">
DeepSeekMoE: Towards Ultimate Expert Specialization in

<br class="ltx_break">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mixture-of-Experts Language Models
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id1.1.1" class="ltx_text" style="font-size:90%;">Damai Dai<sup id="id1.1.1.1" class="ltx_sup"><span id="id1.1.1.1.1" class="ltx_text ltx_font_italic">∗1,2</span></sup></span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chengqi Deng<sup id="id28.2.id1" class="ltx_sup"><span id="id28.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chenggang Zhao<sup id="id29.2.id1" class="ltx_sup"><span id="id29.2.id1.1" class="ltx_text ltx_font_italic">∗1,3</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
R.X. Xu<sup id="id30.2.id1" class="ltx_sup"><span id="id30.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Huazuo Gao<sup id="id31.2.id1" class="ltx_sup"><span id="id31.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Deli Chen<sup id="id32.2.id1" class="ltx_sup"><span id="id32.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jiashi Li<sup id="id33.2.id1" class="ltx_sup"><span id="id33.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wangding Zeng<sup id="id34.2.id1" class="ltx_sup"><span id="id34.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xingkai Yu<sup id="id35.2.id1" class="ltx_sup"><span id="id35.2.id1.1" class="ltx_text ltx_font_italic">∗1,4</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Y. Wu<sup id="id36.2.id1" class="ltx_sup"><span id="id36.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Zhenda Xie<sup id="id37.2.id1" class="ltx_sup"><span id="id37.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Y.K. Li<sup id="id38.2.id1" class="ltx_sup"><span id="id38.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Panpan Huang<sup id="id39.2.id1" class="ltx_sup"><span id="id39.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Fuli Luo<sup id="id40.2.id1" class="ltx_sup"><span id="id40.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chong Ruan<sup id="id41.2.id1" class="ltx_sup"><span id="id41.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">

<br class="ltx_break">Zhifang Sui<sup id="id42.2.id1" class="ltx_sup"><span id="id42.2.id1.1" class="ltx_text ltx_font_italic">2</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wenfeng Liang<sup id="id43.4.id1" class="ltx_sup"><span id="id43.4.id1.1" class="ltx_text ltx_font_italic">1</span></sup>

<br class="ltx_break"><sup id="id44.5.id2" class="ltx_sup"><span id="id44.5.id2.1" class="ltx_text" style="font-size:90%;">1</span></sup><span id="id19.3.1" class="ltx_text" style="font-size:90%;">DeepSeek-AI 
<br class="ltx_break"><sup id="id19.3.1.1" class="ltx_sup">2</sup>National Key Laboratory for Multimedia Information Processing</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Peking University 
<br class="ltx_break"><sup id="id45.2.id1" class="ltx_sup"><span id="id45.2.id1.1" class="ltx_text" style="font-size:90%;">3</span></sup><span id="id46.3.id2" class="ltx_text" style="font-size:90%;">Institute for Interdisciplinary Information Sciences</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Tsinghua University 
<br class="ltx_break"><sup id="id47.2.id1" class="ltx_sup"><span id="id47.2.id1.1" class="ltx_text" style="font-size:90%;">4</span></sup><span id="id48.3.id2" class="ltx_text" style="font-size:90%;">National Key Laboratory for Novel Software Technology</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Nanjing University 
<br class="ltx_break"><span id="id49.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{daidamai, szf}@pku.edu.cn</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id50.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{wenfeng.liang}@deepseek.com<span id="id50.1.id1.1" class="ltx_text ltx_font_serif">

<br class="ltx_break"><a target="_blank" href="https://github.com/deepseek-ai/DeepSeek-MoE" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/deepseek-ai/DeepSeek-MoE</a>
</span></span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id27.6">대규모 언어 모델 시대에, Mixture-of-Experts (MoE)는 모델 파라미터들을 스케일링할 때 계산 비용들을 관리하기 위한 유망한 아키텍처이다. 그러나, <math alttext="N" class="ltx_Math" display="inline" id="id23.2.m2.1"><semantics id="id23.2.m2.1a"><mi id="id23.2.m2.1.1" xref="id23.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="id23.2.m2.1b"><ci id="id23.2.m2.1.1.cmml" xref="id23.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="id23.2.m2.1c">N</annotation></semantics></math> 전문가 중 상위 <math alttext="K" class="ltx_Math" display="inline" id="id22.1.m1.1"><semantics id="id22.1.m1.1a"><mi id="id22.1.m1.1.1" xref="id22.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="id22.1.m1.1b"><ci id="id22.1.m1.1.1.cmml" xref="id22.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="id22.1.m1.1c">K</annotation></semantics></math>를 활성화시키는 GShard와 같은 기존의 MoE 아키텍처는 전문가 전문화를 보장하는 데 있어 어려움에 직면해 있다. 즉, 각 전문가는 중복되지 않고 집중된 지식을 획득하게 된다. 이에 대해 <span class="ltx_text ltx_font_bold" id="id27.6.1">DeepSeekMoE</span> 아키텍처를 궁극적인 전문가 전문화로 제안한다. 여기에는 두 가지 주요 전략이 포함됩니다: (1) 전문가를 <math alttext="mN" class="ltx_Math" display="inline" id="id24.3.m3.1"><semantics id="id24.3.m3.1a"><mrow id="id24.3.m3.1.1" xref="id24.3.m3.1.1.cmml"><mi id="id24.3.m3.1.1.2" xref="id24.3.m3.1.1.2.cmml">m</mi><mo id="id24.3.m3.1.1.1" lspace="0em" rspace="0em" xref="id24.3.m3.1.1.1.cmml">​</mo><mi id="id24.3.m3.1.1.3" xref="id24.3.m3.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="id24.3.m3.1b"><apply id="id24.3.m3.1.1.cmml" xref="id24.3.m3.1.1"><times id="id24.3.m3.1.1.1.cmml" xref="id24.3.m3.1.1.1"></times><ci id="id24.3.m3.1.1.2.cmml" xref="id24.3.m3.1.1.2">𝑚</ci><ci id="id24.3.m3.1.1.3.cmml" xref="id24.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id24.3.m3.1c">mN</annotation></semantics></math>로 세밀하게 세분화하고 이로부터 <math alttext="mK" class="ltx_Math" display="inline" id="id25.4.m4.1"><semantics id="id25.4.m4.1a"><mrow id="id25.4.m4.1.1" xref="id25.4.m4.1.1.cmml"><mi id="id25.4.m4.1.1.2" xref="id25.4.m4.1.1.2.cmml">m</mi><mo id="id25.4.m4.1.1.1" lspace="0em" rspace="0em" xref="id25.4.m4.1.1.1.cmml">​</mo><mi id="id25.4.m4.1.1.3" xref="id25.4.m4.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="id25.4.m4.1b"><apply id="id25.4.m4.1.1.cmml" xref="id25.4.m4.1.1"><times id="id25.4.m4.1.1.1.cmml" xref="id25.4.m4.1.1.1"></times><ci id="id25.4.m4.1.1.2.cmml" xref="id25.4.m4.1.1.2">𝑚</ci><ci id="id25.4.m4.1.1.3.cmml" xref="id25.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id25.4.m4.1c">mK</annotation></semantics></math>를 활성화하여 활성화된 전문가의 보다 유연한 조합을 허용하고; (2) [math idx=4></math> 전문가를 공유된 전문가로 격리하여 공통 지식을 포착하고 라우팅된 전문가의 중복성을 완화하는 것을 목표로 합니다. 2B 파라미터를 갖는 적당한 스케일에서 시작하여, DeepSeekMoE 2B가 1.5<math alttext="\times" class="ltx_Math" display="inline" id="id27.6.m6.1"><semantics id="id27.6.m6.1a"><mo id="id27.6.m6.1.1" xref="id27.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="id27.6.m6.1b"><times id="id27.6.m6.1.1.cmml" xref="id27.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id27.6.m6.1c">\times</annotation></semantics></math> 전문가 파라미터 및 계산을 갖는 GShard 2.9B와 비교 가능한 성능을 달성함을 입증한다. 또한, DeepSeekMoE 2B는 MoE 모델의 상한을 설정하는 동일한 수의 총 매개변수로 조밀한 대응물의 성능에 거의 근접한다. 그 후 DeepSeekMoE를 16B 파라미터로 확장하여 LLaMA2 7B와 비교 가능한 성능을 얻었으며, 계산량은 약 40%에 불과하였다. 또한 DeepSeekMoE를 145B 매개변수로 확장하려는 예비 노력은 GShard 아키텍처에 비해 상당한 이점을 일관되게 검증하고 28.5%(심지어 18.2%)의 계산만을 사용하여 DeepSeek 67B와 유사한 성능을 보여준다.</p>
</div>
<figure id="S0.F1" class="ltx_figure" lang="en"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x1.png" id="S0.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">도 1:</span></figcaption>
Comparison between DeepSeekMoE 16B and open source models on the Open LLM Leaderboard.
The red dashed line is linearly fitted from data points of all models except DeepSeekMoE 16B.
DeepSeekMoE 16B consistently outperforms models with a similar number of activated parameters by a large margin, and achieves comparable performance with LLaMA2 7B, which has approximately 2.5 times the activated parameters.
</figcaption>
</figure>
<section id="S1" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p" id="S1.p1.1">최근의 연구 및 관행들은 충분한 트레이닝 데이터를 이용가능하게 함으로써, 증가된 파라미터들 및 계산 예산들을 갖는 스케일링 언어 모델들이 현저하게 더 강한 모델들 <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a class="ltx_ref" href="#bib.bib7" title="">2020</a>; OpenAI, <a class="ltx_ref" href="#bib.bib38" title="">2023</a>; Touvron et al., <a class="ltx_ref" href="#bib.bib53" title="">2023a</a>; Hoffmann et al., <a class="ltx_ref" href="#bib.bib24" title="">2022</a>)</cite>를 산출할 수 있다는 것을 경험적으로 입증했다. 그러나 모델을 매우 대규모로 확장하려는 노력은 또한 매우 높은 계산 비용과 관련이 있음을 인정해야 한다. 상당한 비용을 고려할 때, Mixture-of-Experts(MoE) 아키텍처 <cite class="ltx_cite ltx_citemacro_citep">(Jacobs et al., <a class="ltx_ref" href="#bib.bib26" title="">1991</a>; Jordan and Jacobs, <a class="ltx_ref" href="#bib.bib27" title="">1994</a>; Shazeer et al., <a class="ltx_ref" href="#bib.bib47" title="">2017</a>)</cite>가 대중적인 솔루션으로 부상했다. 파라미터 스케일링을 가능하게 하는 동시에 계산 비용을 적당한 수준으로 유지할 수 있습니다. 최근 Transformers<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a class="ltx_ref" href="#bib.bib55" title="">2017</a>)</cite>에서 MoE 아키텍처의 응용은 언어 모델을 상당한 크기<cite class="ltx_cite ltx_citemacro_citep">(Fedus et al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>; Lepikhin et al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>; Du et al., <a class="ltx_ref" href="#bib.bib14" title="">2022</a>; Zoph, <a class="ltx_ref" href="#bib.bib63" title="">2022</a>)</cite>로 확장하려는 성공적인 시도를 가져왔으며 놀라운 성능을 동반했다. 이러한 성과는 MoE 언어 모델의 상당한 잠재력과 가능성을 강조한다.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p" id="S1.p2.1">MoE 아키텍처의 유망한 잠재력에도 불구하고, 기존의 MoE 아키텍처는 잠재적으로 지식 혼종성 및 지식 중복성의 문제로 고통받으며, 이는 전문가 전문화를 제한하며, 즉 각 전문가가 비중첩 및 집중된 지식을 획득한다. 기존의 MoE 구조는 트랜스포머의 Feed-Forward Networks(FFN)을 MoE 계층으로 대체한다. 각 MoE 계층은 여러 전문가로 구성되며, 각각은 구조적으로 표준 FFN과 동일하며, 각 토큰은 하나의 <cite class="ltx_cite ltx_citemacro_citep">(Fedus et al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite> 또는 두 개의 <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> 전문가에 할당된다. 이 아키텍처는 (1) <span class="ltx_text ltx_font_bold" id="S1.p2.1.1">Knowledge Hybridity</span>: 기존 MoE 관행은 종종 제한된 수의 전문가(예: 8 또는 16)를 사용하므로 특정 전문가에 할당된 토큰은 다양한 지식을 포함할 가능성이 높습니다. 따라서 지정된 전문가는 동시에 활용하기 어려운 매개변수에서 매우 다양한 유형의 지식을 수집할 계획이다. (2) <span class="ltx_text ltx_font_bold" id="S1.p2.1.2">Knowledge Redundancy</span>: 서로 다른 전문가에게 할당된 토큰은 공통된 지식을 필요로 할 수 있다. 결과적으로, 다수의 전문가들은 각자의 파라미터들에서 공유된 지식을 획득하는데 수렴할 수 있고, 이에 의해 전문가 파라미터들에서 중복성으로 이어질 수 있다. 이러한 문제는 기존 MoE 관행의 전문가 전문화를 일괄적으로 방해하여 MoE 모델의 이론적 상한 성능에 도달하지 못하게 한다.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p class="ltx_p" id="S1.p3.1">앞서 언급한 문제에 대응하여, 우리는 궁극적인 전문가 전문화를 위해 특별히 설계된 혁신적인 MoE 아키텍처인 <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">DeepSeekMoE</span>을 소개한다. 우리의 아키텍처는 두 가지 주요 전략을 포함한다: (1) <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">Fine-Grained Expert Segmentation:</span> 파라미터 수를 일정하게 유지하면서 FFN 중간 은닉 차원을 분할함으로써 전문가를 더 미세한 그레인으로 분할한다. 이에 대응하여 일정한 계산 비용을 유지하면서 보다 세분화된 전문가를 활성화하여 활성화된 전문가의 보다 유연하고 적응적인 조합을 가능하게 한다. 세립화된 전문가 세분화는 다양한 지식을 더 세밀하게 분해하고 다른 전문가로 더 정확하게 학습할 수 있도록 하며, 여기서 각 전문가는 더 높은 수준의 전문화를 유지할 것이다. 또한, 활성화된 전문가를 결합하는 유연성의 증가는 보다 정확하고 표적화된 지식 습득에도 기여한다. (2) <span class="ltx_text ltx_font_bold" id="S1.p3.1.3">Shared Expert Isolation:</span> 우리는 다양한 컨텍스트에 걸쳐 공통 지식을 캡처하고 통합하는 것을 목표로 항상 활성화되는 공유 전문가 역할을 하기 위해 특정 전문가를 분리합니다. 상식 지식을 이러한 공유 전문가로 압축함으로써, 라우팅된 다른 전문가들 간의 중복성이 완화될 것이다. 이는 파라미터 효율성을 향상시키고 각각의 라우팅된 전문가가 독특한 측면에 초점을 맞추어 전문화된 상태를 유지하도록 할 수 있다. DeepSeekMoE의 이러한 아키텍처 혁신은 각 전문가가 고도로 전문화된 매개변수 효율적인 MoE 언어 모델을 훈련할 수 있는 기회를 제공한다.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p class="ltx_p" id="S1.p4.1">2B 매개 변수를 사용한 적당한 규모에서 시작하여 DeepSeekMoE 아키텍처의 이점을 검증한다. 다양한 작업에 걸쳐 12개의 제로 샷 또는 소수 샷 벤치마크에 대한 평가를 수행합니다. 실험 결과는 DeepSeekMoE 2B가 GShard 2B<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite>를 상당한 마진으로 능가하고, 더 큰 MoE 모델인 GShard 2.9B와 1.5<math alttext="\times" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mo id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><times id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\times</annotation></semantics></math> 전문가 파라미터 및 계산과 일치함을 나타낸다. 놀랍게도, DeepSeekMoE 2B는 MoE 언어 모델의 엄격한 상한을 설정하는 동등한 수의 매개변수로 조밀한 대응물의 성능에 거의 근접한다는 것을 발견했다. 더 깊은 통찰력을 추구하기 위해 DeepSeekMoE에 대한 전문가 전문화에 대한 정교한 절제 연구와 분석을 수행한다. 이러한 연구는 세밀한 전문가 세분화와 공유 전문가 격리의 효과를 검증하고 DeepSeekMoE가 높은 수준의 전문가 전문화를 달성할 수 있다는 주장을 뒷받침하는 실증적 증거를 제공한다.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p class="ltx_p" id="S1.p5.1">우리의 아키텍처를 활용하여 모델 매개변수를 16B로 확장하고 2T 토큰이 있는 대규모 코퍼스에서 DeepSeekMoE 16B를 훈련한다. 평가 결과는 약 40%의 계산만으로 DeepSeekMoE 16B가 동일한 2T 코퍼스에 대해 훈련된 밀집 모델인 DeepSeek 7B <cite class="ltx_cite ltx_citemacro_citep">(DeepSeek-AI, <a class="ltx_ref" href="#bib.bib13" title="">2024</a>)</cite>와 유사한 성능을 달성함을 보여준다. 또한 DeepSeekMoE를 오픈소스 모델과 비교하였으며, 성능 평가를 통해 DeepSeekMoE 16B가 비슷한 수의 활성화된 파라미터를 가진 모델보다 큰 마진 차이로 일관되게 우수한 성능을 보였으며, 활성화된 파라미터의 약 2.5배인 LLaMA2 7B<cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="#bib.bib54" title="">2023b</a>)</cite>와 유사한 성능을 보였다. <a class="ltx_ref" href="#S0.F1" title="Figure 1 ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>는 Open LLM Leaderboard<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard</span></span></span>에 대한 평가 결과를 보여준다. 또한, 모델을 채팅 모델로 변환하여 정렬을 위한 감독 미세 조정(supervised fine-tuning, SFT)을 수행한다. 평가 결과는 DeepSeekMoE Chat 16B도 채팅 설정에서 DeepSeek Chat 7B 및 LLaMA2 SFT 7B와 유사한 성능을 달성함을 보여준다. 이러한 결과에 고무되어 DeepSeekMoE를 145B로 확장하기 위한 예비 노력을 추가로 수행한다. 실험 결과는 여전히 GShard 아키텍처에 비해 상당한 이점을 일관되게 검증한다. 또한, 28.5%(심지어 18.2%)의 계산만을 사용하여 DeepSeek 67B와 유사한 성능을 보여준다.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p class="ltx_p" id="S1.p6.1">우리의 기여는 다음과 같이 요약된다:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Architectural Innovation. <span> 우리는 세밀한 전문가 분할과 공유 전문가 격리의 두 가지 주요 전략을 사용하는 궁극적인 전문가 전문화를 달성하는 것을 목표로 하는 혁신적인 MoE 아키텍처인 DeepSeekMoE를 소개한다.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Empirical Validation. </span> DeepSeekMoE 아키텍처의 유효성을 실증적으로 검증하기 위해 광범위한 실험을 진행합니다. 실험 결과는 DeepSeekMoE 2B에서 높은 수준의 전문가 전문화를 검증하고, DeepSeekMoE 2B가 MoE 모델에 대한 상한 성능에 거의 접근할 수 있음을 나타낸다.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Scalability. </span> DeepSeekMoE를 확장하여 16B 모델을 학습하고 약 40%의 계산만으로 DeepSeekMoE 16B가 DeepSeek 7B 및 LLaMA2 7B와 유사한 성능을 달성함을 보여준다. 또한 DeepSeekMoE를 145B로 확장하기 위한 예비 시도를 수행하여 GShard 아키텍처에 비해 일관된 이점을 강조하고 DeepSeek 67B와 유사한 성능을 보여준다.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">Alignment for MoE. </span> DeepSeekMoE 16B에서 감독 미세 조정을 성공적으로 수행하여 정렬된 채팅 모델을 생성하여 DeepSeekMoE 16B의 적응성과 다양성을 보여준다.</p>
</div>
</li>
<li id="S1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i5.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i5.p1.1.1">Public Release. </span> 오픈 리서치의 정신에서 DeepSeekMoE 16B의 모델 체크포인트를 대중에게 공개합니다. 특히, 이 모델은 양자화할 필요 없이 40GB의 메모리를 갖는 단일 GPU에 배치될 수 있다.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries: Mixture-of-Experts for Transformers</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p" id="S2.p1.1">먼저 트랜스포머 언어 모델에서 일반적으로 사용되는 일반적인 MoE 아키텍처를 소개한다. 표준 트랜스포머 언어 모델은 표준 트랜스포머 블록들의 <math alttext="L" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">L</annotation></semantics></math> 레이어를 적층하여 구성되며, 여기서 각 블록은 다음과 같이 나타낼 수 있다:</p>
<table id="A3.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{u}_{1:T}^{l}" display="inline"><semantics id="S2.E1.m1.1a"><msubsup id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mi id="S2.E1.m1.1.1.2.2" xref="S2.E1.m1.1.1.2.2.cmml">𝐮</mi><mrow id="S2.E1.m1.1.1.2.3" xref="S2.E1.m1.1.1.2.3.cmml"><mn id="S2.E1.m1.1.1.2.3.2" xref="S2.E1.m1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m1.1.1.2.3.1" xref="S2.E1.m1.1.1.2.3.1.cmml">:</mo><mi id="S2.E1.m1.1.1.2.3.3" xref="S2.E1.m1.1.1.2.3.3.cmml">T</mi></mrow><mi id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1">superscript</csymbol><apply id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.1.cmml" xref="S2.E1.m1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.2.2">𝐮</ci><apply id="S2.E1.m1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.2.3"><ci id="S2.E1.m1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.2.3.1">:</ci><cn type="integer" id="S2.E1.m1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.2.3.2">1</cn><ci id="S2.E1.m1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\displaystyle\mathbf{u}_{1:T}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E1.m2.2" class="ltx_Math" alttext="\displaystyle=\operatorname{Self-Att}\left(\mathbf{h}_{1:T}^{l-1}\right)+\mathbf{h}_{1:T}^{l-1}," display="inline"><semantics id="S2.E1.m2.2a"><mrow id="S2.E1.m2.2.2.1" xref="S2.E1.m2.2.2.1.1.cmml"><mrow id="S2.E1.m2.2.2.1.1" xref="S2.E1.m2.2.2.1.1.cmml"><mi id="S2.E1.m2.2.2.1.1.3" xref="S2.E1.m2.2.2.1.1.3.cmml"></mi><mo id="S2.E1.m2.2.2.1.1.2" xref="S2.E1.m2.2.2.1.1.2.cmml">=</mo><mrow id="S2.E1.m2.2.2.1.1.1" xref="S2.E1.m2.2.2.1.1.1.cmml"><mrow id="S2.E1.m2.2.2.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml"><mrow id="S2.E1.m2.1.1" xref="S2.E1.m2.1.1.cmml"><mi id="S2.E1.m2.1.1.2" xref="S2.E1.m2.1.1.2.cmml">Self</mi><mo id="S2.E1.m2.1.1.1" xref="S2.E1.m2.1.1.1.cmml">−</mo><mi id="S2.E1.m2.1.1.3" xref="S2.E1.m2.1.1.3.cmml">Att</mi></mrow><mo id="S2.E1.m2.2.2.1.1.1.1.1a" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m2.2.2.1.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml"><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.2" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml">(</mo><msubsup id="S2.E1.m2.2.2.1.1.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mrow id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.cmml"><mn id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow><mrow id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m2.2.2.1.1.1.2" xref="S2.E1.m2.2.2.1.1.1.2.cmml">+</mo><msubsup id="S2.E1.m2.2.2.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.3.cmml"><mi id="S2.E1.m2.2.2.1.1.1.3.2.2" xref="S2.E1.m2.2.2.1.1.1.3.2.2.cmml">𝐡</mi><mrow id="S2.E1.m2.2.2.1.1.1.3.2.3" xref="S2.E1.m2.2.2.1.1.1.3.2.3.cmml"><mn id="S2.E1.m2.2.2.1.1.1.3.2.3.2" xref="S2.E1.m2.2.2.1.1.1.3.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m2.2.2.1.1.1.3.2.3.1" xref="S2.E1.m2.2.2.1.1.1.3.2.3.1.cmml">:</mo><mi id="S2.E1.m2.2.2.1.1.1.3.2.3.3" xref="S2.E1.m2.2.2.1.1.1.3.2.3.3.cmml">T</mi></mrow><mrow id="S2.E1.m2.2.2.1.1.1.3.3" xref="S2.E1.m2.2.2.1.1.1.3.3.cmml"><mi id="S2.E1.m2.2.2.1.1.1.3.3.2" xref="S2.E1.m2.2.2.1.1.1.3.3.2.cmml">l</mi><mo id="S2.E1.m2.2.2.1.1.1.3.3.1" xref="S2.E1.m2.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E1.m2.2.2.1.1.1.3.3.3" xref="S2.E1.m2.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo id="S2.E1.m2.2.2.1.2" xref="S2.E1.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m2.2b"><apply id="S2.E1.m2.2.2.1.1.cmml" xref="S2.E1.m2.2.2.1"><eq id="S2.E1.m2.2.2.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S2.E1.m2.2.2.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.3">absent</csymbol><apply id="S2.E1.m2.2.2.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1"><plus id="S2.E1.m2.2.2.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.2"></plus><apply id="S2.E1.m2.2.2.1.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1"><apply id="S2.E1.m2.1.1.cmml" xref="S2.E1.m2.1.1"><minus id="S2.E1.m2.1.1.1.cmml" xref="S2.E1.m2.1.1.1"></minus><ci id="S2.E1.m2.1.1.2.cmml" xref="S2.E1.m2.1.1.2">Self</ci><ci id="S2.E1.m2.1.1.3.cmml" xref="S2.E1.m2.1.1.3">Att</ci></apply><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2">𝐡</ci><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3"><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3"><minus id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S2.E1.m2.2.2.1.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3">superscript</csymbol><apply id="S2.E1.m2.2.2.1.1.1.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.3.2.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E1.m2.2.2.1.1.1.3.2.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.2">𝐡</ci><apply id="S2.E1.m2.2.2.1.1.1.3.2.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3"><ci id="S2.E1.m2.2.2.1.1.1.3.2.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3.1">:</ci><cn type="integer" id="S2.E1.m2.2.2.1.1.1.3.2.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3.2">1</cn><ci id="S2.E1.m2.2.2.1.1.1.3.2.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3.3">𝑇</ci></apply></apply><apply id="S2.E1.m2.2.2.1.1.1.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3"><minus id="S2.E1.m2.2.2.1.1.1.3.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3.1"></minus><ci id="S2.E1.m2.2.2.1.1.1.3.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3.2">𝑙</ci><cn type="integer" id="S2.E1.m2.2.2.1.1.1.3.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m2.2c">\displaystyle=\operatorname{Self-Att}\left(\mathbf{h}_{1:T}^{l-1}\right)+\mathbf{h}_{1:T}^{l-1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{h}_{t}^{l}" display="inline"><semantics id="S2.E2.m1.1a"><msubsup id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mi id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">𝐡</mi><mi id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml">t</mi><mi id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1">superscript</csymbol><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">𝐡</ci><ci id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2.m2.2" class="ltx_Math" alttext="\displaystyle=\operatorname{FFN}\left(\mathbf{u}_{t}^{l}\right)+\mathbf{u}_{t}^{l}," display="inline"><semantics id="S2.E2.m2.2a"><mrow id="S2.E2.m2.2.2.1" xref="S2.E2.m2.2.2.1.1.cmml"><mrow id="S2.E2.m2.2.2.1.1" xref="S2.E2.m2.2.2.1.1.cmml"><mi id="S2.E2.m2.2.2.1.1.3" xref="S2.E2.m2.2.2.1.1.3.cmml"></mi><mo id="S2.E2.m2.2.2.1.1.2" xref="S2.E2.m2.2.2.1.1.2.cmml">=</mo><mrow id="S2.E2.m2.2.2.1.1.1" xref="S2.E2.m2.2.2.1.1.1.cmml"><mrow id="S2.E2.m2.2.2.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml"><mi id="S2.E2.m2.1.1" xref="S2.E2.m2.1.1.cmml">FFN</mi><mo id="S2.E2.m2.2.2.1.1.1.1.1a" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E2.m2.2.2.1.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml"><mo id="S2.E2.m2.2.2.1.1.1.1.1.1.2" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml">(</mo><msubsup id="S2.E2.m2.2.2.1.1.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐮</mi><mi id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.E2.m2.2.2.1.1.1.1.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.E2.m2.2.2.1.1.1.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m2.2.2.1.1.1.2" xref="S2.E2.m2.2.2.1.1.1.2.cmml">+</mo><msubsup id="S2.E2.m2.2.2.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.3.cmml"><mi id="S2.E2.m2.2.2.1.1.1.3.2.2" xref="S2.E2.m2.2.2.1.1.1.3.2.2.cmml">𝐮</mi><mi id="S2.E2.m2.2.2.1.1.1.3.2.3" xref="S2.E2.m2.2.2.1.1.1.3.2.3.cmml">t</mi><mi id="S2.E2.m2.2.2.1.1.1.3.3" xref="S2.E2.m2.2.2.1.1.1.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S2.E2.m2.2.2.1.2" xref="S2.E2.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.2b"><apply id="S2.E2.m2.2.2.1.1.cmml" xref="S2.E2.m2.2.2.1"><eq id="S2.E2.m2.2.2.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S2.E2.m2.2.2.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.3">absent</csymbol><apply id="S2.E2.m2.2.2.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1"><plus id="S2.E2.m2.2.2.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.2"></plus><apply id="S2.E2.m2.2.2.1.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1"><ci id="S2.E2.m2.1.1.cmml" xref="S2.E2.m2.1.1">FFN</ci><apply id="S2.E2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2">𝐮</ci><ci id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S2.E2.m2.2.2.1.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.3.1.cmml" xref="S2.E2.m2.2.2.1.1.1.3">superscript</csymbol><apply id="S2.E2.m2.2.2.1.1.1.3.2.cmml" xref="S2.E2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.3.2.1.cmml" xref="S2.E2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E2.m2.2.2.1.1.1.3.2.2.cmml" xref="S2.E2.m2.2.2.1.1.1.3.2.2">𝐮</ci><ci id="S2.E2.m2.2.2.1.1.1.3.2.3.cmml" xref="S2.E2.m2.2.2.1.1.1.3.2.3">𝑡</ci></apply><ci id="S2.E2.m2.2.2.1.1.1.3.3.cmml" xref="S2.E2.m2.2.2.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.2c">\displaystyle=\operatorname{FFN}\left(\mathbf{u}_{t}^{l}\right)+\mathbf{u}_{t}^{l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.9" class="ltx_p">where <math id="S2.p1.2.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.p1.2.m1.1a"><mi id="S2.p1.2.m1.1.1" xref="S2.p1.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m1.1b"><ci id="S2.p1.2.m1.1.1.cmml" xref="S2.p1.2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m1.1c">T</annotation></semantics></math> denotes the sequence length, <math id="S2.p1.3.m2.2" class="ltx_Math" alttext="\operatorname{Self-Att}(\cdot)" display="inline"><semantics id="S2.p1.3.m2.2a"><mrow id="S2.p1.3.m2.2.3.2" xref="S2.p1.3.m2.2.3.1.cmml"><mrow id="S2.p1.3.m2.1.1" xref="S2.p1.3.m2.1.1.cmml"><mi id="S2.p1.3.m2.1.1.2" xref="S2.p1.3.m2.1.1.2.cmml">Self</mi><mo id="S2.p1.3.m2.1.1.1" xref="S2.p1.3.m2.1.1.1.cmml">−</mo><mi id="S2.p1.3.m2.1.1.3" xref="S2.p1.3.m2.1.1.3.cmml">Att</mi></mrow><mo id="S2.p1.3.m2.2.3.2a" xref="S2.p1.3.m2.2.3.1.cmml">⁡</mo><mrow id="S2.p1.3.m2.2.3.2.1" xref="S2.p1.3.m2.2.3.1.cmml"><mo stretchy="false" id="S2.p1.3.m2.2.3.2.1.1" xref="S2.p1.3.m2.2.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p1.3.m2.2.2" xref="S2.p1.3.m2.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.p1.3.m2.2.3.2.1.2" xref="S2.p1.3.m2.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m2.2b"><apply id="S2.p1.3.m2.2.3.1.cmml" xref="S2.p1.3.m2.2.3.2"><apply id="S2.p1.3.m2.1.1.cmml" xref="S2.p1.3.m2.1.1"><minus id="S2.p1.3.m2.1.1.1.cmml" xref="S2.p1.3.m2.1.1.1"></minus><ci id="S2.p1.3.m2.1.1.2.cmml" xref="S2.p1.3.m2.1.1.2">Self</ci><ci id="S2.p1.3.m2.1.1.3.cmml" xref="S2.p1.3.m2.1.1.3">Att</ci></apply><ci id="S2.p1.3.m2.2.2.cmml" xref="S2.p1.3.m2.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m2.2c">\operatorname{Self-Att}(\cdot)</annotation></semantics></math> denotes the self-attention module, <math id="S2.p1.4.m3.2" class="ltx_Math" alttext="\operatorname{FFN}(\cdot)" display="inline"><semantics id="S2.p1.4.m3.2a"><mrow id="S2.p1.4.m3.2.3.2" xref="S2.p1.4.m3.2.3.1.cmml"><mi id="S2.p1.4.m3.1.1" xref="S2.p1.4.m3.1.1.cmml">FFN</mi><mo id="S2.p1.4.m3.2.3.2a" xref="S2.p1.4.m3.2.3.1.cmml">⁡</mo><mrow id="S2.p1.4.m3.2.3.2.1" xref="S2.p1.4.m3.2.3.1.cmml"><mo stretchy="false" id="S2.p1.4.m3.2.3.2.1.1" xref="S2.p1.4.m3.2.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p1.4.m3.2.2" xref="S2.p1.4.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.p1.4.m3.2.3.2.1.2" xref="S2.p1.4.m3.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m3.2b"><apply id="S2.p1.4.m3.2.3.1.cmml" xref="S2.p1.4.m3.2.3.2"><ci id="S2.p1.4.m3.1.1.cmml" xref="S2.p1.4.m3.1.1">FFN</ci><ci id="S2.p1.4.m3.2.2.cmml" xref="S2.p1.4.m3.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m3.2c">\operatorname{FFN}(\cdot)</annotation></semantics></math> denotes the Feed-Forward Network&nbsp;(FFN), <math id="S2.p1.5.m4.1" class="ltx_Math" alttext="\mathbf{u}_{1:T}^{l}\in\mathbb{R}^{T\times d}" display="inline"><semantics id="S2.p1.5.m4.1a"><mrow id="S2.p1.5.m4.1.1" xref="S2.p1.5.m4.1.1.cmml"><msubsup id="S2.p1.5.m4.1.1.2" xref="S2.p1.5.m4.1.1.2.cmml"><mi id="S2.p1.5.m4.1.1.2.2.2" xref="S2.p1.5.m4.1.1.2.2.2.cmml">𝐮</mi><mrow id="S2.p1.5.m4.1.1.2.2.3" xref="S2.p1.5.m4.1.1.2.2.3.cmml"><mn id="S2.p1.5.m4.1.1.2.2.3.2" xref="S2.p1.5.m4.1.1.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.p1.5.m4.1.1.2.2.3.1" xref="S2.p1.5.m4.1.1.2.2.3.1.cmml">:</mo><mi id="S2.p1.5.m4.1.1.2.2.3.3" xref="S2.p1.5.m4.1.1.2.2.3.3.cmml">T</mi></mrow><mi id="S2.p1.5.m4.1.1.2.3" xref="S2.p1.5.m4.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.p1.5.m4.1.1.1" xref="S2.p1.5.m4.1.1.1.cmml">∈</mo><msup id="S2.p1.5.m4.1.1.3" xref="S2.p1.5.m4.1.1.3.cmml"><mi id="S2.p1.5.m4.1.1.3.2" xref="S2.p1.5.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p1.5.m4.1.1.3.3" xref="S2.p1.5.m4.1.1.3.3.cmml"><mi id="S2.p1.5.m4.1.1.3.3.2" xref="S2.p1.5.m4.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p1.5.m4.1.1.3.3.1" xref="S2.p1.5.m4.1.1.3.3.1.cmml">×</mo><mi id="S2.p1.5.m4.1.1.3.3.3" xref="S2.p1.5.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m4.1b"><apply id="S2.p1.5.m4.1.1.cmml" xref="S2.p1.5.m4.1.1"><in id="S2.p1.5.m4.1.1.1.cmml" xref="S2.p1.5.m4.1.1.1"></in><apply id="S2.p1.5.m4.1.1.2.cmml" xref="S2.p1.5.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.2.1.cmml" xref="S2.p1.5.m4.1.1.2">superscript</csymbol><apply id="S2.p1.5.m4.1.1.2.2.cmml" xref="S2.p1.5.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.2.2.1.cmml" xref="S2.p1.5.m4.1.1.2">subscript</csymbol><ci id="S2.p1.5.m4.1.1.2.2.2.cmml" xref="S2.p1.5.m4.1.1.2.2.2">𝐮</ci><apply id="S2.p1.5.m4.1.1.2.2.3.cmml" xref="S2.p1.5.m4.1.1.2.2.3"><ci id="S2.p1.5.m4.1.1.2.2.3.1.cmml" xref="S2.p1.5.m4.1.1.2.2.3.1">:</ci><cn type="integer" id="S2.p1.5.m4.1.1.2.2.3.2.cmml" xref="S2.p1.5.m4.1.1.2.2.3.2">1</cn><ci id="S2.p1.5.m4.1.1.2.2.3.3.cmml" xref="S2.p1.5.m4.1.1.2.2.3.3">𝑇</ci></apply></apply><ci id="S2.p1.5.m4.1.1.2.3.cmml" xref="S2.p1.5.m4.1.1.2.3">𝑙</ci></apply><apply id="S2.p1.5.m4.1.1.3.cmml" xref="S2.p1.5.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.3.1.cmml" xref="S2.p1.5.m4.1.1.3">superscript</csymbol><ci id="S2.p1.5.m4.1.1.3.2.cmml" xref="S2.p1.5.m4.1.1.3.2">ℝ</ci><apply id="S2.p1.5.m4.1.1.3.3.cmml" xref="S2.p1.5.m4.1.1.3.3"><times id="S2.p1.5.m4.1.1.3.3.1.cmml" xref="S2.p1.5.m4.1.1.3.3.1"></times><ci id="S2.p1.5.m4.1.1.3.3.2.cmml" xref="S2.p1.5.m4.1.1.3.3.2">𝑇</ci><ci id="S2.p1.5.m4.1.1.3.3.3.cmml" xref="S2.p1.5.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m4.1c">\mathbf{u}_{1:T}^{l}\in\mathbb{R}^{T\times d}</annotation></semantics></math> are the hidden states of all tokens after the <math id="S2.p1.6.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p1.6.m5.1a"><mi id="S2.p1.6.m5.1.1" xref="S2.p1.6.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m5.1b"><ci id="S2.p1.6.m5.1.1.cmml" xref="S2.p1.6.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m5.1c">l</annotation></semantics></math>-th attention module, and <math id="S2.p1.7.m6.1" class="ltx_Math" alttext="\mathbf{h}_{t}^{l}\in\mathbb{R}^{d}" display="inline"><semantics id="S2.p1.7.m6.1a"><mrow id="S2.p1.7.m6.1.1" xref="S2.p1.7.m6.1.1.cmml"><msubsup id="S2.p1.7.m6.1.1.2" xref="S2.p1.7.m6.1.1.2.cmml"><mi id="S2.p1.7.m6.1.1.2.2.2" xref="S2.p1.7.m6.1.1.2.2.2.cmml">𝐡</mi><mi id="S2.p1.7.m6.1.1.2.2.3" xref="S2.p1.7.m6.1.1.2.2.3.cmml">t</mi><mi id="S2.p1.7.m6.1.1.2.3" xref="S2.p1.7.m6.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.p1.7.m6.1.1.1" xref="S2.p1.7.m6.1.1.1.cmml">∈</mo><msup id="S2.p1.7.m6.1.1.3" xref="S2.p1.7.m6.1.1.3.cmml"><mi id="S2.p1.7.m6.1.1.3.2" xref="S2.p1.7.m6.1.1.3.2.cmml">ℝ</mi><mi id="S2.p1.7.m6.1.1.3.3" xref="S2.p1.7.m6.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m6.1b"><apply id="S2.p1.7.m6.1.1.cmml" xref="S2.p1.7.m6.1.1"><in id="S2.p1.7.m6.1.1.1.cmml" xref="S2.p1.7.m6.1.1.1"></in><apply id="S2.p1.7.m6.1.1.2.cmml" xref="S2.p1.7.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p1.7.m6.1.1.2.1.cmml" xref="S2.p1.7.m6.1.1.2">superscript</csymbol><apply id="S2.p1.7.m6.1.1.2.2.cmml" xref="S2.p1.7.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p1.7.m6.1.1.2.2.1.cmml" xref="S2.p1.7.m6.1.1.2">subscript</csymbol><ci id="S2.p1.7.m6.1.1.2.2.2.cmml" xref="S2.p1.7.m6.1.1.2.2.2">𝐡</ci><ci id="S2.p1.7.m6.1.1.2.2.3.cmml" xref="S2.p1.7.m6.1.1.2.2.3">𝑡</ci></apply><ci id="S2.p1.7.m6.1.1.2.3.cmml" xref="S2.p1.7.m6.1.1.2.3">𝑙</ci></apply><apply id="S2.p1.7.m6.1.1.3.cmml" xref="S2.p1.7.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p1.7.m6.1.1.3.1.cmml" xref="S2.p1.7.m6.1.1.3">superscript</csymbol><ci id="S2.p1.7.m6.1.1.3.2.cmml" xref="S2.p1.7.m6.1.1.3.2">ℝ</ci><ci id="S2.p1.7.m6.1.1.3.3.cmml" xref="S2.p1.7.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m6.1c">\mathbf{h}_{t}^{l}\in\mathbb{R}^{d}</annotation></semantics></math> is the output hidden state of the <math id="S2.p1.8.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p1.8.m7.1a"><mi id="S2.p1.8.m7.1.1" xref="S2.p1.8.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m7.1b"><ci id="S2.p1.8.m7.1.1.cmml" xref="S2.p1.8.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m7.1c">t</annotation></semantics></math>-th token after the <math id="S2.p1.9.m8.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p1.9.m8.1a"><mi id="S2.p1.9.m8.1.1" xref="S2.p1.9.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m8.1b"><ci id="S2.p1.9.m8.1.1.cmml" xref="S2.p1.9.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m8.1c">l</annotation></semantics></math>-th Transformer block. For brevity, we omit the layer normalization in the above formulations.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p class="ltx_p" id="S2.p2.2">MoE 언어 모델을 구성하는 일반적인 관행은 일반적으로 지정된 간격 [cite idx=0></cite>]에서 MoE 계층으로 Transformer의 FFN을 대체한다. MoE 층은 다수의 전문가들로 구성되며, 여기서 각각의 전문가는 표준 FFN과 구조적으로 동일하다. 그런 다음, 각 토큰은 하나의 <cite class="ltx_cite ltx_citemacro_citep">(Fedus et al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite> 또는 두 개의 <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> 전문가에게 할당될 것이다. <math alttext="l" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">l</annotation></semantics></math>-th FFN이 MoE 레이어로 치환된 경우, 그 출력 히든 스테이트 <math alttext="\mathbf{h}_{t}^{l}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><msubsup id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2.2" xref="S2.p2.2.m2.1.1.2.2.cmml">𝐡</mi><mi id="S2.p2.2.m2.1.1.2.3" xref="S2.p2.2.m2.1.1.2.3.cmml">t</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">superscript</csymbol><apply id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.2.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.2.cmml" xref="S2.p2.2.m2.1.1.2.2">𝐡</ci><ci id="S2.p2.2.m2.1.1.2.3.cmml" xref="S2.p2.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathbf{h}_{t}^{l}</annotation></semantics></math>에 대한 계산은 다음과 같이 표현된다:</p>
<table id="A3.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{h}_{t}^{l}" display="inline"><semantics id="S2.E3.m1.1a"><msubsup id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mi id="S2.E3.m1.1.1.2.2" xref="S2.E3.m1.1.1.2.2.cmml">𝐡</mi><mi id="S2.E3.m1.1.1.2.3" xref="S2.E3.m1.1.1.2.3.cmml">t</mi><mi id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1">superscript</csymbol><apply id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.1.cmml" xref="S2.E3.m1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.2.2">𝐡</ci><ci id="S2.E3.m1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{N}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l}," display="inline"><semantics id="S2.E3.m2.3a"><mrow id="S2.E3.m2.3.3.1" xref="S2.E3.m2.3.3.1.1.cmml"><mrow id="S2.E3.m2.3.3.1.1" xref="S2.E3.m2.3.3.1.1.cmml"><mi id="S2.E3.m2.3.3.1.1.3" xref="S2.E3.m2.3.3.1.1.3.cmml"></mi><mo id="S2.E3.m2.3.3.1.1.2" xref="S2.E3.m2.3.3.1.1.2.cmml">=</mo><mrow id="S2.E3.m2.3.3.1.1.1" xref="S2.E3.m2.3.3.1.1.1.cmml"><mrow id="S2.E3.m2.3.3.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3.m2.3.3.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.2.cmml"><munderover id="S2.E3.m2.3.3.1.1.1.1.2a" xref="S2.E3.m2.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E3.m2.3.3.1.1.1.1.2.2.2" xref="S2.E3.m2.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.2.2.3" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.2.2.3.2" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E3.m2.3.3.1.1.1.1.2.2.3.1" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m2.3.3.1.1.1.1.2.2.3.3" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m2.3.3.1.1.1.1.2.3" xref="S2.E3.m2.3.3.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="S2.E3.m2.2.2.2.4" xref="S2.E3.m2.2.2.2.3.cmml"><mi id="S2.E3.m2.1.1.1.1" xref="S2.E3.m2.1.1.1.1.cmml">i</mi><mo id="S2.E3.m2.2.2.2.4.1" xref="S2.E3.m2.2.2.2.3.cmml">,</mo><mi id="S2.E3.m2.2.2.2.2" xref="S2.E3.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2a" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml">𝐮</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml">t</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m2.3.3.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.2.cmml">+</mo><msubsup id="S2.E3.m2.3.3.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.3.cmml"><mi id="S2.E3.m2.3.3.1.1.1.3.2.2" xref="S2.E3.m2.3.3.1.1.1.3.2.2.cmml">𝐮</mi><mi id="S2.E3.m2.3.3.1.1.1.3.2.3" xref="S2.E3.m2.3.3.1.1.1.3.2.3.cmml">t</mi><mi id="S2.E3.m2.3.3.1.1.1.3.3" xref="S2.E3.m2.3.3.1.1.1.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S2.E3.m2.3.3.1.2" xref="S2.E3.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.3b"><apply id="S2.E3.m2.3.3.1.1.cmml" xref="S2.E3.m2.3.3.1"><eq id="S2.E3.m2.3.3.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S2.E3.m2.3.3.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.3">absent</csymbol><apply id="S2.E3.m2.3.3.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1"><plus id="S2.E3.m2.3.3.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.2"></plus><apply id="S2.E3.m2.3.3.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1"><apply id="S2.E3.m2.3.3.1.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.1.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.2"></sum><apply id="S2.E3.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3"><eq id="S2.E3.m2.3.3.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m2.3.3.1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E3.m2.3.3.1.1.1.1.2.2.3.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m2.3.3.1.1.1.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1"><times id="S2.E3.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.3"></times><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2">𝑔</ci><list id="S2.E3.m2.2.2.2.3.cmml" xref="S2.E3.m2.2.2.2.4"><ci id="S2.E3.m2.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1">𝑖</ci><ci id="S2.E3.m2.2.2.2.2.cmml" xref="S2.E3.m2.2.2.2.2">𝑡</ci></list></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2"><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2">FFN</ci><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">superscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2">𝐮</ci><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3">𝑡</ci></apply><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S2.E3.m2.3.3.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.3.1.cmml" xref="S2.E3.m2.3.3.1.1.1.3">superscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.3.2.cmml" xref="S2.E3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.3.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.3.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.3.2.2">𝐮</ci><ci id="S2.E3.m2.3.3.1.1.1.3.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.3.2.3">𝑡</ci></apply><ci id="S2.E3.m2.3.3.1.1.1.3.3.cmml" xref="S2.E3.m2.3.3.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.3c">\displaystyle=\sum_{i=1}^{N}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.2" class="ltx_Math" alttext="\displaystyle g_{i,t}" display="inline"><semantics id="S2.E4.m1.2a"><msub id="S2.E4.m1.2.3" xref="S2.E4.m1.2.3.cmml"><mi id="S2.E4.m1.2.3.2" xref="S2.E4.m1.2.3.2.cmml">g</mi><mrow id="S2.E4.m1.2.2.2.4" xref="S2.E4.m1.2.2.2.3.cmml"><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">i</mi><mo id="S2.E4.m1.2.2.2.4.1" xref="S2.E4.m1.2.2.2.3.cmml">,</mo><mi id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.3.cmml" xref="S2.E4.m1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.3.1.cmml" xref="S2.E4.m1.2.3">subscript</csymbol><ci id="S2.E4.m1.2.3.2.cmml" xref="S2.E4.m1.2.3.2">𝑔</ci><list id="S2.E4.m1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.4"><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑖</ci><ci id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\displaystyle g_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.4" class="ltx_Math" alttext="\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1\leqslant j\leqslant N\},K),\\
0,&amp;\text{otherwise},\end{cases}" display="inline"><semantics id="S2.E4.m2.4a"><mrow id="S2.E4.m2.4.5" xref="S2.E4.m2.4.5.cmml"><mi id="S2.E4.m2.4.5.2" xref="S2.E4.m2.4.5.2.cmml"></mi><mo id="S2.E4.m2.4.5.1" xref="S2.E4.m2.4.5.1.cmml">=</mo><mrow id="S2.E4.m2.4.4a" xref="S2.E4.m2.4.5.3.1.cmml"><mo id="S2.E4.m2.4.4a.5" xref="S2.E4.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S2.E4.m2.4.4.4a" xref="S2.E4.m2.4.5.3.1.cmml"><mtr id="S2.E4.m2.4.4.4aa" xref="S2.E4.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4ab" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.1.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.1.3.1.cmml"><msub id="S2.E4.m2.1.1.1.1.1.1.3.1" xref="S2.E4.m2.1.1.1.1.1.1.3.1.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.3.1.2" xref="S2.E4.m2.1.1.1.1.1.1.3.1.2.cmml">s</mi><mrow id="S2.E4.m2.1.1.1.1.1.1.2.2.4" xref="S2.E4.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S2.E4.m2.1.1.1.1.1.1.2.2.4.1" xref="S2.E4.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S2.E4.m2.1.1.1.1.1.1.2.2.2" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S2.E4.m2.1.1.1.1.1.1.3.2" xref="S2.E4.m2.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4ac" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.2.2.2.2.2.1.7" xref="S2.E4.m2.2.2.2.2.2.1.7.1.cmml"><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.cmml"><msub id="S2.E4.m2.2.2.2.2.2.1.7.1.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.3.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3.2.cmml">s</mi><mrow id="S2.E4.m2.2.2.2.2.2.1.2.2.4" xref="S2.E4.m2.2.2.2.2.2.1.2.2.3.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.1.1.1.cmml">i</mi><mo id="S2.E4.m2.2.2.2.2.2.1.2.2.4.1" xref="S2.E4.m2.2.2.2.2.2.1.2.2.3.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2.2.1.2.2.2" xref="S2.E4.m2.2.2.2.2.2.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.2.cmml">∈</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.5" xref="S2.E4.m2.2.2.2.2.2.1.5.cmml">Topk</mi><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1a" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">⁡</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">(</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml">{</mo><msub id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S2.E4.m2.2.2.2.2.2.1.4.2.4" xref="S2.E4.m2.2.2.2.2.2.1.4.2.3.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.3.1.1" xref="S2.E4.m2.2.2.2.2.2.1.3.1.1.cmml">j</mi><mo id="S2.E4.m2.2.2.2.2.2.1.4.2.4.1" xref="S2.E4.m2.2.2.2.2.2.1.4.2.3.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2.2.1.4.2.2" xref="S2.E4.m2.2.2.2.2.2.1.4.2.2.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.4" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.cmml"><mn id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2.cmml">1</mn><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3.cmml">⩽</mo><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4.cmml">j</mi><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5.cmml">⩽</mo><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6.cmml">N</mi></mrow><mo stretchy="false" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.5" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2.2.1.6" xref="S2.E4.m2.2.2.2.2.2.1.6.cmml">K</mi><mo stretchy="false" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.4" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m2.2.2.2.2.2.1.7.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S2.E4.m2.4.4.4ad" xref="S2.E4.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4ae" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.3.3.3.3.1.1.3" xref="S2.E4.m2.4.5.3.1.cmml"><mn id="S2.E4.m2.3.3.3.3.1.1.1" xref="S2.E4.m2.3.3.3.3.1.1.1.cmml">0</mn><mo id="S2.E4.m2.3.3.3.3.1.1.3.1" xref="S2.E4.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4af" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.4.4.4.4.2.1.3" xref="S2.E4.m2.4.4.4.4.2.1.1a.cmml"><mtext id="S2.E4.m2.4.4.4.4.2.1.1" xref="S2.E4.m2.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S2.E4.m2.4.4.4.4.2.1.3.1" xref="S2.E4.m2.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.4b"><apply id="S2.E4.m2.4.5.cmml" xref="S2.E4.m2.4.5"><eq id="S2.E4.m2.4.5.1.cmml" xref="S2.E4.m2.4.5.1"></eq><csymbol cd="latexml" id="S2.E4.m2.4.5.2.cmml" xref="S2.E4.m2.4.5.2">absent</csymbol><apply id="S2.E4.m2.4.5.3.1.cmml" xref="S2.E4.m2.4.4a"><csymbol cd="latexml" id="S2.E4.m2.4.5.3.1.1.cmml" xref="S2.E4.m2.4.4a.5">cases</csymbol><apply id="S2.E4.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.1.3.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.1.1.3.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3.1.2">𝑠</ci><list id="S2.E4.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.4"><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1">𝑖</ci><ci id="S2.E4.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2">𝑡</ci></list></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7"><in id="S2.E4.m2.2.2.2.2.2.1.7.1.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.2"></in><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.2.2.2.1.7.1.3.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3">subscript</csymbol><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.3.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3.2">𝑠</ci><list id="S2.E4.m2.2.2.2.2.2.1.2.2.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.2.2.4"><ci id="S2.E4.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.1.1.1">𝑖</ci><ci id="S2.E4.m2.2.2.2.2.2.1.2.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.2.2.2">𝑡</ci></list></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1"><ci id="S2.E4.m2.2.2.2.2.2.1.5.cmml" xref="S2.E4.m2.2.2.2.2.2.1.5">Topk</ci><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2">𝑠</ci><list id="S2.E4.m2.2.2.2.2.2.1.4.2.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.4.2.4"><ci id="S2.E4.m2.2.2.2.2.2.1.3.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.3.1.1">𝑗</ci><ci id="S2.E4.m2.2.2.2.2.2.1.4.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.4.2.2">𝑡</ci></list></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"><and id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2a.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"></and><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2b.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"><leq id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3"></leq><cn type="integer" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2">1</cn><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4">𝑗</ci></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2c.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"><leq id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5"></leq><share href="#S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4.cmml" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2d.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"></share><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6">𝑁</ci></apply></apply></apply><ci id="S2.E4.m2.2.2.2.2.2.1.6.cmml" xref="S2.E4.m2.2.2.2.2.2.1.6">𝐾</ci></apply></apply><cn type="integer" id="S2.E4.m2.3.3.3.3.1.1.1.cmml" xref="S2.E4.m2.3.3.3.3.1.1.1">0</cn><ci id="S2.E4.m2.4.4.4.4.2.1.1a.cmml" xref="S2.E4.m2.4.4.4.4.2.1.3"><mtext id="S2.E4.m2.4.4.4.4.2.1.1.cmml" xref="S2.E4.m2.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.4c">\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1\leqslant j\leqslant N\},K),\\
0,&amp;\text{otherwise},\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.2" class="ltx_Math" alttext="\displaystyle s_{i,t}" display="inline"><semantics id="S2.E5.m1.2a"><msub id="S2.E5.m1.2.3" xref="S2.E5.m1.2.3.cmml"><mi id="S2.E5.m1.2.3.2" xref="S2.E5.m1.2.3.2.cmml">s</mi><mrow id="S2.E5.m1.2.2.2.4" xref="S2.E5.m1.2.2.2.3.cmml"><mi id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">i</mi><mo id="S2.E5.m1.2.2.2.4.1" xref="S2.E5.m1.2.2.2.3.cmml">,</mo><mi id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.3.cmml" xref="S2.E5.m1.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.3.1.cmml" xref="S2.E5.m1.2.3">subscript</csymbol><ci id="S2.E5.m1.2.3.2.cmml" xref="S2.E5.m1.2.3.2">𝑠</ci><list id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.4"><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">𝑖</ci><ci id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">\displaystyle s_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5.m2.1" class="ltx_Math" alttext="\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right)," display="inline"><semantics id="S2.E5.m2.1a"><mrow id="S2.E5.m2.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.4" xref="S2.E5.m2.1.1.1.1.4.cmml"></mi><mo id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.3.cmml">=</mo><mrow id="S2.E5.m2.1.1.1.1.2.2" xref="S2.E5.m2.1.1.1.1.2.3.cmml"><msub id="S2.E5.m2.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.1.1.2.cmml">Softmax</mi><mi id="S2.E5.m2.1.1.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E5.m2.1.1.1.1.2.2a" xref="S2.E5.m2.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S2.E5.m2.1.1.1.1.2.2.2" xref="S2.E5.m2.1.1.1.1.2.3.cmml"><mo id="S2.E5.m2.1.1.1.1.2.2.2.2" xref="S2.E5.m2.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.E5.m2.1.1.1.1.2.2.2.1" xref="S2.E5.m2.1.1.1.1.2.2.2.1.cmml"><mmultiscripts id="S2.E5.m2.1.1.1.1.2.2.2.1.2" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.cmml"><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml">𝐮</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml">t</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3.cmml">l</mi><mrow id="S2.E5.m2.1.1.1.1.2.2.2.1.2a" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.cmml"></mrow><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.2.2.2.1.1" xref="S2.E5.m2.1.1.1.1.2.2.2.1.1.cmml">​</mo><msubsup id="S2.E5.m2.1.1.1.1.2.2.2.1.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.cmml"><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2.cmml">𝐞</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.3.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S2.E5.m2.1.1.1.1.2.2.2.3" xref="S2.E5.m2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m2.1.1.1.2" xref="S2.E5.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.1b"><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1"><eq id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.4.cmml" xref="S2.E5.m2.1.1.1.1.4">absent</csymbol><apply id="S2.E5.m2.1.1.1.1.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2"><apply id="S2.E5.m2.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.2">Softmax</ci><ci id="S2.E5.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1"><times id="S2.E5.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.1"></times><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2">𝐮</ci><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3">𝑡</ci></apply><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3">𝑙</ci></apply><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.3">𝑇</ci></apply><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.3.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2">𝐞</ci><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3">𝑖</ci></apply><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.3.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.1c">\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.p2.19" class="ltx_p">where <math id="S2.p2.3.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p2.3.m1.1a"><mi id="S2.p2.3.m1.1.1" xref="S2.p2.3.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m1.1b"><ci id="S2.p2.3.m1.1.1.cmml" xref="S2.p2.3.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m1.1c">N</annotation></semantics></math> denotes the total number of experts, <math id="S2.p2.4.m2.2" class="ltx_Math" alttext="\operatorname{FFN}_{i}(\cdot)" display="inline"><semantics id="S2.p2.4.m2.2a"><mrow id="S2.p2.4.m2.2.2.1" xref="S2.p2.4.m2.2.2.2.cmml"><msub id="S2.p2.4.m2.2.2.1.1" xref="S2.p2.4.m2.2.2.1.1.cmml"><mi id="S2.p2.4.m2.2.2.1.1.2" xref="S2.p2.4.m2.2.2.1.1.2.cmml">FFN</mi><mi id="S2.p2.4.m2.2.2.1.1.3" xref="S2.p2.4.m2.2.2.1.1.3.cmml">i</mi></msub><mo id="S2.p2.4.m2.2.2.1a" xref="S2.p2.4.m2.2.2.2.cmml">⁡</mo><mrow id="S2.p2.4.m2.2.2.1.2" xref="S2.p2.4.m2.2.2.2.cmml"><mo stretchy="false" id="S2.p2.4.m2.2.2.1.2.1" xref="S2.p2.4.m2.2.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.4.m2.1.1" xref="S2.p2.4.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p2.4.m2.2.2.1.2.2" xref="S2.p2.4.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m2.2b"><apply id="S2.p2.4.m2.2.2.2.cmml" xref="S2.p2.4.m2.2.2.1"><apply id="S2.p2.4.m2.2.2.1.1.cmml" xref="S2.p2.4.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m2.2.2.1.1.1.cmml" xref="S2.p2.4.m2.2.2.1.1">subscript</csymbol><ci id="S2.p2.4.m2.2.2.1.1.2.cmml" xref="S2.p2.4.m2.2.2.1.1.2">FFN</ci><ci id="S2.p2.4.m2.2.2.1.1.3.cmml" xref="S2.p2.4.m2.2.2.1.1.3">𝑖</ci></apply><ci id="S2.p2.4.m2.1.1.cmml" xref="S2.p2.4.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m2.2c">\operatorname{FFN}_{i}(\cdot)</annotation></semantics></math> is the <math id="S2.p2.5.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.5.m3.1a"><mi id="S2.p2.5.m3.1.1" xref="S2.p2.5.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.5.m3.1b"><ci id="S2.p2.5.m3.1.1.cmml" xref="S2.p2.5.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m3.1c">i</annotation></semantics></math>-th expert FFN, <math id="S2.p2.6.m4.2" class="ltx_Math" alttext="g_{i,t}" display="inline"><semantics id="S2.p2.6.m4.2a"><msub id="S2.p2.6.m4.2.3" xref="S2.p2.6.m4.2.3.cmml"><mi id="S2.p2.6.m4.2.3.2" xref="S2.p2.6.m4.2.3.2.cmml">g</mi><mrow id="S2.p2.6.m4.2.2.2.4" xref="S2.p2.6.m4.2.2.2.3.cmml"><mi id="S2.p2.6.m4.1.1.1.1" xref="S2.p2.6.m4.1.1.1.1.cmml">i</mi><mo id="S2.p2.6.m4.2.2.2.4.1" xref="S2.p2.6.m4.2.2.2.3.cmml">,</mo><mi id="S2.p2.6.m4.2.2.2.2" xref="S2.p2.6.m4.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.6.m4.2b"><apply id="S2.p2.6.m4.2.3.cmml" xref="S2.p2.6.m4.2.3"><csymbol cd="ambiguous" id="S2.p2.6.m4.2.3.1.cmml" xref="S2.p2.6.m4.2.3">subscript</csymbol><ci id="S2.p2.6.m4.2.3.2.cmml" xref="S2.p2.6.m4.2.3.2">𝑔</ci><list id="S2.p2.6.m4.2.2.2.3.cmml" xref="S2.p2.6.m4.2.2.2.4"><ci id="S2.p2.6.m4.1.1.1.1.cmml" xref="S2.p2.6.m4.1.1.1.1">𝑖</ci><ci id="S2.p2.6.m4.2.2.2.2.cmml" xref="S2.p2.6.m4.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m4.2c">g_{i,t}</annotation></semantics></math> denotes the gate value for the <math id="S2.p2.7.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.7.m5.1a"><mi id="S2.p2.7.m5.1.1" xref="S2.p2.7.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m5.1b"><ci id="S2.p2.7.m5.1.1.cmml" xref="S2.p2.7.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m5.1c">i</annotation></semantics></math>-th expert, <math id="S2.p2.8.m6.2" class="ltx_Math" alttext="s_{i,t}" display="inline"><semantics id="S2.p2.8.m6.2a"><msub id="S2.p2.8.m6.2.3" xref="S2.p2.8.m6.2.3.cmml"><mi id="S2.p2.8.m6.2.3.2" xref="S2.p2.8.m6.2.3.2.cmml">s</mi><mrow id="S2.p2.8.m6.2.2.2.4" xref="S2.p2.8.m6.2.2.2.3.cmml"><mi id="S2.p2.8.m6.1.1.1.1" xref="S2.p2.8.m6.1.1.1.1.cmml">i</mi><mo id="S2.p2.8.m6.2.2.2.4.1" xref="S2.p2.8.m6.2.2.2.3.cmml">,</mo><mi id="S2.p2.8.m6.2.2.2.2" xref="S2.p2.8.m6.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.8.m6.2b"><apply id="S2.p2.8.m6.2.3.cmml" xref="S2.p2.8.m6.2.3"><csymbol cd="ambiguous" id="S2.p2.8.m6.2.3.1.cmml" xref="S2.p2.8.m6.2.3">subscript</csymbol><ci id="S2.p2.8.m6.2.3.2.cmml" xref="S2.p2.8.m6.2.3.2">𝑠</ci><list id="S2.p2.8.m6.2.2.2.3.cmml" xref="S2.p2.8.m6.2.2.2.4"><ci id="S2.p2.8.m6.1.1.1.1.cmml" xref="S2.p2.8.m6.1.1.1.1">𝑖</ci><ci id="S2.p2.8.m6.2.2.2.2.cmml" xref="S2.p2.8.m6.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m6.2c">s_{i,t}</annotation></semantics></math> denotes the token-to-expert affinity, <math id="S2.p2.9.m7.3" class="ltx_Math" alttext="\operatorname{Topk}(\cdot,K)" display="inline"><semantics id="S2.p2.9.m7.3a"><mrow id="S2.p2.9.m7.3.4.2" xref="S2.p2.9.m7.3.4.1.cmml"><mi id="S2.p2.9.m7.1.1" xref="S2.p2.9.m7.1.1.cmml">Topk</mi><mo id="S2.p2.9.m7.3.4.2a" xref="S2.p2.9.m7.3.4.1.cmml">⁡</mo><mrow id="S2.p2.9.m7.3.4.2.1" xref="S2.p2.9.m7.3.4.1.cmml"><mo stretchy="false" id="S2.p2.9.m7.3.4.2.1.1" xref="S2.p2.9.m7.3.4.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.9.m7.2.2" xref="S2.p2.9.m7.2.2.cmml">⋅</mo><mo id="S2.p2.9.m7.3.4.2.1.2" xref="S2.p2.9.m7.3.4.1.cmml">,</mo><mi id="S2.p2.9.m7.3.3" xref="S2.p2.9.m7.3.3.cmml">K</mi><mo stretchy="false" id="S2.p2.9.m7.3.4.2.1.3" xref="S2.p2.9.m7.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m7.3b"><apply id="S2.p2.9.m7.3.4.1.cmml" xref="S2.p2.9.m7.3.4.2"><ci id="S2.p2.9.m7.1.1.cmml" xref="S2.p2.9.m7.1.1">Topk</ci><ci id="S2.p2.9.m7.2.2.cmml" xref="S2.p2.9.m7.2.2">⋅</ci><ci id="S2.p2.9.m7.3.3.cmml" xref="S2.p2.9.m7.3.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m7.3c">\operatorname{Topk}(\cdot,K)</annotation></semantics></math> denotes the set comprising <math id="S2.p2.10.m8.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.10.m8.1a"><mi id="S2.p2.10.m8.1.1" xref="S2.p2.10.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.10.m8.1b"><ci id="S2.p2.10.m8.1.1.cmml" xref="S2.p2.10.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m8.1c">K</annotation></semantics></math> highest affinity scores among those calculated for the <math id="S2.p2.11.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p2.11.m9.1a"><mi id="S2.p2.11.m9.1.1" xref="S2.p2.11.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p2.11.m9.1b"><ci id="S2.p2.11.m9.1.1.cmml" xref="S2.p2.11.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m9.1c">t</annotation></semantics></math>-th token and all <math id="S2.p2.12.m10.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p2.12.m10.1a"><mi id="S2.p2.12.m10.1.1" xref="S2.p2.12.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.12.m10.1b"><ci id="S2.p2.12.m10.1.1.cmml" xref="S2.p2.12.m10.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m10.1c">N</annotation></semantics></math> experts, and <math id="S2.p2.13.m11.1" class="ltx_Math" alttext="\mathbf{e}_{i}^{l}" display="inline"><semantics id="S2.p2.13.m11.1a"><msubsup id="S2.p2.13.m11.1.1" xref="S2.p2.13.m11.1.1.cmml"><mi id="S2.p2.13.m11.1.1.2.2" xref="S2.p2.13.m11.1.1.2.2.cmml">𝐞</mi><mi id="S2.p2.13.m11.1.1.2.3" xref="S2.p2.13.m11.1.1.2.3.cmml">i</mi><mi id="S2.p2.13.m11.1.1.3" xref="S2.p2.13.m11.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.13.m11.1b"><apply id="S2.p2.13.m11.1.1.cmml" xref="S2.p2.13.m11.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m11.1.1.1.cmml" xref="S2.p2.13.m11.1.1">superscript</csymbol><apply id="S2.p2.13.m11.1.1.2.cmml" xref="S2.p2.13.m11.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m11.1.1.2.1.cmml" xref="S2.p2.13.m11.1.1">subscript</csymbol><ci id="S2.p2.13.m11.1.1.2.2.cmml" xref="S2.p2.13.m11.1.1.2.2">𝐞</ci><ci id="S2.p2.13.m11.1.1.2.3.cmml" xref="S2.p2.13.m11.1.1.2.3">𝑖</ci></apply><ci id="S2.p2.13.m11.1.1.3.cmml" xref="S2.p2.13.m11.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m11.1c">\mathbf{e}_{i}^{l}</annotation></semantics></math> is the centroid of the <math id="S2.p2.14.m12.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.14.m12.1a"><mi id="S2.p2.14.m12.1.1" xref="S2.p2.14.m12.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.14.m12.1b"><ci id="S2.p2.14.m12.1.1.cmml" xref="S2.p2.14.m12.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.14.m12.1c">i</annotation></semantics></math>-th expert in the <math id="S2.p2.15.m13.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p2.15.m13.1a"><mi id="S2.p2.15.m13.1.1" xref="S2.p2.15.m13.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p2.15.m13.1b"><ci id="S2.p2.15.m13.1.1.cmml" xref="S2.p2.15.m13.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.15.m13.1c">l</annotation></semantics></math>-th layer. Note that <math id="S2.p2.16.m14.2" class="ltx_Math" alttext="g_{i,t}" display="inline"><semantics id="S2.p2.16.m14.2a"><msub id="S2.p2.16.m14.2.3" xref="S2.p2.16.m14.2.3.cmml"><mi id="S2.p2.16.m14.2.3.2" xref="S2.p2.16.m14.2.3.2.cmml">g</mi><mrow id="S2.p2.16.m14.2.2.2.4" xref="S2.p2.16.m14.2.2.2.3.cmml"><mi id="S2.p2.16.m14.1.1.1.1" xref="S2.p2.16.m14.1.1.1.1.cmml">i</mi><mo id="S2.p2.16.m14.2.2.2.4.1" xref="S2.p2.16.m14.2.2.2.3.cmml">,</mo><mi id="S2.p2.16.m14.2.2.2.2" xref="S2.p2.16.m14.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.16.m14.2b"><apply id="S2.p2.16.m14.2.3.cmml" xref="S2.p2.16.m14.2.3"><csymbol cd="ambiguous" id="S2.p2.16.m14.2.3.1.cmml" xref="S2.p2.16.m14.2.3">subscript</csymbol><ci id="S2.p2.16.m14.2.3.2.cmml" xref="S2.p2.16.m14.2.3.2">𝑔</ci><list id="S2.p2.16.m14.2.2.2.3.cmml" xref="S2.p2.16.m14.2.2.2.4"><ci id="S2.p2.16.m14.1.1.1.1.cmml" xref="S2.p2.16.m14.1.1.1.1">𝑖</ci><ci id="S2.p2.16.m14.2.2.2.2.cmml" xref="S2.p2.16.m14.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.16.m14.2c">g_{i,t}</annotation></semantics></math> is sparse, indicating that only <math id="S2.p2.17.m15.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.17.m15.1a"><mi id="S2.p2.17.m15.1.1" xref="S2.p2.17.m15.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.17.m15.1b"><ci id="S2.p2.17.m15.1.1.cmml" xref="S2.p2.17.m15.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.17.m15.1c">K</annotation></semantics></math> out of <math id="S2.p2.18.m16.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p2.18.m16.1a"><mi id="S2.p2.18.m16.1.1" xref="S2.p2.18.m16.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.18.m16.1b"><ci id="S2.p2.18.m16.1.1.cmml" xref="S2.p2.18.m16.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.18.m16.1c">N</annotation></semantics></math> gate values are nonzero. This sparsity property ensures computational efficiency within an MoE layer, i.e., each token will be assigned to and computed in only <math id="S2.p2.19.m17.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.19.m17.1a"><mi id="S2.p2.19.m17.1.1" xref="S2.p2.19.m17.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.19.m17.1b"><ci id="S2.p2.19.m17.1.1.cmml" xref="S2.p2.19.m17.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.19.m17.1c">K</annotation></semantics></math> experts. Also, in the above formulations, we omit the layer normalization operation for brevity.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="221" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 2:</span></figcaption>
Illustration of DeepSeekMoE.
Subfigure (a) showcases an MoE layer with the conventional top-2 routing strategy.
Subfigure (b) illustrates the fine-grained expert segmentation strategy.
Subsequently, subfigure (c) demonstrates the integration of the shared expert isolation strategy, constituting the complete DeepSeekMoE architecture.
It is noteworthy that across these three architectures, the number of expert parameters and computational costs remain constant.
</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>DeepSeekMoE Architecture</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p" id="S3.p1.1">섹션 <a class="ltx_ref" href="#S2" title="2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>에 요약된 일반적인 MoE 아키텍처 위에 전문가 전문화의 잠재력을 활용하기 위해 특별히 설계된 DeepSeekMoE를 소개한다. <a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>에 예시된 바와 같이, 우리의 아키텍처는 세밀한 전문가 분할과 공유 전문가 격리의 두 가지 주요 전략을 통합한다. 이 두 가지 전략은 모두 전문가 전문화의 수준을 높이기 위해 고안되었다.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Fine-Grained Expert Segmentation</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS1.p1.1">전문가 수가 제한된 시나리오에서 특정 전문가에게 할당된 토큰은 다양한 유형의 지식을 다룰 가능성이 더 높다. 이에 따라 지정 전문가는 매개 변수에서 매우 다양한 유형의 지식을 학습할 계획이며 동시에 활용되기 어렵다. 그러나 각 토큰이 더 많은 전문가에게 라우팅될 수 있다면 다양한 지식은 각각 다른 전문가에서 분해되고 학습될 잠재력을 얻을 것이다. 이러한 맥락에서 각 전문가는 여전히 높은 수준의 전문가 전문화를 유지할 수 있어 전문가 전반에 걸쳐 보다 집중된 지식 분배에 기여할 수 있다.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p class="ltx_p" id="S3.SS1.p2.3">목표 달성을 위해 일관된 수의 전문가 매개변수와 계산 비용을 유지하면서 더 미세한 그레인으로 전문가를 분할한다. 더 미세한 전문가 세분화는 활성화된 전문가의 보다 유연하고 적응 가능한 조합을 가능하게 한다. 구체적으로, 그림 <a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(a)에 도시된 전형적인 MoE 아키텍처 위에, FFN 중간 은닉 차원을 원래 크기의 <math alttext="\frac{1}{m}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mfrac id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mn id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">1</mn><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">m</mi></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><divide id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"></divide><cn id="S3.SS1.p2.2.m2.1.1.2.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.2">1</cn><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\frac{1}{m}</annotation></semantics></math>배로 줄임으로써 각 전문가 FFN을 <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">m</annotation></semantics></math> 더 작은 전문가로 분할한다. 각 전문가가 작아지기 때문에, 이에 응답하여, 그림 <a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(b)에 예시된 바와 같이, 동일한 계산 비용을 유지하기 위해 활성화된 전문가의 수를 <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">m</annotation></semantics></math> 시간으로 증가시킨다. 미세-결정화된 전문가 세그먼테이션에 의해, MoE 레이어의 출력은 다음과 같이 표현될 수 있다:</p>
<table id="A3.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{h}_{t}^{l}" display="inline"><semantics id="S3.E6.m1.1a"><msubsup id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3.cmml">t</mi><mi id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1">superscript</csymbol><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2">𝐡</ci><ci id="S3.E6.m1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l}," display="inline"><semantics id="S3.E6.m2.3a"><mrow id="S3.E6.m2.3.3.1" xref="S3.E6.m2.3.3.1.1.cmml"><mrow id="S3.E6.m2.3.3.1.1" xref="S3.E6.m2.3.3.1.1.cmml"><mi id="S3.E6.m2.3.3.1.1.3" xref="S3.E6.m2.3.3.1.1.3.cmml"></mi><mo id="S3.E6.m2.3.3.1.1.2" xref="S3.E6.m2.3.3.1.1.2.cmml">=</mo><mrow id="S3.E6.m2.3.3.1.1.1" xref="S3.E6.m2.3.3.1.1.1.cmml"><mrow id="S3.E6.m2.3.3.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E6.m2.3.3.1.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.1.2.cmml"><munderover id="S3.E6.m2.3.3.1.1.1.1.2a" xref="S3.E6.m2.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E6.m2.3.3.1.1.1.1.2.2.2" xref="S3.E6.m2.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.2.2.3" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.2.2.3.2" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E6.m2.3.3.1.1.1.1.2.2.3.1" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m2.3.3.1.1.1.1.2.2.3.3" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m2.3.3.1.1.1.1.2.3" xref="S3.E6.m2.3.3.1.1.1.1.2.3.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.2.3.2" xref="S3.E6.m2.3.3.1.1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E6.m2.3.3.1.1.1.1.2.3.1" xref="S3.E6.m2.3.3.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m2.3.3.1.1.1.1.2.3.3" xref="S3.E6.m2.3.3.1.1.1.1.2.3.3.cmml">N</mi></mrow></munderover></mstyle><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="S3.E6.m2.2.2.2.4" xref="S3.E6.m2.2.2.2.3.cmml"><mi id="S3.E6.m2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml">i</mi><mo id="S3.E6.m2.2.2.2.4.1" xref="S3.E6.m2.2.2.2.3.cmml">,</mo><mi id="S3.E6.m2.2.2.2.2" xref="S3.E6.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2a" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml">𝐮</mi><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml">t</mi><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m2.3.3.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.2.cmml">+</mo><msubsup id="S3.E6.m2.3.3.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.3.cmml"><mi id="S3.E6.m2.3.3.1.1.1.3.2.2" xref="S3.E6.m2.3.3.1.1.1.3.2.2.cmml">𝐮</mi><mi id="S3.E6.m2.3.3.1.1.1.3.2.3" xref="S3.E6.m2.3.3.1.1.1.3.2.3.cmml">t</mi><mi id="S3.E6.m2.3.3.1.1.1.3.3" xref="S3.E6.m2.3.3.1.1.1.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S3.E6.m2.3.3.1.2" xref="S3.E6.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.3b"><apply id="S3.E6.m2.3.3.1.1.cmml" xref="S3.E6.m2.3.3.1"><eq id="S3.E6.m2.3.3.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E6.m2.3.3.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.3">absent</csymbol><apply id="S3.E6.m2.3.3.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1"><plus id="S3.E6.m2.3.3.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.2"></plus><apply id="S3.E6.m2.3.3.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1"><apply id="S3.E6.m2.3.3.1.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E6.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E6.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3"><eq id="S3.E6.m2.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m2.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m2.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E6.m2.3.3.1.1.1.1.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3"><times id="S3.E6.m2.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3.1"></times><ci id="S3.E6.m2.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3.2">𝑚</ci><ci id="S3.E6.m2.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3.3">𝑁</ci></apply></apply><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1"><times id="S3.E6.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.3"></times><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2">𝑔</ci><list id="S3.E6.m2.2.2.2.3.cmml" xref="S3.E6.m2.2.2.2.4"><ci id="S3.E6.m2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1">𝑖</ci><ci id="S3.E6.m2.2.2.2.2.cmml" xref="S3.E6.m2.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2"><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2">FFN</ci><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">superscript</csymbol><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2">𝐮</ci><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3">𝑡</ci></apply><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.E6.m2.3.3.1.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.3.1.cmml" xref="S3.E6.m2.3.3.1.1.1.3">superscript</csymbol><apply id="S3.E6.m2.3.3.1.1.1.3.2.cmml" xref="S3.E6.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.3.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.3.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.3.2.2">𝐮</ci><ci id="S3.E6.m2.3.3.1.1.1.3.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E6.m2.3.3.1.1.1.3.3.cmml" xref="S3.E6.m2.3.3.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.3c">\displaystyle=\sum_{i=1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.2" class="ltx_Math" alttext="\displaystyle g_{i,t}" display="inline"><semantics id="S3.E7.m1.2a"><msub id="S3.E7.m1.2.3" xref="S3.E7.m1.2.3.cmml"><mi id="S3.E7.m1.2.3.2" xref="S3.E7.m1.2.3.2.cmml">g</mi><mrow id="S3.E7.m1.2.2.2.4" xref="S3.E7.m1.2.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.2.2.2.4.1" xref="S3.E7.m1.2.2.2.3.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.3.cmml" xref="S3.E7.m1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.1.cmml" xref="S3.E7.m1.2.3">subscript</csymbol><ci id="S3.E7.m1.2.3.2.cmml" xref="S3.E7.m1.2.3.2">𝑔</ci><list id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.4"><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑖</ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\displaystyle g_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7.m2.4" class="ltx_Math" alttext="\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1\leqslant j\leqslant mN\},mK),\\
0,&amp;\text{otherwise},\end{cases}" display="inline"><semantics id="S3.E7.m2.4a"><mrow id="S3.E7.m2.4.5" xref="S3.E7.m2.4.5.cmml"><mi id="S3.E7.m2.4.5.2" xref="S3.E7.m2.4.5.2.cmml"></mi><mo id="S3.E7.m2.4.5.1" xref="S3.E7.m2.4.5.1.cmml">=</mo><mrow id="S3.E7.m2.4.4a" xref="S3.E7.m2.4.5.3.1.cmml"><mo id="S3.E7.m2.4.4a.5" xref="S3.E7.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S3.E7.m2.4.4.4a" xref="S3.E7.m2.4.5.3.1.cmml"><mtr id="S3.E7.m2.4.4.4aa" xref="S3.E7.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4ab" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.1.1.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.1.1.3.1.cmml"><msub id="S3.E7.m2.1.1.1.1.1.1.3.1" xref="S3.E7.m2.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.3.1.2" xref="S3.E7.m2.1.1.1.1.1.1.3.1.2.cmml">s</mi><mrow id="S3.E7.m2.1.1.1.1.1.1.2.2.4" xref="S3.E7.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m2.1.1.1.1.1.1.2.2.4.1" xref="S3.E7.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S3.E7.m2.1.1.1.1.1.1.2.2.2" xref="S3.E7.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E7.m2.1.1.1.1.1.1.3.2" xref="S3.E7.m2.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4ac" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.2.2.2.2.2.1.6" xref="S3.E7.m2.2.2.2.2.2.1.6.1.cmml"><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.cmml"><msub id="S3.E7.m2.2.2.2.2.2.1.6.1.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.4.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4.2.cmml">s</mi><mrow id="S3.E7.m2.2.2.2.2.2.1.2.2.4" xref="S3.E7.m2.2.2.2.2.2.1.2.2.3.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.1.1.1" xref="S3.E7.m2.2.2.2.2.2.1.1.1.1.cmml">i</mi><mo id="S3.E7.m2.2.2.2.2.2.1.2.2.4.1" xref="S3.E7.m2.2.2.2.2.2.1.2.2.3.cmml">,</mo><mi id="S3.E7.m2.2.2.2.2.2.1.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.3.cmml">∈</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.5" xref="S3.E7.m2.2.2.2.2.2.1.5.cmml">Topk</mi><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2a" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">⁡</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mo stretchy="false" id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">(</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">{</mo><msub id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E7.m2.2.2.2.2.2.1.4.2.4" xref="S3.E7.m2.2.2.2.2.2.1.4.2.3.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.3.1.1" xref="S3.E7.m2.2.2.2.2.2.1.3.1.1.cmml">j</mi><mo id="S3.E7.m2.2.2.2.2.2.1.4.2.4.1" xref="S3.E7.m2.2.2.2.2.2.1.4.2.3.cmml">,</mo><mi id="S3.E7.m2.2.2.2.2.2.1.4.2.2" xref="S3.E7.m2.2.2.2.2.2.1.4.2.2.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml"><mn id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml">1</mn><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml">⩽</mo><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml">j</mi><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml">⩽</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml">​</mo><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml">N</mi></mrow></mrow><mo stretchy="false" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.5" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">,</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml">​</mo><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml">K</mi></mrow><mo stretchy="false" id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.5" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m2.2.2.2.2.2.1.6.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E7.m2.4.4.4ad" xref="S3.E7.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4ae" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.3.3.3.3.1.1.3" xref="S3.E7.m2.4.5.3.1.cmml"><mn id="S3.E7.m2.3.3.3.3.1.1.1" xref="S3.E7.m2.3.3.3.3.1.1.1.cmml">0</mn><mo id="S3.E7.m2.3.3.3.3.1.1.3.1" xref="S3.E7.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4af" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.4.4.4.4.2.1.3" xref="S3.E7.m2.4.4.4.4.2.1.1a.cmml"><mtext id="S3.E7.m2.4.4.4.4.2.1.1" xref="S3.E7.m2.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S3.E7.m2.4.4.4.4.2.1.3.1" xref="S3.E7.m2.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.4b"><apply id="S3.E7.m2.4.5.cmml" xref="S3.E7.m2.4.5"><eq id="S3.E7.m2.4.5.1.cmml" xref="S3.E7.m2.4.5.1"></eq><csymbol cd="latexml" id="S3.E7.m2.4.5.2.cmml" xref="S3.E7.m2.4.5.2">absent</csymbol><apply id="S3.E7.m2.4.5.3.1.cmml" xref="S3.E7.m2.4.4a"><csymbol cd="latexml" id="S3.E7.m2.4.5.3.1.1.cmml" xref="S3.E7.m2.4.4a.5">cases</csymbol><apply id="S3.E7.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m2.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3.1.2">𝑠</ci><list id="S3.E7.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.2.4"><ci id="S3.E7.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E7.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.2.2">𝑡</ci></list></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6"><in id="S3.E7.m2.2.2.2.2.2.1.6.1.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.3"></in><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.4.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4"><csymbol cd="ambiguous" id="S3.E7.m2.2.2.2.2.2.1.6.1.4.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4">subscript</csymbol><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.4.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4.2">𝑠</ci><list id="S3.E7.m2.2.2.2.2.2.1.2.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.2.2.4"><ci id="S3.E7.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.1.1.1">𝑖</ci><ci id="S3.E7.m2.2.2.2.2.2.1.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.2.2.2">𝑡</ci></list></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2"><ci id="S3.E7.m2.2.2.2.2.2.1.5.cmml" xref="S3.E7.m2.2.2.2.2.2.1.5">Topk</ci><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2">𝑠</ci><list id="S3.E7.m2.2.2.2.2.2.1.4.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.4.2.4"><ci id="S3.E7.m2.2.2.2.2.2.1.3.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.3.1.1">𝑗</ci><ci id="S3.E7.m2.2.2.2.2.2.1.4.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.4.2.2">𝑡</ci></list></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><and id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2a.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></and><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2b.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3"></leq><cn type="integer" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2">1</cn><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4">𝑗</ci></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2c.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5"></leq><share href="#S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2d.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></share><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6"><times id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1"></times><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2">𝑚</ci><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3">𝑁</ci></apply></apply></apply></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2"><times id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1"></times><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2">𝑚</ci><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3">𝐾</ci></apply></apply></apply><cn type="integer" id="S3.E7.m2.3.3.3.3.1.1.1.cmml" xref="S3.E7.m2.3.3.3.3.1.1.1">0</cn><ci id="S3.E7.m2.4.4.4.4.2.1.1a.cmml" xref="S3.E7.m2.4.4.4.4.2.1.3"><mtext id="S3.E7.m2.4.4.4.4.2.1.1.cmml" xref="S3.E7.m2.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.4c">\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1\leqslant j\leqslant mN\},mK),\\
0,&amp;\text{otherwise},\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.2" class="ltx_Math" alttext="\displaystyle s_{i,t}" display="inline"><semantics id="S3.E8.m1.2a"><msub id="S3.E8.m1.2.3" xref="S3.E8.m1.2.3.cmml"><mi id="S3.E8.m1.2.3.2" xref="S3.E8.m1.2.3.2.cmml">s</mi><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">i</mi><mo id="S3.E8.m1.2.2.2.4.1" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.3.cmml" xref="S3.E8.m1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.1.cmml" xref="S3.E8.m1.2.3">subscript</csymbol><ci id="S3.E8.m1.2.3.2.cmml" xref="S3.E8.m1.2.3.2">𝑠</ci><list id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.4"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑖</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">\displaystyle s_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8.m2.1" class="ltx_Math" alttext="\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right)," display="inline"><semantics id="S3.E8.m2.1a"><mrow id="S3.E8.m2.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mrow id="S3.E8.m2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.4" xref="S3.E8.m2.1.1.1.1.4.cmml"></mi><mo id="S3.E8.m2.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E8.m2.1.1.1.1.2.2" xref="S3.E8.m2.1.1.1.1.2.3.cmml"><msub id="S3.E8.m2.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.1.1.2.cmml">Softmax</mi><mi id="S3.E8.m2.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m2.1.1.1.1.2.2a" xref="S3.E8.m2.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2" xref="S3.E8.m2.1.1.1.1.2.3.cmml"><mo id="S3.E8.m2.1.1.1.1.2.2.2.2" xref="S3.E8.m2.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2.1" xref="S3.E8.m2.1.1.1.1.2.2.2.1.cmml"><mmultiscripts id="S3.E8.m2.1.1.1.1.2.2.2.1.2" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml">𝐮</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml">t</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3.cmml">l</mi><mrow id="S3.E8.m2.1.1.1.1.2.2.2.1.2a" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.cmml"></mrow><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E8.m2.1.1.1.1.2.2.2.1.1" xref="S3.E8.m2.1.1.1.1.2.2.2.1.1.cmml">​</mo><msubsup id="S3.E8.m2.1.1.1.1.2.2.2.1.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2.cmml">𝐞</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.3.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S3.E8.m2.1.1.1.1.2.2.2.3" xref="S3.E8.m2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m2.1.1.1.2" xref="S3.E8.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.1b"><apply id="S3.E8.m2.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1"><eq id="S3.E8.m2.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E8.m2.1.1.1.1.4.cmml" xref="S3.E8.m2.1.1.1.1.4">absent</csymbol><apply id="S3.E8.m2.1.1.1.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2"><apply id="S3.E8.m2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.2">Softmax</ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1"><times id="S3.E8.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.1"></times><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2">𝐮</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3">𝑡</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3">𝑙</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.3">𝑇</ci></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.3.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2">𝐞</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3">𝑖</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.3.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.1c">\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.6">여기서, 전문가 파라미터들의 총 수는 표준 FFN에서의 파라미터들의 수의 <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m1.1"><semantics id="S3.SS1.p2.4.m1.1a"><mi id="S3.SS1.p2.4.m1.1.1" xref="S3.SS1.p2.4.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m1.1b"><ci id="S3.SS1.p2.4.m1.1.1.cmml" xref="S3.SS1.p2.4.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m1.1c">N</annotation></semantics></math> 배와 동일하고, <math alttext="mN" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m2.1"><semantics id="S3.SS1.p2.5.m2.1a"><mrow id="S3.SS1.p2.5.m2.1.1" xref="S3.SS1.p2.5.m2.1.1.cmml"><mi id="S3.SS1.p2.5.m2.1.1.2" xref="S3.SS1.p2.5.m2.1.1.2.cmml">m</mi><mo id="S3.SS1.p2.5.m2.1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p2.5.m2.1.1.1.cmml">​</mo><mi id="S3.SS1.p2.5.m2.1.1.3" xref="S3.SS1.p2.5.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m2.1b"><apply id="S3.SS1.p2.5.m2.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1"><times id="S3.SS1.p2.5.m2.1.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1.1"></times><ci id="S3.SS1.p2.5.m2.1.1.2.cmml" xref="S3.SS1.p2.5.m2.1.1.2">𝑚</ci><ci id="S3.SS1.p2.5.m2.1.1.3.cmml" xref="S3.SS1.p2.5.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m2.1c">mN</annotation></semantics></math>는 세분화된 전문가들의 총 수를 나타낸다. 세립화된 전문가 세분화 전략에 의해, 0이 아닌 게이트의 수는 또한 <math alttext="mK" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m3.1"><semantics id="S3.SS1.p2.6.m3.1a"><mrow id="S3.SS1.p2.6.m3.1.1" xref="S3.SS1.p2.6.m3.1.1.cmml"><mi id="S3.SS1.p2.6.m3.1.1.2" xref="S3.SS1.p2.6.m3.1.1.2.cmml">m</mi><mo id="S3.SS1.p2.6.m3.1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p2.6.m3.1.1.1.cmml">​</mo><mi id="S3.SS1.p2.6.m3.1.1.3" xref="S3.SS1.p2.6.m3.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m3.1b"><apply id="S3.SS1.p2.6.m3.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1"><times id="S3.SS1.p2.6.m3.1.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1.1"></times><ci id="S3.SS1.p2.6.m3.1.1.2.cmml" xref="S3.SS1.p2.6.m3.1.1.2">𝑚</ci><ci id="S3.SS1.p2.6.m3.1.1.3.cmml" xref="S3.SS1.p2.6.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m3.1c">mK</annotation></semantics></math>로 증가할 것이다.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p class="ltx_p" id="S3.SS1.p3.4">조합적 관점에서 세분화된 전문가 세분화 전략은 활성화된 전문가의 조합적 유연성을 실질적으로 향상시킨다. 예시적인 예로서, <math alttext="N=16" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">N</mi><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><eq id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></eq><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑁</ci><cn id="S3.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">N=16</annotation></semantics></math>인 경우를 고려한다. 전형적인 top-2 라우팅 전략은 <math alttext="\binom{16}{2}=120" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.2"><semantics id="S3.SS1.p3.2.m2.2a"><mrow id="S3.SS1.p3.2.m2.2.3" xref="S3.SS1.p3.2.m2.2.3.cmml"><mrow id="S3.SS1.p3.2.m2.2.2.4" xref="S3.SS1.p3.2.m2.2.2.3.cmml"><mo id="S3.SS1.p3.2.m2.2.2.4.1" xref="S3.SS1.p3.2.m2.2.2.3.1.cmml">(</mo><mfrac id="S3.SS1.p3.2.m2.2.2.2.2" linethickness="0pt" xref="S3.SS1.p3.2.m2.2.2.3.cmml"><mn id="S3.SS1.p3.2.m2.1.1.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.cmml">16</mn><mn id="S3.SS1.p3.2.m2.2.2.2.2.2.1" xref="S3.SS1.p3.2.m2.2.2.2.2.2.1.cmml">2</mn></mfrac><mo id="S3.SS1.p3.2.m2.2.2.4.2" xref="S3.SS1.p3.2.m2.2.2.3.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.2.m2.2.3.1" xref="S3.SS1.p3.2.m2.2.3.1.cmml">=</mo><mn id="S3.SS1.p3.2.m2.2.3.2" xref="S3.SS1.p3.2.m2.2.3.2.cmml">120</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.2b"><apply id="S3.SS1.p3.2.m2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.3"><eq id="S3.SS1.p3.2.m2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.3.1"></eq><apply id="S3.SS1.p3.2.m2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.4"><csymbol cd="latexml" id="S3.SS1.p3.2.m2.2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.2.4.1">binomial</csymbol><cn id="S3.SS1.p3.2.m2.1.1.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1">16</cn><cn id="S3.SS1.p3.2.m2.2.2.2.2.2.1.cmml" type="integer" xref="S3.SS1.p3.2.m2.2.2.2.2.2.1">2</cn></apply><cn id="S3.SS1.p3.2.m2.2.3.2.cmml" type="integer" xref="S3.SS1.p3.2.m2.2.3.2">120</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">\binom{16}{2}=120</annotation></semantics></math> 가능한 조합들을 산출할 수 있다. 대조적으로, 각 전문가가 <math alttext="4" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mn id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><cn id="S3.SS1.p3.3.m3.1.1.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">4</annotation></semantics></math> 더 작은 전문가로 분할되면, 세밀한 라우팅 전략은 <math alttext="\binom{64}{8}=4,426,165,368" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.6"><semantics id="S3.SS1.p3.4.m4.6a"><mrow id="S3.SS1.p3.4.m4.6.7" xref="S3.SS1.p3.4.m4.6.7.cmml"><mrow id="S3.SS1.p3.4.m4.2.2.4" xref="S3.SS1.p3.4.m4.2.2.3.cmml"><mo id="S3.SS1.p3.4.m4.2.2.4.1" xref="S3.SS1.p3.4.m4.2.2.3.1.cmml">(</mo><mfrac id="S3.SS1.p3.4.m4.2.2.2.2" linethickness="0pt" xref="S3.SS1.p3.4.m4.2.2.3.cmml"><mn id="S3.SS1.p3.4.m4.1.1.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml">64</mn><mn id="S3.SS1.p3.4.m4.2.2.2.2.2.1" xref="S3.SS1.p3.4.m4.2.2.2.2.2.1.cmml">8</mn></mfrac><mo id="S3.SS1.p3.4.m4.2.2.4.2" xref="S3.SS1.p3.4.m4.2.2.3.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.4.m4.6.7.1" xref="S3.SS1.p3.4.m4.6.7.1.cmml">=</mo><mrow id="S3.SS1.p3.4.m4.6.7.2.2" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml"><mn id="S3.SS1.p3.4.m4.3.3" xref="S3.SS1.p3.4.m4.3.3.cmml">4</mn><mo id="S3.SS1.p3.4.m4.6.7.2.2.1" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml">,</mo><mn id="S3.SS1.p3.4.m4.4.4" xref="S3.SS1.p3.4.m4.4.4.cmml">426</mn><mo id="S3.SS1.p3.4.m4.6.7.2.2.2" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml">,</mo><mn id="S3.SS1.p3.4.m4.5.5" xref="S3.SS1.p3.4.m4.5.5.cmml">165</mn><mo id="S3.SS1.p3.4.m4.6.7.2.2.3" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml">,</mo><mn id="S3.SS1.p3.4.m4.6.6" xref="S3.SS1.p3.4.m4.6.6.cmml">368</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.6b"><apply id="S3.SS1.p3.4.m4.6.7.cmml" xref="S3.SS1.p3.4.m4.6.7"><eq id="S3.SS1.p3.4.m4.6.7.1.cmml" xref="S3.SS1.p3.4.m4.6.7.1"></eq><apply id="S3.SS1.p3.4.m4.2.2.3.cmml" xref="S3.SS1.p3.4.m4.2.2.4"><csymbol cd="latexml" id="S3.SS1.p3.4.m4.2.2.3.1.cmml" xref="S3.SS1.p3.4.m4.2.2.4.1">binomial</csymbol><cn id="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1">64</cn><cn id="S3.SS1.p3.4.m4.2.2.2.2.2.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.2.2.2.2.2.1">8</cn></apply><list id="S3.SS1.p3.4.m4.6.7.2.1.cmml" xref="S3.SS1.p3.4.m4.6.7.2.2"><cn id="S3.SS1.p3.4.m4.3.3.cmml" type="integer" xref="S3.SS1.p3.4.m4.3.3">4</cn><cn id="S3.SS1.p3.4.m4.4.4.cmml" type="integer" xref="S3.SS1.p3.4.m4.4.4">426</cn><cn id="S3.SS1.p3.4.m4.5.5.cmml" type="integer" xref="S3.SS1.p3.4.m4.5.5">165</cn><cn id="S3.SS1.p3.4.m4.6.6.cmml" type="integer" xref="S3.SS1.p3.4.m4.6.6">368</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.6c">\binom{64}{8}=4,426,165,368</annotation></semantics></math> 잠재적 조합을 산출할 수 있다. 조합 유연성의 급증은 보다 정확하고 목표된 지식 획득을 달성할 수 있는 잠재력을 향상시킨다.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Shared Expert Isolation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS2.p1.1">기존의 라우팅 전략을 사용하면 서로 다른 전문가에게 할당된 토큰이 몇 가지 일반적인 지식이나 정보를 필요로 할 수 있습니다. 그 결과, 다수의 전문가가 각자의 파라미터에서 공유된 지식을 획득하는 데 수렴할 수 있고, 그에 따라 전문가 파라미터에서 중복이 발생할 수 있다. 그러나 다양한 컨텍스트에 걸쳐 공통 지식을 캡처하고 통합하는 데 전념하는 공유 전문가가 있는 경우 라우팅된 다른 전문가 간의 매개변수 중복성이 완화된다. 이러한 중복성 완화는 보다 전문화된 전문가와 함께 보다 모수 효율적인 모델에 기여할 것이다.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p class="ltx_p" id="S3.SS2.p2.2">이 목적을 위해 세밀한 전문가 세분화 전략 외에도 <math alttext="K_{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐾</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">K_{s}</annotation></semantics></math> 전문가를 추가로 분리하여 공유 전문가 역할을 한다. 라우터 모듈에 관계없이 각 토큰은 이러한 공유 전문가에게 결정적으로 할당됩니다. 일정한 계산 비용을 유지하기 위해, 다른 라우팅된 전문가들 중 활성화된 전문가의 수는 그림 <a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Preliminaries: Mixture-of-Experts for Transformers ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(c)에 도시된 바와 같이 <math alttext="K_{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐾</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">K_{s}</annotation></semantics></math>만큼 감소될 것이다. 공유된 전문가 격리 전략이 통합된 상태에서, 완전한 DeepSeekMoE 아키텍처 내의 MoE 계층은 다음과 같이 공식화된다:</p>
<table id="A3.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{h}_{t}^{l}" display="inline"><semantics id="S3.E9.m1.1a"><msubsup id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mi id="S3.E9.m1.1.1.2.2" xref="S3.E9.m1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E9.m1.1.1.2.3" xref="S3.E9.m1.1.1.2.3.cmml">t</mi><mi id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1">superscript</csymbol><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2.2">𝐡</ci><ci id="S3.E9.m1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{K_{s}}{\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}+\sum_{i=K_{s}+1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l}," display="inline"><semantics id="S3.E9.m2.3a"><mrow id="S3.E9.m2.3.3.1" xref="S3.E9.m2.3.3.1.1.cmml"><mrow id="S3.E9.m2.3.3.1.1" xref="S3.E9.m2.3.3.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.5" xref="S3.E9.m2.3.3.1.1.5.cmml"></mi><mo id="S3.E9.m2.3.3.1.1.4" xref="S3.E9.m2.3.3.1.1.4.cmml">=</mo><mrow id="S3.E9.m2.3.3.1.1.3" xref="S3.E9.m2.3.3.1.1.3.cmml"><mrow id="S3.E9.m2.3.3.1.1.2.2" xref="S3.E9.m2.3.3.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E9.m2.3.3.1.1.2.2.3" xref="S3.E9.m2.3.3.1.1.2.2.3.cmml"><munderover id="S3.E9.m2.3.3.1.1.2.2.3a" xref="S3.E9.m2.3.3.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E9.m2.3.3.1.1.2.2.3.2.2" xref="S3.E9.m2.3.3.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E9.m2.3.3.1.1.2.2.3.2.3" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.2.2.3.2.3.2" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E9.m2.3.3.1.1.2.2.3.2.3.1" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E9.m2.3.3.1.1.2.2.3.2.3.3" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E9.m2.3.3.1.1.2.2.3.3" xref="S3.E9.m2.3.3.1.1.2.2.3.3.cmml"><mi id="S3.E9.m2.3.3.1.1.2.2.3.3.2" xref="S3.E9.m2.3.3.1.1.2.2.3.3.2.cmml">K</mi><mi id="S3.E9.m2.3.3.1.1.2.2.3.3.3" xref="S3.E9.m2.3.3.1.1.2.2.3.3.3.cmml">s</mi></msub></munderover></mstyle><mrow id="S3.E9.m2.3.3.1.1.2.2.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml"><msub id="S3.E9.m2.3.3.1.1.1.1.1.1.1" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.1.1.1.1.1.2" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S3.E9.m2.3.3.1.1.1.1.1.1.1.3" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m2.3.3.1.1.2.2.2.2a" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E9.m2.3.3.1.1.2.2.2.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml"><mo id="S3.E9.m2.3.3.1.1.2.2.2.2.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.cmml"><mi id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2.cmml">𝐮</mi><mi id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3.cmml">t</mi><mi id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S3.E9.m2.3.3.1.1.2.2.2.2.2.3" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m2.3.3.1.1.3.4" xref="S3.E9.m2.3.3.1.1.3.4.cmml">+</mo><mrow id="S3.E9.m2.3.3.1.1.3.3" xref="S3.E9.m2.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E9.m2.3.3.1.1.3.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.cmml"><munderover id="S3.E9.m2.3.3.1.1.3.3.2a" xref="S3.E9.m2.3.3.1.1.3.3.2.cmml"><mo movablelimits="false" id="S3.E9.m2.3.3.1.1.3.3.2.2.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.2.cmml">∑</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.2.2.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.2.2.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.2.cmml">i</mi><mo id="S3.E9.m2.3.3.1.1.3.3.2.2.3.1" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.1.cmml">=</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.cmml"><msub id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2.cmml">K</mi><mi id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3.cmml">s</mi></msub><mo id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1.cmml">+</mo><mn id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3.cmml">1</mn></mrow></mrow><mrow id="S3.E9.m2.3.3.1.1.3.3.2.3" xref="S3.E9.m2.3.3.1.1.3.3.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.2.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E9.m2.3.3.1.1.3.3.2.3.1" xref="S3.E9.m2.3.3.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.E9.m2.3.3.1.1.3.3.2.3.3" xref="S3.E9.m2.3.3.1.1.3.3.2.3.3.cmml">N</mi></mrow></munderover></mstyle><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml"><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml"><msub id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2.cmml">g</mi><mrow id="S3.E9.m2.2.2.2.4" xref="S3.E9.m2.2.2.2.3.cmml"><mi id="S3.E9.m2.1.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml">i</mi><mo id="S3.E9.m2.2.2.2.4.1" xref="S3.E9.m2.2.2.2.3.cmml">,</mo><mi id="S3.E9.m2.2.2.2.2" xref="S3.E9.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.3.cmml">​</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml"><msub id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2a" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml"><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2.cmml">𝐮</mi><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3.cmml">t</mi><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m2.3.3.1.1.3.4a" xref="S3.E9.m2.3.3.1.1.3.4.cmml">+</mo><msubsup id="S3.E9.m2.3.3.1.1.3.5" xref="S3.E9.m2.3.3.1.1.3.5.cmml"><mi id="S3.E9.m2.3.3.1.1.3.5.2.2" xref="S3.E9.m2.3.3.1.1.3.5.2.2.cmml">𝐮</mi><mi id="S3.E9.m2.3.3.1.1.3.5.2.3" xref="S3.E9.m2.3.3.1.1.3.5.2.3.cmml">t</mi><mi id="S3.E9.m2.3.3.1.1.3.5.3" xref="S3.E9.m2.3.3.1.1.3.5.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S3.E9.m2.3.3.1.2" xref="S3.E9.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.3b"><apply id="S3.E9.m2.3.3.1.1.cmml" xref="S3.E9.m2.3.3.1"><eq id="S3.E9.m2.3.3.1.1.4.cmml" xref="S3.E9.m2.3.3.1.1.4"></eq><csymbol cd="latexml" id="S3.E9.m2.3.3.1.1.5.cmml" xref="S3.E9.m2.3.3.1.1.5">absent</csymbol><apply id="S3.E9.m2.3.3.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3"><plus id="S3.E9.m2.3.3.1.1.3.4.cmml" xref="S3.E9.m2.3.3.1.1.3.4"></plus><apply id="S3.E9.m2.3.3.1.1.2.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2"><apply id="S3.E9.m2.3.3.1.1.2.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.2.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3">subscript</csymbol><sum id="S3.E9.m2.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.2"></sum><apply id="S3.E9.m2.3.3.1.1.2.2.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3"><eq id="S3.E9.m2.3.3.1.1.2.2.3.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S3.E9.m2.3.3.1.1.2.2.3.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E9.m2.3.3.1.1.2.2.3.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E9.m2.3.3.1.1.2.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.3.3.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.2.2.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3.2">𝐾</ci><ci id="S3.E9.m2.3.3.1.1.2.2.3.3.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3.3">𝑠</ci></apply></apply><apply id="S3.E9.m2.3.3.1.1.2.2.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2"><apply id="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.2">FFN</ci><ci id="S3.E9.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2">𝐮</ci><ci id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3">𝑡</ci></apply><ci id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3">𝑙</ci></apply></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3"><apply id="S3.E9.m2.3.3.1.1.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2">subscript</csymbol><sum id="S3.E9.m2.3.3.1.1.3.3.2.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.2"></sum><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3"><eq id="S3.E9.m2.3.3.1.1.3.3.2.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.1"></eq><ci id="S3.E9.m2.3.3.1.1.3.3.2.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.2">𝑖</ci><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3"><plus id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1"></plus><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2">𝐾</ci><ci id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3">𝑠</ci></apply><cn type="integer" id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3"><times id="S3.E9.m2.3.3.1.1.3.3.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3.1"></times><ci id="S3.E9.m2.3.3.1.1.3.3.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3.2">𝑚</ci><ci id="S3.E9.m2.3.3.1.1.3.3.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3.3">𝑁</ci></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1"><times id="S3.E9.m2.3.3.1.1.3.3.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.3"></times><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2">𝑔</ci><list id="S3.E9.m2.2.2.2.3.cmml" xref="S3.E9.m2.2.2.2.4"><ci id="S3.E9.m2.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1">𝑖</ci><ci id="S3.E9.m2.2.2.2.2.cmml" xref="S3.E9.m2.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2"><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2">FFN</ci><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2">𝐮</ci><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3">𝑡</ci></apply><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.5.cmml" xref="S3.E9.m2.3.3.1.1.3.5"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.5.1.cmml" xref="S3.E9.m2.3.3.1.1.3.5">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.3.5.2.cmml" xref="S3.E9.m2.3.3.1.1.3.5"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.5.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.5">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.5.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.5.2.2">𝐮</ci><ci id="S3.E9.m2.3.3.1.1.3.5.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.5.2.3">𝑡</ci></apply><ci id="S3.E9.m2.3.3.1.1.3.5.3.cmml" xref="S3.E9.m2.3.3.1.1.3.5.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.3c">\displaystyle=\sum_{i=1}^{K_{s}}{\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}+\sum_{i=K_{s}+1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.2" class="ltx_Math" alttext="\displaystyle g_{i,t}" display="inline"><semantics id="S3.E10.m1.2a"><msub id="S3.E10.m1.2.3" xref="S3.E10.m1.2.3.cmml"><mi id="S3.E10.m1.2.3.2" xref="S3.E10.m1.2.3.2.cmml">g</mi><mrow id="S3.E10.m1.2.2.2.4" xref="S3.E10.m1.2.2.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">i</mi><mo id="S3.E10.m1.2.2.2.4.1" xref="S3.E10.m1.2.2.2.3.cmml">,</mo><mi id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.3.cmml" xref="S3.E10.m1.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.3.1.cmml" xref="S3.E10.m1.2.3">subscript</csymbol><ci id="S3.E10.m1.2.3.2.cmml" xref="S3.E10.m1.2.3.2">𝑔</ci><list id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.4"><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">𝑖</ci><ci id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\displaystyle g_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E10.m2.4" class="ltx_Math" alttext="\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|K_{s}+1\leqslant j\leqslant mN\},mK-K_{s}),\\
0,&amp;\text{otherwise},\end{cases}" display="inline"><semantics id="S3.E10.m2.4a"><mrow id="S3.E10.m2.4.5" xref="S3.E10.m2.4.5.cmml"><mi id="S3.E10.m2.4.5.2" xref="S3.E10.m2.4.5.2.cmml"></mi><mo id="S3.E10.m2.4.5.1" xref="S3.E10.m2.4.5.1.cmml">=</mo><mrow id="S3.E10.m2.4.4a" xref="S3.E10.m2.4.5.3.1.cmml"><mo id="S3.E10.m2.4.4a.5" xref="S3.E10.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S3.E10.m2.4.4.4a" xref="S3.E10.m2.4.5.3.1.cmml"><mtr id="S3.E10.m2.4.4.4aa" xref="S3.E10.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4ab" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.1.1.1.1.1.1.3" xref="S3.E10.m2.1.1.1.1.1.1.3.1.cmml"><msub id="S3.E10.m2.1.1.1.1.1.1.3.1" xref="S3.E10.m2.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E10.m2.1.1.1.1.1.1.3.1.2" xref="S3.E10.m2.1.1.1.1.1.1.3.1.2.cmml">s</mi><mrow id="S3.E10.m2.1.1.1.1.1.1.2.2.4" xref="S3.E10.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E10.m2.1.1.1.1.1.1.1.1.1" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E10.m2.1.1.1.1.1.1.2.2.4.1" xref="S3.E10.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S3.E10.m2.1.1.1.1.1.1.2.2.2" xref="S3.E10.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E10.m2.1.1.1.1.1.1.3.2" xref="S3.E10.m2.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4ac" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6" xref="S3.E10.m2.2.2.2.2.2.1.6.1.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.cmml"><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.4.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4.2.cmml">s</mi><mrow id="S3.E10.m2.2.2.2.2.2.1.2.2.4" xref="S3.E10.m2.2.2.2.2.2.1.2.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.1.1.1" xref="S3.E10.m2.2.2.2.2.2.1.1.1.1.cmml">i</mi><mo id="S3.E10.m2.2.2.2.2.2.1.2.2.4.1" xref="S3.E10.m2.2.2.2.2.2.1.2.2.3.cmml">,</mo><mi id="S3.E10.m2.2.2.2.2.2.1.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.3.cmml">∈</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.5" xref="S3.E10.m2.2.2.2.2.2.1.5.cmml">Topk</mi><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2a" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">⁡</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">(</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">{</mo><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E10.m2.2.2.2.2.2.1.4.2.4" xref="S3.E10.m2.2.2.2.2.2.1.4.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.3.1.1" xref="S3.E10.m2.2.2.2.2.2.1.3.1.1.cmml">j</mi><mo id="S3.E10.m2.2.2.2.2.2.1.4.2.4.1" xref="S3.E10.m2.2.2.2.2.2.1.4.2.3.cmml">,</mo><mi id="S3.E10.m2.2.2.2.2.2.1.4.2.2" xref="S3.E10.m2.2.2.2.2.2.1.4.2.2.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml"><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2.cmml">K</mi><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3.cmml">s</mi></msub><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1.cmml">+</mo><mn id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3.cmml">1</mn></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml">⩽</mo><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml">j</mi><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml">⩽</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml">​</mo><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml">N</mi></mrow></mrow><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.5" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">,</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1.cmml">​</mo><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3.cmml">K</mi></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml">−</mo><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2.cmml">K</mi><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.5" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E10.m2.4.4.4ad" xref="S3.E10.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4ae" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.3.3.3.3.1.1.3" xref="S3.E10.m2.4.5.3.1.cmml"><mn id="S3.E10.m2.3.3.3.3.1.1.1" xref="S3.E10.m2.3.3.3.3.1.1.1.cmml">0</mn><mo id="S3.E10.m2.3.3.3.3.1.1.3.1" xref="S3.E10.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4af" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.4.4.4.4.2.1.3" xref="S3.E10.m2.4.4.4.4.2.1.1a.cmml"><mtext id="S3.E10.m2.4.4.4.4.2.1.1" xref="S3.E10.m2.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S3.E10.m2.4.4.4.4.2.1.3.1" xref="S3.E10.m2.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m2.4b"><apply id="S3.E10.m2.4.5.cmml" xref="S3.E10.m2.4.5"><eq id="S3.E10.m2.4.5.1.cmml" xref="S3.E10.m2.4.5.1"></eq><csymbol cd="latexml" id="S3.E10.m2.4.5.2.cmml" xref="S3.E10.m2.4.5.2">absent</csymbol><apply id="S3.E10.m2.4.5.3.1.cmml" xref="S3.E10.m2.4.4a"><csymbol cd="latexml" id="S3.E10.m2.4.5.3.1.1.cmml" xref="S3.E10.m2.4.4a.5">cases</csymbol><apply id="S3.E10.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m2.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3.1.2">𝑠</ci><list id="S3.E10.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.2.2.4"><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E10.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.2.2.2">𝑡</ci></list></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6"><in id="S3.E10.m2.2.2.2.2.2.1.6.1.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.3"></in><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.4.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.4.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.4.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4.2">𝑠</ci><list id="S3.E10.m2.2.2.2.2.2.1.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.2.2.4"><ci id="S3.E10.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.1.1.1">𝑖</ci><ci id="S3.E10.m2.2.2.2.2.2.1.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.2.2.2">𝑡</ci></list></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2"><ci id="S3.E10.m2.2.2.2.2.2.1.5.cmml" xref="S3.E10.m2.2.2.2.2.2.1.5">Topk</ci><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2">𝑠</ci><list id="S3.E10.m2.2.2.2.2.2.1.4.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.4.2.4"><ci id="S3.E10.m2.2.2.2.2.2.1.3.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.3.1.1">𝑗</ci><ci id="S3.E10.m2.2.2.2.2.2.1.4.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.4.2.2">𝑡</ci></list></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><and id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2a.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></and><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2b.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3"></leq><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2"><plus id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1"></plus><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2">𝐾</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3">𝑠</ci></apply><cn type="integer" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3">1</cn></apply><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4">𝑗</ci></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2c.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5"></leq><share href="#S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2d.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></share><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6"><times id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1"></times><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2">𝑚</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3">𝑁</ci></apply></apply></apply></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2"><minus id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1"></minus><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2"><times id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1"></times><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2">𝑚</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2">𝐾</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3">𝑠</ci></apply></apply></apply></apply><cn type="integer" id="S3.E10.m2.3.3.3.3.1.1.1.cmml" xref="S3.E10.m2.3.3.3.3.1.1.1">0</cn><ci id="S3.E10.m2.4.4.4.4.2.1.1a.cmml" xref="S3.E10.m2.4.4.4.4.2.1.3"><mtext id="S3.E10.m2.4.4.4.4.2.1.1.cmml" xref="S3.E10.m2.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m2.4c">\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|K_{s}+1\leqslant j\leqslant mN\},mK-K_{s}),\\
0,&amp;\text{otherwise},\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11.m1.2" class="ltx_Math" alttext="\displaystyle s_{i,t}" display="inline"><semantics id="S3.E11.m1.2a"><msub id="S3.E11.m1.2.3" xref="S3.E11.m1.2.3.cmml"><mi id="S3.E11.m1.2.3.2" xref="S3.E11.m1.2.3.2.cmml">s</mi><mrow id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">i</mi><mo id="S3.E11.m1.2.2.2.4.1" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.3.cmml" xref="S3.E11.m1.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.3.1.cmml" xref="S3.E11.m1.2.3">subscript</csymbol><ci id="S3.E11.m1.2.3.2.cmml" xref="S3.E11.m1.2.3.2">𝑠</ci><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.4"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑖</ci><ci id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\displaystyle s_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E11.m2.1" class="ltx_Math" alttext="\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right)." display="inline"><semantics id="S3.E11.m2.1a"><mrow id="S3.E11.m2.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mrow id="S3.E11.m2.1.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mi id="S3.E11.m2.1.1.1.1.4" xref="S3.E11.m2.1.1.1.1.4.cmml"></mi><mo id="S3.E11.m2.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E11.m2.1.1.1.1.2.2" xref="S3.E11.m2.1.1.1.1.2.3.cmml"><msub id="S3.E11.m2.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m2.1.1.1.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.1.1.1.2.cmml">Softmax</mi><mi id="S3.E11.m2.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E11.m2.1.1.1.1.2.2a" xref="S3.E11.m2.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E11.m2.1.1.1.1.2.2.2" xref="S3.E11.m2.1.1.1.1.2.3.cmml"><mo id="S3.E11.m2.1.1.1.1.2.2.2.2" xref="S3.E11.m2.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E11.m2.1.1.1.1.2.2.2.1" xref="S3.E11.m2.1.1.1.1.2.2.2.1.cmml"><mmultiscripts id="S3.E11.m2.1.1.1.1.2.2.2.1.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.cmml"><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml">𝐮</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml">t</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3.cmml">l</mi><mrow id="S3.E11.m2.1.1.1.1.2.2.2.1.2a" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.cmml"></mrow><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E11.m2.1.1.1.1.2.2.2.1.1" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml">​</mo><msubsup id="S3.E11.m2.1.1.1.1.2.2.2.1.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.cmml"><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2.cmml">𝐞</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.3.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S3.E11.m2.1.1.1.1.2.2.2.3" xref="S3.E11.m2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E11.m2.1.1.1.2" xref="S3.E11.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m2.1b"><apply id="S3.E11.m2.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1"><eq id="S3.E11.m2.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E11.m2.1.1.1.1.4.cmml" xref="S3.E11.m2.1.1.1.1.4">absent</csymbol><apply id="S3.E11.m2.1.1.1.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2"><apply id="S3.E11.m2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.2">Softmax</ci><ci id="S3.E11.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1"><times id="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1"></times><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2">𝐮</ci><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3">𝑡</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3">𝑙</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.3">𝑇</ci></apply><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.3.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2">𝐞</ci><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3">𝑖</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.3.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m2.1c">\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.5" class="ltx_p">Finally, in DeepSeekMoE, the number of shared expert is <math id="S3.SS2.p2.3.m1.1" class="ltx_Math" alttext="K_{s}" display="inline"><semantics id="S3.SS2.p2.3.m1.1a"><msub id="S3.SS2.p2.3.m1.1.1" xref="S3.SS2.p2.3.m1.1.1.cmml"><mi id="S3.SS2.p2.3.m1.1.1.2" xref="S3.SS2.p2.3.m1.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.3.m1.1.1.3" xref="S3.SS2.p2.3.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m1.1b"><apply id="S3.SS2.p2.3.m1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m1.1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m1.1.1.2.cmml" xref="S3.SS2.p2.3.m1.1.1.2">𝐾</ci><ci id="S3.SS2.p2.3.m1.1.1.3.cmml" xref="S3.SS2.p2.3.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m1.1c">K_{s}</annotation></semantics></math>, the total number of routed experts is <math id="S3.SS2.p2.4.m2.1" class="ltx_Math" alttext="mN-K_{s}" display="inline"><semantics id="S3.SS2.p2.4.m2.1a"><mrow id="S3.SS2.p2.4.m2.1.1" xref="S3.SS2.p2.4.m2.1.1.cmml"><mrow id="S3.SS2.p2.4.m2.1.1.2" xref="S3.SS2.p2.4.m2.1.1.2.cmml"><mi id="S3.SS2.p2.4.m2.1.1.2.2" xref="S3.SS2.p2.4.m2.1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m2.1.1.2.1" xref="S3.SS2.p2.4.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p2.4.m2.1.1.2.3" xref="S3.SS2.p2.4.m2.1.1.2.3.cmml">N</mi></mrow><mo id="S3.SS2.p2.4.m2.1.1.1" xref="S3.SS2.p2.4.m2.1.1.1.cmml">−</mo><msub id="S3.SS2.p2.4.m2.1.1.3" xref="S3.SS2.p2.4.m2.1.1.3.cmml"><mi id="S3.SS2.p2.4.m2.1.1.3.2" xref="S3.SS2.p2.4.m2.1.1.3.2.cmml">K</mi><mi id="S3.SS2.p2.4.m2.1.1.3.3" xref="S3.SS2.p2.4.m2.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m2.1b"><apply id="S3.SS2.p2.4.m2.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1"><minus id="S3.SS2.p2.4.m2.1.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1.1"></minus><apply id="S3.SS2.p2.4.m2.1.1.2.cmml" xref="S3.SS2.p2.4.m2.1.1.2"><times id="S3.SS2.p2.4.m2.1.1.2.1.cmml" xref="S3.SS2.p2.4.m2.1.1.2.1"></times><ci id="S3.SS2.p2.4.m2.1.1.2.2.cmml" xref="S3.SS2.p2.4.m2.1.1.2.2">𝑚</ci><ci id="S3.SS2.p2.4.m2.1.1.2.3.cmml" xref="S3.SS2.p2.4.m2.1.1.2.3">𝑁</ci></apply><apply id="S3.SS2.p2.4.m2.1.1.3.cmml" xref="S3.SS2.p2.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m2.1.1.3.1.cmml" xref="S3.SS2.p2.4.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.4.m2.1.1.3.2.cmml" xref="S3.SS2.p2.4.m2.1.1.3.2">𝐾</ci><ci id="S3.SS2.p2.4.m2.1.1.3.3.cmml" xref="S3.SS2.p2.4.m2.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m2.1c">mN-K_{s}</annotation></semantics></math>, and the number of nonzero gates is <math id="S3.SS2.p2.5.m3.1" class="ltx_Math" alttext="mK-K_{s}" display="inline"><semantics id="S3.SS2.p2.5.m3.1a"><mrow id="S3.SS2.p2.5.m3.1.1" xref="S3.SS2.p2.5.m3.1.1.cmml"><mrow id="S3.SS2.p2.5.m3.1.1.2" xref="S3.SS2.p2.5.m3.1.1.2.cmml"><mi id="S3.SS2.p2.5.m3.1.1.2.2" xref="S3.SS2.p2.5.m3.1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m3.1.1.2.1" xref="S3.SS2.p2.5.m3.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p2.5.m3.1.1.2.3" xref="S3.SS2.p2.5.m3.1.1.2.3.cmml">K</mi></mrow><mo id="S3.SS2.p2.5.m3.1.1.1" xref="S3.SS2.p2.5.m3.1.1.1.cmml">−</mo><msub id="S3.SS2.p2.5.m3.1.1.3" xref="S3.SS2.p2.5.m3.1.1.3.cmml"><mi id="S3.SS2.p2.5.m3.1.1.3.2" xref="S3.SS2.p2.5.m3.1.1.3.2.cmml">K</mi><mi id="S3.SS2.p2.5.m3.1.1.3.3" xref="S3.SS2.p2.5.m3.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m3.1b"><apply id="S3.SS2.p2.5.m3.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1"><minus id="S3.SS2.p2.5.m3.1.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1.1"></minus><apply id="S3.SS2.p2.5.m3.1.1.2.cmml" xref="S3.SS2.p2.5.m3.1.1.2"><times id="S3.SS2.p2.5.m3.1.1.2.1.cmml" xref="S3.SS2.p2.5.m3.1.1.2.1"></times><ci id="S3.SS2.p2.5.m3.1.1.2.2.cmml" xref="S3.SS2.p2.5.m3.1.1.2.2">𝑚</ci><ci id="S3.SS2.p2.5.m3.1.1.2.3.cmml" xref="S3.SS2.p2.5.m3.1.1.2.3">𝐾</ci></apply><apply id="S3.SS2.p2.5.m3.1.1.3.cmml" xref="S3.SS2.p2.5.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m3.1.1.3.1.cmml" xref="S3.SS2.p2.5.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.5.m3.1.1.3.2.cmml" xref="S3.SS2.p2.5.m3.1.1.3.2">𝐾</ci><ci id="S3.SS2.p2.5.m3.1.1.3.3.cmml" xref="S3.SS2.p2.5.m3.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m3.1c">mK-K_{s}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p class="ltx_p" id="S3.SS2.p3.1">공유 전문가 격리의 프로토타입은 <cite class="ltx_cite ltx_citemacro_citet">Rajbhandari et al. (<a class="ltx_ref" href="#bib.bib40" title="">2022</a>)</cite>로 인정될 수 있다는 점에 주목할 필요가 있다. 핵심적인 구별은 그들이 이 전략을 공학적 관점에서 도출하는 반면 우리는 알고리즘적 관점에서 접근한다는 사실에 있다.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Load Balance Consideration</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS3.p1.1">자동으로 학습된 라우팅 전략은 두 가지 주목할 만한 결함을 나타내는 부하 불균형 문제에 직면할 수 있다. 첫째, 라우팅 붕괴의 위험이 있다. <cite class="ltx_cite ltx_citemacro_citep">(Shazeer et al., <a class="ltx_ref" href="#bib.bib47" title="">2017</a>)</cite> 즉, 모델은 항상 소수의 전문가만을 선택하여 다른 전문가의 충분한 훈련을 방해한다. 둘째, 전문가가 여러 장치에 분산되어 있는 경우 부하 불균형이 계산 병목 현상을 악화시킬 수 있습니다.</p>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Expert-Level Balance Loss.</h5>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.7">라우팅 붕괴의 위험을 완화하기 위해 전문가 수준의 균형 손실도 사용합니다. 잔액 손실의 계산은 다음과 같다:</p>
<table id="A3.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\mathrm{ExpBal}}" display="inline"><semantics id="S3.E12.m1.1a"><msub id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml">ℒ</mi><mi id="S3.E12.m1.1.1.3" xref="S3.E12.m1.1.1.3.cmml">ExpBal</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.cmml" xref="S3.E12.m1.1.1">subscript</csymbol><ci id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2">ℒ</ci><ci id="S3.E12.m1.1.1.3.cmml" xref="S3.E12.m1.1.1.3">ExpBal</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\displaystyle\mathcal{L}_{\mathrm{ExpBal}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12.m2.1" class="ltx_Math" alttext="\displaystyle=\alpha_{1}\sum_{i=1}^{N^{\prime}}{f_{i}P_{i}}," display="inline"><semantics id="S3.E12.m2.1a"><mrow id="S3.E12.m2.1.1.1" xref="S3.E12.m2.1.1.1.1.cmml"><mrow id="S3.E12.m2.1.1.1.1" xref="S3.E12.m2.1.1.1.1.cmml"><mi id="S3.E12.m2.1.1.1.1.2" xref="S3.E12.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E12.m2.1.1.1.1.1" xref="S3.E12.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E12.m2.1.1.1.1.3" xref="S3.E12.m2.1.1.1.1.3.cmml"><msub id="S3.E12.m2.1.1.1.1.3.2" xref="S3.E12.m2.1.1.1.1.3.2.cmml"><mi id="S3.E12.m2.1.1.1.1.3.2.2" xref="S3.E12.m2.1.1.1.1.3.2.2.cmml">α</mi><mn id="S3.E12.m2.1.1.1.1.3.2.3" xref="S3.E12.m2.1.1.1.1.3.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E12.m2.1.1.1.1.3.1" xref="S3.E12.m2.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E12.m2.1.1.1.1.3.3" xref="S3.E12.m2.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E12.m2.1.1.1.1.3.3.1" xref="S3.E12.m2.1.1.1.1.3.3.1.cmml"><munderover id="S3.E12.m2.1.1.1.1.3.3.1a" xref="S3.E12.m2.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E12.m2.1.1.1.1.3.3.1.2.2" xref="S3.E12.m2.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E12.m2.1.1.1.1.3.3.1.2.3" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.1.2.3.2" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E12.m2.1.1.1.1.3.3.1.2.3.1" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E12.m2.1.1.1.1.3.3.1.2.3.3" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><msup id="S3.E12.m2.1.1.1.1.3.3.1.3" xref="S3.E12.m2.1.1.1.1.3.3.1.3.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.1.3.2" xref="S3.E12.m2.1.1.1.1.3.3.1.3.2.cmml">N</mi><mo id="S3.E12.m2.1.1.1.1.3.3.1.3.3" xref="S3.E12.m2.1.1.1.1.3.3.1.3.3.cmml">′</mo></msup></munderover></mstyle><mrow id="S3.E12.m2.1.1.1.1.3.3.2" xref="S3.E12.m2.1.1.1.1.3.3.2.cmml"><msub id="S3.E12.m2.1.1.1.1.3.3.2.2" xref="S3.E12.m2.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.2.2.2" xref="S3.E12.m2.1.1.1.1.3.3.2.2.2.cmml">f</mi><mi id="S3.E12.m2.1.1.1.1.3.3.2.2.3" xref="S3.E12.m2.1.1.1.1.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.m2.1.1.1.1.3.3.2.1" xref="S3.E12.m2.1.1.1.1.3.3.2.1.cmml">​</mo><msub id="S3.E12.m2.1.1.1.1.3.3.2.3" xref="S3.E12.m2.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.2.3.2" xref="S3.E12.m2.1.1.1.1.3.3.2.3.2.cmml">P</mi><mi id="S3.E12.m2.1.1.1.1.3.3.2.3.3" xref="S3.E12.m2.1.1.1.1.3.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo id="S3.E12.m2.1.1.1.2" xref="S3.E12.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m2.1b"><apply id="S3.E12.m2.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1"><eq id="S3.E12.m2.1.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E12.m2.1.1.1.1.2.cmml" xref="S3.E12.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E12.m2.1.1.1.1.3.cmml" xref="S3.E12.m2.1.1.1.1.3"><times id="S3.E12.m2.1.1.1.1.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.1"></times><apply id="S3.E12.m2.1.1.1.1.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.2.2">𝛼</ci><cn type="integer" id="S3.E12.m2.1.1.1.1.3.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.E12.m2.1.1.1.1.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3"><apply id="S3.E12.m2.1.1.1.1.3.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.1.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1">superscript</csymbol><apply id="S3.E12.m2.1.1.1.1.3.3.1.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.1.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E12.m2.1.1.1.1.3.3.1.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.2"></sum><apply id="S3.E12.m2.1.1.1.1.3.3.1.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3"><eq id="S3.E12.m2.1.1.1.1.3.3.1.2.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E12.m2.1.1.1.1.3.3.1.2.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E12.m2.1.1.1.1.3.3.1.2.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E12.m2.1.1.1.1.3.3.1.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.1.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3">superscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.3.1.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3.2">𝑁</ci><ci id="S3.E12.m2.1.1.1.1.3.3.1.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3.3">′</ci></apply></apply><apply id="S3.E12.m2.1.1.1.1.3.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2"><times id="S3.E12.m2.1.1.1.1.3.3.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.1"></times><apply id="S3.E12.m2.1.1.1.1.3.3.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2.2">𝑓</ci><ci id="S3.E12.m2.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="S3.E12.m2.1.1.1.1.3.3.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3.2">𝑃</ci><ci id="S3.E12.m2.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m2.1c">\displaystyle=\alpha_{1}\sum_{i=1}^{N^{\prime}}{f_{i}P_{i}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13.m1.1" class="ltx_Math" alttext="\displaystyle f_{i}" display="inline"><semantics id="S3.E13.m1.1a"><msub id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><mi id="S3.E13.m1.1.1.2" xref="S3.E13.m1.1.1.2.cmml">f</mi><mi id="S3.E13.m1.1.1.3" xref="S3.E13.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1">subscript</csymbol><ci id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1.2">𝑓</ci><ci id="S3.E13.m1.1.1.3.cmml" xref="S3.E13.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\displaystyle f_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13.m2.3" class="ltx_Math" alttext="\displaystyle=\frac{N^{\prime}}{K^{\prime}T}\sum_{t=1}^{T}{\mathds{1}(\text{Token $t$ selects Expert $i$})}," display="inline"><semantics id="S3.E13.m2.3a"><mrow id="S3.E13.m2.3.3.1" xref="S3.E13.m2.3.3.1.1.cmml"><mrow id="S3.E13.m2.3.3.1.1" xref="S3.E13.m2.3.3.1.1.cmml"><mi id="S3.E13.m2.3.3.1.1.2" xref="S3.E13.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E13.m2.3.3.1.1.1" xref="S3.E13.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E13.m2.3.3.1.1.3" xref="S3.E13.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E13.m2.3.3.1.1.3.2" xref="S3.E13.m2.3.3.1.1.3.2.cmml"><mfrac id="S3.E13.m2.3.3.1.1.3.2a" xref="S3.E13.m2.3.3.1.1.3.2.cmml"><msup id="S3.E13.m2.3.3.1.1.3.2.2" xref="S3.E13.m2.3.3.1.1.3.2.2.cmml"><mi id="S3.E13.m2.3.3.1.1.3.2.2.2" xref="S3.E13.m2.3.3.1.1.3.2.2.2.cmml">N</mi><mo id="S3.E13.m2.3.3.1.1.3.2.2.3" xref="S3.E13.m2.3.3.1.1.3.2.2.3.cmml">′</mo></msup><mrow id="S3.E13.m2.3.3.1.1.3.2.3" xref="S3.E13.m2.3.3.1.1.3.2.3.cmml"><msup id="S3.E13.m2.3.3.1.1.3.2.3.2" xref="S3.E13.m2.3.3.1.1.3.2.3.2.cmml"><mi id="S3.E13.m2.3.3.1.1.3.2.3.2.2" xref="S3.E13.m2.3.3.1.1.3.2.3.2.2.cmml">K</mi><mo id="S3.E13.m2.3.3.1.1.3.2.3.2.3" xref="S3.E13.m2.3.3.1.1.3.2.3.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S3.E13.m2.3.3.1.1.3.2.3.1" xref="S3.E13.m2.3.3.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E13.m2.3.3.1.1.3.2.3.3" xref="S3.E13.m2.3.3.1.1.3.2.3.3.cmml">T</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E13.m2.3.3.1.1.3.1" xref="S3.E13.m2.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E13.m2.3.3.1.1.3.3" xref="S3.E13.m2.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E13.m2.3.3.1.1.3.3.1" xref="S3.E13.m2.3.3.1.1.3.3.1.cmml"><munderover id="S3.E13.m2.3.3.1.1.3.3.1a" xref="S3.E13.m2.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E13.m2.3.3.1.1.3.3.1.2.2" xref="S3.E13.m2.3.3.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E13.m2.3.3.1.1.3.3.1.2.3" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.cmml"><mi id="S3.E13.m2.3.3.1.1.3.3.1.2.3.2" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.2.cmml">t</mi><mo id="S3.E13.m2.3.3.1.1.3.3.1.2.3.1" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E13.m2.3.3.1.1.3.3.1.2.3.3" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E13.m2.3.3.1.1.3.3.1.3" xref="S3.E13.m2.3.3.1.1.3.3.1.3.cmml">T</mi></munderover></mstyle><mrow id="S3.E13.m2.3.3.1.1.3.3.2" xref="S3.E13.m2.3.3.1.1.3.3.2.cmml"><mn id="S3.E13.m2.3.3.1.1.3.3.2.2" xref="S3.E13.m2.3.3.1.1.3.3.2.2.cmml">𝟙</mn><mo lspace="0em" rspace="0em" id="S3.E13.m2.3.3.1.1.3.3.2.1" xref="S3.E13.m2.3.3.1.1.3.3.2.1.cmml">​</mo><mrow id="S3.E13.m2.3.3.1.1.3.3.2.3.2" xref="S3.E13.m2.2.2.2ac.cmml"><mo stretchy="false" id="S3.E13.m2.3.3.1.1.3.3.2.3.2.1" xref="S3.E13.m2.2.2.2ac.cmml">(</mo><mrow id="S3.E13.m2.2.2.2a" xref="S3.E13.m2.2.2.2ac.cmml"><mtext id="S3.E13.m2.2.2.2aa" xref="S3.E13.m2.2.2.2aa.cmml">Token&nbsp;</mtext><mi id="S3.E13.m2.1.1.1.m1.1.1" xref="S3.E13.m2.1.1.1.m1.1.1.cmml">t</mi><mtext id="S3.E13.m2.2.2.2ab" xref="S3.E13.m2.2.2.2aa.cmml">&nbsp;selects Expert&nbsp;</mtext><mi id="S3.E13.m2.2.2.2.m2.1.1" xref="S3.E13.m2.2.2.2.m2.1.1.cmml">i</mi></mrow><mo stretchy="false" id="S3.E13.m2.3.3.1.1.3.3.2.3.2.2" xref="S3.E13.m2.2.2.2ac.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E13.m2.3.3.1.2" xref="S3.E13.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m2.3b"><apply id="S3.E13.m2.3.3.1.1.cmml" xref="S3.E13.m2.3.3.1"><eq id="S3.E13.m2.3.3.1.1.1.cmml" xref="S3.E13.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E13.m2.3.3.1.1.2.cmml" xref="S3.E13.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E13.m2.3.3.1.1.3.cmml" xref="S3.E13.m2.3.3.1.1.3"><times id="S3.E13.m2.3.3.1.1.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.1"></times><apply id="S3.E13.m2.3.3.1.1.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2"><divide id="S3.E13.m2.3.3.1.1.3.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2"></divide><apply id="S3.E13.m2.3.3.1.1.3.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.2.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2">superscript</csymbol><ci id="S3.E13.m2.3.3.1.1.3.2.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2.2">𝑁</ci><ci id="S3.E13.m2.3.3.1.1.3.2.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2.3">′</ci></apply><apply id="S3.E13.m2.3.3.1.1.3.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3"><times id="S3.E13.m2.3.3.1.1.3.2.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.1"></times><apply id="S3.E13.m2.3.3.1.1.3.2.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.2.3.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2">superscript</csymbol><ci id="S3.E13.m2.3.3.1.1.3.2.3.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2.2">𝐾</ci><ci id="S3.E13.m2.3.3.1.1.3.2.3.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2.3">′</ci></apply><ci id="S3.E13.m2.3.3.1.1.3.2.3.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.3">𝑇</ci></apply></apply><apply id="S3.E13.m2.3.3.1.1.3.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3"><apply id="S3.E13.m2.3.3.1.1.3.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.3.1.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1">superscript</csymbol><apply id="S3.E13.m2.3.3.1.1.3.3.1.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.3.1.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E13.m2.3.3.1.1.3.3.1.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.2"></sum><apply id="S3.E13.m2.3.3.1.1.3.3.1.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3"><eq id="S3.E13.m2.3.3.1.1.3.3.1.2.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S3.E13.m2.3.3.1.1.3.3.1.2.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E13.m2.3.3.1.1.3.3.1.2.3.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E13.m2.3.3.1.1.3.3.1.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.3">𝑇</ci></apply><apply id="S3.E13.m2.3.3.1.1.3.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2"><times id="S3.E13.m2.3.3.1.1.3.3.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.1"></times><cn type="integer" id="S3.E13.m2.3.3.1.1.3.3.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.2">1</cn><ci id="S3.E13.m2.2.2.2ac.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.3.2"><mrow id="S3.E13.m2.2.2.2a.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.3.2"><mtext id="S3.E13.m2.2.2.2aa.cmml" xref="S3.E13.m2.2.2.2aa">Token&nbsp;</mtext><mi id="S3.E13.m2.1.1.1.m1.1.1.cmml" xref="S3.E13.m2.1.1.1.m1.1.1">t</mi><mtext id="S3.E13.m2.2.2.2ab.cmml" xref="S3.E13.m2.2.2.2aa">&nbsp;selects Expert&nbsp;</mtext><mi id="S3.E13.m2.2.2.2.m2.1.1.cmml" xref="S3.E13.m2.2.2.2.m2.1.1">i</mi></mrow></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m2.3c">\displaystyle=\frac{N^{\prime}}{K^{\prime}T}\sum_{t=1}^{T}{\mathds{1}(\text{Token $t$ selects Expert $i$})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E14.m1.1" class="ltx_Math" alttext="\displaystyle P_{i}" display="inline"><semantics id="S3.E14.m1.1a"><msub id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml"><mi id="S3.E14.m1.1.1.2" xref="S3.E14.m1.1.1.2.cmml">P</mi><mi id="S3.E14.m1.1.1.3" xref="S3.E14.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.cmml" xref="S3.E14.m1.1.1">subscript</csymbol><ci id="S3.E14.m1.1.1.2.cmml" xref="S3.E14.m1.1.1.2">𝑃</ci><ci id="S3.E14.m1.1.1.3.cmml" xref="S3.E14.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\displaystyle P_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E14.m2.3" class="ltx_Math" alttext="\displaystyle=\frac{1}{T}\sum_{t=1}^{T}{s_{i,t}}," display="inline"><semantics id="S3.E14.m2.3a"><mrow id="S3.E14.m2.3.3.1" xref="S3.E14.m2.3.3.1.1.cmml"><mrow id="S3.E14.m2.3.3.1.1" xref="S3.E14.m2.3.3.1.1.cmml"><mi id="S3.E14.m2.3.3.1.1.2" xref="S3.E14.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E14.m2.3.3.1.1.1" xref="S3.E14.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E14.m2.3.3.1.1.3" xref="S3.E14.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E14.m2.3.3.1.1.3.2" xref="S3.E14.m2.3.3.1.1.3.2.cmml"><mfrac id="S3.E14.m2.3.3.1.1.3.2a" xref="S3.E14.m2.3.3.1.1.3.2.cmml"><mn id="S3.E14.m2.3.3.1.1.3.2.2" xref="S3.E14.m2.3.3.1.1.3.2.2.cmml">1</mn><mi id="S3.E14.m2.3.3.1.1.3.2.3" xref="S3.E14.m2.3.3.1.1.3.2.3.cmml">T</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E14.m2.3.3.1.1.3.1" xref="S3.E14.m2.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E14.m2.3.3.1.1.3.3" xref="S3.E14.m2.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E14.m2.3.3.1.1.3.3.1" xref="S3.E14.m2.3.3.1.1.3.3.1.cmml"><munderover id="S3.E14.m2.3.3.1.1.3.3.1a" xref="S3.E14.m2.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E14.m2.3.3.1.1.3.3.1.2.2" xref="S3.E14.m2.3.3.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E14.m2.3.3.1.1.3.3.1.2.3" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.cmml"><mi id="S3.E14.m2.3.3.1.1.3.3.1.2.3.2" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.2.cmml">t</mi><mo id="S3.E14.m2.3.3.1.1.3.3.1.2.3.1" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E14.m2.3.3.1.1.3.3.1.2.3.3" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E14.m2.3.3.1.1.3.3.1.3" xref="S3.E14.m2.3.3.1.1.3.3.1.3.cmml">T</mi></munderover></mstyle><msub id="S3.E14.m2.3.3.1.1.3.3.2" xref="S3.E14.m2.3.3.1.1.3.3.2.cmml"><mi id="S3.E14.m2.3.3.1.1.3.3.2.2" xref="S3.E14.m2.3.3.1.1.3.3.2.2.cmml">s</mi><mrow id="S3.E14.m2.2.2.2.4" xref="S3.E14.m2.2.2.2.3.cmml"><mi id="S3.E14.m2.1.1.1.1" xref="S3.E14.m2.1.1.1.1.cmml">i</mi><mo id="S3.E14.m2.2.2.2.4.1" xref="S3.E14.m2.2.2.2.3.cmml">,</mo><mi id="S3.E14.m2.2.2.2.2" xref="S3.E14.m2.2.2.2.2.cmml">t</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E14.m2.3.3.1.2" xref="S3.E14.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m2.3b"><apply id="S3.E14.m2.3.3.1.1.cmml" xref="S3.E14.m2.3.3.1"><eq id="S3.E14.m2.3.3.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E14.m2.3.3.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E14.m2.3.3.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.3"><times id="S3.E14.m2.3.3.1.1.3.1.cmml" xref="S3.E14.m2.3.3.1.1.3.1"></times><apply id="S3.E14.m2.3.3.1.1.3.2.cmml" xref="S3.E14.m2.3.3.1.1.3.2"><divide id="S3.E14.m2.3.3.1.1.3.2.1.cmml" xref="S3.E14.m2.3.3.1.1.3.2"></divide><cn type="integer" id="S3.E14.m2.3.3.1.1.3.2.2.cmml" xref="S3.E14.m2.3.3.1.1.3.2.2">1</cn><ci id="S3.E14.m2.3.3.1.1.3.2.3.cmml" xref="S3.E14.m2.3.3.1.1.3.2.3">𝑇</ci></apply><apply id="S3.E14.m2.3.3.1.1.3.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3"><apply id="S3.E14.m2.3.3.1.1.3.3.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.3.3.1.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1">superscript</csymbol><apply id="S3.E14.m2.3.3.1.1.3.3.1.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.3.3.1.2.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E14.m2.3.3.1.1.3.3.1.2.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.2"></sum><apply id="S3.E14.m2.3.3.1.1.3.3.1.2.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3"><eq id="S3.E14.m2.3.3.1.1.3.3.1.2.3.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S3.E14.m2.3.3.1.1.3.3.1.2.3.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E14.m2.3.3.1.1.3.3.1.2.3.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E14.m2.3.3.1.1.3.3.1.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.3">𝑇</ci></apply><apply id="S3.E14.m2.3.3.1.1.3.3.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.3.3.2.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.2">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.3.3.2.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.2.2">𝑠</ci><list id="S3.E14.m2.2.2.2.3.cmml" xref="S3.E14.m2.2.2.2.4"><ci id="S3.E14.m2.1.1.1.1.cmml" xref="S3.E14.m2.1.1.1.1">𝑖</ci><ci id="S3.E14.m2.2.2.2.2.cmml" xref="S3.E14.m2.2.2.2.2">𝑡</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m2.3c">\displaystyle=\frac{1}{T}\sum_{t=1}^{T}{s_{i,t}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px1.p1.6" class="ltx_p">where <math id="S3.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\alpha_{1}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">α</mi><mn id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">\alpha_{1}</annotation></semantics></math> is a hyper-parameter called expert-level balance factor, <math id="S3.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="N^{\prime}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><msup id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">N</mi><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2">𝑁</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">N^{\prime}</annotation></semantics></math> is equal to <math id="S3.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="(mN-K_{s})" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml">−</mo><msub id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2.cmml">K</mi><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1"><minus id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1"></minus><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2"><times id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1"></times><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2">𝐾</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.1c">(mN-K_{s})</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="K^{\prime}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.4.m4.1a"><msup id="S3.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml">K</mi><mo id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2">𝐾</ci><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.4.m4.1c">K^{\prime}</annotation></semantics></math> is equal to <math id="S3.SS3.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="(mK-K_{s})" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3.cmml">K</mi></mrow><mo id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml">−</mo><msub id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2.cmml">K</mi><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1"><minus id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1"></minus><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2"><times id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1"></times><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3">𝐾</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2">𝐾</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.5.m5.1c">(mK-K_{s})</annotation></semantics></math> for brevity. <math id="S3.SS3.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="\mathds{1}(\cdot)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.6.m6.1a"><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.1.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml"><mn id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2.cmml">𝟙</mn><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.3.2.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.3.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2"><times id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1"></times><cn type="integer" id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2">1</cn><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.6.m6.1c">\mathds{1}(\cdot)</annotation></semantics></math> denotes the indicator function.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Device-Level Balance Loss.</h5>

<div id="S3.SS3.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.2">전문가 수준의 균형 손실 외에 장치 수준의 균형 손실을 소개합니다. 부하 균형에 대한 과도한 제약은 모델 성능을 손상시키기 때문에, 계산 병목 현상을 완화하기 위해 전문가 수준에서 엄격한 균형 제약을 적용하는 것은 불필요해진다. 대신, 우리의 주요 목표는 장치 전반에 걸쳐 균형 잡힌 계산을 보장하는 것입니다. 라우팅된 모든 전문가를 <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">D</annotation></semantics></math> 그룹 <math alttext="\{\mathcal{E}_{1},\mathcal{E}_{2},...,\mathcal{E}_{D}\}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.2.m2.4"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.4a"><mrow id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml"><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.4" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">{</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml">ℰ</mi><mn id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.5" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2.cmml">ℰ</mi><mn id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.6" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.7" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2.cmml">ℰ</mi><mi id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3.cmml">D</mi></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.8" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.4b"><set id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3"><apply id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2">ℰ</ci><cn id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2">ℰ</ci><cn id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2">ℰ</ci><ci id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3">𝐷</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.4c">\{\mathcal{E}_{1},\mathcal{E}_{2},...,\mathcal{E}_{D}\}</annotation></semantics></math>로 분할하고 각 그룹을 단일 디바이스에 배포하면 디바이스 수준 균형 손실은 다음과 같이 계산됩니다.</p>
<table id="A3.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E15.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\mathrm{DevBal}}" display="inline"><semantics id="S3.E15.m1.1a"><msub id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.1.1.2" xref="S3.E15.m1.1.1.2.cmml">ℒ</mi><mi id="S3.E15.m1.1.1.3" xref="S3.E15.m1.1.1.3.cmml">DevBal</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E15.m1.1b"><apply id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.cmml" xref="S3.E15.m1.1.1">subscript</csymbol><ci id="S3.E15.m1.1.1.2.cmml" xref="S3.E15.m1.1.1.2">ℒ</ci><ci id="S3.E15.m1.1.1.3.cmml" xref="S3.E15.m1.1.1.3">DevBal</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.1c">\displaystyle\mathcal{L}_{\mathrm{DevBal}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E15.m2.1" class="ltx_Math" alttext="\displaystyle=\alpha_{2}\sum_{i=1}^{D}{f_{i}^{\prime}P_{i}^{\prime}}," display="inline"><semantics id="S3.E15.m2.1a"><mrow id="S3.E15.m2.1.1.1" xref="S3.E15.m2.1.1.1.1.cmml"><mrow id="S3.E15.m2.1.1.1.1" xref="S3.E15.m2.1.1.1.1.cmml"><mi id="S3.E15.m2.1.1.1.1.2" xref="S3.E15.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E15.m2.1.1.1.1.1" xref="S3.E15.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E15.m2.1.1.1.1.3" xref="S3.E15.m2.1.1.1.1.3.cmml"><msub id="S3.E15.m2.1.1.1.1.3.2" xref="S3.E15.m2.1.1.1.1.3.2.cmml"><mi id="S3.E15.m2.1.1.1.1.3.2.2" xref="S3.E15.m2.1.1.1.1.3.2.2.cmml">α</mi><mn id="S3.E15.m2.1.1.1.1.3.2.3" xref="S3.E15.m2.1.1.1.1.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E15.m2.1.1.1.1.3.1" xref="S3.E15.m2.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E15.m2.1.1.1.1.3.3" xref="S3.E15.m2.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E15.m2.1.1.1.1.3.3.1" xref="S3.E15.m2.1.1.1.1.3.3.1.cmml"><munderover id="S3.E15.m2.1.1.1.1.3.3.1a" xref="S3.E15.m2.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E15.m2.1.1.1.1.3.3.1.2.2" xref="S3.E15.m2.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E15.m2.1.1.1.1.3.3.1.2.3" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.cmml"><mi id="S3.E15.m2.1.1.1.1.3.3.1.2.3.2" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E15.m2.1.1.1.1.3.3.1.2.3.1" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E15.m2.1.1.1.1.3.3.1.2.3.3" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E15.m2.1.1.1.1.3.3.1.3" xref="S3.E15.m2.1.1.1.1.3.3.1.3.cmml">D</mi></munderover></mstyle><mrow id="S3.E15.m2.1.1.1.1.3.3.2" xref="S3.E15.m2.1.1.1.1.3.3.2.cmml"><msubsup id="S3.E15.m2.1.1.1.1.3.3.2.2" xref="S3.E15.m2.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E15.m2.1.1.1.1.3.3.2.2.2.2" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.2.cmml">f</mi><mi id="S3.E15.m2.1.1.1.1.3.3.2.2.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.3.cmml">i</mi><mo id="S3.E15.m2.1.1.1.1.3.3.2.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.2.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E15.m2.1.1.1.1.3.3.2.1" xref="S3.E15.m2.1.1.1.1.3.3.2.1.cmml">​</mo><msubsup id="S3.E15.m2.1.1.1.1.3.3.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E15.m2.1.1.1.1.3.3.2.3.2.2" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.2.cmml">P</mi><mi id="S3.E15.m2.1.1.1.1.3.3.2.3.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.3.cmml">i</mi><mo id="S3.E15.m2.1.1.1.1.3.3.2.3.3" xref="S3.E15.m2.1.1.1.1.3.3.2.3.3.cmml">′</mo></msubsup></mrow></mrow></mrow></mrow><mo id="S3.E15.m2.1.1.1.2" xref="S3.E15.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m2.1b"><apply id="S3.E15.m2.1.1.1.1.cmml" xref="S3.E15.m2.1.1.1"><eq id="S3.E15.m2.1.1.1.1.1.cmml" xref="S3.E15.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E15.m2.1.1.1.1.2.cmml" xref="S3.E15.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E15.m2.1.1.1.1.3.cmml" xref="S3.E15.m2.1.1.1.1.3"><times id="S3.E15.m2.1.1.1.1.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.1"></times><apply id="S3.E15.m2.1.1.1.1.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E15.m2.1.1.1.1.3.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.2.2">𝛼</ci><cn type="integer" id="S3.E15.m2.1.1.1.1.3.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.2.3">2</cn></apply><apply id="S3.E15.m2.1.1.1.1.3.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3"><apply id="S3.E15.m2.1.1.1.1.3.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.1.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1">superscript</csymbol><apply id="S3.E15.m2.1.1.1.1.3.3.1.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.1.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E15.m2.1.1.1.1.3.3.1.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.2"></sum><apply id="S3.E15.m2.1.1.1.1.3.3.1.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3"><eq id="S3.E15.m2.1.1.1.1.3.3.1.2.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E15.m2.1.1.1.1.3.3.1.2.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E15.m2.1.1.1.1.3.3.1.2.3.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E15.m2.1.1.1.1.3.3.1.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.3">𝐷</ci></apply><apply id="S3.E15.m2.1.1.1.1.3.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2"><times id="S3.E15.m2.1.1.1.1.3.3.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.1"></times><apply id="S3.E15.m2.1.1.1.1.3.3.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2">superscript</csymbol><apply id="S3.E15.m2.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.2.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E15.m2.1.1.1.1.3.3.2.2.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.2">𝑓</ci><ci id="S3.E15.m2.1.1.1.1.3.3.2.2.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E15.m2.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2.3">′</ci></apply><apply id="S3.E15.m2.1.1.1.1.3.3.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E15.m2.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.3.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E15.m2.1.1.1.1.3.3.2.3.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.2">𝑃</ci><ci id="S3.E15.m2.1.1.1.1.3.3.2.3.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E15.m2.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m2.1c">\displaystyle=\alpha_{2}\sum_{i=1}^{D}{f_{i}^{\prime}P_{i}^{\prime}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
<tbody id="S3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E16.m1.1" class="ltx_Math" alttext="\displaystyle f_{i}^{\prime}" display="inline"><semantics id="S3.E16.m1.1a"><msubsup id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml"><mi id="S3.E16.m1.1.1.2.2" xref="S3.E16.m1.1.1.2.2.cmml">f</mi><mi id="S3.E16.m1.1.1.2.3" xref="S3.E16.m1.1.1.2.3.cmml">i</mi><mo id="S3.E16.m1.1.1.3" xref="S3.E16.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.E16.m1.1b"><apply id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.cmml" xref="S3.E16.m1.1.1">superscript</csymbol><apply id="S3.E16.m1.1.1.2.cmml" xref="S3.E16.m1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.2.1.cmml" xref="S3.E16.m1.1.1">subscript</csymbol><ci id="S3.E16.m1.1.1.2.2.cmml" xref="S3.E16.m1.1.1.2.2">𝑓</ci><ci id="S3.E16.m1.1.1.2.3.cmml" xref="S3.E16.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.E16.m1.1.1.3.cmml" xref="S3.E16.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.1c">\displaystyle f_{i}^{\prime}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16.m2.2" class="ltx_Math" alttext="\displaystyle=\frac{1}{|\mathcal{E}_{i}|}\sum_{j\in\mathcal{E}_{i}}{f_{j}}," display="inline"><semantics id="S3.E16.m2.2a"><mrow id="S3.E16.m2.2.2.1" xref="S3.E16.m2.2.2.1.1.cmml"><mrow id="S3.E16.m2.2.2.1.1" xref="S3.E16.m2.2.2.1.1.cmml"><mi id="S3.E16.m2.2.2.1.1.2" xref="S3.E16.m2.2.2.1.1.2.cmml"></mi><mo id="S3.E16.m2.2.2.1.1.1" xref="S3.E16.m2.2.2.1.1.1.cmml">=</mo><mrow id="S3.E16.m2.2.2.1.1.3" xref="S3.E16.m2.2.2.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E16.m2.1.1" xref="S3.E16.m2.1.1.cmml"><mfrac id="S3.E16.m2.1.1a" xref="S3.E16.m2.1.1.cmml"><mn id="S3.E16.m2.1.1.3" xref="S3.E16.m2.1.1.3.cmml">1</mn><mrow id="S3.E16.m2.1.1.1.1" xref="S3.E16.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E16.m2.1.1.1.1.2" xref="S3.E16.m2.1.1.1.2.1.cmml">|</mo><msub id="S3.E16.m2.1.1.1.1.1" xref="S3.E16.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m2.1.1.1.1.1.2" xref="S3.E16.m2.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S3.E16.m2.1.1.1.1.1.3" xref="S3.E16.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E16.m2.1.1.1.1.3" xref="S3.E16.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E16.m2.2.2.1.1.3.1" xref="S3.E16.m2.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E16.m2.2.2.1.1.3.2" xref="S3.E16.m2.2.2.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E16.m2.2.2.1.1.3.2.1" xref="S3.E16.m2.2.2.1.1.3.2.1.cmml"><munder id="S3.E16.m2.2.2.1.1.3.2.1a" xref="S3.E16.m2.2.2.1.1.3.2.1.cmml"><mo movablelimits="false" id="S3.E16.m2.2.2.1.1.3.2.1.2" xref="S3.E16.m2.2.2.1.1.3.2.1.2.cmml">∑</mo><mrow id="S3.E16.m2.2.2.1.1.3.2.1.3" xref="S3.E16.m2.2.2.1.1.3.2.1.3.cmml"><mi id="S3.E16.m2.2.2.1.1.3.2.1.3.2" xref="S3.E16.m2.2.2.1.1.3.2.1.3.2.cmml">j</mi><mo id="S3.E16.m2.2.2.1.1.3.2.1.3.1" xref="S3.E16.m2.2.2.1.1.3.2.1.3.1.cmml">∈</mo><msub id="S3.E16.m2.2.2.1.1.3.2.1.3.3" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m2.2.2.1.1.3.2.1.3.3.2" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.2.cmml">ℰ</mi><mi id="S3.E16.m2.2.2.1.1.3.2.1.3.3.3" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><msub id="S3.E16.m2.2.2.1.1.3.2.2" xref="S3.E16.m2.2.2.1.1.3.2.2.cmml"><mi id="S3.E16.m2.2.2.1.1.3.2.2.2" xref="S3.E16.m2.2.2.1.1.3.2.2.2.cmml">f</mi><mi id="S3.E16.m2.2.2.1.1.3.2.2.3" xref="S3.E16.m2.2.2.1.1.3.2.2.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S3.E16.m2.2.2.1.2" xref="S3.E16.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m2.2b"><apply id="S3.E16.m2.2.2.1.1.cmml" xref="S3.E16.m2.2.2.1"><eq id="S3.E16.m2.2.2.1.1.1.cmml" xref="S3.E16.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S3.E16.m2.2.2.1.1.2.cmml" xref="S3.E16.m2.2.2.1.1.2">absent</csymbol><apply id="S3.E16.m2.2.2.1.1.3.cmml" xref="S3.E16.m2.2.2.1.1.3"><times id="S3.E16.m2.2.2.1.1.3.1.cmml" xref="S3.E16.m2.2.2.1.1.3.1"></times><apply id="S3.E16.m2.1.1.cmml" xref="S3.E16.m2.1.1"><divide id="S3.E16.m2.1.1.2.cmml" xref="S3.E16.m2.1.1"></divide><cn type="integer" id="S3.E16.m2.1.1.3.cmml" xref="S3.E16.m2.1.1.3">1</cn><apply id="S3.E16.m2.1.1.1.2.cmml" xref="S3.E16.m2.1.1.1.1"><abs id="S3.E16.m2.1.1.1.2.1.cmml" xref="S3.E16.m2.1.1.1.1.2"></abs><apply id="S3.E16.m2.1.1.1.1.1.cmml" xref="S3.E16.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m2.1.1.1.1.1.1.cmml" xref="S3.E16.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.E16.m2.1.1.1.1.1.2.cmml" xref="S3.E16.m2.1.1.1.1.1.2">ℰ</ci><ci id="S3.E16.m2.1.1.1.1.1.3.cmml" xref="S3.E16.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E16.m2.2.2.1.1.3.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2"><apply id="S3.E16.m2.2.2.1.1.3.2.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.1.1.3.2.1.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1">subscript</csymbol><sum id="S3.E16.m2.2.2.1.1.3.2.1.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.2"></sum><apply id="S3.E16.m2.2.2.1.1.3.2.1.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3"><in id="S3.E16.m2.2.2.1.1.3.2.1.3.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.1"></in><ci id="S3.E16.m2.2.2.1.1.3.2.1.3.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.2">𝑗</ci><apply id="S3.E16.m2.2.2.1.1.3.2.1.3.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.1.1.3.2.1.3.3.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3">subscript</csymbol><ci id="S3.E16.m2.2.2.1.1.3.2.1.3.3.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.2">ℰ</ci><ci id="S3.E16.m2.2.2.1.1.3.2.1.3.3.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E16.m2.2.2.1.1.3.2.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.1.1.3.2.2.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E16.m2.2.2.1.1.3.2.2.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2.2">𝑓</ci><ci id="S3.E16.m2.2.2.1.1.3.2.2.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m2.2c">\displaystyle=\frac{1}{|\mathcal{E}_{i}|}\sum_{j\in\mathcal{E}_{i}}{f_{j}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="S3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E17.m1.1" class="ltx_Math" alttext="\displaystyle P_{i}^{\prime}" display="inline"><semantics id="S3.E17.m1.1a"><msubsup id="S3.E17.m1.1.1" xref="S3.E17.m1.1.1.cmml"><mi id="S3.E17.m1.1.1.2.2" xref="S3.E17.m1.1.1.2.2.cmml">P</mi><mi id="S3.E17.m1.1.1.2.3" xref="S3.E17.m1.1.1.2.3.cmml">i</mi><mo id="S3.E17.m1.1.1.3" xref="S3.E17.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.E17.m1.1b"><apply id="S3.E17.m1.1.1.cmml" xref="S3.E17.m1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.1.cmml" xref="S3.E17.m1.1.1">superscript</csymbol><apply id="S3.E17.m1.1.1.2.cmml" xref="S3.E17.m1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.2.1.cmml" xref="S3.E17.m1.1.1">subscript</csymbol><ci id="S3.E17.m1.1.1.2.2.cmml" xref="S3.E17.m1.1.1.2.2">𝑃</ci><ci id="S3.E17.m1.1.1.2.3.cmml" xref="S3.E17.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.E17.m1.1.1.3.cmml" xref="S3.E17.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.1c">\displaystyle P_{i}^{\prime}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E17.m2.1" class="ltx_Math" alttext="\displaystyle=\sum_{j\in\mathcal{E}_{i}}{P_{j}}," display="inline"><semantics id="S3.E17.m2.1a"><mrow id="S3.E17.m2.1.1.1" xref="S3.E17.m2.1.1.1.1.cmml"><mrow id="S3.E17.m2.1.1.1.1" xref="S3.E17.m2.1.1.1.1.cmml"><mi id="S3.E17.m2.1.1.1.1.2" xref="S3.E17.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E17.m2.1.1.1.1.1" xref="S3.E17.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E17.m2.1.1.1.1.3" xref="S3.E17.m2.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E17.m2.1.1.1.1.3.1" xref="S3.E17.m2.1.1.1.1.3.1.cmml"><munder id="S3.E17.m2.1.1.1.1.3.1a" xref="S3.E17.m2.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E17.m2.1.1.1.1.3.1.2" xref="S3.E17.m2.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E17.m2.1.1.1.1.3.1.3" xref="S3.E17.m2.1.1.1.1.3.1.3.cmml"><mi id="S3.E17.m2.1.1.1.1.3.1.3.2" xref="S3.E17.m2.1.1.1.1.3.1.3.2.cmml">j</mi><mo id="S3.E17.m2.1.1.1.1.3.1.3.1" xref="S3.E17.m2.1.1.1.1.3.1.3.1.cmml">∈</mo><msub id="S3.E17.m2.1.1.1.1.3.1.3.3" xref="S3.E17.m2.1.1.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E17.m2.1.1.1.1.3.1.3.3.2" xref="S3.E17.m2.1.1.1.1.3.1.3.3.2.cmml">ℰ</mi><mi id="S3.E17.m2.1.1.1.1.3.1.3.3.3" xref="S3.E17.m2.1.1.1.1.3.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><msub id="S3.E17.m2.1.1.1.1.3.2" xref="S3.E17.m2.1.1.1.1.3.2.cmml"><mi id="S3.E17.m2.1.1.1.1.3.2.2" xref="S3.E17.m2.1.1.1.1.3.2.2.cmml">P</mi><mi id="S3.E17.m2.1.1.1.1.3.2.3" xref="S3.E17.m2.1.1.1.1.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E17.m2.1.1.1.2" xref="S3.E17.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m2.1b"><apply id="S3.E17.m2.1.1.1.1.cmml" xref="S3.E17.m2.1.1.1"><eq id="S3.E17.m2.1.1.1.1.1.cmml" xref="S3.E17.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E17.m2.1.1.1.1.2.cmml" xref="S3.E17.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E17.m2.1.1.1.1.3.cmml" xref="S3.E17.m2.1.1.1.1.3"><apply id="S3.E17.m2.1.1.1.1.3.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E17.m2.1.1.1.1.3.1.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E17.m2.1.1.1.1.3.1.2.cmml" xref="S3.E17.m2.1.1.1.1.3.1.2"></sum><apply id="S3.E17.m2.1.1.1.1.3.1.3.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3"><in id="S3.E17.m2.1.1.1.1.3.1.3.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.1"></in><ci id="S3.E17.m2.1.1.1.1.3.1.3.2.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.2">𝑗</ci><apply id="S3.E17.m2.1.1.1.1.3.1.3.3.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E17.m2.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3">subscript</csymbol><ci id="S3.E17.m2.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3.2">ℰ</ci><ci id="S3.E17.m2.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E17.m2.1.1.1.1.3.2.cmml" xref="S3.E17.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E17.m2.1.1.1.1.3.2.1.cmml" xref="S3.E17.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E17.m2.1.1.1.1.3.2.2.cmml" xref="S3.E17.m2.1.1.1.1.3.2.2">𝑃</ci><ci id="S3.E17.m2.1.1.1.1.3.2.3.cmml" xref="S3.E17.m2.1.1.1.1.3.2.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m2.1c">\displaystyle=\sum_{j\in\mathcal{E}_{i}}{P_{j}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.3">여기서 <math alttext="\alpha_{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.3.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.3.m1.1a"><msub id="S3.SS3.SSS0.Px2.p1.3.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2.cmml">α</mi><mn id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2">𝛼</ci><cn id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m1.1c">\alpha_{2}</annotation></semantics></math>는 디바이스-레벨 밸런스 팩터라고 불리는 하이퍼-파라미터이다. 실제로, 라우팅 붕괴의 위험을 완화하기 위해 작은 전문가 수준의 균형 요소를 설정하고, 장치 전반에 걸쳐 균형 계산을 촉진하기 위해 더 큰 장치 수준의 균형 요소를 설정한다.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Validation Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Training Data and Tokenization</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">우리의 훈련 데이터는 DeepSeek-AI가 만든 대규모 다국어 말뭉치에서 샘플링된다. 코퍼스는 주로 영어와 중국어에 초점을 맞추지만 다른 언어들도 포함한다. 웹 텍스트, 수학 자료, 코딩 스크립트, 출판 문헌 및 기타 다양한 텍스트 자료를 포함한 다양한 출처에서 파생된다. 검증 실험을 위해 코퍼스에서 100B 토큰을 포함하는 하위 집합을 샘플링하여 모델을 학습한다. 토큰화를 위해 HuggingFace Tokenizer<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://github.com/huggingface/tokenizers</span></span></span> 도구를 사용하여 훈련 말뭉치의 작은 부분 집합에 바이트 쌍 인코딩(BPE) <cite class="ltx_cite ltx_citemacro_citep">(Sennrich et al., <a class="ltx_ref" href="#bib.bib45" title="">2016</a>)</cite> tokenizers를 훈련합니다. 검증 실험에서는 어휘 크기가 8K인 토큰화기를 준비하였으며, 더 큰 모델을 훈련할 때 어휘 크기가 확장될 것이다.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Infrastructures</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">실험은 HAI-LLM <cite class="ltx_cite ltx_citemacro_citep">(High-Flyer, <a class="ltx_ref" href="#bib.bib22" title="">2023</a>)</cite>, 데이터와 텐서 병렬성을 결합하여 텐서 병렬성 <cite class="ltx_cite ltx_citemacro_citep">(Shoeybi et al., <a class="ltx_ref" href="#bib.bib49" title="">2019</a>; Narayanan et al., <a class="ltx_ref" href="#bib.bib37" title="">2021</a>; Korthikanti et al., <a class="ltx_ref" href="#bib.bib29" title="">2023</a>)</cite>, ZeRO 데이터 병렬성 <cite class="ltx_cite ltx_citemacro_citep">(Rajbhandari et al., <a class="ltx_ref" href="#bib.bib39" title="">2020</a>)</cite>, PipeDream 파이프라인 병렬성 <cite class="ltx_cite ltx_citemacro_citep">(Harlap et al., <a class="ltx_ref" href="#bib.bib19" title="">2018</a>)</cite>, 보다 구체적으로 전문가 병렬성 <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> 등의 다중 병렬성 전략을 통합한 효율적이고 경량화된 훈련 프레임워크를 기반으로 실험을 진행하였다. 성능 최적화를 위해 GPU 커널을 CUDA와 Triton<cite class="ltx_cite ltx_citemacro_citep">(Tillet et al., <a class="ltx_ref" href="#bib.bib51" title="">2019</a>)</cite>로 개발하여 알고리즘을 게이팅하고 서로 다른 전문가에서 선형 계층에 걸쳐 계산을 융합한다.</p>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS2.p2.1">모든 실험은 NVIDIA A100 또는 H800 GPU가 장착된 클러스터에서 수행된다. A100 클러스터의 각 노드는 NVLink 브리지를 통해 쌍으로 연결된 8개의 GPU를 포함한다. H800 클러스터는 또한 노드 내에서 NVLink 및 NVSwitch를 사용하여 상호 연결된 노드당 8개의 GPU를 특징으로 한다. A100 및 H800 클러스터 모두에 대해, InfiniBand 상호연결은 노드들 간의 통신을 용이하게 하기 위해 활용된다.</p>
</div>
</section>
<section id="S4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3 </span>Hyper-Parameters</h4>

<section id="S4.SS1.SSS3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Model Settings.</h5>

<div id="S4.SS1.SSS3.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS3.Px1.p1.1">검증 실험에서는 트랜스포머 층의 수를 9개, 은닉 차원을 1280개로 설정하였다. 총 10개의 어텐션 헤드를 갖는 다중 헤드 어텐션 메커니즘을 사용하였으며, 각 헤드의 차원은 128이다. 초기화를 위해 학습 가능한 모든 파라미터는 0.006의 표준 편차로 무작위로 초기화된다. 모든 FFN을 MoE 층으로 대체하고, 전문가 파라미터의 총 수가 표준 FFN의 16배인지 확인한다. 또한, 공유된 전문가 파라미터와 활성화된 라우팅된 전문가 파라미터를 포함한 활성화된 전문가 파라미터를 표준 FFN의 2배로 유지한다. 이러한 구성 하에서, 각각의 MoE 모델은 대략 2B 총 파라미터를 가지며, 활성화된 파라미터의 수는 약 0.3B이다.</p>
</div>
</section>
<section id="S4.SS1.SSS3.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Settings.</h5>

<div id="S4.SS1.SSS3.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS3.Px2.p1.4">Hyper-parameters가 <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.1.m1.1"><semantics id="S4.SS1.SSS3.Px2.p1.1.m1.1a"><mrow id="S4.SS1.SSS3.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.cmml"><msub id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2.cmml">β</mi><mn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.1.m1.1b"><apply id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1"><eq id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1"></eq><apply id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2">𝛽</ci><cn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.1.m1.1c">\beta_{1}=0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.95" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.2.m2.1"><semantics id="S4.SS1.SSS3.Px2.p1.2.m2.1a"><mrow id="S4.SS1.SSS3.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.cmml"><msub id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2.cmml">β</mi><mn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.2.m2.1b"><apply id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1"><eq id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1"></eq><apply id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2">𝛽</ci><cn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.2.m2.1c">\beta_{2}=0.95</annotation></semantics></math>, <math alttext="\mathrm{weight\_decay}=0.1" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.3.m3.1"><semantics id="S4.SS1.SSS3.Px2.p1.3.m3.1a"><mrow id="S4.SS1.SSS3.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.cmml"><mrow id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.cmml"><mi id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2.cmml">weight</mi><mo id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1" lspace="0em" rspace="0em" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1a" lspace="0em" rspace="0em" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4.cmml">decay</mi></mrow><mo id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.3.m3.1b"><apply id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1"><eq id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1"></eq><apply id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2"><times id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1"></times><ci id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2">weight</ci><ci id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3">_</ci><ci id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4">decay</ci></apply><cn id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.3.m3.1c">\mathrm{weight\_decay}=0.1</annotation></semantics></math>로 설정된 AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite>를 채용한다. 학습률은 준비-단계-붕괴 전략을 사용하여 예약된다. 처음에, 학습률은 처음 2K 단계 동안 0에서 최대값까지 선형적으로 증가한다. 이어서, 학습 속도는 훈련 단계의 80%에서 0.316을 곱하고, 다시 훈련 단계의 90%에서 0.316을 곱한다. 검증 실험을 위한 최대 학습률은 <math alttext="1.08\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.4.m4.1"><semantics id="S4.SS1.SSS3.Px2.p1.4.m4.1a"><mrow id="S4.SS1.SSS3.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.cmml"><mn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2.cmml">1.08</mn><mo id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1.cmml">×</mo><msup id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.cmml"><mn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.cmml"><mo id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3a" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.4.m4.1b"><apply id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1"><times id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1"></times><cn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2">1.08</cn><apply id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3">superscript</csymbol><cn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2">10</cn><apply id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3"><minus id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3"></minus><cn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.4.m4.1c">1.08\times 10^{-3}</annotation></semantics></math>로 설정되고, 그래디언트 클리핑 규범은 1.0으로 설정된다. 배치 크기는 2K로 설정되고, 최대 시퀀스 길이가 2K인 경우, 각각의 트레이닝 배치에는 4M 토큰이 포함된다. 상응하게, 100B 트레이닝 토큰들을 달성하기 위해 트레이닝 단계들의 총 수는 25,000으로 설정된다. 훈련 데이터가 풍부하기 때문에 훈련 중 중도 탈락은 사용하지 않습니다. 상대적으로 작은 모델 크기를 감안할 때, 전문가 파라미터를 포함한 모든 파라미터는 불균형한 계산을 피하기 위해 단일 GPU 장치에 배치된다. 이에 따라 교육 중에 토큰을 떨어뜨리지 않으며 장치 수준 잔액 손실을 사용하지 않습니다. 라우팅 붕괴를 방지하기 위해 전문가 수준의 균형 계수를 0.01로 설정하였다.</p>
</div>
<div id="S4.SS1.SSS3.Px2.p2" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS3.Px2.p2.1">가독성을 위해 부록 <a class="ltx_ref" href="#A1" title="Appendix A Overview of Hyper-Parameters ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">A</span></a>에서 다양한 크기에 걸쳐 DeepSeekMoE에 대한 하이퍼 매개 변수의 개요 표도 제시한다.</p>
</div>
</section>
</section>
<section id="S4.SS1.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.4 </span>Evaluation Benchmarks</h4>

<div id="S4.SS1.SSS4.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.p1.1">다양한 유형의 작업을 포괄하는 광범위한 벤치마크에 대한 평가를 수행합니다. 벤치마크를 다음과 같이 나열합니다.</p>
</div>
<section id="S4.SS1.SSS4.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Language Modeling.</h5>

<div id="S4.SS1.SSS4.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px1.p1.1">언어 모델링을 위해, 우리는 Pile<cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="#bib.bib17" title="">2020</a>)</cite>의 테스트 세트에 대한 모델을 평가하며, 평가 메트릭은 교차 엔트로피 손실이다.</p>
</div>
</section>
<section id="S4.SS1.SSS4.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Language Understanding and Reasoning.</h5>

<div id="S4.SS1.SSS4.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px2.p1.1">언어 이해와 추론을 위해 HellaSwag <cite class="ltx_cite ltx_citemacro_citep">(Zellers et al., <a class="ltx_ref" href="#bib.bib59" title="">2019</a>)</cite>, PIQA <cite class="ltx_cite ltx_citemacro_citep">(Bisk et al., <a class="ltx_ref" href="#bib.bib5" title="">2020</a>)</cite>, ARC-challenge와 ARC-easy <cite class="ltx_cite ltx_citemacro_citep">(Clark et al., <a class="ltx_ref" href="#bib.bib9" title="">2018</a>)</cite>를 고려한다. 이러한 작업에 대한 평가 메트릭은 정확성입니다.</p>
</div>
</section>
<section id="S4.SS1.SSS4.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reading Comprehension.</h5>

<div id="S4.SS1.SSS4.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px3.p1.1">읽기 이해를 위해 RACE-high와 RACE-middle <cite class="ltx_cite ltx_citemacro_cite">Lai et al. (<a class="ltx_ref" href="#bib.bib31" title="">2017</a>)</cite>를 사용하며, 평가 척도는 정확도이다.</p>
</div>
</section>
<section id="S4.SS1.SSS4.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Code Generation.</h5>

<div id="S4.SS1.SSS4.Px4.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px4.p1.1">코드 생성을 위해 HumanEval <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="#bib.bib8" title="">2021</a>)</cite>와 MBPP <cite class="ltx_cite ltx_citemacro_citep">(Austin et al., <a class="ltx_ref" href="#bib.bib3" title="">2021</a>)</cite>에 대한 모델을 평가한다. 평가 메트릭은 하나의 세대 시도에 대한 패스 레이트를 나타내는 Pass@1이다.</p>
</div>
</section>
<section id="S4.SS1.SSS4.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Closed-Book Question Answering.</h5>

<div id="S4.SS1.SSS4.Px5.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px5.p1.1">클로즈북 질의응답을 위해, 우리는 TriviaQA <cite class="ltx_cite ltx_citemacro_citep">(Joshi et al., <a class="ltx_ref" href="#bib.bib28" title="">2017</a>)</cite>와 NaturalQuestions <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski et al., <a class="ltx_ref" href="#bib.bib30" title="">2019</a>)</cite>를 고려한다. 평가 메트릭은 정확 일치율입니다.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></td>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.2.1" class="ltx_text ltx_font_bold"># Shot</span></td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.3.1" class="ltx_text ltx_font_bold">Dense</span></td>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.4.1" class="ltx_text ltx_font_bold">Hash Layer</span></td>
<td id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.5.1" class="ltx_text ltx_font_bold">Switch</span></td>
<td id="S4.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.6.1" class="ltx_text ltx_font_bold">GShard</span></td>
<td id="S4.T1.1.1.1.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.7.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="S4.T1.1.2.2" class="ltx_tr">
<td id="S4.T1.1.2.2.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"># Total Params</td>
<td id="S4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td id="S4.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
<td id="S4.T1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
<td id="S4.T1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
<td id="S4.T1.1.2.2.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
</tr>
<tr id="S4.T1.1.3.3" class="ltx_tr">
<td id="S4.T1.1.3.3.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;"># Activated Params</td>
<td id="S4.T1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td id="S4.T1.1.3.3.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td id="S4.T1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td id="S4.T1.1.3.3.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.3B</td>
<td id="S4.T1.1.3.3.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.3B</td>
</tr>
<tr id="S4.T1.1.4.4" class="ltx_tr">
<td id="S4.T1.1.4.4.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">FLOPs per 2K Tokens</td>
<td id="S4.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">2.9T</td>
<td id="S4.T1.1.4.4.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">2.9T</td>
<td id="S4.T1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">2.9T</td>
<td id="S4.T1.1.4.4.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">4.3T</td>
<td id="S4.T1.1.4.4.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">4.3T</td>
</tr>
<tr id="S4.T1.1.5.5" class="ltx_tr">
<td id="S4.T1.1.5.5.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;"># Training Tokens</td>
<td id="S4.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td id="S4.T1.1.5.5.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td id="S4.T1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td id="S4.T1.1.5.5.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td id="S4.T1.1.5.5.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
</tr>
<tr id="S4.T1.1.6.6" class="ltx_tr">
<td id="S4.T1.1.6.6.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">Pile&nbsp;(Loss)</td>
<td id="S4.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.060</td>
<td id="S4.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1.932</td>
<td id="S4.T1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1.881</td>
<td id="S4.T1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1.867</td>
<td id="S4.T1.1.6.6.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.6.6.7.1" class="ltx_text ltx_font_bold">1.808</span></td>
</tr>
<tr id="S4.T1.1.7.7" class="ltx_tr">
<td id="S4.T1.1.7.7.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">HellaSwag&nbsp;(Acc.)</td>
<td id="S4.T1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">38.8</td>
<td id="S4.T1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">46.2</td>
<td id="S4.T1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">49.1</td>
<td id="S4.T1.1.7.7.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">50.5</td>
<td id="S4.T1.1.7.7.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.7.7.7.1" class="ltx_text ltx_font_bold">54.8</span></td>
</tr>
<tr id="S4.T1.1.8.8" class="ltx_tr">
<td id="S4.T1.1.8.8.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">PIQA&nbsp;(Acc.)</td>
<td id="S4.T1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">66.8</td>
<td id="S4.T1.1.8.8.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">68.4</td>
<td id="S4.T1.1.8.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">70.5</td>
<td id="S4.T1.1.8.8.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">70.6</td>
<td id="S4.T1.1.8.8.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.8.8.7.1" class="ltx_text ltx_font_bold">72.3</span></td>
</tr>
<tr id="S4.T1.1.9.9" class="ltx_tr">
<td id="S4.T1.1.9.9.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">ARC-easy&nbsp;(Acc.)</td>
<td id="S4.T1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">41.0</td>
<td id="S4.T1.1.9.9.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">45.3</td>
<td id="S4.T1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">45.9</td>
<td id="S4.T1.1.9.9.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">43.9</td>
<td id="S4.T1.1.9.9.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.9.9.7.1" class="ltx_text ltx_font_bold">49.4</span></td>
</tr>
<tr id="S4.T1.1.10.10" class="ltx_tr">
<td id="S4.T1.1.10.10.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">ARC-challenge&nbsp;(Acc.)</td>
<td id="S4.T1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.10.10.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">26.0</td>
<td id="S4.T1.1.10.10.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">28.2</td>
<td id="S4.T1.1.10.10.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">30.2</td>
<td id="S4.T1.1.10.10.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">31.6</td>
<td id="S4.T1.1.10.10.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.10.10.7.1" class="ltx_text ltx_font_bold">34.3</span></td>
</tr>
<tr id="S4.T1.1.11.11" class="ltx_tr">
<td id="S4.T1.1.11.11.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">RACE-middle&nbsp;(Acc.)</td>
<td id="S4.T1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td id="S4.T1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">38.8</td>
<td id="S4.T1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">38.8</td>
<td id="S4.T1.1.11.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">43.6</td>
<td id="S4.T1.1.11.11.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">42.1</td>
<td id="S4.T1.1.11.11.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.11.11.7.1" class="ltx_text ltx_font_bold">44.0</span></td>
</tr>
<tr id="S4.T1.1.12.12" class="ltx_tr">
<td id="S4.T1.1.12.12.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">RACE-high&nbsp;(Acc.)</td>
<td id="S4.T1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td id="S4.T1.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">29.0</td>
<td id="S4.T1.1.12.12.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">30.0</td>
<td id="S4.T1.1.12.12.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">30.9</td>
<td id="S4.T1.1.12.12.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">30.4</td>
<td id="S4.T1.1.12.12.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.12.12.7.1" class="ltx_text ltx_font_bold">31.7</span></td>
</tr>
<tr id="S4.T1.1.13.13" class="ltx_tr">
<td id="S4.T1.1.13.13.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">HumanEval&nbsp;(Pass@1)</td>
<td id="S4.T1.1.13.13.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.13.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">0.0</td>
<td id="S4.T1.1.13.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1.2</td>
<td id="S4.T1.1.13.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.4</td>
<td id="S4.T1.1.13.13.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">3.7</td>
<td id="S4.T1.1.13.13.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.13.13.7.1" class="ltx_text ltx_font_bold">4.9</span></td>
</tr>
<tr id="S4.T1.1.14.14" class="ltx_tr">
<td id="S4.T1.1.14.14.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">MBPP&nbsp;(Pass@1)</td>
<td id="S4.T1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">3-shot</td>
<td id="S4.T1.1.14.14.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.2</td>
<td id="S4.T1.1.14.14.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.6</td>
<td id="S4.T1.1.14.14.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0.4</td>
<td id="S4.T1.1.14.14.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.2</td>
<td id="S4.T1.1.14.14.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.14.14.7.1" class="ltx_text ltx_font_bold">2.2</span></td>
</tr>
<tr id="S4.T1.1.15.15" class="ltx_tr">
<td id="S4.T1.1.15.15.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">TriviaQA&nbsp;(EM)</td>
<td id="S4.T1.1.15.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td id="S4.T1.1.15.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">4.9</td>
<td id="S4.T1.1.15.15.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">6.5</td>
<td id="S4.T1.1.15.15.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">8.9</td>
<td id="S4.T1.1.15.15.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">10.2</td>
<td id="S4.T1.1.15.15.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.15.15.7.1" class="ltx_text ltx_font_bold">16.6</span></td>
</tr>
<tr id="S4.T1.1.16.16" class="ltx_tr">
<td id="S4.T1.1.16.16.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">NaturalQuestions&nbsp;(EM)</td>
<td id="S4.T1.1.16.16.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td id="S4.T1.1.16.16.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">1.4</td>
<td id="S4.T1.1.16.16.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">1.4</td>
<td id="S4.T1.1.16.16.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">2.5</td>
<td id="S4.T1.1.16.16.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">3.2</td>
<td id="S4.T1.1.16.16.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.16.16.7.1" class="ltx_text ltx_font_bold">5.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 1:</span></figcaption>
Evaluation results for validation experiments.
<span id="S4.T1.3.1" class="ltx_text ltx_font_bold">Bold</span> font indicates the best.
Compared with other MoE architectures, DeepSeekMoE exhibits a substantial performance advantage.
</figcaption>
</figure>
</section>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Evaluations</h3>

<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">DeepSeekMoE를 포함하여 검증 실험을 위해 5가지 모델을 비교한다. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.1">Dense</span>은 0.2B 총 파라미터를 갖는 표준 dense Transformer 언어 모델을 나타낸다. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.2">Hash Layer</span> <cite class="ltx_cite ltx_citemacro_citep">(Roller et al., <a class="ltx_ref" href="#bib.bib42" title="">2021</a>)</cite>는 조밀한 기준선과 정렬된 2.0B 총 파라미터 및 0.2B 활성화된 파라미터를 갖는 top-1 해시 라우팅을 기반으로 하는 MoE 아키텍처이다. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.3">Switch Transformer</span> <cite class="ltx_cite ltx_citemacro_citep">(Fedus et al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite>는 top-1 학습 가능한 라우팅을 기반으로 하는 또 다른 잘 알려진 MoE 아키텍처이며, 총 파라미터와 활성화된 파라미터는 Hash Layer와 동일하다. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.4">GShard</span> <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite>는 top-1 라우팅 방법에 비해 한 명의 전문가가 더 활성화되기 때문에 2.0B의 총 매개 변수와 0.3B의 활성화된 매개 변수를 사용하여 top-2 학습 가능한 라우팅 전략을 사용합니다. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.5">DeepSeekMoE</span> has 1 shared expert and 63 routed experts, where each expert is 0.25 times of a standard FFN. DeepSeekMoE를 포함하여, 비교된 모든 모델들은 동일한 트레이닝 코퍼스와 트레이닝 하이퍼-파라미터를 공유한다. 비교된 모든 MoE 모델은 동일한 수의 총 파라미터를 가지며, GShard는 DeepSeekMoE와 동일한 수의 활성화된 파라미터를 갖는다.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5>

<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">평가 결과를 표 <a class="ltx_ref" href="#S4.T1" title="Table 1 ‣ Closed-Book Question Answering. ‣ 4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>에 제시한다. 검증된 모든 모델에 대해 100B 토큰에 대한 훈련 후 최종 평가 결과를 보고한다. 표에서 우리는 다음과 같은 관찰을 한다. (1) 희박한 아키텍처와 더 많은 총 매개변수를 사용하여 해시 계층 및 스위치 트랜스포머는 동일한 수의 활성화된 매개변수를 사용하여 조밀한 기준선보다 훨씬 더 강력한 성능을 달성한다. (2) 해시 레이어 및 스위치 트랜스포머와 비교하여, GShard는 활성화된 파라미터가 더 많고 스위치 트랜스포머보다 약간 더 나은 성능을 달성한다. (3) 동일한 수의 총 파라미터 및 활성화된 파라미터로, DeepSeekMoE는 GShard에 비해 압도적인 이점을 보여준다. 이러한 결과는 MoE 아키텍처의 기존 풍경 내에서 우리의 DeepSeekMoE 아키텍처의 우수성을 보여준다.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.2.2" class="ltx_tr">
<th id="S4.T2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.3.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="S4.T2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.4.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.1.1.1.1" class="ltx_text ltx_font_bold">GShard<math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.T2.1.1.1.1.m1.1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><times id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">absent</csymbol><cn type="float" id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\times 1.5</annotation></semantics></math></span></td>
<td id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.2.1" class="ltx_text ltx_font_bold">Dense<math id="S4.T2.2.2.2.1.m1.1" class="ltx_Math" alttext="\times 16" display="inline"><semantics id="S4.T2.2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.cmml"><mi id="S4.T2.2.2.2.1.m1.1.1.2" xref="S4.T2.2.2.2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.T2.2.2.2.1.m1.1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="S4.T2.2.2.2.1.m1.1.1.3" xref="S4.T2.2.2.2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.1.m1.1b"><apply id="S4.T2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1"><times id="S4.T2.2.2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T2.2.2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S4.T2.2.2.2.1.m1.1.1.3.cmml" xref="S4.T2.2.2.2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.1.m1.1c">\times 16</annotation></semantics></math></span></td>
<td id="S4.T2.2.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.5.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="S4.T2.2.3.1" class="ltx_tr">
<th id="S4.T2.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th id="S4.T2.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.5</td>
<td id="S4.T2.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1</td>
<td id="S4.T2.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr id="S4.T2.2.4.2" class="ltx_tr">
<th id="S4.T2.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th id="S4.T2.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.4.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="S4.T2.2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td id="S4.T2.2.4.2.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr id="S4.T2.2.5.3" class="ltx_tr">
<th id="S4.T2.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th id="S4.T2.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.5.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="S4.T2.2.5.3.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td id="S4.T2.2.5.3.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr id="S4.T2.2.6.4" class="ltx_tr">
<th id="S4.T2.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th id="S4.T2.2.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.6.4.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.83B</td>
<td id="S4.T2.2.6.4.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td id="S4.T2.2.6.4.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
</tr>
<tr id="S4.T2.2.7.5" class="ltx_tr">
<th id="S4.T2.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th id="S4.T2.2.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.7.5.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.35B</td>
<td id="S4.T2.2.7.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td id="S4.T2.2.7.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.24B</td>
</tr>
<tr id="S4.T2.2.8.6" class="ltx_tr">
<th id="S4.T2.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">FLOPs per 2K Tokens</th>
<th id="S4.T2.2.8.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.8.6.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">5.8T</td>
<td id="S4.T2.2.8.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">24.6T</td>
<td id="S4.T2.2.8.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">4.3T</td>
</tr>
<tr id="S4.T2.2.9.7" class="ltx_tr">
<th id="S4.T2.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th id="S4.T2.2.9.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.9.7.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="S4.T2.2.9.7.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="S4.T2.2.9.7.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr id="S4.T2.2.10.8" class="ltx_tr">
<th id="S4.T2.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Pile&nbsp;(Loss)</th>
<th id="S4.T2.2.10.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.10.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.808</td>
<td id="S4.T2.2.10.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.806</td>
<td id="S4.T2.2.10.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.808</td>
</tr>
<tr id="S4.T2.2.11.9" class="ltx_tr">
<th id="S4.T2.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S4.T2.2.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.11.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">54.4</td>
<td id="S4.T2.2.11.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">55.1</td>
<td id="S4.T2.2.11.9.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">54.8</td>
</tr>
<tr id="S4.T2.2.12.10" class="ltx_tr">
<th id="S4.T2.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S4.T2.2.12.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.12.10.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.1</td>
<td id="S4.T2.2.12.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.9</td>
<td id="S4.T2.2.12.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">72.3</td>
</tr>
<tr id="S4.T2.2.13.11" class="ltx_tr">
<th id="S4.T2.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S4.T2.2.13.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.13.11.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">47.3</td>
<td id="S4.T2.2.13.11.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">51.9</td>
<td id="S4.T2.2.13.11.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">49.4</td>
</tr>
<tr id="S4.T2.2.14.12" class="ltx_tr">
<th id="S4.T2.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S4.T2.2.14.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.14.12.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">34.1</td>
<td id="S4.T2.2.14.12.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">33.8</td>
<td id="S4.T2.2.14.12.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">34.3</td>
</tr>
<tr id="S4.T2.2.15.13" class="ltx_tr">
<th id="S4.T2.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S4.T2.2.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="S4.T2.2.15.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">46.4</td>
<td id="S4.T2.2.15.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">46.3</td>
<td id="S4.T2.2.15.13.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">44.0</td>
</tr>
<tr id="S4.T2.2.16.14" class="ltx_tr">
<th id="S4.T2.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S4.T2.2.16.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="S4.T2.2.16.14.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">32.4</td>
<td id="S4.T2.2.16.14.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">33.0</td>
<td id="S4.T2.2.16.14.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
</tr>
<tr id="S4.T2.2.17.15" class="ltx_tr">
<th id="S4.T2.2.17.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S4.T2.2.17.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.17.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">3.0</td>
<td id="S4.T2.2.17.15.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">4.3</td>
<td id="S4.T2.2.17.15.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">4.9</td>
</tr>
<tr id="S4.T2.2.18.16" class="ltx_tr">
<th id="S4.T2.2.18.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S4.T2.2.18.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td id="S4.T2.2.18.16.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.6</td>
<td id="S4.T2.2.18.16.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.2</td>
<td id="S4.T2.2.18.16.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.2</td>
</tr>
<tr id="S4.T2.2.19.17" class="ltx_tr">
<th id="S4.T2.2.19.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S4.T2.2.19.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="S4.T2.2.19.17.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">15.7</td>
<td id="S4.T2.2.19.17.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">16.5</td>
<td id="S4.T2.2.19.17.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">16.6</td>
</tr>
<tr id="S4.T2.2.20.18" class="ltx_tr">
<th id="S4.T2.2.20.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S4.T2.2.20.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="S4.T2.2.20.18.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">4.7</td>
<td id="S4.T2.2.20.18.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">6.3</td>
<td id="S4.T2.2.20.18.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">5.7</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 2:</span></figcaption>
Comparisons among DeepSeekMoE, larger GShard models, and larger dense models.
In the line of “# Experts”, <math id="S4.T2.11.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.T2.11.m1.1b"><mi id="S4.T2.11.m1.1.1" xref="S4.T2.11.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.11.m1.1c"><ci id="S4.T2.11.m1.1.1.cmml" xref="S4.T2.11.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.m1.1d">a</annotation></semantics></math> + <math id="S4.T2.12.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.T2.12.m2.1b"><mi id="S4.T2.12.m2.1.1" xref="S4.T2.12.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.12.m2.1c"><ci id="S4.T2.12.m2.1.1.cmml" xref="S4.T2.12.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.m2.1d">b</annotation></semantics></math> denotes <math id="S4.T2.13.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.T2.13.m3.1b"><mi id="S4.T2.13.m3.1.1" xref="S4.T2.13.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.13.m3.1c"><ci id="S4.T2.13.m3.1.1.cmml" xref="S4.T2.13.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.m3.1d">a</annotation></semantics></math> shared experts and <math id="S4.T2.14.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.T2.14.m4.1b"><mi id="S4.T2.14.m4.1.1" xref="S4.T2.14.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.14.m4.1c"><ci id="S4.T2.14.m4.1.1.cmml" xref="S4.T2.14.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.m4.1d">b</annotation></semantics></math> routed experts.
In the line of “# Activated Experts”, <math id="S4.T2.15.m5.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.T2.15.m5.1b"><mi id="S4.T2.15.m5.1.1" xref="S4.T2.15.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.15.m5.1c"><ci id="S4.T2.15.m5.1.1.cmml" xref="S4.T2.15.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.m5.1d">a</annotation></semantics></math> + <math id="S4.T2.16.m6.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.T2.16.m6.1b"><mi id="S4.T2.16.m6.1.1" xref="S4.T2.16.m6.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.16.m6.1c"><ci id="S4.T2.16.m6.1.1.cmml" xref="S4.T2.16.m6.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.m6.1d">b</annotation></semantics></math> denotes <math id="S4.T2.17.m7.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.T2.17.m7.1b"><mi id="S4.T2.17.m7.1.1" xref="S4.T2.17.m7.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.17.m7.1c"><ci id="S4.T2.17.m7.1.1.cmml" xref="S4.T2.17.m7.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.m7.1d">a</annotation></semantics></math> activated shared experts and <math id="S4.T2.18.m8.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.T2.18.m8.1b"><mi id="S4.T2.18.m8.1.1" xref="S4.T2.18.m8.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.18.m8.1c"><ci id="S4.T2.18.m8.1.1.cmml" xref="S4.T2.18.m8.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.m8.1d">b</annotation></semantics></math> activated routed experts.
DeepSeekMoE achieves comparable performance with a GShard model containing 1.5 times expert parameters and computation.
In addition, DeepSeekMoE nearly approaches the performance of a dense model with 16 times FFN parameters, which sets the upper bound for MoE models in terms of the model capacity.
</figcaption>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>DeepSeekMoE Aligns Closely with the upper bound of MoE Models</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS3.p1.1">우리는 DeepSeekMoE가 조밀한 기준선 및 다른 MoE 아키텍처보다 우수하다는 것을 입증했다. DeepSeekMoE의 성능을 보다 정확하게 이해하기 위해 더 많은 총 매개변수 또는 활성화된 매개변수와 더 큰 기준선과 비교한다. 비교를 통해 DeepSeekMoE와 동등한 성능을 얻기 위해 GShard 또는 조밀한 기준선의 필요한 모델 크기를 추정할 수 있다.</p>
</div>
<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Comparison with GShard<math id="S4.SS3.SSS0.Px1.1.m1.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="S4.SS3.SSS0.Px1.1.m1.1b"><mrow id="S4.SS3.SSS0.Px1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.1.m1.1c"><apply id="S4.SS3.SSS0.Px1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1.2">absent</csymbol><cn type="float" id="S4.SS3.SSS0.Px1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.1.m1.1d">\times 1.5</annotation></semantics></math>.</h5>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.3">표 <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ Results. ‣ 4.2 Evaluations ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>는 DeepSeekMoE와 전문가 크기의 1.5배인 더 큰 GShard 모델의 비교를 보여주며, 이는 전문가 파라미터와 전문가 계산 모두 1.5배의 결과를 초래한다. 전반적으로, DeepSeekMoE는 GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">\times 1.5</annotation></semantics></math>와 비교 가능한 성능을 달성하며, DeepSeekMoE 아키텍처에 내재된 상당한 이점을 강조한다. 또한, GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1"><times id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m2.1c">\times 1.5</annotation></semantics></math>와의 비교 외에, Appendix<a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>에서의 GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS3.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1"><times id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.3.m3.1c">\times 1.2</annotation></semantics></math>와의 비교도 나타낸다.</p>
</div>
<div id="S4.SS3.SSS0.Px1.p2" class="ltx_para">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p2.3">또한, DeepSeekMoE의 총 파라미터 수를 13.3B로 증가시키고, GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p2.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.1.m1.1c">\times 1.2</annotation></semantics></math> 및 GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS3.SSS0.Px1.p2.2.m2.1a"><mrow id="S4.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1"><times id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.2.m2.1c">\times 1.5</annotation></semantics></math>와 각각 15.9B 및 19.8B의 총 파라미터 수를 비교한다. 우리는 더 큰 규모에서 DeepSeekMoE가 GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS3.SSS0.Px1.p2.3.m3.1a"><mrow id="S4.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.3.m3.1b"><apply id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1"><times id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.3.m3.1c">\times 1.5</annotation></semantics></math>를 뚜렷하게 능가할 수 있음을 발견했다. 이러한 결과는 부록 <a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>에서도 제공된다.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Comparison with Dense<math id="S4.SS3.SSS0.Px2.1.m1.1" class="ltx_Math" alttext="\times 16" display="inline"><semantics id="S4.SS3.SSS0.Px2.1.m1.1b"><mrow id="S4.SS3.SSS0.Px2.1.m1.1.1" xref="S4.SS3.SSS0.Px2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px2.1.m1.1.1.1" xref="S4.SS3.SSS0.Px2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px2.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.1.m1.1c"><apply id="S4.SS3.SSS0.Px2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1"><times id="S4.SS3.SSS0.Px2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S4.SS3.SSS0.Px2.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.1.m1.1d">\times 16</annotation></semantics></math>.</h5>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.2">표 <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ Results. ‣ 4.2 Evaluations ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>는 DeepSeekMoE와 더 큰 밀집 모델의 비교도 보여준다. 공정한 비교를 위해 주의력과 FFN 매개변수 간의 널리 사용되는 비율(1:2)을 사용하지 않는다. 대신, 각 전문가가 표준 FFN과 동일한 수의 파라미터를 갖는 16개의 공유 전문가를 구성한다. 이 아키텍처는 16배 표준 FFN 매개변수를 가진 밀집 모델을 모방한다. 표로부터 DeepSeekMoE는 모델 용량 측면에서 MoE 모델의 엄격한 상한을 설정하는 Dense<math alttext="\times 16" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1"><times id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">\times 16</annotation></semantics></math>의 성능에 거의 근접함을 알 수 있다. 이러한 결과는 <span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS3.SSS0.Px2.p1.2.1"> 적어도 약 2B 매개 변수 및 100B 훈련 토큰의 규모에서 DeepSeekMoE의 성능이 MoE 모델의 이론적 상한</span>과 밀접하게 일치함을 시사한다. 또한, 부록 <a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>에서 Dense<math alttext="\times 4" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px2.p1.2.m2.1a"><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1"><times id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m2.1c">\times 4</annotation></semantics></math>와 추가적인 비교를 제공한다.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="211" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 3:</span></figcaption>
Ablation studies for DeepSeekMoE.
The performance is normalized by the best performance for clarity in presentation.
All compared models have the same number of parameters and activated parameters.
We can find that fine-grained expert segmentation and shared expert isolation both contribute to stronger overall performance.
</figcaption>
</figure>
</section>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation Studies</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS4.p1.1">세분화된 전문가 분할 및 공유 전문가 분리 전략의 효과를 입증하기 위해 DeepSeekMoE에 대한 절제 연구를 수행하고 그 결과를 그림 <a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ Comparison with Dense×16. ‣ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>에 제시한다. 공정한 비교를 위해 비교에 포함된 모든 모델이 동일한 수의 총 매개변수와 활성화된 매개변수를 갖도록 한다.</p>
</div>
<section id="S4.SS4.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Shared Expert Isolation.</h5>

<div id="S4.SS4.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS4.SSS0.Px1.p1.1">공유 전문가 분리 전략의 영향을 평가하기 위해 GShard를 기반으로 한 전문가를 공유 전문가로 분리한다. 그림 <a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ Comparison with Dense×16. ‣ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>에서 우리는 GShard와 비교하여 공유 전문가의 의도적 격리가 대부분의 벤치마크에서 향상된 성능을 산출한다는 것을 관찰한다. 이러한 결과는 공유 전문가 격리 전략이 더 강력한 모델 성능에 기여한다는 명제를 뒷받침한다.</p>
</div>
</section>
<section id="S4.SS4.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Fine-Grained Expert Segmentation.</h5>

<div id="S4.SS4.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS4.SSS0.Px2.p1.1">세립화된 전문가 세분화 전략의 효과를 평가하기 위해 전문가를 더 세립화된 그레인으로 세분화하여 보다 상세한 비교를 수행한다. 구체적으로, 우리는 각 전문가를 2명 또는 4명의 작은 전문가로 세분화하여 총 32명(1개의 공유 + 31개의 라우팅) 또는 64명(1개의 공유 + 63개의 라우팅)의 전문가를 생성한다. 그림 <a class="ltx_ref" href="#S4.F3" title="Figure 3 ‣ Comparison with Dense×16. ‣ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>는 전문가 세분화 세분화의 연속적 개선이 전체 모델 성능의 연속적 향상에 해당한다는 일관된 경향을 보여준다. 이러한 결과는 세분화된 전문가 세분화 전략의 효과성에 대한 실증적 검증을 제공한다.</p>
</div>
</section>
<section id="S4.SS4.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Ratios Between Shared and Routed Experts.</h5>

<div id="S4.SS4.SSS0.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS4.SSS0.Px3.p1.1">또한, 공유 전문가와 라우팅된 전문가의 최적 비율을 조사한다. 총 64명의 전문가와 활성화된 전문가의 수를 일정하게 유지하면서 최고의 세분성을 바탕으로 1, 2, 4명의 전문가를 공유 전문가로 분리하고자 한다. 연구 결과, 공유전문가와 라우팅된 전문가의 비율이 서로 다른 경우 성능에 큰 영향을 미치지 않는 것으로 나타났으며, 1, 2, 4명의 공유전문가는 각각 1.808, 1.806, 1.811의 파일손실을 달성하였다. 1:3의 비율이 약간 더 나은 파일 손실을 산출한다는 점을 고려하여 DeepSeekMoE를 확장할 때 공유 전문가와 활성화된 라우팅 전문가 간의 비율을 1:3으로 유지한다.</p>
</div>
</section>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Analysis on Expert Specialization</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS5.p1.1">본 절에서는 DeepSeekMoE 2B의 전문가 전문화에 대한 실증분석을 실시한다. 이 섹션의 DeepSeekMoE 2B는 표 <a class="ltx_ref" href="#S4.T1" title="Table 1 ‣ Closed-Book Question Answering. ‣ 4.1.4 Evaluation Benchmarks ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>에 보고된 모델, 즉 2.0B 총 매개변수를 포함하며 공유 전문가 1명과 라우팅된 전문가 63명 중 7명이 활성화된다.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="276" height="197" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 4:</span></figcaption>
Pile loss with regard to different ratios of disabled top routed experts.
Notably, DeepSeekMoE exhibits greater sensitivity to the ratio of disabled top routed experts, indicating lower redundancy among routed experts in DeepSeekMoE.
</figcaption>
</figure>
<section id="S4.SS5.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">DeepSeekMoE Exhibits Lower Redundancy Among Routed Experts.</h5>

<div id="S4.SS5.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p1.3">라우팅된 전문가들 간의 중복성을 평가하기 위해, 상위 라우팅된 전문가들의 다양한 비율을 비활성화하고 파일 손실을 평가한다. 구체적으로 각 토큰에 대해 라우팅 확률이 가장 높은 특정 비율의 전문가를 마스킹한 후 나머지 라우팅된 전문가 중에서 상위 K명의 전문가를 선택한다. 공정성을 위해 전문가가 비활성화되지 않은 경우 동일한 파일 손실을 갖기 때문에 DeepSeekMoE와 GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS5.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS5.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1"><times id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.1.m1.1c">\times 1.5</annotation></semantics></math>를 비교한다. <a class="ltx_ref" href="#S4.F4" title="Figure 4 ‣ 4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>에 도시된 바와 같이, GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS5.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS5.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1"><times id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.2.m2.1c">\times 1.5</annotation></semantics></math>와 비교하여 DeepSeekMoE는 상위 라우팅된 전문가의 디스에이블에 더 민감하다. 이 민감도는 각 라우팅된 전문가가 더 대체할 수 없기 때문에 DeepSeekMoE에서 더 낮은 수준의 매개변수 중복성을 시사한다. 대조적으로, GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS5.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS5.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml"></mi><mo id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1"><times id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1"></times><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2">absent</csymbol><cn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.3.m3.1c">\times 1.5</annotation></semantics></math>는 그 전문가 파라미터들 중에서 더 큰 중복성을 나타내므로, 상위 라우팅된 전문가들이 디스에이블될 때 성능 저하를 버퍼링할 수 있다.</p>
</div>
</section>
<section id="S4.SS5.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Shared Experts Are Irreplaceable by Routed Experts.</h5>

<div id="S4.SS5.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS5.SSS0.Px2.p1.1">DeepSeekMoE에서 공유 전문가의 역할을 조사하기 위해 이를 비활성화하고 라우팅된 전문가 한 명을 더 활성화한다. Pile에 대한 평가는 동일한 계산 비용을 유지함에도 불구하고 파일 손실이 1.808에서 2.414로 크게 증가하는 것으로 나타났다. 이 결과는 공유 전문가의 중요한 기능을 강조하며 공유 전문가가 라우팅된 전문가와 공유되지 않은 기본적이고 필수적인 지식을 포착하여 라우팅된 전문가로 대체할 수 없음을 나타낸다.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="276" height="197" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 5:</span></figcaption>
Pile loss with regard to different numbers of activated routed experts in DeepSeekMoE.
With only 4 routed experts activated, DeepSeekMoE achieves a Pile loss comparable with GShard.
</figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="211" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 6:</span></figcaption>
Comparison between GShard and DeepSeekMoE with half the activated experts (trained from scratch).
With the same total expert parameters and only half of the activated expert parameters, DeepSeekMoE still outperforms GShard.
</figcaption>
</figure>
</section>
<section id="S4.SS5.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">DeepSeekMoE Acquires Knowledge More Accurately.</h5>

<div id="S4.SS5.SSS0.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS5.SSS0.Px3.p1.1">활성화된 전문가 결합의 유연성이 높을수록 더 정확하고 표적화된 지식 획득에 기여한다는 주장을 검증하기 위해 DeepSeekMoE가 더 적은 수의 활성화된 전문가로 필요한 지식을 획득할 수 있는지 여부를 조사한다. 구체적으로, 우리는 활성화된 라우팅 전문가의 수를 3명에서 7명으로 변경하고 결과적인 파일 손실을 평가한다. <a class="ltx_ref" href="#S4.F5" title="Figure 5 ‣ Shared Experts Are Irreplaceable by Routed Experts. ‣ 4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>에서 증명된 바와 같이, 단지 4명의 라우팅된 전문가들만이 활성화된 상태에서도, DeepSeekMoE는 GShard에 필적하는 파일 손실을 달성한다. 이러한 관찰은 DeepSeekMoE가 보다 정확하고 효율적으로 필요한 지식을 획득할 수 있다는 명제를 뒷받침한다.</p>
</div>
<div id="S4.SS5.SSS0.Px3.p2" class="ltx_para">
<p class="ltx_p" id="S4.SS5.SSS0.Px3.p2.1">이러한 결과를 통해 DeepSeekMoE의 전문가 전문화와 정확한 지식 습득을 보다 엄격하게 검증하기 위해 새로운 모델을 처음부터 훈련한다. 이 모델은 공유 전문가 1명과 라우팅 전문가 63명으로 구성되며, 라우팅 전문가 3명만 활성화된다. <a class="ltx_ref" href="#S4.F6" title="Figure 6 ‣ Shared Experts Are Irreplaceable by Routed Experts. ‣ 4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>에 나타낸 평가 결과는, 동일한 총 전문가 파라미터와 활성화된 전문가 파라미터의 절반만을 가지고도 DeepSeekMoE가 여전히 GShard보다 우수하다는 것을 입증한다. 이는 DeepSeekMoE가 전문가 매개변수를 보다 효율적으로 활용하는 능력, 즉 활성화된 전문가에서 효과적인 매개변수의 비율이 GShard보다 훨씬 높다는 것을 강조한다.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Scaling up to DeepSeekMoE 16B</h2>

<div id="S5.p1" class="ltx_para">
<p class="ltx_p" id="S5.p1.1">DeepSeekMoE 아키텍처를 사용하여 MoE 모델을 16B 총 매개변수로 더 큰 규모로 확장하고 2T 토큰에서 훈련합니다. 실험 결과, DeepSeekMoE 16B는 LLaMA2 7B와 비교하여 약 40%의 계산량으로 우수한 성능을 보였다.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Training Data and Tokenization</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">우리는 Section <a class="ltx_ref" href="#S4.SS1.SSS1" title="4.1.1 Training Data and Tokenization ‣ 4.1 Experimental Setup ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4.1.1</span></a>에서 설명한 것과 동일한 말뭉치로부터 학습 데이터를 샘플링한다. 검증 실험과 달리 LLaMA2 7B의 훈련 토큰 수와 정렬하여 2T 토큰으로 더 많은 양의 데이터를 샘플링한다. 또한 HuggingFace 토큰나이저 도구를 사용하여 BPE 토큰나이저를 훈련시키지만, DeepSeekMoE 16B의 경우 어휘 크기가 100K로 설정된다.</p>
</div>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Hyper-Parameters</h4>

<section id="S5.SS1.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Model Settings.</h5>

<div id="S5.SS1.SSS2.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS2.Px1.p1.1">DeepSeekMoE 16B의 경우 트랜스포머 층의 수를 28개로, 은닉 차원을 2048개로 설정하였다. 총 16개의 어텐션 헤드가 있는 다중 헤드 어텐션 메커니즘을 사용하였으며, 각 헤드의 차원은 128이다. 초기화는 학습 가능한 모든 파라미터가 0.006의 표준 편차로 랜덤하게 초기화된다. 첫 번째 레이어에서 부하 균형 상태가 특히 더 느리게 수렴하는 것을 관찰하기 때문에 첫 번째 레이어를 제외한 모든 FFN을 MoE 레이어로 대체한다. 각 MoE 계층은 공유 전문가 2명과 라우팅 전문가 64명으로 구성되며, 각 전문가는 표준 FFN의 0.25배 크기이다. 각 토큰은 이 두 명의 공유 전문가와 64명의 라우팅된 전문가 중 6명에게 라우팅됩니다. 너무 작은 전문가 크기와 관련된 계산 효율의 잠재적인 감소로 인해 더 미세한 전문가 세분화 세분화는 사용되지 않는다. 16B에 걸쳐 더 큰 스케일에서, 더 미세한 입도가 여전히 채용될 수 있다. 우리의 구성에서 DeepSeekMoE 16B는 약 16.4B의 총 매개변수를 가지고 있으며 활성화된 매개변수의 수는 약 2.8B이다.</p>
</div>
</section>
<section id="S5.SS1.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Settings.</h5>

<div id="S5.SS1.SSS2.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS2.Px2.p1.4">Hyper-parameters가 <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.1.m1.1"><semantics id="S5.SS1.SSS2.Px2.p1.1.m1.1a"><mrow id="S5.SS1.SSS2.Px2.p1.1.m1.1.1" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.cmml"><msub id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.cmml"><mi id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2.cmml">β</mi><mn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.1.m1.1b"><apply id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1"><eq id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1"></eq><apply id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.1.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2">𝛽</ci><cn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.1.m1.1c">\beta_{1}=0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.95" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.2.m2.1"><semantics id="S5.SS1.SSS2.Px2.p1.2.m2.1a"><mrow id="S5.SS1.SSS2.Px2.p1.2.m2.1.1" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.cmml"><msub id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.cmml"><mi id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2.cmml">β</mi><mn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.2.m2.1b"><apply id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1"><eq id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1"></eq><apply id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.1.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2">𝛽</ci><cn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.2.m2.1c">\beta_{2}=0.95</annotation></semantics></math>, <math alttext="\mathrm{weight\_decay}=0.1" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.3.m3.1"><semantics id="S5.SS1.SSS2.Px2.p1.3.m3.1a"><mrow id="S5.SS1.SSS2.Px2.p1.3.m3.1.1" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.cmml"><mrow id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.cmml"><mi id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2.cmml">weight</mi><mo id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1" lspace="0em" rspace="0em" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1.cmml">​</mo><mi id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1a" lspace="0em" rspace="0em" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1.cmml">​</mo><mi id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4.cmml">decay</mi></mrow><mo id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.3.m3.1b"><apply id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1"><eq id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1"></eq><apply id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2"><times id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1"></times><ci id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2">weight</ci><ci id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3">_</ci><ci id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4">decay</ci></apply><cn id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.3.m3.1c">\mathrm{weight\_decay}=0.1</annotation></semantics></math>로 설정된 AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite>를 채용한다. 학습률 또한 준비-단계-붕괴 전략을 사용하여 스케줄링된다. 처음에, 학습률은 처음 2K 단계 동안 0에서 최대값까지 선형적으로 증가한다. 이어서, 학습 속도는 훈련 단계의 80%에서 0.316을 곱하고, 다시 훈련 단계의 90%에서 0.316을 곱한다. DeepSeekMoE 16B에 대한 최대 학습 속도는 <math alttext="4.2\times 10^{-4}" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.4.m4.1"><semantics id="S5.SS1.SSS2.Px2.p1.4.m4.1a"><mrow id="S5.SS1.SSS2.Px2.p1.4.m4.1.1" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.cmml"><mn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2.cmml">4.2</mn><mo id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1.cmml">×</mo><msup id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.cmml"><mn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.cmml"><mo id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3a" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.4.m4.1b"><apply id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1"><times id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1"></times><cn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2">4.2</cn><apply id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3">superscript</csymbol><cn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2">10</cn><apply id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3"><minus id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3"></minus><cn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.4.m4.1c">4.2\times 10^{-4}</annotation></semantics></math>로 설정되고, 그래디언트 클리핑 규범은 1.0으로 설정된다. 배치 크기는 4.5K로 설정되고, 최대 시퀀스 길이가 4K인 경우, 각각의 트레이닝 배치에는 18M 토큰이 포함된다. 상응하게, 트레이닝 단계들의 총 수는 2T 트레이닝 토큰들을 달성하기 위해 106,449로 설정된다. 훈련 데이터가 풍부하기 때문에 훈련 중 중도 탈락은 사용하지 않습니다. 파이프라인 병렬성을 활용하여 모델의 다른 계층을 다른 장치에 배치합니다. 각 계층에 대해 모든 전문가가 동일한 장치에 배치됩니다. 따라서 우리는 또한 훈련 중에 토큰을 떨어뜨리지 않으며 장치 수준 잔액 손실을 사용하지 않습니다. 라우팅 붕괴를 방지하기 위해 0.001의 상당히 작은 전문가 수준의 균형 계수를 설정했는데, 이는 병렬화 전략 하에서 전문가 수준의 균형 계수가 높을수록 계산 효율이 증가할 수 없지만 모델 성능이 손상된다는 것을 발견했기 때문이다.</p>
</div>
</section>
</section>
<section id="S5.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>Evaluation Benchmarks</h4>

<div id="S5.SS1.SSS3.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1">검증 실험에 사용된 벤치마크 외에도 보다 포괄적인 평가를 위해 추가 벤치마크를 통합한다. 검증 실험에 사용된 벤치마크와의 차이점을 다음과 같이 소개한다.</p>
</div>
<section id="S5.SS1.SSS3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Language Modeling.</h5>

<div id="S5.SS1.SSS3.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px1.p1.1">언어 모델링을 위해 Pile<cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="#bib.bib17" title="">2020</a>)</cite>의 테스트 세트에 대한 모델도 평가한다. DeepSeekMoE 16B에서 사용되는 토큰화기는 LLaMA2 7B에서 사용되는 토큰화기와 다르기 때문이다. 공정한 비교를 위해 우리는 평가 메트릭으로 바이트당 비트(BPB)를 사용한다.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reading Comprehension.</h5>

<div id="S5.SS1.SSS3.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px2.p1.1">독해력을 위해 DROP <cite class="ltx_cite ltx_citemacro_citep">(Dua et al., <a class="ltx_ref" href="#bib.bib15" title="">2019</a>)</cite>를 추가적으로 고려한다. 평가 메트릭은 정확 일치율입니다.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Math Reasoning.</h5>

<div id="S5.SS1.SSS3.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px3.p1.1">수학 추론을 위해 EM을 평가 메트릭으로 사용하여 GSM8K <cite class="ltx_cite ltx_citemacro_citep">(Cobbe et al., <a class="ltx_ref" href="#bib.bib10" title="">2021</a>)</cite>와 MATH <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et al., <a class="ltx_ref" href="#bib.bib21" title="">2021</a>)</cite>를 추가로 통합한다.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Multi-Subject Multiple-Choice.</h5>

<div id="S5.SS1.SSS3.Px4.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px4.p1.1">다주제 객관식의 경우 MMLU <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et al., <a class="ltx_ref" href="#bib.bib20" title="">2020</a>)</cite>에 대한 모델을 추가로 평가한다. 평가 메트릭은 정확성입니다.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Disambiguation.</h5>

<div id="S5.SS1.SSS3.Px5.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px5.p1.1">중복성 해소를 위해 WinoGrande<cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi et al., <a class="ltx_ref" href="#bib.bib43" title="">2019</a>)</cite>를 추가적으로 고려하며, 평가 메트릭은 정확도이다.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px6" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Chinese Benchmarks.</h5>

<div id="S5.SS1.SSS3.Px6.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px6.p1.1">DeepSeekMoE 16B는 이중 언어 코퍼스에서 사전 훈련되기 때문에, 우리는 또한 4개의 중국 벤치마크에서 그것을 평가한다. CLUEWSC<cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="#bib.bib57" title="">2020</a>)</cite>는 중국어 중의성 해소 벤치마크이다. CEval <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a class="ltx_ref" href="#bib.bib25" title="">2023</a>)</cite>와 CMMLU <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="#bib.bib33" title="">2023</a>)</cite>는 MMLU와 비슷한 형태를 가진 두 개의 중국어 객관식 벤치마크이다. CHID <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="#bib.bib61" title="">2019</a>)</cite>는 중국문화에 대한 이해를 평가하기 위한 중국어 관용어 완성 벤치마크이다. 앞서 언급한 중국 벤치마크에 대한 평가 지표는 정확성 또는 EM이다.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px7" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Open LLM Leaderboard.</h5>

<div id="S5.SS1.SSS3.Px7.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px7.p1.1">우리는 내부 평가 프레임워크를 기반으로 앞서 언급한 모든 벤치마크를 평가한다. DeepSeekMoE 16B를 오픈소스 모델과 공정하고 편리하게 비교하기 위해 Open LLM 리더보드 상에서 DeepSeekMoE 16B를 추가적으로 평가한다. Open LLM Leaderboard는 HuggingFace에서 지원하는 공개 리더보드로서, ARC <cite class="ltx_cite ltx_citemacro_citep">(Clark et al., <a class="ltx_ref" href="#bib.bib9" title="">2018</a>)</cite>, HellaSwag <cite class="ltx_cite ltx_citemacro_citep">(Zellers et al., <a class="ltx_ref" href="#bib.bib59" title="">2019</a>)</cite>, MMLU <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et al., <a class="ltx_ref" href="#bib.bib20" title="">2020</a>)</cite>, TruthfulQA <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="#bib.bib35" title="">2022</a>)</cite>, Winogrande <cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi et al., <a class="ltx_ref" href="#bib.bib43" title="">2019</a>)</cite>, GSM8K <cite class="ltx_cite ltx_citemacro_citep">(Cobbe et al., <a class="ltx_ref" href="#bib.bib10" title="">2021</a>)</cite>의 6개의 태스크로 구성된다.</p>
</div>
</section>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Evaluations</h3>

<figure id="S5.T3" class="ltx_table">
<table id="S5.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.1.1.2.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.1.1.3.1" class="ltx_text ltx_font_bold">DeepSeek 7B (Dense)</span></td>
<td id="S5.T3.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.1.1.4.1" class="ltx_text ltx_font_bold">DeepSeekMoE 16B</span></td>
</tr>
<tr id="S5.T3.1.2.2" class="ltx_tr">
<th id="S5.T3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"># Total Params</th>
<th id="S5.T3.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">6.9B</td>
<td id="S5.T3.1.2.2.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">16.4B</td>
</tr>
<tr id="S5.T3.1.3.3" class="ltx_tr">
<th id="S5.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;"># Activated Params</th>
<th id="S5.T3.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">6.9B</td>
<td id="S5.T3.1.3.3.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2.8B</td>
</tr>
<tr id="S5.T3.1.4.4" class="ltx_tr">
<th id="S5.T3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">FLOPs per 4K Tokens</th>
<th id="S5.T3.1.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">183.5T</td>
<td id="S5.T3.1.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">74.4T</td>
</tr>
<tr id="S5.T3.1.5.5" class="ltx_tr">
<th id="S5.T3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;"># Training Tokens</th>
<th id="S5.T3.1.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
<td id="S5.T3.1.5.5.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
</tr>
<tr id="S5.T3.1.6.6" class="ltx_tr">
<th id="S5.T3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Pile&nbsp;(BPB)</th>
<th id="S5.T3.1.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.75</td>
<td id="S5.T3.1.6.6.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.6.6.4.1" class="ltx_text ltx_font_bold">0.74</span></td>
</tr>
<tr id="S5.T3.1.7.7" class="ltx_tr">
<th id="S5.T3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S5.T3.1.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">75.4</td>
<td id="S5.T3.1.7.7.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.7.7.4.1" class="ltx_text ltx_font_bold">77.1</span></td>
</tr>
<tr id="S5.T3.1.8.8" class="ltx_tr">
<th id="S5.T3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S5.T3.1.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">79.2</td>
<td id="S5.T3.1.8.8.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.8.8.4.1" class="ltx_text ltx_font_bold">80.2</span></td>
</tr>
<tr id="S5.T3.1.9.9" class="ltx_tr">
<th id="S5.T3.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S5.T3.1.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.9.9.3.1" class="ltx_text ltx_font_bold">67.9</span></td>
<td id="S5.T3.1.9.9.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.9.9.4.1" class="ltx_text ltx_font_bold">68.1</span></td>
</tr>
<tr id="S5.T3.1.10.10" class="ltx_tr">
<th id="S5.T3.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S5.T3.1.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.10.10.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">48.1</td>
<td id="S5.T3.1.10.10.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.10.10.4.1" class="ltx_text ltx_font_bold">49.8</span></td>
</tr>
<tr id="S5.T3.1.11.11" class="ltx_tr">
<th id="S5.T3.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S5.T3.1.11.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.11.11.3.1" class="ltx_text ltx_font_bold">63.2</span></td>
<td id="S5.T3.1.11.11.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">61.9</td>
</tr>
<tr id="S5.T3.1.12.12" class="ltx_tr">
<th id="S5.T3.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S5.T3.1.12.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.12.12.3.1" class="ltx_text ltx_font_bold">46.5</span></td>
<td id="S5.T3.1.12.12.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.12.12.4.1" class="ltx_text ltx_font_bold">46.4</span></td>
</tr>
<tr id="S5.T3.1.13.13" class="ltx_tr">
<th id="S5.T3.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">DROP&nbsp;(EM)</th>
<th id="S5.T3.1.13.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">1-shot</th>
<td id="S5.T3.1.13.13.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.13.13.3.1" class="ltx_text ltx_font_bold">34.9</span></td>
<td id="S5.T3.1.13.13.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">32.9</td>
</tr>
<tr id="S5.T3.1.14.14" class="ltx_tr">
<th id="S5.T3.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">GSM8K&nbsp;(EM)</th>
<th id="S5.T3.1.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">8-shot</th>
<td id="S5.T3.1.14.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">17.4</td>
<td id="S5.T3.1.14.14.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.14.14.4.1" class="ltx_text ltx_font_bold">18.8</span></td>
</tr>
<tr id="S5.T3.1.15.15" class="ltx_tr">
<th id="S5.T3.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">MATH&nbsp;(EM)</th>
<th id="S5.T3.1.15.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">4-shot</th>
<td id="S5.T3.1.15.15.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">3.3</td>
<td id="S5.T3.1.15.15.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.15.15.4.1" class="ltx_text ltx_font_bold">4.3</span></td>
</tr>
<tr id="S5.T3.1.16.16" class="ltx_tr">
<th id="S5.T3.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S5.T3.1.16.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.16.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">26.2</td>
<td id="S5.T3.1.16.16.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.16.16.4.1" class="ltx_text ltx_font_bold">26.8</span></td>
</tr>
<tr id="S5.T3.1.17.17" class="ltx_tr">
<th id="S5.T3.1.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S5.T3.1.17.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">3-shot</th>
<td id="S5.T3.1.17.17.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.17.17.3.1" class="ltx_text ltx_font_bold">39.0</span></td>
<td id="S5.T3.1.17.17.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.17.17.4.1" class="ltx_text ltx_font_bold">39.2</span></td>
</tr>
<tr id="S5.T3.1.18.18" class="ltx_tr">
<th id="S5.T3.1.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S5.T3.1.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.18.18.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">59.7</td>
<td id="S5.T3.1.18.18.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.18.18.4.1" class="ltx_text ltx_font_bold">64.8</span></td>
</tr>
<tr id="S5.T3.1.19.19" class="ltx_tr">
<th id="S5.T3.1.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S5.T3.1.19.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.19.19.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">22.2</td>
<td id="S5.T3.1.19.19.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.19.19.4.1" class="ltx_text ltx_font_bold">25.5</span></td>
</tr>
<tr id="S5.T3.1.20.20" class="ltx_tr">
<th id="S5.T3.1.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">MMLU&nbsp;(Acc.)</th>
<th id="S5.T3.1.20.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.20.20.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.20.20.3.1" class="ltx_text ltx_font_bold">48.2</span></td>
<td id="S5.T3.1.20.20.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">45.0</td>
</tr>
<tr id="S5.T3.1.21.21" class="ltx_tr">
<th id="S5.T3.1.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th id="S5.T3.1.21.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.21.21.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.21.21.3.1" class="ltx_text ltx_font_bold">70.5</span></td>
<td id="S5.T3.1.21.21.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.21.21.4.1" class="ltx_text ltx_font_bold">70.2</span></td>
</tr>
<tr id="S5.T3.1.22.22" class="ltx_tr">
<th id="S5.T3.1.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">CLUEWSC&nbsp;(EM)</th>
<th id="S5.T3.1.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.22.22.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.22.22.3.1" class="ltx_text ltx_font_bold">73.1</span></td>
<td id="S5.T3.1.22.22.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">72.1</td>
</tr>
<tr id="S5.T3.1.23.23" class="ltx_tr">
<th id="S5.T3.1.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">CEval&nbsp;(Acc.)</th>
<th id="S5.T3.1.23.23.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.23.23.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.23.23.3.1" class="ltx_text ltx_font_bold">45.0</span></td>
<td id="S5.T3.1.23.23.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">40.6</td>
</tr>
<tr id="S5.T3.1.24.24" class="ltx_tr">
<th id="S5.T3.1.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">CMMLU&nbsp;(Acc.)</th>
<th id="S5.T3.1.24.24.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.24.24.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.24.24.3.1" class="ltx_text ltx_font_bold">47.2</span></td>
<td id="S5.T3.1.24.24.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">42.5</td>
</tr>
<tr id="S5.T3.1.25.25" class="ltx_tr">
<th id="S5.T3.1.25.25.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">CHID&nbsp;(Acc.)</th>
<th id="S5.T3.1.25.25.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.25.25.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.25.25.3.1" class="ltx_text ltx_font_bold">89.3</span></td>
<td id="S5.T3.1.25.25.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.25.25.4.1" class="ltx_text ltx_font_bold">89.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 3:</span></figcaption>
Comparison between DeepSeek 7B and DeepSeekMoE 16B.
<span id="S5.T3.3.1" class="ltx_text ltx_font_bold">Bold</span> font indicates the best or near the best.
With only 40.5% of computations, DeepSeekMoE 16B achieves comparable performance with DeepSeek 7B.
</figcaption>
</figure>
<section id="S5.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1 </span>Internal Comparison with DeepSeek 7B</h4>

<div id="S5.SS2.SSS1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS1.p1.1">먼저 DeepSeekMoE 16B와 DeepSeek 7B <cite class="ltx_cite ltx_citemacro_citep">(DeepSeek-AI, <a class="ltx_ref" href="#bib.bib13" title="">2024</a>)</cite>, 6.9B 파라미터를 갖는 조밀한 언어 모델을 내부적으로 비교한다. 공정성을 보장하기 위해 두 모델은 2T 토큰이 있는 동일한 코퍼스에서 훈련된다. 이를 통해 훈련 데이터의 영향과 무관하게 MoE 아키텍처의 유효성을 정확하게 평가할 수 있다.</p>
</div>
<div id="S5.SS2.SSS1.p2" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS1.p2.1">평가 결과는 표 <a class="ltx_ref" href="#S5.T3" title="Table 3 ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>에 제시되어 다음과 같은 관찰을 산출한다. (1) 전체적으로 계산의 약 40%만으로 DeepSeekMoE 16B는 DeepSeek 7B와 비교 가능한 성능을 달성한다. (2) DeepSeekMoE 16B는 Pile, HellaSwag, TriviaQA 및 NaturalQuestions와 같은 언어 모델링 및 지식 집약적 태스크에서 주목할 만한 강점을 나타낸다. MoE 모델에서 FFN 매개변수가 주의 매개변수보다 훨씬 무겁다는 점을 감안할 때 이러한 결과는 트랜스포머의 FFN이 지식 암기 능력을 나타낸다는 명제<cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a class="ltx_ref" href="#bib.bib11" title="">2022a</a>)</cite>와 일치한다. (3) 다른 태스크에 대한 우수한 성능과 비교하여, DeepSeekMoE는 객관식 태스크를 다루는데 한계를 나타낸다. 이러한 부적절함은 DeepSeekMoE 16B에서의 제한된 주의 파라미터로부터 기인한다(DeepSeekMoE 16B는 단지 약 0.5B 주의 파라미터를 갖는 반면, DeepSeek 7B는 2.5B 주의 파라미터를 갖는다). 딥씽 7B에 대한 우리의 초기 조사는 객관식 과제에 대한 주의력과 수행 사이의 양의 상관관계를 보여준다. 예를 들어, 다중 쿼리 주의 메커니즘 <cite class="ltx_cite ltx_citemacro_citep">(Shazeer, <a class="ltx_ref" href="#bib.bib46" title="">2019</a>)</cite>를 탑재한 DeepSeek 7B MQA도 MMLU와 같은 작업에서 고전했다. 또한, DeepSeekMoE 16B의 훈련 과정에 대한 보다 포괄적인 이해를 위해, 참조를 위해 부록 <a class="ltx_ref" href="#A3" title="Appendix C Training Benchmark Curves of DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">C</span></a>에서 훈련하는 동안 DeepSeekMoE 16B와 DeepSeek 7B(Dense)의 벤치마크 곡선도 함께 제공한다.</p>
</div>
<div id="S5.SS2.SSS1.p3" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS1.p3.1">비판적으로 DeepSeekMoE 16B의 적당한 수의 파라미터로 인해 40GB의 메모리를 가진 GPU에서 단일 장치 배포를 가능하게 한다. 적절한 연산자 최적화를 통해 7B 밀집 모델의 추론 속도의 거의 2.5배를 달성할 수 있다.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.1.1.1" class="ltx_tr">
<th id="S5.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.1.1.2.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="S5.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">LLaMA2 7B</span></td>
<td id="S5.T4.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.1.1.4.1" class="ltx_text ltx_font_bold">DeepSeekMoE 16B</span></td>
</tr>
<tr id="S5.T4.1.2.2" class="ltx_tr">
<th id="S5.T4.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"># Total Params</th>
<th id="S5.T4.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">6.7B</td>
<td id="S5.T4.1.2.2.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">16.4B</td>
</tr>
<tr id="S5.T4.1.3.3" class="ltx_tr">
<th id="S5.T4.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;"># Activated Params</th>
<th id="S5.T4.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">6.7B</td>
<td id="S5.T4.1.3.3.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2.8B</td>
</tr>
<tr id="S5.T4.1.4.4" class="ltx_tr">
<th id="S5.T4.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">FLOPs per 4K Tokens</th>
<th id="S5.T4.1.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">187.9T</td>
<td id="S5.T4.1.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">74.4T</td>
</tr>
<tr id="S5.T4.1.5.5" class="ltx_tr">
<th id="S5.T4.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;"># Training Tokens</th>
<th id="S5.T4.1.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
<td id="S5.T4.1.5.5.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
</tr>
<tr id="S5.T4.1.6.6" class="ltx_tr">
<th id="S5.T4.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Pile&nbsp;(BPB)</th>
<th id="S5.T4.1.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.76</td>
<td id="S5.T4.1.6.6.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.6.6.4.1" class="ltx_text ltx_font_bold">0.74</span></td>
</tr>
<tr id="S5.T4.1.7.7" class="ltx_tr">
<th id="S5.T4.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S5.T4.1.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">75.6</td>
<td id="S5.T4.1.7.7.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.7.7.4.1" class="ltx_text ltx_font_bold">77.1</span></td>
</tr>
<tr id="S5.T4.1.8.8" class="ltx_tr">
<th id="S5.T4.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S5.T4.1.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">78.0</td>
<td id="S5.T4.1.8.8.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.8.8.4.1" class="ltx_text ltx_font_bold">80.2</span></td>
</tr>
<tr id="S5.T4.1.9.9" class="ltx_tr">
<th id="S5.T4.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S5.T4.1.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.9.9.3.1" class="ltx_text ltx_font_bold">69.1</span></td>
<td id="S5.T4.1.9.9.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">68.1</td>
</tr>
<tr id="S5.T4.1.10.10" class="ltx_tr">
<th id="S5.T4.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S5.T4.1.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.10.10.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">49.0</td>
<td id="S5.T4.1.10.10.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.10.10.4.1" class="ltx_text ltx_font_bold">49.8</span></td>
</tr>
<tr id="S5.T4.1.11.11" class="ltx_tr">
<th id="S5.T4.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S5.T4.1.11.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">60.7</td>
<td id="S5.T4.1.11.11.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.11.11.4.1" class="ltx_text ltx_font_bold">61.9</span></td>
</tr>
<tr id="S5.T4.1.12.12" class="ltx_tr">
<th id="S5.T4.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S5.T4.1.12.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">45.8</td>
<td id="S5.T4.1.12.12.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.12.12.4.1" class="ltx_text ltx_font_bold">46.4</span></td>
</tr>
<tr id="S5.T4.1.13.13" class="ltx_tr">
<th id="S5.T4.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">DROP&nbsp;(EM)</th>
<th id="S5.T4.1.13.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">1-shot</th>
<td id="S5.T4.1.13.13.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.13.13.3.1" class="ltx_text ltx_font_bold">34.0</span></td>
<td id="S5.T4.1.13.13.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">32.9</td>
</tr>
<tr id="S5.T4.1.14.14" class="ltx_tr">
<th id="S5.T4.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">GSM8K&nbsp;(EM)</th>
<th id="S5.T4.1.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">8-shot</th>
<td id="S5.T4.1.14.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">15.5</td>
<td id="S5.T4.1.14.14.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.14.14.4.1" class="ltx_text ltx_font_bold">18.8</span></td>
</tr>
<tr id="S5.T4.1.15.15" class="ltx_tr">
<th id="S5.T4.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">MATH&nbsp;(EM)</th>
<th id="S5.T4.1.15.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">4-shot</th>
<td id="S5.T4.1.15.15.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2.6</td>
<td id="S5.T4.1.15.15.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.15.15.4.1" class="ltx_text ltx_font_bold">4.3</span></td>
</tr>
<tr id="S5.T4.1.16.16" class="ltx_tr">
<th id="S5.T4.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S5.T4.1.16.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.16.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">14.6</td>
<td id="S5.T4.1.16.16.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.16.16.4.1" class="ltx_text ltx_font_bold">26.8</span></td>
</tr>
<tr id="S5.T4.1.17.17" class="ltx_tr">
<th id="S5.T4.1.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S5.T4.1.17.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">3-shot</th>
<td id="S5.T4.1.17.17.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">21.8</td>
<td id="S5.T4.1.17.17.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.17.17.4.1" class="ltx_text ltx_font_bold">39.2</span></td>
</tr>
<tr id="S5.T4.1.18.18" class="ltx_tr">
<th id="S5.T4.1.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S5.T4.1.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.18.18.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">63.8</td>
<td id="S5.T4.1.18.18.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.18.18.4.1" class="ltx_text ltx_font_bold">64.8</span></td>
</tr>
<tr id="S5.T4.1.19.19" class="ltx_tr">
<th id="S5.T4.1.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S5.T4.1.19.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.19.19.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.19.19.3.1" class="ltx_text ltx_font_bold">25.5</span></td>
<td id="S5.T4.1.19.19.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.19.19.4.1" class="ltx_text ltx_font_bold">25.5</span></td>
</tr>
<tr id="S5.T4.1.20.20" class="ltx_tr">
<th id="S5.T4.1.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">MMLU&nbsp;(Acc.)</th>
<th id="S5.T4.1.20.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.20.20.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.20.20.3.1" class="ltx_text ltx_font_bold">45.8</span></td>
<td id="S5.T4.1.20.20.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">45.0</td>
</tr>
<tr id="S5.T4.1.21.21" class="ltx_tr">
<th id="S5.T4.1.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th id="S5.T4.1.21.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.21.21.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">69.6</td>
<td id="S5.T4.1.21.21.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.21.21.4.1" class="ltx_text ltx_font_bold">70.2</span></td>
</tr>
<tr id="S5.T4.1.22.22" class="ltx_tr">
<th id="S5.T4.1.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">CLUEWSC&nbsp;(EM)</th>
<th id="S5.T4.1.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.22.22.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">64.0</td>
<td id="S5.T4.1.22.22.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.22.22.4.1" class="ltx_text ltx_font_bold">72.1</span></td>
</tr>
<tr id="S5.T4.1.23.23" class="ltx_tr">
<th id="S5.T4.1.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">CEval&nbsp;(Acc.)</th>
<th id="S5.T4.1.23.23.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.23.23.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">33.9</td>
<td id="S5.T4.1.23.23.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.23.23.4.1" class="ltx_text ltx_font_bold">40.6</span></td>
</tr>
<tr id="S5.T4.1.24.24" class="ltx_tr">
<th id="S5.T4.1.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">CMMLU&nbsp;(Acc.)</th>
<th id="S5.T4.1.24.24.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.24.24.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">32.6</td>
<td id="S5.T4.1.24.24.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.24.24.4.1" class="ltx_text ltx_font_bold">42.5</span></td>
</tr>
<tr id="S5.T4.1.25.25" class="ltx_tr">
<th id="S5.T4.1.25.25.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">CHID&nbsp;(Acc.)</th>
<th id="S5.T4.1.25.25.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.25.25.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">37.9</td>
<td id="S5.T4.1.25.25.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.25.25.4.1" class="ltx_text ltx_font_bold">89.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 4:</span></figcaption>
Comparison between LLaMA2 7B and DeepSeekMoE 16B.
With only 39.6% of computations, DeepSeekMoE 16B outperforms LLaMA2 7B on the majority of benchmarks.
</figcaption>
</figure>
</section>
<section id="S5.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2 </span>Comparison with Open Source Models</h4>

<section id="S5.SS2.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Internal Comparison with LLaMA2 7B.</h5>

<div id="S5.SS2.SSS2.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS2.Px1.p1.1">오픈 소스 모델의 영역에서는 주로 DeepSeekMoE 16B와 6.7B 파라미터를 가진 잘 알려져 있고 강력한 오픈 소스 언어 모델인 LLaMA2 7B <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="#bib.bib54" title="">2023b</a>)</cite>를 비교한다. DeepSeekMoE 16B와 LLaMA2 7B는 모두 2T 토큰에 대해 사전 훈련된다. LLaMA2 7B와 비교하여 DeepSeekMoE는 전체 매개변수의 245%를 갖지만 계산의 39.6%만 필요하다. 내부 벤치마크에 대한 결과는 다음 관찰로 이어지는 표 <a class="ltx_ref" href="#S5.T4" title="Table 4 ‣ 5.2.1 Internal Comparison with DeepSeek 7B ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>에 나와 있다. (1) 평가된 벤치마크 중에서, 단지 약 40%의 계산으로, DeepSeekMoE 16B는 대부분의 벤치마크에서 LLaMA2 7B를 능가한다. (2) DeepSeekMoE 16B의 수학 추론 및 코드 생성 능력은 LLaMA2 7B보다 강하며, 이는 사전 훈련 말뭉치에 수학적 및 코드 관련 텍스트가 풍부하게 존재하기 때문이다. (3) 사전 훈련 코퍼스에 중국어 텍스트가 존재하는 경우, DeepSeekMoE 16B는 중국 벤치마크에서 LLaMA2 7B에 비해 상당한 성능 이점을 나타낸다. (4) 더 적은 수의 영어 텍스트들에 대해 트레이닝되었음에도 불구하고, DeepSeekMoE 16B는 영어 이해 또는 지식 집약적 벤치마크들에 대해 LLaMA2 7B와 비교되거나 더 나은 성능을 달성하며, 이는 DeepSeekMoE 16B의 탁월한 능력을 입증한다.</p>
</div>
</section>
<section id="S5.SS2.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Evaluation on Open LLM Leaderboard.</h5>

<div id="S5.SS2.SSS2.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS2.Px2.p1.1">내부 평가 외에도 오픈 LLM 리더보드에서 DeepSeekMoE 16B를 평가하고 다른 오픈 소스 모델과 비교한다. LLaMA2 7B 외에도 LLaMA 7B <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="#bib.bib53" title="">2023a</a>)</cite>, Falcon 7B <cite class="ltx_cite ltx_citemacro_citep">(Almazrouei et al., <a class="ltx_ref" href="#bib.bib1" title="">2023</a>)</cite>, GPT-J 6B <cite class="ltx_cite ltx_citemacro_citep">(Wang and Komatsuzaki, <a class="ltx_ref" href="#bib.bib56" title="">2021</a>)</cite>, RedPajama-INCITE 7B and 3B <cite class="ltx_cite ltx_citemacro_citep">(Together-AI, <a class="ltx_ref" href="#bib.bib52" title="">2023</a>)</cite>, Open LLaMA 7B and 3B <cite class="ltx_cite ltx_citemacro_citep">(Geng and Liu, <a class="ltx_ref" href="#bib.bib18" title="">2023</a>)</cite>, OPT 2.7B <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="#bib.bib60" title="">2022</a>)</cite>, Pythia 2.8B <cite class="ltx_cite ltx_citemacro_citep">(Biderman et al., <a class="ltx_ref" href="#bib.bib4" title="">2023</a>)</cite>, GPT-neo 2.7B <cite class="ltx_cite ltx_citemacro_citep">(Black et al., <a class="ltx_ref" href="#bib.bib6" title="">2021</a>)</cite>, BLOOM 3B <cite class="ltx_cite ltx_citemacro_citep">(Scao et al., <a class="ltx_ref" href="#bib.bib44" title="">2022</a>)</cite> 등의 오픈 소스 모델 집합을 고려한다. <a class="ltx_ref" href="#S0.F1" title="Figure 1 ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>에 제시된 평가 결과는 DeepSeekMoE 16B가 유사한 활성화된 파라미터를 가진 모델보다 큰 마진만큼 일관되게 우수함을 보여준다. 또한, 약 2.5배의 활성화된 파라미터를 갖는 LLaMA2 7B와 유사한 성능을 달성한다.</p>
</div>
</section>
</section>
</section>
</section>
<section id="S6" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Alignment for DeepSeekMoE 16B</h2>

<div id="S6.p1" class="ltx_para">
<p class="ltx_p" id="S6.p1.1">이전 연구에 따르면 MoE 모델은 일반적으로 미세 조정 <cite class="ltx_cite ltx_citemacro_citep">(Fedus et al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>; Artetxe et al., <a class="ltx_ref" href="#bib.bib2" title="">2022</a>)</cite>에서 유의미한 이득을 나타내지 않는다. 그러나 <cite class="ltx_cite ltx_citemacro_citet">Shen et al. (<a class="ltx_ref" href="#bib.bib48" title="">2023</a>)</cite>는 MoE 모델이 실제로 명령어 튜닝의 이점을 얻을 수 있음을 시사하는 결과를 제시한다. DeepSeekMoE 16B가 미세조정의 이점을 얻을 수 있는지 평가하기 위해 DeepSeekMoE 16B를 기반으로 채팅 모델을 구성하기 위해 감독 미세조정을 수행한다. 실험 결과는 DeepSeekMoE Chat 16B도 LLaMA2 SFT 7B 및 DeepSeek Chat 7B와 유사한 성능을 달성함을 보여준다.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Experimental Setup</h3>

<section id="S6.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Data.</h5>

<div id="S6.SS1.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS1.SSS0.Px1.p1.1">채팅 모델을 학습하기 위해 1.4M 훈련 사례로 구성된 자체 선별된 데이터에 대해 감독 미세 조정(supervised fine-tuning, SFT)을 수행한다. 이 데이터 세트는 수학, 코드, 쓰기, 질문 답변, 추론, 요약 등을 포함한 광범위한 범주에 걸쳐 있습니다. 우리의 SFT 훈련 데이터의 대부분은 영어와 중국어로 되어 있어 채팅 모델을 다재다능하고 이중 언어 시나리오에서 적용할 수 있다.</p>
</div>
</section>
<section id="S6.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Hyper-Parameters.</h5>

<div id="S6.SS1.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS1.SSS0.Px2.p1.1">감독 미세 조정 동안 배치 크기를 1024개의 예제로 설정하고 AdamW 최적화기 <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite>를 사용하여 8개의 에폭에 걸쳐 훈련을 수행한다. 우리는 4K의 최대 시퀀스 길이를 사용하고, 시퀀스 길이 한계에 도달할 때까지 훈련 예제를 최대한 조밀하게 패킹한다. 우리는 감독된 미세 조정을 위해 드롭아웃을 사용하지 않으며, 학습률 스케줄링 전략을 통합하지 않고 단순히 <math alttext="10^{-5}" class="ltx_Math" display="inline" id="S6.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S6.SS1.SSS0.Px2.p1.1.m1.1a"><msup id="S6.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">10</mn><mrow id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mo id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3a" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">−</mo><mn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><cn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" type="integer" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2">10</cn><apply id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3"><minus id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3"></minus><cn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS0.Px2.p1.1.m1.1c">10^{-5}</annotation></semantics></math>의 일정한 학습률을 설정한다.</p>
</div>
</section>
<section id="S6.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Evaluation Benchmarks.</h5>

<div id="S6.SS1.SSS0.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS1.SSS0.Px3.p1.1">채팅 모델의 평가를 위해 다음과 같은 조정으로 섹션 <a class="ltx_ref" href="#S5.SS1.SSS3" title="5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5.1.3</span></a>에서 사용된 것과 유사한 벤치마크를 사용한다. (1) 채팅 모델은 순수 언어 모델링에 거의 사용되지 않기 때문에 파일 <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="#bib.bib17" title="">2020</a>)</cite>를 제외한다. (2) 관찰된 결과의 불안정성으로 인해 CHID <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="#bib.bib61" title="">2019</a>)</cite>를 제외하여 견고한 결론 도출을 방해한다. (3) 채팅 모델들의 추론 능력에 대한 보다 포괄적인 평가를 제공하기 위해 BBH <cite class="ltx_cite ltx_citemacro_citep">(Suzgun et al., <a class="ltx_ref" href="#bib.bib50" title="">2022</a>)</cite>를 추가적으로 포함한다.</p>
</div>
<figure id="S6.T5" class="ltx_table">
<table id="S6.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T5.1.1.1" class="ltx_tr">
<th id="S6.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.1.1" class="ltx_text">
<span id="S6.T5.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></span></span>
</span></span></th>
<th id="S6.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.2.1" class="ltx_text">
<span id="S6.T5.1.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.2.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.2.1.1.1.1.1" class="ltx_text ltx_font_bold"># Shot</span></span></span>
</span></span></th>
<td id="S6.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.3.1" class="ltx_text">
<span id="S6.T5.1.1.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.3.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.3.1.1.1.1.1" class="ltx_text ltx_font_bold">LLaMA2</span></span></span>
<span id="S6.T5.1.1.1.3.1.1.2" class="ltx_tr">
<span id="S6.T5.1.1.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.3.1.1.2.1.1" class="ltx_text ltx_font_bold">SFT 7B</span></span></span>
</span></span></td>
<td id="S6.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.4.1" class="ltx_text">
<span id="S6.T5.1.1.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.4.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.4.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeek</span></span></span>
<span id="S6.T5.1.1.1.4.1.1.2" class="ltx_tr">
<span id="S6.T5.1.1.1.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.4.1.1.2.1.1" class="ltx_text ltx_font_bold">Chat 7B</span></span></span>
</span></span></td>
<td id="S6.T5.1.1.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.5.1" class="ltx_text">
<span id="S6.T5.1.1.1.5.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.5.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.5.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.5.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></span></span>
<span id="S6.T5.1.1.1.5.1.1.2" class="ltx_tr">
<span id="S6.T5.1.1.1.5.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.5.1.1.2.1.1" class="ltx_text ltx_font_bold">Chat 16B</span></span></span>
</span></span></td>
</tr>
<tr id="S6.T5.1.2.2" class="ltx_tr">
<th id="S6.T5.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"># Total Params</th>
<th id="S6.T5.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">N/A</th>
<td id="S6.T5.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">6.7B</td>
<td id="S6.T5.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">6.9B</td>
<td id="S6.T5.1.2.2.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">16.4B</td>
</tr>
<tr id="S6.T5.1.3.3" class="ltx_tr">
<th id="S6.T5.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;"># Activated Params</th>
<th id="S6.T5.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">N/A</th>
<td id="S6.T5.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">6.7B</td>
<td id="S6.T5.1.3.3.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">6.9B</td>
<td id="S6.T5.1.3.3.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">2.8B</td>
</tr>
<tr id="S6.T5.1.4.4" class="ltx_tr">
<th id="S6.T5.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">FLOPs per 4K Tokens</th>
<th id="S6.T5.1.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">N/A</th>
<td id="S6.T5.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">187.9T</td>
<td id="S6.T5.1.4.4.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">183.5T</td>
<td id="S6.T5.1.4.4.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">74.4T</td>
</tr>
<tr id="S6.T5.1.5.5" class="ltx_tr">
<th id="S6.T5.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S6.T5.1.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">67.9</td>
<td id="S6.T5.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">71.0</td>
<td id="S6.T5.1.5.5.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.5.5.5.1" class="ltx_text ltx_font_bold">72.2</span></td>
</tr>
<tr id="S6.T5.1.6.6" class="ltx_tr">
<th id="S6.T5.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S6.T5.1.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.6.6.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">76.9</td>
<td id="S6.T5.1.6.6.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">78.4</td>
<td id="S6.T5.1.6.6.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.6.6.5.1" class="ltx_text ltx_font_bold">79.7</span></td>
</tr>
<tr id="S6.T5.1.7.7" class="ltx_tr">
<th id="S6.T5.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S6.T5.1.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.7.7.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">69.7</td>
<td id="S6.T5.1.7.7.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.7.7.4.1" class="ltx_text ltx_font_bold">70.2</span></td>
<td id="S6.T5.1.7.7.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.7.7.5.1" class="ltx_text ltx_font_bold">69.9</span></td>
</tr>
<tr id="S6.T5.1.8.8" class="ltx_tr">
<th id="S6.T5.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S6.T5.1.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.8.8.3.1" class="ltx_text ltx_font_bold">50.8</span></td>
<td id="S6.T5.1.8.8.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">50.2</td>
<td id="S6.T5.1.8.8.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">50.0</td>
</tr>
<tr id="S6.T5.1.9.9" class="ltx_tr">
<th id="S6.T5.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">BBH&nbsp;(EM)</th>
<th id="S6.T5.1.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">3-shot</th>
<td id="S6.T5.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">39.3</td>
<td id="S6.T5.1.9.9.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.9.9.4.1" class="ltx_text ltx_font_bold">43.1</span></td>
<td id="S6.T5.1.9.9.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">42.2</td>
</tr>
<tr id="S6.T5.1.10.10" class="ltx_tr">
<th id="S6.T5.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S6.T5.1.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td id="S6.T5.1.10.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">63.9</td>
<td id="S6.T5.1.10.10.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.10.10.4.1" class="ltx_text ltx_font_bold">66.1</span></td>
<td id="S6.T5.1.10.10.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">64.8</td>
</tr>
<tr id="S6.T5.1.11.11" class="ltx_tr">
<th id="S6.T5.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S6.T5.1.11.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td id="S6.T5.1.11.11.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">49.6</td>
<td id="S6.T5.1.11.11.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.11.11.4.1" class="ltx_text ltx_font_bold">50.8</span></td>
<td id="S6.T5.1.11.11.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.11.11.5.1" class="ltx_text ltx_font_bold">50.6</span></td>
</tr>
<tr id="S6.T5.1.12.12" class="ltx_tr">
<th id="S6.T5.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">DROP&nbsp;(EM)</th>
<th id="S6.T5.1.12.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">1-shot</th>
<td id="S6.T5.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">40.0</td>
<td id="S6.T5.1.12.12.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.12.12.4.1" class="ltx_text ltx_font_bold">41.7</span></td>
<td id="S6.T5.1.12.12.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">33.8</td>
</tr>
<tr id="S6.T5.1.13.13" class="ltx_tr">
<th id="S6.T5.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">GSM8K&nbsp;(EM)</th>
<th id="S6.T5.1.13.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.13.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.13.13.3.1" class="ltx_text ltx_font_bold">63.4</span></td>
<td id="S6.T5.1.13.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">62.6</td>
<td id="S6.T5.1.13.13.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">62.2</td>
</tr>
<tr id="S6.T5.1.14.14" class="ltx_tr">
<th id="S6.T5.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">MATH&nbsp;(EM)</th>
<th id="S6.T5.1.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">4-shot</th>
<td id="S6.T5.1.14.14.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">13.5</td>
<td id="S6.T5.1.14.14.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">14.7</td>
<td id="S6.T5.1.14.14.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.14.14.5.1" class="ltx_text ltx_font_bold">15.2</span></td>
</tr>
<tr id="S6.T5.1.15.15" class="ltx_tr">
<th id="S6.T5.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S6.T5.1.15.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.15.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">35.4</td>
<td id="S6.T5.1.15.15.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">45.1</td>
<td id="S6.T5.1.15.15.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.15.15.5.1" class="ltx_text ltx_font_bold">45.7</span></td>
</tr>
<tr id="S6.T5.1.16.16" class="ltx_tr">
<th id="S6.T5.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S6.T5.1.16.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">3-shot</th>
<td id="S6.T5.1.16.16.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">27.8</td>
<td id="S6.T5.1.16.16.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">39.0</td>
<td id="S6.T5.1.16.16.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.16.16.5.1" class="ltx_text ltx_font_bold">46.2</span></td>
</tr>
<tr id="S6.T5.1.17.17" class="ltx_tr">
<th id="S6.T5.1.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S6.T5.1.17.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td id="S6.T5.1.17.17.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">60.1</td>
<td id="S6.T5.1.17.17.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">59.5</td>
<td id="S6.T5.1.17.17.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.17.17.5.1" class="ltx_text ltx_font_bold">63.3</span></td>
</tr>
<tr id="S6.T5.1.18.18" class="ltx_tr">
<th id="S6.T5.1.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S6.T5.1.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.18.18.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.18.18.3.1" class="ltx_text ltx_font_bold">35.2</span></td>
<td id="S6.T5.1.18.18.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">32.7</td>
<td id="S6.T5.1.18.18.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.18.18.5.1" class="ltx_text ltx_font_bold">35.1</span></td>
</tr>
<tr id="S6.T5.1.19.19" class="ltx_tr">
<th id="S6.T5.1.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">MMLU&nbsp;(Acc.)</th>
<th id="S6.T5.1.19.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.19.19.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.19.19.3.1" class="ltx_text ltx_font_bold">50.0</span></td>
<td id="S6.T5.1.19.19.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">49.7</td>
<td id="S6.T5.1.19.19.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">47.2</td>
</tr>
<tr id="S6.T5.1.20.20" class="ltx_tr">
<th id="S6.T5.1.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th id="S6.T5.1.20.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.20.20.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">65.1</td>
<td id="S6.T5.1.20.20.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">68.4</td>
<td id="S6.T5.1.20.20.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.20.20.5.1" class="ltx_text ltx_font_bold">69.0</span></td>
</tr>
<tr id="S6.T5.1.21.21" class="ltx_tr">
<th id="S6.T5.1.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">CLUEWSC&nbsp;(EM)</th>
<th id="S6.T5.1.21.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td id="S6.T5.1.21.21.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">48.4</td>
<td id="S6.T5.1.21.21.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">66.2</td>
<td id="S6.T5.1.21.21.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.21.21.5.1" class="ltx_text ltx_font_bold">68.2</span></td>
</tr>
<tr id="S6.T5.1.22.22" class="ltx_tr">
<th id="S6.T5.1.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">CEval&nbsp;(Acc.)</th>
<th id="S6.T5.1.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.22.22.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">35.1</td>
<td id="S6.T5.1.22.22.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.22.22.4.1" class="ltx_text ltx_font_bold">44.7</span></td>
<td id="S6.T5.1.22.22.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">40.0</td>
</tr>
<tr id="S6.T5.1.23.23" class="ltx_tr">
<th id="S6.T5.1.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">CMMLU&nbsp;(Acc.)</th>
<th id="S6.T5.1.23.23.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.23.23.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">36.9</td>
<td id="S6.T5.1.23.23.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.23.23.4.1" class="ltx_text ltx_font_bold">51.2</span></td>
<td id="S6.T5.1.23.23.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">49.3</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 5:</span></figcaption>
Comparison among LLaMA2 SFT 7B, DeepSeek Chat 7B and DeepSeekMoE Chat 16B, with all of these three models fine-tuned on the same SFT data.
Compared with both 7B dense models, DeepSeekMoE Chat 16B still achieves comparable or better performance on the majority of benchmarks with only 40% of computations.
</figcaption>
</figure>
</section>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Evaluations</h3>

<section id="S6.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5>

<div id="S6.SS2.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS2.SSS0.Px1.p1.1">정렬 후 DeepSeekMoE 16B의 잠재력을 검증하기 위해 LLaMA2 7B, DeepSeek 7B 및 DeepSeekMoE 16B에 대해 감독 미세 조정을 수행했으며, 공정성을 보장하기 위해 완전히 동일한 미세 조정 데이터를 활용한다. 이에 대응하여 LLaMA2 SFT 7B<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We use LLaMA2 SFT to distinguish from the official LLaMA2 Chat <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="#bib.bib54" title="">2023b</a>)</cite> model.</span></span></span>, DeepSeek Chat 7B, DeepSeekMoE Chat 16B 등 3개의 채팅 모델을 구축한다. 그 후, 우리는 DeepSeekMoE Chat 16B를 광범위한 다운스트림 태스크에 걸쳐 다른 두 개의 밀집 채팅 모델(FLOP의 약 2.5배)과 비교한다.</p>
</div>
</section>
<section id="S6.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5>

<div id="S6.SS2.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS2.SSS0.Px2.p1.1">평가 결과는 표 <a class="ltx_ref" href="#S6.T5" title="Table 5 ‣ Evaluation Benchmarks. ‣ 6.1 Experimental Setup ‣ 6 Alignment for DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>에 제시되어 있다. 우리의 주요 관찰은 다음과 같다: (1) DeepSeekMoE Chat 16B는 계산의 거의 40%를 소비하지만 언어 이해 및 추론(PIQA, ARC, BBH), 기계 독해(RACE), 수학적(GSM8K, MATH), 지식 집약적 작업(TriviaQA, NaturalQuestions)에 걸쳐 7B 밀집 모델과 비교 가능한 성능을 달성한다. (2) 코드 생성 작업에서 DeepSeekMoE Chat 16B는 LLaMA2 SFT 7B를 상당히 능가하여 HumanEval 및 MBPP에서 주목할만한 개선을 보여준다. 또한 딥씽 채팅 7B를 능가합니다. (3) MMLU, CEval 및 CMMLU를 포함하는 객관식 질의 응답 벤치마크에서, DeepSeekMoE Chat 16B는 여전히 기본 모델에 대한 관찰과 일치하는 DeepSeek Chat 7B에 뒤처진다(섹션<a class="ltx_ref" href="#S5.SS2.SSS1" title="5.2.1 Internal Comparison with DeepSeek 7B ‣ 5.2 Evaluations ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5.2.1</span></a>). 그러나 감독 미세 조정 후 DeepSeekMoE 16B와 DeepSeek 7B 사이의 성능 격차가 좁혀진다는 점에 주목할 필요가 있다. (4) 이중 언어 코퍼스에 대한 사전 훈련으로부터 이득을 얻은 DeepSeekMoE Chat 16B는 모든 중국 벤치마크에서 LLaMA2 SFT 7B를 현저하게 능가한다. 이러한 결과는 중국어와 영어 모두에서 DeepSeekMoE 16B의 균형 잡힌 기능을 보여주며 다양한 시나리오에서 다양성과 적용 가능성을 향상시킨다. 결론적으로 채팅 모델에 대한 평가는 정렬의 이점을 얻을 수 있는 DeepSeekMoE 16B의 잠재력을 강조하고 계산의 약 40%만 사용하면서 밀집 모델과 비교할 수 있는 성능을 달성하는 일관된 이점을 검증한다.</p>
</div>
</section>
</section>
</section>
<section id="S7" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>DeepSeekMoE 145B Ongoing</h2>

<div id="S7.p1" class="ltx_para">
<p class="ltx_p" id="S7.p1.1">DeepSeekMoE 16B의 뛰어난 성능에 고무되어 DeepSeekMoE를 145B로 확장하기 위한 예비 노력을 더 수행한다. 이 초기 연구에서 DeepSeekMoE 145B는 245B 토큰에 대해 훈련되지만 GShard 아키텍처에 비해 일관된 이점을 보여주었고 DeepSeek 67B(Dense)의 성능과 일치하거나 초과할 가능성을 보여주었다. 나아가 DeepSeekMoE 145B의 최종 버전과 전수 교육이 완료되면 공개도 할 계획이다.</p>
</div>
<section id="S7.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Experimental Setup</h3>

<section id="S7.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Data and Tokenization.</h5>

<div id="S7.SS1.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS1.SSS0.Px1.p1.1">DeepSeekMoE 145B의 경우 DeepSeekMoE 16B와 정확히 동일한 훈련 말뭉치 및 토큰화기를 사용하며, 유일한 차이점은 DeepSeekMoE 145B가 초기 연구를 위해 245B 토큰에 대해 훈련된다는 것이다.</p>
</div>
</section>
<section id="S7.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Model Settings.</h5>

<div id="S7.SS1.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS1.SSS0.Px2.p1.1">DeepSeekMoE 145B의 경우 트랜스포머 층의 수를 62개, 히든 차원을 4096개로 설정하였다. 총 32개의 어텐션 헤드를 갖는 다중 헤드 어텐션 메커니즘을 사용하며, 각 헤드의 차원은 128이다. 초기화는 모든 학습 가능한 파라미터가 0.006의 표준 편차로 랜덤하게 초기화된다. DeepSeekMoE 16B에서와 마찬가지로 첫 번째 레이어를 제외한 모든 FFN을 MoE 레이어로 대체한다. 각 MoE 레이어는 4명의 공유 전문가와 128명의 라우팅 전문가로 구성되며, 각 전문가는 표준 FFN의 0.125배 크기이다. 각 토큰은 이 4명의 공유 전문가와 128명의 라우팅된 전문가 중 12명에게 라우팅됩니다. 이러한 구성 하에서, DeepSeekMoE 145는 약 144.6B의 총 파라미터를 가지며, 활성화된 파라미터의 수는 약 22.2B이다.</p>
</div>
</section>
<section id="S7.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Settings.</h5>

<div id="S7.SS1.SSS0.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS1.SSS0.Px3.p1.4">Hyper-parameters가 <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S7.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S7.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><msub id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml"><mi id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2.cmml">β</mi><mn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1"><eq id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1"></eq><apply id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.1.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2">𝛽</ci><cn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.1.m1.1c">\beta_{1}=0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.95" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.2.m2.1"><semantics id="S7.SS1.SSS0.Px3.p1.2.m2.1a"><mrow id="S7.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.cmml"><msub id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml"><mi id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2.cmml">β</mi><mn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.2.m2.1b"><apply id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1"><eq id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1"></eq><apply id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.1.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2">subscript</csymbol><ci id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2">𝛽</ci><cn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.2.m2.1c">\beta_{2}=0.95</annotation></semantics></math>, <math alttext="\mathrm{weight\_decay}=0.1" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.3.m3.1"><semantics id="S7.SS1.SSS0.Px3.p1.3.m3.1a"><mrow id="S7.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.cmml"><mrow id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml"><mi id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2.cmml">weight</mi><mo id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1" lspace="0em" rspace="0em" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1.cmml">​</mo><mi id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1a" lspace="0em" rspace="0em" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1.cmml">​</mo><mi id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4.cmml">decay</mi></mrow><mo id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.3.m3.1b"><apply id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1"><eq id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1"></eq><apply id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2"><times id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1"></times><ci id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2">weight</ci><ci id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3">_</ci><ci id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4">decay</ci></apply><cn id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.3.m3.1c">\mathrm{weight\_decay}=0.1</annotation></semantics></math>로 설정된 AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite>를 채용한다. DeepSeekMoE 145B의 예비 연구를 위해 워밍업 및 상수 학습률 스케줄러를 사용한다. 처음에, 학습률은 처음 2K 단계 동안 0에서 최대값까지 선형적으로 증가한다. 이어서, 나머지 훈련 과정 동안 학습률은 일정하게 유지된다. DeepSeekMoE 145B에 대한 최대 학습 속도는 <math alttext="3.0\times 10^{-4}" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.4.m4.1"><semantics id="S7.SS1.SSS0.Px3.p1.4.m4.1a"><mrow id="S7.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.cmml"><mn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml">3.0</mn><mo id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml">×</mo><msup id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml"><mn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml"><mo id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3a" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.4.m4.1b"><apply id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1"><times id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1"></times><cn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2">3.0</cn><apply id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3">superscript</csymbol><cn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2">10</cn><apply id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3"><minus id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3"></minus><cn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.4.m4.1c">3.0\times 10^{-4}</annotation></semantics></math>로 설정되고, 그래디언트 클리핑 규범은 1.0으로 설정된다. 배치 크기는 4.5K로 설정되고, 최대 시퀀스 길이가 4K인 경우, 각각의 트레이닝 배치에는 18M 토큰이 포함된다. 우리는 DeepSeekMoE 145B를 13,000단계 동안 훈련하여 245B 훈련 토큰을 달성합니다. 또한, 우리는 훈련 중에 중퇴를 사용하지 않습니다. 파이프라인 병렬성을 활용하여 모델의 다른 계층을 다른 장치에 배치하며, 각 계층에 대해 라우팅된 모든 전문가가 4개의 장치(즉, 데이터 병렬성과 결합된 전문가 병렬성)에 균일하게 배치됩니다. DeepSeekMoE 145B에 대해 전문가 병렬성을 사용하기 때문에 계산 병목 현상을 줄이기 위해 장치 수준의 부하 균형을 고려해야 한다. 이에 대해 장치 수준 균형 계수를 0.05로 설정하여 장치 간 균형 계산을 권장합니다. 또한 라우팅 붕괴를 방지하기 위해 여전히 0.003의 작은 전문가 수준의 균형 계수를 설정했습니다.</p>
</div>
</section>
<section id="S7.SS1.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Evaluation Benchmarks.</h5>

<div id="S7.SS1.SSS0.Px4.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS1.SSS0.Px4.p1.1">DeepSeekMoE 16B에 사용된 것과 정확히 동일한 내부 벤치마크에 대해 DeepSeekMoE 145B를 평가한다(<a class="ltx_ref" href="#S5.SS1.SSS3" title="5.1.3 Evaluation Benchmarks ‣ 5.1 Experimental Setup ‣ 5 Scaling up to DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5.1.3</span></a> 섹션 참조).</p>
</div>
<figure id="S7.T6" class="ltx_table">
<table id="S7.T6.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S7.T6.9.1.1" class="ltx_tr">
<th id="S7.T6.9.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.1.1" class="ltx_text">
<span id="S7.T6.9.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.1.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></span></span>
</span></span></th>
<th id="S7.T6.9.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.2.1" class="ltx_text">
<span id="S7.T6.9.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.2.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.2.1.1.1.1.1" class="ltx_text ltx_font_bold"># Shot</span></span></span>
</span></span></th>
<td id="S7.T6.9.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.3.1" class="ltx_text">
<span id="S7.T6.9.1.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.3.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.3.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeek</span></span></span>
<span id="S7.T6.9.1.1.3.1.1.2" class="ltx_tr">
<span id="S7.T6.9.1.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.3.1.1.2.1.1" class="ltx_text ltx_font_bold">67B (Dense)</span></span></span>
</span></span></td>
<td id="S7.T6.9.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.4.1" class="ltx_text">
<span id="S7.T6.9.1.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.4.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.4.1.1.1.1.1" class="ltx_text ltx_font_bold">GShard</span></span></span>
<span id="S7.T6.9.1.1.4.1.1.2" class="ltx_tr">
<span id="S7.T6.9.1.1.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.4.1.1.2.1.1" class="ltx_text ltx_font_bold">137B</span></span></span>
</span></span></td>
<td id="S7.T6.9.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.5.1" class="ltx_text">
<span id="S7.T6.9.1.1.5.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.5.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.5.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.5.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></span></span>
<span id="S7.T6.9.1.1.5.1.1.2" class="ltx_tr">
<span id="S7.T6.9.1.1.5.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.5.1.1.2.1.1" class="ltx_text ltx_font_bold">145B</span></span></span>
</span></span></td>
<td id="S7.T6.9.1.1.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.6.1" class="ltx_text">
<span id="S7.T6.9.1.1.6.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.6.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.6.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.6.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeekMoE 142B</span></span></span>
<span id="S7.T6.9.1.1.6.1.1.2" class="ltx_tr">
<span id="S7.T6.9.1.1.6.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.6.1.1.2.1.1" class="ltx_text ltx_font_bold">(Half Activated)</span></span></span>
</span></span></td>
</tr>
<tr id="S7.T6.9.2.2" class="ltx_tr">
<th id="S7.T6.9.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"># Total Params</th>
<th id="S7.T6.9.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">67.4B</td>
<td id="S7.T6.9.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">136.5B</td>
<td id="S7.T6.9.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">144.6B</td>
<td id="S7.T6.9.2.2.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">142.3B</td>
</tr>
<tr id="S7.T6.9.3.3" class="ltx_tr">
<th id="S7.T6.9.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"># Activated Params</th>
<th id="S7.T6.9.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.3.3.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">67.4B</td>
<td id="S7.T6.9.3.3.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">21.6B</td>
<td id="S7.T6.9.3.3.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">22.2B</td>
<td id="S7.T6.9.3.3.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">12.2B</td>
</tr>
<tr id="S7.T6.9.4.4" class="ltx_tr">
<th id="S7.T6.9.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">Relative Expert Size</th>
<th id="S7.T6.9.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.4.4.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</td>
<td id="S7.T6.9.4.4.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">1</td>
<td id="S7.T6.9.4.4.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0.125</td>
<td id="S7.T6.9.4.4.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">0.125</td>
</tr>
<tr id="S7.T6.9.5.5" class="ltx_tr">
<th id="S7.T6.9.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"># Experts</th>
<th id="S7.T6.9.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.5.5.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</td>
<td id="S7.T6.9.5.5.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">0 + 16</td>
<td id="S7.T6.9.5.5.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">4 + 128</td>
<td id="S7.T6.9.5.5.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2 + 128</td>
</tr>
<tr id="S7.T6.9.6.6" class="ltx_tr">
<th id="S7.T6.9.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"># Activated Experts</th>
<th id="S7.T6.9.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.6.6.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</td>
<td id="S7.T6.9.6.6.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">0 + 2</td>
<td id="S7.T6.9.6.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">4 + 12</td>
<td id="S7.T6.9.6.6.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2 + 6</td>
</tr>
<tr id="S7.T6.9.7.7" class="ltx_tr">
<th id="S7.T6.9.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">FLOPs per 4K Tokens</th>
<th id="S7.T6.9.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.7.7.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2057.5T</td>
<td id="S7.T6.9.7.7.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">572.7T</td>
<td id="S7.T6.9.7.7.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">585.6T</td>
<td id="S7.T6.9.7.7.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">374.6T</td>
</tr>
<tr id="S7.T6.9.8.8" class="ltx_tr">
<th id="S7.T6.9.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"># Training Tokens</th>
<th id="S7.T6.9.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.8.8.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
<td id="S7.T6.9.8.8.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
<td id="S7.T6.9.8.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
<td id="S7.T6.9.8.8.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
</tr>
<tr id="S7.T6.9.9.9" class="ltx_tr">
<th id="S7.T6.9.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">Pile&nbsp;(Loss.)</th>
<th id="S7.T6.9.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.9.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">1.905</td>
<td id="S7.T6.9.9.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">1.961</td>
<td id="S7.T6.9.9.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.9.9.5.1" class="ltx_text ltx_font_bold">1.876</span></td>
<td id="S7.T6.9.9.9.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">1.888</td>
</tr>
<tr id="S7.T6.9.10.10" class="ltx_tr">
<th id="S7.T6.9.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S7.T6.9.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.10.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">74.8</td>
<td id="S7.T6.9.10.10.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">72.0</td>
<td id="S7.T6.9.10.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.10.10.5.1" class="ltx_text ltx_font_bold">75.8</span></td>
<td id="S7.T6.9.10.10.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">74.9</td>
</tr>
<tr id="S7.T6.9.11.11" class="ltx_tr">
<th id="S7.T6.9.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S7.T6.9.11.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.11.11.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">79.8</td>
<td id="S7.T6.9.11.11.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">77.6</td>
<td id="S7.T6.9.11.11.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.11.11.5.1" class="ltx_text ltx_font_bold">80.7</span></td>
<td id="S7.T6.9.11.11.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">80.2</td>
</tr>
<tr id="S7.T6.9.12.12" class="ltx_tr">
<th id="S7.T6.9.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S7.T6.9.12.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.12.12.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">69.0</td>
<td id="S7.T6.9.12.12.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">64.0</td>
<td id="S7.T6.9.12.12.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.12.12.5.1" class="ltx_text ltx_font_bold">69.7</span></td>
<td id="S7.T6.9.12.12.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">67.9</td>
</tr>
<tr id="S7.T6.9.13.13" class="ltx_tr">
<th id="S7.T6.9.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S7.T6.9.13.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.13.13.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.13.13.3.1" class="ltx_text ltx_font_bold">50.4</span></td>
<td id="S7.T6.9.13.13.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">45.8</td>
<td id="S7.T6.9.13.13.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">48.8</td>
<td id="S7.T6.9.13.13.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">49.0</td>
</tr>
<tr id="S7.T6.9.14.14" class="ltx_tr">
<th id="S7.T6.9.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S7.T6.9.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.14.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.14.14.3.1" class="ltx_text ltx_font_bold">63.2</span></td>
<td id="S7.T6.9.14.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">59.2</td>
<td id="S7.T6.9.14.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">62.1</td>
<td id="S7.T6.9.14.14.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">59.5</td>
</tr>
<tr id="S7.T6.9.15.15" class="ltx_tr">
<th id="S7.T6.9.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S7.T6.9.15.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.15.15.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.15.15.3.1" class="ltx_text ltx_font_bold">46.9</span></td>
<td id="S7.T6.9.15.15.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">43.5</td>
<td id="S7.T6.9.15.15.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">45.5</td>
<td id="S7.T6.9.15.15.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">42.6</td>
</tr>
<tr id="S7.T6.9.16.16" class="ltx_tr">
<th id="S7.T6.9.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">DROP&nbsp;(EM)</th>
<th id="S7.T6.9.16.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">1-shot</th>
<td id="S7.T6.9.16.16.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.16.16.3.1" class="ltx_text ltx_font_bold">27.5</span></td>
<td id="S7.T6.9.16.16.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">21.6</td>
<td id="S7.T6.9.16.16.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.16.16.5.1" class="ltx_text ltx_font_bold">27.8</span></td>
<td id="S7.T6.9.16.16.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">28.9</td>
</tr>
<tr id="S7.T6.9.17.17" class="ltx_tr">
<th id="S7.T6.9.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">GSM8K&nbsp;(EM)</th>
<th id="S7.T6.9.17.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">8-shot</th>
<td id="S7.T6.9.17.17.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.17.17.3.1" class="ltx_text ltx_font_bold">11.8</span></td>
<td id="S7.T6.9.17.17.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">6.4</td>
<td id="S7.T6.9.17.17.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.17.17.5.1" class="ltx_text ltx_font_bold">12.2</span></td>
<td id="S7.T6.9.17.17.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">13.8</td>
</tr>
<tr id="S7.T6.9.18.18" class="ltx_tr">
<th id="S7.T6.9.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">MATH&nbsp;(EM)</th>
<th id="S7.T6.9.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">4-shot</th>
<td id="S7.T6.9.18.18.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2.1</td>
<td id="S7.T6.9.18.18.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">1.6</td>
<td id="S7.T6.9.18.18.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.18.18.5.1" class="ltx_text ltx_font_bold">3.1</span></td>
<td id="S7.T6.9.18.18.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2.8</td>
</tr>
<tr id="S7.T6.9.19.19" class="ltx_tr">
<th id="S7.T6.9.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S7.T6.9.19.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.19.19.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.19.19.3.1" class="ltx_text ltx_font_bold">23.8</span></td>
<td id="S7.T6.9.19.19.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">17.7</td>
<td id="S7.T6.9.19.19.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">19.5</td>
<td id="S7.T6.9.19.19.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">23.2</td>
</tr>
<tr id="S7.T6.9.20.20" class="ltx_tr">
<th id="S7.T6.9.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S7.T6.9.20.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">3-shot</th>
<td id="S7.T6.9.20.20.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.20.20.3.1" class="ltx_text ltx_font_bold">33.6</span></td>
<td id="S7.T6.9.20.20.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">27.6</td>
<td id="S7.T6.9.20.20.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.20.20.5.1" class="ltx_text ltx_font_bold">33.2</span></td>
<td id="S7.T6.9.20.20.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">32.0</td>
</tr>
<tr id="S7.T6.9.21.21" class="ltx_tr">
<th id="S7.T6.9.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S7.T6.9.21.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.21.21.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">57.2</td>
<td id="S7.T6.9.21.21.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">52.5</td>
<td id="S7.T6.9.21.21.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.21.21.5.1" class="ltx_text ltx_font_bold">61.1</span></td>
<td id="S7.T6.9.21.21.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">59.8</td>
</tr>
<tr id="S7.T6.9.22.22" class="ltx_tr">
<th id="S7.T6.9.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S7.T6.9.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.22.22.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">22.6</td>
<td id="S7.T6.9.22.22.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">19.0</td>
<td id="S7.T6.9.22.22.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.22.22.5.1" class="ltx_text ltx_font_bold">25.0</span></td>
<td id="S7.T6.9.22.22.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">23.5</td>
</tr>
<tr id="S7.T6.9.23.23" class="ltx_tr">
<th id="S7.T6.9.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">MMLU&nbsp;(Acc.)</th>
<th id="S7.T6.9.23.23.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.23.23.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.23.23.3.1" class="ltx_text ltx_font_bold">45.1</span></td>
<td id="S7.T6.9.23.23.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">26.3</td>
<td id="S7.T6.9.23.23.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">39.4</td>
<td id="S7.T6.9.23.23.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">37.5</td>
</tr>
<tr id="S7.T6.9.24.24" class="ltx_tr">
<th id="S7.T6.9.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th id="S7.T6.9.24.24.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.24.24.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">70.7</td>
<td id="S7.T6.9.24.24.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">67.6</td>
<td id="S7.T6.9.24.24.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.24.24.5.1" class="ltx_text ltx_font_bold">71.9</span></td>
<td id="S7.T6.9.24.24.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">70.8</td>
</tr>
<tr id="S7.T6.9.25.25" class="ltx_tr">
<th id="S7.T6.9.25.25.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">CLUEWSC&nbsp;(EM)</th>
<th id="S7.T6.9.25.25.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.25.25.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">69.1</td>
<td id="S7.T6.9.25.25.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">65.7</td>
<td id="S7.T6.9.25.25.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.25.25.5.1" class="ltx_text ltx_font_bold">71.9</span></td>
<td id="S7.T6.9.25.25.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">72.6</td>
</tr>
<tr id="S7.T6.9.26.26" class="ltx_tr">
<th id="S7.T6.9.26.26.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">CEval&nbsp;(Acc.)</th>
<th id="S7.T6.9.26.26.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.26.26.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.26.26.3.1" class="ltx_text ltx_font_bold">40.3</span></td>
<td id="S7.T6.9.26.26.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">26.2</td>
<td id="S7.T6.9.26.26.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">37.1</td>
<td id="S7.T6.9.26.26.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">32.8</td>
</tr>
<tr id="S7.T6.9.27.27" class="ltx_tr">
<th id="S7.T6.9.27.27.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">CMMLU&nbsp;(Acc.)</th>
<th id="S7.T6.9.27.27.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.27.27.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.27.27.3.1" class="ltx_text ltx_font_bold">40.6</span></td>
<td id="S7.T6.9.27.27.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">25.4</td>
<td id="S7.T6.9.27.27.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">35.9</td>
<td id="S7.T6.9.27.27.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">31.9</td>
</tr>
<tr id="S7.T6.9.28.28" class="ltx_tr">
<th id="S7.T6.9.28.28.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">CHID&nbsp;(Acc.)</th>
<th id="S7.T6.9.28.28.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.28.28.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">88.5</td>
<td id="S7.T6.9.28.28.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">86.9</td>
<td id="S7.T6.9.28.28.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.28.28.5.1" class="ltx_text ltx_font_bold">90.3</span></td>
<td id="S7.T6.9.28.28.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">88.3</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 6:</span></figcaption>
Comparison among DeepSeek 67B (Dense) and MoE models at the scale of about 140B total parameters.
In the lines of “# Experts” and “# Activated Experts”, <math id="S7.T6.5.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S7.T6.5.m1.1b"><mi id="S7.T6.5.m1.1.1" xref="S7.T6.5.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S7.T6.5.m1.1c"><ci id="S7.T6.5.m1.1.1.cmml" xref="S7.T6.5.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.5.m1.1d">a</annotation></semantics></math> + <math id="S7.T6.6.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S7.T6.6.m2.1b"><mi id="S7.T6.6.m2.1.1" xref="S7.T6.6.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S7.T6.6.m2.1c"><ci id="S7.T6.6.m2.1.1.cmml" xref="S7.T6.6.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.6.m2.1d">b</annotation></semantics></math> denotes <math id="S7.T6.7.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S7.T6.7.m3.1b"><mi id="S7.T6.7.m3.1.1" xref="S7.T6.7.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S7.T6.7.m3.1c"><ci id="S7.T6.7.m3.1.1.cmml" xref="S7.T6.7.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.7.m3.1d">a</annotation></semantics></math> shared experts and <math id="S7.T6.8.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S7.T6.8.m4.1b"><mi id="S7.T6.8.m4.1.1" xref="S7.T6.8.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S7.T6.8.m4.1c"><ci id="S7.T6.8.m4.1.1.cmml" xref="S7.T6.8.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.8.m4.1d">b</annotation></semantics></math> routed experts, respectively.
<span id="S7.T6.11.1" class="ltx_text ltx_font_bold">Bold</span> font indicates the best or near the best performance excluding the last column.
DeepSeekMoE 145B, and even DeepSeekMoE 142B (Half Activated) that has only a half of activated expert parameters, outperform GShard 137B by a large margin.
Moreover, with 28.5% of computations, DeepSeekMoE 145B achieves comparable performance with DeepSeek 67B.
</figcaption>
</figure>
</section>
</section>
<section id="S7.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Evaluations</h3>

<section id="S7.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5>

<div id="S7.SS2.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS2.SSS0.Px1.p1.1"><span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.1">DeepSeekMoE 145B</span> 외에도 비교를 위해 세 가지 추가 모델을 고려한다. <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.2">DeepSeek 67B (Dense)</span>은 67.4B 총 매개 변수를 가진 dense 모델입니다 (모델 및 훈련 세부 정보에 대해 <cite class="ltx_cite ltx_citemacro_citet">DeepSeek-AI (<a class="ltx_ref" href="#bib.bib13" title="">2024</a>)</cite> 참조). <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.3">GShard 137B</span>는 DeepSeekMoE 145B와 동일한 숨겨진 차원 및 층 수를 공유하지만 GShard 아키텍처를 따른다. DeepSeekMoE 145B는 계산 효율성을 위해 각 전문가의 중간 은닉 차원을 64의 배수로 정렬하므로 모델 크기는 GShard 137B보다 6% 더 크다. <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.4">DeepSeekMoE 142B(Half Activated)</span>는 DeepSeekMoE 145B와 유사한 아키텍처를 갖지만, 공유된 전문가 2명만 포함하고, 128명의 라우팅된 전문가 중 6명만이 활성화된다. DeepSeekMoE 145B를 포함한 비교된 모든 모델이 동일한 훈련 코퍼스를 공유한다는 점은 주목할 만하다. 또한, 비교의 모든 MoE 모델은 처음부터 훈련되고 동일한 훈련 하이퍼-파라미터를 공유한다.</p>
</div>
</section>
<section id="S7.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5>

<div id="S7.SS2.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS2.SSS0.Px2.p1.1">표 <a class="ltx_ref" href="#S7.T6" title="Table 6 ‣ Evaluation Benchmarks. ‣ 7.1 Experimental Setup ‣ 7 DeepSeekMoE 145B Ongoing ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>에 제시된 평가 결과로부터 다음과 같은 관찰 결과를 얻을 수 있다. (1) 비슷한 총 파라미터와 계산을 가짐에도 불구하고 DeepSeekMoE 145B는 GShard 137B보다 훨씬 우수한 성능을 보여 DeepSeekMoE 아키텍처의 장점을 다시 강조한다. (2) 전체적으로, 28.5%의 계산만으로, DeepSeekMoE 145B는 DeepSeek 67B(Dense)와 비교 가능한 성능을 달성한다. DeepSeekMoE 16B의 결과와 일치하게, DeepSeekMoE 145B는 언어 모델링 및 지식 집약적 작업에서 현저한 강점을 나타내지만 객관식 작업에서는 한계가 있다. (3) 더 큰 규모에서, DeepSeekMoE 142B(Half Activated)의 성능은 DeepSeekMoE 145B로부터 너무 많이 뒤처지지 않는다. 또한, 활성화된 전문가 매개변수의 절반만을 가지고 있음에도 불구하고 DeepSeekMoE 142B(Half Activated)는 여전히 DeepSeek 67B(Dense)의 성능과 18.2%의 계산만으로 일치한다. 또한 Section <a class="ltx_ref" href="#S4.SS5" title="4.5 Analysis on Expert Specialization ‣ 4 Validation Experiments ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4.5</span></a>의 결론과 일치하는 GShard 137B를 능가한다.</p>
</div>
</section>
</section>
</section>
<section id="S8" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Related Work</h2>

<div id="S8.p1" class="ltx_para">
<p class="ltx_p" id="S8.p1.1">Mixture of Experts(MoE) 기법은 독립적인 전문가 모듈로 서로 다른 샘플을 다루기 위해 <cite class="ltx_cite ltx_citemacro_citet">Jacobs et al. (<a class="ltx_ref" href="#bib.bib26" title="">1991</a>); Jordan and Jacobs (<a class="ltx_ref" href="#bib.bib27" title="">1994</a>)</cite>에 의해 처음 제안된다. <cite class="ltx_cite ltx_citemacro_citet">Shazeer et al. (<a class="ltx_ref" href="#bib.bib47" title="">2017</a>)</cite> 언어 모델 훈련에 MoE를 도입하고 대규모 LSTM 기반 <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and Schmidhuber, <a class="ltx_ref" href="#bib.bib23" title="">1997</a>)</cite> MoE 모델을 구축한다. 트랜스포머가 NLP의 가장 인기 있는 아키텍처가 되면서 많은 시도가 트랜스포머에서 FFN을 MoE 계층으로 확장하여 MoE 언어 모델을 구축한다. GShard<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin et al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite>와 Switch Transformer<cite class="ltx_cite ltx_citemacro_citep">(Fedus et al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite>는 MoE 언어 모델을 매우 큰 규모로 확장하기 위해 학습 가능한 top-2 또는 top-1 라우팅 전략을 사용하는 선구자이다. Hash Layer <cite class="ltx_cite ltx_citemacro_citep">(Roller et al., <a class="ltx_ref" href="#bib.bib42" title="">2021</a>)</cite>와 StableMoE <cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a class="ltx_ref" href="#bib.bib12" title="">2022b</a>)</cite>는 보다 안정적인 라우팅과 훈련을 위해 고정적인 라우팅 전략을 사용한다. <cite class="ltx_cite ltx_citemacro_citet">Zhou et al. (<a class="ltx_ref" href="#bib.bib62" title="">2022</a>)</cite>는 전문가 선택 라우팅 전략을 제안하며, 여기서 각 토큰은 서로 다른 수의 전문가에게 할당될 수 있다. <cite class="ltx_cite ltx_citemacro_citet">Zoph (<a class="ltx_ref" href="#bib.bib63" title="">2022</a>)</cite>는 MoE 모델의 훈련 불안정성과 미세 조정 어려움 문제에 초점을 맞추고 이러한 문제를 극복하기 위한 ST-MoE를 제안한다. MoE 아키텍처 및 훈련 전략에 대한 연구 외에도 최근 몇 년 동안 기존 MoE 아키텍처를 기반으로 하는 수많은 대규모 언어 또는 멀티모달 모델 <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="#bib.bib34" title="">2021</a>; Du et al., <a class="ltx_ref" href="#bib.bib14" title="">2022</a>; Ren et al., <a class="ltx_ref" href="#bib.bib41" title="">2023</a>; Xue et al., <a class="ltx_ref" href="#bib.bib58" title="">2023</a>)</cite>가 출현했다. 대체로, 이전의 대부분의 MoE 모델은 종래의 상위-1 또는 상위-2 라우팅 전략을 기반으로 하여 전문가 전문화를 개선할 수 있는 큰 여지를 남겨둔다. 이에 저희 DeepSeekMoE 아키텍처는 전문가 전문화를 최대한 개선하는 것을 목표로 하고 있습니다.</p>
</div>
</section>
<section id="S9" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Conclusion</h2>

<div id="S9.p1" class="ltx_para">
<p class="ltx_p" id="S9.p1.1">본 논문에서는 MoE 언어 모델을 위한 DeepSeekMoE 아키텍처를 소개하고, 궁극적인 전문가 전문화를 달성하는 것을 목표로 한다. 세분화된 전문가 분할과 공유된 전문가 분리를 통해 DeepSeekMoE는 기존의 MoE 아키텍처에 비해 훨씬 더 높은 전문가 전문화와 성능을 달성한다. 2B 매개변수의 적당한 척도로 시작하여 DeepSeekMoE의 장점을 검증하여 MoE 모델의 상한 성능에 접근하는 능력을 입증한다. 또한 DeepSeekMoE가 GShard보다 전문가 전문화 수준이 높다는 실증적 증거를 제공한다.</p>
</div>
<div id="S9.p2" class="ltx_para">
<p class="ltx_p" id="S9.p2.1">더 큰 규모의 16B 총 매개변수까지 확장하여 2T 토큰에서 DeepSeekMoE 16B를 훈련하고 약 40%의 계산으로 DeepSeek 7B 및 LLaMA2 7B와 비교할 수 있는 뛰어난 성능을 보여준다. 또한, DeepSeekMoE 16B를 기반으로 MoE 채팅 모델을 구성하기 위한 정렬을 위해 감독 미세 조정을 수행하여 적응성과 범용성을 추가로 보여준다. 또한 DeepSeekMoE를 145B 매개변수로 확장하기 위한 예비 탐색을 수행한다. 우리는 DeepSeekMoE 145B가 여전히 GShard 아키텍처에 비해 상당한 이점을 유지한다는 것을 발견했으며, 28.5%(심지어 18.2%)의 계산만을 사용하여 DeepSeek 67B와 유사한 성능을 보여준다.</p>
</div>
<div id="S9.p3" class="ltx_para">
<p class="ltx_p" id="S9.p3.1">연구 목적을 위해, 우리는 40GB의 메모리를 가진 단일 GPU에 배포될 수 있는 DeepSeekMoE 16B의 모델 체크포인트를 대중에게 공개한다. 우리는 이 작업이 학계와 산업계 모두에게 귀중한 통찰력을 제공하고 대규모 언어 모델의 가속화된 발전에 기여하기를 바란다.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography" lang="en">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Almazrouei et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
E.&nbsp;Almazrouei, H.&nbsp;Alobeidli, A.&nbsp;Alshamsi, A.&nbsp;Cappelli, R.&nbsp;Cojocaru, M.&nbsp;Debbah, E.&nbsp;Goffinet, D.&nbsp;Heslow, J.&nbsp;Launay, Q.&nbsp;Malartic, B.&nbsp;Noune, B.&nbsp;Pannier, and G.&nbsp;Penedo.

</span>
<span class="ltx_bibblock">Falcon-40B: an open large language model with state-of-the-art performance, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Artetxe et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
M.&nbsp;Artetxe, S.&nbsp;Bhosale, N.&nbsp;Goyal, T.&nbsp;Mihaylov, M.&nbsp;Ott, S.&nbsp;Shleifer, X.&nbsp;V. Lin, J.&nbsp;Du, S.&nbsp;Iyer, R.&nbsp;Pasunuru, G.&nbsp;Anantharaman, X.&nbsp;Li, S.&nbsp;Chen, H.&nbsp;Akin, M.&nbsp;Baines, L.&nbsp;Martin, X.&nbsp;Zhou, P.&nbsp;S. Koura, B.&nbsp;O’Horo, J.&nbsp;Wang, L.&nbsp;Zettlemoyer, M.&nbsp;T. Diab, Z.&nbsp;Kozareva, and V.&nbsp;Stoyanov.

</span>
<span class="ltx_bibblock">Efficient large scale language modeling with mixtures of experts.

</span>
<span class="ltx_bibblock">In Y.&nbsp;Goldberg, Z.&nbsp;Kozareva, and Y.&nbsp;Zhang, editors, <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing, EMNLP 2022, Abu Dhabi, United Arab Emirates, December 7-11, 2022</em>, pages 11699–11732. Association for Computational Linguistics, 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2022.EMNLP-MAIN.804" title="" class="ltx_ref">10.18653/V1/2022.EMNLP-MAIN.804</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2022.emnlp-main.804" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2022.emnlp-main.804</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Austin et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
J.&nbsp;Austin, A.&nbsp;Odena, M.&nbsp;Nye, M.&nbsp;Bosma, H.&nbsp;Michalewski, D.&nbsp;Dohan, E.&nbsp;Jiang, C.&nbsp;Cai, M.&nbsp;Terry, Q.&nbsp;Le, et&nbsp;al.

</span>
<span class="ltx_bibblock">Program synthesis with large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.07732</em>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
S.&nbsp;Biderman, H.&nbsp;Schoelkopf, Q.&nbsp;G. Anthony, H.&nbsp;Bradley, K.&nbsp;O’Brien, E.&nbsp;Hallahan, M.&nbsp;A. Khan, S.&nbsp;Purohit, U.&nbsp;S. Prashanth, E.&nbsp;Raff, A.&nbsp;Skowron, L.&nbsp;Sutawika, and O.&nbsp;van&nbsp;der Wal.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In A.&nbsp;Krause, E.&nbsp;Brunskill, K.&nbsp;Cho, B.&nbsp;Engelhardt, S.&nbsp;Sabato, and J.&nbsp;Scarlett, editors, <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning, ICML 2023, 23-29 July 2023, Honolulu, Hawaii, USA</em>, volume 202 of <em id="bib.bib4.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pages 2397–2430. PMLR, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v202/biderman23a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v202/biderman23a.html</a>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Y.&nbsp;Bisk, R.&nbsp;Zellers, R.&nbsp;L. Bras, J.&nbsp;Gao, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">PIQA: reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">The Thirty-Fourth AAAI Conference on Artificial Intelligence, AAAI 2020, The Thirty-Second Innovative Applications of Artificial Intelligence Conference, IAAI 2020, The Tenth AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI 2020, New York, NY, USA, February 7-12, 2020</em>, pages 7432–7439. AAAI Press, 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.1609/aaai.v34i05.6239" title="" class="ltx_ref">10.1609/aaai.v34i05.6239</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1609/aaai.v34i05.6239" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1609/aaai.v34i05.6239</a>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Black et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
S.&nbsp;Black, L.&nbsp;Gao, P.&nbsp;Wang, C.&nbsp;Leahy, and S.&nbsp;Biderman.

</span>
<span class="ltx_bibblock">GPT-Neo: Large Scale Autoregressive Language Modeling with Mesh-Tensorflow, Mar. 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.5281/zenodo.5297715" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.5281/zenodo.5297715</a>.

</span>
<span class="ltx_bibblock">If you use this misc, please cite it using these metadata.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
T.&nbsp;B. Brown, B.&nbsp;Mann, N.&nbsp;Ryder, M.&nbsp;Subbiah, J.&nbsp;Kaplan, P.&nbsp;Dhariwal, A.&nbsp;Neelakantan, P.&nbsp;Shyam, G.&nbsp;Sastry, A.&nbsp;Askell, S.&nbsp;Agarwal, A.&nbsp;Herbert-Voss, G.&nbsp;Krueger, T.&nbsp;Henighan, R.&nbsp;Child, A.&nbsp;Ramesh, D.&nbsp;M. Ziegler, J.&nbsp;Wu, C.&nbsp;Winter, C.&nbsp;Hesse, M.&nbsp;Chen, E.&nbsp;Sigler, M.&nbsp;Litwin, S.&nbsp;Gray, B.&nbsp;Chess, J.&nbsp;Clark, C.&nbsp;Berner, S.&nbsp;McCandlish, A.&nbsp;Radford, I.&nbsp;Sutskever, and D.&nbsp;Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.neurips.cc/paper/2020/hash/1457c0d6bfcb4967418bfb8ac142f64a-Abstract.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2020/hash/1457c0d6bfcb4967418bfb8ac142f64a-Abstract.html</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
M.&nbsp;Chen, J.&nbsp;Tworek, H.&nbsp;Jun, Q.&nbsp;Yuan, H.&nbsp;P. de&nbsp;Oliveira&nbsp;Pinto, J.&nbsp;Kaplan, H.&nbsp;Edwards, Y.&nbsp;Burda, N.&nbsp;Joseph, G.&nbsp;Brockman, A.&nbsp;Ray, R.&nbsp;Puri, G.&nbsp;Krueger, M.&nbsp;Petrov, H.&nbsp;Khlaaf, G.&nbsp;Sastry, P.&nbsp;Mishkin, B.&nbsp;Chan, S.&nbsp;Gray, N.&nbsp;Ryder, M.&nbsp;Pavlov, A.&nbsp;Power, L.&nbsp;Kaiser, M.&nbsp;Bavarian, C.&nbsp;Winter, P.&nbsp;Tillet, F.&nbsp;P. Such, D.&nbsp;Cummings, M.&nbsp;Plappert, F.&nbsp;Chantzis, E.&nbsp;Barnes, A.&nbsp;Herbert-Voss, W.&nbsp;H. Guss, A.&nbsp;Nichol, A.&nbsp;Paino, N.&nbsp;Tezak, J.&nbsp;Tang, I.&nbsp;Babuschkin, S.&nbsp;Balaji, S.&nbsp;Jain, W.&nbsp;Saunders, C.&nbsp;Hesse, A.&nbsp;N. Carr, J.&nbsp;Leike, J.&nbsp;Achiam, V.&nbsp;Misra, E.&nbsp;Morikawa, A.&nbsp;Radford, M.&nbsp;Knight, M.&nbsp;Brundage, M.&nbsp;Murati, K.&nbsp;Mayer, P.&nbsp;Welinder, B.&nbsp;McGrew, D.&nbsp;Amodei, S.&nbsp;McCandlish, I.&nbsp;Sutskever, and W.&nbsp;Zaremba.

</span>
<span class="ltx_bibblock">Evaluating large language models trained on code.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2107.03374, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2107.03374" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2107.03374</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
P.&nbsp;Clark, I.&nbsp;Cowhey, O.&nbsp;Etzioni, T.&nbsp;Khot, A.&nbsp;Sabharwal, C.&nbsp;Schoenick, and O.&nbsp;Tafjord.

</span>
<span class="ltx_bibblock">Think you have solved question answering? try arc, the AI2 reasoning challenge.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1803.05457, 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1803.05457" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1803.05457</a>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cobbe et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
K.&nbsp;Cobbe, V.&nbsp;Kosaraju, M.&nbsp;Bavarian, M.&nbsp;Chen, H.&nbsp;Jun, L.&nbsp;Kaiser, M.&nbsp;Plappert, J.&nbsp;Tworek, J.&nbsp;Hilton, R.&nbsp;Nakano, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training verifiers to solve math word problems.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.14168</em>, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2022a)</span>
<span class="ltx_bibblock">
D.&nbsp;Dai, L.&nbsp;Dong, Y.&nbsp;Hao, Z.&nbsp;Sui, B.&nbsp;Chang, and F.&nbsp;Wei.

</span>
<span class="ltx_bibblock">Knowledge neurons in pretrained transformers.

</span>
<span class="ltx_bibblock">In S.&nbsp;Muresan, P.&nbsp;Nakov, and A.&nbsp;Villavicencio, editors, <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 8493–8502. Association for Computational Linguistics, 2022a.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2022.ACL-LONG.581" title="" class="ltx_ref">10.18653/V1/2022.ACL-LONG.581</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2022.acl-long.581" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2022.acl-long.581</a>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2022b)</span>
<span class="ltx_bibblock">
D.&nbsp;Dai, L.&nbsp;Dong, S.&nbsp;Ma, B.&nbsp;Zheng, Z.&nbsp;Sui, B.&nbsp;Chang, and F.&nbsp;Wei.

</span>
<span class="ltx_bibblock">Stablemoe: Stable routing strategy for mixture of experts.

</span>
<span class="ltx_bibblock">In S.&nbsp;Muresan, P.&nbsp;Nakov, and A.&nbsp;Villavicencio, editors, <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 7085–7095. Association for Computational Linguistics, 2022b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2022.ACL-LONG.489" title="" class="ltx_ref">10.18653/V1/2022.ACL-LONG.489</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2022.acl-long.489" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2022.acl-long.489</a>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">DeepSeek-AI (2024)</span>
<span class="ltx_bibblock">
DeepSeek-AI.

</span>
<span class="ltx_bibblock">Deepseek llm: Scaling open-source language models with longtermism.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.02954</em>, 2024.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
N.&nbsp;Du, Y.&nbsp;Huang, A.&nbsp;M. Dai, S.&nbsp;Tong, D.&nbsp;Lepikhin, Y.&nbsp;Xu, M.&nbsp;Krikun, Y.&nbsp;Zhou, A.&nbsp;W. Yu, O.&nbsp;Firat, B.&nbsp;Zoph, L.&nbsp;Fedus, M.&nbsp;P. Bosma, Z.&nbsp;Zhou, T.&nbsp;Wang, Y.&nbsp;E. Wang, K.&nbsp;Webster, M.&nbsp;Pellat, K.&nbsp;Robinson, K.&nbsp;S. Meier-Hellstern, T.&nbsp;Duke, L.&nbsp;Dixon, K.&nbsp;Zhang, Q.&nbsp;V. Le, Y.&nbsp;Wu, Z.&nbsp;Chen, and C.&nbsp;Cui.

</span>
<span class="ltx_bibblock">Glam: Efficient scaling of language models with mixture-of-experts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</em>, volume 162 of <em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pages 5547–5569. PMLR, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v162/du22c.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v162/du22c.html</a>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dua et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
D.&nbsp;Dua, Y.&nbsp;Wang, P.&nbsp;Dasigi, G.&nbsp;Stanovsky, S.&nbsp;Singh, and M.&nbsp;Gardner.

</span>
<span class="ltx_bibblock">DROP: A reading comprehension benchmark requiring discrete reasoning over paragraphs.

</span>
<span class="ltx_bibblock">In J.&nbsp;Burstein, C.&nbsp;Doran, and T.&nbsp;Solorio, editors, <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, NAACL-HLT 2019, Minneapolis, MN, USA, June 2-7, 2019, Volume 1 (Long and Short Papers)</em>, pages 2368–2378. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/N19-1246" title="" class="ltx_ref">10.18653/V1/N19-1246</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/n19-1246" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/n19-1246</a>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fedus et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
W.&nbsp;Fedus, B.&nbsp;Zoph, and N.&nbsp;Shazeer.

</span>
<span class="ltx_bibblock">Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2101.03961, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2101.03961" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2101.03961</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
L.&nbsp;Gao, S.&nbsp;Biderman, S.&nbsp;Black, L.&nbsp;Golding, T.&nbsp;Hoppe, C.&nbsp;Foster, J.&nbsp;Phang, H.&nbsp;He, A.&nbsp;Thite, N.&nbsp;Nabeshima, et&nbsp;al.

</span>
<span class="ltx_bibblock">The Pile: An 800GB dataset of diverse text for language modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2101.00027</em>, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng and Liu (2023)</span>
<span class="ltx_bibblock">
X.&nbsp;Geng and H.&nbsp;Liu.

</span>
<span class="ltx_bibblock">Openllama: An open reproduction of llama, May 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://github.com/openlm-research/open_llama" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/openlm-research/open_llama</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harlap et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
A.&nbsp;Harlap, D.&nbsp;Narayanan, A.&nbsp;Phanishayee, V.&nbsp;Seshadri, N.&nbsp;R. Devanur, G.&nbsp;R. Ganger, and P.&nbsp;B. Gibbons.

</span>
<span class="ltx_bibblock">Pipedream: Fast and efficient pipeline parallel DNN training.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1806.03377, 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1806.03377" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1806.03377</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
D.&nbsp;Hendrycks, C.&nbsp;Burns, S.&nbsp;Basart, A.&nbsp;Zou, M.&nbsp;Mazeika, D.&nbsp;Song, and J.&nbsp;Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2009.03300</em>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
D.&nbsp;Hendrycks, C.&nbsp;Burns, S.&nbsp;Kadavath, A.&nbsp;Arora, S.&nbsp;Basart, E.&nbsp;Tang, D.&nbsp;Song, and J.&nbsp;Steinhardt.

</span>
<span class="ltx_bibblock">Measuring mathematical problem solving with the math dataset, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">High-Flyer (2023)</span>
<span class="ltx_bibblock">
High-Flyer.

</span>
<span class="ltx_bibblock">Hai-llm: An efficient and lightweight tool for training large models, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.high-flyer.cn/en/blog/hai-llm" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.high-flyer.cn/en/blog/hai-llm</a>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter and Schmidhuber (1997)</span>
<span class="ltx_bibblock">
S.&nbsp;Hochreiter and J.&nbsp;Schmidhuber.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Neural Computing</em>, 9(8):1735–1780, 1997.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1162/neco.1997.9.8.1735" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1162/neco.1997.9.8.1735</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
J.&nbsp;Hoffmann, S.&nbsp;Borgeaud, A.&nbsp;Mensch, E.&nbsp;Buchatskaya, T.&nbsp;Cai, E.&nbsp;Rutherford, D.&nbsp;de&nbsp;Las&nbsp;Casas, L.&nbsp;A. Hendricks, J.&nbsp;Welbl, A.&nbsp;Clark, T.&nbsp;Hennigan, E.&nbsp;Noland, K.&nbsp;Millican, G.&nbsp;van&nbsp;den Driessche, B.&nbsp;Damoc, A.&nbsp;Guy, S.&nbsp;Osindero, K.&nbsp;Simonyan, E.&nbsp;Elsen, J.&nbsp;W. Rae, O.&nbsp;Vinyals, and L.&nbsp;Sifre.

</span>
<span class="ltx_bibblock">Training compute-optimal large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2203.15556, 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/arXiv.2203.15556" title="" class="ltx_ref">10.48550/arXiv.2203.15556</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2203.15556" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2203.15556</a>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Y.&nbsp;Huang, Y.&nbsp;Bai, Z.&nbsp;Zhu, J.&nbsp;Zhang, J.&nbsp;Zhang, T.&nbsp;Su, J.&nbsp;Liu, C.&nbsp;Lv, Y.&nbsp;Zhang, J.&nbsp;Lei, et&nbsp;al.

</span>
<span class="ltx_bibblock">C-Eval: A multi-level multi-discipline chinese evaluation suite for foundation models.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.08322</em>, 2023.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jacobs et&nbsp;al. (1991)</span>
<span class="ltx_bibblock">
R.&nbsp;A. Jacobs, M.&nbsp;I. Jordan, S.&nbsp;J. Nowlan, and G.&nbsp;E. Hinton.

</span>
<span class="ltx_bibblock">Adaptive mixtures of local experts.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Neural Computing</em>, 3(1):79–87, 1991.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1162/neco.1991.3.1.79" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1162/neco.1991.3.1.79</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jordan and Jacobs (1994)</span>
<span class="ltx_bibblock">
M.&nbsp;I. Jordan and R.&nbsp;A. Jacobs.

</span>
<span class="ltx_bibblock">Hierarchical mixtures of experts and the EM algorithm.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Neural Computing</em>, 6(2):181–214, 1994.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1162/neco.1994.6.2.181" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1162/neco.1994.6.2.181</a>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
M.&nbsp;Joshi, E.&nbsp;Choi, D.&nbsp;Weld, and L.&nbsp;Zettlemoyer.

</span>
<span class="ltx_bibblock">triviaqa: A Large Scale Distantly Supervised Challenge Dataset for Reading Comprehension.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv e-prints</em>, art. arXiv:1705.03551, 2017.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Korthikanti et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
V.&nbsp;A. Korthikanti, J.&nbsp;Casper, S.&nbsp;Lym, L.&nbsp;McAfee, M.&nbsp;Andersch, M.&nbsp;Shoeybi, and B.&nbsp;Catanzaro.

</span>
<span class="ltx_bibblock">Reducing activation recomputation in large transformer models.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 5, 2023.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
T.&nbsp;Kwiatkowski, J.&nbsp;Palomaki, O.&nbsp;Redfield, M.&nbsp;Collins, A.&nbsp;Parikh, C.&nbsp;Alberti, D.&nbsp;Epstein, I.&nbsp;Polosukhin, M.&nbsp;Kelcey, J.&nbsp;Devlin, K.&nbsp;Lee, K.&nbsp;N. Toutanova, L.&nbsp;Jones, M.-W. Chang, A.&nbsp;Dai, J.&nbsp;Uszkoreit, Q.&nbsp;Le, and S.&nbsp;Petrov.

</span>
<span class="ltx_bibblock">Natural questions: a benchmark for question answering research.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association of Computational Linguistics</em>, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lai et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
G.&nbsp;Lai, Q.&nbsp;Xie, H.&nbsp;Liu, Y.&nbsp;Yang, and E.&nbsp;H. Hovy.

</span>
<span class="ltx_bibblock">RACE: large-scale reading comprehension dataset from examinations.

</span>
<span class="ltx_bibblock">In M.&nbsp;Palmer, R.&nbsp;Hwa, and S.&nbsp;Riedel, editors, <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing, EMNLP 2017, Copenhagen, Denmark, September 9-11, 2017</em>, pages 785–794. Association for Computational Linguistics, 2017.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/D17-1082" title="" class="ltx_ref">10.18653/V1/D17-1082</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/d17-1082" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/d17-1082</a>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lepikhin et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
D.&nbsp;Lepikhin, H.&nbsp;Lee, Y.&nbsp;Xu, D.&nbsp;Chen, O.&nbsp;Firat, Y.&nbsp;Huang, M.&nbsp;Krikun, N.&nbsp;Shazeer, and Z.&nbsp;Chen.

</span>
<span class="ltx_bibblock">Gshard: Scaling giant models with conditional computation and automatic sharding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations, ICLR 2021</em>. OpenReview.net, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=qrwe7XHTmYb" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=qrwe7XHTmYb</a>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
H.&nbsp;Li, Y.&nbsp;Zhang, F.&nbsp;Koto, Y.&nbsp;Yang, H.&nbsp;Zhao, Y.&nbsp;Gong, N.&nbsp;Duan, and T.&nbsp;Baldwin.

</span>
<span class="ltx_bibblock">CMMLU: Measuring massive multitask language understanding in Chinese.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.09212</em>, 2023.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
J.&nbsp;Lin, R.&nbsp;Men, A.&nbsp;Yang, C.&nbsp;Zhou, M.&nbsp;Ding, Y.&nbsp;Zhang, P.&nbsp;Wang, A.&nbsp;Wang, L.&nbsp;Jiang, X.&nbsp;Jia, J.&nbsp;Zhang, J.&nbsp;Zhang, X.&nbsp;Zou, Z.&nbsp;Li, X.&nbsp;Deng, J.&nbsp;Liu, J.&nbsp;Xue, H.&nbsp;Zhou, J.&nbsp;Ma, J.&nbsp;Yu, Y.&nbsp;Li, W.&nbsp;Lin, J.&nbsp;Zhou, J.&nbsp;Tang, and H.&nbsp;Yang.

</span>
<span class="ltx_bibblock">M6: A chinese multimodal pretrainer.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2103.00823, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2103.00823" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2103.00823</a>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
S.&nbsp;Lin, J.&nbsp;Hilton, and O.&nbsp;Evans.

</span>
<span class="ltx_bibblock">Truthfulqa: Measuring how models mimic human falsehoods.

</span>
<span class="ltx_bibblock">In S.&nbsp;Muresan, P.&nbsp;Nakov, and A.&nbsp;Villavicencio, editors, <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 3214–3252. Association for Computational Linguistics, 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2022.ACL-LONG.229" title="" class="ltx_ref">10.18653/V1/2022.ACL-LONG.229</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2022.acl-long.229" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2022.acl-long.229</a>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2019)</span>
<span class="ltx_bibblock">
I.&nbsp;Loshchilov and F.&nbsp;Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">7th International Conference on Learning Representations, ICLR 2019, New Orleans, LA, USA, May 6-9, 2019</em>. OpenReview.net, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=Bkg6RiCqY7" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=Bkg6RiCqY7</a>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayanan et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
D.&nbsp;Narayanan, M.&nbsp;Shoeybi, J.&nbsp;Casper, P.&nbsp;LeGresley, M.&nbsp;Patwary, V.&nbsp;Korthikanti, D.&nbsp;Vainbrand, P.&nbsp;Kashinkunti, J.&nbsp;Bernauer, B.&nbsp;Catanzaro, et&nbsp;al.

</span>
<span class="ltx_bibblock">Efficient large-scale language model training on gpu clusters using megatron-lm.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference for High Performance Computing, Networking, Storage and Analysis</em>, pages 1–15, 2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">GPT-4 technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2303.08774, 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/arXiv.2303.08774" title="" class="ltx_ref">10.48550/arXiv.2303.08774</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2303.08774" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2303.08774</a>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajbhandari et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
S.&nbsp;Rajbhandari, J.&nbsp;Rasley, O.&nbsp;Ruwase, and Y.&nbsp;He.

</span>
<span class="ltx_bibblock">Zero: memory optimizations toward training trillion parameter models.

</span>
<span class="ltx_bibblock">In C.&nbsp;Cuicchi, I.&nbsp;Qualters, and W.&nbsp;T. Kramer, editors, <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference for High Performance Computing, Networking, Storage and Analysis, SC 2020, Virtual Event / Atlanta, Georgia, USA, November 9-19, 2020</em>, page&nbsp;20. IEEE/ACM, 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.1109/SC41405.2020.00024" title="" class="ltx_ref">10.1109/SC41405.2020.00024</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1109/SC41405.2020.00024" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/SC41405.2020.00024</a>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajbhandari et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
S.&nbsp;Rajbhandari, C.&nbsp;Li, Z.&nbsp;Yao, M.&nbsp;Zhang, R.&nbsp;Y. Aminabadi, A.&nbsp;A. Awan, J.&nbsp;Rasley, and Y.&nbsp;He.

</span>
<span class="ltx_bibblock">Deepspeed-moe: Advancing mixture-of-experts inference and training to power next-generation AI scale.

</span>
<span class="ltx_bibblock">In K.&nbsp;Chaudhuri, S.&nbsp;Jegelka, L.&nbsp;Song, C.&nbsp;Szepesvári, G.&nbsp;Niu, and S.&nbsp;Sabato, editors, <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</em>, volume 162 of <em id="bib.bib40.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pages 18332–18346. PMLR, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v162/rajbhandari22a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v162/rajbhandari22a.html</a>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
X.&nbsp;Ren, P.&nbsp;Zhou, X.&nbsp;Meng, X.&nbsp;Huang, Y.&nbsp;Wang, W.&nbsp;Wang, P.&nbsp;Li, X.&nbsp;Zhang, A.&nbsp;Podolskiy, G.&nbsp;Arshinov, A.&nbsp;Bout, I.&nbsp;Piontkovskaya, J.&nbsp;Wei, X.&nbsp;Jiang, T.&nbsp;Su, Q.&nbsp;Liu, and J.&nbsp;Yao.

</span>
<span class="ltx_bibblock">Pangu-<math id="bib.bib41.1.m1.1" class="ltx_Math" alttext="\Sigma" display="inline"><semantics id="bib.bib41.1.m1.1a"><mi mathvariant="normal" id="bib.bib41.1.m1.1.1" xref="bib.bib41.1.m1.1.1.cmml">Σ</mi><annotation-xml encoding="MathML-Content" id="bib.bib41.1.m1.1b"><ci id="bib.bib41.1.m1.1.1.cmml" xref="bib.bib41.1.m1.1.1">Σ</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib41.1.m1.1c">\Sigma</annotation></semantics></math>: Towards trillion parameter language model with sparse heterogeneous computing.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.2.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2303.10845, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2303.10845" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2303.10845</a>.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roller et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
S.&nbsp;Roller, S.&nbsp;Sukhbaatar, A.&nbsp;Szlam, and J.&nbsp;Weston.

</span>
<span class="ltx_bibblock">Hash layers for large sparse models.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2106.04426, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2106.04426" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2106.04426</a>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakaguchi et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
K.&nbsp;Sakaguchi, R.&nbsp;L. Bras, C.&nbsp;Bhagavatula, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">Winogrande: An adversarial winograd schema challenge at scale, 2019.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Scao et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
T.&nbsp;L. Scao, A.&nbsp;Fan, C.&nbsp;Akiki, E.&nbsp;Pavlick, S.&nbsp;Ilic, D.&nbsp;Hesslow, R.&nbsp;Castagné, A.&nbsp;S. Luccioni, F.&nbsp;Yvon, M.&nbsp;Gallé, J.&nbsp;Tow, A.&nbsp;M. Rush, S.&nbsp;Biderman, A.&nbsp;Webson, P.&nbsp;S. Ammanamanchi, T.&nbsp;Wang, B.&nbsp;Sagot, N.&nbsp;Muennighoff, A.&nbsp;V. del Moral, O.&nbsp;Ruwase, R.&nbsp;Bawden, S.&nbsp;Bekman, A.&nbsp;McMillan-Major, I.&nbsp;Beltagy, H.&nbsp;Nguyen, L.&nbsp;Saulnier, S.&nbsp;Tan, P.&nbsp;O. Suarez, V.&nbsp;Sanh, H.&nbsp;Laurençon, Y.&nbsp;Jernite, J.&nbsp;Launay, M.&nbsp;Mitchell, C.&nbsp;Raffel, A.&nbsp;Gokaslan, A.&nbsp;Simhi, A.&nbsp;Soroa, A.&nbsp;F. Aji, A.&nbsp;Alfassy, A.&nbsp;Rogers, A.&nbsp;K. Nitzav, C.&nbsp;Xu, C.&nbsp;Mou, C.&nbsp;Emezue, C.&nbsp;Klamm, C.&nbsp;Leong, D.&nbsp;van Strien, D.&nbsp;I. Adelani, and et&nbsp;al.

</span>
<span class="ltx_bibblock">BLOOM: A 176b-parameter open-access multilingual language model.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2211.05100, 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/ARXIV.2211.05100" title="" class="ltx_ref">10.48550/ARXIV.2211.05100</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2211.05100" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2211.05100</a>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et&nbsp;al. (2016)</span>
<span class="ltx_bibblock">
R.&nbsp;Sennrich, B.&nbsp;Haddow, and A.&nbsp;Birch.

</span>
<span class="ltx_bibblock">Neural machine translation of rare words with subword units.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics, ACL 2016, August 7-12, 2016, Berlin, Germany, Volume 1: Long Papers</em>. The Association for Computer Linguistics, 2016.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/P16-1162" title="" class="ltx_ref">10.18653/V1/P16-1162</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/p16-1162" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/p16-1162</a>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2019)</span>
<span class="ltx_bibblock">
N.&nbsp;Shazeer.

</span>
<span class="ltx_bibblock">Fast transformer decoding: One write-head is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1911.02150, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1911.02150" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1911.02150</a>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
N.&nbsp;Shazeer, A.&nbsp;Mirhoseini, K.&nbsp;Maziarz, A.&nbsp;Davis, Q.&nbsp;V. Le, G.&nbsp;E. Hinton, and J.&nbsp;Dean.

</span>
<span class="ltx_bibblock">Outrageously large neural networks: The sparsely-gated mixture-of-experts layer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">5th International Conference on Learning Representations, ICLR 2017</em>. OpenReview.net, 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=B1ckMDqlg" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=B1ckMDqlg</a>.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
S.&nbsp;Shen, L.&nbsp;Hou, Y.&nbsp;Zhou, N.&nbsp;Du, S.&nbsp;Longpre, J.&nbsp;Wei, H.&nbsp;W. Chung, B.&nbsp;Zoph, W.&nbsp;Fedus, X.&nbsp;Chen, T.&nbsp;Vu, Y.&nbsp;Wu, W.&nbsp;Chen, A.&nbsp;Webson, Y.&nbsp;Li, V.&nbsp;Zhao, H.&nbsp;Yu, K.&nbsp;Keutzer, T.&nbsp;Darrell, and D.&nbsp;Zhou.

</span>
<span class="ltx_bibblock">Flan-moe: Scaling instruction-finetuned language models with sparse mixture of experts.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2305.14705, 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/ARXIV.2305.14705" title="" class="ltx_ref">10.48550/ARXIV.2305.14705</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2305.14705" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2305.14705</a>.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shoeybi et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
M.&nbsp;Shoeybi, M.&nbsp;Patwary, R.&nbsp;Puri, P.&nbsp;LeGresley, J.&nbsp;Casper, and B.&nbsp;Catanzaro.

</span>
<span class="ltx_bibblock">Megatron-lm: Training multi-billion parameter language models using model parallelism.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.08053</em>, 2019.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suzgun et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
M.&nbsp;Suzgun, N.&nbsp;Scales, N.&nbsp;Schärli, S.&nbsp;Gehrmann, Y.&nbsp;Tay, H.&nbsp;W. Chung, A.&nbsp;Chowdhery, Q.&nbsp;V. Le, E.&nbsp;H. Chi, D.&nbsp;Zhou, et&nbsp;al.

</span>
<span class="ltx_bibblock">Challenging big-bench tasks and whether chain-of-thought can solve them.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.09261</em>, 2022.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tillet et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
P.&nbsp;Tillet, H.&nbsp;T. Kung, and D.&nbsp;Cox.

</span>
<span class="ltx_bibblock">Triton: An intermediate language and compiler for tiled neural network computations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 3rd ACM SIGPLAN International Workshop on Machine Learning and Programming Languages</em>, MAPL 2019, page 10–19, New York, NY, USA, 2019. Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450367196.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.1145/3315508.3329973" title="" class="ltx_ref">10.1145/3315508.3329973</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1145/3315508.3329973" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3315508.3329973</a>.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Together-AI (2023)</span>
<span class="ltx_bibblock">
Together-AI.

</span>
<span class="ltx_bibblock">Redpajama-data: An open source recipe to reproduce llama training dataset, April 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://github.com/togethercomputer/RedPajama-Data" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/togethercomputer/RedPajama-Data</a>.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
H.&nbsp;Touvron, T.&nbsp;Lavril, G.&nbsp;Izacard, X.&nbsp;Martinet, M.&nbsp;Lachaux, T.&nbsp;Lacroix, B.&nbsp;Rozière, N.&nbsp;Goyal, E.&nbsp;Hambro, F.&nbsp;Azhar, A.&nbsp;Rodriguez, A.&nbsp;Joulin, E.&nbsp;Grave, and G.&nbsp;Lample.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2302.13971, 2023a.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/arXiv.2302.13971" title="" class="ltx_ref">10.48550/arXiv.2302.13971</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2302.13971" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2302.13971</a>.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
H.&nbsp;Touvron, L.&nbsp;Martin, K.&nbsp;Stone, P.&nbsp;Albert, A.&nbsp;Almahairi, Y.&nbsp;Babaei, N.&nbsp;Bashlykov, S.&nbsp;Batra, P.&nbsp;Bhargava, S.&nbsp;Bhosale, D.&nbsp;Bikel, L.&nbsp;Blecher, C.&nbsp;Canton-Ferrer, M.&nbsp;Chen, G.&nbsp;Cucurull, D.&nbsp;Esiobu, J.&nbsp;Fernandes, J.&nbsp;Fu, W.&nbsp;Fu, B.&nbsp;Fuller, C.&nbsp;Gao, V.&nbsp;Goswami, N.&nbsp;Goyal, A.&nbsp;Hartshorn, S.&nbsp;Hosseini, R.&nbsp;Hou, H.&nbsp;Inan, M.&nbsp;Kardas, V.&nbsp;Kerkez, M.&nbsp;Khabsa, I.&nbsp;Kloumann, A.&nbsp;Korenev, P.&nbsp;S. Koura, M.&nbsp;Lachaux, T.&nbsp;Lavril, J.&nbsp;Lee, D.&nbsp;Liskovich, Y.&nbsp;Lu, Y.&nbsp;Mao, X.&nbsp;Martinet, T.&nbsp;Mihaylov, P.&nbsp;Mishra, I.&nbsp;Molybog, Y.&nbsp;Nie, A.&nbsp;Poulton, J.&nbsp;Reizenstein, R.&nbsp;Rungta, K.&nbsp;Saladi, A.&nbsp;Schelten, R.&nbsp;Silva, E.&nbsp;M. Smith, R.&nbsp;Subramanian, X.&nbsp;E. Tan, B.&nbsp;Tang, R.&nbsp;Taylor, A.&nbsp;Williams, J.&nbsp;X. Kuan, P.&nbsp;Xu, Z.&nbsp;Yan, I.&nbsp;Zarov, Y.&nbsp;Zhang, A.&nbsp;Fan, M.&nbsp;Kambadur, S.&nbsp;Narang, A.&nbsp;Rodriguez, R.&nbsp;Stojnic, S.&nbsp;Edunov, and T.&nbsp;Scialom.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2307.09288, 2023b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/arXiv.2307.09288" title="" class="ltx_ref">10.48550/arXiv.2307.09288</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2307.09288" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2307.09288</a>.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
A.&nbsp;Vaswani, N.&nbsp;Shazeer, N.&nbsp;Parmar, J.&nbsp;Uszkoreit, L.&nbsp;Jones, A.&nbsp;N. Gomez, L.&nbsp;Kaiser, and I.&nbsp;Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 30: Annual Conference on Neural Information Processing Systems 2017</em>, pages 5998–6008, 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html</a>.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Komatsuzaki (2021)</span>
<span class="ltx_bibblock">
B.&nbsp;Wang and A.&nbsp;Komatsuzaki.

</span>
<span class="ltx_bibblock">GPT-J-6B: A 6 Billion Parameter Autoregressive Language Model.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/kingoflolz/mesh-transformer-jax" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/kingoflolz/mesh-transformer-jax</a>, May 2021.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
L.&nbsp;Xu, H.&nbsp;Hu, X.&nbsp;Zhang, L.&nbsp;Li, C.&nbsp;Cao, Y.&nbsp;Li, Y.&nbsp;Xu, K.&nbsp;Sun, D.&nbsp;Yu, C.&nbsp;Yu, Y.&nbsp;Tian, Q.&nbsp;Dong, W.&nbsp;Liu, B.&nbsp;Shi, Y.&nbsp;Cui, J.&nbsp;Li, J.&nbsp;Zeng, R.&nbsp;Wang, W.&nbsp;Xie, Y.&nbsp;Li, Y.&nbsp;Patterson, Z.&nbsp;Tian, Y.&nbsp;Zhang, H.&nbsp;Zhou, S.&nbsp;Liu, Z.&nbsp;Zhao, Q.&nbsp;Zhao, C.&nbsp;Yue, X.&nbsp;Zhang, Z.&nbsp;Yang, K.&nbsp;Richardson, and Z.&nbsp;Lan.

</span>
<span class="ltx_bibblock">CLUE: A chinese language understanding evaluation benchmark.

</span>
<span class="ltx_bibblock">In D.&nbsp;Scott, N.&nbsp;Bel, and C.&nbsp;Zong, editors, <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 28th International Conference on Computational Linguistics, COLING 2020, Barcelona, Spain (Online), December 8-13, 2020</em>, pages 4762–4772. International Committee on Computational Linguistics, 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2020.COLING-MAIN.419" title="" class="ltx_ref">10.18653/V1/2020.COLING-MAIN.419</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2020.coling-main.419" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2020.coling-main.419</a>.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xue et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
F.&nbsp;Xue, Z.&nbsp;Zheng, Y.&nbsp;Fu, J.&nbsp;Ni, Z.&nbsp;Zheng, W.&nbsp;Zhou, and Y.&nbsp;You.

</span>
<span class="ltx_bibblock">Openmoe: Open mixture-of-experts language models.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/XueFuzhao/OpenMoE" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/XueFuzhao/OpenMoE</a>, 2023.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
R.&nbsp;Zellers, A.&nbsp;Holtzman, Y.&nbsp;Bisk, A.&nbsp;Farhadi, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">HellaSwag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock">In A.&nbsp;Korhonen, D.&nbsp;R. Traum, and L.&nbsp;Màrquez, editors, <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 57th Conference of the Association for Computational Linguistics, ACL 2019, Florence, Italy, July 28- August 2, 2019, Volume 1: Long Papers</em>, pages 4791–4800. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/v1/p19-1472" title="" class="ltx_ref">10.18653/v1/p19-1472</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/p19-1472" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/p19-1472</a>.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
S.&nbsp;Zhang, S.&nbsp;Roller, N.&nbsp;Goyal, M.&nbsp;Artetxe, M.&nbsp;Chen, S.&nbsp;Chen, C.&nbsp;Dewan, M.&nbsp;Diab, X.&nbsp;Li, X.&nbsp;V. Lin, T.&nbsp;Mihaylov, M.&nbsp;Ott, S.&nbsp;Shleifer, K.&nbsp;Shuster, D.&nbsp;Simig, P.&nbsp;S. Koura, A.&nbsp;Sridhar, T.&nbsp;Wang, and L.&nbsp;Zettlemoyer.

</span>
<span class="ltx_bibblock">Opt: Open pre-trained transformer language models, 2022.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
C.&nbsp;Zheng, M.&nbsp;Huang, and A.&nbsp;Sun.

</span>
<span class="ltx_bibblock">Chid: A large-scale chinese idiom dataset for cloze test.

</span>
<span class="ltx_bibblock">In A.&nbsp;Korhonen, D.&nbsp;R. Traum, and L.&nbsp;Màrquez, editors, <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 57th Conference of the Association for Computational Linguistics, ACL 2019, Florence, Italy, July 28- August 2, 2019, Volume 1: Long Papers</em>, pages 778–787. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/P19-1075" title="" class="ltx_ref">10.18653/V1/P19-1075</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/p19-1075" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/p19-1075</a>.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Y.&nbsp;Zhou, T.&nbsp;Lei, H.&nbsp;Liu, N.&nbsp;Du, Y.&nbsp;Huang, V.&nbsp;Zhao, A.&nbsp;M. Dai, Z.&nbsp;Chen, Q.&nbsp;V. Le, and J.&nbsp;Laudon.

</span>
<span class="ltx_bibblock">Mixture-of-experts with expert choice routing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://papers.nips.cc/paper_files/paper/2022/hash/2f00ecd787b432c1d36f3de9800728eb-Abstract-Conference.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://papers.nips.cc/paper_files/paper/2022/hash/2f00ecd787b432c1d36f3de9800728eb-Abstract-Conference.html</a>.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zoph (2022)</span>
<span class="ltx_bibblock">
B.&nbsp;Zoph.

</span>
<span class="ltx_bibblock">Designing effective sparse expert models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">IEEE International Parallel and Distributed Processing Symposium, IPDPS Workshops 2022, Lyon, France, May 30 - June 3, 2022</em>, page 1044. IEEE, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1109/IPDPSW55747.2022.00171" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/IPDPSW55747.2022.00171</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Ax1" class="ltx_appendix" lang="en">
<h2 class="ltx_title ltx_title_appendix">Appendices</h2>

</section>
<section id="A1" class="ltx_appendix" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Overview of Hyper-Parameters</h2>

<div id="A1.p1" class="ltx_para">
<p class="ltx_p" id="A1.p1.1">우리는 표 <a class="ltx_ref" href="#A1.T7" title="Table 7 ‣ Appendix A Overview of Hyper-Parameters ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>에서 다양한 크기에 걸쳐 DeepSeekMoE에 대한 하이퍼-파라미터의 개요를 제시한다.</p>
</div>
<figure id="A1.T7" class="ltx_table">
<table id="A1.T7.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T7.1.1.1" class="ltx_tr">
<th id="A1.T7.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.1.1" class="ltx_text" style="font-size:80%;"># Params</span></th>
<th id="A1.T7.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.2.1" class="ltx_text" style="font-size:80%;"># Layers</span></th>
<th id="A1.T7.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.3.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.3.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Hidden</span></span>
<span id="A1.T7.1.1.1.3.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Size</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.4.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.4.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"># Attn</span></span>
<span id="A1.T7.1.1.1.4.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Heads</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.5.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.5.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.5.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.5.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"># Shared</span></span>
<span id="A1.T7.1.1.1.5.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.5.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Experts</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.6.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.6.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.6.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.6.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"># Routed</span></span>
<span id="A1.T7.1.1.1.6.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.6.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Experts</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.7.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.7.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.7.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.7.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Relative</span></span>
<span id="A1.T7.1.1.1.7.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.7.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Expert Size</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.8.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.8.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.8.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.8.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Sequence</span></span>
<span id="A1.T7.1.1.1.8.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.8.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Length</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.9.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.9.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.9.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.9.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Batch Size</span></span>
<span id="A1.T7.1.1.1.9.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.9.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">(Sequence)</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.10.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.10.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.10.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.10.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Learning</span></span>
<span id="A1.T7.1.1.1.10.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.10.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Rate</span></span>
</span></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T7.1.2.1" class="ltx_tr">
<td id="A1.T7.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.1.1" class="ltx_text" style="font-size:80%;">&nbsp;&nbsp;&nbsp;&nbsp;2.0B</span></td>
<td id="A1.T7.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.2.1" class="ltx_text" style="font-size:80%;">9</span></td>
<td id="A1.T7.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.3.1" class="ltx_text" style="font-size:80%;">1280</span></td>
<td id="A1.T7.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.4.1" class="ltx_text" style="font-size:80%;">10</span></td>
<td id="A1.T7.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.5.1" class="ltx_text" style="font-size:80%;">1</span></td>
<td id="A1.T7.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.6.1" class="ltx_text" style="font-size:80%;">63 (7 activated)</span></td>
<td id="A1.T7.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.7.1" class="ltx_text" style="font-size:80%;">0.25</span></td>
<td id="A1.T7.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.8.1" class="ltx_text" style="font-size:80%;">2048</span></td>
<td id="A1.T7.1.2.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.9.1" class="ltx_text" style="font-size:80%;">2048</span></td>
<td id="A1.T7.1.2.1.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.10.1" class="ltx_text" style="font-size:80%;">1.08e-3</span></td>
</tr>
<tr id="A1.T7.1.3.2" class="ltx_tr">
<td id="A1.T7.1.3.2.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.1.1" class="ltx_text" style="font-size:80%;">&nbsp;&nbsp;16.4B</span></td>
<td id="A1.T7.1.3.2.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.2.1" class="ltx_text" style="font-size:80%;">28</span></td>
<td id="A1.T7.1.3.2.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.3.1" class="ltx_text" style="font-size:80%;">2048</span></td>
<td id="A1.T7.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.4.1" class="ltx_text" style="font-size:80%;">16</span></td>
<td id="A1.T7.1.3.2.5" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.5.1" class="ltx_text" style="font-size:80%;">2</span></td>
<td id="A1.T7.1.3.2.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.6.1" class="ltx_text" style="font-size:80%;">64 (6 activated)</span></td>
<td id="A1.T7.1.3.2.7" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.7.1" class="ltx_text" style="font-size:80%;">0.25</span></td>
<td id="A1.T7.1.3.2.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.8.1" class="ltx_text" style="font-size:80%;">4096</span></td>
<td id="A1.T7.1.3.2.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.9.1" class="ltx_text" style="font-size:80%;">4608</span></td>
<td id="A1.T7.1.3.2.10" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.10.1" class="ltx_text" style="font-size:80%;">&nbsp;&nbsp;4.2e-4</span></td>
</tr>
<tr id="A1.T7.1.4.3" class="ltx_tr">
<td id="A1.T7.1.4.3.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.1.1" class="ltx_text" style="font-size:80%;">144.6B</span></td>
<td id="A1.T7.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.2.1" class="ltx_text" style="font-size:80%;">62</span></td>
<td id="A1.T7.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.3.1" class="ltx_text" style="font-size:80%;">4096</span></td>
<td id="A1.T7.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.4.1" class="ltx_text" style="font-size:80%;">32</span></td>
<td id="A1.T7.1.4.3.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.5.1" class="ltx_text" style="font-size:80%;">4</span></td>
<td id="A1.T7.1.4.3.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.6.1" class="ltx_text" style="font-size:80%;">128 (12 activated)</span></td>
<td id="A1.T7.1.4.3.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.7.1" class="ltx_text" style="font-size:80%;">0.125</span></td>
<td id="A1.T7.1.4.3.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.8.1" class="ltx_text" style="font-size:80%;">4096</span></td>
<td id="A1.T7.1.4.3.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.9.1" class="ltx_text" style="font-size:80%;">4608</span></td>
<td id="A1.T7.1.4.3.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.10.1" class="ltx_text" style="font-size:80%;">&nbsp;&nbsp;3.0e-4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 7: </span>
Overview of hyper-parameters for DeepSeekMoE across various sizes.
The relative expert size is in comparison to a standard FFN.
</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Comparing DeepSeekMoE with Larger Models</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.4" class="ltx_p">Comparisons among DeepSeekMoE, GShard<math id="A2.p1.1.m1.1" class="ltx_Math" alttext="\times 1.2" display="inline"><semantics id="A2.p1.1.m1.1a"><mrow id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mi id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.p1.1.m1.1.1.1" xref="A2.p1.1.m1.1.1.1.cmml">×</mo><mn id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><times id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.p1.1.m1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">\times 1.2</annotation></semantics></math>, and GShard<math id="A2.p1.2.m2.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="A2.p1.2.m2.1a"><mrow id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mi id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.p1.2.m2.1.1.1" xref="A2.p1.2.m2.1.1.1.cmml">×</mo><mn id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><times id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2">absent</csymbol><cn type="float" id="A2.p1.2.m2.1.1.3.cmml" xref="A2.p1.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">\times 1.5</annotation></semantics></math> are shown in Table&nbsp;<a href="#A2.T8" title="Table 8 ‣ Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. Comparisons among DeepSeekMoE, Dense<math id="A2.p1.3.m3.1" class="ltx_Math" alttext="\times 4" display="inline"><semantics id="A2.p1.3.m3.1a"><mrow id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml"><mi id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.p1.3.m3.1.1.1" xref="A2.p1.3.m3.1.1.1.cmml">×</mo><mn id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1"><times id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1.1"></times><csymbol cd="latexml" id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2">absent</csymbol><cn type="integer" id="A2.p1.3.m3.1.1.3.cmml" xref="A2.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">\times 4</annotation></semantics></math>, and Dense<math id="A2.p1.4.m4.1" class="ltx_Math" alttext="\times 16" display="inline"><semantics id="A2.p1.4.m4.1a"><mrow id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml"><mi id="A2.p1.4.m4.1.1.2" xref="A2.p1.4.m4.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.p1.4.m4.1.1.1" xref="A2.p1.4.m4.1.1.1.cmml">×</mo><mn id="A2.p1.4.m4.1.1.3" xref="A2.p1.4.m4.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><apply id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1"><times id="A2.p1.4.m4.1.1.1.cmml" xref="A2.p1.4.m4.1.1.1"></times><csymbol cd="latexml" id="A2.p1.4.m4.1.1.2.cmml" xref="A2.p1.4.m4.1.1.2">absent</csymbol><cn type="integer" id="A2.p1.4.m4.1.1.3.cmml" xref="A2.p1.4.m4.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">\times 16</annotation></semantics></math> are shown in Table&nbsp;<a href="#A2.T9" title="Table 9 ‣ Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<figure id="A2.T8" class="ltx_table">
<table id="A2.T8.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T8.2.2" class="ltx_tr">
<th id="A2.T8.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.2.3.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="A2.T8.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.2.4.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="A2.T8.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.1.1.1.1" class="ltx_text ltx_font_bold">GShard<math id="A2.T8.1.1.1.1.m1.1" class="ltx_Math" alttext="\times 1.2" display="inline"><semantics id="A2.T8.1.1.1.1.m1.1a"><mrow id="A2.T8.1.1.1.1.m1.1.1" xref="A2.T8.1.1.1.1.m1.1.1.cmml"><mi id="A2.T8.1.1.1.1.m1.1.1.2" xref="A2.T8.1.1.1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T8.1.1.1.1.m1.1.1.1" xref="A2.T8.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A2.T8.1.1.1.1.m1.1.1.3" xref="A2.T8.1.1.1.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T8.1.1.1.1.m1.1b"><apply id="A2.T8.1.1.1.1.m1.1.1.cmml" xref="A2.T8.1.1.1.1.m1.1.1"><times id="A2.T8.1.1.1.1.m1.1.1.1.cmml" xref="A2.T8.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T8.1.1.1.1.m1.1.1.2.cmml" xref="A2.T8.1.1.1.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.T8.1.1.1.1.m1.1.1.3.cmml" xref="A2.T8.1.1.1.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T8.1.1.1.1.m1.1c">\times 1.2</annotation></semantics></math></span></td>
<td id="A2.T8.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.2.2.1" class="ltx_text ltx_font_bold">GShard<math id="A2.T8.2.2.2.1.m1.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="A2.T8.2.2.2.1.m1.1a"><mrow id="A2.T8.2.2.2.1.m1.1.1" xref="A2.T8.2.2.2.1.m1.1.1.cmml"><mi id="A2.T8.2.2.2.1.m1.1.1.2" xref="A2.T8.2.2.2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T8.2.2.2.1.m1.1.1.1" xref="A2.T8.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A2.T8.2.2.2.1.m1.1.1.3" xref="A2.T8.2.2.2.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T8.2.2.2.1.m1.1b"><apply id="A2.T8.2.2.2.1.m1.1.1.cmml" xref="A2.T8.2.2.2.1.m1.1.1"><times id="A2.T8.2.2.2.1.m1.1.1.1.cmml" xref="A2.T8.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T8.2.2.2.1.m1.1.1.2.cmml" xref="A2.T8.2.2.2.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.T8.2.2.2.1.m1.1.1.3.cmml" xref="A2.T8.2.2.2.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T8.2.2.2.1.m1.1c">\times 1.5</annotation></semantics></math></span></td>
<td id="A2.T8.2.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.2.5.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="A2.T8.2.3.1" class="ltx_tr">
<th id="A2.T8.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th id="A2.T8.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.2</td>
<td id="A2.T8.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.5</td>
<td id="A2.T8.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr id="A2.T8.2.4.2" class="ltx_tr">
<th id="A2.T8.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th id="A2.T8.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.4.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="A2.T8.2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="A2.T8.2.4.2.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr id="A2.T8.2.5.3" class="ltx_tr">
<th id="A2.T8.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th id="A2.T8.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.5.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="A2.T8.2.5.3.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="A2.T8.2.5.3.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr id="A2.T8.2.6.4" class="ltx_tr">
<th id="A2.T8.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th id="A2.T8.2.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.6.4.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.3B</td>
<td id="A2.T8.2.6.4.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.8B</td>
<td id="A2.T8.2.6.4.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.9B</td>
</tr>
<tr id="A2.T8.2.7.5" class="ltx_tr">
<th id="A2.T8.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th id="A2.T8.2.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.7.5.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.28B</td>
<td id="A2.T8.2.7.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.35B</td>
<td id="A2.T8.2.7.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.24B</td>
</tr>
<tr id="A2.T8.2.8.6" class="ltx_tr">
<th id="A2.T8.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th id="A2.T8.2.8.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.8.6.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T8.2.8.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T8.2.8.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr id="A2.T8.2.9.7" class="ltx_tr">
<th id="A2.T8.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Pile&nbsp;(Loss)</th>
<th id="A2.T8.2.9.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.9.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.824</td>
<td id="A2.T8.2.9.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.9.7.4.1" class="ltx_text ltx_font_bold">1.808</span></td>
<td id="A2.T8.2.9.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.9.7.5.1" class="ltx_text ltx_font_bold">1.808</span></td>
</tr>
<tr id="A2.T8.2.10.8" class="ltx_tr">
<th id="A2.T8.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="A2.T8.2.10.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.10.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">53.7</td>
<td id="A2.T8.2.10.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">54.4</td>
<td id="A2.T8.2.10.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.10.8.5.1" class="ltx_text ltx_font_bold">54.8</span></td>
</tr>
<tr id="A2.T8.2.11.9" class="ltx_tr">
<th id="A2.T8.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="A2.T8.2.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.11.9.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.8</td>
<td id="A2.T8.2.11.9.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.1</td>
<td id="A2.T8.2.11.9.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.11.9.5.1" class="ltx_text ltx_font_bold">72.3</span></td>
</tr>
<tr id="A2.T8.2.12.10" class="ltx_tr">
<th id="A2.T8.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="A2.T8.2.12.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.12.10.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">46.8</td>
<td id="A2.T8.2.12.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">47.3</td>
<td id="A2.T8.2.12.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.12.10.5.1" class="ltx_text ltx_font_bold">49.4</span></td>
</tr>
<tr id="A2.T8.2.13.11" class="ltx_tr">
<th id="A2.T8.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="A2.T8.2.13.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.13.11.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
<td id="A2.T8.2.13.11.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.13.11.4.1" class="ltx_text ltx_font_bold">34.1</span></td>
<td id="A2.T8.2.13.11.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.13.11.5.1" class="ltx_text ltx_font_bold">34.3</span></td>
</tr>
<tr id="A2.T8.2.14.12" class="ltx_tr">
<th id="A2.T8.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="A2.T8.2.14.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T8.2.14.12.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">43.7</td>
<td id="A2.T8.2.14.12.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.14.12.4.1" class="ltx_text ltx_font_bold">46.4</span></td>
<td id="A2.T8.2.14.12.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">44.0</td>
</tr>
<tr id="A2.T8.2.15.13" class="ltx_tr">
<th id="A2.T8.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="A2.T8.2.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T8.2.15.13.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.9</td>
<td id="A2.T8.2.15.13.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.15.13.4.1" class="ltx_text ltx_font_bold">32.4</span></td>
<td id="A2.T8.2.15.13.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
</tr>
<tr id="A2.T8.2.16.14" class="ltx_tr">
<th id="A2.T8.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="A2.T8.2.16.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.16.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">3.7</td>
<td id="A2.T8.2.16.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">3.0</td>
<td id="A2.T8.2.16.14.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.16.14.5.1" class="ltx_text ltx_font_bold">4.9</span></td>
</tr>
<tr id="A2.T8.2.17.15" class="ltx_tr">
<th id="A2.T8.2.17.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="A2.T8.2.17.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td id="A2.T8.2.17.15.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.4</td>
<td id="A2.T8.2.17.15.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.17.15.4.1" class="ltx_text ltx_font_bold">2.6</span></td>
<td id="A2.T8.2.17.15.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.2</td>
</tr>
<tr id="A2.T8.2.18.16" class="ltx_tr">
<th id="A2.T8.2.18.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="A2.T8.2.18.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T8.2.18.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">15.2</td>
<td id="A2.T8.2.18.16.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">15.7</td>
<td id="A2.T8.2.18.16.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.18.16.5.1" class="ltx_text ltx_font_bold">16.6</span></td>
</tr>
<tr id="A2.T8.2.19.17" class="ltx_tr">
<th id="A2.T8.2.19.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="A2.T8.2.19.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T8.2.19.17.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">4.5</td>
<td id="A2.T8.2.19.17.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">4.7</td>
<td id="A2.T8.2.19.17.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.19.17.5.1" class="ltx_text ltx_font_bold">5.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8:</span></figcaption>
Comparison between DeepSeekMoE and larger GShard models.
</figcaption>
</figure>
<figure id="A2.T9" class="ltx_table">
<table id="A2.T9.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T9.2.2" class="ltx_tr">
<th id="A2.T9.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.2.3.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="A2.T9.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.2.4.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="A2.T9.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.1.1.1.1" class="ltx_text ltx_font_bold">Dense<math id="A2.T9.1.1.1.1.m1.1" class="ltx_Math" alttext="\times 4" display="inline"><semantics id="A2.T9.1.1.1.1.m1.1a"><mrow id="A2.T9.1.1.1.1.m1.1.1" xref="A2.T9.1.1.1.1.m1.1.1.cmml"><mi id="A2.T9.1.1.1.1.m1.1.1.2" xref="A2.T9.1.1.1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T9.1.1.1.1.m1.1.1.1" xref="A2.T9.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A2.T9.1.1.1.1.m1.1.1.3" xref="A2.T9.1.1.1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.1.1.1.1.m1.1b"><apply id="A2.T9.1.1.1.1.m1.1.1.cmml" xref="A2.T9.1.1.1.1.m1.1.1"><times id="A2.T9.1.1.1.1.m1.1.1.1.cmml" xref="A2.T9.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T9.1.1.1.1.m1.1.1.2.cmml" xref="A2.T9.1.1.1.1.m1.1.1.2">absent</csymbol><cn type="integer" id="A2.T9.1.1.1.1.m1.1.1.3.cmml" xref="A2.T9.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.1.1.1.1.m1.1c">\times 4</annotation></semantics></math></span></td>
<td id="A2.T9.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.2.2.1" class="ltx_text ltx_font_bold">Dense<math id="A2.T9.2.2.2.1.m1.1" class="ltx_Math" alttext="\times 16" display="inline"><semantics id="A2.T9.2.2.2.1.m1.1a"><mrow id="A2.T9.2.2.2.1.m1.1.1" xref="A2.T9.2.2.2.1.m1.1.1.cmml"><mi id="A2.T9.2.2.2.1.m1.1.1.2" xref="A2.T9.2.2.2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T9.2.2.2.1.m1.1.1.1" xref="A2.T9.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A2.T9.2.2.2.1.m1.1.1.3" xref="A2.T9.2.2.2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.2.2.2.1.m1.1b"><apply id="A2.T9.2.2.2.1.m1.1.1.cmml" xref="A2.T9.2.2.2.1.m1.1.1"><times id="A2.T9.2.2.2.1.m1.1.1.1.cmml" xref="A2.T9.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T9.2.2.2.1.m1.1.1.2.cmml" xref="A2.T9.2.2.2.1.m1.1.1.2">absent</csymbol><cn type="integer" id="A2.T9.2.2.2.1.m1.1.1.3.cmml" xref="A2.T9.2.2.2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.2.2.2.1.m1.1c">\times 16</annotation></semantics></math></span></td>
<td id="A2.T9.2.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.2.5.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="A2.T9.2.3.1" class="ltx_tr">
<th id="A2.T9.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th id="A2.T9.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1</td>
<td id="A2.T9.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1</td>
<td id="A2.T9.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr id="A2.T9.2.4.2" class="ltx_tr">
<th id="A2.T9.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th id="A2.T9.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.4.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">4 + 0</td>
<td id="A2.T9.2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td id="A2.T9.2.4.2.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr id="A2.T9.2.5.3" class="ltx_tr">
<th id="A2.T9.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th id="A2.T9.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.5.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">4 + 0</td>
<td id="A2.T9.2.5.3.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td id="A2.T9.2.5.3.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr id="A2.T9.2.6.4" class="ltx_tr">
<th id="A2.T9.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th id="A2.T9.2.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.6.4.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.47B</td>
<td id="A2.T9.2.6.4.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td id="A2.T9.2.6.4.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
</tr>
<tr id="A2.T9.2.7.5" class="ltx_tr">
<th id="A2.T9.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th id="A2.T9.2.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.7.5.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.47B</td>
<td id="A2.T9.2.7.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td id="A2.T9.2.7.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.24B</td>
</tr>
<tr id="A2.T9.2.8.6" class="ltx_tr">
<th id="A2.T9.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th id="A2.T9.2.8.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.8.6.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T9.2.8.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T9.2.8.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr id="A2.T9.2.9.7" class="ltx_tr">
<th id="A2.T9.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Pile&nbsp;(Loss)</th>
<th id="A2.T9.2.9.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.9.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.908</td>
<td id="A2.T9.2.9.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.9.7.4.1" class="ltx_text ltx_font_bold">1.806</span></td>
<td id="A2.T9.2.9.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.9.7.5.1" class="ltx_text ltx_font_bold">1.808</span></td>
</tr>
<tr id="A2.T9.2.10.8" class="ltx_tr">
<th id="A2.T9.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="A2.T9.2.10.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.10.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">47.6</td>
<td id="A2.T9.2.10.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.10.8.4.1" class="ltx_text ltx_font_bold">55.1</span></td>
<td id="A2.T9.2.10.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.10.8.5.1" class="ltx_text ltx_font_bold">54.8</span></td>
</tr>
<tr id="A2.T9.2.11.9" class="ltx_tr">
<th id="A2.T9.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="A2.T9.2.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.11.9.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">70.0</td>
<td id="A2.T9.2.11.9.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.9</td>
<td id="A2.T9.2.11.9.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.11.9.5.1" class="ltx_text ltx_font_bold">72.3</span></td>
</tr>
<tr id="A2.T9.2.12.10" class="ltx_tr">
<th id="A2.T9.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="A2.T9.2.12.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.12.10.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">43.9</td>
<td id="A2.T9.2.12.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.12.10.4.1" class="ltx_text ltx_font_bold">51.9</span></td>
<td id="A2.T9.2.12.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">49.4</td>
</tr>
<tr id="A2.T9.2.13.11" class="ltx_tr">
<th id="A2.T9.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="A2.T9.2.13.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.13.11.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">30.5</td>
<td id="A2.T9.2.13.11.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">33.8</td>
<td id="A2.T9.2.13.11.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.13.11.5.1" class="ltx_text ltx_font_bold">34.3</span></td>
</tr>
<tr id="A2.T9.2.14.12" class="ltx_tr">
<th id="A2.T9.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="A2.T9.2.14.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T9.2.14.12.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">42.4</td>
<td id="A2.T9.2.14.12.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.14.12.4.1" class="ltx_text ltx_font_bold">46.3</span></td>
<td id="A2.T9.2.14.12.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">44.0</td>
</tr>
<tr id="A2.T9.2.15.13" class="ltx_tr">
<th id="A2.T9.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="A2.T9.2.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T9.2.15.13.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">30.7</td>
<td id="A2.T9.2.15.13.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.15.13.4.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="A2.T9.2.15.13.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
</tr>
<tr id="A2.T9.2.16.14" class="ltx_tr">
<th id="A2.T9.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="A2.T9.2.16.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.16.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.8</td>
<td id="A2.T9.2.16.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">4.3</td>
<td id="A2.T9.2.16.14.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.16.14.5.1" class="ltx_text ltx_font_bold">4.9</span></td>
</tr>
<tr id="A2.T9.2.17.15" class="ltx_tr">
<th id="A2.T9.2.17.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="A2.T9.2.17.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td id="A2.T9.2.17.15.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.2</td>
<td id="A2.T9.2.17.15.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.17.15.4.1" class="ltx_text ltx_font_bold">2.2</span></td>
<td id="A2.T9.2.17.15.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.17.15.5.1" class="ltx_text ltx_font_bold">2.2</span></td>
</tr>
<tr id="A2.T9.2.18.16" class="ltx_tr">
<th id="A2.T9.2.18.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="A2.T9.2.18.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T9.2.18.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">9.9</td>
<td id="A2.T9.2.18.16.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.18.16.4.1" class="ltx_text ltx_font_bold">16.5</span></td>
<td id="A2.T9.2.18.16.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.18.16.5.1" class="ltx_text ltx_font_bold">16.6</span></td>
</tr>
<tr id="A2.T9.2.19.17" class="ltx_tr">
<th id="A2.T9.2.19.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="A2.T9.2.19.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T9.2.19.17.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">3.0</td>
<td id="A2.T9.2.19.17.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.19.17.4.1" class="ltx_text ltx_font_bold">6.3</span></td>
<td id="A2.T9.2.19.17.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">5.7</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">표 9:</span></figcaption>
Comparison between DeepSeekMoE and larger dense baselines.
</figcaption>
</figure>
<div id="A2.p2" class="ltx_para">
<p class="ltx_p" id="A2.p2.3">13B 총 매개변수의 더 큰 규모에서 DeepSeekMoE를 GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="A2.p2.1.m1.1"><semantics id="A2.p2.1.m1.1a"><mrow id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml"><mi id="A2.p2.1.m1.1.1.2" xref="A2.p2.1.m1.1.1.2.cmml"></mi><mo id="A2.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.1.m1.1.1.1.cmml">×</mo><mn id="A2.p2.1.m1.1.1.3" xref="A2.p2.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><apply id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1"><times id="A2.p2.1.m1.1.1.1.cmml" xref="A2.p2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.p2.1.m1.1.1.2.cmml" xref="A2.p2.1.m1.1.1.2">absent</csymbol><cn id="A2.p2.1.m1.1.1.3.cmml" type="float" xref="A2.p2.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\times 1.2</annotation></semantics></math> 및 GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="A2.p2.2.m2.1"><semantics id="A2.p2.2.m2.1a"><mrow id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml"><mi id="A2.p2.2.m2.1.1.2" xref="A2.p2.2.m2.1.1.2.cmml"></mi><mo id="A2.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.2.m2.1.1.1.cmml">×</mo><mn id="A2.p2.2.m2.1.1.3" xref="A2.p2.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><apply id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1"><times id="A2.p2.2.m2.1.1.1.cmml" xref="A2.p2.2.m2.1.1.1"></times><csymbol cd="latexml" id="A2.p2.2.m2.1.1.2.cmml" xref="A2.p2.2.m2.1.1.2">absent</csymbol><cn id="A2.p2.2.m2.1.1.3.cmml" type="float" xref="A2.p2.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">\times 1.5</annotation></semantics></math>와 비교하고 표<a class="ltx_ref" href="#A2.T10" title="Table 10 ‣ Appendix B Comparing DeepSeekMoE with Larger Models ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">10</span></a>의 결과를 보여준다. 더 큰 규모에서 DeepSeekMoE는 GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="A2.p2.3.m3.1"><semantics id="A2.p2.3.m3.1a"><mrow id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml"><mi id="A2.p2.3.m3.1.1.2" xref="A2.p2.3.m3.1.1.2.cmml"></mi><mo id="A2.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.3.m3.1.1.1.cmml">×</mo><mn id="A2.p2.3.m3.1.1.3" xref="A2.p2.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.1b"><apply id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1"><times id="A2.p2.3.m3.1.1.1.cmml" xref="A2.p2.3.m3.1.1.1"></times><csymbol cd="latexml" id="A2.p2.3.m3.1.1.2.cmml" xref="A2.p2.3.m3.1.1.2">absent</csymbol><cn id="A2.p2.3.m3.1.1.3.cmml" type="float" xref="A2.p2.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.1c">\times 1.5</annotation></semantics></math>를 뚜렷하게 능가한다.</p>
</div>
<figure id="A2.T10" class="ltx_table">
<table id="A2.T10.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T10.2.2" class="ltx_tr">
<th id="A2.T10.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.2.3.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="A2.T10.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.2.4.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="A2.T10.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.1.1.1.1" class="ltx_text ltx_font_bold">GShard<math id="A2.T10.1.1.1.1.m1.1" class="ltx_Math" alttext="\times 1.2" display="inline"><semantics id="A2.T10.1.1.1.1.m1.1a"><mrow id="A2.T10.1.1.1.1.m1.1.1" xref="A2.T10.1.1.1.1.m1.1.1.cmml"><mi id="A2.T10.1.1.1.1.m1.1.1.2" xref="A2.T10.1.1.1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T10.1.1.1.1.m1.1.1.1" xref="A2.T10.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A2.T10.1.1.1.1.m1.1.1.3" xref="A2.T10.1.1.1.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.1.1.1.1.m1.1b"><apply id="A2.T10.1.1.1.1.m1.1.1.cmml" xref="A2.T10.1.1.1.1.m1.1.1"><times id="A2.T10.1.1.1.1.m1.1.1.1.cmml" xref="A2.T10.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T10.1.1.1.1.m1.1.1.2.cmml" xref="A2.T10.1.1.1.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.T10.1.1.1.1.m1.1.1.3.cmml" xref="A2.T10.1.1.1.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.1.1.1.1.m1.1c">\times 1.2</annotation></semantics></math></span></td>
<td id="A2.T10.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.2.2.1" class="ltx_text ltx_font_bold">GShard<math id="A2.T10.2.2.2.1.m1.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="A2.T10.2.2.2.1.m1.1a"><mrow id="A2.T10.2.2.2.1.m1.1.1" xref="A2.T10.2.2.2.1.m1.1.1.cmml"><mi id="A2.T10.2.2.2.1.m1.1.1.2" xref="A2.T10.2.2.2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T10.2.2.2.1.m1.1.1.1" xref="A2.T10.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A2.T10.2.2.2.1.m1.1.1.3" xref="A2.T10.2.2.2.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.2.2.2.1.m1.1b"><apply id="A2.T10.2.2.2.1.m1.1.1.cmml" xref="A2.T10.2.2.2.1.m1.1.1"><times id="A2.T10.2.2.2.1.m1.1.1.1.cmml" xref="A2.T10.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T10.2.2.2.1.m1.1.1.2.cmml" xref="A2.T10.2.2.2.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.T10.2.2.2.1.m1.1.1.3.cmml" xref="A2.T10.2.2.2.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.2.2.2.1.m1.1c">\times 1.5</annotation></semantics></math></span></td>
<td id="A2.T10.2.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.2.5.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="A2.T10.2.3.1" class="ltx_tr">
<th id="A2.T10.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th id="A2.T10.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.2</td>
<td id="A2.T10.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.5</td>
<td id="A2.T10.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr id="A2.T10.2.4.2" class="ltx_tr">
<th id="A2.T10.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th id="A2.T10.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.4.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="A2.T10.2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="A2.T10.2.4.2.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr id="A2.T10.2.5.3" class="ltx_tr">
<th id="A2.T10.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th id="A2.T10.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.5.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="A2.T10.2.5.3.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="A2.T10.2.5.3.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr id="A2.T10.2.6.4" class="ltx_tr">
<th id="A2.T10.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th id="A2.T10.2.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.6.4.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">15.9B</td>
<td id="A2.T10.2.6.4.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">19.8B</td>
<td id="A2.T10.2.6.4.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">13.3B</td>
</tr>
<tr id="A2.T10.2.7.5" class="ltx_tr">
<th id="A2.T10.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th id="A2.T10.2.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.7.5.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.37B</td>
<td id="A2.T10.2.7.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.82B</td>
<td id="A2.T10.2.7.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.05B</td>
</tr>
<tr id="A2.T10.2.8.6" class="ltx_tr">
<th id="A2.T10.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th id="A2.T10.2.8.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.8.6.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T10.2.8.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T10.2.8.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr id="A2.T10.2.9.7" class="ltx_tr">
<th id="A2.T10.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="A2.T10.2.9.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.9.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">66.6</td>
<td id="A2.T10.2.9.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">67.7</td>
<td id="A2.T10.2.9.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.9.7.5.1" class="ltx_text ltx_font_bold">69.1</span></td>
</tr>
<tr id="A2.T10.2.10.8" class="ltx_tr">
<th id="A2.T10.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="A2.T10.2.10.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.10.8.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">75.6</td>
<td id="A2.T10.2.10.8.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.10.8.4.1" class="ltx_text ltx_font_bold">76.0</span></td>
<td id="A2.T10.2.10.8.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.10.8.5.1" class="ltx_text ltx_font_bold">75.7</span></td>
</tr>
<tr id="A2.T10.2.11.9" class="ltx_tr">
<th id="A2.T10.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="A2.T10.2.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.11.9.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">56.8</td>
<td id="A2.T10.2.11.9.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">56.8</td>
<td id="A2.T10.2.11.9.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.11.9.5.1" class="ltx_text ltx_font_bold">58.8</span></td>
</tr>
<tr id="A2.T10.2.12.10" class="ltx_tr">
<th id="A2.T10.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="A2.T10.2.12.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.12.10.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.12.10.3.1" class="ltx_text ltx_font_bold">39.9</span></td>
<td id="A2.T10.2.12.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">37.6</td>
<td id="A2.T10.2.12.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">38.5</td>
</tr>
<tr id="A2.T10.2.13.11" class="ltx_tr">
<th id="A2.T10.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="A2.T10.2.13.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T10.2.13.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">51.6</td>
<td id="A2.T10.2.13.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">50.6</td>
<td id="A2.T10.2.13.11.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.13.11.5.1" class="ltx_text ltx_font_bold">52.4</span></td>
</tr>
<tr id="A2.T10.2.14.12" class="ltx_tr">
<th id="A2.T10.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="A2.T10.2.14.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T10.2.14.12.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">37.4</td>
<td id="A2.T10.2.14.12.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">36.3</td>
<td id="A2.T10.2.14.12.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.14.12.5.1" class="ltx_text ltx_font_bold">38.5</span></td>
</tr>
<tr id="A2.T10.2.15.13" class="ltx_tr">
<th id="A2.T10.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="A2.T10.2.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.15.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">6.1</td>
<td id="A2.T10.2.15.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">6.1</td>
<td id="A2.T10.2.15.13.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.15.13.5.1" class="ltx_text ltx_font_bold">9.8</span></td>
</tr>
<tr id="A2.T10.2.16.14" class="ltx_tr">
<th id="A2.T10.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="A2.T10.2.16.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td id="A2.T10.2.16.14.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">7.0</td>
<td id="A2.T10.2.16.14.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.16.14.4.1" class="ltx_text ltx_font_bold">11.6</span></td>
<td id="A2.T10.2.16.14.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">10.6</td>
</tr>
<tr id="A2.T10.2.17.15" class="ltx_tr">
<th id="A2.T10.2.17.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="A2.T10.2.17.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T10.2.17.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">36.5</td>
<td id="A2.T10.2.17.15.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">36.7</td>
<td id="A2.T10.2.17.15.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.17.15.5.1" class="ltx_text ltx_font_bold">38.2</span></td>
</tr>
<tr id="A2.T10.2.18.16" class="ltx_tr">
<th id="A2.T10.2.18.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="A2.T10.2.18.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T10.2.18.16.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">12.6</td>
<td id="A2.T10.2.18.16.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">12.1</td>
<td id="A2.T10.2.18.16.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.18.16.5.1" class="ltx_text ltx_font_bold">13.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">표 10:</span></figcaption>
Comparison between DeepSeekMoE and larger GShard models at a larger scale.
</figcaption>
</figure>
</section>
<section id="A3" class="ltx_appendix" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Training Benchmark Curves of DeepSeekMoE 16B</h2>

<div id="A3.p1" class="ltx_para">
<p class="ltx_p" id="A3.p1.1">참고용으로 <a class="ltx_ref" href="#A3.F7" title="Figure 7 ‣ Appendix C Training Benchmark Curves of DeepSeekMoE 16B ‣ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>에서 DeepSeekMoE 16B와 DeepSeek 7B(Dense)의 훈련 중 벤치마크 곡선을 제시한다.</p>
</div>
<figure id="A3.F7" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x7.png" id="A3.F7.g1" class="ltx_graphics ltx_img_portrait" width="456" height="608" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">그림 7:</span></figcaption>
Benchmark curves during training of DeepSeekMoE 16B and DeepSeek 7B (Dense).
</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="https://ar5iv.labs.arxiv.org/html/2401.06065" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="https://ar5iv.labs.arxiv.org/"><img height="40" alt="ar5iv homepage" src="https://ar5iv.labs.arxiv.org/assets/ar5iv.png"></a>
    <a href="https://ar5iv.labs.arxiv.org/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="https://ar5iv.labs.arxiv.org/log/2401.06066" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+2401.06066">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2401.06066" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="https://ar5iv.labs.arxiv.org/html/2401.06067" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 09:57:45 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>