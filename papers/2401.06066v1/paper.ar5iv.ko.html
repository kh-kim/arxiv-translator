<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2401.06066] DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models</title><meta property="og:description" content="In the era of large language models, Mixture-of-Experts (MoE) is a promising architecture for managing computational costs when scaling up model parameters.
However, conventional MoE architectures like GShard, which acβ€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2401.06066">

<!--Generated on Tue Feb 27 09:57:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv-fonts.0.7.9.min.css"><link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv.0.7.9.min.css"><link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\reportnumber</span>
<p class="ltx_p" id="p1.2">001    <span class="ltx_ERROR undefined" id="p1.2.1">\correspondingauthor</span>Contribution during internship at DeepSeek-AI.</p>
</div>
<h1 class="ltx_title ltx_title_document">
DeepSeekMoE: Towards Ultimate Expert Specialization in

<br class="ltx_break">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mixture-of-Experts Language Models
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id1.1.1" class="ltx_text" style="font-size:90%;">Damai Dai<sup id="id1.1.1.1" class="ltx_sup"><span id="id1.1.1.1.1" class="ltx_text ltx_font_italic">β—1,2</span></sup></span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chengqi Deng<sup id="id28.2.id1" class="ltx_sup"><span id="id28.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chenggang Zhao<sup id="id29.2.id1" class="ltx_sup"><span id="id29.2.id1.1" class="ltx_text ltx_font_italic">β—1,3</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
R.X. Xu<sup id="id30.2.id1" class="ltx_sup"><span id="id30.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Huazuo Gao<sup id="id31.2.id1" class="ltx_sup"><span id="id31.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Deli Chen<sup id="id32.2.id1" class="ltx_sup"><span id="id32.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jiashi Li<sup id="id33.2.id1" class="ltx_sup"><span id="id33.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wangding Zeng<sup id="id34.2.id1" class="ltx_sup"><span id="id34.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xingkai Yu<sup id="id35.2.id1" class="ltx_sup"><span id="id35.2.id1.1" class="ltx_text ltx_font_italic">β—1,4</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Y. Wu<sup id="id36.2.id1" class="ltx_sup"><span id="id36.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Zhenda Xie<sup id="id37.2.id1" class="ltx_sup"><span id="id37.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Y.K. Li<sup id="id38.2.id1" class="ltx_sup"><span id="id38.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Panpan Huang<sup id="id39.2.id1" class="ltx_sup"><span id="id39.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Fuli Luo<sup id="id40.2.id1" class="ltx_sup"><span id="id40.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chong Ruan<sup id="id41.2.id1" class="ltx_sup"><span id="id41.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">

<br class="ltx_break">Zhifang Sui<sup id="id42.2.id1" class="ltx_sup"><span id="id42.2.id1.1" class="ltx_text ltx_font_italic">2</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wenfeng Liang<sup id="id43.4.id1" class="ltx_sup"><span id="id43.4.id1.1" class="ltx_text ltx_font_italic">1</span></sup>

<br class="ltx_break"><sup id="id44.5.id2" class="ltx_sup"><span id="id44.5.id2.1" class="ltx_text" style="font-size:90%;">1</span></sup><span id="id19.3.1" class="ltx_text" style="font-size:90%;">DeepSeek-AI 
<br class="ltx_break"><sup id="id19.3.1.1" class="ltx_sup">2</sup>National Key Laboratory for Multimedia Information Processing</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Peking University 
<br class="ltx_break"><sup id="id45.2.id1" class="ltx_sup"><span id="id45.2.id1.1" class="ltx_text" style="font-size:90%;">3</span></sup><span id="id46.3.id2" class="ltx_text" style="font-size:90%;">Institute for Interdisciplinary Information Sciences</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Tsinghua University 
<br class="ltx_break"><sup id="id47.2.id1" class="ltx_sup"><span id="id47.2.id1.1" class="ltx_text" style="font-size:90%;">4</span></sup><span id="id48.3.id2" class="ltx_text" style="font-size:90%;">National Key Laboratory for Novel Software Technology</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Nanjing University 
<br class="ltx_break"><span id="id49.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{daidamai, szf}@pku.edu.cn</span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id50.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{wenfeng.liang}@deepseek.com<span id="id50.1.id1.1" class="ltx_text ltx_font_serif">

<br class="ltx_break"><a target="_blank" href="https://github.com/deepseek-ai/DeepSeek-MoE" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/deepseek-ai/DeepSeek-MoE</a>
</span></span>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id27.6">λ€κ·λ¨ μ–Έμ–΄ λ¨λΈ μ‹λ€μ—, Mixture-of-Experts (MoE)λ” λ¨λΈ νλΌλ―Έν„°λ“¤μ„ μ¤μΌ€μΌλ§ν•  λ• κ³„μ‚° λΉ„μ©λ“¤μ„ κ΄€λ¦¬ν•κΈ° μ„ν• μ λ§ν• μ•„ν‚¤ν…μ²μ΄λ‹¤. κ·Έλ¬λ‚, <math alttext="N" class="ltx_Math" display="inline" id="id23.2.m2.1"><semantics id="id23.2.m2.1a"><mi id="id23.2.m2.1.1" xref="id23.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="id23.2.m2.1b"><ci id="id23.2.m2.1.1.cmml" xref="id23.2.m2.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="id23.2.m2.1c">N</annotation></semantics></math> μ „λ¬Έκ°€ μ¤‘ μƒμ„ <math alttext="K" class="ltx_Math" display="inline" id="id22.1.m1.1"><semantics id="id22.1.m1.1a"><mi id="id22.1.m1.1.1" xref="id22.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="id22.1.m1.1b"><ci id="id22.1.m1.1.1.cmml" xref="id22.1.m1.1.1">πΎ</ci></annotation-xml><annotation encoding="application/x-tex" id="id22.1.m1.1c">K</annotation></semantics></math>λ¥Ό ν™μ„±ν™”μ‹ν‚¤λ” GShardμ™€ κ°™μ€ κΈ°μ΅΄μ MoE μ•„ν‚¤ν…μ²λ” μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό λ³΄μ¥ν•λ” λ° μμ–΄ μ–΄λ ¤μ›€μ— μ§λ©΄ν•΄ μλ‹¤. μ¦‰, κ° μ „λ¬Έκ°€λ” μ¤‘λ³µλμ§€ μ•κ³  μ§‘μ¤‘λ μ§€μ‹μ„ νλ“ν•κ² λλ‹¤. μ΄μ— λ€ν•΄ <span class="ltx_text ltx_font_bold" id="id27.6.1">DeepSeekMoE</span> μ•„ν‚¤ν…μ²λ¥Ό κ¶κ·Ήμ μΈ μ „λ¬Έκ°€ μ „λ¬Έν™”λ΅ μ μ•ν•λ‹¤. μ—¬κΈ°μ—λ” λ‘ κ°€μ§€ μ£Όμ” μ „λµμ΄ ν¬ν•¨λ©λ‹λ‹¤: (1) μ „λ¬Έκ°€λ¥Ό <math alttext="mN" class="ltx_Math" display="inline" id="id24.3.m3.1"><semantics id="id24.3.m3.1a"><mrow id="id24.3.m3.1.1" xref="id24.3.m3.1.1.cmml"><mi id="id24.3.m3.1.1.2" xref="id24.3.m3.1.1.2.cmml">m</mi><mo id="id24.3.m3.1.1.1" lspace="0em" rspace="0em" xref="id24.3.m3.1.1.1.cmml">β€‹</mo><mi id="id24.3.m3.1.1.3" xref="id24.3.m3.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="id24.3.m3.1b"><apply id="id24.3.m3.1.1.cmml" xref="id24.3.m3.1.1"><times id="id24.3.m3.1.1.1.cmml" xref="id24.3.m3.1.1.1"></times><ci id="id24.3.m3.1.1.2.cmml" xref="id24.3.m3.1.1.2">π‘</ci><ci id="id24.3.m3.1.1.3.cmml" xref="id24.3.m3.1.1.3">π‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id24.3.m3.1c">mN</annotation></semantics></math>λ΅ μ„Έλ°€ν•κ² μ„Έλ¶„ν™”ν•κ³  μ΄λ΅λ¶€ν„° <math alttext="mK" class="ltx_Math" display="inline" id="id25.4.m4.1"><semantics id="id25.4.m4.1a"><mrow id="id25.4.m4.1.1" xref="id25.4.m4.1.1.cmml"><mi id="id25.4.m4.1.1.2" xref="id25.4.m4.1.1.2.cmml">m</mi><mo id="id25.4.m4.1.1.1" lspace="0em" rspace="0em" xref="id25.4.m4.1.1.1.cmml">β€‹</mo><mi id="id25.4.m4.1.1.3" xref="id25.4.m4.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="id25.4.m4.1b"><apply id="id25.4.m4.1.1.cmml" xref="id25.4.m4.1.1"><times id="id25.4.m4.1.1.1.cmml" xref="id25.4.m4.1.1.1"></times><ci id="id25.4.m4.1.1.2.cmml" xref="id25.4.m4.1.1.2">π‘</ci><ci id="id25.4.m4.1.1.3.cmml" xref="id25.4.m4.1.1.3">πΎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id25.4.m4.1c">mK</annotation></semantics></math>λ¥Ό ν™μ„±ν™”ν•μ—¬ ν™μ„±ν™”λ μ „λ¬Έκ°€μ λ³΄λ‹¤ μ μ—°ν• μ΅°ν•©μ„ ν—μ©ν•κ³ ; (2) [math idx=4></math> μ „λ¬Έκ°€λ¥Ό κ³µμ λ μ „λ¬Έκ°€λ΅ κ²©λ¦¬ν•μ—¬ κ³µν†µ μ§€μ‹μ„ ν¬μ°©ν•κ³  λΌμ°ν…λ μ „λ¬Έκ°€μ μ¤‘λ³µμ„±μ„ μ™„ν™”ν•λ” κ²ƒμ„ λ©ν‘λ΅ ν•©λ‹λ‹¤. 2B νλΌλ―Έν„°λ¥Ό κ°–λ” μ λ‹Ήν• μ¤μΌ€μΌμ—μ„ μ‹μ‘ν•μ—¬, DeepSeekMoE 2Bκ°€ 1.5<math alttext="\times" class="ltx_Math" display="inline" id="id27.6.m6.1"><semantics id="id27.6.m6.1a"><mo id="id27.6.m6.1.1" xref="id27.6.m6.1.1.cmml">Γ—</mo><annotation-xml encoding="MathML-Content" id="id27.6.m6.1b"><times id="id27.6.m6.1.1.cmml" xref="id27.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id27.6.m6.1c">\times</annotation></semantics></math> μ „λ¬Έκ°€ νλΌλ―Έν„° λ° κ³„μ‚°μ„ κ°–λ” GShard 2.9Bμ™€ λΉ„κµ κ°€λ¥ν• μ„±λ¥μ„ λ‹¬μ„±ν•¨μ„ μ…μ¦ν•λ‹¤. λν•, DeepSeekMoE 2Bλ” MoE λ¨λΈμ μƒν•μ„ μ„¤μ •ν•λ” λ™μΌν• μμ μ΄ λ§¤κ°λ³€μλ΅ μ΅°λ°€ν• λ€μ‘λ¬Όμ μ„±λ¥μ— κ±°μ κ·Όμ ‘ν•λ‹¤. κ·Έ ν›„ DeepSeekMoEλ¥Ό 16B νλΌλ―Έν„°λ΅ ν™•μ¥ν•μ—¬ LLaMA2 7Bμ™€ λΉ„κµ κ°€λ¥ν• μ„±λ¥μ„ μ–»μ—μΌλ©°, κ³„μ‚°λ‰μ€ μ•½ 40%μ— λ¶κ³Όν•μ€λ‹¤. λν• DeepSeekMoEλ¥Ό 145B λ§¤κ°λ³€μλ΅ ν™•μ¥ν•λ ¤λ” μλΉ„ λ…Έλ ¥μ€ GShard μ•„ν‚¤ν…μ²μ— λΉ„ν•΄ μƒλ‹Ήν• μ΄μ μ„ μΌκ΄€λκ² κ²€μ¦ν•κ³  28.5%(μ‹¬μ§€μ–΄ 18.2%)μ κ³„μ‚°λ§μ„ μ‚¬μ©ν•μ—¬ DeepSeek 67Bμ™€ μ μ‚¬ν• μ„±λ¥μ„ λ³΄μ—¬μ¤€λ‹¤.</p>
</div>
<figure id="S0.F1" class="ltx_figure" lang="en"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x1.png" id="S0.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="230" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">λ„ 1:</span></figcaption>
Comparison between DeepSeekMoE 16B and open source models on the Open LLM Leaderboard.
The red dashed line is linearly fitted from data points of all models except DeepSeekMoE 16B.
DeepSeekMoE 16B consistently outperforms models with a similar number of activated parameters by a large margin, and achieves comparable performance with LLaMA2 7B, which has approximately 2.5 times the activated parameters.
</figcaption>
</figure>
<section id="S1" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p" id="S1.p1.1">μµκ·Όμ μ—°κµ¬ λ° κ΄€ν–‰λ“¤μ€ μ¶©λ¶„ν• νΈλ μ΄λ‹ λ°μ΄ν„°λ¥Ό μ΄μ©κ°€λ¥ν•κ² ν•¨μΌλ΅μ¨, μ¦κ°€λ νλΌλ―Έν„°λ“¤ λ° κ³„μ‚° μμ‚°λ“¤μ„ κ°–λ” μ¤μΌ€μΌλ§ μ–Έμ–΄ λ¨λΈλ“¤μ΄ ν„μ €ν•κ² λ” κ°•ν• λ¨λΈλ“¤ <cite class="ltx_cite ltx_citemacro_citep">(Brown etΒ al., <a class="ltx_ref" href="#bib.bib7" title="">2020</a>; OpenAI, <a class="ltx_ref" href="#bib.bib38" title="">2023</a>; Touvron etΒ al., <a class="ltx_ref" href="#bib.bib53" title="">2023a</a>; Hoffmann etΒ al., <a class="ltx_ref" href="#bib.bib24" title="">2022</a>)</cite>λ¥Ό μ‚°μ¶ν•  μ μλ‹¤λ” κ²ƒμ„ κ²½ν—μ μΌλ΅ μ…μ¦ν–λ‹¤. κ·Έλ¬λ‚ λ¨λΈμ„ λ§¤μ° λ€κ·λ¨λ΅ ν™•μ¥ν•λ ¤λ” λ…Έλ ¥μ€ λν• λ§¤μ° λ†’μ€ κ³„μ‚° λΉ„μ©κ³Ό κ΄€λ ¨μ΄ μμμ„ μΈμ •ν•΄μ•Ό ν•λ‹¤. μƒλ‹Ήν• λΉ„μ©μ„ κ³ λ ¤ν•  λ•, Mixture-of-Experts(MoE) μ•„ν‚¤ν…μ² <cite class="ltx_cite ltx_citemacro_citep">(Jacobs etΒ al., <a class="ltx_ref" href="#bib.bib26" title="">1991</a>; Jordan and Jacobs, <a class="ltx_ref" href="#bib.bib27" title="">1994</a>; Shazeer etΒ al., <a class="ltx_ref" href="#bib.bib47" title="">2017</a>)</cite>κ°€ λ€μ¤‘μ μΈ μ†”λ£¨μ…μΌλ΅ λ¶€μƒν–λ‹¤. νλΌλ―Έν„° μ¤μΌ€μΌλ§μ„ κ°€λ¥ν•κ² ν•λ” λ™μ‹μ— κ³„μ‚° λΉ„μ©μ„ μ λ‹Ήν• μμ¤€μΌλ΅ μ μ§€ν•  μ μμµλ‹λ‹¤. μµκ·Ό Transformers<cite class="ltx_cite ltx_citemacro_citep">(Vaswani etΒ al., <a class="ltx_ref" href="#bib.bib55" title="">2017</a>)</cite>μ—μ„ MoE μ•„ν‚¤ν…μ²μ μ‘μ©μ€ μ–Έμ–΄ λ¨λΈμ„ μƒλ‹Ήν• ν¬κΈ°<cite class="ltx_cite ltx_citemacro_citep">(Fedus etΒ al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>; Lepikhin etΒ al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>; Du etΒ al., <a class="ltx_ref" href="#bib.bib14" title="">2022</a>; Zoph, <a class="ltx_ref" href="#bib.bib63" title="">2022</a>)</cite>λ΅ ν™•μ¥ν•λ ¤λ” μ„±κ³µμ μΈ μ‹λ„λ¥Ό κ°€μ Έμ™”μΌλ©° λ†€λΌμ΄ μ„±λ¥μ„ λ™λ°ν–λ‹¤. μ΄λ¬ν• μ„±κ³Όλ” MoE μ–Έμ–΄ λ¨λΈμ μƒλ‹Ήν• μ μ¬λ ¥κ³Ό κ°€λ¥μ„±μ„ κ°•μ΅°ν•λ‹¤.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p" id="S1.p2.1">MoE μ•„ν‚¤ν…μ²μ μ λ§ν• μ μ¬λ ¥μ—λ„ λ¶κµ¬ν•κ³ , κΈ°μ΅΄μ MoE μ•„ν‚¤ν…μ²λ” μ μ¬μ μΌλ΅ μ§€μ‹ νΌμΆ…μ„± λ° μ§€μ‹ μ¤‘λ³µμ„±μ λ¬Έμ λ΅ κ³ ν†µλ°›μΌλ©°, μ΄λ” μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό μ ν•ν•λ©°, μ¦‰ κ° μ „λ¬Έκ°€κ°€ λΉ„μ¤‘μ²© λ° μ§‘μ¤‘λ μ§€μ‹μ„ νλ“ν•λ‹¤. κΈ°μ΅΄μ MoE κµ¬μ΅°λ” νΈλμ¤ν¬λ¨Έμ Feed-Forward Networks(FFN)μ„ MoE κ³„μΈµμΌλ΅ λ€μ²΄ν•λ‹¤. κ° MoE κ³„μΈµμ€ μ—¬λ¬ μ „λ¬Έκ°€λ΅ κµ¬μ„±λλ©°, κ°κ°μ€ κµ¬μ΅°μ μΌλ΅ ν‘μ¤€ FFNκ³Ό λ™μΌν•λ©°, κ° ν† ν°μ€ ν•λ‚μ <cite class="ltx_cite ltx_citemacro_citep">(Fedus etΒ al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite> λλ” λ‘ κ°μ <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin etΒ al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> μ „λ¬Έκ°€μ— ν• λ‹Ήλλ‹¤. μ΄ μ•„ν‚¤ν…μ²λ” (1) <span class="ltx_text ltx_font_bold" id="S1.p2.1.1">Knowledge Hybridity</span>: κΈ°μ΅΄ MoE κ΄€ν–‰μ€ μΆ…μΆ… μ ν•λ μμ μ „λ¬Έκ°€(μ: 8 λλ” 16)λ¥Ό μ‚¬μ©ν•λ―€λ΅ νΉμ • μ „λ¬Έκ°€μ— ν• λ‹Ήλ ν† ν°μ€ λ‹¤μ–‘ν• μ§€μ‹μ„ ν¬ν•¨ν•  κ°€λ¥μ„±μ΄ λ†’μµλ‹λ‹¤. λ”°λΌμ„ μ§€μ •λ μ „λ¬Έκ°€λ” λ™μ‹μ— ν™μ©ν•κΈ° μ–΄λ ¤μ΄ λ§¤κ°λ³€μμ—μ„ λ§¤μ° λ‹¤μ–‘ν• μ ν•μ μ§€μ‹μ„ μμ§‘ν•  κ³„νμ΄λ‹¤. (2) <span class="ltx_text ltx_font_bold" id="S1.p2.1.2">Knowledge Redundancy</span>: μ„λ΅ λ‹¤λ¥Έ μ „λ¬Έκ°€μ—κ² ν• λ‹Ήλ ν† ν°μ€ κ³µν†µλ μ§€μ‹μ„ ν•„μ”λ΅ ν•  μ μλ‹¤. κ²°κ³Όμ μΌλ΅, λ‹¤μμ μ „λ¬Έκ°€λ“¤μ€ κ°μμ νλΌλ―Έν„°λ“¤μ—μ„ κ³µμ λ μ§€μ‹μ„ νλ“ν•λ”λ° μλ ΄ν•  μ μκ³ , μ΄μ— μν•΄ μ „λ¬Έκ°€ νλΌλ―Έν„°λ“¤μ—μ„ μ¤‘λ³µμ„±μΌλ΅ μ΄μ–΄μ§ μ μλ‹¤. μ΄λ¬ν• λ¬Έμ λ” κΈ°μ΅΄ MoE κ΄€ν–‰μ μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό μΌκ΄„μ μΌλ΅ λ°©ν•΄ν•μ—¬ MoE λ¨λΈμ μ΄λ΅ μ  μƒν• μ„±λ¥μ— λ„λ‹¬ν•μ§€ λ»ν•κ² ν•λ‹¤.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p class="ltx_p" id="S1.p3.1">μ•μ„ μ–ΈκΈ‰ν• λ¬Έμ μ— λ€μ‘ν•μ—¬, μ°λ¦¬λ” κ¶κ·Ήμ μΈ μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό μ„ν•΄ νΉλ³„ν μ„¤κ³„λ νμ‹ μ μΈ MoE μ•„ν‚¤ν…μ²μΈ <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">DeepSeekMoE</span>μ„ μ†κ°ν•λ‹¤. μ°λ¦¬μ μ•„ν‚¤ν…μ²λ” λ‘ κ°€μ§€ μ£Όμ” μ „λµμ„ ν¬ν•¨ν•λ‹¤: (1) <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">Fine-Grained Expert Segmentation:</span> νλΌλ―Έν„° μλ¥Ό μΌμ •ν•κ² μ μ§€ν•λ©΄μ„ FFN μ¤‘κ°„ μ€λ‹‰ μ°¨μ›μ„ λ¶„ν• ν•¨μΌλ΅μ¨ μ „λ¬Έκ°€λ¥Ό λ” λ―Έμ„Έν• κ·Έλ μΈμΌλ΅ λ¶„ν• ν•λ‹¤. μ΄μ— λ€μ‘ν•μ—¬ μΌμ •ν• κ³„μ‚° λΉ„μ©μ„ μ μ§€ν•λ©΄μ„ λ³΄λ‹¤ μ„Έλ¶„ν™”λ μ „λ¬Έκ°€λ¥Ό ν™μ„±ν™”ν•μ—¬ ν™μ„±ν™”λ μ „λ¬Έκ°€μ λ³΄λ‹¤ μ μ—°ν•κ³  μ μ‘μ μΈ μ΅°ν•©μ„ κ°€λ¥ν•κ² ν•λ‹¤. μ„Έλ¦½ν™”λ μ „λ¬Έκ°€ μ„Έλ¶„ν™”λ” λ‹¤μ–‘ν• μ§€μ‹μ„ λ” μ„Έλ°€ν•κ² λ¶„ν•΄ν•κ³  λ‹¤λ¥Έ μ „λ¬Έκ°€λ΅ λ” μ •ν™•ν•κ² ν•™μµν•  μ μλ„λ΅ ν•λ©°, μ—¬κΈ°μ„ κ° μ „λ¬Έκ°€λ” λ” λ†’μ€ μμ¤€μ μ „λ¬Έν™”λ¥Ό μ μ§€ν•  κ²ƒμ΄λ‹¤. λν•, ν™μ„±ν™”λ μ „λ¬Έκ°€λ¥Ό κ²°ν•©ν•λ” μ μ—°μ„±μ μ¦κ°€λ” λ³΄λ‹¤ μ •ν™•ν•κ³  ν‘μ ν™”λ μ§€μ‹ μµλ“μ—λ„ κΈ°μ—¬ν•λ‹¤. (2) <span class="ltx_text ltx_font_bold" id="S1.p3.1.3">Shared Expert Isolation:</span> μ°λ¦¬λ” λ‹¤μ–‘ν• μ»¨ν…μ¤νΈμ— κ±Έμ³ κ³µν†µ μ§€μ‹μ„ μΊ΅μ²ν•κ³  ν†µν•©ν•λ” κ²ƒμ„ λ©ν‘λ΅ ν•­μƒ ν™μ„±ν™”λλ” κ³µμ  μ „λ¬Έκ°€ μ—­ν• μ„ ν•κΈ° μ„ν•΄ νΉμ • μ „λ¬Έκ°€λ¥Ό λ¶„λ¦¬ν•©λ‹λ‹¤. μƒμ‹ μ§€μ‹μ„ μ΄λ¬ν• κ³µμ  μ „λ¬Έκ°€λ΅ μ••μ¶•ν•¨μΌλ΅μ¨, λΌμ°ν…λ λ‹¤λ¥Έ μ „λ¬Έκ°€λ“¤ κ°„μ μ¤‘λ³µμ„±μ΄ μ™„ν™”λ  κ²ƒμ΄λ‹¤. μ΄λ” νλΌλ―Έν„° ν¨μ¨μ„±μ„ ν–¥μƒμ‹ν‚¤κ³  κ°κ°μ λΌμ°ν…λ μ „λ¬Έκ°€κ°€ λ…νΉν• μΈ΅λ©΄μ— μ΄μ μ„ λ§μ¶”μ–΄ μ „λ¬Έν™”λ μƒνƒλ¥Ό μ μ§€ν•λ„λ΅ ν•  μ μλ‹¤. DeepSeekMoEμ μ΄λ¬ν• μ•„ν‚¤ν…μ² νμ‹ μ€ κ° μ „λ¬Έκ°€κ°€ κ³ λ„λ΅ μ „λ¬Έν™”λ λ§¤κ°λ³€μ ν¨μ¨μ μΈ MoE μ–Έμ–΄ λ¨λΈμ„ ν›λ ¨ν•  μ μλ” κΈ°νλ¥Ό μ κ³µν•λ‹¤.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p class="ltx_p" id="S1.p4.1">2B λ§¤κ° λ³€μλ¥Ό μ‚¬μ©ν• μ λ‹Ήν• κ·λ¨μ—μ„ μ‹μ‘ν•μ—¬ DeepSeekMoE μ•„ν‚¤ν…μ²μ μ΄μ μ„ κ²€μ¦ν•λ‹¤. λ‹¤μ–‘ν• μ‘μ—…μ— κ±Έμ³ 12κ°μ μ λ΅ μƒ· λλ” μ†μ μƒ· λ²¤μΉλ§ν¬μ— λ€ν• ν‰κ°€λ¥Ό μν–‰ν•©λ‹λ‹¤. μ‹¤ν— κ²°κ³Όλ” DeepSeekMoE 2Bκ°€ GShard 2B<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin etΒ al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite>λ¥Ό μƒλ‹Ήν• λ§μ§„μΌλ΅ λ¥κ°€ν•κ³ , λ” ν° MoE λ¨λΈμΈ GShard 2.9Bμ™€ 1.5<math alttext="\times" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mo id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">Γ—</mo><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><times id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\times</annotation></semantics></math> μ „λ¬Έκ°€ νλΌλ―Έν„° λ° κ³„μ‚°κ³Ό μΌμΉν•¨μ„ λ‚νƒ€λ‚Έλ‹¤. λ†€λκ²λ„, DeepSeekMoE 2Bλ” MoE μ–Έμ–΄ λ¨λΈμ μ—„κ²©ν• μƒν•μ„ μ„¤μ •ν•λ” λ™λ“±ν• μμ λ§¤κ°λ³€μλ΅ μ΅°λ°€ν• λ€μ‘λ¬Όμ μ„±λ¥μ— κ±°μ κ·Όμ ‘ν•λ‹¤λ” κ²ƒμ„ λ°κ²¬ν–λ‹¤. λ” κΉμ€ ν†µμ°°λ ¥μ„ μ¶”κµ¬ν•κΈ° μ„ν•΄ DeepSeekMoEμ— λ€ν• μ „λ¬Έκ°€ μ „λ¬Έν™”μ— λ€ν• μ •κµν• μ μ  μ—°κµ¬μ™€ λ¶„μ„μ„ μν–‰ν•λ‹¤. μ΄λ¬ν• μ—°κµ¬λ” μ„Έλ°€ν• μ „λ¬Έκ°€ μ„Έλ¶„ν™”μ™€ κ³µμ  μ „λ¬Έκ°€ κ²©λ¦¬μ ν¨κ³Όλ¥Ό κ²€μ¦ν•κ³  DeepSeekMoEκ°€ λ†’μ€ μμ¤€μ μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό λ‹¬μ„±ν•  μ μλ‹¤λ” μ£Όμ¥μ„ λ’·λ°›μΉ¨ν•λ” μ‹¤μ¦μ  μ¦κ±°λ¥Ό μ κ³µν•λ‹¤.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p class="ltx_p" id="S1.p5.1">μ°λ¦¬μ μ•„ν‚¤ν…μ²λ¥Ό ν™μ©ν•μ—¬ λ¨λΈ λ§¤κ°λ³€μλ¥Ό 16Bλ΅ ν™•μ¥ν•κ³  2T ν† ν°μ΄ μλ” λ€κ·λ¨ μ½”νΌμ¤μ—μ„ DeepSeekMoE 16Bλ¥Ό ν›λ ¨ν•λ‹¤. ν‰κ°€ κ²°κ³Όλ” μ•½ 40%μ κ³„μ‚°λ§μΌλ΅ DeepSeekMoE 16Bκ°€ λ™μΌν• 2T μ½”νΌμ¤μ— λ€ν•΄ ν›λ ¨λ λ°€μ§‘ λ¨λΈμΈ DeepSeek 7B <cite class="ltx_cite ltx_citemacro_citep">(DeepSeek-AI, <a class="ltx_ref" href="#bib.bib13" title="">2024</a>)</cite>μ™€ μ μ‚¬ν• μ„±λ¥μ„ λ‹¬μ„±ν•¨μ„ λ³΄μ—¬μ¤€λ‹¤. λν• DeepSeekMoEλ¥Ό μ¤ν”μ†μ¤ λ¨λΈκ³Ό λΉ„κµν•μ€μΌλ©°, μ„±λ¥ ν‰κ°€λ¥Ό ν†µν•΄ DeepSeekMoE 16Bκ°€ λΉ„μ·ν• μμ ν™μ„±ν™”λ νλΌλ―Έν„°λ¥Ό κ°€μ§„ λ¨λΈλ³΄λ‹¤ ν° λ§μ§„ μ°¨μ΄λ΅ μΌκ΄€λκ² μ°μν• μ„±λ¥μ„ λ³΄μ€μΌλ©°, ν™μ„±ν™”λ νλΌλ―Έν„°μ μ•½ 2.5λ°°μΈ LLaMA2 7B<cite class="ltx_cite ltx_citemacro_citep">(Touvron etΒ al., <a class="ltx_ref" href="#bib.bib54" title="">2023b</a>)</cite>μ™€ μ μ‚¬ν• μ„±λ¥μ„ λ³΄μ€λ‹¤. <a class="ltx_ref" href="#S0.F1" title="Figure 1 β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>λ” Open LLM Leaderboard<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard</span></span></span>μ— λ€ν• ν‰κ°€ κ²°κ³Όλ¥Ό λ³΄μ—¬μ¤€λ‹¤. λν•, λ¨λΈμ„ μ±„ν… λ¨λΈλ΅ λ³€ν™ν•μ—¬ μ •λ ¬μ„ μ„ν• κ°λ… λ―Έμ„Έ μ΅°μ •(supervised fine-tuning, SFT)μ„ μν–‰ν•λ‹¤. ν‰κ°€ κ²°κ³Όλ” DeepSeekMoE Chat 16Bλ„ μ±„ν… μ„¤μ •μ—μ„ DeepSeek Chat 7B λ° LLaMA2 SFT 7Bμ™€ μ μ‚¬ν• μ„±λ¥μ„ λ‹¬μ„±ν•¨μ„ λ³΄μ—¬μ¤€λ‹¤. μ΄λ¬ν• κ²°κ³Όμ— κ³ λ¬΄λμ–΄ DeepSeekMoEλ¥Ό 145Bλ΅ ν™•μ¥ν•κΈ° μ„ν• μλΉ„ λ…Έλ ¥μ„ μ¶”κ°€λ΅ μν–‰ν•λ‹¤. μ‹¤ν— κ²°κ³Όλ” μ—¬μ „ν GShard μ•„ν‚¤ν…μ²μ— λΉ„ν•΄ μƒλ‹Ήν• μ΄μ μ„ μΌκ΄€λκ² κ²€μ¦ν•λ‹¤. λν•, 28.5%(μ‹¬μ§€μ–΄ 18.2%)μ κ³„μ‚°λ§μ„ μ‚¬μ©ν•μ—¬ DeepSeek 67Bμ™€ μ μ‚¬ν• μ„±λ¥μ„ λ³΄μ—¬μ¤€λ‹¤.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p class="ltx_p" id="S1.p6.1">μ°λ¦¬μ κΈ°μ—¬λ” λ‹¤μκ³Ό κ°™μ΄ μ”μ•½λλ‹¤:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">β€Ά</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Architectural Innovation. <span> μ°λ¦¬λ” μ„Έλ°€ν• μ „λ¬Έκ°€ λ¶„ν• κ³Ό κ³µμ  μ „λ¬Έκ°€ κ²©λ¦¬μ λ‘ κ°€μ§€ μ£Όμ” μ „λµμ„ μ‚¬μ©ν•λ” κ¶κ·Ήμ μΈ μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό λ‹¬μ„±ν•λ” κ²ƒμ„ λ©ν‘λ΅ ν•λ” νμ‹ μ μΈ MoE μ•„ν‚¤ν…μ²μΈ DeepSeekMoEλ¥Ό μ†κ°ν•λ‹¤.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">β€Ά</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Empirical Validation. </span> DeepSeekMoE μ•„ν‚¤ν…μ²μ μ ν¨μ„±μ„ μ‹¤μ¦μ μΌλ΅ κ²€μ¦ν•κΈ° μ„ν•΄ κ΄‘λ²”μ„ν• μ‹¤ν—μ„ μ§„ν–‰ν•©λ‹λ‹¤. μ‹¤ν— κ²°κ³Όλ” DeepSeekMoE 2Bμ—μ„ λ†’μ€ μμ¤€μ μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό κ²€μ¦ν•κ³ , DeepSeekMoE 2Bκ°€ MoE λ¨λΈμ— λ€ν• μƒν• μ„±λ¥μ— κ±°μ μ ‘κ·Όν•  μ μμμ„ λ‚νƒ€λ‚Έλ‹¤.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">β€Ά</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Scalability. </span> DeepSeekMoEλ¥Ό ν™•μ¥ν•μ—¬ 16B λ¨λΈμ„ ν•™μµν•κ³  μ•½ 40%μ κ³„μ‚°λ§μΌλ΅ DeepSeekMoE 16Bκ°€ DeepSeek 7B λ° LLaMA2 7Bμ™€ μ μ‚¬ν• μ„±λ¥μ„ λ‹¬μ„±ν•¨μ„ λ³΄μ—¬μ¤€λ‹¤. λν• DeepSeekMoEλ¥Ό 145Bλ΅ ν™•μ¥ν•κΈ° μ„ν• μλΉ„ μ‹λ„λ¥Ό μν–‰ν•μ—¬ GShard μ•„ν‚¤ν…μ²μ— λΉ„ν•΄ μΌκ΄€λ μ΄μ μ„ κ°•μ΅°ν•κ³  DeepSeek 67Bμ™€ μ μ‚¬ν• μ„±λ¥μ„ λ³΄μ—¬μ¤€λ‹¤.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">β€Ά</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">Alignment for MoE. </span> DeepSeekMoE 16Bμ—μ„ κ°λ… λ―Έμ„Έ μ΅°μ •μ„ μ„±κ³µμ μΌλ΅ μν–‰ν•μ—¬ μ •λ ¬λ μ±„ν… λ¨λΈμ„ μƒμ„±ν•μ—¬ DeepSeekMoE 16Bμ μ μ‘μ„±κ³Ό λ‹¤μ–‘μ„±μ„ λ³΄μ—¬μ¤€λ‹¤.</p>
</div>
</li>
<li id="S1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">β€Ά</span> 
<div id="S1.I1.i5.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i5.p1.1.1">Public Release. </span> μ¤ν” λ¦¬μ„μΉμ μ •μ‹ μ—μ„ DeepSeekMoE 16Bμ λ¨λΈ μ²΄ν¬ν¬μΈνΈλ¥Ό λ€μ¤‘μ—κ² κ³µκ°ν•©λ‹λ‹¤. νΉν, μ΄ λ¨λΈμ€ μ–‘μν™”ν•  ν•„μ” μ—†μ΄ 40GBμ λ©”λ¨λ¦¬λ¥Ό κ°–λ” λ‹¨μΌ GPUμ— λ°°μΉλ  μ μλ‹¤.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries: Mixture-of-Experts for Transformers</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p" id="S2.p1.1">λ¨Όμ € νΈλμ¤ν¬λ¨Έ μ–Έμ–΄ λ¨λΈμ—μ„ μΌλ°μ μΌλ΅ μ‚¬μ©λλ” μΌλ°μ μΈ MoE μ•„ν‚¤ν…μ²λ¥Ό μ†κ°ν•λ‹¤. ν‘μ¤€ νΈλμ¤ν¬λ¨Έ μ–Έμ–΄ λ¨λΈμ€ ν‘μ¤€ νΈλμ¤ν¬λ¨Έ λΈ”λ΅λ“¤μ <math alttext="L" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">πΏ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">L</annotation></semantics></math> λ μ΄μ–΄λ¥Ό μ μΈµν•μ—¬ κµ¬μ„±λλ©°, μ—¬κΈ°μ„ κ° λΈ”λ΅μ€ λ‹¤μκ³Ό κ°™μ΄ λ‚νƒ€λ‚Ό μ μλ‹¤:</p>
<table id="A3.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{u}_{1:T}^{l}" display="inline"><semantics id="S2.E1.m1.1a"><msubsup id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mi id="S2.E1.m1.1.1.2.2" xref="S2.E1.m1.1.1.2.2.cmml">π®</mi><mrow id="S2.E1.m1.1.1.2.3" xref="S2.E1.m1.1.1.2.3.cmml"><mn id="S2.E1.m1.1.1.2.3.2" xref="S2.E1.m1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m1.1.1.2.3.1" xref="S2.E1.m1.1.1.2.3.1.cmml">:</mo><mi id="S2.E1.m1.1.1.2.3.3" xref="S2.E1.m1.1.1.2.3.3.cmml">T</mi></mrow><mi id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1">superscript</csymbol><apply id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.1.cmml" xref="S2.E1.m1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.2.2">π®</ci><apply id="S2.E1.m1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.2.3"><ci id="S2.E1.m1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.2.3.1">:</ci><cn type="integer" id="S2.E1.m1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.2.3.2">1</cn><ci id="S2.E1.m1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.2.3.3">π‘‡</ci></apply></apply><ci id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3">π‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\displaystyle\mathbf{u}_{1:T}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E1.m2.2" class="ltx_Math" alttext="\displaystyle=\operatorname{Self-Att}\left(\mathbf{h}_{1:T}^{l-1}\right)+\mathbf{h}_{1:T}^{l-1}," display="inline"><semantics id="S2.E1.m2.2a"><mrow id="S2.E1.m2.2.2.1" xref="S2.E1.m2.2.2.1.1.cmml"><mrow id="S2.E1.m2.2.2.1.1" xref="S2.E1.m2.2.2.1.1.cmml"><mi id="S2.E1.m2.2.2.1.1.3" xref="S2.E1.m2.2.2.1.1.3.cmml"></mi><mo id="S2.E1.m2.2.2.1.1.2" xref="S2.E1.m2.2.2.1.1.2.cmml">=</mo><mrow id="S2.E1.m2.2.2.1.1.1" xref="S2.E1.m2.2.2.1.1.1.cmml"><mrow id="S2.E1.m2.2.2.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml"><mrow id="S2.E1.m2.1.1" xref="S2.E1.m2.1.1.cmml"><mi id="S2.E1.m2.1.1.2" xref="S2.E1.m2.1.1.2.cmml">Self</mi><mo id="S2.E1.m2.1.1.1" xref="S2.E1.m2.1.1.1.cmml">β’</mo><mi id="S2.E1.m2.1.1.3" xref="S2.E1.m2.1.1.3.cmml">Att</mi></mrow><mo id="S2.E1.m2.2.2.1.1.1.1.1a" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml">β΅</mo><mrow id="S2.E1.m2.2.2.1.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml"><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.2" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml">(</mo><msubsup id="S2.E1.m2.2.2.1.1.1.1.1.1.1" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">π΅</mi><mrow id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.cmml"><mn id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow><mrow id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1.cmml">β’</mo><mn id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.E1.m2.2.2.1.1.1.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m2.2.2.1.1.1.2" xref="S2.E1.m2.2.2.1.1.1.2.cmml">+</mo><msubsup id="S2.E1.m2.2.2.1.1.1.3" xref="S2.E1.m2.2.2.1.1.1.3.cmml"><mi id="S2.E1.m2.2.2.1.1.1.3.2.2" xref="S2.E1.m2.2.2.1.1.1.3.2.2.cmml">π΅</mi><mrow id="S2.E1.m2.2.2.1.1.1.3.2.3" xref="S2.E1.m2.2.2.1.1.1.3.2.3.cmml"><mn id="S2.E1.m2.2.2.1.1.1.3.2.3.2" xref="S2.E1.m2.2.2.1.1.1.3.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m2.2.2.1.1.1.3.2.3.1" xref="S2.E1.m2.2.2.1.1.1.3.2.3.1.cmml">:</mo><mi id="S2.E1.m2.2.2.1.1.1.3.2.3.3" xref="S2.E1.m2.2.2.1.1.1.3.2.3.3.cmml">T</mi></mrow><mrow id="S2.E1.m2.2.2.1.1.1.3.3" xref="S2.E1.m2.2.2.1.1.1.3.3.cmml"><mi id="S2.E1.m2.2.2.1.1.1.3.3.2" xref="S2.E1.m2.2.2.1.1.1.3.3.2.cmml">l</mi><mo id="S2.E1.m2.2.2.1.1.1.3.3.1" xref="S2.E1.m2.2.2.1.1.1.3.3.1.cmml">β’</mo><mn id="S2.E1.m2.2.2.1.1.1.3.3.3" xref="S2.E1.m2.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo id="S2.E1.m2.2.2.1.2" xref="S2.E1.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m2.2b"><apply id="S2.E1.m2.2.2.1.1.cmml" xref="S2.E1.m2.2.2.1"><eq id="S2.E1.m2.2.2.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S2.E1.m2.2.2.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.3">absent</csymbol><apply id="S2.E1.m2.2.2.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1"><plus id="S2.E1.m2.2.2.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.2"></plus><apply id="S2.E1.m2.2.2.1.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1"><apply id="S2.E1.m2.1.1.cmml" xref="S2.E1.m2.1.1"><minus id="S2.E1.m2.1.1.1.cmml" xref="S2.E1.m2.1.1.1"></minus><ci id="S2.E1.m2.1.1.2.cmml" xref="S2.E1.m2.1.1.2">Self</ci><ci id="S2.E1.m2.1.1.3.cmml" xref="S2.E1.m2.1.1.3">Att</ci></apply><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.2">π΅</ci><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3"><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.1">:</ci><cn type="integer" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.2.3.3">π‘‡</ci></apply></apply><apply id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3"><minus id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.2">π‘™</ci><cn type="integer" id="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S2.E1.m2.2.2.1.1.1.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3">superscript</csymbol><apply id="S2.E1.m2.2.2.1.1.1.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m2.2.2.1.1.1.3.2.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E1.m2.2.2.1.1.1.3.2.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.2">π΅</ci><apply id="S2.E1.m2.2.2.1.1.1.3.2.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3"><ci id="S2.E1.m2.2.2.1.1.1.3.2.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3.1">:</ci><cn type="integer" id="S2.E1.m2.2.2.1.1.1.3.2.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3.2">1</cn><ci id="S2.E1.m2.2.2.1.1.1.3.2.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.2.3.3">π‘‡</ci></apply></apply><apply id="S2.E1.m2.2.2.1.1.1.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3"><minus id="S2.E1.m2.2.2.1.1.1.3.3.1.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3.1"></minus><ci id="S2.E1.m2.2.2.1.1.1.3.3.2.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3.2">π‘™</ci><cn type="integer" id="S2.E1.m2.2.2.1.1.1.3.3.3.cmml" xref="S2.E1.m2.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m2.2c">\displaystyle=\operatorname{Self-Att}\left(\mathbf{h}_{1:T}^{l-1}\right)+\mathbf{h}_{1:T}^{l-1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{h}_{t}^{l}" display="inline"><semantics id="S2.E2.m1.1a"><msubsup id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mi id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">π΅</mi><mi id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml">t</mi><mi id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1">superscript</csymbol><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">π΅</ci><ci id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3">π‘΅</ci></apply><ci id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3">π‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2.m2.2" class="ltx_Math" alttext="\displaystyle=\operatorname{FFN}\left(\mathbf{u}_{t}^{l}\right)+\mathbf{u}_{t}^{l}," display="inline"><semantics id="S2.E2.m2.2a"><mrow id="S2.E2.m2.2.2.1" xref="S2.E2.m2.2.2.1.1.cmml"><mrow id="S2.E2.m2.2.2.1.1" xref="S2.E2.m2.2.2.1.1.cmml"><mi id="S2.E2.m2.2.2.1.1.3" xref="S2.E2.m2.2.2.1.1.3.cmml"></mi><mo id="S2.E2.m2.2.2.1.1.2" xref="S2.E2.m2.2.2.1.1.2.cmml">=</mo><mrow id="S2.E2.m2.2.2.1.1.1" xref="S2.E2.m2.2.2.1.1.1.cmml"><mrow id="S2.E2.m2.2.2.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml"><mi id="S2.E2.m2.1.1" xref="S2.E2.m2.1.1.cmml">FFN</mi><mo id="S2.E2.m2.2.2.1.1.1.1.1a" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml">β΅</mo><mrow id="S2.E2.m2.2.2.1.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml"><mo id="S2.E2.m2.2.2.1.1.1.1.1.1.2" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml">(</mo><msubsup id="S2.E2.m2.2.2.1.1.1.1.1.1.1" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">π®</mi><mi id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.E2.m2.2.2.1.1.1.1.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S2.E2.m2.2.2.1.1.1.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m2.2.2.1.1.1.2" xref="S2.E2.m2.2.2.1.1.1.2.cmml">+</mo><msubsup id="S2.E2.m2.2.2.1.1.1.3" xref="S2.E2.m2.2.2.1.1.1.3.cmml"><mi id="S2.E2.m2.2.2.1.1.1.3.2.2" xref="S2.E2.m2.2.2.1.1.1.3.2.2.cmml">π®</mi><mi id="S2.E2.m2.2.2.1.1.1.3.2.3" xref="S2.E2.m2.2.2.1.1.1.3.2.3.cmml">t</mi><mi id="S2.E2.m2.2.2.1.1.1.3.3" xref="S2.E2.m2.2.2.1.1.1.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S2.E2.m2.2.2.1.2" xref="S2.E2.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.2b"><apply id="S2.E2.m2.2.2.1.1.cmml" xref="S2.E2.m2.2.2.1"><eq id="S2.E2.m2.2.2.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S2.E2.m2.2.2.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.3">absent</csymbol><apply id="S2.E2.m2.2.2.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1"><plus id="S2.E2.m2.2.2.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.2"></plus><apply id="S2.E2.m2.2.2.1.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1"><ci id="S2.E2.m2.1.1.cmml" xref="S2.E2.m2.1.1">FFN</ci><apply id="S2.E2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.2">π®</ci><ci id="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.2.3">π‘΅</ci></apply><ci id="S2.E2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.1.1.1.1.1.3">π‘™</ci></apply></apply><apply id="S2.E2.m2.2.2.1.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.3.1.cmml" xref="S2.E2.m2.2.2.1.1.1.3">superscript</csymbol><apply id="S2.E2.m2.2.2.1.1.1.3.2.cmml" xref="S2.E2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m2.2.2.1.1.1.3.2.1.cmml" xref="S2.E2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E2.m2.2.2.1.1.1.3.2.2.cmml" xref="S2.E2.m2.2.2.1.1.1.3.2.2">π®</ci><ci id="S2.E2.m2.2.2.1.1.1.3.2.3.cmml" xref="S2.E2.m2.2.2.1.1.1.3.2.3">π‘΅</ci></apply><ci id="S2.E2.m2.2.2.1.1.1.3.3.cmml" xref="S2.E2.m2.2.2.1.1.1.3.3">π‘™</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.2c">\displaystyle=\operatorname{FFN}\left(\mathbf{u}_{t}^{l}\right)+\mathbf{u}_{t}^{l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.9" class="ltx_p">where <math id="S2.p1.2.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.p1.2.m1.1a"><mi id="S2.p1.2.m1.1.1" xref="S2.p1.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m1.1b"><ci id="S2.p1.2.m1.1.1.cmml" xref="S2.p1.2.m1.1.1">π‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m1.1c">T</annotation></semantics></math> denotes the sequence length, <math id="S2.p1.3.m2.2" class="ltx_Math" alttext="\operatorname{Self-Att}(\cdot)" display="inline"><semantics id="S2.p1.3.m2.2a"><mrow id="S2.p1.3.m2.2.3.2" xref="S2.p1.3.m2.2.3.1.cmml"><mrow id="S2.p1.3.m2.1.1" xref="S2.p1.3.m2.1.1.cmml"><mi id="S2.p1.3.m2.1.1.2" xref="S2.p1.3.m2.1.1.2.cmml">Self</mi><mo id="S2.p1.3.m2.1.1.1" xref="S2.p1.3.m2.1.1.1.cmml">β’</mo><mi id="S2.p1.3.m2.1.1.3" xref="S2.p1.3.m2.1.1.3.cmml">Att</mi></mrow><mo id="S2.p1.3.m2.2.3.2a" xref="S2.p1.3.m2.2.3.1.cmml">β΅</mo><mrow id="S2.p1.3.m2.2.3.2.1" xref="S2.p1.3.m2.2.3.1.cmml"><mo stretchy="false" id="S2.p1.3.m2.2.3.2.1.1" xref="S2.p1.3.m2.2.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p1.3.m2.2.2" xref="S2.p1.3.m2.2.2.cmml">β‹…</mo><mo stretchy="false" id="S2.p1.3.m2.2.3.2.1.2" xref="S2.p1.3.m2.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m2.2b"><apply id="S2.p1.3.m2.2.3.1.cmml" xref="S2.p1.3.m2.2.3.2"><apply id="S2.p1.3.m2.1.1.cmml" xref="S2.p1.3.m2.1.1"><minus id="S2.p1.3.m2.1.1.1.cmml" xref="S2.p1.3.m2.1.1.1"></minus><ci id="S2.p1.3.m2.1.1.2.cmml" xref="S2.p1.3.m2.1.1.2">Self</ci><ci id="S2.p1.3.m2.1.1.3.cmml" xref="S2.p1.3.m2.1.1.3">Att</ci></apply><ci id="S2.p1.3.m2.2.2.cmml" xref="S2.p1.3.m2.2.2">β‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m2.2c">\operatorname{Self-Att}(\cdot)</annotation></semantics></math> denotes the self-attention module, <math id="S2.p1.4.m3.2" class="ltx_Math" alttext="\operatorname{FFN}(\cdot)" display="inline"><semantics id="S2.p1.4.m3.2a"><mrow id="S2.p1.4.m3.2.3.2" xref="S2.p1.4.m3.2.3.1.cmml"><mi id="S2.p1.4.m3.1.1" xref="S2.p1.4.m3.1.1.cmml">FFN</mi><mo id="S2.p1.4.m3.2.3.2a" xref="S2.p1.4.m3.2.3.1.cmml">β΅</mo><mrow id="S2.p1.4.m3.2.3.2.1" xref="S2.p1.4.m3.2.3.1.cmml"><mo stretchy="false" id="S2.p1.4.m3.2.3.2.1.1" xref="S2.p1.4.m3.2.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p1.4.m3.2.2" xref="S2.p1.4.m3.2.2.cmml">β‹…</mo><mo stretchy="false" id="S2.p1.4.m3.2.3.2.1.2" xref="S2.p1.4.m3.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m3.2b"><apply id="S2.p1.4.m3.2.3.1.cmml" xref="S2.p1.4.m3.2.3.2"><ci id="S2.p1.4.m3.1.1.cmml" xref="S2.p1.4.m3.1.1">FFN</ci><ci id="S2.p1.4.m3.2.2.cmml" xref="S2.p1.4.m3.2.2">β‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m3.2c">\operatorname{FFN}(\cdot)</annotation></semantics></math> denotes the Feed-Forward Network&nbsp;(FFN), <math id="S2.p1.5.m4.1" class="ltx_Math" alttext="\mathbf{u}_{1:T}^{l}\in\mathbb{R}^{T\times d}" display="inline"><semantics id="S2.p1.5.m4.1a"><mrow id="S2.p1.5.m4.1.1" xref="S2.p1.5.m4.1.1.cmml"><msubsup id="S2.p1.5.m4.1.1.2" xref="S2.p1.5.m4.1.1.2.cmml"><mi id="S2.p1.5.m4.1.1.2.2.2" xref="S2.p1.5.m4.1.1.2.2.2.cmml">π®</mi><mrow id="S2.p1.5.m4.1.1.2.2.3" xref="S2.p1.5.m4.1.1.2.2.3.cmml"><mn id="S2.p1.5.m4.1.1.2.2.3.2" xref="S2.p1.5.m4.1.1.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.p1.5.m4.1.1.2.2.3.1" xref="S2.p1.5.m4.1.1.2.2.3.1.cmml">:</mo><mi id="S2.p1.5.m4.1.1.2.2.3.3" xref="S2.p1.5.m4.1.1.2.2.3.3.cmml">T</mi></mrow><mi id="S2.p1.5.m4.1.1.2.3" xref="S2.p1.5.m4.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.p1.5.m4.1.1.1" xref="S2.p1.5.m4.1.1.1.cmml">β</mo><msup id="S2.p1.5.m4.1.1.3" xref="S2.p1.5.m4.1.1.3.cmml"><mi id="S2.p1.5.m4.1.1.3.2" xref="S2.p1.5.m4.1.1.3.2.cmml">β„</mi><mrow id="S2.p1.5.m4.1.1.3.3" xref="S2.p1.5.m4.1.1.3.3.cmml"><mi id="S2.p1.5.m4.1.1.3.3.2" xref="S2.p1.5.m4.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p1.5.m4.1.1.3.3.1" xref="S2.p1.5.m4.1.1.3.3.1.cmml">Γ—</mo><mi id="S2.p1.5.m4.1.1.3.3.3" xref="S2.p1.5.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m4.1b"><apply id="S2.p1.5.m4.1.1.cmml" xref="S2.p1.5.m4.1.1"><in id="S2.p1.5.m4.1.1.1.cmml" xref="S2.p1.5.m4.1.1.1"></in><apply id="S2.p1.5.m4.1.1.2.cmml" xref="S2.p1.5.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.2.1.cmml" xref="S2.p1.5.m4.1.1.2">superscript</csymbol><apply id="S2.p1.5.m4.1.1.2.2.cmml" xref="S2.p1.5.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.2.2.1.cmml" xref="S2.p1.5.m4.1.1.2">subscript</csymbol><ci id="S2.p1.5.m4.1.1.2.2.2.cmml" xref="S2.p1.5.m4.1.1.2.2.2">π®</ci><apply id="S2.p1.5.m4.1.1.2.2.3.cmml" xref="S2.p1.5.m4.1.1.2.2.3"><ci id="S2.p1.5.m4.1.1.2.2.3.1.cmml" xref="S2.p1.5.m4.1.1.2.2.3.1">:</ci><cn type="integer" id="S2.p1.5.m4.1.1.2.2.3.2.cmml" xref="S2.p1.5.m4.1.1.2.2.3.2">1</cn><ci id="S2.p1.5.m4.1.1.2.2.3.3.cmml" xref="S2.p1.5.m4.1.1.2.2.3.3">π‘‡</ci></apply></apply><ci id="S2.p1.5.m4.1.1.2.3.cmml" xref="S2.p1.5.m4.1.1.2.3">π‘™</ci></apply><apply id="S2.p1.5.m4.1.1.3.cmml" xref="S2.p1.5.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.3.1.cmml" xref="S2.p1.5.m4.1.1.3">superscript</csymbol><ci id="S2.p1.5.m4.1.1.3.2.cmml" xref="S2.p1.5.m4.1.1.3.2">β„</ci><apply id="S2.p1.5.m4.1.1.3.3.cmml" xref="S2.p1.5.m4.1.1.3.3"><times id="S2.p1.5.m4.1.1.3.3.1.cmml" xref="S2.p1.5.m4.1.1.3.3.1"></times><ci id="S2.p1.5.m4.1.1.3.3.2.cmml" xref="S2.p1.5.m4.1.1.3.3.2">π‘‡</ci><ci id="S2.p1.5.m4.1.1.3.3.3.cmml" xref="S2.p1.5.m4.1.1.3.3.3">π‘‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m4.1c">\mathbf{u}_{1:T}^{l}\in\mathbb{R}^{T\times d}</annotation></semantics></math> are the hidden states of all tokens after the <math id="S2.p1.6.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p1.6.m5.1a"><mi id="S2.p1.6.m5.1.1" xref="S2.p1.6.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m5.1b"><ci id="S2.p1.6.m5.1.1.cmml" xref="S2.p1.6.m5.1.1">π‘™</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m5.1c">l</annotation></semantics></math>-th attention module, and <math id="S2.p1.7.m6.1" class="ltx_Math" alttext="\mathbf{h}_{t}^{l}\in\mathbb{R}^{d}" display="inline"><semantics id="S2.p1.7.m6.1a"><mrow id="S2.p1.7.m6.1.1" xref="S2.p1.7.m6.1.1.cmml"><msubsup id="S2.p1.7.m6.1.1.2" xref="S2.p1.7.m6.1.1.2.cmml"><mi id="S2.p1.7.m6.1.1.2.2.2" xref="S2.p1.7.m6.1.1.2.2.2.cmml">π΅</mi><mi id="S2.p1.7.m6.1.1.2.2.3" xref="S2.p1.7.m6.1.1.2.2.3.cmml">t</mi><mi id="S2.p1.7.m6.1.1.2.3" xref="S2.p1.7.m6.1.1.2.3.cmml">l</mi></msubsup><mo id="S2.p1.7.m6.1.1.1" xref="S2.p1.7.m6.1.1.1.cmml">β</mo><msup id="S2.p1.7.m6.1.1.3" xref="S2.p1.7.m6.1.1.3.cmml"><mi id="S2.p1.7.m6.1.1.3.2" xref="S2.p1.7.m6.1.1.3.2.cmml">β„</mi><mi id="S2.p1.7.m6.1.1.3.3" xref="S2.p1.7.m6.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m6.1b"><apply id="S2.p1.7.m6.1.1.cmml" xref="S2.p1.7.m6.1.1"><in id="S2.p1.7.m6.1.1.1.cmml" xref="S2.p1.7.m6.1.1.1"></in><apply id="S2.p1.7.m6.1.1.2.cmml" xref="S2.p1.7.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p1.7.m6.1.1.2.1.cmml" xref="S2.p1.7.m6.1.1.2">superscript</csymbol><apply id="S2.p1.7.m6.1.1.2.2.cmml" xref="S2.p1.7.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p1.7.m6.1.1.2.2.1.cmml" xref="S2.p1.7.m6.1.1.2">subscript</csymbol><ci id="S2.p1.7.m6.1.1.2.2.2.cmml" xref="S2.p1.7.m6.1.1.2.2.2">π΅</ci><ci id="S2.p1.7.m6.1.1.2.2.3.cmml" xref="S2.p1.7.m6.1.1.2.2.3">π‘΅</ci></apply><ci id="S2.p1.7.m6.1.1.2.3.cmml" xref="S2.p1.7.m6.1.1.2.3">π‘™</ci></apply><apply id="S2.p1.7.m6.1.1.3.cmml" xref="S2.p1.7.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p1.7.m6.1.1.3.1.cmml" xref="S2.p1.7.m6.1.1.3">superscript</csymbol><ci id="S2.p1.7.m6.1.1.3.2.cmml" xref="S2.p1.7.m6.1.1.3.2">β„</ci><ci id="S2.p1.7.m6.1.1.3.3.cmml" xref="S2.p1.7.m6.1.1.3.3">π‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m6.1c">\mathbf{h}_{t}^{l}\in\mathbb{R}^{d}</annotation></semantics></math> is the output hidden state of the <math id="S2.p1.8.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p1.8.m7.1a"><mi id="S2.p1.8.m7.1.1" xref="S2.p1.8.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m7.1b"><ci id="S2.p1.8.m7.1.1.cmml" xref="S2.p1.8.m7.1.1">π‘΅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m7.1c">t</annotation></semantics></math>-th token after the <math id="S2.p1.9.m8.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p1.9.m8.1a"><mi id="S2.p1.9.m8.1.1" xref="S2.p1.9.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m8.1b"><ci id="S2.p1.9.m8.1.1.cmml" xref="S2.p1.9.m8.1.1">π‘™</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m8.1c">l</annotation></semantics></math>-th Transformer block. For brevity, we omit the layer normalization in the above formulations.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p class="ltx_p" id="S2.p2.2">MoE μ–Έμ–΄ λ¨λΈμ„ κµ¬μ„±ν•λ” μΌλ°μ μΈ κ΄€ν–‰μ€ μΌλ°μ μΌλ΅ μ§€μ •λ κ°„κ²© [cite idx=0></cite>]μ—μ„ MoE κ³„μΈµμΌλ΅ Transformerμ FFNμ„ λ€μ²΄ν•λ‹¤. MoE μΈµμ€ λ‹¤μμ μ „λ¬Έκ°€λ“¤λ΅ κµ¬μ„±λλ©°, μ—¬κΈ°μ„ κ°κ°μ μ „λ¬Έκ°€λ” ν‘μ¤€ FFNκ³Ό κµ¬μ΅°μ μΌλ΅ λ™μΌν•λ‹¤. κ·Έλ° λ‹¤μ, κ° ν† ν°μ€ ν•λ‚μ <cite class="ltx_cite ltx_citemacro_citep">(Fedus etΒ al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite> λλ” λ‘ κ°μ <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin etΒ al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> μ „λ¬Έκ°€μ—κ² ν• λ‹Ήλ  κ²ƒμ΄λ‹¤. <math alttext="l" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">π‘™</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">l</annotation></semantics></math>-th FFNμ΄ MoE λ μ΄μ–΄λ΅ μΉν™λ κ²½μ°, κ·Έ μ¶λ ¥ νλ“  μ¤ν…μ΄νΈ <math alttext="\mathbf{h}_{t}^{l}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><msubsup id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2.2" xref="S2.p2.2.m2.1.1.2.2.cmml">π΅</mi><mi id="S2.p2.2.m2.1.1.2.3" xref="S2.p2.2.m2.1.1.2.3.cmml">t</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">superscript</csymbol><apply id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.2.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.2.cmml" xref="S2.p2.2.m2.1.1.2.2">π΅</ci><ci id="S2.p2.2.m2.1.1.2.3.cmml" xref="S2.p2.2.m2.1.1.2.3">π‘΅</ci></apply><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">π‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathbf{h}_{t}^{l}</annotation></semantics></math>μ— λ€ν• κ³„μ‚°μ€ λ‹¤μκ³Ό κ°™μ΄ ν‘ν„λλ‹¤:</p>
<table id="A3.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{h}_{t}^{l}" display="inline"><semantics id="S2.E3.m1.1a"><msubsup id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mi id="S2.E3.m1.1.1.2.2" xref="S2.E3.m1.1.1.2.2.cmml">π΅</mi><mi id="S2.E3.m1.1.1.2.3" xref="S2.E3.m1.1.1.2.3.cmml">t</mi><mi id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1">superscript</csymbol><apply id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.1.cmml" xref="S2.E3.m1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.2.2">π΅</ci><ci id="S2.E3.m1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3">π‘΅</ci></apply><ci id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">π‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{N}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l}," display="inline"><semantics id="S2.E3.m2.3a"><mrow id="S2.E3.m2.3.3.1" xref="S2.E3.m2.3.3.1.1.cmml"><mrow id="S2.E3.m2.3.3.1.1" xref="S2.E3.m2.3.3.1.1.cmml"><mi id="S2.E3.m2.3.3.1.1.3" xref="S2.E3.m2.3.3.1.1.3.cmml"></mi><mo id="S2.E3.m2.3.3.1.1.2" xref="S2.E3.m2.3.3.1.1.2.cmml">=</mo><mrow id="S2.E3.m2.3.3.1.1.1" xref="S2.E3.m2.3.3.1.1.1.cmml"><mrow id="S2.E3.m2.3.3.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3.m2.3.3.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.2.cmml"><munderover id="S2.E3.m2.3.3.1.1.1.1.2a" xref="S2.E3.m2.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E3.m2.3.3.1.1.1.1.2.2.2" xref="S2.E3.m2.3.3.1.1.1.1.2.2.2.cmml">β‘</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.2.2.3" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.2.2.3.2" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E3.m2.3.3.1.1.1.1.2.2.3.1" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m2.3.3.1.1.1.1.2.2.3.3" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m2.3.3.1.1.1.1.2.3" xref="S2.E3.m2.3.3.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="S2.E3.m2.2.2.2.4" xref="S2.E3.m2.2.2.2.3.cmml"><mi id="S2.E3.m2.1.1.1.1" xref="S2.E3.m2.1.1.1.1.cmml">i</mi><mo id="S2.E3.m2.2.2.2.4.1" xref="S2.E3.m2.2.2.2.3.cmml">,</mo><mi id="S2.E3.m2.2.2.2.2" xref="S2.E3.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.3.cmml">β€‹</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2a" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">β΅</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml">π®</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml">t</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m2.3.3.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.2.cmml">+</mo><msubsup id="S2.E3.m2.3.3.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.3.cmml"><mi id="S2.E3.m2.3.3.1.1.1.3.2.2" xref="S2.E3.m2.3.3.1.1.1.3.2.2.cmml">π®</mi><mi id="S2.E3.m2.3.3.1.1.1.3.2.3" xref="S2.E3.m2.3.3.1.1.1.3.2.3.cmml">t</mi><mi id="S2.E3.m2.3.3.1.1.1.3.3" xref="S2.E3.m2.3.3.1.1.1.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S2.E3.m2.3.3.1.2" xref="S2.E3.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.3b"><apply id="S2.E3.m2.3.3.1.1.cmml" xref="S2.E3.m2.3.3.1"><eq id="S2.E3.m2.3.3.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S2.E3.m2.3.3.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.3">absent</csymbol><apply id="S2.E3.m2.3.3.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1"><plus id="S2.E3.m2.3.3.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.2"></plus><apply id="S2.E3.m2.3.3.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1"><apply id="S2.E3.m2.3.3.1.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.1.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.2"></sum><apply id="S2.E3.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3"><eq id="S2.E3.m2.3.3.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m2.3.3.1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.2">π‘–</ci><cn type="integer" id="S2.E3.m2.3.3.1.1.1.1.2.2.3.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m2.3.3.1.1.1.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.2.3">π‘</ci></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1"><times id="S2.E3.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.3"></times><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.4.2">π‘”</ci><list id="S2.E3.m2.2.2.2.3.cmml" xref="S2.E3.m2.2.2.2.4"><ci id="S2.E3.m2.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1">π‘–</ci><ci id="S2.E3.m2.2.2.2.2.cmml" xref="S2.E3.m2.2.2.2.2">π‘΅</ci></list></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2"><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.2">FFN</ci><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.1.3">π‘–</ci></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">superscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2">π®</ci><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3">π‘΅</ci></apply><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3">π‘™</ci></apply></apply></apply></apply><apply id="S2.E3.m2.3.3.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.3.1.cmml" xref="S2.E3.m2.3.3.1.1.1.3">superscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.3.2.cmml" xref="S2.E3.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.3.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.3.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.3.2.2">π®</ci><ci id="S2.E3.m2.3.3.1.1.1.3.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.3.2.3">π‘΅</ci></apply><ci id="S2.E3.m2.3.3.1.1.1.3.3.cmml" xref="S2.E3.m2.3.3.1.1.1.3.3">π‘™</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.3c">\displaystyle=\sum_{i=1}^{N}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.2" class="ltx_Math" alttext="\displaystyle g_{i,t}" display="inline"><semantics id="S2.E4.m1.2a"><msub id="S2.E4.m1.2.3" xref="S2.E4.m1.2.3.cmml"><mi id="S2.E4.m1.2.3.2" xref="S2.E4.m1.2.3.2.cmml">g</mi><mrow id="S2.E4.m1.2.2.2.4" xref="S2.E4.m1.2.2.2.3.cmml"><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">i</mi><mo id="S2.E4.m1.2.2.2.4.1" xref="S2.E4.m1.2.2.2.3.cmml">,</mo><mi id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.3.cmml" xref="S2.E4.m1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.3.1.cmml" xref="S2.E4.m1.2.3">subscript</csymbol><ci id="S2.E4.m1.2.3.2.cmml" xref="S2.E4.m1.2.3.2">π‘”</ci><list id="S2.E4.m1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.4"><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">π‘–</ci><ci id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2">π‘΅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\displaystyle g_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.4" class="ltx_Math" alttext="\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1\leqslant j\leqslant N\},K),\\
0,&amp;\text{otherwise},\end{cases}" display="inline"><semantics id="S2.E4.m2.4a"><mrow id="S2.E4.m2.4.5" xref="S2.E4.m2.4.5.cmml"><mi id="S2.E4.m2.4.5.2" xref="S2.E4.m2.4.5.2.cmml"></mi><mo id="S2.E4.m2.4.5.1" xref="S2.E4.m2.4.5.1.cmml">=</mo><mrow id="S2.E4.m2.4.4a" xref="S2.E4.m2.4.5.3.1.cmml"><mo id="S2.E4.m2.4.4a.5" xref="S2.E4.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S2.E4.m2.4.4.4a" xref="S2.E4.m2.4.5.3.1.cmml"><mtr id="S2.E4.m2.4.4.4aa" xref="S2.E4.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4ab" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.1.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.1.3.1.cmml"><msub id="S2.E4.m2.1.1.1.1.1.1.3.1" xref="S2.E4.m2.1.1.1.1.1.1.3.1.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.3.1.2" xref="S2.E4.m2.1.1.1.1.1.1.3.1.2.cmml">s</mi><mrow id="S2.E4.m2.1.1.1.1.1.1.2.2.4" xref="S2.E4.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E4.m2.1.1.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S2.E4.m2.1.1.1.1.1.1.2.2.4.1" xref="S2.E4.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S2.E4.m2.1.1.1.1.1.1.2.2.2" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S2.E4.m2.1.1.1.1.1.1.3.2" xref="S2.E4.m2.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4ac" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.2.2.2.2.2.1.7" xref="S2.E4.m2.2.2.2.2.2.1.7.1.cmml"><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.cmml"><msub id="S2.E4.m2.2.2.2.2.2.1.7.1.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.3.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3.2.cmml">s</mi><mrow id="S2.E4.m2.2.2.2.2.2.1.2.2.4" xref="S2.E4.m2.2.2.2.2.2.1.2.2.3.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.1.1.1.cmml">i</mi><mo id="S2.E4.m2.2.2.2.2.2.1.2.2.4.1" xref="S2.E4.m2.2.2.2.2.2.1.2.2.3.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2.2.1.2.2.2" xref="S2.E4.m2.2.2.2.2.2.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.2.cmml">β</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.5" xref="S2.E4.m2.2.2.2.2.2.1.5.cmml">Topk</mi><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1a" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">β΅</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">(</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml">{</mo><msub id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S2.E4.m2.2.2.2.2.2.1.4.2.4" xref="S2.E4.m2.2.2.2.2.2.1.4.2.3.cmml"><mi id="S2.E4.m2.2.2.2.2.2.1.3.1.1" xref="S2.E4.m2.2.2.2.2.2.1.3.1.1.cmml">j</mi><mo id="S2.E4.m2.2.2.2.2.2.1.4.2.4.1" xref="S2.E4.m2.2.2.2.2.2.1.4.2.3.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2.2.1.4.2.2" xref="S2.E4.m2.2.2.2.2.2.1.4.2.2.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.4" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.cmml"><mn id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2.cmml">1</mn><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3.cmml">β©½</mo><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4.cmml">j</mi><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5.cmml">β©½</mo><mi id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6.cmml">N</mi></mrow><mo stretchy="false" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.5" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.3" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2.2.1.6" xref="S2.E4.m2.2.2.2.2.2.1.6.cmml">K</mi><mo stretchy="false" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.4" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m2.2.2.2.2.2.1.7.2" xref="S2.E4.m2.2.2.2.2.2.1.7.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S2.E4.m2.4.4.4ad" xref="S2.E4.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4ae" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.3.3.3.3.1.1.3" xref="S2.E4.m2.4.5.3.1.cmml"><mn id="S2.E4.m2.3.3.3.3.1.1.1" xref="S2.E4.m2.3.3.3.3.1.1.1.cmml">0</mn><mo id="S2.E4.m2.3.3.3.3.1.1.3.1" xref="S2.E4.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m2.4.4.4af" xref="S2.E4.m2.4.5.3.1.cmml"><mrow id="S2.E4.m2.4.4.4.4.2.1.3" xref="S2.E4.m2.4.4.4.4.2.1.1a.cmml"><mtext id="S2.E4.m2.4.4.4.4.2.1.1" xref="S2.E4.m2.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S2.E4.m2.4.4.4.4.2.1.3.1" xref="S2.E4.m2.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.4b"><apply id="S2.E4.m2.4.5.cmml" xref="S2.E4.m2.4.5"><eq id="S2.E4.m2.4.5.1.cmml" xref="S2.E4.m2.4.5.1"></eq><csymbol cd="latexml" id="S2.E4.m2.4.5.2.cmml" xref="S2.E4.m2.4.5.2">absent</csymbol><apply id="S2.E4.m2.4.5.3.1.cmml" xref="S2.E4.m2.4.4a"><csymbol cd="latexml" id="S2.E4.m2.4.5.3.1.1.cmml" xref="S2.E4.m2.4.4a.5">cases</csymbol><apply id="S2.E4.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.1.3.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.1.1.3.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.3.1.2">π‘ </ci><list id="S2.E4.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.4"><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1">π‘–</ci><ci id="S2.E4.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.2.2.2">π‘΅</ci></list></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7"><in id="S2.E4.m2.2.2.2.2.2.1.7.1.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.2"></in><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.2.2.2.1.7.1.3.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3">subscript</csymbol><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.3.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.3.2">π‘ </ci><list id="S2.E4.m2.2.2.2.2.2.1.2.2.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.2.2.4"><ci id="S2.E4.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.1.1.1">π‘–</ci><ci id="S2.E4.m2.2.2.2.2.2.1.2.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.2.2.2">π‘΅</ci></list></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1"><ci id="S2.E4.m2.2.2.2.2.2.1.5.cmml" xref="S2.E4.m2.2.2.2.2.2.1.5">Topk</ci><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.1.1.2">π‘ </ci><list id="S2.E4.m2.2.2.2.2.2.1.4.2.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.4.2.4"><ci id="S2.E4.m2.2.2.2.2.2.1.3.1.1.cmml" xref="S2.E4.m2.2.2.2.2.2.1.3.1.1">π‘—</ci><ci id="S2.E4.m2.2.2.2.2.2.1.4.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.4.2.2">π‘΅</ci></list></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"><and id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2a.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"></and><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2b.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"><leq id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.3"></leq><cn type="integer" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.2">1</cn><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4">π‘—</ci></apply><apply id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2c.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"><leq id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.5"></leq><share href="#S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.4.cmml" id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2d.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2"></share><ci id="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6.cmml" xref="S2.E4.m2.2.2.2.2.2.1.7.1.1.1.1.1.2.2.6">π‘</ci></apply></apply></apply><ci id="S2.E4.m2.2.2.2.2.2.1.6.cmml" xref="S2.E4.m2.2.2.2.2.2.1.6">πΎ</ci></apply></apply><cn type="integer" id="S2.E4.m2.3.3.3.3.1.1.1.cmml" xref="S2.E4.m2.3.3.3.3.1.1.1">0</cn><ci id="S2.E4.m2.4.4.4.4.2.1.1a.cmml" xref="S2.E4.m2.4.4.4.4.2.1.3"><mtext id="S2.E4.m2.4.4.4.4.2.1.1.cmml" xref="S2.E4.m2.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.4c">\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1\leqslant j\leqslant N\},K),\\
0,&amp;\text{otherwise},\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.2" class="ltx_Math" alttext="\displaystyle s_{i,t}" display="inline"><semantics id="S2.E5.m1.2a"><msub id="S2.E5.m1.2.3" xref="S2.E5.m1.2.3.cmml"><mi id="S2.E5.m1.2.3.2" xref="S2.E5.m1.2.3.2.cmml">s</mi><mrow id="S2.E5.m1.2.2.2.4" xref="S2.E5.m1.2.2.2.3.cmml"><mi id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">i</mi><mo id="S2.E5.m1.2.2.2.4.1" xref="S2.E5.m1.2.2.2.3.cmml">,</mo><mi id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.3.cmml" xref="S2.E5.m1.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.3.1.cmml" xref="S2.E5.m1.2.3">subscript</csymbol><ci id="S2.E5.m1.2.3.2.cmml" xref="S2.E5.m1.2.3.2">π‘ </ci><list id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.4"><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">π‘–</ci><ci id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2">π‘΅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">\displaystyle s_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5.m2.1" class="ltx_Math" alttext="\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right)," display="inline"><semantics id="S2.E5.m2.1a"><mrow id="S2.E5.m2.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.4" xref="S2.E5.m2.1.1.1.1.4.cmml"></mi><mo id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.3.cmml">=</mo><mrow id="S2.E5.m2.1.1.1.1.2.2" xref="S2.E5.m2.1.1.1.1.2.3.cmml"><msub id="S2.E5.m2.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.1.1.2.cmml">Softmax</mi><mi id="S2.E5.m2.1.1.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E5.m2.1.1.1.1.2.2a" xref="S2.E5.m2.1.1.1.1.2.3.cmml">β΅</mo><mrow id="S2.E5.m2.1.1.1.1.2.2.2" xref="S2.E5.m2.1.1.1.1.2.3.cmml"><mo id="S2.E5.m2.1.1.1.1.2.2.2.2" xref="S2.E5.m2.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.E5.m2.1.1.1.1.2.2.2.1" xref="S2.E5.m2.1.1.1.1.2.2.2.1.cmml"><mmultiscripts id="S2.E5.m2.1.1.1.1.2.2.2.1.2" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.cmml"><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml">π®</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml">t</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3.cmml">l</mi><mrow id="S2.E5.m2.1.1.1.1.2.2.2.1.2a" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.cmml"></mrow><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.2.2.2.1.1" xref="S2.E5.m2.1.1.1.1.2.2.2.1.1.cmml">β€‹</mo><msubsup id="S2.E5.m2.1.1.1.1.2.2.2.1.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.cmml"><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2.cmml">π</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi><mi id="S2.E5.m2.1.1.1.1.2.2.2.1.3.3" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S2.E5.m2.1.1.1.1.2.2.2.3" xref="S2.E5.m2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m2.1.1.1.2" xref="S2.E5.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.1b"><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1"><eq id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.4.cmml" xref="S2.E5.m2.1.1.1.1.4">absent</csymbol><apply id="S2.E5.m2.1.1.1.1.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2"><apply id="S2.E5.m2.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.2">Softmax</ci><ci id="S2.E5.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.3">π‘–</ci></apply><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1"><times id="S2.E5.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.1"></times><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.2">π®</ci><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.2.3">π‘΅</ci></apply><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.2.3">π‘™</ci></apply><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.2.3">π‘‡</ci></apply><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.3.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3">superscript</csymbol><apply id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.2">π</ci><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.2.3">π‘–</ci></apply><ci id="S2.E5.m2.1.1.1.1.2.2.2.1.3.3.cmml" xref="S2.E5.m2.1.1.1.1.2.2.2.1.3.3">π‘™</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.1c">\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.p2.19" class="ltx_p">where <math id="S2.p2.3.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p2.3.m1.1a"><mi id="S2.p2.3.m1.1.1" xref="S2.p2.3.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m1.1b"><ci id="S2.p2.3.m1.1.1.cmml" xref="S2.p2.3.m1.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m1.1c">N</annotation></semantics></math> denotes the total number of experts, <math id="S2.p2.4.m2.2" class="ltx_Math" alttext="\operatorname{FFN}_{i}(\cdot)" display="inline"><semantics id="S2.p2.4.m2.2a"><mrow id="S2.p2.4.m2.2.2.1" xref="S2.p2.4.m2.2.2.2.cmml"><msub id="S2.p2.4.m2.2.2.1.1" xref="S2.p2.4.m2.2.2.1.1.cmml"><mi id="S2.p2.4.m2.2.2.1.1.2" xref="S2.p2.4.m2.2.2.1.1.2.cmml">FFN</mi><mi id="S2.p2.4.m2.2.2.1.1.3" xref="S2.p2.4.m2.2.2.1.1.3.cmml">i</mi></msub><mo id="S2.p2.4.m2.2.2.1a" xref="S2.p2.4.m2.2.2.2.cmml">β΅</mo><mrow id="S2.p2.4.m2.2.2.1.2" xref="S2.p2.4.m2.2.2.2.cmml"><mo stretchy="false" id="S2.p2.4.m2.2.2.1.2.1" xref="S2.p2.4.m2.2.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.4.m2.1.1" xref="S2.p2.4.m2.1.1.cmml">β‹…</mo><mo stretchy="false" id="S2.p2.4.m2.2.2.1.2.2" xref="S2.p2.4.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m2.2b"><apply id="S2.p2.4.m2.2.2.2.cmml" xref="S2.p2.4.m2.2.2.1"><apply id="S2.p2.4.m2.2.2.1.1.cmml" xref="S2.p2.4.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m2.2.2.1.1.1.cmml" xref="S2.p2.4.m2.2.2.1.1">subscript</csymbol><ci id="S2.p2.4.m2.2.2.1.1.2.cmml" xref="S2.p2.4.m2.2.2.1.1.2">FFN</ci><ci id="S2.p2.4.m2.2.2.1.1.3.cmml" xref="S2.p2.4.m2.2.2.1.1.3">π‘–</ci></apply><ci id="S2.p2.4.m2.1.1.cmml" xref="S2.p2.4.m2.1.1">β‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m2.2c">\operatorname{FFN}_{i}(\cdot)</annotation></semantics></math> is the <math id="S2.p2.5.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.5.m3.1a"><mi id="S2.p2.5.m3.1.1" xref="S2.p2.5.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.5.m3.1b"><ci id="S2.p2.5.m3.1.1.cmml" xref="S2.p2.5.m3.1.1">π‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m3.1c">i</annotation></semantics></math>-th expert FFN, <math id="S2.p2.6.m4.2" class="ltx_Math" alttext="g_{i,t}" display="inline"><semantics id="S2.p2.6.m4.2a"><msub id="S2.p2.6.m4.2.3" xref="S2.p2.6.m4.2.3.cmml"><mi id="S2.p2.6.m4.2.3.2" xref="S2.p2.6.m4.2.3.2.cmml">g</mi><mrow id="S2.p2.6.m4.2.2.2.4" xref="S2.p2.6.m4.2.2.2.3.cmml"><mi id="S2.p2.6.m4.1.1.1.1" xref="S2.p2.6.m4.1.1.1.1.cmml">i</mi><mo id="S2.p2.6.m4.2.2.2.4.1" xref="S2.p2.6.m4.2.2.2.3.cmml">,</mo><mi id="S2.p2.6.m4.2.2.2.2" xref="S2.p2.6.m4.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.6.m4.2b"><apply id="S2.p2.6.m4.2.3.cmml" xref="S2.p2.6.m4.2.3"><csymbol cd="ambiguous" id="S2.p2.6.m4.2.3.1.cmml" xref="S2.p2.6.m4.2.3">subscript</csymbol><ci id="S2.p2.6.m4.2.3.2.cmml" xref="S2.p2.6.m4.2.3.2">π‘”</ci><list id="S2.p2.6.m4.2.2.2.3.cmml" xref="S2.p2.6.m4.2.2.2.4"><ci id="S2.p2.6.m4.1.1.1.1.cmml" xref="S2.p2.6.m4.1.1.1.1">π‘–</ci><ci id="S2.p2.6.m4.2.2.2.2.cmml" xref="S2.p2.6.m4.2.2.2.2">π‘΅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m4.2c">g_{i,t}</annotation></semantics></math> denotes the gate value for the <math id="S2.p2.7.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.7.m5.1a"><mi id="S2.p2.7.m5.1.1" xref="S2.p2.7.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m5.1b"><ci id="S2.p2.7.m5.1.1.cmml" xref="S2.p2.7.m5.1.1">π‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m5.1c">i</annotation></semantics></math>-th expert, <math id="S2.p2.8.m6.2" class="ltx_Math" alttext="s_{i,t}" display="inline"><semantics id="S2.p2.8.m6.2a"><msub id="S2.p2.8.m6.2.3" xref="S2.p2.8.m6.2.3.cmml"><mi id="S2.p2.8.m6.2.3.2" xref="S2.p2.8.m6.2.3.2.cmml">s</mi><mrow id="S2.p2.8.m6.2.2.2.4" xref="S2.p2.8.m6.2.2.2.3.cmml"><mi id="S2.p2.8.m6.1.1.1.1" xref="S2.p2.8.m6.1.1.1.1.cmml">i</mi><mo id="S2.p2.8.m6.2.2.2.4.1" xref="S2.p2.8.m6.2.2.2.3.cmml">,</mo><mi id="S2.p2.8.m6.2.2.2.2" xref="S2.p2.8.m6.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.8.m6.2b"><apply id="S2.p2.8.m6.2.3.cmml" xref="S2.p2.8.m6.2.3"><csymbol cd="ambiguous" id="S2.p2.8.m6.2.3.1.cmml" xref="S2.p2.8.m6.2.3">subscript</csymbol><ci id="S2.p2.8.m6.2.3.2.cmml" xref="S2.p2.8.m6.2.3.2">π‘ </ci><list id="S2.p2.8.m6.2.2.2.3.cmml" xref="S2.p2.8.m6.2.2.2.4"><ci id="S2.p2.8.m6.1.1.1.1.cmml" xref="S2.p2.8.m6.1.1.1.1">π‘–</ci><ci id="S2.p2.8.m6.2.2.2.2.cmml" xref="S2.p2.8.m6.2.2.2.2">π‘΅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m6.2c">s_{i,t}</annotation></semantics></math> denotes the token-to-expert affinity, <math id="S2.p2.9.m7.3" class="ltx_Math" alttext="\operatorname{Topk}(\cdot,K)" display="inline"><semantics id="S2.p2.9.m7.3a"><mrow id="S2.p2.9.m7.3.4.2" xref="S2.p2.9.m7.3.4.1.cmml"><mi id="S2.p2.9.m7.1.1" xref="S2.p2.9.m7.1.1.cmml">Topk</mi><mo id="S2.p2.9.m7.3.4.2a" xref="S2.p2.9.m7.3.4.1.cmml">β΅</mo><mrow id="S2.p2.9.m7.3.4.2.1" xref="S2.p2.9.m7.3.4.1.cmml"><mo stretchy="false" id="S2.p2.9.m7.3.4.2.1.1" xref="S2.p2.9.m7.3.4.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.9.m7.2.2" xref="S2.p2.9.m7.2.2.cmml">β‹…</mo><mo id="S2.p2.9.m7.3.4.2.1.2" xref="S2.p2.9.m7.3.4.1.cmml">,</mo><mi id="S2.p2.9.m7.3.3" xref="S2.p2.9.m7.3.3.cmml">K</mi><mo stretchy="false" id="S2.p2.9.m7.3.4.2.1.3" xref="S2.p2.9.m7.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m7.3b"><apply id="S2.p2.9.m7.3.4.1.cmml" xref="S2.p2.9.m7.3.4.2"><ci id="S2.p2.9.m7.1.1.cmml" xref="S2.p2.9.m7.1.1">Topk</ci><ci id="S2.p2.9.m7.2.2.cmml" xref="S2.p2.9.m7.2.2">β‹…</ci><ci id="S2.p2.9.m7.3.3.cmml" xref="S2.p2.9.m7.3.3">πΎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m7.3c">\operatorname{Topk}(\cdot,K)</annotation></semantics></math> denotes the set comprising <math id="S2.p2.10.m8.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.10.m8.1a"><mi id="S2.p2.10.m8.1.1" xref="S2.p2.10.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.10.m8.1b"><ci id="S2.p2.10.m8.1.1.cmml" xref="S2.p2.10.m8.1.1">πΎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m8.1c">K</annotation></semantics></math> highest affinity scores among those calculated for the <math id="S2.p2.11.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p2.11.m9.1a"><mi id="S2.p2.11.m9.1.1" xref="S2.p2.11.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p2.11.m9.1b"><ci id="S2.p2.11.m9.1.1.cmml" xref="S2.p2.11.m9.1.1">π‘΅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m9.1c">t</annotation></semantics></math>-th token and all <math id="S2.p2.12.m10.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p2.12.m10.1a"><mi id="S2.p2.12.m10.1.1" xref="S2.p2.12.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.12.m10.1b"><ci id="S2.p2.12.m10.1.1.cmml" xref="S2.p2.12.m10.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m10.1c">N</annotation></semantics></math> experts, and <math id="S2.p2.13.m11.1" class="ltx_Math" alttext="\mathbf{e}_{i}^{l}" display="inline"><semantics id="S2.p2.13.m11.1a"><msubsup id="S2.p2.13.m11.1.1" xref="S2.p2.13.m11.1.1.cmml"><mi id="S2.p2.13.m11.1.1.2.2" xref="S2.p2.13.m11.1.1.2.2.cmml">π</mi><mi id="S2.p2.13.m11.1.1.2.3" xref="S2.p2.13.m11.1.1.2.3.cmml">i</mi><mi id="S2.p2.13.m11.1.1.3" xref="S2.p2.13.m11.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.p2.13.m11.1b"><apply id="S2.p2.13.m11.1.1.cmml" xref="S2.p2.13.m11.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m11.1.1.1.cmml" xref="S2.p2.13.m11.1.1">superscript</csymbol><apply id="S2.p2.13.m11.1.1.2.cmml" xref="S2.p2.13.m11.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m11.1.1.2.1.cmml" xref="S2.p2.13.m11.1.1">subscript</csymbol><ci id="S2.p2.13.m11.1.1.2.2.cmml" xref="S2.p2.13.m11.1.1.2.2">π</ci><ci id="S2.p2.13.m11.1.1.2.3.cmml" xref="S2.p2.13.m11.1.1.2.3">π‘–</ci></apply><ci id="S2.p2.13.m11.1.1.3.cmml" xref="S2.p2.13.m11.1.1.3">π‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m11.1c">\mathbf{e}_{i}^{l}</annotation></semantics></math> is the centroid of the <math id="S2.p2.14.m12.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.14.m12.1a"><mi id="S2.p2.14.m12.1.1" xref="S2.p2.14.m12.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.14.m12.1b"><ci id="S2.p2.14.m12.1.1.cmml" xref="S2.p2.14.m12.1.1">π‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.14.m12.1c">i</annotation></semantics></math>-th expert in the <math id="S2.p2.15.m13.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p2.15.m13.1a"><mi id="S2.p2.15.m13.1.1" xref="S2.p2.15.m13.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p2.15.m13.1b"><ci id="S2.p2.15.m13.1.1.cmml" xref="S2.p2.15.m13.1.1">π‘™</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.15.m13.1c">l</annotation></semantics></math>-th layer. Note that <math id="S2.p2.16.m14.2" class="ltx_Math" alttext="g_{i,t}" display="inline"><semantics id="S2.p2.16.m14.2a"><msub id="S2.p2.16.m14.2.3" xref="S2.p2.16.m14.2.3.cmml"><mi id="S2.p2.16.m14.2.3.2" xref="S2.p2.16.m14.2.3.2.cmml">g</mi><mrow id="S2.p2.16.m14.2.2.2.4" xref="S2.p2.16.m14.2.2.2.3.cmml"><mi id="S2.p2.16.m14.1.1.1.1" xref="S2.p2.16.m14.1.1.1.1.cmml">i</mi><mo id="S2.p2.16.m14.2.2.2.4.1" xref="S2.p2.16.m14.2.2.2.3.cmml">,</mo><mi id="S2.p2.16.m14.2.2.2.2" xref="S2.p2.16.m14.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p2.16.m14.2b"><apply id="S2.p2.16.m14.2.3.cmml" xref="S2.p2.16.m14.2.3"><csymbol cd="ambiguous" id="S2.p2.16.m14.2.3.1.cmml" xref="S2.p2.16.m14.2.3">subscript</csymbol><ci id="S2.p2.16.m14.2.3.2.cmml" xref="S2.p2.16.m14.2.3.2">π‘”</ci><list id="S2.p2.16.m14.2.2.2.3.cmml" xref="S2.p2.16.m14.2.2.2.4"><ci id="S2.p2.16.m14.1.1.1.1.cmml" xref="S2.p2.16.m14.1.1.1.1">π‘–</ci><ci id="S2.p2.16.m14.2.2.2.2.cmml" xref="S2.p2.16.m14.2.2.2.2">π‘΅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.16.m14.2c">g_{i,t}</annotation></semantics></math> is sparse, indicating that only <math id="S2.p2.17.m15.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.17.m15.1a"><mi id="S2.p2.17.m15.1.1" xref="S2.p2.17.m15.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.17.m15.1b"><ci id="S2.p2.17.m15.1.1.cmml" xref="S2.p2.17.m15.1.1">πΎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.17.m15.1c">K</annotation></semantics></math> out of <math id="S2.p2.18.m16.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p2.18.m16.1a"><mi id="S2.p2.18.m16.1.1" xref="S2.p2.18.m16.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p2.18.m16.1b"><ci id="S2.p2.18.m16.1.1.cmml" xref="S2.p2.18.m16.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.18.m16.1c">N</annotation></semantics></math> gate values are nonzero. This sparsity property ensures computational efficiency within an MoE layer, i.e., each token will be assigned to and computed in only <math id="S2.p2.19.m17.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.19.m17.1a"><mi id="S2.p2.19.m17.1.1" xref="S2.p2.19.m17.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.19.m17.1b"><ci id="S2.p2.19.m17.1.1.cmml" xref="S2.p2.19.m17.1.1">πΎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.19.m17.1c">K</annotation></semantics></math> experts. Also, in the above formulations, we omit the layer normalization operation for brevity.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="221" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">κ·Έλ¦Ό 2:</span></figcaption>
Illustration of DeepSeekMoE.
Subfigure (a) showcases an MoE layer with the conventional top-2 routing strategy.
Subfigure (b) illustrates the fine-grained expert segmentation strategy.
Subsequently, subfigure (c) demonstrates the integration of the shared expert isolation strategy, constituting the complete DeepSeekMoE architecture.
It is noteworthy that across these three architectures, the number of expert parameters and computational costs remain constant.
</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>DeepSeekMoE Architecture</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p" id="S3.p1.1">μ„Ήμ… <a class="ltx_ref" href="#S2" title="2 Preliminaries: Mixture-of-Experts for Transformers β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>μ— μ”μ•½λ μΌλ°μ μΈ MoE μ•„ν‚¤ν…μ² μ„μ— μ „λ¬Έκ°€ μ „λ¬Έν™”μ μ μ¬λ ¥μ„ ν™μ©ν•κΈ° μ„ν•΄ νΉλ³„ν μ„¤κ³„λ DeepSeekMoEλ¥Ό μ†κ°ν•λ‹¤. <a class="ltx_ref" href="#S2.F2" title="Figure 2 β€£ 2 Preliminaries: Mixture-of-Experts for Transformers β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>μ— μμ‹λ λ°”μ™€ κ°™μ΄, μ°λ¦¬μ μ•„ν‚¤ν…μ²λ” μ„Έλ°€ν• μ „λ¬Έκ°€ λ¶„ν• κ³Ό κ³µμ  μ „λ¬Έκ°€ κ²©λ¦¬μ λ‘ κ°€μ§€ μ£Όμ” μ „λµμ„ ν†µν•©ν•λ‹¤. μ΄ λ‘ κ°€μ§€ μ „λµμ€ λ¨λ‘ μ „λ¬Έκ°€ μ „λ¬Έν™”μ μμ¤€μ„ λ†’μ΄κΈ° μ„ν•΄ κ³ μ•λμ—λ‹¤.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Fine-Grained Expert Segmentation</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS1.p1.1">μ „λ¬Έκ°€ μκ°€ μ ν•λ μ‹λ‚λ¦¬μ¤μ—μ„ νΉμ • μ „λ¬Έκ°€μ—κ² ν• λ‹Ήλ ν† ν°μ€ λ‹¤μ–‘ν• μ ν•μ μ§€μ‹μ„ λ‹¤λ£° κ°€λ¥μ„±μ΄ λ” λ†’λ‹¤. μ΄μ— λ”°λΌ μ§€μ • μ „λ¬Έκ°€λ” λ§¤κ° λ³€μμ—μ„ λ§¤μ° λ‹¤μ–‘ν• μ ν•μ μ§€μ‹μ„ ν•™μµν•  κ³„νμ΄λ©° λ™μ‹μ— ν™μ©λκΈ° μ–΄λ µλ‹¤. κ·Έλ¬λ‚ κ° ν† ν°μ΄ λ” λ§μ€ μ „λ¬Έκ°€μ—κ² λΌμ°ν…λ  μ μλ‹¤λ©΄ λ‹¤μ–‘ν• μ§€μ‹μ€ κ°κ° λ‹¤λ¥Έ μ „λ¬Έκ°€μ—μ„ λ¶„ν•΄λκ³  ν•™μµλ  μ μ¬λ ¥μ„ μ–»μ„ κ²ƒμ΄λ‹¤. μ΄λ¬ν• λ§¥λ½μ—μ„ κ° μ „λ¬Έκ°€λ” μ—¬μ „ν λ†’μ€ μμ¤€μ μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό μ μ§€ν•  μ μμ–΄ μ „λ¬Έκ°€ μ „λ°μ— κ±Έμ³ λ³΄λ‹¤ μ§‘μ¤‘λ μ§€μ‹ λ¶„λ°°μ— κΈ°μ—¬ν•  μ μλ‹¤.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p class="ltx_p" id="S3.SS1.p2.3">λ©ν‘ λ‹¬μ„±μ„ μ„ν•΄ μΌκ΄€λ μμ μ „λ¬Έκ°€ λ§¤κ°λ³€μμ™€ κ³„μ‚° λΉ„μ©μ„ μ μ§€ν•λ©΄μ„ λ” λ―Έμ„Έν• κ·Έλ μΈμΌλ΅ μ „λ¬Έκ°€λ¥Ό λ¶„ν• ν•λ‹¤. λ” λ―Έμ„Έν• μ „λ¬Έκ°€ μ„Έλ¶„ν™”λ” ν™μ„±ν™”λ μ „λ¬Έκ°€μ λ³΄λ‹¤ μ μ—°ν•κ³  μ μ‘ κ°€λ¥ν• μ΅°ν•©μ„ κ°€λ¥ν•κ² ν•λ‹¤. κµ¬μ²΄μ μΌλ΅, κ·Έλ¦Ό <a class="ltx_ref" href="#S2.F2" title="Figure 2 β€£ 2 Preliminaries: Mixture-of-Experts for Transformers β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(a)μ— λ„μ‹λ μ „ν•μ μΈ MoE μ•„ν‚¤ν…μ² μ„μ—, FFN μ¤‘κ°„ μ€λ‹‰ μ°¨μ›μ„ μ›λ ν¬κΈ°μ <math alttext="\frac{1}{m}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mfrac id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mn id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">1</mn><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">m</mi></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><divide id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"></divide><cn id="S3.SS1.p2.2.m2.1.1.2.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.2">1</cn><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">π‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\frac{1}{m}</annotation></semantics></math>λ°°λ΅ μ¤„μ„μΌλ΅μ¨ κ° μ „λ¬Έκ°€ FFNμ„ <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">m</annotation></semantics></math> λ” μ‘μ€ μ „λ¬Έκ°€λ΅ λ¶„ν• ν•λ‹¤. κ° μ „λ¬Έκ°€κ°€ μ‘μ•„μ§€κΈ° λ•λ¬Έμ—, μ΄μ— μ‘λ‹µν•μ—¬, κ·Έλ¦Ό <a class="ltx_ref" href="#S2.F2" title="Figure 2 β€£ 2 Preliminaries: Mixture-of-Experts for Transformers β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(b)μ— μμ‹λ λ°”μ™€ κ°™μ΄, λ™μΌν• κ³„μ‚° λΉ„μ©μ„ μ μ§€ν•κΈ° μ„ν•΄ ν™μ„±ν™”λ μ „λ¬Έκ°€μ μλ¥Ό <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">m</annotation></semantics></math> μ‹κ°„μΌλ΅ μ¦κ°€μ‹ν‚¨λ‹¤. λ―Έμ„Έ-κ²°μ •ν™”λ μ „λ¬Έκ°€ μ„Έκ·Έλ¨Όν…μ΄μ…μ— μν•΄, MoE λ μ΄μ–΄μ μ¶λ ¥μ€ λ‹¤μκ³Ό κ°™μ΄ ν‘ν„λ  μ μλ‹¤:</p>
<table id="A3.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{h}_{t}^{l}" display="inline"><semantics id="S3.E6.m1.1a"><msubsup id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml">π΅</mi><mi id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3.cmml">t</mi><mi id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1">superscript</csymbol><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2">π΅</ci><ci id="S3.E6.m1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.2.3">π‘΅</ci></apply><ci id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">π‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l}," display="inline"><semantics id="S3.E6.m2.3a"><mrow id="S3.E6.m2.3.3.1" xref="S3.E6.m2.3.3.1.1.cmml"><mrow id="S3.E6.m2.3.3.1.1" xref="S3.E6.m2.3.3.1.1.cmml"><mi id="S3.E6.m2.3.3.1.1.3" xref="S3.E6.m2.3.3.1.1.3.cmml"></mi><mo id="S3.E6.m2.3.3.1.1.2" xref="S3.E6.m2.3.3.1.1.2.cmml">=</mo><mrow id="S3.E6.m2.3.3.1.1.1" xref="S3.E6.m2.3.3.1.1.1.cmml"><mrow id="S3.E6.m2.3.3.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E6.m2.3.3.1.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.1.2.cmml"><munderover id="S3.E6.m2.3.3.1.1.1.1.2a" xref="S3.E6.m2.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E6.m2.3.3.1.1.1.1.2.2.2" xref="S3.E6.m2.3.3.1.1.1.1.2.2.2.cmml">β‘</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.2.2.3" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.2.2.3.2" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E6.m2.3.3.1.1.1.1.2.2.3.1" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m2.3.3.1.1.1.1.2.2.3.3" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m2.3.3.1.1.1.1.2.3" xref="S3.E6.m2.3.3.1.1.1.1.2.3.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.2.3.2" xref="S3.E6.m2.3.3.1.1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E6.m2.3.3.1.1.1.1.2.3.1" xref="S3.E6.m2.3.3.1.1.1.1.2.3.1.cmml">β€‹</mo><mi id="S3.E6.m2.3.3.1.1.1.1.2.3.3" xref="S3.E6.m2.3.3.1.1.1.1.2.3.3.cmml">N</mi></mrow></munderover></mstyle><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="S3.E6.m2.2.2.2.4" xref="S3.E6.m2.2.2.2.3.cmml"><mi id="S3.E6.m2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml">i</mi><mo id="S3.E6.m2.2.2.2.4.1" xref="S3.E6.m2.2.2.2.3.cmml">,</mo><mi id="S3.E6.m2.2.2.2.2" xref="S3.E6.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.3.cmml">β€‹</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2a" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">β΅</mo><mrow id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml">π®</mi><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml">t</mi><mi id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m2.3.3.1.1.1.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m2.3.3.1.1.1.2" xref="S3.E6.m2.3.3.1.1.1.2.cmml">+</mo><msubsup id="S3.E6.m2.3.3.1.1.1.3" xref="S3.E6.m2.3.3.1.1.1.3.cmml"><mi id="S3.E6.m2.3.3.1.1.1.3.2.2" xref="S3.E6.m2.3.3.1.1.1.3.2.2.cmml">π®</mi><mi id="S3.E6.m2.3.3.1.1.1.3.2.3" xref="S3.E6.m2.3.3.1.1.1.3.2.3.cmml">t</mi><mi id="S3.E6.m2.3.3.1.1.1.3.3" xref="S3.E6.m2.3.3.1.1.1.3.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S3.E6.m2.3.3.1.2" xref="S3.E6.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.3b"><apply id="S3.E6.m2.3.3.1.1.cmml" xref="S3.E6.m2.3.3.1"><eq id="S3.E6.m2.3.3.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E6.m2.3.3.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.3">absent</csymbol><apply id="S3.E6.m2.3.3.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1"><plus id="S3.E6.m2.3.3.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.2"></plus><apply id="S3.E6.m2.3.3.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1"><apply id="S3.E6.m2.3.3.1.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E6.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E6.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3"><eq id="S3.E6.m2.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m2.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.2">π‘–</ci><cn type="integer" id="S3.E6.m2.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E6.m2.3.3.1.1.1.1.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3"><times id="S3.E6.m2.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3.1"></times><ci id="S3.E6.m2.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3.2">π‘</ci><ci id="S3.E6.m2.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.2.3.3">π‘</ci></apply></apply><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1"><times id="S3.E6.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.3"></times><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.4.2">π‘”</ci><list id="S3.E6.m2.2.2.2.3.cmml" xref="S3.E6.m2.2.2.2.4"><ci id="S3.E6.m2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1">π‘–</ci><ci id="S3.E6.m2.2.2.2.2.cmml" xref="S3.E6.m2.2.2.2.2">π‘΅</ci></list></apply><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2"><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.2">FFN</ci><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.1.1.1.3">π‘–</ci></apply><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">superscript</csymbol><apply id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.2">π®</ci><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.2.3">π‘΅</ci></apply><ci id="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.1.1.1.1.2.2.2.1.3">π‘™</ci></apply></apply></apply></apply><apply id="S3.E6.m2.3.3.1.1.1.3.cmml" xref="S3.E6.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.3.1.cmml" xref="S3.E6.m2.3.3.1.1.1.3">superscript</csymbol><apply id="S3.E6.m2.3.3.1.1.1.3.2.cmml" xref="S3.E6.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.3.3.1.1.1.3.2.1.cmml" xref="S3.E6.m2.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E6.m2.3.3.1.1.1.3.2.2.cmml" xref="S3.E6.m2.3.3.1.1.1.3.2.2">π®</ci><ci id="S3.E6.m2.3.3.1.1.1.3.2.3.cmml" xref="S3.E6.m2.3.3.1.1.1.3.2.3">π‘΅</ci></apply><ci id="S3.E6.m2.3.3.1.1.1.3.3.cmml" xref="S3.E6.m2.3.3.1.1.1.3.3">π‘™</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.3c">\displaystyle=\sum_{i=1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.2" class="ltx_Math" alttext="\displaystyle g_{i,t}" display="inline"><semantics id="S3.E7.m1.2a"><msub id="S3.E7.m1.2.3" xref="S3.E7.m1.2.3.cmml"><mi id="S3.E7.m1.2.3.2" xref="S3.E7.m1.2.3.2.cmml">g</mi><mrow id="S3.E7.m1.2.2.2.4" xref="S3.E7.m1.2.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.2.2.2.4.1" xref="S3.E7.m1.2.2.2.3.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.3.cmml" xref="S3.E7.m1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.3.1.cmml" xref="S3.E7.m1.2.3">subscript</csymbol><ci id="S3.E7.m1.2.3.2.cmml" xref="S3.E7.m1.2.3.2">π‘”</ci><list id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.4"><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">π‘–</ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">π‘΅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\displaystyle g_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7.m2.4" class="ltx_Math" alttext="\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1\leqslant j\leqslant mN\},mK),\\
0,&amp;\text{otherwise},\end{cases}" display="inline"><semantics id="S3.E7.m2.4a"><mrow id="S3.E7.m2.4.5" xref="S3.E7.m2.4.5.cmml"><mi id="S3.E7.m2.4.5.2" xref="S3.E7.m2.4.5.2.cmml"></mi><mo id="S3.E7.m2.4.5.1" xref="S3.E7.m2.4.5.1.cmml">=</mo><mrow id="S3.E7.m2.4.4a" xref="S3.E7.m2.4.5.3.1.cmml"><mo id="S3.E7.m2.4.4a.5" xref="S3.E7.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S3.E7.m2.4.4.4a" xref="S3.E7.m2.4.5.3.1.cmml"><mtr id="S3.E7.m2.4.4.4aa" xref="S3.E7.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4ab" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.1.1.1.1.1.1.3" xref="S3.E7.m2.1.1.1.1.1.1.3.1.cmml"><msub id="S3.E7.m2.1.1.1.1.1.1.3.1" xref="S3.E7.m2.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.3.1.2" xref="S3.E7.m2.1.1.1.1.1.1.3.1.2.cmml">s</mi><mrow id="S3.E7.m2.1.1.1.1.1.1.2.2.4" xref="S3.E7.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E7.m2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m2.1.1.1.1.1.1.2.2.4.1" xref="S3.E7.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S3.E7.m2.1.1.1.1.1.1.2.2.2" xref="S3.E7.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E7.m2.1.1.1.1.1.1.3.2" xref="S3.E7.m2.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4ac" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.2.2.2.2.2.1.6" xref="S3.E7.m2.2.2.2.2.2.1.6.1.cmml"><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.cmml"><msub id="S3.E7.m2.2.2.2.2.2.1.6.1.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.4.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4.2.cmml">s</mi><mrow id="S3.E7.m2.2.2.2.2.2.1.2.2.4" xref="S3.E7.m2.2.2.2.2.2.1.2.2.3.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.1.1.1" xref="S3.E7.m2.2.2.2.2.2.1.1.1.1.cmml">i</mi><mo id="S3.E7.m2.2.2.2.2.2.1.2.2.4.1" xref="S3.E7.m2.2.2.2.2.2.1.2.2.3.cmml">,</mo><mi id="S3.E7.m2.2.2.2.2.2.1.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.3.cmml">β</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.5" xref="S3.E7.m2.2.2.2.2.2.1.5.cmml">Topk</mi><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2a" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">β΅</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mo stretchy="false" id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">(</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">{</mo><msub id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E7.m2.2.2.2.2.2.1.4.2.4" xref="S3.E7.m2.2.2.2.2.2.1.4.2.3.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.3.1.1" xref="S3.E7.m2.2.2.2.2.2.1.3.1.1.cmml">j</mi><mo id="S3.E7.m2.2.2.2.2.2.1.4.2.4.1" xref="S3.E7.m2.2.2.2.2.2.1.4.2.3.cmml">,</mo><mi id="S3.E7.m2.2.2.2.2.2.1.4.2.2" xref="S3.E7.m2.2.2.2.2.2.1.4.2.2.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml"><mn id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml">1</mn><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml">β©½</mo><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml">j</mi><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml">β©½</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml">β€‹</mo><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml">N</mi></mrow></mrow><mo stretchy="false" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.5" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.4" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">,</mo><mrow id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml"><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml">β€‹</mo><mi id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml">K</mi></mrow><mo stretchy="false" id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.5" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m2.2.2.2.2.2.1.6.2" xref="S3.E7.m2.2.2.2.2.2.1.6.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E7.m2.4.4.4ad" xref="S3.E7.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4ae" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.3.3.3.3.1.1.3" xref="S3.E7.m2.4.5.3.1.cmml"><mn id="S3.E7.m2.3.3.3.3.1.1.1" xref="S3.E7.m2.3.3.3.3.1.1.1.cmml">0</mn><mo id="S3.E7.m2.3.3.3.3.1.1.3.1" xref="S3.E7.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m2.4.4.4af" xref="S3.E7.m2.4.5.3.1.cmml"><mrow id="S3.E7.m2.4.4.4.4.2.1.3" xref="S3.E7.m2.4.4.4.4.2.1.1a.cmml"><mtext id="S3.E7.m2.4.4.4.4.2.1.1" xref="S3.E7.m2.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S3.E7.m2.4.4.4.4.2.1.3.1" xref="S3.E7.m2.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.4b"><apply id="S3.E7.m2.4.5.cmml" xref="S3.E7.m2.4.5"><eq id="S3.E7.m2.4.5.1.cmml" xref="S3.E7.m2.4.5.1"></eq><csymbol cd="latexml" id="S3.E7.m2.4.5.2.cmml" xref="S3.E7.m2.4.5.2">absent</csymbol><apply id="S3.E7.m2.4.5.3.1.cmml" xref="S3.E7.m2.4.4a"><csymbol cd="latexml" id="S3.E7.m2.4.5.3.1.1.cmml" xref="S3.E7.m2.4.4a.5">cases</csymbol><apply id="S3.E7.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m2.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m2.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.3.1.2">π‘ </ci><list id="S3.E7.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.2.4"><ci id="S3.E7.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1.1.1.1.1.1">π‘–</ci><ci id="S3.E7.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m2.1.1.1.1.1.1.2.2.2">π‘΅</ci></list></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6"><in id="S3.E7.m2.2.2.2.2.2.1.6.1.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.3"></in><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.4.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4"><csymbol cd="ambiguous" id="S3.E7.m2.2.2.2.2.2.1.6.1.4.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4">subscript</csymbol><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.4.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.4.2">π‘ </ci><list id="S3.E7.m2.2.2.2.2.2.1.2.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.2.2.4"><ci id="S3.E7.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.1.1.1">π‘–</ci><ci id="S3.E7.m2.2.2.2.2.2.1.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.2.2.2">π‘΅</ci></list></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2"><ci id="S3.E7.m2.2.2.2.2.2.1.5.cmml" xref="S3.E7.m2.2.2.2.2.2.1.5">Topk</ci><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2">π‘ </ci><list id="S3.E7.m2.2.2.2.2.2.1.4.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.4.2.4"><ci id="S3.E7.m2.2.2.2.2.2.1.3.1.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.3.1.1">π‘—</ci><ci id="S3.E7.m2.2.2.2.2.2.1.4.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.4.2.2">π‘΅</ci></list></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><and id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2a.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></and><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2b.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3"></leq><cn type="integer" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2">1</cn><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4">π‘—</ci></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2c.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5"></leq><share href="#S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2d.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></share><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6"><times id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1"></times><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2">π‘</ci><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3">π‘</ci></apply></apply></apply></apply><apply id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2"><times id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.1"></times><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.2">π‘</ci><ci id="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml" xref="S3.E7.m2.2.2.2.2.2.1.6.1.2.2.2.2.3">πΎ</ci></apply></apply></apply><cn type="integer" id="S3.E7.m2.3.3.3.3.1.1.1.cmml" xref="S3.E7.m2.3.3.3.3.1.1.1">0</cn><ci id="S3.E7.m2.4.4.4.4.2.1.1a.cmml" xref="S3.E7.m2.4.4.4.4.2.1.3"><mtext id="S3.E7.m2.4.4.4.4.2.1.1.cmml" xref="S3.E7.m2.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.4c">\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|1\leqslant j\leqslant mN\},mK),\\
0,&amp;\text{otherwise},\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.2" class="ltx_Math" alttext="\displaystyle s_{i,t}" display="inline"><semantics id="S3.E8.m1.2a"><msub id="S3.E8.m1.2.3" xref="S3.E8.m1.2.3.cmml"><mi id="S3.E8.m1.2.3.2" xref="S3.E8.m1.2.3.2.cmml">s</mi><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">i</mi><mo id="S3.E8.m1.2.2.2.4.1" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.3.cmml" xref="S3.E8.m1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.3.1.cmml" xref="S3.E8.m1.2.3">subscript</csymbol><ci id="S3.E8.m1.2.3.2.cmml" xref="S3.E8.m1.2.3.2">π‘ </ci><list id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.4"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">π‘–</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">π‘΅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">\displaystyle s_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8.m2.1" class="ltx_Math" alttext="\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right)," display="inline"><semantics id="S3.E8.m2.1a"><mrow id="S3.E8.m2.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mrow id="S3.E8.m2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.4" xref="S3.E8.m2.1.1.1.1.4.cmml"></mi><mo id="S3.E8.m2.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E8.m2.1.1.1.1.2.2" xref="S3.E8.m2.1.1.1.1.2.3.cmml"><msub id="S3.E8.m2.1.1.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.1.1.1.2.cmml">Softmax</mi><mi id="S3.E8.m2.1.1.1.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m2.1.1.1.1.2.2a" xref="S3.E8.m2.1.1.1.1.2.3.cmml">β΅</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2" xref="S3.E8.m2.1.1.1.1.2.3.cmml"><mo id="S3.E8.m2.1.1.1.1.2.2.2.2" xref="S3.E8.m2.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E8.m2.1.1.1.1.2.2.2.1" xref="S3.E8.m2.1.1.1.1.2.2.2.1.cmml"><mmultiscripts id="S3.E8.m2.1.1.1.1.2.2.2.1.2" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml">π®</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml">t</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3.cmml">l</mi><mrow id="S3.E8.m2.1.1.1.1.2.2.2.1.2a" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.cmml"></mrow><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E8.m2.1.1.1.1.2.2.2.1.1" xref="S3.E8.m2.1.1.1.1.2.2.2.1.1.cmml">β€‹</mo><msubsup id="S3.E8.m2.1.1.1.1.2.2.2.1.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.cmml"><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2.cmml">π</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi><mi id="S3.E8.m2.1.1.1.1.2.2.2.1.3.3" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S3.E8.m2.1.1.1.1.2.2.2.3" xref="S3.E8.m2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m2.1.1.1.2" xref="S3.E8.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.1b"><apply id="S3.E8.m2.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1"><eq id="S3.E8.m2.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E8.m2.1.1.1.1.4.cmml" xref="S3.E8.m2.1.1.1.1.4">absent</csymbol><apply id="S3.E8.m2.1.1.1.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2"><apply id="S3.E8.m2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.2">Softmax</ci><ci id="S3.E8.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.1.1.1.3">π‘–</ci></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1"><times id="S3.E8.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.1"></times><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.2">π®</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.2.3">π‘΅</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.2.3">π‘™</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.2.3">π‘‡</ci></apply><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.3.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.2">π</ci><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.2.3">π‘–</ci></apply><ci id="S3.E8.m2.1.1.1.1.2.2.2.1.3.3.cmml" xref="S3.E8.m2.1.1.1.1.2.2.2.1.3.3">π‘™</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.1c">\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.6">μ—¬κΈ°μ„, μ „λ¬Έκ°€ νλΌλ―Έν„°λ“¤μ μ΄ μλ” ν‘μ¤€ FFNμ—μ„μ νλΌλ―Έν„°λ“¤μ μμ <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m1.1"><semantics id="S3.SS1.p2.4.m1.1a"><mi id="S3.SS1.p2.4.m1.1.1" xref="S3.SS1.p2.4.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m1.1b"><ci id="S3.SS1.p2.4.m1.1.1.cmml" xref="S3.SS1.p2.4.m1.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m1.1c">N</annotation></semantics></math> λ°°μ™€ λ™μΌν•κ³ , <math alttext="mN" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m2.1"><semantics id="S3.SS1.p2.5.m2.1a"><mrow id="S3.SS1.p2.5.m2.1.1" xref="S3.SS1.p2.5.m2.1.1.cmml"><mi id="S3.SS1.p2.5.m2.1.1.2" xref="S3.SS1.p2.5.m2.1.1.2.cmml">m</mi><mo id="S3.SS1.p2.5.m2.1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p2.5.m2.1.1.1.cmml">β€‹</mo><mi id="S3.SS1.p2.5.m2.1.1.3" xref="S3.SS1.p2.5.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m2.1b"><apply id="S3.SS1.p2.5.m2.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1"><times id="S3.SS1.p2.5.m2.1.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1.1"></times><ci id="S3.SS1.p2.5.m2.1.1.2.cmml" xref="S3.SS1.p2.5.m2.1.1.2">π‘</ci><ci id="S3.SS1.p2.5.m2.1.1.3.cmml" xref="S3.SS1.p2.5.m2.1.1.3">π‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m2.1c">mN</annotation></semantics></math>λ” μ„Έλ¶„ν™”λ μ „λ¬Έκ°€λ“¤μ μ΄ μλ¥Ό λ‚νƒ€λ‚Έλ‹¤. μ„Έλ¦½ν™”λ μ „λ¬Έκ°€ μ„Έλ¶„ν™” μ „λµμ— μν•΄, 0μ΄ μ•„λ‹ κ²μ΄νΈμ μλ” λν• <math alttext="mK" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m3.1"><semantics id="S3.SS1.p2.6.m3.1a"><mrow id="S3.SS1.p2.6.m3.1.1" xref="S3.SS1.p2.6.m3.1.1.cmml"><mi id="S3.SS1.p2.6.m3.1.1.2" xref="S3.SS1.p2.6.m3.1.1.2.cmml">m</mi><mo id="S3.SS1.p2.6.m3.1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p2.6.m3.1.1.1.cmml">β€‹</mo><mi id="S3.SS1.p2.6.m3.1.1.3" xref="S3.SS1.p2.6.m3.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m3.1b"><apply id="S3.SS1.p2.6.m3.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1"><times id="S3.SS1.p2.6.m3.1.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1.1"></times><ci id="S3.SS1.p2.6.m3.1.1.2.cmml" xref="S3.SS1.p2.6.m3.1.1.2">π‘</ci><ci id="S3.SS1.p2.6.m3.1.1.3.cmml" xref="S3.SS1.p2.6.m3.1.1.3">πΎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m3.1c">mK</annotation></semantics></math>λ΅ μ¦κ°€ν•  κ²ƒμ΄λ‹¤.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p class="ltx_p" id="S3.SS1.p3.4">μ΅°ν•©μ  κ΄€μ μ—μ„ μ„Έλ¶„ν™”λ μ „λ¬Έκ°€ μ„Έλ¶„ν™” μ „λµμ€ ν™μ„±ν™”λ μ „λ¬Έκ°€μ μ΅°ν•©μ  μ μ—°μ„±μ„ μ‹¤μ§μ μΌλ΅ ν–¥μƒμ‹ν‚¨λ‹¤. μμ‹μ μΈ μλ΅μ„, <math alttext="N=16" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">N</mi><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><eq id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></eq><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">π‘</ci><cn id="S3.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">N=16</annotation></semantics></math>μΈ κ²½μ°λ¥Ό κ³ λ ¤ν•λ‹¤. μ „ν•μ μΈ top-2 λΌμ°ν… μ „λµμ€ <math alttext="\binom{16}{2}=120" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.2"><semantics id="S3.SS1.p3.2.m2.2a"><mrow id="S3.SS1.p3.2.m2.2.3" xref="S3.SS1.p3.2.m2.2.3.cmml"><mrow id="S3.SS1.p3.2.m2.2.2.4" xref="S3.SS1.p3.2.m2.2.2.3.cmml"><mo id="S3.SS1.p3.2.m2.2.2.4.1" xref="S3.SS1.p3.2.m2.2.2.3.1.cmml">(</mo><mfrac id="S3.SS1.p3.2.m2.2.2.2.2" linethickness="0pt" xref="S3.SS1.p3.2.m2.2.2.3.cmml"><mn id="S3.SS1.p3.2.m2.1.1.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.cmml">16</mn><mn id="S3.SS1.p3.2.m2.2.2.2.2.2.1" xref="S3.SS1.p3.2.m2.2.2.2.2.2.1.cmml">2</mn></mfrac><mo id="S3.SS1.p3.2.m2.2.2.4.2" xref="S3.SS1.p3.2.m2.2.2.3.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.2.m2.2.3.1" xref="S3.SS1.p3.2.m2.2.3.1.cmml">=</mo><mn id="S3.SS1.p3.2.m2.2.3.2" xref="S3.SS1.p3.2.m2.2.3.2.cmml">120</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.2b"><apply id="S3.SS1.p3.2.m2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.3"><eq id="S3.SS1.p3.2.m2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.3.1"></eq><apply id="S3.SS1.p3.2.m2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.4"><csymbol cd="latexml" id="S3.SS1.p3.2.m2.2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.2.4.1">binomial</csymbol><cn id="S3.SS1.p3.2.m2.1.1.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1">16</cn><cn id="S3.SS1.p3.2.m2.2.2.2.2.2.1.cmml" type="integer" xref="S3.SS1.p3.2.m2.2.2.2.2.2.1">2</cn></apply><cn id="S3.SS1.p3.2.m2.2.3.2.cmml" type="integer" xref="S3.SS1.p3.2.m2.2.3.2">120</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">\binom{16}{2}=120</annotation></semantics></math> κ°€λ¥ν• μ΅°ν•©λ“¤μ„ μ‚°μ¶ν•  μ μλ‹¤. λ€μ΅°μ μΌλ΅, κ° μ „λ¬Έκ°€κ°€ <math alttext="4" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mn id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><cn id="S3.SS1.p3.3.m3.1.1.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">4</annotation></semantics></math> λ” μ‘μ€ μ „λ¬Έκ°€λ΅ λ¶„ν• λλ©΄, μ„Έλ°€ν• λΌμ°ν… μ „λµμ€ <math alttext="\binom{64}{8}=4,426,165,368" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.6"><semantics id="S3.SS1.p3.4.m4.6a"><mrow id="S3.SS1.p3.4.m4.6.7" xref="S3.SS1.p3.4.m4.6.7.cmml"><mrow id="S3.SS1.p3.4.m4.2.2.4" xref="S3.SS1.p3.4.m4.2.2.3.cmml"><mo id="S3.SS1.p3.4.m4.2.2.4.1" xref="S3.SS1.p3.4.m4.2.2.3.1.cmml">(</mo><mfrac id="S3.SS1.p3.4.m4.2.2.2.2" linethickness="0pt" xref="S3.SS1.p3.4.m4.2.2.3.cmml"><mn id="S3.SS1.p3.4.m4.1.1.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml">64</mn><mn id="S3.SS1.p3.4.m4.2.2.2.2.2.1" xref="S3.SS1.p3.4.m4.2.2.2.2.2.1.cmml">8</mn></mfrac><mo id="S3.SS1.p3.4.m4.2.2.4.2" xref="S3.SS1.p3.4.m4.2.2.3.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.4.m4.6.7.1" xref="S3.SS1.p3.4.m4.6.7.1.cmml">=</mo><mrow id="S3.SS1.p3.4.m4.6.7.2.2" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml"><mn id="S3.SS1.p3.4.m4.3.3" xref="S3.SS1.p3.4.m4.3.3.cmml">4</mn><mo id="S3.SS1.p3.4.m4.6.7.2.2.1" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml">,</mo><mn id="S3.SS1.p3.4.m4.4.4" xref="S3.SS1.p3.4.m4.4.4.cmml">426</mn><mo id="S3.SS1.p3.4.m4.6.7.2.2.2" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml">,</mo><mn id="S3.SS1.p3.4.m4.5.5" xref="S3.SS1.p3.4.m4.5.5.cmml">165</mn><mo id="S3.SS1.p3.4.m4.6.7.2.2.3" xref="S3.SS1.p3.4.m4.6.7.2.1.cmml">,</mo><mn id="S3.SS1.p3.4.m4.6.6" xref="S3.SS1.p3.4.m4.6.6.cmml">368</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.6b"><apply id="S3.SS1.p3.4.m4.6.7.cmml" xref="S3.SS1.p3.4.m4.6.7"><eq id="S3.SS1.p3.4.m4.6.7.1.cmml" xref="S3.SS1.p3.4.m4.6.7.1"></eq><apply id="S3.SS1.p3.4.m4.2.2.3.cmml" xref="S3.SS1.p3.4.m4.2.2.4"><csymbol cd="latexml" id="S3.SS1.p3.4.m4.2.2.3.1.cmml" xref="S3.SS1.p3.4.m4.2.2.4.1">binomial</csymbol><cn id="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1">64</cn><cn id="S3.SS1.p3.4.m4.2.2.2.2.2.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.2.2.2.2.2.1">8</cn></apply><list id="S3.SS1.p3.4.m4.6.7.2.1.cmml" xref="S3.SS1.p3.4.m4.6.7.2.2"><cn id="S3.SS1.p3.4.m4.3.3.cmml" type="integer" xref="S3.SS1.p3.4.m4.3.3">4</cn><cn id="S3.SS1.p3.4.m4.4.4.cmml" type="integer" xref="S3.SS1.p3.4.m4.4.4">426</cn><cn id="S3.SS1.p3.4.m4.5.5.cmml" type="integer" xref="S3.SS1.p3.4.m4.5.5">165</cn><cn id="S3.SS1.p3.4.m4.6.6.cmml" type="integer" xref="S3.SS1.p3.4.m4.6.6">368</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.6c">\binom{64}{8}=4,426,165,368</annotation></semantics></math> μ μ¬μ  μ΅°ν•©μ„ μ‚°μ¶ν•  μ μλ‹¤. μ΅°ν•© μ μ—°μ„±μ κΈ‰μ¦μ€ λ³΄λ‹¤ μ •ν™•ν•κ³  λ©ν‘λ μ§€μ‹ νλ“μ„ λ‹¬μ„±ν•  μ μλ” μ μ¬λ ¥μ„ ν–¥μƒμ‹ν‚¨λ‹¤.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Shared Expert Isolation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS2.p1.1">κΈ°μ΅΄μ λΌμ°ν… μ „λµμ„ μ‚¬μ©ν•λ©΄ μ„λ΅ λ‹¤λ¥Έ μ „λ¬Έκ°€μ—κ² ν• λ‹Ήλ ν† ν°μ΄ λ‡ κ°€μ§€ μΌλ°μ μΈ μ§€μ‹μ΄λ‚ μ •λ³΄λ¥Ό ν•„μ”λ΅ ν•  μ μμµλ‹λ‹¤. κ·Έ κ²°κ³Ό, λ‹¤μμ μ „λ¬Έκ°€κ°€ κ°μμ νλΌλ―Έν„°μ—μ„ κ³µμ λ μ§€μ‹μ„ νλ“ν•λ” λ° μλ ΄ν•  μ μκ³ , κ·Έμ— λ”°λΌ μ „λ¬Έκ°€ νλΌλ―Έν„°μ—μ„ μ¤‘λ³µμ΄ λ°μƒν•  μ μλ‹¤. κ·Έλ¬λ‚ λ‹¤μ–‘ν• μ»¨ν…μ¤νΈμ— κ±Έμ³ κ³µν†µ μ§€μ‹μ„ μΊ΅μ²ν•κ³  ν†µν•©ν•λ” λ° μ „λ…ν•λ” κ³µμ  μ „λ¬Έκ°€κ°€ μλ” κ²½μ° λΌμ°ν…λ λ‹¤λ¥Έ μ „λ¬Έκ°€ κ°„μ λ§¤κ°λ³€μ μ¤‘λ³µμ„±μ΄ μ™„ν™”λλ‹¤. μ΄λ¬ν• μ¤‘λ³µμ„± μ™„ν™”λ” λ³΄λ‹¤ μ „λ¬Έν™”λ μ „λ¬Έκ°€μ™€ ν•¨κ» λ³΄λ‹¤ λ¨μ ν¨μ¨μ μΈ λ¨λΈμ— κΈ°μ—¬ν•  κ²ƒμ΄λ‹¤.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p class="ltx_p" id="S3.SS2.p2.2">μ΄ λ©μ μ„ μ„ν•΄ μ„Έλ°€ν• μ „λ¬Έκ°€ μ„Έλ¶„ν™” μ „λµ μ™Έμ—λ„ <math alttext="K_{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">πΎ</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">π‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">K_{s}</annotation></semantics></math> μ „λ¬Έκ°€λ¥Ό μ¶”κ°€λ΅ λ¶„λ¦¬ν•μ—¬ κ³µμ  μ „λ¬Έκ°€ μ—­ν• μ„ ν•λ‹¤. λΌμ°ν„° λ¨λ“μ— κ΄€κ³„μ—†μ΄ κ° ν† ν°μ€ μ΄λ¬ν• κ³µμ  μ „λ¬Έκ°€μ—κ² κ²°μ •μ μΌλ΅ ν• λ‹Ήλ©λ‹λ‹¤. μΌμ •ν• κ³„μ‚° λΉ„μ©μ„ μ μ§€ν•κΈ° μ„ν•΄, λ‹¤λ¥Έ λΌμ°ν…λ μ „λ¬Έκ°€λ“¤ μ¤‘ ν™μ„±ν™”λ μ „λ¬Έκ°€μ μλ” κ·Έλ¦Ό <a class="ltx_ref" href="#S2.F2" title="Figure 2 β€£ 2 Preliminaries: Mixture-of-Experts for Transformers β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(c)μ— λ„μ‹λ λ°”μ™€ κ°™μ΄ <math alttext="K_{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">πΎ</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">π‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">K_{s}</annotation></semantics></math>λ§νΌ κ°μ†λ  κ²ƒμ΄λ‹¤. κ³µμ λ μ „λ¬Έκ°€ κ²©λ¦¬ μ „λµμ΄ ν†µν•©λ μƒνƒμ—μ„, μ™„μ „ν• DeepSeekMoE μ•„ν‚¤ν…μ² λ‚΄μ MoE κ³„μΈµμ€ λ‹¤μκ³Ό κ°™μ΄ κ³µμ‹ν™”λλ‹¤:</p>
<table id="A3.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{h}_{t}^{l}" display="inline"><semantics id="S3.E9.m1.1a"><msubsup id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mi id="S3.E9.m1.1.1.2.2" xref="S3.E9.m1.1.1.2.2.cmml">π΅</mi><mi id="S3.E9.m1.1.1.2.3" xref="S3.E9.m1.1.1.2.3.cmml">t</mi><mi id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1">superscript</csymbol><apply id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.2.1.cmml" xref="S3.E9.m1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.2.2">π΅</ci><ci id="S3.E9.m1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.2.3">π‘΅</ci></apply><ci id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3">π‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle\mathbf{h}_{t}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{K_{s}}{\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}+\sum_{i=K_{s}+1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l}," display="inline"><semantics id="S3.E9.m2.3a"><mrow id="S3.E9.m2.3.3.1" xref="S3.E9.m2.3.3.1.1.cmml"><mrow id="S3.E9.m2.3.3.1.1" xref="S3.E9.m2.3.3.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.5" xref="S3.E9.m2.3.3.1.1.5.cmml"></mi><mo id="S3.E9.m2.3.3.1.1.4" xref="S3.E9.m2.3.3.1.1.4.cmml">=</mo><mrow id="S3.E9.m2.3.3.1.1.3" xref="S3.E9.m2.3.3.1.1.3.cmml"><mrow id="S3.E9.m2.3.3.1.1.2.2" xref="S3.E9.m2.3.3.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E9.m2.3.3.1.1.2.2.3" xref="S3.E9.m2.3.3.1.1.2.2.3.cmml"><munderover id="S3.E9.m2.3.3.1.1.2.2.3a" xref="S3.E9.m2.3.3.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E9.m2.3.3.1.1.2.2.3.2.2" xref="S3.E9.m2.3.3.1.1.2.2.3.2.2.cmml">β‘</mo><mrow id="S3.E9.m2.3.3.1.1.2.2.3.2.3" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.2.2.3.2.3.2" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E9.m2.3.3.1.1.2.2.3.2.3.1" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E9.m2.3.3.1.1.2.2.3.2.3.3" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E9.m2.3.3.1.1.2.2.3.3" xref="S3.E9.m2.3.3.1.1.2.2.3.3.cmml"><mi id="S3.E9.m2.3.3.1.1.2.2.3.3.2" xref="S3.E9.m2.3.3.1.1.2.2.3.3.2.cmml">K</mi><mi id="S3.E9.m2.3.3.1.1.2.2.3.3.3" xref="S3.E9.m2.3.3.1.1.2.2.3.3.3.cmml">s</mi></msub></munderover></mstyle><mrow id="S3.E9.m2.3.3.1.1.2.2.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml"><msub id="S3.E9.m2.3.3.1.1.1.1.1.1.1" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.1.1.1.1.1.2" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S3.E9.m2.3.3.1.1.1.1.1.1.1.3" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m2.3.3.1.1.2.2.2.2a" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml">β΅</mo><mrow id="S3.E9.m2.3.3.1.1.2.2.2.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml"><mo id="S3.E9.m2.3.3.1.1.2.2.2.2.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.cmml"><mi id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2.cmml">π®</mi><mi id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3.cmml">t</mi><mi id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S3.E9.m2.3.3.1.1.2.2.2.2.2.3" xref="S3.E9.m2.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m2.3.3.1.1.3.4" xref="S3.E9.m2.3.3.1.1.3.4.cmml">+</mo><mrow id="S3.E9.m2.3.3.1.1.3.3" xref="S3.E9.m2.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E9.m2.3.3.1.1.3.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.cmml"><munderover id="S3.E9.m2.3.3.1.1.3.3.2a" xref="S3.E9.m2.3.3.1.1.3.3.2.cmml"><mo movablelimits="false" id="S3.E9.m2.3.3.1.1.3.3.2.2.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.2.cmml">β‘</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.2.2.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.2.2.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.2.cmml">i</mi><mo id="S3.E9.m2.3.3.1.1.3.3.2.2.3.1" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.1.cmml">=</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.cmml"><msub id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2.cmml">K</mi><mi id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3.cmml">s</mi></msub><mo id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1.cmml">+</mo><mn id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3.cmml">1</mn></mrow></mrow><mrow id="S3.E9.m2.3.3.1.1.3.3.2.3" xref="S3.E9.m2.3.3.1.1.3.3.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.2.3.2" xref="S3.E9.m2.3.3.1.1.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E9.m2.3.3.1.1.3.3.2.3.1" xref="S3.E9.m2.3.3.1.1.3.3.2.3.1.cmml">β€‹</mo><mi id="S3.E9.m2.3.3.1.1.3.3.2.3.3" xref="S3.E9.m2.3.3.1.1.3.3.2.3.3.cmml">N</mi></mrow></munderover></mstyle><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml"><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml"><msub id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2.cmml">g</mi><mrow id="S3.E9.m2.2.2.2.4" xref="S3.E9.m2.2.2.2.3.cmml"><mi id="S3.E9.m2.1.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml">i</mi><mo id="S3.E9.m2.2.2.2.4.1" xref="S3.E9.m2.2.2.2.3.cmml">,</mo><mi id="S3.E9.m2.2.2.2.2" xref="S3.E9.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.3.cmml">β€‹</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml"><msub id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2.cmml">FFN</mi><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2a" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml">β΅</mo><mrow id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml"><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.cmml"><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2.cmml">π®</mi><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3.cmml">t</mi><mi id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3.cmml">l</mi></msubsup><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m2.3.3.1.1.3.3.1.1.3" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m2.3.3.1.1.3.4a" xref="S3.E9.m2.3.3.1.1.3.4.cmml">+</mo><msubsup id="S3.E9.m2.3.3.1.1.3.5" xref="S3.E9.m2.3.3.1.1.3.5.cmml"><mi id="S3.E9.m2.3.3.1.1.3.5.2.2" xref="S3.E9.m2.3.3.1.1.3.5.2.2.cmml">π®</mi><mi id="S3.E9.m2.3.3.1.1.3.5.2.3" xref="S3.E9.m2.3.3.1.1.3.5.2.3.cmml">t</mi><mi id="S3.E9.m2.3.3.1.1.3.5.3" xref="S3.E9.m2.3.3.1.1.3.5.3.cmml">l</mi></msubsup></mrow></mrow><mo id="S3.E9.m2.3.3.1.2" xref="S3.E9.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.3b"><apply id="S3.E9.m2.3.3.1.1.cmml" xref="S3.E9.m2.3.3.1"><eq id="S3.E9.m2.3.3.1.1.4.cmml" xref="S3.E9.m2.3.3.1.1.4"></eq><csymbol cd="latexml" id="S3.E9.m2.3.3.1.1.5.cmml" xref="S3.E9.m2.3.3.1.1.5">absent</csymbol><apply id="S3.E9.m2.3.3.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3"><plus id="S3.E9.m2.3.3.1.1.3.4.cmml" xref="S3.E9.m2.3.3.1.1.3.4"></plus><apply id="S3.E9.m2.3.3.1.1.2.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2"><apply id="S3.E9.m2.3.3.1.1.2.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.2.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3">subscript</csymbol><sum id="S3.E9.m2.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.2"></sum><apply id="S3.E9.m2.3.3.1.1.2.2.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3"><eq id="S3.E9.m2.3.3.1.1.2.2.3.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S3.E9.m2.3.3.1.1.2.2.3.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.2">π‘–</ci><cn type="integer" id="S3.E9.m2.3.3.1.1.2.2.3.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E9.m2.3.3.1.1.2.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.3.3.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.2.2.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3.2">πΎ</ci><ci id="S3.E9.m2.3.3.1.1.2.2.3.3.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.3.3.3">π‘ </ci></apply></apply><apply id="S3.E9.m2.3.3.1.1.2.2.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2"><apply id="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.2">FFN</ci><ci id="S3.E9.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.3">π‘–</ci></apply><apply id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.1.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.2">π®</ci><ci id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.2.3">π‘΅</ci></apply><ci id="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3.cmml" xref="S3.E9.m2.3.3.1.1.2.2.2.2.2.1.3">π‘™</ci></apply></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3"><apply id="S3.E9.m2.3.3.1.1.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2">subscript</csymbol><sum id="S3.E9.m2.3.3.1.1.3.3.2.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.2"></sum><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3"><eq id="S3.E9.m2.3.3.1.1.3.3.2.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.1"></eq><ci id="S3.E9.m2.3.3.1.1.3.3.2.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.2">π‘–</ci><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3"><plus id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.1"></plus><apply id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.2">πΎ</ci><ci id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.2.3">π‘ </ci></apply><cn type="integer" id="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3"><times id="S3.E9.m2.3.3.1.1.3.3.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3.1"></times><ci id="S3.E9.m2.3.3.1.1.3.3.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3.2">π‘</ci><ci id="S3.E9.m2.3.3.1.1.3.3.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.2.3.3">π‘</ci></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1"><times id="S3.E9.m2.3.3.1.1.3.3.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.3"></times><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.4.2">π‘”</ci><list id="S3.E9.m2.2.2.2.3.cmml" xref="S3.E9.m2.2.2.2.4"><ci id="S3.E9.m2.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1">π‘–</ci><ci id="S3.E9.m2.2.2.2.2.cmml" xref="S3.E9.m2.2.2.2.2">π‘΅</ci></list></apply><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2"><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.2">FFN</ci><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.1.1.1.3">π‘–</ci></apply><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.2">π®</ci><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.2.3">π‘΅</ci></apply><ci id="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3.3.1.1.1.2.2.2.1.3">π‘™</ci></apply></apply></apply></apply><apply id="S3.E9.m2.3.3.1.1.3.5.cmml" xref="S3.E9.m2.3.3.1.1.3.5"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.5.1.cmml" xref="S3.E9.m2.3.3.1.1.3.5">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.3.5.2.cmml" xref="S3.E9.m2.3.3.1.1.3.5"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.3.5.2.1.cmml" xref="S3.E9.m2.3.3.1.1.3.5">subscript</csymbol><ci id="S3.E9.m2.3.3.1.1.3.5.2.2.cmml" xref="S3.E9.m2.3.3.1.1.3.5.2.2">π®</ci><ci id="S3.E9.m2.3.3.1.1.3.5.2.3.cmml" xref="S3.E9.m2.3.3.1.1.3.5.2.3">π‘΅</ci></apply><ci id="S3.E9.m2.3.3.1.1.3.5.3.cmml" xref="S3.E9.m2.3.3.1.1.3.5.3">π‘™</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.3c">\displaystyle=\sum_{i=1}^{K_{s}}{\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}+\sum_{i=K_{s}+1}^{mN}\left({g_{i,t}\operatorname{FFN}_{i}\left(\mathbf{u}_{t}^{l}\right)}\right)+\mathbf{u}_{t}^{l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.2" class="ltx_Math" alttext="\displaystyle g_{i,t}" display="inline"><semantics id="S3.E10.m1.2a"><msub id="S3.E10.m1.2.3" xref="S3.E10.m1.2.3.cmml"><mi id="S3.E10.m1.2.3.2" xref="S3.E10.m1.2.3.2.cmml">g</mi><mrow id="S3.E10.m1.2.2.2.4" xref="S3.E10.m1.2.2.2.3.cmml"><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">i</mi><mo id="S3.E10.m1.2.2.2.4.1" xref="S3.E10.m1.2.2.2.3.cmml">,</mo><mi id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.3.cmml" xref="S3.E10.m1.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.3.1.cmml" xref="S3.E10.m1.2.3">subscript</csymbol><ci id="S3.E10.m1.2.3.2.cmml" xref="S3.E10.m1.2.3.2">π‘”</ci><list id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.4"><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">π‘–</ci><ci id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2">π‘΅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\displaystyle g_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E10.m2.4" class="ltx_Math" alttext="\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|K_{s}+1\leqslant j\leqslant mN\},mK-K_{s}),\\
0,&amp;\text{otherwise},\end{cases}" display="inline"><semantics id="S3.E10.m2.4a"><mrow id="S3.E10.m2.4.5" xref="S3.E10.m2.4.5.cmml"><mi id="S3.E10.m2.4.5.2" xref="S3.E10.m2.4.5.2.cmml"></mi><mo id="S3.E10.m2.4.5.1" xref="S3.E10.m2.4.5.1.cmml">=</mo><mrow id="S3.E10.m2.4.4a" xref="S3.E10.m2.4.5.3.1.cmml"><mo id="S3.E10.m2.4.4a.5" xref="S3.E10.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S3.E10.m2.4.4.4a" xref="S3.E10.m2.4.5.3.1.cmml"><mtr id="S3.E10.m2.4.4.4aa" xref="S3.E10.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4ab" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.1.1.1.1.1.1.3" xref="S3.E10.m2.1.1.1.1.1.1.3.1.cmml"><msub id="S3.E10.m2.1.1.1.1.1.1.3.1" xref="S3.E10.m2.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E10.m2.1.1.1.1.1.1.3.1.2" xref="S3.E10.m2.1.1.1.1.1.1.3.1.2.cmml">s</mi><mrow id="S3.E10.m2.1.1.1.1.1.1.2.2.4" xref="S3.E10.m2.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E10.m2.1.1.1.1.1.1.1.1.1" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E10.m2.1.1.1.1.1.1.2.2.4.1" xref="S3.E10.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S3.E10.m2.1.1.1.1.1.1.2.2.2" xref="S3.E10.m2.1.1.1.1.1.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E10.m2.1.1.1.1.1.1.3.2" xref="S3.E10.m2.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4ac" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6" xref="S3.E10.m2.2.2.2.2.2.1.6.1.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.cmml"><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.4.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4.2.cmml">s</mi><mrow id="S3.E10.m2.2.2.2.2.2.1.2.2.4" xref="S3.E10.m2.2.2.2.2.2.1.2.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.1.1.1" xref="S3.E10.m2.2.2.2.2.2.1.1.1.1.cmml">i</mi><mo id="S3.E10.m2.2.2.2.2.2.1.2.2.4.1" xref="S3.E10.m2.2.2.2.2.2.1.2.2.3.cmml">,</mo><mi id="S3.E10.m2.2.2.2.2.2.1.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.3.cmml">β</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.5" xref="S3.E10.m2.2.2.2.2.2.1.5.cmml">Topk</mi><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2a" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">β΅</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml"><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">(</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">{</mo><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E10.m2.2.2.2.2.2.1.4.2.4" xref="S3.E10.m2.2.2.2.2.2.1.4.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.3.1.1" xref="S3.E10.m2.2.2.2.2.2.1.3.1.1.cmml">j</mi><mo id="S3.E10.m2.2.2.2.2.2.1.4.2.4.1" xref="S3.E10.m2.2.2.2.2.2.1.4.2.3.cmml">,</mo><mi id="S3.E10.m2.2.2.2.2.2.1.4.2.2" xref="S3.E10.m2.2.2.2.2.2.1.4.2.2.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml"><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2.cmml">K</mi><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3.cmml">s</mi></msub><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1.cmml">+</mo><mn id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3.cmml">1</mn></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml">β©½</mo><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml">j</mi><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml">β©½</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml">β€‹</mo><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml">N</mi></mrow></mrow><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.5" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.4" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">,</mo><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml"><mrow id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1.cmml">β€‹</mo><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3.cmml">K</mi></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml">β’</mo><msub id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml"><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2.cmml">K</mi><mi id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.5" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m2.2.2.2.2.2.1.6.2" xref="S3.E10.m2.2.2.2.2.2.1.6.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E10.m2.4.4.4ad" xref="S3.E10.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4ae" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.3.3.3.3.1.1.3" xref="S3.E10.m2.4.5.3.1.cmml"><mn id="S3.E10.m2.3.3.3.3.1.1.1" xref="S3.E10.m2.3.3.3.3.1.1.1.cmml">0</mn><mo id="S3.E10.m2.3.3.3.3.1.1.3.1" xref="S3.E10.m2.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m2.4.4.4af" xref="S3.E10.m2.4.5.3.1.cmml"><mrow id="S3.E10.m2.4.4.4.4.2.1.3" xref="S3.E10.m2.4.4.4.4.2.1.1a.cmml"><mtext id="S3.E10.m2.4.4.4.4.2.1.1" xref="S3.E10.m2.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S3.E10.m2.4.4.4.4.2.1.3.1" xref="S3.E10.m2.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m2.4b"><apply id="S3.E10.m2.4.5.cmml" xref="S3.E10.m2.4.5"><eq id="S3.E10.m2.4.5.1.cmml" xref="S3.E10.m2.4.5.1"></eq><csymbol cd="latexml" id="S3.E10.m2.4.5.2.cmml" xref="S3.E10.m2.4.5.2">absent</csymbol><apply id="S3.E10.m2.4.5.3.1.cmml" xref="S3.E10.m2.4.4a"><csymbol cd="latexml" id="S3.E10.m2.4.5.3.1.1.cmml" xref="S3.E10.m2.4.4a.5">cases</csymbol><apply id="S3.E10.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m2.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.3.1.2">π‘ </ci><list id="S3.E10.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m2.1.1.1.1.1.1.2.2.4"><ci id="S3.E10.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1.1.1.1">π‘–</ci><ci id="S3.E10.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m2.1.1.1.1.1.1.2.2.2">π‘΅</ci></list></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6"><in id="S3.E10.m2.2.2.2.2.2.1.6.1.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.3"></in><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.4.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.4.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.4.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.4.2">π‘ </ci><list id="S3.E10.m2.2.2.2.2.2.1.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.2.2.4"><ci id="S3.E10.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.1.1.1">π‘–</ci><ci id="S3.E10.m2.2.2.2.2.2.1.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.2.2.2">π‘΅</ci></list></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2"><ci id="S3.E10.m2.2.2.2.2.2.1.5.cmml" xref="S3.E10.m2.2.2.2.2.2.1.5">Topk</ci><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.3.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.1.1.2">π‘ </ci><list id="S3.E10.m2.2.2.2.2.2.1.4.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.4.2.4"><ci id="S3.E10.m2.2.2.2.2.2.1.3.1.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.3.1.1">π‘—</ci><ci id="S3.E10.m2.2.2.2.2.2.1.4.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.4.2.2">π‘΅</ci></list></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><and id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2a.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></and><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2b.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.3"></leq><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2"><plus id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.1"></plus><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.2">πΎ</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.2.3">π‘ </ci></apply><cn type="integer" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.2.3">1</cn></apply><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4">π‘—</ci></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2c.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"><leq id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.5"></leq><share href="#S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.4.cmml" id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2d.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2"></share><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6"><times id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.1"></times><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.2">π‘</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.1.1.1.1.2.2.6.3">π‘</ci></apply></apply></apply></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2"><minus id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.1"></minus><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2"><times id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.1"></times><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.2">π‘</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.2.3">πΎ</ci></apply><apply id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.1.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3">subscript</csymbol><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.2">πΎ</ci><ci id="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3.cmml" xref="S3.E10.m2.2.2.2.2.2.1.6.1.2.2.2.2.3.3">π‘ </ci></apply></apply></apply></apply><cn type="integer" id="S3.E10.m2.3.3.3.3.1.1.1.cmml" xref="S3.E10.m2.3.3.3.3.1.1.1">0</cn><ci id="S3.E10.m2.4.4.4.4.2.1.1a.cmml" xref="S3.E10.m2.4.4.4.4.2.1.3"><mtext id="S3.E10.m2.4.4.4.4.2.1.1.cmml" xref="S3.E10.m2.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m2.4c">\displaystyle=\begin{cases}s_{i,t},&amp;s_{i,t}\in\operatorname{Topk}(\{s_{j,t}|K_{s}+1\leqslant j\leqslant mN\},mK-K_{s}),\\
0,&amp;\text{otherwise},\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11.m1.2" class="ltx_Math" alttext="\displaystyle s_{i,t}" display="inline"><semantics id="S3.E11.m1.2a"><msub id="S3.E11.m1.2.3" xref="S3.E11.m1.2.3.cmml"><mi id="S3.E11.m1.2.3.2" xref="S3.E11.m1.2.3.2.cmml">s</mi><mrow id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">i</mi><mo id="S3.E11.m1.2.2.2.4.1" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.3.cmml" xref="S3.E11.m1.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.3.1.cmml" xref="S3.E11.m1.2.3">subscript</csymbol><ci id="S3.E11.m1.2.3.2.cmml" xref="S3.E11.m1.2.3.2">π‘ </ci><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.4"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">π‘–</ci><ci id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2">π‘΅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\displaystyle s_{i,t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E11.m2.1" class="ltx_Math" alttext="\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right)." display="inline"><semantics id="S3.E11.m2.1a"><mrow id="S3.E11.m2.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mrow id="S3.E11.m2.1.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mi id="S3.E11.m2.1.1.1.1.4" xref="S3.E11.m2.1.1.1.1.4.cmml"></mi><mo id="S3.E11.m2.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E11.m2.1.1.1.1.2.2" xref="S3.E11.m2.1.1.1.1.2.3.cmml"><msub id="S3.E11.m2.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m2.1.1.1.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.1.1.1.2.cmml">Softmax</mi><mi id="S3.E11.m2.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E11.m2.1.1.1.1.2.2a" xref="S3.E11.m2.1.1.1.1.2.3.cmml">β΅</mo><mrow id="S3.E11.m2.1.1.1.1.2.2.2" xref="S3.E11.m2.1.1.1.1.2.3.cmml"><mo id="S3.E11.m2.1.1.1.1.2.2.2.2" xref="S3.E11.m2.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E11.m2.1.1.1.1.2.2.2.1" xref="S3.E11.m2.1.1.1.1.2.2.2.1.cmml"><mmultiscripts id="S3.E11.m2.1.1.1.1.2.2.2.1.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.cmml"><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml">π®</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml">t</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3.cmml">l</mi><mrow id="S3.E11.m2.1.1.1.1.2.2.2.1.2a" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.cmml"></mrow><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S3.E11.m2.1.1.1.1.2.2.2.1.1" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml">β€‹</mo><msubsup id="S3.E11.m2.1.1.1.1.2.2.2.1.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.cmml"><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2.cmml">π</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.3.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S3.E11.m2.1.1.1.1.2.2.2.3" xref="S3.E11.m2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E11.m2.1.1.1.2" xref="S3.E11.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m2.1b"><apply id="S3.E11.m2.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1"><eq id="S3.E11.m2.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E11.m2.1.1.1.1.4.cmml" xref="S3.E11.m2.1.1.1.1.4">absent</csymbol><apply id="S3.E11.m2.1.1.1.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2"><apply id="S3.E11.m2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.2">Softmax</ci><ci id="S3.E11.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.3">π‘–</ci></apply><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1"><times id="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1"></times><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.2">π®</ci><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.2.3">π‘΅</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.2.3">π‘™</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.2.3">π‘‡</ci></apply><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.3.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.2">π</ci><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.2.3">π‘–</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.3.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.3.3">π‘™</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m2.1c">\displaystyle=\operatorname{Softmax}_{i}\left({\mathbf{u}_{t}^{l}}^{T}\mathbf{e}_{i}^{l}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.5" class="ltx_p">Finally, in DeepSeekMoE, the number of shared expert is <math id="S3.SS2.p2.3.m1.1" class="ltx_Math" alttext="K_{s}" display="inline"><semantics id="S3.SS2.p2.3.m1.1a"><msub id="S3.SS2.p2.3.m1.1.1" xref="S3.SS2.p2.3.m1.1.1.cmml"><mi id="S3.SS2.p2.3.m1.1.1.2" xref="S3.SS2.p2.3.m1.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.3.m1.1.1.3" xref="S3.SS2.p2.3.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m1.1b"><apply id="S3.SS2.p2.3.m1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m1.1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m1.1.1.2.cmml" xref="S3.SS2.p2.3.m1.1.1.2">πΎ</ci><ci id="S3.SS2.p2.3.m1.1.1.3.cmml" xref="S3.SS2.p2.3.m1.1.1.3">π‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m1.1c">K_{s}</annotation></semantics></math>, the total number of routed experts is <math id="S3.SS2.p2.4.m2.1" class="ltx_Math" alttext="mN-K_{s}" display="inline"><semantics id="S3.SS2.p2.4.m2.1a"><mrow id="S3.SS2.p2.4.m2.1.1" xref="S3.SS2.p2.4.m2.1.1.cmml"><mrow id="S3.SS2.p2.4.m2.1.1.2" xref="S3.SS2.p2.4.m2.1.1.2.cmml"><mi id="S3.SS2.p2.4.m2.1.1.2.2" xref="S3.SS2.p2.4.m2.1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m2.1.1.2.1" xref="S3.SS2.p2.4.m2.1.1.2.1.cmml">β€‹</mo><mi id="S3.SS2.p2.4.m2.1.1.2.3" xref="S3.SS2.p2.4.m2.1.1.2.3.cmml">N</mi></mrow><mo id="S3.SS2.p2.4.m2.1.1.1" xref="S3.SS2.p2.4.m2.1.1.1.cmml">β’</mo><msub id="S3.SS2.p2.4.m2.1.1.3" xref="S3.SS2.p2.4.m2.1.1.3.cmml"><mi id="S3.SS2.p2.4.m2.1.1.3.2" xref="S3.SS2.p2.4.m2.1.1.3.2.cmml">K</mi><mi id="S3.SS2.p2.4.m2.1.1.3.3" xref="S3.SS2.p2.4.m2.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m2.1b"><apply id="S3.SS2.p2.4.m2.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1"><minus id="S3.SS2.p2.4.m2.1.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1.1"></minus><apply id="S3.SS2.p2.4.m2.1.1.2.cmml" xref="S3.SS2.p2.4.m2.1.1.2"><times id="S3.SS2.p2.4.m2.1.1.2.1.cmml" xref="S3.SS2.p2.4.m2.1.1.2.1"></times><ci id="S3.SS2.p2.4.m2.1.1.2.2.cmml" xref="S3.SS2.p2.4.m2.1.1.2.2">π‘</ci><ci id="S3.SS2.p2.4.m2.1.1.2.3.cmml" xref="S3.SS2.p2.4.m2.1.1.2.3">π‘</ci></apply><apply id="S3.SS2.p2.4.m2.1.1.3.cmml" xref="S3.SS2.p2.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m2.1.1.3.1.cmml" xref="S3.SS2.p2.4.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.4.m2.1.1.3.2.cmml" xref="S3.SS2.p2.4.m2.1.1.3.2">πΎ</ci><ci id="S3.SS2.p2.4.m2.1.1.3.3.cmml" xref="S3.SS2.p2.4.m2.1.1.3.3">π‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m2.1c">mN-K_{s}</annotation></semantics></math>, and the number of nonzero gates is <math id="S3.SS2.p2.5.m3.1" class="ltx_Math" alttext="mK-K_{s}" display="inline"><semantics id="S3.SS2.p2.5.m3.1a"><mrow id="S3.SS2.p2.5.m3.1.1" xref="S3.SS2.p2.5.m3.1.1.cmml"><mrow id="S3.SS2.p2.5.m3.1.1.2" xref="S3.SS2.p2.5.m3.1.1.2.cmml"><mi id="S3.SS2.p2.5.m3.1.1.2.2" xref="S3.SS2.p2.5.m3.1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m3.1.1.2.1" xref="S3.SS2.p2.5.m3.1.1.2.1.cmml">β€‹</mo><mi id="S3.SS2.p2.5.m3.1.1.2.3" xref="S3.SS2.p2.5.m3.1.1.2.3.cmml">K</mi></mrow><mo id="S3.SS2.p2.5.m3.1.1.1" xref="S3.SS2.p2.5.m3.1.1.1.cmml">β’</mo><msub id="S3.SS2.p2.5.m3.1.1.3" xref="S3.SS2.p2.5.m3.1.1.3.cmml"><mi id="S3.SS2.p2.5.m3.1.1.3.2" xref="S3.SS2.p2.5.m3.1.1.3.2.cmml">K</mi><mi id="S3.SS2.p2.5.m3.1.1.3.3" xref="S3.SS2.p2.5.m3.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m3.1b"><apply id="S3.SS2.p2.5.m3.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1"><minus id="S3.SS2.p2.5.m3.1.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1.1"></minus><apply id="S3.SS2.p2.5.m3.1.1.2.cmml" xref="S3.SS2.p2.5.m3.1.1.2"><times id="S3.SS2.p2.5.m3.1.1.2.1.cmml" xref="S3.SS2.p2.5.m3.1.1.2.1"></times><ci id="S3.SS2.p2.5.m3.1.1.2.2.cmml" xref="S3.SS2.p2.5.m3.1.1.2.2">π‘</ci><ci id="S3.SS2.p2.5.m3.1.1.2.3.cmml" xref="S3.SS2.p2.5.m3.1.1.2.3">πΎ</ci></apply><apply id="S3.SS2.p2.5.m3.1.1.3.cmml" xref="S3.SS2.p2.5.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m3.1.1.3.1.cmml" xref="S3.SS2.p2.5.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.5.m3.1.1.3.2.cmml" xref="S3.SS2.p2.5.m3.1.1.3.2">πΎ</ci><ci id="S3.SS2.p2.5.m3.1.1.3.3.cmml" xref="S3.SS2.p2.5.m3.1.1.3.3">π‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m3.1c">mK-K_{s}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p class="ltx_p" id="S3.SS2.p3.1">κ³µμ  μ „λ¬Έκ°€ κ²©λ¦¬μ ν”„λ΅ν† νƒ€μ…μ€ <cite class="ltx_cite ltx_citemacro_citet">Rajbhandari etΒ al. (<a class="ltx_ref" href="#bib.bib40" title="">2022</a>)</cite>λ΅ μΈμ •λ  μ μλ‹¤λ” μ μ— μ£Όλ©ν•  ν•„μ”κ°€ μλ‹¤. ν•µμ‹¬μ μΈ κµ¬λ³„μ€ κ·Έλ“¤μ΄ μ΄ μ „λµμ„ κ³µν•™μ  κ΄€μ μ—μ„ λ„μ¶ν•λ” λ°λ©΄ μ°λ¦¬λ” μ•κ³ λ¦¬μ¦μ  κ΄€μ μ—μ„ μ ‘κ·Όν•λ‹¤λ” μ‚¬μ‹¤μ— μλ‹¤.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Load Balance Consideration</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS3.p1.1">μλ™μΌλ΅ ν•™μµλ λΌμ°ν… μ „λµμ€ λ‘ κ°€μ§€ μ£Όλ©ν•  λ§ν• κ²°ν•¨μ„ λ‚νƒ€λ‚΄λ” λ¶€ν• λ¶κ· ν• λ¬Έμ μ— μ§λ©΄ν•  μ μλ‹¤. μ²«μ§Έ, λΌμ°ν… λ¶•κ΄΄μ μ„ν—μ΄ μλ‹¤. <cite class="ltx_cite ltx_citemacro_citep">(Shazeer etΒ al., <a class="ltx_ref" href="#bib.bib47" title="">2017</a>)</cite> μ¦‰, λ¨λΈμ€ ν•­μƒ μ†μμ μ „λ¬Έκ°€λ§μ„ μ„ νƒν•μ—¬ λ‹¤λ¥Έ μ „λ¬Έκ°€μ μ¶©λ¶„ν• ν›λ ¨μ„ λ°©ν•΄ν•λ‹¤. λ‘μ§Έ, μ „λ¬Έκ°€κ°€ μ—¬λ¬ μ¥μΉμ— λ¶„μ‚°λμ–΄ μλ” κ²½μ° λ¶€ν• λ¶κ· ν•μ΄ κ³„μ‚° λ³‘λ© ν„μƒμ„ μ•…ν™”μ‹ν‚¬ μ μμµλ‹λ‹¤.</p>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Expert-Level Balance Loss.</h5>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.7">λΌμ°ν… λ¶•κ΄΄μ μ„ν—μ„ μ™„ν™”ν•κΈ° μ„ν•΄ μ „λ¬Έκ°€ μμ¤€μ κ· ν• μ†μ‹¤λ„ μ‚¬μ©ν•©λ‹λ‹¤. μ”μ•΅ μ†μ‹¤μ κ³„μ‚°μ€ λ‹¤μκ³Ό κ°™λ‹¤:</p>
<table id="A3.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\mathrm{ExpBal}}" display="inline"><semantics id="S3.E12.m1.1a"><msub id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml">β„’</mi><mi id="S3.E12.m1.1.1.3" xref="S3.E12.m1.1.1.3.cmml">ExpBal</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.cmml" xref="S3.E12.m1.1.1">subscript</csymbol><ci id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2">β„’</ci><ci id="S3.E12.m1.1.1.3.cmml" xref="S3.E12.m1.1.1.3">ExpBal</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\displaystyle\mathcal{L}_{\mathrm{ExpBal}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12.m2.1" class="ltx_Math" alttext="\displaystyle=\alpha_{1}\sum_{i=1}^{N^{\prime}}{f_{i}P_{i}}," display="inline"><semantics id="S3.E12.m2.1a"><mrow id="S3.E12.m2.1.1.1" xref="S3.E12.m2.1.1.1.1.cmml"><mrow id="S3.E12.m2.1.1.1.1" xref="S3.E12.m2.1.1.1.1.cmml"><mi id="S3.E12.m2.1.1.1.1.2" xref="S3.E12.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E12.m2.1.1.1.1.1" xref="S3.E12.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E12.m2.1.1.1.1.3" xref="S3.E12.m2.1.1.1.1.3.cmml"><msub id="S3.E12.m2.1.1.1.1.3.2" xref="S3.E12.m2.1.1.1.1.3.2.cmml"><mi id="S3.E12.m2.1.1.1.1.3.2.2" xref="S3.E12.m2.1.1.1.1.3.2.2.cmml">Ξ±</mi><mn id="S3.E12.m2.1.1.1.1.3.2.3" xref="S3.E12.m2.1.1.1.1.3.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E12.m2.1.1.1.1.3.1" xref="S3.E12.m2.1.1.1.1.3.1.cmml">β€‹</mo><mrow id="S3.E12.m2.1.1.1.1.3.3" xref="S3.E12.m2.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E12.m2.1.1.1.1.3.3.1" xref="S3.E12.m2.1.1.1.1.3.3.1.cmml"><munderover id="S3.E12.m2.1.1.1.1.3.3.1a" xref="S3.E12.m2.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E12.m2.1.1.1.1.3.3.1.2.2" xref="S3.E12.m2.1.1.1.1.3.3.1.2.2.cmml">β‘</mo><mrow id="S3.E12.m2.1.1.1.1.3.3.1.2.3" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.1.2.3.2" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E12.m2.1.1.1.1.3.3.1.2.3.1" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E12.m2.1.1.1.1.3.3.1.2.3.3" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><msup id="S3.E12.m2.1.1.1.1.3.3.1.3" xref="S3.E12.m2.1.1.1.1.3.3.1.3.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.1.3.2" xref="S3.E12.m2.1.1.1.1.3.3.1.3.2.cmml">N</mi><mo id="S3.E12.m2.1.1.1.1.3.3.1.3.3" xref="S3.E12.m2.1.1.1.1.3.3.1.3.3.cmml">β€²</mo></msup></munderover></mstyle><mrow id="S3.E12.m2.1.1.1.1.3.3.2" xref="S3.E12.m2.1.1.1.1.3.3.2.cmml"><msub id="S3.E12.m2.1.1.1.1.3.3.2.2" xref="S3.E12.m2.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.2.2.2" xref="S3.E12.m2.1.1.1.1.3.3.2.2.2.cmml">f</mi><mi id="S3.E12.m2.1.1.1.1.3.3.2.2.3" xref="S3.E12.m2.1.1.1.1.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.m2.1.1.1.1.3.3.2.1" xref="S3.E12.m2.1.1.1.1.3.3.2.1.cmml">β€‹</mo><msub id="S3.E12.m2.1.1.1.1.3.3.2.3" xref="S3.E12.m2.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E12.m2.1.1.1.1.3.3.2.3.2" xref="S3.E12.m2.1.1.1.1.3.3.2.3.2.cmml">P</mi><mi id="S3.E12.m2.1.1.1.1.3.3.2.3.3" xref="S3.E12.m2.1.1.1.1.3.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo id="S3.E12.m2.1.1.1.2" xref="S3.E12.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m2.1b"><apply id="S3.E12.m2.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1"><eq id="S3.E12.m2.1.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E12.m2.1.1.1.1.2.cmml" xref="S3.E12.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E12.m2.1.1.1.1.3.cmml" xref="S3.E12.m2.1.1.1.1.3"><times id="S3.E12.m2.1.1.1.1.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.1"></times><apply id="S3.E12.m2.1.1.1.1.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.2.2">π›Ό</ci><cn type="integer" id="S3.E12.m2.1.1.1.1.3.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.2.3">1</cn></apply><apply id="S3.E12.m2.1.1.1.1.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3"><apply id="S3.E12.m2.1.1.1.1.3.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.1.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1">superscript</csymbol><apply id="S3.E12.m2.1.1.1.1.3.3.1.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.1.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E12.m2.1.1.1.1.3.3.1.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.2"></sum><apply id="S3.E12.m2.1.1.1.1.3.3.1.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3"><eq id="S3.E12.m2.1.1.1.1.3.3.1.2.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E12.m2.1.1.1.1.3.3.1.2.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.2">π‘–</ci><cn type="integer" id="S3.E12.m2.1.1.1.1.3.3.1.2.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E12.m2.1.1.1.1.3.3.1.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.1.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3">superscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.3.1.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3.2">π‘</ci><ci id="S3.E12.m2.1.1.1.1.3.3.1.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.1.3.3">β€²</ci></apply></apply><apply id="S3.E12.m2.1.1.1.1.3.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2"><times id="S3.E12.m2.1.1.1.1.3.3.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.1"></times><apply id="S3.E12.m2.1.1.1.1.3.3.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2.2">π‘“</ci><ci id="S3.E12.m2.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.2.3">π‘–</ci></apply><apply id="S3.E12.m2.1.1.1.1.3.3.2.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3.2">π‘ƒ</ci><ci id="S3.E12.m2.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E12.m2.1.1.1.1.3.3.2.3.3">π‘–</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m2.1c">\displaystyle=\alpha_{1}\sum_{i=1}^{N^{\prime}}{f_{i}P_{i}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13.m1.1" class="ltx_Math" alttext="\displaystyle f_{i}" display="inline"><semantics id="S3.E13.m1.1a"><msub id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><mi id="S3.E13.m1.1.1.2" xref="S3.E13.m1.1.1.2.cmml">f</mi><mi id="S3.E13.m1.1.1.3" xref="S3.E13.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1">subscript</csymbol><ci id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1.2">π‘“</ci><ci id="S3.E13.m1.1.1.3.cmml" xref="S3.E13.m1.1.1.3">π‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\displaystyle f_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13.m2.3" class="ltx_Math" alttext="\displaystyle=\frac{N^{\prime}}{K^{\prime}T}\sum_{t=1}^{T}{\mathds{1}(\text{Token $t$ selects Expert $i$})}," display="inline"><semantics id="S3.E13.m2.3a"><mrow id="S3.E13.m2.3.3.1" xref="S3.E13.m2.3.3.1.1.cmml"><mrow id="S3.E13.m2.3.3.1.1" xref="S3.E13.m2.3.3.1.1.cmml"><mi id="S3.E13.m2.3.3.1.1.2" xref="S3.E13.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E13.m2.3.3.1.1.1" xref="S3.E13.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E13.m2.3.3.1.1.3" xref="S3.E13.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E13.m2.3.3.1.1.3.2" xref="S3.E13.m2.3.3.1.1.3.2.cmml"><mfrac id="S3.E13.m2.3.3.1.1.3.2a" xref="S3.E13.m2.3.3.1.1.3.2.cmml"><msup id="S3.E13.m2.3.3.1.1.3.2.2" xref="S3.E13.m2.3.3.1.1.3.2.2.cmml"><mi id="S3.E13.m2.3.3.1.1.3.2.2.2" xref="S3.E13.m2.3.3.1.1.3.2.2.2.cmml">N</mi><mo id="S3.E13.m2.3.3.1.1.3.2.2.3" xref="S3.E13.m2.3.3.1.1.3.2.2.3.cmml">β€²</mo></msup><mrow id="S3.E13.m2.3.3.1.1.3.2.3" xref="S3.E13.m2.3.3.1.1.3.2.3.cmml"><msup id="S3.E13.m2.3.3.1.1.3.2.3.2" xref="S3.E13.m2.3.3.1.1.3.2.3.2.cmml"><mi id="S3.E13.m2.3.3.1.1.3.2.3.2.2" xref="S3.E13.m2.3.3.1.1.3.2.3.2.2.cmml">K</mi><mo id="S3.E13.m2.3.3.1.1.3.2.3.2.3" xref="S3.E13.m2.3.3.1.1.3.2.3.2.3.cmml">β€²</mo></msup><mo lspace="0em" rspace="0em" id="S3.E13.m2.3.3.1.1.3.2.3.1" xref="S3.E13.m2.3.3.1.1.3.2.3.1.cmml">β€‹</mo><mi id="S3.E13.m2.3.3.1.1.3.2.3.3" xref="S3.E13.m2.3.3.1.1.3.2.3.3.cmml">T</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E13.m2.3.3.1.1.3.1" xref="S3.E13.m2.3.3.1.1.3.1.cmml">β€‹</mo><mrow id="S3.E13.m2.3.3.1.1.3.3" xref="S3.E13.m2.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E13.m2.3.3.1.1.3.3.1" xref="S3.E13.m2.3.3.1.1.3.3.1.cmml"><munderover id="S3.E13.m2.3.3.1.1.3.3.1a" xref="S3.E13.m2.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E13.m2.3.3.1.1.3.3.1.2.2" xref="S3.E13.m2.3.3.1.1.3.3.1.2.2.cmml">β‘</mo><mrow id="S3.E13.m2.3.3.1.1.3.3.1.2.3" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.cmml"><mi id="S3.E13.m2.3.3.1.1.3.3.1.2.3.2" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.2.cmml">t</mi><mo id="S3.E13.m2.3.3.1.1.3.3.1.2.3.1" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E13.m2.3.3.1.1.3.3.1.2.3.3" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E13.m2.3.3.1.1.3.3.1.3" xref="S3.E13.m2.3.3.1.1.3.3.1.3.cmml">T</mi></munderover></mstyle><mrow id="S3.E13.m2.3.3.1.1.3.3.2" xref="S3.E13.m2.3.3.1.1.3.3.2.cmml"><mn id="S3.E13.m2.3.3.1.1.3.3.2.2" xref="S3.E13.m2.3.3.1.1.3.3.2.2.cmml">π™</mn><mo lspace="0em" rspace="0em" id="S3.E13.m2.3.3.1.1.3.3.2.1" xref="S3.E13.m2.3.3.1.1.3.3.2.1.cmml">β€‹</mo><mrow id="S3.E13.m2.3.3.1.1.3.3.2.3.2" xref="S3.E13.m2.2.2.2ac.cmml"><mo stretchy="false" id="S3.E13.m2.3.3.1.1.3.3.2.3.2.1" xref="S3.E13.m2.2.2.2ac.cmml">(</mo><mrow id="S3.E13.m2.2.2.2a" xref="S3.E13.m2.2.2.2ac.cmml"><mtext id="S3.E13.m2.2.2.2aa" xref="S3.E13.m2.2.2.2aa.cmml">Token&nbsp;</mtext><mi id="S3.E13.m2.1.1.1.m1.1.1" xref="S3.E13.m2.1.1.1.m1.1.1.cmml">t</mi><mtext id="S3.E13.m2.2.2.2ab" xref="S3.E13.m2.2.2.2aa.cmml">&nbsp;selects Expert&nbsp;</mtext><mi id="S3.E13.m2.2.2.2.m2.1.1" xref="S3.E13.m2.2.2.2.m2.1.1.cmml">i</mi></mrow><mo stretchy="false" id="S3.E13.m2.3.3.1.1.3.3.2.3.2.2" xref="S3.E13.m2.2.2.2ac.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E13.m2.3.3.1.2" xref="S3.E13.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m2.3b"><apply id="S3.E13.m2.3.3.1.1.cmml" xref="S3.E13.m2.3.3.1"><eq id="S3.E13.m2.3.3.1.1.1.cmml" xref="S3.E13.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E13.m2.3.3.1.1.2.cmml" xref="S3.E13.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E13.m2.3.3.1.1.3.cmml" xref="S3.E13.m2.3.3.1.1.3"><times id="S3.E13.m2.3.3.1.1.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.1"></times><apply id="S3.E13.m2.3.3.1.1.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2"><divide id="S3.E13.m2.3.3.1.1.3.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2"></divide><apply id="S3.E13.m2.3.3.1.1.3.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.2.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2">superscript</csymbol><ci id="S3.E13.m2.3.3.1.1.3.2.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2.2">π‘</ci><ci id="S3.E13.m2.3.3.1.1.3.2.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.2.3">β€²</ci></apply><apply id="S3.E13.m2.3.3.1.1.3.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3"><times id="S3.E13.m2.3.3.1.1.3.2.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.1"></times><apply id="S3.E13.m2.3.3.1.1.3.2.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.2.3.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2">superscript</csymbol><ci id="S3.E13.m2.3.3.1.1.3.2.3.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2.2">πΎ</ci><ci id="S3.E13.m2.3.3.1.1.3.2.3.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.2.3">β€²</ci></apply><ci id="S3.E13.m2.3.3.1.1.3.2.3.3.cmml" xref="S3.E13.m2.3.3.1.1.3.2.3.3">π‘‡</ci></apply></apply><apply id="S3.E13.m2.3.3.1.1.3.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3"><apply id="S3.E13.m2.3.3.1.1.3.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.3.1.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1">superscript</csymbol><apply id="S3.E13.m2.3.3.1.1.3.3.1.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E13.m2.3.3.1.1.3.3.1.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E13.m2.3.3.1.1.3.3.1.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.2"></sum><apply id="S3.E13.m2.3.3.1.1.3.3.1.2.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3"><eq id="S3.E13.m2.3.3.1.1.3.3.1.2.3.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S3.E13.m2.3.3.1.1.3.3.1.2.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.2">π‘΅</ci><cn type="integer" id="S3.E13.m2.3.3.1.1.3.3.1.2.3.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E13.m2.3.3.1.1.3.3.1.3.cmml" xref="S3.E13.m2.3.3.1.1.3.3.1.3">π‘‡</ci></apply><apply id="S3.E13.m2.3.3.1.1.3.3.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2"><times id="S3.E13.m2.3.3.1.1.3.3.2.1.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.1"></times><cn type="integer" id="S3.E13.m2.3.3.1.1.3.3.2.2.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.2">1</cn><ci id="S3.E13.m2.2.2.2ac.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.3.2"><mrow id="S3.E13.m2.2.2.2a.cmml" xref="S3.E13.m2.3.3.1.1.3.3.2.3.2"><mtext id="S3.E13.m2.2.2.2aa.cmml" xref="S3.E13.m2.2.2.2aa">Token&nbsp;</mtext><mi id="S3.E13.m2.1.1.1.m1.1.1.cmml" xref="S3.E13.m2.1.1.1.m1.1.1">t</mi><mtext id="S3.E13.m2.2.2.2ab.cmml" xref="S3.E13.m2.2.2.2aa">&nbsp;selects Expert&nbsp;</mtext><mi id="S3.E13.m2.2.2.2.m2.1.1.cmml" xref="S3.E13.m2.2.2.2.m2.1.1">i</mi></mrow></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m2.3c">\displaystyle=\frac{N^{\prime}}{K^{\prime}T}\sum_{t=1}^{T}{\mathds{1}(\text{Token $t$ selects Expert $i$})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E14.m1.1" class="ltx_Math" alttext="\displaystyle P_{i}" display="inline"><semantics id="S3.E14.m1.1a"><msub id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml"><mi id="S3.E14.m1.1.1.2" xref="S3.E14.m1.1.1.2.cmml">P</mi><mi id="S3.E14.m1.1.1.3" xref="S3.E14.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.cmml" xref="S3.E14.m1.1.1">subscript</csymbol><ci id="S3.E14.m1.1.1.2.cmml" xref="S3.E14.m1.1.1.2">π‘ƒ</ci><ci id="S3.E14.m1.1.1.3.cmml" xref="S3.E14.m1.1.1.3">π‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\displaystyle P_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E14.m2.3" class="ltx_Math" alttext="\displaystyle=\frac{1}{T}\sum_{t=1}^{T}{s_{i,t}}," display="inline"><semantics id="S3.E14.m2.3a"><mrow id="S3.E14.m2.3.3.1" xref="S3.E14.m2.3.3.1.1.cmml"><mrow id="S3.E14.m2.3.3.1.1" xref="S3.E14.m2.3.3.1.1.cmml"><mi id="S3.E14.m2.3.3.1.1.2" xref="S3.E14.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E14.m2.3.3.1.1.1" xref="S3.E14.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E14.m2.3.3.1.1.3" xref="S3.E14.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E14.m2.3.3.1.1.3.2" xref="S3.E14.m2.3.3.1.1.3.2.cmml"><mfrac id="S3.E14.m2.3.3.1.1.3.2a" xref="S3.E14.m2.3.3.1.1.3.2.cmml"><mn id="S3.E14.m2.3.3.1.1.3.2.2" xref="S3.E14.m2.3.3.1.1.3.2.2.cmml">1</mn><mi id="S3.E14.m2.3.3.1.1.3.2.3" xref="S3.E14.m2.3.3.1.1.3.2.3.cmml">T</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E14.m2.3.3.1.1.3.1" xref="S3.E14.m2.3.3.1.1.3.1.cmml">β€‹</mo><mrow id="S3.E14.m2.3.3.1.1.3.3" xref="S3.E14.m2.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E14.m2.3.3.1.1.3.3.1" xref="S3.E14.m2.3.3.1.1.3.3.1.cmml"><munderover id="S3.E14.m2.3.3.1.1.3.3.1a" xref="S3.E14.m2.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E14.m2.3.3.1.1.3.3.1.2.2" xref="S3.E14.m2.3.3.1.1.3.3.1.2.2.cmml">β‘</mo><mrow id="S3.E14.m2.3.3.1.1.3.3.1.2.3" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.cmml"><mi id="S3.E14.m2.3.3.1.1.3.3.1.2.3.2" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.2.cmml">t</mi><mo id="S3.E14.m2.3.3.1.1.3.3.1.2.3.1" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E14.m2.3.3.1.1.3.3.1.2.3.3" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E14.m2.3.3.1.1.3.3.1.3" xref="S3.E14.m2.3.3.1.1.3.3.1.3.cmml">T</mi></munderover></mstyle><msub id="S3.E14.m2.3.3.1.1.3.3.2" xref="S3.E14.m2.3.3.1.1.3.3.2.cmml"><mi id="S3.E14.m2.3.3.1.1.3.3.2.2" xref="S3.E14.m2.3.3.1.1.3.3.2.2.cmml">s</mi><mrow id="S3.E14.m2.2.2.2.4" xref="S3.E14.m2.2.2.2.3.cmml"><mi id="S3.E14.m2.1.1.1.1" xref="S3.E14.m2.1.1.1.1.cmml">i</mi><mo id="S3.E14.m2.2.2.2.4.1" xref="S3.E14.m2.2.2.2.3.cmml">,</mo><mi id="S3.E14.m2.2.2.2.2" xref="S3.E14.m2.2.2.2.2.cmml">t</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E14.m2.3.3.1.2" xref="S3.E14.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m2.3b"><apply id="S3.E14.m2.3.3.1.1.cmml" xref="S3.E14.m2.3.3.1"><eq id="S3.E14.m2.3.3.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E14.m2.3.3.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E14.m2.3.3.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.3"><times id="S3.E14.m2.3.3.1.1.3.1.cmml" xref="S3.E14.m2.3.3.1.1.3.1"></times><apply id="S3.E14.m2.3.3.1.1.3.2.cmml" xref="S3.E14.m2.3.3.1.1.3.2"><divide id="S3.E14.m2.3.3.1.1.3.2.1.cmml" xref="S3.E14.m2.3.3.1.1.3.2"></divide><cn type="integer" id="S3.E14.m2.3.3.1.1.3.2.2.cmml" xref="S3.E14.m2.3.3.1.1.3.2.2">1</cn><ci id="S3.E14.m2.3.3.1.1.3.2.3.cmml" xref="S3.E14.m2.3.3.1.1.3.2.3">π‘‡</ci></apply><apply id="S3.E14.m2.3.3.1.1.3.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3"><apply id="S3.E14.m2.3.3.1.1.3.3.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.3.3.1.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1">superscript</csymbol><apply id="S3.E14.m2.3.3.1.1.3.3.1.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.3.3.1.2.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E14.m2.3.3.1.1.3.3.1.2.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.2"></sum><apply id="S3.E14.m2.3.3.1.1.3.3.1.2.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3"><eq id="S3.E14.m2.3.3.1.1.3.3.1.2.3.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S3.E14.m2.3.3.1.1.3.3.1.2.3.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.2">π‘΅</ci><cn type="integer" id="S3.E14.m2.3.3.1.1.3.3.1.2.3.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E14.m2.3.3.1.1.3.3.1.3.cmml" xref="S3.E14.m2.3.3.1.1.3.3.1.3">π‘‡</ci></apply><apply id="S3.E14.m2.3.3.1.1.3.3.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.3.3.2.1.cmml" xref="S3.E14.m2.3.3.1.1.3.3.2">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.3.3.2.2.cmml" xref="S3.E14.m2.3.3.1.1.3.3.2.2">π‘ </ci><list id="S3.E14.m2.2.2.2.3.cmml" xref="S3.E14.m2.2.2.2.4"><ci id="S3.E14.m2.1.1.1.1.cmml" xref="S3.E14.m2.1.1.1.1">π‘–</ci><ci id="S3.E14.m2.2.2.2.2.cmml" xref="S3.E14.m2.2.2.2.2">π‘΅</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m2.3c">\displaystyle=\frac{1}{T}\sum_{t=1}^{T}{s_{i,t}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px1.p1.6" class="ltx_p">where <math id="S3.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\alpha_{1}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">Ξ±</mi><mn id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2">π›Ό</ci><cn type="integer" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">\alpha_{1}</annotation></semantics></math> is a hyper-parameter called expert-level balance factor, <math id="S3.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="N^{\prime}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><msup id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">N</mi><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">β€²</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2">π‘</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3">β€²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">N^{\prime}</annotation></semantics></math> is equal to <math id="S3.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="(mN-K_{s})" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1.cmml">β€‹</mo><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml">β’</mo><msub id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2.cmml">K</mi><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1"><minus id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.1"></minus><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2"><times id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.1"></times><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.2">π‘</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.2.3">π‘</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.2">πΎ</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.1.3.3">π‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.1c">(mN-K_{s})</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="K^{\prime}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.4.m4.1a"><msup id="S3.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml">K</mi><mo id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml">β€²</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2">πΎ</ci><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3">β€²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.4.m4.1c">K^{\prime}</annotation></semantics></math> is equal to <math id="S3.SS3.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="(mK-K_{s})" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1.cmml">β€‹</mo><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3.cmml">K</mi></mrow><mo id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml">β’</mo><msub id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2.cmml">K</mi><mi id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1"><minus id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.1"></minus><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2"><times id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.1"></times><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.2">π‘</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.2.3">πΎ</ci></apply><apply id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.2">πΎ</ci><ci id="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.5.m5.1.1.1.1.3.3">π‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.5.m5.1c">(mK-K_{s})</annotation></semantics></math> for brevity. <math id="S3.SS3.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="\mathds{1}(\cdot)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.6.m6.1a"><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.1.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml"><mn id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2.cmml">π™</mn><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1.cmml">β€‹</mo><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.3.2.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml">β‹…</mo><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.3.2.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2"><times id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.1"></times><cn type="integer" id="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.2.2">1</cn><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1">β‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.6.m6.1c">\mathds{1}(\cdot)</annotation></semantics></math> denotes the indicator function.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Device-Level Balance Loss.</h5>

<div id="S3.SS3.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.2">μ „λ¬Έκ°€ μμ¤€μ κ· ν• μ†μ‹¤ μ™Έμ— μ¥μΉ μμ¤€μ κ· ν• μ†μ‹¤μ„ μ†κ°ν•©λ‹λ‹¤. λ¶€ν• κ· ν•μ— λ€ν• κ³Όλ„ν• μ μ•½μ€ λ¨λΈ μ„±λ¥μ„ μ†μƒμ‹ν‚¤κΈ° λ•λ¬Έμ—, κ³„μ‚° λ³‘λ© ν„μƒμ„ μ™„ν™”ν•κΈ° μ„ν•΄ μ „λ¬Έκ°€ μμ¤€μ—μ„ μ—„κ²©ν• κ· ν• μ μ•½μ„ μ μ©ν•λ” κ²ƒμ€ λ¶ν•„μ”ν•΄μ§„λ‹¤. λ€μ‹ , μ°λ¦¬μ μ£Όμ” λ©ν‘λ” μ¥μΉ μ „λ°μ— κ±Έμ³ κ· ν• μ΅ν κ³„μ‚°μ„ λ³΄μ¥ν•λ” κ²ƒμ…λ‹λ‹¤. λΌμ°ν…λ λ¨λ“  μ „λ¬Έκ°€λ¥Ό <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">π·</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">D</annotation></semantics></math> κ·Έλ£Ή <math alttext="\{\mathcal{E}_{1},\mathcal{E}_{2},...,\mathcal{E}_{D}\}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.2.m2.4"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.4a"><mrow id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml"><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.4" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">{</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml">β„°</mi><mn id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.5" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2.cmml">β„°</mi><mn id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.6" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">β€¦</mi><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.7" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2.cmml">β„°</mi><mi id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3.cmml">D</mi></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.8" stretchy="false" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.4b"><set id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.4.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3"><apply id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2">β„°</ci><cn id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2">β„°</ci><cn id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">β€¦</ci><apply id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.2">β„°</ci><ci id="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.4.4.3.3.3">π·</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.4c">\{\mathcal{E}_{1},\mathcal{E}_{2},...,\mathcal{E}_{D}\}</annotation></semantics></math>λ΅ λ¶„ν• ν•κ³  κ° κ·Έλ£Ήμ„ λ‹¨μΌ λ””λ°”μ΄μ¤μ— λ°°ν¬ν•λ©΄ λ””λ°”μ΄μ¤ μμ¤€ κ· ν• μ†μ‹¤μ€ λ‹¤μκ³Ό κ°™μ΄ κ³„μ‚°λ©λ‹λ‹¤.</p>
<table id="A3.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E15.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{\mathrm{DevBal}}" display="inline"><semantics id="S3.E15.m1.1a"><msub id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.1.1.2" xref="S3.E15.m1.1.1.2.cmml">β„’</mi><mi id="S3.E15.m1.1.1.3" xref="S3.E15.m1.1.1.3.cmml">DevBal</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E15.m1.1b"><apply id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.cmml" xref="S3.E15.m1.1.1">subscript</csymbol><ci id="S3.E15.m1.1.1.2.cmml" xref="S3.E15.m1.1.1.2">β„’</ci><ci id="S3.E15.m1.1.1.3.cmml" xref="S3.E15.m1.1.1.3">DevBal</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.1c">\displaystyle\mathcal{L}_{\mathrm{DevBal}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E15.m2.1" class="ltx_Math" alttext="\displaystyle=\alpha_{2}\sum_{i=1}^{D}{f_{i}^{\prime}P_{i}^{\prime}}," display="inline"><semantics id="S3.E15.m2.1a"><mrow id="S3.E15.m2.1.1.1" xref="S3.E15.m2.1.1.1.1.cmml"><mrow id="S3.E15.m2.1.1.1.1" xref="S3.E15.m2.1.1.1.1.cmml"><mi id="S3.E15.m2.1.1.1.1.2" xref="S3.E15.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E15.m2.1.1.1.1.1" xref="S3.E15.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E15.m2.1.1.1.1.3" xref="S3.E15.m2.1.1.1.1.3.cmml"><msub id="S3.E15.m2.1.1.1.1.3.2" xref="S3.E15.m2.1.1.1.1.3.2.cmml"><mi id="S3.E15.m2.1.1.1.1.3.2.2" xref="S3.E15.m2.1.1.1.1.3.2.2.cmml">Ξ±</mi><mn id="S3.E15.m2.1.1.1.1.3.2.3" xref="S3.E15.m2.1.1.1.1.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E15.m2.1.1.1.1.3.1" xref="S3.E15.m2.1.1.1.1.3.1.cmml">β€‹</mo><mrow id="S3.E15.m2.1.1.1.1.3.3" xref="S3.E15.m2.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E15.m2.1.1.1.1.3.3.1" xref="S3.E15.m2.1.1.1.1.3.3.1.cmml"><munderover id="S3.E15.m2.1.1.1.1.3.3.1a" xref="S3.E15.m2.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E15.m2.1.1.1.1.3.3.1.2.2" xref="S3.E15.m2.1.1.1.1.3.3.1.2.2.cmml">β‘</mo><mrow id="S3.E15.m2.1.1.1.1.3.3.1.2.3" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.cmml"><mi id="S3.E15.m2.1.1.1.1.3.3.1.2.3.2" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E15.m2.1.1.1.1.3.3.1.2.3.1" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E15.m2.1.1.1.1.3.3.1.2.3.3" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E15.m2.1.1.1.1.3.3.1.3" xref="S3.E15.m2.1.1.1.1.3.3.1.3.cmml">D</mi></munderover></mstyle><mrow id="S3.E15.m2.1.1.1.1.3.3.2" xref="S3.E15.m2.1.1.1.1.3.3.2.cmml"><msubsup id="S3.E15.m2.1.1.1.1.3.3.2.2" xref="S3.E15.m2.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E15.m2.1.1.1.1.3.3.2.2.2.2" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.2.cmml">f</mi><mi id="S3.E15.m2.1.1.1.1.3.3.2.2.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.3.cmml">i</mi><mo id="S3.E15.m2.1.1.1.1.3.3.2.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.2.3.cmml">β€²</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E15.m2.1.1.1.1.3.3.2.1" xref="S3.E15.m2.1.1.1.1.3.3.2.1.cmml">β€‹</mo><msubsup id="S3.E15.m2.1.1.1.1.3.3.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E15.m2.1.1.1.1.3.3.2.3.2.2" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.2.cmml">P</mi><mi id="S3.E15.m2.1.1.1.1.3.3.2.3.2.3" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.3.cmml">i</mi><mo id="S3.E15.m2.1.1.1.1.3.3.2.3.3" xref="S3.E15.m2.1.1.1.1.3.3.2.3.3.cmml">β€²</mo></msubsup></mrow></mrow></mrow></mrow><mo id="S3.E15.m2.1.1.1.2" xref="S3.E15.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m2.1b"><apply id="S3.E15.m2.1.1.1.1.cmml" xref="S3.E15.m2.1.1.1"><eq id="S3.E15.m2.1.1.1.1.1.cmml" xref="S3.E15.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E15.m2.1.1.1.1.2.cmml" xref="S3.E15.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E15.m2.1.1.1.1.3.cmml" xref="S3.E15.m2.1.1.1.1.3"><times id="S3.E15.m2.1.1.1.1.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.1"></times><apply id="S3.E15.m2.1.1.1.1.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E15.m2.1.1.1.1.3.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.2.2">π›Ό</ci><cn type="integer" id="S3.E15.m2.1.1.1.1.3.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.2.3">2</cn></apply><apply id="S3.E15.m2.1.1.1.1.3.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3"><apply id="S3.E15.m2.1.1.1.1.3.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.1.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1">superscript</csymbol><apply id="S3.E15.m2.1.1.1.1.3.3.1.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.1.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E15.m2.1.1.1.1.3.3.1.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.2"></sum><apply id="S3.E15.m2.1.1.1.1.3.3.1.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3"><eq id="S3.E15.m2.1.1.1.1.3.3.1.2.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E15.m2.1.1.1.1.3.3.1.2.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.2">π‘–</ci><cn type="integer" id="S3.E15.m2.1.1.1.1.3.3.1.2.3.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E15.m2.1.1.1.1.3.3.1.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.1.3">π·</ci></apply><apply id="S3.E15.m2.1.1.1.1.3.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2"><times id="S3.E15.m2.1.1.1.1.3.3.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.1"></times><apply id="S3.E15.m2.1.1.1.1.3.3.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2">superscript</csymbol><apply id="S3.E15.m2.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.2.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E15.m2.1.1.1.1.3.3.2.2.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.2">π‘“</ci><ci id="S3.E15.m2.1.1.1.1.3.3.2.2.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2.2.3">π‘–</ci></apply><ci id="S3.E15.m2.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.2.3">β€²</ci></apply><apply id="S3.E15.m2.1.1.1.1.3.3.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E15.m2.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E15.m2.1.1.1.1.3.3.2.3.2.1.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E15.m2.1.1.1.1.3.3.2.3.2.2.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.2">π‘ƒ</ci><ci id="S3.E15.m2.1.1.1.1.3.3.2.3.2.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3.2.3">π‘–</ci></apply><ci id="S3.E15.m2.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E15.m2.1.1.1.1.3.3.2.3.3">β€²</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m2.1c">\displaystyle=\alpha_{2}\sum_{i=1}^{D}{f_{i}^{\prime}P_{i}^{\prime}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
<tbody id="S3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E16.m1.1" class="ltx_Math" alttext="\displaystyle f_{i}^{\prime}" display="inline"><semantics id="S3.E16.m1.1a"><msubsup id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml"><mi id="S3.E16.m1.1.1.2.2" xref="S3.E16.m1.1.1.2.2.cmml">f</mi><mi id="S3.E16.m1.1.1.2.3" xref="S3.E16.m1.1.1.2.3.cmml">i</mi><mo id="S3.E16.m1.1.1.3" xref="S3.E16.m1.1.1.3.cmml">β€²</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.E16.m1.1b"><apply id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.cmml" xref="S3.E16.m1.1.1">superscript</csymbol><apply id="S3.E16.m1.1.1.2.cmml" xref="S3.E16.m1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.2.1.cmml" xref="S3.E16.m1.1.1">subscript</csymbol><ci id="S3.E16.m1.1.1.2.2.cmml" xref="S3.E16.m1.1.1.2.2">π‘“</ci><ci id="S3.E16.m1.1.1.2.3.cmml" xref="S3.E16.m1.1.1.2.3">π‘–</ci></apply><ci id="S3.E16.m1.1.1.3.cmml" xref="S3.E16.m1.1.1.3">β€²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.1c">\displaystyle f_{i}^{\prime}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16.m2.2" class="ltx_Math" alttext="\displaystyle=\frac{1}{|\mathcal{E}_{i}|}\sum_{j\in\mathcal{E}_{i}}{f_{j}}," display="inline"><semantics id="S3.E16.m2.2a"><mrow id="S3.E16.m2.2.2.1" xref="S3.E16.m2.2.2.1.1.cmml"><mrow id="S3.E16.m2.2.2.1.1" xref="S3.E16.m2.2.2.1.1.cmml"><mi id="S3.E16.m2.2.2.1.1.2" xref="S3.E16.m2.2.2.1.1.2.cmml"></mi><mo id="S3.E16.m2.2.2.1.1.1" xref="S3.E16.m2.2.2.1.1.1.cmml">=</mo><mrow id="S3.E16.m2.2.2.1.1.3" xref="S3.E16.m2.2.2.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E16.m2.1.1" xref="S3.E16.m2.1.1.cmml"><mfrac id="S3.E16.m2.1.1a" xref="S3.E16.m2.1.1.cmml"><mn id="S3.E16.m2.1.1.3" xref="S3.E16.m2.1.1.3.cmml">1</mn><mrow id="S3.E16.m2.1.1.1.1" xref="S3.E16.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E16.m2.1.1.1.1.2" xref="S3.E16.m2.1.1.1.2.1.cmml">|</mo><msub id="S3.E16.m2.1.1.1.1.1" xref="S3.E16.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m2.1.1.1.1.1.2" xref="S3.E16.m2.1.1.1.1.1.2.cmml">β„°</mi><mi id="S3.E16.m2.1.1.1.1.1.3" xref="S3.E16.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E16.m2.1.1.1.1.3" xref="S3.E16.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E16.m2.2.2.1.1.3.1" xref="S3.E16.m2.2.2.1.1.3.1.cmml">β€‹</mo><mrow id="S3.E16.m2.2.2.1.1.3.2" xref="S3.E16.m2.2.2.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E16.m2.2.2.1.1.3.2.1" xref="S3.E16.m2.2.2.1.1.3.2.1.cmml"><munder id="S3.E16.m2.2.2.1.1.3.2.1a" xref="S3.E16.m2.2.2.1.1.3.2.1.cmml"><mo movablelimits="false" id="S3.E16.m2.2.2.1.1.3.2.1.2" xref="S3.E16.m2.2.2.1.1.3.2.1.2.cmml">β‘</mo><mrow id="S3.E16.m2.2.2.1.1.3.2.1.3" xref="S3.E16.m2.2.2.1.1.3.2.1.3.cmml"><mi id="S3.E16.m2.2.2.1.1.3.2.1.3.2" xref="S3.E16.m2.2.2.1.1.3.2.1.3.2.cmml">j</mi><mo id="S3.E16.m2.2.2.1.1.3.2.1.3.1" xref="S3.E16.m2.2.2.1.1.3.2.1.3.1.cmml">β</mo><msub id="S3.E16.m2.2.2.1.1.3.2.1.3.3" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m2.2.2.1.1.3.2.1.3.3.2" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.2.cmml">β„°</mi><mi id="S3.E16.m2.2.2.1.1.3.2.1.3.3.3" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><msub id="S3.E16.m2.2.2.1.1.3.2.2" xref="S3.E16.m2.2.2.1.1.3.2.2.cmml"><mi id="S3.E16.m2.2.2.1.1.3.2.2.2" xref="S3.E16.m2.2.2.1.1.3.2.2.2.cmml">f</mi><mi id="S3.E16.m2.2.2.1.1.3.2.2.3" xref="S3.E16.m2.2.2.1.1.3.2.2.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S3.E16.m2.2.2.1.2" xref="S3.E16.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m2.2b"><apply id="S3.E16.m2.2.2.1.1.cmml" xref="S3.E16.m2.2.2.1"><eq id="S3.E16.m2.2.2.1.1.1.cmml" xref="S3.E16.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S3.E16.m2.2.2.1.1.2.cmml" xref="S3.E16.m2.2.2.1.1.2">absent</csymbol><apply id="S3.E16.m2.2.2.1.1.3.cmml" xref="S3.E16.m2.2.2.1.1.3"><times id="S3.E16.m2.2.2.1.1.3.1.cmml" xref="S3.E16.m2.2.2.1.1.3.1"></times><apply id="S3.E16.m2.1.1.cmml" xref="S3.E16.m2.1.1"><divide id="S3.E16.m2.1.1.2.cmml" xref="S3.E16.m2.1.1"></divide><cn type="integer" id="S3.E16.m2.1.1.3.cmml" xref="S3.E16.m2.1.1.3">1</cn><apply id="S3.E16.m2.1.1.1.2.cmml" xref="S3.E16.m2.1.1.1.1"><abs id="S3.E16.m2.1.1.1.2.1.cmml" xref="S3.E16.m2.1.1.1.1.2"></abs><apply id="S3.E16.m2.1.1.1.1.1.cmml" xref="S3.E16.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m2.1.1.1.1.1.1.cmml" xref="S3.E16.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.E16.m2.1.1.1.1.1.2.cmml" xref="S3.E16.m2.1.1.1.1.1.2">β„°</ci><ci id="S3.E16.m2.1.1.1.1.1.3.cmml" xref="S3.E16.m2.1.1.1.1.1.3">π‘–</ci></apply></apply></apply><apply id="S3.E16.m2.2.2.1.1.3.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2"><apply id="S3.E16.m2.2.2.1.1.3.2.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.1.1.3.2.1.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1">subscript</csymbol><sum id="S3.E16.m2.2.2.1.1.3.2.1.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.2"></sum><apply id="S3.E16.m2.2.2.1.1.3.2.1.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3"><in id="S3.E16.m2.2.2.1.1.3.2.1.3.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.1"></in><ci id="S3.E16.m2.2.2.1.1.3.2.1.3.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.2">π‘—</ci><apply id="S3.E16.m2.2.2.1.1.3.2.1.3.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.1.1.3.2.1.3.3.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3">subscript</csymbol><ci id="S3.E16.m2.2.2.1.1.3.2.1.3.3.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.2">β„°</ci><ci id="S3.E16.m2.2.2.1.1.3.2.1.3.3.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.1.3.3.3">π‘–</ci></apply></apply></apply><apply id="S3.E16.m2.2.2.1.1.3.2.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.1.1.3.2.2.1.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E16.m2.2.2.1.1.3.2.2.2.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2.2">π‘“</ci><ci id="S3.E16.m2.2.2.1.1.3.2.2.3.cmml" xref="S3.E16.m2.2.2.1.1.3.2.2.3">π‘—</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m2.2c">\displaystyle=\frac{1}{|\mathcal{E}_{i}|}\sum_{j\in\mathcal{E}_{i}}{f_{j}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="S3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E17.m1.1" class="ltx_Math" alttext="\displaystyle P_{i}^{\prime}" display="inline"><semantics id="S3.E17.m1.1a"><msubsup id="S3.E17.m1.1.1" xref="S3.E17.m1.1.1.cmml"><mi id="S3.E17.m1.1.1.2.2" xref="S3.E17.m1.1.1.2.2.cmml">P</mi><mi id="S3.E17.m1.1.1.2.3" xref="S3.E17.m1.1.1.2.3.cmml">i</mi><mo id="S3.E17.m1.1.1.3" xref="S3.E17.m1.1.1.3.cmml">β€²</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.E17.m1.1b"><apply id="S3.E17.m1.1.1.cmml" xref="S3.E17.m1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.1.cmml" xref="S3.E17.m1.1.1">superscript</csymbol><apply id="S3.E17.m1.1.1.2.cmml" xref="S3.E17.m1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.1.1.2.1.cmml" xref="S3.E17.m1.1.1">subscript</csymbol><ci id="S3.E17.m1.1.1.2.2.cmml" xref="S3.E17.m1.1.1.2.2">π‘ƒ</ci><ci id="S3.E17.m1.1.1.2.3.cmml" xref="S3.E17.m1.1.1.2.3">π‘–</ci></apply><ci id="S3.E17.m1.1.1.3.cmml" xref="S3.E17.m1.1.1.3">β€²</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.1c">\displaystyle P_{i}^{\prime}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E17.m2.1" class="ltx_Math" alttext="\displaystyle=\sum_{j\in\mathcal{E}_{i}}{P_{j}}," display="inline"><semantics id="S3.E17.m2.1a"><mrow id="S3.E17.m2.1.1.1" xref="S3.E17.m2.1.1.1.1.cmml"><mrow id="S3.E17.m2.1.1.1.1" xref="S3.E17.m2.1.1.1.1.cmml"><mi id="S3.E17.m2.1.1.1.1.2" xref="S3.E17.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E17.m2.1.1.1.1.1" xref="S3.E17.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E17.m2.1.1.1.1.3" xref="S3.E17.m2.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E17.m2.1.1.1.1.3.1" xref="S3.E17.m2.1.1.1.1.3.1.cmml"><munder id="S3.E17.m2.1.1.1.1.3.1a" xref="S3.E17.m2.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E17.m2.1.1.1.1.3.1.2" xref="S3.E17.m2.1.1.1.1.3.1.2.cmml">β‘</mo><mrow id="S3.E17.m2.1.1.1.1.3.1.3" xref="S3.E17.m2.1.1.1.1.3.1.3.cmml"><mi id="S3.E17.m2.1.1.1.1.3.1.3.2" xref="S3.E17.m2.1.1.1.1.3.1.3.2.cmml">j</mi><mo id="S3.E17.m2.1.1.1.1.3.1.3.1" xref="S3.E17.m2.1.1.1.1.3.1.3.1.cmml">β</mo><msub id="S3.E17.m2.1.1.1.1.3.1.3.3" xref="S3.E17.m2.1.1.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E17.m2.1.1.1.1.3.1.3.3.2" xref="S3.E17.m2.1.1.1.1.3.1.3.3.2.cmml">β„°</mi><mi id="S3.E17.m2.1.1.1.1.3.1.3.3.3" xref="S3.E17.m2.1.1.1.1.3.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><msub id="S3.E17.m2.1.1.1.1.3.2" xref="S3.E17.m2.1.1.1.1.3.2.cmml"><mi id="S3.E17.m2.1.1.1.1.3.2.2" xref="S3.E17.m2.1.1.1.1.3.2.2.cmml">P</mi><mi id="S3.E17.m2.1.1.1.1.3.2.3" xref="S3.E17.m2.1.1.1.1.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E17.m2.1.1.1.2" xref="S3.E17.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m2.1b"><apply id="S3.E17.m2.1.1.1.1.cmml" xref="S3.E17.m2.1.1.1"><eq id="S3.E17.m2.1.1.1.1.1.cmml" xref="S3.E17.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E17.m2.1.1.1.1.2.cmml" xref="S3.E17.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E17.m2.1.1.1.1.3.cmml" xref="S3.E17.m2.1.1.1.1.3"><apply id="S3.E17.m2.1.1.1.1.3.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E17.m2.1.1.1.1.3.1.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E17.m2.1.1.1.1.3.1.2.cmml" xref="S3.E17.m2.1.1.1.1.3.1.2"></sum><apply id="S3.E17.m2.1.1.1.1.3.1.3.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3"><in id="S3.E17.m2.1.1.1.1.3.1.3.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.1"></in><ci id="S3.E17.m2.1.1.1.1.3.1.3.2.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.2">π‘—</ci><apply id="S3.E17.m2.1.1.1.1.3.1.3.3.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E17.m2.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3">subscript</csymbol><ci id="S3.E17.m2.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3.2">β„°</ci><ci id="S3.E17.m2.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E17.m2.1.1.1.1.3.1.3.3.3">π‘–</ci></apply></apply></apply><apply id="S3.E17.m2.1.1.1.1.3.2.cmml" xref="S3.E17.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E17.m2.1.1.1.1.3.2.1.cmml" xref="S3.E17.m2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E17.m2.1.1.1.1.3.2.2.cmml" xref="S3.E17.m2.1.1.1.1.3.2.2">π‘ƒ</ci><ci id="S3.E17.m2.1.1.1.1.3.2.3.cmml" xref="S3.E17.m2.1.1.1.1.3.2.3">π‘—</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m2.1c">\displaystyle=\sum_{j\in\mathcal{E}_{i}}{P_{j}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.3">μ—¬κΈ°μ„ <math alttext="\alpha_{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.3.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.3.m1.1a"><msub id="S3.SS3.SSS0.Px2.p1.3.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2.cmml">Ξ±</mi><mn id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.2">π›Ό</ci><cn id="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m1.1c">\alpha_{2}</annotation></semantics></math>λ” λ””λ°”μ΄μ¤-λ λ²¨ λ°Έλ°μ¤ ν©ν„°λΌκ³  λ¶λ¦¬λ” ν•μ΄νΌ-νλΌλ―Έν„°μ΄λ‹¤. μ‹¤μ λ΅, λΌμ°ν… λ¶•κ΄΄μ μ„ν—μ„ μ™„ν™”ν•κΈ° μ„ν•΄ μ‘μ€ μ „λ¬Έκ°€ μμ¤€μ κ· ν• μ”μ†λ¥Ό μ„¤μ •ν•κ³ , μ¥μΉ μ „λ°μ— κ±Έμ³ κ· ν• κ³„μ‚°μ„ μ΄‰μ§„ν•κΈ° μ„ν•΄ λ” ν° μ¥μΉ μμ¤€μ κ· ν• μ”μ†λ¥Ό μ„¤μ •ν•λ‹¤.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Validation Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Training Data and Tokenization</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">μ°λ¦¬μ ν›λ ¨ λ°μ΄ν„°λ” DeepSeek-AIκ°€ λ§λ“  λ€κ·λ¨ λ‹¤κµ­μ–΄ λ§λ­‰μΉμ—μ„ μƒν”λ§λλ‹¤. μ½”νΌμ¤λ” μ£Όλ΅ μμ–΄μ™€ μ¤‘κµ­μ–΄μ— μ΄μ μ„ λ§μ¶”μ§€λ§ λ‹¤λ¥Έ μ–Έμ–΄λ“¤λ„ ν¬ν•¨ν•λ‹¤. μ›Ή ν…μ¤νΈ, μν•™ μλ£, μ½”λ”© μ¤ν¬λ¦½νΈ, μ¶ν λ¬Έν— λ° κΈ°νƒ€ λ‹¤μ–‘ν• ν…μ¤νΈ μλ£λ¥Ό ν¬ν•¨ν• λ‹¤μ–‘ν• μ¶μ²μ—μ„ νμƒλλ‹¤. κ²€μ¦ μ‹¤ν—μ„ μ„ν•΄ μ½”νΌμ¤μ—μ„ 100B ν† ν°μ„ ν¬ν•¨ν•λ” ν•μ„ μ§‘ν•©μ„ μƒν”λ§ν•μ—¬ λ¨λΈμ„ ν•™μµν•λ‹¤. ν† ν°ν™”λ¥Ό μ„ν•΄ HuggingFace Tokenizer<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://github.com/huggingface/tokenizers</span></span></span> λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ ν›λ ¨ λ§λ­‰μΉμ μ‘μ€ λ¶€λ¶„ μ§‘ν•©μ— λ°”μ΄νΈ μ μΈμ½”λ”©(BPE) <cite class="ltx_cite ltx_citemacro_citep">(Sennrich etΒ al., <a class="ltx_ref" href="#bib.bib45" title="">2016</a>)</cite> tokenizersλ¥Ό ν›λ ¨ν•©λ‹λ‹¤. κ²€μ¦ μ‹¤ν—μ—μ„λ” μ–΄ν ν¬κΈ°κ°€ 8KμΈ ν† ν°ν™”κΈ°λ¥Ό μ¤€λΉ„ν•μ€μΌλ©°, λ” ν° λ¨λΈμ„ ν›λ ¨ν•  λ• μ–΄ν ν¬κΈ°κ°€ ν™•μ¥λ  κ²ƒμ΄λ‹¤.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Infrastructures</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">μ‹¤ν—μ€ HAI-LLM <cite class="ltx_cite ltx_citemacro_citep">(High-Flyer, <a class="ltx_ref" href="#bib.bib22" title="">2023</a>)</cite>, λ°μ΄ν„°μ™€ ν…μ„ λ³‘λ ¬μ„±μ„ κ²°ν•©ν•μ—¬ ν…μ„ λ³‘λ ¬μ„± <cite class="ltx_cite ltx_citemacro_citep">(Shoeybi etΒ al., <a class="ltx_ref" href="#bib.bib49" title="">2019</a>; Narayanan etΒ al., <a class="ltx_ref" href="#bib.bib37" title="">2021</a>; Korthikanti etΒ al., <a class="ltx_ref" href="#bib.bib29" title="">2023</a>)</cite>, ZeRO λ°μ΄ν„° λ³‘λ ¬μ„± <cite class="ltx_cite ltx_citemacro_citep">(Rajbhandari etΒ al., <a class="ltx_ref" href="#bib.bib39" title="">2020</a>)</cite>, PipeDream νμ΄ν”„λΌμΈ λ³‘λ ¬μ„± <cite class="ltx_cite ltx_citemacro_citep">(Harlap etΒ al., <a class="ltx_ref" href="#bib.bib19" title="">2018</a>)</cite>, λ³΄λ‹¤ κµ¬μ²΄μ μΌλ΅ μ „λ¬Έκ°€ λ³‘λ ¬μ„± <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin etΒ al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite> λ“±μ λ‹¤μ¤‘ λ³‘λ ¬μ„± μ „λµμ„ ν†µν•©ν• ν¨μ¨μ μ΄κ³  κ²½λ‰ν™”λ ν›λ ¨ ν”„λ μ„μ›ν¬λ¥Ό κΈ°λ°μΌλ΅ μ‹¤ν—μ„ μ§„ν–‰ν•μ€λ‹¤. μ„±λ¥ μµμ ν™”λ¥Ό μ„ν•΄ GPU μ»¤λ„μ„ CUDAμ™€ Triton<cite class="ltx_cite ltx_citemacro_citep">(Tillet etΒ al., <a class="ltx_ref" href="#bib.bib51" title="">2019</a>)</cite>λ΅ κ°λ°ν•μ—¬ μ•κ³ λ¦¬μ¦μ„ κ²μ΄ν…ν•κ³  μ„λ΅ λ‹¤λ¥Έ μ „λ¬Έκ°€μ—μ„ μ„ ν• κ³„μΈµμ— κ±Έμ³ κ³„μ‚°μ„ μµν•©ν•λ‹¤.</p>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS2.p2.1">λ¨λ“  μ‹¤ν—μ€ NVIDIA A100 λλ” H800 GPUκ°€ μ¥μ°©λ ν΄λ¬μ¤ν„°μ—μ„ μν–‰λλ‹¤. A100 ν΄λ¬μ¤ν„°μ κ° λ…Έλ“λ” NVLink λΈλ¦¬μ§€λ¥Ό ν†µν•΄ μμΌλ΅ μ—°κ²°λ 8κ°μ GPUλ¥Ό ν¬ν•¨ν•λ‹¤. H800 ν΄λ¬μ¤ν„°λ” λν• λ…Έλ“ λ‚΄μ—μ„ NVLink λ° NVSwitchλ¥Ό μ‚¬μ©ν•μ—¬ μƒνΈ μ—°κ²°λ λ…Έλ“λ‹Ή 8κ°μ GPUλ¥Ό νΉμ§•μΌλ΅ ν•λ‹¤. A100 λ° H800 ν΄λ¬μ¤ν„° λ¨λ‘μ— λ€ν•΄, InfiniBand μƒνΈμ—°κ²°μ€ λ…Έλ“λ“¤ κ°„μ ν†µμ‹ μ„ μ©μ΄ν•κ² ν•κΈ° μ„ν•΄ ν™μ©λλ‹¤.</p>
</div>
</section>
<section id="S4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3 </span>Hyper-Parameters</h4>

<section id="S4.SS1.SSS3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Model Settings.</h5>

<div id="S4.SS1.SSS3.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS3.Px1.p1.1">κ²€μ¦ μ‹¤ν—μ—μ„λ” νΈλμ¤ν¬λ¨Έ μΈµμ μλ¥Ό 9κ°, μ€λ‹‰ μ°¨μ›μ„ 1280κ°λ΅ μ„¤μ •ν•μ€λ‹¤. μ΄ 10κ°μ μ–΄ν…μ… ν—¤λ“λ¥Ό κ°–λ” λ‹¤μ¤‘ ν—¤λ“ μ–΄ν…μ… λ©”μ»¤λ‹μ¦μ„ μ‚¬μ©ν•μ€μΌλ©°, κ° ν—¤λ“μ μ°¨μ›μ€ 128μ΄λ‹¤. μ΄κΈ°ν™”λ¥Ό μ„ν•΄ ν•™μµ κ°€λ¥ν• λ¨λ“  νλΌλ―Έν„°λ” 0.006μ ν‘μ¤€ νΈμ°¨λ΅ λ¬΄μ‘μ„λ΅ μ΄κΈ°ν™”λλ‹¤. λ¨λ“  FFNμ„ MoE μΈµμΌλ΅ λ€μ²΄ν•κ³ , μ „λ¬Έκ°€ νλΌλ―Έν„°μ μ΄ μκ°€ ν‘μ¤€ FFNμ 16λ°°μΈμ§€ ν™•μΈν•λ‹¤. λν•, κ³µμ λ μ „λ¬Έκ°€ νλΌλ―Έν„°μ™€ ν™μ„±ν™”λ λΌμ°ν…λ μ „λ¬Έκ°€ νλΌλ―Έν„°λ¥Ό ν¬ν•¨ν• ν™μ„±ν™”λ μ „λ¬Έκ°€ νλΌλ―Έν„°λ¥Ό ν‘μ¤€ FFNμ 2λ°°λ΅ μ μ§€ν•λ‹¤. μ΄λ¬ν• κµ¬μ„± ν•μ—μ„, κ°κ°μ MoE λ¨λΈμ€ λ€λµ 2B μ΄ νλΌλ―Έν„°λ¥Ό κ°€μ§€λ©°, ν™μ„±ν™”λ νλΌλ―Έν„°μ μλ” μ•½ 0.3Bμ΄λ‹¤.</p>
</div>
</section>
<section id="S4.SS1.SSS3.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Settings.</h5>

<div id="S4.SS1.SSS3.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS3.Px2.p1.4">Hyper-parametersκ°€ <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.1.m1.1"><semantics id="S4.SS1.SSS3.Px2.p1.1.m1.1a"><mrow id="S4.SS1.SSS3.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.cmml"><msub id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2.cmml">Ξ²</mi><mn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.1.m1.1b"><apply id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1"><eq id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.1"></eq><apply id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.2">π›½</ci><cn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.1.m1.1c">\beta_{1}=0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.95" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.2.m2.1"><semantics id="S4.SS1.SSS3.Px2.p1.2.m2.1a"><mrow id="S4.SS1.SSS3.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.cmml"><msub id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2.cmml">Ξ²</mi><mn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.2.m2.1b"><apply id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1"><eq id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.1"></eq><apply id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.2">π›½</ci><cn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.2.m2.1c">\beta_{2}=0.95</annotation></semantics></math>, <math alttext="\mathrm{weight\_decay}=0.1" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.3.m3.1"><semantics id="S4.SS1.SSS3.Px2.p1.3.m3.1a"><mrow id="S4.SS1.SSS3.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.cmml"><mrow id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.cmml"><mi id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2.cmml">weight</mi><mo id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1" lspace="0em" rspace="0em" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1.cmml">β€‹</mo><mi id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1a" lspace="0em" rspace="0em" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1.cmml">β€‹</mo><mi id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4.cmml">decay</mi></mrow><mo id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.3.m3.1b"><apply id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1"><eq id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.1"></eq><apply id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2"><times id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.1"></times><ci id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.2">weight</ci><ci id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.3">_</ci><ci id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4.cmml" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.2.4">decay</ci></apply><cn id="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.3.m3.1c">\mathrm{weight\_decay}=0.1</annotation></semantics></math>λ΅ μ„¤μ •λ AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite>λ¥Ό μ±„μ©ν•λ‹¤. ν•™μµλ¥ μ€ μ¤€λΉ„-λ‹¨κ³„-λ¶•κ΄΄ μ „λµμ„ μ‚¬μ©ν•μ—¬ μμ•½λλ‹¤. μ²μμ—, ν•™μµλ¥ μ€ μ²μ 2K λ‹¨κ³„ λ™μ• 0μ—μ„ μµλ€κ°’κΉμ§€ μ„ ν•μ μΌλ΅ μ¦κ°€ν•λ‹¤. μ΄μ–΄μ„, ν•™μµ μ†λ„λ” ν›λ ¨ λ‹¨κ³„μ 80%μ—μ„ 0.316μ„ κ³±ν•κ³ , λ‹¤μ‹ ν›λ ¨ λ‹¨κ³„μ 90%μ—μ„ 0.316μ„ κ³±ν•λ‹¤. κ²€μ¦ μ‹¤ν—μ„ μ„ν• μµλ€ ν•™μµλ¥ μ€ <math alttext="1.08\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.Px2.p1.4.m4.1"><semantics id="S4.SS1.SSS3.Px2.p1.4.m4.1a"><mrow id="S4.SS1.SSS3.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.cmml"><mn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2.cmml">1.08</mn><mo id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1.cmml">Γ—</mo><msup id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.cmml"><mn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.cmml"><mo id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3a" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.cmml">β’</mo><mn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.Px2.p1.4.m4.1b"><apply id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1"><times id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.1"></times><cn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2.cmml" type="float" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.2">1.08</cn><apply id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3">superscript</csymbol><cn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.2">10</cn><apply id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3"><minus id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3"></minus><cn id="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.SSS3.Px2.p1.4.m4.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.Px2.p1.4.m4.1c">1.08\times 10^{-3}</annotation></semantics></math>λ΅ μ„¤μ •λκ³ , κ·Έλλ””μ–ΈνΈ ν΄λ¦¬ν•‘ κ·λ²”μ€ 1.0μΌλ΅ μ„¤μ •λλ‹¤. λ°°μΉ ν¬κΈ°λ” 2Kλ΅ μ„¤μ •λκ³ , μµλ€ μ‹ν€€μ¤ κΈΈμ΄κ°€ 2KμΈ κ²½μ°, κ°κ°μ νΈλ μ΄λ‹ λ°°μΉμ—λ” 4M ν† ν°μ΄ ν¬ν•¨λλ‹¤. μƒμ‘ν•κ², 100B νΈλ μ΄λ‹ ν† ν°λ“¤μ„ λ‹¬μ„±ν•κΈ° μ„ν•΄ νΈλ μ΄λ‹ λ‹¨κ³„λ“¤μ μ΄ μλ” 25,000μΌλ΅ μ„¤μ •λλ‹¤. ν›λ ¨ λ°μ΄ν„°κ°€ ν’λ¶€ν•κΈ° λ•λ¬Έμ— ν›λ ¨ μ¤‘ μ¤‘λ„ νƒλ½μ€ μ‚¬μ©ν•μ§€ μ•μµλ‹λ‹¤. μƒλ€μ μΌλ΅ μ‘μ€ λ¨λΈ ν¬κΈ°λ¥Ό κ°μ•ν•  λ•, μ „λ¬Έκ°€ νλΌλ―Έν„°λ¥Ό ν¬ν•¨ν• λ¨λ“  νλΌλ―Έν„°λ” λ¶κ· ν•ν• κ³„μ‚°μ„ ν”Όν•κΈ° μ„ν•΄ λ‹¨μΌ GPU μ¥μΉμ— λ°°μΉλλ‹¤. μ΄μ— λ”°λΌ κµμ΅ μ¤‘μ— ν† ν°μ„ λ–¨μ–΄λ¨λ¦¬μ§€ μ•μΌλ©° μ¥μΉ μμ¤€ μ”μ•΅ μ†μ‹¤μ„ μ‚¬μ©ν•μ§€ μ•μµλ‹λ‹¤. λΌμ°ν… λ¶•κ΄΄λ¥Ό λ°©μ§€ν•κΈ° μ„ν•΄ μ „λ¬Έκ°€ μμ¤€μ κ· ν• κ³„μλ¥Ό 0.01λ΅ μ„¤μ •ν•μ€λ‹¤.</p>
</div>
<div id="S4.SS1.SSS3.Px2.p2" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS3.Px2.p2.1">κ°€λ…μ„±μ„ μ„ν•΄ λ¶€λ΅ <a class="ltx_ref" href="#A1" title="Appendix A Overview of Hyper-Parameters β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">A</span></a>μ—μ„ λ‹¤μ–‘ν• ν¬κΈ°μ— κ±Έμ³ DeepSeekMoEμ— λ€ν• ν•μ΄νΌ λ§¤κ° λ³€μμ κ°μ” ν‘λ„ μ μ‹ν•λ‹¤.</p>
</div>
</section>
</section>
<section id="S4.SS1.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.4 </span>Evaluation Benchmarks</h4>

<div id="S4.SS1.SSS4.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.p1.1">λ‹¤μ–‘ν• μ ν•μ μ‘μ—…μ„ ν¬κ΄„ν•λ” κ΄‘λ²”μ„ν• λ²¤μΉλ§ν¬μ— λ€ν• ν‰κ°€λ¥Ό μν–‰ν•©λ‹λ‹¤. λ²¤μΉλ§ν¬λ¥Ό λ‹¤μκ³Ό κ°™μ΄ λ‚μ—΄ν•©λ‹λ‹¤.</p>
</div>
<section id="S4.SS1.SSS4.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Language Modeling.</h5>

<div id="S4.SS1.SSS4.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px1.p1.1">μ–Έμ–΄ λ¨λΈλ§μ„ μ„ν•΄, μ°λ¦¬λ” Pile<cite class="ltx_cite ltx_citemacro_citep">(Gao etΒ al., <a class="ltx_ref" href="#bib.bib17" title="">2020</a>)</cite>μ ν…μ¤νΈ μ„ΈνΈμ— λ€ν• λ¨λΈμ„ ν‰κ°€ν•λ©°, ν‰κ°€ λ©”νΈλ¦­μ€ κµμ°¨ μ—”νΈλ΅ν”Ό μ†μ‹¤μ΄λ‹¤.</p>
</div>
</section>
<section id="S4.SS1.SSS4.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Language Understanding and Reasoning.</h5>

<div id="S4.SS1.SSS4.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px2.p1.1">μ–Έμ–΄ μ΄ν•΄μ™€ μ¶”λ΅ μ„ μ„ν•΄ HellaSwag <cite class="ltx_cite ltx_citemacro_citep">(Zellers etΒ al., <a class="ltx_ref" href="#bib.bib59" title="">2019</a>)</cite>, PIQA <cite class="ltx_cite ltx_citemacro_citep">(Bisk etΒ al., <a class="ltx_ref" href="#bib.bib5" title="">2020</a>)</cite>, ARC-challengeμ™€ ARC-easy <cite class="ltx_cite ltx_citemacro_citep">(Clark etΒ al., <a class="ltx_ref" href="#bib.bib9" title="">2018</a>)</cite>λ¥Ό κ³ λ ¤ν•λ‹¤. μ΄λ¬ν• μ‘μ—…μ— λ€ν• ν‰κ°€ λ©”νΈλ¦­μ€ μ •ν™•μ„±μ…λ‹λ‹¤.</p>
</div>
</section>
<section id="S4.SS1.SSS4.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reading Comprehension.</h5>

<div id="S4.SS1.SSS4.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px3.p1.1">μ½κΈ° μ΄ν•΄λ¥Ό μ„ν•΄ RACE-highμ™€ RACE-middle <cite class="ltx_cite ltx_citemacro_cite">Lai etΒ al. (<a class="ltx_ref" href="#bib.bib31" title="">2017</a>)</cite>λ¥Ό μ‚¬μ©ν•λ©°, ν‰κ°€ μ²™λ„λ” μ •ν™•λ„μ΄λ‹¤.</p>
</div>
</section>
<section id="S4.SS1.SSS4.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Code Generation.</h5>

<div id="S4.SS1.SSS4.Px4.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px4.p1.1">μ½”λ“ μƒμ„±μ„ μ„ν•΄ HumanEval <cite class="ltx_cite ltx_citemacro_citep">(Chen etΒ al., <a class="ltx_ref" href="#bib.bib8" title="">2021</a>)</cite>μ™€ MBPP <cite class="ltx_cite ltx_citemacro_citep">(Austin etΒ al., <a class="ltx_ref" href="#bib.bib3" title="">2021</a>)</cite>μ— λ€ν• λ¨λΈμ„ ν‰κ°€ν•λ‹¤. ν‰κ°€ λ©”νΈλ¦­μ€ ν•λ‚μ μ„Έλ€ μ‹λ„μ— λ€ν• ν¨μ¤ λ μ΄νΈλ¥Ό λ‚νƒ€λ‚΄λ” Pass@1μ΄λ‹¤.</p>
</div>
</section>
<section id="S4.SS1.SSS4.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Closed-Book Question Answering.</h5>

<div id="S4.SS1.SSS4.Px5.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS1.SSS4.Px5.p1.1">ν΄λ΅μ¦λ¶ μ§μμ‘λ‹µμ„ μ„ν•΄, μ°λ¦¬λ” TriviaQA <cite class="ltx_cite ltx_citemacro_citep">(Joshi etΒ al., <a class="ltx_ref" href="#bib.bib28" title="">2017</a>)</cite>μ™€ NaturalQuestions <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski etΒ al., <a class="ltx_ref" href="#bib.bib30" title="">2019</a>)</cite>λ¥Ό κ³ λ ¤ν•λ‹¤. ν‰κ°€ λ©”νΈλ¦­μ€ μ •ν™• μΌμΉμ¨μ…λ‹λ‹¤.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></td>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.2.1" class="ltx_text ltx_font_bold"># Shot</span></td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.3.1" class="ltx_text ltx_font_bold">Dense</span></td>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.4.1" class="ltx_text ltx_font_bold">Hash Layer</span></td>
<td id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.5.1" class="ltx_text ltx_font_bold">Switch</span></td>
<td id="S4.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.6.1" class="ltx_text ltx_font_bold">GShard</span></td>
<td id="S4.T1.1.1.1.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.1.1.7.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="S4.T1.1.2.2" class="ltx_tr">
<td id="S4.T1.1.2.2.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"># Total Params</td>
<td id="S4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td id="S4.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
<td id="S4.T1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
<td id="S4.T1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
<td id="S4.T1.1.2.2.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.0B</td>
</tr>
<tr id="S4.T1.1.3.3" class="ltx_tr">
<td id="S4.T1.1.3.3.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;"># Activated Params</td>
<td id="S4.T1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td id="S4.T1.1.3.3.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td id="S4.T1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0.2B</td>
<td id="S4.T1.1.3.3.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.3B</td>
<td id="S4.T1.1.3.3.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.3B</td>
</tr>
<tr id="S4.T1.1.4.4" class="ltx_tr">
<td id="S4.T1.1.4.4.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">FLOPs per 2K Tokens</td>
<td id="S4.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">2.9T</td>
<td id="S4.T1.1.4.4.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">2.9T</td>
<td id="S4.T1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">2.9T</td>
<td id="S4.T1.1.4.4.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">4.3T</td>
<td id="S4.T1.1.4.4.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">4.3T</td>
</tr>
<tr id="S4.T1.1.5.5" class="ltx_tr">
<td id="S4.T1.1.5.5.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;"># Training Tokens</td>
<td id="S4.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td id="S4.T1.1.5.5.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td id="S4.T1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td id="S4.T1.1.5.5.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
<td id="S4.T1.1.5.5.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">100B</td>
</tr>
<tr id="S4.T1.1.6.6" class="ltx_tr">
<td id="S4.T1.1.6.6.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">Pile&nbsp;(Loss)</td>
<td id="S4.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">N/A</td>
<td id="S4.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.060</td>
<td id="S4.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1.932</td>
<td id="S4.T1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1.881</td>
<td id="S4.T1.1.6.6.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1.867</td>
<td id="S4.T1.1.6.6.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.6.6.7.1" class="ltx_text ltx_font_bold">1.808</span></td>
</tr>
<tr id="S4.T1.1.7.7" class="ltx_tr">
<td id="S4.T1.1.7.7.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">HellaSwag&nbsp;(Acc.)</td>
<td id="S4.T1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">38.8</td>
<td id="S4.T1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">46.2</td>
<td id="S4.T1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">49.1</td>
<td id="S4.T1.1.7.7.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">50.5</td>
<td id="S4.T1.1.7.7.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.7.7.7.1" class="ltx_text ltx_font_bold">54.8</span></td>
</tr>
<tr id="S4.T1.1.8.8" class="ltx_tr">
<td id="S4.T1.1.8.8.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">PIQA&nbsp;(Acc.)</td>
<td id="S4.T1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">66.8</td>
<td id="S4.T1.1.8.8.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">68.4</td>
<td id="S4.T1.1.8.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">70.5</td>
<td id="S4.T1.1.8.8.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">70.6</td>
<td id="S4.T1.1.8.8.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.8.8.7.1" class="ltx_text ltx_font_bold">72.3</span></td>
</tr>
<tr id="S4.T1.1.9.9" class="ltx_tr">
<td id="S4.T1.1.9.9.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">ARC-easy&nbsp;(Acc.)</td>
<td id="S4.T1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">41.0</td>
<td id="S4.T1.1.9.9.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">45.3</td>
<td id="S4.T1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">45.9</td>
<td id="S4.T1.1.9.9.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">43.9</td>
<td id="S4.T1.1.9.9.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.9.9.7.1" class="ltx_text ltx_font_bold">49.4</span></td>
</tr>
<tr id="S4.T1.1.10.10" class="ltx_tr">
<td id="S4.T1.1.10.10.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">ARC-challenge&nbsp;(Acc.)</td>
<td id="S4.T1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.10.10.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">26.0</td>
<td id="S4.T1.1.10.10.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">28.2</td>
<td id="S4.T1.1.10.10.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">30.2</td>
<td id="S4.T1.1.10.10.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">31.6</td>
<td id="S4.T1.1.10.10.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.10.10.7.1" class="ltx_text ltx_font_bold">34.3</span></td>
</tr>
<tr id="S4.T1.1.11.11" class="ltx_tr">
<td id="S4.T1.1.11.11.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">RACE-middle&nbsp;(Acc.)</td>
<td id="S4.T1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td id="S4.T1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">38.8</td>
<td id="S4.T1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">38.8</td>
<td id="S4.T1.1.11.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">43.6</td>
<td id="S4.T1.1.11.11.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">42.1</td>
<td id="S4.T1.1.11.11.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.11.11.7.1" class="ltx_text ltx_font_bold">44.0</span></td>
</tr>
<tr id="S4.T1.1.12.12" class="ltx_tr">
<td id="S4.T1.1.12.12.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">RACE-high&nbsp;(Acc.)</td>
<td id="S4.T1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td id="S4.T1.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">29.0</td>
<td id="S4.T1.1.12.12.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">30.0</td>
<td id="S4.T1.1.12.12.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">30.9</td>
<td id="S4.T1.1.12.12.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">30.4</td>
<td id="S4.T1.1.12.12.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.12.12.7.1" class="ltx_text ltx_font_bold">31.7</span></td>
</tr>
<tr id="S4.T1.1.13.13" class="ltx_tr">
<td id="S4.T1.1.13.13.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">HumanEval&nbsp;(Pass@1)</td>
<td id="S4.T1.1.13.13.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">0-shot</td>
<td id="S4.T1.1.13.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">0.0</td>
<td id="S4.T1.1.13.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">1.2</td>
<td id="S4.T1.1.13.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">2.4</td>
<td id="S4.T1.1.13.13.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">3.7</td>
<td id="S4.T1.1.13.13.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.13.13.7.1" class="ltx_text ltx_font_bold">4.9</span></td>
</tr>
<tr id="S4.T1.1.14.14" class="ltx_tr">
<td id="S4.T1.1.14.14.1" class="ltx_td ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">MBPP&nbsp;(Pass@1)</td>
<td id="S4.T1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">3-shot</td>
<td id="S4.T1.1.14.14.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.2</td>
<td id="S4.T1.1.14.14.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.6</td>
<td id="S4.T1.1.14.14.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">0.4</td>
<td id="S4.T1.1.14.14.6" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;">0.2</td>
<td id="S4.T1.1.14.14.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.14.14.7.1" class="ltx_text ltx_font_bold">2.2</span></td>
</tr>
<tr id="S4.T1.1.15.15" class="ltx_tr">
<td id="S4.T1.1.15.15.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">TriviaQA&nbsp;(EM)</td>
<td id="S4.T1.1.15.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td id="S4.T1.1.15.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">4.9</td>
<td id="S4.T1.1.15.15.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">6.5</td>
<td id="S4.T1.1.15.15.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">8.9</td>
<td id="S4.T1.1.15.15.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;">10.2</td>
<td id="S4.T1.1.15.15.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.15.15.7.1" class="ltx_text ltx_font_bold">16.6</span></td>
</tr>
<tr id="S4.T1.1.16.16" class="ltx_tr">
<td id="S4.T1.1.16.16.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">NaturalQuestions&nbsp;(EM)</td>
<td id="S4.T1.1.16.16.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">5-shot</td>
<td id="S4.T1.1.16.16.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">1.4</td>
<td id="S4.T1.1.16.16.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">1.4</td>
<td id="S4.T1.1.16.16.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:5.0pt;padding-right:5.0pt;">2.5</td>
<td id="S4.T1.1.16.16.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;">3.2</td>
<td id="S4.T1.1.16.16.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T1.1.16.16.7.1" class="ltx_text ltx_font_bold">5.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">ν‘ 1:</span></figcaption>
Evaluation results for validation experiments.
<span id="S4.T1.3.1" class="ltx_text ltx_font_bold">Bold</span> font indicates the best.
Compared with other MoE architectures, DeepSeekMoE exhibits a substantial performance advantage.
</figcaption>
</figure>
</section>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Evaluations</h3>

<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">DeepSeekMoEλ¥Ό ν¬ν•¨ν•μ—¬ κ²€μ¦ μ‹¤ν—μ„ μ„ν•΄ 5κ°€μ§€ λ¨λΈμ„ λΉ„κµν•λ‹¤. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.1">Dense</span>μ€ 0.2B μ΄ νλΌλ―Έν„°λ¥Ό κ°–λ” ν‘μ¤€ dense Transformer μ–Έμ–΄ λ¨λΈμ„ λ‚νƒ€λ‚Έλ‹¤. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.2">Hash Layer</span>Β <cite class="ltx_cite ltx_citemacro_citep">(Roller etΒ al., <a class="ltx_ref" href="#bib.bib42" title="">2021</a>)</cite>λ” μ΅°λ°€ν• κΈ°μ¤€μ„ κ³Ό μ •λ ¬λ 2.0B μ΄ νλΌλ―Έν„° λ° 0.2B ν™μ„±ν™”λ νλΌλ―Έν„°λ¥Ό κ°–λ” top-1 ν•΄μ‹ λΌμ°ν…μ„ κΈ°λ°μΌλ΅ ν•λ” MoE μ•„ν‚¤ν…μ²μ΄λ‹¤. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.3">Switch Transformer</span>Β <cite class="ltx_cite ltx_citemacro_citep">(Fedus etΒ al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite>λ” top-1 ν•™μµ κ°€λ¥ν• λΌμ°ν…μ„ κΈ°λ°μΌλ΅ ν•λ” λ λ‹¤λ¥Έ μ μ•λ ¤μ§„ MoE μ•„ν‚¤ν…μ²μ΄λ©°, μ΄ νλΌλ―Έν„°μ™€ ν™μ„±ν™”λ νλΌλ―Έν„°λ” Hash Layerμ™€ λ™μΌν•λ‹¤. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.4">GShard</span>Β <cite class="ltx_cite ltx_citemacro_citep">(Lepikhin etΒ al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite>λ” top-1 λΌμ°ν… λ°©λ²•μ— λΉ„ν•΄ ν• λ…μ μ „λ¬Έκ°€κ°€ λ” ν™μ„±ν™”λκΈ° λ•λ¬Έμ— 2.0Bμ μ΄ λ§¤κ° λ³€μμ™€ 0.3Bμ ν™μ„±ν™”λ λ§¤κ° λ³€μλ¥Ό μ‚¬μ©ν•μ—¬ top-2 ν•™μµ κ°€λ¥ν• λΌμ°ν… μ „λµμ„ μ‚¬μ©ν•©λ‹λ‹¤. <span class="ltx_text ltx_font_bold" id="S4.SS2.SSS0.Px1.p1.1.5">DeepSeekMoE</span> has 1 shared expert and 63 routed experts, where each expert is 0.25 times of a standard FFN. DeepSeekMoEλ¥Ό ν¬ν•¨ν•μ—¬, λΉ„κµλ λ¨λ“  λ¨λΈλ“¤μ€ λ™μΌν• νΈλ μ΄λ‹ μ½”νΌμ¤μ™€ νΈλ μ΄λ‹ ν•μ΄νΌ-νλΌλ―Έν„°λ¥Ό κ³µμ ν•λ‹¤. λΉ„κµλ λ¨λ“  MoE λ¨λΈμ€ λ™μΌν• μμ μ΄ νλΌλ―Έν„°λ¥Ό κ°€μ§€λ©°, GShardλ” DeepSeekMoEμ™€ λ™μΌν• μμ ν™μ„±ν™”λ νλΌλ―Έν„°λ¥Ό κ°–λ”λ‹¤.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5>

<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">ν‰κ°€ κ²°κ³Όλ¥Ό ν‘ <a class="ltx_ref" href="#S4.T1" title="Table 1 β€£ Closed-Book Question Answering. β€£ 4.1.4 Evaluation Benchmarks β€£ 4.1 Experimental Setup β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>μ— μ μ‹ν•λ‹¤. κ²€μ¦λ λ¨λ“  λ¨λΈμ— λ€ν•΄ 100B ν† ν°μ— λ€ν• ν›λ ¨ ν›„ μµμΆ… ν‰κ°€ κ²°κ³Όλ¥Ό λ³΄κ³ ν•λ‹¤. ν‘μ—μ„ μ°λ¦¬λ” λ‹¤μκ³Ό κ°™μ€ κ΄€μ°°μ„ ν•λ‹¤. (1) ν¬λ°•ν• μ•„ν‚¤ν…μ²μ™€ λ” λ§μ€ μ΄ λ§¤κ°λ³€μλ¥Ό μ‚¬μ©ν•μ—¬ ν•΄μ‹ κ³„μΈµ λ° μ¤μ„μΉ νΈλμ¤ν¬λ¨Έλ” λ™μΌν• μμ ν™μ„±ν™”λ λ§¤κ°λ³€μλ¥Ό μ‚¬μ©ν•μ—¬ μ΅°λ°€ν• κΈ°μ¤€μ„ λ³΄λ‹¤ ν›¨μ”¬ λ” κ°•λ ¥ν• μ„±λ¥μ„ λ‹¬μ„±ν•λ‹¤. (2) ν•΄μ‹ λ μ΄μ–΄ λ° μ¤μ„μΉ νΈλμ¤ν¬λ¨Έμ™€ λΉ„κµν•μ—¬, GShardλ” ν™μ„±ν™”λ νλΌλ―Έν„°κ°€ λ” λ§κ³  μ¤μ„μΉ νΈλμ¤ν¬λ¨Έλ³΄λ‹¤ μ•½κ°„ λ” λ‚μ€ μ„±λ¥μ„ λ‹¬μ„±ν•λ‹¤. (3) λ™μΌν• μμ μ΄ νλΌλ―Έν„° λ° ν™μ„±ν™”λ νλΌλ―Έν„°λ΅, DeepSeekMoEλ” GShardμ— λΉ„ν•΄ μ••λ„μ μΈ μ΄μ μ„ λ³΄μ—¬μ¤€λ‹¤. μ΄λ¬ν• κ²°κ³Όλ” MoE μ•„ν‚¤ν…μ²μ κΈ°μ΅΄ ν’κ²½ λ‚΄μ—μ„ μ°λ¦¬μ DeepSeekMoE μ•„ν‚¤ν…μ²μ μ°μμ„±μ„ λ³΄μ—¬μ¤€λ‹¤.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.2.2" class="ltx_tr">
<th id="S4.T2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.3.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="S4.T2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.4.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.1.1.1.1" class="ltx_text ltx_font_bold">GShard<math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.T2.1.1.1.1.m1.1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.1.cmml">Γ—</mo><mn id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><times id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">absent</csymbol><cn type="float" id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\times 1.5</annotation></semantics></math></span></td>
<td id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.2.1" class="ltx_text ltx_font_bold">Dense<math id="S4.T2.2.2.2.1.m1.1" class="ltx_Math" alttext="\times 16" display="inline"><semantics id="S4.T2.2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.cmml"><mi id="S4.T2.2.2.2.1.m1.1.1.2" xref="S4.T2.2.2.2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.T2.2.2.2.1.m1.1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.1.cmml">Γ—</mo><mn id="S4.T2.2.2.2.1.m1.1.1.3" xref="S4.T2.2.2.2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.1.m1.1b"><apply id="S4.T2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1"><times id="S4.T2.2.2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T2.2.2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.2.2.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S4.T2.2.2.2.1.m1.1.1.3.cmml" xref="S4.T2.2.2.2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.1.m1.1c">\times 16</annotation></semantics></math></span></td>
<td id="S4.T2.2.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T2.2.2.5.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="S4.T2.2.3.1" class="ltx_tr">
<th id="S4.T2.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th id="S4.T2.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.5</td>
<td id="S4.T2.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1</td>
<td id="S4.T2.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr id="S4.T2.2.4.2" class="ltx_tr">
<th id="S4.T2.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th id="S4.T2.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.4.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="S4.T2.2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td id="S4.T2.2.4.2.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr id="S4.T2.2.5.3" class="ltx_tr">
<th id="S4.T2.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th id="S4.T2.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.5.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="S4.T2.2.5.3.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td id="S4.T2.2.5.3.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr id="S4.T2.2.6.4" class="ltx_tr">
<th id="S4.T2.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th id="S4.T2.2.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.6.4.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.83B</td>
<td id="S4.T2.2.6.4.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td id="S4.T2.2.6.4.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
</tr>
<tr id="S4.T2.2.7.5" class="ltx_tr">
<th id="S4.T2.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th id="S4.T2.2.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.7.5.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.35B</td>
<td id="S4.T2.2.7.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td id="S4.T2.2.7.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.24B</td>
</tr>
<tr id="S4.T2.2.8.6" class="ltx_tr">
<th id="S4.T2.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">FLOPs per 2K Tokens</th>
<th id="S4.T2.2.8.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.8.6.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">5.8T</td>
<td id="S4.T2.2.8.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">24.6T</td>
<td id="S4.T2.2.8.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">4.3T</td>
</tr>
<tr id="S4.T2.2.9.7" class="ltx_tr">
<th id="S4.T2.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th id="S4.T2.2.9.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.9.7.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="S4.T2.2.9.7.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="S4.T2.2.9.7.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr id="S4.T2.2.10.8" class="ltx_tr">
<th id="S4.T2.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Pile&nbsp;(Loss)</th>
<th id="S4.T2.2.10.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="S4.T2.2.10.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.808</td>
<td id="S4.T2.2.10.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.806</td>
<td id="S4.T2.2.10.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.808</td>
</tr>
<tr id="S4.T2.2.11.9" class="ltx_tr">
<th id="S4.T2.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S4.T2.2.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.11.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">54.4</td>
<td id="S4.T2.2.11.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">55.1</td>
<td id="S4.T2.2.11.9.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">54.8</td>
</tr>
<tr id="S4.T2.2.12.10" class="ltx_tr">
<th id="S4.T2.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S4.T2.2.12.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.12.10.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.1</td>
<td id="S4.T2.2.12.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.9</td>
<td id="S4.T2.2.12.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">72.3</td>
</tr>
<tr id="S4.T2.2.13.11" class="ltx_tr">
<th id="S4.T2.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S4.T2.2.13.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.13.11.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">47.3</td>
<td id="S4.T2.2.13.11.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">51.9</td>
<td id="S4.T2.2.13.11.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">49.4</td>
</tr>
<tr id="S4.T2.2.14.12" class="ltx_tr">
<th id="S4.T2.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S4.T2.2.14.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.14.12.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">34.1</td>
<td id="S4.T2.2.14.12.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">33.8</td>
<td id="S4.T2.2.14.12.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">34.3</td>
</tr>
<tr id="S4.T2.2.15.13" class="ltx_tr">
<th id="S4.T2.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S4.T2.2.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="S4.T2.2.15.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">46.4</td>
<td id="S4.T2.2.15.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">46.3</td>
<td id="S4.T2.2.15.13.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">44.0</td>
</tr>
<tr id="S4.T2.2.16.14" class="ltx_tr">
<th id="S4.T2.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S4.T2.2.16.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="S4.T2.2.16.14.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">32.4</td>
<td id="S4.T2.2.16.14.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">33.0</td>
<td id="S4.T2.2.16.14.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
</tr>
<tr id="S4.T2.2.17.15" class="ltx_tr">
<th id="S4.T2.2.17.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S4.T2.2.17.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="S4.T2.2.17.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">3.0</td>
<td id="S4.T2.2.17.15.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">4.3</td>
<td id="S4.T2.2.17.15.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">4.9</td>
</tr>
<tr id="S4.T2.2.18.16" class="ltx_tr">
<th id="S4.T2.2.18.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S4.T2.2.18.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td id="S4.T2.2.18.16.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.6</td>
<td id="S4.T2.2.18.16.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.2</td>
<td id="S4.T2.2.18.16.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.2</td>
</tr>
<tr id="S4.T2.2.19.17" class="ltx_tr">
<th id="S4.T2.2.19.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S4.T2.2.19.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="S4.T2.2.19.17.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">15.7</td>
<td id="S4.T2.2.19.17.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">16.5</td>
<td id="S4.T2.2.19.17.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">16.6</td>
</tr>
<tr id="S4.T2.2.20.18" class="ltx_tr">
<th id="S4.T2.2.20.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S4.T2.2.20.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="S4.T2.2.20.18.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">4.7</td>
<td id="S4.T2.2.20.18.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">6.3</td>
<td id="S4.T2.2.20.18.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">5.7</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">ν‘ 2:</span></figcaption>
Comparisons among DeepSeekMoE, larger GShard models, and larger dense models.
In the line of β€# Expertsβ€, <math id="S4.T2.11.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.T2.11.m1.1b"><mi id="S4.T2.11.m1.1.1" xref="S4.T2.11.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.11.m1.1c"><ci id="S4.T2.11.m1.1.1.cmml" xref="S4.T2.11.m1.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.m1.1d">a</annotation></semantics></math> + <math id="S4.T2.12.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.T2.12.m2.1b"><mi id="S4.T2.12.m2.1.1" xref="S4.T2.12.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.12.m2.1c"><ci id="S4.T2.12.m2.1.1.cmml" xref="S4.T2.12.m2.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.m2.1d">b</annotation></semantics></math> denotes <math id="S4.T2.13.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.T2.13.m3.1b"><mi id="S4.T2.13.m3.1.1" xref="S4.T2.13.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.13.m3.1c"><ci id="S4.T2.13.m3.1.1.cmml" xref="S4.T2.13.m3.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.m3.1d">a</annotation></semantics></math> shared experts and <math id="S4.T2.14.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.T2.14.m4.1b"><mi id="S4.T2.14.m4.1.1" xref="S4.T2.14.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.14.m4.1c"><ci id="S4.T2.14.m4.1.1.cmml" xref="S4.T2.14.m4.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.m4.1d">b</annotation></semantics></math> routed experts.
In the line of β€# Activated Expertsβ€, <math id="S4.T2.15.m5.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.T2.15.m5.1b"><mi id="S4.T2.15.m5.1.1" xref="S4.T2.15.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.15.m5.1c"><ci id="S4.T2.15.m5.1.1.cmml" xref="S4.T2.15.m5.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.m5.1d">a</annotation></semantics></math> + <math id="S4.T2.16.m6.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.T2.16.m6.1b"><mi id="S4.T2.16.m6.1.1" xref="S4.T2.16.m6.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.16.m6.1c"><ci id="S4.T2.16.m6.1.1.cmml" xref="S4.T2.16.m6.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.m6.1d">b</annotation></semantics></math> denotes <math id="S4.T2.17.m7.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.T2.17.m7.1b"><mi id="S4.T2.17.m7.1.1" xref="S4.T2.17.m7.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T2.17.m7.1c"><ci id="S4.T2.17.m7.1.1.cmml" xref="S4.T2.17.m7.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.m7.1d">a</annotation></semantics></math> activated shared experts and <math id="S4.T2.18.m8.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.T2.18.m8.1b"><mi id="S4.T2.18.m8.1.1" xref="S4.T2.18.m8.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.T2.18.m8.1c"><ci id="S4.T2.18.m8.1.1.cmml" xref="S4.T2.18.m8.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.m8.1d">b</annotation></semantics></math> activated routed experts.
DeepSeekMoE achieves comparable performance with a GShard model containing 1.5 times expert parameters and computation.
In addition, DeepSeekMoE nearly approaches the performance of a dense model with 16 times FFN parameters, which sets the upper bound for MoE models in terms of the model capacity.
</figcaption>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>DeepSeekMoE Aligns Closely with the upper bound of MoE Models</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS3.p1.1">μ°λ¦¬λ” DeepSeekMoEκ°€ μ΅°λ°€ν• κΈ°μ¤€μ„  λ° λ‹¤λ¥Έ MoE μ•„ν‚¤ν…μ²λ³΄λ‹¤ μ°μν•λ‹¤λ” κ²ƒμ„ μ…μ¦ν–λ‹¤. DeepSeekMoEμ μ„±λ¥μ„ λ³΄λ‹¤ μ •ν™•ν•κ² μ΄ν•΄ν•κΈ° μ„ν•΄ λ” λ§μ€ μ΄ λ§¤κ°λ³€μ λλ” ν™μ„±ν™”λ λ§¤κ°λ³€μμ™€ λ” ν° κΈ°μ¤€μ„ κ³Ό λΉ„κµν•λ‹¤. λΉ„κµλ¥Ό ν†µν•΄ DeepSeekMoEμ™€ λ™λ“±ν• μ„±λ¥μ„ μ–»κΈ° μ„ν•΄ GShard λλ” μ΅°λ°€ν• κΈ°μ¤€μ„ μ ν•„μ”ν• λ¨λΈ ν¬κΈ°λ¥Ό μ¶”μ •ν•  μ μλ‹¤.</p>
</div>
<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Comparison with GShard<math id="S4.SS3.SSS0.Px1.1.m1.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="S4.SS3.SSS0.Px1.1.m1.1b"><mrow id="S4.SS3.SSS0.Px1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px1.1.m1.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.1.m1.1c"><apply id="S4.SS3.SSS0.Px1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1.2">absent</csymbol><cn type="float" id="S4.SS3.SSS0.Px1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.1.m1.1d">\times 1.5</annotation></semantics></math>.</h5>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.3">ν‘ <a class="ltx_ref" href="#S4.T2" title="Table 2 β€£ Results. β€£ 4.2 Evaluations β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>λ” DeepSeekMoEμ™€ μ „λ¬Έκ°€ ν¬κΈ°μ 1.5λ°°μΈ λ” ν° GShard λ¨λΈμ λΉ„κµλ¥Ό λ³΄μ—¬μ£Όλ©°, μ΄λ” μ „λ¬Έκ°€ νλΌλ―Έν„°μ™€ μ „λ¬Έκ°€ κ³„μ‚° λ¨λ‘ 1.5λ°°μ κ²°κ³Όλ¥Ό μ΄λν•λ‹¤. μ „λ°μ μΌλ΅, DeepSeekMoEλ” GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">\times 1.5</annotation></semantics></math>μ™€ λΉ„κµ κ°€λ¥ν• μ„±λ¥μ„ λ‹¬μ„±ν•λ©°, DeepSeekMoE μ•„ν‚¤ν…μ²μ— λ‚΄μ¬λ μƒλ‹Ήν• μ΄μ μ„ κ°•μ΅°ν•λ‹¤. λν•, GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1"><times id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m2.1c">\times 1.5</annotation></semantics></math>μ™€μ λΉ„κµ μ™Έμ—, Appendix<a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>μ—μ„μ GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS3.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1"><times id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.3.m3.1c">\times 1.2</annotation></semantics></math>μ™€μ λΉ„κµλ„ λ‚νƒ€λ‚Έλ‹¤.</p>
</div>
<div id="S4.SS3.SSS0.Px1.p2" class="ltx_para">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p2.3">λν•, DeepSeekMoEμ μ΄ νλΌλ―Έν„° μλ¥Ό 13.3Bλ΅ μ¦κ°€μ‹ν‚¤κ³ , GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p2.1.m1.1a"><mrow id="S4.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1"><times id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.1.m1.1c">\times 1.2</annotation></semantics></math> λ° GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS3.SSS0.Px1.p2.2.m2.1a"><mrow id="S4.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1"><times id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.2.m2.1c">\times 1.5</annotation></semantics></math>μ™€ κ°κ° 15.9B λ° 19.8Bμ μ΄ νλΌλ―Έν„° μλ¥Ό λΉ„κµν•λ‹¤. μ°λ¦¬λ” λ” ν° κ·λ¨μ—μ„ DeepSeekMoEκ°€ GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS3.SSS0.Px1.p2.3.m3.1a"><mrow id="S4.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.3.m3.1b"><apply id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1"><times id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml" type="float" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.3.m3.1c">\times 1.5</annotation></semantics></math>λ¥Ό λλ ·ν•κ² λ¥κ°€ν•  μ μμμ„ λ°κ²¬ν–λ‹¤. μ΄λ¬ν• κ²°κ³Όλ” λ¶€λ΅ <a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>μ—μ„λ„ μ κ³µλλ‹¤.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Comparison with Dense<math id="S4.SS3.SSS0.Px2.1.m1.1" class="ltx_Math" alttext="\times 16" display="inline"><semantics id="S4.SS3.SSS0.Px2.1.m1.1b"><mrow id="S4.SS3.SSS0.Px2.1.m1.1.1" xref="S4.SS3.SSS0.Px2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px2.1.m1.1.1.1" xref="S4.SS3.SSS0.Px2.1.m1.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px2.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.1.m1.1c"><apply id="S4.SS3.SSS0.Px2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1"><times id="S4.SS3.SSS0.Px2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S4.SS3.SSS0.Px2.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.1.m1.1d">\times 16</annotation></semantics></math>.</h5>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.2">ν‘ <a class="ltx_ref" href="#S4.T2" title="Table 2 β€£ Results. β€£ 4.2 Evaluations β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>λ” DeepSeekMoEμ™€ λ” ν° λ°€μ§‘ λ¨λΈμ λΉ„κµλ„ λ³΄μ—¬μ¤€λ‹¤. κ³µμ •ν• λΉ„κµλ¥Ό μ„ν•΄ μ£Όμλ ¥κ³Ό FFN λ§¤κ°λ³€μ κ°„μ λ„λ¦¬ μ‚¬μ©λλ” λΉ„μ¨(1:2)μ„ μ‚¬μ©ν•μ§€ μ•λ”λ‹¤. λ€μ‹ , κ° μ „λ¬Έκ°€κ°€ ν‘μ¤€ FFNκ³Ό λ™μΌν• μμ νλΌλ―Έν„°λ¥Ό κ°–λ” 16κ°μ κ³µμ  μ „λ¬Έκ°€λ¥Ό κµ¬μ„±ν•λ‹¤. μ΄ μ•„ν‚¤ν…μ²λ” 16λ°° ν‘μ¤€ FFN λ§¤κ°λ³€μλ¥Ό κ°€μ§„ λ°€μ§‘ λ¨λΈμ„ λ¨λ°©ν•λ‹¤. ν‘λ΅λ¶€ν„° DeepSeekMoEλ” λ¨λΈ μ©λ‰ μΈ΅λ©΄μ—μ„ MoE λ¨λΈμ μ—„κ²©ν• μƒν•μ„ μ„¤μ •ν•λ” Dense<math alttext="\times 16" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1"><times id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">\times 16</annotation></semantics></math>μ μ„±λ¥μ— κ±°μ κ·Όμ ‘ν•¨μ„ μ• μ μλ‹¤. μ΄λ¬ν• κ²°κ³Όλ” <span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS3.SSS0.Px2.p1.2.1"> μ μ–΄λ„ μ•½ 2B λ§¤κ° λ³€μ λ° 100B ν›λ ¨ ν† ν°μ κ·λ¨μ—μ„ DeepSeekMoEμ μ„±λ¥μ΄ MoE λ¨λΈμ μ΄λ΅ μ  μƒν•</span>κ³Ό λ°€μ ‘ν•κ² μΌμΉν•¨μ„ μ‹μ‚¬ν•λ‹¤. λν•, λ¶€λ΅ <a class="ltx_ref" href="#A2" title="Appendix B Comparing DeepSeekMoE with Larger Models β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>μ—μ„ Dense<math alttext="\times 4" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS3.SSS0.Px2.p1.2.m2.1a"><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml">Γ—</mo><mn id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1"><times id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m2.1c">\times 4</annotation></semantics></math>μ™€ μ¶”κ°€μ μΈ λΉ„κµλ¥Ό μ κ³µν•λ‹¤.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="211" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">κ·Έλ¦Ό 3:</span></figcaption>
Ablation studies for DeepSeekMoE.
The performance is normalized by the best performance for clarity in presentation.
All compared models have the same number of parameters and activated parameters.
We can find that fine-grained expert segmentation and shared expert isolation both contribute to stronger overall performance.
</figcaption>
</figure>
</section>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation Studies</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS4.p1.1">μ„Έλ¶„ν™”λ μ „λ¬Έκ°€ λ¶„ν•  λ° κ³µμ  μ „λ¬Έκ°€ λ¶„λ¦¬ μ „λµμ ν¨κ³Όλ¥Ό μ…μ¦ν•κΈ° μ„ν•΄ DeepSeekMoEμ— λ€ν• μ μ  μ—°κµ¬λ¥Ό μν–‰ν•κ³  κ·Έ κ²°κ³Όλ¥Ό κ·Έλ¦Ό <a class="ltx_ref" href="#S4.F3" title="Figure 3 β€£ Comparison with DenseΓ—16. β€£ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>μ— μ μ‹ν•λ‹¤. κ³µμ •ν• λΉ„κµλ¥Ό μ„ν•΄ λΉ„κµμ— ν¬ν•¨λ λ¨λ“  λ¨λΈμ΄ λ™μΌν• μμ μ΄ λ§¤κ°λ³€μμ™€ ν™μ„±ν™”λ λ§¤κ°λ³€μλ¥Ό κ°–λ„λ΅ ν•λ‹¤.</p>
</div>
<section id="S4.SS4.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Shared Expert Isolation.</h5>

<div id="S4.SS4.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS4.SSS0.Px1.p1.1">κ³µμ  μ „λ¬Έκ°€ λ¶„λ¦¬ μ „λµμ μν–¥μ„ ν‰κ°€ν•κΈ° μ„ν•΄ GShardλ¥Ό κΈ°λ°μΌλ΅ ν• μ „λ¬Έκ°€λ¥Ό κ³µμ  μ „λ¬Έκ°€λ΅ λ¶„λ¦¬ν•λ‹¤. κ·Έλ¦Ό <a class="ltx_ref" href="#S4.F3" title="Figure 3 β€£ Comparison with DenseΓ—16. β€£ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>μ—μ„ μ°λ¦¬λ” GShardμ™€ λΉ„κµν•μ—¬ κ³µμ  μ „λ¬Έκ°€μ μλ„μ  κ²©λ¦¬κ°€ λ€λ¶€λ¶„μ λ²¤μΉλ§ν¬μ—μ„ ν–¥μƒλ μ„±λ¥μ„ μ‚°μ¶ν•λ‹¤λ” κ²ƒμ„ κ΄€μ°°ν•λ‹¤. μ΄λ¬ν• κ²°κ³Όλ” κ³µμ  μ „λ¬Έκ°€ κ²©λ¦¬ μ „λµμ΄ λ” κ°•λ ¥ν• λ¨λΈ μ„±λ¥μ— κΈ°μ—¬ν•λ‹¤λ” λ…μ λ¥Ό λ’·λ°›μΉ¨ν•λ‹¤.</p>
</div>
</section>
<section id="S4.SS4.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Fine-Grained Expert Segmentation.</h5>

<div id="S4.SS4.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS4.SSS0.Px2.p1.1">μ„Έλ¦½ν™”λ μ „λ¬Έκ°€ μ„Έλ¶„ν™” μ „λµμ ν¨κ³Όλ¥Ό ν‰κ°€ν•κΈ° μ„ν•΄ μ „λ¬Έκ°€λ¥Ό λ” μ„Έλ¦½ν™”λ κ·Έλ μΈμΌλ΅ μ„Έλ¶„ν™”ν•μ—¬ λ³΄λ‹¤ μƒμ„Έν• λΉ„κµλ¥Ό μν–‰ν•λ‹¤. κµ¬μ²΄μ μΌλ΅, μ°λ¦¬λ” κ° μ „λ¬Έκ°€λ¥Ό 2λ… λλ” 4λ…μ μ‘μ€ μ „λ¬Έκ°€λ΅ μ„Έλ¶„ν™”ν•μ—¬ μ΄ 32λ…(1κ°μ κ³µμ  + 31κ°μ λΌμ°ν…) λλ” 64λ…(1κ°μ κ³µμ  + 63κ°μ λΌμ°ν…)μ μ „λ¬Έκ°€λ¥Ό μƒμ„±ν•λ‹¤. κ·Έλ¦Ό <a class="ltx_ref" href="#S4.F3" title="Figure 3 β€£ Comparison with DenseΓ—16. β€£ 4.3 DeepSeekMoE Aligns Closely with the upper bound of MoE Models β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>λ” μ „λ¬Έκ°€ μ„Έλ¶„ν™” μ„Έλ¶„ν™”μ μ—°μ†μ  κ°μ„ μ΄ μ „μ²΄ λ¨λΈ μ„±λ¥μ μ—°μ†μ  ν–¥μƒμ— ν•΄λ‹Ήν•λ‹¤λ” μΌκ΄€λ κ²½ν–¥μ„ λ³΄μ—¬μ¤€λ‹¤. μ΄λ¬ν• κ²°κ³Όλ” μ„Έλ¶„ν™”λ μ „λ¬Έκ°€ μ„Έλ¶„ν™” μ „λµμ ν¨κ³Όμ„±μ— λ€ν• μ‹¤μ¦μ  κ²€μ¦μ„ μ κ³µν•λ‹¤.</p>
</div>
</section>
<section id="S4.SS4.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Ratios Between Shared and Routed Experts.</h5>

<div id="S4.SS4.SSS0.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS4.SSS0.Px3.p1.1">λν•, κ³µμ  μ „λ¬Έκ°€μ™€ λΌμ°ν…λ μ „λ¬Έκ°€μ μµμ  λΉ„μ¨μ„ μ΅°μ‚¬ν•λ‹¤. μ΄ 64λ…μ μ „λ¬Έκ°€μ™€ ν™μ„±ν™”λ μ „λ¬Έκ°€μ μλ¥Ό μΌμ •ν•κ² μ μ§€ν•λ©΄μ„ μµκ³ μ μ„Έλ¶„μ„±μ„ λ°”νƒ•μΌλ΅ 1, 2, 4λ…μ μ „λ¬Έκ°€λ¥Ό κ³µμ  μ „λ¬Έκ°€λ΅ λ¶„λ¦¬ν•κ³ μ ν•λ‹¤. μ—°κµ¬ κ²°κ³Ό, κ³µμ μ „λ¬Έκ°€μ™€ λΌμ°ν…λ μ „λ¬Έκ°€μ λΉ„μ¨μ΄ μ„λ΅ λ‹¤λ¥Έ κ²½μ° μ„±λ¥μ— ν° μν–¥μ„ λ―ΈμΉμ§€ μ•λ” κ²ƒμΌλ΅ λ‚νƒ€λ‚¬μΌλ©°, 1, 2, 4λ…μ κ³µμ μ „λ¬Έκ°€λ” κ°κ° 1.808, 1.806, 1.811μ νμΌμ†μ‹¤μ„ λ‹¬μ„±ν•μ€λ‹¤. 1:3μ λΉ„μ¨μ΄ μ•½κ°„ λ” λ‚μ€ νμΌ μ†μ‹¤μ„ μ‚°μ¶ν•λ‹¤λ” μ μ„ κ³ λ ¤ν•μ—¬ DeepSeekMoEλ¥Ό ν™•μ¥ν•  λ• κ³µμ  μ „λ¬Έκ°€μ™€ ν™μ„±ν™”λ λΌμ°ν… μ „λ¬Έκ°€ κ°„μ λΉ„μ¨μ„ 1:3μΌλ΅ μ μ§€ν•λ‹¤.</p>
</div>
</section>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Analysis on Expert Specialization</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS5.p1.1">λ³Έ μ μ—μ„λ” DeepSeekMoE 2Bμ μ „λ¬Έκ°€ μ „λ¬Έν™”μ— λ€ν• μ‹¤μ¦λ¶„μ„μ„ μ‹¤μ‹ν•λ‹¤. μ΄ μ„Ήμ…μ DeepSeekMoE 2Bλ” ν‘ <a class="ltx_ref" href="#S4.T1" title="Table 1 β€£ Closed-Book Question Answering. β€£ 4.1.4 Evaluation Benchmarks β€£ 4.1 Experimental Setup β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>μ— λ³΄κ³ λ λ¨λΈ, μ¦‰ 2.0B μ΄ λ§¤κ°λ³€μλ¥Ό ν¬ν•¨ν•λ©° κ³µμ  μ „λ¬Έκ°€ 1λ…κ³Ό λΌμ°ν…λ μ „λ¬Έκ°€ 63λ… μ¤‘ 7λ…μ΄ ν™μ„±ν™”λλ‹¤.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="276" height="197" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">κ·Έλ¦Ό 4:</span></figcaption>
Pile loss with regard to different ratios of disabled top routed experts.
Notably, DeepSeekMoE exhibits greater sensitivity to the ratio of disabled top routed experts, indicating lower redundancy among routed experts in DeepSeekMoE.
</figcaption>
</figure>
<section id="S4.SS5.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">DeepSeekMoE Exhibits Lower Redundancy Among Routed Experts.</h5>

<div id="S4.SS5.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p1.3">λΌμ°ν…λ μ „λ¬Έκ°€λ“¤ κ°„μ μ¤‘λ³µμ„±μ„ ν‰κ°€ν•κΈ° μ„ν•΄, μƒμ„ λΌμ°ν…λ μ „λ¬Έκ°€λ“¤μ λ‹¤μ–‘ν• λΉ„μ¨μ„ λΉ„ν™μ„±ν™”ν•κ³  νμΌ μ†μ‹¤μ„ ν‰κ°€ν•λ‹¤. κµ¬μ²΄μ μΌλ΅ κ° ν† ν°μ— λ€ν•΄ λΌμ°ν… ν™•λ¥ μ΄ κ°€μ¥ λ†’μ€ νΉμ • λΉ„μ¨μ μ „λ¬Έκ°€λ¥Ό λ§μ¤ν‚Ήν• ν›„ λ‚λ¨Έμ§€ λΌμ°ν…λ μ „λ¬Έκ°€ μ¤‘μ—μ„ μƒμ„ Kλ…μ μ „λ¬Έκ°€λ¥Ό μ„ νƒν•λ‹¤. κ³µμ •μ„±μ„ μ„ν•΄ μ „λ¬Έκ°€κ°€ λΉ„ν™μ„±ν™”λμ§€ μ•μ€ κ²½μ° λ™μΌν• νμΌ μ†μ‹¤μ„ κ°–κΈ° λ•λ¬Έμ— DeepSeekMoEμ™€ GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS5.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS5.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml">Γ—</mo><mn id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1"><times id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS5.SSS0.Px1.p1.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.1.m1.1c">\times 1.5</annotation></semantics></math>λ¥Ό λΉ„κµν•λ‹¤. <a class="ltx_ref" href="#S4.F4" title="Figure 4 β€£ 4.5 Analysis on Expert Specialization β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>μ— λ„μ‹λ λ°”μ™€ κ°™μ΄, GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS5.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS5.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1.cmml">Γ—</mo><mn id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1"><times id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS5.SSS0.Px1.p1.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.2.m2.1c">\times 1.5</annotation></semantics></math>μ™€ λΉ„κµν•μ—¬ DeepSeekMoEλ” μƒμ„ λΌμ°ν…λ μ „λ¬Έκ°€μ λ””μ¤μ—μ΄λΈ”μ— λ” λ―Όκ°ν•λ‹¤. μ΄ λ―Όκ°λ„λ” κ° λΌμ°ν…λ μ „λ¬Έκ°€κ°€ λ” λ€μ²΄ν•  μ μ—†κΈ° λ•λ¬Έμ— DeepSeekMoEμ—μ„ λ” λ‚®μ€ μμ¤€μ λ§¤κ°λ³€μ μ¤‘λ³µμ„±μ„ μ‹μ‚¬ν•λ‹¤. λ€μ΅°μ μΌλ΅, GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="S4.SS5.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS5.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS5.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml"></mi><mo id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1.cmml">Γ—</mo><mn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1"><times id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.1"></times><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.2">absent</csymbol><cn id="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="float" xref="S4.SS5.SSS0.Px1.p1.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p1.3.m3.1c">\times 1.5</annotation></semantics></math>λ” κ·Έ μ „λ¬Έκ°€ νλΌλ―Έν„°λ“¤ μ¤‘μ—μ„ λ” ν° μ¤‘λ³µμ„±μ„ λ‚νƒ€λ‚΄λ―€λ΅, μƒμ„ λΌμ°ν…λ μ „λ¬Έκ°€λ“¤μ΄ λ””μ¤μ—μ΄λΈ”λ  λ• μ„±λ¥ μ €ν•λ¥Ό λ²„νΌλ§ν•  μ μλ‹¤.</p>
</div>
</section>
<section id="S4.SS5.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Shared Experts Are Irreplaceable by Routed Experts.</h5>

<div id="S4.SS5.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS5.SSS0.Px2.p1.1">DeepSeekMoEμ—μ„ κ³µμ  μ „λ¬Έκ°€μ μ—­ν• μ„ μ΅°μ‚¬ν•κΈ° μ„ν•΄ μ΄λ¥Ό λΉ„ν™μ„±ν™”ν•κ³  λΌμ°ν…λ μ „λ¬Έκ°€ ν• λ…μ„ λ” ν™μ„±ν™”ν•λ‹¤. Pileμ— λ€ν• ν‰κ°€λ” λ™μΌν• κ³„μ‚° λΉ„μ©μ„ μ μ§€ν•¨μ—λ„ λ¶κµ¬ν•κ³  νμΌ μ†μ‹¤μ΄ 1.808μ—μ„ 2.414λ΅ ν¬κ² μ¦κ°€ν•λ” κ²ƒμΌλ΅ λ‚νƒ€λ‚¬λ‹¤. μ΄ κ²°κ³Όλ” κ³µμ  μ „λ¬Έκ°€μ μ¤‘μ”ν• κΈ°λ¥μ„ κ°•μ΅°ν•λ©° κ³µμ  μ „λ¬Έκ°€κ°€ λΌμ°ν…λ μ „λ¬Έκ°€μ™€ κ³µμ λμ§€ μ•μ€ κΈ°λ³Έμ μ΄κ³  ν•„μμ μΈ μ§€μ‹μ„ ν¬μ°©ν•μ—¬ λΌμ°ν…λ μ „λ¬Έκ°€λ΅ λ€μ²΄ν•  μ μ—†μμ„ λ‚νƒ€λ‚Έλ‹¤.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="276" height="197" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">κ·Έλ¦Ό 5:</span></figcaption>
Pile loss with regard to different numbers of activated routed experts in DeepSeekMoE.
With only 4 routed experts activated, DeepSeekMoE achieves a Pile loss comparable with GShard.
</figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="211" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">κ·Έλ¦Ό 6:</span></figcaption>
Comparison between GShard and DeepSeekMoE with half the activated experts (trained from scratch).
With the same total expert parameters and only half of the activated expert parameters, DeepSeekMoE still outperforms GShard.
</figcaption>
</figure>
</section>
<section id="S4.SS5.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">DeepSeekMoE Acquires Knowledge More Accurately.</h5>

<div id="S4.SS5.SSS0.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S4.SS5.SSS0.Px3.p1.1">ν™μ„±ν™”λ μ „λ¬Έκ°€ κ²°ν•©μ μ μ—°μ„±μ΄ λ†’μ„μλ΅ λ” μ •ν™•ν•κ³  ν‘μ ν™”λ μ§€μ‹ νλ“μ— κΈ°μ—¬ν•λ‹¤λ” μ£Όμ¥μ„ κ²€μ¦ν•κΈ° μ„ν•΄ DeepSeekMoEκ°€ λ” μ μ€ μμ ν™μ„±ν™”λ μ „λ¬Έκ°€λ΅ ν•„μ”ν• μ§€μ‹μ„ νλ“ν•  μ μλ”μ§€ μ—¬λ¶€λ¥Ό μ΅°μ‚¬ν•λ‹¤. κµ¬μ²΄μ μΌλ΅, μ°λ¦¬λ” ν™μ„±ν™”λ λΌμ°ν… μ „λ¬Έκ°€μ μλ¥Ό 3λ…μ—μ„ 7λ…μΌλ΅ λ³€κ²½ν•κ³  κ²°κ³Όμ μΈ νμΌ μ†μ‹¤μ„ ν‰κ°€ν•λ‹¤. <a class="ltx_ref" href="#S4.F5" title="Figure 5 β€£ Shared Experts Are Irreplaceable by Routed Experts. β€£ 4.5 Analysis on Expert Specialization β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>μ—μ„ μ¦λ…λ λ°”μ™€ κ°™μ΄, λ‹¨μ§€ 4λ…μ λΌμ°ν…λ μ „λ¬Έκ°€λ“¤λ§μ΄ ν™μ„±ν™”λ μƒνƒμ—μ„λ„, DeepSeekMoEλ” GShardμ— ν•„μ ν•λ” νμΌ μ†μ‹¤μ„ λ‹¬μ„±ν•λ‹¤. μ΄λ¬ν• κ΄€μ°°μ€ DeepSeekMoEκ°€ λ³΄λ‹¤ μ •ν™•ν•κ³  ν¨μ¨μ μΌλ΅ ν•„μ”ν• μ§€μ‹μ„ νλ“ν•  μ μλ‹¤λ” λ…μ λ¥Ό λ’·λ°›μΉ¨ν•λ‹¤.</p>
</div>
<div id="S4.SS5.SSS0.Px3.p2" class="ltx_para">
<p class="ltx_p" id="S4.SS5.SSS0.Px3.p2.1">μ΄λ¬ν• κ²°κ³Όλ¥Ό ν†µν•΄ DeepSeekMoEμ μ „λ¬Έκ°€ μ „λ¬Έν™”μ™€ μ •ν™•ν• μ§€μ‹ μµλ“μ„ λ³΄λ‹¤ μ—„κ²©ν•κ² κ²€μ¦ν•κΈ° μ„ν•΄ μƒλ΅μ΄ λ¨λΈμ„ μ²μλ¶€ν„° ν›λ ¨ν•λ‹¤. μ΄ λ¨λΈμ€ κ³µμ  μ „λ¬Έκ°€ 1λ…κ³Ό λΌμ°ν… μ „λ¬Έκ°€ 63λ…μΌλ΅ κµ¬μ„±λλ©°, λΌμ°ν… μ „λ¬Έκ°€ 3λ…λ§ ν™μ„±ν™”λλ‹¤. <a class="ltx_ref" href="#S4.F6" title="Figure 6 β€£ Shared Experts Are Irreplaceable by Routed Experts. β€£ 4.5 Analysis on Expert Specialization β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>μ— λ‚νƒ€λ‚Έ ν‰κ°€ κ²°κ³Όλ”, λ™μΌν• μ΄ μ „λ¬Έκ°€ νλΌλ―Έν„°μ™€ ν™μ„±ν™”λ μ „λ¬Έκ°€ νλΌλ―Έν„°μ μ λ°λ§μ„ κ°€μ§€κ³ λ„ DeepSeekMoEκ°€ μ—¬μ „ν GShardλ³΄λ‹¤ μ°μν•λ‹¤λ” κ²ƒμ„ μ…μ¦ν•λ‹¤. μ΄λ” DeepSeekMoEκ°€ μ „λ¬Έκ°€ λ§¤κ°λ³€μλ¥Ό λ³΄λ‹¤ ν¨μ¨μ μΌλ΅ ν™μ©ν•λ” λ¥λ ¥, μ¦‰ ν™μ„±ν™”λ μ „λ¬Έκ°€μ—μ„ ν¨κ³Όμ μΈ λ§¤κ°λ³€μμ λΉ„μ¨μ΄ GShardλ³΄λ‹¤ ν›¨μ”¬ λ†’λ‹¤λ” κ²ƒμ„ κ°•μ΅°ν•λ‹¤.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Scaling up to DeepSeekMoE 16B</h2>

<div id="S5.p1" class="ltx_para">
<p class="ltx_p" id="S5.p1.1">DeepSeekMoE μ•„ν‚¤ν…μ²λ¥Ό μ‚¬μ©ν•μ—¬ MoE λ¨λΈμ„ 16B μ΄ λ§¤κ°λ³€μλ΅ λ” ν° κ·λ¨λ΅ ν™•μ¥ν•κ³  2T ν† ν°μ—μ„ ν›λ ¨ν•©λ‹λ‹¤. μ‹¤ν— κ²°κ³Ό, DeepSeekMoE 16Bλ” LLaMA2 7Bμ™€ λΉ„κµν•μ—¬ μ•½ 40%μ κ³„μ‚°λ‰μΌλ΅ μ°μν• μ„±λ¥μ„ λ³΄μ€λ‹¤.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Training Data and Tokenization</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">μ°λ¦¬λ” SectionΒ <a class="ltx_ref" href="#S4.SS1.SSS1" title="4.1.1 Training Data and Tokenization β€£ 4.1 Experimental Setup β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4.1.1</span></a>μ—μ„ μ„¤λ…ν• κ²ƒκ³Ό λ™μΌν• λ§λ­‰μΉλ΅λ¶€ν„° ν•™μµ λ°μ΄ν„°λ¥Ό μƒν”λ§ν•λ‹¤. κ²€μ¦ μ‹¤ν—κ³Ό λ‹¬λ¦¬ LLaMA2 7Bμ ν›λ ¨ ν† ν° μμ™€ μ •λ ¬ν•μ—¬ 2T ν† ν°μΌλ΅ λ” λ§μ€ μ–‘μ λ°μ΄ν„°λ¥Ό μƒν”λ§ν•λ‹¤. λν• HuggingFace ν† ν°λ‚μ΄μ € λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ BPE ν† ν°λ‚μ΄μ €λ¥Ό ν›λ ¨μ‹ν‚¤μ§€λ§, DeepSeekMoE 16Bμ κ²½μ° μ–΄ν ν¬κΈ°κ°€ 100Kλ΅ μ„¤μ •λλ‹¤.</p>
</div>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Hyper-Parameters</h4>

<section id="S5.SS1.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Model Settings.</h5>

<div id="S5.SS1.SSS2.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS2.Px1.p1.1">DeepSeekMoE 16Bμ κ²½μ° νΈλμ¤ν¬λ¨Έ μΈµμ μλ¥Ό 28κ°λ΅, μ€λ‹‰ μ°¨μ›μ„ 2048κ°λ΅ μ„¤μ •ν•μ€λ‹¤. μ΄ 16κ°μ μ–΄ν…μ… ν—¤λ“κ°€ μλ” λ‹¤μ¤‘ ν—¤λ“ μ–΄ν…μ… λ©”μ»¤λ‹μ¦μ„ μ‚¬μ©ν•μ€μΌλ©°, κ° ν—¤λ“μ μ°¨μ›μ€ 128μ΄λ‹¤. μ΄κΈ°ν™”λ” ν•™μµ κ°€λ¥ν• λ¨λ“  νλΌλ―Έν„°κ°€ 0.006μ ν‘μ¤€ νΈμ°¨λ΅ λλ¤ν•κ² μ΄κΈ°ν™”λλ‹¤. μ²« λ²μ§Έ λ μ΄μ–΄μ—μ„ λ¶€ν• κ· ν• μƒνƒκ°€ νΉν λ” λλ¦¬κ² μλ ΄ν•λ” κ²ƒμ„ κ΄€μ°°ν•κΈ° λ•λ¬Έμ— μ²« λ²μ§Έ λ μ΄μ–΄λ¥Ό μ μ™Έν• λ¨λ“  FFNμ„ MoE λ μ΄μ–΄λ΅ λ€μ²΄ν•λ‹¤. κ° MoE κ³„μΈµμ€ κ³µμ  μ „λ¬Έκ°€ 2λ…κ³Ό λΌμ°ν… μ „λ¬Έκ°€ 64λ…μΌλ΅ κµ¬μ„±λλ©°, κ° μ „λ¬Έκ°€λ” ν‘μ¤€ FFNμ 0.25λ°° ν¬κΈ°μ΄λ‹¤. κ° ν† ν°μ€ μ΄ λ‘ λ…μ κ³µμ  μ „λ¬Έκ°€μ™€ 64λ…μ λΌμ°ν…λ μ „λ¬Έκ°€ μ¤‘ 6λ…μ—κ² λΌμ°ν…λ©λ‹λ‹¤. λ„λ¬΄ μ‘μ€ μ „λ¬Έκ°€ ν¬κΈ°μ™€ κ΄€λ ¨λ κ³„μ‚° ν¨μ¨μ μ μ¬μ μΈ κ°μ†λ΅ μΈν•΄ λ” λ―Έμ„Έν• μ „λ¬Έκ°€ μ„Έλ¶„ν™” μ„Έλ¶„ν™”λ” μ‚¬μ©λμ§€ μ•λ”λ‹¤. 16Bμ— κ±Έμ³ λ” ν° μ¤μΌ€μΌμ—μ„, λ” λ―Έμ„Έν• μ…λ„κ°€ μ—¬μ „ν μ±„μ©λ  μ μλ‹¤. μ°λ¦¬μ κµ¬μ„±μ—μ„ DeepSeekMoE 16Bλ” μ•½ 16.4Bμ μ΄ λ§¤κ°λ³€μλ¥Ό κ°€μ§€κ³  μμΌλ©° ν™μ„±ν™”λ λ§¤κ°λ³€μμ μλ” μ•½ 2.8Bμ΄λ‹¤.</p>
</div>
</section>
<section id="S5.SS1.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Settings.</h5>

<div id="S5.SS1.SSS2.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS2.Px2.p1.4">Hyper-parametersκ°€ <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.1.m1.1"><semantics id="S5.SS1.SSS2.Px2.p1.1.m1.1a"><mrow id="S5.SS1.SSS2.Px2.p1.1.m1.1.1" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.cmml"><msub id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.cmml"><mi id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2.cmml">Ξ²</mi><mn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.1.m1.1b"><apply id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1"><eq id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.1"></eq><apply id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.1.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2.cmml" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.2">π›½</ci><cn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.1.m1.1c">\beta_{1}=0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.95" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.2.m2.1"><semantics id="S5.SS1.SSS2.Px2.p1.2.m2.1a"><mrow id="S5.SS1.SSS2.Px2.p1.2.m2.1.1" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.cmml"><msub id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.cmml"><mi id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2.cmml">Ξ²</mi><mn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.2.m2.1b"><apply id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1"><eq id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.1"></eq><apply id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.1.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2.cmml" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.2">π›½</ci><cn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.2.m2.1c">\beta_{2}=0.95</annotation></semantics></math>, <math alttext="\mathrm{weight\_decay}=0.1" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.3.m3.1"><semantics id="S5.SS1.SSS2.Px2.p1.3.m3.1a"><mrow id="S5.SS1.SSS2.Px2.p1.3.m3.1.1" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.cmml"><mrow id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.cmml"><mi id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2.cmml">weight</mi><mo id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1" lspace="0em" rspace="0em" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1.cmml">β€‹</mo><mi id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1a" lspace="0em" rspace="0em" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1.cmml">β€‹</mo><mi id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4.cmml">decay</mi></mrow><mo id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.3.m3.1b"><apply id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1"><eq id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.1"></eq><apply id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2"><times id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.1"></times><ci id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.2">weight</ci><ci id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.3">_</ci><ci id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4.cmml" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.2.4">decay</ci></apply><cn id="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.3.m3.1c">\mathrm{weight\_decay}=0.1</annotation></semantics></math>λ΅ μ„¤μ •λ AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite>λ¥Ό μ±„μ©ν•λ‹¤. ν•™μµλ¥  λν• μ¤€λΉ„-λ‹¨κ³„-λ¶•κ΄΄ μ „λµμ„ μ‚¬μ©ν•μ—¬ μ¤μΌ€μ¤„λ§λλ‹¤. μ²μμ—, ν•™μµλ¥ μ€ μ²μ 2K λ‹¨κ³„ λ™μ• 0μ—μ„ μµλ€κ°’κΉμ§€ μ„ ν•μ μΌλ΅ μ¦κ°€ν•λ‹¤. μ΄μ–΄μ„, ν•™μµ μ†λ„λ” ν›λ ¨ λ‹¨κ³„μ 80%μ—μ„ 0.316μ„ κ³±ν•κ³ , λ‹¤μ‹ ν›λ ¨ λ‹¨κ³„μ 90%μ—μ„ 0.316μ„ κ³±ν•λ‹¤. DeepSeekMoE 16Bμ— λ€ν• μµλ€ ν•™μµ μ†λ„λ” <math alttext="4.2\times 10^{-4}" class="ltx_Math" display="inline" id="S5.SS1.SSS2.Px2.p1.4.m4.1"><semantics id="S5.SS1.SSS2.Px2.p1.4.m4.1a"><mrow id="S5.SS1.SSS2.Px2.p1.4.m4.1.1" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.cmml"><mn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2.cmml">4.2</mn><mo id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1.cmml">Γ—</mo><msup id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.cmml"><mn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.cmml"><mo id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3a" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.cmml">β’</mo><mn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.Px2.p1.4.m4.1b"><apply id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1"><times id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.1"></times><cn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2.cmml" type="float" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.2">4.2</cn><apply id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3">superscript</csymbol><cn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.2">10</cn><apply id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3"><minus id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.1.cmml" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3"></minus><cn id="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.SSS2.Px2.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.Px2.p1.4.m4.1c">4.2\times 10^{-4}</annotation></semantics></math>λ΅ μ„¤μ •λκ³ , κ·Έλλ””μ–ΈνΈ ν΄λ¦¬ν•‘ κ·λ²”μ€ 1.0μΌλ΅ μ„¤μ •λλ‹¤. λ°°μΉ ν¬κΈ°λ” 4.5Kλ΅ μ„¤μ •λκ³ , μµλ€ μ‹ν€€μ¤ κΈΈμ΄κ°€ 4KμΈ κ²½μ°, κ°κ°μ νΈλ μ΄λ‹ λ°°μΉμ—λ” 18M ν† ν°μ΄ ν¬ν•¨λλ‹¤. μƒμ‘ν•κ², νΈλ μ΄λ‹ λ‹¨κ³„λ“¤μ μ΄ μλ” 2T νΈλ μ΄λ‹ ν† ν°λ“¤μ„ λ‹¬μ„±ν•κΈ° μ„ν•΄ 106,449λ΅ μ„¤μ •λλ‹¤. ν›λ ¨ λ°μ΄ν„°κ°€ ν’λ¶€ν•κΈ° λ•λ¬Έμ— ν›λ ¨ μ¤‘ μ¤‘λ„ νƒλ½μ€ μ‚¬μ©ν•μ§€ μ•μµλ‹λ‹¤. νμ΄ν”„λΌμΈ λ³‘λ ¬μ„±μ„ ν™μ©ν•μ—¬ λ¨λΈμ λ‹¤λ¥Έ κ³„μΈµμ„ λ‹¤λ¥Έ μ¥μΉμ— λ°°μΉν•©λ‹λ‹¤. κ° κ³„μΈµμ— λ€ν•΄ λ¨λ“  μ „λ¬Έκ°€κ°€ λ™μΌν• μ¥μΉμ— λ°°μΉλ©λ‹λ‹¤. λ”°λΌμ„ μ°λ¦¬λ” λν• ν›λ ¨ μ¤‘μ— ν† ν°μ„ λ–¨μ–΄λ¨λ¦¬μ§€ μ•μΌλ©° μ¥μΉ μμ¤€ μ”μ•΅ μ†μ‹¤μ„ μ‚¬μ©ν•μ§€ μ•μµλ‹λ‹¤. λΌμ°ν… λ¶•κ΄΄λ¥Ό λ°©μ§€ν•κΈ° μ„ν•΄ 0.001μ μƒλ‹Ήν μ‘μ€ μ „λ¬Έκ°€ μμ¤€μ κ· ν• κ³„μλ¥Ό μ„¤μ •ν–λ”λ°, μ΄λ” λ³‘λ ¬ν™” μ „λµ ν•μ—μ„ μ „λ¬Έκ°€ μμ¤€μ κ· ν• κ³„μκ°€ λ†’μ„μλ΅ κ³„μ‚° ν¨μ¨μ΄ μ¦κ°€ν•  μ μ—†μ§€λ§ λ¨λΈ μ„±λ¥μ΄ μ†μƒλλ‹¤λ” κ²ƒμ„ λ°κ²¬ν–κΈ° λ•λ¬Έμ΄λ‹¤.</p>
</div>
</section>
</section>
<section id="S5.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>Evaluation Benchmarks</h4>

<div id="S5.SS1.SSS3.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1">κ²€μ¦ μ‹¤ν—μ— μ‚¬μ©λ λ²¤μΉλ§ν¬ μ™Έμ—λ„ λ³΄λ‹¤ ν¬κ΄„μ μΈ ν‰κ°€λ¥Ό μ„ν•΄ μ¶”κ°€ λ²¤μΉλ§ν¬λ¥Ό ν†µν•©ν•λ‹¤. κ²€μ¦ μ‹¤ν—μ— μ‚¬μ©λ λ²¤μΉλ§ν¬μ™€μ μ°¨μ΄μ μ„ λ‹¤μκ³Ό κ°™μ΄ μ†κ°ν•λ‹¤.</p>
</div>
<section id="S5.SS1.SSS3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Language Modeling.</h5>

<div id="S5.SS1.SSS3.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px1.p1.1">μ–Έμ–΄ λ¨λΈλ§μ„ μ„ν•΄ Pile<cite class="ltx_cite ltx_citemacro_citep">(Gao etΒ al., <a class="ltx_ref" href="#bib.bib17" title="">2020</a>)</cite>μ ν…μ¤νΈ μ„ΈνΈμ— λ€ν• λ¨λΈλ„ ν‰κ°€ν•λ‹¤. DeepSeekMoE 16Bμ—μ„ μ‚¬μ©λλ” ν† ν°ν™”κΈ°λ” LLaMA2 7Bμ—μ„ μ‚¬μ©λλ” ν† ν°ν™”κΈ°μ™€ λ‹¤λ¥΄κΈ° λ•λ¬Έμ΄λ‹¤. κ³µμ •ν• λΉ„κµλ¥Ό μ„ν•΄ μ°λ¦¬λ” ν‰κ°€ λ©”νΈλ¦­μΌλ΅ λ°”μ΄νΈλ‹Ή λΉ„νΈ(BPB)λ¥Ό μ‚¬μ©ν•λ‹¤.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reading Comprehension.</h5>

<div id="S5.SS1.SSS3.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px2.p1.1">λ…ν•΄λ ¥μ„ μ„ν•΄ DROP <cite class="ltx_cite ltx_citemacro_citep">(Dua etΒ al., <a class="ltx_ref" href="#bib.bib15" title="">2019</a>)</cite>λ¥Ό μ¶”κ°€μ μΌλ΅ κ³ λ ¤ν•λ‹¤. ν‰κ°€ λ©”νΈλ¦­μ€ μ •ν™• μΌμΉμ¨μ…λ‹λ‹¤.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Math Reasoning.</h5>

<div id="S5.SS1.SSS3.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px3.p1.1">μν•™ μ¶”λ΅ μ„ μ„ν•΄ EMμ„ ν‰κ°€ λ©”νΈλ¦­μΌλ΅ μ‚¬μ©ν•μ—¬ GSM8K <cite class="ltx_cite ltx_citemacro_citep">(Cobbe etΒ al., <a class="ltx_ref" href="#bib.bib10" title="">2021</a>)</cite>μ™€ MATH <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks etΒ al., <a class="ltx_ref" href="#bib.bib21" title="">2021</a>)</cite>λ¥Ό μ¶”κ°€λ΅ ν†µν•©ν•λ‹¤.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Multi-Subject Multiple-Choice.</h5>

<div id="S5.SS1.SSS3.Px4.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px4.p1.1">λ‹¤μ£Όμ  κ°κ΄€μ‹μ κ²½μ° MMLU <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks etΒ al., <a class="ltx_ref" href="#bib.bib20" title="">2020</a>)</cite>μ— λ€ν• λ¨λΈμ„ μ¶”κ°€λ΅ ν‰κ°€ν•λ‹¤. ν‰κ°€ λ©”νΈλ¦­μ€ μ •ν™•μ„±μ…λ‹λ‹¤.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Disambiguation.</h5>

<div id="S5.SS1.SSS3.Px5.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px5.p1.1">μ¤‘λ³µμ„± ν•΄μ†λ¥Ό μ„ν•΄ WinoGrande<cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi etΒ al., <a class="ltx_ref" href="#bib.bib43" title="">2019</a>)</cite>λ¥Ό μ¶”κ°€μ μΌλ΅ κ³ λ ¤ν•λ©°, ν‰κ°€ λ©”νΈλ¦­μ€ μ •ν™•λ„μ΄λ‹¤.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px6" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Chinese Benchmarks.</h5>

<div id="S5.SS1.SSS3.Px6.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px6.p1.1">DeepSeekMoE 16Bλ” μ΄μ¤‘ μ–Έμ–΄ μ½”νΌμ¤μ—μ„ μ‚¬μ „ ν›λ ¨λκΈ° λ•λ¬Έμ—, μ°λ¦¬λ” λν• 4κ°μ μ¤‘κµ­ λ²¤μΉλ§ν¬μ—μ„ κ·Έκ²ƒμ„ ν‰κ°€ν•λ‹¤. CLUEWSC<cite class="ltx_cite ltx_citemacro_citep">(Xu etΒ al., <a class="ltx_ref" href="#bib.bib57" title="">2020</a>)</cite>λ” μ¤‘κµ­μ–΄ μ¤‘μμ„± ν•΄μ† λ²¤μΉλ§ν¬μ΄λ‹¤. CEvalΒ <cite class="ltx_cite ltx_citemacro_citep">(Huang etΒ al., <a class="ltx_ref" href="#bib.bib25" title="">2023</a>)</cite>μ™€ CMMLUΒ <cite class="ltx_cite ltx_citemacro_citep">(Li etΒ al., <a class="ltx_ref" href="#bib.bib33" title="">2023</a>)</cite>λ” MMLUμ™€ λΉ„μ·ν• ν•νƒλ¥Ό κ°€μ§„ λ‘ κ°μ μ¤‘κµ­μ–΄ κ°κ΄€μ‹ λ²¤μΉλ§ν¬μ΄λ‹¤. CHID <cite class="ltx_cite ltx_citemacro_citep">(Zheng etΒ al., <a class="ltx_ref" href="#bib.bib61" title="">2019</a>)</cite>λ” μ¤‘κµ­λ¬Έν™”μ— λ€ν• μ΄ν•΄λ¥Ό ν‰κ°€ν•κΈ° μ„ν• μ¤‘κµ­μ–΄ κ΄€μ©μ–΄ μ™„μ„± λ²¤μΉλ§ν¬μ΄λ‹¤. μ•μ„ μ–ΈκΈ‰ν• μ¤‘κµ­ λ²¤μΉλ§ν¬μ— λ€ν• ν‰κ°€ μ§€ν‘λ” μ •ν™•μ„± λλ” EMμ΄λ‹¤.</p>
</div>
</section>
<section id="S5.SS1.SSS3.Px7" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Open LLM Leaderboard.</h5>

<div id="S5.SS1.SSS3.Px7.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS1.SSS3.Px7.p1.1">μ°λ¦¬λ” λ‚΄λ¶€ ν‰κ°€ ν”„λ μ„μ›ν¬λ¥Ό κΈ°λ°μΌλ΅ μ•μ„ μ–ΈκΈ‰ν• λ¨λ“  λ²¤μΉλ§ν¬λ¥Ό ν‰κ°€ν•λ‹¤. DeepSeekMoE 16Bλ¥Ό μ¤ν”μ†μ¤ λ¨λΈκ³Ό κ³µμ •ν•κ³  νΈλ¦¬ν•κ² λΉ„κµν•κΈ° μ„ν•΄ Open LLM λ¦¬λ”λ³΄λ“ μƒμ—μ„ DeepSeekMoE 16Bλ¥Ό μ¶”κ°€μ μΌλ΅ ν‰κ°€ν•λ‹¤. Open LLM Leaderboardλ” HuggingFaceμ—μ„ μ§€μ›ν•λ” κ³µκ° λ¦¬λ”λ³΄λ“λ΅μ„, ARCΒ <cite class="ltx_cite ltx_citemacro_citep">(Clark etΒ al., <a class="ltx_ref" href="#bib.bib9" title="">2018</a>)</cite>, HellaSwagΒ <cite class="ltx_cite ltx_citemacro_citep">(Zellers etΒ al., <a class="ltx_ref" href="#bib.bib59" title="">2019</a>)</cite>, MMLUΒ <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks etΒ al., <a class="ltx_ref" href="#bib.bib20" title="">2020</a>)</cite>, TruthfulQAΒ <cite class="ltx_cite ltx_citemacro_citep">(Lin etΒ al., <a class="ltx_ref" href="#bib.bib35" title="">2022</a>)</cite>, WinograndeΒ <cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi etΒ al., <a class="ltx_ref" href="#bib.bib43" title="">2019</a>)</cite>, GSM8KΒ <cite class="ltx_cite ltx_citemacro_citep">(Cobbe etΒ al., <a class="ltx_ref" href="#bib.bib10" title="">2021</a>)</cite>μ 6κ°μ νƒμ¤ν¬λ΅ κµ¬μ„±λλ‹¤.</p>
</div>
</section>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Evaluations</h3>

<figure id="S5.T3" class="ltx_table">
<table id="S5.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.1.1.2.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.1.1.3.1" class="ltx_text ltx_font_bold">DeepSeek 7B (Dense)</span></td>
<td id="S5.T3.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.1.1.4.1" class="ltx_text ltx_font_bold">DeepSeekMoE 16B</span></td>
</tr>
<tr id="S5.T3.1.2.2" class="ltx_tr">
<th id="S5.T3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"># Total Params</th>
<th id="S5.T3.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">6.9B</td>
<td id="S5.T3.1.2.2.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">16.4B</td>
</tr>
<tr id="S5.T3.1.3.3" class="ltx_tr">
<th id="S5.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;"># Activated Params</th>
<th id="S5.T3.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">6.9B</td>
<td id="S5.T3.1.3.3.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2.8B</td>
</tr>
<tr id="S5.T3.1.4.4" class="ltx_tr">
<th id="S5.T3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">FLOPs per 4K Tokens</th>
<th id="S5.T3.1.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">183.5T</td>
<td id="S5.T3.1.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">74.4T</td>
</tr>
<tr id="S5.T3.1.5.5" class="ltx_tr">
<th id="S5.T3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;"># Training Tokens</th>
<th id="S5.T3.1.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
<td id="S5.T3.1.5.5.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
</tr>
<tr id="S5.T3.1.6.6" class="ltx_tr">
<th id="S5.T3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Pile&nbsp;(BPB)</th>
<th id="S5.T3.1.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T3.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.75</td>
<td id="S5.T3.1.6.6.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.6.6.4.1" class="ltx_text ltx_font_bold">0.74</span></td>
</tr>
<tr id="S5.T3.1.7.7" class="ltx_tr">
<th id="S5.T3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S5.T3.1.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">75.4</td>
<td id="S5.T3.1.7.7.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.7.7.4.1" class="ltx_text ltx_font_bold">77.1</span></td>
</tr>
<tr id="S5.T3.1.8.8" class="ltx_tr">
<th id="S5.T3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S5.T3.1.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">79.2</td>
<td id="S5.T3.1.8.8.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.8.8.4.1" class="ltx_text ltx_font_bold">80.2</span></td>
</tr>
<tr id="S5.T3.1.9.9" class="ltx_tr">
<th id="S5.T3.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S5.T3.1.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.9.9.3.1" class="ltx_text ltx_font_bold">67.9</span></td>
<td id="S5.T3.1.9.9.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.9.9.4.1" class="ltx_text ltx_font_bold">68.1</span></td>
</tr>
<tr id="S5.T3.1.10.10" class="ltx_tr">
<th id="S5.T3.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S5.T3.1.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.10.10.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">48.1</td>
<td id="S5.T3.1.10.10.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.10.10.4.1" class="ltx_text ltx_font_bold">49.8</span></td>
</tr>
<tr id="S5.T3.1.11.11" class="ltx_tr">
<th id="S5.T3.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S5.T3.1.11.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.11.11.3.1" class="ltx_text ltx_font_bold">63.2</span></td>
<td id="S5.T3.1.11.11.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">61.9</td>
</tr>
<tr id="S5.T3.1.12.12" class="ltx_tr">
<th id="S5.T3.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S5.T3.1.12.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.12.12.3.1" class="ltx_text ltx_font_bold">46.5</span></td>
<td id="S5.T3.1.12.12.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.12.12.4.1" class="ltx_text ltx_font_bold">46.4</span></td>
</tr>
<tr id="S5.T3.1.13.13" class="ltx_tr">
<th id="S5.T3.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">DROP&nbsp;(EM)</th>
<th id="S5.T3.1.13.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">1-shot</th>
<td id="S5.T3.1.13.13.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.13.13.3.1" class="ltx_text ltx_font_bold">34.9</span></td>
<td id="S5.T3.1.13.13.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">32.9</td>
</tr>
<tr id="S5.T3.1.14.14" class="ltx_tr">
<th id="S5.T3.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">GSM8K&nbsp;(EM)</th>
<th id="S5.T3.1.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">8-shot</th>
<td id="S5.T3.1.14.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">17.4</td>
<td id="S5.T3.1.14.14.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.14.14.4.1" class="ltx_text ltx_font_bold">18.8</span></td>
</tr>
<tr id="S5.T3.1.15.15" class="ltx_tr">
<th id="S5.T3.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">MATH&nbsp;(EM)</th>
<th id="S5.T3.1.15.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">4-shot</th>
<td id="S5.T3.1.15.15.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">3.3</td>
<td id="S5.T3.1.15.15.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.15.15.4.1" class="ltx_text ltx_font_bold">4.3</span></td>
</tr>
<tr id="S5.T3.1.16.16" class="ltx_tr">
<th id="S5.T3.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S5.T3.1.16.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.16.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">26.2</td>
<td id="S5.T3.1.16.16.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.16.16.4.1" class="ltx_text ltx_font_bold">26.8</span></td>
</tr>
<tr id="S5.T3.1.17.17" class="ltx_tr">
<th id="S5.T3.1.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S5.T3.1.17.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">3-shot</th>
<td id="S5.T3.1.17.17.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.17.17.3.1" class="ltx_text ltx_font_bold">39.0</span></td>
<td id="S5.T3.1.17.17.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.17.17.4.1" class="ltx_text ltx_font_bold">39.2</span></td>
</tr>
<tr id="S5.T3.1.18.18" class="ltx_tr">
<th id="S5.T3.1.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S5.T3.1.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.18.18.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">59.7</td>
<td id="S5.T3.1.18.18.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.18.18.4.1" class="ltx_text ltx_font_bold">64.8</span></td>
</tr>
<tr id="S5.T3.1.19.19" class="ltx_tr">
<th id="S5.T3.1.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S5.T3.1.19.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.19.19.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">22.2</td>
<td id="S5.T3.1.19.19.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.19.19.4.1" class="ltx_text ltx_font_bold">25.5</span></td>
</tr>
<tr id="S5.T3.1.20.20" class="ltx_tr">
<th id="S5.T3.1.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">MMLU&nbsp;(Acc.)</th>
<th id="S5.T3.1.20.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.20.20.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.20.20.3.1" class="ltx_text ltx_font_bold">48.2</span></td>
<td id="S5.T3.1.20.20.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">45.0</td>
</tr>
<tr id="S5.T3.1.21.21" class="ltx_tr">
<th id="S5.T3.1.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th id="S5.T3.1.21.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.21.21.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.21.21.3.1" class="ltx_text ltx_font_bold">70.5</span></td>
<td id="S5.T3.1.21.21.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.21.21.4.1" class="ltx_text ltx_font_bold">70.2</span></td>
</tr>
<tr id="S5.T3.1.22.22" class="ltx_tr">
<th id="S5.T3.1.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">CLUEWSC&nbsp;(EM)</th>
<th id="S5.T3.1.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.22.22.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.22.22.3.1" class="ltx_text ltx_font_bold">73.1</span></td>
<td id="S5.T3.1.22.22.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">72.1</td>
</tr>
<tr id="S5.T3.1.23.23" class="ltx_tr">
<th id="S5.T3.1.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">CEval&nbsp;(Acc.)</th>
<th id="S5.T3.1.23.23.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.23.23.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.23.23.3.1" class="ltx_text ltx_font_bold">45.0</span></td>
<td id="S5.T3.1.23.23.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">40.6</td>
</tr>
<tr id="S5.T3.1.24.24" class="ltx_tr">
<th id="S5.T3.1.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">CMMLU&nbsp;(Acc.)</th>
<th id="S5.T3.1.24.24.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T3.1.24.24.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.24.24.3.1" class="ltx_text ltx_font_bold">47.2</span></td>
<td id="S5.T3.1.24.24.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">42.5</td>
</tr>
<tr id="S5.T3.1.25.25" class="ltx_tr">
<th id="S5.T3.1.25.25.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">CHID&nbsp;(Acc.)</th>
<th id="S5.T3.1.25.25.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T3.1.25.25.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.25.25.3.1" class="ltx_text ltx_font_bold">89.3</span></td>
<td id="S5.T3.1.25.25.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T3.1.25.25.4.1" class="ltx_text ltx_font_bold">89.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">ν‘ 3:</span></figcaption>
Comparison between DeepSeek 7B and DeepSeekMoE 16B.
<span id="S5.T3.3.1" class="ltx_text ltx_font_bold">Bold</span> font indicates the best or near the best.
With only 40.5% of computations, DeepSeekMoE 16B achieves comparable performance with DeepSeek 7B.
</figcaption>
</figure>
<section id="S5.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1 </span>Internal Comparison with DeepSeek 7B</h4>

<div id="S5.SS2.SSS1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS1.p1.1">λ¨Όμ € DeepSeekMoE 16Bμ™€ DeepSeek 7B <cite class="ltx_cite ltx_citemacro_citep">(DeepSeek-AI, <a class="ltx_ref" href="#bib.bib13" title="">2024</a>)</cite>, 6.9B νλΌλ―Έν„°λ¥Ό κ°–λ” μ΅°λ°€ν• μ–Έμ–΄ λ¨λΈμ„ λ‚΄λ¶€μ μΌλ΅ λΉ„κµν•λ‹¤. κ³µμ •μ„±μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ λ‘ λ¨λΈμ€ 2T ν† ν°μ΄ μλ” λ™μΌν• μ½”νΌμ¤μ—μ„ ν›λ ¨λλ‹¤. μ΄λ¥Ό ν†µν•΄ ν›λ ¨ λ°μ΄ν„°μ μν–¥κ³Ό λ¬΄κ΄€ν•κ² MoE μ•„ν‚¤ν…μ²μ μ ν¨μ„±μ„ μ •ν™•ν•κ² ν‰κ°€ν•  μ μλ‹¤.</p>
</div>
<div id="S5.SS2.SSS1.p2" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS1.p2.1">ν‰κ°€ κ²°κ³Όλ” ν‘ <a class="ltx_ref" href="#S5.T3" title="Table 3 β€£ 5.2 Evaluations β€£ 5 Scaling up to DeepSeekMoE 16B β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>μ— μ μ‹λμ–΄ λ‹¤μκ³Ό κ°™μ€ κ΄€μ°°μ„ μ‚°μ¶ν•λ‹¤. (1) μ „μ²΄μ μΌλ΅ κ³„μ‚°μ μ•½ 40%λ§μΌλ΅ DeepSeekMoE 16Bλ” DeepSeek 7Bμ™€ λΉ„κµ κ°€λ¥ν• μ„±λ¥μ„ λ‹¬μ„±ν•λ‹¤. (2) DeepSeekMoE 16Bλ” Pile, HellaSwag, TriviaQA λ° NaturalQuestionsμ™€ κ°™μ€ μ–Έμ–΄ λ¨λΈλ§ λ° μ§€μ‹ μ§‘μ•½μ  νƒμ¤ν¬μ—μ„ μ£Όλ©ν•  λ§ν• κ°•μ μ„ λ‚νƒ€λ‚Έλ‹¤. MoE λ¨λΈμ—μ„ FFN λ§¤κ°λ³€μκ°€ μ£Όμ λ§¤κ°λ³€μλ³΄λ‹¤ ν›¨μ”¬ λ¬΄κ²λ‹¤λ” μ μ„ κ°μ•ν•  λ• μ΄λ¬ν• κ²°κ³Όλ” νΈλμ¤ν¬λ¨Έμ FFNμ΄ μ§€μ‹ μ•”κΈ° λ¥λ ¥μ„ λ‚νƒ€λ‚Έλ‹¤λ” λ…μ <cite class="ltx_cite ltx_citemacro_citep">(Dai etΒ al., <a class="ltx_ref" href="#bib.bib11" title="">2022a</a>)</cite>μ™€ μΌμΉν•λ‹¤. (3) λ‹¤λ¥Έ νƒμ¤ν¬μ— λ€ν• μ°μν• μ„±λ¥κ³Ό λΉ„κµν•μ—¬, DeepSeekMoEλ” κ°κ΄€μ‹ νƒμ¤ν¬λ¥Ό λ‹¤λ£¨λ”λ° ν•κ³„λ¥Ό λ‚νƒ€λ‚Έλ‹¤. μ΄λ¬ν• λ¶€μ μ ν•¨μ€ DeepSeekMoE 16Bμ—μ„μ μ ν•λ μ£Όμ νλΌλ―Έν„°λ΅λ¶€ν„° κΈ°μΈν•λ‹¤(DeepSeekMoE 16Bλ” λ‹¨μ§€ μ•½ 0.5B μ£Όμ νλΌλ―Έν„°λ¥Ό κ°–λ” λ°λ©΄, DeepSeek 7Bλ” 2.5B μ£Όμ νλΌλ―Έν„°λ¥Ό κ°–λ”λ‹¤). λ”¥μ”½ 7Bμ— λ€ν• μ°λ¦¬μ μ΄κΈ° μ΅°μ‚¬λ” κ°κ΄€μ‹ κ³Όμ μ— λ€ν• μ£Όμλ ¥κ³Ό μν–‰ μ‚¬μ΄μ μ–‘μ μƒκ΄€κ΄€κ³„λ¥Ό λ³΄μ—¬μ¤€λ‹¤. μλ¥Ό λ“¤μ–΄, λ‹¤μ¤‘ μΏΌλ¦¬ μ£Όμ λ©”μ»¤λ‹μ¦ <cite class="ltx_cite ltx_citemacro_citep">(Shazeer, <a class="ltx_ref" href="#bib.bib46" title="">2019</a>)</cite>λ¥Ό νƒ‘μ¬ν• DeepSeek 7B MQAλ„ MMLUμ™€ κ°™μ€ μ‘μ—…μ—μ„ κ³ μ „ν–λ‹¤. λν•, DeepSeekMoE 16Bμ ν›λ ¨ κ³Όμ •μ— λ€ν• λ³΄λ‹¤ ν¬κ΄„μ μΈ μ΄ν•΄λ¥Ό μ„ν•΄, μ°Έμ΅°λ¥Ό μ„ν•΄ λ¶€λ΅ <a class="ltx_ref" href="#A3" title="Appendix C Training Benchmark Curves of DeepSeekMoE 16B β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">C</span></a>μ—μ„ ν›λ ¨ν•λ” λ™μ• DeepSeekMoE 16Bμ™€ DeepSeek 7B(Dense)μ λ²¤μΉλ§ν¬ κ³΅μ„ λ„ ν•¨κ» μ κ³µν•λ‹¤.</p>
</div>
<div id="S5.SS2.SSS1.p3" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS1.p3.1">λΉ„νμ μΌλ΅ DeepSeekMoE 16Bμ μ λ‹Ήν• μμ νλΌλ―Έν„°λ΅ μΈν•΄ 40GBμ λ©”λ¨λ¦¬λ¥Ό κ°€μ§„ GPUμ—μ„ λ‹¨μΌ μ¥μΉ λ°°ν¬λ¥Ό κ°€λ¥ν•κ² ν•λ‹¤. μ μ ν• μ—°μ‚°μ μµμ ν™”λ¥Ό ν†µν•΄ 7B λ°€μ§‘ λ¨λΈμ μ¶”λ΅  μ†λ„μ κ±°μ 2.5λ°°λ¥Ό λ‹¬μ„±ν•  μ μλ‹¤.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.1.1.1" class="ltx_tr">
<th id="S5.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.1.1.2.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="S5.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">LLaMA2 7B</span></td>
<td id="S5.T4.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.1.1.4.1" class="ltx_text ltx_font_bold">DeepSeekMoE 16B</span></td>
</tr>
<tr id="S5.T4.1.2.2" class="ltx_tr">
<th id="S5.T4.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"># Total Params</th>
<th id="S5.T4.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">6.7B</td>
<td id="S5.T4.1.2.2.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">16.4B</td>
</tr>
<tr id="S5.T4.1.3.3" class="ltx_tr">
<th id="S5.T4.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;"># Activated Params</th>
<th id="S5.T4.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">6.7B</td>
<td id="S5.T4.1.3.3.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2.8B</td>
</tr>
<tr id="S5.T4.1.4.4" class="ltx_tr">
<th id="S5.T4.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">FLOPs per 4K Tokens</th>
<th id="S5.T4.1.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">187.9T</td>
<td id="S5.T4.1.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">74.4T</td>
</tr>
<tr id="S5.T4.1.5.5" class="ltx_tr">
<th id="S5.T4.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;"># Training Tokens</th>
<th id="S5.T4.1.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
<td id="S5.T4.1.5.5.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2T</td>
</tr>
<tr id="S5.T4.1.6.6" class="ltx_tr">
<th id="S5.T4.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">Pile&nbsp;(BPB)</th>
<th id="S5.T4.1.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">N/A</th>
<td id="S5.T4.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0.76</td>
<td id="S5.T4.1.6.6.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.6.6.4.1" class="ltx_text ltx_font_bold">0.74</span></td>
</tr>
<tr id="S5.T4.1.7.7" class="ltx_tr">
<th id="S5.T4.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S5.T4.1.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">75.6</td>
<td id="S5.T4.1.7.7.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.7.7.4.1" class="ltx_text ltx_font_bold">77.1</span></td>
</tr>
<tr id="S5.T4.1.8.8" class="ltx_tr">
<th id="S5.T4.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S5.T4.1.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">78.0</td>
<td id="S5.T4.1.8.8.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.8.8.4.1" class="ltx_text ltx_font_bold">80.2</span></td>
</tr>
<tr id="S5.T4.1.9.9" class="ltx_tr">
<th id="S5.T4.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S5.T4.1.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.9.9.3.1" class="ltx_text ltx_font_bold">69.1</span></td>
<td id="S5.T4.1.9.9.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">68.1</td>
</tr>
<tr id="S5.T4.1.10.10" class="ltx_tr">
<th id="S5.T4.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S5.T4.1.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.10.10.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">49.0</td>
<td id="S5.T4.1.10.10.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.10.10.4.1" class="ltx_text ltx_font_bold">49.8</span></td>
</tr>
<tr id="S5.T4.1.11.11" class="ltx_tr">
<th id="S5.T4.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S5.T4.1.11.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">60.7</td>
<td id="S5.T4.1.11.11.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.11.11.4.1" class="ltx_text ltx_font_bold">61.9</span></td>
</tr>
<tr id="S5.T4.1.12.12" class="ltx_tr">
<th id="S5.T4.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S5.T4.1.12.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">45.8</td>
<td id="S5.T4.1.12.12.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.12.12.4.1" class="ltx_text ltx_font_bold">46.4</span></td>
</tr>
<tr id="S5.T4.1.13.13" class="ltx_tr">
<th id="S5.T4.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">DROP&nbsp;(EM)</th>
<th id="S5.T4.1.13.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">1-shot</th>
<td id="S5.T4.1.13.13.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.13.13.3.1" class="ltx_text ltx_font_bold">34.0</span></td>
<td id="S5.T4.1.13.13.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">32.9</td>
</tr>
<tr id="S5.T4.1.14.14" class="ltx_tr">
<th id="S5.T4.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">GSM8K&nbsp;(EM)</th>
<th id="S5.T4.1.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">8-shot</th>
<td id="S5.T4.1.14.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">15.5</td>
<td id="S5.T4.1.14.14.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.14.14.4.1" class="ltx_text ltx_font_bold">18.8</span></td>
</tr>
<tr id="S5.T4.1.15.15" class="ltx_tr">
<th id="S5.T4.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">MATH&nbsp;(EM)</th>
<th id="S5.T4.1.15.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">4-shot</th>
<td id="S5.T4.1.15.15.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">2.6</td>
<td id="S5.T4.1.15.15.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.15.15.4.1" class="ltx_text ltx_font_bold">4.3</span></td>
</tr>
<tr id="S5.T4.1.16.16" class="ltx_tr">
<th id="S5.T4.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S5.T4.1.16.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.16.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">14.6</td>
<td id="S5.T4.1.16.16.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.16.16.4.1" class="ltx_text ltx_font_bold">26.8</span></td>
</tr>
<tr id="S5.T4.1.17.17" class="ltx_tr">
<th id="S5.T4.1.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S5.T4.1.17.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">3-shot</th>
<td id="S5.T4.1.17.17.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">21.8</td>
<td id="S5.T4.1.17.17.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.17.17.4.1" class="ltx_text ltx_font_bold">39.2</span></td>
</tr>
<tr id="S5.T4.1.18.18" class="ltx_tr">
<th id="S5.T4.1.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S5.T4.1.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.18.18.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">63.8</td>
<td id="S5.T4.1.18.18.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.18.18.4.1" class="ltx_text ltx_font_bold">64.8</span></td>
</tr>
<tr id="S5.T4.1.19.19" class="ltx_tr">
<th id="S5.T4.1.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S5.T4.1.19.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.19.19.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.19.19.3.1" class="ltx_text ltx_font_bold">25.5</span></td>
<td id="S5.T4.1.19.19.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.19.19.4.1" class="ltx_text ltx_font_bold">25.5</span></td>
</tr>
<tr id="S5.T4.1.20.20" class="ltx_tr">
<th id="S5.T4.1.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">MMLU&nbsp;(Acc.)</th>
<th id="S5.T4.1.20.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.20.20.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.20.20.3.1" class="ltx_text ltx_font_bold">45.8</span></td>
<td id="S5.T4.1.20.20.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">45.0</td>
</tr>
<tr id="S5.T4.1.21.21" class="ltx_tr">
<th id="S5.T4.1.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th id="S5.T4.1.21.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.21.21.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">69.6</td>
<td id="S5.T4.1.21.21.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.21.21.4.1" class="ltx_text ltx_font_bold">70.2</span></td>
</tr>
<tr id="S5.T4.1.22.22" class="ltx_tr">
<th id="S5.T4.1.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">CLUEWSC&nbsp;(EM)</th>
<th id="S5.T4.1.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.22.22.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">64.0</td>
<td id="S5.T4.1.22.22.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.22.22.4.1" class="ltx_text ltx_font_bold">72.1</span></td>
</tr>
<tr id="S5.T4.1.23.23" class="ltx_tr">
<th id="S5.T4.1.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">CEval&nbsp;(Acc.)</th>
<th id="S5.T4.1.23.23.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.23.23.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">33.9</td>
<td id="S5.T4.1.23.23.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.23.23.4.1" class="ltx_text ltx_font_bold">40.6</span></td>
</tr>
<tr id="S5.T4.1.24.24" class="ltx_tr">
<th id="S5.T4.1.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.0pt;padding-right:4.0pt;">CMMLU&nbsp;(Acc.)</th>
<th id="S5.T4.1.24.24.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">5-shot</th>
<td id="S5.T4.1.24.24.3" class="ltx_td ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;">32.6</td>
<td id="S5.T4.1.24.24.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.24.24.4.1" class="ltx_text ltx_font_bold">42.5</span></td>
</tr>
<tr id="S5.T4.1.25.25" class="ltx_tr">
<th id="S5.T4.1.25.25.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">CHID&nbsp;(Acc.)</th>
<th id="S5.T4.1.25.25.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:4.0pt;padding-right:4.0pt;">0-shot</th>
<td id="S5.T4.1.25.25.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;">37.9</td>
<td id="S5.T4.1.25.25.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T4.1.25.25.4.1" class="ltx_text ltx_font_bold">89.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">ν‘ 4:</span></figcaption>
Comparison between LLaMA2 7B and DeepSeekMoE 16B.
With only 39.6% of computations, DeepSeekMoE 16B outperforms LLaMA2 7B on the majority of benchmarks.
</figcaption>
</figure>
</section>
<section id="S5.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2 </span>Comparison with Open Source Models</h4>

<section id="S5.SS2.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Internal Comparison with LLaMA2 7B.</h5>

<div id="S5.SS2.SSS2.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS2.Px1.p1.1">μ¤ν” μ†μ¤ λ¨λΈμ μμ—­μ—μ„λ” μ£Όλ΅ DeepSeekMoE 16Bμ™€ 6.7B νλΌλ―Έν„°λ¥Ό κ°€μ§„ μ μ•λ ¤μ Έ μκ³  κ°•λ ¥ν• μ¤ν” μ†μ¤ μ–Έμ–΄ λ¨λΈμΈ LLaMA2 7B <cite class="ltx_cite ltx_citemacro_citep">(Touvron etΒ al., <a class="ltx_ref" href="#bib.bib54" title="">2023b</a>)</cite>λ¥Ό λΉ„κµν•λ‹¤. DeepSeekMoE 16Bμ™€ LLaMA2 7Bλ” λ¨λ‘ 2T ν† ν°μ— λ€ν•΄ μ‚¬μ „ ν›λ ¨λλ‹¤. LLaMA2 7Bμ™€ λΉ„κµν•μ—¬ DeepSeekMoEλ” μ „μ²΄ λ§¤κ°λ³€μμ 245%λ¥Ό κ°–μ§€λ§ κ³„μ‚°μ 39.6%λ§ ν•„μ”ν•λ‹¤. λ‚΄λ¶€ λ²¤μΉλ§ν¬μ— λ€ν• κ²°κ³Όλ” λ‹¤μ κ΄€μ°°λ΅ μ΄μ–΄μ§€λ” ν‘ <a class="ltx_ref" href="#S5.T4" title="Table 4 β€£ 5.2.1 Internal Comparison with DeepSeek 7B β€£ 5.2 Evaluations β€£ 5 Scaling up to DeepSeekMoE 16B β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>μ— λ‚μ™€ μλ‹¤. (1) ν‰κ°€λ λ²¤μΉλ§ν¬ μ¤‘μ—μ„, λ‹¨μ§€ μ•½ 40%μ κ³„μ‚°μΌλ΅, DeepSeekMoE 16Bλ” λ€λ¶€λ¶„μ λ²¤μΉλ§ν¬μ—μ„ LLaMA2 7Bλ¥Ό λ¥κ°€ν•λ‹¤. (2) DeepSeekMoE 16Bμ μν•™ μ¶”λ΅  λ° μ½”λ“ μƒμ„± λ¥λ ¥μ€ LLaMA2 7Bλ³΄λ‹¤ κ°•ν•λ©°, μ΄λ” μ‚¬μ „ ν›λ ¨ λ§λ­‰μΉμ— μν•™μ  λ° μ½”λ“ κ΄€λ ¨ ν…μ¤νΈκ°€ ν’λ¶€ν•κ² μ΅΄μ¬ν•κΈ° λ•λ¬Έμ΄λ‹¤. (3) μ‚¬μ „ ν›λ ¨ μ½”νΌμ¤μ— μ¤‘κµ­μ–΄ ν…μ¤νΈκ°€ μ΅΄μ¬ν•λ” κ²½μ°, DeepSeekMoE 16Bλ” μ¤‘κµ­ λ²¤μΉλ§ν¬μ—μ„ LLaMA2 7Bμ— λΉ„ν•΄ μƒλ‹Ήν• μ„±λ¥ μ΄μ μ„ λ‚νƒ€λ‚Έλ‹¤. (4) λ” μ μ€ μμ μμ–΄ ν…μ¤νΈλ“¤μ— λ€ν•΄ νΈλ μ΄λ‹λμ—μμ—λ„ λ¶κµ¬ν•κ³ , DeepSeekMoE 16Bλ” μμ–΄ μ΄ν•΄ λλ” μ§€μ‹ μ§‘μ•½μ  λ²¤μΉλ§ν¬λ“¤μ— λ€ν•΄ LLaMA2 7Bμ™€ λΉ„κµλκ±°λ‚ λ” λ‚μ€ μ„±λ¥μ„ λ‹¬μ„±ν•λ©°, μ΄λ” DeepSeekMoE 16Bμ νƒμ›”ν• λ¥λ ¥μ„ μ…μ¦ν•λ‹¤.</p>
</div>
</section>
<section id="S5.SS2.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Evaluation on Open LLM Leaderboard.</h5>

<div id="S5.SS2.SSS2.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S5.SS2.SSS2.Px2.p1.1">λ‚΄λ¶€ ν‰κ°€ μ™Έμ—λ„ μ¤ν” LLM λ¦¬λ”λ³΄λ“μ—μ„ DeepSeekMoE 16Bλ¥Ό ν‰κ°€ν•κ³  λ‹¤λ¥Έ μ¤ν” μ†μ¤ λ¨λΈκ³Ό λΉ„κµν•λ‹¤. LLaMA2 7B μ™Έμ—λ„ LLaMA 7B <cite class="ltx_cite ltx_citemacro_citep">(Touvron etΒ al., <a class="ltx_ref" href="#bib.bib53" title="">2023a</a>)</cite>, Falcon 7B <cite class="ltx_cite ltx_citemacro_citep">(Almazrouei etΒ al., <a class="ltx_ref" href="#bib.bib1" title="">2023</a>)</cite>, GPT-J 6B <cite class="ltx_cite ltx_citemacro_citep">(Wang and Komatsuzaki, <a class="ltx_ref" href="#bib.bib56" title="">2021</a>)</cite>, RedPajama-INCITE 7B and 3B <cite class="ltx_cite ltx_citemacro_citep">(Together-AI, <a class="ltx_ref" href="#bib.bib52" title="">2023</a>)</cite>, Open LLaMA 7B and 3B <cite class="ltx_cite ltx_citemacro_citep">(Geng and Liu, <a class="ltx_ref" href="#bib.bib18" title="">2023</a>)</cite>, OPT 2.7B <cite class="ltx_cite ltx_citemacro_citep">(Zhang etΒ al., <a class="ltx_ref" href="#bib.bib60" title="">2022</a>)</cite>, Pythia 2.8B <cite class="ltx_cite ltx_citemacro_citep">(Biderman etΒ al., <a class="ltx_ref" href="#bib.bib4" title="">2023</a>)</cite>, GPT-neo 2.7B <cite class="ltx_cite ltx_citemacro_citep">(Black etΒ al., <a class="ltx_ref" href="#bib.bib6" title="">2021</a>)</cite>, BLOOM 3B <cite class="ltx_cite ltx_citemacro_citep">(Scao etΒ al., <a class="ltx_ref" href="#bib.bib44" title="">2022</a>)</cite> λ“±μ μ¤ν” μ†μ¤ λ¨λΈ μ§‘ν•©μ„ κ³ λ ¤ν•λ‹¤. <a class="ltx_ref" href="#S0.F1" title="Figure 1 β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>μ— μ μ‹λ ν‰κ°€ κ²°κ³Όλ” DeepSeekMoE 16Bκ°€ μ μ‚¬ν• ν™μ„±ν™”λ νλΌλ―Έν„°λ¥Ό κ°€μ§„ λ¨λΈλ³΄λ‹¤ ν° λ§μ§„λ§νΌ μΌκ΄€λκ² μ°μν•¨μ„ λ³΄μ—¬μ¤€λ‹¤. λν•, μ•½ 2.5λ°°μ ν™μ„±ν™”λ νλΌλ―Έν„°λ¥Ό κ°–λ” LLaMA2 7Bμ™€ μ μ‚¬ν• μ„±λ¥μ„ λ‹¬μ„±ν•λ‹¤.</p>
</div>
</section>
</section>
</section>
</section>
<section id="S6" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Alignment for DeepSeekMoE 16B</h2>

<div id="S6.p1" class="ltx_para">
<p class="ltx_p" id="S6.p1.1">μ΄μ „ μ—°κµ¬μ— λ”°λ¥΄λ©΄ MoE λ¨λΈμ€ μΌλ°μ μΌλ΅ λ―Έμ„Έ μ΅°μ • <cite class="ltx_cite ltx_citemacro_citep">(Fedus etΒ al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>; Artetxe etΒ al., <a class="ltx_ref" href="#bib.bib2" title="">2022</a>)</cite>μ—μ„ μ μλ―Έν• μ΄λ“μ„ λ‚νƒ€λ‚΄μ§€ μ•λ”λ‹¤. κ·Έλ¬λ‚ <cite class="ltx_cite ltx_citemacro_citet">Shen etΒ al. (<a class="ltx_ref" href="#bib.bib48" title="">2023</a>)</cite>λ” MoE λ¨λΈμ΄ μ‹¤μ λ΅ λ…λ Ήμ–΄ νλ‹μ μ΄μ μ„ μ–»μ„ μ μμμ„ μ‹μ‚¬ν•λ” κ²°κ³Όλ¥Ό μ μ‹ν•λ‹¤. DeepSeekMoE 16Bκ°€ λ―Έμ„Έμ΅°μ •μ μ΄μ μ„ μ–»μ„ μ μλ”μ§€ ν‰κ°€ν•κΈ° μ„ν•΄ DeepSeekMoE 16Bλ¥Ό κΈ°λ°μΌλ΅ μ±„ν… λ¨λΈμ„ κµ¬μ„±ν•κΈ° μ„ν•΄ κ°λ… λ―Έμ„Έμ΅°μ •μ„ μν–‰ν•λ‹¤. μ‹¤ν— κ²°κ³Όλ” DeepSeekMoE Chat 16Bλ„ LLaMA2 SFT 7B λ° DeepSeek Chat 7Bμ™€ μ μ‚¬ν• μ„±λ¥μ„ λ‹¬μ„±ν•¨μ„ λ³΄μ—¬μ¤€λ‹¤.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Experimental Setup</h3>

<section id="S6.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Data.</h5>

<div id="S6.SS1.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS1.SSS0.Px1.p1.1">μ±„ν… λ¨λΈμ„ ν•™μµν•κΈ° μ„ν•΄ 1.4M ν›λ ¨ μ‚¬λ΅€λ΅ κµ¬μ„±λ μμ²΄ μ„ λ³„λ λ°μ΄ν„°μ— λ€ν•΄ κ°λ… λ―Έμ„Έ μ΅°μ •(supervised fine-tuning, SFT)μ„ μν–‰ν•λ‹¤. μ΄ λ°μ΄ν„° μ„ΈνΈλ” μν•™, μ½”λ“, μ“°κΈ°, μ§λ¬Έ λ‹µλ³€, μ¶”λ΅ , μ”μ•½ λ“±μ„ ν¬ν•¨ν• κ΄‘λ²”μ„ν• λ²”μ£Όμ— κ±Έμ³ μμµλ‹λ‹¤. μ°λ¦¬μ SFT ν›λ ¨ λ°μ΄ν„°μ λ€λ¶€λ¶„μ€ μμ–΄μ™€ μ¤‘κµ­μ–΄λ΅ λμ–΄ μμ–΄ μ±„ν… λ¨λΈμ„ λ‹¤μ¬λ‹¤λ¥ν•κ³  μ΄μ¤‘ μ–Έμ–΄ μ‹λ‚λ¦¬μ¤μ—μ„ μ μ©ν•  μ μλ‹¤.</p>
</div>
</section>
<section id="S6.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Hyper-Parameters.</h5>

<div id="S6.SS1.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS1.SSS0.Px2.p1.1">κ°λ… λ―Έμ„Έ μ΅°μ • λ™μ• λ°°μΉ ν¬κΈ°λ¥Ό 1024κ°μ μμ λ΅ μ„¤μ •ν•κ³  AdamW μµμ ν™”κΈ° <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite>λ¥Ό μ‚¬μ©ν•μ—¬ 8κ°μ μ—ν­μ— κ±Έμ³ ν›λ ¨μ„ μν–‰ν•λ‹¤. μ°λ¦¬λ” 4Kμ μµλ€ μ‹ν€€μ¤ κΈΈμ΄λ¥Ό μ‚¬μ©ν•κ³ , μ‹ν€€μ¤ κΈΈμ΄ ν•κ³„μ— λ„λ‹¬ν•  λ•κΉμ§€ ν›λ ¨ μμ λ¥Ό μµλ€ν• μ΅°λ°€ν•κ² ν¨ν‚Ήν•λ‹¤. μ°λ¦¬λ” κ°λ…λ λ―Έμ„Έ μ΅°μ •μ„ μ„ν•΄ λ“λ΅­μ•„μ›ƒμ„ μ‚¬μ©ν•μ§€ μ•μΌλ©°, ν•™μµλ¥  μ¤μΌ€μ¤„λ§ μ „λµμ„ ν†µν•©ν•μ§€ μ•κ³  λ‹¨μν <math alttext="10^{-5}" class="ltx_Math" display="inline" id="S6.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S6.SS1.SSS0.Px2.p1.1.m1.1a"><msup id="S6.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">10</mn><mrow id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mo id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3a" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">β’</mo><mn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><cn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" type="integer" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.2">10</cn><apply id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3"><minus id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3"></minus><cn id="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S6.SS1.SSS0.Px2.p1.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS0.Px2.p1.1.m1.1c">10^{-5}</annotation></semantics></math>μ μΌμ •ν• ν•™μµλ¥ μ„ μ„¤μ •ν•λ‹¤.</p>
</div>
</section>
<section id="S6.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Evaluation Benchmarks.</h5>

<div id="S6.SS1.SSS0.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS1.SSS0.Px3.p1.1">μ±„ν… λ¨λΈμ ν‰κ°€λ¥Ό μ„ν•΄ λ‹¤μκ³Ό κ°™μ€ μ΅°μ •μΌλ΅ μ„Ήμ… <a class="ltx_ref" href="#S5.SS1.SSS3" title="5.1.3 Evaluation Benchmarks β€£ 5.1 Experimental Setup β€£ 5 Scaling up to DeepSeekMoE 16B β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5.1.3</span></a>μ—μ„ μ‚¬μ©λ κ²ƒκ³Ό μ μ‚¬ν• λ²¤μΉλ§ν¬λ¥Ό μ‚¬μ©ν•λ‹¤. (1) μ±„ν… λ¨λΈμ€ μμ μ–Έμ–΄ λ¨λΈλ§μ— κ±°μ μ‚¬μ©λμ§€ μ•κΈ° λ•λ¬Έμ— νμΌ <cite class="ltx_cite ltx_citemacro_citep">(Gao etΒ al., <a class="ltx_ref" href="#bib.bib17" title="">2020</a>)</cite>λ¥Ό μ μ™Έν•λ‹¤. (2) κ΄€μ°°λ κ²°κ³Όμ λ¶μ•μ •μ„±μΌλ΅ μΈν•΄ CHID <cite class="ltx_cite ltx_citemacro_citep">(Zheng etΒ al., <a class="ltx_ref" href="#bib.bib61" title="">2019</a>)</cite>λ¥Ό μ μ™Έν•μ—¬ κ²¬κ³ ν• κ²°λ΅  λ„μ¶μ„ λ°©ν•΄ν•λ‹¤. (3) μ±„ν… λ¨λΈλ“¤μ μ¶”λ΅  λ¥λ ¥μ— λ€ν• λ³΄λ‹¤ ν¬κ΄„μ μΈ ν‰κ°€λ¥Ό μ κ³µν•κΈ° μ„ν•΄ BBHΒ <cite class="ltx_cite ltx_citemacro_citep">(Suzgun etΒ al., <a class="ltx_ref" href="#bib.bib50" title="">2022</a>)</cite>λ¥Ό μ¶”κ°€μ μΌλ΅ ν¬ν•¨ν•λ‹¤.</p>
</div>
<figure id="S6.T5" class="ltx_table">
<table id="S6.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T5.1.1.1" class="ltx_tr">
<th id="S6.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.1.1" class="ltx_text">
<span id="S6.T5.1.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.1.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></span></span>
</span></span></th>
<th id="S6.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.2.1" class="ltx_text">
<span id="S6.T5.1.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.2.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.2.1.1.1.1.1" class="ltx_text ltx_font_bold"># Shot</span></span></span>
</span></span></th>
<td id="S6.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.3.1" class="ltx_text">
<span id="S6.T5.1.1.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.3.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.3.1.1.1.1.1" class="ltx_text ltx_font_bold">LLaMA2</span></span></span>
<span id="S6.T5.1.1.1.3.1.1.2" class="ltx_tr">
<span id="S6.T5.1.1.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.3.1.1.2.1.1" class="ltx_text ltx_font_bold">SFT 7B</span></span></span>
</span></span></td>
<td id="S6.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.4.1" class="ltx_text">
<span id="S6.T5.1.1.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.4.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.4.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeek</span></span></span>
<span id="S6.T5.1.1.1.4.1.1.2" class="ltx_tr">
<span id="S6.T5.1.1.1.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.4.1.1.2.1.1" class="ltx_text ltx_font_bold">Chat 7B</span></span></span>
</span></span></td>
<td id="S6.T5.1.1.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.5.1" class="ltx_text">
<span id="S6.T5.1.1.1.5.1.1" class="ltx_tabular ltx_align_middle">
<span id="S6.T5.1.1.1.5.1.1.1" class="ltx_tr">
<span id="S6.T5.1.1.1.5.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.5.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></span></span>
<span id="S6.T5.1.1.1.5.1.1.2" class="ltx_tr">
<span id="S6.T5.1.1.1.5.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.1.1.5.1.1.2.1.1" class="ltx_text ltx_font_bold">Chat 16B</span></span></span>
</span></span></td>
</tr>
<tr id="S6.T5.1.2.2" class="ltx_tr">
<th id="S6.T5.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"># Total Params</th>
<th id="S6.T5.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">N/A</th>
<td id="S6.T5.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">6.7B</td>
<td id="S6.T5.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">6.9B</td>
<td id="S6.T5.1.2.2.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">16.4B</td>
</tr>
<tr id="S6.T5.1.3.3" class="ltx_tr">
<th id="S6.T5.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;"># Activated Params</th>
<th id="S6.T5.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">N/A</th>
<td id="S6.T5.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">6.7B</td>
<td id="S6.T5.1.3.3.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">6.9B</td>
<td id="S6.T5.1.3.3.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">2.8B</td>
</tr>
<tr id="S6.T5.1.4.4" class="ltx_tr">
<th id="S6.T5.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">FLOPs per 4K Tokens</th>
<th id="S6.T5.1.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">N/A</th>
<td id="S6.T5.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">187.9T</td>
<td id="S6.T5.1.4.4.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">183.5T</td>
<td id="S6.T5.1.4.4.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">74.4T</td>
</tr>
<tr id="S6.T5.1.5.5" class="ltx_tr">
<th id="S6.T5.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S6.T5.1.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">67.9</td>
<td id="S6.T5.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">71.0</td>
<td id="S6.T5.1.5.5.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.5.5.5.1" class="ltx_text ltx_font_bold">72.2</span></td>
</tr>
<tr id="S6.T5.1.6.6" class="ltx_tr">
<th id="S6.T5.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S6.T5.1.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.6.6.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">76.9</td>
<td id="S6.T5.1.6.6.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">78.4</td>
<td id="S6.T5.1.6.6.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.6.6.5.1" class="ltx_text ltx_font_bold">79.7</span></td>
</tr>
<tr id="S6.T5.1.7.7" class="ltx_tr">
<th id="S6.T5.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S6.T5.1.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.7.7.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">69.7</td>
<td id="S6.T5.1.7.7.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.7.7.4.1" class="ltx_text ltx_font_bold">70.2</span></td>
<td id="S6.T5.1.7.7.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.7.7.5.1" class="ltx_text ltx_font_bold">69.9</span></td>
</tr>
<tr id="S6.T5.1.8.8" class="ltx_tr">
<th id="S6.T5.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S6.T5.1.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.8.8.3.1" class="ltx_text ltx_font_bold">50.8</span></td>
<td id="S6.T5.1.8.8.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">50.2</td>
<td id="S6.T5.1.8.8.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">50.0</td>
</tr>
<tr id="S6.T5.1.9.9" class="ltx_tr">
<th id="S6.T5.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">BBH&nbsp;(EM)</th>
<th id="S6.T5.1.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">3-shot</th>
<td id="S6.T5.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">39.3</td>
<td id="S6.T5.1.9.9.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.9.9.4.1" class="ltx_text ltx_font_bold">43.1</span></td>
<td id="S6.T5.1.9.9.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">42.2</td>
</tr>
<tr id="S6.T5.1.10.10" class="ltx_tr">
<th id="S6.T5.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S6.T5.1.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td id="S6.T5.1.10.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">63.9</td>
<td id="S6.T5.1.10.10.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.10.10.4.1" class="ltx_text ltx_font_bold">66.1</span></td>
<td id="S6.T5.1.10.10.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">64.8</td>
</tr>
<tr id="S6.T5.1.11.11" class="ltx_tr">
<th id="S6.T5.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S6.T5.1.11.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td id="S6.T5.1.11.11.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">49.6</td>
<td id="S6.T5.1.11.11.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.11.11.4.1" class="ltx_text ltx_font_bold">50.8</span></td>
<td id="S6.T5.1.11.11.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.11.11.5.1" class="ltx_text ltx_font_bold">50.6</span></td>
</tr>
<tr id="S6.T5.1.12.12" class="ltx_tr">
<th id="S6.T5.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">DROP&nbsp;(EM)</th>
<th id="S6.T5.1.12.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">1-shot</th>
<td id="S6.T5.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">40.0</td>
<td id="S6.T5.1.12.12.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.12.12.4.1" class="ltx_text ltx_font_bold">41.7</span></td>
<td id="S6.T5.1.12.12.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">33.8</td>
</tr>
<tr id="S6.T5.1.13.13" class="ltx_tr">
<th id="S6.T5.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">GSM8K&nbsp;(EM)</th>
<th id="S6.T5.1.13.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.13.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.13.13.3.1" class="ltx_text ltx_font_bold">63.4</span></td>
<td id="S6.T5.1.13.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">62.6</td>
<td id="S6.T5.1.13.13.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">62.2</td>
</tr>
<tr id="S6.T5.1.14.14" class="ltx_tr">
<th id="S6.T5.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">MATH&nbsp;(EM)</th>
<th id="S6.T5.1.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">4-shot</th>
<td id="S6.T5.1.14.14.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">13.5</td>
<td id="S6.T5.1.14.14.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">14.7</td>
<td id="S6.T5.1.14.14.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.14.14.5.1" class="ltx_text ltx_font_bold">15.2</span></td>
</tr>
<tr id="S6.T5.1.15.15" class="ltx_tr">
<th id="S6.T5.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S6.T5.1.15.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.15.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">35.4</td>
<td id="S6.T5.1.15.15.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">45.1</td>
<td id="S6.T5.1.15.15.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.15.15.5.1" class="ltx_text ltx_font_bold">45.7</span></td>
</tr>
<tr id="S6.T5.1.16.16" class="ltx_tr">
<th id="S6.T5.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S6.T5.1.16.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">3-shot</th>
<td id="S6.T5.1.16.16.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">27.8</td>
<td id="S6.T5.1.16.16.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">39.0</td>
<td id="S6.T5.1.16.16.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.16.16.5.1" class="ltx_text ltx_font_bold">46.2</span></td>
</tr>
<tr id="S6.T5.1.17.17" class="ltx_tr">
<th id="S6.T5.1.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S6.T5.1.17.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td id="S6.T5.1.17.17.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">60.1</td>
<td id="S6.T5.1.17.17.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">59.5</td>
<td id="S6.T5.1.17.17.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.17.17.5.1" class="ltx_text ltx_font_bold">63.3</span></td>
</tr>
<tr id="S6.T5.1.18.18" class="ltx_tr">
<th id="S6.T5.1.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S6.T5.1.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.18.18.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.18.18.3.1" class="ltx_text ltx_font_bold">35.2</span></td>
<td id="S6.T5.1.18.18.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">32.7</td>
<td id="S6.T5.1.18.18.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.18.18.5.1" class="ltx_text ltx_font_bold">35.1</span></td>
</tr>
<tr id="S6.T5.1.19.19" class="ltx_tr">
<th id="S6.T5.1.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">MMLU&nbsp;(Acc.)</th>
<th id="S6.T5.1.19.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.19.19.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.19.19.3.1" class="ltx_text ltx_font_bold">50.0</span></td>
<td id="S6.T5.1.19.19.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">49.7</td>
<td id="S6.T5.1.19.19.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">47.2</td>
</tr>
<tr id="S6.T5.1.20.20" class="ltx_tr">
<th id="S6.T5.1.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th id="S6.T5.1.20.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.20.20.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">65.1</td>
<td id="S6.T5.1.20.20.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">68.4</td>
<td id="S6.T5.1.20.20.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.20.20.5.1" class="ltx_text ltx_font_bold">69.0</span></td>
</tr>
<tr id="S6.T5.1.21.21" class="ltx_tr">
<th id="S6.T5.1.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">CLUEWSC&nbsp;(EM)</th>
<th id="S6.T5.1.21.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">5-shot</th>
<td id="S6.T5.1.21.21.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">48.4</td>
<td id="S6.T5.1.21.21.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;">66.2</td>
<td id="S6.T5.1.21.21.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.21.21.5.1" class="ltx_text ltx_font_bold">68.2</span></td>
</tr>
<tr id="S6.T5.1.22.22" class="ltx_tr">
<th id="S6.T5.1.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">CEval&nbsp;(Acc.)</th>
<th id="S6.T5.1.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.22.22.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">35.1</td>
<td id="S6.T5.1.22.22.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.22.22.4.1" class="ltx_text ltx_font_bold">44.7</span></td>
<td id="S6.T5.1.22.22.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">40.0</td>
</tr>
<tr id="S6.T5.1.23.23" class="ltx_tr">
<th id="S6.T5.1.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">CMMLU&nbsp;(Acc.)</th>
<th id="S6.T5.1.23.23.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;">0-shot</th>
<td id="S6.T5.1.23.23.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">36.9</td>
<td id="S6.T5.1.23.23.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S6.T5.1.23.23.4.1" class="ltx_text ltx_font_bold">51.2</span></td>
<td id="S6.T5.1.23.23.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">49.3</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">ν‘ 5:</span></figcaption>
Comparison among LLaMA2 SFT 7B, DeepSeek Chat 7B and DeepSeekMoE Chat 16B, with all of these three models fine-tuned on the same SFT data.
Compared with both 7B dense models, DeepSeekMoE Chat 16B still achieves comparable or better performance on the majority of benchmarks with only 40% of computations.
</figcaption>
</figure>
</section>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Evaluations</h3>

<section id="S6.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5>

<div id="S6.SS2.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS2.SSS0.Px1.p1.1">μ •λ ¬ ν›„ DeepSeekMoE 16Bμ μ μ¬λ ¥μ„ κ²€μ¦ν•κΈ° μ„ν•΄ LLaMA2 7B, DeepSeek 7B λ° DeepSeekMoE 16Bμ— λ€ν•΄ κ°λ… λ―Έμ„Έ μ΅°μ •μ„ μν–‰ν–μΌλ©°, κ³µμ •μ„±μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ μ™„μ „ν λ™μΌν• λ―Έμ„Έ μ΅°μ • λ°μ΄ν„°λ¥Ό ν™μ©ν•λ‹¤. μ΄μ— λ€μ‘ν•μ—¬ LLaMA2 SFT 7B<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We use LLaMA2 SFT to distinguish from the official LLaMA2 ChatΒ <cite class="ltx_cite ltx_citemacro_citep">(Touvron etΒ al., <a class="ltx_ref" href="#bib.bib54" title="">2023b</a>)</cite> model.</span></span></span>, DeepSeek Chat 7B, DeepSeekMoE Chat 16B λ“± 3κ°μ μ±„ν… λ¨λΈμ„ κµ¬μ¶•ν•λ‹¤. κ·Έ ν›„, μ°λ¦¬λ” DeepSeekMoE Chat 16Bλ¥Ό κ΄‘λ²”μ„ν• λ‹¤μ΄μ¤νΈλ¦Ό νƒμ¤ν¬μ— κ±Έμ³ λ‹¤λ¥Έ λ‘ κ°μ λ°€μ§‘ μ±„ν… λ¨λΈ(FLOPμ μ•½ 2.5λ°°)κ³Ό λΉ„κµν•λ‹¤.</p>
</div>
</section>
<section id="S6.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5>

<div id="S6.SS2.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S6.SS2.SSS0.Px2.p1.1">ν‰κ°€ κ²°κ³Όλ” ν‘ <a class="ltx_ref" href="#S6.T5" title="Table 5 β€£ Evaluation Benchmarks. β€£ 6.1 Experimental Setup β€£ 6 Alignment for DeepSeekMoE 16B β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>μ— μ μ‹λμ–΄ μλ‹¤. μ°λ¦¬μ μ£Όμ” κ΄€μ°°μ€ λ‹¤μκ³Ό κ°™λ‹¤: (1) DeepSeekMoE Chat 16Bλ” κ³„μ‚°μ κ±°μ 40%λ¥Ό μ†λΉ„ν•μ§€λ§ μ–Έμ–΄ μ΄ν•΄ λ° μ¶”λ΅ (PIQA, ARC, BBH), κΈ°κ³„ λ…ν•΄(RACE), μν•™μ (GSM8K, MATH), μ§€μ‹ μ§‘μ•½μ  μ‘μ—…(TriviaQA, NaturalQuestions)μ— κ±Έμ³ 7B λ°€μ§‘ λ¨λΈκ³Ό λΉ„κµ κ°€λ¥ν• μ„±λ¥μ„ λ‹¬μ„±ν•λ‹¤. (2) μ½”λ“ μƒμ„± μ‘μ—…μ—μ„ DeepSeekMoE Chat 16Bλ” LLaMA2 SFT 7Bλ¥Ό μƒλ‹Ήν λ¥κ°€ν•μ—¬ HumanEval λ° MBPPμ—μ„ μ£Όλ©ν• λ§ν• κ°μ„ μ„ λ³΄μ—¬μ¤€λ‹¤. λν• λ”¥μ”½ μ±„ν… 7Bλ¥Ό λ¥κ°€ν•©λ‹λ‹¤. (3) MMLU, CEval λ° CMMLUλ¥Ό ν¬ν•¨ν•λ” κ°κ΄€μ‹ μ§μ μ‘λ‹µ λ²¤μΉλ§ν¬μ—μ„, DeepSeekMoE Chat 16Bλ” μ—¬μ „ν κΈ°λ³Έ λ¨λΈμ— λ€ν• κ΄€μ°°κ³Ό μΌμΉν•λ” DeepSeek Chat 7Bμ— λ’¤μ²μ§„λ‹¤(μ„Ήμ…<a class="ltx_ref" href="#S5.SS2.SSS1" title="5.2.1 Internal Comparison with DeepSeek 7B β€£ 5.2 Evaluations β€£ 5 Scaling up to DeepSeekMoE 16B β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5.2.1</span></a>). κ·Έλ¬λ‚ κ°λ… λ―Έμ„Έ μ΅°μ • ν›„ DeepSeekMoE 16Bμ™€ DeepSeek 7B μ‚¬μ΄μ μ„±λ¥ κ²©μ°¨κ°€ μΆν€μ§„λ‹¤λ” μ μ— μ£Όλ©ν•  ν•„μ”κ°€ μλ‹¤. (4) μ΄μ¤‘ μ–Έμ–΄ μ½”νΌμ¤μ— λ€ν• μ‚¬μ „ ν›λ ¨μΌλ΅λ¶€ν„° μ΄λ“μ„ μ–»μ€ DeepSeekMoE Chat 16Bλ” λ¨λ“  μ¤‘κµ­ λ²¤μΉλ§ν¬μ—μ„ LLaMA2 SFT 7Bλ¥Ό ν„μ €ν•κ² λ¥κ°€ν•λ‹¤. μ΄λ¬ν• κ²°κ³Όλ” μ¤‘κµ­μ–΄μ™€ μμ–΄ λ¨λ‘μ—μ„ DeepSeekMoE 16Bμ κ· ν• μ΅ν κΈ°λ¥μ„ λ³΄μ—¬μ£Όλ©° λ‹¤μ–‘ν• μ‹λ‚λ¦¬μ¤μ—μ„ λ‹¤μ–‘μ„±κ³Ό μ μ© κ°€λ¥μ„±μ„ ν–¥μƒμ‹ν‚¨λ‹¤. κ²°λ΅ μ μΌλ΅ μ±„ν… λ¨λΈμ— λ€ν• ν‰κ°€λ” μ •λ ¬μ μ΄μ μ„ μ–»μ„ μ μλ” DeepSeekMoE 16Bμ μ μ¬λ ¥μ„ κ°•μ΅°ν•κ³  κ³„μ‚°μ μ•½ 40%λ§ μ‚¬μ©ν•λ©΄μ„ λ°€μ§‘ λ¨λΈκ³Ό λΉ„κµν•  μ μλ” μ„±λ¥μ„ λ‹¬μ„±ν•λ” μΌκ΄€λ μ΄μ μ„ κ²€μ¦ν•λ‹¤.</p>
</div>
</section>
</section>
</section>
<section id="S7" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>DeepSeekMoE 145B Ongoing</h2>

<div id="S7.p1" class="ltx_para">
<p class="ltx_p" id="S7.p1.1">DeepSeekMoE 16Bμ λ›°μ–΄λ‚ μ„±λ¥μ— κ³ λ¬΄λμ–΄ DeepSeekMoEλ¥Ό 145Bλ΅ ν™•μ¥ν•κΈ° μ„ν• μλΉ„ λ…Έλ ¥μ„ λ” μν–‰ν•λ‹¤. μ΄ μ΄κΈ° μ—°κµ¬μ—μ„ DeepSeekMoE 145Bλ” 245B ν† ν°μ— λ€ν•΄ ν›λ ¨λμ§€λ§ GShard μ•„ν‚¤ν…μ²μ— λΉ„ν•΄ μΌκ΄€λ μ΄μ μ„ λ³΄μ—¬μ£Όμ—κ³  DeepSeek 67B(Dense)μ μ„±λ¥κ³Ό μΌμΉν•κ±°λ‚ μ΄κ³Όν•  κ°€λ¥μ„±μ„ λ³΄μ—¬μ£Όμ—λ‹¤. λ‚μ•„κ°€ DeepSeekMoE 145Bμ μµμΆ… λ²„μ „κ³Ό μ „μ κµμ΅μ΄ μ™„λ£λλ©΄ κ³µκ°λ„ ν•  κ³„νμ΄λ‹¤.</p>
</div>
<section id="S7.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Experimental Setup</h3>

<section id="S7.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Data and Tokenization.</h5>

<div id="S7.SS1.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS1.SSS0.Px1.p1.1">DeepSeekMoE 145Bμ κ²½μ° DeepSeekMoE 16Bμ™€ μ •ν™•ν λ™μΌν• ν›λ ¨ λ§λ­‰μΉ λ° ν† ν°ν™”κΈ°λ¥Ό μ‚¬μ©ν•λ©°, μ μΌν• μ°¨μ΄μ μ€ DeepSeekMoE 145Bκ°€ μ΄κΈ° μ—°κµ¬λ¥Ό μ„ν•΄ 245B ν† ν°μ— λ€ν•΄ ν›λ ¨λλ‹¤λ” κ²ƒμ΄λ‹¤.</p>
</div>
</section>
<section id="S7.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Model Settings.</h5>

<div id="S7.SS1.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS1.SSS0.Px2.p1.1">DeepSeekMoE 145Bμ κ²½μ° νΈλμ¤ν¬λ¨Έ μΈµμ μλ¥Ό 62κ°, νλ“  μ°¨μ›μ„ 4096κ°λ΅ μ„¤μ •ν•μ€λ‹¤. μ΄ 32κ°μ μ–΄ν…μ… ν—¤λ“λ¥Ό κ°–λ” λ‹¤μ¤‘ ν—¤λ“ μ–΄ν…μ… λ©”μ»¤λ‹μ¦μ„ μ‚¬μ©ν•λ©°, κ° ν—¤λ“μ μ°¨μ›μ€ 128μ΄λ‹¤. μ΄κΈ°ν™”λ” λ¨λ“  ν•™μµ κ°€λ¥ν• νλΌλ―Έν„°κ°€ 0.006μ ν‘μ¤€ νΈμ°¨λ΅ λλ¤ν•κ² μ΄κΈ°ν™”λλ‹¤. DeepSeekMoE 16Bμ—μ„μ™€ λ§μ°¬κ°€μ§€λ΅ μ²« λ²μ§Έ λ μ΄μ–΄λ¥Ό μ μ™Έν• λ¨λ“  FFNμ„ MoE λ μ΄μ–΄λ΅ λ€μ²΄ν•λ‹¤. κ° MoE λ μ΄μ–΄λ” 4λ…μ κ³µμ  μ „λ¬Έκ°€μ™€ 128λ…μ λΌμ°ν… μ „λ¬Έκ°€λ΅ κµ¬μ„±λλ©°, κ° μ „λ¬Έκ°€λ” ν‘μ¤€ FFNμ 0.125λ°° ν¬κΈ°μ΄λ‹¤. κ° ν† ν°μ€ μ΄ 4λ…μ κ³µμ  μ „λ¬Έκ°€μ™€ 128λ…μ λΌμ°ν…λ μ „λ¬Έκ°€ μ¤‘ 12λ…μ—κ² λΌμ°ν…λ©λ‹λ‹¤. μ΄λ¬ν• κµ¬μ„± ν•μ—μ„, DeepSeekMoE 145λ” μ•½ 144.6Bμ μ΄ νλΌλ―Έν„°λ¥Ό κ°€μ§€λ©°, ν™μ„±ν™”λ νλΌλ―Έν„°μ μλ” μ•½ 22.2Bμ΄λ‹¤.</p>
</div>
</section>
<section id="S7.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Settings.</h5>

<div id="S7.SS1.SSS0.Px3.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS1.SSS0.Px3.p1.4">Hyper-parametersκ°€ <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S7.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S7.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><msub id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml"><mi id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2.cmml">Ξ²</mi><mn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1"><eq id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.1"></eq><apply id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.1.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2.cmml" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.2">π›½</ci><cn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.1.m1.1c">\beta_{1}=0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.95" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.2.m2.1"><semantics id="S7.SS1.SSS0.Px3.p1.2.m2.1a"><mrow id="S7.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.cmml"><msub id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml"><mi id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2.cmml">Ξ²</mi><mn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.2.m2.1b"><apply id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1"><eq id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.1"></eq><apply id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.1.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2">subscript</csymbol><ci id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2.cmml" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.2">π›½</ci><cn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.2.m2.1c">\beta_{2}=0.95</annotation></semantics></math>, <math alttext="\mathrm{weight\_decay}=0.1" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.3.m3.1"><semantics id="S7.SS1.SSS0.Px3.p1.3.m3.1a"><mrow id="S7.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.cmml"><mrow id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml"><mi id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2.cmml">weight</mi><mo id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1" lspace="0em" rspace="0em" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1.cmml">β€‹</mo><mi id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1a" lspace="0em" rspace="0em" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1.cmml">β€‹</mo><mi id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4.cmml">decay</mi></mrow><mo id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.3.m3.1b"><apply id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1"><eq id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.1"></eq><apply id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2"><times id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.1"></times><ci id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.2">weight</ci><ci id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.3">_</ci><ci id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4.cmml" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.2.4">decay</ci></apply><cn id="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.3.m3.1c">\mathrm{weight\_decay}=0.1</annotation></semantics></math>λ΅ μ„¤μ •λ AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="#bib.bib36" title="">2019</a>)</cite>λ¥Ό μ±„μ©ν•λ‹¤. DeepSeekMoE 145Bμ μλΉ„ μ—°κµ¬λ¥Ό μ„ν•΄ μ›λ°μ—… λ° μƒμ ν•™μµλ¥  μ¤μΌ€μ¤„λ¬λ¥Ό μ‚¬μ©ν•λ‹¤. μ²μμ—, ν•™μµλ¥ μ€ μ²μ 2K λ‹¨κ³„ λ™μ• 0μ—μ„ μµλ€κ°’κΉμ§€ μ„ ν•μ μΌλ΅ μ¦κ°€ν•λ‹¤. μ΄μ–΄μ„, λ‚λ¨Έμ§€ ν›λ ¨ κ³Όμ • λ™μ• ν•™μµλ¥ μ€ μΌμ •ν•κ² μ μ§€λλ‹¤. DeepSeekMoE 145Bμ— λ€ν• μµλ€ ν•™μµ μ†λ„λ” <math alttext="3.0\times 10^{-4}" class="ltx_Math" display="inline" id="S7.SS1.SSS0.Px3.p1.4.m4.1"><semantics id="S7.SS1.SSS0.Px3.p1.4.m4.1a"><mrow id="S7.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.cmml"><mn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml">3.0</mn><mo id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml">Γ—</mo><msup id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml"><mn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml"><mo id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3a" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml">β’</mo><mn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.SSS0.Px3.p1.4.m4.1b"><apply id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1"><times id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.1"></times><cn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml" type="float" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.2">3.0</cn><apply id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3">superscript</csymbol><cn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.2">10</cn><apply id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3"><minus id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.1.cmml" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3"></minus><cn id="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S7.SS1.SSS0.Px3.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.SSS0.Px3.p1.4.m4.1c">3.0\times 10^{-4}</annotation></semantics></math>λ΅ μ„¤μ •λκ³ , κ·Έλλ””μ–ΈνΈ ν΄λ¦¬ν•‘ κ·λ²”μ€ 1.0μΌλ΅ μ„¤μ •λλ‹¤. λ°°μΉ ν¬κΈ°λ” 4.5Kλ΅ μ„¤μ •λκ³ , μµλ€ μ‹ν€€μ¤ κΈΈμ΄κ°€ 4KμΈ κ²½μ°, κ°κ°μ νΈλ μ΄λ‹ λ°°μΉμ—λ” 18M ν† ν°μ΄ ν¬ν•¨λλ‹¤. μ°λ¦¬λ” DeepSeekMoE 145Bλ¥Ό 13,000λ‹¨κ³„ λ™μ• ν›λ ¨ν•μ—¬ 245B ν›λ ¨ ν† ν°μ„ λ‹¬μ„±ν•©λ‹λ‹¤. λν•, μ°λ¦¬λ” ν›λ ¨ μ¤‘μ— μ¤‘ν‡΄λ¥Ό μ‚¬μ©ν•μ§€ μ•μµλ‹λ‹¤. νμ΄ν”„λΌμΈ λ³‘λ ¬μ„±μ„ ν™μ©ν•μ—¬ λ¨λΈμ λ‹¤λ¥Έ κ³„μΈµμ„ λ‹¤λ¥Έ μ¥μΉμ— λ°°μΉν•λ©°, κ° κ³„μΈµμ— λ€ν•΄ λΌμ°ν…λ λ¨λ“  μ „λ¬Έκ°€κ°€ 4κ°μ μ¥μΉ(μ¦‰, λ°μ΄ν„° λ³‘λ ¬μ„±κ³Ό κ²°ν•©λ μ „λ¬Έκ°€ λ³‘λ ¬μ„±)μ— κ· μΌν•κ² λ°°μΉλ©λ‹λ‹¤. DeepSeekMoE 145Bμ— λ€ν•΄ μ „λ¬Έκ°€ λ³‘λ ¬μ„±μ„ μ‚¬μ©ν•κΈ° λ•λ¬Έμ— κ³„μ‚° λ³‘λ© ν„μƒμ„ μ¤„μ΄κΈ° μ„ν•΄ μ¥μΉ μμ¤€μ λ¶€ν• κ· ν•μ„ κ³ λ ¤ν•΄μ•Ό ν•λ‹¤. μ΄μ— λ€ν•΄ μ¥μΉ μμ¤€ κ· ν• κ³„μλ¥Ό 0.05λ΅ μ„¤μ •ν•μ—¬ μ¥μΉ κ°„ κ· ν• κ³„μ‚°μ„ κ¶μ¥ν•©λ‹λ‹¤. λν• λΌμ°ν… λ¶•κ΄΄λ¥Ό λ°©μ§€ν•κΈ° μ„ν•΄ μ—¬μ „ν 0.003μ μ‘μ€ μ „λ¬Έκ°€ μμ¤€μ κ· ν• κ³„μλ¥Ό μ„¤μ •ν–μµλ‹λ‹¤.</p>
</div>
</section>
<section id="S7.SS1.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Evaluation Benchmarks.</h5>

<div id="S7.SS1.SSS0.Px4.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS1.SSS0.Px4.p1.1">DeepSeekMoE 16Bμ— μ‚¬μ©λ κ²ƒκ³Ό μ •ν™•ν λ™μΌν• λ‚΄λ¶€ λ²¤μΉλ§ν¬μ— λ€ν•΄ DeepSeekMoE 145Bλ¥Ό ν‰κ°€ν•λ‹¤(<a class="ltx_ref" href="#S5.SS1.SSS3" title="5.1.3 Evaluation Benchmarks β€£ 5.1 Experimental Setup β€£ 5 Scaling up to DeepSeekMoE 16B β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">5.1.3</span></a> μ„Ήμ… μ°Έμ΅°).</p>
</div>
<figure id="S7.T6" class="ltx_table">
<table id="S7.T6.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S7.T6.9.1.1" class="ltx_tr">
<th id="S7.T6.9.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.1.1" class="ltx_text">
<span id="S7.T6.9.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.1.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Metric</span></span></span>
</span></span></th>
<th id="S7.T6.9.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.2.1" class="ltx_text">
<span id="S7.T6.9.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.2.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.2.1.1.1.1.1" class="ltx_text ltx_font_bold"># Shot</span></span></span>
</span></span></th>
<td id="S7.T6.9.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.3.1" class="ltx_text">
<span id="S7.T6.9.1.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.3.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.3.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeek</span></span></span>
<span id="S7.T6.9.1.1.3.1.1.2" class="ltx_tr">
<span id="S7.T6.9.1.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.3.1.1.2.1.1" class="ltx_text ltx_font_bold">67B (Dense)</span></span></span>
</span></span></td>
<td id="S7.T6.9.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.4.1" class="ltx_text">
<span id="S7.T6.9.1.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.4.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.4.1.1.1.1.1" class="ltx_text ltx_font_bold">GShard</span></span></span>
<span id="S7.T6.9.1.1.4.1.1.2" class="ltx_tr">
<span id="S7.T6.9.1.1.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.4.1.1.2.1.1" class="ltx_text ltx_font_bold">137B</span></span></span>
</span></span></td>
<td id="S7.T6.9.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.5.1" class="ltx_text">
<span id="S7.T6.9.1.1.5.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.5.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.5.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.5.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></span></span>
<span id="S7.T6.9.1.1.5.1.1.2" class="ltx_tr">
<span id="S7.T6.9.1.1.5.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.5.1.1.2.1.1" class="ltx_text ltx_font_bold">145B</span></span></span>
</span></span></td>
<td id="S7.T6.9.1.1.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.6.1" class="ltx_text">
<span id="S7.T6.9.1.1.6.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.T6.9.1.1.6.1.1.1" class="ltx_tr">
<span id="S7.T6.9.1.1.6.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.6.1.1.1.1.1" class="ltx_text ltx_font_bold">DeepSeekMoE 142B</span></span></span>
<span id="S7.T6.9.1.1.6.1.1.2" class="ltx_tr">
<span id="S7.T6.9.1.1.6.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.1.1.6.1.1.2.1.1" class="ltx_text ltx_font_bold">(Half Activated)</span></span></span>
</span></span></td>
</tr>
<tr id="S7.T6.9.2.2" class="ltx_tr">
<th id="S7.T6.9.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"># Total Params</th>
<th id="S7.T6.9.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">67.4B</td>
<td id="S7.T6.9.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">136.5B</td>
<td id="S7.T6.9.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">144.6B</td>
<td id="S7.T6.9.2.2.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">142.3B</td>
</tr>
<tr id="S7.T6.9.3.3" class="ltx_tr">
<th id="S7.T6.9.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"># Activated Params</th>
<th id="S7.T6.9.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.3.3.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">67.4B</td>
<td id="S7.T6.9.3.3.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">21.6B</td>
<td id="S7.T6.9.3.3.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">22.2B</td>
<td id="S7.T6.9.3.3.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">12.2B</td>
</tr>
<tr id="S7.T6.9.4.4" class="ltx_tr">
<th id="S7.T6.9.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">Relative Expert Size</th>
<th id="S7.T6.9.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.4.4.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</td>
<td id="S7.T6.9.4.4.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">1</td>
<td id="S7.T6.9.4.4.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0.125</td>
<td id="S7.T6.9.4.4.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">0.125</td>
</tr>
<tr id="S7.T6.9.5.5" class="ltx_tr">
<th id="S7.T6.9.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"># Experts</th>
<th id="S7.T6.9.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.5.5.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</td>
<td id="S7.T6.9.5.5.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">0 + 16</td>
<td id="S7.T6.9.5.5.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">4 + 128</td>
<td id="S7.T6.9.5.5.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2 + 128</td>
</tr>
<tr id="S7.T6.9.6.6" class="ltx_tr">
<th id="S7.T6.9.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"># Activated Experts</th>
<th id="S7.T6.9.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.6.6.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</td>
<td id="S7.T6.9.6.6.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">0 + 2</td>
<td id="S7.T6.9.6.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">4 + 12</td>
<td id="S7.T6.9.6.6.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2 + 6</td>
</tr>
<tr id="S7.T6.9.7.7" class="ltx_tr">
<th id="S7.T6.9.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">FLOPs per 4K Tokens</th>
<th id="S7.T6.9.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.7.7.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2057.5T</td>
<td id="S7.T6.9.7.7.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">572.7T</td>
<td id="S7.T6.9.7.7.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">585.6T</td>
<td id="S7.T6.9.7.7.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">374.6T</td>
</tr>
<tr id="S7.T6.9.8.8" class="ltx_tr">
<th id="S7.T6.9.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"># Training Tokens</th>
<th id="S7.T6.9.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.8.8.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
<td id="S7.T6.9.8.8.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
<td id="S7.T6.9.8.8.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
<td id="S7.T6.9.8.8.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">245B</td>
</tr>
<tr id="S7.T6.9.9.9" class="ltx_tr">
<th id="S7.T6.9.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">Pile&nbsp;(Loss.)</th>
<th id="S7.T6.9.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">N/A</th>
<td id="S7.T6.9.9.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">1.905</td>
<td id="S7.T6.9.9.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">1.961</td>
<td id="S7.T6.9.9.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.9.9.5.1" class="ltx_text ltx_font_bold">1.876</span></td>
<td id="S7.T6.9.9.9.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">1.888</td>
</tr>
<tr id="S7.T6.9.10.10" class="ltx_tr">
<th id="S7.T6.9.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="S7.T6.9.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.10.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">74.8</td>
<td id="S7.T6.9.10.10.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">72.0</td>
<td id="S7.T6.9.10.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.10.10.5.1" class="ltx_text ltx_font_bold">75.8</span></td>
<td id="S7.T6.9.10.10.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">74.9</td>
</tr>
<tr id="S7.T6.9.11.11" class="ltx_tr">
<th id="S7.T6.9.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="S7.T6.9.11.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.11.11.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">79.8</td>
<td id="S7.T6.9.11.11.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">77.6</td>
<td id="S7.T6.9.11.11.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.11.11.5.1" class="ltx_text ltx_font_bold">80.7</span></td>
<td id="S7.T6.9.11.11.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">80.2</td>
</tr>
<tr id="S7.T6.9.12.12" class="ltx_tr">
<th id="S7.T6.9.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="S7.T6.9.12.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.12.12.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">69.0</td>
<td id="S7.T6.9.12.12.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">64.0</td>
<td id="S7.T6.9.12.12.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.12.12.5.1" class="ltx_text ltx_font_bold">69.7</span></td>
<td id="S7.T6.9.12.12.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">67.9</td>
</tr>
<tr id="S7.T6.9.13.13" class="ltx_tr">
<th id="S7.T6.9.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="S7.T6.9.13.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.13.13.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.13.13.3.1" class="ltx_text ltx_font_bold">50.4</span></td>
<td id="S7.T6.9.13.13.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">45.8</td>
<td id="S7.T6.9.13.13.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">48.8</td>
<td id="S7.T6.9.13.13.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">49.0</td>
</tr>
<tr id="S7.T6.9.14.14" class="ltx_tr">
<th id="S7.T6.9.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="S7.T6.9.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.14.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.14.14.3.1" class="ltx_text ltx_font_bold">63.2</span></td>
<td id="S7.T6.9.14.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">59.2</td>
<td id="S7.T6.9.14.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">62.1</td>
<td id="S7.T6.9.14.14.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">59.5</td>
</tr>
<tr id="S7.T6.9.15.15" class="ltx_tr">
<th id="S7.T6.9.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="S7.T6.9.15.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.15.15.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.15.15.3.1" class="ltx_text ltx_font_bold">46.9</span></td>
<td id="S7.T6.9.15.15.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">43.5</td>
<td id="S7.T6.9.15.15.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">45.5</td>
<td id="S7.T6.9.15.15.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">42.6</td>
</tr>
<tr id="S7.T6.9.16.16" class="ltx_tr">
<th id="S7.T6.9.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">DROP&nbsp;(EM)</th>
<th id="S7.T6.9.16.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">1-shot</th>
<td id="S7.T6.9.16.16.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.16.16.3.1" class="ltx_text ltx_font_bold">27.5</span></td>
<td id="S7.T6.9.16.16.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">21.6</td>
<td id="S7.T6.9.16.16.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.16.16.5.1" class="ltx_text ltx_font_bold">27.8</span></td>
<td id="S7.T6.9.16.16.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">28.9</td>
</tr>
<tr id="S7.T6.9.17.17" class="ltx_tr">
<th id="S7.T6.9.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">GSM8K&nbsp;(EM)</th>
<th id="S7.T6.9.17.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">8-shot</th>
<td id="S7.T6.9.17.17.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.17.17.3.1" class="ltx_text ltx_font_bold">11.8</span></td>
<td id="S7.T6.9.17.17.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">6.4</td>
<td id="S7.T6.9.17.17.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.17.17.5.1" class="ltx_text ltx_font_bold">12.2</span></td>
<td id="S7.T6.9.17.17.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">13.8</td>
</tr>
<tr id="S7.T6.9.18.18" class="ltx_tr">
<th id="S7.T6.9.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">MATH&nbsp;(EM)</th>
<th id="S7.T6.9.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">4-shot</th>
<td id="S7.T6.9.18.18.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2.1</td>
<td id="S7.T6.9.18.18.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">1.6</td>
<td id="S7.T6.9.18.18.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.18.18.5.1" class="ltx_text ltx_font_bold">3.1</span></td>
<td id="S7.T6.9.18.18.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">2.8</td>
</tr>
<tr id="S7.T6.9.19.19" class="ltx_tr">
<th id="S7.T6.9.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="S7.T6.9.19.19.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.19.19.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.19.19.3.1" class="ltx_text ltx_font_bold">23.8</span></td>
<td id="S7.T6.9.19.19.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">17.7</td>
<td id="S7.T6.9.19.19.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">19.5</td>
<td id="S7.T6.9.19.19.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">23.2</td>
</tr>
<tr id="S7.T6.9.20.20" class="ltx_tr">
<th id="S7.T6.9.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="S7.T6.9.20.20.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">3-shot</th>
<td id="S7.T6.9.20.20.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.20.20.3.1" class="ltx_text ltx_font_bold">33.6</span></td>
<td id="S7.T6.9.20.20.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">27.6</td>
<td id="S7.T6.9.20.20.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.20.20.5.1" class="ltx_text ltx_font_bold">33.2</span></td>
<td id="S7.T6.9.20.20.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">32.0</td>
</tr>
<tr id="S7.T6.9.21.21" class="ltx_tr">
<th id="S7.T6.9.21.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="S7.T6.9.21.21.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.21.21.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">57.2</td>
<td id="S7.T6.9.21.21.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">52.5</td>
<td id="S7.T6.9.21.21.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.21.21.5.1" class="ltx_text ltx_font_bold">61.1</span></td>
<td id="S7.T6.9.21.21.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">59.8</td>
</tr>
<tr id="S7.T6.9.22.22" class="ltx_tr">
<th id="S7.T6.9.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="S7.T6.9.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.22.22.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">22.6</td>
<td id="S7.T6.9.22.22.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">19.0</td>
<td id="S7.T6.9.22.22.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.22.22.5.1" class="ltx_text ltx_font_bold">25.0</span></td>
<td id="S7.T6.9.22.22.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">23.5</td>
</tr>
<tr id="S7.T6.9.23.23" class="ltx_tr">
<th id="S7.T6.9.23.23.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">MMLU&nbsp;(Acc.)</th>
<th id="S7.T6.9.23.23.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.23.23.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.23.23.3.1" class="ltx_text ltx_font_bold">45.1</span></td>
<td id="S7.T6.9.23.23.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">26.3</td>
<td id="S7.T6.9.23.23.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">39.4</td>
<td id="S7.T6.9.23.23.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">37.5</td>
</tr>
<tr id="S7.T6.9.24.24" class="ltx_tr">
<th id="S7.T6.9.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">WinoGrande&nbsp;(Acc.)</th>
<th id="S7.T6.9.24.24.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.24.24.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">70.7</td>
<td id="S7.T6.9.24.24.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">67.6</td>
<td id="S7.T6.9.24.24.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.24.24.5.1" class="ltx_text ltx_font_bold">71.9</span></td>
<td id="S7.T6.9.24.24.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">70.8</td>
</tr>
<tr id="S7.T6.9.25.25" class="ltx_tr">
<th id="S7.T6.9.25.25.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">CLUEWSC&nbsp;(EM)</th>
<th id="S7.T6.9.25.25.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.25.25.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">69.1</td>
<td id="S7.T6.9.25.25.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">65.7</td>
<td id="S7.T6.9.25.25.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.25.25.5.1" class="ltx_text ltx_font_bold">71.9</span></td>
<td id="S7.T6.9.25.25.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;">72.6</td>
</tr>
<tr id="S7.T6.9.26.26" class="ltx_tr">
<th id="S7.T6.9.26.26.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">CEval&nbsp;(Acc.)</th>
<th id="S7.T6.9.26.26.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.26.26.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.26.26.3.1" class="ltx_text ltx_font_bold">40.3</span></td>
<td id="S7.T6.9.26.26.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">26.2</td>
<td id="S7.T6.9.26.26.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">37.1</td>
<td id="S7.T6.9.26.26.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">32.8</td>
</tr>
<tr id="S7.T6.9.27.27" class="ltx_tr">
<th id="S7.T6.9.27.27.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">CMMLU&nbsp;(Acc.)</th>
<th id="S7.T6.9.27.27.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">5-shot</th>
<td id="S7.T6.9.27.27.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.27.27.3.1" class="ltx_text ltx_font_bold">40.6</span></td>
<td id="S7.T6.9.27.27.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">25.4</td>
<td id="S7.T6.9.27.27.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">35.9</td>
<td id="S7.T6.9.27.27.6" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">31.9</td>
</tr>
<tr id="S7.T6.9.28.28" class="ltx_tr">
<th id="S7.T6.9.28.28.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">CHID&nbsp;(Acc.)</th>
<th id="S7.T6.9.28.28.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;">0-shot</th>
<td id="S7.T6.9.28.28.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">88.5</td>
<td id="S7.T6.9.28.28.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">86.9</td>
<td id="S7.T6.9.28.28.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S7.T6.9.28.28.5.1" class="ltx_text ltx_font_bold">90.3</span></td>
<td id="S7.T6.9.28.28.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">88.3</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">ν‘ 6:</span></figcaption>
Comparison among DeepSeek 67B (Dense) and MoE models at the scale of about 140B total parameters.
In the lines of β€# Expertsβ€ and β€# Activated Expertsβ€, <math id="S7.T6.5.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S7.T6.5.m1.1b"><mi id="S7.T6.5.m1.1.1" xref="S7.T6.5.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S7.T6.5.m1.1c"><ci id="S7.T6.5.m1.1.1.cmml" xref="S7.T6.5.m1.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.5.m1.1d">a</annotation></semantics></math> + <math id="S7.T6.6.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S7.T6.6.m2.1b"><mi id="S7.T6.6.m2.1.1" xref="S7.T6.6.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S7.T6.6.m2.1c"><ci id="S7.T6.6.m2.1.1.cmml" xref="S7.T6.6.m2.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.6.m2.1d">b</annotation></semantics></math> denotes <math id="S7.T6.7.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S7.T6.7.m3.1b"><mi id="S7.T6.7.m3.1.1" xref="S7.T6.7.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S7.T6.7.m3.1c"><ci id="S7.T6.7.m3.1.1.cmml" xref="S7.T6.7.m3.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.7.m3.1d">a</annotation></semantics></math> shared experts and <math id="S7.T6.8.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S7.T6.8.m4.1b"><mi id="S7.T6.8.m4.1.1" xref="S7.T6.8.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S7.T6.8.m4.1c"><ci id="S7.T6.8.m4.1.1.cmml" xref="S7.T6.8.m4.1.1">π‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T6.8.m4.1d">b</annotation></semantics></math> routed experts, respectively.
<span id="S7.T6.11.1" class="ltx_text ltx_font_bold">Bold</span> font indicates the best or near the best performance excluding the last column.
DeepSeekMoE 145B, and even DeepSeekMoE 142B (Half Activated) that has only a half of activated expert parameters, outperform GShard 137B by a large margin.
Moreover, with 28.5% of computations, DeepSeekMoE 145B achieves comparable performance with DeepSeek 67B.
</figcaption>
</figure>
</section>
</section>
<section id="S7.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Evaluations</h3>

<section id="S7.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5>

<div id="S7.SS2.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS2.SSS0.Px1.p1.1"><span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.1">DeepSeekMoE 145B</span> μ™Έμ—λ„ λΉ„κµλ¥Ό μ„ν•΄ μ„Έ κ°€μ§€ μ¶”κ°€ λ¨λΈμ„ κ³ λ ¤ν•λ‹¤. <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.2">DeepSeek 67B (Dense)</span>μ€ 67.4B μ΄ λ§¤κ° λ³€μλ¥Ό κ°€μ§„ dense λ¨λΈμ…λ‹λ‹¤ (λ¨λΈ λ° ν›λ ¨ μ„Έλ¶€ μ •λ³΄μ— λ€ν•΄ <cite class="ltx_cite ltx_citemacro_citet">DeepSeek-AI (<a class="ltx_ref" href="#bib.bib13" title="">2024</a>)</cite> μ°Έμ΅°). <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.3">GShard 137B</span>λ” DeepSeekMoE 145Bμ™€ λ™μΌν• μ¨κ²¨μ§„ μ°¨μ› λ° μΈµ μλ¥Ό κ³µμ ν•μ§€λ§ GShard μ•„ν‚¤ν…μ²λ¥Ό λ”°λ¥Έλ‹¤. DeepSeekMoE 145Bλ” κ³„μ‚° ν¨μ¨μ„±μ„ μ„ν•΄ κ° μ „λ¬Έκ°€μ μ¤‘κ°„ μ€λ‹‰ μ°¨μ›μ„ 64μ λ°°μλ΅ μ •λ ¬ν•λ―€λ΅ λ¨λΈ ν¬κΈ°λ” GShard 137Bλ³΄λ‹¤ 6% λ” ν¬λ‹¤. <span class="ltx_text ltx_font_bold" id="S7.SS2.SSS0.Px1.p1.1.4">DeepSeekMoE 142B(Half Activated)</span>λ” DeepSeekMoE 145Bμ™€ μ μ‚¬ν• μ•„ν‚¤ν…μ²λ¥Ό κ°–μ§€λ§, κ³µμ λ μ „λ¬Έκ°€ 2λ…λ§ ν¬ν•¨ν•κ³ , 128λ…μ λΌμ°ν…λ μ „λ¬Έκ°€ μ¤‘ 6λ…λ§μ΄ ν™μ„±ν™”λλ‹¤. DeepSeekMoE 145Bλ¥Ό ν¬ν•¨ν• λΉ„κµλ λ¨λ“  λ¨λΈμ΄ λ™μΌν• ν›λ ¨ μ½”νΌμ¤λ¥Ό κ³µμ ν•λ‹¤λ” μ μ€ μ£Όλ©ν•  λ§ν•λ‹¤. λν•, λΉ„κµμ λ¨λ“  MoE λ¨λΈμ€ μ²μλ¶€ν„° ν›λ ¨λκ³  λ™μΌν• ν›λ ¨ ν•μ΄νΌ-νλΌλ―Έν„°λ¥Ό κ³µμ ν•λ‹¤.</p>
</div>
</section>
<section id="S7.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5>

<div id="S7.SS2.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p" id="S7.SS2.SSS0.Px2.p1.1">ν‘ <a class="ltx_ref" href="#S7.T6" title="Table 6 β€£ Evaluation Benchmarks. β€£ 7.1 Experimental Setup β€£ 7 DeepSeekMoE 145B Ongoing β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>μ— μ μ‹λ ν‰κ°€ κ²°κ³Όλ΅λ¶€ν„° λ‹¤μκ³Ό κ°™μ€ κ΄€μ°° κ²°κ³Όλ¥Ό μ–»μ„ μ μλ‹¤. (1) λΉ„μ·ν• μ΄ νλΌλ―Έν„°μ™€ κ³„μ‚°μ„ κ°€μ§μ—λ„ λ¶κµ¬ν•κ³  DeepSeekMoE 145Bλ” GShard 137Bλ³΄λ‹¤ ν›¨μ”¬ μ°μν• μ„±λ¥μ„ λ³΄μ—¬ DeepSeekMoE μ•„ν‚¤ν…μ²μ μ¥μ μ„ λ‹¤μ‹ κ°•μ΅°ν•λ‹¤. (2) μ „μ²΄μ μΌλ΅, 28.5%μ κ³„μ‚°λ§μΌλ΅, DeepSeekMoE 145Bλ” DeepSeek 67B(Dense)μ™€ λΉ„κµ κ°€λ¥ν• μ„±λ¥μ„ λ‹¬μ„±ν•λ‹¤. DeepSeekMoE 16Bμ κ²°κ³Όμ™€ μΌμΉν•κ², DeepSeekMoE 145Bλ” μ–Έμ–΄ λ¨λΈλ§ λ° μ§€μ‹ μ§‘μ•½μ  μ‘μ—…μ—μ„ ν„μ €ν• κ°•μ μ„ λ‚νƒ€λ‚΄μ§€λ§ κ°κ΄€μ‹ μ‘μ—…μ—μ„λ” ν•κ³„κ°€ μλ‹¤. (3) λ” ν° κ·λ¨μ—μ„, DeepSeekMoE 142B(Half Activated)μ μ„±λ¥μ€ DeepSeekMoE 145Bλ΅λ¶€ν„° λ„λ¬΄ λ§μ΄ λ’¤μ²μ§€μ§€ μ•λ”λ‹¤. λν•, ν™μ„±ν™”λ μ „λ¬Έκ°€ λ§¤κ°λ³€μμ μ λ°λ§μ„ κ°€μ§€κ³  μμμ—λ„ λ¶κµ¬ν•κ³  DeepSeekMoE 142B(Half Activated)λ” μ—¬μ „ν DeepSeek 67B(Dense)μ μ„±λ¥κ³Ό 18.2%μ κ³„μ‚°λ§μΌλ΅ μΌμΉν•λ‹¤. λν• SectionΒ <a class="ltx_ref" href="#S4.SS5" title="4.5 Analysis on Expert Specialization β€£ 4 Validation Experiments β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">4.5</span></a>μ κ²°λ΅ κ³Ό μΌμΉν•λ” GShard 137Bλ¥Ό λ¥κ°€ν•λ‹¤.</p>
</div>
</section>
</section>
</section>
<section id="S8" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Related Work</h2>

<div id="S8.p1" class="ltx_para">
<p class="ltx_p" id="S8.p1.1">Mixture of Experts(MoE) κΈ°λ²•μ€ λ…λ¦½μ μΈ μ „λ¬Έκ°€ λ¨λ“λ΅ μ„λ΅ λ‹¤λ¥Έ μƒν”μ„ λ‹¤λ£¨κΈ° μ„ν•΄ <cite class="ltx_cite ltx_citemacro_citet">Jacobs etΒ al. (<a class="ltx_ref" href="#bib.bib26" title="">1991</a>); Jordan and Jacobs (<a class="ltx_ref" href="#bib.bib27" title="">1994</a>)</cite>μ— μν•΄ μ²μ μ μ•λλ‹¤. <cite class="ltx_cite ltx_citemacro_citet">Shazeer etΒ al. (<a class="ltx_ref" href="#bib.bib47" title="">2017</a>)</cite> μ–Έμ–΄ λ¨λΈ ν›λ ¨μ— MoEλ¥Ό λ„μ…ν•κ³  λ€κ·λ¨ LSTM κΈ°λ° <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and Schmidhuber, <a class="ltx_ref" href="#bib.bib23" title="">1997</a>)</cite> MoE λ¨λΈμ„ κµ¬μ¶•ν•λ‹¤. νΈλμ¤ν¬λ¨Έκ°€ NLPμ κ°€μ¥ μΈκΈ° μλ” μ•„ν‚¤ν…μ²κ°€ λλ©΄μ„ λ§μ€ μ‹λ„κ°€ νΈλμ¤ν¬λ¨Έμ—μ„ FFNμ„ MoE κ³„μΈµμΌλ΅ ν™•μ¥ν•μ—¬ MoE μ–Έμ–΄ λ¨λΈμ„ κµ¬μ¶•ν•λ‹¤. GShard<cite class="ltx_cite ltx_citemacro_citep">(Lepikhin etΒ al., <a class="ltx_ref" href="#bib.bib32" title="">2021</a>)</cite>μ™€ Switch Transformer<cite class="ltx_cite ltx_citemacro_citep">(Fedus etΒ al., <a class="ltx_ref" href="#bib.bib16" title="">2021</a>)</cite>λ” MoE μ–Έμ–΄ λ¨λΈμ„ λ§¤μ° ν° κ·λ¨λ΅ ν™•μ¥ν•κΈ° μ„ν•΄ ν•™μµ κ°€λ¥ν• top-2 λλ” top-1 λΌμ°ν… μ „λµμ„ μ‚¬μ©ν•λ” μ„ κµ¬μμ΄λ‹¤. Hash Layer <cite class="ltx_cite ltx_citemacro_citep">(Roller etΒ al., <a class="ltx_ref" href="#bib.bib42" title="">2021</a>)</cite>μ™€ StableMoE <cite class="ltx_cite ltx_citemacro_citep">(Dai etΒ al., <a class="ltx_ref" href="#bib.bib12" title="">2022b</a>)</cite>λ” λ³΄λ‹¤ μ•μ •μ μΈ λΌμ°ν…κ³Ό ν›λ ¨μ„ μ„ν•΄ κ³ μ •μ μΈ λΌμ°ν… μ „λµμ„ μ‚¬μ©ν•λ‹¤. <cite class="ltx_cite ltx_citemacro_citet">Zhou etΒ al. (<a class="ltx_ref" href="#bib.bib62" title="">2022</a>)</cite>λ” μ „λ¬Έκ°€ μ„ νƒ λΌμ°ν… μ „λµμ„ μ μ•ν•λ©°, μ—¬κΈ°μ„ κ° ν† ν°μ€ μ„λ΅ λ‹¤λ¥Έ μμ μ „λ¬Έκ°€μ—κ² ν• λ‹Ήλ  μ μλ‹¤. <cite class="ltx_cite ltx_citemacro_citet">Zoph (<a class="ltx_ref" href="#bib.bib63" title="">2022</a>)</cite>λ” MoE λ¨λΈμ ν›λ ¨ λ¶μ•μ •μ„±κ³Ό λ―Έμ„Έ μ΅°μ • μ–΄λ ¤μ›€ λ¬Έμ μ— μ΄μ μ„ λ§μ¶”κ³  μ΄λ¬ν• λ¬Έμ λ¥Ό κ·Ήλ³µν•κΈ° μ„ν• ST-MoEλ¥Ό μ μ•ν•λ‹¤. MoE μ•„ν‚¤ν…μ² λ° ν›λ ¨ μ „λµμ— λ€ν• μ—°κµ¬ μ™Έμ—λ„ μµκ·Ό λ‡ λ…„ λ™μ• κΈ°μ΅΄ MoE μ•„ν‚¤ν…μ²λ¥Ό κΈ°λ°μΌλ΅ ν•λ” μλ§μ€ λ€κ·λ¨ μ–Έμ–΄ λλ” λ©€ν‹°λ¨λ‹¬ λ¨λΈ <cite class="ltx_cite ltx_citemacro_citep">(Lin etΒ al., <a class="ltx_ref" href="#bib.bib34" title="">2021</a>; Du etΒ al., <a class="ltx_ref" href="#bib.bib14" title="">2022</a>; Ren etΒ al., <a class="ltx_ref" href="#bib.bib41" title="">2023</a>; Xue etΒ al., <a class="ltx_ref" href="#bib.bib58" title="">2023</a>)</cite>κ°€ μ¶ν„ν–λ‹¤. λ€μ²΄λ΅, μ΄μ „μ λ€λ¶€λ¶„μ MoE λ¨λΈμ€ μΆ…λμ μƒμ„-1 λλ” μƒμ„-2 λΌμ°ν… μ „λµμ„ κΈ°λ°μΌλ΅ ν•μ—¬ μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό κ°μ„ ν•  μ μλ” ν° μ—¬μ§€λ¥Ό λ‚¨κ²¨λ‘”λ‹¤. μ΄μ— μ €ν¬ DeepSeekMoE μ•„ν‚¤ν…μ²λ” μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό μµλ€ν• κ°μ„ ν•λ” κ²ƒμ„ λ©ν‘λ΅ ν•κ³  μμµλ‹λ‹¤.</p>
</div>
</section>
<section id="S9" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Conclusion</h2>

<div id="S9.p1" class="ltx_para">
<p class="ltx_p" id="S9.p1.1">λ³Έ λ…Όλ¬Έμ—μ„λ” MoE μ–Έμ–΄ λ¨λΈμ„ μ„ν• DeepSeekMoE μ•„ν‚¤ν…μ²λ¥Ό μ†κ°ν•κ³ , κ¶κ·Ήμ μΈ μ „λ¬Έκ°€ μ „λ¬Έν™”λ¥Ό λ‹¬μ„±ν•λ” κ²ƒμ„ λ©ν‘λ΅ ν•λ‹¤. μ„Έλ¶„ν™”λ μ „λ¬Έκ°€ λ¶„ν• κ³Ό κ³µμ λ μ „λ¬Έκ°€ λ¶„λ¦¬λ¥Ό ν†µν•΄ DeepSeekMoEλ” κΈ°μ΅΄μ MoE μ•„ν‚¤ν…μ²μ— λΉ„ν•΄ ν›¨μ”¬ λ” λ†’μ€ μ „λ¬Έκ°€ μ „λ¬Έν™”μ™€ μ„±λ¥μ„ λ‹¬μ„±ν•λ‹¤. 2B λ§¤κ°λ³€μμ μ λ‹Ήν• μ²™λ„λ΅ μ‹μ‘ν•μ—¬ DeepSeekMoEμ μ¥μ μ„ κ²€μ¦ν•μ—¬ MoE λ¨λΈμ μƒν• μ„±λ¥μ— μ ‘κ·Όν•λ” λ¥λ ¥μ„ μ…μ¦ν•λ‹¤. λν• DeepSeekMoEκ°€ GShardλ³΄λ‹¤ μ „λ¬Έκ°€ μ „λ¬Έν™” μμ¤€μ΄ λ†’λ‹¤λ” μ‹¤μ¦μ  μ¦κ±°λ¥Ό μ κ³µν•λ‹¤.</p>
</div>
<div id="S9.p2" class="ltx_para">
<p class="ltx_p" id="S9.p2.1">λ” ν° κ·λ¨μ 16B μ΄ λ§¤κ°λ³€μκΉμ§€ ν™•μ¥ν•μ—¬ 2T ν† ν°μ—μ„ DeepSeekMoE 16Bλ¥Ό ν›λ ¨ν•κ³  μ•½ 40%μ κ³„μ‚°μΌλ΅ DeepSeek 7B λ° LLaMA2 7Bμ™€ λΉ„κµν•  μ μλ” λ›°μ–΄λ‚ μ„±λ¥μ„ λ³΄μ—¬μ¤€λ‹¤. λν•, DeepSeekMoE 16Bλ¥Ό κΈ°λ°μΌλ΅ MoE μ±„ν… λ¨λΈμ„ κµ¬μ„±ν•κΈ° μ„ν• μ •λ ¬μ„ μ„ν•΄ κ°λ… λ―Έμ„Έ μ΅°μ •μ„ μν–‰ν•μ—¬ μ μ‘μ„±κ³Ό λ²”μ©μ„±μ„ μ¶”κ°€λ΅ λ³΄μ—¬μ¤€λ‹¤. λν• DeepSeekMoEλ¥Ό 145B λ§¤κ°λ³€μλ΅ ν™•μ¥ν•κΈ° μ„ν• μλΉ„ νƒμƒ‰μ„ μν–‰ν•λ‹¤. μ°λ¦¬λ” DeepSeekMoE 145Bκ°€ μ—¬μ „ν GShard μ•„ν‚¤ν…μ²μ— λΉ„ν•΄ μƒλ‹Ήν• μ΄μ μ„ μ μ§€ν•λ‹¤λ” κ²ƒμ„ λ°κ²¬ν–μΌλ©°, 28.5%(μ‹¬μ§€μ–΄ 18.2%)μ κ³„μ‚°λ§μ„ μ‚¬μ©ν•μ—¬ DeepSeek 67Bμ™€ μ μ‚¬ν• μ„±λ¥μ„ λ³΄μ—¬μ¤€λ‹¤.</p>
</div>
<div id="S9.p3" class="ltx_para">
<p class="ltx_p" id="S9.p3.1">μ—°κµ¬ λ©μ μ„ μ„ν•΄, μ°λ¦¬λ” 40GBμ λ©”λ¨λ¦¬λ¥Ό κ°€μ§„ λ‹¨μΌ GPUμ— λ°°ν¬λ  μ μλ” DeepSeekMoE 16Bμ λ¨λΈ μ²΄ν¬ν¬μΈνΈλ¥Ό λ€μ¤‘μ—κ² κ³µκ°ν•λ‹¤. μ°λ¦¬λ” μ΄ μ‘μ—…μ΄ ν•™κ³„μ™€ μ‚°μ—…κ³„ λ¨λ‘μ—κ² κ·€μ¤‘ν• ν†µμ°°λ ¥μ„ μ κ³µν•κ³  λ€κ·λ¨ μ–Έμ–΄ λ¨λΈμ κ°€μ†ν™”λ λ°μ „μ— κΈ°μ—¬ν•κΈ°λ¥Ό λ°”λ€λ‹¤.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography" lang="en">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Almazrouei et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
E.&nbsp;Almazrouei, H.&nbsp;Alobeidli, A.&nbsp;Alshamsi, A.&nbsp;Cappelli, R.&nbsp;Cojocaru, M.&nbsp;Debbah, E.&nbsp;Goffinet, D.&nbsp;Heslow, J.&nbsp;Launay, Q.&nbsp;Malartic, B.&nbsp;Noune, B.&nbsp;Pannier, and G.&nbsp;Penedo.

</span>
<span class="ltx_bibblock">Falcon-40B: an open large language model with state-of-the-art performance, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Artetxe et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
M.&nbsp;Artetxe, S.&nbsp;Bhosale, N.&nbsp;Goyal, T.&nbsp;Mihaylov, M.&nbsp;Ott, S.&nbsp;Shleifer, X.&nbsp;V. Lin, J.&nbsp;Du, S.&nbsp;Iyer, R.&nbsp;Pasunuru, G.&nbsp;Anantharaman, X.&nbsp;Li, S.&nbsp;Chen, H.&nbsp;Akin, M.&nbsp;Baines, L.&nbsp;Martin, X.&nbsp;Zhou, P.&nbsp;S. Koura, B.&nbsp;Oβ€™Horo, J.&nbsp;Wang, L.&nbsp;Zettlemoyer, M.&nbsp;T. Diab, Z.&nbsp;Kozareva, and V.&nbsp;Stoyanov.

</span>
<span class="ltx_bibblock">Efficient large scale language modeling with mixtures of experts.

</span>
<span class="ltx_bibblock">In Y.&nbsp;Goldberg, Z.&nbsp;Kozareva, and Y.&nbsp;Zhang, editors, <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing, EMNLP 2022, Abu Dhabi, United Arab Emirates, December 7-11, 2022</em>, pages 11699β€“11732. Association for Computational Linguistics, 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2022.EMNLP-MAIN.804" title="" class="ltx_ref">10.18653/V1/2022.EMNLP-MAIN.804</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2022.emnlp-main.804" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2022.emnlp-main.804</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Austin et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
J.&nbsp;Austin, A.&nbsp;Odena, M.&nbsp;Nye, M.&nbsp;Bosma, H.&nbsp;Michalewski, D.&nbsp;Dohan, E.&nbsp;Jiang, C.&nbsp;Cai, M.&nbsp;Terry, Q.&nbsp;Le, et&nbsp;al.

</span>
<span class="ltx_bibblock">Program synthesis with large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.07732</em>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
S.&nbsp;Biderman, H.&nbsp;Schoelkopf, Q.&nbsp;G. Anthony, H.&nbsp;Bradley, K.&nbsp;Oβ€™Brien, E.&nbsp;Hallahan, M.&nbsp;A. Khan, S.&nbsp;Purohit, U.&nbsp;S. Prashanth, E.&nbsp;Raff, A.&nbsp;Skowron, L.&nbsp;Sutawika, and O.&nbsp;van&nbsp;der Wal.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In A.&nbsp;Krause, E.&nbsp;Brunskill, K.&nbsp;Cho, B.&nbsp;Engelhardt, S.&nbsp;Sabato, and J.&nbsp;Scarlett, editors, <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning, ICML 2023, 23-29 July 2023, Honolulu, Hawaii, USA</em>, volume 202 of <em id="bib.bib4.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pages 2397β€“2430. PMLR, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v202/biderman23a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v202/biderman23a.html</a>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Y.&nbsp;Bisk, R.&nbsp;Zellers, R.&nbsp;L. Bras, J.&nbsp;Gao, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">PIQA: reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">The Thirty-Fourth AAAI Conference on Artificial Intelligence, AAAI 2020, The Thirty-Second Innovative Applications of Artificial Intelligence Conference, IAAI 2020, The Tenth AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI 2020, New York, NY, USA, February 7-12, 2020</em>, pages 7432β€“7439. AAAI Press, 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.1609/aaai.v34i05.6239" title="" class="ltx_ref">10.1609/aaai.v34i05.6239</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1609/aaai.v34i05.6239" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1609/aaai.v34i05.6239</a>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Black et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
S.&nbsp;Black, L.&nbsp;Gao, P.&nbsp;Wang, C.&nbsp;Leahy, and S.&nbsp;Biderman.

</span>
<span class="ltx_bibblock">GPT-Neo: Large Scale Autoregressive Language Modeling with Mesh-Tensorflow, Mar. 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.5281/zenodo.5297715" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.5281/zenodo.5297715</a>.

</span>
<span class="ltx_bibblock">If you use this misc, please cite it using these metadata.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
T.&nbsp;B. Brown, B.&nbsp;Mann, N.&nbsp;Ryder, M.&nbsp;Subbiah, J.&nbsp;Kaplan, P.&nbsp;Dhariwal, A.&nbsp;Neelakantan, P.&nbsp;Shyam, G.&nbsp;Sastry, A.&nbsp;Askell, S.&nbsp;Agarwal, A.&nbsp;Herbert-Voss, G.&nbsp;Krueger, T.&nbsp;Henighan, R.&nbsp;Child, A.&nbsp;Ramesh, D.&nbsp;M. Ziegler, J.&nbsp;Wu, C.&nbsp;Winter, C.&nbsp;Hesse, M.&nbsp;Chen, E.&nbsp;Sigler, M.&nbsp;Litwin, S.&nbsp;Gray, B.&nbsp;Chess, J.&nbsp;Clark, C.&nbsp;Berner, S.&nbsp;McCandlish, A.&nbsp;Radford, I.&nbsp;Sutskever, and D.&nbsp;Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.neurips.cc/paper/2020/hash/1457c0d6bfcb4967418bfb8ac142f64a-Abstract.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2020/hash/1457c0d6bfcb4967418bfb8ac142f64a-Abstract.html</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
M.&nbsp;Chen, J.&nbsp;Tworek, H.&nbsp;Jun, Q.&nbsp;Yuan, H.&nbsp;P. de&nbsp;Oliveira&nbsp;Pinto, J.&nbsp;Kaplan, H.&nbsp;Edwards, Y.&nbsp;Burda, N.&nbsp;Joseph, G.&nbsp;Brockman, A.&nbsp;Ray, R.&nbsp;Puri, G.&nbsp;Krueger, M.&nbsp;Petrov, H.&nbsp;Khlaaf, G.&nbsp;Sastry, P.&nbsp;Mishkin, B.&nbsp;Chan, S.&nbsp;Gray, N.&nbsp;Ryder, M.&nbsp;Pavlov, A.&nbsp;Power, L.&nbsp;Kaiser, M.&nbsp;Bavarian, C.&nbsp;Winter, P.&nbsp;Tillet, F.&nbsp;P. Such, D.&nbsp;Cummings, M.&nbsp;Plappert, F.&nbsp;Chantzis, E.&nbsp;Barnes, A.&nbsp;Herbert-Voss, W.&nbsp;H. Guss, A.&nbsp;Nichol, A.&nbsp;Paino, N.&nbsp;Tezak, J.&nbsp;Tang, I.&nbsp;Babuschkin, S.&nbsp;Balaji, S.&nbsp;Jain, W.&nbsp;Saunders, C.&nbsp;Hesse, A.&nbsp;N. Carr, J.&nbsp;Leike, J.&nbsp;Achiam, V.&nbsp;Misra, E.&nbsp;Morikawa, A.&nbsp;Radford, M.&nbsp;Knight, M.&nbsp;Brundage, M.&nbsp;Murati, K.&nbsp;Mayer, P.&nbsp;Welinder, B.&nbsp;McGrew, D.&nbsp;Amodei, S.&nbsp;McCandlish, I.&nbsp;Sutskever, and W.&nbsp;Zaremba.

</span>
<span class="ltx_bibblock">Evaluating large language models trained on code.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2107.03374, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2107.03374" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2107.03374</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
P.&nbsp;Clark, I.&nbsp;Cowhey, O.&nbsp;Etzioni, T.&nbsp;Khot, A.&nbsp;Sabharwal, C.&nbsp;Schoenick, and O.&nbsp;Tafjord.

</span>
<span class="ltx_bibblock">Think you have solved question answering? try arc, the AI2 reasoning challenge.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1803.05457, 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1803.05457" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1803.05457</a>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cobbe et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
K.&nbsp;Cobbe, V.&nbsp;Kosaraju, M.&nbsp;Bavarian, M.&nbsp;Chen, H.&nbsp;Jun, L.&nbsp;Kaiser, M.&nbsp;Plappert, J.&nbsp;Tworek, J.&nbsp;Hilton, R.&nbsp;Nakano, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training verifiers to solve math word problems.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.14168</em>, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2022a)</span>
<span class="ltx_bibblock">
D.&nbsp;Dai, L.&nbsp;Dong, Y.&nbsp;Hao, Z.&nbsp;Sui, B.&nbsp;Chang, and F.&nbsp;Wei.

</span>
<span class="ltx_bibblock">Knowledge neurons in pretrained transformers.

</span>
<span class="ltx_bibblock">In S.&nbsp;Muresan, P.&nbsp;Nakov, and A.&nbsp;Villavicencio, editors, <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 8493β€“8502. Association for Computational Linguistics, 2022a.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2022.ACL-LONG.581" title="" class="ltx_ref">10.18653/V1/2022.ACL-LONG.581</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2022.acl-long.581" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2022.acl-long.581</a>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2022b)</span>
<span class="ltx_bibblock">
D.&nbsp;Dai, L.&nbsp;Dong, S.&nbsp;Ma, B.&nbsp;Zheng, Z.&nbsp;Sui, B.&nbsp;Chang, and F.&nbsp;Wei.

</span>
<span class="ltx_bibblock">Stablemoe: Stable routing strategy for mixture of experts.

</span>
<span class="ltx_bibblock">In S.&nbsp;Muresan, P.&nbsp;Nakov, and A.&nbsp;Villavicencio, editors, <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 7085β€“7095. Association for Computational Linguistics, 2022b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2022.ACL-LONG.489" title="" class="ltx_ref">10.18653/V1/2022.ACL-LONG.489</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2022.acl-long.489" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2022.acl-long.489</a>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">DeepSeek-AI (2024)</span>
<span class="ltx_bibblock">
DeepSeek-AI.

</span>
<span class="ltx_bibblock">Deepseek llm: Scaling open-source language models with longtermism.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.02954</em>, 2024.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
N.&nbsp;Du, Y.&nbsp;Huang, A.&nbsp;M. Dai, S.&nbsp;Tong, D.&nbsp;Lepikhin, Y.&nbsp;Xu, M.&nbsp;Krikun, Y.&nbsp;Zhou, A.&nbsp;W. Yu, O.&nbsp;Firat, B.&nbsp;Zoph, L.&nbsp;Fedus, M.&nbsp;P. Bosma, Z.&nbsp;Zhou, T.&nbsp;Wang, Y.&nbsp;E. Wang, K.&nbsp;Webster, M.&nbsp;Pellat, K.&nbsp;Robinson, K.&nbsp;S. Meier-Hellstern, T.&nbsp;Duke, L.&nbsp;Dixon, K.&nbsp;Zhang, Q.&nbsp;V. Le, Y.&nbsp;Wu, Z.&nbsp;Chen, and C.&nbsp;Cui.

</span>
<span class="ltx_bibblock">Glam: Efficient scaling of language models with mixture-of-experts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</em>, volume 162 of <em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pages 5547β€“5569. PMLR, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v162/du22c.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v162/du22c.html</a>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dua et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
D.&nbsp;Dua, Y.&nbsp;Wang, P.&nbsp;Dasigi, G.&nbsp;Stanovsky, S.&nbsp;Singh, and M.&nbsp;Gardner.

</span>
<span class="ltx_bibblock">DROP: A reading comprehension benchmark requiring discrete reasoning over paragraphs.

</span>
<span class="ltx_bibblock">In J.&nbsp;Burstein, C.&nbsp;Doran, and T.&nbsp;Solorio, editors, <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, NAACL-HLT 2019, Minneapolis, MN, USA, June 2-7, 2019, Volume 1 (Long and Short Papers)</em>, pages 2368β€“2378. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/N19-1246" title="" class="ltx_ref">10.18653/V1/N19-1246</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/n19-1246" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/n19-1246</a>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fedus et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
W.&nbsp;Fedus, B.&nbsp;Zoph, and N.&nbsp;Shazeer.

</span>
<span class="ltx_bibblock">Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2101.03961, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2101.03961" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2101.03961</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
L.&nbsp;Gao, S.&nbsp;Biderman, S.&nbsp;Black, L.&nbsp;Golding, T.&nbsp;Hoppe, C.&nbsp;Foster, J.&nbsp;Phang, H.&nbsp;He, A.&nbsp;Thite, N.&nbsp;Nabeshima, et&nbsp;al.

</span>
<span class="ltx_bibblock">The Pile: An 800GB dataset of diverse text for language modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2101.00027</em>, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng and Liu (2023)</span>
<span class="ltx_bibblock">
X.&nbsp;Geng and H.&nbsp;Liu.

</span>
<span class="ltx_bibblock">Openllama: An open reproduction of llama, May 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://github.com/openlm-research/open_llama" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/openlm-research/open_llama</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harlap et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
A.&nbsp;Harlap, D.&nbsp;Narayanan, A.&nbsp;Phanishayee, V.&nbsp;Seshadri, N.&nbsp;R. Devanur, G.&nbsp;R. Ganger, and P.&nbsp;B. Gibbons.

</span>
<span class="ltx_bibblock">Pipedream: Fast and efficient pipeline parallel DNN training.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1806.03377, 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1806.03377" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1806.03377</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
D.&nbsp;Hendrycks, C.&nbsp;Burns, S.&nbsp;Basart, A.&nbsp;Zou, M.&nbsp;Mazeika, D.&nbsp;Song, and J.&nbsp;Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2009.03300</em>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
D.&nbsp;Hendrycks, C.&nbsp;Burns, S.&nbsp;Kadavath, A.&nbsp;Arora, S.&nbsp;Basart, E.&nbsp;Tang, D.&nbsp;Song, and J.&nbsp;Steinhardt.

</span>
<span class="ltx_bibblock">Measuring mathematical problem solving with the math dataset, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">High-Flyer (2023)</span>
<span class="ltx_bibblock">
High-Flyer.

</span>
<span class="ltx_bibblock">Hai-llm: An efficient and lightweight tool for training large models, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.high-flyer.cn/en/blog/hai-llm" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.high-flyer.cn/en/blog/hai-llm</a>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter and Schmidhuber (1997)</span>
<span class="ltx_bibblock">
S.&nbsp;Hochreiter and J.&nbsp;Schmidhuber.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Neural Computing</em>, 9(8):1735β€“1780, 1997.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1162/neco.1997.9.8.1735" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1162/neco.1997.9.8.1735</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
J.&nbsp;Hoffmann, S.&nbsp;Borgeaud, A.&nbsp;Mensch, E.&nbsp;Buchatskaya, T.&nbsp;Cai, E.&nbsp;Rutherford, D.&nbsp;de&nbsp;Las&nbsp;Casas, L.&nbsp;A. Hendricks, J.&nbsp;Welbl, A.&nbsp;Clark, T.&nbsp;Hennigan, E.&nbsp;Noland, K.&nbsp;Millican, G.&nbsp;van&nbsp;den Driessche, B.&nbsp;Damoc, A.&nbsp;Guy, S.&nbsp;Osindero, K.&nbsp;Simonyan, E.&nbsp;Elsen, J.&nbsp;W. Rae, O.&nbsp;Vinyals, and L.&nbsp;Sifre.

</span>
<span class="ltx_bibblock">Training compute-optimal large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2203.15556, 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/arXiv.2203.15556" title="" class="ltx_ref">10.48550/arXiv.2203.15556</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2203.15556" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2203.15556</a>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Y.&nbsp;Huang, Y.&nbsp;Bai, Z.&nbsp;Zhu, J.&nbsp;Zhang, J.&nbsp;Zhang, T.&nbsp;Su, J.&nbsp;Liu, C.&nbsp;Lv, Y.&nbsp;Zhang, J.&nbsp;Lei, et&nbsp;al.

</span>
<span class="ltx_bibblock">C-Eval: A multi-level multi-discipline chinese evaluation suite for foundation models.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.08322</em>, 2023.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jacobs et&nbsp;al. (1991)</span>
<span class="ltx_bibblock">
R.&nbsp;A. Jacobs, M.&nbsp;I. Jordan, S.&nbsp;J. Nowlan, and G.&nbsp;E. Hinton.

</span>
<span class="ltx_bibblock">Adaptive mixtures of local experts.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Neural Computing</em>, 3(1):79β€“87, 1991.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1162/neco.1991.3.1.79" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1162/neco.1991.3.1.79</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jordan and Jacobs (1994)</span>
<span class="ltx_bibblock">
M.&nbsp;I. Jordan and R.&nbsp;A. Jacobs.

</span>
<span class="ltx_bibblock">Hierarchical mixtures of experts and the EM algorithm.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Neural Computing</em>, 6(2):181β€“214, 1994.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1162/neco.1994.6.2.181" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1162/neco.1994.6.2.181</a>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
M.&nbsp;Joshi, E.&nbsp;Choi, D.&nbsp;Weld, and L.&nbsp;Zettlemoyer.

</span>
<span class="ltx_bibblock">triviaqa: A Large Scale Distantly Supervised Challenge Dataset for Reading Comprehension.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv e-prints</em>, art. arXiv:1705.03551, 2017.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Korthikanti et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
V.&nbsp;A. Korthikanti, J.&nbsp;Casper, S.&nbsp;Lym, L.&nbsp;McAfee, M.&nbsp;Andersch, M.&nbsp;Shoeybi, and B.&nbsp;Catanzaro.

</span>
<span class="ltx_bibblock">Reducing activation recomputation in large transformer models.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 5, 2023.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
T.&nbsp;Kwiatkowski, J.&nbsp;Palomaki, O.&nbsp;Redfield, M.&nbsp;Collins, A.&nbsp;Parikh, C.&nbsp;Alberti, D.&nbsp;Epstein, I.&nbsp;Polosukhin, M.&nbsp;Kelcey, J.&nbsp;Devlin, K.&nbsp;Lee, K.&nbsp;N. Toutanova, L.&nbsp;Jones, M.-W. Chang, A.&nbsp;Dai, J.&nbsp;Uszkoreit, Q.&nbsp;Le, and S.&nbsp;Petrov.

</span>
<span class="ltx_bibblock">Natural questions: a benchmark for question answering research.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association of Computational Linguistics</em>, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lai et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
G.&nbsp;Lai, Q.&nbsp;Xie, H.&nbsp;Liu, Y.&nbsp;Yang, and E.&nbsp;H. Hovy.

</span>
<span class="ltx_bibblock">RACE: large-scale reading comprehension dataset from examinations.

</span>
<span class="ltx_bibblock">In M.&nbsp;Palmer, R.&nbsp;Hwa, and S.&nbsp;Riedel, editors, <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing, EMNLP 2017, Copenhagen, Denmark, September 9-11, 2017</em>, pages 785β€“794. Association for Computational Linguistics, 2017.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/D17-1082" title="" class="ltx_ref">10.18653/V1/D17-1082</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/d17-1082" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/d17-1082</a>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lepikhin et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
D.&nbsp;Lepikhin, H.&nbsp;Lee, Y.&nbsp;Xu, D.&nbsp;Chen, O.&nbsp;Firat, Y.&nbsp;Huang, M.&nbsp;Krikun, N.&nbsp;Shazeer, and Z.&nbsp;Chen.

</span>
<span class="ltx_bibblock">Gshard: Scaling giant models with conditional computation and automatic sharding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations, ICLR 2021</em>. OpenReview.net, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=qrwe7XHTmYb" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=qrwe7XHTmYb</a>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
H.&nbsp;Li, Y.&nbsp;Zhang, F.&nbsp;Koto, Y.&nbsp;Yang, H.&nbsp;Zhao, Y.&nbsp;Gong, N.&nbsp;Duan, and T.&nbsp;Baldwin.

</span>
<span class="ltx_bibblock">CMMLU: Measuring massive multitask language understanding in Chinese.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.09212</em>, 2023.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
J.&nbsp;Lin, R.&nbsp;Men, A.&nbsp;Yang, C.&nbsp;Zhou, M.&nbsp;Ding, Y.&nbsp;Zhang, P.&nbsp;Wang, A.&nbsp;Wang, L.&nbsp;Jiang, X.&nbsp;Jia, J.&nbsp;Zhang, J.&nbsp;Zhang, X.&nbsp;Zou, Z.&nbsp;Li, X.&nbsp;Deng, J.&nbsp;Liu, J.&nbsp;Xue, H.&nbsp;Zhou, J.&nbsp;Ma, J.&nbsp;Yu, Y.&nbsp;Li, W.&nbsp;Lin, J.&nbsp;Zhou, J.&nbsp;Tang, and H.&nbsp;Yang.

</span>
<span class="ltx_bibblock">M6: A chinese multimodal pretrainer.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2103.00823, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2103.00823" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2103.00823</a>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
S.&nbsp;Lin, J.&nbsp;Hilton, and O.&nbsp;Evans.

</span>
<span class="ltx_bibblock">Truthfulqa: Measuring how models mimic human falsehoods.

</span>
<span class="ltx_bibblock">In S.&nbsp;Muresan, P.&nbsp;Nakov, and A.&nbsp;Villavicencio, editors, <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 3214β€“3252. Association for Computational Linguistics, 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2022.ACL-LONG.229" title="" class="ltx_ref">10.18653/V1/2022.ACL-LONG.229</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2022.acl-long.229" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2022.acl-long.229</a>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2019)</span>
<span class="ltx_bibblock">
I.&nbsp;Loshchilov and F.&nbsp;Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">7th International Conference on Learning Representations, ICLR 2019, New Orleans, LA, USA, May 6-9, 2019</em>. OpenReview.net, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=Bkg6RiCqY7" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=Bkg6RiCqY7</a>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayanan et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
D.&nbsp;Narayanan, M.&nbsp;Shoeybi, J.&nbsp;Casper, P.&nbsp;LeGresley, M.&nbsp;Patwary, V.&nbsp;Korthikanti, D.&nbsp;Vainbrand, P.&nbsp;Kashinkunti, J.&nbsp;Bernauer, B.&nbsp;Catanzaro, et&nbsp;al.

</span>
<span class="ltx_bibblock">Efficient large-scale language model training on gpu clusters using megatron-lm.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference for High Performance Computing, Networking, Storage and Analysis</em>, pages 1β€“15, 2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">GPT-4 technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2303.08774, 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/arXiv.2303.08774" title="" class="ltx_ref">10.48550/arXiv.2303.08774</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2303.08774" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2303.08774</a>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajbhandari et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
S.&nbsp;Rajbhandari, J.&nbsp;Rasley, O.&nbsp;Ruwase, and Y.&nbsp;He.

</span>
<span class="ltx_bibblock">Zero: memory optimizations toward training trillion parameter models.

</span>
<span class="ltx_bibblock">In C.&nbsp;Cuicchi, I.&nbsp;Qualters, and W.&nbsp;T. Kramer, editors, <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference for High Performance Computing, Networking, Storage and Analysis, SC 2020, Virtual Event / Atlanta, Georgia, USA, November 9-19, 2020</em>, page&nbsp;20. IEEE/ACM, 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.1109/SC41405.2020.00024" title="" class="ltx_ref">10.1109/SC41405.2020.00024</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1109/SC41405.2020.00024" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/SC41405.2020.00024</a>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajbhandari et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
S.&nbsp;Rajbhandari, C.&nbsp;Li, Z.&nbsp;Yao, M.&nbsp;Zhang, R.&nbsp;Y. Aminabadi, A.&nbsp;A. Awan, J.&nbsp;Rasley, and Y.&nbsp;He.

</span>
<span class="ltx_bibblock">Deepspeed-moe: Advancing mixture-of-experts inference and training to power next-generation AI scale.

</span>
<span class="ltx_bibblock">In K.&nbsp;Chaudhuri, S.&nbsp;Jegelka, L.&nbsp;Song, C.&nbsp;SzepesvΓ΅ri, G.&nbsp;Niu, and S.&nbsp;Sabato, editors, <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</em>, volume 162 of <em id="bib.bib40.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pages 18332β€“18346. PMLR, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v162/rajbhandari22a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v162/rajbhandari22a.html</a>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
X.&nbsp;Ren, P.&nbsp;Zhou, X.&nbsp;Meng, X.&nbsp;Huang, Y.&nbsp;Wang, W.&nbsp;Wang, P.&nbsp;Li, X.&nbsp;Zhang, A.&nbsp;Podolskiy, G.&nbsp;Arshinov, A.&nbsp;Bout, I.&nbsp;Piontkovskaya, J.&nbsp;Wei, X.&nbsp;Jiang, T.&nbsp;Su, Q.&nbsp;Liu, and J.&nbsp;Yao.

</span>
<span class="ltx_bibblock">Pangu-<math id="bib.bib41.1.m1.1" class="ltx_Math" alttext="\Sigma" display="inline"><semantics id="bib.bib41.1.m1.1a"><mi mathvariant="normal" id="bib.bib41.1.m1.1.1" xref="bib.bib41.1.m1.1.1.cmml">Ξ£</mi><annotation-xml encoding="MathML-Content" id="bib.bib41.1.m1.1b"><ci id="bib.bib41.1.m1.1.1.cmml" xref="bib.bib41.1.m1.1.1">Ξ£</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib41.1.m1.1c">\Sigma</annotation></semantics></math>: Towards trillion parameter language model with sparse heterogeneous computing.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.2.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2303.10845, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2303.10845" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2303.10845</a>.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roller et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
S.&nbsp;Roller, S.&nbsp;Sukhbaatar, A.&nbsp;Szlam, and J.&nbsp;Weston.

</span>
<span class="ltx_bibblock">Hash layers for large sparse models.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2106.04426, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2106.04426" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2106.04426</a>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakaguchi et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
K.&nbsp;Sakaguchi, R.&nbsp;L. Bras, C.&nbsp;Bhagavatula, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">Winogrande: An adversarial winograd schema challenge at scale, 2019.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Scao et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
T.&nbsp;L. Scao, A.&nbsp;Fan, C.&nbsp;Akiki, E.&nbsp;Pavlick, S.&nbsp;Ilic, D.&nbsp;Hesslow, R.&nbsp;CastagnΓ©, A.&nbsp;S. Luccioni, F.&nbsp;Yvon, M.&nbsp;GallΓ©, J.&nbsp;Tow, A.&nbsp;M. Rush, S.&nbsp;Biderman, A.&nbsp;Webson, P.&nbsp;S. Ammanamanchi, T.&nbsp;Wang, B.&nbsp;Sagot, N.&nbsp;Muennighoff, A.&nbsp;V. del Moral, O.&nbsp;Ruwase, R.&nbsp;Bawden, S.&nbsp;Bekman, A.&nbsp;McMillan-Major, I.&nbsp;Beltagy, H.&nbsp;Nguyen, L.&nbsp;Saulnier, S.&nbsp;Tan, P.&nbsp;O. Suarez, V.&nbsp;Sanh, H.&nbsp;LaurenΓ§on, Y.&nbsp;Jernite, J.&nbsp;Launay, M.&nbsp;Mitchell, C.&nbsp;Raffel, A.&nbsp;Gokaslan, A.&nbsp;Simhi, A.&nbsp;Soroa, A.&nbsp;F. Aji, A.&nbsp;Alfassy, A.&nbsp;Rogers, A.&nbsp;K. Nitzav, C.&nbsp;Xu, C.&nbsp;Mou, C.&nbsp;Emezue, C.&nbsp;Klamm, C.&nbsp;Leong, D.&nbsp;van Strien, D.&nbsp;I. Adelani, and et&nbsp;al.

</span>
<span class="ltx_bibblock">BLOOM: A 176b-parameter open-access multilingual language model.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2211.05100, 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/ARXIV.2211.05100" title="" class="ltx_ref">10.48550/ARXIV.2211.05100</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2211.05100" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2211.05100</a>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et&nbsp;al. (2016)</span>
<span class="ltx_bibblock">
R.&nbsp;Sennrich, B.&nbsp;Haddow, and A.&nbsp;Birch.

</span>
<span class="ltx_bibblock">Neural machine translation of rare words with subword units.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics, ACL 2016, August 7-12, 2016, Berlin, Germany, Volume 1: Long Papers</em>. The Association for Computer Linguistics, 2016.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/P16-1162" title="" class="ltx_ref">10.18653/V1/P16-1162</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/p16-1162" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/p16-1162</a>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2019)</span>
<span class="ltx_bibblock">
N.&nbsp;Shazeer.

</span>
<span class="ltx_bibblock">Fast transformer decoding: One write-head is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1911.02150, 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1911.02150" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1911.02150</a>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
N.&nbsp;Shazeer, A.&nbsp;Mirhoseini, K.&nbsp;Maziarz, A.&nbsp;Davis, Q.&nbsp;V. Le, G.&nbsp;E. Hinton, and J.&nbsp;Dean.

</span>
<span class="ltx_bibblock">Outrageously large neural networks: The sparsely-gated mixture-of-experts layer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">5th International Conference on Learning Representations, ICLR 2017</em>. OpenReview.net, 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=B1ckMDqlg" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=B1ckMDqlg</a>.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
S.&nbsp;Shen, L.&nbsp;Hou, Y.&nbsp;Zhou, N.&nbsp;Du, S.&nbsp;Longpre, J.&nbsp;Wei, H.&nbsp;W. Chung, B.&nbsp;Zoph, W.&nbsp;Fedus, X.&nbsp;Chen, T.&nbsp;Vu, Y.&nbsp;Wu, W.&nbsp;Chen, A.&nbsp;Webson, Y.&nbsp;Li, V.&nbsp;Zhao, H.&nbsp;Yu, K.&nbsp;Keutzer, T.&nbsp;Darrell, and D.&nbsp;Zhou.

</span>
<span class="ltx_bibblock">Flan-moe: Scaling instruction-finetuned language models with sparse mixture of experts.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2305.14705, 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/ARXIV.2305.14705" title="" class="ltx_ref">10.48550/ARXIV.2305.14705</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2305.14705" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2305.14705</a>.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shoeybi et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
M.&nbsp;Shoeybi, M.&nbsp;Patwary, R.&nbsp;Puri, P.&nbsp;LeGresley, J.&nbsp;Casper, and B.&nbsp;Catanzaro.

</span>
<span class="ltx_bibblock">Megatron-lm: Training multi-billion parameter language models using model parallelism.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.08053</em>, 2019.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suzgun et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
M.&nbsp;Suzgun, N.&nbsp;Scales, N.&nbsp;SchΓ¤rli, S.&nbsp;Gehrmann, Y.&nbsp;Tay, H.&nbsp;W. Chung, A.&nbsp;Chowdhery, Q.&nbsp;V. Le, E.&nbsp;H. Chi, D.&nbsp;Zhou, et&nbsp;al.

</span>
<span class="ltx_bibblock">Challenging big-bench tasks and whether chain-of-thought can solve them.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.09261</em>, 2022.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tillet et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
P.&nbsp;Tillet, H.&nbsp;T. Kung, and D.&nbsp;Cox.

</span>
<span class="ltx_bibblock">Triton: An intermediate language and compiler for tiled neural network computations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 3rd ACM SIGPLAN International Workshop on Machine Learning and Programming Languages</em>, MAPL 2019, page 10β€“19, New York, NY, USA, 2019. Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450367196.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.1145/3315508.3329973" title="" class="ltx_ref">10.1145/3315508.3329973</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1145/3315508.3329973" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3315508.3329973</a>.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Together-AI (2023)</span>
<span class="ltx_bibblock">
Together-AI.

</span>
<span class="ltx_bibblock">Redpajama-data: An open source recipe to reproduce llama training dataset, April 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://github.com/togethercomputer/RedPajama-Data" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/togethercomputer/RedPajama-Data</a>.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
H.&nbsp;Touvron, T.&nbsp;Lavril, G.&nbsp;Izacard, X.&nbsp;Martinet, M.&nbsp;Lachaux, T.&nbsp;Lacroix, B.&nbsp;RoziΓ¨re, N.&nbsp;Goyal, E.&nbsp;Hambro, F.&nbsp;Azhar, A.&nbsp;Rodriguez, A.&nbsp;Joulin, E.&nbsp;Grave, and G.&nbsp;Lample.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2302.13971, 2023a.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/arXiv.2302.13971" title="" class="ltx_ref">10.48550/arXiv.2302.13971</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2302.13971" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2302.13971</a>.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
H.&nbsp;Touvron, L.&nbsp;Martin, K.&nbsp;Stone, P.&nbsp;Albert, A.&nbsp;Almahairi, Y.&nbsp;Babaei, N.&nbsp;Bashlykov, S.&nbsp;Batra, P.&nbsp;Bhargava, S.&nbsp;Bhosale, D.&nbsp;Bikel, L.&nbsp;Blecher, C.&nbsp;Canton-Ferrer, M.&nbsp;Chen, G.&nbsp;Cucurull, D.&nbsp;Esiobu, J.&nbsp;Fernandes, J.&nbsp;Fu, W.&nbsp;Fu, B.&nbsp;Fuller, C.&nbsp;Gao, V.&nbsp;Goswami, N.&nbsp;Goyal, A.&nbsp;Hartshorn, S.&nbsp;Hosseini, R.&nbsp;Hou, H.&nbsp;Inan, M.&nbsp;Kardas, V.&nbsp;Kerkez, M.&nbsp;Khabsa, I.&nbsp;Kloumann, A.&nbsp;Korenev, P.&nbsp;S. Koura, M.&nbsp;Lachaux, T.&nbsp;Lavril, J.&nbsp;Lee, D.&nbsp;Liskovich, Y.&nbsp;Lu, Y.&nbsp;Mao, X.&nbsp;Martinet, T.&nbsp;Mihaylov, P.&nbsp;Mishra, I.&nbsp;Molybog, Y.&nbsp;Nie, A.&nbsp;Poulton, J.&nbsp;Reizenstein, R.&nbsp;Rungta, K.&nbsp;Saladi, A.&nbsp;Schelten, R.&nbsp;Silva, E.&nbsp;M. Smith, R.&nbsp;Subramanian, X.&nbsp;E. Tan, B.&nbsp;Tang, R.&nbsp;Taylor, A.&nbsp;Williams, J.&nbsp;X. Kuan, P.&nbsp;Xu, Z.&nbsp;Yan, I.&nbsp;Zarov, Y.&nbsp;Zhang, A.&nbsp;Fan, M.&nbsp;Kambadur, S.&nbsp;Narang, A.&nbsp;Rodriguez, R.&nbsp;Stojnic, S.&nbsp;Edunov, and T.&nbsp;Scialom.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2307.09288, 2023b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.48550/arXiv.2307.09288" title="" class="ltx_ref">10.48550/arXiv.2307.09288</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.48550/arXiv.2307.09288" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.48550/arXiv.2307.09288</a>.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
A.&nbsp;Vaswani, N.&nbsp;Shazeer, N.&nbsp;Parmar, J.&nbsp;Uszkoreit, L.&nbsp;Jones, A.&nbsp;N. Gomez, L.&nbsp;Kaiser, and I.&nbsp;Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 30: Annual Conference on Neural Information Processing Systems 2017</em>, pages 5998β€“6008, 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html</a>.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Komatsuzaki (2021)</span>
<span class="ltx_bibblock">
B.&nbsp;Wang and A.&nbsp;Komatsuzaki.

</span>
<span class="ltx_bibblock">GPT-J-6B: A 6 Billion Parameter Autoregressive Language Model.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/kingoflolz/mesh-transformer-jax" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/kingoflolz/mesh-transformer-jax</a>, May 2021.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
L.&nbsp;Xu, H.&nbsp;Hu, X.&nbsp;Zhang, L.&nbsp;Li, C.&nbsp;Cao, Y.&nbsp;Li, Y.&nbsp;Xu, K.&nbsp;Sun, D.&nbsp;Yu, C.&nbsp;Yu, Y.&nbsp;Tian, Q.&nbsp;Dong, W.&nbsp;Liu, B.&nbsp;Shi, Y.&nbsp;Cui, J.&nbsp;Li, J.&nbsp;Zeng, R.&nbsp;Wang, W.&nbsp;Xie, Y.&nbsp;Li, Y.&nbsp;Patterson, Z.&nbsp;Tian, Y.&nbsp;Zhang, H.&nbsp;Zhou, S.&nbsp;Liu, Z.&nbsp;Zhao, Q.&nbsp;Zhao, C.&nbsp;Yue, X.&nbsp;Zhang, Z.&nbsp;Yang, K.&nbsp;Richardson, and Z.&nbsp;Lan.

</span>
<span class="ltx_bibblock">CLUE: A chinese language understanding evaluation benchmark.

</span>
<span class="ltx_bibblock">In D.&nbsp;Scott, N.&nbsp;Bel, and C.&nbsp;Zong, editors, <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 28th International Conference on Computational Linguistics, COLING 2020, Barcelona, Spain (Online), December 8-13, 2020</em>, pages 4762β€“4772. International Committee on Computational Linguistics, 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/2020.COLING-MAIN.419" title="" class="ltx_ref">10.18653/V1/2020.COLING-MAIN.419</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/2020.coling-main.419" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2020.coling-main.419</a>.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xue et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
F.&nbsp;Xue, Z.&nbsp;Zheng, Y.&nbsp;Fu, J.&nbsp;Ni, Z.&nbsp;Zheng, W.&nbsp;Zhou, and Y.&nbsp;You.

</span>
<span class="ltx_bibblock">Openmoe: Open mixture-of-experts language models.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/XueFuzhao/OpenMoE" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/XueFuzhao/OpenMoE</a>, 2023.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
R.&nbsp;Zellers, A.&nbsp;Holtzman, Y.&nbsp;Bisk, A.&nbsp;Farhadi, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">HellaSwag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock">In A.&nbsp;Korhonen, D.&nbsp;R. Traum, and L.&nbsp;MΓ rquez, editors, <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 57th Conference of the Association for Computational Linguistics, ACL 2019, Florence, Italy, July 28- August 2, 2019, Volume 1: Long Papers</em>, pages 4791β€“4800. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/v1/p19-1472" title="" class="ltx_ref">10.18653/v1/p19-1472</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/p19-1472" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/p19-1472</a>.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
S.&nbsp;Zhang, S.&nbsp;Roller, N.&nbsp;Goyal, M.&nbsp;Artetxe, M.&nbsp;Chen, S.&nbsp;Chen, C.&nbsp;Dewan, M.&nbsp;Diab, X.&nbsp;Li, X.&nbsp;V. Lin, T.&nbsp;Mihaylov, M.&nbsp;Ott, S.&nbsp;Shleifer, K.&nbsp;Shuster, D.&nbsp;Simig, P.&nbsp;S. Koura, A.&nbsp;Sridhar, T.&nbsp;Wang, and L.&nbsp;Zettlemoyer.

</span>
<span class="ltx_bibblock">Opt: Open pre-trained transformer language models, 2022.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
C.&nbsp;Zheng, M.&nbsp;Huang, and A.&nbsp;Sun.

</span>
<span class="ltx_bibblock">Chid: A large-scale chinese idiom dataset for cloze test.

</span>
<span class="ltx_bibblock">In A.&nbsp;Korhonen, D.&nbsp;R. Traum, and L.&nbsp;MΓ rquez, editors, <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 57th Conference of the Association for Computational Linguistics, ACL 2019, Florence, Italy, July 28- August 2, 2019, Volume 1: Long Papers</em>, pages 778β€“787. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https:/doi.org/10.18653/V1/P19-1075" title="" class="ltx_ref">10.18653/V1/P19-1075</a>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.18653/v1/p19-1075" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/p19-1075</a>.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Y.&nbsp;Zhou, T.&nbsp;Lei, H.&nbsp;Liu, N.&nbsp;Du, Y.&nbsp;Huang, V.&nbsp;Zhao, A.&nbsp;M. Dai, Z.&nbsp;Chen, Q.&nbsp;V. Le, and J.&nbsp;Laudon.

</span>
<span class="ltx_bibblock">Mixture-of-experts with expert choice routing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://papers.nips.cc/paper_files/paper/2022/hash/2f00ecd787b432c1d36f3de9800728eb-Abstract-Conference.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://papers.nips.cc/paper_files/paper/2022/hash/2f00ecd787b432c1d36f3de9800728eb-Abstract-Conference.html</a>.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zoph (2022)</span>
<span class="ltx_bibblock">
B.&nbsp;Zoph.

</span>
<span class="ltx_bibblock">Designing effective sparse expert models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">IEEE International Parallel and Distributed Processing Symposium, IPDPS Workshops 2022, Lyon, France, May 30 - June 3, 2022</em>, page 1044. IEEE, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1109/IPDPSW55747.2022.00171" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/IPDPSW55747.2022.00171</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Ax1" class="ltx_appendix" lang="en">
<h2 class="ltx_title ltx_title_appendix">Appendices</h2>

</section>
<section id="A1" class="ltx_appendix" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Overview of Hyper-Parameters</h2>

<div id="A1.p1" class="ltx_para">
<p class="ltx_p" id="A1.p1.1">μ°λ¦¬λ” ν‘ <a class="ltx_ref" href="#A1.T7" title="Table 7 β€£ Appendix A Overview of Hyper-Parameters β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>μ—μ„ λ‹¤μ–‘ν• ν¬κΈ°μ— κ±Έμ³ DeepSeekMoEμ— λ€ν• ν•μ΄νΌ-νλΌλ―Έν„°μ κ°μ”λ¥Ό μ μ‹ν•λ‹¤.</p>
</div>
<figure id="A1.T7" class="ltx_table">
<table id="A1.T7.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T7.1.1.1" class="ltx_tr">
<th id="A1.T7.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.1.1" class="ltx_text" style="font-size:80%;"># Params</span></th>
<th id="A1.T7.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.2.1" class="ltx_text" style="font-size:80%;"># Layers</span></th>
<th id="A1.T7.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.3.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.3.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Hidden</span></span>
<span id="A1.T7.1.1.1.3.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Size</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.4.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.4.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.4.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"># Attn</span></span>
<span id="A1.T7.1.1.1.4.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Heads</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.5.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.5.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.5.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.5.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"># Shared</span></span>
<span id="A1.T7.1.1.1.5.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.5.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Experts</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.6.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.6.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.6.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.6.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"># Routed</span></span>
<span id="A1.T7.1.1.1.6.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.6.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Experts</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.7.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.7.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.7.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.7.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Relative</span></span>
<span id="A1.T7.1.1.1.7.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.7.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Expert Size</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.8.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.8.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.8.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.8.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Sequence</span></span>
<span id="A1.T7.1.1.1.8.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.8.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Length</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.9.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.9.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.9.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.9.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Batch Size</span></span>
<span id="A1.T7.1.1.1.9.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.9.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">(Sequence)</span></span>
</span></span></th>
<th id="A1.T7.1.1.1.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.1.1.10.1" class="ltx_text" style="font-size:80%;">
<span id="A1.T7.1.1.1.10.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T7.1.1.1.10.1.1.1" class="ltx_tr">
<span id="A1.T7.1.1.1.10.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Learning</span></span>
<span id="A1.T7.1.1.1.10.1.1.2" class="ltx_tr">
<span id="A1.T7.1.1.1.10.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Rate</span></span>
</span></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T7.1.2.1" class="ltx_tr">
<td id="A1.T7.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.1.1" class="ltx_text" style="font-size:80%;">&nbsp;&nbsp;&nbsp;&nbsp;2.0B</span></td>
<td id="A1.T7.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.2.1" class="ltx_text" style="font-size:80%;">9</span></td>
<td id="A1.T7.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.3.1" class="ltx_text" style="font-size:80%;">1280</span></td>
<td id="A1.T7.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.4.1" class="ltx_text" style="font-size:80%;">10</span></td>
<td id="A1.T7.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.5.1" class="ltx_text" style="font-size:80%;">1</span></td>
<td id="A1.T7.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.6.1" class="ltx_text" style="font-size:80%;">63 (7 activated)</span></td>
<td id="A1.T7.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.7.1" class="ltx_text" style="font-size:80%;">0.25</span></td>
<td id="A1.T7.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.8.1" class="ltx_text" style="font-size:80%;">2048</span></td>
<td id="A1.T7.1.2.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.9.1" class="ltx_text" style="font-size:80%;">2048</span></td>
<td id="A1.T7.1.2.1.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.2.1.10.1" class="ltx_text" style="font-size:80%;">1.08e-3</span></td>
</tr>
<tr id="A1.T7.1.3.2" class="ltx_tr">
<td id="A1.T7.1.3.2.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.1.1" class="ltx_text" style="font-size:80%;">&nbsp;&nbsp;16.4B</span></td>
<td id="A1.T7.1.3.2.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.2.1" class="ltx_text" style="font-size:80%;">28</span></td>
<td id="A1.T7.1.3.2.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.3.1" class="ltx_text" style="font-size:80%;">2048</span></td>
<td id="A1.T7.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.4.1" class="ltx_text" style="font-size:80%;">16</span></td>
<td id="A1.T7.1.3.2.5" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.5.1" class="ltx_text" style="font-size:80%;">2</span></td>
<td id="A1.T7.1.3.2.6" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.6.1" class="ltx_text" style="font-size:80%;">64 (6 activated)</span></td>
<td id="A1.T7.1.3.2.7" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.7.1" class="ltx_text" style="font-size:80%;">0.25</span></td>
<td id="A1.T7.1.3.2.8" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.8.1" class="ltx_text" style="font-size:80%;">4096</span></td>
<td id="A1.T7.1.3.2.9" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.9.1" class="ltx_text" style="font-size:80%;">4608</span></td>
<td id="A1.T7.1.3.2.10" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.3.2.10.1" class="ltx_text" style="font-size:80%;">&nbsp;&nbsp;4.2e-4</span></td>
</tr>
<tr id="A1.T7.1.4.3" class="ltx_tr">
<td id="A1.T7.1.4.3.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.1.1" class="ltx_text" style="font-size:80%;">144.6B</span></td>
<td id="A1.T7.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.2.1" class="ltx_text" style="font-size:80%;">62</span></td>
<td id="A1.T7.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.3.1" class="ltx_text" style="font-size:80%;">4096</span></td>
<td id="A1.T7.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.4.1" class="ltx_text" style="font-size:80%;">32</span></td>
<td id="A1.T7.1.4.3.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.5.1" class="ltx_text" style="font-size:80%;">4</span></td>
<td id="A1.T7.1.4.3.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.6.1" class="ltx_text" style="font-size:80%;">128 (12 activated)</span></td>
<td id="A1.T7.1.4.3.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.7.1" class="ltx_text" style="font-size:80%;">0.125</span></td>
<td id="A1.T7.1.4.3.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.8.1" class="ltx_text" style="font-size:80%;">4096</span></td>
<td id="A1.T7.1.4.3.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.9.1" class="ltx_text" style="font-size:80%;">4608</span></td>
<td id="A1.T7.1.4.3.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="A1.T7.1.4.3.10.1" class="ltx_text" style="font-size:80%;">&nbsp;&nbsp;3.0e-4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 7: </span>
Overview of hyper-parameters for DeepSeekMoE across various sizes.
The relative expert size is in comparison to a standard FFN.
</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Comparing DeepSeekMoE with Larger Models</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.4" class="ltx_p">Comparisons among DeepSeekMoE, GShard<math id="A2.p1.1.m1.1" class="ltx_Math" alttext="\times 1.2" display="inline"><semantics id="A2.p1.1.m1.1a"><mrow id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mi id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.p1.1.m1.1.1.1" xref="A2.p1.1.m1.1.1.1.cmml">Γ—</mo><mn id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><times id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.p1.1.m1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">\times 1.2</annotation></semantics></math>, and GShard<math id="A2.p1.2.m2.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="A2.p1.2.m2.1a"><mrow id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mi id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.p1.2.m2.1.1.1" xref="A2.p1.2.m2.1.1.1.cmml">Γ—</mo><mn id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><times id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1"></times><csymbol cd="latexml" id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2">absent</csymbol><cn type="float" id="A2.p1.2.m2.1.1.3.cmml" xref="A2.p1.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">\times 1.5</annotation></semantics></math> are shown in Table&nbsp;<a href="#A2.T8" title="Table 8 β€£ Appendix B Comparing DeepSeekMoE with Larger Models β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. Comparisons among DeepSeekMoE, Dense<math id="A2.p1.3.m3.1" class="ltx_Math" alttext="\times 4" display="inline"><semantics id="A2.p1.3.m3.1a"><mrow id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml"><mi id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.p1.3.m3.1.1.1" xref="A2.p1.3.m3.1.1.1.cmml">Γ—</mo><mn id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1"><times id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1.1"></times><csymbol cd="latexml" id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2">absent</csymbol><cn type="integer" id="A2.p1.3.m3.1.1.3.cmml" xref="A2.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">\times 4</annotation></semantics></math>, and Dense<math id="A2.p1.4.m4.1" class="ltx_Math" alttext="\times 16" display="inline"><semantics id="A2.p1.4.m4.1a"><mrow id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml"><mi id="A2.p1.4.m4.1.1.2" xref="A2.p1.4.m4.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.p1.4.m4.1.1.1" xref="A2.p1.4.m4.1.1.1.cmml">Γ—</mo><mn id="A2.p1.4.m4.1.1.3" xref="A2.p1.4.m4.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><apply id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1"><times id="A2.p1.4.m4.1.1.1.cmml" xref="A2.p1.4.m4.1.1.1"></times><csymbol cd="latexml" id="A2.p1.4.m4.1.1.2.cmml" xref="A2.p1.4.m4.1.1.2">absent</csymbol><cn type="integer" id="A2.p1.4.m4.1.1.3.cmml" xref="A2.p1.4.m4.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">\times 16</annotation></semantics></math> are shown in Table&nbsp;<a href="#A2.T9" title="Table 9 β€£ Appendix B Comparing DeepSeekMoE with Larger Models β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<figure id="A2.T8" class="ltx_table">
<table id="A2.T8.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T8.2.2" class="ltx_tr">
<th id="A2.T8.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.2.3.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="A2.T8.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.2.4.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="A2.T8.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.1.1.1.1" class="ltx_text ltx_font_bold">GShard<math id="A2.T8.1.1.1.1.m1.1" class="ltx_Math" alttext="\times 1.2" display="inline"><semantics id="A2.T8.1.1.1.1.m1.1a"><mrow id="A2.T8.1.1.1.1.m1.1.1" xref="A2.T8.1.1.1.1.m1.1.1.cmml"><mi id="A2.T8.1.1.1.1.m1.1.1.2" xref="A2.T8.1.1.1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T8.1.1.1.1.m1.1.1.1" xref="A2.T8.1.1.1.1.m1.1.1.1.cmml">Γ—</mo><mn id="A2.T8.1.1.1.1.m1.1.1.3" xref="A2.T8.1.1.1.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T8.1.1.1.1.m1.1b"><apply id="A2.T8.1.1.1.1.m1.1.1.cmml" xref="A2.T8.1.1.1.1.m1.1.1"><times id="A2.T8.1.1.1.1.m1.1.1.1.cmml" xref="A2.T8.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T8.1.1.1.1.m1.1.1.2.cmml" xref="A2.T8.1.1.1.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.T8.1.1.1.1.m1.1.1.3.cmml" xref="A2.T8.1.1.1.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T8.1.1.1.1.m1.1c">\times 1.2</annotation></semantics></math></span></td>
<td id="A2.T8.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.2.2.1" class="ltx_text ltx_font_bold">GShard<math id="A2.T8.2.2.2.1.m1.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="A2.T8.2.2.2.1.m1.1a"><mrow id="A2.T8.2.2.2.1.m1.1.1" xref="A2.T8.2.2.2.1.m1.1.1.cmml"><mi id="A2.T8.2.2.2.1.m1.1.1.2" xref="A2.T8.2.2.2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T8.2.2.2.1.m1.1.1.1" xref="A2.T8.2.2.2.1.m1.1.1.1.cmml">Γ—</mo><mn id="A2.T8.2.2.2.1.m1.1.1.3" xref="A2.T8.2.2.2.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T8.2.2.2.1.m1.1b"><apply id="A2.T8.2.2.2.1.m1.1.1.cmml" xref="A2.T8.2.2.2.1.m1.1.1"><times id="A2.T8.2.2.2.1.m1.1.1.1.cmml" xref="A2.T8.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T8.2.2.2.1.m1.1.1.2.cmml" xref="A2.T8.2.2.2.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.T8.2.2.2.1.m1.1.1.3.cmml" xref="A2.T8.2.2.2.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T8.2.2.2.1.m1.1c">\times 1.5</annotation></semantics></math></span></td>
<td id="A2.T8.2.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.2.5.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="A2.T8.2.3.1" class="ltx_tr">
<th id="A2.T8.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th id="A2.T8.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.2</td>
<td id="A2.T8.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.5</td>
<td id="A2.T8.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr id="A2.T8.2.4.2" class="ltx_tr">
<th id="A2.T8.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th id="A2.T8.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.4.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="A2.T8.2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="A2.T8.2.4.2.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr id="A2.T8.2.5.3" class="ltx_tr">
<th id="A2.T8.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th id="A2.T8.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.5.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="A2.T8.2.5.3.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="A2.T8.2.5.3.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr id="A2.T8.2.6.4" class="ltx_tr">
<th id="A2.T8.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th id="A2.T8.2.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.6.4.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.3B</td>
<td id="A2.T8.2.6.4.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.8B</td>
<td id="A2.T8.2.6.4.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.9B</td>
</tr>
<tr id="A2.T8.2.7.5" class="ltx_tr">
<th id="A2.T8.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th id="A2.T8.2.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.7.5.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.28B</td>
<td id="A2.T8.2.7.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.35B</td>
<td id="A2.T8.2.7.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.24B</td>
</tr>
<tr id="A2.T8.2.8.6" class="ltx_tr">
<th id="A2.T8.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th id="A2.T8.2.8.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.8.6.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T8.2.8.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T8.2.8.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr id="A2.T8.2.9.7" class="ltx_tr">
<th id="A2.T8.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Pile&nbsp;(Loss)</th>
<th id="A2.T8.2.9.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T8.2.9.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.824</td>
<td id="A2.T8.2.9.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.9.7.4.1" class="ltx_text ltx_font_bold">1.808</span></td>
<td id="A2.T8.2.9.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.9.7.5.1" class="ltx_text ltx_font_bold">1.808</span></td>
</tr>
<tr id="A2.T8.2.10.8" class="ltx_tr">
<th id="A2.T8.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="A2.T8.2.10.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.10.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">53.7</td>
<td id="A2.T8.2.10.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">54.4</td>
<td id="A2.T8.2.10.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.10.8.5.1" class="ltx_text ltx_font_bold">54.8</span></td>
</tr>
<tr id="A2.T8.2.11.9" class="ltx_tr">
<th id="A2.T8.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="A2.T8.2.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.11.9.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.8</td>
<td id="A2.T8.2.11.9.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.1</td>
<td id="A2.T8.2.11.9.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.11.9.5.1" class="ltx_text ltx_font_bold">72.3</span></td>
</tr>
<tr id="A2.T8.2.12.10" class="ltx_tr">
<th id="A2.T8.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="A2.T8.2.12.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.12.10.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">46.8</td>
<td id="A2.T8.2.12.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">47.3</td>
<td id="A2.T8.2.12.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.12.10.5.1" class="ltx_text ltx_font_bold">49.4</span></td>
</tr>
<tr id="A2.T8.2.13.11" class="ltx_tr">
<th id="A2.T8.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="A2.T8.2.13.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.13.11.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
<td id="A2.T8.2.13.11.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.13.11.4.1" class="ltx_text ltx_font_bold">34.1</span></td>
<td id="A2.T8.2.13.11.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.13.11.5.1" class="ltx_text ltx_font_bold">34.3</span></td>
</tr>
<tr id="A2.T8.2.14.12" class="ltx_tr">
<th id="A2.T8.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="A2.T8.2.14.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T8.2.14.12.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">43.7</td>
<td id="A2.T8.2.14.12.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.14.12.4.1" class="ltx_text ltx_font_bold">46.4</span></td>
<td id="A2.T8.2.14.12.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">44.0</td>
</tr>
<tr id="A2.T8.2.15.13" class="ltx_tr">
<th id="A2.T8.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="A2.T8.2.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T8.2.15.13.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.9</td>
<td id="A2.T8.2.15.13.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.15.13.4.1" class="ltx_text ltx_font_bold">32.4</span></td>
<td id="A2.T8.2.15.13.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
</tr>
<tr id="A2.T8.2.16.14" class="ltx_tr">
<th id="A2.T8.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="A2.T8.2.16.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T8.2.16.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">3.7</td>
<td id="A2.T8.2.16.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">3.0</td>
<td id="A2.T8.2.16.14.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.16.14.5.1" class="ltx_text ltx_font_bold">4.9</span></td>
</tr>
<tr id="A2.T8.2.17.15" class="ltx_tr">
<th id="A2.T8.2.17.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="A2.T8.2.17.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td id="A2.T8.2.17.15.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.4</td>
<td id="A2.T8.2.17.15.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.17.15.4.1" class="ltx_text ltx_font_bold">2.6</span></td>
<td id="A2.T8.2.17.15.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.2</td>
</tr>
<tr id="A2.T8.2.18.16" class="ltx_tr">
<th id="A2.T8.2.18.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="A2.T8.2.18.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T8.2.18.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">15.2</td>
<td id="A2.T8.2.18.16.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">15.7</td>
<td id="A2.T8.2.18.16.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.18.16.5.1" class="ltx_text ltx_font_bold">16.6</span></td>
</tr>
<tr id="A2.T8.2.19.17" class="ltx_tr">
<th id="A2.T8.2.19.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="A2.T8.2.19.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T8.2.19.17.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">4.5</td>
<td id="A2.T8.2.19.17.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">4.7</td>
<td id="A2.T8.2.19.17.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T8.2.19.17.5.1" class="ltx_text ltx_font_bold">5.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8:</span></figcaption>
Comparison between DeepSeekMoE and larger GShard models.
</figcaption>
</figure>
<figure id="A2.T9" class="ltx_table">
<table id="A2.T9.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T9.2.2" class="ltx_tr">
<th id="A2.T9.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.2.3.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="A2.T9.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.2.4.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="A2.T9.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.1.1.1.1" class="ltx_text ltx_font_bold">Dense<math id="A2.T9.1.1.1.1.m1.1" class="ltx_Math" alttext="\times 4" display="inline"><semantics id="A2.T9.1.1.1.1.m1.1a"><mrow id="A2.T9.1.1.1.1.m1.1.1" xref="A2.T9.1.1.1.1.m1.1.1.cmml"><mi id="A2.T9.1.1.1.1.m1.1.1.2" xref="A2.T9.1.1.1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T9.1.1.1.1.m1.1.1.1" xref="A2.T9.1.1.1.1.m1.1.1.1.cmml">Γ—</mo><mn id="A2.T9.1.1.1.1.m1.1.1.3" xref="A2.T9.1.1.1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.1.1.1.1.m1.1b"><apply id="A2.T9.1.1.1.1.m1.1.1.cmml" xref="A2.T9.1.1.1.1.m1.1.1"><times id="A2.T9.1.1.1.1.m1.1.1.1.cmml" xref="A2.T9.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T9.1.1.1.1.m1.1.1.2.cmml" xref="A2.T9.1.1.1.1.m1.1.1.2">absent</csymbol><cn type="integer" id="A2.T9.1.1.1.1.m1.1.1.3.cmml" xref="A2.T9.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.1.1.1.1.m1.1c">\times 4</annotation></semantics></math></span></td>
<td id="A2.T9.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.2.2.1" class="ltx_text ltx_font_bold">Dense<math id="A2.T9.2.2.2.1.m1.1" class="ltx_Math" alttext="\times 16" display="inline"><semantics id="A2.T9.2.2.2.1.m1.1a"><mrow id="A2.T9.2.2.2.1.m1.1.1" xref="A2.T9.2.2.2.1.m1.1.1.cmml"><mi id="A2.T9.2.2.2.1.m1.1.1.2" xref="A2.T9.2.2.2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T9.2.2.2.1.m1.1.1.1" xref="A2.T9.2.2.2.1.m1.1.1.1.cmml">Γ—</mo><mn id="A2.T9.2.2.2.1.m1.1.1.3" xref="A2.T9.2.2.2.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.2.2.2.1.m1.1b"><apply id="A2.T9.2.2.2.1.m1.1.1.cmml" xref="A2.T9.2.2.2.1.m1.1.1"><times id="A2.T9.2.2.2.1.m1.1.1.1.cmml" xref="A2.T9.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T9.2.2.2.1.m1.1.1.2.cmml" xref="A2.T9.2.2.2.1.m1.1.1.2">absent</csymbol><cn type="integer" id="A2.T9.2.2.2.1.m1.1.1.3.cmml" xref="A2.T9.2.2.2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.2.2.2.1.m1.1c">\times 16</annotation></semantics></math></span></td>
<td id="A2.T9.2.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.2.5.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="A2.T9.2.3.1" class="ltx_tr">
<th id="A2.T9.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th id="A2.T9.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1</td>
<td id="A2.T9.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1</td>
<td id="A2.T9.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr id="A2.T9.2.4.2" class="ltx_tr">
<th id="A2.T9.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th id="A2.T9.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.4.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">4 + 0</td>
<td id="A2.T9.2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td id="A2.T9.2.4.2.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr id="A2.T9.2.5.3" class="ltx_tr">
<th id="A2.T9.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th id="A2.T9.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.5.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">4 + 0</td>
<td id="A2.T9.2.5.3.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">16 + 0</td>
<td id="A2.T9.2.5.3.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr id="A2.T9.2.6.4" class="ltx_tr">
<th id="A2.T9.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th id="A2.T9.2.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.6.4.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.47B</td>
<td id="A2.T9.2.6.4.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td id="A2.T9.2.6.4.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
</tr>
<tr id="A2.T9.2.7.5" class="ltx_tr">
<th id="A2.T9.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th id="A2.T9.2.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.7.5.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.47B</td>
<td id="A2.T9.2.7.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1.89B</td>
<td id="A2.T9.2.7.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.24B</td>
</tr>
<tr id="A2.T9.2.8.6" class="ltx_tr">
<th id="A2.T9.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th id="A2.T9.2.8.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.8.6.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T9.2.8.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T9.2.8.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr id="A2.T9.2.9.7" class="ltx_tr">
<th id="A2.T9.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Pile&nbsp;(Loss)</th>
<th id="A2.T9.2.9.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T9.2.9.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.908</td>
<td id="A2.T9.2.9.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.9.7.4.1" class="ltx_text ltx_font_bold">1.806</span></td>
<td id="A2.T9.2.9.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.9.7.5.1" class="ltx_text ltx_font_bold">1.808</span></td>
</tr>
<tr id="A2.T9.2.10.8" class="ltx_tr">
<th id="A2.T9.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="A2.T9.2.10.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.10.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">47.6</td>
<td id="A2.T9.2.10.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.10.8.4.1" class="ltx_text ltx_font_bold">55.1</span></td>
<td id="A2.T9.2.10.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.10.8.5.1" class="ltx_text ltx_font_bold">54.8</span></td>
</tr>
<tr id="A2.T9.2.11.9" class="ltx_tr">
<th id="A2.T9.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="A2.T9.2.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.11.9.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">70.0</td>
<td id="A2.T9.2.11.9.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">71.9</td>
<td id="A2.T9.2.11.9.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.11.9.5.1" class="ltx_text ltx_font_bold">72.3</span></td>
</tr>
<tr id="A2.T9.2.12.10" class="ltx_tr">
<th id="A2.T9.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="A2.T9.2.12.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.12.10.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">43.9</td>
<td id="A2.T9.2.12.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.12.10.4.1" class="ltx_text ltx_font_bold">51.9</span></td>
<td id="A2.T9.2.12.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">49.4</td>
</tr>
<tr id="A2.T9.2.13.11" class="ltx_tr">
<th id="A2.T9.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="A2.T9.2.13.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.13.11.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">30.5</td>
<td id="A2.T9.2.13.11.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">33.8</td>
<td id="A2.T9.2.13.11.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.13.11.5.1" class="ltx_text ltx_font_bold">34.3</span></td>
</tr>
<tr id="A2.T9.2.14.12" class="ltx_tr">
<th id="A2.T9.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="A2.T9.2.14.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T9.2.14.12.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">42.4</td>
<td id="A2.T9.2.14.12.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.14.12.4.1" class="ltx_text ltx_font_bold">46.3</span></td>
<td id="A2.T9.2.14.12.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">44.0</td>
</tr>
<tr id="A2.T9.2.15.13" class="ltx_tr">
<th id="A2.T9.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="A2.T9.2.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T9.2.15.13.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">30.7</td>
<td id="A2.T9.2.15.13.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.15.13.4.1" class="ltx_text ltx_font_bold">33.0</span></td>
<td id="A2.T9.2.15.13.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">31.7</td>
</tr>
<tr id="A2.T9.2.16.14" class="ltx_tr">
<th id="A2.T9.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="A2.T9.2.16.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T9.2.16.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.8</td>
<td id="A2.T9.2.16.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">4.3</td>
<td id="A2.T9.2.16.14.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.16.14.5.1" class="ltx_text ltx_font_bold">4.9</span></td>
</tr>
<tr id="A2.T9.2.17.15" class="ltx_tr">
<th id="A2.T9.2.17.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="A2.T9.2.17.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td id="A2.T9.2.17.15.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0.2</td>
<td id="A2.T9.2.17.15.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.17.15.4.1" class="ltx_text ltx_font_bold">2.2</span></td>
<td id="A2.T9.2.17.15.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.17.15.5.1" class="ltx_text ltx_font_bold">2.2</span></td>
</tr>
<tr id="A2.T9.2.18.16" class="ltx_tr">
<th id="A2.T9.2.18.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="A2.T9.2.18.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T9.2.18.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">9.9</td>
<td id="A2.T9.2.18.16.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.18.16.4.1" class="ltx_text ltx_font_bold">16.5</span></td>
<td id="A2.T9.2.18.16.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.18.16.5.1" class="ltx_text ltx_font_bold">16.6</span></td>
</tr>
<tr id="A2.T9.2.19.17" class="ltx_tr">
<th id="A2.T9.2.19.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="A2.T9.2.19.17.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T9.2.19.17.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">3.0</td>
<td id="A2.T9.2.19.17.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T9.2.19.17.4.1" class="ltx_text ltx_font_bold">6.3</span></td>
<td id="A2.T9.2.19.17.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">5.7</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">ν‘ 9:</span></figcaption>
Comparison between DeepSeekMoE and larger dense baselines.
</figcaption>
</figure>
<div id="A2.p2" class="ltx_para">
<p class="ltx_p" id="A2.p2.3">13B μ΄ λ§¤κ°λ³€μμ λ” ν° κ·λ¨μ—μ„ DeepSeekMoEλ¥Ό GShard<math alttext="\times 1.2" class="ltx_Math" display="inline" id="A2.p2.1.m1.1"><semantics id="A2.p2.1.m1.1a"><mrow id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml"><mi id="A2.p2.1.m1.1.1.2" xref="A2.p2.1.m1.1.1.2.cmml"></mi><mo id="A2.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.1.m1.1.1.1.cmml">Γ—</mo><mn id="A2.p2.1.m1.1.1.3" xref="A2.p2.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><apply id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1"><times id="A2.p2.1.m1.1.1.1.cmml" xref="A2.p2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.p2.1.m1.1.1.2.cmml" xref="A2.p2.1.m1.1.1.2">absent</csymbol><cn id="A2.p2.1.m1.1.1.3.cmml" type="float" xref="A2.p2.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\times 1.2</annotation></semantics></math> λ° GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="A2.p2.2.m2.1"><semantics id="A2.p2.2.m2.1a"><mrow id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml"><mi id="A2.p2.2.m2.1.1.2" xref="A2.p2.2.m2.1.1.2.cmml"></mi><mo id="A2.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.2.m2.1.1.1.cmml">Γ—</mo><mn id="A2.p2.2.m2.1.1.3" xref="A2.p2.2.m2.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><apply id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1"><times id="A2.p2.2.m2.1.1.1.cmml" xref="A2.p2.2.m2.1.1.1"></times><csymbol cd="latexml" id="A2.p2.2.m2.1.1.2.cmml" xref="A2.p2.2.m2.1.1.2">absent</csymbol><cn id="A2.p2.2.m2.1.1.3.cmml" type="float" xref="A2.p2.2.m2.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">\times 1.5</annotation></semantics></math>μ™€ λΉ„κµν•κ³  ν‘<a class="ltx_ref" href="#A2.T10" title="Table 10 β€£ Appendix B Comparing DeepSeekMoE with Larger Models β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">10</span></a>μ κ²°κ³Όλ¥Ό λ³΄μ—¬μ¤€λ‹¤. λ” ν° κ·λ¨μ—μ„ DeepSeekMoEλ” GShard<math alttext="\times 1.5" class="ltx_Math" display="inline" id="A2.p2.3.m3.1"><semantics id="A2.p2.3.m3.1a"><mrow id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml"><mi id="A2.p2.3.m3.1.1.2" xref="A2.p2.3.m3.1.1.2.cmml"></mi><mo id="A2.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.3.m3.1.1.1.cmml">Γ—</mo><mn id="A2.p2.3.m3.1.1.3" xref="A2.p2.3.m3.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.1b"><apply id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1"><times id="A2.p2.3.m3.1.1.1.cmml" xref="A2.p2.3.m3.1.1.1"></times><csymbol cd="latexml" id="A2.p2.3.m3.1.1.2.cmml" xref="A2.p2.3.m3.1.1.2">absent</csymbol><cn id="A2.p2.3.m3.1.1.3.cmml" type="float" xref="A2.p2.3.m3.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.1c">\times 1.5</annotation></semantics></math>λ¥Ό λλ ·ν•κ² λ¥κ°€ν•λ‹¤.</p>
</div>
<figure id="A2.T10" class="ltx_table">
<table id="A2.T10.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T10.2.2" class="ltx_tr">
<th id="A2.T10.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.2.3.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="A2.T10.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.2.4.1" class="ltx_text ltx_font_bold"># Shot</span></th>
<td id="A2.T10.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.1.1.1.1" class="ltx_text ltx_font_bold">GShard<math id="A2.T10.1.1.1.1.m1.1" class="ltx_Math" alttext="\times 1.2" display="inline"><semantics id="A2.T10.1.1.1.1.m1.1a"><mrow id="A2.T10.1.1.1.1.m1.1.1" xref="A2.T10.1.1.1.1.m1.1.1.cmml"><mi id="A2.T10.1.1.1.1.m1.1.1.2" xref="A2.T10.1.1.1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T10.1.1.1.1.m1.1.1.1" xref="A2.T10.1.1.1.1.m1.1.1.1.cmml">Γ—</mo><mn id="A2.T10.1.1.1.1.m1.1.1.3" xref="A2.T10.1.1.1.1.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.1.1.1.1.m1.1b"><apply id="A2.T10.1.1.1.1.m1.1.1.cmml" xref="A2.T10.1.1.1.1.m1.1.1"><times id="A2.T10.1.1.1.1.m1.1.1.1.cmml" xref="A2.T10.1.1.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T10.1.1.1.1.m1.1.1.2.cmml" xref="A2.T10.1.1.1.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.T10.1.1.1.1.m1.1.1.3.cmml" xref="A2.T10.1.1.1.1.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.1.1.1.1.m1.1c">\times 1.2</annotation></semantics></math></span></td>
<td id="A2.T10.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.2.2.1" class="ltx_text ltx_font_bold">GShard<math id="A2.T10.2.2.2.1.m1.1" class="ltx_Math" alttext="\times 1.5" display="inline"><semantics id="A2.T10.2.2.2.1.m1.1a"><mrow id="A2.T10.2.2.2.1.m1.1.1" xref="A2.T10.2.2.2.1.m1.1.1.cmml"><mi id="A2.T10.2.2.2.1.m1.1.1.2" xref="A2.T10.2.2.2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="A2.T10.2.2.2.1.m1.1.1.1" xref="A2.T10.2.2.2.1.m1.1.1.1.cmml">Γ—</mo><mn id="A2.T10.2.2.2.1.m1.1.1.3" xref="A2.T10.2.2.2.1.m1.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T10.2.2.2.1.m1.1b"><apply id="A2.T10.2.2.2.1.m1.1.1.cmml" xref="A2.T10.2.2.2.1.m1.1.1"><times id="A2.T10.2.2.2.1.m1.1.1.1.cmml" xref="A2.T10.2.2.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="A2.T10.2.2.2.1.m1.1.1.2.cmml" xref="A2.T10.2.2.2.1.m1.1.1.2">absent</csymbol><cn type="float" id="A2.T10.2.2.2.1.m1.1.1.3.cmml" xref="A2.T10.2.2.2.1.m1.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T10.2.2.2.1.m1.1c">\times 1.5</annotation></semantics></math></span></td>
<td id="A2.T10.2.2.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.2.5.1" class="ltx_text ltx_font_bold">DeepSeekMoE</span></td>
</tr>
<tr id="A2.T10.2.3.1" class="ltx_tr">
<th id="A2.T10.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">Relative Expert Size</th>
<th id="A2.T10.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.2</td>
<td id="A2.T10.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">1.5</td>
<td id="A2.T10.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0.25</td>
</tr>
<tr id="A2.T10.2.4.2" class="ltx_tr">
<th id="A2.T10.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Experts</th>
<th id="A2.T10.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.4.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="A2.T10.2.4.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 16</td>
<td id="A2.T10.2.4.2.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 63</td>
</tr>
<tr id="A2.T10.2.5.3" class="ltx_tr">
<th id="A2.T10.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Experts</th>
<th id="A2.T10.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.5.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="A2.T10.2.5.3.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">0 + 2</td>
<td id="A2.T10.2.5.3.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">1 + 7</td>
</tr>
<tr id="A2.T10.2.6.4" class="ltx_tr">
<th id="A2.T10.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Total Expert Params</th>
<th id="A2.T10.2.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.6.4.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">15.9B</td>
<td id="A2.T10.2.6.4.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">19.8B</td>
<td id="A2.T10.2.6.4.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">13.3B</td>
</tr>
<tr id="A2.T10.2.7.5" class="ltx_tr">
<th id="A2.T10.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Activated Expert Params</th>
<th id="A2.T10.2.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.7.5.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.37B</td>
<td id="A2.T10.2.7.5.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.82B</td>
<td id="A2.T10.2.7.5.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">2.05B</td>
</tr>
<tr id="A2.T10.2.8.6" class="ltx_tr">
<th id="A2.T10.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;"># Training Tokens</th>
<th id="A2.T10.2.8.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">N/A</th>
<td id="A2.T10.2.8.6.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T10.2.8.6.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
<td id="A2.T10.2.8.6.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">100B</td>
</tr>
<tr id="A2.T10.2.9.7" class="ltx_tr">
<th id="A2.T10.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HellaSwag&nbsp;(Acc.)</th>
<th id="A2.T10.2.9.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.9.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">66.6</td>
<td id="A2.T10.2.9.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">67.7</td>
<td id="A2.T10.2.9.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.9.7.5.1" class="ltx_text ltx_font_bold">69.1</span></td>
</tr>
<tr id="A2.T10.2.10.8" class="ltx_tr">
<th id="A2.T10.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">PIQA&nbsp;(Acc.)</th>
<th id="A2.T10.2.10.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.10.8.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">75.6</td>
<td id="A2.T10.2.10.8.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.10.8.4.1" class="ltx_text ltx_font_bold">76.0</span></td>
<td id="A2.T10.2.10.8.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.10.8.5.1" class="ltx_text ltx_font_bold">75.7</span></td>
</tr>
<tr id="A2.T10.2.11.9" class="ltx_tr">
<th id="A2.T10.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-easy&nbsp;(Acc.)</th>
<th id="A2.T10.2.11.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.11.9.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">56.8</td>
<td id="A2.T10.2.11.9.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">56.8</td>
<td id="A2.T10.2.11.9.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.11.9.5.1" class="ltx_text ltx_font_bold">58.8</span></td>
</tr>
<tr id="A2.T10.2.12.10" class="ltx_tr">
<th id="A2.T10.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">ARC-challenge&nbsp;(Acc.)</th>
<th id="A2.T10.2.12.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.12.10.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.12.10.3.1" class="ltx_text ltx_font_bold">39.9</span></td>
<td id="A2.T10.2.12.10.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">37.6</td>
<td id="A2.T10.2.12.10.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">38.5</td>
</tr>
<tr id="A2.T10.2.13.11" class="ltx_tr">
<th id="A2.T10.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-middle&nbsp;(Acc.)</th>
<th id="A2.T10.2.13.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T10.2.13.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">51.6</td>
<td id="A2.T10.2.13.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">50.6</td>
<td id="A2.T10.2.13.11.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.13.11.5.1" class="ltx_text ltx_font_bold">52.4</span></td>
</tr>
<tr id="A2.T10.2.14.12" class="ltx_tr">
<th id="A2.T10.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">RACE-high&nbsp;(Acc.)</th>
<th id="A2.T10.2.14.12.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T10.2.14.12.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">37.4</td>
<td id="A2.T10.2.14.12.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">36.3</td>
<td id="A2.T10.2.14.12.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.14.12.5.1" class="ltx_text ltx_font_bold">38.5</span></td>
</tr>
<tr id="A2.T10.2.15.13" class="ltx_tr">
<th id="A2.T10.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">HumanEval&nbsp;(Pass@1)</th>
<th id="A2.T10.2.15.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">0-shot</th>
<td id="A2.T10.2.15.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">6.1</td>
<td id="A2.T10.2.15.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">6.1</td>
<td id="A2.T10.2.15.13.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.15.13.5.1" class="ltx_text ltx_font_bold">9.8</span></td>
</tr>
<tr id="A2.T10.2.16.14" class="ltx_tr">
<th id="A2.T10.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:8.0pt;padding-right:8.0pt;">MBPP&nbsp;(Pass@1)</th>
<th id="A2.T10.2.16.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">3-shot</th>
<td id="A2.T10.2.16.14.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">7.0</td>
<td id="A2.T10.2.16.14.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.16.14.4.1" class="ltx_text ltx_font_bold">11.6</span></td>
<td id="A2.T10.2.16.14.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">10.6</td>
</tr>
<tr id="A2.T10.2.17.15" class="ltx_tr">
<th id="A2.T10.2.17.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">TriviaQA&nbsp;(EM)</th>
<th id="A2.T10.2.17.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T10.2.17.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">36.5</td>
<td id="A2.T10.2.17.15.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">36.7</td>
<td id="A2.T10.2.17.15.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.17.15.5.1" class="ltx_text ltx_font_bold">38.2</span></td>
</tr>
<tr id="A2.T10.2.18.16" class="ltx_tr">
<th id="A2.T10.2.18.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">NaturalQuestions&nbsp;(EM)</th>
<th id="A2.T10.2.18.16.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">5-shot</th>
<td id="A2.T10.2.18.16.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">12.6</td>
<td id="A2.T10.2.18.16.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">12.1</td>
<td id="A2.T10.2.18.16.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="A2.T10.2.18.16.5.1" class="ltx_text ltx_font_bold">13.7</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">ν‘ 10:</span></figcaption>
Comparison between DeepSeekMoE and larger GShard models at a larger scale.
</figcaption>
</figure>
</section>
<section id="A3" class="ltx_appendix" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Training Benchmark Curves of DeepSeekMoE 16B</h2>

<div id="A3.p1" class="ltx_para">
<p class="ltx_p" id="A3.p1.1">μ°Έκ³ μ©μΌλ΅ <a class="ltx_ref" href="#A3.F7" title="Figure 7 β€£ Appendix C Training Benchmark Curves of DeepSeekMoE 16B β€£ DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>μ—μ„ DeepSeekMoE 16Bμ™€ DeepSeek 7B(Dense)μ ν›λ ¨ μ¤‘ λ²¤μΉλ§ν¬ κ³΅μ„ μ„ μ μ‹ν•λ‹¤.</p>
</div>
<figure id="A3.F7" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2401.06066/assets/x7.png" id="A3.F7.g1" class="ltx_graphics ltx_img_portrait" width="456" height="608" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">κ·Έλ¦Ό 7:</span></figcaption>
Benchmark curves during training of DeepSeekMoE 16B and DeepSeek 7B (Dense).
</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="https://ar5iv.labs.arxiv.org/html/2401.06065" class="ar5iv-nav-button ar5iv-nav-button-prev">β—„</a>
    <a class="ar5iv-home-button" href="https://ar5iv.labs.arxiv.org/"><img height="40" alt="ar5iv homepage" src="https://ar5iv.labs.arxiv.org/assets/ar5iv.png"></a>
    <a href="https://ar5iv.labs.arxiv.org/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="https://ar5iv.labs.arxiv.org/log/2401.06066" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+2401.06066">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2401.06066" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="https://ar5iv.labs.arxiv.org/html/2401.06067" class="ar5iv-nav-button ar5iv-nav-button-next">β–Ί</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 09:57:45 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Γ—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>