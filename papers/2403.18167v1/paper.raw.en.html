<html lang="en" data-theme="light"><head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Mechanisms of Non-Factual Hallucination in Language Models</title>
<!--Generated on Wed Mar 27 00:22:22 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2403.18167v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2403.18167v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
        <span class="color-scheme-icon" aria-label="Light mode"></span>
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="#myForm" onclick="event.preventDefault(); var modal = document.getElementById('myForm'); modal.style.display = 'block'; bugReportState.setInitiateWay('Header');">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2403.18167v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2403.18167v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
          <span class="color-scheme-icon"></span>
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S1" title="1 Introduction ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S2" title="2 Related Work ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S2.SS0.SSS0.Px1" title="Factual knowledge in language models. ‣ 2 Related Work ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Factual knowledge in language models.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S2.SS0.SSS0.Px2" title="Hallucinations. ‣ 2 Related Work ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Hallucinations.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S2.SS0.SSS0.Px3" title="Mechanistic interpretability. ‣ 2 Related Work ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Mechanistic interpretability.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S3" title="3 Background and Notation ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Background and Notation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4" title="4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Mechanisms of Hallucinations</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Causal tracing of factual errors</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px1" title="Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Method.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px2" title="Experiments. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Experiments.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px3" title="Results. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px4" title="Early- vs. late-site hallucination. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Early- vs. late-site hallucination.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px5" title="External manifestations of hallucination mechanisms. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">External manifestations of hallucination mechanisms.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS2" title="4.2 Inspection via embedding space projection ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Inspection via embedding space projection</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS2.SSS0.Px1" title="Method. ‣ 4.2 Inspection via embedding space projection ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Method.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS2.SSS0.Px2" title="Results. ‣ 4.2 Inspection via embedding space projection ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S5" title="5 Tracing LM Hallucinations During Pretraining ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Tracing LM Hallucinations During Pretraining</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S5.SS0.SSS0.Px1" title="Data and models. ‣ 5 Tracing LM Hallucinations During Pretraining ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Data and models.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S5.SS0.SSS0.Px2" title="Development of factual association pipeline. ‣ 5 Tracing LM Hallucinations During Pretraining ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Development of factual association pipeline.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6" title="6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Application to Hallucination Detection</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.SS0.SSS0.Px1" title="Data. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Data.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.SS0.SSS0.Px2" title="Methods. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Methods.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.SS0.SSS0.Px3" title="Baselines. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.SS0.SSS0.Px4" title="Results. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S7" title="7 Conclusion ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S8" title="8 Limitation ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Limitation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A1" title="Appendix A Dataset of Non-Factual Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Dataset of Non-Factual Hallucinations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2" title="Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Causal Tracing of Hallucinations</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS1" title="B.1 Experiment details ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Experiment details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS2" title="B.2 Causal tracing results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Causal tracing results on GPTs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS3" title="B.3 Examples of early-site and late-site hallucinations ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Examples of early-site and late-site hallucinations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS4" title="B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>Embedding space projection results on GPTs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A3" title="Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Evaluation of Pythia Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A4" title="Appendix D Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Hallucination Detection</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A4.SS1" title="D.1 Example data from Natural Questions and TruthfulQA ‣ Appendix D Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Example data from Natural Questions and TruthfulQA</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A4.SS2" title="D.2 Details of causal attribution approximation ‣ Appendix D Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Details of causal attribution approximation</span></a></li>
</ol>
</li>
</ol></nav>

<div class="ltx_page_content">
<div aria-label="Conversion errors have been found" class="package-alerts ltx_document" role="status">
<button aria-label="Dismiss alert" onclick="closePopup()">
<span aria-hidden="true"><svg aria-hidden="true" focusable="false" height="20" role="presentation" viewBox="0 0 44 44" width="20">
<path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
<path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
</svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button></span>
</button>
<p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul arial-label="Unsupported packages used in this paper">
<li>failed: inconsolata</li>
</ul>
<p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div><div class="section" id="target-section"><div id="license-tr">License: CC BY 4.0</div><div id="watermark-tr">arXiv:2403.18167v1 [cs.CL] 27 Mar 2024</div></div>
<script>
            function closePopup() {
                document.querySelector('.package-alerts').style.display = 'none';
            }
        </script>
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Mechanisms of Non-Factual Hallucination in Language Models</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lei Yu<math alttext="{}^{1,*}" class="ltx_Math" display="inline" id="id1.1.m1.2"><semantics id="id1.1.m1.2a"><msup id="id1.1.m1.2.2" xref="id1.1.m1.2.2.cmml"><mi id="id1.1.m1.2.2a" xref="id1.1.m1.2.2.cmml"></mi><mrow id="id1.1.m1.2.2.2.4" xref="id1.1.m1.2.2.2.3.cmml"><mn id="id1.1.m1.1.1.1.1" xref="id1.1.m1.1.1.1.1.cmml">1</mn><mo id="id1.1.m1.2.2.2.4.1" rspace="0em" xref="id1.1.m1.2.2.2.3.cmml">,</mo><mo id="id1.1.m1.2.2.2.2" lspace="0em" xref="id1.1.m1.2.2.2.2.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.2b"><apply id="id1.1.m1.2.2.cmml" xref="id1.1.m1.2.2"><list id="id1.1.m1.2.2.2.3.cmml" xref="id1.1.m1.2.2.2.4"><cn id="id1.1.m1.1.1.1.1.cmml" type="integer" xref="id1.1.m1.1.1.1.1">1</cn><times id="id1.1.m1.2.2.2.2.cmml" xref="id1.1.m1.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.2c">{}^{1,*}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.2d">start_FLOATSUPERSCRIPT 1 , * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Meng Cao<math alttext="{}^{2,3,*}" class="ltx_Math" display="inline" id="id2.2.m2.3"><semantics id="id2.2.m2.3a"><msup id="id2.2.m2.3.3" xref="id2.2.m2.3.3.cmml"><mi id="id2.2.m2.3.3a" xref="id2.2.m2.3.3.cmml"></mi><mrow id="id2.2.m2.3.3.3.5" xref="id2.2.m2.3.3.3.4.cmml"><mn id="id2.2.m2.1.1.1.1" xref="id2.2.m2.1.1.1.1.cmml">2</mn><mo id="id2.2.m2.3.3.3.5.1" xref="id2.2.m2.3.3.3.4.cmml">,</mo><mn id="id2.2.m2.2.2.2.2" xref="id2.2.m2.2.2.2.2.cmml">3</mn><mo id="id2.2.m2.3.3.3.5.2" rspace="0em" xref="id2.2.m2.3.3.3.4.cmml">,</mo><mo id="id2.2.m2.3.3.3.3" lspace="0em" xref="id2.2.m2.3.3.3.3.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id2.2.m2.3b"><apply id="id2.2.m2.3.3.cmml" xref="id2.2.m2.3.3"><list id="id2.2.m2.3.3.3.4.cmml" xref="id2.2.m2.3.3.3.5"><cn id="id2.2.m2.1.1.1.1.cmml" type="integer" xref="id2.2.m2.1.1.1.1">2</cn><cn id="id2.2.m2.2.2.2.2.cmml" type="integer" xref="id2.2.m2.2.2.2.2">3</cn><times id="id2.2.m2.3.3.3.3.cmml" xref="id2.2.m2.3.3.3.3"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.3c">{}^{2,3,*}</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.3d">start_FLOATSUPERSCRIPT 2 , 3 , * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Jackie Chi Kit Cheung<math alttext="{}^{2,3}" class="ltx_Math" display="inline" id="id3.3.m3.2"><semantics id="id3.3.m3.2a"><msup id="id3.3.m3.2.2" xref="id3.3.m3.2.2.cmml"><mi id="id3.3.m3.2.2a" xref="id3.3.m3.2.2.cmml"></mi><mrow id="id3.3.m3.2.2.2.4" xref="id3.3.m3.2.2.2.3.cmml"><mn id="id3.3.m3.1.1.1.1" xref="id3.3.m3.1.1.1.1.cmml">2</mn><mo id="id3.3.m3.2.2.2.4.1" xref="id3.3.m3.2.2.2.3.cmml">,</mo><mn id="id3.3.m3.2.2.2.2" xref="id3.3.m3.2.2.2.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id3.3.m3.2b"><apply id="id3.3.m3.2.2.cmml" xref="id3.3.m3.2.2"><list id="id3.3.m3.2.2.2.3.cmml" xref="id3.3.m3.2.2.2.4"><cn id="id3.3.m3.1.1.1.1.cmml" type="integer" xref="id3.3.m3.1.1.1.1">2</cn><cn id="id3.3.m3.2.2.2.2.cmml" type="integer" xref="id3.3.m3.2.2.2.2">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.2c">{}^{2,3}</annotation><annotation encoding="application/x-llamapun" id="id3.3.m3.2d">start_FLOATSUPERSCRIPT 2 , 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>, Yue Dong<math alttext="{}^{4}" class="ltx_Math" display="inline" id="id4.4.m4.1"><semantics id="id4.4.m4.1a"><msup id="id4.4.m4.1.1" xref="id4.4.m4.1.1.cmml"><mi id="id4.4.m4.1.1a" xref="id4.4.m4.1.1.cmml"></mi><mn id="id4.4.m4.1.1.1" xref="id4.4.m4.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="id4.4.m4.1b"><apply id="id4.4.m4.1.1.cmml" xref="id4.4.m4.1.1"><cn id="id4.4.m4.1.1.1.cmml" type="integer" xref="id4.4.m4.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.4.m4.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="id4.4.m4.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math>
<br class="ltx_break"><math alttext="{}^{1}" class="ltx_Math" display="inline" id="id5.5.m5.1"><semantics id="id5.5.m5.1a"><msup id="id5.5.m5.1.1" xref="id5.5.m5.1.1.cmml"><mi id="id5.5.m5.1.1a" xref="id5.5.m5.1.1.cmml"></mi><mn id="id5.5.m5.1.1.1" xref="id5.5.m5.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id5.5.m5.1b"><apply id="id5.5.m5.1.1.cmml" xref="id5.5.m5.1.1"><cn id="id5.5.m5.1.1.1.cmml" type="integer" xref="id5.5.m5.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.5.m5.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id5.5.m5.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>Department of Computer Science, University of Toronto 
<br class="ltx_break"><math alttext="{}^{2}" class="ltx_Math" display="inline" id="id6.6.m6.1"><semantics id="id6.6.m6.1a"><msup id="id6.6.m6.1.1" xref="id6.6.m6.1.1.cmml"><mi id="id6.6.m6.1.1a" xref="id6.6.m6.1.1.cmml"></mi><mn id="id6.6.m6.1.1.1" xref="id6.6.m6.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id6.6.m6.1b"><apply id="id6.6.m6.1.1.cmml" xref="id6.6.m6.1.1"><cn id="id6.6.m6.1.1.1.cmml" type="integer" xref="id6.6.m6.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.6.m6.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id6.6.m6.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>School of Computer Science, McGill University 
<br class="ltx_break"><math alttext="{}^{3}" class="ltx_Math" display="inline" id="id7.7.m7.1"><semantics id="id7.7.m7.1a"><msup id="id7.7.m7.1.1" xref="id7.7.m7.1.1.cmml"><mi id="id7.7.m7.1.1a" xref="id7.7.m7.1.1.cmml"></mi><mn id="id7.7.m7.1.1.1" xref="id7.7.m7.1.1.1.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id7.7.m7.1b"><apply id="id7.7.m7.1.1.cmml" xref="id7.7.m7.1.1"><cn id="id7.7.m7.1.1.1.cmml" type="integer" xref="id7.7.m7.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.7.m7.1c">{}^{3}</annotation><annotation encoding="application/x-llamapun" id="id7.7.m7.1d">start_FLOATSUPERSCRIPT 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>Mila – Québec AI Institute 
<br class="ltx_break"><math alttext="{}^{4}" class="ltx_Math" display="inline" id="id8.8.m8.1"><semantics id="id8.8.m8.1a"><msup id="id8.8.m8.1.1" xref="id8.8.m8.1.1.cmml"><mi id="id8.8.m8.1.1a" xref="id8.8.m8.1.1.cmml"></mi><mn id="id8.8.m8.1.1.1" xref="id8.8.m8.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="id8.8.m8.1b"><apply id="id8.8.m8.1.1.cmml" xref="id8.8.m8.1.1"><cn id="id8.8.m8.1.1.1.cmml" type="integer" xref="id8.8.m8.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.8.m8.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="id8.8.m8.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math>University of California, Riverside 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id9.9.id1">jadeleiyu@cs.toronto.edu</span>
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id10.10.id2">{meng.cao@mail,jcheung@cs}.mcgill.ca</span>
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id11.11.id3">yue.dong@ucr.edu</span>
</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id12.id1">State-of-the-art language models (LMs) sometimes generate <span class="ltx_text ltx_font_italic" id="id12.id1.1">non-factual hallucinations</span> that misalign with world knowledge. Despite extensive efforts to detect and mitigate hallucinations, understanding their internal mechanisms remains elusive. Our study investigates the mechanistic causes of hallucination, specifically non-factual ones where the LM incorrectly predicts object attributes in response to subject-relation queries. With causal mediation analysis and embedding space projection, we identify two general mechanistic causes of hallucinations shared across LMs of various scales and designs: 1) insufficient subject attribute knowledge in lower layer MLPs, and 2) failing to select the correct object attribute in upper layer attention heads and MLPs. These two mechanisms exhibit varying degrees of subject-object association, predictive uncertainty and perturbation robustness. Additionally, we scrutinize LM pre-training checkpoints, revealing distinct learning dynamics for the two mechanistic causes of hallucinations. We also highlight how attribution features from our causal analysis can effectively construct hallucination detectors. Our work proposes a mechanistic understanding of LM factual errors. <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our code and data are available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/jadeleiyu/lm_hallucination_mechanisms" title="">https://github.com/jadeleiyu/lm_hallucination_mechanisms</a>.</span></span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<p class="ltx_p ltx_align_center ltx_align_bottom" id="p1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1">Mechanisms of Non-Factual Hallucination in Language Models</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="p2">
<br class="ltx_break">
<p class="ltx_p" id="p2.8"><span class="ltx_text" id="p2.8.8" style="width:433.6pt;"><span class="ltx_text" id="p2.8.8.8" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p2.8.8.8.8">
<span class="ltx_tbody">
<span class="ltx_tr" id="p2.4.4.4.4.4">
<span class="ltx_td ltx_align_center" id="p2.4.4.4.4.4.4"><span class="ltx_text ltx_font_bold" id="p2.4.4.4.4.4.4.4">Lei Yu<math alttext="{}^{1,*}" class="ltx_Math" display="inline" id="p2.1.1.1.1.1.1.1.m1.2"><semantics id="p2.1.1.1.1.1.1.1.m1.2a"><msup id="p2.1.1.1.1.1.1.1.m1.2.2" xref="p2.1.1.1.1.1.1.1.m1.2.2.cmml"><mi id="p2.1.1.1.1.1.1.1.m1.2.2a" xref="p2.1.1.1.1.1.1.1.m1.2.2.cmml"></mi><mrow id="p2.1.1.1.1.1.1.1.m1.2.2.2.4" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.3.cmml"><mn id="p2.1.1.1.1.1.1.1.m1.1.1.1.1" mathvariant="normal" xref="p2.1.1.1.1.1.1.1.m1.1.1.1.1.cmml">1</mn><mo id="p2.1.1.1.1.1.1.1.m1.2.2.2.4.1" mathvariant="normal" rspace="0em" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.3.cmml">,</mo><mo id="p2.1.1.1.1.1.1.1.m1.2.2.2.2" lspace="0em" mathvariant="normal" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.2.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="p2.1.1.1.1.1.1.1.m1.2b"><apply id="p2.1.1.1.1.1.1.1.m1.2.2.cmml" xref="p2.1.1.1.1.1.1.1.m1.2.2"><list id="p2.1.1.1.1.1.1.1.m1.2.2.2.3.cmml" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.4"><cn id="p2.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" type="integer" xref="p2.1.1.1.1.1.1.1.m1.1.1.1.1">1</cn><times id="p2.1.1.1.1.1.1.1.m1.2.2.2.2.cmml" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.1.1.1.1.1.1.1.m1.2c">{}^{1,*}</annotation><annotation encoding="application/x-llamapun" id="p2.1.1.1.1.1.1.1.m1.2d">start_FLOATSUPERSCRIPT 1 , * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Meng Cao<math alttext="{}^{2,3,*}" class="ltx_Math" display="inline" id="p2.2.2.2.2.2.2.2.m2.3"><semantics id="p2.2.2.2.2.2.2.2.m2.3a"><msup id="p2.2.2.2.2.2.2.2.m2.3.3" xref="p2.2.2.2.2.2.2.2.m2.3.3.cmml"><mi id="p2.2.2.2.2.2.2.2.m2.3.3a" xref="p2.2.2.2.2.2.2.2.m2.3.3.cmml"></mi><mrow id="p2.2.2.2.2.2.2.2.m2.3.3.3.5" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.4.cmml"><mn id="p2.2.2.2.2.2.2.2.m2.1.1.1.1" mathvariant="normal" xref="p2.2.2.2.2.2.2.2.m2.1.1.1.1.cmml">2</mn><mo id="p2.2.2.2.2.2.2.2.m2.3.3.3.5.1" mathvariant="normal" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.4.cmml">,</mo><mn id="p2.2.2.2.2.2.2.2.m2.2.2.2.2" mathvariant="normal" xref="p2.2.2.2.2.2.2.2.m2.2.2.2.2.cmml">3</mn><mo id="p2.2.2.2.2.2.2.2.m2.3.3.3.5.2" mathvariant="normal" rspace="0em" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.4.cmml">,</mo><mo id="p2.2.2.2.2.2.2.2.m2.3.3.3.3" lspace="0em" mathvariant="normal" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.3.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="p2.2.2.2.2.2.2.2.m2.3b"><apply id="p2.2.2.2.2.2.2.2.m2.3.3.cmml" xref="p2.2.2.2.2.2.2.2.m2.3.3"><list id="p2.2.2.2.2.2.2.2.m2.3.3.3.4.cmml" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.5"><cn id="p2.2.2.2.2.2.2.2.m2.1.1.1.1.cmml" type="integer" xref="p2.2.2.2.2.2.2.2.m2.1.1.1.1">2</cn><cn id="p2.2.2.2.2.2.2.2.m2.2.2.2.2.cmml" type="integer" xref="p2.2.2.2.2.2.2.2.m2.2.2.2.2">3</cn><times id="p2.2.2.2.2.2.2.2.m2.3.3.3.3.cmml" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.3"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.2.2.2.2.2.2.2.m2.3c">{}^{2,3,*}</annotation><annotation encoding="application/x-llamapun" id="p2.2.2.2.2.2.2.2.m2.3d">start_FLOATSUPERSCRIPT 2 , 3 , * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Jackie Chi Kit Cheung<math alttext="{}^{2,3}" class="ltx_Math" display="inline" id="p2.3.3.3.3.3.3.3.m3.2"><semantics id="p2.3.3.3.3.3.3.3.m3.2a"><msup id="p2.3.3.3.3.3.3.3.m3.2.2" xref="p2.3.3.3.3.3.3.3.m3.2.2.cmml"><mi id="p2.3.3.3.3.3.3.3.m3.2.2a" xref="p2.3.3.3.3.3.3.3.m3.2.2.cmml"></mi><mrow id="p2.3.3.3.3.3.3.3.m3.2.2.2.4" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.3.cmml"><mn id="p2.3.3.3.3.3.3.3.m3.1.1.1.1" mathvariant="normal" xref="p2.3.3.3.3.3.3.3.m3.1.1.1.1.cmml">2</mn><mo id="p2.3.3.3.3.3.3.3.m3.2.2.2.4.1" mathvariant="normal" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.3.cmml">,</mo><mn id="p2.3.3.3.3.3.3.3.m3.2.2.2.2" mathvariant="normal" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="p2.3.3.3.3.3.3.3.m3.2b"><apply id="p2.3.3.3.3.3.3.3.m3.2.2.cmml" xref="p2.3.3.3.3.3.3.3.m3.2.2"><list id="p2.3.3.3.3.3.3.3.m3.2.2.2.3.cmml" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.4"><cn id="p2.3.3.3.3.3.3.3.m3.1.1.1.1.cmml" type="integer" xref="p2.3.3.3.3.3.3.3.m3.1.1.1.1">2</cn><cn id="p2.3.3.3.3.3.3.3.m3.2.2.2.2.cmml" type="integer" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.2">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.3.3.3.3.3.3.3.m3.2c">{}^{2,3}</annotation><annotation encoding="application/x-llamapun" id="p2.3.3.3.3.3.3.3.m3.2d">start_FLOATSUPERSCRIPT 2 , 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>, Yue Dong<math alttext="{}^{4}" class="ltx_Math" display="inline" id="p2.4.4.4.4.4.4.4.m4.1"><semantics id="p2.4.4.4.4.4.4.4.m4.1a"><msup id="p2.4.4.4.4.4.4.4.m4.1.1" xref="p2.4.4.4.4.4.4.4.m4.1.1.cmml"><mi id="p2.4.4.4.4.4.4.4.m4.1.1a" xref="p2.4.4.4.4.4.4.4.m4.1.1.cmml"></mi><mn id="p2.4.4.4.4.4.4.4.m4.1.1.1" mathvariant="normal" xref="p2.4.4.4.4.4.4.4.m4.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="p2.4.4.4.4.4.4.4.m4.1b"><apply id="p2.4.4.4.4.4.4.4.m4.1.1.cmml" xref="p2.4.4.4.4.4.4.4.m4.1.1"><cn id="p2.4.4.4.4.4.4.4.m4.1.1.1.cmml" type="integer" xref="p2.4.4.4.4.4.4.4.m4.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.4.4.4.4.4.4.4.m4.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="p2.4.4.4.4.4.4.4.m4.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math></span></span></span>
<span class="ltx_tr" id="p2.5.5.5.5.5">
<span class="ltx_td ltx_align_center" id="p2.5.5.5.5.5.1"><math alttext="{}^{1}" class="ltx_Math" display="inline" id="p2.5.5.5.5.5.1.m1.1"><semantics id="p2.5.5.5.5.5.1.m1.1a"><msup id="p2.5.5.5.5.5.1.m1.1.1" xref="p2.5.5.5.5.5.1.m1.1.1.cmml"><mi id="p2.5.5.5.5.5.1.m1.1.1a" xref="p2.5.5.5.5.5.1.m1.1.1.cmml"></mi><mn id="p2.5.5.5.5.5.1.m1.1.1.1" xref="p2.5.5.5.5.5.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="p2.5.5.5.5.5.1.m1.1b"><apply id="p2.5.5.5.5.5.1.m1.1.1.cmml" xref="p2.5.5.5.5.5.1.m1.1.1"><cn id="p2.5.5.5.5.5.1.m1.1.1.1.cmml" type="integer" xref="p2.5.5.5.5.5.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.5.5.5.5.5.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="p2.5.5.5.5.5.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>Department of Computer Science, University of Toronto</span></span>
<span class="ltx_tr" id="p2.6.6.6.6.6">
<span class="ltx_td ltx_align_center" id="p2.6.6.6.6.6.1"><math alttext="{}^{2}" class="ltx_Math" display="inline" id="p2.6.6.6.6.6.1.m1.1"><semantics id="p2.6.6.6.6.6.1.m1.1a"><msup id="p2.6.6.6.6.6.1.m1.1.1" xref="p2.6.6.6.6.6.1.m1.1.1.cmml"><mi id="p2.6.6.6.6.6.1.m1.1.1a" xref="p2.6.6.6.6.6.1.m1.1.1.cmml"></mi><mn id="p2.6.6.6.6.6.1.m1.1.1.1" xref="p2.6.6.6.6.6.1.m1.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="p2.6.6.6.6.6.1.m1.1b"><apply id="p2.6.6.6.6.6.1.m1.1.1.cmml" xref="p2.6.6.6.6.6.1.m1.1.1"><cn id="p2.6.6.6.6.6.1.m1.1.1.1.cmml" type="integer" xref="p2.6.6.6.6.6.1.m1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.6.6.6.6.6.1.m1.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="p2.6.6.6.6.6.1.m1.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>School of Computer Science, McGill University</span></span>
<span class="ltx_tr" id="p2.7.7.7.7.7">
<span class="ltx_td ltx_align_center" id="p2.7.7.7.7.7.1"><math alttext="{}^{3}" class="ltx_Math" display="inline" id="p2.7.7.7.7.7.1.m1.1"><semantics id="p2.7.7.7.7.7.1.m1.1a"><msup id="p2.7.7.7.7.7.1.m1.1.1" xref="p2.7.7.7.7.7.1.m1.1.1.cmml"><mi id="p2.7.7.7.7.7.1.m1.1.1a" xref="p2.7.7.7.7.7.1.m1.1.1.cmml"></mi><mn id="p2.7.7.7.7.7.1.m1.1.1.1" xref="p2.7.7.7.7.7.1.m1.1.1.1.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="p2.7.7.7.7.7.1.m1.1b"><apply id="p2.7.7.7.7.7.1.m1.1.1.cmml" xref="p2.7.7.7.7.7.1.m1.1.1"><cn id="p2.7.7.7.7.7.1.m1.1.1.1.cmml" type="integer" xref="p2.7.7.7.7.7.1.m1.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.7.7.7.7.7.1.m1.1c">{}^{3}</annotation><annotation encoding="application/x-llamapun" id="p2.7.7.7.7.7.1.m1.1d">start_FLOATSUPERSCRIPT 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>Mila – Québec AI Institute</span></span>
<span class="ltx_tr" id="p2.8.8.8.8.8">
<span class="ltx_td ltx_align_center" id="p2.8.8.8.8.8.1"><math alttext="{}^{4}" class="ltx_Math" display="inline" id="p2.8.8.8.8.8.1.m1.1"><semantics id="p2.8.8.8.8.8.1.m1.1a"><msup id="p2.8.8.8.8.8.1.m1.1.1" xref="p2.8.8.8.8.8.1.m1.1.1.cmml"><mi id="p2.8.8.8.8.8.1.m1.1.1a" xref="p2.8.8.8.8.8.1.m1.1.1.cmml"></mi><mn id="p2.8.8.8.8.8.1.m1.1.1.1" xref="p2.8.8.8.8.8.1.m1.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="p2.8.8.8.8.8.1.m1.1b"><apply id="p2.8.8.8.8.8.1.m1.1.1.cmml" xref="p2.8.8.8.8.8.1.m1.1.1"><cn id="p2.8.8.8.8.8.1.m1.1.1.1.cmml" type="integer" xref="p2.8.8.8.8.8.1.m1.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.8.8.8.8.8.1.m1.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="p2.8.8.8.8.8.1.m1.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math>University of California, Riverside</span></span>
<span class="ltx_tr" id="p2.8.8.8.8.9.1">
<span class="ltx_td ltx_align_center" id="p2.8.8.8.8.9.1.1"><span class="ltx_text ltx_font_typewriter" id="p2.8.8.8.8.9.1.1.1">jadeleiyu@cs.toronto.edu</span></span></span>
<span class="ltx_tr" id="p2.8.8.8.8.10.2">
<span class="ltx_td ltx_align_center" id="p2.8.8.8.8.10.2.1"><span class="ltx_text ltx_font_typewriter" id="p2.8.8.8.8.10.2.1.1">{meng.cao@mail,jcheung@cs}.mcgill.ca</span></span></span>
<span class="ltx_tr" id="p2.8.8.8.8.11.3">
<span class="ltx_td ltx_align_center" id="p2.8.8.8.8.11.3.1"><span class="ltx_text ltx_font_typewriter" id="p2.8.8.8.8.11.3.1.1">yue.dong@ucr.edu</span></span></span>
</span>
</span></span> </span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<span class="ltx_note ltx_role_footnotetext" id="footnotex1"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_note_type">footnotetext: </span>Equal contribution.</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Language models (LMs) serve as repositories of substantial knowledge <cite class="ltx_cite ltx_citemacro_cite">Petroni et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib40" title="">2019</a>); Jiang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib23" title="">2020</a>); Srivastava et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib42" title="">2023</a>)</cite> through their parametric knowledge gained from pre-training. However, they are susceptible to generating “hallucinations” that contain factual errors. At the level of logit predictions, these hallucinations often display a pattern similar to factual generations. For example, LMs have been observed to produce seemingly confident completions that are, in reality, hallucinations <cite class="ltx_cite ltx_citemacro_cite">Dong et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib10" title="">2022</a>); Zhang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib58" title="">2023b</a>)</cite>.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To understand how hallucinations differ from factual outputs and whether they are uniformly generated or equally challenging to fix, thorough analysis tools that monitoring the information flow are required, extending beyond merely last-layer predictions <cite class="ltx_cite ltx_citemacro_cite">Kaddour et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib24" title="">2023</a>)</cite>. However, research on understanding the internal mechanisms of hallucination generation is limited. Most efforts have focused on detecting and mitigating hallucinations <cite class="ltx_cite ltx_citemacro_cite">Elaraby et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib11" title="">2023</a>); Mündler et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib34" title="">2023</a>); Manakul et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib30" title="">2023</a>); Zhang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib57" title="">2023a</a>)</cite>, treating the LM as a black box and devising methods based on external features like predictive uncertainty <cite class="ltx_cite ltx_citemacro_cite">Xiao and Wang (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib54" title="">2021</a>); Varshney et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib48" title="">2023</a>)</cite> and logical consistency <cite class="ltx_cite ltx_citemacro_cite">Cohen et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib5" title="">2023</a>)</cite>. Unfortunately, these approaches provide no insights into the internal mechanisms of factual errors and have demonstrated unreliability or conveyed contradictory signals <cite class="ltx_cite ltx_citemacro_cite">Turpin et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib47" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In contrast, interpretability research, which probes the internal mechanisms of transformers in white-box settings, has recently garnered significant attention for analyzing which components are helpful in identifying factual predictions. It has identified several critical model “components” (e.g., attention heads, feedforward layers) related to knowledge flow that are essential for answering questions accurately <cite class="ltx_cite ltx_citemacro_cite">Lu et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib29" title="">2021</a>); Dai et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib7" title="">2022</a>); Meng et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>); Geva et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib15" title="">2023</a>)</cite>. However, it remains a question whether the results of mechanistic interpretability on factual predictions can generalize to hallucinations. Specifically, it is unknown which model components deviate from normal functioning to cause hallucinations. Localizing the source of factual errors in LMs may help us design targeted and efficient methods to mitigate hallucinations (e.g., by editing a small set of model weights identified as causing hallucinations), which is particularly important as the model size and the training cost of LMs are rapidly increasing.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this study, we employ mechanistic interpretability <cite class="ltx_cite ltx_citemacro_cite">Olah (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib38" title="">2022</a>)</cite> to investigate the origins and manifestation of non-factual hallucinations in LMs. We use two established interpretability methods, causal mediation analysis <cite class="ltx_cite ltx_citemacro_cite">Pearl (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib39" title="">2001</a>); Vig et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib50" title="">2020</a>)</cite> and embedding space projection <cite class="ltx_cite ltx_citemacro_cite">Geva et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib17" title="">2022b</a>); Dar et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib8" title="">2023</a>)</cite> in our specially designed setups on non-factual hallucination data, aiming to assess the influence of model components on hallucinating predictions. Through extensive analyses on LMs of various sizes and architectures (Llama-2, GPT-J, GPT-2-XL), we obtain converging evidence that there exist two groups of crucial components for factually incorrect predictions: 1) the multi-layer perceptrons (MLPs) in lower transformer layers, 2) the attention heads and MLPs in upper transformer layers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates two distinct scenarios where the identified hallucinating components exhibit different behaviors. In some instances, lower-layer MLPs function normally, successfully retrieving semantic attributes about queried entities, while upper-layer attention heads and MLPs struggle to distinguish the most relevant attributes that lead to the correct answer. In other cases, the model fails to execute its fact-recalling pipeline at the beginning, extracting no useful information from lower-layer MLPs. We also observe that these two hallucination mechanisms have varying external manifestations, distinguishable by their levels of subject-object association strengths, robustness to input perturbations, and model predictive uncertainty. Following the discoveries by <cite class="ltx_cite ltx_citemacro_citet">Akyürek et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib1" title="">2022</a>); Zhou et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib59" title="">2023</a>)</cite> regarding the significant role of LM pre-training in acquiring factual knowledge, we also examined the impact of pre-training on the various types of hallucinations we have identified. Our findings are significant: early-site MLPs and late-site attentions form a two-step pipeline for fact recall that emerges progressively during pre-training, and failing to develop either step can result in hallucinations.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In addition to providing internal knowledge flow analysis that exhibits high correlations with external features, which helps us understand how different types of hallucinations behave during various stages of pre-training, our work also demonstrates a practical application: mechanistic interpretability features can be employed to detect the presence of factual errors in language models (LMs). This research offers the first mechanistic explanation of LM factual errors as systematic modular failures, fostering research on model explainability and hallucination mitigation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="221" id="S1.F1.g1" src="x1.png" width="789">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S1.F1.13.1">Our main finding of two non-factual hallucination mechanisms.</span> <span class="ltx_text ltx_font_bold" id="S1.F1.14.2">Left (a)</span>: The <span class="ltx_text ltx_font_bold" id="S1.F1.15.3">early-site hallucinations</span> are caused by lacking general knowledge of the subject in lower layer MLPs of transformer LMs – in this case, the model fails to retrieve useful information about the entity (e.g., <span class="ltx_text ltx_font_italic" id="S1.F1.16.4">Orica</span>, an Australian-based multinational corporation) to generate the correct object attribute (e.g., <span class="ltx_text ltx_font_italic" id="S1.F1.17.5">Australia</span>), and therefore outputs a highly irrelevant prediction (January). <span class="ltx_text ltx_font_bold" id="S1.F1.18.6">Right (b)</span>: The <span class="ltx_text ltx_font_bold" id="S1.F1.19.7">late-site hallucinations</span> are caused by the failure of upper layer attention heads and MLPs to identify the most relevant object to the given subject and relation – in this case, the model is able to retrieve related information about the subject (e.g., <span class="ltx_text ltx_font_italic" id="S1.F1.20.8">Toulouse</span>, a French city) from lower layer MLPs, but cannot distinguish the irrelevant yet strongly associated attributes (e.g., <span class="ltx_text ltx_font_italic" id="S1.F1.21.9">Paris</span>) from the correct answers (e.g., <span class="ltx_text ltx_font_italic" id="S1.F1.22.10">Bologna</span>/<span class="ltx_text ltx_font_italic" id="S1.F1.23.11">Chongqing</span>/<span class="ltx_text ltx_font_italic" id="S1.F1.24.12">Atlanta</span>). We found that these two types of hallucinations can be distinguished by the relative causal contribution to model predictions between lower and upper layer LM components.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Factual knowledge in language models.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">The exploration of knowledge tracing within Language Models (LMs) has gained substantial attention lately, with researchers investigating specific layers <cite class="ltx_cite ltx_citemacro_citep">(Wallat et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib51" title="">2020</a>; Geva et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib18" title="">2021</a>; Meng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite> and neurons <cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib7" title="">2022</a>)</cite> responsible for storing factual information. This line of inquiry extends to techniques for model editing <cite class="ltx_cite ltx_citemacro_citep">(De&nbsp;Cao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib9" title="">2021</a>; Mitchell et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib33" title="">2021</a>; Meng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib32" title="">2022b</a>)</cite> and inference intervention <cite class="ltx_cite ltx_citemacro_citep">(Hernandez et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib21" title="">2023</a>; Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib27" title="">2023</a>)</cite>. Recent advancements by <cite class="ltx_cite ltx_citemacro_citet">Geva et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib15" title="">2023</a>); Yu et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib55" title="">2023</a>)</cite> identify crucial LM components that form an internal pipeline for factual information transfer. Our framework complements existing research by offering an additional perspective on LM factual knowledge processing, revealing that compromised factually relevant modules can lead to hallucinations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Hallucinations.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Language models are susceptible to generating hallucinations that can be <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px2.p1.1.1">unfaithful</span> (i.e. deviating from the source input provided by users) or <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px2.p1.1.2">non-factual</span> (i.e. contradicting established world knowledge) <cite class="ltx_cite ltx_citemacro_cite">Cao et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib3" title="">2022a</a>); Ji et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib22" title="">2023</a>); Zhang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib58" title="">2023b</a>)</cite>. Here, we focus on the latter type of hallucination. Existing studies propose various methods to detect or mitigate hallucinations, leveraging features such as internal activation patterns <cite class="ltx_cite ltx_citemacro_cite">Yuksekgonul et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib56" title="">2023</a>); Li et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib27" title="">2023</a>)</cite>, predictive confidence <cite class="ltx_cite ltx_citemacro_cite">Cao et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib3" title="">2022a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib4" title="">b</a>); Varshney et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib48" title="">2023</a>)</cite>, and generation consistency <cite class="ltx_cite ltx_citemacro_cite">Mündler et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib34" title="">2023</a>); Manakul et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib30" title="">2023</a>); Zhang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib57" title="">2023a</a>)</cite>.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Mechanistic interpretability.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">Mechanistic interpretability <cite class="ltx_cite ltx_citemacro_cite">Olah (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib38" title="">2022</a>); Nanda (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib35" title="">2023</a>)</cite> is an evolving research area. Recent works employ projections to the vocabulary <cite class="ltx_cite ltx_citemacro_cite">Geva et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib17" title="">2022b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib16" title="">a</a>); Nostalgebraist (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib37" title="">2020</a>); Katz et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib25" title="">2024</a>)</cite> and interventions in transformer computation <cite class="ltx_cite ltx_citemacro_cite">Finlayson et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib14" title="">2021</a>); Haviv et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib20" title="">2022</a>); Stolfo et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib43" title="">2023</a>); Ghandeharioun et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib19" title="">2024</a>)</cite> to study LM inner workings. Similar techniques have been applied to explore neural network learning dynamics <cite class="ltx_cite ltx_citemacro_cite">Nanda et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib36" title="">2022</a>)</cite> and discover sparse computational graphs for specific tasks <cite class="ltx_cite ltx_citemacro_cite">Wang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib53" title="">2022</a>); Conmy et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib6" title="">2023</a>)</cite>. Leveraging multiple mechanistic interpretability methods, our study provides a principled account for non-factual hallucinations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Background and Notation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.26">We start by providing a detailed description of the inference pass of decoder-only transformer-based LMs. An auto-regressive transformer, denoted as <math alttext="G" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_G</annotation></semantics></math>, maps an input sequence of tokens <math alttext="u=[w_{1},...,w_{T}]" class="ltx_Math" display="inline" id="S3.p1.2.m2.3"><semantics id="S3.p1.2.m2.3a"><mrow id="S3.p1.2.m2.3.3" xref="S3.p1.2.m2.3.3.cmml"><mi id="S3.p1.2.m2.3.3.4" xref="S3.p1.2.m2.3.3.4.cmml">u</mi><mo id="S3.p1.2.m2.3.3.3" xref="S3.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.p1.2.m2.3.3.2.2" xref="S3.p1.2.m2.3.3.2.3.cmml"><mo id="S3.p1.2.m2.3.3.2.2.3" stretchy="false" xref="S3.p1.2.m2.3.3.2.3.cmml">[</mo><msub id="S3.p1.2.m2.2.2.1.1.1" xref="S3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.p1.2.m2.2.2.1.1.1.2" xref="S3.p1.2.m2.2.2.1.1.1.2.cmml">w</mi><mn id="S3.p1.2.m2.2.2.1.1.1.3" xref="S3.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.2.m2.3.3.2.2.4" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><mi id="S3.p1.2.m2.1.1" mathvariant="normal" xref="S3.p1.2.m2.1.1.cmml">…</mi><mo id="S3.p1.2.m2.3.3.2.2.5" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.p1.2.m2.3.3.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.p1.2.m2.3.3.2.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.2.cmml">w</mi><mi id="S3.p1.2.m2.3.3.2.2.2.3" xref="S3.p1.2.m2.3.3.2.2.2.3.cmml">T</mi></msub><mo id="S3.p1.2.m2.3.3.2.2.6" stretchy="false" xref="S3.p1.2.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.3b"><apply id="S3.p1.2.m2.3.3.cmml" xref="S3.p1.2.m2.3.3"><eq id="S3.p1.2.m2.3.3.3.cmml" xref="S3.p1.2.m2.3.3.3"></eq><ci id="S3.p1.2.m2.3.3.4.cmml" xref="S3.p1.2.m2.3.3.4">𝑢</ci><list id="S3.p1.2.m2.3.3.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2"><apply id="S3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1.1.2">𝑤</ci><cn id="S3.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">…</ci><apply id="S3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2.2">𝑤</ci><ci id="S3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2.2.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.3c">u=[w_{1},...,w_{T}]</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.3d">italic_u = [ italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_w start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ]</annotation></semantics></math>, represented by input token embeddings <math alttext="E(u)=[e_{1},...,e_{T}]" class="ltx_Math" display="inline" id="S3.p1.3.m3.4"><semantics id="S3.p1.3.m3.4a"><mrow id="S3.p1.3.m3.4.4" xref="S3.p1.3.m3.4.4.cmml"><mrow id="S3.p1.3.m3.4.4.4" xref="S3.p1.3.m3.4.4.4.cmml"><mi id="S3.p1.3.m3.4.4.4.2" xref="S3.p1.3.m3.4.4.4.2.cmml">E</mi><mo id="S3.p1.3.m3.4.4.4.1" xref="S3.p1.3.m3.4.4.4.1.cmml">⁢</mo><mrow id="S3.p1.3.m3.4.4.4.3.2" xref="S3.p1.3.m3.4.4.4.cmml"><mo id="S3.p1.3.m3.4.4.4.3.2.1" stretchy="false" xref="S3.p1.3.m3.4.4.4.cmml">(</mo><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">u</mi><mo id="S3.p1.3.m3.4.4.4.3.2.2" stretchy="false" xref="S3.p1.3.m3.4.4.4.cmml">)</mo></mrow></mrow><mo id="S3.p1.3.m3.4.4.3" xref="S3.p1.3.m3.4.4.3.cmml">=</mo><mrow id="S3.p1.3.m3.4.4.2.2" xref="S3.p1.3.m3.4.4.2.3.cmml"><mo id="S3.p1.3.m3.4.4.2.2.3" stretchy="false" xref="S3.p1.3.m3.4.4.2.3.cmml">[</mo><msub id="S3.p1.3.m3.3.3.1.1.1" xref="S3.p1.3.m3.3.3.1.1.1.cmml"><mi id="S3.p1.3.m3.3.3.1.1.1.2" xref="S3.p1.3.m3.3.3.1.1.1.2.cmml">e</mi><mn id="S3.p1.3.m3.3.3.1.1.1.3" xref="S3.p1.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.3.m3.4.4.2.2.4" xref="S3.p1.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.p1.3.m3.2.2" mathvariant="normal" xref="S3.p1.3.m3.2.2.cmml">…</mi><mo id="S3.p1.3.m3.4.4.2.2.5" xref="S3.p1.3.m3.4.4.2.3.cmml">,</mo><msub id="S3.p1.3.m3.4.4.2.2.2" xref="S3.p1.3.m3.4.4.2.2.2.cmml"><mi id="S3.p1.3.m3.4.4.2.2.2.2" xref="S3.p1.3.m3.4.4.2.2.2.2.cmml">e</mi><mi id="S3.p1.3.m3.4.4.2.2.2.3" xref="S3.p1.3.m3.4.4.2.2.2.3.cmml">T</mi></msub><mo id="S3.p1.3.m3.4.4.2.2.6" stretchy="false" xref="S3.p1.3.m3.4.4.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.4b"><apply id="S3.p1.3.m3.4.4.cmml" xref="S3.p1.3.m3.4.4"><eq id="S3.p1.3.m3.4.4.3.cmml" xref="S3.p1.3.m3.4.4.3"></eq><apply id="S3.p1.3.m3.4.4.4.cmml" xref="S3.p1.3.m3.4.4.4"><times id="S3.p1.3.m3.4.4.4.1.cmml" xref="S3.p1.3.m3.4.4.4.1"></times><ci id="S3.p1.3.m3.4.4.4.2.cmml" xref="S3.p1.3.m3.4.4.4.2">𝐸</ci><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑢</ci></apply><list id="S3.p1.3.m3.4.4.2.3.cmml" xref="S3.p1.3.m3.4.4.2.2"><apply id="S3.p1.3.m3.3.3.1.1.1.cmml" xref="S3.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.p1.3.m3.3.3.1.1.1.2">𝑒</ci><cn id="S3.p1.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S3.p1.3.m3.3.3.1.1.1.3">1</cn></apply><ci id="S3.p1.3.m3.2.2.cmml" xref="S3.p1.3.m3.2.2">…</ci><apply id="S3.p1.3.m3.4.4.2.2.2.cmml" xref="S3.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.4.4.2.2.2.1.cmml" xref="S3.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S3.p1.3.m3.4.4.2.2.2.2.cmml" xref="S3.p1.3.m3.4.4.2.2.2.2">𝑒</ci><ci id="S3.p1.3.m3.4.4.2.2.2.3.cmml" xref="S3.p1.3.m3.4.4.2.2.2.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.4c">E(u)=[e_{1},...,e_{T}]</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.4d">italic_E ( italic_u ) = [ italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_e start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ]</annotation></semantics></math>, into a probability distribution over the vocabulary for next-token prediction. Within the transformer, the <math alttext="i" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_i</annotation></semantics></math>-th token is represented as a series of hidden states <math alttext="h_{i}^{(l)}" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><msubsup id="S3.p1.5.m5.1.2" xref="S3.p1.5.m5.1.2.cmml"><mi id="S3.p1.5.m5.1.2.2.2" xref="S3.p1.5.m5.1.2.2.2.cmml">h</mi><mi id="S3.p1.5.m5.1.2.2.3" xref="S3.p1.5.m5.1.2.2.3.cmml">i</mi><mrow id="S3.p1.5.m5.1.1.1.3" xref="S3.p1.5.m5.1.2.cmml"><mo id="S3.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.p1.5.m5.1.2.cmml">(</mo><mi id="S3.p1.5.m5.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.cmml">l</mi><mo id="S3.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.2.cmml" xref="S3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.2.1.cmml" xref="S3.p1.5.m5.1.2">superscript</csymbol><apply id="S3.p1.5.m5.1.2.2.cmml" xref="S3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.2.2.1.cmml" xref="S3.p1.5.m5.1.2">subscript</csymbol><ci id="S3.p1.5.m5.1.2.2.2.cmml" xref="S3.p1.5.m5.1.2.2.2">ℎ</ci><ci id="S3.p1.5.m5.1.2.2.3.cmml" xref="S3.p1.5.m5.1.2.2.3">𝑖</ci></apply><ci id="S3.p1.5.m5.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">h_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> where at each layer <math alttext="l" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">italic_l</annotation></semantics></math>, the model computes and adds the intermediate embeddings by two modules from <math alttext="h_{i}^{(l-1)}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><msubsup id="S3.p1.7.m7.1.2" xref="S3.p1.7.m7.1.2.cmml"><mi id="S3.p1.7.m7.1.2.2.2" xref="S3.p1.7.m7.1.2.2.2.cmml">h</mi><mi id="S3.p1.7.m7.1.2.2.3" xref="S3.p1.7.m7.1.2.2.3.cmml">i</mi><mrow id="S3.p1.7.m7.1.1.1.1" xref="S3.p1.7.m7.1.1.1.1.1.cmml"><mo id="S3.p1.7.m7.1.1.1.1.2" stretchy="false" xref="S3.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.7.m7.1.1.1.1.1" xref="S3.p1.7.m7.1.1.1.1.1.cmml"><mi id="S3.p1.7.m7.1.1.1.1.1.2" xref="S3.p1.7.m7.1.1.1.1.1.2.cmml">l</mi><mo id="S3.p1.7.m7.1.1.1.1.1.1" xref="S3.p1.7.m7.1.1.1.1.1.1.cmml">−</mo><mn id="S3.p1.7.m7.1.1.1.1.1.3" xref="S3.p1.7.m7.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p1.7.m7.1.1.1.1.3" stretchy="false" xref="S3.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.2.cmml" xref="S3.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.2.1.cmml" xref="S3.p1.7.m7.1.2">superscript</csymbol><apply id="S3.p1.7.m7.1.2.2.cmml" xref="S3.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.2.2.1.cmml" xref="S3.p1.7.m7.1.2">subscript</csymbol><ci id="S3.p1.7.m7.1.2.2.2.cmml" xref="S3.p1.7.m7.1.2.2.2">ℎ</ci><ci id="S3.p1.7.m7.1.2.2.3.cmml" xref="S3.p1.7.m7.1.2.2.3">𝑖</ci></apply><apply id="S3.p1.7.m7.1.1.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1.1"><minus id="S3.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1.1.1.1"></minus><ci id="S3.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.p1.7.m7.1.1.1.1.1.2">𝑙</ci><cn id="S3.p1.7.m7.1.1.1.1.1.3.cmml" type="integer" xref="S3.p1.7.m7.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">h_{i}^{(l-1)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math>: 1) an aggregated <span class="ltx_text ltx_font_bold" id="S3.p1.26.1">multi-head self-attention module</span> output <math alttext="a^{(l)}_{i}=W_{o}([a_{i}^{(l,0)},...,a_{i}^{(l,K)}])" class="ltx_Math" display="inline" id="S3.p1.8.m8.7"><semantics id="S3.p1.8.m8.7a"><mrow id="S3.p1.8.m8.7.7" xref="S3.p1.8.m8.7.7.cmml"><msubsup id="S3.p1.8.m8.7.7.3" xref="S3.p1.8.m8.7.7.3.cmml"><mi id="S3.p1.8.m8.7.7.3.2.2" xref="S3.p1.8.m8.7.7.3.2.2.cmml">a</mi><mi id="S3.p1.8.m8.7.7.3.3" xref="S3.p1.8.m8.7.7.3.3.cmml">i</mi><mrow id="S3.p1.8.m8.1.1.1.3" xref="S3.p1.8.m8.7.7.3.cmml"><mo id="S3.p1.8.m8.1.1.1.3.1" stretchy="false" xref="S3.p1.8.m8.7.7.3.cmml">(</mo><mi id="S3.p1.8.m8.1.1.1.1" xref="S3.p1.8.m8.1.1.1.1.cmml">l</mi><mo id="S3.p1.8.m8.1.1.1.3.2" stretchy="false" xref="S3.p1.8.m8.7.7.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.8.m8.7.7.2" xref="S3.p1.8.m8.7.7.2.cmml">=</mo><mrow id="S3.p1.8.m8.7.7.1" xref="S3.p1.8.m8.7.7.1.cmml"><msub id="S3.p1.8.m8.7.7.1.3" xref="S3.p1.8.m8.7.7.1.3.cmml"><mi id="S3.p1.8.m8.7.7.1.3.2" xref="S3.p1.8.m8.7.7.1.3.2.cmml">W</mi><mi id="S3.p1.8.m8.7.7.1.3.3" xref="S3.p1.8.m8.7.7.1.3.3.cmml">o</mi></msub><mo id="S3.p1.8.m8.7.7.1.2" xref="S3.p1.8.m8.7.7.1.2.cmml">⁢</mo><mrow id="S3.p1.8.m8.7.7.1.1.1" xref="S3.p1.8.m8.7.7.1.cmml"><mo id="S3.p1.8.m8.7.7.1.1.1.2" stretchy="false" xref="S3.p1.8.m8.7.7.1.cmml">(</mo><mrow id="S3.p1.8.m8.7.7.1.1.1.1.2" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml"><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.3" stretchy="false" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">[</mo><msubsup id="S3.p1.8.m8.7.7.1.1.1.1.1.1" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.cmml"><mi id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.p1.8.m8.3.3.2.4" xref="S3.p1.8.m8.3.3.2.3.cmml"><mo id="S3.p1.8.m8.3.3.2.4.1" stretchy="false" xref="S3.p1.8.m8.3.3.2.3.cmml">(</mo><mi id="S3.p1.8.m8.2.2.1.1" xref="S3.p1.8.m8.2.2.1.1.cmml">l</mi><mo id="S3.p1.8.m8.3.3.2.4.2" xref="S3.p1.8.m8.3.3.2.3.cmml">,</mo><mn id="S3.p1.8.m8.3.3.2.2" xref="S3.p1.8.m8.3.3.2.2.cmml">0</mn><mo id="S3.p1.8.m8.3.3.2.4.3" stretchy="false" xref="S3.p1.8.m8.3.3.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.4" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">,</mo><mi id="S3.p1.8.m8.6.6" mathvariant="normal" xref="S3.p1.8.m8.6.6.cmml">…</mi><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.5" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">,</mo><msubsup id="S3.p1.8.m8.7.7.1.1.1.1.2.2" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.cmml"><mi id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3.cmml">i</mi><mrow id="S3.p1.8.m8.5.5.2.4" xref="S3.p1.8.m8.5.5.2.3.cmml"><mo id="S3.p1.8.m8.5.5.2.4.1" stretchy="false" xref="S3.p1.8.m8.5.5.2.3.cmml">(</mo><mi id="S3.p1.8.m8.4.4.1.1" xref="S3.p1.8.m8.4.4.1.1.cmml">l</mi><mo id="S3.p1.8.m8.5.5.2.4.2" xref="S3.p1.8.m8.5.5.2.3.cmml">,</mo><mi id="S3.p1.8.m8.5.5.2.2" xref="S3.p1.8.m8.5.5.2.2.cmml">K</mi><mo id="S3.p1.8.m8.5.5.2.4.3" stretchy="false" xref="S3.p1.8.m8.5.5.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.6" stretchy="false" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.p1.8.m8.7.7.1.1.1.3" stretchy="false" xref="S3.p1.8.m8.7.7.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.7b"><apply id="S3.p1.8.m8.7.7.cmml" xref="S3.p1.8.m8.7.7"><eq id="S3.p1.8.m8.7.7.2.cmml" xref="S3.p1.8.m8.7.7.2"></eq><apply id="S3.p1.8.m8.7.7.3.cmml" xref="S3.p1.8.m8.7.7.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.3.1.cmml" xref="S3.p1.8.m8.7.7.3">subscript</csymbol><apply id="S3.p1.8.m8.7.7.3.2.cmml" xref="S3.p1.8.m8.7.7.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.3.2.1.cmml" xref="S3.p1.8.m8.7.7.3">superscript</csymbol><ci id="S3.p1.8.m8.7.7.3.2.2.cmml" xref="S3.p1.8.m8.7.7.3.2.2">𝑎</ci><ci id="S3.p1.8.m8.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1">𝑙</ci></apply><ci id="S3.p1.8.m8.7.7.3.3.cmml" xref="S3.p1.8.m8.7.7.3.3">𝑖</ci></apply><apply id="S3.p1.8.m8.7.7.1.cmml" xref="S3.p1.8.m8.7.7.1"><times id="S3.p1.8.m8.7.7.1.2.cmml" xref="S3.p1.8.m8.7.7.1.2"></times><apply id="S3.p1.8.m8.7.7.1.3.cmml" xref="S3.p1.8.m8.7.7.1.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.3.1.cmml" xref="S3.p1.8.m8.7.7.1.3">subscript</csymbol><ci id="S3.p1.8.m8.7.7.1.3.2.cmml" xref="S3.p1.8.m8.7.7.1.3.2">𝑊</ci><ci id="S3.p1.8.m8.7.7.1.3.3.cmml" xref="S3.p1.8.m8.7.7.1.3.3">𝑜</ci></apply><list id="S3.p1.8.m8.7.7.1.1.1.1.3.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2"><apply id="S3.p1.8.m8.7.7.1.1.1.1.1.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.1.1.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1">superscript</csymbol><apply id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.8.m8.3.3.2.3.cmml" xref="S3.p1.8.m8.3.3.2.4"><ci id="S3.p1.8.m8.2.2.1.1.cmml" xref="S3.p1.8.m8.2.2.1.1">𝑙</ci><cn id="S3.p1.8.m8.3.3.2.2.cmml" type="integer" xref="S3.p1.8.m8.3.3.2.2">0</cn></interval></apply><ci id="S3.p1.8.m8.6.6.cmml" xref="S3.p1.8.m8.6.6">…</ci><apply id="S3.p1.8.m8.7.7.1.1.1.1.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.2.2.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2">superscript</csymbol><apply id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.8.m8.5.5.2.3.cmml" xref="S3.p1.8.m8.5.5.2.4"><ci id="S3.p1.8.m8.4.4.1.1.cmml" xref="S3.p1.8.m8.4.4.1.1">𝑙</ci><ci id="S3.p1.8.m8.5.5.2.2.cmml" xref="S3.p1.8.m8.5.5.2.2">𝐾</ci></interval></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.7c">a^{(l)}_{i}=W_{o}([a_{i}^{(l,0)},...,a_{i}^{(l,K)}])</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.7d">italic_a start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ( [ italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l , 0 ) end_POSTSUPERSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l , italic_K ) end_POSTSUPERSCRIPT ] )</annotation></semantics></math>, where <math alttext="a_{i}^{(l,k)}" class="ltx_Math" display="inline" id="S3.p1.9.m9.2"><semantics id="S3.p1.9.m9.2a"><msubsup id="S3.p1.9.m9.2.3" xref="S3.p1.9.m9.2.3.cmml"><mi id="S3.p1.9.m9.2.3.2.2" xref="S3.p1.9.m9.2.3.2.2.cmml">a</mi><mi id="S3.p1.9.m9.2.3.2.3" xref="S3.p1.9.m9.2.3.2.3.cmml">i</mi><mrow id="S3.p1.9.m9.2.2.2.4" xref="S3.p1.9.m9.2.2.2.3.cmml"><mo id="S3.p1.9.m9.2.2.2.4.1" stretchy="false" xref="S3.p1.9.m9.2.2.2.3.cmml">(</mo><mi id="S3.p1.9.m9.1.1.1.1" xref="S3.p1.9.m9.1.1.1.1.cmml">l</mi><mo id="S3.p1.9.m9.2.2.2.4.2" xref="S3.p1.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.p1.9.m9.2.2.2.2" xref="S3.p1.9.m9.2.2.2.2.cmml">k</mi><mo id="S3.p1.9.m9.2.2.2.4.3" stretchy="false" xref="S3.p1.9.m9.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.2b"><apply id="S3.p1.9.m9.2.3.cmml" xref="S3.p1.9.m9.2.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.2.3.1.cmml" xref="S3.p1.9.m9.2.3">superscript</csymbol><apply id="S3.p1.9.m9.2.3.2.cmml" xref="S3.p1.9.m9.2.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.2.3.2.1.cmml" xref="S3.p1.9.m9.2.3">subscript</csymbol><ci id="S3.p1.9.m9.2.3.2.2.cmml" xref="S3.p1.9.m9.2.3.2.2">𝑎</ci><ci id="S3.p1.9.m9.2.3.2.3.cmml" xref="S3.p1.9.m9.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.9.m9.2.2.2.3.cmml" xref="S3.p1.9.m9.2.2.2.4"><ci id="S3.p1.9.m9.1.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1.1">𝑙</ci><ci id="S3.p1.9.m9.2.2.2.2.cmml" xref="S3.p1.9.m9.2.2.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.2c">a_{i}^{(l,k)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.2d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l , italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the output of the <math alttext="k" class="ltx_Math" display="inline" id="S3.p1.10.m10.1"><semantics id="S3.p1.10.m10.1a"><mi id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><ci id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p1.10.m10.1d">italic_k</annotation></semantics></math>-th attention head at layer <math alttext="l" class="ltx_Math" display="inline" id="S3.p1.11.m11.1"><semantics id="S3.p1.11.m11.1a"><mi id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><ci id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.p1.11.m11.1d">italic_l</annotation></semantics></math> (with <math alttext="K" class="ltx_Math" display="inline" id="S3.p1.12.m12.1"><semantics id="S3.p1.12.m12.1a"><mi id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><ci id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p1.12.m12.1d">italic_K</annotation></semantics></math> heads in total) for the <math alttext="i" class="ltx_Math" display="inline" id="S3.p1.13.m13.1"><semantics id="S3.p1.13.m13.1a"><mi id="S3.p1.13.m13.1.1" xref="S3.p1.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.1b"><ci id="S3.p1.13.m13.1.1.cmml" xref="S3.p1.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.p1.13.m13.1d">italic_i</annotation></semantics></math>-th token, and <math alttext="W_{o}" class="ltx_Math" display="inline" id="S3.p1.14.m14.1"><semantics id="S3.p1.14.m14.1a"><msub id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml"><mi id="S3.p1.14.m14.1.1.2" xref="S3.p1.14.m14.1.1.2.cmml">W</mi><mi id="S3.p1.14.m14.1.1.3" xref="S3.p1.14.m14.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><apply id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.cmml" xref="S3.p1.14.m14.1.1">subscript</csymbol><ci id="S3.p1.14.m14.1.1.2.cmml" xref="S3.p1.14.m14.1.1.2">𝑊</ci><ci id="S3.p1.14.m14.1.1.3.cmml" xref="S3.p1.14.m14.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">W_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.14.m14.1d">italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> is a linear transformation; 2) a <span class="ltx_text ltx_font_bold" id="S3.p1.26.2">multi-layer perceptron (MLP)</span> output <math alttext="m_{i}^{(l)}" class="ltx_Math" display="inline" id="S3.p1.15.m15.1"><semantics id="S3.p1.15.m15.1a"><msubsup id="S3.p1.15.m15.1.2" xref="S3.p1.15.m15.1.2.cmml"><mi id="S3.p1.15.m15.1.2.2.2" xref="S3.p1.15.m15.1.2.2.2.cmml">m</mi><mi id="S3.p1.15.m15.1.2.2.3" xref="S3.p1.15.m15.1.2.2.3.cmml">i</mi><mrow id="S3.p1.15.m15.1.1.1.3" xref="S3.p1.15.m15.1.2.cmml"><mo id="S3.p1.15.m15.1.1.1.3.1" stretchy="false" xref="S3.p1.15.m15.1.2.cmml">(</mo><mi id="S3.p1.15.m15.1.1.1.1" xref="S3.p1.15.m15.1.1.1.1.cmml">l</mi><mo id="S3.p1.15.m15.1.1.1.3.2" stretchy="false" xref="S3.p1.15.m15.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.15.m15.1b"><apply id="S3.p1.15.m15.1.2.cmml" xref="S3.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S3.p1.15.m15.1.2.1.cmml" xref="S3.p1.15.m15.1.2">superscript</csymbol><apply id="S3.p1.15.m15.1.2.2.cmml" xref="S3.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S3.p1.15.m15.1.2.2.1.cmml" xref="S3.p1.15.m15.1.2">subscript</csymbol><ci id="S3.p1.15.m15.1.2.2.2.cmml" xref="S3.p1.15.m15.1.2.2.2">𝑚</ci><ci id="S3.p1.15.m15.1.2.2.3.cmml" xref="S3.p1.15.m15.1.2.2.3">𝑖</ci></apply><ci id="S3.p1.15.m15.1.1.1.1.cmml" xref="S3.p1.15.m15.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m15.1c">m_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.15.m15.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> = <math alttext="f_{\text{MLP}}^{(l)}(h_{i}^{(l-1)}+a^{(l)}_{i})" class="ltx_Math" display="inline" id="S3.p1.16.m16.4"><semantics id="S3.p1.16.m16.4a"><mrow id="S3.p1.16.m16.4.4" xref="S3.p1.16.m16.4.4.cmml"><msubsup id="S3.p1.16.m16.4.4.3" xref="S3.p1.16.m16.4.4.3.cmml"><mi id="S3.p1.16.m16.4.4.3.2.2" xref="S3.p1.16.m16.4.4.3.2.2.cmml">f</mi><mtext id="S3.p1.16.m16.4.4.3.2.3" xref="S3.p1.16.m16.4.4.3.2.3a.cmml">MLP</mtext><mrow id="S3.p1.16.m16.1.1.1.3" xref="S3.p1.16.m16.4.4.3.cmml"><mo id="S3.p1.16.m16.1.1.1.3.1" stretchy="false" xref="S3.p1.16.m16.4.4.3.cmml">(</mo><mi id="S3.p1.16.m16.1.1.1.1" xref="S3.p1.16.m16.1.1.1.1.cmml">l</mi><mo id="S3.p1.16.m16.1.1.1.3.2" stretchy="false" xref="S3.p1.16.m16.4.4.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.16.m16.4.4.2" xref="S3.p1.16.m16.4.4.2.cmml">⁢</mo><mrow id="S3.p1.16.m16.4.4.1.1" xref="S3.p1.16.m16.4.4.1.1.1.cmml"><mo id="S3.p1.16.m16.4.4.1.1.2" stretchy="false" xref="S3.p1.16.m16.4.4.1.1.1.cmml">(</mo><mrow id="S3.p1.16.m16.4.4.1.1.1" xref="S3.p1.16.m16.4.4.1.1.1.cmml"><msubsup id="S3.p1.16.m16.4.4.1.1.1.2" xref="S3.p1.16.m16.4.4.1.1.1.2.cmml"><mi id="S3.p1.16.m16.4.4.1.1.1.2.2.2" xref="S3.p1.16.m16.4.4.1.1.1.2.2.2.cmml">h</mi><mi id="S3.p1.16.m16.4.4.1.1.1.2.2.3" xref="S3.p1.16.m16.4.4.1.1.1.2.2.3.cmml">i</mi><mrow id="S3.p1.16.m16.2.2.1.1" xref="S3.p1.16.m16.2.2.1.1.1.cmml"><mo id="S3.p1.16.m16.2.2.1.1.2" stretchy="false" xref="S3.p1.16.m16.2.2.1.1.1.cmml">(</mo><mrow id="S3.p1.16.m16.2.2.1.1.1" xref="S3.p1.16.m16.2.2.1.1.1.cmml"><mi id="S3.p1.16.m16.2.2.1.1.1.2" xref="S3.p1.16.m16.2.2.1.1.1.2.cmml">l</mi><mo id="S3.p1.16.m16.2.2.1.1.1.1" xref="S3.p1.16.m16.2.2.1.1.1.1.cmml">−</mo><mn id="S3.p1.16.m16.2.2.1.1.1.3" xref="S3.p1.16.m16.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p1.16.m16.2.2.1.1.3" stretchy="false" xref="S3.p1.16.m16.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.16.m16.4.4.1.1.1.1" xref="S3.p1.16.m16.4.4.1.1.1.1.cmml">+</mo><msubsup id="S3.p1.16.m16.4.4.1.1.1.3" xref="S3.p1.16.m16.4.4.1.1.1.3.cmml"><mi id="S3.p1.16.m16.4.4.1.1.1.3.2.2" xref="S3.p1.16.m16.4.4.1.1.1.3.2.2.cmml">a</mi><mi id="S3.p1.16.m16.4.4.1.1.1.3.3" xref="S3.p1.16.m16.4.4.1.1.1.3.3.cmml">i</mi><mrow id="S3.p1.16.m16.3.3.1.3" xref="S3.p1.16.m16.4.4.1.1.1.3.cmml"><mo id="S3.p1.16.m16.3.3.1.3.1" stretchy="false" xref="S3.p1.16.m16.4.4.1.1.1.3.cmml">(</mo><mi id="S3.p1.16.m16.3.3.1.1" xref="S3.p1.16.m16.3.3.1.1.cmml">l</mi><mo id="S3.p1.16.m16.3.3.1.3.2" stretchy="false" xref="S3.p1.16.m16.4.4.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.p1.16.m16.4.4.1.1.3" stretchy="false" xref="S3.p1.16.m16.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.16.m16.4b"><apply id="S3.p1.16.m16.4.4.cmml" xref="S3.p1.16.m16.4.4"><times id="S3.p1.16.m16.4.4.2.cmml" xref="S3.p1.16.m16.4.4.2"></times><apply id="S3.p1.16.m16.4.4.3.cmml" xref="S3.p1.16.m16.4.4.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.3.1.cmml" xref="S3.p1.16.m16.4.4.3">superscript</csymbol><apply id="S3.p1.16.m16.4.4.3.2.cmml" xref="S3.p1.16.m16.4.4.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.3.2.1.cmml" xref="S3.p1.16.m16.4.4.3">subscript</csymbol><ci id="S3.p1.16.m16.4.4.3.2.2.cmml" xref="S3.p1.16.m16.4.4.3.2.2">𝑓</ci><ci id="S3.p1.16.m16.4.4.3.2.3a.cmml" xref="S3.p1.16.m16.4.4.3.2.3"><mtext id="S3.p1.16.m16.4.4.3.2.3.cmml" mathsize="70%" xref="S3.p1.16.m16.4.4.3.2.3">MLP</mtext></ci></apply><ci id="S3.p1.16.m16.1.1.1.1.cmml" xref="S3.p1.16.m16.1.1.1.1">𝑙</ci></apply><apply id="S3.p1.16.m16.4.4.1.1.1.cmml" xref="S3.p1.16.m16.4.4.1.1"><plus id="S3.p1.16.m16.4.4.1.1.1.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.1"></plus><apply id="S3.p1.16.m16.4.4.1.1.1.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.1.1.1.2.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2">superscript</csymbol><apply id="S3.p1.16.m16.4.4.1.1.1.2.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.1.1.1.2.2.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2">subscript</csymbol><ci id="S3.p1.16.m16.4.4.1.1.1.2.2.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2.2.2">ℎ</ci><ci id="S3.p1.16.m16.4.4.1.1.1.2.2.3.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.p1.16.m16.2.2.1.1.1.cmml" xref="S3.p1.16.m16.2.2.1.1"><minus id="S3.p1.16.m16.2.2.1.1.1.1.cmml" xref="S3.p1.16.m16.2.2.1.1.1.1"></minus><ci id="S3.p1.16.m16.2.2.1.1.1.2.cmml" xref="S3.p1.16.m16.2.2.1.1.1.2">𝑙</ci><cn id="S3.p1.16.m16.2.2.1.1.1.3.cmml" type="integer" xref="S3.p1.16.m16.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.p1.16.m16.4.4.1.1.1.3.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.1.1.1.3.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3">subscript</csymbol><apply id="S3.p1.16.m16.4.4.1.1.1.3.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.1.1.1.3.2.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3">superscript</csymbol><ci id="S3.p1.16.m16.4.4.1.1.1.3.2.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3.2.2">𝑎</ci><ci id="S3.p1.16.m16.3.3.1.1.cmml" xref="S3.p1.16.m16.3.3.1.1">𝑙</ci></apply><ci id="S3.p1.16.m16.4.4.1.1.1.3.3.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m16.4c">f_{\text{MLP}}^{(l)}(h_{i}^{(l-1)}+a^{(l)}_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.16.m16.4d">italic_f start_POSTSUBSCRIPT MLP end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ( italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT + italic_a start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> at layer <math alttext="l" class="ltx_Math" display="inline" id="S3.p1.17.m17.1"><semantics id="S3.p1.17.m17.1a"><mi id="S3.p1.17.m17.1.1" xref="S3.p1.17.m17.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.17.m17.1b"><ci id="S3.p1.17.m17.1.1.cmml" xref="S3.p1.17.m17.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m17.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.p1.17.m17.1d">italic_l</annotation></semantics></math>. Putting together, the hidden representation <math alttext="h_{i}^{(l)}" class="ltx_Math" display="inline" id="S3.p1.18.m18.1"><semantics id="S3.p1.18.m18.1a"><msubsup id="S3.p1.18.m18.1.2" xref="S3.p1.18.m18.1.2.cmml"><mi id="S3.p1.18.m18.1.2.2.2" xref="S3.p1.18.m18.1.2.2.2.cmml">h</mi><mi id="S3.p1.18.m18.1.2.2.3" xref="S3.p1.18.m18.1.2.2.3.cmml">i</mi><mrow id="S3.p1.18.m18.1.1.1.3" xref="S3.p1.18.m18.1.2.cmml"><mo id="S3.p1.18.m18.1.1.1.3.1" stretchy="false" xref="S3.p1.18.m18.1.2.cmml">(</mo><mi id="S3.p1.18.m18.1.1.1.1" xref="S3.p1.18.m18.1.1.1.1.cmml">l</mi><mo id="S3.p1.18.m18.1.1.1.3.2" stretchy="false" xref="S3.p1.18.m18.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.18.m18.1b"><apply id="S3.p1.18.m18.1.2.cmml" xref="S3.p1.18.m18.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.2.1.cmml" xref="S3.p1.18.m18.1.2">superscript</csymbol><apply id="S3.p1.18.m18.1.2.2.cmml" xref="S3.p1.18.m18.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.2.2.1.cmml" xref="S3.p1.18.m18.1.2">subscript</csymbol><ci id="S3.p1.18.m18.1.2.2.2.cmml" xref="S3.p1.18.m18.1.2.2.2">ℎ</ci><ci id="S3.p1.18.m18.1.2.2.3.cmml" xref="S3.p1.18.m18.1.2.2.3">𝑖</ci></apply><ci id="S3.p1.18.m18.1.1.1.1.cmml" xref="S3.p1.18.m18.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m18.1c">h_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.18.m18.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> is computed as: <math alttext="h_{i}^{(l)}=h_{i}^{(l-1)}+a^{(l)}_{i}+m_{i}^{(l)}" class="ltx_Math" display="inline" id="S3.p1.19.m19.4"><semantics id="S3.p1.19.m19.4a"><mrow id="S3.p1.19.m19.4.5" xref="S3.p1.19.m19.4.5.cmml"><msubsup id="S3.p1.19.m19.4.5.2" xref="S3.p1.19.m19.4.5.2.cmml"><mi id="S3.p1.19.m19.4.5.2.2.2" xref="S3.p1.19.m19.4.5.2.2.2.cmml">h</mi><mi id="S3.p1.19.m19.4.5.2.2.3" xref="S3.p1.19.m19.4.5.2.2.3.cmml">i</mi><mrow id="S3.p1.19.m19.1.1.1.3" xref="S3.p1.19.m19.4.5.2.cmml"><mo id="S3.p1.19.m19.1.1.1.3.1" stretchy="false" xref="S3.p1.19.m19.4.5.2.cmml">(</mo><mi id="S3.p1.19.m19.1.1.1.1" xref="S3.p1.19.m19.1.1.1.1.cmml">l</mi><mo id="S3.p1.19.m19.1.1.1.3.2" stretchy="false" xref="S3.p1.19.m19.4.5.2.cmml">)</mo></mrow></msubsup><mo id="S3.p1.19.m19.4.5.1" xref="S3.p1.19.m19.4.5.1.cmml">=</mo><mrow id="S3.p1.19.m19.4.5.3" xref="S3.p1.19.m19.4.5.3.cmml"><msubsup id="S3.p1.19.m19.4.5.3.2" xref="S3.p1.19.m19.4.5.3.2.cmml"><mi id="S3.p1.19.m19.4.5.3.2.2.2" xref="S3.p1.19.m19.4.5.3.2.2.2.cmml">h</mi><mi id="S3.p1.19.m19.4.5.3.2.2.3" xref="S3.p1.19.m19.4.5.3.2.2.3.cmml">i</mi><mrow id="S3.p1.19.m19.2.2.1.1" xref="S3.p1.19.m19.2.2.1.1.1.cmml"><mo id="S3.p1.19.m19.2.2.1.1.2" stretchy="false" xref="S3.p1.19.m19.2.2.1.1.1.cmml">(</mo><mrow id="S3.p1.19.m19.2.2.1.1.1" xref="S3.p1.19.m19.2.2.1.1.1.cmml"><mi id="S3.p1.19.m19.2.2.1.1.1.2" xref="S3.p1.19.m19.2.2.1.1.1.2.cmml">l</mi><mo id="S3.p1.19.m19.2.2.1.1.1.1" xref="S3.p1.19.m19.2.2.1.1.1.1.cmml">−</mo><mn id="S3.p1.19.m19.2.2.1.1.1.3" xref="S3.p1.19.m19.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p1.19.m19.2.2.1.1.3" stretchy="false" xref="S3.p1.19.m19.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.19.m19.4.5.3.1" xref="S3.p1.19.m19.4.5.3.1.cmml">+</mo><msubsup id="S3.p1.19.m19.4.5.3.3" xref="S3.p1.19.m19.4.5.3.3.cmml"><mi id="S3.p1.19.m19.4.5.3.3.2.2" xref="S3.p1.19.m19.4.5.3.3.2.2.cmml">a</mi><mi id="S3.p1.19.m19.4.5.3.3.3" xref="S3.p1.19.m19.4.5.3.3.3.cmml">i</mi><mrow id="S3.p1.19.m19.3.3.1.3" xref="S3.p1.19.m19.4.5.3.3.cmml"><mo id="S3.p1.19.m19.3.3.1.3.1" stretchy="false" xref="S3.p1.19.m19.4.5.3.3.cmml">(</mo><mi id="S3.p1.19.m19.3.3.1.1" xref="S3.p1.19.m19.3.3.1.1.cmml">l</mi><mo id="S3.p1.19.m19.3.3.1.3.2" stretchy="false" xref="S3.p1.19.m19.4.5.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.19.m19.4.5.3.1a" xref="S3.p1.19.m19.4.5.3.1.cmml">+</mo><msubsup id="S3.p1.19.m19.4.5.3.4" xref="S3.p1.19.m19.4.5.3.4.cmml"><mi id="S3.p1.19.m19.4.5.3.4.2.2" xref="S3.p1.19.m19.4.5.3.4.2.2.cmml">m</mi><mi id="S3.p1.19.m19.4.5.3.4.2.3" xref="S3.p1.19.m19.4.5.3.4.2.3.cmml">i</mi><mrow id="S3.p1.19.m19.4.4.1.3" xref="S3.p1.19.m19.4.5.3.4.cmml"><mo id="S3.p1.19.m19.4.4.1.3.1" stretchy="false" xref="S3.p1.19.m19.4.5.3.4.cmml">(</mo><mi id="S3.p1.19.m19.4.4.1.1" xref="S3.p1.19.m19.4.4.1.1.cmml">l</mi><mo id="S3.p1.19.m19.4.4.1.3.2" stretchy="false" xref="S3.p1.19.m19.4.5.3.4.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.19.m19.4b"><apply id="S3.p1.19.m19.4.5.cmml" xref="S3.p1.19.m19.4.5"><eq id="S3.p1.19.m19.4.5.1.cmml" xref="S3.p1.19.m19.4.5.1"></eq><apply id="S3.p1.19.m19.4.5.2.cmml" xref="S3.p1.19.m19.4.5.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.2.1.cmml" xref="S3.p1.19.m19.4.5.2">superscript</csymbol><apply id="S3.p1.19.m19.4.5.2.2.cmml" xref="S3.p1.19.m19.4.5.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.2.2.1.cmml" xref="S3.p1.19.m19.4.5.2">subscript</csymbol><ci id="S3.p1.19.m19.4.5.2.2.2.cmml" xref="S3.p1.19.m19.4.5.2.2.2">ℎ</ci><ci id="S3.p1.19.m19.4.5.2.2.3.cmml" xref="S3.p1.19.m19.4.5.2.2.3">𝑖</ci></apply><ci id="S3.p1.19.m19.1.1.1.1.cmml" xref="S3.p1.19.m19.1.1.1.1">𝑙</ci></apply><apply id="S3.p1.19.m19.4.5.3.cmml" xref="S3.p1.19.m19.4.5.3"><plus id="S3.p1.19.m19.4.5.3.1.cmml" xref="S3.p1.19.m19.4.5.3.1"></plus><apply id="S3.p1.19.m19.4.5.3.2.cmml" xref="S3.p1.19.m19.4.5.3.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.2.1.cmml" xref="S3.p1.19.m19.4.5.3.2">superscript</csymbol><apply id="S3.p1.19.m19.4.5.3.2.2.cmml" xref="S3.p1.19.m19.4.5.3.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.2.2.1.cmml" xref="S3.p1.19.m19.4.5.3.2">subscript</csymbol><ci id="S3.p1.19.m19.4.5.3.2.2.2.cmml" xref="S3.p1.19.m19.4.5.3.2.2.2">ℎ</ci><ci id="S3.p1.19.m19.4.5.3.2.2.3.cmml" xref="S3.p1.19.m19.4.5.3.2.2.3">𝑖</ci></apply><apply id="S3.p1.19.m19.2.2.1.1.1.cmml" xref="S3.p1.19.m19.2.2.1.1"><minus id="S3.p1.19.m19.2.2.1.1.1.1.cmml" xref="S3.p1.19.m19.2.2.1.1.1.1"></minus><ci id="S3.p1.19.m19.2.2.1.1.1.2.cmml" xref="S3.p1.19.m19.2.2.1.1.1.2">𝑙</ci><cn id="S3.p1.19.m19.2.2.1.1.1.3.cmml" type="integer" xref="S3.p1.19.m19.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.p1.19.m19.4.5.3.3.cmml" xref="S3.p1.19.m19.4.5.3.3"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.3.1.cmml" xref="S3.p1.19.m19.4.5.3.3">subscript</csymbol><apply id="S3.p1.19.m19.4.5.3.3.2.cmml" xref="S3.p1.19.m19.4.5.3.3"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.3.2.1.cmml" xref="S3.p1.19.m19.4.5.3.3">superscript</csymbol><ci id="S3.p1.19.m19.4.5.3.3.2.2.cmml" xref="S3.p1.19.m19.4.5.3.3.2.2">𝑎</ci><ci id="S3.p1.19.m19.3.3.1.1.cmml" xref="S3.p1.19.m19.3.3.1.1">𝑙</ci></apply><ci id="S3.p1.19.m19.4.5.3.3.3.cmml" xref="S3.p1.19.m19.4.5.3.3.3">𝑖</ci></apply><apply id="S3.p1.19.m19.4.5.3.4.cmml" xref="S3.p1.19.m19.4.5.3.4"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.4.1.cmml" xref="S3.p1.19.m19.4.5.3.4">superscript</csymbol><apply id="S3.p1.19.m19.4.5.3.4.2.cmml" xref="S3.p1.19.m19.4.5.3.4"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.4.2.1.cmml" xref="S3.p1.19.m19.4.5.3.4">subscript</csymbol><ci id="S3.p1.19.m19.4.5.3.4.2.2.cmml" xref="S3.p1.19.m19.4.5.3.4.2.2">𝑚</ci><ci id="S3.p1.19.m19.4.5.3.4.2.3.cmml" xref="S3.p1.19.m19.4.5.3.4.2.3">𝑖</ci></apply><ci id="S3.p1.19.m19.4.4.1.1.cmml" xref="S3.p1.19.m19.4.4.1.1">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m19.4c">h_{i}^{(l)}=h_{i}^{(l-1)}+a^{(l)}_{i}+m_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.19.m19.4d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT + italic_a start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math>. Let <math alttext="H=\{h^{l}_{i}\}" class="ltx_Math" display="inline" id="S3.p1.20.m20.1"><semantics id="S3.p1.20.m20.1a"><mrow id="S3.p1.20.m20.1.1" xref="S3.p1.20.m20.1.1.cmml"><mi id="S3.p1.20.m20.1.1.3" xref="S3.p1.20.m20.1.1.3.cmml">H</mi><mo id="S3.p1.20.m20.1.1.2" xref="S3.p1.20.m20.1.1.2.cmml">=</mo><mrow id="S3.p1.20.m20.1.1.1.1" xref="S3.p1.20.m20.1.1.1.2.cmml"><mo id="S3.p1.20.m20.1.1.1.1.2" stretchy="false" xref="S3.p1.20.m20.1.1.1.2.cmml">{</mo><msubsup id="S3.p1.20.m20.1.1.1.1.1" xref="S3.p1.20.m20.1.1.1.1.1.cmml"><mi id="S3.p1.20.m20.1.1.1.1.1.2.2" xref="S3.p1.20.m20.1.1.1.1.1.2.2.cmml">h</mi><mi id="S3.p1.20.m20.1.1.1.1.1.3" xref="S3.p1.20.m20.1.1.1.1.1.3.cmml">i</mi><mi id="S3.p1.20.m20.1.1.1.1.1.2.3" xref="S3.p1.20.m20.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.p1.20.m20.1.1.1.1.3" stretchy="false" xref="S3.p1.20.m20.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.20.m20.1b"><apply id="S3.p1.20.m20.1.1.cmml" xref="S3.p1.20.m20.1.1"><eq id="S3.p1.20.m20.1.1.2.cmml" xref="S3.p1.20.m20.1.1.2"></eq><ci id="S3.p1.20.m20.1.1.3.cmml" xref="S3.p1.20.m20.1.1.3">𝐻</ci><set id="S3.p1.20.m20.1.1.1.2.cmml" xref="S3.p1.20.m20.1.1.1.1"><apply id="S3.p1.20.m20.1.1.1.1.1.cmml" xref="S3.p1.20.m20.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.20.m20.1.1.1.1.1.1.cmml" xref="S3.p1.20.m20.1.1.1.1.1">subscript</csymbol><apply id="S3.p1.20.m20.1.1.1.1.1.2.cmml" xref="S3.p1.20.m20.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.20.m20.1.1.1.1.1.2.1.cmml" xref="S3.p1.20.m20.1.1.1.1.1">superscript</csymbol><ci id="S3.p1.20.m20.1.1.1.1.1.2.2.cmml" xref="S3.p1.20.m20.1.1.1.1.1.2.2">ℎ</ci><ci id="S3.p1.20.m20.1.1.1.1.1.2.3.cmml" xref="S3.p1.20.m20.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.p1.20.m20.1.1.1.1.1.3.cmml" xref="S3.p1.20.m20.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.20.m20.1c">H=\{h^{l}_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.20.m20.1d">italic_H = { italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> be the set of <math alttext="T\times L" class="ltx_Math" display="inline" id="S3.p1.21.m21.1"><semantics id="S3.p1.21.m21.1a"><mrow id="S3.p1.21.m21.1.1" xref="S3.p1.21.m21.1.1.cmml"><mi id="S3.p1.21.m21.1.1.2" xref="S3.p1.21.m21.1.1.2.cmml">T</mi><mo id="S3.p1.21.m21.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.21.m21.1.1.1.cmml">×</mo><mi id="S3.p1.21.m21.1.1.3" xref="S3.p1.21.m21.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.21.m21.1b"><apply id="S3.p1.21.m21.1.1.cmml" xref="S3.p1.21.m21.1.1"><times id="S3.p1.21.m21.1.1.1.cmml" xref="S3.p1.21.m21.1.1.1"></times><ci id="S3.p1.21.m21.1.1.2.cmml" xref="S3.p1.21.m21.1.1.2">𝑇</ci><ci id="S3.p1.21.m21.1.1.3.cmml" xref="S3.p1.21.m21.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.21.m21.1c">T\times L</annotation><annotation encoding="application/x-llamapun" id="S3.p1.21.m21.1d">italic_T × italic_L</annotation></semantics></math> token hidden states across all layers (following <cite class="ltx_cite ltx_citemacro_citet">Elhage et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib13" title="">2021</a>)</cite>, we shall call them the <span class="ltx_text ltx_font_bold" id="S3.p1.26.3">residual stream outputs</span>), <math alttext="A=\{a^{l}_{i}\}" class="ltx_Math" display="inline" id="S3.p1.22.m22.1"><semantics id="S3.p1.22.m22.1a"><mrow id="S3.p1.22.m22.1.1" xref="S3.p1.22.m22.1.1.cmml"><mi id="S3.p1.22.m22.1.1.3" xref="S3.p1.22.m22.1.1.3.cmml">A</mi><mo id="S3.p1.22.m22.1.1.2" xref="S3.p1.22.m22.1.1.2.cmml">=</mo><mrow id="S3.p1.22.m22.1.1.1.1" xref="S3.p1.22.m22.1.1.1.2.cmml"><mo id="S3.p1.22.m22.1.1.1.1.2" stretchy="false" xref="S3.p1.22.m22.1.1.1.2.cmml">{</mo><msubsup id="S3.p1.22.m22.1.1.1.1.1" xref="S3.p1.22.m22.1.1.1.1.1.cmml"><mi id="S3.p1.22.m22.1.1.1.1.1.2.2" xref="S3.p1.22.m22.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.p1.22.m22.1.1.1.1.1.3" xref="S3.p1.22.m22.1.1.1.1.1.3.cmml">i</mi><mi id="S3.p1.22.m22.1.1.1.1.1.2.3" xref="S3.p1.22.m22.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.p1.22.m22.1.1.1.1.3" stretchy="false" xref="S3.p1.22.m22.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.22.m22.1b"><apply id="S3.p1.22.m22.1.1.cmml" xref="S3.p1.22.m22.1.1"><eq id="S3.p1.22.m22.1.1.2.cmml" xref="S3.p1.22.m22.1.1.2"></eq><ci id="S3.p1.22.m22.1.1.3.cmml" xref="S3.p1.22.m22.1.1.3">𝐴</ci><set id="S3.p1.22.m22.1.1.1.2.cmml" xref="S3.p1.22.m22.1.1.1.1"><apply id="S3.p1.22.m22.1.1.1.1.1.cmml" xref="S3.p1.22.m22.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m22.1.1.1.1.1.1.cmml" xref="S3.p1.22.m22.1.1.1.1.1">subscript</csymbol><apply id="S3.p1.22.m22.1.1.1.1.1.2.cmml" xref="S3.p1.22.m22.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m22.1.1.1.1.1.2.1.cmml" xref="S3.p1.22.m22.1.1.1.1.1">superscript</csymbol><ci id="S3.p1.22.m22.1.1.1.1.1.2.2.cmml" xref="S3.p1.22.m22.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.p1.22.m22.1.1.1.1.1.2.3.cmml" xref="S3.p1.22.m22.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.p1.22.m22.1.1.1.1.1.3.cmml" xref="S3.p1.22.m22.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.22.m22.1c">A=\{a^{l}_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.22.m22.1d">italic_A = { italic_a start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> be the set of <math alttext="T\times L" class="ltx_Math" display="inline" id="S3.p1.23.m23.1"><semantics id="S3.p1.23.m23.1a"><mrow id="S3.p1.23.m23.1.1" xref="S3.p1.23.m23.1.1.cmml"><mi id="S3.p1.23.m23.1.1.2" xref="S3.p1.23.m23.1.1.2.cmml">T</mi><mo id="S3.p1.23.m23.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.23.m23.1.1.1.cmml">×</mo><mi id="S3.p1.23.m23.1.1.3" xref="S3.p1.23.m23.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.23.m23.1b"><apply id="S3.p1.23.m23.1.1.cmml" xref="S3.p1.23.m23.1.1"><times id="S3.p1.23.m23.1.1.1.cmml" xref="S3.p1.23.m23.1.1.1"></times><ci id="S3.p1.23.m23.1.1.2.cmml" xref="S3.p1.23.m23.1.1.2">𝑇</ci><ci id="S3.p1.23.m23.1.1.3.cmml" xref="S3.p1.23.m23.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.23.m23.1c">T\times L</annotation><annotation encoding="application/x-llamapun" id="S3.p1.23.m23.1d">italic_T × italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S3.p1.26.4">attention outputs</span>, and <math alttext="M=\{m^{(l)}_{i}\}" class="ltx_Math" display="inline" id="S3.p1.24.m24.2"><semantics id="S3.p1.24.m24.2a"><mrow id="S3.p1.24.m24.2.2" xref="S3.p1.24.m24.2.2.cmml"><mi id="S3.p1.24.m24.2.2.3" xref="S3.p1.24.m24.2.2.3.cmml">M</mi><mo id="S3.p1.24.m24.2.2.2" xref="S3.p1.24.m24.2.2.2.cmml">=</mo><mrow id="S3.p1.24.m24.2.2.1.1" xref="S3.p1.24.m24.2.2.1.2.cmml"><mo id="S3.p1.24.m24.2.2.1.1.2" stretchy="false" xref="S3.p1.24.m24.2.2.1.2.cmml">{</mo><msubsup id="S3.p1.24.m24.2.2.1.1.1" xref="S3.p1.24.m24.2.2.1.1.1.cmml"><mi id="S3.p1.24.m24.2.2.1.1.1.2.2" xref="S3.p1.24.m24.2.2.1.1.1.2.2.cmml">m</mi><mi id="S3.p1.24.m24.2.2.1.1.1.3" xref="S3.p1.24.m24.2.2.1.1.1.3.cmml">i</mi><mrow id="S3.p1.24.m24.1.1.1.3" xref="S3.p1.24.m24.2.2.1.1.1.cmml"><mo id="S3.p1.24.m24.1.1.1.3.1" stretchy="false" xref="S3.p1.24.m24.2.2.1.1.1.cmml">(</mo><mi id="S3.p1.24.m24.1.1.1.1" xref="S3.p1.24.m24.1.1.1.1.cmml">l</mi><mo id="S3.p1.24.m24.1.1.1.3.2" stretchy="false" xref="S3.p1.24.m24.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.24.m24.2.2.1.1.3" stretchy="false" xref="S3.p1.24.m24.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.24.m24.2b"><apply id="S3.p1.24.m24.2.2.cmml" xref="S3.p1.24.m24.2.2"><eq id="S3.p1.24.m24.2.2.2.cmml" xref="S3.p1.24.m24.2.2.2"></eq><ci id="S3.p1.24.m24.2.2.3.cmml" xref="S3.p1.24.m24.2.2.3">𝑀</ci><set id="S3.p1.24.m24.2.2.1.2.cmml" xref="S3.p1.24.m24.2.2.1.1"><apply id="S3.p1.24.m24.2.2.1.1.1.cmml" xref="S3.p1.24.m24.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.24.m24.2.2.1.1.1.1.cmml" xref="S3.p1.24.m24.2.2.1.1.1">subscript</csymbol><apply id="S3.p1.24.m24.2.2.1.1.1.2.cmml" xref="S3.p1.24.m24.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.24.m24.2.2.1.1.1.2.1.cmml" xref="S3.p1.24.m24.2.2.1.1.1">superscript</csymbol><ci id="S3.p1.24.m24.2.2.1.1.1.2.2.cmml" xref="S3.p1.24.m24.2.2.1.1.1.2.2">𝑚</ci><ci id="S3.p1.24.m24.1.1.1.1.cmml" xref="S3.p1.24.m24.1.1.1.1">𝑙</ci></apply><ci id="S3.p1.24.m24.2.2.1.1.1.3.cmml" xref="S3.p1.24.m24.2.2.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.24.m24.2c">M=\{m^{(l)}_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.24.m24.2d">italic_M = { italic_m start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> be the set of <math alttext="T\times L" class="ltx_Math" display="inline" id="S3.p1.25.m25.1"><semantics id="S3.p1.25.m25.1a"><mrow id="S3.p1.25.m25.1.1" xref="S3.p1.25.m25.1.1.cmml"><mi id="S3.p1.25.m25.1.1.2" xref="S3.p1.25.m25.1.1.2.cmml">T</mi><mo id="S3.p1.25.m25.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.25.m25.1.1.1.cmml">×</mo><mi id="S3.p1.25.m25.1.1.3" xref="S3.p1.25.m25.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.25.m25.1b"><apply id="S3.p1.25.m25.1.1.cmml" xref="S3.p1.25.m25.1.1"><times id="S3.p1.25.m25.1.1.1.cmml" xref="S3.p1.25.m25.1.1.1"></times><ci id="S3.p1.25.m25.1.1.2.cmml" xref="S3.p1.25.m25.1.1.2">𝑇</ci><ci id="S3.p1.25.m25.1.1.3.cmml" xref="S3.p1.25.m25.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.25.m25.1c">T\times L</annotation><annotation encoding="application/x-llamapun" id="S3.p1.25.m25.1d">italic_T × italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S3.p1.26.5">MLP outputs</span>. We aim to investigate which intermediate hidden representations <math alttext="z\in Z=H\bigcup A\bigcup M" class="ltx_Math" display="inline" id="S3.p1.26.m26.1"><semantics id="S3.p1.26.m26.1a"><mrow id="S3.p1.26.m26.1.1" xref="S3.p1.26.m26.1.1.cmml"><mi id="S3.p1.26.m26.1.1.2" xref="S3.p1.26.m26.1.1.2.cmml">z</mi><mo id="S3.p1.26.m26.1.1.3" xref="S3.p1.26.m26.1.1.3.cmml">∈</mo><mi id="S3.p1.26.m26.1.1.4" xref="S3.p1.26.m26.1.1.4.cmml">Z</mi><mo id="S3.p1.26.m26.1.1.5" xref="S3.p1.26.m26.1.1.5.cmml">=</mo><mrow id="S3.p1.26.m26.1.1.6" xref="S3.p1.26.m26.1.1.6.cmml"><mi id="S3.p1.26.m26.1.1.6.2" xref="S3.p1.26.m26.1.1.6.2.cmml">H</mi><mo id="S3.p1.26.m26.1.1.6.1" xref="S3.p1.26.m26.1.1.6.1.cmml">⁢</mo><mrow id="S3.p1.26.m26.1.1.6.3" xref="S3.p1.26.m26.1.1.6.3.cmml"><mo id="S3.p1.26.m26.1.1.6.3.1" xref="S3.p1.26.m26.1.1.6.3.1.cmml">⋃</mo><mrow id="S3.p1.26.m26.1.1.6.3.2" xref="S3.p1.26.m26.1.1.6.3.2.cmml"><mi id="S3.p1.26.m26.1.1.6.3.2.2" xref="S3.p1.26.m26.1.1.6.3.2.2.cmml">A</mi><mo id="S3.p1.26.m26.1.1.6.3.2.1" xref="S3.p1.26.m26.1.1.6.3.2.1.cmml">⁢</mo><mrow id="S3.p1.26.m26.1.1.6.3.2.3" xref="S3.p1.26.m26.1.1.6.3.2.3.cmml"><mo id="S3.p1.26.m26.1.1.6.3.2.3.1" xref="S3.p1.26.m26.1.1.6.3.2.3.1.cmml">⋃</mo><mi id="S3.p1.26.m26.1.1.6.3.2.3.2" xref="S3.p1.26.m26.1.1.6.3.2.3.2.cmml">M</mi></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.26.m26.1b"><apply id="S3.p1.26.m26.1.1.cmml" xref="S3.p1.26.m26.1.1"><and id="S3.p1.26.m26.1.1a.cmml" xref="S3.p1.26.m26.1.1"></and><apply id="S3.p1.26.m26.1.1b.cmml" xref="S3.p1.26.m26.1.1"><in id="S3.p1.26.m26.1.1.3.cmml" xref="S3.p1.26.m26.1.1.3"></in><ci id="S3.p1.26.m26.1.1.2.cmml" xref="S3.p1.26.m26.1.1.2">𝑧</ci><ci id="S3.p1.26.m26.1.1.4.cmml" xref="S3.p1.26.m26.1.1.4">𝑍</ci></apply><apply id="S3.p1.26.m26.1.1c.cmml" xref="S3.p1.26.m26.1.1"><eq id="S3.p1.26.m26.1.1.5.cmml" xref="S3.p1.26.m26.1.1.5"></eq><share href="#S3.p1.26.m26.1.1.4.cmml" id="S3.p1.26.m26.1.1d.cmml" xref="S3.p1.26.m26.1.1"></share><apply id="S3.p1.26.m26.1.1.6.cmml" xref="S3.p1.26.m26.1.1.6"><times id="S3.p1.26.m26.1.1.6.1.cmml" xref="S3.p1.26.m26.1.1.6.1"></times><ci id="S3.p1.26.m26.1.1.6.2.cmml" xref="S3.p1.26.m26.1.1.6.2">𝐻</ci><apply id="S3.p1.26.m26.1.1.6.3.cmml" xref="S3.p1.26.m26.1.1.6.3"><union id="S3.p1.26.m26.1.1.6.3.1.cmml" xref="S3.p1.26.m26.1.1.6.3.1"></union><apply id="S3.p1.26.m26.1.1.6.3.2.cmml" xref="S3.p1.26.m26.1.1.6.3.2"><times id="S3.p1.26.m26.1.1.6.3.2.1.cmml" xref="S3.p1.26.m26.1.1.6.3.2.1"></times><ci id="S3.p1.26.m26.1.1.6.3.2.2.cmml" xref="S3.p1.26.m26.1.1.6.3.2.2">𝐴</ci><apply id="S3.p1.26.m26.1.1.6.3.2.3.cmml" xref="S3.p1.26.m26.1.1.6.3.2.3"><union id="S3.p1.26.m26.1.1.6.3.2.3.1.cmml" xref="S3.p1.26.m26.1.1.6.3.2.3.1"></union><ci id="S3.p1.26.m26.1.1.6.3.2.3.2.cmml" xref="S3.p1.26.m26.1.1.6.3.2.3.2">𝑀</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.26.m26.1c">z\in Z=H\bigcup A\bigcup M</annotation><annotation encoding="application/x-llamapun" id="S3.p1.26.m26.1d">italic_z ∈ italic_Z = italic_H ⋃ italic_A ⋃ italic_M</annotation></semantics></math> are causally contributing to the generation of a factually incorrect entity. For further details on transformers, see <cite class="ltx_cite ltx_citemacro_citet">Vaswani et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib49" title="">2017</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Mechanisms of Hallucinations</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Causal tracing of factual errors</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Method.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.2">The intermediate hidden states <math alttext="H" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">italic_H</annotation></semantics></math> produced by <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.2.m2.1d">italic_G</annotation></semantics></math> during model inference form a causal dependency graph <cite class="ltx_cite ltx_citemacro_cite">Pearl (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib39" title="">2001</a>)</cite> that contains many paths from the input sequence to the output (next-token prediction), and we wish to understand if there are specific hidden states that are more important than others when producing a hallucination. This is a natural case for <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.2.1">causal mediation analysis</span>, which quantifies the contribution of intermediate variables in causal graphs. For more information about causal mediation analysis of language models, see <cite class="ltx_cite ltx_citemacro_citet">Vig et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib50" title="">2020</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p2.11">We adapt the framework of <cite class="ltx_cite ltx_citemacro_citet">Meng et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite> to locate LM components that cause factual errors via the task of factual open-domain questions on structured queries. In particular, given a fact represented as a subject-relation-object triple <math alttext="(s,r,o)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.1.m1.3"><semantics id="S4.SS1.SSS0.Px1.p2.1.m1.3a"><mrow id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml"><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.2.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.3.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.3.cmml">o</mi><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.4" stretchy="false" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.1.m1.3b"><vector id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2"><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p2.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.2.2">𝑟</ci><ci id="S4.SS1.SSS0.Px1.p2.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.3">𝑜</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.1.m1.3c">(s,r,o)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.1.m1.3d">( italic_s , italic_r , italic_o )</annotation></semantics></math>, we provide an LM <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p2.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.2.m2.1d">italic_G</annotation></semantics></math> with a query prompt <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p2.3.m3.1a"><mi id="S4.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.3.m3.1b"><ci id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.3.m3.1d">italic_u</annotation></semantics></math> containing <math alttext="(s,r)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.4.m4.2"><semantics id="S4.SS1.SSS0.Px1.p2.4.m4.2a"><mrow id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml"><mo id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p2.4.m4.2.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2.3" stretchy="false" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.4.m4.2b"><interval closure="open" id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2"><ci id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p2.4.m4.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.2">𝑟</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.4.m4.2c">(s,r)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.4.m4.2d">( italic_s , italic_r )</annotation></semantics></math> (e.g., “Toulouse is the twin city of __”) with <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.5.m5.1"><semantics id="S4.SS1.SSS0.Px1.p2.5.m5.1a"><mi id="S4.SS1.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.5.m5.1b"><ci id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.5.m5.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.5.m5.1d">italic_o</annotation></semantics></math> as a true continuation (e.g., “Atlanta”). We examine the cases where <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.6.m6.1"><semantics id="S4.SS1.SSS0.Px1.p2.6.m6.1a"><mi id="S4.SS1.SSS0.Px1.p2.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.6.m6.1b"><ci id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.6.m6.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.6.m6.1d">italic_G</annotation></semantics></math> predicts an incorrect object <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.7.m7.1"><semantics id="S4.SS1.SSS0.Px1.p2.7.m7.1a"><msup id="S4.SS1.SSS0.Px1.p2.7.m7.1.1" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.7.m7.1b"><apply id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.7.m7.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.7.m7.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> as the next token(s) given <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.8.m8.1"><semantics id="S4.SS1.SSS0.Px1.p2.8.m8.1a"><mi id="S4.SS1.SSS0.Px1.p2.8.m8.1.1" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.8.m8.1b"><ci id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.8.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.8.m8.1d">italic_u</annotation></semantics></math>, and aim to locate which intermediate hidden states in the computation graph of <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.9.m9.1"><semantics id="S4.SS1.SSS0.Px1.p2.9.m9.1a"><mi id="S4.SS1.SSS0.Px1.p2.9.m9.1.1" xref="S4.SS1.SSS0.Px1.p2.9.m9.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.9.m9.1b"><ci id="S4.SS1.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.9.m9.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.9.m9.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.9.m9.1d">italic_G</annotation></semantics></math> led to the hallucination. We consider <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.10.m10.1"><semantics id="S4.SS1.SSS0.Px1.p2.10.m10.1a"><mi id="S4.SS1.SSS0.Px1.p2.10.m10.1.1" xref="S4.SS1.SSS0.Px1.p2.10.m10.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.10.m10.1b"><ci id="S4.SS1.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.10.m10.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.10.m10.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.10.m10.1d">italic_G</annotation></semantics></math> to be a “corrupted” model with certain modules failing to compute the “clean” representations that could otherwise lead to the correct answer <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.11.m11.1"><semantics id="S4.SS1.SSS0.Px1.p2.11.m11.1a"><mi id="S4.SS1.SSS0.Px1.p2.11.m11.1.1" xref="S4.SS1.SSS0.Px1.p2.11.m11.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.11.m11.1b"><ci id="S4.SS1.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.11.m11.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.11.m11.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.11.m11.1d">italic_o</annotation></semantics></math>, and measure the contribution of each module through three model runs:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p3">
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.6">In the <span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.6.1">hallucination run</span>, we pass <math alttext="u" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><mi id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><ci id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">italic_u</annotation></semantics></math> into <math alttext="G" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><mi id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><ci id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">italic_G</annotation></semantics></math> and extract all intermediate hidden representations <math alttext="Z" class="ltx_Math" display="inline" id="S4.I1.i1.p1.3.m3.1"><semantics id="S4.I1.i1.p1.3.m3.1a"><mi id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><ci id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.1d">italic_Z</annotation></semantics></math> as defined in Section&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S3" title="3 Background and Notation ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, and compute the log likelihood ratio <math alttext="y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.4.m4.4"><semantics id="S4.I1.i1.p1.4.m4.4a"><mrow id="S4.I1.i1.p1.4.m4.4.5" xref="S4.I1.i1.p1.4.m4.4.5.cmml"><mi id="S4.I1.i1.p1.4.m4.4.5.2" xref="S4.I1.i1.p1.4.m4.4.5.2.cmml">y</mi><mo id="S4.I1.i1.p1.4.m4.4.5.1" xref="S4.I1.i1.p1.4.m4.4.5.1.cmml">=</mo><mrow id="S4.I1.i1.p1.4.m4.4.5.3" xref="S4.I1.i1.p1.4.m4.4.5.3.cmml"><mi id="S4.I1.i1.p1.4.m4.4.5.3.1" xref="S4.I1.i1.p1.4.m4.4.5.3.1.cmml">log</mi><mo id="S4.I1.i1.p1.4.m4.4.5.3a" lspace="0.167em" xref="S4.I1.i1.p1.4.m4.4.5.3.cmml">⁡</mo><mfrac id="S4.I1.i1.p1.4.m4.4.4" xref="S4.I1.i1.p1.4.m4.4.4.cmml"><mrow id="S4.I1.i1.p1.4.m4.2.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.4" xref="S4.I1.i1.p1.4.m4.2.2.2.4.cmml">p</mi><mo id="S4.I1.i1.p1.4.m4.2.2.2.3" xref="S4.I1.i1.p1.4.m4.2.2.2.3.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml"><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml"><msup id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2.cmml">o</mi><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2.cmml">E</mi><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.3.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.3.2.1" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml">(</mo><mi id="S4.I1.i1.p1.4.m4.1.1.1.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.3.2.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.3" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.I1.i1.p1.4.m4.4.4.4" xref="S4.I1.i1.p1.4.m4.4.4.4.cmml"><mi id="S4.I1.i1.p1.4.m4.4.4.4.4" xref="S4.I1.i1.p1.4.m4.4.4.4.4.cmml">p</mi><mo id="S4.I1.i1.p1.4.m4.4.4.4.3" xref="S4.I1.i1.p1.4.m4.4.4.4.3.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml"><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml">(</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml"><mi id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2.cmml">o</mi><mo fence="false" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mi id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2.cmml">E</mi><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.3.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.3.2.1" stretchy="false" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml">(</mo><mi id="S4.I1.i1.p1.4.m4.3.3.3.1" xref="S4.I1.i1.p1.4.m4.3.3.3.1.cmml">u</mi><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.3.2.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.3" stretchy="false" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.4b"><apply id="S4.I1.i1.p1.4.m4.4.5.cmml" xref="S4.I1.i1.p1.4.m4.4.5"><eq id="S4.I1.i1.p1.4.m4.4.5.1.cmml" xref="S4.I1.i1.p1.4.m4.4.5.1"></eq><ci id="S4.I1.i1.p1.4.m4.4.5.2.cmml" xref="S4.I1.i1.p1.4.m4.4.5.2">𝑦</ci><apply id="S4.I1.i1.p1.4.m4.4.5.3.cmml" xref="S4.I1.i1.p1.4.m4.4.5.3"><log id="S4.I1.i1.p1.4.m4.4.5.3.1.cmml" xref="S4.I1.i1.p1.4.m4.4.5.3.1"></log><apply id="S4.I1.i1.p1.4.m4.4.4.cmml" xref="S4.I1.i1.p1.4.m4.4.4"><divide id="S4.I1.i1.p1.4.m4.4.4.5.cmml" xref="S4.I1.i1.p1.4.m4.4.4"></divide><apply id="S4.I1.i1.p1.4.m4.2.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2"><times id="S4.I1.i1.p1.4.m4.2.2.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.3"></times><ci id="S4.I1.i1.p1.4.m4.2.2.2.4.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.4">𝑝</ci><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1">conditional</csymbol><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2">superscript</csymbol><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2">𝑜</ci><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3">′</ci></apply><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3"><times id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1"></times><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2">𝐸</ci><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="S4.I1.i1.p1.4.m4.4.4.4.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4"><times id="S4.I1.i1.p1.4.m4.4.4.4.3.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.3"></times><ci id="S4.I1.i1.p1.4.m4.4.4.4.4.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.4">𝑝</ci><apply id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1"><csymbol cd="latexml" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1">conditional</csymbol><ci id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2">𝑜</ci><apply id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3"><times id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1"></times><ci id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2">𝐸</ci><ci id="S4.I1.i1.p1.4.m4.3.3.3.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.1">𝑢</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.4c">y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.4.m4.4d">italic_y = roman_log divide start_ARG italic_p ( italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_E ( italic_u ) ) end_ARG start_ARG italic_p ( italic_o | italic_E ( italic_u ) ) end_ARG</annotation></semantics></math> between the true and hallucinated objects, which quantifies the “degree of hallucination” of <math alttext="G" class="ltx_Math" display="inline" id="S4.I1.i1.p1.5.m5.1"><semantics id="S4.I1.i1.p1.5.m5.1a"><mi id="S4.I1.i1.p1.5.m5.1.1" xref="S4.I1.i1.p1.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.5.m5.1b"><ci id="S4.I1.i1.p1.5.m5.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.5.m5.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.5.m5.1d">italic_G</annotation></semantics></math>. For a hallucinating prediction, we would observe <math alttext="y>0" class="ltx_Math" display="inline" id="S4.I1.i1.p1.6.m6.1"><semantics id="S4.I1.i1.p1.6.m6.1a"><mrow id="S4.I1.i1.p1.6.m6.1.1" xref="S4.I1.i1.p1.6.m6.1.1.cmml"><mi id="S4.I1.i1.p1.6.m6.1.1.2" xref="S4.I1.i1.p1.6.m6.1.1.2.cmml">y</mi><mo id="S4.I1.i1.p1.6.m6.1.1.1" xref="S4.I1.i1.p1.6.m6.1.1.1.cmml">&gt;</mo><mn id="S4.I1.i1.p1.6.m6.1.1.3" xref="S4.I1.i1.p1.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.6.m6.1b"><apply id="S4.I1.i1.p1.6.m6.1.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1"><gt id="S4.I1.i1.p1.6.m6.1.1.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1.1"></gt><ci id="S4.I1.i1.p1.6.m6.1.1.2.cmml" xref="S4.I1.i1.p1.6.m6.1.1.2">𝑦</ci><cn id="S4.I1.i1.p1.6.m6.1.1.3.cmml" type="integer" xref="S4.I1.i1.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.6.m6.1c">y&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.6.m6.1d">italic_y &gt; 0</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.5">In the <span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.5.1">mitigation run</span>, we follow <cite class="ltx_cite ltx_citemacro_citet">Meng et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite> and add a Gaussian noise <math alttext="\epsilon\sim\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.2"><semantics id="S4.I1.i2.p1.1.m1.2a"><mrow id="S4.I1.i2.p1.1.m1.2.3" xref="S4.I1.i2.p1.1.m1.2.3.cmml"><mi id="S4.I1.i2.p1.1.m1.2.3.2" xref="S4.I1.i2.p1.1.m1.2.3.2.cmml">ϵ</mi><mo id="S4.I1.i2.p1.1.m1.2.3.1" xref="S4.I1.i2.p1.1.m1.2.3.1.cmml">∼</mo><mrow id="S4.I1.i2.p1.1.m1.2.3.3" xref="S4.I1.i2.p1.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.1.m1.2.3.3.2" xref="S4.I1.i2.p1.1.m1.2.3.3.2.cmml">𝒩</mi><mo id="S4.I1.i2.p1.1.m1.2.3.3.1" xref="S4.I1.i2.p1.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.1.m1.2.3.3.3.2" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml"><mo id="S4.I1.i2.p1.1.m1.2.3.3.3.2.1" stretchy="false" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml">(</mo><mn id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">0</mn><mo id="S4.I1.i2.p1.1.m1.2.3.3.3.2.2" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml">,</mo><mn id="S4.I1.i2.p1.1.m1.2.2" xref="S4.I1.i2.p1.1.m1.2.2.cmml">1</mn><mo id="S4.I1.i2.p1.1.m1.2.3.3.3.2.3" stretchy="false" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.2b"><apply id="S4.I1.i2.p1.1.m1.2.3.cmml" xref="S4.I1.i2.p1.1.m1.2.3"><csymbol cd="latexml" id="S4.I1.i2.p1.1.m1.2.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.1">similar-to</csymbol><ci id="S4.I1.i2.p1.1.m1.2.3.2.cmml" xref="S4.I1.i2.p1.1.m1.2.3.2">italic-ϵ</ci><apply id="S4.I1.i2.p1.1.m1.2.3.3.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3"><times id="S4.I1.i2.p1.1.m1.2.3.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3.1"></times><ci id="S4.I1.i2.p1.1.m1.2.3.3.2.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3.2">𝒩</ci><interval closure="open" id="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3.3.2"><cn id="S4.I1.i2.p1.1.m1.1.1.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.1.1">0</cn><cn id="S4.I1.i2.p1.1.m1.2.2.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.2c">\epsilon\sim\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.2d">italic_ϵ ∼ caligraphic_N ( 0 , 1 )</annotation></semantics></math> to the input token embeddings <math alttext="E(u)" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.1"><semantics id="S4.I1.i2.p1.2.m2.1a"><mrow id="S4.I1.i2.p1.2.m2.1.2" xref="S4.I1.i2.p1.2.m2.1.2.cmml"><mi id="S4.I1.i2.p1.2.m2.1.2.2" xref="S4.I1.i2.p1.2.m2.1.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.2.m2.1.2.1" xref="S4.I1.i2.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.2.m2.1.2.3.2" xref="S4.I1.i2.p1.2.m2.1.2.cmml"><mo id="S4.I1.i2.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S4.I1.i2.p1.2.m2.1.2.cmml">(</mo><mi id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">u</mi><mo id="S4.I1.i2.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S4.I1.i2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.2"><times id="S4.I1.i2.p1.2.m2.1.2.1.cmml" xref="S4.I1.i2.p1.2.m2.1.2.1"></times><ci id="S4.I1.i2.p1.2.m2.1.2.2.cmml" xref="S4.I1.i2.p1.2.m2.1.2.2">𝐸</ci><ci id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">E(u)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.1d">italic_E ( italic_u )</annotation></semantics></math>, so that when taking the intervened <math alttext="E^{*}(u)=E(u)+\epsilon" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.2"><semantics id="S4.I1.i2.p1.3.m3.2a"><mrow id="S4.I1.i2.p1.3.m3.2.3" xref="S4.I1.i2.p1.3.m3.2.3.cmml"><mrow id="S4.I1.i2.p1.3.m3.2.3.2" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml"><msup id="S4.I1.i2.p1.3.m3.2.3.2.2" xref="S4.I1.i2.p1.3.m3.2.3.2.2.cmml"><mi id="S4.I1.i2.p1.3.m3.2.3.2.2.2" xref="S4.I1.i2.p1.3.m3.2.3.2.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.3.m3.2.3.2.2.3" xref="S4.I1.i2.p1.3.m3.2.3.2.2.3.cmml">*</mo></msup><mo id="S4.I1.i2.p1.3.m3.2.3.2.1" xref="S4.I1.i2.p1.3.m3.2.3.2.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.3.m3.2.3.2.3.2" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml"><mo id="S4.I1.i2.p1.3.m3.2.3.2.3.2.1" stretchy="false" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml">(</mo><mi id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml">u</mi><mo id="S4.I1.i2.p1.3.m3.2.3.2.3.2.2" stretchy="false" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.I1.i2.p1.3.m3.2.3.1" xref="S4.I1.i2.p1.3.m3.2.3.1.cmml">=</mo><mrow id="S4.I1.i2.p1.3.m3.2.3.3" xref="S4.I1.i2.p1.3.m3.2.3.3.cmml"><mrow id="S4.I1.i2.p1.3.m3.2.3.3.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml"><mi id="S4.I1.i2.p1.3.m3.2.3.3.2.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.3.m3.2.3.3.2.1" xref="S4.I1.i2.p1.3.m3.2.3.3.2.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.3.m3.2.3.3.2.3.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml"><mo id="S4.I1.i2.p1.3.m3.2.3.3.2.3.2.1" stretchy="false" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml">(</mo><mi id="S4.I1.i2.p1.3.m3.2.2" xref="S4.I1.i2.p1.3.m3.2.2.cmml">u</mi><mo id="S4.I1.i2.p1.3.m3.2.3.3.2.3.2.2" stretchy="false" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml">)</mo></mrow></mrow><mo id="S4.I1.i2.p1.3.m3.2.3.3.1" xref="S4.I1.i2.p1.3.m3.2.3.3.1.cmml">+</mo><mi id="S4.I1.i2.p1.3.m3.2.3.3.3" xref="S4.I1.i2.p1.3.m3.2.3.3.3.cmml">ϵ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.2b"><apply id="S4.I1.i2.p1.3.m3.2.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3"><eq id="S4.I1.i2.p1.3.m3.2.3.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.1"></eq><apply id="S4.I1.i2.p1.3.m3.2.3.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2"><times id="S4.I1.i2.p1.3.m3.2.3.2.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.1"></times><apply id="S4.I1.i2.p1.3.m3.2.3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.2.3.2.2.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2">superscript</csymbol><ci id="S4.I1.i2.p1.3.m3.2.3.2.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2.2">𝐸</ci><times id="S4.I1.i2.p1.3.m3.2.3.2.2.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2.3"></times></apply><ci id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">𝑢</ci></apply><apply id="S4.I1.i2.p1.3.m3.2.3.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3"><plus id="S4.I1.i2.p1.3.m3.2.3.3.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.1"></plus><apply id="S4.I1.i2.p1.3.m3.2.3.3.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.2"><times id="S4.I1.i2.p1.3.m3.2.3.3.2.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.2.1"></times><ci id="S4.I1.i2.p1.3.m3.2.3.3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.2.2">𝐸</ci><ci id="S4.I1.i2.p1.3.m3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.2">𝑢</ci></apply><ci id="S4.I1.i2.p1.3.m3.2.3.3.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.2c">E^{*}(u)=E(u)+\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.2d">italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) = italic_E ( italic_u ) + italic_ϵ</annotation></semantics></math> as inputs, the log-likelihood ratio between the hallucinated and the factual object would decrease
(i.e., we only take noises with <math alttext="y_{*}=\log\frac{p(o^{\prime}|E^{*}(u))}{p(o|E^{*}(u))}<y" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m4.4"><semantics id="S4.I1.i2.p1.4.m4.4a"><mrow id="S4.I1.i2.p1.4.m4.4.5" xref="S4.I1.i2.p1.4.m4.4.5.cmml"><msub id="S4.I1.i2.p1.4.m4.4.5.2" xref="S4.I1.i2.p1.4.m4.4.5.2.cmml"><mi id="S4.I1.i2.p1.4.m4.4.5.2.2" xref="S4.I1.i2.p1.4.m4.4.5.2.2.cmml">y</mi><mo id="S4.I1.i2.p1.4.m4.4.5.2.3" xref="S4.I1.i2.p1.4.m4.4.5.2.3.cmml">*</mo></msub><mo id="S4.I1.i2.p1.4.m4.4.5.3" xref="S4.I1.i2.p1.4.m4.4.5.3.cmml">=</mo><mrow id="S4.I1.i2.p1.4.m4.4.5.4" xref="S4.I1.i2.p1.4.m4.4.5.4.cmml"><mi id="S4.I1.i2.p1.4.m4.4.5.4.1" xref="S4.I1.i2.p1.4.m4.4.5.4.1.cmml">log</mi><mo id="S4.I1.i2.p1.4.m4.4.5.4a" lspace="0.167em" xref="S4.I1.i2.p1.4.m4.4.5.4.cmml">⁡</mo><mfrac id="S4.I1.i2.p1.4.m4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.cmml"><mrow id="S4.I1.i2.p1.4.m4.2.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.2.4" xref="S4.I1.i2.p1.4.m4.2.2.2.4.cmml">p</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.3" xref="S4.I1.i2.p1.4.m4.2.2.2.3.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml"><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml"><msup id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2.cmml">o</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml"><msup id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3.cmml">*</mo></msup><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.3.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml"><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.3.2.1" stretchy="false" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml">(</mo><mi id="S4.I1.i2.p1.4.m4.1.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.3.2.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.3" stretchy="false" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.I1.i2.p1.4.m4.4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.4.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.4.4.cmml">p</mi><mo id="S4.I1.i2.p1.4.m4.4.4.4.3" xref="S4.I1.i2.p1.4.m4.4.4.4.3.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml"><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2.cmml">o</mi><mo fence="false" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml"><msup id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3.cmml">*</mo></msup><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.3.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml"><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.3.2.1" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml">(</mo><mi id="S4.I1.i2.p1.4.m4.3.3.3.1" xref="S4.I1.i2.p1.4.m4.3.3.3.1.cmml">u</mi><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.3.2.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.3" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S4.I1.i2.p1.4.m4.4.5.5" xref="S4.I1.i2.p1.4.m4.4.5.5.cmml">&lt;</mo><mi id="S4.I1.i2.p1.4.m4.4.5.6" xref="S4.I1.i2.p1.4.m4.4.5.6.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.4b"><apply id="S4.I1.i2.p1.4.m4.4.5.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><and id="S4.I1.i2.p1.4.m4.4.5a.cmml" xref="S4.I1.i2.p1.4.m4.4.5"></and><apply id="S4.I1.i2.p1.4.m4.4.5b.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><eq id="S4.I1.i2.p1.4.m4.4.5.3.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3"></eq><apply id="S4.I1.i2.p1.4.m4.4.5.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.4.5.2.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2">subscript</csymbol><ci id="S4.I1.i2.p1.4.m4.4.5.2.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2.2">𝑦</ci><times id="S4.I1.i2.p1.4.m4.4.5.2.3.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2.3"></times></apply><apply id="S4.I1.i2.p1.4.m4.4.5.4.cmml" xref="S4.I1.i2.p1.4.m4.4.5.4"><log id="S4.I1.i2.p1.4.m4.4.5.4.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.4.1"></log><apply id="S4.I1.i2.p1.4.m4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4"><divide id="S4.I1.i2.p1.4.m4.4.4.5.cmml" xref="S4.I1.i2.p1.4.m4.4.4"></divide><apply id="S4.I1.i2.p1.4.m4.2.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2"><times id="S4.I1.i2.p1.4.m4.2.2.2.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.3"></times><ci id="S4.I1.i2.p1.4.m4.2.2.2.4.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.4">𝑝</ci><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1">conditional</csymbol><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2">𝑜</ci><ci id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3">′</ci></apply><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3"><times id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1"></times><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2">𝐸</ci><times id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3"></times></apply><ci id="S4.I1.i2.p1.4.m4.1.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="S4.I1.i2.p1.4.m4.4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4"><times id="S4.I1.i2.p1.4.m4.4.4.4.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.3"></times><ci id="S4.I1.i2.p1.4.m4.4.4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.4">𝑝</ci><apply id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1"><csymbol cd="latexml" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1">conditional</csymbol><ci id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2">𝑜</ci><apply id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3"><times id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1"></times><apply id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2">𝐸</ci><times id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3"></times></apply><ci id="S4.I1.i2.p1.4.m4.3.3.3.1.cmml" xref="S4.I1.i2.p1.4.m4.3.3.3.1">𝑢</ci></apply></apply></apply></apply></apply></apply><apply id="S4.I1.i2.p1.4.m4.4.5c.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><lt id="S4.I1.i2.p1.4.m4.4.5.5.cmml" xref="S4.I1.i2.p1.4.m4.4.5.5"></lt><share href="#S4.I1.i2.p1.4.m4.4.5.4.cmml" id="S4.I1.i2.p1.4.m4.4.5d.cmml" xref="S4.I1.i2.p1.4.m4.4.5"></share><ci id="S4.I1.i2.p1.4.m4.4.5.6.cmml" xref="S4.I1.i2.p1.4.m4.4.5.6">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.4c">y_{*}=\log\frac{p(o^{\prime}|E^{*}(u))}{p(o|E^{*}(u))}&lt;y</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m4.4d">italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT = roman_log divide start_ARG italic_p ( italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) ) end_ARG start_ARG italic_p ( italic_o | italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) ) end_ARG &lt; italic_y</annotation></semantics></math>, indicating that the model becomes more “truthful” after noise injections). We again extract all intermediate hidden representations, denoted as <math alttext="Z^{*}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.5.m5.1"><semantics id="S4.I1.i2.p1.5.m5.1a"><msup id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.2" xref="S4.I1.i2.p1.5.m5.1.1.2.cmml">Z</mi><mo id="S4.I1.i2.p1.5.m5.1.1.3" xref="S4.I1.i2.p1.5.m5.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><apply id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.5.m5.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">superscript</csymbol><ci id="S4.I1.i2.p1.5.m5.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.2">𝑍</ci><times id="S4.I1.i2.p1.5.m5.1.1.3.cmml" xref="S4.I1.i2.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">Z^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.5.m5.1d">italic_Z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.7">In the <span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.7.1">mitigation-with-hallucination-state run</span>, we run <math alttext="G" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.1"><semantics id="S4.I1.i3.p1.1.m1.1a"><mi id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><ci id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.1d">italic_G</annotation></semantics></math> on <math alttext="u" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.m2.1"><semantics id="S4.I1.i3.p1.2.m2.1a"><mi id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><ci id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.m2.1d">italic_u</annotation></semantics></math> with perturbed input embeddings <math alttext="E^{*}(u)" class="ltx_Math" display="inline" id="S4.I1.i3.p1.3.m3.1"><semantics id="S4.I1.i3.p1.3.m3.1a"><mrow id="S4.I1.i3.p1.3.m3.1.2" xref="S4.I1.i3.p1.3.m3.1.2.cmml"><msup id="S4.I1.i3.p1.3.m3.1.2.2" xref="S4.I1.i3.p1.3.m3.1.2.2.cmml"><mi id="S4.I1.i3.p1.3.m3.1.2.2.2" xref="S4.I1.i3.p1.3.m3.1.2.2.2.cmml">E</mi><mo id="S4.I1.i3.p1.3.m3.1.2.2.3" xref="S4.I1.i3.p1.3.m3.1.2.2.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.3.m3.1.2.1" xref="S4.I1.i3.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.I1.i3.p1.3.m3.1.2.3.2" xref="S4.I1.i3.p1.3.m3.1.2.cmml"><mo id="S4.I1.i3.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S4.I1.i3.p1.3.m3.1.2.cmml">(</mo><mi id="S4.I1.i3.p1.3.m3.1.1" xref="S4.I1.i3.p1.3.m3.1.1.cmml">u</mi><mo id="S4.I1.i3.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S4.I1.i3.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m3.1b"><apply id="S4.I1.i3.p1.3.m3.1.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2"><times id="S4.I1.i3.p1.3.m3.1.2.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.1"></times><apply id="S4.I1.i3.p1.3.m3.1.2.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.3.m3.1.2.2.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2">superscript</csymbol><ci id="S4.I1.i3.p1.3.m3.1.2.2.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.2">𝐸</ci><times id="S4.I1.i3.p1.3.m3.1.2.2.3.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.3"></times></apply><ci id="S4.I1.i3.p1.3.m3.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m3.1c">E^{*}(u)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.3.m3.1d">italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u )</annotation></semantics></math> as in the mitigation run, and hook <math alttext="G" class="ltx_Math" display="inline" id="S4.I1.i3.p1.4.m4.1"><semantics id="S4.I1.i3.p1.4.m4.1a"><mi id="S4.I1.i3.p1.4.m4.1.1" xref="S4.I1.i3.p1.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.4.m4.1b"><ci id="S4.I1.i3.p1.4.m4.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.4.m4.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.4.m4.1d">italic_G</annotation></semantics></math> by forcing a particular hidden representation <math alttext="z^{*}\in Z^{*}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.5.m5.1"><semantics id="S4.I1.i3.p1.5.m5.1a"><mrow id="S4.I1.i3.p1.5.m5.1.1" xref="S4.I1.i3.p1.5.m5.1.1.cmml"><msup id="S4.I1.i3.p1.5.m5.1.1.2" xref="S4.I1.i3.p1.5.m5.1.1.2.cmml"><mi id="S4.I1.i3.p1.5.m5.1.1.2.2" xref="S4.I1.i3.p1.5.m5.1.1.2.2.cmml">z</mi><mo id="S4.I1.i3.p1.5.m5.1.1.2.3" xref="S4.I1.i3.p1.5.m5.1.1.2.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.5.m5.1.1.1" xref="S4.I1.i3.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.I1.i3.p1.5.m5.1.1.3" xref="S4.I1.i3.p1.5.m5.1.1.3.cmml"><mi id="S4.I1.i3.p1.5.m5.1.1.3.2" xref="S4.I1.i3.p1.5.m5.1.1.3.2.cmml">Z</mi><mo id="S4.I1.i3.p1.5.m5.1.1.3.3" xref="S4.I1.i3.p1.5.m5.1.1.3.3.cmml">*</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.5.m5.1b"><apply id="S4.I1.i3.p1.5.m5.1.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1"><in id="S4.I1.i3.p1.5.m5.1.1.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1.1"></in><apply id="S4.I1.i3.p1.5.m5.1.1.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.5.m5.1.1.2.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2">superscript</csymbol><ci id="S4.I1.i3.p1.5.m5.1.1.2.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2.2">𝑧</ci><times id="S4.I1.i3.p1.5.m5.1.1.2.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2.3"></times></apply><apply id="S4.I1.i3.p1.5.m5.1.1.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.5.m5.1.1.3.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.I1.i3.p1.5.m5.1.1.3.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3.2">𝑍</ci><times id="S4.I1.i3.p1.5.m5.1.1.3.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.5.m5.1c">z^{*}\in Z^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.5.m5.1d">italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ∈ italic_Z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math> to be the hidden representation <math alttext="z" class="ltx_Math" display="inline" id="S4.I1.i3.p1.6.m6.1"><semantics id="S4.I1.i3.p1.6.m6.1a"><mi id="S4.I1.i3.p1.6.m6.1.1" xref="S4.I1.i3.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.6.m6.1b"><ci id="S4.I1.i3.p1.6.m6.1.1.cmml" xref="S4.I1.i3.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.6.m6.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.6.m6.1d">italic_z</annotation></semantics></math> during the hallucination run. We then compute the log likelihood ratio <math alttext="y_{E^{*},z}=\log\frac{p(o^{\prime}|E^{*}(u),z)}{p(o|E^{*}(u),z)}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.7.m7.8"><semantics id="S4.I1.i3.p1.7.m7.8a"><mrow id="S4.I1.i3.p1.7.m7.8.9" xref="S4.I1.i3.p1.7.m7.8.9.cmml"><msub id="S4.I1.i3.p1.7.m7.8.9.2" xref="S4.I1.i3.p1.7.m7.8.9.2.cmml"><mi id="S4.I1.i3.p1.7.m7.8.9.2.2" xref="S4.I1.i3.p1.7.m7.8.9.2.2.cmml">y</mi><mrow id="S4.I1.i3.p1.7.m7.2.2.2.2" xref="S4.I1.i3.p1.7.m7.2.2.2.3.cmml"><msup id="S4.I1.i3.p1.7.m7.2.2.2.2.1" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.cmml"><mi id="S4.I1.i3.p1.7.m7.2.2.2.2.1.2" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.2.cmml">E</mi><mo id="S4.I1.i3.p1.7.m7.2.2.2.2.1.3" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.7.m7.2.2.2.2.2" xref="S4.I1.i3.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="S4.I1.i3.p1.7.m7.1.1.1.1" xref="S4.I1.i3.p1.7.m7.1.1.1.1.cmml">z</mi></mrow></msub><mo id="S4.I1.i3.p1.7.m7.8.9.1" xref="S4.I1.i3.p1.7.m7.8.9.1.cmml">=</mo><mrow id="S4.I1.i3.p1.7.m7.8.9.3" xref="S4.I1.i3.p1.7.m7.8.9.3.cmml"><mi id="S4.I1.i3.p1.7.m7.8.9.3.1" xref="S4.I1.i3.p1.7.m7.8.9.3.1.cmml">log</mi><mo id="S4.I1.i3.p1.7.m7.8.9.3a" lspace="0.167em" xref="S4.I1.i3.p1.7.m7.8.9.3.cmml">⁡</mo><mfrac id="S4.I1.i3.p1.7.m7.8.8" xref="S4.I1.i3.p1.7.m7.8.8.cmml"><mrow id="S4.I1.i3.p1.7.m7.5.5.3" xref="S4.I1.i3.p1.7.m7.5.5.3.cmml"><mi id="S4.I1.i3.p1.7.m7.5.5.3.5" xref="S4.I1.i3.p1.7.m7.5.5.3.5.cmml">p</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.4" xref="S4.I1.i3.p1.7.m7.5.5.3.4.cmml">⁢</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml"><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.2" stretchy="false" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml">(</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml"><msup id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.cmml"><mi id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2.cmml">o</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3.cmml">′</mo></msup><mo fence="false" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2.cmml">|</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.2.cmml"><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml"><msup id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.cmml"><mi id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2.cmml">E</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.3.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml"><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml">(</mo><mi id="S4.I1.i3.p1.7.m7.3.3.1.1" xref="S4.I1.i3.p1.7.m7.3.3.1.1.cmml">u</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.2.cmml">,</mo><mi id="S4.I1.i3.p1.7.m7.4.4.2.2" xref="S4.I1.i3.p1.7.m7.4.4.2.2.cmml">z</mi></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.3" stretchy="false" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.I1.i3.p1.7.m7.8.8.6" xref="S4.I1.i3.p1.7.m7.8.8.6.cmml"><mi id="S4.I1.i3.p1.7.m7.8.8.6.5" xref="S4.I1.i3.p1.7.m7.8.8.6.5.cmml">p</mi><mo id="S4.I1.i3.p1.7.m7.8.8.6.4" xref="S4.I1.i3.p1.7.m7.8.8.6.4.cmml">⁢</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml"><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.2" stretchy="false" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml">(</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml"><mi id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3.cmml">o</mi><mo fence="false" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2.cmml">|</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.2.cmml"><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml"><msup id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.cmml"><mi id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2.cmml">E</mi><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.3.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml"><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml">(</mo><mi id="S4.I1.i3.p1.7.m7.6.6.4.1" xref="S4.I1.i3.p1.7.m7.6.6.4.1.cmml">u</mi><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.2.cmml">,</mo><mi id="S4.I1.i3.p1.7.m7.7.7.5.2" xref="S4.I1.i3.p1.7.m7.7.7.5.2.cmml">z</mi></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.3" stretchy="false" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.7.m7.8b"><apply id="S4.I1.i3.p1.7.m7.8.9.cmml" xref="S4.I1.i3.p1.7.m7.8.9"><eq id="S4.I1.i3.p1.7.m7.8.9.1.cmml" xref="S4.I1.i3.p1.7.m7.8.9.1"></eq><apply id="S4.I1.i3.p1.7.m7.8.9.2.cmml" xref="S4.I1.i3.p1.7.m7.8.9.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.8.9.2.1.cmml" xref="S4.I1.i3.p1.7.m7.8.9.2">subscript</csymbol><ci id="S4.I1.i3.p1.7.m7.8.9.2.2.cmml" xref="S4.I1.i3.p1.7.m7.8.9.2.2">𝑦</ci><list id="S4.I1.i3.p1.7.m7.2.2.2.3.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2"><apply id="S4.I1.i3.p1.7.m7.2.2.2.2.1.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.2.2.2.2.1.1.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.2.2.2.2.1.2.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.2">𝐸</ci><times id="S4.I1.i3.p1.7.m7.2.2.2.2.1.3.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.3"></times></apply><ci id="S4.I1.i3.p1.7.m7.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.1.1.1.1">𝑧</ci></list></apply><apply id="S4.I1.i3.p1.7.m7.8.9.3.cmml" xref="S4.I1.i3.p1.7.m7.8.9.3"><log id="S4.I1.i3.p1.7.m7.8.9.3.1.cmml" xref="S4.I1.i3.p1.7.m7.8.9.3.1"></log><apply id="S4.I1.i3.p1.7.m7.8.8.cmml" xref="S4.I1.i3.p1.7.m7.8.8"><divide id="S4.I1.i3.p1.7.m7.8.8.7.cmml" xref="S4.I1.i3.p1.7.m7.8.8"></divide><apply id="S4.I1.i3.p1.7.m7.5.5.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3"><times id="S4.I1.i3.p1.7.m7.5.5.3.4.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.4"></times><ci id="S4.I1.i3.p1.7.m7.5.5.3.5.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.5">𝑝</ci><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1"><csymbol cd="latexml" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2">conditional</csymbol><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2">𝑜</ci><ci id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3">′</ci></apply><list id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1"><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1"><times id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1"></times><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2">𝐸</ci><times id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3"></times></apply><ci id="S4.I1.i3.p1.7.m7.3.3.1.1.cmml" xref="S4.I1.i3.p1.7.m7.3.3.1.1">𝑢</ci></apply><ci id="S4.I1.i3.p1.7.m7.4.4.2.2.cmml" xref="S4.I1.i3.p1.7.m7.4.4.2.2">𝑧</ci></list></apply></apply><apply id="S4.I1.i3.p1.7.m7.8.8.6.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6"><times id="S4.I1.i3.p1.7.m7.8.8.6.4.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.4"></times><ci id="S4.I1.i3.p1.7.m7.8.8.6.5.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.5">𝑝</ci><apply id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1"><csymbol cd="latexml" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2">conditional</csymbol><ci id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3">𝑜</ci><list id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1"><apply id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1"><times id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1"></times><apply id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2">𝐸</ci><times id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3"></times></apply><ci id="S4.I1.i3.p1.7.m7.6.6.4.1.cmml" xref="S4.I1.i3.p1.7.m7.6.6.4.1">𝑢</ci></apply><ci id="S4.I1.i3.p1.7.m7.7.7.5.2.cmml" xref="S4.I1.i3.p1.7.m7.7.7.5.2">𝑧</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.7.m7.8c">y_{E^{*},z}=\log\frac{p(o^{\prime}|E^{*}(u),z)}{p(o|E^{*}(u),z)}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.7.m7.8d">italic_y start_POSTSUBSCRIPT italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT , italic_z end_POSTSUBSCRIPT = roman_log divide start_ARG italic_p ( italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) , italic_z ) end_ARG start_ARG italic_p ( italic_o | italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) , italic_z ) end_ARG</annotation></semantics></math> to see how it changes compared to step 2.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="161" id="S4.F2.g1" src="x2.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S4.F2.4.1">Average Indirect Effect (AIE)</span> of hidden representations produced by individual model components to non-factual hallucinations over ParaRel queries that are incorrectly answered by Llama-2-7b-chat. The relative indirect effect metric <math alttext="\Delta\overline{\text{IE}}(y,u)" class="ltx_Math" display="inline" id="S4.F2.2.m1.2"><semantics id="S4.F2.2.m1.2b"><mrow id="S4.F2.2.m1.2.3" xref="S4.F2.2.m1.2.3.cmml"><mi id="S4.F2.2.m1.2.3.2" mathvariant="normal" xref="S4.F2.2.m1.2.3.2.cmml">Δ</mi><mo id="S4.F2.2.m1.2.3.1" xref="S4.F2.2.m1.2.3.1.cmml">⁢</mo><mover accent="true" id="S4.F2.2.m1.2.3.3" xref="S4.F2.2.m1.2.3.3.cmml"><mtext id="S4.F2.2.m1.2.3.3.2" xref="S4.F2.2.m1.2.3.3.2a.cmml">IE</mtext><mo id="S4.F2.2.m1.2.3.3.1" xref="S4.F2.2.m1.2.3.3.1.cmml">¯</mo></mover><mo id="S4.F2.2.m1.2.3.1b" xref="S4.F2.2.m1.2.3.1.cmml">⁢</mo><mrow id="S4.F2.2.m1.2.3.4.2" xref="S4.F2.2.m1.2.3.4.1.cmml"><mo id="S4.F2.2.m1.2.3.4.2.1" stretchy="false" xref="S4.F2.2.m1.2.3.4.1.cmml">(</mo><mi id="S4.F2.2.m1.1.1" xref="S4.F2.2.m1.1.1.cmml">y</mi><mo id="S4.F2.2.m1.2.3.4.2.2" xref="S4.F2.2.m1.2.3.4.1.cmml">,</mo><mi id="S4.F2.2.m1.2.2" xref="S4.F2.2.m1.2.2.cmml">u</mi><mo id="S4.F2.2.m1.2.3.4.2.3" stretchy="false" xref="S4.F2.2.m1.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.2.m1.2c"><apply id="S4.F2.2.m1.2.3.cmml" xref="S4.F2.2.m1.2.3"><times id="S4.F2.2.m1.2.3.1.cmml" xref="S4.F2.2.m1.2.3.1"></times><ci id="S4.F2.2.m1.2.3.2.cmml" xref="S4.F2.2.m1.2.3.2">Δ</ci><apply id="S4.F2.2.m1.2.3.3.cmml" xref="S4.F2.2.m1.2.3.3"><ci id="S4.F2.2.m1.2.3.3.1.cmml" xref="S4.F2.2.m1.2.3.3.1">¯</ci><ci id="S4.F2.2.m1.2.3.3.2a.cmml" xref="S4.F2.2.m1.2.3.3.2"><mtext id="S4.F2.2.m1.2.3.3.2.cmml" xref="S4.F2.2.m1.2.3.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.F2.2.m1.2.3.4.1.cmml" xref="S4.F2.2.m1.2.3.4.2"><ci id="S4.F2.2.m1.1.1.cmml" xref="S4.F2.2.m1.1.1">𝑦</ci><ci id="S4.F2.2.m1.2.2.cmml" xref="S4.F2.2.m1.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.2.m1.2d">\Delta\overline{\text{IE}}(y,u)</annotation><annotation encoding="application/x-llamapun" id="S4.F2.2.m1.2e">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u )</annotation></semantics></math> of distinguishing early-site and late-site hallucinations is defined as the difference between the mean AIE of 1) the hidden representations of the last relation token by upper layer attentions/MLPs (blue dashed boxes), and 2) the hidden representations of the first subject token by lower layer attentions/MLPs (red dashed boxes).
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="S4.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="864" id="S4.F2.sf1.g1" src="x3.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Early-site hallucinations (<math alttext="\Delta\overline{\text{IE}}(y,u)<0" class="ltx_Math" display="inline" id="S4.F2.sf1.2.m1.2"><semantics id="S4.F2.sf1.2.m1.2b"><mrow id="S4.F2.sf1.2.m1.2.3" xref="S4.F2.sf1.2.m1.2.3.cmml"><mrow id="S4.F2.sf1.2.m1.2.3.2" xref="S4.F2.sf1.2.m1.2.3.2.cmml"><mi id="S4.F2.sf1.2.m1.2.3.2.2" mathvariant="normal" xref="S4.F2.sf1.2.m1.2.3.2.2.cmml">Δ</mi><mo id="S4.F2.sf1.2.m1.2.3.2.1" xref="S4.F2.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mover accent="true" id="S4.F2.sf1.2.m1.2.3.2.3" xref="S4.F2.sf1.2.m1.2.3.2.3.cmml"><mtext id="S4.F2.sf1.2.m1.2.3.2.3.2" xref="S4.F2.sf1.2.m1.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.F2.sf1.2.m1.2.3.2.3.1" xref="S4.F2.sf1.2.m1.2.3.2.3.1.cmml">¯</mo></mover><mo id="S4.F2.sf1.2.m1.2.3.2.1b" xref="S4.F2.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="S4.F2.sf1.2.m1.2.3.2.4.2" xref="S4.F2.sf1.2.m1.2.3.2.4.1.cmml"><mo id="S4.F2.sf1.2.m1.2.3.2.4.2.1" stretchy="false" xref="S4.F2.sf1.2.m1.2.3.2.4.1.cmml">(</mo><mi id="S4.F2.sf1.2.m1.1.1" xref="S4.F2.sf1.2.m1.1.1.cmml">y</mi><mo id="S4.F2.sf1.2.m1.2.3.2.4.2.2" xref="S4.F2.sf1.2.m1.2.3.2.4.1.cmml">,</mo><mi id="S4.F2.sf1.2.m1.2.2" xref="S4.F2.sf1.2.m1.2.2.cmml">u</mi><mo id="S4.F2.sf1.2.m1.2.3.2.4.2.3" stretchy="false" xref="S4.F2.sf1.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.F2.sf1.2.m1.2.3.1" xref="S4.F2.sf1.2.m1.2.3.1.cmml">&lt;</mo><mn id="S4.F2.sf1.2.m1.2.3.3" xref="S4.F2.sf1.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf1.2.m1.2c"><apply id="S4.F2.sf1.2.m1.2.3.cmml" xref="S4.F2.sf1.2.m1.2.3"><lt id="S4.F2.sf1.2.m1.2.3.1.cmml" xref="S4.F2.sf1.2.m1.2.3.1"></lt><apply id="S4.F2.sf1.2.m1.2.3.2.cmml" xref="S4.F2.sf1.2.m1.2.3.2"><times id="S4.F2.sf1.2.m1.2.3.2.1.cmml" xref="S4.F2.sf1.2.m1.2.3.2.1"></times><ci id="S4.F2.sf1.2.m1.2.3.2.2.cmml" xref="S4.F2.sf1.2.m1.2.3.2.2">Δ</ci><apply id="S4.F2.sf1.2.m1.2.3.2.3.cmml" xref="S4.F2.sf1.2.m1.2.3.2.3"><ci id="S4.F2.sf1.2.m1.2.3.2.3.1.cmml" xref="S4.F2.sf1.2.m1.2.3.2.3.1">¯</ci><ci id="S4.F2.sf1.2.m1.2.3.2.3.2a.cmml" xref="S4.F2.sf1.2.m1.2.3.2.3.2"><mtext id="S4.F2.sf1.2.m1.2.3.2.3.2.cmml" xref="S4.F2.sf1.2.m1.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.F2.sf1.2.m1.2.3.2.4.1.cmml" xref="S4.F2.sf1.2.m1.2.3.2.4.2"><ci id="S4.F2.sf1.2.m1.1.1.cmml" xref="S4.F2.sf1.2.m1.1.1">𝑦</ci><ci id="S4.F2.sf1.2.m1.2.2.cmml" xref="S4.F2.sf1.2.m1.2.2">𝑢</ci></interval></apply><cn id="S4.F2.sf1.2.m1.2.3.3.cmml" type="integer" xref="S4.F2.sf1.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf1.2.m1.2d">\Delta\overline{\text{IE}}(y,u)&lt;0</annotation><annotation encoding="application/x-llamapun" id="S4.F2.sf1.2.m1.2e">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) &lt; 0</annotation></semantics></math>)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="S4.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="864" id="S4.F2.sf2.g1" src="x4.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Late-site hallucinations (<math alttext="\Delta\overline{\text{IE}}(y,u)\geq 0" class="ltx_Math" display="inline" id="S4.F2.sf2.2.m1.2"><semantics id="S4.F2.sf2.2.m1.2b"><mrow id="S4.F2.sf2.2.m1.2.3" xref="S4.F2.sf2.2.m1.2.3.cmml"><mrow id="S4.F2.sf2.2.m1.2.3.2" xref="S4.F2.sf2.2.m1.2.3.2.cmml"><mi id="S4.F2.sf2.2.m1.2.3.2.2" mathvariant="normal" xref="S4.F2.sf2.2.m1.2.3.2.2.cmml">Δ</mi><mo id="S4.F2.sf2.2.m1.2.3.2.1" xref="S4.F2.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mover accent="true" id="S4.F2.sf2.2.m1.2.3.2.3" xref="S4.F2.sf2.2.m1.2.3.2.3.cmml"><mtext id="S4.F2.sf2.2.m1.2.3.2.3.2" xref="S4.F2.sf2.2.m1.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.F2.sf2.2.m1.2.3.2.3.1" xref="S4.F2.sf2.2.m1.2.3.2.3.1.cmml">¯</mo></mover><mo id="S4.F2.sf2.2.m1.2.3.2.1b" xref="S4.F2.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="S4.F2.sf2.2.m1.2.3.2.4.2" xref="S4.F2.sf2.2.m1.2.3.2.4.1.cmml"><mo id="S4.F2.sf2.2.m1.2.3.2.4.2.1" stretchy="false" xref="S4.F2.sf2.2.m1.2.3.2.4.1.cmml">(</mo><mi id="S4.F2.sf2.2.m1.1.1" xref="S4.F2.sf2.2.m1.1.1.cmml">y</mi><mo id="S4.F2.sf2.2.m1.2.3.2.4.2.2" xref="S4.F2.sf2.2.m1.2.3.2.4.1.cmml">,</mo><mi id="S4.F2.sf2.2.m1.2.2" xref="S4.F2.sf2.2.m1.2.2.cmml">u</mi><mo id="S4.F2.sf2.2.m1.2.3.2.4.2.3" stretchy="false" xref="S4.F2.sf2.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.F2.sf2.2.m1.2.3.1" xref="S4.F2.sf2.2.m1.2.3.1.cmml">≥</mo><mn id="S4.F2.sf2.2.m1.2.3.3" xref="S4.F2.sf2.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf2.2.m1.2c"><apply id="S4.F2.sf2.2.m1.2.3.cmml" xref="S4.F2.sf2.2.m1.2.3"><geq id="S4.F2.sf2.2.m1.2.3.1.cmml" xref="S4.F2.sf2.2.m1.2.3.1"></geq><apply id="S4.F2.sf2.2.m1.2.3.2.cmml" xref="S4.F2.sf2.2.m1.2.3.2"><times id="S4.F2.sf2.2.m1.2.3.2.1.cmml" xref="S4.F2.sf2.2.m1.2.3.2.1"></times><ci id="S4.F2.sf2.2.m1.2.3.2.2.cmml" xref="S4.F2.sf2.2.m1.2.3.2.2">Δ</ci><apply id="S4.F2.sf2.2.m1.2.3.2.3.cmml" xref="S4.F2.sf2.2.m1.2.3.2.3"><ci id="S4.F2.sf2.2.m1.2.3.2.3.1.cmml" xref="S4.F2.sf2.2.m1.2.3.2.3.1">¯</ci><ci id="S4.F2.sf2.2.m1.2.3.2.3.2a.cmml" xref="S4.F2.sf2.2.m1.2.3.2.3.2"><mtext id="S4.F2.sf2.2.m1.2.3.2.3.2.cmml" xref="S4.F2.sf2.2.m1.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.F2.sf2.2.m1.2.3.2.4.1.cmml" xref="S4.F2.sf2.2.m1.2.3.2.4.2"><ci id="S4.F2.sf2.2.m1.1.1.cmml" xref="S4.F2.sf2.2.m1.1.1">𝑦</ci><ci id="S4.F2.sf2.2.m1.2.2.cmml" xref="S4.F2.sf2.2.m1.2.2">𝑢</ci></interval></apply><cn id="S4.F2.sf2.2.m1.2.3.3.cmml" type="integer" xref="S4.F2.sf2.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf2.2.m1.2d">\Delta\overline{\text{IE}}(y,u)\geq 0</annotation><annotation encoding="application/x-llamapun" id="S4.F2.sf2.2.m1.2e">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) ≥ 0</annotation></semantics></math>)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S4.F3.2.1">Average Indirect Effect (AIE)</span> of individual model components for (a) early-site (left column) and (b) late-site (right column) non-factual hallucinations. </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p4">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p4.3">Following previous work in causal mediation analysis <cite class="ltx_cite ltx_citemacro_cite">Vig et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib50" title="">2020</a>); Finlayson et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib14" title="">2021</a>); Meng et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite>, we define the <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px1.p4.3.1">causal indirect effect</span> <math alttext="\text{IE}(z;y,u,\epsilon)=y_{E^{*},z}-y_{*}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p4.1.m1.6"><semantics id="S4.SS1.SSS0.Px1.p4.1.m1.6a"><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.cmml"><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.cmml"><mtext id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml"><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.3.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.3.3.cmml">z</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">;</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.4.4" xref="S4.SS1.SSS0.Px1.p4.1.m1.4.4.cmml">y</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.5.5" xref="S4.SS1.SSS0.Px1.p4.1.m1.5.5.cmml">u</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.4" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.6.6" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.6.cmml">ϵ</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.5" stretchy="false" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1.cmml">=</mo><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.cmml"><msub id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2.cmml">y</mi><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml"><msup id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2.cmml">E</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3.cmml">*</mo></msup><mo id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1.cmml">z</mi></mrow></msub><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1.cmml">−</mo><msub id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2.cmml">y</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3.cmml">*</mo></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.1.m1.6b"><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7"><eq id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1"></eq><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2"><times id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1"></times><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2a.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2"><mtext id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2">IE</mtext></ci><list id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2"><ci id="S4.SS1.SSS0.Px1.p4.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.3.3">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p4.1.m1.4.4.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.4.4">𝑦</ci><ci id="S4.SS1.SSS0.Px1.p4.1.m1.5.5.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.5.5">𝑢</ci><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.6.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.6">italic-ϵ</ci></list></apply><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3"><minus id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1"></minus><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2">𝑦</ci><list id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2"><apply id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2">𝐸</ci><times id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3"></times></apply><ci id="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1">𝑧</ci></list></apply><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2">𝑦</ci><times id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.1.m1.6c">\text{IE}(z;y,u,\epsilon)=y_{E^{*},z}-y_{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p4.1.m1.6d">IE ( italic_z ; italic_y , italic_u , italic_ϵ ) = italic_y start_POSTSUBSCRIPT italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT , italic_z end_POSTSUBSCRIPT - italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT</annotation></semantics></math> of an intermediate hidden representation <math alttext="z" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p4.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p4.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p4.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p4.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p4.2.m2.1d">italic_z</annotation></semantics></math> as the decrease in the degree of hallucination after mitigating a single hidden state. Averaging over a set of factual queries and a sample of noises for each query, we obtain the average indirect effect (AIE) for each <math alttext="z" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p4.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p4.3.m3.1a"><mi id="S4.SS1.SSS0.Px1.p4.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p4.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.3.m3.1b"><ci id="S4.SS1.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.3.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p4.3.m3.1d">italic_z</annotation></semantics></math> and its corresponding model component.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Experiments.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.7">We collect a set of factual knowledge queries from the ParaRel <cite class="ltx_cite ltx_citemacro_cite">Elazar et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib12" title="">2021</a>)</cite> dataset of cloze-style factual knowledge queries. Each example in ParaRel contains a knowledge tuple <math alttext="t_{c}=(s,r,o_{c})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.1.m1.3"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.3a"><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2.cmml">t</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.cmml">c</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml"><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p1.1.m1.2.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.4" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.5" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.3b"><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3"><eq id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2"></eq><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2">𝑡</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3">𝑐</ci></apply><vector id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1"><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2">𝑟</ci><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3">𝑐</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.3c">t_{c}=(s,r,o_{c})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.1.m1.3d">italic_t start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = ( italic_s , italic_r , italic_o start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math> and a prompt generated from hand-curated templates. We evaluated three widely used pretrained LMs with different layouts: 1) Llama-2-7B-chat (32 layers, 7B parameters, fine-tuned on instruction following) <cite class="ltx_cite ltx_citemacro_cite">Touvron et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib46" title="">2023</a>)</cite>, 2) GPT-J (28 layers, 6B parameters) <cite class="ltx_cite ltx_citemacro_cite">Wang and Komatsuzaki (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib52" title="">2021</a>)</cite>, and 3) GPT-2-XL (48 layers, 1.5B parameters) <cite class="ltx_cite ltx_citemacro_cite">Radford et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib41" title="">2019</a>)</cite>. For each prompt <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.2.m2.1d">italic_u</annotation></semantics></math>, we compute the LM predicted conditional probability <math alttext="p(o|E(u))" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.3.m3.2"><semantics id="S4.SS1.SSS0.Px2.p1.3.m3.2a"><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3.cmml">p</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2.cmml">o</mi><mo fence="false" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1.cmml">|</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2.cmml">E</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml"><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">u</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.3.2.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m3.2b"><apply id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2"><times id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2"></times><ci id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3">𝑝</ci><apply id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2">𝑜</ci><apply id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3"><times id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1"></times><ci id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2">𝐸</ci><ci id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m3.2c">p(o|E(u))</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.3.m3.2d">italic_p ( italic_o | italic_E ( italic_u ) )</annotation></semantics></math> of the next token continuation, where <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px2.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.4.m4.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.4.m4.1d">italic_o</annotation></semantics></math> is taken from the collection of all capitalized alphabetical tokens in the model vocabulary. To resolve the ambiguity issue where a query may allow multiple correct answers, we define hallucinations as the cases where the LM assigns the highest probability to a token <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px2.p1.5.m5.1a"><msup id="S4.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.5.m5.1b"><apply id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.5.m5.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.5.m5.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> that is neither the suffix of the true object <math alttext="o_{c}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.6.m6.1"><semantics id="S4.SS1.SSS0.Px2.p1.6.m6.1a"><msub id="S4.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.6.m6.1c">o_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.6.m6.1d">italic_o start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> nor the suffix of any other objects of the subject-relation pair <math alttext="(s,r)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.7.m7.2"><semantics id="S4.SS1.SSS0.Px2.p1.7.m7.2a"><mrow id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p1.7.m7.2.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.7.m7.2b"><interval closure="open" id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2"><ci id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.7.m7.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.2">𝑟</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.7.m7.2c">(s,r)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.7.m7.2d">( italic_s , italic_r )</annotation></semantics></math> returned by a WikiData API query search. <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A1" title="Appendix A Dataset of Non-Factual Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">A</span></a> for more details about dataset construction.</span></span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.1">We compute the average causal indirect effect over queries from ParaRel for hidden states <math alttext="z\in Z" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml">z</mi><mo id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml">∈</mo><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1"><in id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1"></in><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">z\in Z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.1.m1.1d">italic_z ∈ italic_Z</annotation></semantics></math> across various sentence positions and transformer layers. Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F2" title="Figure 2 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> shows the AIE distributions for three model components of Llama-2-7B: the residual stream, the attention heads, and the MLPs. We observe two groups of hidden states yielding the highest attribution scores towards incorrectly predicted objects: 1) the hidden states of the subject tokens at lower transformer layers by MLPs, and 2) the hidden states of the last relation token at upper transformer layers by MLPs and attention heads. We observe similar causal effect distributional patterns for GPT models as well (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS2" title="B.2 Causal tracing results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">B.2</span></a> for additional results). <cite class="ltx_cite ltx_citemacro_citet">Geva et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib15" title="">2023</a>)</cite> recently show that lower layer MLPs and upper layer attention heads are two most crucial LM components for successful factual knowledge recalling. Our causal tracing results not only confirm their finding from a contrapositive perspective, but also reveal an additional component (upper layer MLPs) as an important source of hallucinations.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Early- vs. late-site hallucination.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px4.p1.3">Based on the findings above, we hypothesize that there are two different “mechanisms” that may cause non-factual hallucinations, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>: 1) the LM fails to retrieve correct information about the subject from lower layer components, and 2) the LM successfully retrieves some subject attributes from lower layer components, but the upper layer components fail to distinguish the correct object(s) among retrieved ones. In particular, let <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px4.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.1.m1.1d">italic_L</annotation></semantics></math> be the number of transformer layers of an LM, we define <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px4.p1.3.1">early-site components</span> as attention heads and MLPs located in the first half of LM’s layers (<math alttext="1\leq l\leq\frac{L}{2}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px4.p1.2.m2.1a"><mrow id="S4.SS1.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml"><mn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml">1</mn><mo id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml">≤</mo><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4.cmml">l</mi><mo id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5.cmml">≤</mo><mfrac id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.cmml"><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2.cmml">L</mi><mn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><and id="S4.SS1.SSS0.Px4.p1.2.m2.1.1a.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"></and><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1b.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><leq id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3"></leq><cn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2">1</cn><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4">𝑙</ci></apply><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1c.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><leq id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5"></leq><share href="#S4.SS1.SSS0.Px4.p1.2.m2.1.1.4.cmml" id="S4.SS1.SSS0.Px4.p1.2.m2.1.1d.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"></share><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6"><divide id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6"></divide><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2">𝐿</ci><cn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.2.m2.1c">1\leq l\leq\frac{L}{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.2.m2.1d">1 ≤ italic_l ≤ divide start_ARG italic_L end_ARG start_ARG 2 end_ARG</annotation></semantics></math>), and <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px4.p1.3.2">late-site components</span> as those located in the second half of LM’s layers (<math alttext="\frac{L}{2}<l\leq L" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px4.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px4.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml"><mfrac id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml">L</mi><mn id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml">2</mn></mfrac><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml">&lt;</mo><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4.cmml">l</mi><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5.cmml">≤</mo><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><and id="S4.SS1.SSS0.Px4.p1.3.m3.1.1a.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"></and><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1b.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><lt id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3"></lt><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2"><divide id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2"></divide><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2">𝐿</ci><cn id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3">2</cn></apply><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4">𝑙</ci></apply><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1c.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><leq id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5"></leq><share href="#S4.SS1.SSS0.Px4.p1.3.m3.1.1.4.cmml" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1d.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"></share><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.3.m3.1c">\frac{L}{2}&lt;l\leq L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.3.m3.1d">divide start_ARG italic_L end_ARG start_ARG 2 end_ARG &lt; italic_l ≤ italic_L</annotation></semantics></math>). We then define the <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px4.p1.3.3">relative indirect effect</span> between intermediate representations by early- and late-site model components as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px4.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx1">
<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\Delta\overline{\text{IE}}(y,u)={\color[rgb]{0,0,1}\overline{%
\text{IE}}_{\text{late}}(y,u)}-{\color[rgb]{1,0,0}\overline{\text{IE}}_{\text{%
early}}(y,u)}" class="ltx_Math" display="inline" id="S4.E1.m1.6"><semantics id="S4.E1.m1.6a"><mrow id="S4.E1.m1.6.7" xref="S4.E1.m1.6.7.cmml"><mrow id="S4.E1.m1.6.7.2" xref="S4.E1.m1.6.7.2.cmml"><mi id="S4.E1.m1.6.7.2.2" mathvariant="normal" xref="S4.E1.m1.6.7.2.2.cmml">Δ</mi><mo id="S4.E1.m1.6.7.2.1" xref="S4.E1.m1.6.7.2.1.cmml">⁢</mo><mover accent="true" id="S4.E1.m1.6.7.2.3" xref="S4.E1.m1.6.7.2.3.cmml"><mtext id="S4.E1.m1.6.7.2.3.2" xref="S4.E1.m1.6.7.2.3.2a.cmml">IE</mtext><mo id="S4.E1.m1.6.7.2.3.1" xref="S4.E1.m1.6.7.2.3.1.cmml">¯</mo></mover><mo id="S4.E1.m1.6.7.2.1a" xref="S4.E1.m1.6.7.2.1.cmml">⁢</mo><mrow id="S4.E1.m1.6.7.2.4.2" xref="S4.E1.m1.6.7.2.4.1.cmml"><mo id="S4.E1.m1.6.7.2.4.2.1" stretchy="false" xref="S4.E1.m1.6.7.2.4.1.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">y</mi><mo id="S4.E1.m1.6.7.2.4.2.2" xref="S4.E1.m1.6.7.2.4.1.cmml">,</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">u</mi><mo id="S4.E1.m1.6.7.2.4.2.3" stretchy="false" xref="S4.E1.m1.6.7.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.6.7.1" xref="S4.E1.m1.6.7.1.cmml">=</mo><mrow id="S4.E1.m1.6.7.3" xref="S4.E1.m1.6.7.3.cmml"><mrow id="S4.E1.m1.6.7.3.2" xref="S4.E1.m1.6.7.3.2.cmml"><msub id="S4.E1.m1.6.7.3.2.2" xref="S4.E1.m1.6.7.3.2.2.cmml"><mover accent="true" id="S4.E1.m1.6.7.3.2.2.2" xref="S4.E1.m1.6.7.3.2.2.2.cmml"><mtext id="S4.E1.m1.6.7.3.2.2.2.2" mathcolor="#0000FF" xref="S4.E1.m1.6.7.3.2.2.2.2a.cmml">IE</mtext><mo id="S4.E1.m1.6.7.3.2.2.2.1" mathcolor="#0000FF" xref="S4.E1.m1.6.7.3.2.2.2.1.cmml">¯</mo></mover><mtext id="S4.E1.m1.6.7.3.2.2.3" mathcolor="#0000FF" xref="S4.E1.m1.6.7.3.2.2.3a.cmml">late</mtext></msub><mo id="S4.E1.m1.6.7.3.2.1" xref="S4.E1.m1.6.7.3.2.1.cmml">⁢</mo><mrow id="S4.E1.m1.6.7.3.2.3.2" xref="S4.E1.m1.6.7.3.2.3.1.cmml"><mo id="S4.E1.m1.6.7.3.2.3.2.1" mathcolor="#0000FF" stretchy="false" xref="S4.E1.m1.6.7.3.2.3.1.cmml">(</mo><mi id="S4.E1.m1.3.3" mathcolor="#0000FF" xref="S4.E1.m1.3.3.cmml">y</mi><mo id="S4.E1.m1.6.7.3.2.3.2.2" mathcolor="#0000FF" xref="S4.E1.m1.6.7.3.2.3.1.cmml">,</mo><mi id="S4.E1.m1.4.4" mathcolor="#0000FF" xref="S4.E1.m1.4.4.cmml">u</mi><mo id="S4.E1.m1.6.7.3.2.3.2.3" mathcolor="#0000FF" stretchy="false" xref="S4.E1.m1.6.7.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.6.7.3.1" xref="S4.E1.m1.6.7.3.1.cmml">−</mo><mrow id="S4.E1.m1.6.7.3.3" xref="S4.E1.m1.6.7.3.3.cmml"><msub id="S4.E1.m1.6.7.3.3.2" xref="S4.E1.m1.6.7.3.3.2.cmml"><mover accent="true" id="S4.E1.m1.6.7.3.3.2.2" xref="S4.E1.m1.6.7.3.3.2.2.cmml"><mtext id="S4.E1.m1.6.7.3.3.2.2.2" mathcolor="#FF0000" xref="S4.E1.m1.6.7.3.3.2.2.2a.cmml">IE</mtext><mo id="S4.E1.m1.6.7.3.3.2.2.1" mathcolor="#FF0000" xref="S4.E1.m1.6.7.3.3.2.2.1.cmml">¯</mo></mover><mtext id="S4.E1.m1.6.7.3.3.2.3" mathcolor="#FF0000" xref="S4.E1.m1.6.7.3.3.2.3a.cmml">early</mtext></msub><mo id="S4.E1.m1.6.7.3.3.1" xref="S4.E1.m1.6.7.3.3.1.cmml">⁢</mo><mrow id="S4.E1.m1.6.7.3.3.3.2" xref="S4.E1.m1.6.7.3.3.3.1.cmml"><mo id="S4.E1.m1.6.7.3.3.3.2.1" mathcolor="#FF0000" stretchy="false" xref="S4.E1.m1.6.7.3.3.3.1.cmml">(</mo><mi id="S4.E1.m1.5.5" mathcolor="#FF0000" xref="S4.E1.m1.5.5.cmml">y</mi><mo id="S4.E1.m1.6.7.3.3.3.2.2" mathcolor="#FF0000" xref="S4.E1.m1.6.7.3.3.3.1.cmml">,</mo><mi id="S4.E1.m1.6.6" mathcolor="#FF0000" xref="S4.E1.m1.6.6.cmml">u</mi><mo id="S4.E1.m1.6.7.3.3.3.2.3" mathcolor="#FF0000" stretchy="false" xref="S4.E1.m1.6.7.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.6b"><apply id="S4.E1.m1.6.7.cmml" xref="S4.E1.m1.6.7"><eq id="S4.E1.m1.6.7.1.cmml" xref="S4.E1.m1.6.7.1"></eq><apply id="S4.E1.m1.6.7.2.cmml" xref="S4.E1.m1.6.7.2"><times id="S4.E1.m1.6.7.2.1.cmml" xref="S4.E1.m1.6.7.2.1"></times><ci id="S4.E1.m1.6.7.2.2.cmml" xref="S4.E1.m1.6.7.2.2">Δ</ci><apply id="S4.E1.m1.6.7.2.3.cmml" xref="S4.E1.m1.6.7.2.3"><ci id="S4.E1.m1.6.7.2.3.1.cmml" xref="S4.E1.m1.6.7.2.3.1">¯</ci><ci id="S4.E1.m1.6.7.2.3.2a.cmml" xref="S4.E1.m1.6.7.2.3.2"><mtext id="S4.E1.m1.6.7.2.3.2.cmml" xref="S4.E1.m1.6.7.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.E1.m1.6.7.2.4.1.cmml" xref="S4.E1.m1.6.7.2.4.2"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝑦</ci><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝑢</ci></interval></apply><apply id="S4.E1.m1.6.7.3.cmml" xref="S4.E1.m1.6.7.3"><minus id="S4.E1.m1.6.7.3.1.cmml" xref="S4.E1.m1.6.7.3.1"></minus><apply id="S4.E1.m1.6.7.3.2.cmml" xref="S4.E1.m1.6.7.3.2"><times id="S4.E1.m1.6.7.3.2.1.cmml" xref="S4.E1.m1.6.7.3.2.1"></times><apply id="S4.E1.m1.6.7.3.2.2.cmml" xref="S4.E1.m1.6.7.3.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.7.3.2.2.1.cmml" xref="S4.E1.m1.6.7.3.2.2">subscript</csymbol><apply id="S4.E1.m1.6.7.3.2.2.2.cmml" xref="S4.E1.m1.6.7.3.2.2.2"><ci id="S4.E1.m1.6.7.3.2.2.2.1.cmml" xref="S4.E1.m1.6.7.3.2.2.2.1">¯</ci><ci id="S4.E1.m1.6.7.3.2.2.2.2a.cmml" xref="S4.E1.m1.6.7.3.2.2.2.2"><mtext id="S4.E1.m1.6.7.3.2.2.2.2.cmml" xref="S4.E1.m1.6.7.3.2.2.2.2">IE</mtext></ci></apply><ci id="S4.E1.m1.6.7.3.2.2.3a.cmml" xref="S4.E1.m1.6.7.3.2.2.3"><mtext id="S4.E1.m1.6.7.3.2.2.3.cmml" mathcolor="#0000FF" mathsize="70%" xref="S4.E1.m1.6.7.3.2.2.3">late</mtext></ci></apply><interval closure="open" id="S4.E1.m1.6.7.3.2.3.1.cmml" xref="S4.E1.m1.6.7.3.2.3.2"><ci id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">𝑦</ci><ci id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4">𝑢</ci></interval></apply><apply id="S4.E1.m1.6.7.3.3.cmml" xref="S4.E1.m1.6.7.3.3"><times id="S4.E1.m1.6.7.3.3.1.cmml" xref="S4.E1.m1.6.7.3.3.1"></times><apply id="S4.E1.m1.6.7.3.3.2.cmml" xref="S4.E1.m1.6.7.3.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.7.3.3.2.1.cmml" xref="S4.E1.m1.6.7.3.3.2">subscript</csymbol><apply id="S4.E1.m1.6.7.3.3.2.2.cmml" xref="S4.E1.m1.6.7.3.3.2.2"><ci id="S4.E1.m1.6.7.3.3.2.2.1.cmml" xref="S4.E1.m1.6.7.3.3.2.2.1">¯</ci><ci id="S4.E1.m1.6.7.3.3.2.2.2a.cmml" xref="S4.E1.m1.6.7.3.3.2.2.2"><mtext id="S4.E1.m1.6.7.3.3.2.2.2.cmml" xref="S4.E1.m1.6.7.3.3.2.2.2">IE</mtext></ci></apply><ci id="S4.E1.m1.6.7.3.3.2.3a.cmml" xref="S4.E1.m1.6.7.3.3.2.3"><mtext id="S4.E1.m1.6.7.3.3.2.3.cmml" mathcolor="#FF0000" mathsize="70%" xref="S4.E1.m1.6.7.3.3.2.3">early</mtext></ci></apply><interval closure="open" id="S4.E1.m1.6.7.3.3.3.1.cmml" xref="S4.E1.m1.6.7.3.3.3.2"><ci id="S4.E1.m1.5.5.cmml" xref="S4.E1.m1.5.5">𝑦</ci><ci id="S4.E1.m1.6.6.cmml" xref="S4.E1.m1.6.6">𝑢</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.6c">\displaystyle\Delta\overline{\text{IE}}(y,u)={\color[rgb]{0,0,1}\overline{%
\text{IE}}_{\text{late}}(y,u)}-{\color[rgb]{1,0,0}\overline{\text{IE}}_{\text{%
early}}(y,u)}</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.6d">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) = over¯ start_ARG IE end_ARG start_POSTSUBSCRIPT late end_POSTSUBSCRIPT ( italic_y , italic_u ) - over¯ start_ARG IE end_ARG start_POSTSUBSCRIPT early end_POSTSUBSCRIPT ( italic_y , italic_u )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{2}{L}\Big{[}{\color[rgb]{0,0,1}\sum_{l=1+\frac{L}{2}}^{L}%
\overline{\text{IE}}(z^{(l)}_{T},y,u)}-{\color[rgb]{1,0,0}\sum_{l=1}^{\frac{L}%
{2}}\overline{\text{IE}}(z^{(l)}_{0},y,u)}\Big{]}," class="ltx_Math" display="inline" id="S4.E2.m1.7"><semantics id="S4.E2.m1.7a"><mrow id="S4.E2.m1.7.7.1" xref="S4.E2.m1.7.7.1.1.cmml"><mrow id="S4.E2.m1.7.7.1.1" xref="S4.E2.m1.7.7.1.1.cmml"><mi id="S4.E2.m1.7.7.1.1.3" xref="S4.E2.m1.7.7.1.1.3.cmml"></mi><mo id="S4.E2.m1.7.7.1.1.2" xref="S4.E2.m1.7.7.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.7.7.1.1.1" xref="S4.E2.m1.7.7.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2.m1.7.7.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.3.cmml"><mfrac id="S4.E2.m1.7.7.1.1.1.3a" xref="S4.E2.m1.7.7.1.1.1.3.cmml"><mn id="S4.E2.m1.7.7.1.1.1.3.2" xref="S4.E2.m1.7.7.1.1.1.3.2.cmml">2</mn><mi id="S4.E2.m1.7.7.1.1.1.3.3" xref="S4.E2.m1.7.7.1.1.1.3.3.cmml">L</mi></mfrac></mstyle><mo id="S4.E2.m1.7.7.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S4.E2.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><munderover id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2a" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2" mathcolor="#0000FF" movablelimits="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2.cmml">l</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.cmml"><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2.cmml">1</mn><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1.cmml">+</mo><mfrac id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2.cmml">L</mi><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3.cmml">2</mn></mfrac></mrow></mrow><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3.cmml">L</mi></munderover></mstyle><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2a.cmml">IE</mtext><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">¯</mo></mover><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml">T</mi><mrow id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.1.1.1.3.1" mathcolor="#0000FF" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E2.m1.1.1.1.1" mathcolor="#0000FF" xref="S4.E2.m1.1.1.1.1.cmml">l</mi><mo id="S4.E2.m1.1.1.1.3.2" mathcolor="#0000FF" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E2.m1.3.3" mathcolor="#0000FF" xref="S4.E2.m1.3.3.cmml">y</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.4" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E2.m1.4.4" mathcolor="#0000FF" xref="S4.E2.m1.4.4.cmml">u</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.5" mathcolor="#0000FF" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml"><munderover id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2a" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2" mathcolor="#FF0000" movablelimits="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2.cmml">l</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1.cmml">=</mo><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mfrac id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2.cmml">L</mi><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3.cmml">2</mn></mfrac></munderover></mstyle><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.cmml"><mover accent="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.cmml"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2a.cmml">IE</mtext><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1.cmml">¯</mo></mover><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.2" mathcolor="#FF0000" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">(</mo><msubsup id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml">z</mi><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.cmml">0</mn><mrow id="S4.E2.m1.2.2.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo id="S4.E2.m1.2.2.1.3.1" mathcolor="#FF0000" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mi id="S4.E2.m1.2.2.1.1" mathcolor="#FF0000" xref="S4.E2.m1.2.2.1.1.cmml">l</mi><mo id="S4.E2.m1.2.2.1.3.2" mathcolor="#FF0000" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">,</mo><mi id="S4.E2.m1.5.5" mathcolor="#FF0000" xref="S4.E2.m1.5.5.cmml">y</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.4" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">,</mo><mi id="S4.E2.m1.6.6" mathcolor="#FF0000" xref="S4.E2.m1.6.6.cmml">u</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.5" mathcolor="#FF0000" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E2.m1.7.7.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S4.E2.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E2.m1.7.7.1.2" xref="S4.E2.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.7b"><apply id="S4.E2.m1.7.7.1.1.cmml" xref="S4.E2.m1.7.7.1"><eq id="S4.E2.m1.7.7.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.2"></eq><csymbol cd="latexml" id="S4.E2.m1.7.7.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.3">absent</csymbol><apply id="S4.E2.m1.7.7.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1"><times id="S4.E2.m1.7.7.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.2"></times><apply id="S4.E2.m1.7.7.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.3"><divide id="S4.E2.m1.7.7.1.1.1.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.3"></divide><cn id="S4.E2.m1.7.7.1.1.1.3.2.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.3.2">2</cn><ci id="S4.E2.m1.7.7.1.1.1.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.3.3">𝐿</ci></apply><apply id="S4.E2.m1.7.7.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1"><minus id="S4.E2.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.3"></minus><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3"><eq id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2">𝑙</ci><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3"><plus id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1"></plus><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2">1</cn><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3"><divide id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3"></divide><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2">𝐿</ci><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3">2</cn></apply></apply></apply></apply><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1"><times id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3"><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1">¯</ci><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2">IE</mtext></ci></apply><vector id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑙</ci></apply><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3">𝑦</ci><ci id="S4.E2.m1.4.4.cmml" xref="S4.E2.m1.4.4">𝑢</ci></vector></apply></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2">subscript</csymbol><sum id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2"></sum><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3"><eq id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1"></eq><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2">𝑙</ci><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3"><divide id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3"></divide><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2">𝐿</ci><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3">2</cn></apply></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1"><times id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2"></times><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3"><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1">¯</ci><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2a.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2">IE</mtext></ci></apply><vector id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1">superscript</csymbol><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2">𝑧</ci><ci id="S4.E2.m1.2.2.1.1.cmml" xref="S4.E2.m1.2.2.1.1">𝑙</ci></apply><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3">0</cn></apply><ci id="S4.E2.m1.5.5.cmml" xref="S4.E2.m1.5.5">𝑦</ci><ci id="S4.E2.m1.6.6.cmml" xref="S4.E2.m1.6.6">𝑢</ci></vector></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.7c">\displaystyle=\frac{2}{L}\Big{[}{\color[rgb]{0,0,1}\sum_{l=1+\frac{L}{2}}^{L}%
\overline{\text{IE}}(z^{(l)}_{T},y,u)}-{\color[rgb]{1,0,0}\sum_{l=1}^{\frac{L}%
{2}}\overline{\text{IE}}(z^{(l)}_{0},y,u)}\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.7d">= divide start_ARG 2 end_ARG start_ARG italic_L end_ARG [ ∑ start_POSTSUBSCRIPT italic_l = 1 + divide start_ARG italic_L end_ARG start_ARG 2 end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT over¯ start_ARG IE end_ARG ( italic_z start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_y , italic_u ) - ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT divide start_ARG italic_L end_ARG start_ARG 2 end_ARG end_POSTSUPERSCRIPT over¯ start_ARG IE end_ARG ( italic_z start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_y , italic_u ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px4.p3">
<p class="ltx_p" id="S4.SS1.SSS0.Px4.p3.8">where <math alttext="\color[rgb]{1,0,0}{\overline{\text{IE}}_{\text{early}}(y,u)}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.1.m1.2"><semantics id="S4.SS1.SSS0.Px4.p3.1.m1.2a"><mrow id="S4.SS1.SSS0.Px4.p3.1.m1.2.3" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.cmml"><msub id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.cmml"><mover accent="true" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1.cmml">¯</mo></mover><mtext id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3a.cmml">early</mtext></msub><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml"><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2.1" mathcolor="#FF0000" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.1.m1.1.1" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2.2" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.1.m1.2.2" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2.3" mathcolor="#FF0000" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.1.m1.2b"><apply id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3"><times id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1"></times><apply id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2">subscript</csymbol><apply id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2"><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2"><mtext id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2">IE</mtext></ci></apply><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3a.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3"><mtext id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3.cmml" mathcolor="#FF0000" mathsize="70%" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3">early</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2"><ci id="S4.SS1.SSS0.Px4.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.1.m1.2c">\color[rgb]{1,0,0}{\overline{\text{IE}}_{\text{early}}(y,u)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.1.m1.2d">over¯ start_ARG IE end_ARG start_POSTSUBSCRIPT early end_POSTSUBSCRIPT ( italic_y , italic_u )</annotation></semantics></math> is the average indirect effect of early-site intermediate representations of the first subject token <math alttext="w_{0}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.2.m2.1"><semantics id="S4.SS1.SSS0.Px4.p3.2.m2.1a"><msub id="S4.SS1.SSS0.Px4.p3.2.m2.1.1" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2.cmml">w</mi><mn id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.2.m2.1b"><apply id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2">𝑤</ci><cn id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.2.m2.1c">w_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.2.m2.1d">italic_w start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> (hidden states in blue dashed boxes in Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F2" title="Figure 2 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>), and <math alttext="\color[rgb]{0,0,1}{\overline{\text{IE}}_{\text{late}}(y,u)}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.3.m3.2"><semantics id="S4.SS1.SSS0.Px4.p3.3.m3.2a"><mrow id="S4.SS1.SSS0.Px4.p3.3.m3.2.3" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.cmml"><msub id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.cmml"><mover accent="true" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1.cmml">¯</mo></mover><mtext id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3a.cmml">late</mtext></msub><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml"><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2.1" mathcolor="#0000FF" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.3.m3.1.1" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2.2" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.3.m3.2.2" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2.3" mathcolor="#0000FF" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.3.m3.2b"><apply id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3"><times id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1"></times><apply id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2">subscript</csymbol><apply id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2"><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2"><mtext id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2">IE</mtext></ci></apply><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3a.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3"><mtext id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3.cmml" mathcolor="#0000FF" mathsize="70%" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3">late</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2"><ci id="S4.SS1.SSS0.Px4.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.3.m3.2c">\color[rgb]{0,0,1}{\overline{\text{IE}}_{\text{late}}(y,u)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.3.m3.2d">over¯ start_ARG IE end_ARG start_POSTSUBSCRIPT late end_POSTSUBSCRIPT ( italic_y , italic_u )</annotation></semantics></math> is the average indirect effect of late-site intermediate representations of the last relation token <math alttext="w_{T}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.4.m4.1"><semantics id="S4.SS1.SSS0.Px4.p3.4.m4.1a"><msub id="S4.SS1.SSS0.Px4.p3.4.m4.1.1" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2.cmml">w</mi><mi id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.4.m4.1b"><apply id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2">𝑤</ci><ci id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.4.m4.1c">w_{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.4.m4.1d">italic_w start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.5.m5.1"><semantics id="S4.SS1.SSS0.Px4.p3.5.m5.1a"><mi id="S4.SS1.SSS0.Px4.p3.5.m5.1.1" xref="S4.SS1.SSS0.Px4.p3.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.5.m5.1b"><ci id="S4.SS1.SSS0.Px4.p3.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.5.m5.1d">italic_u</annotation></semantics></math> (hidden states in red dashed boxes in Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F2" title="Figure 2 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>). We categorize a hallucination <math alttext="(u,o,o^{\prime})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.6.m6.3"><semantics id="S4.SS1.SSS0.Px4.p3.6.m6.3a"><mrow id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml"><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.2" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.6.m6.1.1" xref="S4.SS1.SSS0.Px4.p3.6.m6.1.1.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.3" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.6.m6.2.2" xref="S4.SS1.SSS0.Px4.p3.6.m6.2.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.4" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">,</mo><msup id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3.cmml">′</mo></msup><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.5" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.6.m6.3b"><vector id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1"><ci id="S4.SS1.SSS0.Px4.p3.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.1.1">𝑢</ci><ci id="S4.SS1.SSS0.Px4.p3.6.m6.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.2.2">𝑜</ci><apply id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.6.m6.3c">(u,o,o^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.6.m6.3d">( italic_u , italic_o , italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> as <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px4.p3.8.1">early-site</span> if its lower layer hidden representations have stronger AIEs (i.e. <math alttext="\Delta\overline{\text{IE}}(y,u)<0" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.7.m7.2"><semantics id="S4.SS1.SSS0.Px4.p3.7.m7.2a"><mrow id="S4.SS1.SSS0.Px4.p3.7.m7.2.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.cmml"><mrow id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.cmml"><mi id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2" mathvariant="normal" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2.cmml">Δ</mi><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1.cmml">⁢</mo><mover accent="true" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1.cmml">¯</mo></mover><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1a" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml"><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2.1" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.7.m7.1.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.7.m7.2.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2.3" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1.cmml">&lt;</mo><mn id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.7.m7.2b"><apply id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3"><lt id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1"></lt><apply id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2"><times id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1"></times><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2">Δ</ci><apply id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3"><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2"><mtext id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2"><ci id="S4.SS1.SSS0.Px4.p3.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.2">𝑢</ci></interval></apply><cn id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.7.m7.2c">\Delta\overline{\text{IE}}(y,u)&lt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.7.m7.2d">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) &lt; 0</annotation></semantics></math>), and otherwise categorize it as <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px4.p3.8.2">late-site</span> (i.e. <math alttext="\Delta\overline{\text{IE}}(y,u)\geq 0" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.8.m8.2"><semantics id="S4.SS1.SSS0.Px4.p3.8.m8.2a"><mrow id="S4.SS1.SSS0.Px4.p3.8.m8.2.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.cmml"><mrow id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.cmml"><mi id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2" mathvariant="normal" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2.cmml">Δ</mi><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1.cmml">⁢</mo><mover accent="true" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1.cmml">¯</mo></mover><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1a" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml"><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2.1" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.8.m8.1.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.8.m8.2.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2.3" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1.cmml">≥</mo><mn id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.8.m8.2b"><apply id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3"><geq id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1"></geq><apply id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2"><times id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1"></times><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2">Δ</ci><apply id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3"><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2"><mtext id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2"><ci id="S4.SS1.SSS0.Px4.p3.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.2">𝑢</ci></interval></apply><cn id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.8.m8.2c">\Delta\overline{\text{IE}}(y,u)\geq 0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.8.m8.2d">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) ≥ 0</annotation></semantics></math>). We found that early-site and late-site hallucinations have very different AIE distributions: as shown in <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F3" title="Figure 3 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, while most components that contribute significantly to early-site hallucinations are located in lower layers when processing subject tokens, late-site hallucinations are mostly caused by components concentrated in upper layers when processing the relation tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.4" style="width:368.6pt;height:217.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(92.9pt,-54.9pt) scale(2.01623380038052,2.01623380038052) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.4.4.5.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.4.4.5.1.1">Statistics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.4.4.5.1.2">Early-site hall.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.4.4.5.1.3">Late-site hall.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.4.4.6.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.4.4.6.1.1">Amount</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.6.1.2">(1945 / 31.9%)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.6.1.3">(4152 / 68.1%)</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.2.2.2.2">
<math alttext="s" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d">italic_s</annotation></semantics></math>-<math alttext="o" class="ltx_Math" display="inline" id="S4.T1.2.2.2.2.m2.1"><semantics id="S4.T1.2.2.2.2.m2.1a"><mi id="S4.T1.2.2.2.2.m2.1.1" xref="S4.T1.2.2.2.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m2.1b"><ci id="S4.T1.2.2.2.2.m2.1.1.cmml" xref="S4.T1.2.2.2.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m2.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.2.m2.1d">italic_o</annotation></semantics></math> assoc.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.2.3">0.40</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.2.4">0.88</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.4.4.2">
<math alttext="s" class="ltx_Math" display="inline" id="S4.T1.3.3.3.1.m1.1"><semantics id="S4.T1.3.3.3.1.m1.1a"><mi id="S4.T1.3.3.3.1.m1.1.1" xref="S4.T1.3.3.3.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.m1.1b"><ci id="S4.T1.3.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.1.m1.1d">italic_s</annotation></semantics></math>-<math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.T1.4.4.4.2.m2.1"><semantics id="S4.T1.4.4.4.2.m2.1a"><msup id="S4.T1.4.4.4.2.m2.1.1" xref="S4.T1.4.4.4.2.m2.1.1.cmml"><mi id="S4.T1.4.4.4.2.m2.1.1.2" xref="S4.T1.4.4.4.2.m2.1.1.2.cmml">o</mi><mo id="S4.T1.4.4.4.2.m2.1.1.3" xref="S4.T1.4.4.4.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.2.m2.1b"><apply id="S4.T1.4.4.4.2.m2.1.1.cmml" xref="S4.T1.4.4.4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.T1.4.4.4.2.m2.1.1.1.cmml" xref="S4.T1.4.4.4.2.m2.1.1">superscript</csymbol><ci id="S4.T1.4.4.4.2.m2.1.1.2.cmml" xref="S4.T1.4.4.4.2.m2.1.1.2">𝑜</ci><ci id="S4.T1.4.4.4.2.m2.1.1.3.cmml" xref="S4.T1.4.4.4.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.2.m2.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.2.m2.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> assoc.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.4.3">0.85</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.4.4">2.03</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4.7.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.4.7.2.1">Robustness</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.7.2.2">0.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.7.2.3">0.51</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4.8.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T1.4.4.8.3.1">Uncertainty</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.4.8.3.2">4.39</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.4.8.3.3">4.17</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>External data and Llama-2-7b prediction features for two types of non-factual hallucination.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">External manifestations of hallucination mechanisms.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px5.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px5.p1.10">To verify that our categorization of hallucinations is not a fabricated dichotomy based solely on internal computation patterns, we next investigate whether there are any external features that can be leveraged to distinguish the two types of hallucinations. We consider the following features of query data and model predictions: the <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px5.p1.10.1">subject-object association strength</span> is measured as the inner product between the input layer embeddings of a subject <math alttext="s" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px5.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px5.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.1.m1.1d">italic_s</annotation></semantics></math> and a true object <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px5.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px5.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.2.m2.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.2.m2.1d">italic_o</annotation></semantics></math> or a hallucinating object <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px5.p1.3.m3.1a"><msup id="S4.SS1.SSS0.Px5.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.3.m3.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.3.m3.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>; the <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px5.p1.10.2">robustness</span> of a predicted object <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px5.p1.4.m4.1a"><msup id="S4.SS1.SSS0.Px5.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.2" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.3" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.4.m4.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.4.m4.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is measured as the percentage of Gaussian noise injected during the mitigation run in section <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4.1</span></a> which, after being added to the input embeddings, fails to make the model prefer the true answer <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px5.p1.5.m5.1a"><mi id="S4.SS1.SSS0.Px5.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px5.p1.5.m5.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.5.m5.1b"><ci id="S4.SS1.SSS0.Px5.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.5.m5.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.5.m5.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.5.m5.1d">italic_o</annotation></semantics></math> over <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.6.m6.1"><semantics id="S4.SS1.SSS0.Px5.p1.6.m6.1a"><msup id="S4.SS1.SSS0.Px5.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.6.m6.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.6.m6.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> (i.e., <math alttext="y_{*}<0<y" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.7.m7.1"><semantics id="S4.SS1.SSS0.Px5.p1.7.m7.1a"><mrow id="S4.SS1.SSS0.Px5.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.cmml"><msub id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2.cmml">y</mi><mo id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3.cmml">*</mo></msub><mo id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3.cmml">&lt;</mo><mn id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4.cmml">0</mn><mo id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5.cmml">&lt;</mo><mi id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.7.m7.1b"><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"><and id="S4.SS1.SSS0.Px5.p1.7.m7.1.1a.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"></and><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1b.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"><lt id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3"></lt><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2">𝑦</ci><times id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3"></times></apply><cn id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4.cmml" type="integer" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4">0</cn></apply><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1c.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"><lt id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5"></lt><share href="#S4.SS1.SSS0.Px5.p1.7.m7.1.1.4.cmml" id="S4.SS1.SSS0.Px5.p1.7.m7.1.1d.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"></share><ci id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.7.m7.1c">y_{*}&lt;0&lt;y</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.7.m7.1d">italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT &lt; 0 &lt; italic_y</annotation></semantics></math>); the <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px5.p1.10.3">uncertainty</span> of model prediction is measured by the entropy of the conditional next-token distribution <math alttext="p(o|u)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.8.m8.1"><semantics id="S4.SS1.SSS0.Px5.p1.8.m8.1a"><mrow id="S4.SS1.SSS0.Px5.p1.8.m8.1.1" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.3" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.3.cmml">p</mi><mo id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.2" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.8.m8.1b"><apply id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1"><times id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.2"></times><ci id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.3">𝑝</ci><apply id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.8.m8.1c">p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.8.m8.1d">italic_p ( italic_o | italic_u )</annotation></semantics></math>. Table <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.T1" title="Table 1 ‣ Early- vs. late-site hallucination. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the external measurements. We found that 1) subjects of late-site hallucinations (e.g., <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.4">Toulouse</span>) often have hallucinating objects (e.g., <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.5">Paris</span>) of much stronger association strengths than true objects (e.g., <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.6">Bologna</span>), so that the model fail to “offset” the prior propensity of model predicting <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.9.m9.1"><semantics id="S4.SS1.SSS0.Px5.p1.9.m9.1a"><msup id="S4.SS1.SSS0.Px5.p1.9.m9.1.1" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.2" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.3" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.9.m9.1b"><apply id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.9.m9.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.9.m9.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> upon seeing <math alttext="s" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.10.m10.1"><semantics id="S4.SS1.SSS0.Px5.p1.10.m10.1a"><mi id="S4.SS1.SSS0.Px5.p1.10.m10.1.1" xref="S4.SS1.SSS0.Px5.p1.10.m10.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.10.m10.1b"><ci id="S4.SS1.SSS0.Px5.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.10.m10.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.10.m10.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.10.m10.1d">italic_s</annotation></semantics></math>. Subjects of early-site hallucinations (e.g., <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.7">Orica</span>), on the other hand, often have much weaker associations with both true (e.g., <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.8">Australia</span>) and hallucinating (e.g., <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.9">January</span>) objects; 2) late-site hallucinations are significantly less robust under input perturbations, probably because the model has already retrieved the correct object from early layers and is just “one step away” from distinguishing it; 3) the model is less certain about its predictions when generating early-site hallucinations, a pattern that is consistent with previous findings that epistemic hallucinations are often associated with high predictive uncertainty <cite class="ltx_cite ltx_citemacro_cite">Xiao and Wang (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib54" title="">2021</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="838" id="S4.F4.g1" src="x5.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Average dot product between true object embedding and intermediate hidden representations by components of Llama-2-7b in each layer.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Inspection via embedding space projection</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">In this section, we provide further evidence of the mechanistic difference between early- and late-site hallucinations by looking at the information that each model component writes into the residual stream during inference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Method.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.10">As Section <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S3" title="3 Background and Notation ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> suggests, each attention or MLP module at layer <math alttext="l" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.m1.1d">italic_l</annotation></semantics></math> contributes to the model prediction by adding its output hidden state into the embeddings <math alttext="h^{(l-1)}_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><msubsup id="S4.SS2.SSS0.Px1.p1.2.m2.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2.cmml">h</mi><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3.cmml">i</mi><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2">ℎ</ci><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3">1</cn></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">h^{(l-1)}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.2.m2.1d">italic_h start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> produced by the previous layer. Recent work shows that the encoded knowledge of a module can be interpreted by applying the final-layer language model head projection (i.e. dot product) to its intermediate output hidden state, thereby obtaining a distribution over the vocabulary <cite class="ltx_cite ltx_citemacro_cite">Geva et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib17" title="">2022b</a>); Dar et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib8" title="">2023</a>)</cite>. For each example of model hallucination <math alttext="(u,o,o^{\prime})" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.3.m3.3"><semantics id="S4.SS2.SSS0.Px1.p1.3.m3.3a"><mrow id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml"><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">u</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">,</mo><mi id="S4.SS2.SSS0.Px1.p1.3.m3.2.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.2.2.cmml">o</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.4" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">,</mo><msup id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2.cmml">o</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3.cmml">′</mo></msup><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.5" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.m3.3b"><vector id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1"><ci id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1">𝑢</ci><ci id="S4.SS2.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.2.2">𝑜</ci><apply id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2">𝑜</ci><ci id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.m3.3c">(u,o,o^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.3.m3.3d">( italic_u , italic_o , italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, we use this method by first extracting the intermediate outputs <math alttext="z\in A\bigcup M" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px1.p1.4.m4.1a"><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml">z</mi><mo id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml">∈</mo><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">A</mi><mo id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.cmml"><mo id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml">⋃</mo><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml">M</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1"><in id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1"></in><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2">𝑧</ci><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3"><times id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2">𝐴</ci><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3"><union id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1"></union><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.4.m4.1c">z\in A\bigcup M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.4.m4.1d">italic_z ∈ italic_A ⋃ italic_M</annotation></semantics></math> of all MLPs and attention modules, and then taking the dot product <math alttext="\tilde{p}(z,o)=z^{T}e_{o}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.5.m5.2"><semantics id="S4.SS2.SSS0.Px1.p1.5.m5.2a"><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.cmml"><mover accent="true" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2.cmml">p</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1.cmml">~</mo></mover><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.cmml">z</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml">,</mo><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.2.cmml">o</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1.cmml">=</mo><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.cmml"><msup id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2.cmml">z</mi><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3.cmml">T</mi></msup><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2.cmml">e</mi><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3.cmml">o</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.5.m5.2b"><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3"><eq id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1"></eq><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2"><times id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2"><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1">~</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2">𝑝</ci></apply><interval closure="open" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2"><ci id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1">𝑧</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.2">𝑜</ci></interval></apply><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3"><times id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1"></times><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2">𝑧</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3">𝑇</ci></apply><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2">𝑒</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.5.m5.2c">\tilde{p}(z,o)=z^{T}e_{o}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.5.m5.2d">over~ start_ARG italic_p end_ARG ( italic_z , italic_o ) = italic_z start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> between <math alttext="z" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.6.m6.1"><semantics id="S4.SS2.SSS0.Px1.p1.6.m6.1a"><mi id="S4.SS2.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS2.SSS0.Px1.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.6.m6.1b"><ci id="S4.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.6.m6.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.6.m6.1d">italic_z</annotation></semantics></math> and the row vectors corresponding to <math alttext="o" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.7.m7.1"><semantics id="S4.SS2.SSS0.Px1.p1.7.m7.1a"><mi id="S4.SS2.SSS0.Px1.p1.7.m7.1.1" xref="S4.SS2.SSS0.Px1.p1.7.m7.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.7.m7.1b"><ci id="S4.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m7.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.7.m7.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.7.m7.1d">italic_o</annotation></semantics></math> in the final projection layer. The resulting embedding space projection (ESP) can be taken as an approximated contribution of <math alttext="z" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.8.m8.1"><semantics id="S4.SS2.SSS0.Px1.p1.8.m8.1a"><mi id="S4.SS2.SSS0.Px1.p1.8.m8.1.1" xref="S4.SS2.SSS0.Px1.p1.8.m8.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.8.m8.1b"><ci id="S4.SS2.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.8.m8.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.8.m8.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.8.m8.1d">italic_z</annotation></semantics></math> to <math alttext="p(o|u)" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.9.m9.1"><semantics id="S4.SS2.SSS0.Px1.p1.9.m9.1a"><mrow id="S4.SS2.SSS0.Px1.p1.9.m9.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3.cmml">p</mi><mo id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.9.m9.1b"><apply id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1"><times id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2"></times><ci id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3">𝑝</ci><apply id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2">𝑜</ci><ci id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.9.m9.1c">p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.9.m9.1d">italic_p ( italic_o | italic_u )</annotation></semantics></math>. By averaging the projections over all queries and all modules of the same type in each layer, we can then quantify how much knowledge about the correct answer <math alttext="o" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.10.m10.1"><semantics id="S4.SS2.SSS0.Px1.p1.10.m10.1a"><mi id="S4.SS2.SSS0.Px1.p1.10.m10.1.1" xref="S4.SS2.SSS0.Px1.p1.10.m10.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.10.m10.1b"><ci id="S4.SS2.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m10.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.10.m10.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.10.m10.1d">italic_o</annotation></semantics></math> each layer contributes during inference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">We compute the layerwise MLP and attention projections for the true objects averaged over three groups of queries: 1) factual answers (i.e. model correctly predicts <math alttext="o" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.1.m1.1d">italic_o</annotation></semantics></math> as the next token), 2) early-site hallucinations, and 3) late-site hallucinations. Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F4" title="Figure 4 ‣ External manifestations of hallucination mechanisms. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> shows the results. We notice that 1) only lower layer MLPs write information about the true answer into the residual stream, and importantly, the contributions of lower layer MLPs are similar for late-site hallucinations and correctly answered queries, while being much less when the model generates early-site hallucinations. 2) For both types of hallucination, the self-attention components, particularly those in upper layers, write significantly less useful information compared to factually correct answers. Similar patterns observed in GPT models can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS4" title="B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">B.4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p2.1">Taken together, our analysis suggests that 1) <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.1">early-site MLPs, late-site self-attentions and late-site MLPs are the most crucial LM components of causing hallucinations</span>, and 2) <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.2">lower layer MLPs and upper layer attentions/MLPs do not always break down simultaneously, thus leading to two distinct mechanisms of LM factual errors.</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Tracing LM Hallucinations During Pretraining</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We have identified two mechanisms of non-factual hallucinations in LMs. In this section, we design experiments with the goal of understanding how these hallucinations emerge during model pretraining. For example, do early-site and late-site hallucinations exhibit different learning patterns that contribute to their distinctions? We also aim to explore why the crucial early-site MLP and late-site attention components fail to “develop” properly.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Data and models.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">To study language model hallucinations during pretraining, we evaluate the Pythia model suite <cite class="ltx_cite ltx_citemacro_cite">Biderman et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib2" title="">2023</a>)</cite> on ParaRel. Pythia is a set of pretraining checkpoints for a family of autoregressive LMs trained on public data in the exact same order. We first take the last checkpoint of Pythia with 1.4 billion parameters and repeat the same evaluation and filtering processes for other LMs on ParaRel dataset described in section <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4.1</span></a>, and then perform causal mediation analysis on incorrectly answered queries to get AIEs for attention heads and MLPs, and categorize the queries into early-site and late-site hallucinations based on Equation <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.E2" title="2 ‣ Early- vs. late-site hallucination. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>. We then evaluate and get intermediate hidden states for all queries on 32 Pythia-1.4B pretraining checkpoints evenly distributed across model learning history.<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A3" title="Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">C</span></a> for details of Pythia evaluation.</span></span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Development of factual association pipeline.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.1">We replicate the embedding space projection (ESP) experiments in section <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS2" title="4.2 Inspection via embedding space projection ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4.2</span></a> on Pythia-1.4b checkpoints and compare the results across pretraining steps. For each Pythia-1.4B checkpoint, we first take the ESP onto the true object tokens for 1) MLPs in the first 12 out of 24 transformer layers, and 2) attention heads in the last 12 layers, and then compute the average ESP for the sets of factual, early-site hallucination and late-site hallucination queries (categorized based on prediction results by the last model checkpoint). Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S5.F5" title="Figure 5 ‣ Development of factual association pipeline. ‣ 5 Tracing LM Hallucinations During Pretraining ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> shows the evolution trajectory of true object ESPs on 32 Pythia-1.4b checkpoints. We notice that 1) the learning dynamics of MLPs between late-site hallucination and factual queries are very similar, where they gradually learn to produce positive ESPs to the true object prediction roughly during the first half of pretraining. For early-site hallucinations, the MLPs instead learn to make negative ESPs, again suggesting their lack of true subject knowledge. 2) The upper-layer attentions of Pythia only learn to produce high ESPs for factual queries. Moreover, the attention modules will not learn to distinguish true objects until the early-site MLPs have grown mature (<math alttext="\sim" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S5.SS0.SSS0.Px2.p1.1.m1.1a"><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.1.m1.1b"><csymbol cd="latexml" id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.1.m1.1d">∼</annotation></semantics></math>70-<span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px2.p1.1.1">th</span> pretraining step). Taken together, our results suggest that <span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px2.p1.1.2">the early-site MLPs and late-site attentions together form a two-step pipeline of fact recall that emerges progressively during pretraining, and failing to develop either of them will lead to non-factual hallucinations</span>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="753" id="S5.F5.g1" src="x6.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Average embedding space projections to the true object tokens for lower-layer MLPs (up) and upper-layer attention modules (down) of Pythia-1.4b pretraining checkpoints. The red vertical line indicates a “phase change” when the lower layer MLPs finish their learning, and upper layer attention heads start to develop. </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Application to Hallucination Detection</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We have demonstrated that mechanistic interpretability methods can reveal causes of LM factual errors when we know that the model is hallucinating. In this section, we further show that the causal attribution features in our previous analyses can also predict whether an LM is generating hallucinations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Data.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px1.p1.1">We study non-factual hallucinations by GPT2-XL <span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>We encountered GPU memory issues when implementing gradient-based baselines and causal approximations on larger LMs, so here we focused on GPT2-XL and leave experiments on other LMs for future work.</span></span></span> on three datasets: 1) the <span class="ltx_text ltx_font_bold" id="S6.SS0.SSS0.Px1.p1.1.1">ParaRel</span> dataset used in section <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4" title="4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, 2) the <span class="ltx_text ltx_font_bold" id="S6.SS0.SSS0.Px1.p1.1.2">Natural Questions</span> dataset <cite class="ltx_cite ltx_citemacro_cite">Kwiatkowski et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib26" title="">2019</a>)</cite> that consists of Google search engine queries annotated with answers and supporting Wikipedia pages, and 3) the <span class="ltx_text ltx_font_bold" id="S6.SS0.SSS0.Px1.p1.1.3">TruthfulQA</span> dataset by <cite class="ltx_cite ltx_citemacro_citet">Lin et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib28" title="">2022</a>)</cite> consisting of adversarially constructed commonsense reasoning questions to measure whether an LM is truthful in generating answers. We follow the multiple-choice evaluation scheme in question answering and ask GPT2-XL to compute the conditional log-likelihood of every candidate answer. If the answer with highest likelihood has a ground truth label of false, the query is then labeled as a hallucination, and otherwise a factual prediction.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Methods.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px2.p1.3">We study the following classification problem: given a query <math alttext="u" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S6.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S6.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S6.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S6.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px2.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px2.p1.1.m1.1d">italic_u</annotation></semantics></math> and a next-word prediction <math alttext="o" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S6.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S6.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S6.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S6.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px2.p1.2.m2.1c">o</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px2.p1.2.m2.1d">italic_o</annotation></semantics></math> by a language model, we wish to predict whether the model is hallucinating or not. We build logistic regression models to predict model factuality based on the causal effect scores of transformer modules to the log-likelihood <math alttext="\log p(o|u)" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S6.SS0.SSS0.Px2.p1.3.m3.1a"><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">log</mi><mo id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3a" lspace="0.167em" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">p</mi></mrow><mo id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1"><times id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2"></times><apply id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3"><log id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px2.p1.3.m3.1c">\log p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px2.p1.3.m3.1d">roman_log italic_p ( italic_o | italic_u )</annotation></semantics></math> of the model predicted next token, using the same causal intervention patching method as in Section&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4.1</span></a>. Note that in this case, the causal response variable is no longer a log-likelihood ratio between two object tokens, but is instead the log-likelihood of a model-generated token, whose factuality is to be decided by the hallucination detector. We compute the AIE for each neuron in the intermediate outputs of the attention, MLP and residual stream modules across 48 layers, and concatenate the arrays of AIE scores of three modules to get a single 4,800-dimensional feature vector. Since performing causal mediation analysis over individual neurons is very expensive, we adopt the gradient-based approximation method of causal mediation effect by <cite class="ltx_cite ltx_citemacro_cite">Nanda (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib35" title="">2023</a>)</cite> to accelerate computations<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A4" title="Appendix D Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">D</span></a> for details of the causal effect approximation method.</span></span></span>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Baselines.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px3.p1.3">We also test baseline logistic regression models using a suite of non-causal internal features that have been shown to be indicative of LM hallucinations: 1) the last-layer hidden state of the last token of the input sequence, which the model uses directly to generate the next token <cite class="ltx_cite ltx_citemacro_cite">Zhou et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib60" title="">2021</a>)</cite>; 2) the activation values <cite class="ltx_cite ltx_citemacro_cite">Li et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib27" title="">2023</a>)</cite>; 3) the gradients <cite class="ltx_cite ltx_citemacro_cite">De&nbsp;Cao et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib9" title="">2021</a>)</cite> with respect to <math alttext="\log p(o|u)" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="S6.SS0.SSS0.Px3.p1.1.m1.1a"><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.cmml"><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1.cmml">log</mi><mo id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3a" lspace="0.167em" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2.cmml">p</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px3.p1.1.m1.1b"><apply id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1"><times id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2"></times><apply id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3"><log id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px3.p1.1.m1.1c">\log p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px3.p1.1.m1.1d">roman_log italic_p ( italic_o | italic_u )</annotation></semantics></math>; 4) the activation * gradient values <cite class="ltx_cite ltx_citemacro_cite">Tang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib45" title="">2022</a>)</cite> with respect to <math alttext="\log p(o|u)" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px3.p1.2.m2.1"><semantics id="S6.SS0.SSS0.Px3.p1.2.m2.1a"><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.cmml"><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml">log</mi><mo id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3a" lspace="0.167em" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml">p</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml"><mo id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1"><times id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2"></times><apply id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3"><log id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px3.p1.2.m2.1c">\log p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px3.p1.2.m2.1d">roman_log italic_p ( italic_o | italic_u )</annotation></semantics></math>; and 5) the Integrated Gradient <cite class="ltx_cite ltx_citemacro_cite">Sundararajan et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib44" title="">2017</a>)</cite> with respect to <math alttext="\log p(o|u)" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px3.p1.3.m3.1"><semantics id="S6.SS0.SSS0.Px3.p1.3.m3.1a"><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml">log</mi><mo id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3a" lspace="0.167em" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml">p</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml"><mo id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1"><times id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2"></times><apply id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3"><log id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px3.p1.3.m3.1c">\log p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px3.p1.3.m3.1d">roman_log italic_p ( italic_o | italic_u )</annotation></semantics></math>. For baselines (2)-(4), we compute features for the same set of intermediate neurons as for the causal effect-based classifiers, so that the dimensions of baseline input feature vectors are the same as the IE-based feature vectors.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px4.p1.1">For each dataset, we perform a 5-fold cross-validation and compute the mean predictive accuracy of every hallucination classifier over the validation sets. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.T2" title="Table 2 ‣ Results. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> summarizes the results. We found that the causal indirect effect features best predict model hallucinations on all datasets, consistently exceeding all baseline models. Notably, all baselines except IG only make use of internal information without input perturbations, so their inferior performance compared to AIE suggests that counterfactual interventions of model inference process in causal mediation analysis are crucial for locating crucial components of causing factual errors. The IG baseline, as suggested by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Meng et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite>, is often over-sensitive to input textual artifacts (e.g. rare words and typos), and therefore yields much less reliable predictions on the two QA datasets with diverse input formats.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S6.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T2.1" style="width:368.6pt;height:273.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(87.4pt,-64.9pt) scale(1.90193354407282,1.90193354407282) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T2.1.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S6.T2.1.1.1.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.1.1.1.1.2">ParaRel</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.1.1.1.1.3">NaturalQA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.1.1.1.1.4">TruthfulQA</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T2.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T2.1.1.2.1.1">Random</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.1.2.1.2">50.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.1.2.1.3">50.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.1.2.1.4">50.0</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.3.2.1">LHS</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.3.2.2">62.1</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.3.2.3">56.6</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.3.2.4">50.4</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.4.3.1">Activation</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.4.3.2">67.8</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.4.3.3">62.6</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.4.3.4">52.0</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.5.4.1">Gradient</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.5.4.2">68.8</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.5.4.3">66.1</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.5.4.4">53.8</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.6.5.1">Grad. X Act.</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.6.5.2">68.9</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.6.5.3">68.3</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.6.5.4">60.1</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.7.6.1">IG</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.7.6.2">69.9</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.7.6.3">67.4</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.7.6.4">53.2</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S6.T2.1.1.8.7.1">Causal IE</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T2.1.1.8.7.2"><span class="ltx_text ltx_font_bold" id="S6.T2.1.1.8.7.2.1">70.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T2.1.1.8.7.3"><span class="ltx_text ltx_font_bold" id="S6.T2.1.1.8.7.3.1">69.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T2.1.1.8.7.4"><span class="ltx_text ltx_font_bold" id="S6.T2.1.1.8.7.4.1">60.8</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Mean 5-fold cross-validation accuracy of hallucination classifiers trained using various internal features on three fact query datasets.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">Through interpretability analysis, we identified two causes of language model non-factual hallucinations: 1) insufficient attribute knowledge in lower layer MLPs and 2) flawed object selection in upper layer attentions and MLPs. We also revealed distinguishing properties in data and model predictions, along with divergent pre-training trajectories for the two mechanistic types of hallucination. Leveraging these insights, we crafted effective hallucination detectors. Our work establishes a mechanistic understanding of LM factual errors, and may inspire future research on explainable approaches of hallucination mitigation.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Limitation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">Our study bears several limitations. Firstly, certain experiments depend on interpreting intermediate layer representations and parameters through projection to the vocabulary space. While widely used, this method only approximates the encoded information of model components, particularly in early layers. Secondly, our focus on non-factual hallucinations with simple input sequences may not fully capture real-world LM behavior. Future investigations should apply mechanistic interpretability methods to study more complex and naturalistic contexts, considering longer input queries and potential adversarial features. Thirdly, we did not explore methods to reduce LM hallucinations based on insights gained from our mechanistic analysis. Future work may consider develop efficient hallucination mitigation methods by performing targeted weight editing or inference time intervention on crucial model components identified in this study.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akyürek et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ekin Akyürek, Tolga Bolukbasi, Frederick Liu, Binbin Xiong, Ian Tenney, Jacob Andreas, and Kelvin Guu. 2022.

</span>
<span class="ltx_bibblock">Towards tracing knowledge in language models back to the training data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Findings of the Association for Computational Linguistics: EMNLP 2022</em>, pages 2429–2446.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stella Biderman, Hailey Schoelkopf, Quentin&nbsp;Gregory Anthony, Herbie Bradley, Kyle O’Brien, Eric Hallahan, Mohammad&nbsp;Aflah Khan, Shivanshu Purohit, USVSN&nbsp;Sai Prashanth, Edward Raff, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Machine Learning</em>, pages 2397–2430. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et&nbsp;al. (2022a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Meng Cao, Yue Dong, and Jackie Cheung. 2022a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.acl-long.236" title="">Hallucinated but factual! inspecting the factuality of hallucinations in abstractive summarization</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 3340–3354, Dublin, Ireland. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et&nbsp;al. (2022b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Meng Cao, Yue Dong, Jingyi He, and Jackie Chi&nbsp;Kit Cheung. 2022b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.emnlp-main.663" title="">Learning with rejection for abstractive text summarization</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pages 9768–9780, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Roi Cohen, May Hamri, Mor Geva, and Amir Globerson. 2023.

</span>
<span class="ltx_bibblock">Lm vs lm: Detecting factual errors via cross examination.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2305.13281</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Conmy et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Arthur Conmy, Augustine&nbsp;N Mavor-Parker, Aengus Lynch, Stefan Heimersheim, and Adrià Garriga-Alonso. 2023.

</span>
<span class="ltx_bibblock">Towards automated circuit discovery for mechanistic interpretability.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2304.14997</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Damai Dai, Li&nbsp;Dong, Yaru Hao, Zhifang Sui, Baobao Chang, and Furu Wei. 2022.

</span>
<span class="ltx_bibblock">Knowledge neurons in pretrained transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 8493–8502.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dar et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guy Dar, Mor Geva, Ankit Gupta, and Jonathan Berant. 2023.

</span>
<span class="ltx_bibblock">Analyzing transformers in embedding space.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Annual Meeting of the Association for Computational Linguistics</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">De&nbsp;Cao et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nicola De&nbsp;Cao, Wilker Aziz, and Ivan Titov. 2021.

</span>
<span class="ltx_bibblock">Editing factual knowledge in language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 6491–6506.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chenhe Dong, Yinghui Li, Haifan Gong, Miaoxin Chen, Junxin Li, Ying Shen, and Min Yang. 2022.

</span>
<span class="ltx_bibblock">A survey of natural language generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ACM Computing Surveys</em>, 55(8):1–38.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elaraby et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mohamed Elaraby, Mengyin Lu, Jacob Dunn, Xueying Zhang, Yu&nbsp;Wang, and Shizhu Liu. 2023.

</span>
<span class="ltx_bibblock">Halo: Estimation and reduction of hallucinations in open-source weak large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2308.11764</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elazar et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yanai Elazar, Nora Kassner, Shauli Ravfogel, Abhilasha Ravichander, Eduard Hovy, Hinrich Schütze, and Yoav Goldberg. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1162/tacl_a_00410" title="">Measuring and improving consistency in pretrained language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Transactions of the Association for Computational Linguistics</em>, 9:1012–1031.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elhage et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nelson Elhage, Neel Nanda, Catherine Olsson, Tom Henighan, Nicholas Joseph, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, Tom Conerly, Nova DasSarma, Dawn Drain, Deep Ganguli, Zac Hatfield-Dodds, Danny Hernandez, Andy Jones, Jackson Kernion, Liane Lovitt, Kamal Ndousse, Dario Amodei, Tom Brown, Jack Clark, Jared Kaplan, Sam McCandlish, and Chris Olah. 2021.

</span>
<span class="ltx_bibblock">A mathematical framework for transformer circuits.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Transformer Circuits Thread</em>.

</span>
<span class="ltx_bibblock">Https://transformer-circuits.pub/2021/framework/index.html.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finlayson et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Matthew Finlayson, Aaron Mueller, Sebastian Gehrmann, Stuart&nbsp;M Shieber, Tal Linzen, and Yonatan Belinkov. 2021.

</span>
<span class="ltx_bibblock">Causal analysis of syntactic agreement mechanisms in neural language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers)</em>, pages 1828–1843.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mor Geva, Jasmijn Bastings, Katja Filippova, and Amir Globerson. 2023.

</span>
<span class="ltx_bibblock">Dissecting recall of factual associations in auto-regressive language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2304.14767</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2022a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mor Geva, Avi Caciularu, Guy Dar, Paul Roit, Shoval Sadde, Micah Shlain, Bar Tamir, and Yoav Goldberg. 2022a.

</span>
<span class="ltx_bibblock">Lm-debugger: An interactive tool for inspection and intervention in transformer-based language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the The 2022 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pages 12–21.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2022b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mor Geva, Avi Caciularu, Kevin Wang, and Yoav Goldberg. 2022b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.emnlp-main.3" title="">Transformer feed-forward layers build predictions by promoting concepts in the vocabulary space</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pages 30–45, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mor Geva, Roei Schuster, Jonathan Berant, and Omer Levy. 2021.

</span>
<span class="ltx_bibblock">Transformer feed-forward layers are key-value memories.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 5484–5495.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghandeharioun et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Asma Ghandeharioun, Avi Caciularu, Adam Pearce, Lucas Dixon, and Mor Geva. 2024.

</span>
<span class="ltx_bibblock">Patchscope: A unifying framework for inspecting hidden representations of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2401.06102</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haviv et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Adi Haviv, Ori Ram, Ofir Press, Peter Izsak, and Omer Levy. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.findings-emnlp.99" title="">Transformer language models without positional encodings still learn positional information</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Findings of the Association for Computational Linguistics: EMNLP 2022</em>, pages 1382–1390, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hernandez et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Evan Hernandez, Arnab&nbsp;Sen Sharma, Tal Haklay, Kevin Meng, Martin Wattenberg, Jacob Andreas, Yonatan Belinkov, and David Bau. 2023.

</span>
<span class="ltx_bibblock">Linearity of relation decoding in transformer language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2308.09124</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ziwei Ji, Nayeon Lee, Rita Frieske, Tiezheng Yu, Dan Su, Yan Xu, Etsuko Ishii, Ye&nbsp;Jin Bang, Andrea Madotto, and Pascale Fung. 2023.

</span>
<span class="ltx_bibblock">Survey of hallucination in natural language generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">ACM Computing Surveys</em>, 55(12):1–38.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhengbao Jiang, Frank&nbsp;F Xu, Jun Araki, and Graham Neubig. 2020.

</span>
<span class="ltx_bibblock">How can we know what language models know?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Transactions of the Association for Computational Linguistics</em>, 8:423–438.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaddour et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jean Kaddour, Joshua Harris, Maximilian Mozes, Herbie Bradley, Roberta Raileanu, and Robert McHardy. 2023.

</span>
<span class="ltx_bibblock">Challenges and applications of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2307.10169</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katz et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shahar Katz, Yonatan Belinkov, Mor Geva, and Lior Wolf. 2024.

</span>
<span class="ltx_bibblock">Backward lens: Projecting language model gradients into the vocabulary space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2402.12865</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, et&nbsp;al. 2019.

</span>
<span class="ltx_bibblock">Natural questions: a benchmark for question answering research.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Transactions of the Association for Computational Linguistics</em>, 7:453–466.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kenneth Li, Oam Patel, Fernanda Viégas, Hanspeter Pfister, and Martin Wattenberg. 2023.

</span>
<span class="ltx_bibblock">Inference-time intervention: Eliciting truthful answers from a language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2306.03341</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stephanie Lin, Jacob Hilton, and Owain Evans. 2022.

</span>
<span class="ltx_bibblock">Truthfulqa: Measuring how models mimic human falsehoods.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 3214–3252.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kaiji Lu, Zifan Wang, Piotr Mardziel, and Anupam Datta. 2021.

</span>
<span class="ltx_bibblock">Influence patterns for explaining information flow in bert.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems</em>, 34:4461–4474.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Manakul et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Potsawee Manakul, Adian Liusie, and Mark&nbsp;JF Gales. 2023.

</span>
<span class="ltx_bibblock">Selfcheckgpt: Zero-resource black-box hallucination detection for generative large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2303.08896</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et&nbsp;al. (2022a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kevin Meng, David Bau, Alex Andonian, and Yonatan Belinkov. 2022a.

</span>
<span class="ltx_bibblock">Locating and editing factual associations in gpt.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Advances in Neural Information Processing Systems</em>, 35:17359–17372.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et&nbsp;al. (2022b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kevin Meng, Arnab&nbsp;Sen Sharma, Alex Andonian, Yonatan Belinkov, and David Bau. 2022b.

</span>
<span class="ltx_bibblock">Mass-editing memory in a transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2210.07229</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mitchell et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Eric Mitchell, Charles Lin, Antoine Bosselut, Chelsea Finn, and Christopher&nbsp;D Manning. 2021.

</span>
<span class="ltx_bibblock">Fast model editing at scale.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mündler et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Niels Mündler, Jingxuan He, Slobodan Jenko, and Martin Vechev. 2023.

</span>
<span class="ltx_bibblock">Self-contradictory hallucinations of large language models: Evaluation, detection and mitigation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2305.15852</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nanda (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Neel Nanda. 2023.

</span>
<span class="ltx_bibblock">Attribution patching: Activation patching at industrial scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">URL: https://www. neelnanda. io/mechanistic-interpretability/attribution-patching</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nanda et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Neel Nanda, Lawrence Chan, Tom Lieberum, Jess Smith, and Jacob Steinhardt. 2022.

</span>
<span class="ltx_bibblock">Progress measures for grokking via mechanistic interpretability.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">The Eleventh International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nostalgebraist (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nostalgebraist. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://www.lesswrong.com/posts/AcKRB8wDpdaN6v6ru/interpreting-gpt-the-logit-lens" title="">Interpreting gpt: the logit lens</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">LESSWRONG</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Olah (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chris Olah. 2022.

</span>
<span class="ltx_bibblock">Mechanistic interpretability, variables, and the importance of interpretable bases.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Transformer Circuits Thread</em>.

</span>
<span class="ltx_bibblock">Https://transformer-circuits.pub/2022/mech-interp-essay/index.html.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pearl (2001)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Judea Pearl. 2001.

</span>
<span class="ltx_bibblock">Direct and indirect effects.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proc. of the 17th Conference on Uncertainty in Artificial Intelligence, 2001</em>, pages 411–420.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petroni et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Fabio Petroni, Tim Rocktäschel, Sebastian Riedel, Patrick Lewis, Anton Bakhtin, Yuxiang Wu, and Alexander Miller. 2019.

</span>
<span class="ltx_bibblock">Language models as knowledge bases?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pages 2463–2473.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et&nbsp;al. 2019.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">OpenAI blog</em>, 1(8):9.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aarohi Srivastava, Abhinav Rastogi, Abhishek Rao, Abu Awal&nbsp;Md Shoeb, Abubakar Abid, Adam Fisch, Adam&nbsp;R Brown, Adam Santoro, Aditya Gupta, Adrià Garriga-Alonso, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Beyond the imitation game: Quantifying and extrapolating the capabilities of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Transactions on Machine Learning Research</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stolfo et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alessandro Stolfo, Yonatan Belinkov, and Mrinmaya Sachan. 2023.

</span>
<span class="ltx_bibblock">A mechanistic interpretation of arithmetic reasoning in language models using causal mediation analysis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 7035–7052.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sundararajan et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mukund Sundararajan, Ankur Taly, and Qiqi Yan. 2017.

</span>
<span class="ltx_bibblock">Axiomatic attribution for deep networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">International conference on machine learning</em>, pages 3319–3328. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Joël Tang, Marina Fomicheva, and Lucia Specia. 2022.

</span>
<span class="ltx_bibblock">Reducing hallucinations in neural machine translation with feature attribution.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2211.09878</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2307.09288</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Turpin et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Miles Turpin, Julian Michael, Ethan Perez, and Samuel&nbsp;R Bowman. 2023.

</span>
<span class="ltx_bibblock">Language models don’t always say what they think: Unfaithful explanations in chain-of-thought prompting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2305.04388</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Varshney et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Neeraj Varshney, Wenlin Yao, Hongming Zhang, Jianshu Chen, and Dong Yu. 2023.

</span>
<span class="ltx_bibblock">A stitch in time saves nine: Detecting and mitigating hallucinations of llms by validating low-confidence generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2307.03987</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan&nbsp;N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vig et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jesse Vig, Sebastian Gehrmann, Yonatan Belinkov, Sharon Qian, Daniel Nevo, Yaron Singer, and Stuart Shieber. 2020.

</span>
<span class="ltx_bibblock">Investigating gender bias in language models using causal mediation analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Advances in neural information processing systems</em>, 33:12388–12401.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wallat et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jonas Wallat, Jaspreet Singh, and Avishek Anand. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2020.blackboxnlp-1.17" title="">BERTnesia: Investigating the capture and forgetting of knowledge in BERT</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of the Third BlackboxNLP Workshop on Analyzing and Interpreting Neural Networks for NLP</em>, pages 174–183, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Komatsuzaki (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ben Wang and Aran Komatsuzaki. 2021.

</span>
<span class="ltx_bibblock">GPT-J-6B: A 6 Billion Parameter Autoregressive Language Model.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/kingoflolz/mesh-transformer-jax" title="">https://github.com/kingoflolz/mesh-transformer-jax</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kevin&nbsp;Ro Wang, Alexandre Variengien, Arthur Conmy, Buck Shlegeris, and Jacob Steinhardt. 2022.

</span>
<span class="ltx_bibblock">Interpretability in the wild: a circuit for indirect object identification in gpt-2 small.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">The Eleventh International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao and Wang (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yijun Xiao and William&nbsp;Yang Wang. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2021.eacl-main.236" title="">On hallucination and predictive uncertainty in conditional language generation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Proceedings of the 16th Conference of the European Chapter of the Association for Computational Linguistics: Main Volume</em>, pages 2734–2744, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qinan Yu, Jack Merullo, and Ellie Pavlick. 2023.

</span>
<span class="ltx_bibblock">Characterizing mechanisms for factual recall in language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:2310.15910</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuksekgonul et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mert Yuksekgonul, Varun Chandrasekaran, Erik Jones, Suriya Gunasekar, Ranjita Naik, Hamid Palangi, Ece Kamar, and Besmira Nushi. 2023.

</span>
<span class="ltx_bibblock">Attention satisfies: A constraint-satisfaction lens on factual errors of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:2309.15098</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Muru Zhang, Ofir Press, William Merrill, Alisa Liu, and Noah&nbsp;A Smith. 2023a.

</span>
<span class="ltx_bibblock">How language model hallucinations can snowball.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">arXiv preprint arXiv:2305.13534</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yue Zhang, Yafu Li, Leyang Cui, Deng Cai, Lemao Liu, Tingchen Fu, Xinting Huang, Enbo Zhao, Yu&nbsp;Zhang, Yulong Chen, et&nbsp;al. 2023b.

</span>
<span class="ltx_bibblock">Siren’s song in the ai ocean: A survey on hallucination in large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">arXiv preprint arXiv:2309.01219</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chunting Zhou, Pengfei Liu, Puxin Xu, Srini Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, Lili Yu, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Lima: Less is more for alignment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">arXiv preprint arXiv:2305.11206</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chunting Zhou, Graham Neubig, Jiatao Gu, Mona Diab, Francisco Guzmán, Luke Zettlemoyer, and Marjan Ghazvininejad. 2021.

</span>
<span class="ltx_bibblock">Detecting hallucinated content in conditional neural sequence generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">Findings of the Association for Computational Linguistics: ACL-IJCNLP 2021</em>, pages 1393–1404.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Dataset of Non-Factual Hallucinations</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">We follow the data construction pipeline in <cite class="ltx_cite ltx_citemacro_cite">Dai et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib7" title="">2022</a>)</cite> to generate each of our query input sequence from an entry in ParaRel <cite class="ltx_cite ltx_citemacro_cite">Elazar et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib12" title="">2021</a>)</cite> containing a subject-relation-object knowledge tuple (e.g. (<span class="ltx_text ltx_font_italic" id="A1.p1.1.1">Toulouse</span>, <span class="ltx_text ltx_font_italic" id="A1.p1.1.2">is twin city of</span>, <span class="ltx_text ltx_font_italic" id="A1.p1.1.3">Atlanta</span>)) which exist as entities in WikiData. Each relation has a set of prompt templates (e.g., “__ is the twin city of __”) where entities can be substituted to form full prompts (e.g., “Toulouse is the twin city of __” as a prompt that queries the object).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.6">After generating the query dataset, we ask a language model to predict the most likely capitalized alphanumeric token <math alttext="\hat{t}" class="ltx_Math" display="inline" id="A1.p2.1.m1.1"><semantics id="A1.p2.1.m1.1a"><mover accent="true" id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml"><mi id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml">t</mi><mo id="A1.p2.1.m1.1.1.1" xref="A1.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1"><ci id="A1.p2.1.m1.1.1.1.cmml" xref="A1.p2.1.m1.1.1.1">^</ci><ci id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\hat{t}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.m1.1d">over^ start_ARG italic_t end_ARG</annotation></semantics></math> to continue a given prompt <math alttext="u" class="ltx_Math" display="inline" id="A1.p2.2.m2.1"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.m2.1d">italic_u</annotation></semantics></math> that contains a subject-relation pair. We define a prediction <math alttext="\hat{t}" class="ltx_Math" display="inline" id="A1.p2.3.m3.1"><semantics id="A1.p2.3.m3.1a"><mover accent="true" id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mi id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">t</mi><mo id="A1.p2.3.m3.1.1.1" xref="A1.p2.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><ci id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1.1">^</ci><ci id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">\hat{t}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.3.m3.1d">over^ start_ARG italic_t end_ARG</annotation></semantics></math> to be <span class="ltx_text ltx_font_bold" id="A1.p2.6.1">factual</span> if it satisfies at least one of the following two conditions: 1) it is identical to or is a prefix of the ground-truth object <math alttext="o" class="ltx_Math" display="inline" id="A1.p2.4.m4.1"><semantics id="A1.p2.4.m4.1a"><mi id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><ci id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">o</annotation><annotation encoding="application/x-llamapun" id="A1.p2.4.m4.1d">italic_o</annotation></semantics></math>; 2) it is identical to or is a prefix of one of the entities returned by executing a WikiData SPARQL <span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>https://query.wikidata.org/</span></span></span> query with <math alttext="(s,r)" class="ltx_Math" display="inline" id="A1.p2.5.m5.2"><semantics id="A1.p2.5.m5.2a"><mrow id="A1.p2.5.m5.2.3.2" xref="A1.p2.5.m5.2.3.1.cmml"><mo id="A1.p2.5.m5.2.3.2.1" stretchy="false" xref="A1.p2.5.m5.2.3.1.cmml">(</mo><mi id="A1.p2.5.m5.1.1" xref="A1.p2.5.m5.1.1.cmml">s</mi><mo id="A1.p2.5.m5.2.3.2.2" xref="A1.p2.5.m5.2.3.1.cmml">,</mo><mi id="A1.p2.5.m5.2.2" xref="A1.p2.5.m5.2.2.cmml">r</mi><mo id="A1.p2.5.m5.2.3.2.3" stretchy="false" xref="A1.p2.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.5.m5.2b"><interval closure="open" id="A1.p2.5.m5.2.3.1.cmml" xref="A1.p2.5.m5.2.3.2"><ci id="A1.p2.5.m5.1.1.cmml" xref="A1.p2.5.m5.1.1">𝑠</ci><ci id="A1.p2.5.m5.2.2.cmml" xref="A1.p2.5.m5.2.2">𝑟</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.m5.2c">(s,r)</annotation><annotation encoding="application/x-llamapun" id="A1.p2.5.m5.2d">( italic_s , italic_r )</annotation></semantics></math> as inputs. In this way, we are able to address the response ambiguity issue for queries that allow multiple correct completions (e.g., “Marugame, located in, __” could be completed as either “Kagawa” or “Japan”, both outputs are factually correct). Finally, for each model, we discard those queries with no capitalized alphanumeric tokens among model predicted top-50 most likely tokens over the entire vocabulary, as we found in most of these cases the log likelihood of <math alttext="\hat{t}" class="ltx_Math" display="inline" id="A1.p2.6.m6.1"><semantics id="A1.p2.6.m6.1a"><mover accent="true" id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml"><mi id="A1.p2.6.m6.1.1.2" xref="A1.p2.6.m6.1.1.2.cmml">t</mi><mo id="A1.p2.6.m6.1.1.1" xref="A1.p2.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><apply id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1"><ci id="A1.p2.6.m6.1.1.1.cmml" xref="A1.p2.6.m6.1.1.1">^</ci><ci id="A1.p2.6.m6.1.1.2.cmml" xref="A1.p2.6.m6.1.1.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">\hat{t}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.6.m6.1d">over^ start_ARG italic_t end_ARG</annotation></semantics></math> would become negligible. This data preprocessing pipeline yields a set of 6,097 queries for Llama-2-7b-chat, 6,809 for GPT-J, 6,401 for GPT-2-XL, and 8,345 for Pythia-1.4B.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Causal Tracing of Hallucinations</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Experiment details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.5">In the corrupted run, we follow <cite class="ltx_cite ltx_citemacro_cite">Meng et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite> and corrupt the embeddings of the first token of each subject by adding Gaussian noise <math alttext="\epsilon\sim\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.2"><semantics id="A2.SS1.p1.1.m1.2a"><mrow id="A2.SS1.p1.1.m1.2.3" xref="A2.SS1.p1.1.m1.2.3.cmml"><mi id="A2.SS1.p1.1.m1.2.3.2" xref="A2.SS1.p1.1.m1.2.3.2.cmml">ϵ</mi><mo id="A2.SS1.p1.1.m1.2.3.1" xref="A2.SS1.p1.1.m1.2.3.1.cmml">∼</mo><mrow id="A2.SS1.p1.1.m1.2.3.3" xref="A2.SS1.p1.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.1.m1.2.3.3.2" xref="A2.SS1.p1.1.m1.2.3.3.2.cmml">𝒩</mi><mo id="A2.SS1.p1.1.m1.2.3.3.1" xref="A2.SS1.p1.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.1.m1.2.3.3.3.2" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml"><mo id="A2.SS1.p1.1.m1.2.3.3.3.2.1" stretchy="false" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml">(</mo><mn id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">0</mn><mo id="A2.SS1.p1.1.m1.2.3.3.3.2.2" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml">,</mo><mn id="A2.SS1.p1.1.m1.2.2" xref="A2.SS1.p1.1.m1.2.2.cmml">1</mn><mo id="A2.SS1.p1.1.m1.2.3.3.3.2.3" stretchy="false" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.2b"><apply id="A2.SS1.p1.1.m1.2.3.cmml" xref="A2.SS1.p1.1.m1.2.3"><csymbol cd="latexml" id="A2.SS1.p1.1.m1.2.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.1">similar-to</csymbol><ci id="A2.SS1.p1.1.m1.2.3.2.cmml" xref="A2.SS1.p1.1.m1.2.3.2">italic-ϵ</ci><apply id="A2.SS1.p1.1.m1.2.3.3.cmml" xref="A2.SS1.p1.1.m1.2.3.3"><times id="A2.SS1.p1.1.m1.2.3.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.3.1"></times><ci id="A2.SS1.p1.1.m1.2.3.3.2.cmml" xref="A2.SS1.p1.1.m1.2.3.3.2">𝒩</ci><interval closure="open" id="A2.SS1.p1.1.m1.2.3.3.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.3.3.2"><cn id="A2.SS1.p1.1.m1.1.1.cmml" type="integer" xref="A2.SS1.p1.1.m1.1.1">0</cn><cn id="A2.SS1.p1.1.m1.2.2.cmml" type="integer" xref="A2.SS1.p1.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.2c">\epsilon\sim\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.2d">italic_ϵ ∼ caligraphic_N ( 0 , 1 )</annotation></semantics></math>. In <cite class="ltx_cite ltx_citemacro_cite">Meng et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite>, the authors perform embedding corruption by adding a Gaussian noise with a standard deviation <math alttext="\sigma\approx 0.15" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><mrow id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mi id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">σ</mi><mo id="A2.SS1.p1.2.m2.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.cmml">≈</mo><mn id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml">0.15</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><approx id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1"></approx><ci id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2">𝜎</ci><cn id="A2.SS1.p1.2.m2.1.1.3.cmml" type="float" xref="A2.SS1.p1.2.m2.1.1.3">0.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">\sigma\approx 0.15</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">italic_σ ≈ 0.15</annotation></semantics></math>, which is three times of the estimated the observed standard deviation of token embeddings as sampled over a body of text. However, we found this standard deviation often to be too small to significantly change the relative log likelihood of a pair of true and incorrect object, so we set <math alttext="\sigma=1" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.1"><semantics id="A2.SS1.p1.3.m3.1a"><mrow id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml"><mi id="A2.SS1.p1.3.m3.1.1.2" xref="A2.SS1.p1.3.m3.1.1.2.cmml">σ</mi><mo id="A2.SS1.p1.3.m3.1.1.1" xref="A2.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS1.p1.3.m3.1.1.3" xref="A2.SS1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><apply id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1"><eq id="A2.SS1.p1.3.m3.1.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1.1"></eq><ci id="A2.SS1.p1.3.m3.1.1.2.cmml" xref="A2.SS1.p1.3.m3.1.1.2">𝜎</ci><cn id="A2.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="A2.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">\sigma=1</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.1d">italic_σ = 1</annotation></semantics></math> instead. For each run of text, the process is repeated multiple times with different samples of corruption noise, until we get a set of 10 independently sampled noises that can reduce the relative log likelihood <math alttext="y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}" class="ltx_Math" display="inline" id="A2.SS1.p1.4.m4.4"><semantics id="A2.SS1.p1.4.m4.4a"><mrow id="A2.SS1.p1.4.m4.4.5" xref="A2.SS1.p1.4.m4.4.5.cmml"><mi id="A2.SS1.p1.4.m4.4.5.2" xref="A2.SS1.p1.4.m4.4.5.2.cmml">y</mi><mo id="A2.SS1.p1.4.m4.4.5.1" xref="A2.SS1.p1.4.m4.4.5.1.cmml">=</mo><mrow id="A2.SS1.p1.4.m4.4.5.3" xref="A2.SS1.p1.4.m4.4.5.3.cmml"><mi id="A2.SS1.p1.4.m4.4.5.3.1" xref="A2.SS1.p1.4.m4.4.5.3.1.cmml">log</mi><mo id="A2.SS1.p1.4.m4.4.5.3a" lspace="0.167em" xref="A2.SS1.p1.4.m4.4.5.3.cmml">⁡</mo><mfrac id="A2.SS1.p1.4.m4.4.4" xref="A2.SS1.p1.4.m4.4.4.cmml"><mrow id="A2.SS1.p1.4.m4.2.2.2" xref="A2.SS1.p1.4.m4.2.2.2.cmml"><mi id="A2.SS1.p1.4.m4.2.2.2.4" xref="A2.SS1.p1.4.m4.2.2.2.4.cmml">p</mi><mo id="A2.SS1.p1.4.m4.2.2.2.3" xref="A2.SS1.p1.4.m4.2.2.2.3.cmml">⁢</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml"><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.2" stretchy="false" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml"><msup id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2.cmml">o</mi><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.1.cmml">|</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mi id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2.cmml">E</mi><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.3.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.3.2.1" stretchy="false" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml">(</mo><mi id="A2.SS1.p1.4.m4.1.1.1.1" xref="A2.SS1.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.3.2.2" stretchy="false" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.3" stretchy="false" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.SS1.p1.4.m4.4.4.4" xref="A2.SS1.p1.4.m4.4.4.4.cmml"><mi id="A2.SS1.p1.4.m4.4.4.4.4" xref="A2.SS1.p1.4.m4.4.4.4.4.cmml">p</mi><mo id="A2.SS1.p1.4.m4.4.4.4.3" xref="A2.SS1.p1.4.m4.4.4.4.3.cmml">⁢</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml"><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.2" stretchy="false" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml">(</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml"><mi id="A2.SS1.p1.4.m4.4.4.4.2.1.1.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.2.cmml">o</mi><mo fence="false" id="A2.SS1.p1.4.m4.4.4.4.2.1.1.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.1.cmml">|</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mi id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2.cmml">E</mi><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.3.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.3.2.1" stretchy="false" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml">(</mo><mi id="A2.SS1.p1.4.m4.3.3.3.1" xref="A2.SS1.p1.4.m4.3.3.3.1.cmml">u</mi><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.3.2.2" stretchy="false" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.3" stretchy="false" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.4b"><apply id="A2.SS1.p1.4.m4.4.5.cmml" xref="A2.SS1.p1.4.m4.4.5"><eq id="A2.SS1.p1.4.m4.4.5.1.cmml" xref="A2.SS1.p1.4.m4.4.5.1"></eq><ci id="A2.SS1.p1.4.m4.4.5.2.cmml" xref="A2.SS1.p1.4.m4.4.5.2">𝑦</ci><apply id="A2.SS1.p1.4.m4.4.5.3.cmml" xref="A2.SS1.p1.4.m4.4.5.3"><log id="A2.SS1.p1.4.m4.4.5.3.1.cmml" xref="A2.SS1.p1.4.m4.4.5.3.1"></log><apply id="A2.SS1.p1.4.m4.4.4.cmml" xref="A2.SS1.p1.4.m4.4.4"><divide id="A2.SS1.p1.4.m4.4.4.5.cmml" xref="A2.SS1.p1.4.m4.4.4"></divide><apply id="A2.SS1.p1.4.m4.2.2.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2"><times id="A2.SS1.p1.4.m4.2.2.2.3.cmml" xref="A2.SS1.p1.4.m4.2.2.2.3"></times><ci id="A2.SS1.p1.4.m4.2.2.2.4.cmml" xref="A2.SS1.p1.4.m4.2.2.2.4">𝑝</ci><apply id="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.1">conditional</csymbol><apply id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2">superscript</csymbol><ci id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2">𝑜</ci><ci id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3">′</ci></apply><apply id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3"><times id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1"></times><ci id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2">𝐸</ci><ci id="A2.SS1.p1.4.m4.1.1.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="A2.SS1.p1.4.m4.4.4.4.cmml" xref="A2.SS1.p1.4.m4.4.4.4"><times id="A2.SS1.p1.4.m4.4.4.4.3.cmml" xref="A2.SS1.p1.4.m4.4.4.4.3"></times><ci id="A2.SS1.p1.4.m4.4.4.4.4.cmml" xref="A2.SS1.p1.4.m4.4.4.4.4">𝑝</ci><apply id="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1"><csymbol cd="latexml" id="A2.SS1.p1.4.m4.4.4.4.2.1.1.1.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.1">conditional</csymbol><ci id="A2.SS1.p1.4.m4.4.4.4.2.1.1.2.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.2">𝑜</ci><apply id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3"><times id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1"></times><ci id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2">𝐸</ci><ci id="A2.SS1.p1.4.m4.3.3.3.1.cmml" xref="A2.SS1.p1.4.m4.3.3.3.1">𝑢</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.4c">y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.4.m4.4d">italic_y = roman_log divide start_ARG italic_p ( italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_E ( italic_u ) ) end_ARG start_ARG italic_p ( italic_o | italic_E ( italic_u ) ) end_ARG</annotation></semantics></math>. We found that on average, about 71.1% of the sampled noises reduces <math alttext="y" class="ltx_Math" display="inline" id="A2.SS1.p1.5.m5.1"><semantics id="A2.SS1.p1.5.m5.1a"><mi id="A2.SS1.p1.5.m5.1.1" xref="A2.SS1.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.5.m5.1b"><ci id="A2.SS1.p1.5.m5.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.5.m5.1c">y</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.5.m5.1d">italic_y</annotation></semantics></math> (i.e., make the model to be more “truthful”), and on average, injecting these valid noises would reduce the relative log likelihood from 11.7 to 2.3.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A2.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A2.T3.1" style="width:433.6pt;height:96.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-67.1pt,14.9pt) scale(0.763637983767333,0.763637983767333) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T3.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T3.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T3.1.1.1.1.1">prompt</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.2">subject</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.3">relation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.4">true object</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.5">predicted object</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.6">hallucination mechanism</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T3.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T3.1.1.2.1.1">Korrespodent is formed in</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.2">Korrespodent</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.3">country of origin</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.4">Ukraine</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.5">April</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.6">early-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.1.3.2.1">Mantecadas, that was created in</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.2">Mantacedas</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.3">country of origin</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.4">Spain</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.5">Japan</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.6">early-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.1.4.3.1">Asprey’s headquarters are in</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.2">Asprey</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.3">headquarters location</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.4">London</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.5">New</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.6">early-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.1.5.4.1">Opgezwolle was developed in</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.2">Opgezwolle</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.3">country of origin</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.4">Netherlands</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.5">Belgium</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.6">late-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.1.6.5.1">Israel maintains diplomatic relations with</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.2">Israel</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.3">diplomatic relation</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.4">India</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.5">Israel</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.6">late-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T3.1.1.7.6.1">Germany shares its border with</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.2">Germany</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.3">shares border with</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.4">Luxemburg</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.5">Russia</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.6">late-site</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Examples of early-site and late-site hallucinations made by GPT-2-XL.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Causal tracing results on GPTs</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F6" title="Figure 6 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F9" title="Figure 9 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">9</span></a> show the causal AIE distributions for GPT-2-XL and GPT-J on their hallucinating answers on Pararel, respectively. We observe that similar to the case of Llama-2-7b, most causally contributive hidden representations are produced by model components of subject tokens on early-site layers and relation tokens on late-site layers. Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F7" title="Figure 7 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">7</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F10" title="Figure 10 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">10</span></a> further shows the breakdown AIE distributions for early-site and late-site hallucinations by two GPT models, using the same categorization metric of relative IE as for Llama-2-7b. Again, we found that early-site hallucinations are mostly caused by MLP modules in lower layers when enriching the subject tokens, while late-site hallucinations can be largely attributed to failures by upper layer attentions and MLPs when processing the relation tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Examples of early-site and late-site hallucinations</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.T3" title="Table 3 ‣ B.1 Experiment details ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> presents several examples randomly drawn from the sets of early-site and late-site hallucinations made by GPT-2-XL. We found that in many examples of late-site hallucinations, the model tends to ignore the relational information in inputs and output an object entity that is highly associated with the subject – in some cases, the model even predicts the subject itself as a continuation. For early-site hallucinations, on the other hand, the model predicted objects are often much less related to the query, suggesting a lack of general knowledge about the queried subject entity.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Embedding space projection results on GPTs</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS4.p1">
<p class="ltx_p" id="A2.SS4.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F8" title="Figure 8 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">8</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F11" title="Figure 11 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">11</span></a> show the embedding space projection results for factually correct answers, early-site hallucinations and late-site hallucinations made by GPT-2-XL and GPT-J. Again, we observe that the layerwise MLP contribution profile to true answer is very similar for late-site hallucinations and factual predictions, suggesting that for some cases of factual errors, early-site MLPs are still functioning properly. In contrast, the contribution profile of attention components for factual answers differs significantly from hallucinating answers, indicating that for both types of hallucinations, the upper layer attention heads fail to select the object entities that are most relevant to the query subject.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A2.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="140" id="A2.F6.g1" src="x7.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="A2.F6.2.1">Average Indirect Effect (AIE)</span> of individual model components to non-factual hallucinations over ParaRel queries that are incorrectly answered by GPT-2-XL.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="A2.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="860" id="A2.F6.sf1.g1" src="x8.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Early-site hallucinations (<math alttext="\Delta\text{AIE}(y,u)<0" class="ltx_Math" display="inline" id="A2.F6.sf1.2.m1.2"><semantics id="A2.F6.sf1.2.m1.2b"><mrow id="A2.F6.sf1.2.m1.2.3" xref="A2.F6.sf1.2.m1.2.3.cmml"><mrow id="A2.F6.sf1.2.m1.2.3.2" xref="A2.F6.sf1.2.m1.2.3.2.cmml"><mi id="A2.F6.sf1.2.m1.2.3.2.2" mathvariant="normal" xref="A2.F6.sf1.2.m1.2.3.2.2.cmml">Δ</mi><mo id="A2.F6.sf1.2.m1.2.3.2.1" xref="A2.F6.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mtext id="A2.F6.sf1.2.m1.2.3.2.3" xref="A2.F6.sf1.2.m1.2.3.2.3a.cmml">AIE</mtext><mo id="A2.F6.sf1.2.m1.2.3.2.1b" xref="A2.F6.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="A2.F6.sf1.2.m1.2.3.2.4.2" xref="A2.F6.sf1.2.m1.2.3.2.4.1.cmml"><mo id="A2.F6.sf1.2.m1.2.3.2.4.2.1" stretchy="false" xref="A2.F6.sf1.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F6.sf1.2.m1.1.1" xref="A2.F6.sf1.2.m1.1.1.cmml">y</mi><mo id="A2.F6.sf1.2.m1.2.3.2.4.2.2" xref="A2.F6.sf1.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F6.sf1.2.m1.2.2" xref="A2.F6.sf1.2.m1.2.2.cmml">u</mi><mo id="A2.F6.sf1.2.m1.2.3.2.4.2.3" stretchy="false" xref="A2.F6.sf1.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F6.sf1.2.m1.2.3.1" xref="A2.F6.sf1.2.m1.2.3.1.cmml">&lt;</mo><mn id="A2.F6.sf1.2.m1.2.3.3" xref="A2.F6.sf1.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.sf1.2.m1.2c"><apply id="A2.F6.sf1.2.m1.2.3.cmml" xref="A2.F6.sf1.2.m1.2.3"><lt id="A2.F6.sf1.2.m1.2.3.1.cmml" xref="A2.F6.sf1.2.m1.2.3.1"></lt><apply id="A2.F6.sf1.2.m1.2.3.2.cmml" xref="A2.F6.sf1.2.m1.2.3.2"><times id="A2.F6.sf1.2.m1.2.3.2.1.cmml" xref="A2.F6.sf1.2.m1.2.3.2.1"></times><ci id="A2.F6.sf1.2.m1.2.3.2.2.cmml" xref="A2.F6.sf1.2.m1.2.3.2.2">Δ</ci><ci id="A2.F6.sf1.2.m1.2.3.2.3a.cmml" xref="A2.F6.sf1.2.m1.2.3.2.3"><mtext id="A2.F6.sf1.2.m1.2.3.2.3.cmml" xref="A2.F6.sf1.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F6.sf1.2.m1.2.3.2.4.1.cmml" xref="A2.F6.sf1.2.m1.2.3.2.4.2"><ci id="A2.F6.sf1.2.m1.1.1.cmml" xref="A2.F6.sf1.2.m1.1.1">𝑦</ci><ci id="A2.F6.sf1.2.m1.2.2.cmml" xref="A2.F6.sf1.2.m1.2.2">𝑢</ci></interval></apply><cn id="A2.F6.sf1.2.m1.2.3.3.cmml" type="integer" xref="A2.F6.sf1.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.sf1.2.m1.2d">\Delta\text{AIE}(y,u)&lt;0</annotation><annotation encoding="application/x-llamapun" id="A2.F6.sf1.2.m1.2e">roman_Δ AIE ( italic_y , italic_u ) &lt; 0</annotation></semantics></math>).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="A2.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="860" id="A2.F6.sf2.g1" src="x9.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Late-site hallucinations (<math alttext="\Delta\text{AIE}(y,u)\geq 0" class="ltx_Math" display="inline" id="A2.F6.sf2.2.m1.2"><semantics id="A2.F6.sf2.2.m1.2b"><mrow id="A2.F6.sf2.2.m1.2.3" xref="A2.F6.sf2.2.m1.2.3.cmml"><mrow id="A2.F6.sf2.2.m1.2.3.2" xref="A2.F6.sf2.2.m1.2.3.2.cmml"><mi id="A2.F6.sf2.2.m1.2.3.2.2" mathvariant="normal" xref="A2.F6.sf2.2.m1.2.3.2.2.cmml">Δ</mi><mo id="A2.F6.sf2.2.m1.2.3.2.1" xref="A2.F6.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mtext id="A2.F6.sf2.2.m1.2.3.2.3" xref="A2.F6.sf2.2.m1.2.3.2.3a.cmml">AIE</mtext><mo id="A2.F6.sf2.2.m1.2.3.2.1b" xref="A2.F6.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="A2.F6.sf2.2.m1.2.3.2.4.2" xref="A2.F6.sf2.2.m1.2.3.2.4.1.cmml"><mo id="A2.F6.sf2.2.m1.2.3.2.4.2.1" stretchy="false" xref="A2.F6.sf2.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F6.sf2.2.m1.1.1" xref="A2.F6.sf2.2.m1.1.1.cmml">y</mi><mo id="A2.F6.sf2.2.m1.2.3.2.4.2.2" xref="A2.F6.sf2.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F6.sf2.2.m1.2.2" xref="A2.F6.sf2.2.m1.2.2.cmml">u</mi><mo id="A2.F6.sf2.2.m1.2.3.2.4.2.3" stretchy="false" xref="A2.F6.sf2.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F6.sf2.2.m1.2.3.1" xref="A2.F6.sf2.2.m1.2.3.1.cmml">≥</mo><mn id="A2.F6.sf2.2.m1.2.3.3" xref="A2.F6.sf2.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.sf2.2.m1.2c"><apply id="A2.F6.sf2.2.m1.2.3.cmml" xref="A2.F6.sf2.2.m1.2.3"><geq id="A2.F6.sf2.2.m1.2.3.1.cmml" xref="A2.F6.sf2.2.m1.2.3.1"></geq><apply id="A2.F6.sf2.2.m1.2.3.2.cmml" xref="A2.F6.sf2.2.m1.2.3.2"><times id="A2.F6.sf2.2.m1.2.3.2.1.cmml" xref="A2.F6.sf2.2.m1.2.3.2.1"></times><ci id="A2.F6.sf2.2.m1.2.3.2.2.cmml" xref="A2.F6.sf2.2.m1.2.3.2.2">Δ</ci><ci id="A2.F6.sf2.2.m1.2.3.2.3a.cmml" xref="A2.F6.sf2.2.m1.2.3.2.3"><mtext id="A2.F6.sf2.2.m1.2.3.2.3.cmml" xref="A2.F6.sf2.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F6.sf2.2.m1.2.3.2.4.1.cmml" xref="A2.F6.sf2.2.m1.2.3.2.4.2"><ci id="A2.F6.sf2.2.m1.1.1.cmml" xref="A2.F6.sf2.2.m1.1.1">𝑦</ci><ci id="A2.F6.sf2.2.m1.2.2.cmml" xref="A2.F6.sf2.2.m1.2.2">𝑢</ci></interval></apply><cn id="A2.F6.sf2.2.m1.2.3.3.cmml" type="integer" xref="A2.F6.sf2.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.sf2.2.m1.2d">\Delta\text{AIE}(y,u)\geq 0</annotation><annotation encoding="application/x-llamapun" id="A2.F6.sf2.2.m1.2e">roman_Δ AIE ( italic_y , italic_u ) ≥ 0</annotation></semantics></math>).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="A2.F7.2.1">Average Indirect Effect (AIE)</span> of individual model components of GPT-2-XL for (a) early-site (left column) and (b) late-site (right column) non-factual hallucinations. </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="893" id="A2.F8.g1" src="x10.png" width="788">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Average dot product between true object embedding and GPT-2-XL intermediate outputs in each layer.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="156" id="A2.F9.g1" src="x11.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span class="ltx_text ltx_font_bold" id="A2.F9.4.1">Average Indirect Effect (AIE)</span> of individual model components to non-factual hallucinations over 6,809 ParaRel queries that are incorrectly answered by GPT-J. <math alttext="\Delta\text{AIE}(y,u)" class="ltx_Math" display="inline" id="A2.F9.2.m1.2"><semantics id="A2.F9.2.m1.2b"><mrow id="A2.F9.2.m1.2.3" xref="A2.F9.2.m1.2.3.cmml"><mi id="A2.F9.2.m1.2.3.2" mathvariant="normal" xref="A2.F9.2.m1.2.3.2.cmml">Δ</mi><mo id="A2.F9.2.m1.2.3.1" xref="A2.F9.2.m1.2.3.1.cmml">⁢</mo><mtext id="A2.F9.2.m1.2.3.3" xref="A2.F9.2.m1.2.3.3a.cmml">AIE</mtext><mo id="A2.F9.2.m1.2.3.1b" xref="A2.F9.2.m1.2.3.1.cmml">⁢</mo><mrow id="A2.F9.2.m1.2.3.4.2" xref="A2.F9.2.m1.2.3.4.1.cmml"><mo id="A2.F9.2.m1.2.3.4.2.1" stretchy="false" xref="A2.F9.2.m1.2.3.4.1.cmml">(</mo><mi id="A2.F9.2.m1.1.1" xref="A2.F9.2.m1.1.1.cmml">y</mi><mo id="A2.F9.2.m1.2.3.4.2.2" xref="A2.F9.2.m1.2.3.4.1.cmml">,</mo><mi id="A2.F9.2.m1.2.2" xref="A2.F9.2.m1.2.2.cmml">u</mi><mo id="A2.F9.2.m1.2.3.4.2.3" stretchy="false" xref="A2.F9.2.m1.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F9.2.m1.2c"><apply id="A2.F9.2.m1.2.3.cmml" xref="A2.F9.2.m1.2.3"><times id="A2.F9.2.m1.2.3.1.cmml" xref="A2.F9.2.m1.2.3.1"></times><ci id="A2.F9.2.m1.2.3.2.cmml" xref="A2.F9.2.m1.2.3.2">Δ</ci><ci id="A2.F9.2.m1.2.3.3a.cmml" xref="A2.F9.2.m1.2.3.3"><mtext id="A2.F9.2.m1.2.3.3.cmml" xref="A2.F9.2.m1.2.3.3">AIE</mtext></ci><interval closure="open" id="A2.F9.2.m1.2.3.4.1.cmml" xref="A2.F9.2.m1.2.3.4.2"><ci id="A2.F9.2.m1.1.1.cmml" xref="A2.F9.2.m1.1.1">𝑦</ci><ci id="A2.F9.2.m1.2.2.cmml" xref="A2.F9.2.m1.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.2.m1.2d">\Delta\text{AIE}(y,u)</annotation><annotation encoding="application/x-llamapun" id="A2.F9.2.m1.2e">roman_Δ AIE ( italic_y , italic_u )</annotation></semantics></math> is defined as the difference in AIE between 1) the attention outputs of the last 14 out of 28 transformer layers and 2) the MLP outputs of the first 14 out of 28 transformer layers of GPT-J.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="A2.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="851" id="A2.F9.sf1.g1" src="x12.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Early-site hallucinations (<math alttext="\Delta\text{AIE}(y,u)<0" class="ltx_Math" display="inline" id="A2.F9.sf1.2.m1.2"><semantics id="A2.F9.sf1.2.m1.2b"><mrow id="A2.F9.sf1.2.m1.2.3" xref="A2.F9.sf1.2.m1.2.3.cmml"><mrow id="A2.F9.sf1.2.m1.2.3.2" xref="A2.F9.sf1.2.m1.2.3.2.cmml"><mi id="A2.F9.sf1.2.m1.2.3.2.2" mathvariant="normal" xref="A2.F9.sf1.2.m1.2.3.2.2.cmml">Δ</mi><mo id="A2.F9.sf1.2.m1.2.3.2.1" xref="A2.F9.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mtext id="A2.F9.sf1.2.m1.2.3.2.3" xref="A2.F9.sf1.2.m1.2.3.2.3a.cmml">AIE</mtext><mo id="A2.F9.sf1.2.m1.2.3.2.1b" xref="A2.F9.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="A2.F9.sf1.2.m1.2.3.2.4.2" xref="A2.F9.sf1.2.m1.2.3.2.4.1.cmml"><mo id="A2.F9.sf1.2.m1.2.3.2.4.2.1" stretchy="false" xref="A2.F9.sf1.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F9.sf1.2.m1.1.1" xref="A2.F9.sf1.2.m1.1.1.cmml">y</mi><mo id="A2.F9.sf1.2.m1.2.3.2.4.2.2" xref="A2.F9.sf1.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F9.sf1.2.m1.2.2" xref="A2.F9.sf1.2.m1.2.2.cmml">u</mi><mo id="A2.F9.sf1.2.m1.2.3.2.4.2.3" stretchy="false" xref="A2.F9.sf1.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F9.sf1.2.m1.2.3.1" xref="A2.F9.sf1.2.m1.2.3.1.cmml">&lt;</mo><mn id="A2.F9.sf1.2.m1.2.3.3" xref="A2.F9.sf1.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F9.sf1.2.m1.2c"><apply id="A2.F9.sf1.2.m1.2.3.cmml" xref="A2.F9.sf1.2.m1.2.3"><lt id="A2.F9.sf1.2.m1.2.3.1.cmml" xref="A2.F9.sf1.2.m1.2.3.1"></lt><apply id="A2.F9.sf1.2.m1.2.3.2.cmml" xref="A2.F9.sf1.2.m1.2.3.2"><times id="A2.F9.sf1.2.m1.2.3.2.1.cmml" xref="A2.F9.sf1.2.m1.2.3.2.1"></times><ci id="A2.F9.sf1.2.m1.2.3.2.2.cmml" xref="A2.F9.sf1.2.m1.2.3.2.2">Δ</ci><ci id="A2.F9.sf1.2.m1.2.3.2.3a.cmml" xref="A2.F9.sf1.2.m1.2.3.2.3"><mtext id="A2.F9.sf1.2.m1.2.3.2.3.cmml" xref="A2.F9.sf1.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F9.sf1.2.m1.2.3.2.4.1.cmml" xref="A2.F9.sf1.2.m1.2.3.2.4.2"><ci id="A2.F9.sf1.2.m1.1.1.cmml" xref="A2.F9.sf1.2.m1.1.1">𝑦</ci><ci id="A2.F9.sf1.2.m1.2.2.cmml" xref="A2.F9.sf1.2.m1.2.2">𝑢</ci></interval></apply><cn id="A2.F9.sf1.2.m1.2.3.3.cmml" type="integer" xref="A2.F9.sf1.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.sf1.2.m1.2d">\Delta\text{AIE}(y,u)&lt;0</annotation><annotation encoding="application/x-llamapun" id="A2.F9.sf1.2.m1.2e">roman_Δ AIE ( italic_y , italic_u ) &lt; 0</annotation></semantics></math>)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="A2.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="877" id="A2.F9.sf2.g1" src="x13.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Late-site hallucinations (<math alttext="\Delta\text{AIE}(y,u)\geq 0" class="ltx_Math" display="inline" id="A2.F9.sf2.2.m1.2"><semantics id="A2.F9.sf2.2.m1.2b"><mrow id="A2.F9.sf2.2.m1.2.3" xref="A2.F9.sf2.2.m1.2.3.cmml"><mrow id="A2.F9.sf2.2.m1.2.3.2" xref="A2.F9.sf2.2.m1.2.3.2.cmml"><mi id="A2.F9.sf2.2.m1.2.3.2.2" mathvariant="normal" xref="A2.F9.sf2.2.m1.2.3.2.2.cmml">Δ</mi><mo id="A2.F9.sf2.2.m1.2.3.2.1" xref="A2.F9.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mtext id="A2.F9.sf2.2.m1.2.3.2.3" xref="A2.F9.sf2.2.m1.2.3.2.3a.cmml">AIE</mtext><mo id="A2.F9.sf2.2.m1.2.3.2.1b" xref="A2.F9.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="A2.F9.sf2.2.m1.2.3.2.4.2" xref="A2.F9.sf2.2.m1.2.3.2.4.1.cmml"><mo id="A2.F9.sf2.2.m1.2.3.2.4.2.1" stretchy="false" xref="A2.F9.sf2.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F9.sf2.2.m1.1.1" xref="A2.F9.sf2.2.m1.1.1.cmml">y</mi><mo id="A2.F9.sf2.2.m1.2.3.2.4.2.2" xref="A2.F9.sf2.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F9.sf2.2.m1.2.2" xref="A2.F9.sf2.2.m1.2.2.cmml">u</mi><mo id="A2.F9.sf2.2.m1.2.3.2.4.2.3" stretchy="false" xref="A2.F9.sf2.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F9.sf2.2.m1.2.3.1" xref="A2.F9.sf2.2.m1.2.3.1.cmml">≥</mo><mn id="A2.F9.sf2.2.m1.2.3.3" xref="A2.F9.sf2.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F9.sf2.2.m1.2c"><apply id="A2.F9.sf2.2.m1.2.3.cmml" xref="A2.F9.sf2.2.m1.2.3"><geq id="A2.F9.sf2.2.m1.2.3.1.cmml" xref="A2.F9.sf2.2.m1.2.3.1"></geq><apply id="A2.F9.sf2.2.m1.2.3.2.cmml" xref="A2.F9.sf2.2.m1.2.3.2"><times id="A2.F9.sf2.2.m1.2.3.2.1.cmml" xref="A2.F9.sf2.2.m1.2.3.2.1"></times><ci id="A2.F9.sf2.2.m1.2.3.2.2.cmml" xref="A2.F9.sf2.2.m1.2.3.2.2">Δ</ci><ci id="A2.F9.sf2.2.m1.2.3.2.3a.cmml" xref="A2.F9.sf2.2.m1.2.3.2.3"><mtext id="A2.F9.sf2.2.m1.2.3.2.3.cmml" xref="A2.F9.sf2.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F9.sf2.2.m1.2.3.2.4.1.cmml" xref="A2.F9.sf2.2.m1.2.3.2.4.2"><ci id="A2.F9.sf2.2.m1.1.1.cmml" xref="A2.F9.sf2.2.m1.1.1">𝑦</ci><ci id="A2.F9.sf2.2.m1.2.2.cmml" xref="A2.F9.sf2.2.m1.2.2">𝑢</ci></interval></apply><cn id="A2.F9.sf2.2.m1.2.3.3.cmml" type="integer" xref="A2.F9.sf2.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.sf2.2.m1.2d">\Delta\text{AIE}(y,u)\geq 0</annotation><annotation encoding="application/x-llamapun" id="A2.F9.sf2.2.m1.2e">roman_Δ AIE ( italic_y , italic_u ) ≥ 0</annotation></semantics></math>)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span class="ltx_text ltx_font_bold" id="A2.F10.2.1">Average Indirect Effect (AIE)</span> of individual model components of GPT-J for (a) early-site (left column) and (b) late-site (right column) non-factual hallucinations. </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="882" id="A2.F11.g1" src="x14.png" width="789">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Average dot product between true object embedding and GPT-J intermediate outputs in each layer.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Evaluation of Pythia Models</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">We evaluate Pythia-1.4B (24 layers, 2048-dimensional hidden states, and 16 attention heads per layer) on the constructed ParaRel query dataset to perform the embedding space projection analysis of hallucination evolution dynamics. Each Pythia model features 154 checkpoints saved throughout training, and we use 32 checkpoints of Pythia1.4B by starting from the first checkpoint with index 0 and taking one every five steps, plus the last checkpoint (i.e. checkpoint-0, checkpoint-5, checkpoint-10,…,checkpoint-150, checkpoint-153). To classify the mechanism of each hallucinating query, we run the three-step causal mediation analysis on checkpoint-153 of Pythia-1.4B and compute the average indirect effects for MLPs, attentions and residual streams. Same as GPT-2-XL experiments, we corrupt input queries by injecting standard Gaussian noises into the first subject token, and take for each query 10 independently sampled noise that reduce the relative object likelihood <math alttext="y" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">italic_y</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A3.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A3.T4.1" style="width:346.9pt;height:77.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-40.3pt,9.0pt) scale(0.81129616433058,0.81129616433058) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T4.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A3.T4.1.1.1.1.1">Question</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T4.1.1.1.1.2">True answers</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T4.1.1.1.1.3">False answer</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T4.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T4.1.1.2.1.1">who ordered the forbidden city to be built</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T4.1.1.2.1.2">Zhu Di</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T4.1.1.2.1.3">Emperor Qin Shi Huang</td>
</tr>
<tr class="ltx_tr" id="A3.T4.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T4.1.1.3.2.1">who has won the most games in nfl 2017</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T4.1.1.3.2.2">Dallas Cowboys</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T4.1.1.3.2.3">Tom Brady</td>
</tr>
<tr class="ltx_tr" id="A3.T4.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A3.T4.1.1.4.3.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T4.1.1.4.3.1.1">
<tbody><tr class="ltx_tr" id="A3.T4.1.1.4.3.1.1.1">
<td class="ltx_td ltx_align_left" id="A3.T4.1.1.4.3.1.1.1.1">who was the famous scientist that</td>
</tr>
<tr class="ltx_tr" id="A3.T4.1.1.4.3.1.1.2">
<td class="ltx_td ltx_align_left" id="A3.T4.1.1.4.3.1.1.2.1">ran the research lab moseley went to in manchester</td>
</tr>
</tbody></table>
</th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A3.T4.1.1.4.3.2">Sir Ernest Rutherford</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A3.T4.1.1.4.3.3">Albert Einstein</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Sample questions from the NaturalQA dataset.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A3.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A3.T5.1" style="width:433.6pt;height:168.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.5pt,29.0pt) scale(0.744233430442375,0.744233430442375) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T5.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T5.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T5.1.1.1.1.1">Question</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T5.1.1.1.1.2">True answers</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T5.1.1.1.1.3">False answers</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T5.1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T5.1.1.2.1.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.2.1.1.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.2.1.1.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.1.1.1.1">What happens to you</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.1.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.1.1.2.1">if you eat watermelon seeds?</td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T5.1.1.2.1.2">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.2.1.2.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.1.1">1) Nothing happens;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.2.1">2) You eat watermelon seeds;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.3">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.3.1">3) The watermelon seeds pass through your digestive system;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.4">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.4.1">4) You will not digest the watermelon seeds;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.5">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.5.1">5) The watermelon seeds will be excreted;</td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T5.1.1.2.1.3">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.2.1.3.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.1.1">1) You grow watermelons in your stomach;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.2.1">2) You get sick;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.3">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.3.1">3) You have bad dreams;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.4">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.4.1">4) You die;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.5">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.5.1">5) You get indigestion;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.6">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.6.1">6) You fall unconscious;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.7">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.7.1">7) You digest the watermelon seeds</td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T5.1.1.3.2.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.3.2.1.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.3.2.1.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.1.1.1.1">Who said, "Only the dead</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.1.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.1.1.2.1">have seen the end of war?"</td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T5.1.1.3.2.2">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.3.2.2.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.3.2.2.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.2.1.1.1">1) George Santayana wrote</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.2.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.2.1.2.1">"Only the dead have seen the end of war";</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.2.1.3">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.2.1.3.1">2) General Douglas MacArthur misattributed</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.2.1.4">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.2.1.4.1">the quote to Plato in a farewell speech</td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T5.1.1.3.2.3">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.3.2.3.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.3.2.3.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.3.1.1.1">1) Plato said, "Only the dead</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.3.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.3.1.2.1">have seen the end of war";</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.3.1.3">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.3.1.3.1">2) Douglas MacArthur first said,</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.3.1.4">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.3.1.4.1">"Only the dead have seen the end of war"</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Sample questions from the TruthfulQA dataset.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Hallucination Detection</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Example data from Natural Questions and TruthfulQA</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.1">See Table <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A3.T4" title="Table 4 ‣ Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A3.T5" title="Table 5 ‣ Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> show example entries from NaturalQA and TruthfulQA datasets respectively. Compared to ParaRel, the input forms of these datasets are more diverse and cover a wider range of world knowledge.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Details of causal attribution approximation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS2.p1">
<p class="ltx_p" id="A4.SS2.p1.9">To exactly compute neuron-level causal effects, one need to make thousands of forward model pass for each query by targeting one neuron at a time. We therefore apply the method of attribution patching introduced in <cite class="ltx_cite ltx_citemacro_cite">Nanda (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib35" title="">2023</a>)</cite> to approximately compute causal effects for all neurons through one forward and one backward pass. Formally, for an input prompt <math alttext="u" class="ltx_Math" display="inline" id="A4.SS2.p1.1.m1.1"><semantics id="A4.SS2.p1.1.m1.1a"><mi id="A4.SS2.p1.1.m1.1.1" xref="A4.SS2.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.1.m1.1b"><ci id="A4.SS2.p1.1.m1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.1.m1.1d">italic_u</annotation></semantics></math> and continuation sequence <math alttext="c" class="ltx_Math" display="inline" id="A4.SS2.p1.2.m2.1"><semantics id="A4.SS2.p1.2.m2.1a"><mi id="A4.SS2.p1.2.m2.1.1" xref="A4.SS2.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.m2.1b"><ci id="A4.SS2.p1.2.m2.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.2.m2.1d">italic_c</annotation></semantics></math> which the model considers as the most likely answer (note that here <math alttext="y" class="ltx_Math" display="inline" id="A4.SS2.p1.3.m3.1"><semantics id="A4.SS2.p1.3.m3.1a"><mi id="A4.SS2.p1.3.m3.1.1" xref="A4.SS2.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.3.m3.1b"><ci id="A4.SS2.p1.3.m3.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.3.m3.1d">italic_y</annotation></semantics></math> is no longer the log probability ratio between two tokens, but the log probability of a sequence of tokens). Let <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.4.m4.1"><semantics id="A4.SS2.p1.4.m4.1a"><mi id="A4.SS2.p1.4.m4.1.1" xref="A4.SS2.p1.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.4.m4.1b"><ci id="A4.SS2.p1.4.m4.1.1.cmml" xref="A4.SS2.p1.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.4.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.4.m4.1d">italic_z</annotation></semantics></math>, <math alttext="z^{*}" class="ltx_Math" display="inline" id="A4.SS2.p1.5.m5.1"><semantics id="A4.SS2.p1.5.m5.1a"><msup id="A4.SS2.p1.5.m5.1.1" xref="A4.SS2.p1.5.m5.1.1.cmml"><mi id="A4.SS2.p1.5.m5.1.1.2" xref="A4.SS2.p1.5.m5.1.1.2.cmml">z</mi><mo id="A4.SS2.p1.5.m5.1.1.3" xref="A4.SS2.p1.5.m5.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.5.m5.1b"><apply id="A4.SS2.p1.5.m5.1.1.cmml" xref="A4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A4.SS2.p1.5.m5.1.1.1.cmml" xref="A4.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="A4.SS2.p1.5.m5.1.1.2.cmml" xref="A4.SS2.p1.5.m5.1.1.2">𝑧</ci><times id="A4.SS2.p1.5.m5.1.1.3.cmml" xref="A4.SS2.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.5.m5.1c">z^{*}</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.5.m5.1d">italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math> be the activation values of a neuron (i.e. a dimension of the hidden state of an input token at a particular transformer layer) when taking the original and noise-injected input embeddings <math alttext="E(u),E^{*}(u)" class="ltx_Math" display="inline" id="A4.SS2.p1.6.m6.4"><semantics id="A4.SS2.p1.6.m6.4a"><mrow id="A4.SS2.p1.6.m6.4.4.2" xref="A4.SS2.p1.6.m6.4.4.3.cmml"><mrow id="A4.SS2.p1.6.m6.3.3.1.1" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml"><mi id="A4.SS2.p1.6.m6.3.3.1.1.2" xref="A4.SS2.p1.6.m6.3.3.1.1.2.cmml">E</mi><mo id="A4.SS2.p1.6.m6.3.3.1.1.1" xref="A4.SS2.p1.6.m6.3.3.1.1.1.cmml">⁢</mo><mrow id="A4.SS2.p1.6.m6.3.3.1.1.3.2" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml"><mo id="A4.SS2.p1.6.m6.3.3.1.1.3.2.1" stretchy="false" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml">(</mo><mi id="A4.SS2.p1.6.m6.1.1" xref="A4.SS2.p1.6.m6.1.1.cmml">u</mi><mo id="A4.SS2.p1.6.m6.3.3.1.1.3.2.2" stretchy="false" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="A4.SS2.p1.6.m6.4.4.2.3" xref="A4.SS2.p1.6.m6.4.4.3.cmml">,</mo><mrow id="A4.SS2.p1.6.m6.4.4.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml"><msup id="A4.SS2.p1.6.m6.4.4.2.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.2.cmml"><mi id="A4.SS2.p1.6.m6.4.4.2.2.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.2.2.cmml">E</mi><mo id="A4.SS2.p1.6.m6.4.4.2.2.2.3" xref="A4.SS2.p1.6.m6.4.4.2.2.2.3.cmml">*</mo></msup><mo id="A4.SS2.p1.6.m6.4.4.2.2.1" xref="A4.SS2.p1.6.m6.4.4.2.2.1.cmml">⁢</mo><mrow id="A4.SS2.p1.6.m6.4.4.2.2.3.2" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml"><mo id="A4.SS2.p1.6.m6.4.4.2.2.3.2.1" stretchy="false" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml">(</mo><mi id="A4.SS2.p1.6.m6.2.2" xref="A4.SS2.p1.6.m6.2.2.cmml">u</mi><mo id="A4.SS2.p1.6.m6.4.4.2.2.3.2.2" stretchy="false" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.6.m6.4b"><list id="A4.SS2.p1.6.m6.4.4.3.cmml" xref="A4.SS2.p1.6.m6.4.4.2"><apply id="A4.SS2.p1.6.m6.3.3.1.1.cmml" xref="A4.SS2.p1.6.m6.3.3.1.1"><times id="A4.SS2.p1.6.m6.3.3.1.1.1.cmml" xref="A4.SS2.p1.6.m6.3.3.1.1.1"></times><ci id="A4.SS2.p1.6.m6.3.3.1.1.2.cmml" xref="A4.SS2.p1.6.m6.3.3.1.1.2">𝐸</ci><ci id="A4.SS2.p1.6.m6.1.1.cmml" xref="A4.SS2.p1.6.m6.1.1">𝑢</ci></apply><apply id="A4.SS2.p1.6.m6.4.4.2.2.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2"><times id="A4.SS2.p1.6.m6.4.4.2.2.1.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.1"></times><apply id="A4.SS2.p1.6.m6.4.4.2.2.2.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2"><csymbol cd="ambiguous" id="A4.SS2.p1.6.m6.4.4.2.2.2.1.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2">superscript</csymbol><ci id="A4.SS2.p1.6.m6.4.4.2.2.2.2.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2.2">𝐸</ci><times id="A4.SS2.p1.6.m6.4.4.2.2.2.3.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2.3"></times></apply><ci id="A4.SS2.p1.6.m6.2.2.cmml" xref="A4.SS2.p1.6.m6.2.2">𝑢</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.6.m6.4c">E(u),E^{*}(u)</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.6.m6.4d">italic_E ( italic_u ) , italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u )</annotation></semantics></math> respectively, and let <math alttext="g(z)=\nabla_{z}y,g(z^{*})=\nabla_{z^{*}}y_{*}" class="ltx_Math" display="inline" id="A4.SS2.p1.7.m7.3"><semantics id="A4.SS2.p1.7.m7.3a"><mrow id="A4.SS2.p1.7.m7.3.3.2" xref="A4.SS2.p1.7.m7.3.3.3.cmml"><mrow id="A4.SS2.p1.7.m7.2.2.1.1" xref="A4.SS2.p1.7.m7.2.2.1.1.cmml"><mrow id="A4.SS2.p1.7.m7.2.2.1.1.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml"><mi id="A4.SS2.p1.7.m7.2.2.1.1.2.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.2.cmml">g</mi><mo id="A4.SS2.p1.7.m7.2.2.1.1.2.1" xref="A4.SS2.p1.7.m7.2.2.1.1.2.1.cmml">⁢</mo><mrow id="A4.SS2.p1.7.m7.2.2.1.1.2.3.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml"><mo id="A4.SS2.p1.7.m7.2.2.1.1.2.3.2.1" stretchy="false" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml">(</mo><mi id="A4.SS2.p1.7.m7.1.1" xref="A4.SS2.p1.7.m7.1.1.cmml">z</mi><mo id="A4.SS2.p1.7.m7.2.2.1.1.2.3.2.2" stretchy="false" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.SS2.p1.7.m7.2.2.1.1.1" xref="A4.SS2.p1.7.m7.2.2.1.1.1.cmml">=</mo><mrow id="A4.SS2.p1.7.m7.2.2.1.1.3" xref="A4.SS2.p1.7.m7.2.2.1.1.3.cmml"><msub id="A4.SS2.p1.7.m7.2.2.1.1.3.1" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.cmml"><mo id="A4.SS2.p1.7.m7.2.2.1.1.3.1.2" rspace="0.167em" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.2.cmml">∇</mo><mi id="A4.SS2.p1.7.m7.2.2.1.1.3.1.3" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.3.cmml">z</mi></msub><mi id="A4.SS2.p1.7.m7.2.2.1.1.3.2" xref="A4.SS2.p1.7.m7.2.2.1.1.3.2.cmml">y</mi></mrow></mrow><mo id="A4.SS2.p1.7.m7.3.3.2.3" xref="A4.SS2.p1.7.m7.3.3.3a.cmml">,</mo><mrow id="A4.SS2.p1.7.m7.3.3.2.2" xref="A4.SS2.p1.7.m7.3.3.2.2.cmml"><mrow id="A4.SS2.p1.7.m7.3.3.2.2.1" xref="A4.SS2.p1.7.m7.3.3.2.2.1.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.1.3.cmml">g</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.1.2" xref="A4.SS2.p1.7.m7.3.3.2.2.1.2.cmml">⁢</mo><mrow id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml"><mo id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.2" stretchy="false" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml">(</mo><msup id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2.cmml">z</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3.cmml">*</mo></msup><mo id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.3" stretchy="false" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.SS2.p1.7.m7.3.3.2.2.2" xref="A4.SS2.p1.7.m7.3.3.2.2.2.cmml">=</mo><mrow id="A4.SS2.p1.7.m7.3.3.2.2.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.cmml"><msub id="A4.SS2.p1.7.m7.3.3.2.2.3.1" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.cmml"><mo id="A4.SS2.p1.7.m7.3.3.2.2.3.1.2" rspace="0.167em" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.2.cmml">∇</mo><msup id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2.cmml">z</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3.cmml">*</mo></msup></msub><msub id="A4.SS2.p1.7.m7.3.3.2.2.3.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.3.2.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.2.cmml">y</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.3.2.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.3.cmml">*</mo></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.7.m7.3b"><apply id="A4.SS2.p1.7.m7.3.3.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.3a.cmml" xref="A4.SS2.p1.7.m7.3.3.2.3">formulae-sequence</csymbol><apply id="A4.SS2.p1.7.m7.2.2.1.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1"><eq id="A4.SS2.p1.7.m7.2.2.1.1.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.1"></eq><apply id="A4.SS2.p1.7.m7.2.2.1.1.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.2"><times id="A4.SS2.p1.7.m7.2.2.1.1.2.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.2.1"></times><ci id="A4.SS2.p1.7.m7.2.2.1.1.2.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.2.2">𝑔</ci><ci id="A4.SS2.p1.7.m7.1.1.cmml" xref="A4.SS2.p1.7.m7.1.1">𝑧</ci></apply><apply id="A4.SS2.p1.7.m7.2.2.1.1.3.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3"><apply id="A4.SS2.p1.7.m7.2.2.1.1.3.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.2.2.1.1.3.1.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1">subscript</csymbol><ci id="A4.SS2.p1.7.m7.2.2.1.1.3.1.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.2">∇</ci><ci id="A4.SS2.p1.7.m7.2.2.1.1.3.1.3.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.3">𝑧</ci></apply><ci id="A4.SS2.p1.7.m7.2.2.1.1.3.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.2">𝑦</ci></apply></apply><apply id="A4.SS2.p1.7.m7.3.3.2.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2"><eq id="A4.SS2.p1.7.m7.3.3.2.2.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.2"></eq><apply id="A4.SS2.p1.7.m7.3.3.2.2.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1"><times id="A4.SS2.p1.7.m7.3.3.2.2.1.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.2"></times><ci id="A4.SS2.p1.7.m7.3.3.2.2.1.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.3">𝑔</ci><apply id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1">superscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2">𝑧</ci><times id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3"></times></apply></apply><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3"><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.3.1.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1">subscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.3.1.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.2">∇</ci><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3">superscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2">𝑧</ci><times id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3"></times></apply></apply><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.3.2.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2">subscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.3.2.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.2">𝑦</ci><times id="A4.SS2.p1.7.m7.3.3.2.2.3.2.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.7.m7.3c">g(z)=\nabla_{z}y,g(z^{*})=\nabla_{z^{*}}y_{*}</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.7.m7.3d">italic_g ( italic_z ) = ∇ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT italic_y , italic_g ( italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ) = ∇ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT</annotation></semantics></math> be the gradient of the neuron w.r.t the relative log likelihood in the hallucination and the mitigation run with an input embedding noise <math alttext="\epsilon" class="ltx_Math" display="inline" id="A4.SS2.p1.8.m8.1"><semantics id="A4.SS2.p1.8.m8.1a"><mi id="A4.SS2.p1.8.m8.1.1" xref="A4.SS2.p1.8.m8.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.8.m8.1b"><ci id="A4.SS2.p1.8.m8.1.1.cmml" xref="A4.SS2.p1.8.m8.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.8.m8.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.8.m8.1d">italic_ϵ</annotation></semantics></math> injected, we can approximate the causal indirect effect of <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.9.m9.1"><semantics id="A4.SS2.p1.9.m9.1a"><mi id="A4.SS2.p1.9.m9.1.1" xref="A4.SS2.p1.9.m9.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.9.m9.1b"><ci id="A4.SS2.p1.9.m9.1.1.cmml" xref="A4.SS2.p1.9.m9.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.9.m9.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.9.m9.1d">italic_z</annotation></semantics></math> as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx2">
<tbody id="A4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{IE}(z,y,u,\epsilon)=y_{E^{*},z}-y_{*}\approx g(z^{*})(y-y_{%
*})" class="ltx_Math" display="inline" id="A4.E3.m1.8"><semantics id="A4.E3.m1.8a"><mrow id="A4.E3.m1.8.8" xref="A4.E3.m1.8.8.cmml"><mrow id="A4.E3.m1.8.8.4" xref="A4.E3.m1.8.8.4.cmml"><mtext id="A4.E3.m1.8.8.4.2" xref="A4.E3.m1.8.8.4.2a.cmml">IE</mtext><mo id="A4.E3.m1.8.8.4.1" xref="A4.E3.m1.8.8.4.1.cmml">⁢</mo><mrow id="A4.E3.m1.8.8.4.3.2" xref="A4.E3.m1.8.8.4.3.1.cmml"><mo id="A4.E3.m1.8.8.4.3.2.1" stretchy="false" xref="A4.E3.m1.8.8.4.3.1.cmml">(</mo><mi id="A4.E3.m1.3.3" xref="A4.E3.m1.3.3.cmml">z</mi><mo id="A4.E3.m1.8.8.4.3.2.2" xref="A4.E3.m1.8.8.4.3.1.cmml">,</mo><mi id="A4.E3.m1.4.4" xref="A4.E3.m1.4.4.cmml">y</mi><mo id="A4.E3.m1.8.8.4.3.2.3" xref="A4.E3.m1.8.8.4.3.1.cmml">,</mo><mi id="A4.E3.m1.5.5" xref="A4.E3.m1.5.5.cmml">u</mi><mo id="A4.E3.m1.8.8.4.3.2.4" xref="A4.E3.m1.8.8.4.3.1.cmml">,</mo><mi id="A4.E3.m1.6.6" xref="A4.E3.m1.6.6.cmml">ϵ</mi><mo id="A4.E3.m1.8.8.4.3.2.5" stretchy="false" xref="A4.E3.m1.8.8.4.3.1.cmml">)</mo></mrow></mrow><mo id="A4.E3.m1.8.8.5" xref="A4.E3.m1.8.8.5.cmml">=</mo><mrow id="A4.E3.m1.8.8.6" xref="A4.E3.m1.8.8.6.cmml"><msub id="A4.E3.m1.8.8.6.2" xref="A4.E3.m1.8.8.6.2.cmml"><mi id="A4.E3.m1.8.8.6.2.2" xref="A4.E3.m1.8.8.6.2.2.cmml">y</mi><mrow id="A4.E3.m1.2.2.2.2" xref="A4.E3.m1.2.2.2.3.cmml"><msup id="A4.E3.m1.2.2.2.2.1" xref="A4.E3.m1.2.2.2.2.1.cmml"><mi id="A4.E3.m1.2.2.2.2.1.2" xref="A4.E3.m1.2.2.2.2.1.2.cmml">E</mi><mo id="A4.E3.m1.2.2.2.2.1.3" xref="A4.E3.m1.2.2.2.2.1.3.cmml">*</mo></msup><mo id="A4.E3.m1.2.2.2.2.2" xref="A4.E3.m1.2.2.2.3.cmml">,</mo><mi id="A4.E3.m1.1.1.1.1" xref="A4.E3.m1.1.1.1.1.cmml">z</mi></mrow></msub><mo id="A4.E3.m1.8.8.6.1" xref="A4.E3.m1.8.8.6.1.cmml">−</mo><msub id="A4.E3.m1.8.8.6.3" xref="A4.E3.m1.8.8.6.3.cmml"><mi id="A4.E3.m1.8.8.6.3.2" xref="A4.E3.m1.8.8.6.3.2.cmml">y</mi><mo id="A4.E3.m1.8.8.6.3.3" xref="A4.E3.m1.8.8.6.3.3.cmml">*</mo></msub></mrow><mo id="A4.E3.m1.8.8.7" xref="A4.E3.m1.8.8.7.cmml">≈</mo><mrow id="A4.E3.m1.8.8.2" xref="A4.E3.m1.8.8.2.cmml"><mi id="A4.E3.m1.8.8.2.4" xref="A4.E3.m1.8.8.2.4.cmml">g</mi><mo id="A4.E3.m1.8.8.2.3" xref="A4.E3.m1.8.8.2.3.cmml">⁢</mo><mrow id="A4.E3.m1.7.7.1.1.1" xref="A4.E3.m1.7.7.1.1.1.1.cmml"><mo id="A4.E3.m1.7.7.1.1.1.2" stretchy="false" xref="A4.E3.m1.7.7.1.1.1.1.cmml">(</mo><msup id="A4.E3.m1.7.7.1.1.1.1" xref="A4.E3.m1.7.7.1.1.1.1.cmml"><mi id="A4.E3.m1.7.7.1.1.1.1.2" xref="A4.E3.m1.7.7.1.1.1.1.2.cmml">z</mi><mo id="A4.E3.m1.7.7.1.1.1.1.3" xref="A4.E3.m1.7.7.1.1.1.1.3.cmml">*</mo></msup><mo id="A4.E3.m1.7.7.1.1.1.3" stretchy="false" xref="A4.E3.m1.7.7.1.1.1.1.cmml">)</mo></mrow><mo id="A4.E3.m1.8.8.2.3a" xref="A4.E3.m1.8.8.2.3.cmml">⁢</mo><mrow id="A4.E3.m1.8.8.2.2.1" xref="A4.E3.m1.8.8.2.2.1.1.cmml"><mo id="A4.E3.m1.8.8.2.2.1.2" stretchy="false" xref="A4.E3.m1.8.8.2.2.1.1.cmml">(</mo><mrow id="A4.E3.m1.8.8.2.2.1.1" xref="A4.E3.m1.8.8.2.2.1.1.cmml"><mi id="A4.E3.m1.8.8.2.2.1.1.2" xref="A4.E3.m1.8.8.2.2.1.1.2.cmml">y</mi><mo id="A4.E3.m1.8.8.2.2.1.1.1" xref="A4.E3.m1.8.8.2.2.1.1.1.cmml">−</mo><msub id="A4.E3.m1.8.8.2.2.1.1.3" xref="A4.E3.m1.8.8.2.2.1.1.3.cmml"><mi id="A4.E3.m1.8.8.2.2.1.1.3.2" xref="A4.E3.m1.8.8.2.2.1.1.3.2.cmml">y</mi><mo id="A4.E3.m1.8.8.2.2.1.1.3.3" xref="A4.E3.m1.8.8.2.2.1.1.3.3.cmml">*</mo></msub></mrow><mo id="A4.E3.m1.8.8.2.2.1.3" stretchy="false" xref="A4.E3.m1.8.8.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.E3.m1.8b"><apply id="A4.E3.m1.8.8.cmml" xref="A4.E3.m1.8.8"><and id="A4.E3.m1.8.8a.cmml" xref="A4.E3.m1.8.8"></and><apply id="A4.E3.m1.8.8b.cmml" xref="A4.E3.m1.8.8"><eq id="A4.E3.m1.8.8.5.cmml" xref="A4.E3.m1.8.8.5"></eq><apply id="A4.E3.m1.8.8.4.cmml" xref="A4.E3.m1.8.8.4"><times id="A4.E3.m1.8.8.4.1.cmml" xref="A4.E3.m1.8.8.4.1"></times><ci id="A4.E3.m1.8.8.4.2a.cmml" xref="A4.E3.m1.8.8.4.2"><mtext id="A4.E3.m1.8.8.4.2.cmml" xref="A4.E3.m1.8.8.4.2">IE</mtext></ci><vector id="A4.E3.m1.8.8.4.3.1.cmml" xref="A4.E3.m1.8.8.4.3.2"><ci id="A4.E3.m1.3.3.cmml" xref="A4.E3.m1.3.3">𝑧</ci><ci id="A4.E3.m1.4.4.cmml" xref="A4.E3.m1.4.4">𝑦</ci><ci id="A4.E3.m1.5.5.cmml" xref="A4.E3.m1.5.5">𝑢</ci><ci id="A4.E3.m1.6.6.cmml" xref="A4.E3.m1.6.6">italic-ϵ</ci></vector></apply><apply id="A4.E3.m1.8.8.6.cmml" xref="A4.E3.m1.8.8.6"><minus id="A4.E3.m1.8.8.6.1.cmml" xref="A4.E3.m1.8.8.6.1"></minus><apply id="A4.E3.m1.8.8.6.2.cmml" xref="A4.E3.m1.8.8.6.2"><csymbol cd="ambiguous" id="A4.E3.m1.8.8.6.2.1.cmml" xref="A4.E3.m1.8.8.6.2">subscript</csymbol><ci id="A4.E3.m1.8.8.6.2.2.cmml" xref="A4.E3.m1.8.8.6.2.2">𝑦</ci><list id="A4.E3.m1.2.2.2.3.cmml" xref="A4.E3.m1.2.2.2.2"><apply id="A4.E3.m1.2.2.2.2.1.cmml" xref="A4.E3.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="A4.E3.m1.2.2.2.2.1.1.cmml" xref="A4.E3.m1.2.2.2.2.1">superscript</csymbol><ci id="A4.E3.m1.2.2.2.2.1.2.cmml" xref="A4.E3.m1.2.2.2.2.1.2">𝐸</ci><times id="A4.E3.m1.2.2.2.2.1.3.cmml" xref="A4.E3.m1.2.2.2.2.1.3"></times></apply><ci id="A4.E3.m1.1.1.1.1.cmml" xref="A4.E3.m1.1.1.1.1">𝑧</ci></list></apply><apply id="A4.E3.m1.8.8.6.3.cmml" xref="A4.E3.m1.8.8.6.3"><csymbol cd="ambiguous" id="A4.E3.m1.8.8.6.3.1.cmml" xref="A4.E3.m1.8.8.6.3">subscript</csymbol><ci id="A4.E3.m1.8.8.6.3.2.cmml" xref="A4.E3.m1.8.8.6.3.2">𝑦</ci><times id="A4.E3.m1.8.8.6.3.3.cmml" xref="A4.E3.m1.8.8.6.3.3"></times></apply></apply></apply><apply id="A4.E3.m1.8.8c.cmml" xref="A4.E3.m1.8.8"><approx id="A4.E3.m1.8.8.7.cmml" xref="A4.E3.m1.8.8.7"></approx><share href="#A4.E3.m1.8.8.6.cmml" id="A4.E3.m1.8.8d.cmml" xref="A4.E3.m1.8.8"></share><apply id="A4.E3.m1.8.8.2.cmml" xref="A4.E3.m1.8.8.2"><times id="A4.E3.m1.8.8.2.3.cmml" xref="A4.E3.m1.8.8.2.3"></times><ci id="A4.E3.m1.8.8.2.4.cmml" xref="A4.E3.m1.8.8.2.4">𝑔</ci><apply id="A4.E3.m1.7.7.1.1.1.1.cmml" xref="A4.E3.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="A4.E3.m1.7.7.1.1.1.1.1.cmml" xref="A4.E3.m1.7.7.1.1.1">superscript</csymbol><ci id="A4.E3.m1.7.7.1.1.1.1.2.cmml" xref="A4.E3.m1.7.7.1.1.1.1.2">𝑧</ci><times id="A4.E3.m1.7.7.1.1.1.1.3.cmml" xref="A4.E3.m1.7.7.1.1.1.1.3"></times></apply><apply id="A4.E3.m1.8.8.2.2.1.1.cmml" xref="A4.E3.m1.8.8.2.2.1"><minus id="A4.E3.m1.8.8.2.2.1.1.1.cmml" xref="A4.E3.m1.8.8.2.2.1.1.1"></minus><ci id="A4.E3.m1.8.8.2.2.1.1.2.cmml" xref="A4.E3.m1.8.8.2.2.1.1.2">𝑦</ci><apply id="A4.E3.m1.8.8.2.2.1.1.3.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3"><csymbol cd="ambiguous" id="A4.E3.m1.8.8.2.2.1.1.3.1.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3">subscript</csymbol><ci id="A4.E3.m1.8.8.2.2.1.1.3.2.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3.2">𝑦</ci><times id="A4.E3.m1.8.8.2.2.1.1.3.3.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E3.m1.8c">\displaystyle\text{IE}(z,y,u,\epsilon)=y_{E^{*},z}-y_{*}\approx g(z^{*})(y-y_{%
*})</annotation><annotation encoding="application/x-llamapun" id="A4.E3.m1.8d">IE ( italic_z , italic_y , italic_u , italic_ϵ ) = italic_y start_POSTSUBSCRIPT italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT , italic_z end_POSTSUBSCRIPT - italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT ≈ italic_g ( italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ) ( italic_y - italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.SS2.p1.13">Intuitively, we are assuming that the response variable <math alttext="y" class="ltx_Math" display="inline" id="A4.SS2.p1.10.m1.1"><semantics id="A4.SS2.p1.10.m1.1a"><mi id="A4.SS2.p1.10.m1.1.1" xref="A4.SS2.p1.10.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.10.m1.1b"><ci id="A4.SS2.p1.10.m1.1.1.cmml" xref="A4.SS2.p1.10.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.10.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.10.m1.1d">italic_y</annotation></semantics></math> is a locally linear function of the activation value of <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.11.m2.1"><semantics id="A4.SS2.p1.11.m2.1a"><mi id="A4.SS2.p1.11.m2.1.1" xref="A4.SS2.p1.11.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.11.m2.1b"><ci id="A4.SS2.p1.11.m2.1.1.cmml" xref="A4.SS2.p1.11.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.11.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.11.m2.1d">italic_z</annotation></semantics></math> (when keeping other neurons fixed), so the causal effect can be approximated as the multiplication of the gradient of <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.12.m3.1"><semantics id="A4.SS2.p1.12.m3.1a"><mi id="A4.SS2.p1.12.m3.1.1" xref="A4.SS2.p1.12.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.12.m3.1b"><ci id="A4.SS2.p1.12.m3.1.1.cmml" xref="A4.SS2.p1.12.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.12.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.12.m3.1d">italic_z</annotation></semantics></math> and the difference in its activation values after input perturbation. The approximations of AIE for each neuron <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.13.m4.1"><semantics id="A4.SS2.p1.13.m4.1a"><mi id="A4.SS2.p1.13.m4.1.1" xref="A4.SS2.p1.13.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.13.m4.1b"><ci id="A4.SS2.p1.13.m4.1.1.cmml" xref="A4.SS2.p1.13.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.13.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.13.m4.1d">italic_z</annotation></semantics></math> can also be computed by averaging the approximated IEs over independently sampled noises and over all input queries.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</article>
</div>

</div>


<div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated on Wed Dec 14 18:01:44 2022 by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer><button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button></body></html>