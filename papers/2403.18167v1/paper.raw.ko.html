<html lang="en" data-theme="light"><head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Mechanisms of Non-Factual Hallucination in Language Models</title>
<!--Generated on Wed Mar 27 00:22:22 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="https://arxiv.org/static/browse/0.3.4/js/addons.js"></script>
<script src="https://arxiv.org/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="https://arxiv.org/html/2403.18167v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2403.18167v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
        <span class="color-scheme-icon" aria-label="Light mode"></span>
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="#myForm" onclick="event.preventDefault(); var modal = document.getElementById('myForm'); modal.style.display = 'block'; bugReportState.setInitiateWay('Header');">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2403.18167v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2403.18167v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
          <span class="color-scheme-icon"></span>
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC mobile collapse" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S1" title="1 Introduction ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S2" title="2 Related Work ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S2.SS0.SSS0.Px1" title="Factual knowledge in language models. ‣ 2 Related Work ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Factual knowledge in language models.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S2.SS0.SSS0.Px2" title="Hallucinations. ‣ 2 Related Work ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Hallucinations.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S2.SS0.SSS0.Px3" title="Mechanistic interpretability. ‣ 2 Related Work ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Mechanistic interpretability.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S3" title="3 Background and Notation ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Background and Notation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4" title="4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Mechanisms of Hallucinations</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Causal tracing of factual errors</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px1" title="Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Method.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px2" title="Experiments. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Experiments.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px3" title="Results. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px4" title="Early- vs. late-site hallucination. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Early- vs. late-site hallucination.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1.SSS0.Px5" title="External manifestations of hallucination mechanisms. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">External manifestations of hallucination mechanisms.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS2" title="4.2 Inspection via embedding space projection ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Inspection via embedding space projection</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS2.SSS0.Px1" title="Method. ‣ 4.2 Inspection via embedding space projection ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Method.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS2.SSS0.Px2" title="Results. ‣ 4.2 Inspection via embedding space projection ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S5" title="5 Tracing LM Hallucinations During Pretraining ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Tracing LM Hallucinations During Pretraining</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S5.SS0.SSS0.Px1" title="Data and models. ‣ 5 Tracing LM Hallucinations During Pretraining ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Data and models.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S5.SS0.SSS0.Px2" title="Development of factual association pipeline. ‣ 5 Tracing LM Hallucinations During Pretraining ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Development of factual association pipeline.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6" title="6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Application to Hallucination Detection</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.SS0.SSS0.Px1" title="Data. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Data.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.SS0.SSS0.Px2" title="Methods. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Methods.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.SS0.SSS0.Px3" title="Baselines. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.SS0.SSS0.Px4" title="Results. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S7" title="7 Conclusion ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S8" title="8 Limitation ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Limitation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A1" title="Appendix A Dataset of Non-Factual Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Dataset of Non-Factual Hallucinations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2" title="Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Causal Tracing of Hallucinations</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS1" title="B.1 Experiment details ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Experiment details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS2" title="B.2 Causal tracing results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Causal tracing results on GPTs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS3" title="B.3 Examples of early-site and late-site hallucinations ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Examples of early-site and late-site hallucinations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS4" title="B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>Embedding space projection results on GPTs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A3" title="Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Evaluation of Pythia Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A4" title="Appendix D Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Hallucination Detection</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A4.SS1" title="D.1 Example data from Natural Questions and TruthfulQA ‣ Appendix D Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Example data from Natural Questions and TruthfulQA</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A4.SS2" title="D.2 Details of causal attribution approximation ‣ Appendix D Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Details of causal attribution approximation</span></a></li>
</ol>
</li>
</ol></nav>

<div class="ltx_page_content">
<div aria-label="Conversion errors have been found" class="package-alerts ltx_document" role="status">
<button aria-label="Dismiss alert" onclick="closePopup()">
<span aria-hidden="true"><svg aria-hidden="true" focusable="false" height="20" role="presentation" viewBox="0 0 44 44" width="20">
<path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
<path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
</svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button></span>
</button>
<p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul arial-label="Unsupported packages used in this paper">
<li>failed: inconsolata</li>
</ul>
<p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div><div class="section" id="target-section"><div id="license-tr">License: CC BY 4.0</div><div id="watermark-tr">arXiv:2403.18167v1 [cs.CL] 27 Mar 2024</div></div>
<script>
            function closePopup() {
                document.querySelector('.package-alerts').style.display = 'none';
            }
        </script>
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Mechanisms of Non-Factual Hallucination in Language Models</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lei Yu<math alttext="{}^{1,*}" class="ltx_Math" display="inline" id="id1.1.m1.2"><semantics id="id1.1.m1.2a"><msup id="id1.1.m1.2.2" xref="id1.1.m1.2.2.cmml"><mi id="id1.1.m1.2.2a" xref="id1.1.m1.2.2.cmml"></mi><mrow id="id1.1.m1.2.2.2.4" xref="id1.1.m1.2.2.2.3.cmml"><mn id="id1.1.m1.1.1.1.1" xref="id1.1.m1.1.1.1.1.cmml">1</mn><mo id="id1.1.m1.2.2.2.4.1" rspace="0em" xref="id1.1.m1.2.2.2.3.cmml">,</mo><mo id="id1.1.m1.2.2.2.2" lspace="0em" xref="id1.1.m1.2.2.2.2.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.2b"><apply id="id1.1.m1.2.2.cmml" xref="id1.1.m1.2.2"><list id="id1.1.m1.2.2.2.3.cmml" xref="id1.1.m1.2.2.2.4"><cn id="id1.1.m1.1.1.1.1.cmml" type="integer" xref="id1.1.m1.1.1.1.1">1</cn><times id="id1.1.m1.2.2.2.2.cmml" xref="id1.1.m1.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.2c">{}^{1,*}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.2d">start_FLOATSUPERSCRIPT 1 , * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Meng Cao<math alttext="{}^{2,3,*}" class="ltx_Math" display="inline" id="id2.2.m2.3"><semantics id="id2.2.m2.3a"><msup id="id2.2.m2.3.3" xref="id2.2.m2.3.3.cmml"><mi id="id2.2.m2.3.3a" xref="id2.2.m2.3.3.cmml"></mi><mrow id="id2.2.m2.3.3.3.5" xref="id2.2.m2.3.3.3.4.cmml"><mn id="id2.2.m2.1.1.1.1" xref="id2.2.m2.1.1.1.1.cmml">2</mn><mo id="id2.2.m2.3.3.3.5.1" xref="id2.2.m2.3.3.3.4.cmml">,</mo><mn id="id2.2.m2.2.2.2.2" xref="id2.2.m2.2.2.2.2.cmml">3</mn><mo id="id2.2.m2.3.3.3.5.2" rspace="0em" xref="id2.2.m2.3.3.3.4.cmml">,</mo><mo id="id2.2.m2.3.3.3.3" lspace="0em" xref="id2.2.m2.3.3.3.3.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id2.2.m2.3b"><apply id="id2.2.m2.3.3.cmml" xref="id2.2.m2.3.3"><list id="id2.2.m2.3.3.3.4.cmml" xref="id2.2.m2.3.3.3.5"><cn id="id2.2.m2.1.1.1.1.cmml" type="integer" xref="id2.2.m2.1.1.1.1">2</cn><cn id="id2.2.m2.2.2.2.2.cmml" type="integer" xref="id2.2.m2.2.2.2.2">3</cn><times id="id2.2.m2.3.3.3.3.cmml" xref="id2.2.m2.3.3.3.3"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.3c">{}^{2,3,*}</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.3d">start_FLOATSUPERSCRIPT 2 , 3 , * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Jackie Chi Kit Cheung<math alttext="{}^{2,3}" class="ltx_Math" display="inline" id="id3.3.m3.2"><semantics id="id3.3.m3.2a"><msup id="id3.3.m3.2.2" xref="id3.3.m3.2.2.cmml"><mi id="id3.3.m3.2.2a" xref="id3.3.m3.2.2.cmml"></mi><mrow id="id3.3.m3.2.2.2.4" xref="id3.3.m3.2.2.2.3.cmml"><mn id="id3.3.m3.1.1.1.1" xref="id3.3.m3.1.1.1.1.cmml">2</mn><mo id="id3.3.m3.2.2.2.4.1" xref="id3.3.m3.2.2.2.3.cmml">,</mo><mn id="id3.3.m3.2.2.2.2" xref="id3.3.m3.2.2.2.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id3.3.m3.2b"><apply id="id3.3.m3.2.2.cmml" xref="id3.3.m3.2.2"><list id="id3.3.m3.2.2.2.3.cmml" xref="id3.3.m3.2.2.2.4"><cn id="id3.3.m3.1.1.1.1.cmml" type="integer" xref="id3.3.m3.1.1.1.1">2</cn><cn id="id3.3.m3.2.2.2.2.cmml" type="integer" xref="id3.3.m3.2.2.2.2">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.2c">{}^{2,3}</annotation><annotation encoding="application/x-llamapun" id="id3.3.m3.2d">start_FLOATSUPERSCRIPT 2 , 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>, Yue Dong<math alttext="{}^{4}" class="ltx_Math" display="inline" id="id4.4.m4.1"><semantics id="id4.4.m4.1a"><msup id="id4.4.m4.1.1" xref="id4.4.m4.1.1.cmml"><mi id="id4.4.m4.1.1a" xref="id4.4.m4.1.1.cmml"></mi><mn id="id4.4.m4.1.1.1" xref="id4.4.m4.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="id4.4.m4.1b"><apply id="id4.4.m4.1.1.cmml" xref="id4.4.m4.1.1"><cn id="id4.4.m4.1.1.1.cmml" type="integer" xref="id4.4.m4.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.4.m4.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="id4.4.m4.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math>
<br class="ltx_break"><math alttext="{}^{1}" class="ltx_Math" display="inline" id="id5.5.m5.1"><semantics id="id5.5.m5.1a"><msup id="id5.5.m5.1.1" xref="id5.5.m5.1.1.cmml"><mi id="id5.5.m5.1.1a" xref="id5.5.m5.1.1.cmml"></mi><mn id="id5.5.m5.1.1.1" xref="id5.5.m5.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id5.5.m5.1b"><apply id="id5.5.m5.1.1.cmml" xref="id5.5.m5.1.1"><cn id="id5.5.m5.1.1.1.cmml" type="integer" xref="id5.5.m5.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.5.m5.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id5.5.m5.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>Department of Computer Science, University of Toronto 
<br class="ltx_break"><math alttext="{}^{2}" class="ltx_Math" display="inline" id="id6.6.m6.1"><semantics id="id6.6.m6.1a"><msup id="id6.6.m6.1.1" xref="id6.6.m6.1.1.cmml"><mi id="id6.6.m6.1.1a" xref="id6.6.m6.1.1.cmml"></mi><mn id="id6.6.m6.1.1.1" xref="id6.6.m6.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id6.6.m6.1b"><apply id="id6.6.m6.1.1.cmml" xref="id6.6.m6.1.1"><cn id="id6.6.m6.1.1.1.cmml" type="integer" xref="id6.6.m6.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.6.m6.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id6.6.m6.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>School of Computer Science, McGill University 
<br class="ltx_break"><math alttext="{}^{3}" class="ltx_Math" display="inline" id="id7.7.m7.1"><semantics id="id7.7.m7.1a"><msup id="id7.7.m7.1.1" xref="id7.7.m7.1.1.cmml"><mi id="id7.7.m7.1.1a" xref="id7.7.m7.1.1.cmml"></mi><mn id="id7.7.m7.1.1.1" xref="id7.7.m7.1.1.1.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id7.7.m7.1b"><apply id="id7.7.m7.1.1.cmml" xref="id7.7.m7.1.1"><cn id="id7.7.m7.1.1.1.cmml" type="integer" xref="id7.7.m7.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.7.m7.1c">{}^{3}</annotation><annotation encoding="application/x-llamapun" id="id7.7.m7.1d">start_FLOATSUPERSCRIPT 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>Mila – Québec AI Institute 
<br class="ltx_break"><math alttext="{}^{4}" class="ltx_Math" display="inline" id="id8.8.m8.1"><semantics id="id8.8.m8.1a"><msup id="id8.8.m8.1.1" xref="id8.8.m8.1.1.cmml"><mi id="id8.8.m8.1.1a" xref="id8.8.m8.1.1.cmml"></mi><mn id="id8.8.m8.1.1.1" xref="id8.8.m8.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="id8.8.m8.1b"><apply id="id8.8.m8.1.1.cmml" xref="id8.8.m8.1.1"><cn id="id8.8.m8.1.1.1.cmml" type="integer" xref="id8.8.m8.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.8.m8.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="id8.8.m8.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math>University of California, Riverside 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id9.9.id1">jadeleiyu@cs.toronto.edu</span>
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id10.10.id2">{meng.cao@mail,jcheung@cs}.mcgill.ca</span>
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id11.11.id3">yue.dong@ucr.edu</span>
</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id12.id1">최신 언어 모델(LMs)은 때때로 세계 지식과 잘못 정렬되는 <span class="ltx_text ltx_font_italic" id="id12.id1.1">비사실적 환각</span>을 생성한다. 환각을 감지하고 완화하기 위한 광범위한 노력에도 불구하고, 그들의 내부 메커니즘을 이해하는 것은 여전히 어렵다. 본 연구는 환각의 기계론적 원인, 특히 LM이 주제-관계 질의에 반응하여 객체 속성을 잘못 예측하는 비사실적 원인을 조사한다. 인과 매개 분석과 임베딩 공간 투영을 통해 다양한 규모와 디자인의 LMs에서 공유되는 환각의 두 가지 일반적인 기계론적 원인을 식별한다: 1) 하위 계층 MLP에서 불충분한 주제 속성 지식, 2) 상위 계층 어텐션 헤드 및 MLP에서 올바른 객체 속성을 선택하지 못했습니다. 이 두 메커니즘은 다양한 정도의 피험자-대상 연관, 예측 불확실성 및 섭동 견고성을 나타낸다. 또한 LM 사전 훈련 체크포인트를 조사하여 환각의 두 가지 기계론적 원인에 대한 뚜렷한 학습 역학을 보여준다. 또한 인과 분석에서 귀인 특징이 환각 감지기를 효과적으로 구성할 수 있는 방법을 강조한다. 우리의 작업은 LM 사실 오류에 대한 기계론적 이해를 제안한다. <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our code and data are available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/jadeleiyu/lm_hallucination_mechanisms" title="">https://github.com/jadeleiyu/lm_hallucination_mechanisms</a>.</span></span></span></p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<p class="ltx_p ltx_align_center ltx_align_bottom" id="p1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1">Mechanisms of Non-Factual Hallucination in Language Models</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="p2">
<br class="ltx_break">
<p class="ltx_p" id="p2.8"><span class="ltx_text" id="p2.8.8" style="width:433.6pt;"><span class="ltx_text" id="p2.8.8.8" style="width:0.0pt;"> <span class="ltx_tabular ltx_align_top" id="p2.8.8.8.8"> <span class="ltx_tbody"> <span class="ltx_tr" id="p2.4.4.4.4.4"> <span class="ltx_td ltx_align_center" id="p2.4.4.4.4.4.4"><span class="ltx_text ltx_font_bold" id="p2.4.4.4.4.4.4.4">Lei Yu<math alttext="{}^{1,*}" class="ltx_Math" display="inline" id="p2.1.1.1.1.1.1.1.m1.2"><semantics id="p2.1.1.1.1.1.1.1.m1.2a"><msup id="p2.1.1.1.1.1.1.1.m1.2.2" xref="p2.1.1.1.1.1.1.1.m1.2.2.cmml"><mi id="p2.1.1.1.1.1.1.1.m1.2.2a" xref="p2.1.1.1.1.1.1.1.m1.2.2.cmml"></mi><mrow id="p2.1.1.1.1.1.1.1.m1.2.2.2.4" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.3.cmml"><mn id="p2.1.1.1.1.1.1.1.m1.1.1.1.1" mathvariant="normal" xref="p2.1.1.1.1.1.1.1.m1.1.1.1.1.cmml">1</mn><mo id="p2.1.1.1.1.1.1.1.m1.2.2.2.4.1" mathvariant="normal" rspace="0em" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.3.cmml">,</mo><mo id="p2.1.1.1.1.1.1.1.m1.2.2.2.2" lspace="0em" mathvariant="normal" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.2.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="p2.1.1.1.1.1.1.1.m1.2b"><apply id="p2.1.1.1.1.1.1.1.m1.2.2.cmml" xref="p2.1.1.1.1.1.1.1.m1.2.2"><list id="p2.1.1.1.1.1.1.1.m1.2.2.2.3.cmml" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.4"><cn id="p2.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" type="integer" xref="p2.1.1.1.1.1.1.1.m1.1.1.1.1">1</cn><times id="p2.1.1.1.1.1.1.1.m1.2.2.2.2.cmml" xref="p2.1.1.1.1.1.1.1.m1.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.1.1.1.1.1.1.1.m1.2c">{}^{1,*}</annotation><annotation encoding="application/x-llamapun" id="p2.1.1.1.1.1.1.1.m1.2d">start_FLOATSUPERSCRIPT 1 , * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Meng Cao<math alttext="{}^{2,3,*}" class="ltx_Math" display="inline" id="p2.2.2.2.2.2.2.2.m2.3"><semantics id="p2.2.2.2.2.2.2.2.m2.3a"><msup id="p2.2.2.2.2.2.2.2.m2.3.3" xref="p2.2.2.2.2.2.2.2.m2.3.3.cmml"><mi id="p2.2.2.2.2.2.2.2.m2.3.3a" xref="p2.2.2.2.2.2.2.2.m2.3.3.cmml"></mi><mrow id="p2.2.2.2.2.2.2.2.m2.3.3.3.5" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.4.cmml"><mn id="p2.2.2.2.2.2.2.2.m2.1.1.1.1" mathvariant="normal" xref="p2.2.2.2.2.2.2.2.m2.1.1.1.1.cmml">2</mn><mo id="p2.2.2.2.2.2.2.2.m2.3.3.3.5.1" mathvariant="normal" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.4.cmml">,</mo><mn id="p2.2.2.2.2.2.2.2.m2.2.2.2.2" mathvariant="normal" xref="p2.2.2.2.2.2.2.2.m2.2.2.2.2.cmml">3</mn><mo id="p2.2.2.2.2.2.2.2.m2.3.3.3.5.2" mathvariant="normal" rspace="0em" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.4.cmml">,</mo><mo id="p2.2.2.2.2.2.2.2.m2.3.3.3.3" lspace="0em" mathvariant="normal" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.3.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="p2.2.2.2.2.2.2.2.m2.3b"><apply id="p2.2.2.2.2.2.2.2.m2.3.3.cmml" xref="p2.2.2.2.2.2.2.2.m2.3.3"><list id="p2.2.2.2.2.2.2.2.m2.3.3.3.4.cmml" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.5"><cn id="p2.2.2.2.2.2.2.2.m2.1.1.1.1.cmml" type="integer" xref="p2.2.2.2.2.2.2.2.m2.1.1.1.1">2</cn><cn id="p2.2.2.2.2.2.2.2.m2.2.2.2.2.cmml" type="integer" xref="p2.2.2.2.2.2.2.2.m2.2.2.2.2">3</cn><times id="p2.2.2.2.2.2.2.2.m2.3.3.3.3.cmml" xref="p2.2.2.2.2.2.2.2.m2.3.3.3.3"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.2.2.2.2.2.2.2.m2.3c">{}^{2,3,*}</annotation><annotation encoding="application/x-llamapun" id="p2.2.2.2.2.2.2.2.m2.3d">start_FLOATSUPERSCRIPT 2 , 3 , * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Jackie Chi Kit Cheung<math alttext="{}^{2,3}" class="ltx_Math" display="inline" id="p2.3.3.3.3.3.3.3.m3.2"><semantics id="p2.3.3.3.3.3.3.3.m3.2a"><msup id="p2.3.3.3.3.3.3.3.m3.2.2" xref="p2.3.3.3.3.3.3.3.m3.2.2.cmml"><mi id="p2.3.3.3.3.3.3.3.m3.2.2a" xref="p2.3.3.3.3.3.3.3.m3.2.2.cmml"></mi><mrow id="p2.3.3.3.3.3.3.3.m3.2.2.2.4" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.3.cmml"><mn id="p2.3.3.3.3.3.3.3.m3.1.1.1.1" mathvariant="normal" xref="p2.3.3.3.3.3.3.3.m3.1.1.1.1.cmml">2</mn><mo id="p2.3.3.3.3.3.3.3.m3.2.2.2.4.1" mathvariant="normal" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.3.cmml">,</mo><mn id="p2.3.3.3.3.3.3.3.m3.2.2.2.2" mathvariant="normal" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="p2.3.3.3.3.3.3.3.m3.2b"><apply id="p2.3.3.3.3.3.3.3.m3.2.2.cmml" xref="p2.3.3.3.3.3.3.3.m3.2.2"><list id="p2.3.3.3.3.3.3.3.m3.2.2.2.3.cmml" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.4"><cn id="p2.3.3.3.3.3.3.3.m3.1.1.1.1.cmml" type="integer" xref="p2.3.3.3.3.3.3.3.m3.1.1.1.1">2</cn><cn id="p2.3.3.3.3.3.3.3.m3.2.2.2.2.cmml" type="integer" xref="p2.3.3.3.3.3.3.3.m3.2.2.2.2">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.3.3.3.3.3.3.3.m3.2c">{}^{2,3}</annotation><annotation encoding="application/x-llamapun" id="p2.3.3.3.3.3.3.3.m3.2d">start_FLOATSUPERSCRIPT 2 , 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>, Yue Dong<math alttext="{}^{4}" class="ltx_Math" display="inline" id="p2.4.4.4.4.4.4.4.m4.1"><semantics id="p2.4.4.4.4.4.4.4.m4.1a"><msup id="p2.4.4.4.4.4.4.4.m4.1.1" xref="p2.4.4.4.4.4.4.4.m4.1.1.cmml"><mi id="p2.4.4.4.4.4.4.4.m4.1.1a" xref="p2.4.4.4.4.4.4.4.m4.1.1.cmml"></mi><mn id="p2.4.4.4.4.4.4.4.m4.1.1.1" mathvariant="normal" xref="p2.4.4.4.4.4.4.4.m4.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="p2.4.4.4.4.4.4.4.m4.1b"><apply id="p2.4.4.4.4.4.4.4.m4.1.1.cmml" xref="p2.4.4.4.4.4.4.4.m4.1.1"><cn id="p2.4.4.4.4.4.4.4.m4.1.1.1.cmml" type="integer" xref="p2.4.4.4.4.4.4.4.m4.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.4.4.4.4.4.4.4.m4.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="p2.4.4.4.4.4.4.4.m4.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math></span></span></span> <span class="ltx_tr" id="p2.5.5.5.5.5"> <span class="ltx_td ltx_align_center" id="p2.5.5.5.5.5.1"><math alttext="{}^{1}" class="ltx_Math" display="inline" id="p2.5.5.5.5.5.1.m1.1"><semantics id="p2.5.5.5.5.5.1.m1.1a"><msup id="p2.5.5.5.5.5.1.m1.1.1" xref="p2.5.5.5.5.5.1.m1.1.1.cmml"><mi id="p2.5.5.5.5.5.1.m1.1.1a" xref="p2.5.5.5.5.5.1.m1.1.1.cmml"></mi><mn id="p2.5.5.5.5.5.1.m1.1.1.1" xref="p2.5.5.5.5.5.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="p2.5.5.5.5.5.1.m1.1b"><apply id="p2.5.5.5.5.5.1.m1.1.1.cmml" xref="p2.5.5.5.5.5.1.m1.1.1"><cn id="p2.5.5.5.5.5.1.m1.1.1.1.cmml" type="integer" xref="p2.5.5.5.5.5.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.5.5.5.5.5.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="p2.5.5.5.5.5.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>Department of Computer Science, University of Toronto</span></span> <span class="ltx_tr" id="p2.6.6.6.6.6"> <span class="ltx_td ltx_align_center" id="p2.6.6.6.6.6.1"><math alttext="{}^{2}" class="ltx_Math" display="inline" id="p2.6.6.6.6.6.1.m1.1"><semantics id="p2.6.6.6.6.6.1.m1.1a"><msup id="p2.6.6.6.6.6.1.m1.1.1" xref="p2.6.6.6.6.6.1.m1.1.1.cmml"><mi id="p2.6.6.6.6.6.1.m1.1.1a" xref="p2.6.6.6.6.6.1.m1.1.1.cmml"></mi><mn id="p2.6.6.6.6.6.1.m1.1.1.1" xref="p2.6.6.6.6.6.1.m1.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="p2.6.6.6.6.6.1.m1.1b"><apply id="p2.6.6.6.6.6.1.m1.1.1.cmml" xref="p2.6.6.6.6.6.1.m1.1.1"><cn id="p2.6.6.6.6.6.1.m1.1.1.1.cmml" type="integer" xref="p2.6.6.6.6.6.1.m1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.6.6.6.6.6.1.m1.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="p2.6.6.6.6.6.1.m1.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>School of Computer Science, McGill University</span></span> <span class="ltx_tr" id="p2.7.7.7.7.7"> <span class="ltx_td ltx_align_center" id="p2.7.7.7.7.7.1"><math alttext="{}^{3}" class="ltx_Math" display="inline" id="p2.7.7.7.7.7.1.m1.1"><semantics id="p2.7.7.7.7.7.1.m1.1a"><msup id="p2.7.7.7.7.7.1.m1.1.1" xref="p2.7.7.7.7.7.1.m1.1.1.cmml"><mi id="p2.7.7.7.7.7.1.m1.1.1a" xref="p2.7.7.7.7.7.1.m1.1.1.cmml"></mi><mn id="p2.7.7.7.7.7.1.m1.1.1.1" xref="p2.7.7.7.7.7.1.m1.1.1.1.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="p2.7.7.7.7.7.1.m1.1b"><apply id="p2.7.7.7.7.7.1.m1.1.1.cmml" xref="p2.7.7.7.7.7.1.m1.1.1"><cn id="p2.7.7.7.7.7.1.m1.1.1.1.cmml" type="integer" xref="p2.7.7.7.7.7.1.m1.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.7.7.7.7.7.1.m1.1c">{}^{3}</annotation><annotation encoding="application/x-llamapun" id="p2.7.7.7.7.7.1.m1.1d">start_FLOATSUPERSCRIPT 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>Mila – Québec AI Institute</span></span> <span class="ltx_tr" id="p2.8.8.8.8.8"> <span class="ltx_td ltx_align_center" id="p2.8.8.8.8.8.1"><math alttext="{}^{4}" class="ltx_Math" display="inline" id="p2.8.8.8.8.8.1.m1.1"><semantics id="p2.8.8.8.8.8.1.m1.1a"><msup id="p2.8.8.8.8.8.1.m1.1.1" xref="p2.8.8.8.8.8.1.m1.1.1.cmml"><mi id="p2.8.8.8.8.8.1.m1.1.1a" xref="p2.8.8.8.8.8.1.m1.1.1.cmml"></mi><mn id="p2.8.8.8.8.8.1.m1.1.1.1" xref="p2.8.8.8.8.8.1.m1.1.1.1.cmml">4</mn></msup><annotation-xml encoding="MathML-Content" id="p2.8.8.8.8.8.1.m1.1b"><apply id="p2.8.8.8.8.8.1.m1.1.1.cmml" xref="p2.8.8.8.8.8.1.m1.1.1"><cn id="p2.8.8.8.8.8.1.m1.1.1.1.cmml" type="integer" xref="p2.8.8.8.8.8.1.m1.1.1.1">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p2.8.8.8.8.8.1.m1.1c">{}^{4}</annotation><annotation encoding="application/x-llamapun" id="p2.8.8.8.8.8.1.m1.1d">start_FLOATSUPERSCRIPT 4 end_FLOATSUPERSCRIPT</annotation></semantics></math>University of California, Riverside</span></span> <span class="ltx_tr" id="p2.8.8.8.8.9.1"> <span class="ltx_td ltx_align_center" id="p2.8.8.8.8.9.1.1"><span class="ltx_text ltx_font_typewriter" id="p2.8.8.8.8.9.1.1.1">jadeleiyu@cs.toronto.edu</span></span></span> <span class="ltx_tr" id="p2.8.8.8.8.10.2"> <span class="ltx_td ltx_align_center" id="p2.8.8.8.8.10.2.1"><span class="ltx_text ltx_font_typewriter" id="p2.8.8.8.8.10.2.1.1">{meng.cao@mail,jcheung@cs}.mcgill.ca</span></span></span> <span class="ltx_tr" id="p2.8.8.8.8.11.3"> <span class="ltx_td ltx_align_center" id="p2.8.8.8.8.11.3.1"><span class="ltx_text ltx_font_typewriter" id="p2.8.8.8.8.11.3.1.1">yue.dong@ucr.edu</span></span></span> </span> </span></span> </span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<span class="ltx_note ltx_role_footnotetext" id="footnotex1"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_note_type">footnotetext: </span>Equal contribution.</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">언어 모델(LMs)은 사전 훈련에서 얻은 매개변수 지식을 통해 상당한 지식 <cite class="ltx_cite ltx_citemacro_cite">Petroni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib40" title="">2019</a>); Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib23" title="">2020</a>); Srivastava et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib42" title="">2023</a>)</cite>의 저장소 역할을 한다. 그러나, 그들은 사실상의 오류를 포함하는 "환각"을 일으키기 쉽다. 로짓 예측 수준에서 이러한 환각은 종종 사실 세대와 유사한 패턴을 나타낸다. 예를 들어, LMs는 실제로 환각 <cite class="ltx_cite ltx_citemacro_cite">Dong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib10" title="">2022</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib58" title="">2023b</a>)</cite>인 겉보기에는 자신 있어 보이는 완성들을 생성하는 것으로 관찰되었다.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">환각이 사실적 출력과 어떻게 다른지, 그리고 그것들이 균일하게 생성되는지 또는 동일하게 수정하기 어려운지를 이해하기 위해서는 정보 흐름을 모니터링하는 철저한 분석 도구가 필요하며, 이는 단지 마지막 계층 예측 <cite class="ltx_cite ltx_citemacro_cite">Kaddour et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib24" title="">2023</a>)</cite>를 넘어 확장된다. 그러나 환각 발생의 내적 메커니즘을 이해하는 연구는 제한적이다. 대부분의 노력은 환각 <cite class="ltx_cite ltx_citemacro_cite">Elaraby et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib11" title="">2023</a>); Mündler et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib34" title="">2023</a>); Manakul et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib30" title="">2023</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib57" title="">2023a</a>)</cite>를 감지하고 완화하는 데 초점을 맞추고 있으며, LM을 블랙박스로 취급하고 예측 불확실성 <cite class="ltx_cite ltx_citemacro_cite">Xiao and Wang (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib54" title="">2021</a>); Varshney et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib48" title="">2023</a>)</cite> 및 논리적 일관성 <cite class="ltx_cite ltx_citemacro_cite">Cohen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib5" title="">2023</a>)</cite>와 같은 외부 특징에 기반한 방법을 고안하고 있다. 불행히도 이러한 접근법은 사실 오류의 내부 메커니즘에 대한 통찰력을 제공하지 않으며 신뢰할 수 없거나 모순된 신호 <cite class="ltx_cite ltx_citemacro_cite">Turpin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib47" title="">2023</a>)</cite>를 전달했다.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">대조적으로, 화이트 박스 환경에서 변압기의 내부 메커니즘을 조사하는 해석 가능성 연구는 최근 사실 예측을 식별하는 데 도움이 되는 구성 요소를 분석하는 데 상당한 관심을 받았다. 그것은 질문에 정확하게 대답하기 위해 필수적인 지식 흐름과 관련된 몇 가지 중요한 모델 "구성 요소"(예: 주의 헤드, 피드포워드 계층)를 식별했다. 그러나 사실 예측에 대한 기계론적 해석 가능성의 결과가 환각에 일반화될 수 있는지는 여전히 의문이다. 구체적으로 어떤 모델 구성 요소가 정상적인 기능을 벗어나 환각을 일으키는지 알 수 없다. LLM에서 사실적 오류의 근원을 로컬화하는 것은 (예를 들어, 환각을 유발하는 것으로 식별된 작은 모델 가중치 세트를 편집함으로써) 환각을 완화하기 위한 표적화되고 효율적인 방법을 설계하는 데 도움이 될 수 있으며, 이는 모델 크기 및 LM의 트레이닝 비용이 급격히 증가하고 있기 때문에 특히 중요하다.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">본 연구에서는 기계론적 해석성 <cite class="ltx_cite ltx_citemacro_cite">Olah (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib38" title="">2022</a>)</cite>를 사용하여 LMs에서 비사실적 환각의 기원과 징후를 조사한다. 우리는 두 가지 확립된 해석 가능성 방법, 즉 인과 매개 분석 <cite class="ltx_cite ltx_citemacro_cite">Pearl (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib39" title="">2001</a>); Vig et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib50" title="">2020</a>)</cite>와 임베딩 공간 투영 <cite class="ltx_cite ltx_citemacro_cite">Geva et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib17" title="">2022b</a>); Dar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib8" title="">2023</a>)</cite>를 사용하여 비사실적 환각 데이터에 대한 모델 구성 요소가 환각 예측에 미치는 영향을 평가한다. 다양한 크기와 구조(Llama-2, GPT-J, GPT-2-XL)의 LMs에 대한 광범위한 분석을 통해, 실제 부정확한 예측에 중요한 두 가지 구성 요소 그룹이 존재한다는 수렴 증거를 얻었다: 1) 하부 변압기 층의 다층 퍼셉트론(MLP), 2) 상부 변압기 층의 주의 헤드 및 MLP.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">그림 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>는 식별된 환각 구성 요소가 서로 다른 행동을 나타내는 두 가지 별개의 시나리오를 보여준다. 일부 예들에서, 하위-계층 MLP들은 정상적으로 기능하여, 질의된 엔티티들에 대한 의미론적 속성들을 성공적으로 검색하는 반면, 상위-계층 주의 헤드들 및 MLP들은 정답으로 이어지는 가장 관련된 속성들을 구별하기 위해 고군분투한다. 다른 경우, 모델은 초기에 팩트 리콜 파이프라인을 실행하지 못하여 하위 계층 MLP에서 유용한 정보를 추출하지 못한다. 또한 이 두 환각 메커니즘이 다양한 외부 징후를 가지고 있으며 피험자-객체 연관 강도의 수준, 입력 섭동에 대한 견고성 및 모델 예측 불확실성으로 구별할 수 있음을 관찰한다. LM 사전 훈련이 사실적 지식을 습득하는 데 중요한 역할에 대해 <cite class="ltx_cite ltx_citemacro_citet">Akyürek et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib1" title="">2022</a>); Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib59" title="">2023</a>)</cite>에 의한 발견에 이어 사전 훈련이 우리가 식별한 다양한 유형의 환각에 미치는 영향도 조사했다. 우리의 연구 결과는 중요하다: 초기 현장 MLP와 후기 현장 주의는 사전 훈련 중에 점진적으로 나타나는 사실 회상을 위한 2단계 파이프라인을 형성하고 두 단계 중 하나를 개발하지 못하면 환각을 초래할 수 있다.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">외부 특징과 높은 상관 관계를 나타내는 내부 지식 흐름 분석을 제공하여 사전 훈련의 다양한 단계에서 다양한 유형의 환각이 어떻게 행동하는지 이해하는 데 도움이 될 뿐만 아니라, 우리의 작업은 실제 응용을 보여준다: 기계론적 해석 가능성 특징은 언어 모델(LMs)에서 사실적 오류의 존재를 탐지하는 데 사용될 수 있다. 이 연구는 체계적인 모듈러 실패로 LM 사실 오류에 대한 최초의 기계론적 설명을 제공하여 모델 설명 가능성과 환각 완화에 대한 연구를 촉진한다.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="221" id="S1.F1.g1" src="https://arxiv.org/html/2403.18167v1/x1.png" width="789">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 1:</span><span class="ltx_text ltx_font_bold" id="S1.F1.13.1">두 가지 비사실적 환각 메커니즘의 주요 발견. <span> <span class="ltx_text ltx_font_bold" id="S1.F1.14.2">Left(a)</span>: <span class="ltx_text ltx_font_bold" id="S1.F1.15.3">early-site 환각</span>은 변압기 LMs의 하위 계층 MLP에서 주제에 대한 일반적인 지식이 부족하여 발생합니다. 이 경우 모델은 엔터티에 대한 유용한 정보(예: <span class="ltx_text ltx_font_italic" id="S1.F1.16.4">Orica</span>, 호주 기반 다국적 기업)를 검색하지 못하여 올바른 객체 속성(예: <span class="ltx_text ltx_font_italic" id="S1.F1.17.5">Australia</span>)을 생성하고, 따라서 관련성이 높은 예측(January)을 출력합니다. <span class="ltx_text ltx_font_bold" id="S1.F1.18.6">Right(b)</span>: The <span class="ltx_text ltx_font_bold" id="S1.F1.19.7">late-site hallucinations</span> is caused by failure of the upper layer attention heads and MLPs to identify the most relevant object to the lower layer MLPs – 이 경우, 모델은 주제에 대한 관련 정보(예: <span class="ltx_text ltx_font_italic" id="S1.F1.20.8">Toulouse</span>, a French city)를 하위 계층 MLPs와 검색할 수 있지만, 관련 없고 강하게 연관된 속성(예: <span class="ltx_text ltx_font_italic" id="S1.F1.21.9">Paris</span>)을 정답(예: <span class="ltx_text ltx_font_italic" id="S1.F1.22.10 우리는 이 두 가지 유형의 환각이 하위 및 상위 계층 LM 구성 요소 간의 모델 예측에 대한 상대적 인과 기여에 의해 구별될 수 있음을 발견했다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Factual knowledge in language models.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">최근 언어 모델(LMs) 내에서 지식 추적에 대한 탐구는 사실 정보를 저장하는 특정 계층 <cite class="ltx_cite ltx_citemacro_citep">(Wallat et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib51" title="">2020</a>; Geva et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib18" title="">2021</a>; Meng et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite>와 뉴런 <cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib7" title="">2022</a>)</cite>를 조사하는 연구자들과 함께 상당한 주목을 받고 있다. 이 탐구 라인은 모델 편집 <cite class="ltx_cite ltx_citemacro_citep">(De Cao et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib9" title="">2021</a>; Mitchell et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib33" title="">2021</a>; Meng et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib32" title="">2022b</a>)</cite> 및 추론 개입 <cite class="ltx_cite ltx_citemacro_citep">(Hernandez et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib21" title="">2023</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib27" title="">2023</a>)</cite>에 대한 기술로 확장된다. <cite class="ltx_cite ltx_citemacro_citet">Geva et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib15" title="">2023</a>); Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib55" title="">2023</a>)</cite>에 의한 최근의 발전은 사실 정보 전달을 위한 내부 파이프라인을 형성하는 중요한 LM 구성 요소를 식별한다. 우리의 프레임워크는 LM 사실 지식 처리에 대한 추가 관점을 제공하여 기존 연구를 보완하며, 손상된 사실 관련 모듈이 환각을 유발할 수 있음을 보여준다.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Hallucinations.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">언어 모델은 <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px2.p1.1.1">unfaithful</span> (i.e. 사용자가 제공한 소스 입력에서 벗어남) 또는 <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px2.p1.1.2">non-factual</span> (i.e. contradicticting established world knowledge) <cite class="ltx_cite ltx_citemacro_cite">Cao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib3" title="">2022a</a>); Ji et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib22" title="">2023</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib58" title="">2023b</a>)</cite>일 수 있다. 여기서는 후자의 환각에 초점을 맞춘다. 기존 연구에서는 환각을 감지하거나 완화하기 위해 내부 활성화 패턴 <cite class="ltx_cite ltx_citemacro_cite">Yuksekgonul et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib56" title="">2023</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib27" title="">2023</a>)</cite>, 예측 신뢰도 <cite class="ltx_cite ltx_citemacro_cite">Cao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib3" title="">2022a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib4" title="">b</a>); Varshney et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib48" title="">2023</a>)</cite>, 생성 일관성 <cite class="ltx_cite ltx_citemacro_cite">Mündler et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib34" title="">2023</a>); Manakul et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib30" title="">2023</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib57" title="">2023a</a>)</cite> 등의 특징을 활용하는 다양한 방법을 제안한다.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Mechanistic interpretability.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">기계적 해석 가능성 <cite class="ltx_cite ltx_citemacro_cite">Olah (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib38" title="">2022</a>); Nanda (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib35" title="">2023</a>)</cite>는 진화하는 연구 분야이다. 최근 연구는 LM 내부 작업을 연구하기 위해 어휘 <cite class="ltx_cite ltx_citemacro_cite">Geva et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib17" title="">2022b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib16" title="">a</a>); Nostalgebraist (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib37" title="">2020</a>); Katz et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib25" title="">2024</a>)</cite>에 대한 투영과 변압기 계산 <cite class="ltx_cite ltx_citemacro_cite">Finlayson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib14" title="">2021</a>); Haviv et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib20" title="">2022</a>); Stolfo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib43" title="">2023</a>); Ghandeharioun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib19" title="">2024</a>)</cite>에 대한 개입을 사용한다. 신경망 학습 역학 <cite class="ltx_cite ltx_citemacro_cite">Nanda et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib36" title="">2022</a>)</cite>를 탐색하고 특정 태스크 <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib53" title="">2022</a>); Conmy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib6" title="">2023</a>)</cite>에 대한 희소 계산 그래프를 발견하기 위해 유사한 기술이 적용되었다. 여러 기계론적 해석 가능성 방법을 활용하여, 우리의 연구는 비사실적 환각에 대한 원칙적인 설명을 제공한다.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Background and Notation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.26">우리는 디코더 전용 변압기 기반 LM의 추론 패스에 대한 상세한 설명을 제공하는 것으로 시작한다. <math alttext="G" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_G</annotation></semantics></math>로 표기되는 자동 회귀 변환기는 입력 토큰 임베딩 <math alttext="E(u)=[e_{1},...,e_{T}]" class="ltx_Math" display="inline" id="S3.p1.3.m3.4"><semantics id="S3.p1.3.m3.4a"><mrow id="S3.p1.3.m3.4.4" xref="S3.p1.3.m3.4.4.cmml"><mrow id="S3.p1.3.m3.4.4.4" xref="S3.p1.3.m3.4.4.4.cmml"><mi id="S3.p1.3.m3.4.4.4.2" xref="S3.p1.3.m3.4.4.4.2.cmml">E</mi><mo id="S3.p1.3.m3.4.4.4.1" xref="S3.p1.3.m3.4.4.4.1.cmml">⁢</mo><mrow id="S3.p1.3.m3.4.4.4.3.2" xref="S3.p1.3.m3.4.4.4.cmml"><mo id="S3.p1.3.m3.4.4.4.3.2.1" stretchy="false" xref="S3.p1.3.m3.4.4.4.cmml">(</mo><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">u</mi><mo id="S3.p1.3.m3.4.4.4.3.2.2" stretchy="false" xref="S3.p1.3.m3.4.4.4.cmml">)</mo></mrow></mrow><mo id="S3.p1.3.m3.4.4.3" xref="S3.p1.3.m3.4.4.3.cmml">=</mo><mrow id="S3.p1.3.m3.4.4.2.2" xref="S3.p1.3.m3.4.4.2.3.cmml"><mo id="S3.p1.3.m3.4.4.2.2.3" stretchy="false" xref="S3.p1.3.m3.4.4.2.3.cmml">[</mo><msub id="S3.p1.3.m3.3.3.1.1.1" xref="S3.p1.3.m3.3.3.1.1.1.cmml"><mi id="S3.p1.3.m3.3.3.1.1.1.2" xref="S3.p1.3.m3.3.3.1.1.1.2.cmml">e</mi><mn id="S3.p1.3.m3.3.3.1.1.1.3" xref="S3.p1.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.3.m3.4.4.2.2.4" xref="S3.p1.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.p1.3.m3.2.2" mathvariant="normal" xref="S3.p1.3.m3.2.2.cmml">…</mi><mo id="S3.p1.3.m3.4.4.2.2.5" xref="S3.p1.3.m3.4.4.2.3.cmml">,</mo><msub id="S3.p1.3.m3.4.4.2.2.2" xref="S3.p1.3.m3.4.4.2.2.2.cmml"><mi id="S3.p1.3.m3.4.4.2.2.2.2" xref="S3.p1.3.m3.4.4.2.2.2.2.cmml">e</mi><mi id="S3.p1.3.m3.4.4.2.2.2.3" xref="S3.p1.3.m3.4.4.2.2.2.3.cmml">T</mi></msub><mo id="S3.p1.3.m3.4.4.2.2.6" stretchy="false" xref="S3.p1.3.m3.4.4.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.4b"><apply id="S3.p1.3.m3.4.4.cmml" xref="S3.p1.3.m3.4.4"><eq id="S3.p1.3.m3.4.4.3.cmml" xref="S3.p1.3.m3.4.4.3"></eq><apply id="S3.p1.3.m3.4.4.4.cmml" xref="S3.p1.3.m3.4.4.4"><times id="S3.p1.3.m3.4.4.4.1.cmml" xref="S3.p1.3.m3.4.4.4.1"></times><ci id="S3.p1.3.m3.4.4.4.2.cmml" xref="S3.p1.3.m3.4.4.4.2">𝐸</ci><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑢</ci></apply><list id="S3.p1.3.m3.4.4.2.3.cmml" xref="S3.p1.3.m3.4.4.2.2"><apply id="S3.p1.3.m3.3.3.1.1.1.cmml" xref="S3.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.p1.3.m3.3.3.1.1.1.2">𝑒</ci><cn id="S3.p1.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S3.p1.3.m3.3.3.1.1.1.3">1</cn></apply><ci id="S3.p1.3.m3.2.2.cmml" xref="S3.p1.3.m3.2.2">…</ci><apply id="S3.p1.3.m3.4.4.2.2.2.cmml" xref="S3.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.4.4.2.2.2.1.cmml" xref="S3.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S3.p1.3.m3.4.4.2.2.2.2.cmml" xref="S3.p1.3.m3.4.4.2.2.2.2">𝑒</ci><ci id="S3.p1.3.m3.4.4.2.2.2.3.cmml" xref="S3.p1.3.m3.4.4.2.2.2.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.4c">E(u)=[e_{1},...,e_{T}]</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.4d">italic_E ( italic_u ) = [ italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_e start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ]</annotation></semantics></math>로 표기되는 토큰 <math alttext="u=[w_{1},...,w_{T}]" class="ltx_Math" display="inline" id="S3.p1.2.m2.3"><semantics id="S3.p1.2.m2.3a"><mrow id="S3.p1.2.m2.3.3" xref="S3.p1.2.m2.3.3.cmml"><mi id="S3.p1.2.m2.3.3.4" xref="S3.p1.2.m2.3.3.4.cmml">u</mi><mo id="S3.p1.2.m2.3.3.3" xref="S3.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.p1.2.m2.3.3.2.2" xref="S3.p1.2.m2.3.3.2.3.cmml"><mo id="S3.p1.2.m2.3.3.2.2.3" stretchy="false" xref="S3.p1.2.m2.3.3.2.3.cmml">[</mo><msub id="S3.p1.2.m2.2.2.1.1.1" xref="S3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.p1.2.m2.2.2.1.1.1.2" xref="S3.p1.2.m2.2.2.1.1.1.2.cmml">w</mi><mn id="S3.p1.2.m2.2.2.1.1.1.3" xref="S3.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.2.m2.3.3.2.2.4" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><mi id="S3.p1.2.m2.1.1" mathvariant="normal" xref="S3.p1.2.m2.1.1.cmml">…</mi><mo id="S3.p1.2.m2.3.3.2.2.5" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.p1.2.m2.3.3.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.p1.2.m2.3.3.2.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.2.cmml">w</mi><mi id="S3.p1.2.m2.3.3.2.2.2.3" xref="S3.p1.2.m2.3.3.2.2.2.3.cmml">T</mi></msub><mo id="S3.p1.2.m2.3.3.2.2.6" stretchy="false" xref="S3.p1.2.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.3b"><apply id="S3.p1.2.m2.3.3.cmml" xref="S3.p1.2.m2.3.3"><eq id="S3.p1.2.m2.3.3.3.cmml" xref="S3.p1.2.m2.3.3.3"></eq><ci id="S3.p1.2.m2.3.3.4.cmml" xref="S3.p1.2.m2.3.3.4">𝑢</ci><list id="S3.p1.2.m2.3.3.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2"><apply id="S3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1.1.2">𝑤</ci><cn id="S3.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">…</ci><apply id="S3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2.2">𝑤</ci><ci id="S3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2.2.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.3c">u=[w_{1},...,w_{T}]</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.3d">italic_u = [ italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_w start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ]</annotation></semantics></math>의 입력 시퀀스를 다음 토큰 예측을 위한 어휘에 걸친 확률 분포로 매핑한다. 트랜스포머 내에서, <math alttext="i" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_i</annotation></semantics></math>-th 토큰은 일련의 숨겨진 상태 <math alttext="h_{i}^{(l)}" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><msubsup id="S3.p1.5.m5.1.2" xref="S3.p1.5.m5.1.2.cmml"><mi id="S3.p1.5.m5.1.2.2.2" xref="S3.p1.5.m5.1.2.2.2.cmml">h</mi><mi id="S3.p1.5.m5.1.2.2.3" xref="S3.p1.5.m5.1.2.2.3.cmml">i</mi><mrow id="S3.p1.5.m5.1.1.1.3" xref="S3.p1.5.m5.1.2.cmml"><mo id="S3.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.p1.5.m5.1.2.cmml">(</mo><mi id="S3.p1.5.m5.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.cmml">l</mi><mo id="S3.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.2.cmml" xref="S3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.2.1.cmml" xref="S3.p1.5.m5.1.2">superscript</csymbol><apply id="S3.p1.5.m5.1.2.2.cmml" xref="S3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.2.2.1.cmml" xref="S3.p1.5.m5.1.2">subscript</csymbol><ci id="S3.p1.5.m5.1.2.2.2.cmml" xref="S3.p1.5.m5.1.2.2.2">ℎ</ci><ci id="S3.p1.5.m5.1.2.2.3.cmml" xref="S3.p1.5.m5.1.2.2.3">𝑖</ci></apply><ci id="S3.p1.5.m5.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">h_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math>로 표현되며, 여기서 각 계층에서 <math alttext="l" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">italic_l</annotation></semantics></math>로부터 두 모듈에 의해 중간 임베딩을 계산하고 추가한다: 1) 집계된 <span class="ltx_text ltx_font_bold" id="S3.p1.26.1">multi-head self-attention module</span> output <math alttext="a^{(l)}_{i}=W_{o}([a_{i}^{(l,0)},...,a_{i}^{(l,K)}])" class="ltx_Math" display="inline" id="S3.p1.8.m8.7"><semantics id="S3.p1.8.m8.7a"><mrow id="S3.p1.8.m8.7.7" xref="S3.p1.8.m8.7.7.cmml"><msubsup id="S3.p1.8.m8.7.7.3" xref="S3.p1.8.m8.7.7.3.cmml"><mi id="S3.p1.8.m8.7.7.3.2.2" xref="S3.p1.8.m8.7.7.3.2.2.cmml">a</mi><mi id="S3.p1.8.m8.7.7.3.3" xref="S3.p1.8.m8.7.7.3.3.cmml">i</mi><mrow id="S3.p1.8.m8.1.1.1.3" xref="S3.p1.8.m8.7.7.3.cmml"><mo id="S3.p1.8.m8.1.1.1.3.1" stretchy="false" xref="S3.p1.8.m8.7.7.3.cmml">(</mo><mi id="S3.p1.8.m8.1.1.1.1" xref="S3.p1.8.m8.1.1.1.1.cmml">l</mi><mo id="S3.p1.8.m8.1.1.1.3.2" stretchy="false" xref="S3.p1.8.m8.7.7.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.8.m8.7.7.2" xref="S3.p1.8.m8.7.7.2.cmml">=</mo><mrow id="S3.p1.8.m8.7.7.1" xref="S3.p1.8.m8.7.7.1.cmml"><msub id="S3.p1.8.m8.7.7.1.3" xref="S3.p1.8.m8.7.7.1.3.cmml"><mi id="S3.p1.8.m8.7.7.1.3.2" xref="S3.p1.8.m8.7.7.1.3.2.cmml">W</mi><mi id="S3.p1.8.m8.7.7.1.3.3" xref="S3.p1.8.m8.7.7.1.3.3.cmml">o</mi></msub><mo id="S3.p1.8.m8.7.7.1.2" xref="S3.p1.8.m8.7.7.1.2.cmml">⁢</mo><mrow id="S3.p1.8.m8.7.7.1.1.1" xref="S3.p1.8.m8.7.7.1.cmml"><mo id="S3.p1.8.m8.7.7.1.1.1.2" stretchy="false" xref="S3.p1.8.m8.7.7.1.cmml">(</mo><mrow id="S3.p1.8.m8.7.7.1.1.1.1.2" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml"><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.3" stretchy="false" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">[</mo><msubsup id="S3.p1.8.m8.7.7.1.1.1.1.1.1" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.cmml"><mi id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.p1.8.m8.3.3.2.4" xref="S3.p1.8.m8.3.3.2.3.cmml"><mo id="S3.p1.8.m8.3.3.2.4.1" stretchy="false" xref="S3.p1.8.m8.3.3.2.3.cmml">(</mo><mi id="S3.p1.8.m8.2.2.1.1" xref="S3.p1.8.m8.2.2.1.1.cmml">l</mi><mo id="S3.p1.8.m8.3.3.2.4.2" xref="S3.p1.8.m8.3.3.2.3.cmml">,</mo><mn id="S3.p1.8.m8.3.3.2.2" xref="S3.p1.8.m8.3.3.2.2.cmml">0</mn><mo id="S3.p1.8.m8.3.3.2.4.3" stretchy="false" xref="S3.p1.8.m8.3.3.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.4" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">,</mo><mi id="S3.p1.8.m8.6.6" mathvariant="normal" xref="S3.p1.8.m8.6.6.cmml">…</mi><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.5" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">,</mo><msubsup id="S3.p1.8.m8.7.7.1.1.1.1.2.2" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.cmml"><mi id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3.cmml">i</mi><mrow id="S3.p1.8.m8.5.5.2.4" xref="S3.p1.8.m8.5.5.2.3.cmml"><mo id="S3.p1.8.m8.5.5.2.4.1" stretchy="false" xref="S3.p1.8.m8.5.5.2.3.cmml">(</mo><mi id="S3.p1.8.m8.4.4.1.1" xref="S3.p1.8.m8.4.4.1.1.cmml">l</mi><mo id="S3.p1.8.m8.5.5.2.4.2" xref="S3.p1.8.m8.5.5.2.3.cmml">,</mo><mi id="S3.p1.8.m8.5.5.2.2" xref="S3.p1.8.m8.5.5.2.2.cmml">K</mi><mo id="S3.p1.8.m8.5.5.2.4.3" stretchy="false" xref="S3.p1.8.m8.5.5.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.6" stretchy="false" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">]</mo></mrow><mo id="S3.p1.8.m8.7.7.1.1.1.3" stretchy="false" xref="S3.p1.8.m8.7.7.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.7b"><apply id="S3.p1.8.m8.7.7.cmml" xref="S3.p1.8.m8.7.7"><eq id="S3.p1.8.m8.7.7.2.cmml" xref="S3.p1.8.m8.7.7.2"></eq><apply id="S3.p1.8.m8.7.7.3.cmml" xref="S3.p1.8.m8.7.7.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.3.1.cmml" xref="S3.p1.8.m8.7.7.3">subscript</csymbol><apply id="S3.p1.8.m8.7.7.3.2.cmml" xref="S3.p1.8.m8.7.7.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.3.2.1.cmml" xref="S3.p1.8.m8.7.7.3">superscript</csymbol><ci id="S3.p1.8.m8.7.7.3.2.2.cmml" xref="S3.p1.8.m8.7.7.3.2.2">𝑎</ci><ci id="S3.p1.8.m8.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1">𝑙</ci></apply><ci id="S3.p1.8.m8.7.7.3.3.cmml" xref="S3.p1.8.m8.7.7.3.3">𝑖</ci></apply><apply id="S3.p1.8.m8.7.7.1.cmml" xref="S3.p1.8.m8.7.7.1"><times id="S3.p1.8.m8.7.7.1.2.cmml" xref="S3.p1.8.m8.7.7.1.2"></times><apply id="S3.p1.8.m8.7.7.1.3.cmml" xref="S3.p1.8.m8.7.7.1.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.3.1.cmml" xref="S3.p1.8.m8.7.7.1.3">subscript</csymbol><ci id="S3.p1.8.m8.7.7.1.3.2.cmml" xref="S3.p1.8.m8.7.7.1.3.2">𝑊</ci><ci id="S3.p1.8.m8.7.7.1.3.3.cmml" xref="S3.p1.8.m8.7.7.1.3.3">𝑜</ci></apply><list id="S3.p1.8.m8.7.7.1.1.1.1.3.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2"><apply id="S3.p1.8.m8.7.7.1.1.1.1.1.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.1.1.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1">superscript</csymbol><apply id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.8.m8.3.3.2.3.cmml" xref="S3.p1.8.m8.3.3.2.4"><ci id="S3.p1.8.m8.2.2.1.1.cmml" xref="S3.p1.8.m8.2.2.1.1">𝑙</ci><cn id="S3.p1.8.m8.3.3.2.2.cmml" type="integer" xref="S3.p1.8.m8.3.3.2.2">0</cn></interval></apply><ci id="S3.p1.8.m8.6.6.cmml" xref="S3.p1.8.m8.6.6">…</ci><apply id="S3.p1.8.m8.7.7.1.1.1.1.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.2.2.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2">superscript</csymbol><apply id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.8.m8.5.5.2.3.cmml" xref="S3.p1.8.m8.5.5.2.4"><ci id="S3.p1.8.m8.4.4.1.1.cmml" xref="S3.p1.8.m8.4.4.1.1">𝑙</ci><ci id="S3.p1.8.m8.5.5.2.2.cmml" xref="S3.p1.8.m8.5.5.2.2">𝐾</ci></interval></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.7c">a^{(l)}_{i}=W_{o}([a_{i}^{(l,0)},...,a_{i}^{(l,K)}])</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.7d">italic_a start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ( [ italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l , 0 ) end_POSTSUPERSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l , italic_K ) end_POSTSUPERSCRIPT ] )</annotation></semantics></math> 여기서 <math alttext="a_{i}^{(l,k)}" class="ltx_Math" display="inline" id="S3.p1.9.m9.2"><semantics id="S3.p1.9.m9.2a"><msubsup id="S3.p1.9.m9.2.3" xref="S3.p1.9.m9.2.3.cmml"><mi id="S3.p1.9.m9.2.3.2.2" xref="S3.p1.9.m9.2.3.2.2.cmml">a</mi><mi id="S3.p1.9.m9.2.3.2.3" xref="S3.p1.9.m9.2.3.2.3.cmml">i</mi><mrow id="S3.p1.9.m9.2.2.2.4" xref="S3.p1.9.m9.2.2.2.3.cmml"><mo id="S3.p1.9.m9.2.2.2.4.1" stretchy="false" xref="S3.p1.9.m9.2.2.2.3.cmml">(</mo><mi id="S3.p1.9.m9.1.1.1.1" xref="S3.p1.9.m9.1.1.1.1.cmml">l</mi><mo id="S3.p1.9.m9.2.2.2.4.2" xref="S3.p1.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.p1.9.m9.2.2.2.2" xref="S3.p1.9.m9.2.2.2.2.cmml">k</mi><mo id="S3.p1.9.m9.2.2.2.4.3" stretchy="false" xref="S3.p1.9.m9.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.2b"><apply id="S3.p1.9.m9.2.3.cmml" xref="S3.p1.9.m9.2.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.2.3.1.cmml" xref="S3.p1.9.m9.2.3">superscript</csymbol><apply id="S3.p1.9.m9.2.3.2.cmml" xref="S3.p1.9.m9.2.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.2.3.2.1.cmml" xref="S3.p1.9.m9.2.3">subscript</csymbol><ci id="S3.p1.9.m9.2.3.2.2.cmml" xref="S3.p1.9.m9.2.3.2.2">𝑎</ci><ci id="S3.p1.9.m9.2.3.2.3.cmml" xref="S3.p1.9.m9.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.9.m9.2.2.2.3.cmml" xref="S3.p1.9.m9.2.2.2.4"><ci id="S3.p1.9.m9.1.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1.1">𝑙</ci><ci id="S3.p1.9.m9.2.2.2.2.cmml" xref="S3.p1.9.m9.2.2.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.2c">a_{i}^{(l,k)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.2d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l , italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math>는 <math alttext="k" class="ltx_Math" display="inline" id="S3.p1.10.m10.1"><semantics id="S3.p1.10.m10.1a"><mi id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><ci id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p1.10.m10.1d">italic_k</annotation></semantics></math> 계층의 <math alttext="l" class="ltx_Math" display="inline" id="S3.p1.11.m11.1"><semantics id="S3.p1.11.m11.1a"><mi id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><ci id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.p1.11.m11.1d">italic_l</annotation></semantics></math>(with <math alttext="K" class="ltx_Math" display="inline" id="S3.p1.12.m12.1"><semantics id="S3.p1.12.m12.1a"><mi id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><ci id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p1.12.m12.1d">italic_K</annotation></semantics></math> heads in total) <math alttext="i" class="ltx_Math" display="inline" id="S3.p1.13.m13.1"><semantics id="S3.p1.13.m13.1a"><mi id="S3.p1.13.m13.1.1" xref="S3.p1.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.1b"><ci id="S3.p1.13.m13.1.1.cmml" xref="S3.p1.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.p1.13.m13.1d">italic_i</annotation></semantics></math>-th 토큰에 대한 <math alttext="W_{o}" class="ltx_Math" display="inline" id="S3.p1.14.m14.1"><semantics id="S3.p1.14.m14.1a"><msub id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml"><mi id="S3.p1.14.m14.1.1.2" xref="S3.p1.14.m14.1.1.2.cmml">W</mi><mi id="S3.p1.14.m14.1.1.3" xref="S3.p1.14.m14.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><apply id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.cmml" xref="S3.p1.14.m14.1.1">subscript</csymbol><ci id="S3.p1.14.m14.1.1.2.cmml" xref="S3.p1.14.m14.1.1.2">𝑊</ci><ci id="S3.p1.14.m14.1.1.3.cmml" xref="S3.p1.14.m14.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">W_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.14.m14.1d">italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math>는 선형 변환이고; 2) <span class="ltx_text ltx_font_bold" id="S3.p1.26.2">multi-layer perceptron (MLP)</span> output <math idx=14></ 종합하면, 숨겨진 표현 <math alttext="h_{i}^{(l)}" class="ltx_Math" display="inline" id="S3.p1.18.m18.1"><semantics id="S3.p1.18.m18.1a"><msubsup id="S3.p1.18.m18.1.2" xref="S3.p1.18.m18.1.2.cmml"><mi id="S3.p1.18.m18.1.2.2.2" xref="S3.p1.18.m18.1.2.2.2.cmml">h</mi><mi id="S3.p1.18.m18.1.2.2.3" xref="S3.p1.18.m18.1.2.2.3.cmml">i</mi><mrow id="S3.p1.18.m18.1.1.1.3" xref="S3.p1.18.m18.1.2.cmml"><mo id="S3.p1.18.m18.1.1.1.3.1" stretchy="false" xref="S3.p1.18.m18.1.2.cmml">(</mo><mi id="S3.p1.18.m18.1.1.1.1" xref="S3.p1.18.m18.1.1.1.1.cmml">l</mi><mo id="S3.p1.18.m18.1.1.1.3.2" stretchy="false" xref="S3.p1.18.m18.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.18.m18.1b"><apply id="S3.p1.18.m18.1.2.cmml" xref="S3.p1.18.m18.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.2.1.cmml" xref="S3.p1.18.m18.1.2">superscript</csymbol><apply id="S3.p1.18.m18.1.2.2.cmml" xref="S3.p1.18.m18.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.2.2.1.cmml" xref="S3.p1.18.m18.1.2">subscript</csymbol><ci id="S3.p1.18.m18.1.2.2.2.cmml" xref="S3.p1.18.m18.1.2.2.2">ℎ</ci><ci id="S3.p1.18.m18.1.2.2.3.cmml" xref="S3.p1.18.m18.1.2.2.3">𝑖</ci></apply><ci id="S3.p1.18.m18.1.1.1.1.cmml" xref="S3.p1.18.m18.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m18.1c">h_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.18.m18.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math>는 다음과 같이 계산된다: <math alttext="h_{i}^{(l)}=h_{i}^{(l-1)}+a^{(l)}_{i}+m_{i}^{(l)}" class="ltx_Math" display="inline" id="S3.p1.19.m19.4"><semantics id="S3.p1.19.m19.4a"><mrow id="S3.p1.19.m19.4.5" xref="S3.p1.19.m19.4.5.cmml"><msubsup id="S3.p1.19.m19.4.5.2" xref="S3.p1.19.m19.4.5.2.cmml"><mi id="S3.p1.19.m19.4.5.2.2.2" xref="S3.p1.19.m19.4.5.2.2.2.cmml">h</mi><mi id="S3.p1.19.m19.4.5.2.2.3" xref="S3.p1.19.m19.4.5.2.2.3.cmml">i</mi><mrow id="S3.p1.19.m19.1.1.1.3" xref="S3.p1.19.m19.4.5.2.cmml"><mo id="S3.p1.19.m19.1.1.1.3.1" stretchy="false" xref="S3.p1.19.m19.4.5.2.cmml">(</mo><mi id="S3.p1.19.m19.1.1.1.1" xref="S3.p1.19.m19.1.1.1.1.cmml">l</mi><mo id="S3.p1.19.m19.1.1.1.3.2" stretchy="false" xref="S3.p1.19.m19.4.5.2.cmml">)</mo></mrow></msubsup><mo id="S3.p1.19.m19.4.5.1" xref="S3.p1.19.m19.4.5.1.cmml">=</mo><mrow id="S3.p1.19.m19.4.5.3" xref="S3.p1.19.m19.4.5.3.cmml"><msubsup id="S3.p1.19.m19.4.5.3.2" xref="S3.p1.19.m19.4.5.3.2.cmml"><mi id="S3.p1.19.m19.4.5.3.2.2.2" xref="S3.p1.19.m19.4.5.3.2.2.2.cmml">h</mi><mi id="S3.p1.19.m19.4.5.3.2.2.3" xref="S3.p1.19.m19.4.5.3.2.2.3.cmml">i</mi><mrow id="S3.p1.19.m19.2.2.1.1" xref="S3.p1.19.m19.2.2.1.1.1.cmml"><mo id="S3.p1.19.m19.2.2.1.1.2" stretchy="false" xref="S3.p1.19.m19.2.2.1.1.1.cmml">(</mo><mrow id="S3.p1.19.m19.2.2.1.1.1" xref="S3.p1.19.m19.2.2.1.1.1.cmml"><mi id="S3.p1.19.m19.2.2.1.1.1.2" xref="S3.p1.19.m19.2.2.1.1.1.2.cmml">l</mi><mo id="S3.p1.19.m19.2.2.1.1.1.1" xref="S3.p1.19.m19.2.2.1.1.1.1.cmml">−</mo><mn id="S3.p1.19.m19.2.2.1.1.1.3" xref="S3.p1.19.m19.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.p1.19.m19.2.2.1.1.3" stretchy="false" xref="S3.p1.19.m19.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.19.m19.4.5.3.1" xref="S3.p1.19.m19.4.5.3.1.cmml">+</mo><msubsup id="S3.p1.19.m19.4.5.3.3" xref="S3.p1.19.m19.4.5.3.3.cmml"><mi id="S3.p1.19.m19.4.5.3.3.2.2" xref="S3.p1.19.m19.4.5.3.3.2.2.cmml">a</mi><mi id="S3.p1.19.m19.4.5.3.3.3" xref="S3.p1.19.m19.4.5.3.3.3.cmml">i</mi><mrow id="S3.p1.19.m19.3.3.1.3" xref="S3.p1.19.m19.4.5.3.3.cmml"><mo id="S3.p1.19.m19.3.3.1.3.1" stretchy="false" xref="S3.p1.19.m19.4.5.3.3.cmml">(</mo><mi id="S3.p1.19.m19.3.3.1.1" xref="S3.p1.19.m19.3.3.1.1.cmml">l</mi><mo id="S3.p1.19.m19.3.3.1.3.2" stretchy="false" xref="S3.p1.19.m19.4.5.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.19.m19.4.5.3.1a" xref="S3.p1.19.m19.4.5.3.1.cmml">+</mo><msubsup id="S3.p1.19.m19.4.5.3.4" xref="S3.p1.19.m19.4.5.3.4.cmml"><mi id="S3.p1.19.m19.4.5.3.4.2.2" xref="S3.p1.19.m19.4.5.3.4.2.2.cmml">m</mi><mi id="S3.p1.19.m19.4.5.3.4.2.3" xref="S3.p1.19.m19.4.5.3.4.2.3.cmml">i</mi><mrow id="S3.p1.19.m19.4.4.1.3" xref="S3.p1.19.m19.4.5.3.4.cmml"><mo id="S3.p1.19.m19.4.4.1.3.1" stretchy="false" xref="S3.p1.19.m19.4.5.3.4.cmml">(</mo><mi id="S3.p1.19.m19.4.4.1.1" xref="S3.p1.19.m19.4.4.1.1.cmml">l</mi><mo id="S3.p1.19.m19.4.4.1.3.2" stretchy="false" xref="S3.p1.19.m19.4.5.3.4.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.19.m19.4b"><apply id="S3.p1.19.m19.4.5.cmml" xref="S3.p1.19.m19.4.5"><eq id="S3.p1.19.m19.4.5.1.cmml" xref="S3.p1.19.m19.4.5.1"></eq><apply id="S3.p1.19.m19.4.5.2.cmml" xref="S3.p1.19.m19.4.5.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.2.1.cmml" xref="S3.p1.19.m19.4.5.2">superscript</csymbol><apply id="S3.p1.19.m19.4.5.2.2.cmml" xref="S3.p1.19.m19.4.5.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.2.2.1.cmml" xref="S3.p1.19.m19.4.5.2">subscript</csymbol><ci id="S3.p1.19.m19.4.5.2.2.2.cmml" xref="S3.p1.19.m19.4.5.2.2.2">ℎ</ci><ci id="S3.p1.19.m19.4.5.2.2.3.cmml" xref="S3.p1.19.m19.4.5.2.2.3">𝑖</ci></apply><ci id="S3.p1.19.m19.1.1.1.1.cmml" xref="S3.p1.19.m19.1.1.1.1">𝑙</ci></apply><apply id="S3.p1.19.m19.4.5.3.cmml" xref="S3.p1.19.m19.4.5.3"><plus id="S3.p1.19.m19.4.5.3.1.cmml" xref="S3.p1.19.m19.4.5.3.1"></plus><apply id="S3.p1.19.m19.4.5.3.2.cmml" xref="S3.p1.19.m19.4.5.3.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.2.1.cmml" xref="S3.p1.19.m19.4.5.3.2">superscript</csymbol><apply id="S3.p1.19.m19.4.5.3.2.2.cmml" xref="S3.p1.19.m19.4.5.3.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.2.2.1.cmml" xref="S3.p1.19.m19.4.5.3.2">subscript</csymbol><ci id="S3.p1.19.m19.4.5.3.2.2.2.cmml" xref="S3.p1.19.m19.4.5.3.2.2.2">ℎ</ci><ci id="S3.p1.19.m19.4.5.3.2.2.3.cmml" xref="S3.p1.19.m19.4.5.3.2.2.3">𝑖</ci></apply><apply id="S3.p1.19.m19.2.2.1.1.1.cmml" xref="S3.p1.19.m19.2.2.1.1"><minus id="S3.p1.19.m19.2.2.1.1.1.1.cmml" xref="S3.p1.19.m19.2.2.1.1.1.1"></minus><ci id="S3.p1.19.m19.2.2.1.1.1.2.cmml" xref="S3.p1.19.m19.2.2.1.1.1.2">𝑙</ci><cn id="S3.p1.19.m19.2.2.1.1.1.3.cmml" type="integer" xref="S3.p1.19.m19.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.p1.19.m19.4.5.3.3.cmml" xref="S3.p1.19.m19.4.5.3.3"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.3.1.cmml" xref="S3.p1.19.m19.4.5.3.3">subscript</csymbol><apply id="S3.p1.19.m19.4.5.3.3.2.cmml" xref="S3.p1.19.m19.4.5.3.3"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.3.2.1.cmml" xref="S3.p1.19.m19.4.5.3.3">superscript</csymbol><ci id="S3.p1.19.m19.4.5.3.3.2.2.cmml" xref="S3.p1.19.m19.4.5.3.3.2.2">𝑎</ci><ci id="S3.p1.19.m19.3.3.1.1.cmml" xref="S3.p1.19.m19.3.3.1.1">𝑙</ci></apply><ci id="S3.p1.19.m19.4.5.3.3.3.cmml" xref="S3.p1.19.m19.4.5.3.3.3">𝑖</ci></apply><apply id="S3.p1.19.m19.4.5.3.4.cmml" xref="S3.p1.19.m19.4.5.3.4"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.4.1.cmml" xref="S3.p1.19.m19.4.5.3.4">superscript</csymbol><apply id="S3.p1.19.m19.4.5.3.4.2.cmml" xref="S3.p1.19.m19.4.5.3.4"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.4.2.1.cmml" xref="S3.p1.19.m19.4.5.3.4">subscript</csymbol><ci id="S3.p1.19.m19.4.5.3.4.2.2.cmml" xref="S3.p1.19.m19.4.5.3.4.2.2">𝑚</ci><ci id="S3.p1.19.m19.4.5.3.4.2.3.cmml" xref="S3.p1.19.m19.4.5.3.4.2.3">𝑖</ci></apply><ci id="S3.p1.19.m19.4.4.1.1.cmml" xref="S3.p1.19.m19.4.4.1.1">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m19.4c">h_{i}^{(l)}=h_{i}^{(l-1)}+a^{(l)}_{i}+m_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.19.m19.4d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT + italic_a start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math>. Let <math alttext="H=\{h^{l}_{i}\}" class="ltx_Math" display="inline" id="S3.p1.20.m20.1"><semantics id="S3.p1.20.m20.1a"><mrow id="S3.p1.20.m20.1.1" xref="S3.p1.20.m20.1.1.cmml"><mi id="S3.p1.20.m20.1.1.3" xref="S3.p1.20.m20.1.1.3.cmml">H</mi><mo id="S3.p1.20.m20.1.1.2" xref="S3.p1.20.m20.1.1.2.cmml">=</mo><mrow id="S3.p1.20.m20.1.1.1.1" xref="S3.p1.20.m20.1.1.1.2.cmml"><mo id="S3.p1.20.m20.1.1.1.1.2" stretchy="false" xref="S3.p1.20.m20.1.1.1.2.cmml">{</mo><msubsup id="S3.p1.20.m20.1.1.1.1.1" xref="S3.p1.20.m20.1.1.1.1.1.cmml"><mi id="S3.p1.20.m20.1.1.1.1.1.2.2" xref="S3.p1.20.m20.1.1.1.1.1.2.2.cmml">h</mi><mi id="S3.p1.20.m20.1.1.1.1.1.3" xref="S3.p1.20.m20.1.1.1.1.1.3.cmml">i</mi><mi id="S3.p1.20.m20.1.1.1.1.1.2.3" xref="S3.p1.20.m20.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.p1.20.m20.1.1.1.1.3" stretchy="false" xref="S3.p1.20.m20.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.20.m20.1b"><apply id="S3.p1.20.m20.1.1.cmml" xref="S3.p1.20.m20.1.1"><eq id="S3.p1.20.m20.1.1.2.cmml" xref="S3.p1.20.m20.1.1.2"></eq><ci id="S3.p1.20.m20.1.1.3.cmml" xref="S3.p1.20.m20.1.1.3">𝐻</ci><set id="S3.p1.20.m20.1.1.1.2.cmml" xref="S3.p1.20.m20.1.1.1.1"><apply id="S3.p1.20.m20.1.1.1.1.1.cmml" xref="S3.p1.20.m20.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.20.m20.1.1.1.1.1.1.cmml" xref="S3.p1.20.m20.1.1.1.1.1">subscript</csymbol><apply id="S3.p1.20.m20.1.1.1.1.1.2.cmml" xref="S3.p1.20.m20.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.20.m20.1.1.1.1.1.2.1.cmml" xref="S3.p1.20.m20.1.1.1.1.1">superscript</csymbol><ci id="S3.p1.20.m20.1.1.1.1.1.2.2.cmml" xref="S3.p1.20.m20.1.1.1.1.1.2.2">ℎ</ci><ci id="S3.p1.20.m20.1.1.1.1.1.2.3.cmml" xref="S3.p1.20.m20.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.p1.20.m20.1.1.1.1.1.3.cmml" xref="S3.p1.20.m20.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.20.m20.1c">H=\{h^{l}_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.20.m20.1d">italic_H = { italic_h start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> is the set of <math alttext="T\times L" class="ltx_Math" display="inline" id="S3.p1.21.m21.1"><semantics id="S3.p1.21.m21.1a"><mrow id="S3.p1.21.m21.1.1" xref="S3.p1.21.m21.1.1.cmml"><mi id="S3.p1.21.m21.1.1.2" xref="S3.p1.21.m21.1.1.2.cmml">T</mi><mo id="S3.p1.21.m21.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.21.m21.1.1.1.cmml">×</mo><mi id="S3.p1.21.m21.1.1.3" xref="S3.p1.21.m21.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.21.m21.1b"><apply id="S3.p1.21.m21.1.1.cmml" xref="S3.p1.21.m21.1.1"><times id="S3.p1.21.m21.1.1.1.cmml" xref="S3.p1.21.m21.1.1.1"></times><ci id="S3.p1.21.m21.1.1.2.cmml" xref="S3.p1.21.m21.1.1.2">𝑇</ci><ci id="S3.p1.21.m21.1.1.3.cmml" xref="S3.p1.21.m21.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.21.m21.1c">T\times L</annotation><annotation encoding="application/x-llamapun" id="S3.p1.21.m21.1d">italic_T × italic_L</annotation></semantics></math> token hidden states across all layers (following <cite class="ltx_cite ltx_citemacro_citet">Elhage et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib13" title="">2021</a>)</cite>, 우리는 그들을 <span class="ltx_text ltx_font_bold" id="S3.p1.26.3">residual stream outputs</span>), <math alttext="A=\{a^{l}_{i}\}" class="ltx_Math" display="inline" id="S3.p1.22.m22.1"><semantics id="S3.p1.22.m22.1a"><mrow id="S3.p1.22.m22.1.1" xref="S3.p1.22.m22.1.1.cmml"><mi id="S3.p1.22.m22.1.1.3" xref="S3.p1.22.m22.1.1.3.cmml">A</mi><mo id="S3.p1.22.m22.1.1.2" xref="S3.p1.22.m22.1.1.2.cmml">=</mo><mrow id="S3.p1.22.m22.1.1.1.1" xref="S3.p1.22.m22.1.1.1.2.cmml"><mo id="S3.p1.22.m22.1.1.1.1.2" stretchy="false" xref="S3.p1.22.m22.1.1.1.2.cmml">{</mo><msubsup id="S3.p1.22.m22.1.1.1.1.1" xref="S3.p1.22.m22.1.1.1.1.1.cmml"><mi id="S3.p1.22.m22.1.1.1.1.1.2.2" xref="S3.p1.22.m22.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.p1.22.m22.1.1.1.1.1.3" xref="S3.p1.22.m22.1.1.1.1.1.3.cmml">i</mi><mi id="S3.p1.22.m22.1.1.1.1.1.2.3" xref="S3.p1.22.m22.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.p1.22.m22.1.1.1.1.3" stretchy="false" xref="S3.p1.22.m22.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.22.m22.1b"><apply id="S3.p1.22.m22.1.1.cmml" xref="S3.p1.22.m22.1.1"><eq id="S3.p1.22.m22.1.1.2.cmml" xref="S3.p1.22.m22.1.1.2"></eq><ci id="S3.p1.22.m22.1.1.3.cmml" xref="S3.p1.22.m22.1.1.3">𝐴</ci><set id="S3.p1.22.m22.1.1.1.2.cmml" xref="S3.p1.22.m22.1.1.1.1"><apply id="S3.p1.22.m22.1.1.1.1.1.cmml" xref="S3.p1.22.m22.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m22.1.1.1.1.1.1.cmml" xref="S3.p1.22.m22.1.1.1.1.1">subscript</csymbol><apply id="S3.p1.22.m22.1.1.1.1.1.2.cmml" xref="S3.p1.22.m22.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m22.1.1.1.1.1.2.1.cmml" xref="S3.p1.22.m22.1.1.1.1.1">superscript</csymbol><ci id="S3.p1.22.m22.1.1.1.1.1.2.2.cmml" xref="S3.p1.22.m22.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.p1.22.m22.1.1.1.1.1.2.3.cmml" xref="S3.p1.22.m22.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.p1.22.m22.1.1.1.1.1.3.cmml" xref="S3.p1.22.m22.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.22.m22.1c">A=\{a^{l}_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.22.m22.1d">italic_A = { italic_a start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> is the set of <math alttext="T\times L" class="ltx_Math" display="inline" id="S3.p1.23.m23.1"><semantics id="S3.p1.23.m23.1a"><mrow id="S3.p1.23.m23.1.1" xref="S3.p1.23.m23.1.1.cmml"><mi id="S3.p1.23.m23.1.1.2" xref="S3.p1.23.m23.1.1.2.cmml">T</mi><mo id="S3.p1.23.m23.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.23.m23.1.1.1.cmml">×</mo><mi id="S3.p1.23.m23.1.1.3" xref="S3.p1.23.m23.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.23.m23.1b"><apply id="S3.p1.23.m23.1.1.cmml" xref="S3.p1.23.m23.1.1"><times id="S3.p1.23.m23.1.1.1.cmml" xref="S3.p1.23.m23.1.1.1"></times><ci id="S3.p1.23.m23.1.1.2.cmml" xref="S3.p1.23.m23.1.1.2">𝑇</ci><ci id="S3.p1.23.m23.1.1.3.cmml" xref="S3.p1.23.m23.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.23.m23.1c">T\times L</annotation><annotation encoding="application/x-llamapun" id="S3.p1.23.m23.1d">italic_T × italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S3.p1.26.4">attention outputs</span> and <math alttext="M=\{m^{(l)}_{i}\}" class="ltx_Math" display="inline" id="S3.p1.24.m24.2"><semantics id="S3.p1.24.m24.2a"><mrow id="S3.p1.24.m24.2.2" xref="S3.p1.24.m24.2.2.cmml"><mi id="S3.p1.24.m24.2.2.3" xref="S3.p1.24.m24.2.2.3.cmml">M</mi><mo id="S3.p1.24.m24.2.2.2" xref="S3.p1.24.m24.2.2.2.cmml">=</mo><mrow id="S3.p1.24.m24.2.2.1.1" xref="S3.p1.24.m24.2.2.1.2.cmml"><mo id="S3.p1.24.m24.2.2.1.1.2" stretchy="false" xref="S3.p1.24.m24.2.2.1.2.cmml">{</mo><msubsup id="S3.p1.24.m24.2.2.1.1.1" xref="S3.p1.24.m24.2.2.1.1.1.cmml"><mi id="S3.p1.24.m24.2.2.1.1.1.2.2" xref="S3.p1.24.m24.2.2.1.1.1.2.2.cmml">m</mi><mi id="S3.p1.24.m24.2.2.1.1.1.3" xref="S3.p1.24.m24.2.2.1.1.1.3.cmml">i</mi><mrow id="S3.p1.24.m24.1.1.1.3" xref="S3.p1.24.m24.2.2.1.1.1.cmml"><mo id="S3.p1.24.m24.1.1.1.3.1" stretchy="false" xref="S3.p1.24.m24.2.2.1.1.1.cmml">(</mo><mi id="S3.p1.24.m24.1.1.1.1" xref="S3.p1.24.m24.1.1.1.1.cmml">l</mi><mo id="S3.p1.24.m24.1.1.1.3.2" stretchy="false" xref="S3.p1.24.m24.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.24.m24.2.2.1.1.3" stretchy="false" xref="S3.p1.24.m24.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.24.m24.2b"><apply id="S3.p1.24.m24.2.2.cmml" xref="S3.p1.24.m24.2.2"><eq id="S3.p1.24.m24.2.2.2.cmml" xref="S3.p1.24.m24.2.2.2"></eq><ci id="S3.p1.24.m24.2.2.3.cmml" xref="S3.p1.24.m24.2.2.3">𝑀</ci><set id="S3.p1.24.m24.2.2.1.2.cmml" xref="S3.p1.24.m24.2.2.1.1"><apply id="S3.p1.24.m24.2.2.1.1.1.cmml" xref="S3.p1.24.m24.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.24.m24.2.2.1.1.1.1.cmml" xref="S3.p1.24.m24.2.2.1.1.1">subscript</csymbol><apply id="S3.p1.24.m24.2.2.1.1.1.2.cmml" xref="S3.p1.24.m24.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.24.m24.2.2.1.1.1.2.1.cmml" xref="S3.p1.24.m24.2.2.1.1.1">superscript</csymbol><ci id="S3.p1.24.m24.2.2.1.1.1.2.2.cmml" xref="S3.p1.24.m24.2.2.1.1.1.2.2">𝑚</ci><ci id="S3.p1.24.m24.1.1.1.1.cmml" xref="S3.p1.24.m24.1.1.1.1">𝑙</ci></apply><ci id="S3.p1.24.m24.2.2.1.1.1.3.cmml" xref="S3.p1.24.m24.2.2.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.24.m24.2c">M=\{m^{(l)}_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.24.m24.2d">italic_M = { italic_m start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> is the set of <math alttext="T\times L" class="ltx_Math" display="inline" id="S3.p1.25.m25.1"><semantics id="S3.p1.25.m25.1a"><mrow id="S3.p1.25.m25.1.1" xref="S3.p1.25.m25.1.1.cmml"><mi id="S3.p1.25.m25.1.1.2" xref="S3.p1.25.m25.1.1.2.cmml">T</mi><mo id="S3.p1.25.m25.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.25.m25.1.1.1.cmml">×</mo><mi id="S3.p1.25.m25.1.1.3" xref="S3.p1.25.m25.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.25.m25.1b"><apply id="S3.p1.25.m25.1.1.cmml" xref="S3.p1.25.m25.1.1"><times id="S3.p1.25.m25.1.1.1.cmml" xref="S3.p1.25.m25.1.1.1"></times><ci id="S3.p1.25.m25.1.1.2.cmml" xref="S3.p1.25.m25.1.1.2">𝑇</ci><ci id="S3.p1.25.m25.1.1.3.cmml" xref="S3.p1.25.m25.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.25.m25.1c">T\times L</annotation><annotation encoding="application/x-llamapun" id="S3.p1.25.m25.1d">italic_T × italic_L</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S3.p1.26.5">MLP outputs</span>. 우리는 어떤 중간 숨겨진 표현 <math alttext="z\in Z=H\bigcup A\bigcup M" class="ltx_Math" display="inline" id="S3.p1.26.m26.1"><semantics id="S3.p1.26.m26.1a"><mrow id="S3.p1.26.m26.1.1" xref="S3.p1.26.m26.1.1.cmml"><mi id="S3.p1.26.m26.1.1.2" xref="S3.p1.26.m26.1.1.2.cmml">z</mi><mo id="S3.p1.26.m26.1.1.3" xref="S3.p1.26.m26.1.1.3.cmml">∈</mo><mi id="S3.p1.26.m26.1.1.4" xref="S3.p1.26.m26.1.1.4.cmml">Z</mi><mo id="S3.p1.26.m26.1.1.5" xref="S3.p1.26.m26.1.1.5.cmml">=</mo><mrow id="S3.p1.26.m26.1.1.6" xref="S3.p1.26.m26.1.1.6.cmml"><mi id="S3.p1.26.m26.1.1.6.2" xref="S3.p1.26.m26.1.1.6.2.cmml">H</mi><mo id="S3.p1.26.m26.1.1.6.1" xref="S3.p1.26.m26.1.1.6.1.cmml">⁢</mo><mrow id="S3.p1.26.m26.1.1.6.3" xref="S3.p1.26.m26.1.1.6.3.cmml"><mo id="S3.p1.26.m26.1.1.6.3.1" xref="S3.p1.26.m26.1.1.6.3.1.cmml">⋃</mo><mrow id="S3.p1.26.m26.1.1.6.3.2" xref="S3.p1.26.m26.1.1.6.3.2.cmml"><mi id="S3.p1.26.m26.1.1.6.3.2.2" xref="S3.p1.26.m26.1.1.6.3.2.2.cmml">A</mi><mo id="S3.p1.26.m26.1.1.6.3.2.1" xref="S3.p1.26.m26.1.1.6.3.2.1.cmml">⁢</mo><mrow id="S3.p1.26.m26.1.1.6.3.2.3" xref="S3.p1.26.m26.1.1.6.3.2.3.cmml"><mo id="S3.p1.26.m26.1.1.6.3.2.3.1" xref="S3.p1.26.m26.1.1.6.3.2.3.1.cmml">⋃</mo><mi id="S3.p1.26.m26.1.1.6.3.2.3.2" xref="S3.p1.26.m26.1.1.6.3.2.3.2.cmml">M</mi></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.26.m26.1b"><apply id="S3.p1.26.m26.1.1.cmml" xref="S3.p1.26.m26.1.1"><and id="S3.p1.26.m26.1.1a.cmml" xref="S3.p1.26.m26.1.1"></and><apply id="S3.p1.26.m26.1.1b.cmml" xref="S3.p1.26.m26.1.1"><in id="S3.p1.26.m26.1.1.3.cmml" xref="S3.p1.26.m26.1.1.3"></in><ci id="S3.p1.26.m26.1.1.2.cmml" xref="S3.p1.26.m26.1.1.2">𝑧</ci><ci id="S3.p1.26.m26.1.1.4.cmml" xref="S3.p1.26.m26.1.1.4">𝑍</ci></apply><apply id="S3.p1.26.m26.1.1c.cmml" xref="S3.p1.26.m26.1.1"><eq id="S3.p1.26.m26.1.1.5.cmml" xref="S3.p1.26.m26.1.1.5"></eq><share href="#S3.p1.26.m26.1.1.4.cmml" id="S3.p1.26.m26.1.1d.cmml" xref="S3.p1.26.m26.1.1"></share><apply id="S3.p1.26.m26.1.1.6.cmml" xref="S3.p1.26.m26.1.1.6"><times id="S3.p1.26.m26.1.1.6.1.cmml" xref="S3.p1.26.m26.1.1.6.1"></times><ci id="S3.p1.26.m26.1.1.6.2.cmml" xref="S3.p1.26.m26.1.1.6.2">𝐻</ci><apply id="S3.p1.26.m26.1.1.6.3.cmml" xref="S3.p1.26.m26.1.1.6.3"><union id="S3.p1.26.m26.1.1.6.3.1.cmml" xref="S3.p1.26.m26.1.1.6.3.1"></union><apply id="S3.p1.26.m26.1.1.6.3.2.cmml" xref="S3.p1.26.m26.1.1.6.3.2"><times id="S3.p1.26.m26.1.1.6.3.2.1.cmml" xref="S3.p1.26.m26.1.1.6.3.2.1"></times><ci id="S3.p1.26.m26.1.1.6.3.2.2.cmml" xref="S3.p1.26.m26.1.1.6.3.2.2">𝐴</ci><apply id="S3.p1.26.m26.1.1.6.3.2.3.cmml" xref="S3.p1.26.m26.1.1.6.3.2.3"><union id="S3.p1.26.m26.1.1.6.3.2.3.1.cmml" xref="S3.p1.26.m26.1.1.6.3.2.3.1"></union><ci id="S3.p1.26.m26.1.1.6.3.2.3.2.cmml" xref="S3.p1.26.m26.1.1.6.3.2.3.2">𝑀</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.26.m26.1c">z\in Z=H\bigcup A\bigcup M</annotation><annotation encoding="application/x-llamapun" id="S3.p1.26.m26.1d">italic_z ∈ italic_Z = italic_H ⋃ italic_A ⋃ italic_M</annotation></semantics></math>가 사실적으로 잘못된 개체의 생성에 인과적으로 기여하는지 조사하는 것을 목표로 한다. 변환기에 대한 자세한 내용은 <cite class="ltx_cite ltx_citemacro_citet">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib49" title="">2017</a>)</cite>를 참조하십시오.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Mechanisms of Hallucinations</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Causal tracing of factual errors</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Method.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.2">모델 추론 중 <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.2.m2.1d">italic_G</annotation></semantics></math>에 의해 생성된 중간 히든 스테이트 <math alttext="H" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">italic_H</annotation></semantics></math>는 입력 시퀀스로부터 출력(다음-토큰 예측)까지의 많은 경로를 포함하는 인과적 종속성 그래프 <cite class="ltx_cite ltx_citemacro_cite">Pearl (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib39" title="">2001</a>)</cite>를 형성하고, 환각을 생성할 때 다른 것들보다 더 중요한 특정 히든 스테이트가 존재하는지를 파악하고자 한다. 이는 인과 그래프에서 중간 변수의 기여도를 정량화하는 <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.2.1">인과 매개 분석</span>에 대한 자연스러운 경우이다. 언어 모델의 인과적 매개 분석에 대한 자세한 내용은 <cite class="ltx_cite ltx_citemacro_citet">Vig et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib50" title="">2020</a>)</cite>를 참조하세요.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p2.11">구조화 질의에 대한 사실적 오픈 도메인 질문의 태스크를 통해 사실적 오류를 유발하는 LM 컴포넌트를 찾기 위해 <cite class="ltx_cite ltx_citemacro_citet">Meng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite>의 프레임워크를 적용한다. 특히, 주제-관계-객체 트리플 <math alttext="(s,r,o)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.1.m1.3"><semantics id="S4.SS1.SSS0.Px1.p2.1.m1.3a"><mrow id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml"><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.2.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.3.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.3.cmml">o</mi><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.4" stretchy="false" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.1.m1.3b"><vector id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2"><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p2.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.2.2">𝑟</ci><ci id="S4.SS1.SSS0.Px1.p2.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.3">𝑜</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.1.m1.3c">(s,r,o)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.1.m1.3d">( italic_s , italic_r , italic_o )</annotation></semantics></math>로 표현된 팩트가 주어지면, 우리는 <math alttext="(s,r)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.4.m4.2"><semantics id="S4.SS1.SSS0.Px1.p2.4.m4.2a"><mrow id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml"><mo id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p2.4.m4.2.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2.3" stretchy="false" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.4.m4.2b"><interval closure="open" id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2"><ci id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p2.4.m4.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.2">𝑟</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.4.m4.2c">(s,r)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.4.m4.2d">( italic_s , italic_r )</annotation></semantics></math>를 포함하는 쿼리 프롬프트 <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p2.3.m3.1a"><mi id="S4.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.3.m3.1b"><ci id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.3.m3.1d">italic_u</annotation></semantics></math>와 함께 LM <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p2.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.2.m2.1d">italic_G</annotation></semantics></math>를 제공한다(예를 들어, “Toulouse is the twin city of __”). <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.5.m5.1"><semantics id="S4.SS1.SSS0.Px1.p2.5.m5.1a"><mi id="S4.SS1.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.5.m5.1b"><ci id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.5.m5.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.5.m5.1d">italic_o</annotation></semantics></math>를 true continuation(예를 들어, “Atlanta”). <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.6.m6.1"><semantics id="S4.SS1.SSS0.Px1.p2.6.m6.1a"><mi id="S4.SS1.SSS0.Px1.p2.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.6.m6.1b"><ci id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.6.m6.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.6.m6.1d">italic_G</annotation></semantics></math>가 잘못된 오브젝트 <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.7.m7.1"><semantics id="S4.SS1.SSS0.Px1.p2.7.m7.1a"><msup id="S4.SS1.SSS0.Px1.p2.7.m7.1.1" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.7.m7.1b"><apply id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.7.m7.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.7.m7.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>를 <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.8.m8.1"><semantics id="S4.SS1.SSS0.Px1.p2.8.m8.1a"><mi id="S4.SS1.SSS0.Px1.p2.8.m8.1.1" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.8.m8.1b"><ci id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.8.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.8.m8.1d">italic_u</annotation></semantics></math>가 주어진 다음 토큰(들)로 예측하는 경우를 살펴보고, <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.9.m9.1"><semantics id="S4.SS1.SSS0.Px1.p2.9.m9.1a"><mi id="S4.SS1.SSS0.Px1.p2.9.m9.1.1" xref="S4.SS1.SSS0.Px1.p2.9.m9.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.9.m9.1b"><ci id="S4.SS1.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.9.m9.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.9.m9.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.9.m9.1d">italic_G</annotation></semantics></math>의 계산 그래프에서 어떤 중간 히든 스테이트가 환각을 유발했는지 찾는 것을 목표로 한다. <math alttext="G" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.10.m10.1"><semantics id="S4.SS1.SSS0.Px1.p2.10.m10.1a"><mi id="S4.SS1.SSS0.Px1.p2.10.m10.1.1" xref="S4.SS1.SSS0.Px1.p2.10.m10.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.10.m10.1b"><ci id="S4.SS1.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.10.m10.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.10.m10.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.10.m10.1d">italic_G</annotation></semantics></math>를 특정 모듈이 정답 <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p2.11.m11.1"><semantics id="S4.SS1.SSS0.Px1.p2.11.m11.1a"><mi id="S4.SS1.SSS0.Px1.p2.11.m11.1.1" xref="S4.SS1.SSS0.Px1.p2.11.m11.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.11.m11.1b"><ci id="S4.SS1.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.11.m11.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.11.m11.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p2.11.m11.1d">italic_o</annotation></semantics></math>로 달리 이어질 수 있는 "clean" 표현을 계산하지 못하는 "corrupted" 모델로 간주하고, 세 가지 모델 실행을 통해 각 모듈의 기여도를 측정한다:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p3">
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.6">In the <span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.6.1">hallucination run</span>, we pass <math alttext="u" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><mi id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><ci id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">italic_u</annotation></semantics></math> into <math alttext="G" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><mi id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><ci id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">italic_G</annotation></semantics></math> and extract all intermediate hidden representations <math alttext="Z" class="ltx_Math" display="inline" id="S4.I1.i1.p1.3.m3.1"><semantics id="S4.I1.i1.p1.3.m3.1a"><mi id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><ci id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.1d">italic_Z</annotation></semantics></math> as defined in Section&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S3" title="3 Background and Notation ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, and compute the log likelihood ratio <math alttext="y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.4.m4.4"><semantics id="S4.I1.i1.p1.4.m4.4a"><mrow id="S4.I1.i1.p1.4.m4.4.5" xref="S4.I1.i1.p1.4.m4.4.5.cmml"><mi id="S4.I1.i1.p1.4.m4.4.5.2" xref="S4.I1.i1.p1.4.m4.4.5.2.cmml">y</mi><mo id="S4.I1.i1.p1.4.m4.4.5.1" xref="S4.I1.i1.p1.4.m4.4.5.1.cmml">=</mo><mrow id="S4.I1.i1.p1.4.m4.4.5.3" xref="S4.I1.i1.p1.4.m4.4.5.3.cmml"><mi id="S4.I1.i1.p1.4.m4.4.5.3.1" xref="S4.I1.i1.p1.4.m4.4.5.3.1.cmml">log</mi><mo id="S4.I1.i1.p1.4.m4.4.5.3a" lspace="0.167em" xref="S4.I1.i1.p1.4.m4.4.5.3.cmml">⁡</mo><mfrac id="S4.I1.i1.p1.4.m4.4.4" xref="S4.I1.i1.p1.4.m4.4.4.cmml"><mrow id="S4.I1.i1.p1.4.m4.2.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.4" xref="S4.I1.i1.p1.4.m4.2.2.2.4.cmml">p</mi><mo id="S4.I1.i1.p1.4.m4.2.2.2.3" xref="S4.I1.i1.p1.4.m4.2.2.2.3.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml"><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml"><msup id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2.cmml">o</mi><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2.cmml">E</mi><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.3.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.3.2.1" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml">(</mo><mi id="S4.I1.i1.p1.4.m4.1.1.1.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.3.2.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.3" stretchy="false" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.I1.i1.p1.4.m4.4.4.4" xref="S4.I1.i1.p1.4.m4.4.4.4.cmml"><mi id="S4.I1.i1.p1.4.m4.4.4.4.4" xref="S4.I1.i1.p1.4.m4.4.4.4.4.cmml">p</mi><mo id="S4.I1.i1.p1.4.m4.4.4.4.3" xref="S4.I1.i1.p1.4.m4.4.4.4.3.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml"><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml">(</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml"><mi id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2.cmml">o</mi><mo fence="false" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mi id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2.cmml">E</mi><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.3.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.3.2.1" stretchy="false" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml">(</mo><mi id="S4.I1.i1.p1.4.m4.3.3.3.1" xref="S4.I1.i1.p1.4.m4.3.3.3.1.cmml">u</mi><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.3.2.2" stretchy="false" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i1.p1.4.m4.4.4.4.2.1.3" stretchy="false" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.4b"><apply id="S4.I1.i1.p1.4.m4.4.5.cmml" xref="S4.I1.i1.p1.4.m4.4.5"><eq id="S4.I1.i1.p1.4.m4.4.5.1.cmml" xref="S4.I1.i1.p1.4.m4.4.5.1"></eq><ci id="S4.I1.i1.p1.4.m4.4.5.2.cmml" xref="S4.I1.i1.p1.4.m4.4.5.2">𝑦</ci><apply id="S4.I1.i1.p1.4.m4.4.5.3.cmml" xref="S4.I1.i1.p1.4.m4.4.5.3"><log id="S4.I1.i1.p1.4.m4.4.5.3.1.cmml" xref="S4.I1.i1.p1.4.m4.4.5.3.1"></log><apply id="S4.I1.i1.p1.4.m4.4.4.cmml" xref="S4.I1.i1.p1.4.m4.4.4"><divide id="S4.I1.i1.p1.4.m4.4.4.5.cmml" xref="S4.I1.i1.p1.4.m4.4.4"></divide><apply id="S4.I1.i1.p1.4.m4.2.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2"><times id="S4.I1.i1.p1.4.m4.2.2.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.3"></times><ci id="S4.I1.i1.p1.4.m4.2.2.2.4.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.4">𝑝</ci><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1">conditional</csymbol><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2">superscript</csymbol><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2">𝑜</ci><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3">′</ci></apply><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3"><times id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1"></times><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2">𝐸</ci><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="S4.I1.i1.p1.4.m4.4.4.4.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4"><times id="S4.I1.i1.p1.4.m4.4.4.4.3.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.3"></times><ci id="S4.I1.i1.p1.4.m4.4.4.4.4.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.4">𝑝</ci><apply id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1"><csymbol cd="latexml" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1">conditional</csymbol><ci id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2">𝑜</ci><apply id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3"><times id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1"></times><ci id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2">𝐸</ci><ci id="S4.I1.i1.p1.4.m4.3.3.3.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.1">𝑢</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.4c">y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.4.m4.4d">italic_y = roman_log divide start_ARG italic_p ( italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_E ( italic_u ) ) end_ARG start_ARG italic_p ( italic_o | italic_E ( italic_u ) ) end_ARG</annotation></semantics></math> between the true and hallucinated objects, which quantifies the “degree of hallucination” of <math alttext="G" class="ltx_Math" display="inline" id="S4.I1.i1.p1.5.m5.1"><semantics id="S4.I1.i1.p1.5.m5.1a"><mi id="S4.I1.i1.p1.5.m5.1.1" xref="S4.I1.i1.p1.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.5.m5.1b"><ci id="S4.I1.i1.p1.5.m5.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.5.m5.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.5.m5.1d">italic_G</annotation></semantics></math>. For a hallucinating prediction, we would observe <math alttext="y>0" class="ltx_Math" display="inline" id="S4.I1.i1.p1.6.m6.1"><semantics id="S4.I1.i1.p1.6.m6.1a"><mrow id="S4.I1.i1.p1.6.m6.1.1" xref="S4.I1.i1.p1.6.m6.1.1.cmml"><mi id="S4.I1.i1.p1.6.m6.1.1.2" xref="S4.I1.i1.p1.6.m6.1.1.2.cmml">y</mi><mo id="S4.I1.i1.p1.6.m6.1.1.1" xref="S4.I1.i1.p1.6.m6.1.1.1.cmml">&gt;</mo><mn id="S4.I1.i1.p1.6.m6.1.1.3" xref="S4.I1.i1.p1.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.6.m6.1b"><apply id="S4.I1.i1.p1.6.m6.1.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1"><gt id="S4.I1.i1.p1.6.m6.1.1.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1.1"></gt><ci id="S4.I1.i1.p1.6.m6.1.1.2.cmml" xref="S4.I1.i1.p1.6.m6.1.1.2">𝑦</ci><cn id="S4.I1.i1.p1.6.m6.1.1.3.cmml" type="integer" xref="S4.I1.i1.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.6.m6.1c">y&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.6.m6.1d">italic_y &gt; 0</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.5">In the <span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.5.1">mitigation run</span>, we follow <cite class="ltx_cite ltx_citemacro_citet">Meng et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite> and add a Gaussian noise <math alttext="\epsilon\sim\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.2"><semantics id="S4.I1.i2.p1.1.m1.2a"><mrow id="S4.I1.i2.p1.1.m1.2.3" xref="S4.I1.i2.p1.1.m1.2.3.cmml"><mi id="S4.I1.i2.p1.1.m1.2.3.2" xref="S4.I1.i2.p1.1.m1.2.3.2.cmml">ϵ</mi><mo id="S4.I1.i2.p1.1.m1.2.3.1" xref="S4.I1.i2.p1.1.m1.2.3.1.cmml">∼</mo><mrow id="S4.I1.i2.p1.1.m1.2.3.3" xref="S4.I1.i2.p1.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.1.m1.2.3.3.2" xref="S4.I1.i2.p1.1.m1.2.3.3.2.cmml">𝒩</mi><mo id="S4.I1.i2.p1.1.m1.2.3.3.1" xref="S4.I1.i2.p1.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.1.m1.2.3.3.3.2" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml"><mo id="S4.I1.i2.p1.1.m1.2.3.3.3.2.1" stretchy="false" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml">(</mo><mn id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">0</mn><mo id="S4.I1.i2.p1.1.m1.2.3.3.3.2.2" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml">,</mo><mn id="S4.I1.i2.p1.1.m1.2.2" xref="S4.I1.i2.p1.1.m1.2.2.cmml">1</mn><mo id="S4.I1.i2.p1.1.m1.2.3.3.3.2.3" stretchy="false" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.2b"><apply id="S4.I1.i2.p1.1.m1.2.3.cmml" xref="S4.I1.i2.p1.1.m1.2.3"><csymbol cd="latexml" id="S4.I1.i2.p1.1.m1.2.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.1">similar-to</csymbol><ci id="S4.I1.i2.p1.1.m1.2.3.2.cmml" xref="S4.I1.i2.p1.1.m1.2.3.2">italic-ϵ</ci><apply id="S4.I1.i2.p1.1.m1.2.3.3.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3"><times id="S4.I1.i2.p1.1.m1.2.3.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3.1"></times><ci id="S4.I1.i2.p1.1.m1.2.3.3.2.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3.2">𝒩</ci><interval closure="open" id="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3.3.2"><cn id="S4.I1.i2.p1.1.m1.1.1.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.1.1">0</cn><cn id="S4.I1.i2.p1.1.m1.2.2.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.2c">\epsilon\sim\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.2d">italic_ϵ ∼ caligraphic_N ( 0 , 1 )</annotation></semantics></math> to the input token embeddings <math alttext="E(u)" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.1"><semantics id="S4.I1.i2.p1.2.m2.1a"><mrow id="S4.I1.i2.p1.2.m2.1.2" xref="S4.I1.i2.p1.2.m2.1.2.cmml"><mi id="S4.I1.i2.p1.2.m2.1.2.2" xref="S4.I1.i2.p1.2.m2.1.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.2.m2.1.2.1" xref="S4.I1.i2.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.2.m2.1.2.3.2" xref="S4.I1.i2.p1.2.m2.1.2.cmml"><mo id="S4.I1.i2.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S4.I1.i2.p1.2.m2.1.2.cmml">(</mo><mi id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">u</mi><mo id="S4.I1.i2.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S4.I1.i2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.2"><times id="S4.I1.i2.p1.2.m2.1.2.1.cmml" xref="S4.I1.i2.p1.2.m2.1.2.1"></times><ci id="S4.I1.i2.p1.2.m2.1.2.2.cmml" xref="S4.I1.i2.p1.2.m2.1.2.2">𝐸</ci><ci id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">E(u)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.1d">italic_E ( italic_u )</annotation></semantics></math>, so that when taking the intervened <math alttext="E^{*}(u)=E(u)+\epsilon" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.2"><semantics id="S4.I1.i2.p1.3.m3.2a"><mrow id="S4.I1.i2.p1.3.m3.2.3" xref="S4.I1.i2.p1.3.m3.2.3.cmml"><mrow id="S4.I1.i2.p1.3.m3.2.3.2" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml"><msup id="S4.I1.i2.p1.3.m3.2.3.2.2" xref="S4.I1.i2.p1.3.m3.2.3.2.2.cmml"><mi id="S4.I1.i2.p1.3.m3.2.3.2.2.2" xref="S4.I1.i2.p1.3.m3.2.3.2.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.3.m3.2.3.2.2.3" xref="S4.I1.i2.p1.3.m3.2.3.2.2.3.cmml">*</mo></msup><mo id="S4.I1.i2.p1.3.m3.2.3.2.1" xref="S4.I1.i2.p1.3.m3.2.3.2.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.3.m3.2.3.2.3.2" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml"><mo id="S4.I1.i2.p1.3.m3.2.3.2.3.2.1" stretchy="false" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml">(</mo><mi id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml">u</mi><mo id="S4.I1.i2.p1.3.m3.2.3.2.3.2.2" stretchy="false" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.I1.i2.p1.3.m3.2.3.1" xref="S4.I1.i2.p1.3.m3.2.3.1.cmml">=</mo><mrow id="S4.I1.i2.p1.3.m3.2.3.3" xref="S4.I1.i2.p1.3.m3.2.3.3.cmml"><mrow id="S4.I1.i2.p1.3.m3.2.3.3.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml"><mi id="S4.I1.i2.p1.3.m3.2.3.3.2.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.3.m3.2.3.3.2.1" xref="S4.I1.i2.p1.3.m3.2.3.3.2.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.3.m3.2.3.3.2.3.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml"><mo id="S4.I1.i2.p1.3.m3.2.3.3.2.3.2.1" stretchy="false" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml">(</mo><mi id="S4.I1.i2.p1.3.m3.2.2" xref="S4.I1.i2.p1.3.m3.2.2.cmml">u</mi><mo id="S4.I1.i2.p1.3.m3.2.3.3.2.3.2.2" stretchy="false" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml">)</mo></mrow></mrow><mo id="S4.I1.i2.p1.3.m3.2.3.3.1" xref="S4.I1.i2.p1.3.m3.2.3.3.1.cmml">+</mo><mi id="S4.I1.i2.p1.3.m3.2.3.3.3" xref="S4.I1.i2.p1.3.m3.2.3.3.3.cmml">ϵ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.2b"><apply id="S4.I1.i2.p1.3.m3.2.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3"><eq id="S4.I1.i2.p1.3.m3.2.3.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.1"></eq><apply id="S4.I1.i2.p1.3.m3.2.3.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2"><times id="S4.I1.i2.p1.3.m3.2.3.2.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.1"></times><apply id="S4.I1.i2.p1.3.m3.2.3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.2.3.2.2.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2">superscript</csymbol><ci id="S4.I1.i2.p1.3.m3.2.3.2.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2.2">𝐸</ci><times id="S4.I1.i2.p1.3.m3.2.3.2.2.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2.3"></times></apply><ci id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">𝑢</ci></apply><apply id="S4.I1.i2.p1.3.m3.2.3.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3"><plus id="S4.I1.i2.p1.3.m3.2.3.3.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.1"></plus><apply id="S4.I1.i2.p1.3.m3.2.3.3.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.2"><times id="S4.I1.i2.p1.3.m3.2.3.3.2.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.2.1"></times><ci id="S4.I1.i2.p1.3.m3.2.3.3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.2.2">𝐸</ci><ci id="S4.I1.i2.p1.3.m3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.2">𝑢</ci></apply><ci id="S4.I1.i2.p1.3.m3.2.3.3.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.2c">E^{*}(u)=E(u)+\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.2d">italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) = italic_E ( italic_u ) + italic_ϵ</annotation></semantics></math> as inputs, the log-likelihood ratio between the hallucinated and the factual object would decrease (i.e., we only take noises with <math alttext="y_{*}=\log\frac{p(o^{\prime}|E^{*}(u))}{p(o|E^{*}(u))}<y" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m4.4"><semantics id="S4.I1.i2.p1.4.m4.4a"><mrow id="S4.I1.i2.p1.4.m4.4.5" xref="S4.I1.i2.p1.4.m4.4.5.cmml"><msub id="S4.I1.i2.p1.4.m4.4.5.2" xref="S4.I1.i2.p1.4.m4.4.5.2.cmml"><mi id="S4.I1.i2.p1.4.m4.4.5.2.2" xref="S4.I1.i2.p1.4.m4.4.5.2.2.cmml">y</mi><mo id="S4.I1.i2.p1.4.m4.4.5.2.3" xref="S4.I1.i2.p1.4.m4.4.5.2.3.cmml">*</mo></msub><mo id="S4.I1.i2.p1.4.m4.4.5.3" xref="S4.I1.i2.p1.4.m4.4.5.3.cmml">=</mo><mrow id="S4.I1.i2.p1.4.m4.4.5.4" xref="S4.I1.i2.p1.4.m4.4.5.4.cmml"><mi id="S4.I1.i2.p1.4.m4.4.5.4.1" xref="S4.I1.i2.p1.4.m4.4.5.4.1.cmml">log</mi><mo id="S4.I1.i2.p1.4.m4.4.5.4a" lspace="0.167em" xref="S4.I1.i2.p1.4.m4.4.5.4.cmml">⁡</mo><mfrac id="S4.I1.i2.p1.4.m4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.cmml"><mrow id="S4.I1.i2.p1.4.m4.2.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.2.4" xref="S4.I1.i2.p1.4.m4.2.2.2.4.cmml">p</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.3" xref="S4.I1.i2.p1.4.m4.2.2.2.3.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml"><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml"><msup id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2.cmml">o</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml"><msup id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3.cmml">*</mo></msup><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.3.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml"><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.3.2.1" stretchy="false" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml">(</mo><mi id="S4.I1.i2.p1.4.m4.1.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.3.2.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.3" stretchy="false" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.I1.i2.p1.4.m4.4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.4.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.4.4.cmml">p</mi><mo id="S4.I1.i2.p1.4.m4.4.4.4.3" xref="S4.I1.i2.p1.4.m4.4.4.4.3.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml"><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2.cmml">o</mi><mo fence="false" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml"><msup id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3.cmml">*</mo></msup><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.3.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml"><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.3.2.1" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml">(</mo><mi id="S4.I1.i2.p1.4.m4.3.3.3.1" xref="S4.I1.i2.p1.4.m4.3.3.3.1.cmml">u</mi><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.3.2.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.3" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S4.I1.i2.p1.4.m4.4.5.5" xref="S4.I1.i2.p1.4.m4.4.5.5.cmml">&lt;</mo><mi id="S4.I1.i2.p1.4.m4.4.5.6" xref="S4.I1.i2.p1.4.m4.4.5.6.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.4b"><apply id="S4.I1.i2.p1.4.m4.4.5.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><and id="S4.I1.i2.p1.4.m4.4.5a.cmml" xref="S4.I1.i2.p1.4.m4.4.5"></and><apply id="S4.I1.i2.p1.4.m4.4.5b.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><eq id="S4.I1.i2.p1.4.m4.4.5.3.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3"></eq><apply id="S4.I1.i2.p1.4.m4.4.5.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.4.5.2.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2">subscript</csymbol><ci id="S4.I1.i2.p1.4.m4.4.5.2.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2.2">𝑦</ci><times id="S4.I1.i2.p1.4.m4.4.5.2.3.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2.3"></times></apply><apply id="S4.I1.i2.p1.4.m4.4.5.4.cmml" xref="S4.I1.i2.p1.4.m4.4.5.4"><log id="S4.I1.i2.p1.4.m4.4.5.4.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.4.1"></log><apply id="S4.I1.i2.p1.4.m4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4"><divide id="S4.I1.i2.p1.4.m4.4.4.5.cmml" xref="S4.I1.i2.p1.4.m4.4.4"></divide><apply id="S4.I1.i2.p1.4.m4.2.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2"><times id="S4.I1.i2.p1.4.m4.2.2.2.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.3"></times><ci id="S4.I1.i2.p1.4.m4.2.2.2.4.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.4">𝑝</ci><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1">conditional</csymbol><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2">𝑜</ci><ci id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3">′</ci></apply><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3"><times id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1"></times><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2">𝐸</ci><times id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3"></times></apply><ci id="S4.I1.i2.p1.4.m4.1.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="S4.I1.i2.p1.4.m4.4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4"><times id="S4.I1.i2.p1.4.m4.4.4.4.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.3"></times><ci id="S4.I1.i2.p1.4.m4.4.4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.4">𝑝</ci><apply id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1"><csymbol cd="latexml" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1">conditional</csymbol><ci id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2">𝑜</ci><apply id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3"><times id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1"></times><apply id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2">𝐸</ci><times id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3"></times></apply><ci id="S4.I1.i2.p1.4.m4.3.3.3.1.cmml" xref="S4.I1.i2.p1.4.m4.3.3.3.1">𝑢</ci></apply></apply></apply></apply></apply></apply><apply id="S4.I1.i2.p1.4.m4.4.5c.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><lt id="S4.I1.i2.p1.4.m4.4.5.5.cmml" xref="S4.I1.i2.p1.4.m4.4.5.5"></lt><share href="#S4.I1.i2.p1.4.m4.4.5.4.cmml" id="S4.I1.i2.p1.4.m4.4.5d.cmml" xref="S4.I1.i2.p1.4.m4.4.5"></share><ci id="S4.I1.i2.p1.4.m4.4.5.6.cmml" xref="S4.I1.i2.p1.4.m4.4.5.6">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.4c">y_{*}=\log\frac{p(o^{\prime}|E^{*}(u))}{p(o|E^{*}(u))}&lt;y</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m4.4d">italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT = roman_log divide start_ARG italic_p ( italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) ) end_ARG start_ARG italic_p ( italic_o | italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) ) end_ARG &lt; italic_y</annotation></semantics></math>, indicating that the model becomes more “truthful” after noise injections). We again extract all intermediate hidden representations, denoted as <math alttext="Z^{*}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.5.m5.1"><semantics id="S4.I1.i2.p1.5.m5.1a"><msup id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.2" xref="S4.I1.i2.p1.5.m5.1.1.2.cmml">Z</mi><mo id="S4.I1.i2.p1.5.m5.1.1.3" xref="S4.I1.i2.p1.5.m5.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><apply id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.5.m5.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">superscript</csymbol><ci id="S4.I1.i2.p1.5.m5.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.2">𝑍</ci><times id="S4.I1.i2.p1.5.m5.1.1.3.cmml" xref="S4.I1.i2.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">Z^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.5.m5.1d">italic_Z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.7">In the <span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.7.1">mitigation-with-hallucination-state run</span>, we run <math alttext="G" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.1"><semantics id="S4.I1.i3.p1.1.m1.1a"><mi id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><ci id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.1d">italic_G</annotation></semantics></math> on <math alttext="u" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.m2.1"><semantics id="S4.I1.i3.p1.2.m2.1a"><mi id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><ci id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.m2.1d">italic_u</annotation></semantics></math> with perturbed input embeddings <math alttext="E^{*}(u)" class="ltx_Math" display="inline" id="S4.I1.i3.p1.3.m3.1"><semantics id="S4.I1.i3.p1.3.m3.1a"><mrow id="S4.I1.i3.p1.3.m3.1.2" xref="S4.I1.i3.p1.3.m3.1.2.cmml"><msup id="S4.I1.i3.p1.3.m3.1.2.2" xref="S4.I1.i3.p1.3.m3.1.2.2.cmml"><mi id="S4.I1.i3.p1.3.m3.1.2.2.2" xref="S4.I1.i3.p1.3.m3.1.2.2.2.cmml">E</mi><mo id="S4.I1.i3.p1.3.m3.1.2.2.3" xref="S4.I1.i3.p1.3.m3.1.2.2.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.3.m3.1.2.1" xref="S4.I1.i3.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.I1.i3.p1.3.m3.1.2.3.2" xref="S4.I1.i3.p1.3.m3.1.2.cmml"><mo id="S4.I1.i3.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S4.I1.i3.p1.3.m3.1.2.cmml">(</mo><mi id="S4.I1.i3.p1.3.m3.1.1" xref="S4.I1.i3.p1.3.m3.1.1.cmml">u</mi><mo id="S4.I1.i3.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S4.I1.i3.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m3.1b"><apply id="S4.I1.i3.p1.3.m3.1.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2"><times id="S4.I1.i3.p1.3.m3.1.2.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.1"></times><apply id="S4.I1.i3.p1.3.m3.1.2.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.3.m3.1.2.2.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2">superscript</csymbol><ci id="S4.I1.i3.p1.3.m3.1.2.2.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.2">𝐸</ci><times id="S4.I1.i3.p1.3.m3.1.2.2.3.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.3"></times></apply><ci id="S4.I1.i3.p1.3.m3.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m3.1c">E^{*}(u)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.3.m3.1d">italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u )</annotation></semantics></math> as in the mitigation run, and hook <math alttext="G" class="ltx_Math" display="inline" id="S4.I1.i3.p1.4.m4.1"><semantics id="S4.I1.i3.p1.4.m4.1a"><mi id="S4.I1.i3.p1.4.m4.1.1" xref="S4.I1.i3.p1.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.4.m4.1b"><ci id="S4.I1.i3.p1.4.m4.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.4.m4.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.4.m4.1d">italic_G</annotation></semantics></math> by forcing a particular hidden representation <math alttext="z^{*}\in Z^{*}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.5.m5.1"><semantics id="S4.I1.i3.p1.5.m5.1a"><mrow id="S4.I1.i3.p1.5.m5.1.1" xref="S4.I1.i3.p1.5.m5.1.1.cmml"><msup id="S4.I1.i3.p1.5.m5.1.1.2" xref="S4.I1.i3.p1.5.m5.1.1.2.cmml"><mi id="S4.I1.i3.p1.5.m5.1.1.2.2" xref="S4.I1.i3.p1.5.m5.1.1.2.2.cmml">z</mi><mo id="S4.I1.i3.p1.5.m5.1.1.2.3" xref="S4.I1.i3.p1.5.m5.1.1.2.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.5.m5.1.1.1" xref="S4.I1.i3.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.I1.i3.p1.5.m5.1.1.3" xref="S4.I1.i3.p1.5.m5.1.1.3.cmml"><mi id="S4.I1.i3.p1.5.m5.1.1.3.2" xref="S4.I1.i3.p1.5.m5.1.1.3.2.cmml">Z</mi><mo id="S4.I1.i3.p1.5.m5.1.1.3.3" xref="S4.I1.i3.p1.5.m5.1.1.3.3.cmml">*</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.5.m5.1b"><apply id="S4.I1.i3.p1.5.m5.1.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1"><in id="S4.I1.i3.p1.5.m5.1.1.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1.1"></in><apply id="S4.I1.i3.p1.5.m5.1.1.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.5.m5.1.1.2.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2">superscript</csymbol><ci id="S4.I1.i3.p1.5.m5.1.1.2.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2.2">𝑧</ci><times id="S4.I1.i3.p1.5.m5.1.1.2.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2.3"></times></apply><apply id="S4.I1.i3.p1.5.m5.1.1.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.5.m5.1.1.3.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.I1.i3.p1.5.m5.1.1.3.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3.2">𝑍</ci><times id="S4.I1.i3.p1.5.m5.1.1.3.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.5.m5.1c">z^{*}\in Z^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.5.m5.1d">italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ∈ italic_Z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math> to be the hidden representation <math alttext="z" class="ltx_Math" display="inline" id="S4.I1.i3.p1.6.m6.1"><semantics id="S4.I1.i3.p1.6.m6.1a"><mi id="S4.I1.i3.p1.6.m6.1.1" xref="S4.I1.i3.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.6.m6.1b"><ci id="S4.I1.i3.p1.6.m6.1.1.cmml" xref="S4.I1.i3.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.6.m6.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.6.m6.1d">italic_z</annotation></semantics></math> during the hallucination run. We then compute the log likelihood ratio <math alttext="y_{E^{*},z}=\log\frac{p(o^{\prime}|E^{*}(u),z)}{p(o|E^{*}(u),z)}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.7.m7.8"><semantics id="S4.I1.i3.p1.7.m7.8a"><mrow id="S4.I1.i3.p1.7.m7.8.9" xref="S4.I1.i3.p1.7.m7.8.9.cmml"><msub id="S4.I1.i3.p1.7.m7.8.9.2" xref="S4.I1.i3.p1.7.m7.8.9.2.cmml"><mi id="S4.I1.i3.p1.7.m7.8.9.2.2" xref="S4.I1.i3.p1.7.m7.8.9.2.2.cmml">y</mi><mrow id="S4.I1.i3.p1.7.m7.2.2.2.2" xref="S4.I1.i3.p1.7.m7.2.2.2.3.cmml"><msup id="S4.I1.i3.p1.7.m7.2.2.2.2.1" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.cmml"><mi id="S4.I1.i3.p1.7.m7.2.2.2.2.1.2" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.2.cmml">E</mi><mo id="S4.I1.i3.p1.7.m7.2.2.2.2.1.3" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.7.m7.2.2.2.2.2" xref="S4.I1.i3.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="S4.I1.i3.p1.7.m7.1.1.1.1" xref="S4.I1.i3.p1.7.m7.1.1.1.1.cmml">z</mi></mrow></msub><mo id="S4.I1.i3.p1.7.m7.8.9.1" xref="S4.I1.i3.p1.7.m7.8.9.1.cmml">=</mo><mrow id="S4.I1.i3.p1.7.m7.8.9.3" xref="S4.I1.i3.p1.7.m7.8.9.3.cmml"><mi id="S4.I1.i3.p1.7.m7.8.9.3.1" xref="S4.I1.i3.p1.7.m7.8.9.3.1.cmml">log</mi><mo id="S4.I1.i3.p1.7.m7.8.9.3a" lspace="0.167em" xref="S4.I1.i3.p1.7.m7.8.9.3.cmml">⁡</mo><mfrac id="S4.I1.i3.p1.7.m7.8.8" xref="S4.I1.i3.p1.7.m7.8.8.cmml"><mrow id="S4.I1.i3.p1.7.m7.5.5.3" xref="S4.I1.i3.p1.7.m7.5.5.3.cmml"><mi id="S4.I1.i3.p1.7.m7.5.5.3.5" xref="S4.I1.i3.p1.7.m7.5.5.3.5.cmml">p</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.4" xref="S4.I1.i3.p1.7.m7.5.5.3.4.cmml">⁢</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml"><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.2" stretchy="false" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml">(</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml"><msup id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.cmml"><mi id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2.cmml">o</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3.cmml">′</mo></msup><mo fence="false" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2.cmml">|</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.2.cmml"><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml"><msup id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.cmml"><mi id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2.cmml">E</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.3.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml"><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml">(</mo><mi id="S4.I1.i3.p1.7.m7.3.3.1.1" xref="S4.I1.i3.p1.7.m7.3.3.1.1.cmml">u</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.2.cmml">,</mo><mi id="S4.I1.i3.p1.7.m7.4.4.2.2" xref="S4.I1.i3.p1.7.m7.4.4.2.2.cmml">z</mi></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.3" stretchy="false" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.I1.i3.p1.7.m7.8.8.6" xref="S4.I1.i3.p1.7.m7.8.8.6.cmml"><mi id="S4.I1.i3.p1.7.m7.8.8.6.5" xref="S4.I1.i3.p1.7.m7.8.8.6.5.cmml">p</mi><mo id="S4.I1.i3.p1.7.m7.8.8.6.4" xref="S4.I1.i3.p1.7.m7.8.8.6.4.cmml">⁢</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml"><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.2" stretchy="false" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml">(</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml"><mi id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3.cmml">o</mi><mo fence="false" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2.cmml">|</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.2.cmml"><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml"><msup id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.cmml"><mi id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2.cmml">E</mi><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3.cmml">*</mo></msup><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.3.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml"><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml">(</mo><mi id="S4.I1.i3.p1.7.m7.6.6.4.1" xref="S4.I1.i3.p1.7.m7.6.6.4.1.cmml">u</mi><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.2.cmml">,</mo><mi id="S4.I1.i3.p1.7.m7.7.7.5.2" xref="S4.I1.i3.p1.7.m7.7.7.5.2.cmml">z</mi></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.3" stretchy="false" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.7.m7.8b"><apply id="S4.I1.i3.p1.7.m7.8.9.cmml" xref="S4.I1.i3.p1.7.m7.8.9"><eq id="S4.I1.i3.p1.7.m7.8.9.1.cmml" xref="S4.I1.i3.p1.7.m7.8.9.1"></eq><apply id="S4.I1.i3.p1.7.m7.8.9.2.cmml" xref="S4.I1.i3.p1.7.m7.8.9.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.8.9.2.1.cmml" xref="S4.I1.i3.p1.7.m7.8.9.2">subscript</csymbol><ci id="S4.I1.i3.p1.7.m7.8.9.2.2.cmml" xref="S4.I1.i3.p1.7.m7.8.9.2.2">𝑦</ci><list id="S4.I1.i3.p1.7.m7.2.2.2.3.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2"><apply id="S4.I1.i3.p1.7.m7.2.2.2.2.1.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.2.2.2.2.1.1.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.2.2.2.2.1.2.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.2">𝐸</ci><times id="S4.I1.i3.p1.7.m7.2.2.2.2.1.3.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.3"></times></apply><ci id="S4.I1.i3.p1.7.m7.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.1.1.1.1">𝑧</ci></list></apply><apply id="S4.I1.i3.p1.7.m7.8.9.3.cmml" xref="S4.I1.i3.p1.7.m7.8.9.3"><log id="S4.I1.i3.p1.7.m7.8.9.3.1.cmml" xref="S4.I1.i3.p1.7.m7.8.9.3.1"></log><apply id="S4.I1.i3.p1.7.m7.8.8.cmml" xref="S4.I1.i3.p1.7.m7.8.8"><divide id="S4.I1.i3.p1.7.m7.8.8.7.cmml" xref="S4.I1.i3.p1.7.m7.8.8"></divide><apply id="S4.I1.i3.p1.7.m7.5.5.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3"><times id="S4.I1.i3.p1.7.m7.5.5.3.4.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.4"></times><ci id="S4.I1.i3.p1.7.m7.5.5.3.5.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.5">𝑝</ci><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1"><csymbol cd="latexml" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2">conditional</csymbol><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2">𝑜</ci><ci id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3">′</ci></apply><list id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1"><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1"><times id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1"></times><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2">𝐸</ci><times id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3"></times></apply><ci id="S4.I1.i3.p1.7.m7.3.3.1.1.cmml" xref="S4.I1.i3.p1.7.m7.3.3.1.1">𝑢</ci></apply><ci id="S4.I1.i3.p1.7.m7.4.4.2.2.cmml" xref="S4.I1.i3.p1.7.m7.4.4.2.2">𝑧</ci></list></apply></apply><apply id="S4.I1.i3.p1.7.m7.8.8.6.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6"><times id="S4.I1.i3.p1.7.m7.8.8.6.4.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.4"></times><ci id="S4.I1.i3.p1.7.m7.8.8.6.5.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.5">𝑝</ci><apply id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1"><csymbol cd="latexml" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2">conditional</csymbol><ci id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3">𝑜</ci><list id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1"><apply id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1"><times id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1"></times><apply id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2">𝐸</ci><times id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3"></times></apply><ci id="S4.I1.i3.p1.7.m7.6.6.4.1.cmml" xref="S4.I1.i3.p1.7.m7.6.6.4.1">𝑢</ci></apply><ci id="S4.I1.i3.p1.7.m7.7.7.5.2.cmml" xref="S4.I1.i3.p1.7.m7.7.7.5.2">𝑧</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.7.m7.8c">y_{E^{*},z}=\log\frac{p(o^{\prime}|E^{*}(u),z)}{p(o|E^{*}(u),z)}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.7.m7.8d">italic_y start_POSTSUBSCRIPT italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT , italic_z end_POSTSUBSCRIPT = roman_log divide start_ARG italic_p ( italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) , italic_z ) end_ARG start_ARG italic_p ( italic_o | italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u ) , italic_z ) end_ARG</annotation></semantics></math> to see how it changes compared to step 2. </p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="161" id="S4.F2.g1" src="https://arxiv.org/html/2403.18167v1/x2.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 2:</span><span class="ltx_text ltx_font_bold" id="S4.F2.4.1">Average Indirect Effect(AIE)</span> of hidden representations produced by non-factual 환각 over ParaRel queries is incorrectly answered by Llama-2-7b-chat. 초기 사이트와 후기 사이트 환각을 구별하는 상대적 간접 효과 메트릭 <math alttext="\Delta\overline{\text{IE}}(y,u)" class="ltx_Math" display="inline" id="S4.F2.2.m1.2"><semantics id="S4.F2.2.m1.2b"><mrow id="S4.F2.2.m1.2.3" xref="S4.F2.2.m1.2.3.cmml"><mi id="S4.F2.2.m1.2.3.2" mathvariant="normal" xref="S4.F2.2.m1.2.3.2.cmml">Δ</mi><mo id="S4.F2.2.m1.2.3.1" xref="S4.F2.2.m1.2.3.1.cmml">⁢</mo><mover accent="true" id="S4.F2.2.m1.2.3.3" xref="S4.F2.2.m1.2.3.3.cmml"><mtext id="S4.F2.2.m1.2.3.3.2" xref="S4.F2.2.m1.2.3.3.2a.cmml">IE</mtext><mo id="S4.F2.2.m1.2.3.3.1" xref="S4.F2.2.m1.2.3.3.1.cmml">¯</mo></mover><mo id="S4.F2.2.m1.2.3.1b" xref="S4.F2.2.m1.2.3.1.cmml">⁢</mo><mrow id="S4.F2.2.m1.2.3.4.2" xref="S4.F2.2.m1.2.3.4.1.cmml"><mo id="S4.F2.2.m1.2.3.4.2.1" stretchy="false" xref="S4.F2.2.m1.2.3.4.1.cmml">(</mo><mi id="S4.F2.2.m1.1.1" xref="S4.F2.2.m1.1.1.cmml">y</mi><mo id="S4.F2.2.m1.2.3.4.2.2" xref="S4.F2.2.m1.2.3.4.1.cmml">,</mo><mi id="S4.F2.2.m1.2.2" xref="S4.F2.2.m1.2.2.cmml">u</mi><mo id="S4.F2.2.m1.2.3.4.2.3" stretchy="false" xref="S4.F2.2.m1.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.2.m1.2c"><apply id="S4.F2.2.m1.2.3.cmml" xref="S4.F2.2.m1.2.3"><times id="S4.F2.2.m1.2.3.1.cmml" xref="S4.F2.2.m1.2.3.1"></times><ci id="S4.F2.2.m1.2.3.2.cmml" xref="S4.F2.2.m1.2.3.2">Δ</ci><apply id="S4.F2.2.m1.2.3.3.cmml" xref="S4.F2.2.m1.2.3.3"><ci id="S4.F2.2.m1.2.3.3.1.cmml" xref="S4.F2.2.m1.2.3.3.1">¯</ci><ci id="S4.F2.2.m1.2.3.3.2a.cmml" xref="S4.F2.2.m1.2.3.3.2"><mtext id="S4.F2.2.m1.2.3.3.2.cmml" xref="S4.F2.2.m1.2.3.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.F2.2.m1.2.3.4.1.cmml" xref="S4.F2.2.m1.2.3.4.2"><ci id="S4.F2.2.m1.1.1.cmml" xref="S4.F2.2.m1.1.1">𝑦</ci><ci id="S4.F2.2.m1.2.2.cmml" xref="S4.F2.2.m1.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.2.m1.2d">\Delta\overline{\text{IE}}(y,u)</annotation><annotation encoding="application/x-llamapun" id="S4.F2.2.m1.2e">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u )</annotation></semantics></math>는 1) 상위 계층 주의/MLPs(파란색 점선 박스)에 의한 마지막 관계 토큰의 숨겨진 표현과 2) 하위 계층 주의/MLPs(빨간색 점선 박스)에 의한 첫 번째 주제 토큰의 숨겨진 표현 사이의 차이로 정의된다.</figcaption>
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="S4.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="864" id="S4.F2.sf1.g1" src="https://arxiv.org/html/2403.18167v1/x3.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Early-site hallucinations (<math alttext="\Delta\overline{\text{IE}}(y,u)<0" class="ltx_Math" display="inline" id="S4.F2.sf1.2.m1.2"><semantics id="S4.F2.sf1.2.m1.2b"><mrow id="S4.F2.sf1.2.m1.2.3" xref="S4.F2.sf1.2.m1.2.3.cmml"><mrow id="S4.F2.sf1.2.m1.2.3.2" xref="S4.F2.sf1.2.m1.2.3.2.cmml"><mi id="S4.F2.sf1.2.m1.2.3.2.2" mathvariant="normal" xref="S4.F2.sf1.2.m1.2.3.2.2.cmml">Δ</mi><mo id="S4.F2.sf1.2.m1.2.3.2.1" xref="S4.F2.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mover accent="true" id="S4.F2.sf1.2.m1.2.3.2.3" xref="S4.F2.sf1.2.m1.2.3.2.3.cmml"><mtext id="S4.F2.sf1.2.m1.2.3.2.3.2" xref="S4.F2.sf1.2.m1.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.F2.sf1.2.m1.2.3.2.3.1" xref="S4.F2.sf1.2.m1.2.3.2.3.1.cmml">¯</mo></mover><mo id="S4.F2.sf1.2.m1.2.3.2.1b" xref="S4.F2.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="S4.F2.sf1.2.m1.2.3.2.4.2" xref="S4.F2.sf1.2.m1.2.3.2.4.1.cmml"><mo id="S4.F2.sf1.2.m1.2.3.2.4.2.1" stretchy="false" xref="S4.F2.sf1.2.m1.2.3.2.4.1.cmml">(</mo><mi id="S4.F2.sf1.2.m1.1.1" xref="S4.F2.sf1.2.m1.1.1.cmml">y</mi><mo id="S4.F2.sf1.2.m1.2.3.2.4.2.2" xref="S4.F2.sf1.2.m1.2.3.2.4.1.cmml">,</mo><mi id="S4.F2.sf1.2.m1.2.2" xref="S4.F2.sf1.2.m1.2.2.cmml">u</mi><mo id="S4.F2.sf1.2.m1.2.3.2.4.2.3" stretchy="false" xref="S4.F2.sf1.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.F2.sf1.2.m1.2.3.1" xref="S4.F2.sf1.2.m1.2.3.1.cmml">&lt;</mo><mn id="S4.F2.sf1.2.m1.2.3.3" xref="S4.F2.sf1.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf1.2.m1.2c"><apply id="S4.F2.sf1.2.m1.2.3.cmml" xref="S4.F2.sf1.2.m1.2.3"><lt id="S4.F2.sf1.2.m1.2.3.1.cmml" xref="S4.F2.sf1.2.m1.2.3.1"></lt><apply id="S4.F2.sf1.2.m1.2.3.2.cmml" xref="S4.F2.sf1.2.m1.2.3.2"><times id="S4.F2.sf1.2.m1.2.3.2.1.cmml" xref="S4.F2.sf1.2.m1.2.3.2.1"></times><ci id="S4.F2.sf1.2.m1.2.3.2.2.cmml" xref="S4.F2.sf1.2.m1.2.3.2.2">Δ</ci><apply id="S4.F2.sf1.2.m1.2.3.2.3.cmml" xref="S4.F2.sf1.2.m1.2.3.2.3"><ci id="S4.F2.sf1.2.m1.2.3.2.3.1.cmml" xref="S4.F2.sf1.2.m1.2.3.2.3.1">¯</ci><ci id="S4.F2.sf1.2.m1.2.3.2.3.2a.cmml" xref="S4.F2.sf1.2.m1.2.3.2.3.2"><mtext id="S4.F2.sf1.2.m1.2.3.2.3.2.cmml" xref="S4.F2.sf1.2.m1.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.F2.sf1.2.m1.2.3.2.4.1.cmml" xref="S4.F2.sf1.2.m1.2.3.2.4.2"><ci id="S4.F2.sf1.2.m1.1.1.cmml" xref="S4.F2.sf1.2.m1.1.1">𝑦</ci><ci id="S4.F2.sf1.2.m1.2.2.cmml" xref="S4.F2.sf1.2.m1.2.2">𝑢</ci></interval></apply><cn id="S4.F2.sf1.2.m1.2.3.3.cmml" type="integer" xref="S4.F2.sf1.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf1.2.m1.2d">\Delta\overline{\text{IE}}(y,u)&lt;0</annotation><annotation encoding="application/x-llamapun" id="S4.F2.sf1.2.m1.2e">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) &lt; 0</annotation></semantics></math>)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="S4.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="864" id="S4.F2.sf2.g1" src="https://arxiv.org/html/2403.18167v1/x4.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Late-site hallucinations (<math alttext="\Delta\overline{\text{IE}}(y,u)\geq 0" class="ltx_Math" display="inline" id="S4.F2.sf2.2.m1.2"><semantics id="S4.F2.sf2.2.m1.2b"><mrow id="S4.F2.sf2.2.m1.2.3" xref="S4.F2.sf2.2.m1.2.3.cmml"><mrow id="S4.F2.sf2.2.m1.2.3.2" xref="S4.F2.sf2.2.m1.2.3.2.cmml"><mi id="S4.F2.sf2.2.m1.2.3.2.2" mathvariant="normal" xref="S4.F2.sf2.2.m1.2.3.2.2.cmml">Δ</mi><mo id="S4.F2.sf2.2.m1.2.3.2.1" xref="S4.F2.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mover accent="true" id="S4.F2.sf2.2.m1.2.3.2.3" xref="S4.F2.sf2.2.m1.2.3.2.3.cmml"><mtext id="S4.F2.sf2.2.m1.2.3.2.3.2" xref="S4.F2.sf2.2.m1.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.F2.sf2.2.m1.2.3.2.3.1" xref="S4.F2.sf2.2.m1.2.3.2.3.1.cmml">¯</mo></mover><mo id="S4.F2.sf2.2.m1.2.3.2.1b" xref="S4.F2.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="S4.F2.sf2.2.m1.2.3.2.4.2" xref="S4.F2.sf2.2.m1.2.3.2.4.1.cmml"><mo id="S4.F2.sf2.2.m1.2.3.2.4.2.1" stretchy="false" xref="S4.F2.sf2.2.m1.2.3.2.4.1.cmml">(</mo><mi id="S4.F2.sf2.2.m1.1.1" xref="S4.F2.sf2.2.m1.1.1.cmml">y</mi><mo id="S4.F2.sf2.2.m1.2.3.2.4.2.2" xref="S4.F2.sf2.2.m1.2.3.2.4.1.cmml">,</mo><mi id="S4.F2.sf2.2.m1.2.2" xref="S4.F2.sf2.2.m1.2.2.cmml">u</mi><mo id="S4.F2.sf2.2.m1.2.3.2.4.2.3" stretchy="false" xref="S4.F2.sf2.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.F2.sf2.2.m1.2.3.1" xref="S4.F2.sf2.2.m1.2.3.1.cmml">≥</mo><mn id="S4.F2.sf2.2.m1.2.3.3" xref="S4.F2.sf2.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.sf2.2.m1.2c"><apply id="S4.F2.sf2.2.m1.2.3.cmml" xref="S4.F2.sf2.2.m1.2.3"><geq id="S4.F2.sf2.2.m1.2.3.1.cmml" xref="S4.F2.sf2.2.m1.2.3.1"></geq><apply id="S4.F2.sf2.2.m1.2.3.2.cmml" xref="S4.F2.sf2.2.m1.2.3.2"><times id="S4.F2.sf2.2.m1.2.3.2.1.cmml" xref="S4.F2.sf2.2.m1.2.3.2.1"></times><ci id="S4.F2.sf2.2.m1.2.3.2.2.cmml" xref="S4.F2.sf2.2.m1.2.3.2.2">Δ</ci><apply id="S4.F2.sf2.2.m1.2.3.2.3.cmml" xref="S4.F2.sf2.2.m1.2.3.2.3"><ci id="S4.F2.sf2.2.m1.2.3.2.3.1.cmml" xref="S4.F2.sf2.2.m1.2.3.2.3.1">¯</ci><ci id="S4.F2.sf2.2.m1.2.3.2.3.2a.cmml" xref="S4.F2.sf2.2.m1.2.3.2.3.2"><mtext id="S4.F2.sf2.2.m1.2.3.2.3.2.cmml" xref="S4.F2.sf2.2.m1.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.F2.sf2.2.m1.2.3.2.4.1.cmml" xref="S4.F2.sf2.2.m1.2.3.2.4.2"><ci id="S4.F2.sf2.2.m1.1.1.cmml" xref="S4.F2.sf2.2.m1.1.1">𝑦</ci><ci id="S4.F2.sf2.2.m1.2.2.cmml" xref="S4.F2.sf2.2.m1.2.2">𝑢</ci></interval></apply><cn id="S4.F2.sf2.2.m1.2.3.3.cmml" type="integer" xref="S4.F2.sf2.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.sf2.2.m1.2d">\Delta\overline{\text{IE}}(y,u)\geq 0</annotation><annotation encoding="application/x-llamapun" id="S4.F2.sf2.2.m1.2e">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) ≥ 0</annotation></semantics></math>)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 3:</span><span class="ltx_text ltx_font_bold" id="S4.F3.2.1">Average Indirect Effect (AIE)</span> for individual model components for (a) early-site (left column) and (b) late-site (right column) non-factual 환각.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p4">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p4.3">인과 매개 분석의 이전 작업 <cite class="ltx_cite ltx_citemacro_cite">Vig et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib50" title="">2020</a>); Finlayson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib14" title="">2021</a>); Meng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite>에 이어, 단일 은닉 상태를 완화한 후 환각 정도의 감소로 <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px1.p4.3.1">causal indirect effect</span> <math alttext="\text{IE}(z;y,u,\epsilon)=y_{E^{*},z}-y_{*}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p4.1.m1.6"><semantics id="S4.SS1.SSS0.Px1.p4.1.m1.6a"><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.cmml"><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.cmml"><mtext id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml"><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.3.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.3.3.cmml">z</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">;</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.4.4" xref="S4.SS1.SSS0.Px1.p4.1.m1.4.4.cmml">y</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.5.5" xref="S4.SS1.SSS0.Px1.p4.1.m1.5.5.cmml">u</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.4" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.6.6" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.6.cmml">ϵ</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.5" stretchy="false" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1.cmml">=</mo><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.cmml"><msub id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2.cmml">y</mi><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml"><msup id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2.cmml">E</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3.cmml">*</mo></msup><mo id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1.cmml">z</mi></mrow></msub><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1.cmml">−</mo><msub id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2.cmml">y</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3.cmml">*</mo></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.1.m1.6b"><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7"><eq id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1"></eq><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2"><times id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1"></times><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2a.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2"><mtext id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2">IE</mtext></ci><list id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2"><ci id="S4.SS1.SSS0.Px1.p4.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.3.3">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p4.1.m1.4.4.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.4.4">𝑦</ci><ci id="S4.SS1.SSS0.Px1.p4.1.m1.5.5.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.5.5">𝑢</ci><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.6.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.6">italic-ϵ</ci></list></apply><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3"><minus id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1"></minus><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2">𝑦</ci><list id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2"><apply id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2">𝐸</ci><times id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3"></times></apply><ci id="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1">𝑧</ci></list></apply><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2">𝑦</ci><times id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.1.m1.6c">\text{IE}(z;y,u,\epsilon)=y_{E^{*},z}-y_{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p4.1.m1.6d">IE ( italic_z ; italic_y , italic_u , italic_ϵ ) = italic_y start_POSTSUBSCRIPT italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT , italic_z end_POSTSUBSCRIPT - italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT</annotation></semantics></math>의 중간 은닉 표현 <math alttext="z" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p4.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p4.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p4.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p4.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p4.2.m2.1d">italic_z</annotation></semantics></math>를 정의한다. 실제 질의 집합과 각 질의에 대한 잡음 샘플에 대한 평균을 구하여, 각 <math alttext="z" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p4.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p4.3.m3.1a"><mi id="S4.SS1.SSS0.Px1.p4.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p4.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.3.m3.1b"><ci id="S4.SS1.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.3.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p4.3.m3.1d">italic_z</annotation></semantics></math> 및 해당 모델 컴포넌트에 대한 평균 간접 효과(AIE)를 구한다.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Experiments.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.7">ParaRel <cite class="ltx_cite ltx_citemacro_cite">Elazar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib12" title="">2021</a>)</cite> cloze-style 사실 지식 쿼리의 데이터 세트로부터 사실 지식 쿼리 세트를 수집한다. ParaRel의 각 예는 지식 튜플 <math alttext="t_{c}=(s,r,o_{c})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.1.m1.3"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.3a"><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2.cmml">t</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.cmml">c</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml"><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p1.1.m1.2.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.4" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.5" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.3b"><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3"><eq id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2"></eq><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2">𝑡</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3">𝑐</ci></apply><vector id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1"><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2">𝑟</ci><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3">𝑐</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.3c">t_{c}=(s,r,o_{c})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.1.m1.3d">italic_t start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = ( italic_s , italic_r , italic_o start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math> 및 핸드 큐레이트 템플릿에서 생성된 프롬프트를 포함한다. Llama-2-7B-chat (32 layer, 7B parameters, fine-tuned on instruction following) <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib46" title="">2023</a>)</cite>, 2) GPT-J (28 layer, 6B parameters) <cite class="ltx_cite ltx_citemacro_cite">Wang and Komatsuzaki (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib52" title="">2021</a>)</cite>, 3) GPT-2-XL (48 layer, 1.5B parameters) <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib41" title="">2019</a>)</cite>의 세 가지 레이아웃을 평가하였다. 각각의 프롬프트 <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.2.m2.1d">italic_u</annotation></semantics></math>에 대해, 우리는 다음 토큰 연속의 LM 예측된 조건부 확률 <math alttext="p(o|E(u))" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.3.m3.2"><semantics id="S4.SS1.SSS0.Px2.p1.3.m3.2a"><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3.cmml">p</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2.cmml">o</mi><mo fence="false" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1.cmml">|</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2.cmml">E</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml"><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">u</mi><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.3.2.2" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m3.2b"><apply id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2"><times id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2"></times><ci id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3">𝑝</ci><apply id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2">𝑜</ci><apply id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3"><times id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1"></times><ci id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2">𝐸</ci><ci id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m3.2c">p(o|E(u))</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.3.m3.2d">italic_p ( italic_o | italic_E ( italic_u ) )</annotation></semantics></math>를 계산하며, 여기서 <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px2.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.4.m4.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.4.m4.1d">italic_o</annotation></semantics></math>는 모델 어휘 내의 모든 대문자 알파벳 토큰의 모음으로부터 취해진다. 질의가 다수의 정답을 허용할 수 있는 모호성 문제를 해결하기 위해, 우리는 환각을 LM이 진정한 객체 <math alttext="o_{c}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.6.m6.1"><semantics id="S4.SS1.SSS0.Px2.p1.6.m6.1a"><msub id="S4.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.6.m6.1c">o_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.6.m6.1d">italic_o start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>의 접미사도 아니고 WikiData API 쿼리 검색에 의해 반환되는 주제-관계 쌍 <math alttext="(s,r)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.7.m7.2"><semantics id="S4.SS1.SSS0.Px2.p1.7.m7.2a"><mrow id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p1.7.m7.2.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.7.m7.2b"><interval closure="open" id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2"><ci id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.7.m7.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.2">𝑟</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.7.m7.2c">(s,r)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.7.m7.2d">( italic_s , italic_r )</annotation></semantics></math>의 다른 객체의 접미사도 아닌 토큰 <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px2.p1.5.m5.1a"><msup id="S4.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.5.m5.1b"><apply id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.5.m5.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.5.m5.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>에 가장 높은 확률을 할당하는 경우로 정의한다. <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A1" title="Appendix A Dataset of Non-Factual Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">A</span></a> for more details about dataset construction.</span></span></span></p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.1">다양한 문장 위치 및 변환기 계층에 걸쳐 숨겨진 상태 <math alttext="z\in Z" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml">z</mi><mo id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml">∈</mo><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1"><in id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1"></in><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">z\in Z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.1.m1.1d">italic_z ∈ italic_Z</annotation></semantics></math>에 대한 ParaRel의 쿼리에 대한 평균 인과 간접 효과를 계산한다. 그림 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F2" title="Figure 2 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>는 Llama-2-7B의 세 가지 모델 구성 요소, 즉 잔차 스트림, 주의 헤드 및 MLP에 대한 AIE 분포를 보여준다. 오예측된 객체들에 대해 가장 높은 속성 점수를 산출하는 두 개의 은닉 상태 그룹을 관찰한다 : 1) MLP에 의해 하위 변압기 층에서 피험자 토큰의 은닉 상태, 2) MLP와 어텐션 헤드에 의해 상위 변압기 층에서 마지막 관계 토큰의 은닉 상태. GPT 모델에 대해서도 유사한 인과 효과 분포 패턴을 관찰한다(추가 결과에 대해서는 부록 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS2" title="B.2 Causal tracing results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">B.2</span></a> 참조). <cite class="ltx_cite ltx_citemacro_citet">Geva et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib15" title="">2023</a>)</cite>는 최근 성공적인 사실적 지식 회상을 위해 하위 계층 MLP와 상위 계층 주의 머리가 가장 중요한 두 가지 LM 구성 요소임을 보여준다. 우리의 인과 추적 결과는 대조적인 관점에서 그들의 발견을 확인할 뿐만 아니라 환각의 중요한 원인으로서 추가 구성 요소(상층 MLP)를 보여준다.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Early- vs. late-site hallucination.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px4.p1.3">위의 결과에 기초하여, 그림 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>에 예시된 바와 같이, 비사실적 환각을 유발할 수 있는 두 가지 다른 "메커니즘"이 있다고 가정한다: 1) LM은 하위 계층 구성요소로부터 피사체에 대한 정확한 정보를 검색하지 못하고, 2) LM은 하위 계층 구성요소로부터 일부 피사체 속성을 성공적으로 검색하지만, 상위 계층 구성요소들은 검색된 객체들 중에서 정확한 객체(들)를 구별하지 못한다. 특히, <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px4.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.1.m1.1d">italic_L</annotation></semantics></math>를 LM 트랜스포머 층의 수라고 하자. <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px4.p1.3.1">early-site components</span> as attention head and MLPs located in LM’s layers (<math alttext="1\leq l\leq\frac{L}{2}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px4.p1.2.m2.1a"><mrow id="S4.SS1.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml"><mn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml">1</mn><mo id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml">≤</mo><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4.cmml">l</mi><mo id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5.cmml">≤</mo><mfrac id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.cmml"><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2.cmml">L</mi><mn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><and id="S4.SS1.SSS0.Px4.p1.2.m2.1.1a.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"></and><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1b.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><leq id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3"></leq><cn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2">1</cn><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4">𝑙</ci></apply><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1c.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><leq id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5"></leq><share href="#S4.SS1.SSS0.Px4.p1.2.m2.1.1.4.cmml" id="S4.SS1.SSS0.Px4.p1.2.m2.1.1d.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"></share><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6"><divide id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6"></divide><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2">𝐿</ci><cn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.2.m2.1c">1\leq l\leq\frac{L}{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.2.m2.1d">1 ≤ italic_l ≤ divide start_ARG italic_L end_ARG start_ARG 2 end_ARG</annotation></semantics></math>), <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px4.p1.3.2">late-site components</span> as LM’s layers (<math alttext="\frac{L}{2}&lt;l\leq L" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px4.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px4.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml"><mfrac id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml">L</mi><mn id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml">2</mn></mfrac><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml">&lt;</mo><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4.cmml">l</mi><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5.cmml">≤</mo><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><and id="S4.SS1.SSS0.Px4.p1.3.m3.1.1a.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"></and><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1b.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><lt id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3"></lt><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2"><divide id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2"></divide><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2">𝐿</ci><cn id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3">2</cn></apply><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4">𝑙</ci></apply><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1c.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><leq id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5"></leq><share href="#S4.SS1.SSS0.Px4.p1.3.m3.1.1.4.cmml" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1d.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"></share><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.3.m3.1c">\frac{L}{2}&lt;l\leq L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p1.3.m3.1d">divide start_ARG italic_L end_ARG start_ARG 2 end_ARG &lt; italic_l ≤ italic_L</annotation></semantics></math>)의 후반부에 위치한 것들로 정의한다. 그런 다음 <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px4.p1.3.3">relative indirect effect</span> between intermediate representations by early-site and late-site model components as:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px4.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx1">
<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\Delta\overline{\text{IE}}(y,u)={\color[rgb]{0,0,1}\overline{%
\text{IE}}_{\text{late}}(y,u)}-{\color[rgb]{1,0,0}\overline{\text{IE}}_{\text{%
early}}(y,u)}" class="ltx_Math" display="inline" id="S4.E1.m1.6"><semantics id="S4.E1.m1.6a"><mrow id="S4.E1.m1.6.7" xref="S4.E1.m1.6.7.cmml"><mrow id="S4.E1.m1.6.7.2" xref="S4.E1.m1.6.7.2.cmml"><mi id="S4.E1.m1.6.7.2.2" mathvariant="normal" xref="S4.E1.m1.6.7.2.2.cmml">Δ</mi><mo id="S4.E1.m1.6.7.2.1" xref="S4.E1.m1.6.7.2.1.cmml">⁢</mo><mover accent="true" id="S4.E1.m1.6.7.2.3" xref="S4.E1.m1.6.7.2.3.cmml"><mtext id="S4.E1.m1.6.7.2.3.2" xref="S4.E1.m1.6.7.2.3.2a.cmml">IE</mtext><mo id="S4.E1.m1.6.7.2.3.1" xref="S4.E1.m1.6.7.2.3.1.cmml">¯</mo></mover><mo id="S4.E1.m1.6.7.2.1a" xref="S4.E1.m1.6.7.2.1.cmml">⁢</mo><mrow id="S4.E1.m1.6.7.2.4.2" xref="S4.E1.m1.6.7.2.4.1.cmml"><mo id="S4.E1.m1.6.7.2.4.2.1" stretchy="false" xref="S4.E1.m1.6.7.2.4.1.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">y</mi><mo id="S4.E1.m1.6.7.2.4.2.2" xref="S4.E1.m1.6.7.2.4.1.cmml">,</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">u</mi><mo id="S4.E1.m1.6.7.2.4.2.3" stretchy="false" xref="S4.E1.m1.6.7.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.6.7.1" xref="S4.E1.m1.6.7.1.cmml">=</mo><mrow id="S4.E1.m1.6.7.3" xref="S4.E1.m1.6.7.3.cmml"><mrow id="S4.E1.m1.6.7.3.2" xref="S4.E1.m1.6.7.3.2.cmml"><msub id="S4.E1.m1.6.7.3.2.2" xref="S4.E1.m1.6.7.3.2.2.cmml"><mover accent="true" id="S4.E1.m1.6.7.3.2.2.2" xref="S4.E1.m1.6.7.3.2.2.2.cmml"><mtext id="S4.E1.m1.6.7.3.2.2.2.2" mathcolor="#0000FF" xref="S4.E1.m1.6.7.3.2.2.2.2a.cmml">IE</mtext><mo id="S4.E1.m1.6.7.3.2.2.2.1" mathcolor="#0000FF" xref="S4.E1.m1.6.7.3.2.2.2.1.cmml">¯</mo></mover><mtext id="S4.E1.m1.6.7.3.2.2.3" mathcolor="#0000FF" xref="S4.E1.m1.6.7.3.2.2.3a.cmml">late</mtext></msub><mo id="S4.E1.m1.6.7.3.2.1" xref="S4.E1.m1.6.7.3.2.1.cmml">⁢</mo><mrow id="S4.E1.m1.6.7.3.2.3.2" xref="S4.E1.m1.6.7.3.2.3.1.cmml"><mo id="S4.E1.m1.6.7.3.2.3.2.1" mathcolor="#0000FF" stretchy="false" xref="S4.E1.m1.6.7.3.2.3.1.cmml">(</mo><mi id="S4.E1.m1.3.3" mathcolor="#0000FF" xref="S4.E1.m1.3.3.cmml">y</mi><mo id="S4.E1.m1.6.7.3.2.3.2.2" mathcolor="#0000FF" xref="S4.E1.m1.6.7.3.2.3.1.cmml">,</mo><mi id="S4.E1.m1.4.4" mathcolor="#0000FF" xref="S4.E1.m1.4.4.cmml">u</mi><mo id="S4.E1.m1.6.7.3.2.3.2.3" mathcolor="#0000FF" stretchy="false" xref="S4.E1.m1.6.7.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.6.7.3.1" xref="S4.E1.m1.6.7.3.1.cmml">−</mo><mrow id="S4.E1.m1.6.7.3.3" xref="S4.E1.m1.6.7.3.3.cmml"><msub id="S4.E1.m1.6.7.3.3.2" xref="S4.E1.m1.6.7.3.3.2.cmml"><mover accent="true" id="S4.E1.m1.6.7.3.3.2.2" xref="S4.E1.m1.6.7.3.3.2.2.cmml"><mtext id="S4.E1.m1.6.7.3.3.2.2.2" mathcolor="#FF0000" xref="S4.E1.m1.6.7.3.3.2.2.2a.cmml">IE</mtext><mo id="S4.E1.m1.6.7.3.3.2.2.1" mathcolor="#FF0000" xref="S4.E1.m1.6.7.3.3.2.2.1.cmml">¯</mo></mover><mtext id="S4.E1.m1.6.7.3.3.2.3" mathcolor="#FF0000" xref="S4.E1.m1.6.7.3.3.2.3a.cmml">early</mtext></msub><mo id="S4.E1.m1.6.7.3.3.1" xref="S4.E1.m1.6.7.3.3.1.cmml">⁢</mo><mrow id="S4.E1.m1.6.7.3.3.3.2" xref="S4.E1.m1.6.7.3.3.3.1.cmml"><mo id="S4.E1.m1.6.7.3.3.3.2.1" mathcolor="#FF0000" stretchy="false" xref="S4.E1.m1.6.7.3.3.3.1.cmml">(</mo><mi id="S4.E1.m1.5.5" mathcolor="#FF0000" xref="S4.E1.m1.5.5.cmml">y</mi><mo id="S4.E1.m1.6.7.3.3.3.2.2" mathcolor="#FF0000" xref="S4.E1.m1.6.7.3.3.3.1.cmml">,</mo><mi id="S4.E1.m1.6.6" mathcolor="#FF0000" xref="S4.E1.m1.6.6.cmml">u</mi><mo id="S4.E1.m1.6.7.3.3.3.2.3" mathcolor="#FF0000" stretchy="false" xref="S4.E1.m1.6.7.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.6b"><apply id="S4.E1.m1.6.7.cmml" xref="S4.E1.m1.6.7"><eq id="S4.E1.m1.6.7.1.cmml" xref="S4.E1.m1.6.7.1"></eq><apply id="S4.E1.m1.6.7.2.cmml" xref="S4.E1.m1.6.7.2"><times id="S4.E1.m1.6.7.2.1.cmml" xref="S4.E1.m1.6.7.2.1"></times><ci id="S4.E1.m1.6.7.2.2.cmml" xref="S4.E1.m1.6.7.2.2">Δ</ci><apply id="S4.E1.m1.6.7.2.3.cmml" xref="S4.E1.m1.6.7.2.3"><ci id="S4.E1.m1.6.7.2.3.1.cmml" xref="S4.E1.m1.6.7.2.3.1">¯</ci><ci id="S4.E1.m1.6.7.2.3.2a.cmml" xref="S4.E1.m1.6.7.2.3.2"><mtext id="S4.E1.m1.6.7.2.3.2.cmml" xref="S4.E1.m1.6.7.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.E1.m1.6.7.2.4.1.cmml" xref="S4.E1.m1.6.7.2.4.2"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝑦</ci><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝑢</ci></interval></apply><apply id="S4.E1.m1.6.7.3.cmml" xref="S4.E1.m1.6.7.3"><minus id="S4.E1.m1.6.7.3.1.cmml" xref="S4.E1.m1.6.7.3.1"></minus><apply id="S4.E1.m1.6.7.3.2.cmml" xref="S4.E1.m1.6.7.3.2"><times id="S4.E1.m1.6.7.3.2.1.cmml" xref="S4.E1.m1.6.7.3.2.1"></times><apply id="S4.E1.m1.6.7.3.2.2.cmml" xref="S4.E1.m1.6.7.3.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.7.3.2.2.1.cmml" xref="S4.E1.m1.6.7.3.2.2">subscript</csymbol><apply id="S4.E1.m1.6.7.3.2.2.2.cmml" xref="S4.E1.m1.6.7.3.2.2.2"><ci id="S4.E1.m1.6.7.3.2.2.2.1.cmml" xref="S4.E1.m1.6.7.3.2.2.2.1">¯</ci><ci id="S4.E1.m1.6.7.3.2.2.2.2a.cmml" xref="S4.E1.m1.6.7.3.2.2.2.2"><mtext id="S4.E1.m1.6.7.3.2.2.2.2.cmml" xref="S4.E1.m1.6.7.3.2.2.2.2">IE</mtext></ci></apply><ci id="S4.E1.m1.6.7.3.2.2.3a.cmml" xref="S4.E1.m1.6.7.3.2.2.3"><mtext id="S4.E1.m1.6.7.3.2.2.3.cmml" mathcolor="#0000FF" mathsize="70%" xref="S4.E1.m1.6.7.3.2.2.3">late</mtext></ci></apply><interval closure="open" id="S4.E1.m1.6.7.3.2.3.1.cmml" xref="S4.E1.m1.6.7.3.2.3.2"><ci id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">𝑦</ci><ci id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4">𝑢</ci></interval></apply><apply id="S4.E1.m1.6.7.3.3.cmml" xref="S4.E1.m1.6.7.3.3"><times id="S4.E1.m1.6.7.3.3.1.cmml" xref="S4.E1.m1.6.7.3.3.1"></times><apply id="S4.E1.m1.6.7.3.3.2.cmml" xref="S4.E1.m1.6.7.3.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.7.3.3.2.1.cmml" xref="S4.E1.m1.6.7.3.3.2">subscript</csymbol><apply id="S4.E1.m1.6.7.3.3.2.2.cmml" xref="S4.E1.m1.6.7.3.3.2.2"><ci id="S4.E1.m1.6.7.3.3.2.2.1.cmml" xref="S4.E1.m1.6.7.3.3.2.2.1">¯</ci><ci id="S4.E1.m1.6.7.3.3.2.2.2a.cmml" xref="S4.E1.m1.6.7.3.3.2.2.2"><mtext id="S4.E1.m1.6.7.3.3.2.2.2.cmml" xref="S4.E1.m1.6.7.3.3.2.2.2">IE</mtext></ci></apply><ci id="S4.E1.m1.6.7.3.3.2.3a.cmml" xref="S4.E1.m1.6.7.3.3.2.3"><mtext id="S4.E1.m1.6.7.3.3.2.3.cmml" mathcolor="#FF0000" mathsize="70%" xref="S4.E1.m1.6.7.3.3.2.3">early</mtext></ci></apply><interval closure="open" id="S4.E1.m1.6.7.3.3.3.1.cmml" xref="S4.E1.m1.6.7.3.3.3.2"><ci id="S4.E1.m1.5.5.cmml" xref="S4.E1.m1.5.5">𝑦</ci><ci id="S4.E1.m1.6.6.cmml" xref="S4.E1.m1.6.6">𝑢</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.6c">\displaystyle\Delta\overline{\text{IE}}(y,u)={\color[rgb]{0,0,1}\overline{%
\text{IE}}_{\text{late}}(y,u)}-{\color[rgb]{1,0,0}\overline{\text{IE}}_{\text{%
early}}(y,u)}</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.6d">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) = over¯ start_ARG IE end_ARG start_POSTSUBSCRIPT late end_POSTSUBSCRIPT ( italic_y , italic_u ) - over¯ start_ARG IE end_ARG start_POSTSUBSCRIPT early end_POSTSUBSCRIPT ( italic_y , italic_u )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{2}{L}\Big{[}{\color[rgb]{0,0,1}\sum_{l=1+\frac{L}{2}}^{L}%
\overline{\text{IE}}(z^{(l)}_{T},y,u)}-{\color[rgb]{1,0,0}\sum_{l=1}^{\frac{L}%
{2}}\overline{\text{IE}}(z^{(l)}_{0},y,u)}\Big{]}," class="ltx_Math" display="inline" id="S4.E2.m1.7"><semantics id="S4.E2.m1.7a"><mrow id="S4.E2.m1.7.7.1" xref="S4.E2.m1.7.7.1.1.cmml"><mrow id="S4.E2.m1.7.7.1.1" xref="S4.E2.m1.7.7.1.1.cmml"><mi id="S4.E2.m1.7.7.1.1.3" xref="S4.E2.m1.7.7.1.1.3.cmml"></mi><mo id="S4.E2.m1.7.7.1.1.2" xref="S4.E2.m1.7.7.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.7.7.1.1.1" xref="S4.E2.m1.7.7.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2.m1.7.7.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.3.cmml"><mfrac id="S4.E2.m1.7.7.1.1.1.3a" xref="S4.E2.m1.7.7.1.1.1.3.cmml"><mn id="S4.E2.m1.7.7.1.1.1.3.2" xref="S4.E2.m1.7.7.1.1.1.3.2.cmml">2</mn><mi id="S4.E2.m1.7.7.1.1.1.3.3" xref="S4.E2.m1.7.7.1.1.1.3.3.cmml">L</mi></mfrac></mstyle><mo id="S4.E2.m1.7.7.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S4.E2.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><munderover id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2a" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2" mathcolor="#0000FF" movablelimits="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2.cmml">l</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.cmml"><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2.cmml">1</mn><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1.cmml">+</mo><mfrac id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2.cmml">L</mi><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3.cmml">2</mn></mfrac></mrow></mrow><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3.cmml">L</mi></munderover></mstyle><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2a.cmml">IE</mtext><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">¯</mo></mover><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" mathcolor="#0000FF" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml">T</mi><mrow id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.1.1.1.3.1" mathcolor="#0000FF" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E2.m1.1.1.1.1" mathcolor="#0000FF" xref="S4.E2.m1.1.1.1.1.cmml">l</mi><mo id="S4.E2.m1.1.1.1.3.2" mathcolor="#0000FF" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E2.m1.3.3" mathcolor="#0000FF" xref="S4.E2.m1.3.3.cmml">y</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.4" mathcolor="#0000FF" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E2.m1.4.4" mathcolor="#0000FF" xref="S4.E2.m1.4.4.cmml">u</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.5" mathcolor="#0000FF" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml"><munderover id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2a" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2" mathcolor="#FF0000" movablelimits="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2.cmml">l</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1.cmml">=</mo><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mfrac id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2.cmml">L</mi><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3.cmml">2</mn></mfrac></munderover></mstyle><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.cmml"><mover accent="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.cmml"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2a.cmml">IE</mtext><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1.cmml">¯</mo></mover><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml"><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.2" mathcolor="#FF0000" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">(</mo><msubsup id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml">z</mi><mn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.cmml">0</mn><mrow id="S4.E2.m1.2.2.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo id="S4.E2.m1.2.2.1.3.1" mathcolor="#FF0000" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mi id="S4.E2.m1.2.2.1.1" mathcolor="#FF0000" xref="S4.E2.m1.2.2.1.1.cmml">l</mi><mo id="S4.E2.m1.2.2.1.3.2" mathcolor="#FF0000" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.3" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">,</mo><mi id="S4.E2.m1.5.5" mathcolor="#FF0000" xref="S4.E2.m1.5.5.cmml">y</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.4" mathcolor="#FF0000" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">,</mo><mi id="S4.E2.m1.6.6" mathcolor="#FF0000" xref="S4.E2.m1.6.6.cmml">u</mi><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.5" mathcolor="#FF0000" stretchy="false" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E2.m1.7.7.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S4.E2.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E2.m1.7.7.1.2" xref="S4.E2.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.7b"><apply id="S4.E2.m1.7.7.1.1.cmml" xref="S4.E2.m1.7.7.1"><eq id="S4.E2.m1.7.7.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.2"></eq><csymbol cd="latexml" id="S4.E2.m1.7.7.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.3">absent</csymbol><apply id="S4.E2.m1.7.7.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1"><times id="S4.E2.m1.7.7.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.2"></times><apply id="S4.E2.m1.7.7.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.3"><divide id="S4.E2.m1.7.7.1.1.1.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.3"></divide><cn id="S4.E2.m1.7.7.1.1.1.3.2.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.3.2">2</cn><ci id="S4.E2.m1.7.7.1.1.1.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.3.3">𝐿</ci></apply><apply id="S4.E2.m1.7.7.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1"><minus id="S4.E2.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.3"></minus><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3"><eq id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2">𝑙</ci><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3"><plus id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1"></plus><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2">1</cn><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3"><divide id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3"></divide><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2">𝐿</ci><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3">2</cn></apply></apply></apply></apply><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1"><times id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3"><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1">¯</ci><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2">IE</mtext></ci></apply><vector id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑙</ci></apply><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3">𝑦</ci><ci id="S4.E2.m1.4.4.cmml" xref="S4.E2.m1.4.4">𝑢</ci></vector></apply></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2">subscript</csymbol><sum id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2"></sum><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3"><eq id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1"></eq><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2">𝑙</ci><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3"><divide id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3"></divide><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2">𝐿</ci><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3">2</cn></apply></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1"><times id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2"></times><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3"><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1">¯</ci><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2a.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2">IE</mtext></ci></apply><vector id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1">superscript</csymbol><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2">𝑧</ci><ci id="S4.E2.m1.2.2.1.1.cmml" xref="S4.E2.m1.2.2.1.1">𝑙</ci></apply><cn id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.cmml" type="integer" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3">0</cn></apply><ci id="S4.E2.m1.5.5.cmml" xref="S4.E2.m1.5.5">𝑦</ci><ci id="S4.E2.m1.6.6.cmml" xref="S4.E2.m1.6.6">𝑢</ci></vector></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.7c">\displaystyle=\frac{2}{L}\Big{[}{\color[rgb]{0,0,1}\sum_{l=1+\frac{L}{2}}^{L}%
\overline{\text{IE}}(z^{(l)}_{T},y,u)}-{\color[rgb]{1,0,0}\sum_{l=1}^{\frac{L}%
{2}}\overline{\text{IE}}(z^{(l)}_{0},y,u)}\Big{]},</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.7d">= divide start_ARG 2 end_ARG start_ARG italic_L end_ARG [ ∑ start_POSTSUBSCRIPT italic_l = 1 + divide start_ARG italic_L end_ARG start_ARG 2 end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT over¯ start_ARG IE end_ARG ( italic_z start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_y , italic_u ) - ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT divide start_ARG italic_L end_ARG start_ARG 2 end_ARG end_POSTSUPERSCRIPT over¯ start_ARG IE end_ARG ( italic_z start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_y , italic_u ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px4.p3">
<p class="ltx_p" id="S4.SS1.SSS0.Px4.p3.8">여기서 <math alttext="\color[rgb]{1,0,0}{\overline{\text{IE}}_{\text{early}}(y,u)}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.1.m1.2"><semantics id="S4.SS1.SSS0.Px4.p3.1.m1.2a"><mrow id="S4.SS1.SSS0.Px4.p3.1.m1.2.3" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.cmml"><msub id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.cmml"><mover accent="true" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1.cmml">¯</mo></mover><mtext id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3a.cmml">early</mtext></msub><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml"><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2.1" mathcolor="#FF0000" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.1.m1.1.1" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2.2" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.1.m1.2.2" mathcolor="#FF0000" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2.3" mathcolor="#FF0000" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.1.m1.2b"><apply id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3"><times id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1"></times><apply id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2">subscript</csymbol><apply id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2"><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2"><mtext id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2">IE</mtext></ci></apply><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3a.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3"><mtext id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3.cmml" mathcolor="#FF0000" mathsize="70%" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3">early</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2"><ci id="S4.SS1.SSS0.Px4.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.1.m1.2c">\color[rgb]{1,0,0}{\overline{\text{IE}}_{\text{early}}(y,u)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.1.m1.2d">over¯ start_ARG IE end_ARG start_POSTSUBSCRIPT early end_POSTSUBSCRIPT ( italic_y , italic_u )</annotation></semantics></math>는 첫 번째 주제 토큰 <math alttext="w_{0}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.2.m2.1"><semantics id="S4.SS1.SSS0.Px4.p3.2.m2.1a"><msub id="S4.SS1.SSS0.Px4.p3.2.m2.1.1" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2.cmml">w</mi><mn id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.2.m2.1b"><apply id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2">𝑤</ci><cn id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.2.m2.1c">w_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.2.m2.1d">italic_w start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>의 초기 사이트 중간 표현들의 평균 간접 효과이고(도 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F2" title="Figure 2 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>의 파란색 점선 박스에서의 은닉 상태), <math alttext="\color[rgb]{0,0,1}{\overline{\text{IE}}_{\text{late}}(y,u)}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.3.m3.2"><semantics id="S4.SS1.SSS0.Px4.p3.3.m3.2a"><mrow id="S4.SS1.SSS0.Px4.p3.3.m3.2.3" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.cmml"><msub id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.cmml"><mover accent="true" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1.cmml">¯</mo></mover><mtext id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3a.cmml">late</mtext></msub><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml"><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2.1" mathcolor="#0000FF" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.3.m3.1.1" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2.2" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.3.m3.2.2" mathcolor="#0000FF" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2.3" mathcolor="#0000FF" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.3.m3.2b"><apply id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3"><times id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1"></times><apply id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2">subscript</csymbol><apply id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2"><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2"><mtext id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2">IE</mtext></ci></apply><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3a.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3"><mtext id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3.cmml" mathcolor="#0000FF" mathsize="70%" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3">late</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2"><ci id="S4.SS1.SSS0.Px4.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.3.m3.2c">\color[rgb]{0,0,1}{\overline{\text{IE}}_{\text{late}}(y,u)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.3.m3.2d">over¯ start_ARG IE end_ARG start_POSTSUBSCRIPT late end_POSTSUBSCRIPT ( italic_y , italic_u )</annotation></semantics></math>는 <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.5.m5.1"><semantics id="S4.SS1.SSS0.Px4.p3.5.m5.1a"><mi id="S4.SS1.SSS0.Px4.p3.5.m5.1.1" xref="S4.SS1.SSS0.Px4.p3.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.5.m5.1b"><ci id="S4.SS1.SSS0.Px4.p3.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.5.m5.1d">italic_u</annotation></semantics></math>의 마지막 관계 토큰 <math alttext="w_{T}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.4.m4.1"><semantics id="S4.SS1.SSS0.Px4.p3.4.m4.1a"><msub id="S4.SS1.SSS0.Px4.p3.4.m4.1.1" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2.cmml">w</mi><mi id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.4.m4.1b"><apply id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2">𝑤</ci><ci id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.4.m4.1c">w_{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.4.m4.1d">italic_w start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>의 후기 사이트 중간 표현들의 평균 간접 효과이다(도 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F2" title="Figure 2 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>의 빨간색 점선 박스에서의 은닉 상태). 우리는 환각 <math alttext="(u,o,o^{\prime})" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.6.m6.3"><semantics id="S4.SS1.SSS0.Px4.p3.6.m6.3a"><mrow id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml"><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.2" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.6.m6.1.1" xref="S4.SS1.SSS0.Px4.p3.6.m6.1.1.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.3" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.6.m6.2.2" xref="S4.SS1.SSS0.Px4.p3.6.m6.2.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.4" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">,</mo><msup id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3.cmml">′</mo></msup><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.5" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.6.m6.3b"><vector id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1"><ci id="S4.SS1.SSS0.Px4.p3.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.1.1">𝑢</ci><ci id="S4.SS1.SSS0.Px4.p3.6.m6.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.2.2">𝑜</ci><apply id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.6.m6.3c">(u,o,o^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.6.m6.3d">( italic_u , italic_o , italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>를 <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px4.p3.8.1">early-site</span>의 하위 계층 숨겨진 표현이 더 강한 AIE(i.e. <math alttext="\Delta\overline{\text{IE}}(y,u)&lt;0" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.7.m7.2"><semantics id="S4.SS1.SSS0.Px4.p3.7.m7.2a"><mrow id="S4.SS1.SSS0.Px4.p3.7.m7.2.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.cmml"><mrow id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.cmml"><mi id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2" mathvariant="normal" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2.cmml">Δ</mi><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1.cmml">⁢</mo><mover accent="true" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1.cmml">¯</mo></mover><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1a" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml"><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2.1" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.7.m7.1.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.7.m7.2.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2.3" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1.cmml">&lt;</mo><mn id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.7.m7.2b"><apply id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3"><lt id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1"></lt><apply id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2"><times id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1"></times><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2">Δ</ci><apply id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3"><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2"><mtext id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2"><ci id="S4.SS1.SSS0.Px4.p3.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.2">𝑢</ci></interval></apply><cn id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.7.m7.2c">\Delta\overline{\text{IE}}(y,u)&lt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.7.m7.2d">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) &lt; 0</annotation></semantics></math>)를 갖는 경우, 그렇지 않으면 <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px4.p3.8.2">late-site</span>(i.e. <math alttext="\Delta\overline{\text{IE}}(y,u)\geq 0" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px4.p3.8.m8.2"><semantics id="S4.SS1.SSS0.Px4.p3.8.m8.2a"><mrow id="S4.SS1.SSS0.Px4.p3.8.m8.2.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.cmml"><mrow id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.cmml"><mi id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2" mathvariant="normal" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2.cmml">Δ</mi><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1.cmml">⁢</mo><mover accent="true" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1.cmml">¯</mo></mover><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1a" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml"><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2.1" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.8.m8.1.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.8.m8.2.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.2.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2.3" stretchy="false" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1.cmml">≥</mo><mn id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.8.m8.2b"><apply id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3"><geq id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1"></geq><apply id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2"><times id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1"></times><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2">Δ</ci><apply id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3"><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2"><mtext id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2"><ci id="S4.SS1.SSS0.Px4.p3.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.2">𝑢</ci></interval></apply><cn id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3.cmml" type="integer" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.8.m8.2c">\Delta\overline{\text{IE}}(y,u)\geq 0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px4.p3.8.m8.2d">roman_Δ over¯ start_ARG IE end_ARG ( italic_y , italic_u ) ≥ 0</annotation></semantics></math>)로 분류한다. 초기 사이트 환각과 후기 사이트 환각은 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F3" title="Figure 3 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>와 같이 매우 다른 AIE 분포를 갖는 반면, 초기 사이트 환각에 크게 기여하는 대부분의 구성 요소는 주제 토큰을 처리할 때 하위 계층에 위치하지만 후기 사이트 환각은 관계 토큰을 처리할 때 상위 계층에 집중된 구성 요소에 의해 대부분 발생한다.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.4" style="width:368.6pt;height:217.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(92.9pt,-54.9pt) scale(2.01623380038052,2.01623380038052) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.4.4.5.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.4.4.5.1.1">Statistics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.4.4.5.1.2">Early-site hall.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.4.4.5.1.3">Late-site hall.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.4.4.6.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.4.4.6.1.1">Amount</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.6.1.2">(1945 / 31.9%)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.6.1.3">(4152 / 68.1%)</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.2.2.2.2">
<math alttext="s" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d">italic_s</annotation></semantics></math>-<math alttext="o" class="ltx_Math" display="inline" id="S4.T1.2.2.2.2.m2.1"><semantics id="S4.T1.2.2.2.2.m2.1a"><mi id="S4.T1.2.2.2.2.m2.1.1" xref="S4.T1.2.2.2.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m2.1b"><ci id="S4.T1.2.2.2.2.m2.1.1.cmml" xref="S4.T1.2.2.2.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m2.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.2.m2.1d">italic_o</annotation></semantics></math> assoc.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.2.3">0.40</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.2.4">0.88</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.4.4.2">
<math alttext="s" class="ltx_Math" display="inline" id="S4.T1.3.3.3.1.m1.1"><semantics id="S4.T1.3.3.3.1.m1.1a"><mi id="S4.T1.3.3.3.1.m1.1.1" xref="S4.T1.3.3.3.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.m1.1b"><ci id="S4.T1.3.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.1.m1.1d">italic_s</annotation></semantics></math>-<math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.T1.4.4.4.2.m2.1"><semantics id="S4.T1.4.4.4.2.m2.1a"><msup id="S4.T1.4.4.4.2.m2.1.1" xref="S4.T1.4.4.4.2.m2.1.1.cmml"><mi id="S4.T1.4.4.4.2.m2.1.1.2" xref="S4.T1.4.4.4.2.m2.1.1.2.cmml">o</mi><mo id="S4.T1.4.4.4.2.m2.1.1.3" xref="S4.T1.4.4.4.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.2.m2.1b"><apply id="S4.T1.4.4.4.2.m2.1.1.cmml" xref="S4.T1.4.4.4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.T1.4.4.4.2.m2.1.1.1.cmml" xref="S4.T1.4.4.4.2.m2.1.1">superscript</csymbol><ci id="S4.T1.4.4.4.2.m2.1.1.2.cmml" xref="S4.T1.4.4.4.2.m2.1.1.2">𝑜</ci><ci id="S4.T1.4.4.4.2.m2.1.1.3.cmml" xref="S4.T1.4.4.4.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.2.m2.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.2.m2.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> assoc.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.4.3">0.85</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.4.4">2.03</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4.7.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.4.7.2.1">Robustness</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.7.2.2">0.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.7.2.3">0.51</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4.8.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T1.4.4.8.3.1">Uncertainty</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.4.8.3.2">4.39</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.4.4.8.3.3">4.17</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1:</span>External data and Llama-2-7b prediction features for two types of non-factual 환각.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">External manifestations of hallucination mechanisms.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.SSS0.Px5.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px5.p1.10">우리의 환각 분류가 내부 계산 패턴만을 기반으로 한 조작된 이분법이 아님을 확인하기 위해 다음으로 두 가지 유형의 환각을 구별하기 위해 활용할 수 있는 외부 특징이 있는지 여부를 조사한다. 쿼리 데이터 및 모델 예측의 다음 특징을 고려합니다. <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px5.p1.10.1">subject-object association strength</span>은 피험자 <math alttext="s" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px5.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px5.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.1.m1.1d">italic_s</annotation></semantics></math>와 참 오브젝트 <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px5.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px5.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.2.m2.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.2.m2.1d">italic_o</annotation></semantics></math> 또는 환각 오브젝트 <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px5.p1.3.m3.1a"><msup id="S4.SS1.SSS0.Px5.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.3.m3.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.3.m3.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>의 입력 레이어 임베딩 사이의 내적 곱으로 측정됩니다. <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS0.Px5.p1.10.2">robustness</span>은 입력 임베딩에 추가된 후 모델이 참 답변을 선호하지 않는 구간 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4.1</span></a>에서 완화 실행 중에 주입된 가우시안 노이즈의 백분율로 측정됩니다. <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px5.p1.5.m5.1a"><mi id="S4.SS1.SSS0.Px5.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px5.p1.5.m5.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.5.m5.1b"><ci id="S4.SS1.SSS0.Px5.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.5.m5.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.5.m5.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.5.m5.1d">italic_o</annotation></semantics></math> over <math alttext="o^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.6.m6.1"><semantics id="S4.SS1.SSS0.Px5.p1.6.m6.1a"><msup id="S4.SS1.SSS0.Px5.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.6.m6.1c">o^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.6.m6.1d">italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> (즉, <math alttext="y_{*}&lt;0&lt;y" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.7.m7.1"><semantics id="S4.SS1.SSS0.Px5.p1.7.m7.1a"><mrow id="S4.SS1.SSS0.Px5.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.cmml"><msub id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2.cmml">y</mi><mo id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3.cmml">*</mo></msub><mo id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3.cmml">&lt;</mo><mn id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4.cmml">0</mn><mo id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5.cmml">&lt;</mo><mi id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.7.m7.1b"><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"><and id="S4.SS1.SSS0.Px5.p1.7.m7.1.1a.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"></and><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1b.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"><lt id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3"></lt><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2">𝑦</ci><times id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3"></times></apply><cn id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4.cmml" type="integer" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4">0</cn></apply><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1c.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"><lt id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5"></lt><share href="#S4.SS1.SSS0.Px5.p1.7.m7.1.1.4.cmml" id="S4.SS1.SSS0.Px5.p1.7.m7.1.1d.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"></share><ci id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.7.m7.1c">y_{*}&lt;0&lt;y</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.7.m7.1d">italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT &lt; 0 &lt; italic_y</annotation></semantics></math>); <span class="ltx_text ltx_font_bold" 표 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.T1" title="Table 1 ‣ Early- vs. late-site hallucination. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>는 외부 측정값을 요약한 것이다. 1) 후기 사이트 환각(예: <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.4">Toulouse</span>)의 피험자는 종종 환각 대상(예: <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.5">Paris</span>)이 실제 대상(예: <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.6">Bologna</span>)보다 훨씬 더 강한 연관 강도의 환각 대상(예: <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.6">Bologna</span>)을 가짐으로써 모델이 <math alttext="s" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px5.p1.10.m10.1"><semantics id="S4.SS1.SSS0.Px5.p1.10.m10.1a"><mi id="S4.SS1.SSS0.Px5.p1.10.m10.1.1" xref="S4.SS1.SSS0.Px5.p1.10.m10.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.10.m10.1b"><ci id="S4.SS1.SSS0.Px5.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.10.m10.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.10.m10.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px5.p1.10.m10.1d">italic_s</annotation></semantics></math>를 볼 때 <math id 한편, 초기-사이트 환각(예를 들어, <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.7">Orica</span>)의 대상은 종종 참(예를 들어, <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.8">Australia</span>) 및 환각(예를 들어, <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px5.p1.10.9">January</span>) 객체들; 2) 후기-사이트 환각들은 입력 섭동 하에서 상당히 덜 강건한데, 이는 아마도 모델이 이미 초기 계층들로부터 정확한 객체를 검색했고 단지 "one step away"이기 때문이고, 그것을 구별하는 것으로부터 단지 "one step away"이기 때문이다; 3) 모델은 초기-사이트 환각을 생성할 때 그것의 예측에 대해 덜 확실하며, 인식론적 환각이 종종 높은 예측 불확실성과 연관</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="838" id="S4.F4.g1" src="https://arxiv.org/html/2403.18167v1/x5.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4:</span>Average dot product between true object embedding and intermediate hidden representations by Llama-2-7b in each layer.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Inspection via embedding space projection</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">이 섹션에서는 각 모델 구성 요소가 추론 중 잔류 스트림에 기록하는 정보를 살펴봄으로써 초기 및 후기 현장 환각 간의 기계론적 차이에 대한 추가 증거를 제공한다.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Method.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.10">섹션 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S3" title="3 Background and Notation ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>가 제안하는 바와 같이, 레이어 <math alttext="l" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.1.m1.1d">italic_l</annotation></semantics></math>의 각 어텐션 또는 MLP 모듈은 이전 레이어에서 제작한 임베딩 <math alttext="h^{(l-1)}_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><msubsup id="S4.SS2.SSS0.Px1.p1.2.m2.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2.cmml">h</mi><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3.cmml">i</mi><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2">ℎ</ci><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3">1</cn></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">h^{(l-1)}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.2.m2.1d">italic_h start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>에 자신의 출력 숨김 상태를 추가하여 모델 예측에 기여한다. 최근 연구에 따르면 모듈의 인코딩된 지식은 최종 계층 언어 모델 헤드 프로젝션(즉, 내적)을 중간 출력 은닉 상태에 적용하여 어휘 <cite class="ltx_cite ltx_citemacro_cite">Geva et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib17" title="">2022b</a>); Dar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib8" title="">2023</a>)</cite>에 대한 분포를 얻음으로써 해석될 수 있다. 모델 환각 <math alttext="(u,o,o^{\prime})" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.3.m3.3"><semantics id="S4.SS2.SSS0.Px1.p1.3.m3.3a"><mrow id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml"><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">u</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">,</mo><mi id="S4.SS2.SSS0.Px1.p1.3.m3.2.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.2.2.cmml">o</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.4" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">,</mo><msup id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2.cmml">o</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3.cmml">′</mo></msup><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.5" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.m3.3b"><vector id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1"><ci id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1">𝑢</ci><ci id="S4.SS2.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.2.2">𝑜</ci><apply id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2">𝑜</ci><ci id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.m3.3c">(u,o,o^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.3.m3.3d">( italic_u , italic_o , italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>의 각 예에 대해, 먼저 모든 MLP 및 어텐션 모듈의 중간 출력 <math alttext="z\in A\bigcup M" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px1.p1.4.m4.1a"><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml">z</mi><mo id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml">∈</mo><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">A</mi><mo id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.cmml"><mo id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml">⋃</mo><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml">M</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1"><in id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1"></in><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2">𝑧</ci><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3"><times id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2">𝐴</ci><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3"><union id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1"></union><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.4.m4.1c">z\in A\bigcup M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.4.m4.1d">italic_z ∈ italic_A ⋃ italic_M</annotation></semantics></math>를 추출한 후, 최종 투영 레이어에서 <math alttext="z" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.6.m6.1"><semantics id="S4.SS2.SSS0.Px1.p1.6.m6.1a"><mi id="S4.SS2.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS2.SSS0.Px1.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.6.m6.1b"><ci id="S4.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.6.m6.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.6.m6.1d">italic_z</annotation></semantics></math>와 <math alttext="o" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.7.m7.1"><semantics id="S4.SS2.SSS0.Px1.p1.7.m7.1a"><mi id="S4.SS2.SSS0.Px1.p1.7.m7.1.1" xref="S4.SS2.SSS0.Px1.p1.7.m7.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.7.m7.1b"><ci id="S4.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m7.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.7.m7.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.7.m7.1d">italic_o</annotation></semantics></math>에 대응하는 행 벡터 사이의 내적 <math alttext="\tilde{p}(z,o)=z^{T}e_{o}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.5.m5.2"><semantics id="S4.SS2.SSS0.Px1.p1.5.m5.2a"><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.cmml"><mover accent="true" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2.cmml">p</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1.cmml">~</mo></mover><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.cmml">z</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml">,</mo><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.2.cmml">o</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1.cmml">=</mo><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.cmml"><msup id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2.cmml">z</mi><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3.cmml">T</mi></msup><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2.cmml">e</mi><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3.cmml">o</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.5.m5.2b"><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3"><eq id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1"></eq><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2"><times id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2"><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1">~</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2">𝑝</ci></apply><interval closure="open" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2"><ci id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1">𝑧</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.2">𝑜</ci></interval></apply><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3"><times id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1"></times><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2">𝑧</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3">𝑇</ci></apply><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2">𝑒</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.5.m5.2c">\tilde{p}(z,o)=z^{T}e_{o}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.5.m5.2d">over~ start_ARG italic_p end_ARG ( italic_z , italic_o ) = italic_z start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math>를 취함으로써 이 방법을 사용한다. 결과적인 임베딩 공간 투영(ESP)은 <math alttext="z" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.8.m8.1"><semantics id="S4.SS2.SSS0.Px1.p1.8.m8.1a"><mi id="S4.SS2.SSS0.Px1.p1.8.m8.1.1" xref="S4.SS2.SSS0.Px1.p1.8.m8.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.8.m8.1b"><ci id="S4.SS2.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.8.m8.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.8.m8.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.8.m8.1d">italic_z</annotation></semantics></math> 대 <math alttext="p(o|u)" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.9.m9.1"><semantics id="S4.SS2.SSS0.Px1.p1.9.m9.1a"><mrow id="S4.SS2.SSS0.Px1.p1.9.m9.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3.cmml">p</mi><mo id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.9.m9.1b"><apply id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1"><times id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2"></times><ci id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3">𝑝</ci><apply id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2">𝑜</ci><ci id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.9.m9.1c">p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.9.m9.1d">italic_p ( italic_o | italic_u )</annotation></semantics></math>의 근사화된 기여도로 취해질 수 있다. 각 계층에서 모든 쿼리와 동일한 유형의 모든 모듈에 대한 투영을 평균함으로써, 추론 동안 각 계층이 정답 <math alttext="o" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p1.10.m10.1"><semantics id="S4.SS2.SSS0.Px1.p1.10.m10.1a"><mi id="S4.SS2.SSS0.Px1.p1.10.m10.1.1" xref="S4.SS2.SSS0.Px1.p1.10.m10.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.10.m10.1b"><ci id="S4.SS2.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m10.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.10.m10.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p1.10.m10.1d">italic_o</annotation></semantics></math>에 대한 지식이 얼마나 기여하는지 정량화할 수 있다.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">1) 사실적 답변(즉, 모델이 다음 토큰으로 <math alttext="o" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.1c">o</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.1.m1.1d">italic_o</annotation></semantics></math>를 올바르게 예측함), 2) 초기 사이트 환각 및 3) 후기 사이트 환각에 대한 계층별 MLP 및 주의 돌기를 계산합니다. 그림 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.F4" title="Figure 4 ‣ External manifestations of hallucination mechanisms. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>는 결과를 보여줍니다. 1) 하위 계층 MLP만 실제 응답에 대한 정보를 잔차 스트림에 기록하며, 중요하게는 하위 계층 MLP의 기여도는 후기 사이트 환각에 대해 유사하고 질의에 올바르게 응답하는 반면 모델이 초기 사이트 환각을 생성할 때는 훨씬 적다. 2) 두 가지 유형의 환각에 대해, 자기 주의 구성 요소, 특히 상위 계층의 구성 요소는 사실적 정답에 비해 훨씬 덜 유용한 정보를 작성한다. GPT 모델에서 관찰된 유사한 패턴은 부록 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.SS4" title="B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">B.4</span></a>에서 찾을 수 있다.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p2.1">종합하면, 1) <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.1">early-site MLPs, late-site self-attentions 및 late-site MLPs가 환각을 일으키는 가장 중요한 LM 구성 요소</span>이고, 2) <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p2.1.2">lower layer MLPs 및 upper layer attentions/MLPs가 항상 동시에 분해되지 않으므로 LM 사실 오류의 두 가지 별개의 메커니즘으로 이어진다. </span></p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Tracing LM Hallucinations During Pretraining</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">우리는 LMs에서 비사실적 환각의 두 가지 메커니즘을 확인했다. 이 섹션에서는 모델 사전 훈련 동안 이러한 환각이 어떻게 나타나는지 이해하는 것을 목표로 실험을 설계한다. 예를 들어, 초기 사이트와 후기 사이트 환각은 구별에 기여하는 다른 학습 패턴을 나타내는가? 또한 중요한 초기 사이트 MLP 및 후기 사이트 주의 구성 요소가 제대로 "개발"하지 못하는 이유를 탐구하는 것을 목표로 한다.</p>
</div>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Data and models.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">사전 훈련 중 언어 모델 환각을 연구하기 위해 ParaRel에서 피티아 모델 제품군 <cite class="ltx_cite ltx_citemacro_cite">Biderman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib2" title="">2023</a>)</cite>를 평가한다. 피티아는 공공 데이터에 대해 정확히 동일한 순서로 훈련된 자기회귀 LMs 계열에 대한 사전 훈련 체크포인트의 집합이다. 먼저 14억 개의 매개 변수를 가진 피티아의 마지막 체크포인트를 취하고 섹션 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4.1</span></a>에 설명된 ParaRel 데이터 세트에서 다른 LMs에 대해 동일한 평가 및 필터링 프로세스를 반복한 다음 잘못 답한 쿼리에 대한 인과 매개 분석을 수행하여 주의 헤드 및 MLP에 대한 AIE를 얻고 쿼리 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.E2" title="2 ‣ Early- vs. late-site hallucination. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>를 기반으로 쿼리를 초기 사이트 및 후기 사이트 환각으로 분류한다. 그런 다음 모델 학습 이력에 고르게 분포된 32개의 피티아-1.4B 사전 훈련 체크포인트에 대한 모든 쿼리에 대해 중간 은닉 상태를 평가하고 얻는다. <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A3" title="Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">C</span></a> for details of Pythia evaluation.</span></span></span></p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Development of factual association pipeline.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.1">Pythia-1.4b 체크포인트에 대한 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS2" title="4.2 Inspection via embedding space projection ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4.2</span></a> 섹션의 임베딩 공간 투영(ESP) 실험을 복제하고 사전 훈련 단계에서 결과를 비교한다. 각 Pythia-1.4B 체크포인트에 대해 먼저 ESP를 1) 변환기 계층 중 처음 12개 계층에 있는 MLP, 2) 마지막 12개 계층에 있는 주의 헤드에 대한 실제, 초기 사이트 환각 및 후기 사이트 환각 쿼리 집합에 대한 평균 ESP를 계산한다(마지막 모델 체크포인트에 의한 예측 결과에 따라 범주화됨). . 도 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S5.F5" title="Figure 5 ‣ Development of factual association pipeline. ‣ 5 Tracing LM Hallucinations During Pretraining ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>는 32개의 Pythia-1.4b 체크포인트 상의 true object ESPs의 진화 궤적을 나타낸다. 우리는 1)에 주목한다 후기 사이트 환각과 사실 질의 사이의 MLP의 학습 역학은 매우 유사하며, 사전 훈련의 전반부 동안 대략적으로 실제 객체 예측과 긍정적인 ESP를 생성하는 것을 점진적으로 학습한다. 초기 현장 환각의 경우 MLP는 대신 부정적인 ESP를 만드는 방법을 배우며 다시 진정한 주제 지식이 부족함을 시사한다. 2) 피티아의 상위 계층 관심은 사실 질의를 위한 높은 ESP를 생성하는 것만을 학습한다. 더욱이, 어텐션 모듈들은 초기 사이트 MLP들이 성숙할 때까지 참 객체들을 구별하는 것을 학습하지 않을 것이다(<math alttext="\sim" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S5.SS0.SSS0.Px2.p1.1.m1.1a"><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.1.m1.1b"><csymbol cd="latexml" id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.1.m1.1d">∼</annotation></semantics></math>70-<span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px2.p1.1.1">th</span> pretraining step). 종합하면, 우리의 결과는 <span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px2.p1.1.2">초기 사이트 MLP와 후기 사이트 주의가 함께 사전 훈련 동안 점진적으로 나타나는 사실 회상의 2단계 파이프라인을 형성하고 둘 중 하나를 개발하지 못하면 비사실적 환각</span>으로 이어질 것임을 시사한다.</p>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="753" id="S5.F5.g1" src="https://arxiv.org/html/2403.18167v1/x6.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5:</span>Average embedding space projection to the true object tokens for lower-layer MLPs (up) and upper-layer attention modules (down) of Pythia-1.4b pretraining checkpoints. 빨간색 수직선은 하위 계층 MLP가 학습을 마치고 상위 계층 주의 머리가 발달하기 시작할 때 "위상 변화"를 나타낸다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Application to Hallucination Detection</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">우리는 모델이 환각이라는 것을 알 때 기계론적 해석 가능성 방법이 LM 사실 오류의 원인을 밝힐 수 있음을 입증했다. 이 섹션에서는 이전 분석에서 인과 관계 속성 특징이 LM이 환각을 생성하는지 여부를 예측할 수 있음을 추가로 보여준다.</p>
</div>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Data.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px1.p1.1">3개의 데이터셋에 대해 GPT2-XL <span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>We encountered GPU memory issues when implementing gradient-based baselines and causal approximations on larger LMs, so here we focused on GPT2-XL and leave experiments on other LMs for future work.</span></span></span>에 의한 비사실적 환각을 연구한다: 1) <span class="ltx_text ltx_font_bold" id="S6.SS0.SSS0.Px1.p1.1.1">ParaRel</span> 섹션 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4" title="4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, 2) Google 검색 엔진 쿼리와 Wikipedia 페이지를 지원하는 <span class="ltx_text ltx_font_bold" id="S6.SS0.SSS0.Px1.p1.1.2">Natural Questions</span> dataset <cite class="ltx_cite ltx_citemacro_cite">Kwiatkowski et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib26" title="">2019</a>)</cite>와 3) <span class="ltx_text ltx_font_bold" id="S6.SS0.SSS0.Px1.p1.1.3">TruthfulQA</span> dataset by <cite class="ltx_cite ltx_citemacro_citet">Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib28" title="">2022</a>)</cite>로 구성된 적대적으로 구성된 커먼센스 추론 질문으로 구성된 <cite idx 우리는 질문 답변에서 객관식 평가 방식을 따르고 GPT2-XL에게 모든 후보 답변의 조건부 로그 우도를 계산하도록 요청한다. 가능성이 가장 높은 답변이 거짓의 지상 진리 레이블을 갖는 경우, 질의는 환각, 그렇지 않으면 사실 예측으로 레이블링된다.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Methods.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px2.p1.3">언어 모델에 의한 질의 <math alttext="u" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S6.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S6.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S6.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S6.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px2.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px2.p1.1.m1.1d">italic_u</annotation></semantics></math>와 다음 단어 예측 <math alttext="o" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S6.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S6.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S6.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S6.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px2.p1.2.m2.1c">o</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px2.p1.2.m2.1d">italic_o</annotation></semantics></math>가 주어졌을 때, 모델의 환각 여부를 예측하고자 한다. 다음 토큰을 예측한 모델의 로그 가능성 <math alttext="\log p(o|u)" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S6.SS0.SSS0.Px2.p1.3.m3.1a"><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">log</mi><mo id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3a" lspace="0.167em" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">p</mi></mrow><mo id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1"><times id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2"></times><apply id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3"><log id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px2.p1.3.m3.1c">\log p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px2.p1.3.m3.1d">roman_log italic_p ( italic_o | italic_u )</annotation></semantics></math>에 대한 변압기 모듈의 인과 효과 점수를 기반으로 모델 사실성을 예측하기 위해 섹션 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4.1</span></a>에서와 동일한 인과 개입 패치 방법을 사용하여 로지스틱 회귀 모델을 구축한다. 이 경우 인과 반응 변수는 더 이상 두 객체 토큰 간의 로그 우도비가 아니라 모델 생성 토큰의 로그 우도이며, 이 토큰의 사실성은 환각 감지기에 의해 결정된다. 어텐션, MLP 및 잔차 스트림 모듈의 중간 출력에서 각 뉴런에 대한 AIE를 48개 레이어에 걸쳐 계산하고 3개 모듈의 AIE 점수 배열을 연결하여 단일 4,800차원 특징 벡터를 얻는다. 개별 뉴런에 대한 인과 매개 분석을 수행하는 것은 매우 비싸기 때문에 계산을 가속화하기 위해 <cite class="ltx_cite ltx_citemacro_cite">Nanda (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib35" title="">2023</a>)</cite>에 의한 인과 매개 효과의 기울기 기반 근사화 방법을 채택한다.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Baselines.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px3.p1.3">또한 LM 환각을 나타내는 것으로 나타난 비인과적 내부 특징 세트를 사용하여 기준 로지스틱 회귀 모델을 테스트한다: 1) 입력 시퀀스의 마지막 토큰의 마지막 계층 숨김 상태, 모델이 직접 사용하여 다음 토큰 <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib60" title="">2021</a>)</cite>; 2) 활성화 값 <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib27" title="">2023</a>)</cite>; 3) <math alttext="\log p(o|u)" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="S6.SS0.SSS0.Px3.p1.1.m1.1a"><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.cmml"><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1.cmml">log</mi><mo id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3a" lspace="0.167em" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2.cmml">p</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px3.p1.1.m1.1b"><apply id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1"><times id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2"></times><apply id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3"><log id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px3.p1.1.m1.1c">\log p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px3.p1.1.m1.1d">roman_log italic_p ( italic_o | italic_u )</annotation></semantics></math>에 대한 그라디언트 <cite class="ltx_cite ltx_citemacro_cite">De Cao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib9" title="">2021</a>)</cite>; 4) <math alttext="\log p(o|u)" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px3.p1.2.m2.1"><semantics id="S6.SS0.SSS0.Px3.p1.2.m2.1a"><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.cmml"><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml">log</mi><mo id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3a" lspace="0.167em" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml">p</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml"><mo id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1"><times id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2"></times><apply id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3"><log id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px3.p1.2.m2.1c">\log p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px3.p1.2.m2.1d">roman_log italic_p ( italic_o | italic_u )</annotation></semantics></math>에 대한 활성화 * 그라디언트 값 <cite class="ltx_cite ltx_citemacro_cite">Tang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib45" title="">2022</a>)</cite>; 및 5) <math alttext="\log p(o|u)" class="ltx_Math" display="inline" id="S6.SS0.SSS0.Px3.p1.3.m3.1"><semantics id="S6.SS0.SSS0.Px3.p1.3.m3.1a"><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml">log</mi><mo id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3a" lspace="0.167em" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml">p</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml"><mo id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3.cmml">u</mi></mrow><mo id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1"><times id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2"></times><apply id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3"><log id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px3.p1.3.m3.1c">\log p(o|u)</annotation><annotation encoding="application/x-llamapun" id="S6.SS0.SSS0.Px3.p1.3.m3.1d">roman_log italic_p ( italic_o | italic_u )</annotation></semantics></math>에 대한 통합 그라디언트 <cite class="ltx_cite ltx_citemacro_cite">Sundararajan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib44" title="">2017</a>)</cite>. 기준선 (2)-(4)의 경우, 인과 효과 기반 분류기와 동일한 중간 뉴런 세트에 대한 특징을 계산하여 기준 입력 특징 벡터의 차원이 IE 기반 특징 벡터와 동일하도록 한다.</p>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px4.p1.1">각 데이터 세트에 대해 5중 교차 검증을 수행하고 검증 세트에 대해 모든 환각 분류기의 평균 예측 정확도를 계산한다. Table <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#S6.T2" title="Table 2 ‣ Results. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>는 결과를 요약한 것이다. 우리는 인과적 간접 효과 특징이 모든 데이터 세트에 대한 모델 환각을 가장 잘 예측하여 일관되게 모든 기준 모델을 초과한다는 것을 발견했다. 특히, IG를 제외한 모든 기준선은 입력 교란 없이 내부 정보만을 사용하기 때문에 AIE에 비해 낮은 성능은 인과적 매개 분석에서 모델 추론 과정의 반사실적 개입이 사실적 오류를 유발하는 중요한 구성 요소를 찾는 데 중요하다는 것을 시사한다. <cite class="ltx_cite ltx_citemacro_citet">Meng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite>에 의해 제안된 IG 기준선은 종종 입력 텍스트 아티팩트(예: 희귀 단어 및 오타)에 과도하게 민감하므로 다양한 입력 형식을 가진 두 QA 데이터 세트에 대해 훨씬 덜 신뢰할 수 있는 예측을 산출한다.</p>
</div>
<figure class="ltx_table" id="S6.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T2.1" style="width:368.6pt;height:273.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(87.4pt,-64.9pt) scale(1.90193354407282,1.90193354407282) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T2.1.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S6.T2.1.1.1.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.1.1.1.1.2">ParaRel</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.1.1.1.1.3">NaturalQA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T2.1.1.1.1.4">TruthfulQA</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T2.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T2.1.1.2.1.1">Random</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.1.2.1.2">50.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.1.2.1.3">50.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.1.2.1.4">50.0</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.3.2.1">LHS</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.3.2.2">62.1</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.3.2.3">56.6</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.3.2.4">50.4</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.4.3.1">Activation</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.4.3.2">67.8</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.4.3.3">62.6</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.4.3.4">52.0</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.5.4.1">Gradient</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.5.4.2">68.8</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.5.4.3">66.1</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.5.4.4">53.8</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.6.5.1">Grad. X Act.</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.6.5.2">68.9</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.6.5.3">68.3</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.6.5.4">60.1</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.1.1.7.6.1">IG</th>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.7.6.2">69.9</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.7.6.3">67.4</td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.1.7.6.4">53.2</td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S6.T2.1.1.8.7.1">Causal IE</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T2.1.1.8.7.2"><span class="ltx_text ltx_font_bold" id="S6.T2.1.1.8.7.2.1">70.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T2.1.1.8.7.3"><span class="ltx_text ltx_font_bold" id="S6.T2.1.1.8.7.3.1">69.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T2.1.1.8.7.4"><span class="ltx_text ltx_font_bold" id="S6.T2.1.1.8.7.4.1">60.8</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 2: </span>3개의 사실 쿼리 데이터 세트에 대해 다양한 내부 특징을 사용하여 훈련된 환각 분류기의 평균 5배 교차 검증 정확도.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">해석가능성 분석을 통해 언어모델 비사실적 환각의 원인을 1) 하위 계층 MLP에서는 속성지식이 부족하고, 2) 상위 계층 주의와 MLP에서는 객체선택에 결함이 있는 두 가지 원인으로 확인하였다. 또한 두 가지 기계론적 유형의 환각에 대한 다양한 사전 훈련 궤적과 함께 데이터 및 모델 예측에서 구별되는 특성을 밝혀냈다. 이러한 통찰력을 활용하여 효과적인 환각 감지기를 만들었습니다. 우리의 연구는 LM 사실 오류에 대한 기계론적 이해를 확립하고 환각 완화의 설명 가능한 접근법에 대한 향후 연구에 영감을 줄 수 있다.</p>
</div>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Limitation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">우리의 연구는 몇 가지 한계를 가지고 있다. 첫째, 특정 실험은 어휘 공간에 투영을 통해 중간 계층 표현과 매개변수를 해석하는 데 의존한다. 널리 사용되지만 이 방법은 특히 초기 계층에서 모델 구성요소의 인코딩된 정보만 근사화한다. 둘째, 간단한 입력 시퀀스를 가진 비사실적 환각에 대한 우리의 초점은 실제 LM 행동을 완전히 포착하지 못할 수 있다. 향후 조사는 더 긴 입력 쿼리와 잠재적인 적대적 특징을 고려하여 보다 복잡하고 자연스러운 컨텍스트를 연구하기 위해 기계론적 해석 가능성 방법을 적용해야 한다. 셋째, 기계론적 분석에서 얻은 통찰력을 기반으로 LM 환각을 줄이는 방법을 탐구하지 않았다. 향후 연구에서는 본 연구에서 확인된 중요한 모델 구성 요소에 대한 목표 가중치 편집 또는 추론 시간 개입을 수행하여 효율적인 환각 완화 방법을 개발하는 것을 고려할 수 있다.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akyürek et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ekin Akyürek, Tolga Bolukbasi, Frederick Liu, Binbin Xiong, Ian Tenney, Jacob Andreas, and Kelvin Guu. 2022.

</span>
<span class="ltx_bibblock">Towards tracing knowledge in language models back to the training data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Findings of the Association for Computational Linguistics: EMNLP 2022</em>, pages 2429–2446.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stella Biderman, Hailey Schoelkopf, Quentin&nbsp;Gregory Anthony, Herbie Bradley, Kyle O’Brien, Eric Hallahan, Mohammad&nbsp;Aflah Khan, Shivanshu Purohit, USVSN&nbsp;Sai Prashanth, Edward Raff, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Machine Learning</em>, pages 2397–2430. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et&nbsp;al. (2022a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Meng Cao, Yue Dong, and Jackie Cheung. 2022a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.acl-long.236" title="">Hallucinated but factual! inspecting the factuality of hallucinations in abstractive summarization</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 3340–3354, Dublin, Ireland. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et&nbsp;al. (2022b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Meng Cao, Yue Dong, Jingyi He, and Jackie Chi&nbsp;Kit Cheung. 2022b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.emnlp-main.663" title="">Learning with rejection for abstractive text summarization</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pages 9768–9780, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Roi Cohen, May Hamri, Mor Geva, and Amir Globerson. 2023.

</span>
<span class="ltx_bibblock">Lm vs lm: Detecting factual errors via cross examination.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2305.13281</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Conmy et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Arthur Conmy, Augustine&nbsp;N Mavor-Parker, Aengus Lynch, Stefan Heimersheim, and Adrià Garriga-Alonso. 2023.

</span>
<span class="ltx_bibblock">Towards automated circuit discovery for mechanistic interpretability.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2304.14997</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Damai Dai, Li&nbsp;Dong, Yaru Hao, Zhifang Sui, Baobao Chang, and Furu Wei. 2022.

</span>
<span class="ltx_bibblock">Knowledge neurons in pretrained transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 8493–8502.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dar et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guy Dar, Mor Geva, Ankit Gupta, and Jonathan Berant. 2023.

</span>
<span class="ltx_bibblock">Analyzing transformers in embedding space.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Annual Meeting of the Association for Computational Linguistics</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">De&nbsp;Cao et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nicola De&nbsp;Cao, Wilker Aziz, and Ivan Titov. 2021.

</span>
<span class="ltx_bibblock">Editing factual knowledge in language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 6491–6506.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chenhe Dong, Yinghui Li, Haifan Gong, Miaoxin Chen, Junxin Li, Ying Shen, and Min Yang. 2022.

</span>
<span class="ltx_bibblock">A survey of natural language generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ACM Computing Surveys</em>, 55(8):1–38.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elaraby et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mohamed Elaraby, Mengyin Lu, Jacob Dunn, Xueying Zhang, Yu&nbsp;Wang, and Shizhu Liu. 2023.

</span>
<span class="ltx_bibblock">Halo: Estimation and reduction of hallucinations in open-source weak large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2308.11764</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elazar et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yanai Elazar, Nora Kassner, Shauli Ravfogel, Abhilasha Ravichander, Eduard Hovy, Hinrich Schütze, and Yoav Goldberg. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1162/tacl_a_00410" title="">Measuring and improving consistency in pretrained language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Transactions of the Association for Computational Linguistics</em>, 9:1012–1031.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elhage et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nelson Elhage, Neel Nanda, Catherine Olsson, Tom Henighan, Nicholas Joseph, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, Tom Conerly, Nova DasSarma, Dawn Drain, Deep Ganguli, Zac Hatfield-Dodds, Danny Hernandez, Andy Jones, Jackson Kernion, Liane Lovitt, Kamal Ndousse, Dario Amodei, Tom Brown, Jack Clark, Jared Kaplan, Sam McCandlish, and Chris Olah. 2021.

</span>
<span class="ltx_bibblock">A mathematical framework for transformer circuits.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Transformer Circuits Thread</em>.

</span>
<span class="ltx_bibblock">Https://transformer-circuits.pub/2021/framework/index.html.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finlayson et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Matthew Finlayson, Aaron Mueller, Sebastian Gehrmann, Stuart&nbsp;M Shieber, Tal Linzen, and Yonatan Belinkov. 2021.

</span>
<span class="ltx_bibblock">Causal analysis of syntactic agreement mechanisms in neural language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers)</em>, pages 1828–1843.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mor Geva, Jasmijn Bastings, Katja Filippova, and Amir Globerson. 2023.

</span>
<span class="ltx_bibblock">Dissecting recall of factual associations in auto-regressive language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2304.14767</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2022a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mor Geva, Avi Caciularu, Guy Dar, Paul Roit, Shoval Sadde, Micah Shlain, Bar Tamir, and Yoav Goldberg. 2022a.

</span>
<span class="ltx_bibblock">Lm-debugger: An interactive tool for inspection and intervention in transformer-based language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the The 2022 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pages 12–21.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2022b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mor Geva, Avi Caciularu, Kevin Wang, and Yoav Goldberg. 2022b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.emnlp-main.3" title="">Transformer feed-forward layers build predictions by promoting concepts in the vocabulary space</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pages 30–45, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mor Geva, Roei Schuster, Jonathan Berant, and Omer Levy. 2021.

</span>
<span class="ltx_bibblock">Transformer feed-forward layers are key-value memories.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 5484–5495.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghandeharioun et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Asma Ghandeharioun, Avi Caciularu, Adam Pearce, Lucas Dixon, and Mor Geva. 2024.

</span>
<span class="ltx_bibblock">Patchscope: A unifying framework for inspecting hidden representations of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2401.06102</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haviv et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Adi Haviv, Ori Ram, Ofir Press, Peter Izsak, and Omer Levy. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.findings-emnlp.99" title="">Transformer language models without positional encodings still learn positional information</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Findings of the Association for Computational Linguistics: EMNLP 2022</em>, pages 1382–1390, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hernandez et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Evan Hernandez, Arnab&nbsp;Sen Sharma, Tal Haklay, Kevin Meng, Martin Wattenberg, Jacob Andreas, Yonatan Belinkov, and David Bau. 2023.

</span>
<span class="ltx_bibblock">Linearity of relation decoding in transformer language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2308.09124</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ziwei Ji, Nayeon Lee, Rita Frieske, Tiezheng Yu, Dan Su, Yan Xu, Etsuko Ishii, Ye&nbsp;Jin Bang, Andrea Madotto, and Pascale Fung. 2023.

</span>
<span class="ltx_bibblock">Survey of hallucination in natural language generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">ACM Computing Surveys</em>, 55(12):1–38.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhengbao Jiang, Frank&nbsp;F Xu, Jun Araki, and Graham Neubig. 2020.

</span>
<span class="ltx_bibblock">How can we know what language models know?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Transactions of the Association for Computational Linguistics</em>, 8:423–438.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaddour et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jean Kaddour, Joshua Harris, Maximilian Mozes, Herbie Bradley, Roberta Raileanu, and Robert McHardy. 2023.

</span>
<span class="ltx_bibblock">Challenges and applications of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2307.10169</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katz et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shahar Katz, Yonatan Belinkov, Mor Geva, and Lior Wolf. 2024.

</span>
<span class="ltx_bibblock">Backward lens: Projecting language model gradients into the vocabulary space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2402.12865</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, et&nbsp;al. 2019.

</span>
<span class="ltx_bibblock">Natural questions: a benchmark for question answering research.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Transactions of the Association for Computational Linguistics</em>, 7:453–466.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kenneth Li, Oam Patel, Fernanda Viégas, Hanspeter Pfister, and Martin Wattenberg. 2023.

</span>
<span class="ltx_bibblock">Inference-time intervention: Eliciting truthful answers from a language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2306.03341</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stephanie Lin, Jacob Hilton, and Owain Evans. 2022.

</span>
<span class="ltx_bibblock">Truthfulqa: Measuring how models mimic human falsehoods.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 3214–3252.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kaiji Lu, Zifan Wang, Piotr Mardziel, and Anupam Datta. 2021.

</span>
<span class="ltx_bibblock">Influence patterns for explaining information flow in bert.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems</em>, 34:4461–4474.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Manakul et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Potsawee Manakul, Adian Liusie, and Mark&nbsp;JF Gales. 2023.

</span>
<span class="ltx_bibblock">Selfcheckgpt: Zero-resource black-box hallucination detection for generative large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2303.08896</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et&nbsp;al. (2022a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kevin Meng, David Bau, Alex Andonian, and Yonatan Belinkov. 2022a.

</span>
<span class="ltx_bibblock">Locating and editing factual associations in gpt.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Advances in Neural Information Processing Systems</em>, 35:17359–17372.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et&nbsp;al. (2022b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kevin Meng, Arnab&nbsp;Sen Sharma, Alex Andonian, Yonatan Belinkov, and David Bau. 2022b.

</span>
<span class="ltx_bibblock">Mass-editing memory in a transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2210.07229</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mitchell et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Eric Mitchell, Charles Lin, Antoine Bosselut, Chelsea Finn, and Christopher&nbsp;D Manning. 2021.

</span>
<span class="ltx_bibblock">Fast model editing at scale.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mündler et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Niels Mündler, Jingxuan He, Slobodan Jenko, and Martin Vechev. 2023.

</span>
<span class="ltx_bibblock">Self-contradictory hallucinations of large language models: Evaluation, detection and mitigation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2305.15852</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nanda (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Neel Nanda. 2023.

</span>
<span class="ltx_bibblock">Attribution patching: Activation patching at industrial scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">URL: https://www. neelnanda. io/mechanistic-interpretability/attribution-patching</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nanda et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Neel Nanda, Lawrence Chan, Tom Lieberum, Jess Smith, and Jacob Steinhardt. 2022.

</span>
<span class="ltx_bibblock">Progress measures for grokking via mechanistic interpretability.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">The Eleventh International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nostalgebraist (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nostalgebraist. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://www.lesswrong.com/posts/AcKRB8wDpdaN6v6ru/interpreting-gpt-the-logit-lens" title="">Interpreting gpt: the logit lens</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">LESSWRONG</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Olah (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chris Olah. 2022.

</span>
<span class="ltx_bibblock">Mechanistic interpretability, variables, and the importance of interpretable bases.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Transformer Circuits Thread</em>.

</span>
<span class="ltx_bibblock">Https://transformer-circuits.pub/2022/mech-interp-essay/index.html.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pearl (2001)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Judea Pearl. 2001.

</span>
<span class="ltx_bibblock">Direct and indirect effects.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proc. of the 17th Conference on Uncertainty in Artificial Intelligence, 2001</em>, pages 411–420.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petroni et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Fabio Petroni, Tim Rocktäschel, Sebastian Riedel, Patrick Lewis, Anton Bakhtin, Yuxiang Wu, and Alexander Miller. 2019.

</span>
<span class="ltx_bibblock">Language models as knowledge bases?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pages 2463–2473.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et&nbsp;al. 2019.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">OpenAI blog</em>, 1(8):9.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aarohi Srivastava, Abhinav Rastogi, Abhishek Rao, Abu Awal&nbsp;Md Shoeb, Abubakar Abid, Adam Fisch, Adam&nbsp;R Brown, Adam Santoro, Aditya Gupta, Adrià Garriga-Alonso, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Beyond the imitation game: Quantifying and extrapolating the capabilities of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Transactions on Machine Learning Research</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stolfo et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alessandro Stolfo, Yonatan Belinkov, and Mrinmaya Sachan. 2023.

</span>
<span class="ltx_bibblock">A mechanistic interpretation of arithmetic reasoning in language models using causal mediation analysis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 7035–7052.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sundararajan et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mukund Sundararajan, Ankur Taly, and Qiqi Yan. 2017.

</span>
<span class="ltx_bibblock">Axiomatic attribution for deep networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">International conference on machine learning</em>, pages 3319–3328. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Joël Tang, Marina Fomicheva, and Lucia Specia. 2022.

</span>
<span class="ltx_bibblock">Reducing hallucinations in neural machine translation with feature attribution.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2211.09878</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2307.09288</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Turpin et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Miles Turpin, Julian Michael, Ethan Perez, and Samuel&nbsp;R Bowman. 2023.

</span>
<span class="ltx_bibblock">Language models don’t always say what they think: Unfaithful explanations in chain-of-thought prompting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2305.04388</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Varshney et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Neeraj Varshney, Wenlin Yao, Hongming Zhang, Jianshu Chen, and Dong Yu. 2023.

</span>
<span class="ltx_bibblock">A stitch in time saves nine: Detecting and mitigating hallucinations of llms by validating low-confidence generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2307.03987</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan&nbsp;N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vig et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jesse Vig, Sebastian Gehrmann, Yonatan Belinkov, Sharon Qian, Daniel Nevo, Yaron Singer, and Stuart Shieber. 2020.

</span>
<span class="ltx_bibblock">Investigating gender bias in language models using causal mediation analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Advances in neural information processing systems</em>, 33:12388–12401.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wallat et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jonas Wallat, Jaspreet Singh, and Avishek Anand. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2020.blackboxnlp-1.17" title="">BERTnesia: Investigating the capture and forgetting of knowledge in BERT</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of the Third BlackboxNLP Workshop on Analyzing and Interpreting Neural Networks for NLP</em>, pages 174–183, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Komatsuzaki (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ben Wang and Aran Komatsuzaki. 2021.

</span>
<span class="ltx_bibblock">GPT-J-6B: A 6 Billion Parameter Autoregressive Language Model.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/kingoflolz/mesh-transformer-jax" title="">https://github.com/kingoflolz/mesh-transformer-jax</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kevin&nbsp;Ro Wang, Alexandre Variengien, Arthur Conmy, Buck Shlegeris, and Jacob Steinhardt. 2022.

</span>
<span class="ltx_bibblock">Interpretability in the wild: a circuit for indirect object identification in gpt-2 small.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">The Eleventh International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao and Wang (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yijun Xiao and William&nbsp;Yang Wang. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2021.eacl-main.236" title="">On hallucination and predictive uncertainty in conditional language generation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Proceedings of the 16th Conference of the European Chapter of the Association for Computational Linguistics: Main Volume</em>, pages 2734–2744, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qinan Yu, Jack Merullo, and Ellie Pavlick. 2023.

</span>
<span class="ltx_bibblock">Characterizing mechanisms for factual recall in language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:2310.15910</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuksekgonul et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mert Yuksekgonul, Varun Chandrasekaran, Erik Jones, Suriya Gunasekar, Ranjita Naik, Hamid Palangi, Ece Kamar, and Besmira Nushi. 2023.

</span>
<span class="ltx_bibblock">Attention satisfies: A constraint-satisfaction lens on factual errors of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:2309.15098</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Muru Zhang, Ofir Press, William Merrill, Alisa Liu, and Noah&nbsp;A Smith. 2023a.

</span>
<span class="ltx_bibblock">How language model hallucinations can snowball.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">arXiv preprint arXiv:2305.13534</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yue Zhang, Yafu Li, Leyang Cui, Deng Cai, Lemao Liu, Tingchen Fu, Xinting Huang, Enbo Zhao, Yu&nbsp;Zhang, Yulong Chen, et&nbsp;al. 2023b.

</span>
<span class="ltx_bibblock">Siren’s song in the ai ocean: A survey on hallucination in large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">arXiv preprint arXiv:2309.01219</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chunting Zhou, Pengfei Liu, Puxin Xu, Srini Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, Lili Yu, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Lima: Less is more for alignment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">arXiv preprint arXiv:2305.11206</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chunting Zhou, Graham Neubig, Jiatao Gu, Mona Diab, Francisco Guzmán, Luke Zettlemoyer, and Marjan Ghazvininejad. 2021.

</span>
<span class="ltx_bibblock">Detecting hallucinated content in conditional neural sequence generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">Findings of the Association for Computational Linguistics: ACL-IJCNLP 2021</em>, pages 1393–1404.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Dataset of Non-Factual Hallucinations</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">우리는 <cite class="ltx_cite ltx_citemacro_cite">Dai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib7" title="">2022</a>)</cite>의 데이터 구성 파이프라인을 따라 주제-관계-객체 지식 튜플을 포함하는 ParaRel <cite class="ltx_cite ltx_citemacro_cite">Elazar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib12" title="">2021</a>)</cite>의 엔트리로부터 우리의 쿼리 입력 시퀀스 각각을 생성한다(예: WikiData에 엔터티로 존재하는 (<span class="ltx_text ltx_font_italic" id="A1.p1.1.1">Toulouse</span>, <span class="ltx_text ltx_font_italic" id="A1.p1.1.2">is twin city of</span>, <span class="ltx_text ltx_font_italic" id="A1.p1.1.3">Atlanta</span>)). 각각의 관계는 엔티티들이 전체 프롬프트들을 형성하도록 대체될 수 있는 프롬프트 템플릿들의 세트(예를 들어, “__는 __의 트윈 도시”)를 갖는다(예를 들어, “Toulouse는 __의 트윈 도시”는 오브젝트를 질의하는 프롬프트로서).</p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.6">쿼리 데이터세트를 생성한 후, 언어 모델에게 주제-관계 쌍을 포함하는 주어진 프롬프트 <math alttext="u" class="ltx_Math" display="inline" id="A1.p2.2.m2.1"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.m2.1d">italic_u</annotation></semantics></math>를 계속하기 위해 가장 가능성이 높은 대문자화된 영숫자 토큰 <math alttext="\hat{t}" class="ltx_Math" display="inline" id="A1.p2.1.m1.1"><semantics id="A1.p2.1.m1.1a"><mover accent="true" id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml"><mi id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml">t</mi><mo id="A1.p2.1.m1.1.1.1" xref="A1.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1"><ci id="A1.p2.1.m1.1.1.1.cmml" xref="A1.p2.1.m1.1.1.1">^</ci><ci id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\hat{t}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.m1.1d">over^ start_ARG italic_t end_ARG</annotation></semantics></math>를 예측하도록 요청한다. 예측 <math alttext="\hat{t}" class="ltx_Math" display="inline" id="A1.p2.3.m3.1"><semantics id="A1.p2.3.m3.1a"><mover accent="true" id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mi id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">t</mi><mo id="A1.p2.3.m3.1.1.1" xref="A1.p2.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><ci id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1.1">^</ci><ci id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">\hat{t}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.3.m3.1d">over^ start_ARG italic_t end_ARG</annotation></semantics></math>는 다음 두 가지 조건 중 적어도 하나를 만족하면 <span class="ltx_text ltx_font_bold" id="A1.p2.6.1">factual</span>이라고 정의한다. 1) ground-truth object <math alttext="o" class="ltx_Math" display="inline" id="A1.p2.4.m4.1"><semantics id="A1.p2.4.m4.1a"><mi id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><ci id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">o</annotation><annotation encoding="application/x-llamapun" id="A1.p2.4.m4.1d">italic_o</annotation></semantics></math>와 동일하거나 접두사이다. 2) WikiData SPARQL <span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>https://query.wikidata.org/</span></span></span> 쿼리를 입력으로 하여 반환한 엔터티 중 하나의 접두사이다. 이러한 방식으로, 우리는 다수의 정확한 완성들을 허용하는 질의들에 대한 응답 모호성 문제를 해결할 수 있다(예를 들어, “Marugame, located in, __”은 “Kagawa” 또는 “Japan” 중 어느 하나로 완료될 수 있고, 두 출력들은 사실적으로 정확하다). 마지막으로, 각 모델에 대해 모델 예측된 전체 어휘에 걸쳐 상위 50개의 가장 가능성 있는 토큰 중 대문자 영숫자 토큰이 없는 쿼리를 폐기하며, 이러한 대부분의 경우에서 <math alttext="\hat{t}" class="ltx_Math" display="inline" id="A1.p2.6.m6.1"><semantics id="A1.p2.6.m6.1a"><mover accent="true" id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml"><mi id="A1.p2.6.m6.1.1.2" xref="A1.p2.6.m6.1.1.2.cmml">t</mi><mo id="A1.p2.6.m6.1.1.1" xref="A1.p2.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><apply id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1"><ci id="A1.p2.6.m6.1.1.1.cmml" xref="A1.p2.6.m6.1.1.1">^</ci><ci id="A1.p2.6.m6.1.1.2.cmml" xref="A1.p2.6.m6.1.1.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">\hat{t}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.6.m6.1d">over^ start_ARG italic_t end_ARG</annotation></semantics></math>의 로그 가능성은 무시할 수 있게 된다. 이 데이터 전처리 파이프라인은 Llama-2-7b-chat에 대해 6,097개의 쿼리 세트, GPT-J에 대해 6,809개, GPT-2-XL에 대해 6,401개, 피티아-1.4B에 대해 8,345개의 쿼리를 생성한다.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Causal Tracing of Hallucinations</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Experiment details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.5">손상된 실행에서 우리는 <cite class="ltx_cite ltx_citemacro_cite">Meng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite>를 따르고 가우시안 노이즈 <math alttext="\epsilon\sim\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.2"><semantics id="A2.SS1.p1.1.m1.2a"><mrow id="A2.SS1.p1.1.m1.2.3" xref="A2.SS1.p1.1.m1.2.3.cmml"><mi id="A2.SS1.p1.1.m1.2.3.2" xref="A2.SS1.p1.1.m1.2.3.2.cmml">ϵ</mi><mo id="A2.SS1.p1.1.m1.2.3.1" xref="A2.SS1.p1.1.m1.2.3.1.cmml">∼</mo><mrow id="A2.SS1.p1.1.m1.2.3.3" xref="A2.SS1.p1.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.1.m1.2.3.3.2" xref="A2.SS1.p1.1.m1.2.3.3.2.cmml">𝒩</mi><mo id="A2.SS1.p1.1.m1.2.3.3.1" xref="A2.SS1.p1.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.1.m1.2.3.3.3.2" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml"><mo id="A2.SS1.p1.1.m1.2.3.3.3.2.1" stretchy="false" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml">(</mo><mn id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">0</mn><mo id="A2.SS1.p1.1.m1.2.3.3.3.2.2" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml">,</mo><mn id="A2.SS1.p1.1.m1.2.2" xref="A2.SS1.p1.1.m1.2.2.cmml">1</mn><mo id="A2.SS1.p1.1.m1.2.3.3.3.2.3" stretchy="false" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.2b"><apply id="A2.SS1.p1.1.m1.2.3.cmml" xref="A2.SS1.p1.1.m1.2.3"><csymbol cd="latexml" id="A2.SS1.p1.1.m1.2.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.1">similar-to</csymbol><ci id="A2.SS1.p1.1.m1.2.3.2.cmml" xref="A2.SS1.p1.1.m1.2.3.2">italic-ϵ</ci><apply id="A2.SS1.p1.1.m1.2.3.3.cmml" xref="A2.SS1.p1.1.m1.2.3.3"><times id="A2.SS1.p1.1.m1.2.3.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.3.1"></times><ci id="A2.SS1.p1.1.m1.2.3.3.2.cmml" xref="A2.SS1.p1.1.m1.2.3.3.2">𝒩</ci><interval closure="open" id="A2.SS1.p1.1.m1.2.3.3.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.3.3.2"><cn id="A2.SS1.p1.1.m1.1.1.cmml" type="integer" xref="A2.SS1.p1.1.m1.1.1">0</cn><cn id="A2.SS1.p1.1.m1.2.2.cmml" type="integer" xref="A2.SS1.p1.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.2c">\epsilon\sim\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.2d">italic_ϵ ∼ caligraphic_N ( 0 , 1 )</annotation></semantics></math>를 추가하여 각 피험자의 첫 번째 토큰의 임베딩을 손상시킨다. <cite class="ltx_cite ltx_citemacro_cite">Meng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib31" title="">2022a</a>)</cite>에서 저자는 텍스트 본문에 걸쳐 샘플링된 토큰 임베딩의 관찰된 표준 편차의 3배인 표준 편차 <math alttext="\sigma\approx 0.15" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><mrow id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mi id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">σ</mi><mo id="A2.SS1.p1.2.m2.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.cmml">≈</mo><mn id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml">0.15</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><approx id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1"></approx><ci id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2">𝜎</ci><cn id="A2.SS1.p1.2.m2.1.1.3.cmml" type="float" xref="A2.SS1.p1.2.m2.1.1.3">0.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">\sigma\approx 0.15</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">italic_σ ≈ 0.15</annotation></semantics></math>로 가우시안 노이즈를 추가하여 임베딩 손상을 수행한다. 그러나 이 표준 편차가 너무 작아서 참 개체 및 부정확 개체 쌍의 상대 로그 가능성을 크게 변경할 수 없는 경우가 많기 때문에 대신 <math alttext="\sigma=1" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.1"><semantics id="A2.SS1.p1.3.m3.1a"><mrow id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml"><mi id="A2.SS1.p1.3.m3.1.1.2" xref="A2.SS1.p1.3.m3.1.1.2.cmml">σ</mi><mo id="A2.SS1.p1.3.m3.1.1.1" xref="A2.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS1.p1.3.m3.1.1.3" xref="A2.SS1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><apply id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1"><eq id="A2.SS1.p1.3.m3.1.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1.1"></eq><ci id="A2.SS1.p1.3.m3.1.1.2.cmml" xref="A2.SS1.p1.3.m3.1.1.2">𝜎</ci><cn id="A2.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="A2.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">\sigma=1</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.1d">italic_σ = 1</annotation></semantics></math>를 설정했다. 텍스트의 각 실행에 대해, 프로세스는 상대 로그 가능성 <math alttext="y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}" class="ltx_Math" display="inline" id="A2.SS1.p1.4.m4.4"><semantics id="A2.SS1.p1.4.m4.4a"><mrow id="A2.SS1.p1.4.m4.4.5" xref="A2.SS1.p1.4.m4.4.5.cmml"><mi id="A2.SS1.p1.4.m4.4.5.2" xref="A2.SS1.p1.4.m4.4.5.2.cmml">y</mi><mo id="A2.SS1.p1.4.m4.4.5.1" xref="A2.SS1.p1.4.m4.4.5.1.cmml">=</mo><mrow id="A2.SS1.p1.4.m4.4.5.3" xref="A2.SS1.p1.4.m4.4.5.3.cmml"><mi id="A2.SS1.p1.4.m4.4.5.3.1" xref="A2.SS1.p1.4.m4.4.5.3.1.cmml">log</mi><mo id="A2.SS1.p1.4.m4.4.5.3a" lspace="0.167em" xref="A2.SS1.p1.4.m4.4.5.3.cmml">⁡</mo><mfrac id="A2.SS1.p1.4.m4.4.4" xref="A2.SS1.p1.4.m4.4.4.cmml"><mrow id="A2.SS1.p1.4.m4.2.2.2" xref="A2.SS1.p1.4.m4.2.2.2.cmml"><mi id="A2.SS1.p1.4.m4.2.2.2.4" xref="A2.SS1.p1.4.m4.2.2.2.4.cmml">p</mi><mo id="A2.SS1.p1.4.m4.2.2.2.3" xref="A2.SS1.p1.4.m4.2.2.2.3.cmml">⁢</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml"><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.2" stretchy="false" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml"><msup id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2.cmml">o</mi><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.1.cmml">|</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mi id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2.cmml">E</mi><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.3.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.3.2.1" stretchy="false" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml">(</mo><mi id="A2.SS1.p1.4.m4.1.1.1.1" xref="A2.SS1.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.3.2.2" stretchy="false" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.3" stretchy="false" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.SS1.p1.4.m4.4.4.4" xref="A2.SS1.p1.4.m4.4.4.4.cmml"><mi id="A2.SS1.p1.4.m4.4.4.4.4" xref="A2.SS1.p1.4.m4.4.4.4.4.cmml">p</mi><mo id="A2.SS1.p1.4.m4.4.4.4.3" xref="A2.SS1.p1.4.m4.4.4.4.3.cmml">⁢</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml"><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.2" stretchy="false" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml">(</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml"><mi id="A2.SS1.p1.4.m4.4.4.4.2.1.1.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.2.cmml">o</mi><mo fence="false" id="A2.SS1.p1.4.m4.4.4.4.2.1.1.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.1.cmml">|</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mi id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2.cmml">E</mi><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1.cmml">⁢</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.3.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.3.2.1" stretchy="false" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml">(</mo><mi id="A2.SS1.p1.4.m4.3.3.3.1" xref="A2.SS1.p1.4.m4.3.3.3.1.cmml">u</mi><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.3.2.2" stretchy="false" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A2.SS1.p1.4.m4.4.4.4.2.1.3" stretchy="false" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.4b"><apply id="A2.SS1.p1.4.m4.4.5.cmml" xref="A2.SS1.p1.4.m4.4.5"><eq id="A2.SS1.p1.4.m4.4.5.1.cmml" xref="A2.SS1.p1.4.m4.4.5.1"></eq><ci id="A2.SS1.p1.4.m4.4.5.2.cmml" xref="A2.SS1.p1.4.m4.4.5.2">𝑦</ci><apply id="A2.SS1.p1.4.m4.4.5.3.cmml" xref="A2.SS1.p1.4.m4.4.5.3"><log id="A2.SS1.p1.4.m4.4.5.3.1.cmml" xref="A2.SS1.p1.4.m4.4.5.3.1"></log><apply id="A2.SS1.p1.4.m4.4.4.cmml" xref="A2.SS1.p1.4.m4.4.4"><divide id="A2.SS1.p1.4.m4.4.4.5.cmml" xref="A2.SS1.p1.4.m4.4.4"></divide><apply id="A2.SS1.p1.4.m4.2.2.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2"><times id="A2.SS1.p1.4.m4.2.2.2.3.cmml" xref="A2.SS1.p1.4.m4.2.2.2.3"></times><ci id="A2.SS1.p1.4.m4.2.2.2.4.cmml" xref="A2.SS1.p1.4.m4.2.2.2.4">𝑝</ci><apply id="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.1">conditional</csymbol><apply id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2">superscript</csymbol><ci id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2">𝑜</ci><ci id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3">′</ci></apply><apply id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3"><times id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1"></times><ci id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2">𝐸</ci><ci id="A2.SS1.p1.4.m4.1.1.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="A2.SS1.p1.4.m4.4.4.4.cmml" xref="A2.SS1.p1.4.m4.4.4.4"><times id="A2.SS1.p1.4.m4.4.4.4.3.cmml" xref="A2.SS1.p1.4.m4.4.4.4.3"></times><ci id="A2.SS1.p1.4.m4.4.4.4.4.cmml" xref="A2.SS1.p1.4.m4.4.4.4.4">𝑝</ci><apply id="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1"><csymbol cd="latexml" id="A2.SS1.p1.4.m4.4.4.4.2.1.1.1.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.1">conditional</csymbol><ci id="A2.SS1.p1.4.m4.4.4.4.2.1.1.2.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.2">𝑜</ci><apply id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3"><times id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1"></times><ci id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2">𝐸</ci><ci id="A2.SS1.p1.4.m4.3.3.3.1.cmml" xref="A2.SS1.p1.4.m4.3.3.3.1">𝑢</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.4c">y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.4.m4.4d">italic_y = roman_log divide start_ARG italic_p ( italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_E ( italic_u ) ) end_ARG start_ARG italic_p ( italic_o | italic_E ( italic_u ) ) end_ARG</annotation></semantics></math>를 감소시킬 수 있는 10개의 독립적으로 샘플링된 노이즈 세트를 얻을 때까지, 서로 다른 부패 노이즈 샘플로 여러 번 반복된다. 평균적으로 샘플링된 노이즈의 약 71.1%가 <math alttext="y" class="ltx_Math" display="inline" id="A2.SS1.p1.5.m5.1"><semantics id="A2.SS1.p1.5.m5.1a"><mi id="A2.SS1.p1.5.m5.1.1" xref="A2.SS1.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.5.m5.1b"><ci id="A2.SS1.p1.5.m5.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.5.m5.1c">y</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.5.m5.1d">italic_y</annotation></semantics></math>를 감소시키며(즉, 모델을 더 "진실"하게 만들며), 평균적으로 이러한 유효한 노이즈를 주입하면 상대 로그 우도가 11.7에서 2.3으로 감소한다는 것을 발견했다.</p>
</div>
<figure class="ltx_table" id="A2.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A2.T3.1" style="width:433.6pt;height:96.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-67.1pt,14.9pt) scale(0.763637983767333,0.763637983767333) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T3.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T3.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T3.1.1.1.1.1">prompt</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.2">subject</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.3">relation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.4">true object</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.5">predicted object</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T3.1.1.1.1.6">hallucination mechanism</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T3.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T3.1.1.2.1.1">Korrespodent is formed in</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.2">Korrespodent</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.3">country of origin</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.4">Ukraine</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.5">April</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.1.2.1.6">early-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.1.3.2.1">Mantecadas, that was created in</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.2">Mantacedas</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.3">country of origin</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.4">Spain</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.5">Japan</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.3.2.6">early-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.1.4.3.1">Asprey’s headquarters are in</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.2">Asprey</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.3">headquarters location</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.4">London</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.5">New</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.4.3.6">early-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.1.5.4.1">Opgezwolle was developed in</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.2">Opgezwolle</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.3">country of origin</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.4">Netherlands</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.5">Belgium</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.5.4.6">late-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.1.6.5.1">Israel maintains diplomatic relations with</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.2">Israel</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.3">diplomatic relation</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.4">India</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.5">Israel</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.1.6.5.6">late-site</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T3.1.1.7.6.1">Germany shares its border with</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.2">Germany</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.3">shares border with</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.4">Luxemburg</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.5">Russia</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T3.1.1.7.6.6">late-site</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 3:</span>GPT-2-XL에 의해 만들어진 초기 사이트 및 후기 사이트 환각의 예.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Causal tracing results on GPTs</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">그림 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F6" title="Figure 6 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> 및 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F9" title="Figure 9 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">9</span></a>는 각각 Pararel에서 GPT-2-XL 및 GPT-J에 대한 인과적 AIE 분포를 보여준다. Llama-2-7b의 경우와 유사하게 대부분의 인과적 기여 은닉 표상은 초기 사이트 계층에 있는 주제 토큰의 모델 구성 요소와 후기 사이트 계층에 있는 관계 토큰에 의해 생성된다는 것을 관찰한다. 그림 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F7" title="Figure 7 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">7</span></a> 및 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F10" title="Figure 10 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">10</span></a>는 Llama-2-7b와 동일한 상대 IE의 범주화 메트릭을 사용하여 두 개의 GPT 모델에 의한 초기 사이트 및 후기 사이트 환각에 대한 분류 AIE 분포를 추가로 보여준다. 다시 말하지만, 초기 사이트 환각은 주제 토큰을 풍부하게 할 때 하위 계층의 MLP 모듈에 의해 대부분 발생하는 반면, 후기 사이트 환각은 관계 토큰을 처리할 때 상위 계층 주의 및 MLP에 의한 실패에 크게 기인할 수 있음을 발견했다.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Examples of early-site and late-site hallucinations</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">표 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.T3" title="Table 3 ‣ B.1 Experiment details ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>는 GPT-2-XL에 의해 만들어진 초기 사이트 및 후기 사이트 환각의 세트로부터 무작위로 그려진 몇 가지 예를 제시한다. 우리는 후기 현장 환각의 많은 예에서 모델이 입력과 출력의 관계 정보를 무시하는 경향이 있음을 발견했다. 반면에, 초기 현장 환각의 경우, 모델 예측된 객체들은 종종 질의와 훨씬 덜 관련되며, 이는 질의된 주제 엔티티에 대한 일반적인 지식의 부족을 시사한다.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Embedding space projection results on GPTs</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS4.p1">
<p class="ltx_p" id="A2.SS4.p1.1">그림 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F8" title="Figure 8 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">8</span></a>와 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A2.F11" title="Figure 11 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">11</span></a>는 GPT-2-XL과 GPT-J가 만든 사실적 정답, 초기사이트 환각 및 후기사이트 환각에 대한 임베딩 공간 투영 결과를 보여준다. 다시 말하지만, 우리는 진답에 대한 계층별 MLP 기여 프로파일이 후기 현장 환각 및 사실 예측에 대해 매우 유사하다는 것을 관찰하며, 이는 일부 사실 오류 사례의 경우 초기 현장 MLP가 여전히 제대로 작동하고 있음을 시사한다. 대조적으로, 사실적 답변에 대한 주의 컴포넌트의 기여 프로파일은 환각적 답변과 상당히 다르며, 이는 두 유형의 환각에 대해 상위 계층 주의 헤드가 질의 주제와 가장 관련성이 높은 객체 엔티티를 선택하지 못함을 나타낸다.</p>
</div>
<figure class="ltx_figure" id="A2.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="140" id="A2.F6.g1" src="https://arxiv.org/html/2403.18167v1/x7.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 6:</span><span class="ltx_text ltx_font_bold" id="A2.F6.2.1">Average Indirect Effect (AIE)</span> of individual model components to non-factual 환각 over ParaRel queries is incorrectly answered by GPT-2-XL.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="A2.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="860" id="A2.F6.sf1.g1" src="https://arxiv.org/html/2403.18167v1/x8.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Early-site hallucinations (<math alttext="\Delta\text{AIE}(y,u)<0" class="ltx_Math" display="inline" id="A2.F6.sf1.2.m1.2"><semantics id="A2.F6.sf1.2.m1.2b"><mrow id="A2.F6.sf1.2.m1.2.3" xref="A2.F6.sf1.2.m1.2.3.cmml"><mrow id="A2.F6.sf1.2.m1.2.3.2" xref="A2.F6.sf1.2.m1.2.3.2.cmml"><mi id="A2.F6.sf1.2.m1.2.3.2.2" mathvariant="normal" xref="A2.F6.sf1.2.m1.2.3.2.2.cmml">Δ</mi><mo id="A2.F6.sf1.2.m1.2.3.2.1" xref="A2.F6.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mtext id="A2.F6.sf1.2.m1.2.3.2.3" xref="A2.F6.sf1.2.m1.2.3.2.3a.cmml">AIE</mtext><mo id="A2.F6.sf1.2.m1.2.3.2.1b" xref="A2.F6.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="A2.F6.sf1.2.m1.2.3.2.4.2" xref="A2.F6.sf1.2.m1.2.3.2.4.1.cmml"><mo id="A2.F6.sf1.2.m1.2.3.2.4.2.1" stretchy="false" xref="A2.F6.sf1.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F6.sf1.2.m1.1.1" xref="A2.F6.sf1.2.m1.1.1.cmml">y</mi><mo id="A2.F6.sf1.2.m1.2.3.2.4.2.2" xref="A2.F6.sf1.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F6.sf1.2.m1.2.2" xref="A2.F6.sf1.2.m1.2.2.cmml">u</mi><mo id="A2.F6.sf1.2.m1.2.3.2.4.2.3" stretchy="false" xref="A2.F6.sf1.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F6.sf1.2.m1.2.3.1" xref="A2.F6.sf1.2.m1.2.3.1.cmml">&lt;</mo><mn id="A2.F6.sf1.2.m1.2.3.3" xref="A2.F6.sf1.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.sf1.2.m1.2c"><apply id="A2.F6.sf1.2.m1.2.3.cmml" xref="A2.F6.sf1.2.m1.2.3"><lt id="A2.F6.sf1.2.m1.2.3.1.cmml" xref="A2.F6.sf1.2.m1.2.3.1"></lt><apply id="A2.F6.sf1.2.m1.2.3.2.cmml" xref="A2.F6.sf1.2.m1.2.3.2"><times id="A2.F6.sf1.2.m1.2.3.2.1.cmml" xref="A2.F6.sf1.2.m1.2.3.2.1"></times><ci id="A2.F6.sf1.2.m1.2.3.2.2.cmml" xref="A2.F6.sf1.2.m1.2.3.2.2">Δ</ci><ci id="A2.F6.sf1.2.m1.2.3.2.3a.cmml" xref="A2.F6.sf1.2.m1.2.3.2.3"><mtext id="A2.F6.sf1.2.m1.2.3.2.3.cmml" xref="A2.F6.sf1.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F6.sf1.2.m1.2.3.2.4.1.cmml" xref="A2.F6.sf1.2.m1.2.3.2.4.2"><ci id="A2.F6.sf1.2.m1.1.1.cmml" xref="A2.F6.sf1.2.m1.1.1">𝑦</ci><ci id="A2.F6.sf1.2.m1.2.2.cmml" xref="A2.F6.sf1.2.m1.2.2">𝑢</ci></interval></apply><cn id="A2.F6.sf1.2.m1.2.3.3.cmml" type="integer" xref="A2.F6.sf1.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.sf1.2.m1.2d">\Delta\text{AIE}(y,u)&lt;0</annotation><annotation encoding="application/x-llamapun" id="A2.F6.sf1.2.m1.2e">roman_Δ AIE ( italic_y , italic_u ) &lt; 0</annotation></semantics></math>).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="A2.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="860" id="A2.F6.sf2.g1" src="https://arxiv.org/html/2403.18167v1/x9.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Late-site hallucinations (<math alttext="\Delta\text{AIE}(y,u)\geq 0" class="ltx_Math" display="inline" id="A2.F6.sf2.2.m1.2"><semantics id="A2.F6.sf2.2.m1.2b"><mrow id="A2.F6.sf2.2.m1.2.3" xref="A2.F6.sf2.2.m1.2.3.cmml"><mrow id="A2.F6.sf2.2.m1.2.3.2" xref="A2.F6.sf2.2.m1.2.3.2.cmml"><mi id="A2.F6.sf2.2.m1.2.3.2.2" mathvariant="normal" xref="A2.F6.sf2.2.m1.2.3.2.2.cmml">Δ</mi><mo id="A2.F6.sf2.2.m1.2.3.2.1" xref="A2.F6.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mtext id="A2.F6.sf2.2.m1.2.3.2.3" xref="A2.F6.sf2.2.m1.2.3.2.3a.cmml">AIE</mtext><mo id="A2.F6.sf2.2.m1.2.3.2.1b" xref="A2.F6.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="A2.F6.sf2.2.m1.2.3.2.4.2" xref="A2.F6.sf2.2.m1.2.3.2.4.1.cmml"><mo id="A2.F6.sf2.2.m1.2.3.2.4.2.1" stretchy="false" xref="A2.F6.sf2.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F6.sf2.2.m1.1.1" xref="A2.F6.sf2.2.m1.1.1.cmml">y</mi><mo id="A2.F6.sf2.2.m1.2.3.2.4.2.2" xref="A2.F6.sf2.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F6.sf2.2.m1.2.2" xref="A2.F6.sf2.2.m1.2.2.cmml">u</mi><mo id="A2.F6.sf2.2.m1.2.3.2.4.2.3" stretchy="false" xref="A2.F6.sf2.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F6.sf2.2.m1.2.3.1" xref="A2.F6.sf2.2.m1.2.3.1.cmml">≥</mo><mn id="A2.F6.sf2.2.m1.2.3.3" xref="A2.F6.sf2.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F6.sf2.2.m1.2c"><apply id="A2.F6.sf2.2.m1.2.3.cmml" xref="A2.F6.sf2.2.m1.2.3"><geq id="A2.F6.sf2.2.m1.2.3.1.cmml" xref="A2.F6.sf2.2.m1.2.3.1"></geq><apply id="A2.F6.sf2.2.m1.2.3.2.cmml" xref="A2.F6.sf2.2.m1.2.3.2"><times id="A2.F6.sf2.2.m1.2.3.2.1.cmml" xref="A2.F6.sf2.2.m1.2.3.2.1"></times><ci id="A2.F6.sf2.2.m1.2.3.2.2.cmml" xref="A2.F6.sf2.2.m1.2.3.2.2">Δ</ci><ci id="A2.F6.sf2.2.m1.2.3.2.3a.cmml" xref="A2.F6.sf2.2.m1.2.3.2.3"><mtext id="A2.F6.sf2.2.m1.2.3.2.3.cmml" xref="A2.F6.sf2.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F6.sf2.2.m1.2.3.2.4.1.cmml" xref="A2.F6.sf2.2.m1.2.3.2.4.2"><ci id="A2.F6.sf2.2.m1.1.1.cmml" xref="A2.F6.sf2.2.m1.1.1">𝑦</ci><ci id="A2.F6.sf2.2.m1.2.2.cmml" xref="A2.F6.sf2.2.m1.2.2">𝑢</ci></interval></apply><cn id="A2.F6.sf2.2.m1.2.3.3.cmml" type="integer" xref="A2.F6.sf2.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F6.sf2.2.m1.2d">\Delta\text{AIE}(y,u)\geq 0</annotation><annotation encoding="application/x-llamapun" id="A2.F6.sf2.2.m1.2e">roman_Δ AIE ( italic_y , italic_u ) ≥ 0</annotation></semantics></math>).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 7:</span><span class="ltx_text ltx_font_bold" id="A2.F7.2.1">Average Indirect Effect (AIE)</span> for (a) early-site (left column) and (b) late-site (right column) non-factual 환각.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="893" id="A2.F8.g1" src="https://arxiv.org/html/2403.18167v1/x10.png" width="788">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 8:</span>실제 객체 임베딩과 각 계층에서 GPT-2-XL 중간 출력 사이의 평균 내적.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="156" id="A2.F9.g1" src="https://arxiv.org/html/2403.18167v1/x11.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 9: </span><span class="ltx_text ltx_font_bold" id="A2.F9.4.1">Average Indirect Effect (AIE)</span> of individual model components to non-factual 환각 over 6,809 ParaRel queries are incorrectly answered by GPT-J. <math alttext="\Delta\text{AIE}(y,u)" class="ltx_Math" display="inline" id="A2.F9.2.m1.2"><semantics id="A2.F9.2.m1.2b"><mrow id="A2.F9.2.m1.2.3" xref="A2.F9.2.m1.2.3.cmml"><mi id="A2.F9.2.m1.2.3.2" mathvariant="normal" xref="A2.F9.2.m1.2.3.2.cmml">Δ</mi><mo id="A2.F9.2.m1.2.3.1" xref="A2.F9.2.m1.2.3.1.cmml">⁢</mo><mtext id="A2.F9.2.m1.2.3.3" xref="A2.F9.2.m1.2.3.3a.cmml">AIE</mtext><mo id="A2.F9.2.m1.2.3.1b" xref="A2.F9.2.m1.2.3.1.cmml">⁢</mo><mrow id="A2.F9.2.m1.2.3.4.2" xref="A2.F9.2.m1.2.3.4.1.cmml"><mo id="A2.F9.2.m1.2.3.4.2.1" stretchy="false" xref="A2.F9.2.m1.2.3.4.1.cmml">(</mo><mi id="A2.F9.2.m1.1.1" xref="A2.F9.2.m1.1.1.cmml">y</mi><mo id="A2.F9.2.m1.2.3.4.2.2" xref="A2.F9.2.m1.2.3.4.1.cmml">,</mo><mi id="A2.F9.2.m1.2.2" xref="A2.F9.2.m1.2.2.cmml">u</mi><mo id="A2.F9.2.m1.2.3.4.2.3" stretchy="false" xref="A2.F9.2.m1.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F9.2.m1.2c"><apply id="A2.F9.2.m1.2.3.cmml" xref="A2.F9.2.m1.2.3"><times id="A2.F9.2.m1.2.3.1.cmml" xref="A2.F9.2.m1.2.3.1"></times><ci id="A2.F9.2.m1.2.3.2.cmml" xref="A2.F9.2.m1.2.3.2">Δ</ci><ci id="A2.F9.2.m1.2.3.3a.cmml" xref="A2.F9.2.m1.2.3.3"><mtext id="A2.F9.2.m1.2.3.3.cmml" xref="A2.F9.2.m1.2.3.3">AIE</mtext></ci><interval closure="open" id="A2.F9.2.m1.2.3.4.1.cmml" xref="A2.F9.2.m1.2.3.4.2"><ci id="A2.F9.2.m1.1.1.cmml" xref="A2.F9.2.m1.1.1">𝑦</ci><ci id="A2.F9.2.m1.2.2.cmml" xref="A2.F9.2.m1.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.2.m1.2d">\Delta\text{AIE}(y,u)</annotation><annotation encoding="application/x-llamapun" id="A2.F9.2.m1.2e">roman_Δ AIE ( italic_y , italic_u )</annotation></semantics></math> is defined as difference in AIE between 1) the attention outputs of last 14 out of 28 transformer layers and 2) GPT-J의 28개 변압기 층 중 처음 14개의 MLP 출력이다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="A2.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="851" id="A2.F9.sf1.g1" src="https://arxiv.org/html/2403.18167v1/x12.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Early-site hallucinations (<math alttext="\Delta\text{AIE}(y,u)<0" class="ltx_Math" display="inline" id="A2.F9.sf1.2.m1.2"><semantics id="A2.F9.sf1.2.m1.2b"><mrow id="A2.F9.sf1.2.m1.2.3" xref="A2.F9.sf1.2.m1.2.3.cmml"><mrow id="A2.F9.sf1.2.m1.2.3.2" xref="A2.F9.sf1.2.m1.2.3.2.cmml"><mi id="A2.F9.sf1.2.m1.2.3.2.2" mathvariant="normal" xref="A2.F9.sf1.2.m1.2.3.2.2.cmml">Δ</mi><mo id="A2.F9.sf1.2.m1.2.3.2.1" xref="A2.F9.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mtext id="A2.F9.sf1.2.m1.2.3.2.3" xref="A2.F9.sf1.2.m1.2.3.2.3a.cmml">AIE</mtext><mo id="A2.F9.sf1.2.m1.2.3.2.1b" xref="A2.F9.sf1.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="A2.F9.sf1.2.m1.2.3.2.4.2" xref="A2.F9.sf1.2.m1.2.3.2.4.1.cmml"><mo id="A2.F9.sf1.2.m1.2.3.2.4.2.1" stretchy="false" xref="A2.F9.sf1.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F9.sf1.2.m1.1.1" xref="A2.F9.sf1.2.m1.1.1.cmml">y</mi><mo id="A2.F9.sf1.2.m1.2.3.2.4.2.2" xref="A2.F9.sf1.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F9.sf1.2.m1.2.2" xref="A2.F9.sf1.2.m1.2.2.cmml">u</mi><mo id="A2.F9.sf1.2.m1.2.3.2.4.2.3" stretchy="false" xref="A2.F9.sf1.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F9.sf1.2.m1.2.3.1" xref="A2.F9.sf1.2.m1.2.3.1.cmml">&lt;</mo><mn id="A2.F9.sf1.2.m1.2.3.3" xref="A2.F9.sf1.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F9.sf1.2.m1.2c"><apply id="A2.F9.sf1.2.m1.2.3.cmml" xref="A2.F9.sf1.2.m1.2.3"><lt id="A2.F9.sf1.2.m1.2.3.1.cmml" xref="A2.F9.sf1.2.m1.2.3.1"></lt><apply id="A2.F9.sf1.2.m1.2.3.2.cmml" xref="A2.F9.sf1.2.m1.2.3.2"><times id="A2.F9.sf1.2.m1.2.3.2.1.cmml" xref="A2.F9.sf1.2.m1.2.3.2.1"></times><ci id="A2.F9.sf1.2.m1.2.3.2.2.cmml" xref="A2.F9.sf1.2.m1.2.3.2.2">Δ</ci><ci id="A2.F9.sf1.2.m1.2.3.2.3a.cmml" xref="A2.F9.sf1.2.m1.2.3.2.3"><mtext id="A2.F9.sf1.2.m1.2.3.2.3.cmml" xref="A2.F9.sf1.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F9.sf1.2.m1.2.3.2.4.1.cmml" xref="A2.F9.sf1.2.m1.2.3.2.4.2"><ci id="A2.F9.sf1.2.m1.1.1.cmml" xref="A2.F9.sf1.2.m1.1.1">𝑦</ci><ci id="A2.F9.sf1.2.m1.2.2.cmml" xref="A2.F9.sf1.2.m1.2.2">𝑢</ci></interval></apply><cn id="A2.F9.sf1.2.m1.2.3.3.cmml" type="integer" xref="A2.F9.sf1.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.sf1.2.m1.2d">\Delta\text{AIE}(y,u)&lt;0</annotation><annotation encoding="application/x-llamapun" id="A2.F9.sf1.2.m1.2e">roman_Δ AIE ( italic_y , italic_u ) &lt; 0</annotation></semantics></math>)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="A2.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="877" id="A2.F9.sf2.g1" src="https://arxiv.org/html/2403.18167v1/x13.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Late-site hallucinations (<math alttext="\Delta\text{AIE}(y,u)\geq 0" class="ltx_Math" display="inline" id="A2.F9.sf2.2.m1.2"><semantics id="A2.F9.sf2.2.m1.2b"><mrow id="A2.F9.sf2.2.m1.2.3" xref="A2.F9.sf2.2.m1.2.3.cmml"><mrow id="A2.F9.sf2.2.m1.2.3.2" xref="A2.F9.sf2.2.m1.2.3.2.cmml"><mi id="A2.F9.sf2.2.m1.2.3.2.2" mathvariant="normal" xref="A2.F9.sf2.2.m1.2.3.2.2.cmml">Δ</mi><mo id="A2.F9.sf2.2.m1.2.3.2.1" xref="A2.F9.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mtext id="A2.F9.sf2.2.m1.2.3.2.3" xref="A2.F9.sf2.2.m1.2.3.2.3a.cmml">AIE</mtext><mo id="A2.F9.sf2.2.m1.2.3.2.1b" xref="A2.F9.sf2.2.m1.2.3.2.1.cmml">⁢</mo><mrow id="A2.F9.sf2.2.m1.2.3.2.4.2" xref="A2.F9.sf2.2.m1.2.3.2.4.1.cmml"><mo id="A2.F9.sf2.2.m1.2.3.2.4.2.1" stretchy="false" xref="A2.F9.sf2.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F9.sf2.2.m1.1.1" xref="A2.F9.sf2.2.m1.1.1.cmml">y</mi><mo id="A2.F9.sf2.2.m1.2.3.2.4.2.2" xref="A2.F9.sf2.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F9.sf2.2.m1.2.2" xref="A2.F9.sf2.2.m1.2.2.cmml">u</mi><mo id="A2.F9.sf2.2.m1.2.3.2.4.2.3" stretchy="false" xref="A2.F9.sf2.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F9.sf2.2.m1.2.3.1" xref="A2.F9.sf2.2.m1.2.3.1.cmml">≥</mo><mn id="A2.F9.sf2.2.m1.2.3.3" xref="A2.F9.sf2.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F9.sf2.2.m1.2c"><apply id="A2.F9.sf2.2.m1.2.3.cmml" xref="A2.F9.sf2.2.m1.2.3"><geq id="A2.F9.sf2.2.m1.2.3.1.cmml" xref="A2.F9.sf2.2.m1.2.3.1"></geq><apply id="A2.F9.sf2.2.m1.2.3.2.cmml" xref="A2.F9.sf2.2.m1.2.3.2"><times id="A2.F9.sf2.2.m1.2.3.2.1.cmml" xref="A2.F9.sf2.2.m1.2.3.2.1"></times><ci id="A2.F9.sf2.2.m1.2.3.2.2.cmml" xref="A2.F9.sf2.2.m1.2.3.2.2">Δ</ci><ci id="A2.F9.sf2.2.m1.2.3.2.3a.cmml" xref="A2.F9.sf2.2.m1.2.3.2.3"><mtext id="A2.F9.sf2.2.m1.2.3.2.3.cmml" xref="A2.F9.sf2.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F9.sf2.2.m1.2.3.2.4.1.cmml" xref="A2.F9.sf2.2.m1.2.3.2.4.2"><ci id="A2.F9.sf2.2.m1.1.1.cmml" xref="A2.F9.sf2.2.m1.1.1">𝑦</ci><ci id="A2.F9.sf2.2.m1.2.2.cmml" xref="A2.F9.sf2.2.m1.2.2">𝑢</ci></interval></apply><cn id="A2.F9.sf2.2.m1.2.3.3.cmml" type="integer" xref="A2.F9.sf2.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.sf2.2.m1.2d">\Delta\text{AIE}(y,u)\geq 0</annotation><annotation encoding="application/x-llamapun" id="A2.F9.sf2.2.m1.2e">roman_Δ AIE ( italic_y , italic_u ) ≥ 0</annotation></semantics></math>)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 10:</span><span class="ltx_text ltx_font_bold" id="A2.F10.2.1">Average Indirect Effect (AIE)</span> for (a) early-site (left column) and (b) late-site (right column) non-factual 환각.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="882" id="A2.F11.g1" src="https://arxiv.org/html/2403.18167v1/x14.png" width="789">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 11:</span>각 계층에서 진정한 객체 임베딩과 GPT-J 중간 출력 사이의 평균 내적.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Evaluation of Pythia Models</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">구축된 ParaRel 질의 데이터 셋에 대해 Pythia-1.4B (24개의 레이어, 2048개의 차원 은닉 상태, 16개의 어텐션 헤드)를 평가하여 환각 진화 역학의 임베딩 공간 투영 분석을 수행한다. 각 피티아 모델은 교육 전반에 걸쳐 저장된 154개의 체크포인트를 특징으로 하며, 인덱스 0이 있는 첫 번째 체크포인트에서 시작하여 5단계마다 하나씩 취하고 마지막 체크포인트(즉, 체크포인트-0, 체크포인트-5, 체크포인트-10,…, 체크포인트-150, 체크포인트-153)를 사용하여 피티아1.4B의 32개의 체크포인트를 사용한다. 각 환각 질의의 메커니즘을 분류하기 위해 피티아-1.4B의 체크포인트-153에 대한 3단계 인과 매개 분석을 실행하고 MLP, 주의 및 잔차 스트림에 대한 평균 간접 효과를 계산한다. GPT-2-XL 실험과 동일하게 첫 번째 주제 토큰에 표준 가우시안 잡음을 주입하여 입력 질의를 손상시키고, 각 질의에 대해 상대 객체 우도 <math alttext="y" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">italic_y</annotation></semantics></math>를 감소시키는 10개의 독립적으로 샘플링된 잡음을 취한다.</p>
</div>
<figure class="ltx_table" id="A3.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A3.T4.1" style="width:346.9pt;height:77.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-40.3pt,9.0pt) scale(0.81129616433058,0.81129616433058) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T4.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A3.T4.1.1.1.1.1">Question</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T4.1.1.1.1.2">True answers</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T4.1.1.1.1.3">False answer</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T4.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T4.1.1.2.1.1">who ordered the forbidden city to be built</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T4.1.1.2.1.2">Zhu Di</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T4.1.1.2.1.3">Emperor Qin Shi Huang</td>
</tr>
<tr class="ltx_tr" id="A3.T4.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T4.1.1.3.2.1">who has won the most games in nfl 2017</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T4.1.1.3.2.2">Dallas Cowboys</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T4.1.1.3.2.3">Tom Brady</td>
</tr>
<tr class="ltx_tr" id="A3.T4.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A3.T4.1.1.4.3.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T4.1.1.4.3.1.1">
<tbody><tr class="ltx_tr" id="A3.T4.1.1.4.3.1.1.1">
<td class="ltx_td ltx_align_left" id="A3.T4.1.1.4.3.1.1.1.1">who was the famous scientist that</td>
</tr>
<tr class="ltx_tr" id="A3.T4.1.1.4.3.1.1.2">
<td class="ltx_td ltx_align_left" id="A3.T4.1.1.4.3.1.1.2.1">ran the research lab moseley went to in manchester</td>
</tr>
</tbody></table>
</th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A3.T4.1.1.4.3.2">Sir Ernest Rutherford</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A3.T4.1.1.4.3.3">Albert Einstein</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4:</span>NaturalQA dataset의 Sample questions.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A3.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A3.T5.1" style="width:433.6pt;height:168.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.5pt,29.0pt) scale(0.744233430442375,0.744233430442375) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T5.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T5.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T5.1.1.1.1.1">Question</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T5.1.1.1.1.2">True answers</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T5.1.1.1.1.3">False answers</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T5.1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T5.1.1.2.1.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.2.1.1.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.2.1.1.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.1.1.1.1">What happens to you</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.1.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.1.1.2.1">if you eat watermelon seeds?</td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T5.1.1.2.1.2">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.2.1.2.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.1.1">1) Nothing happens;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.2.1">2) You eat watermelon seeds;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.3">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.3.1">3) The watermelon seeds pass through your digestive system;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.4">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.4.1">4) You will not digest the watermelon seeds;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.2.1.5">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.2.1.5.1">5) The watermelon seeds will be excreted;</td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T5.1.1.2.1.3">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.2.1.3.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.1.1">1) You grow watermelons in your stomach;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.2.1">2) You get sick;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.3">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.3.1">3) You have bad dreams;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.4">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.4.1">4) You die;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.5">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.5.1">5) You get indigestion;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.6">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.6.1">6) You fall unconscious;</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.2.1.3.1.7">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.2.1.3.1.7.1">7) You digest the watermelon seeds</td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T5.1.1.3.2.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.3.2.1.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.3.2.1.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.1.1.1.1">Who said, "Only the dead</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.1.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.1.1.2.1">have seen the end of war?"</td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T5.1.1.3.2.2">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.3.2.2.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.3.2.2.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.2.1.1.1">1) George Santayana wrote</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.2.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.2.1.2.1">"Only the dead have seen the end of war";</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.2.1.3">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.2.1.3.1">2) General Douglas MacArthur misattributed</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.2.1.4">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.2.1.4.1">the quote to Plato in a farewell speech</td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T5.1.1.3.2.3">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.1.3.2.3.1">
<tbody><tr class="ltx_tr" id="A3.T5.1.1.3.2.3.1.1">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.3.1.1.1">1) Plato said, "Only the dead</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.3.1.2">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.3.1.2.1">have seen the end of war";</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.3.1.3">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.3.1.3.1">2) Douglas MacArthur first said,</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.3.2.3.1.4">
<td class="ltx_td ltx_align_left" id="A3.T5.1.1.3.2.3.1.4.1">"Only the dead have seen the end of war"</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 5:</span>TruthfulQA 데이터 세트의 샘플 질문.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Hallucination Detection</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Example data from Natural Questions and TruthfulQA</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.1">표 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A3.T4" title="Table 4 ‣ Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> 및 <a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#A3.T5" title="Table 5 ‣ Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>는 각각 NaturalQA 및 TruthfulQA 데이터 세트의 예제 항목을 보여줍니다. ParaRel에 비해 이러한 데이터 세트의 입력 형태는 더 다양하며 광범위한 세계 지식을 포함한다.</p>
</div>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Details of causal attribution approximation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS2.p1">
<p class="ltx_p" id="A4.SS2.p1.9">뉴런 수준의 인과 효과를 정확하게 계산하려면 한 번에 하나의 뉴런을 대상으로 하여 각 쿼리에 대해 수천 개의 순방향 모델을 통과시켜야 한다. 따라서 우리는 <cite class="ltx_cite ltx_citemacro_cite">Nanda (<a class="ltx_ref" href="https://arxiv.org/html/2403.18167v1#bib.bib35" title="">2023</a>)</cite>에 소개된 속성 패치 방법을 하나의 순방향 및 역방향 패스를 통해 모든 뉴런에 대한 인과 효과를 근사적으로 계산하는 데 적용한다. 형식적으로, 모델이 가장 가능성 있는 답변으로 간주하는 입력 프롬프트 <math alttext="u" class="ltx_Math" display="inline" id="A4.SS2.p1.1.m1.1"><semantics id="A4.SS2.p1.1.m1.1a"><mi id="A4.SS2.p1.1.m1.1.1" xref="A4.SS2.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.1.m1.1b"><ci id="A4.SS2.p1.1.m1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.1.m1.1d">italic_u</annotation></semantics></math> 및 연속 시퀀스 <math alttext="c" class="ltx_Math" display="inline" id="A4.SS2.p1.2.m2.1"><semantics id="A4.SS2.p1.2.m2.1a"><mi id="A4.SS2.p1.2.m2.1.1" xref="A4.SS2.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.m2.1b"><ci id="A4.SS2.p1.2.m2.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.2.m2.1d">italic_c</annotation></semantics></math>에 대해(여기서 <math alttext="y" class="ltx_Math" display="inline" id="A4.SS2.p1.3.m3.1"><semantics id="A4.SS2.p1.3.m3.1a"><mi id="A4.SS2.p1.3.m3.1.1" xref="A4.SS2.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.3.m3.1b"><ci id="A4.SS2.p1.3.m3.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.3.m3.1d">italic_y</annotation></semantics></math>는 더 이상 두 토큰 사이의 로그 확률 비율이 아니라 토큰의 시퀀스의 로그 확률이라는 점에 유의한다). <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.4.m4.1"><semantics id="A4.SS2.p1.4.m4.1a"><mi id="A4.SS2.p1.4.m4.1.1" xref="A4.SS2.p1.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.4.m4.1b"><ci id="A4.SS2.p1.4.m4.1.1.cmml" xref="A4.SS2.p1.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.4.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.4.m4.1d">italic_z</annotation></semantics></math>, <math alttext="z^{*}" class="ltx_Math" display="inline" id="A4.SS2.p1.5.m5.1"><semantics id="A4.SS2.p1.5.m5.1a"><msup id="A4.SS2.p1.5.m5.1.1" xref="A4.SS2.p1.5.m5.1.1.cmml"><mi id="A4.SS2.p1.5.m5.1.1.2" xref="A4.SS2.p1.5.m5.1.1.2.cmml">z</mi><mo id="A4.SS2.p1.5.m5.1.1.3" xref="A4.SS2.p1.5.m5.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.5.m5.1b"><apply id="A4.SS2.p1.5.m5.1.1.cmml" xref="A4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A4.SS2.p1.5.m5.1.1.1.cmml" xref="A4.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="A4.SS2.p1.5.m5.1.1.2.cmml" xref="A4.SS2.p1.5.m5.1.1.2">𝑧</ci><times id="A4.SS2.p1.5.m5.1.1.3.cmml" xref="A4.SS2.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.5.m5.1c">z^{*}</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.5.m5.1d">italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>를 각각 원본 및 노이즈 주입 입력 임베딩 <math alttext="E(u),E^{*}(u)" class="ltx_Math" display="inline" id="A4.SS2.p1.6.m6.4"><semantics id="A4.SS2.p1.6.m6.4a"><mrow id="A4.SS2.p1.6.m6.4.4.2" xref="A4.SS2.p1.6.m6.4.4.3.cmml"><mrow id="A4.SS2.p1.6.m6.3.3.1.1" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml"><mi id="A4.SS2.p1.6.m6.3.3.1.1.2" xref="A4.SS2.p1.6.m6.3.3.1.1.2.cmml">E</mi><mo id="A4.SS2.p1.6.m6.3.3.1.1.1" xref="A4.SS2.p1.6.m6.3.3.1.1.1.cmml">⁢</mo><mrow id="A4.SS2.p1.6.m6.3.3.1.1.3.2" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml"><mo id="A4.SS2.p1.6.m6.3.3.1.1.3.2.1" stretchy="false" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml">(</mo><mi id="A4.SS2.p1.6.m6.1.1" xref="A4.SS2.p1.6.m6.1.1.cmml">u</mi><mo id="A4.SS2.p1.6.m6.3.3.1.1.3.2.2" stretchy="false" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="A4.SS2.p1.6.m6.4.4.2.3" xref="A4.SS2.p1.6.m6.4.4.3.cmml">,</mo><mrow id="A4.SS2.p1.6.m6.4.4.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml"><msup id="A4.SS2.p1.6.m6.4.4.2.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.2.cmml"><mi id="A4.SS2.p1.6.m6.4.4.2.2.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.2.2.cmml">E</mi><mo id="A4.SS2.p1.6.m6.4.4.2.2.2.3" xref="A4.SS2.p1.6.m6.4.4.2.2.2.3.cmml">*</mo></msup><mo id="A4.SS2.p1.6.m6.4.4.2.2.1" xref="A4.SS2.p1.6.m6.4.4.2.2.1.cmml">⁢</mo><mrow id="A4.SS2.p1.6.m6.4.4.2.2.3.2" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml"><mo id="A4.SS2.p1.6.m6.4.4.2.2.3.2.1" stretchy="false" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml">(</mo><mi id="A4.SS2.p1.6.m6.2.2" xref="A4.SS2.p1.6.m6.2.2.cmml">u</mi><mo id="A4.SS2.p1.6.m6.4.4.2.2.3.2.2" stretchy="false" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.6.m6.4b"><list id="A4.SS2.p1.6.m6.4.4.3.cmml" xref="A4.SS2.p1.6.m6.4.4.2"><apply id="A4.SS2.p1.6.m6.3.3.1.1.cmml" xref="A4.SS2.p1.6.m6.3.3.1.1"><times id="A4.SS2.p1.6.m6.3.3.1.1.1.cmml" xref="A4.SS2.p1.6.m6.3.3.1.1.1"></times><ci id="A4.SS2.p1.6.m6.3.3.1.1.2.cmml" xref="A4.SS2.p1.6.m6.3.3.1.1.2">𝐸</ci><ci id="A4.SS2.p1.6.m6.1.1.cmml" xref="A4.SS2.p1.6.m6.1.1">𝑢</ci></apply><apply id="A4.SS2.p1.6.m6.4.4.2.2.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2"><times id="A4.SS2.p1.6.m6.4.4.2.2.1.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.1"></times><apply id="A4.SS2.p1.6.m6.4.4.2.2.2.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2"><csymbol cd="ambiguous" id="A4.SS2.p1.6.m6.4.4.2.2.2.1.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2">superscript</csymbol><ci id="A4.SS2.p1.6.m6.4.4.2.2.2.2.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2.2">𝐸</ci><times id="A4.SS2.p1.6.m6.4.4.2.2.2.3.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2.3"></times></apply><ci id="A4.SS2.p1.6.m6.2.2.cmml" xref="A4.SS2.p1.6.m6.2.2">𝑢</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.6.m6.4c">E(u),E^{*}(u)</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.6.m6.4d">italic_E ( italic_u ) , italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_u )</annotation></semantics></math>를 취할 때 뉴런의 활성화 값(즉, 특정 트랜스포머 레이어에서 입력 토큰의 은닉 상태의 차원)으로 하고, <math alttext="g(z)=\nabla_{z}y,g(z^{*})=\nabla_{z^{*}}y_{*}" class="ltx_Math" display="inline" id="A4.SS2.p1.7.m7.3"><semantics id="A4.SS2.p1.7.m7.3a"><mrow id="A4.SS2.p1.7.m7.3.3.2" xref="A4.SS2.p1.7.m7.3.3.3.cmml"><mrow id="A4.SS2.p1.7.m7.2.2.1.1" xref="A4.SS2.p1.7.m7.2.2.1.1.cmml"><mrow id="A4.SS2.p1.7.m7.2.2.1.1.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml"><mi id="A4.SS2.p1.7.m7.2.2.1.1.2.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.2.cmml">g</mi><mo id="A4.SS2.p1.7.m7.2.2.1.1.2.1" xref="A4.SS2.p1.7.m7.2.2.1.1.2.1.cmml">⁢</mo><mrow id="A4.SS2.p1.7.m7.2.2.1.1.2.3.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml"><mo id="A4.SS2.p1.7.m7.2.2.1.1.2.3.2.1" stretchy="false" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml">(</mo><mi id="A4.SS2.p1.7.m7.1.1" xref="A4.SS2.p1.7.m7.1.1.cmml">z</mi><mo id="A4.SS2.p1.7.m7.2.2.1.1.2.3.2.2" stretchy="false" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.SS2.p1.7.m7.2.2.1.1.1" xref="A4.SS2.p1.7.m7.2.2.1.1.1.cmml">=</mo><mrow id="A4.SS2.p1.7.m7.2.2.1.1.3" xref="A4.SS2.p1.7.m7.2.2.1.1.3.cmml"><msub id="A4.SS2.p1.7.m7.2.2.1.1.3.1" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.cmml"><mo id="A4.SS2.p1.7.m7.2.2.1.1.3.1.2" rspace="0.167em" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.2.cmml">∇</mo><mi id="A4.SS2.p1.7.m7.2.2.1.1.3.1.3" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.3.cmml">z</mi></msub><mi id="A4.SS2.p1.7.m7.2.2.1.1.3.2" xref="A4.SS2.p1.7.m7.2.2.1.1.3.2.cmml">y</mi></mrow></mrow><mo id="A4.SS2.p1.7.m7.3.3.2.3" xref="A4.SS2.p1.7.m7.3.3.3a.cmml">,</mo><mrow id="A4.SS2.p1.7.m7.3.3.2.2" xref="A4.SS2.p1.7.m7.3.3.2.2.cmml"><mrow id="A4.SS2.p1.7.m7.3.3.2.2.1" xref="A4.SS2.p1.7.m7.3.3.2.2.1.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.1.3.cmml">g</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.1.2" xref="A4.SS2.p1.7.m7.3.3.2.2.1.2.cmml">⁢</mo><mrow id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml"><mo id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.2" stretchy="false" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml">(</mo><msup id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2.cmml">z</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3.cmml">*</mo></msup><mo id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.3" stretchy="false" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.SS2.p1.7.m7.3.3.2.2.2" xref="A4.SS2.p1.7.m7.3.3.2.2.2.cmml">=</mo><mrow id="A4.SS2.p1.7.m7.3.3.2.2.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.cmml"><msub id="A4.SS2.p1.7.m7.3.3.2.2.3.1" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.cmml"><mo id="A4.SS2.p1.7.m7.3.3.2.2.3.1.2" rspace="0.167em" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.2.cmml">∇</mo><msup id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2.cmml">z</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3.cmml">*</mo></msup></msub><msub id="A4.SS2.p1.7.m7.3.3.2.2.3.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.3.2.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.2.cmml">y</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.3.2.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.3.cmml">*</mo></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.7.m7.3b"><apply id="A4.SS2.p1.7.m7.3.3.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.3a.cmml" xref="A4.SS2.p1.7.m7.3.3.2.3">formulae-sequence</csymbol><apply id="A4.SS2.p1.7.m7.2.2.1.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1"><eq id="A4.SS2.p1.7.m7.2.2.1.1.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.1"></eq><apply id="A4.SS2.p1.7.m7.2.2.1.1.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.2"><times id="A4.SS2.p1.7.m7.2.2.1.1.2.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.2.1"></times><ci id="A4.SS2.p1.7.m7.2.2.1.1.2.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.2.2">𝑔</ci><ci id="A4.SS2.p1.7.m7.1.1.cmml" xref="A4.SS2.p1.7.m7.1.1">𝑧</ci></apply><apply id="A4.SS2.p1.7.m7.2.2.1.1.3.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3"><apply id="A4.SS2.p1.7.m7.2.2.1.1.3.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.2.2.1.1.3.1.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1">subscript</csymbol><ci id="A4.SS2.p1.7.m7.2.2.1.1.3.1.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.2">∇</ci><ci id="A4.SS2.p1.7.m7.2.2.1.1.3.1.3.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.3">𝑧</ci></apply><ci id="A4.SS2.p1.7.m7.2.2.1.1.3.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.2">𝑦</ci></apply></apply><apply id="A4.SS2.p1.7.m7.3.3.2.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2"><eq id="A4.SS2.p1.7.m7.3.3.2.2.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.2"></eq><apply id="A4.SS2.p1.7.m7.3.3.2.2.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1"><times id="A4.SS2.p1.7.m7.3.3.2.2.1.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.2"></times><ci id="A4.SS2.p1.7.m7.3.3.2.2.1.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.3">𝑔</ci><apply id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1">superscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2">𝑧</ci><times id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3"></times></apply></apply><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3"><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.3.1.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1">subscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.3.1.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.2">∇</ci><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3">superscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2">𝑧</ci><times id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3"></times></apply></apply><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.3.2.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2">subscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.3.2.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.2">𝑦</ci><times id="A4.SS2.p1.7.m7.3.3.2.2.3.2.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.7.m7.3c">g(z)=\nabla_{z}y,g(z^{*})=\nabla_{z^{*}}y_{*}</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.7.m7.3d">italic_g ( italic_z ) = ∇ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT italic_y , italic_g ( italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ) = ∇ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT</annotation></semantics></math>를 뉴런의 기울기 w.r.t 환각에서의 상대적 로그 우도 및 입력 임베딩 노이즈 <math alttext="\epsilon" class="ltx_Math" display="inline" id="A4.SS2.p1.8.m8.1"><semantics id="A4.SS2.p1.8.m8.1a"><mi id="A4.SS2.p1.8.m8.1.1" xref="A4.SS2.p1.8.m8.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.8.m8.1b"><ci id="A4.SS2.p1.8.m8.1.1.cmml" xref="A4.SS2.p1.8.m8.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.8.m8.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.8.m8.1d">italic_ϵ</annotation></semantics></math>를 주입한 완화 실행으로 <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.9.m9.1"><semantics id="A4.SS2.p1.9.m9.1a"><mi id="A4.SS2.p1.9.m9.1.1" xref="A4.SS2.p1.9.m9.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.9.m9.1b"><ci id="A4.SS2.p1.9.m9.1.1.cmml" xref="A4.SS2.p1.9.m9.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.9.m9.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.9.m9.1d">italic_z</annotation></semantics></math>의 인과 간접 효과를 다음과 같이 근사화할 수 있다:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx2">
<tbody id="A4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{IE}(z,y,u,\epsilon)=y_{E^{*},z}-y_{*}\approx g(z^{*})(y-y_{%
*})" class="ltx_Math" display="inline" id="A4.E3.m1.8"><semantics id="A4.E3.m1.8a"><mrow id="A4.E3.m1.8.8" xref="A4.E3.m1.8.8.cmml"><mrow id="A4.E3.m1.8.8.4" xref="A4.E3.m1.8.8.4.cmml"><mtext id="A4.E3.m1.8.8.4.2" xref="A4.E3.m1.8.8.4.2a.cmml">IE</mtext><mo id="A4.E3.m1.8.8.4.1" xref="A4.E3.m1.8.8.4.1.cmml">⁢</mo><mrow id="A4.E3.m1.8.8.4.3.2" xref="A4.E3.m1.8.8.4.3.1.cmml"><mo id="A4.E3.m1.8.8.4.3.2.1" stretchy="false" xref="A4.E3.m1.8.8.4.3.1.cmml">(</mo><mi id="A4.E3.m1.3.3" xref="A4.E3.m1.3.3.cmml">z</mi><mo id="A4.E3.m1.8.8.4.3.2.2" xref="A4.E3.m1.8.8.4.3.1.cmml">,</mo><mi id="A4.E3.m1.4.4" xref="A4.E3.m1.4.4.cmml">y</mi><mo id="A4.E3.m1.8.8.4.3.2.3" xref="A4.E3.m1.8.8.4.3.1.cmml">,</mo><mi id="A4.E3.m1.5.5" xref="A4.E3.m1.5.5.cmml">u</mi><mo id="A4.E3.m1.8.8.4.3.2.4" xref="A4.E3.m1.8.8.4.3.1.cmml">,</mo><mi id="A4.E3.m1.6.6" xref="A4.E3.m1.6.6.cmml">ϵ</mi><mo id="A4.E3.m1.8.8.4.3.2.5" stretchy="false" xref="A4.E3.m1.8.8.4.3.1.cmml">)</mo></mrow></mrow><mo id="A4.E3.m1.8.8.5" xref="A4.E3.m1.8.8.5.cmml">=</mo><mrow id="A4.E3.m1.8.8.6" xref="A4.E3.m1.8.8.6.cmml"><msub id="A4.E3.m1.8.8.6.2" xref="A4.E3.m1.8.8.6.2.cmml"><mi id="A4.E3.m1.8.8.6.2.2" xref="A4.E3.m1.8.8.6.2.2.cmml">y</mi><mrow id="A4.E3.m1.2.2.2.2" xref="A4.E3.m1.2.2.2.3.cmml"><msup id="A4.E3.m1.2.2.2.2.1" xref="A4.E3.m1.2.2.2.2.1.cmml"><mi id="A4.E3.m1.2.2.2.2.1.2" xref="A4.E3.m1.2.2.2.2.1.2.cmml">E</mi><mo id="A4.E3.m1.2.2.2.2.1.3" xref="A4.E3.m1.2.2.2.2.1.3.cmml">*</mo></msup><mo id="A4.E3.m1.2.2.2.2.2" xref="A4.E3.m1.2.2.2.3.cmml">,</mo><mi id="A4.E3.m1.1.1.1.1" xref="A4.E3.m1.1.1.1.1.cmml">z</mi></mrow></msub><mo id="A4.E3.m1.8.8.6.1" xref="A4.E3.m1.8.8.6.1.cmml">−</mo><msub id="A4.E3.m1.8.8.6.3" xref="A4.E3.m1.8.8.6.3.cmml"><mi id="A4.E3.m1.8.8.6.3.2" xref="A4.E3.m1.8.8.6.3.2.cmml">y</mi><mo id="A4.E3.m1.8.8.6.3.3" xref="A4.E3.m1.8.8.6.3.3.cmml">*</mo></msub></mrow><mo id="A4.E3.m1.8.8.7" xref="A4.E3.m1.8.8.7.cmml">≈</mo><mrow id="A4.E3.m1.8.8.2" xref="A4.E3.m1.8.8.2.cmml"><mi id="A4.E3.m1.8.8.2.4" xref="A4.E3.m1.8.8.2.4.cmml">g</mi><mo id="A4.E3.m1.8.8.2.3" xref="A4.E3.m1.8.8.2.3.cmml">⁢</mo><mrow id="A4.E3.m1.7.7.1.1.1" xref="A4.E3.m1.7.7.1.1.1.1.cmml"><mo id="A4.E3.m1.7.7.1.1.1.2" stretchy="false" xref="A4.E3.m1.7.7.1.1.1.1.cmml">(</mo><msup id="A4.E3.m1.7.7.1.1.1.1" xref="A4.E3.m1.7.7.1.1.1.1.cmml"><mi id="A4.E3.m1.7.7.1.1.1.1.2" xref="A4.E3.m1.7.7.1.1.1.1.2.cmml">z</mi><mo id="A4.E3.m1.7.7.1.1.1.1.3" xref="A4.E3.m1.7.7.1.1.1.1.3.cmml">*</mo></msup><mo id="A4.E3.m1.7.7.1.1.1.3" stretchy="false" xref="A4.E3.m1.7.7.1.1.1.1.cmml">)</mo></mrow><mo id="A4.E3.m1.8.8.2.3a" xref="A4.E3.m1.8.8.2.3.cmml">⁢</mo><mrow id="A4.E3.m1.8.8.2.2.1" xref="A4.E3.m1.8.8.2.2.1.1.cmml"><mo id="A4.E3.m1.8.8.2.2.1.2" stretchy="false" xref="A4.E3.m1.8.8.2.2.1.1.cmml">(</mo><mrow id="A4.E3.m1.8.8.2.2.1.1" xref="A4.E3.m1.8.8.2.2.1.1.cmml"><mi id="A4.E3.m1.8.8.2.2.1.1.2" xref="A4.E3.m1.8.8.2.2.1.1.2.cmml">y</mi><mo id="A4.E3.m1.8.8.2.2.1.1.1" xref="A4.E3.m1.8.8.2.2.1.1.1.cmml">−</mo><msub id="A4.E3.m1.8.8.2.2.1.1.3" xref="A4.E3.m1.8.8.2.2.1.1.3.cmml"><mi id="A4.E3.m1.8.8.2.2.1.1.3.2" xref="A4.E3.m1.8.8.2.2.1.1.3.2.cmml">y</mi><mo id="A4.E3.m1.8.8.2.2.1.1.3.3" xref="A4.E3.m1.8.8.2.2.1.1.3.3.cmml">*</mo></msub></mrow><mo id="A4.E3.m1.8.8.2.2.1.3" stretchy="false" xref="A4.E3.m1.8.8.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.E3.m1.8b"><apply id="A4.E3.m1.8.8.cmml" xref="A4.E3.m1.8.8"><and id="A4.E3.m1.8.8a.cmml" xref="A4.E3.m1.8.8"></and><apply id="A4.E3.m1.8.8b.cmml" xref="A4.E3.m1.8.8"><eq id="A4.E3.m1.8.8.5.cmml" xref="A4.E3.m1.8.8.5"></eq><apply id="A4.E3.m1.8.8.4.cmml" xref="A4.E3.m1.8.8.4"><times id="A4.E3.m1.8.8.4.1.cmml" xref="A4.E3.m1.8.8.4.1"></times><ci id="A4.E3.m1.8.8.4.2a.cmml" xref="A4.E3.m1.8.8.4.2"><mtext id="A4.E3.m1.8.8.4.2.cmml" xref="A4.E3.m1.8.8.4.2">IE</mtext></ci><vector id="A4.E3.m1.8.8.4.3.1.cmml" xref="A4.E3.m1.8.8.4.3.2"><ci id="A4.E3.m1.3.3.cmml" xref="A4.E3.m1.3.3">𝑧</ci><ci id="A4.E3.m1.4.4.cmml" xref="A4.E3.m1.4.4">𝑦</ci><ci id="A4.E3.m1.5.5.cmml" xref="A4.E3.m1.5.5">𝑢</ci><ci id="A4.E3.m1.6.6.cmml" xref="A4.E3.m1.6.6">italic-ϵ</ci></vector></apply><apply id="A4.E3.m1.8.8.6.cmml" xref="A4.E3.m1.8.8.6"><minus id="A4.E3.m1.8.8.6.1.cmml" xref="A4.E3.m1.8.8.6.1"></minus><apply id="A4.E3.m1.8.8.6.2.cmml" xref="A4.E3.m1.8.8.6.2"><csymbol cd="ambiguous" id="A4.E3.m1.8.8.6.2.1.cmml" xref="A4.E3.m1.8.8.6.2">subscript</csymbol><ci id="A4.E3.m1.8.8.6.2.2.cmml" xref="A4.E3.m1.8.8.6.2.2">𝑦</ci><list id="A4.E3.m1.2.2.2.3.cmml" xref="A4.E3.m1.2.2.2.2"><apply id="A4.E3.m1.2.2.2.2.1.cmml" xref="A4.E3.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="A4.E3.m1.2.2.2.2.1.1.cmml" xref="A4.E3.m1.2.2.2.2.1">superscript</csymbol><ci id="A4.E3.m1.2.2.2.2.1.2.cmml" xref="A4.E3.m1.2.2.2.2.1.2">𝐸</ci><times id="A4.E3.m1.2.2.2.2.1.3.cmml" xref="A4.E3.m1.2.2.2.2.1.3"></times></apply><ci id="A4.E3.m1.1.1.1.1.cmml" xref="A4.E3.m1.1.1.1.1">𝑧</ci></list></apply><apply id="A4.E3.m1.8.8.6.3.cmml" xref="A4.E3.m1.8.8.6.3"><csymbol cd="ambiguous" id="A4.E3.m1.8.8.6.3.1.cmml" xref="A4.E3.m1.8.8.6.3">subscript</csymbol><ci id="A4.E3.m1.8.8.6.3.2.cmml" xref="A4.E3.m1.8.8.6.3.2">𝑦</ci><times id="A4.E3.m1.8.8.6.3.3.cmml" xref="A4.E3.m1.8.8.6.3.3"></times></apply></apply></apply><apply id="A4.E3.m1.8.8c.cmml" xref="A4.E3.m1.8.8"><approx id="A4.E3.m1.8.8.7.cmml" xref="A4.E3.m1.8.8.7"></approx><share href="#A4.E3.m1.8.8.6.cmml" id="A4.E3.m1.8.8d.cmml" xref="A4.E3.m1.8.8"></share><apply id="A4.E3.m1.8.8.2.cmml" xref="A4.E3.m1.8.8.2"><times id="A4.E3.m1.8.8.2.3.cmml" xref="A4.E3.m1.8.8.2.3"></times><ci id="A4.E3.m1.8.8.2.4.cmml" xref="A4.E3.m1.8.8.2.4">𝑔</ci><apply id="A4.E3.m1.7.7.1.1.1.1.cmml" xref="A4.E3.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="A4.E3.m1.7.7.1.1.1.1.1.cmml" xref="A4.E3.m1.7.7.1.1.1">superscript</csymbol><ci id="A4.E3.m1.7.7.1.1.1.1.2.cmml" xref="A4.E3.m1.7.7.1.1.1.1.2">𝑧</ci><times id="A4.E3.m1.7.7.1.1.1.1.3.cmml" xref="A4.E3.m1.7.7.1.1.1.1.3"></times></apply><apply id="A4.E3.m1.8.8.2.2.1.1.cmml" xref="A4.E3.m1.8.8.2.2.1"><minus id="A4.E3.m1.8.8.2.2.1.1.1.cmml" xref="A4.E3.m1.8.8.2.2.1.1.1"></minus><ci id="A4.E3.m1.8.8.2.2.1.1.2.cmml" xref="A4.E3.m1.8.8.2.2.1.1.2">𝑦</ci><apply id="A4.E3.m1.8.8.2.2.1.1.3.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3"><csymbol cd="ambiguous" id="A4.E3.m1.8.8.2.2.1.1.3.1.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3">subscript</csymbol><ci id="A4.E3.m1.8.8.2.2.1.1.3.2.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3.2">𝑦</ci><times id="A4.E3.m1.8.8.2.2.1.1.3.3.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E3.m1.8c">\displaystyle\text{IE}(z,y,u,\epsilon)=y_{E^{*},z}-y_{*}\approx g(z^{*})(y-y_{%
*})</annotation><annotation encoding="application/x-llamapun" id="A4.E3.m1.8d">IE ( italic_z , italic_y , italic_u , italic_ϵ ) = italic_y start_POSTSUBSCRIPT italic_E start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT , italic_z end_POSTSUBSCRIPT - italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT ≈ italic_g ( italic_z start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ) ( italic_y - italic_y start_POSTSUBSCRIPT * end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.SS2.p1.13">직관적으로, 우리는 반응 변수 <math alttext="y" class="ltx_Math" display="inline" id="A4.SS2.p1.10.m1.1"><semantics id="A4.SS2.p1.10.m1.1a"><mi id="A4.SS2.p1.10.m1.1.1" xref="A4.SS2.p1.10.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.10.m1.1b"><ci id="A4.SS2.p1.10.m1.1.1.cmml" xref="A4.SS2.p1.10.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.10.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.10.m1.1d">italic_y</annotation></semantics></math>가 <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.11.m2.1"><semantics id="A4.SS2.p1.11.m2.1a"><mi id="A4.SS2.p1.11.m2.1.1" xref="A4.SS2.p1.11.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.11.m2.1b"><ci id="A4.SS2.p1.11.m2.1.1.cmml" xref="A4.SS2.p1.11.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.11.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.11.m2.1d">italic_z</annotation></semantics></math>의 활성화 값의 국부적인 선형 함수(다른 뉴런을 고정시킨 경우)이므로, 인과 효과는 <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.12.m3.1"><semantics id="A4.SS2.p1.12.m3.1a"><mi id="A4.SS2.p1.12.m3.1.1" xref="A4.SS2.p1.12.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.12.m3.1b"><ci id="A4.SS2.p1.12.m3.1.1.cmml" xref="A4.SS2.p1.12.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.12.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.12.m3.1d">italic_z</annotation></semantics></math>의 그래디언트와 입력 섭동 후의 활성화 값의 차이의 곱으로 근사화될 수 있다고 가정한다. 각 뉴런 <math alttext="z" class="ltx_Math" display="inline" id="A4.SS2.p1.13.m4.1"><semantics id="A4.SS2.p1.13.m4.1a"><mi id="A4.SS2.p1.13.m4.1.1" xref="A4.SS2.p1.13.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.13.m4.1b"><ci id="A4.SS2.p1.13.m4.1.1.cmml" xref="A4.SS2.p1.13.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.13.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="A4.SS2.p1.13.m4.1d">italic_z</annotation></semantics></math>에 대한 AIE의 근사치는 또한 독립적으로 샘플링된 노이즈에 대해 그리고 모든 입력 쿼리에 대해 근사화된 IE를 평균함으로써 계산될 수 있다.</p>
</div>
</section>
</section>
</article>
</div>

</div>


<div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated on Wed Dec 14 18:01:44 2022 by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer><button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button></body></html>