<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.18167] Mechanisms of Non-Factual Hallucination in Language Models</title><meta property="og:description" content="State-of-the-art language models (LMs) sometimes generate non-factual hallucinations that misalign with world knowledge. Despite extensive efforts to detect and mitigate hallucinations, understanding their internal mec…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mechanisms of Non-Factual Hallucination in Language Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Mechanisms of Non-Factual Hallucination in Language Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.18167">

<!--Generated on Fri Apr  5 17:54:20 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.7.9.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.9.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Mechanisms of Non-Factual Hallucination in Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lei Yu<sup id="id9.9.id1" class="ltx_sup"><span id="id9.9.id1.1" class="ltx_text ltx_font_italic">1,∗</span></sup>, Meng Cao<sup id="id10.10.id2" class="ltx_sup"><span id="id10.10.id2.1" class="ltx_text ltx_font_italic">2,3,∗</span></sup>, Jackie Chi Kit Cheung<sup id="id11.11.id3" class="ltx_sup"><span id="id11.11.id3.1" class="ltx_text ltx_font_italic">2,3</span></sup>, Yue Dong<sup id="id12.12.id4" class="ltx_sup"><span id="id12.12.id4.1" class="ltx_text ltx_font_italic">4</span></sup>
<br class="ltx_break"><sup id="id13.13.id5" class="ltx_sup">1</sup>Department of Computer Science, University of Toronto 
<br class="ltx_break"><sup id="id14.14.id6" class="ltx_sup">2</sup>School of Computer Science, McGill University 
<br class="ltx_break"><sup id="id15.15.id7" class="ltx_sup">3</sup>Mila – Québec AI Institute 
<br class="ltx_break"><sup id="id16.16.id8" class="ltx_sup">4</sup>University of California, Riverside 
<br class="ltx_break"><span id="id17.17.id9" class="ltx_text ltx_font_typewriter">jadeleiyu@cs.toronto.edu</span> 
<br class="ltx_break"><span id="id18.18.id10" class="ltx_text ltx_font_typewriter">{meng.cao@mail,jcheung@cs}.mcgill.ca</span> 
<br class="ltx_break"><span id="id19.19.id11" class="ltx_text ltx_font_typewriter">yue.dong@ucr.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id20.id1" class="ltx_p">State-of-the-art language models (LMs) sometimes generate <span id="id20.id1.1" class="ltx_text ltx_font_italic">non-factual hallucinations</span> that misalign with world knowledge. Despite extensive efforts to detect and mitigate hallucinations, understanding their internal mechanisms remains elusive. Our study investigates the mechanistic causes of hallucination, specifically non-factual ones where the LM incorrectly predicts object attributes in response to subject-relation queries. With causal mediation analysis and embedding space projection, we identify two general mechanistic causes of hallucinations shared across LMs of various scales and designs: 1) insufficient subject attribute knowledge in lower layer MLPs, and 2) failing to select the correct object attribute in upper layer attention heads and MLPs. These two mechanisms exhibit varying degrees of subject-object association, predictive uncertainty and perturbation robustness. Additionally, we scrutinize LM pre-training checkpoints, revealing distinct learning dynamics for the two mechanistic causes of hallucinations. We also highlight how attribution features from our causal analysis can effectively construct hallucination detectors. Our work proposes a mechanistic understanding of LM factual errors. <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our code and data are available at: <a target="_blank" href="https://github.com/jadeleiyu/lm_hallucination_mechanisms" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/jadeleiyu/lm_hallucination_mechanisms</a>.</span></span></span></p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<div id="p1.8" class="ltx_block ltx_align_bottom">
<p id="p1.8.9" class="ltx_p"><span id="p1.8.9.1" class="ltx_text ltx_font_bold">Mechanisms of Non-Factual Hallucination in Language Models</span></p>
<br class="ltx_break ltx_centering">
<p id="p1.8.8" class="ltx_p ltx_align_center" style="width:433.6pt;"><span id="p1.8.8.8" class="ltx_text ltx_inline-block" style="width:0.0pt;">

<span id="p1.8.8.8.8" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p1.4.4.4.4.4" class="ltx_tr">
<span id="p1.4.4.4.4.4.4" class="ltx_td ltx_align_center"><span id="p1.4.4.4.4.4.4.4" class="ltx_text ltx_font_bold">Lei Yu<sup id="p1.4.4.4.4.4.4.4.1" class="ltx_sup"><span id="p1.4.4.4.4.4.4.4.1.1" class="ltx_text ltx_font_medium ltx_font_italic">1,∗</span></sup>, Meng Cao<sup id="p1.4.4.4.4.4.4.4.2" class="ltx_sup"><span id="p1.4.4.4.4.4.4.4.2.1" class="ltx_text ltx_font_medium ltx_font_italic">2,3,∗</span></sup>, Jackie Chi Kit Cheung<sup id="p1.4.4.4.4.4.4.4.3" class="ltx_sup"><span id="p1.4.4.4.4.4.4.4.3.1" class="ltx_text ltx_font_medium ltx_font_italic">2,3</span></sup>, Yue Dong<sup id="p1.4.4.4.4.4.4.4.4" class="ltx_sup"><span id="p1.4.4.4.4.4.4.4.4.1" class="ltx_text ltx_font_medium ltx_font_italic">4</span></sup></span></span></span>
<span id="p1.5.5.5.5.5" class="ltx_tr">
<span id="p1.5.5.5.5.5.1" class="ltx_td ltx_align_center"><sup id="p1.5.5.5.5.5.1.1" class="ltx_sup">1</sup>Department of Computer Science, University of Toronto</span></span>
<span id="p1.6.6.6.6.6" class="ltx_tr">
<span id="p1.6.6.6.6.6.1" class="ltx_td ltx_align_center"><sup id="p1.6.6.6.6.6.1.1" class="ltx_sup">2</sup>School of Computer Science, McGill University</span></span>
<span id="p1.7.7.7.7.7" class="ltx_tr">
<span id="p1.7.7.7.7.7.1" class="ltx_td ltx_align_center"><sup id="p1.7.7.7.7.7.1.1" class="ltx_sup">3</sup>Mila – Québec AI Institute</span></span>
<span id="p1.8.8.8.8.8" class="ltx_tr">
<span id="p1.8.8.8.8.8.1" class="ltx_td ltx_align_center"><sup id="p1.8.8.8.8.8.1.1" class="ltx_sup">4</sup>University of California, Riverside</span></span>
<span id="p1.8.8.8.8.9.1" class="ltx_tr">
<span id="p1.8.8.8.8.9.1.1" class="ltx_td ltx_align_center"><span id="p1.8.8.8.8.9.1.1.1" class="ltx_text ltx_font_typewriter">jadeleiyu@cs.toronto.edu</span></span></span>
<span id="p1.8.8.8.8.10.2" class="ltx_tr">
<span id="p1.8.8.8.8.10.2.1" class="ltx_td ltx_align_center"><span id="p1.8.8.8.8.10.2.1.1" class="ltx_text ltx_font_typewriter">{meng.cao@mail,jcheung@cs}.mcgill.ca</span></span></span>
<span id="p1.8.8.8.8.11.3" class="ltx_tr">
<span id="p1.8.8.8.8.11.3.1" class="ltx_td ltx_align_center"><span id="p1.8.8.8.8.11.3.1.1" class="ltx_text ltx_font_typewriter">yue.dong@ucr.edu</span></span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering">
</div>
</div>
<span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_note_type">footnotetext: </span>Equal contribution.</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Language models (LMs) serve as repositories of substantial knowledge <cite class="ltx_cite ltx_citemacro_cite">Petroni et&nbsp;al. (<a href="#bib.bib40" title="" class="ltx_ref">2019</a>); Jiang et&nbsp;al. (<a href="#bib.bib23" title="" class="ltx_ref">2020</a>); Srivastava et&nbsp;al. (<a href="#bib.bib42" title="" class="ltx_ref">2023</a>)</cite> through their parametric knowledge gained from pre-training. However, they are susceptible to generating “hallucinations” that contain factual errors. At the level of logit predictions, these hallucinations often display a pattern similar to factual generations. For example, LMs have been observed to produce seemingly confident completions that are, in reality, hallucinations <cite class="ltx_cite ltx_citemacro_cite">Dong et&nbsp;al. (<a href="#bib.bib10" title="" class="ltx_ref">2022</a>); Zhang et&nbsp;al. (<a href="#bib.bib58" title="" class="ltx_ref">2023b</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To understand how hallucinations differ from factual outputs and whether they are uniformly generated or equally challenging to fix, thorough analysis tools that monitoring the information flow are required, extending beyond merely last-layer predictions <cite class="ltx_cite ltx_citemacro_cite">Kaddour et&nbsp;al. (<a href="#bib.bib24" title="" class="ltx_ref">2023</a>)</cite>. However, research on understanding the internal mechanisms of hallucination generation is limited. Most efforts have focused on detecting and mitigating hallucinations <cite class="ltx_cite ltx_citemacro_cite">Elaraby et&nbsp;al. (<a href="#bib.bib11" title="" class="ltx_ref">2023</a>); Mündler et&nbsp;al. (<a href="#bib.bib34" title="" class="ltx_ref">2023</a>); Manakul et&nbsp;al. (<a href="#bib.bib30" title="" class="ltx_ref">2023</a>); Zhang et&nbsp;al. (<a href="#bib.bib57" title="" class="ltx_ref">2023a</a>)</cite>, treating the LM as a black box and devising methods based on external features like predictive uncertainty <cite class="ltx_cite ltx_citemacro_cite">Xiao and Wang (<a href="#bib.bib54" title="" class="ltx_ref">2021</a>); Varshney et&nbsp;al. (<a href="#bib.bib48" title="" class="ltx_ref">2023</a>)</cite> and logical consistency <cite class="ltx_cite ltx_citemacro_cite">Cohen et&nbsp;al. (<a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite>. Unfortunately, these approaches provide no insights into the internal mechanisms of factual errors and have demonstrated unreliability or conveyed contradictory signals <cite class="ltx_cite ltx_citemacro_cite">Turpin et&nbsp;al. (<a href="#bib.bib47" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In contrast, interpretability research, which probes the internal mechanisms of transformers in white-box settings, has recently garnered significant attention for analyzing which components are helpful in identifying factual predictions. It has identified several critical model “components” (e.g., attention heads, feedforward layers) related to knowledge flow that are essential for answering questions accurately <cite class="ltx_cite ltx_citemacro_cite">Lu et&nbsp;al. (<a href="#bib.bib29" title="" class="ltx_ref">2021</a>); Dai et&nbsp;al. (<a href="#bib.bib7" title="" class="ltx_ref">2022</a>); Meng et&nbsp;al. (<a href="#bib.bib31" title="" class="ltx_ref">2022a</a>); Geva et&nbsp;al. (<a href="#bib.bib15" title="" class="ltx_ref">2023</a>)</cite>. However, it remains a question whether the results of mechanistic interpretability on factual predictions can generalize to hallucinations. Specifically, it is unknown which model components deviate from normal functioning to cause hallucinations. Localizing the source of factual errors in LMs may help us design targeted and efficient methods to mitigate hallucinations (e.g., by editing a small set of model weights identified as causing hallucinations), which is particularly important as the model size and the training cost of LMs are rapidly increasing.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this study, we employ mechanistic interpretability <cite class="ltx_cite ltx_citemacro_cite">Olah (<a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite> to investigate the origins and manifestation of non-factual hallucinations in LMs. We use two established interpretability methods, causal mediation analysis <cite class="ltx_cite ltx_citemacro_cite">Pearl (<a href="#bib.bib39" title="" class="ltx_ref">2001</a>); Vig et&nbsp;al. (<a href="#bib.bib50" title="" class="ltx_ref">2020</a>)</cite> and embedding space projection <cite class="ltx_cite ltx_citemacro_cite">Geva et&nbsp;al. (<a href="#bib.bib17" title="" class="ltx_ref">2022b</a>); Dar et&nbsp;al. (<a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite> in our specially designed setups on non-factual hallucination data, aiming to assess the influence of model components on hallucinating predictions. Through extensive analyses on LMs of various sizes and architectures (Llama-2, GPT-J, GPT-2-XL), we obtain converging evidence that there exist two groups of crucial components for factually incorrect predictions: 1) the multi-layer perceptrons (MLPs) in lower transformer layers, 2) the attention heads and MLPs in upper transformer layers.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Figure&nbsp;<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates two distinct scenarios where the identified hallucinating components exhibit different behaviors. In some instances, lower-layer MLPs function normally, successfully retrieving semantic attributes about queried entities, while upper-layer attention heads and MLPs struggle to distinguish the most relevant attributes that lead to the correct answer. In other cases, the model fails to execute its fact-recalling pipeline at the beginning, extracting no useful information from lower-layer MLPs. We also observe that these two hallucination mechanisms have varying external manifestations, distinguishable by their levels of subject-object association strengths, robustness to input perturbations, and model predictive uncertainty. Following the discoveries by <cite class="ltx_cite ltx_citemacro_citet">Akyürek et&nbsp;al. (<a href="#bib.bib1" title="" class="ltx_ref">2022</a>); Zhou et&nbsp;al. (<a href="#bib.bib59" title="" class="ltx_ref">2023</a>)</cite> regarding the significant role of LM pre-training in acquiring factual knowledge, we also examined the impact of pre-training on the various types of hallucinations we have identified. Our findings are significant: early-site MLPs and late-site attentions form a two-step pipeline for fact recall that emerges progressively during pre-training, and failing to develop either step can result in hallucinations.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">In addition to providing internal knowledge flow analysis that exhibits high correlations with external features, which helps us understand how different types of hallucinations behave during various stages of pre-training, our work also demonstrates a practical application: mechanistic interpretability features can be employed to detect the presence of factual errors in language models (LMs). This research offers the first mechanistic explanation of LM factual errors as systematic modular failures, fostering research on model explainability and hallucination mitigation.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2403.18167/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="122" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.13.1" class="ltx_text ltx_font_bold">Our main finding of two non-factual hallucination mechanisms.</span> <span id="S1.F1.14.2" class="ltx_text ltx_font_bold">Left (a)</span>: The <span id="S1.F1.15.3" class="ltx_text ltx_font_bold">early-site hallucinations</span> are caused by lacking general knowledge of the subject in lower layer MLPs of transformer LMs – in this case, the model fails to retrieve useful information about the entity (e.g., <span id="S1.F1.16.4" class="ltx_text ltx_font_italic">Orica</span>, an Australian-based multinational corporation) to generate the correct object attribute (e.g., <span id="S1.F1.17.5" class="ltx_text ltx_font_italic">Australia</span>), and therefore outputs a highly irrelevant prediction (January). <span id="S1.F1.18.6" class="ltx_text ltx_font_bold">Right (b)</span>: The <span id="S1.F1.19.7" class="ltx_text ltx_font_bold">late-site hallucinations</span> are caused by the failure of upper layer attention heads and MLPs to identify the most relevant object to the given subject and relation – in this case, the model is able to retrieve related information about the subject (e.g., <span id="S1.F1.20.8" class="ltx_text ltx_font_italic">Toulouse</span>, a French city) from lower layer MLPs, but cannot distinguish the irrelevant yet strongly associated attributes (e.g., <span id="S1.F1.21.9" class="ltx_text ltx_font_italic">Paris</span>) from the correct answers (e.g., <span id="S1.F1.22.10" class="ltx_text ltx_font_italic">Bologna</span>/<span id="S1.F1.23.11" class="ltx_text ltx_font_italic">Chongqing</span>/<span id="S1.F1.24.12" class="ltx_text ltx_font_italic">Atlanta</span>). We found that these two types of hallucinations can be distinguished by the relative causal contribution to model predictions between lower and upper layer LM components.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Factual knowledge in language models.</h4>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">The exploration of knowledge tracing within Language Models (LMs) has gained substantial attention lately, with researchers investigating specific layers <cite class="ltx_cite ltx_citemacro_citep">(Wallat et&nbsp;al., <a href="#bib.bib51" title="" class="ltx_ref">2020</a>; Geva et&nbsp;al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>; Meng et&nbsp;al., <a href="#bib.bib31" title="" class="ltx_ref">2022a</a>)</cite> and neurons <cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite> responsible for storing factual information. This line of inquiry extends to techniques for model editing <cite class="ltx_cite ltx_citemacro_citep">(De&nbsp;Cao et&nbsp;al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Mitchell et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2021</a>; Meng et&nbsp;al., <a href="#bib.bib32" title="" class="ltx_ref">2022b</a>)</cite> and inference intervention <cite class="ltx_cite ltx_citemacro_citep">(Hernandez et&nbsp;al., <a href="#bib.bib21" title="" class="ltx_ref">2023</a>; Li et&nbsp;al., <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite>. Recent advancements by <cite class="ltx_cite ltx_citemacro_citet">Geva et&nbsp;al. (<a href="#bib.bib15" title="" class="ltx_ref">2023</a>); Yu et&nbsp;al. (<a href="#bib.bib55" title="" class="ltx_ref">2023</a>)</cite> identify crucial LM components that form an internal pipeline for factual information transfer. Our framework complements existing research by offering an additional perspective on LM factual knowledge processing, revealing that compromised factually relevant modules can lead to hallucinations.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Hallucinations.</h4>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">Language models are susceptible to generating hallucinations that can be <span id="S2.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">unfaithful</span> (i.e. deviating from the source input provided by users) or <span id="S2.SS0.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_italic">non-factual</span> (i.e. contradicting established world knowledge) <cite class="ltx_cite ltx_citemacro_cite">Cao et&nbsp;al. (<a href="#bib.bib3" title="" class="ltx_ref">2022a</a>); Ji et&nbsp;al. (<a href="#bib.bib22" title="" class="ltx_ref">2023</a>); Zhang et&nbsp;al. (<a href="#bib.bib58" title="" class="ltx_ref">2023b</a>)</cite>. Here, we focus on the latter type of hallucination. Existing studies propose various methods to detect or mitigate hallucinations, leveraging features such as internal activation patterns <cite class="ltx_cite ltx_citemacro_cite">Yuksekgonul et&nbsp;al. (<a href="#bib.bib56" title="" class="ltx_ref">2023</a>); Li et&nbsp;al. (<a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite>, predictive confidence <cite class="ltx_cite ltx_citemacro_cite">Cao et&nbsp;al. (<a href="#bib.bib3" title="" class="ltx_ref">2022a</a>, <a href="#bib.bib4" title="" class="ltx_ref">b</a>); Varshney et&nbsp;al. (<a href="#bib.bib48" title="" class="ltx_ref">2023</a>)</cite>, and generation consistency <cite class="ltx_cite ltx_citemacro_cite">Mündler et&nbsp;al. (<a href="#bib.bib34" title="" class="ltx_ref">2023</a>); Manakul et&nbsp;al. (<a href="#bib.bib30" title="" class="ltx_ref">2023</a>); Zhang et&nbsp;al. (<a href="#bib.bib57" title="" class="ltx_ref">2023a</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Mechanistic interpretability.</h4>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">Mechanistic interpretability <cite class="ltx_cite ltx_citemacro_cite">Olah (<a href="#bib.bib38" title="" class="ltx_ref">2022</a>); Nanda (<a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite> is an evolving research area. Recent works employ projections to the vocabulary <cite class="ltx_cite ltx_citemacro_cite">Geva et&nbsp;al. (<a href="#bib.bib17" title="" class="ltx_ref">2022b</a>, <a href="#bib.bib16" title="" class="ltx_ref">a</a>); Nostalgebraist (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>); Katz et&nbsp;al. (<a href="#bib.bib25" title="" class="ltx_ref">2024</a>)</cite> and interventions in transformer computation <cite class="ltx_cite ltx_citemacro_cite">Finlayson et&nbsp;al. (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>); Haviv et&nbsp;al. (<a href="#bib.bib20" title="" class="ltx_ref">2022</a>); Stolfo et&nbsp;al. (<a href="#bib.bib43" title="" class="ltx_ref">2023</a>); Ghandeharioun et&nbsp;al. (<a href="#bib.bib19" title="" class="ltx_ref">2024</a>)</cite> to study LM inner workings. Similar techniques have been applied to explore neural network learning dynamics <cite class="ltx_cite ltx_citemacro_cite">Nanda et&nbsp;al. (<a href="#bib.bib36" title="" class="ltx_ref">2022</a>)</cite> and discover sparse computational graphs for specific tasks <cite class="ltx_cite ltx_citemacro_cite">Wang et&nbsp;al. (<a href="#bib.bib53" title="" class="ltx_ref">2022</a>); Conmy et&nbsp;al. (<a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite>. Leveraging multiple mechanistic interpretability methods, our study provides a principled account for non-factual hallucinations.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Background and Notation</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.26" class="ltx_p">We start by providing a detailed description of the inference pass of decoder-only transformer-based LMs. An auto-regressive transformer, denoted as <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">G</annotation></semantics></math>, maps an input sequence of tokens <math id="S3.p1.2.m2.3" class="ltx_Math" alttext="u=[w_{1},...,w_{T}]" display="inline"><semantics id="S3.p1.2.m2.3a"><mrow id="S3.p1.2.m2.3.3" xref="S3.p1.2.m2.3.3.cmml"><mi id="S3.p1.2.m2.3.3.4" xref="S3.p1.2.m2.3.3.4.cmml">u</mi><mo id="S3.p1.2.m2.3.3.3" xref="S3.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.p1.2.m2.3.3.2.2" xref="S3.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.2.m2.3.3.2.2.3" xref="S3.p1.2.m2.3.3.2.3.cmml">[</mo><msub id="S3.p1.2.m2.2.2.1.1.1" xref="S3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.p1.2.m2.2.2.1.1.1.2" xref="S3.p1.2.m2.2.2.1.1.1.2.cmml">w</mi><mn id="S3.p1.2.m2.2.2.1.1.1.3" xref="S3.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.2.m2.3.3.2.2.4" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">…</mi><mo id="S3.p1.2.m2.3.3.2.2.5" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.p1.2.m2.3.3.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.p1.2.m2.3.3.2.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.2.cmml">w</mi><mi id="S3.p1.2.m2.3.3.2.2.2.3" xref="S3.p1.2.m2.3.3.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="S3.p1.2.m2.3.3.2.2.6" xref="S3.p1.2.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.3b"><apply id="S3.p1.2.m2.3.3.cmml" xref="S3.p1.2.m2.3.3"><eq id="S3.p1.2.m2.3.3.3.cmml" xref="S3.p1.2.m2.3.3.3"></eq><ci id="S3.p1.2.m2.3.3.4.cmml" xref="S3.p1.2.m2.3.3.4">𝑢</ci><list id="S3.p1.2.m2.3.3.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2"><apply id="S3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1.1.2">𝑤</ci><cn type="integer" id="S3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">…</ci><apply id="S3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2.2">𝑤</ci><ci id="S3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2.2.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.3c">u=[w_{1},...,w_{T}]</annotation></semantics></math>, represented by input token embeddings <math id="S3.p1.3.m3.4" class="ltx_Math" alttext="E(u)=[e_{1},...,e_{T}]" display="inline"><semantics id="S3.p1.3.m3.4a"><mrow id="S3.p1.3.m3.4.4" xref="S3.p1.3.m3.4.4.cmml"><mrow id="S3.p1.3.m3.4.4.4" xref="S3.p1.3.m3.4.4.4.cmml"><mi id="S3.p1.3.m3.4.4.4.2" xref="S3.p1.3.m3.4.4.4.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.p1.3.m3.4.4.4.1" xref="S3.p1.3.m3.4.4.4.1.cmml">​</mo><mrow id="S3.p1.3.m3.4.4.4.3.2" xref="S3.p1.3.m3.4.4.4.cmml"><mo stretchy="false" id="S3.p1.3.m3.4.4.4.3.2.1" xref="S3.p1.3.m3.4.4.4.cmml">(</mo><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">u</mi><mo stretchy="false" id="S3.p1.3.m3.4.4.4.3.2.2" xref="S3.p1.3.m3.4.4.4.cmml">)</mo></mrow></mrow><mo id="S3.p1.3.m3.4.4.3" xref="S3.p1.3.m3.4.4.3.cmml">=</mo><mrow id="S3.p1.3.m3.4.4.2.2" xref="S3.p1.3.m3.4.4.2.3.cmml"><mo stretchy="false" id="S3.p1.3.m3.4.4.2.2.3" xref="S3.p1.3.m3.4.4.2.3.cmml">[</mo><msub id="S3.p1.3.m3.3.3.1.1.1" xref="S3.p1.3.m3.3.3.1.1.1.cmml"><mi id="S3.p1.3.m3.3.3.1.1.1.2" xref="S3.p1.3.m3.3.3.1.1.1.2.cmml">e</mi><mn id="S3.p1.3.m3.3.3.1.1.1.3" xref="S3.p1.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.3.m3.4.4.2.2.4" xref="S3.p1.3.m3.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.3.m3.2.2" xref="S3.p1.3.m3.2.2.cmml">…</mi><mo id="S3.p1.3.m3.4.4.2.2.5" xref="S3.p1.3.m3.4.4.2.3.cmml">,</mo><msub id="S3.p1.3.m3.4.4.2.2.2" xref="S3.p1.3.m3.4.4.2.2.2.cmml"><mi id="S3.p1.3.m3.4.4.2.2.2.2" xref="S3.p1.3.m3.4.4.2.2.2.2.cmml">e</mi><mi id="S3.p1.3.m3.4.4.2.2.2.3" xref="S3.p1.3.m3.4.4.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="S3.p1.3.m3.4.4.2.2.6" xref="S3.p1.3.m3.4.4.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.4b"><apply id="S3.p1.3.m3.4.4.cmml" xref="S3.p1.3.m3.4.4"><eq id="S3.p1.3.m3.4.4.3.cmml" xref="S3.p1.3.m3.4.4.3"></eq><apply id="S3.p1.3.m3.4.4.4.cmml" xref="S3.p1.3.m3.4.4.4"><times id="S3.p1.3.m3.4.4.4.1.cmml" xref="S3.p1.3.m3.4.4.4.1"></times><ci id="S3.p1.3.m3.4.4.4.2.cmml" xref="S3.p1.3.m3.4.4.4.2">𝐸</ci><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑢</ci></apply><list id="S3.p1.3.m3.4.4.2.3.cmml" xref="S3.p1.3.m3.4.4.2.2"><apply id="S3.p1.3.m3.3.3.1.1.1.cmml" xref="S3.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.p1.3.m3.3.3.1.1.1.2">𝑒</ci><cn type="integer" id="S3.p1.3.m3.3.3.1.1.1.3.cmml" xref="S3.p1.3.m3.3.3.1.1.1.3">1</cn></apply><ci id="S3.p1.3.m3.2.2.cmml" xref="S3.p1.3.m3.2.2">…</ci><apply id="S3.p1.3.m3.4.4.2.2.2.cmml" xref="S3.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.4.4.2.2.2.1.cmml" xref="S3.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S3.p1.3.m3.4.4.2.2.2.2.cmml" xref="S3.p1.3.m3.4.4.2.2.2.2">𝑒</ci><ci id="S3.p1.3.m3.4.4.2.2.2.3.cmml" xref="S3.p1.3.m3.4.4.2.2.2.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.4c">E(u)=[e_{1},...,e_{T}]</annotation></semantics></math>, into a probability distribution over the vocabulary for next-token prediction. Within the transformer, the <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">i</annotation></semantics></math>-th token is represented as a series of hidden states <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="h_{i}^{(l)}" display="inline"><semantics id="S3.p1.5.m5.1a"><msubsup id="S3.p1.5.m5.1.2" xref="S3.p1.5.m5.1.2.cmml"><mi id="S3.p1.5.m5.1.2.2.2" xref="S3.p1.5.m5.1.2.2.2.cmml">h</mi><mi id="S3.p1.5.m5.1.2.2.3" xref="S3.p1.5.m5.1.2.2.3.cmml">i</mi><mrow id="S3.p1.5.m5.1.1.1.3" xref="S3.p1.5.m5.1.2.cmml"><mo stretchy="false" id="S3.p1.5.m5.1.1.1.3.1" xref="S3.p1.5.m5.1.2.cmml">(</mo><mi id="S3.p1.5.m5.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.5.m5.1.1.1.3.2" xref="S3.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.2.cmml" xref="S3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.2.1.cmml" xref="S3.p1.5.m5.1.2">superscript</csymbol><apply id="S3.p1.5.m5.1.2.2.cmml" xref="S3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.2.2.1.cmml" xref="S3.p1.5.m5.1.2">subscript</csymbol><ci id="S3.p1.5.m5.1.2.2.2.cmml" xref="S3.p1.5.m5.1.2.2.2">ℎ</ci><ci id="S3.p1.5.m5.1.2.2.3.cmml" xref="S3.p1.5.m5.1.2.2.3">𝑖</ci></apply><ci id="S3.p1.5.m5.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">h_{i}^{(l)}</annotation></semantics></math> where at each layer <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">l</annotation></semantics></math>, the model computes and adds the intermediate embeddings by two modules from <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="h_{i}^{(l-1)}" display="inline"><semantics id="S3.p1.7.m7.1a"><msubsup id="S3.p1.7.m7.1.2" xref="S3.p1.7.m7.1.2.cmml"><mi id="S3.p1.7.m7.1.2.2.2" xref="S3.p1.7.m7.1.2.2.2.cmml">h</mi><mi id="S3.p1.7.m7.1.2.2.3" xref="S3.p1.7.m7.1.2.2.3.cmml">i</mi><mrow id="S3.p1.7.m7.1.1.1.1" xref="S3.p1.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.7.m7.1.1.1.1.2" xref="S3.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.7.m7.1.1.1.1.1" xref="S3.p1.7.m7.1.1.1.1.1.cmml"><mi id="S3.p1.7.m7.1.1.1.1.1.2" xref="S3.p1.7.m7.1.1.1.1.1.2.cmml">l</mi><mo id="S3.p1.7.m7.1.1.1.1.1.1" xref="S3.p1.7.m7.1.1.1.1.1.1.cmml">−</mo><mn id="S3.p1.7.m7.1.1.1.1.1.3" xref="S3.p1.7.m7.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.p1.7.m7.1.1.1.1.3" xref="S3.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.2.cmml" xref="S3.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.2.1.cmml" xref="S3.p1.7.m7.1.2">superscript</csymbol><apply id="S3.p1.7.m7.1.2.2.cmml" xref="S3.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.2.2.1.cmml" xref="S3.p1.7.m7.1.2">subscript</csymbol><ci id="S3.p1.7.m7.1.2.2.2.cmml" xref="S3.p1.7.m7.1.2.2.2">ℎ</ci><ci id="S3.p1.7.m7.1.2.2.3.cmml" xref="S3.p1.7.m7.1.2.2.3">𝑖</ci></apply><apply id="S3.p1.7.m7.1.1.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1.1"><minus id="S3.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1.1.1.1"></minus><ci id="S3.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.p1.7.m7.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S3.p1.7.m7.1.1.1.1.1.3.cmml" xref="S3.p1.7.m7.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">h_{i}^{(l-1)}</annotation></semantics></math>: 1) an aggregated <span id="S3.p1.26.1" class="ltx_text ltx_font_bold">multi-head self-attention module</span> output <math id="S3.p1.8.m8.7" class="ltx_Math" alttext="a^{(l)}_{i}=W_{o}([a_{i}^{(l,0)},...,a_{i}^{(l,K)}])" display="inline"><semantics id="S3.p1.8.m8.7a"><mrow id="S3.p1.8.m8.7.7" xref="S3.p1.8.m8.7.7.cmml"><msubsup id="S3.p1.8.m8.7.7.3" xref="S3.p1.8.m8.7.7.3.cmml"><mi id="S3.p1.8.m8.7.7.3.2.2" xref="S3.p1.8.m8.7.7.3.2.2.cmml">a</mi><mi id="S3.p1.8.m8.7.7.3.3" xref="S3.p1.8.m8.7.7.3.3.cmml">i</mi><mrow id="S3.p1.8.m8.1.1.1.3" xref="S3.p1.8.m8.7.7.3.cmml"><mo stretchy="false" id="S3.p1.8.m8.1.1.1.3.1" xref="S3.p1.8.m8.7.7.3.cmml">(</mo><mi id="S3.p1.8.m8.1.1.1.1" xref="S3.p1.8.m8.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.8.m8.1.1.1.3.2" xref="S3.p1.8.m8.7.7.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.8.m8.7.7.2" xref="S3.p1.8.m8.7.7.2.cmml">=</mo><mrow id="S3.p1.8.m8.7.7.1" xref="S3.p1.8.m8.7.7.1.cmml"><msub id="S3.p1.8.m8.7.7.1.3" xref="S3.p1.8.m8.7.7.1.3.cmml"><mi id="S3.p1.8.m8.7.7.1.3.2" xref="S3.p1.8.m8.7.7.1.3.2.cmml">W</mi><mi id="S3.p1.8.m8.7.7.1.3.3" xref="S3.p1.8.m8.7.7.1.3.3.cmml">o</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.8.m8.7.7.1.2" xref="S3.p1.8.m8.7.7.1.2.cmml">​</mo><mrow id="S3.p1.8.m8.7.7.1.1.1" xref="S3.p1.8.m8.7.7.1.cmml"><mo stretchy="false" id="S3.p1.8.m8.7.7.1.1.1.2" xref="S3.p1.8.m8.7.7.1.cmml">(</mo><mrow id="S3.p1.8.m8.7.7.1.1.1.1.2" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.p1.8.m8.7.7.1.1.1.1.2.3" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">[</mo><msubsup id="S3.p1.8.m8.7.7.1.1.1.1.1.1" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.cmml"><mi id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.p1.8.m8.3.3.2.4" xref="S3.p1.8.m8.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.8.m8.3.3.2.4.1" xref="S3.p1.8.m8.3.3.2.3.cmml">(</mo><mi id="S3.p1.8.m8.2.2.1.1" xref="S3.p1.8.m8.2.2.1.1.cmml">l</mi><mo id="S3.p1.8.m8.3.3.2.4.2" xref="S3.p1.8.m8.3.3.2.3.cmml">,</mo><mn id="S3.p1.8.m8.3.3.2.2" xref="S3.p1.8.m8.3.3.2.2.cmml">0</mn><mo stretchy="false" id="S3.p1.8.m8.3.3.2.4.3" xref="S3.p1.8.m8.3.3.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.4" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.8.m8.6.6" xref="S3.p1.8.m8.6.6.cmml">…</mi><mo id="S3.p1.8.m8.7.7.1.1.1.1.2.5" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">,</mo><msubsup id="S3.p1.8.m8.7.7.1.1.1.1.2.2" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.cmml"><mi id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3.cmml">i</mi><mrow id="S3.p1.8.m8.5.5.2.4" xref="S3.p1.8.m8.5.5.2.3.cmml"><mo stretchy="false" id="S3.p1.8.m8.5.5.2.4.1" xref="S3.p1.8.m8.5.5.2.3.cmml">(</mo><mi id="S3.p1.8.m8.4.4.1.1" xref="S3.p1.8.m8.4.4.1.1.cmml">l</mi><mo id="S3.p1.8.m8.5.5.2.4.2" xref="S3.p1.8.m8.5.5.2.3.cmml">,</mo><mi id="S3.p1.8.m8.5.5.2.2" xref="S3.p1.8.m8.5.5.2.2.cmml">K</mi><mo stretchy="false" id="S3.p1.8.m8.5.5.2.4.3" xref="S3.p1.8.m8.5.5.2.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.p1.8.m8.7.7.1.1.1.1.2.6" xref="S3.p1.8.m8.7.7.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S3.p1.8.m8.7.7.1.1.1.3" xref="S3.p1.8.m8.7.7.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.7b"><apply id="S3.p1.8.m8.7.7.cmml" xref="S3.p1.8.m8.7.7"><eq id="S3.p1.8.m8.7.7.2.cmml" xref="S3.p1.8.m8.7.7.2"></eq><apply id="S3.p1.8.m8.7.7.3.cmml" xref="S3.p1.8.m8.7.7.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.3.1.cmml" xref="S3.p1.8.m8.7.7.3">subscript</csymbol><apply id="S3.p1.8.m8.7.7.3.2.cmml" xref="S3.p1.8.m8.7.7.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.3.2.1.cmml" xref="S3.p1.8.m8.7.7.3">superscript</csymbol><ci id="S3.p1.8.m8.7.7.3.2.2.cmml" xref="S3.p1.8.m8.7.7.3.2.2">𝑎</ci><ci id="S3.p1.8.m8.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1">𝑙</ci></apply><ci id="S3.p1.8.m8.7.7.3.3.cmml" xref="S3.p1.8.m8.7.7.3.3">𝑖</ci></apply><apply id="S3.p1.8.m8.7.7.1.cmml" xref="S3.p1.8.m8.7.7.1"><times id="S3.p1.8.m8.7.7.1.2.cmml" xref="S3.p1.8.m8.7.7.1.2"></times><apply id="S3.p1.8.m8.7.7.1.3.cmml" xref="S3.p1.8.m8.7.7.1.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.3.1.cmml" xref="S3.p1.8.m8.7.7.1.3">subscript</csymbol><ci id="S3.p1.8.m8.7.7.1.3.2.cmml" xref="S3.p1.8.m8.7.7.1.3.2">𝑊</ci><ci id="S3.p1.8.m8.7.7.1.3.3.cmml" xref="S3.p1.8.m8.7.7.1.3.3">𝑜</ci></apply><list id="S3.p1.8.m8.7.7.1.1.1.1.3.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2"><apply id="S3.p1.8.m8.7.7.1.1.1.1.1.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.1.1.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1">superscript</csymbol><apply id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.1.1.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.8.m8.3.3.2.3.cmml" xref="S3.p1.8.m8.3.3.2.4"><ci id="S3.p1.8.m8.2.2.1.1.cmml" xref="S3.p1.8.m8.2.2.1.1">𝑙</ci><cn type="integer" id="S3.p1.8.m8.3.3.2.2.cmml" xref="S3.p1.8.m8.3.3.2.2">0</cn></interval></apply><ci id="S3.p1.8.m8.6.6.cmml" xref="S3.p1.8.m8.6.6">…</ci><apply id="S3.p1.8.m8.7.7.1.1.1.1.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.2.2.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2">superscript</csymbol><apply id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.1.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3.cmml" xref="S3.p1.8.m8.7.7.1.1.1.1.2.2.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.8.m8.5.5.2.3.cmml" xref="S3.p1.8.m8.5.5.2.4"><ci id="S3.p1.8.m8.4.4.1.1.cmml" xref="S3.p1.8.m8.4.4.1.1">𝑙</ci><ci id="S3.p1.8.m8.5.5.2.2.cmml" xref="S3.p1.8.m8.5.5.2.2">𝐾</ci></interval></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.7c">a^{(l)}_{i}=W_{o}([a_{i}^{(l,0)},...,a_{i}^{(l,K)}])</annotation></semantics></math>, where <math id="S3.p1.9.m9.2" class="ltx_Math" alttext="a_{i}^{(l,k)}" display="inline"><semantics id="S3.p1.9.m9.2a"><msubsup id="S3.p1.9.m9.2.3" xref="S3.p1.9.m9.2.3.cmml"><mi id="S3.p1.9.m9.2.3.2.2" xref="S3.p1.9.m9.2.3.2.2.cmml">a</mi><mi id="S3.p1.9.m9.2.3.2.3" xref="S3.p1.9.m9.2.3.2.3.cmml">i</mi><mrow id="S3.p1.9.m9.2.2.2.4" xref="S3.p1.9.m9.2.2.2.3.cmml"><mo stretchy="false" id="S3.p1.9.m9.2.2.2.4.1" xref="S3.p1.9.m9.2.2.2.3.cmml">(</mo><mi id="S3.p1.9.m9.1.1.1.1" xref="S3.p1.9.m9.1.1.1.1.cmml">l</mi><mo id="S3.p1.9.m9.2.2.2.4.2" xref="S3.p1.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.p1.9.m9.2.2.2.2" xref="S3.p1.9.m9.2.2.2.2.cmml">k</mi><mo stretchy="false" id="S3.p1.9.m9.2.2.2.4.3" xref="S3.p1.9.m9.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.2b"><apply id="S3.p1.9.m9.2.3.cmml" xref="S3.p1.9.m9.2.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.2.3.1.cmml" xref="S3.p1.9.m9.2.3">superscript</csymbol><apply id="S3.p1.9.m9.2.3.2.cmml" xref="S3.p1.9.m9.2.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.2.3.2.1.cmml" xref="S3.p1.9.m9.2.3">subscript</csymbol><ci id="S3.p1.9.m9.2.3.2.2.cmml" xref="S3.p1.9.m9.2.3.2.2">𝑎</ci><ci id="S3.p1.9.m9.2.3.2.3.cmml" xref="S3.p1.9.m9.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.9.m9.2.2.2.3.cmml" xref="S3.p1.9.m9.2.2.2.4"><ci id="S3.p1.9.m9.1.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1.1">𝑙</ci><ci id="S3.p1.9.m9.2.2.2.2.cmml" xref="S3.p1.9.m9.2.2.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.2c">a_{i}^{(l,k)}</annotation></semantics></math> is the output of the <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p1.10.m10.1a"><mi id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><ci id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">k</annotation></semantics></math>-th attention head at layer <math id="S3.p1.11.m11.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p1.11.m11.1a"><mi id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><ci id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">l</annotation></semantics></math> (with <math id="S3.p1.12.m12.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.p1.12.m12.1a"><mi id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><ci id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">K</annotation></semantics></math> heads in total) for the <math id="S3.p1.13.m13.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.13.m13.1a"><mi id="S3.p1.13.m13.1.1" xref="S3.p1.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.1b"><ci id="S3.p1.13.m13.1.1.cmml" xref="S3.p1.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.1c">i</annotation></semantics></math>-th token, and <math id="S3.p1.14.m14.1" class="ltx_Math" alttext="W_{o}" display="inline"><semantics id="S3.p1.14.m14.1a"><msub id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml"><mi id="S3.p1.14.m14.1.1.2" xref="S3.p1.14.m14.1.1.2.cmml">W</mi><mi id="S3.p1.14.m14.1.1.3" xref="S3.p1.14.m14.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><apply id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.cmml" xref="S3.p1.14.m14.1.1">subscript</csymbol><ci id="S3.p1.14.m14.1.1.2.cmml" xref="S3.p1.14.m14.1.1.2">𝑊</ci><ci id="S3.p1.14.m14.1.1.3.cmml" xref="S3.p1.14.m14.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">W_{o}</annotation></semantics></math> is a linear transformation; 2) a <span id="S3.p1.26.2" class="ltx_text ltx_font_bold">multi-layer perceptron (MLP)</span> output <math id="S3.p1.15.m15.1" class="ltx_Math" alttext="m_{i}^{(l)}" display="inline"><semantics id="S3.p1.15.m15.1a"><msubsup id="S3.p1.15.m15.1.2" xref="S3.p1.15.m15.1.2.cmml"><mi id="S3.p1.15.m15.1.2.2.2" xref="S3.p1.15.m15.1.2.2.2.cmml">m</mi><mi id="S3.p1.15.m15.1.2.2.3" xref="S3.p1.15.m15.1.2.2.3.cmml">i</mi><mrow id="S3.p1.15.m15.1.1.1.3" xref="S3.p1.15.m15.1.2.cmml"><mo stretchy="false" id="S3.p1.15.m15.1.1.1.3.1" xref="S3.p1.15.m15.1.2.cmml">(</mo><mi id="S3.p1.15.m15.1.1.1.1" xref="S3.p1.15.m15.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.15.m15.1.1.1.3.2" xref="S3.p1.15.m15.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.15.m15.1b"><apply id="S3.p1.15.m15.1.2.cmml" xref="S3.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S3.p1.15.m15.1.2.1.cmml" xref="S3.p1.15.m15.1.2">superscript</csymbol><apply id="S3.p1.15.m15.1.2.2.cmml" xref="S3.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S3.p1.15.m15.1.2.2.1.cmml" xref="S3.p1.15.m15.1.2">subscript</csymbol><ci id="S3.p1.15.m15.1.2.2.2.cmml" xref="S3.p1.15.m15.1.2.2.2">𝑚</ci><ci id="S3.p1.15.m15.1.2.2.3.cmml" xref="S3.p1.15.m15.1.2.2.3">𝑖</ci></apply><ci id="S3.p1.15.m15.1.1.1.1.cmml" xref="S3.p1.15.m15.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m15.1c">m_{i}^{(l)}</annotation></semantics></math> = <math id="S3.p1.16.m16.4" class="ltx_Math" alttext="f_{\text{MLP}}^{(l)}(h_{i}^{(l-1)}+a^{(l)}_{i})" display="inline"><semantics id="S3.p1.16.m16.4a"><mrow id="S3.p1.16.m16.4.4" xref="S3.p1.16.m16.4.4.cmml"><msubsup id="S3.p1.16.m16.4.4.3" xref="S3.p1.16.m16.4.4.3.cmml"><mi id="S3.p1.16.m16.4.4.3.2.2" xref="S3.p1.16.m16.4.4.3.2.2.cmml">f</mi><mtext id="S3.p1.16.m16.4.4.3.2.3" xref="S3.p1.16.m16.4.4.3.2.3a.cmml">MLP</mtext><mrow id="S3.p1.16.m16.1.1.1.3" xref="S3.p1.16.m16.4.4.3.cmml"><mo stretchy="false" id="S3.p1.16.m16.1.1.1.3.1" xref="S3.p1.16.m16.4.4.3.cmml">(</mo><mi id="S3.p1.16.m16.1.1.1.1" xref="S3.p1.16.m16.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.16.m16.1.1.1.3.2" xref="S3.p1.16.m16.4.4.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.p1.16.m16.4.4.2" xref="S3.p1.16.m16.4.4.2.cmml">​</mo><mrow id="S3.p1.16.m16.4.4.1.1" xref="S3.p1.16.m16.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.p1.16.m16.4.4.1.1.2" xref="S3.p1.16.m16.4.4.1.1.1.cmml">(</mo><mrow id="S3.p1.16.m16.4.4.1.1.1" xref="S3.p1.16.m16.4.4.1.1.1.cmml"><msubsup id="S3.p1.16.m16.4.4.1.1.1.2" xref="S3.p1.16.m16.4.4.1.1.1.2.cmml"><mi id="S3.p1.16.m16.4.4.1.1.1.2.2.2" xref="S3.p1.16.m16.4.4.1.1.1.2.2.2.cmml">h</mi><mi id="S3.p1.16.m16.4.4.1.1.1.2.2.3" xref="S3.p1.16.m16.4.4.1.1.1.2.2.3.cmml">i</mi><mrow id="S3.p1.16.m16.2.2.1.1" xref="S3.p1.16.m16.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.p1.16.m16.2.2.1.1.2" xref="S3.p1.16.m16.2.2.1.1.1.cmml">(</mo><mrow id="S3.p1.16.m16.2.2.1.1.1" xref="S3.p1.16.m16.2.2.1.1.1.cmml"><mi id="S3.p1.16.m16.2.2.1.1.1.2" xref="S3.p1.16.m16.2.2.1.1.1.2.cmml">l</mi><mo id="S3.p1.16.m16.2.2.1.1.1.1" xref="S3.p1.16.m16.2.2.1.1.1.1.cmml">−</mo><mn id="S3.p1.16.m16.2.2.1.1.1.3" xref="S3.p1.16.m16.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.p1.16.m16.2.2.1.1.3" xref="S3.p1.16.m16.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.16.m16.4.4.1.1.1.1" xref="S3.p1.16.m16.4.4.1.1.1.1.cmml">+</mo><msubsup id="S3.p1.16.m16.4.4.1.1.1.3" xref="S3.p1.16.m16.4.4.1.1.1.3.cmml"><mi id="S3.p1.16.m16.4.4.1.1.1.3.2.2" xref="S3.p1.16.m16.4.4.1.1.1.3.2.2.cmml">a</mi><mi id="S3.p1.16.m16.4.4.1.1.1.3.3" xref="S3.p1.16.m16.4.4.1.1.1.3.3.cmml">i</mi><mrow id="S3.p1.16.m16.3.3.1.3" xref="S3.p1.16.m16.4.4.1.1.1.3.cmml"><mo stretchy="false" id="S3.p1.16.m16.3.3.1.3.1" xref="S3.p1.16.m16.4.4.1.1.1.3.cmml">(</mo><mi id="S3.p1.16.m16.3.3.1.1" xref="S3.p1.16.m16.3.3.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.16.m16.3.3.1.3.2" xref="S3.p1.16.m16.4.4.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S3.p1.16.m16.4.4.1.1.3" xref="S3.p1.16.m16.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.16.m16.4b"><apply id="S3.p1.16.m16.4.4.cmml" xref="S3.p1.16.m16.4.4"><times id="S3.p1.16.m16.4.4.2.cmml" xref="S3.p1.16.m16.4.4.2"></times><apply id="S3.p1.16.m16.4.4.3.cmml" xref="S3.p1.16.m16.4.4.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.3.1.cmml" xref="S3.p1.16.m16.4.4.3">superscript</csymbol><apply id="S3.p1.16.m16.4.4.3.2.cmml" xref="S3.p1.16.m16.4.4.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.3.2.1.cmml" xref="S3.p1.16.m16.4.4.3">subscript</csymbol><ci id="S3.p1.16.m16.4.4.3.2.2.cmml" xref="S3.p1.16.m16.4.4.3.2.2">𝑓</ci><ci id="S3.p1.16.m16.4.4.3.2.3a.cmml" xref="S3.p1.16.m16.4.4.3.2.3"><mtext mathsize="70%" id="S3.p1.16.m16.4.4.3.2.3.cmml" xref="S3.p1.16.m16.4.4.3.2.3">MLP</mtext></ci></apply><ci id="S3.p1.16.m16.1.1.1.1.cmml" xref="S3.p1.16.m16.1.1.1.1">𝑙</ci></apply><apply id="S3.p1.16.m16.4.4.1.1.1.cmml" xref="S3.p1.16.m16.4.4.1.1"><plus id="S3.p1.16.m16.4.4.1.1.1.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.1"></plus><apply id="S3.p1.16.m16.4.4.1.1.1.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.1.1.1.2.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2">superscript</csymbol><apply id="S3.p1.16.m16.4.4.1.1.1.2.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.1.1.1.2.2.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2">subscript</csymbol><ci id="S3.p1.16.m16.4.4.1.1.1.2.2.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2.2.2">ℎ</ci><ci id="S3.p1.16.m16.4.4.1.1.1.2.2.3.cmml" xref="S3.p1.16.m16.4.4.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.p1.16.m16.2.2.1.1.1.cmml" xref="S3.p1.16.m16.2.2.1.1"><minus id="S3.p1.16.m16.2.2.1.1.1.1.cmml" xref="S3.p1.16.m16.2.2.1.1.1.1"></minus><ci id="S3.p1.16.m16.2.2.1.1.1.2.cmml" xref="S3.p1.16.m16.2.2.1.1.1.2">𝑙</ci><cn type="integer" id="S3.p1.16.m16.2.2.1.1.1.3.cmml" xref="S3.p1.16.m16.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.p1.16.m16.4.4.1.1.1.3.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.1.1.1.3.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3">subscript</csymbol><apply id="S3.p1.16.m16.4.4.1.1.1.3.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.1.1.1.3.2.1.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3">superscript</csymbol><ci id="S3.p1.16.m16.4.4.1.1.1.3.2.2.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3.2.2">𝑎</ci><ci id="S3.p1.16.m16.3.3.1.1.cmml" xref="S3.p1.16.m16.3.3.1.1">𝑙</ci></apply><ci id="S3.p1.16.m16.4.4.1.1.1.3.3.cmml" xref="S3.p1.16.m16.4.4.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m16.4c">f_{\text{MLP}}^{(l)}(h_{i}^{(l-1)}+a^{(l)}_{i})</annotation></semantics></math> at layer <math id="S3.p1.17.m17.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p1.17.m17.1a"><mi id="S3.p1.17.m17.1.1" xref="S3.p1.17.m17.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.17.m17.1b"><ci id="S3.p1.17.m17.1.1.cmml" xref="S3.p1.17.m17.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m17.1c">l</annotation></semantics></math>. Putting together, the hidden representation <math id="S3.p1.18.m18.1" class="ltx_Math" alttext="h_{i}^{(l)}" display="inline"><semantics id="S3.p1.18.m18.1a"><msubsup id="S3.p1.18.m18.1.2" xref="S3.p1.18.m18.1.2.cmml"><mi id="S3.p1.18.m18.1.2.2.2" xref="S3.p1.18.m18.1.2.2.2.cmml">h</mi><mi id="S3.p1.18.m18.1.2.2.3" xref="S3.p1.18.m18.1.2.2.3.cmml">i</mi><mrow id="S3.p1.18.m18.1.1.1.3" xref="S3.p1.18.m18.1.2.cmml"><mo stretchy="false" id="S3.p1.18.m18.1.1.1.3.1" xref="S3.p1.18.m18.1.2.cmml">(</mo><mi id="S3.p1.18.m18.1.1.1.1" xref="S3.p1.18.m18.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.18.m18.1.1.1.3.2" xref="S3.p1.18.m18.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.18.m18.1b"><apply id="S3.p1.18.m18.1.2.cmml" xref="S3.p1.18.m18.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.2.1.cmml" xref="S3.p1.18.m18.1.2">superscript</csymbol><apply id="S3.p1.18.m18.1.2.2.cmml" xref="S3.p1.18.m18.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.2.2.1.cmml" xref="S3.p1.18.m18.1.2">subscript</csymbol><ci id="S3.p1.18.m18.1.2.2.2.cmml" xref="S3.p1.18.m18.1.2.2.2">ℎ</ci><ci id="S3.p1.18.m18.1.2.2.3.cmml" xref="S3.p1.18.m18.1.2.2.3">𝑖</ci></apply><ci id="S3.p1.18.m18.1.1.1.1.cmml" xref="S3.p1.18.m18.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m18.1c">h_{i}^{(l)}</annotation></semantics></math> is computed as: <math id="S3.p1.19.m19.4" class="ltx_Math" alttext="h_{i}^{(l)}=h_{i}^{(l-1)}+a^{(l)}_{i}+m_{i}^{(l)}" display="inline"><semantics id="S3.p1.19.m19.4a"><mrow id="S3.p1.19.m19.4.5" xref="S3.p1.19.m19.4.5.cmml"><msubsup id="S3.p1.19.m19.4.5.2" xref="S3.p1.19.m19.4.5.2.cmml"><mi id="S3.p1.19.m19.4.5.2.2.2" xref="S3.p1.19.m19.4.5.2.2.2.cmml">h</mi><mi id="S3.p1.19.m19.4.5.2.2.3" xref="S3.p1.19.m19.4.5.2.2.3.cmml">i</mi><mrow id="S3.p1.19.m19.1.1.1.3" xref="S3.p1.19.m19.4.5.2.cmml"><mo stretchy="false" id="S3.p1.19.m19.1.1.1.3.1" xref="S3.p1.19.m19.4.5.2.cmml">(</mo><mi id="S3.p1.19.m19.1.1.1.1" xref="S3.p1.19.m19.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.19.m19.1.1.1.3.2" xref="S3.p1.19.m19.4.5.2.cmml">)</mo></mrow></msubsup><mo id="S3.p1.19.m19.4.5.1" xref="S3.p1.19.m19.4.5.1.cmml">=</mo><mrow id="S3.p1.19.m19.4.5.3" xref="S3.p1.19.m19.4.5.3.cmml"><msubsup id="S3.p1.19.m19.4.5.3.2" xref="S3.p1.19.m19.4.5.3.2.cmml"><mi id="S3.p1.19.m19.4.5.3.2.2.2" xref="S3.p1.19.m19.4.5.3.2.2.2.cmml">h</mi><mi id="S3.p1.19.m19.4.5.3.2.2.3" xref="S3.p1.19.m19.4.5.3.2.2.3.cmml">i</mi><mrow id="S3.p1.19.m19.2.2.1.1" xref="S3.p1.19.m19.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.p1.19.m19.2.2.1.1.2" xref="S3.p1.19.m19.2.2.1.1.1.cmml">(</mo><mrow id="S3.p1.19.m19.2.2.1.1.1" xref="S3.p1.19.m19.2.2.1.1.1.cmml"><mi id="S3.p1.19.m19.2.2.1.1.1.2" xref="S3.p1.19.m19.2.2.1.1.1.2.cmml">l</mi><mo id="S3.p1.19.m19.2.2.1.1.1.1" xref="S3.p1.19.m19.2.2.1.1.1.1.cmml">−</mo><mn id="S3.p1.19.m19.2.2.1.1.1.3" xref="S3.p1.19.m19.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.p1.19.m19.2.2.1.1.3" xref="S3.p1.19.m19.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.19.m19.4.5.3.1" xref="S3.p1.19.m19.4.5.3.1.cmml">+</mo><msubsup id="S3.p1.19.m19.4.5.3.3" xref="S3.p1.19.m19.4.5.3.3.cmml"><mi id="S3.p1.19.m19.4.5.3.3.2.2" xref="S3.p1.19.m19.4.5.3.3.2.2.cmml">a</mi><mi id="S3.p1.19.m19.4.5.3.3.3" xref="S3.p1.19.m19.4.5.3.3.3.cmml">i</mi><mrow id="S3.p1.19.m19.3.3.1.3" xref="S3.p1.19.m19.4.5.3.3.cmml"><mo stretchy="false" id="S3.p1.19.m19.3.3.1.3.1" xref="S3.p1.19.m19.4.5.3.3.cmml">(</mo><mi id="S3.p1.19.m19.3.3.1.1" xref="S3.p1.19.m19.3.3.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.19.m19.3.3.1.3.2" xref="S3.p1.19.m19.4.5.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.19.m19.4.5.3.1a" xref="S3.p1.19.m19.4.5.3.1.cmml">+</mo><msubsup id="S3.p1.19.m19.4.5.3.4" xref="S3.p1.19.m19.4.5.3.4.cmml"><mi id="S3.p1.19.m19.4.5.3.4.2.2" xref="S3.p1.19.m19.4.5.3.4.2.2.cmml">m</mi><mi id="S3.p1.19.m19.4.5.3.4.2.3" xref="S3.p1.19.m19.4.5.3.4.2.3.cmml">i</mi><mrow id="S3.p1.19.m19.4.4.1.3" xref="S3.p1.19.m19.4.5.3.4.cmml"><mo stretchy="false" id="S3.p1.19.m19.4.4.1.3.1" xref="S3.p1.19.m19.4.5.3.4.cmml">(</mo><mi id="S3.p1.19.m19.4.4.1.1" xref="S3.p1.19.m19.4.4.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.19.m19.4.4.1.3.2" xref="S3.p1.19.m19.4.5.3.4.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.19.m19.4b"><apply id="S3.p1.19.m19.4.5.cmml" xref="S3.p1.19.m19.4.5"><eq id="S3.p1.19.m19.4.5.1.cmml" xref="S3.p1.19.m19.4.5.1"></eq><apply id="S3.p1.19.m19.4.5.2.cmml" xref="S3.p1.19.m19.4.5.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.2.1.cmml" xref="S3.p1.19.m19.4.5.2">superscript</csymbol><apply id="S3.p1.19.m19.4.5.2.2.cmml" xref="S3.p1.19.m19.4.5.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.2.2.1.cmml" xref="S3.p1.19.m19.4.5.2">subscript</csymbol><ci id="S3.p1.19.m19.4.5.2.2.2.cmml" xref="S3.p1.19.m19.4.5.2.2.2">ℎ</ci><ci id="S3.p1.19.m19.4.5.2.2.3.cmml" xref="S3.p1.19.m19.4.5.2.2.3">𝑖</ci></apply><ci id="S3.p1.19.m19.1.1.1.1.cmml" xref="S3.p1.19.m19.1.1.1.1">𝑙</ci></apply><apply id="S3.p1.19.m19.4.5.3.cmml" xref="S3.p1.19.m19.4.5.3"><plus id="S3.p1.19.m19.4.5.3.1.cmml" xref="S3.p1.19.m19.4.5.3.1"></plus><apply id="S3.p1.19.m19.4.5.3.2.cmml" xref="S3.p1.19.m19.4.5.3.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.2.1.cmml" xref="S3.p1.19.m19.4.5.3.2">superscript</csymbol><apply id="S3.p1.19.m19.4.5.3.2.2.cmml" xref="S3.p1.19.m19.4.5.3.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.2.2.1.cmml" xref="S3.p1.19.m19.4.5.3.2">subscript</csymbol><ci id="S3.p1.19.m19.4.5.3.2.2.2.cmml" xref="S3.p1.19.m19.4.5.3.2.2.2">ℎ</ci><ci id="S3.p1.19.m19.4.5.3.2.2.3.cmml" xref="S3.p1.19.m19.4.5.3.2.2.3">𝑖</ci></apply><apply id="S3.p1.19.m19.2.2.1.1.1.cmml" xref="S3.p1.19.m19.2.2.1.1"><minus id="S3.p1.19.m19.2.2.1.1.1.1.cmml" xref="S3.p1.19.m19.2.2.1.1.1.1"></minus><ci id="S3.p1.19.m19.2.2.1.1.1.2.cmml" xref="S3.p1.19.m19.2.2.1.1.1.2">𝑙</ci><cn type="integer" id="S3.p1.19.m19.2.2.1.1.1.3.cmml" xref="S3.p1.19.m19.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.p1.19.m19.4.5.3.3.cmml" xref="S3.p1.19.m19.4.5.3.3"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.3.1.cmml" xref="S3.p1.19.m19.4.5.3.3">subscript</csymbol><apply id="S3.p1.19.m19.4.5.3.3.2.cmml" xref="S3.p1.19.m19.4.5.3.3"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.3.2.1.cmml" xref="S3.p1.19.m19.4.5.3.3">superscript</csymbol><ci id="S3.p1.19.m19.4.5.3.3.2.2.cmml" xref="S3.p1.19.m19.4.5.3.3.2.2">𝑎</ci><ci id="S3.p1.19.m19.3.3.1.1.cmml" xref="S3.p1.19.m19.3.3.1.1">𝑙</ci></apply><ci id="S3.p1.19.m19.4.5.3.3.3.cmml" xref="S3.p1.19.m19.4.5.3.3.3">𝑖</ci></apply><apply id="S3.p1.19.m19.4.5.3.4.cmml" xref="S3.p1.19.m19.4.5.3.4"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.4.1.cmml" xref="S3.p1.19.m19.4.5.3.4">superscript</csymbol><apply id="S3.p1.19.m19.4.5.3.4.2.cmml" xref="S3.p1.19.m19.4.5.3.4"><csymbol cd="ambiguous" id="S3.p1.19.m19.4.5.3.4.2.1.cmml" xref="S3.p1.19.m19.4.5.3.4">subscript</csymbol><ci id="S3.p1.19.m19.4.5.3.4.2.2.cmml" xref="S3.p1.19.m19.4.5.3.4.2.2">𝑚</ci><ci id="S3.p1.19.m19.4.5.3.4.2.3.cmml" xref="S3.p1.19.m19.4.5.3.4.2.3">𝑖</ci></apply><ci id="S3.p1.19.m19.4.4.1.1.cmml" xref="S3.p1.19.m19.4.4.1.1">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m19.4c">h_{i}^{(l)}=h_{i}^{(l-1)}+a^{(l)}_{i}+m_{i}^{(l)}</annotation></semantics></math>. Let <math id="S3.p1.20.m20.1" class="ltx_Math" alttext="H=\{h^{l}_{i}\}" display="inline"><semantics id="S3.p1.20.m20.1a"><mrow id="S3.p1.20.m20.1.1" xref="S3.p1.20.m20.1.1.cmml"><mi id="S3.p1.20.m20.1.1.3" xref="S3.p1.20.m20.1.1.3.cmml">H</mi><mo id="S3.p1.20.m20.1.1.2" xref="S3.p1.20.m20.1.1.2.cmml">=</mo><mrow id="S3.p1.20.m20.1.1.1.1" xref="S3.p1.20.m20.1.1.1.2.cmml"><mo stretchy="false" id="S3.p1.20.m20.1.1.1.1.2" xref="S3.p1.20.m20.1.1.1.2.cmml">{</mo><msubsup id="S3.p1.20.m20.1.1.1.1.1" xref="S3.p1.20.m20.1.1.1.1.1.cmml"><mi id="S3.p1.20.m20.1.1.1.1.1.2.2" xref="S3.p1.20.m20.1.1.1.1.1.2.2.cmml">h</mi><mi id="S3.p1.20.m20.1.1.1.1.1.3" xref="S3.p1.20.m20.1.1.1.1.1.3.cmml">i</mi><mi id="S3.p1.20.m20.1.1.1.1.1.2.3" xref="S3.p1.20.m20.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.p1.20.m20.1.1.1.1.3" xref="S3.p1.20.m20.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.20.m20.1b"><apply id="S3.p1.20.m20.1.1.cmml" xref="S3.p1.20.m20.1.1"><eq id="S3.p1.20.m20.1.1.2.cmml" xref="S3.p1.20.m20.1.1.2"></eq><ci id="S3.p1.20.m20.1.1.3.cmml" xref="S3.p1.20.m20.1.1.3">𝐻</ci><set id="S3.p1.20.m20.1.1.1.2.cmml" xref="S3.p1.20.m20.1.1.1.1"><apply id="S3.p1.20.m20.1.1.1.1.1.cmml" xref="S3.p1.20.m20.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.20.m20.1.1.1.1.1.1.cmml" xref="S3.p1.20.m20.1.1.1.1.1">subscript</csymbol><apply id="S3.p1.20.m20.1.1.1.1.1.2.cmml" xref="S3.p1.20.m20.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.20.m20.1.1.1.1.1.2.1.cmml" xref="S3.p1.20.m20.1.1.1.1.1">superscript</csymbol><ci id="S3.p1.20.m20.1.1.1.1.1.2.2.cmml" xref="S3.p1.20.m20.1.1.1.1.1.2.2">ℎ</ci><ci id="S3.p1.20.m20.1.1.1.1.1.2.3.cmml" xref="S3.p1.20.m20.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.p1.20.m20.1.1.1.1.1.3.cmml" xref="S3.p1.20.m20.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.20.m20.1c">H=\{h^{l}_{i}\}</annotation></semantics></math> be the set of <math id="S3.p1.21.m21.1" class="ltx_Math" alttext="T\times L" display="inline"><semantics id="S3.p1.21.m21.1a"><mrow id="S3.p1.21.m21.1.1" xref="S3.p1.21.m21.1.1.cmml"><mi id="S3.p1.21.m21.1.1.2" xref="S3.p1.21.m21.1.1.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.21.m21.1.1.1" xref="S3.p1.21.m21.1.1.1.cmml">×</mo><mi id="S3.p1.21.m21.1.1.3" xref="S3.p1.21.m21.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.21.m21.1b"><apply id="S3.p1.21.m21.1.1.cmml" xref="S3.p1.21.m21.1.1"><times id="S3.p1.21.m21.1.1.1.cmml" xref="S3.p1.21.m21.1.1.1"></times><ci id="S3.p1.21.m21.1.1.2.cmml" xref="S3.p1.21.m21.1.1.2">𝑇</ci><ci id="S3.p1.21.m21.1.1.3.cmml" xref="S3.p1.21.m21.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.21.m21.1c">T\times L</annotation></semantics></math> token hidden states across all layers (following <cite class="ltx_cite ltx_citemacro_citet">Elhage et&nbsp;al. (<a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, we shall call them the <span id="S3.p1.26.3" class="ltx_text ltx_font_bold">residual stream outputs</span>), <math id="S3.p1.22.m22.1" class="ltx_Math" alttext="A=\{a^{l}_{i}\}" display="inline"><semantics id="S3.p1.22.m22.1a"><mrow id="S3.p1.22.m22.1.1" xref="S3.p1.22.m22.1.1.cmml"><mi id="S3.p1.22.m22.1.1.3" xref="S3.p1.22.m22.1.1.3.cmml">A</mi><mo id="S3.p1.22.m22.1.1.2" xref="S3.p1.22.m22.1.1.2.cmml">=</mo><mrow id="S3.p1.22.m22.1.1.1.1" xref="S3.p1.22.m22.1.1.1.2.cmml"><mo stretchy="false" id="S3.p1.22.m22.1.1.1.1.2" xref="S3.p1.22.m22.1.1.1.2.cmml">{</mo><msubsup id="S3.p1.22.m22.1.1.1.1.1" xref="S3.p1.22.m22.1.1.1.1.1.cmml"><mi id="S3.p1.22.m22.1.1.1.1.1.2.2" xref="S3.p1.22.m22.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.p1.22.m22.1.1.1.1.1.3" xref="S3.p1.22.m22.1.1.1.1.1.3.cmml">i</mi><mi id="S3.p1.22.m22.1.1.1.1.1.2.3" xref="S3.p1.22.m22.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.p1.22.m22.1.1.1.1.3" xref="S3.p1.22.m22.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.22.m22.1b"><apply id="S3.p1.22.m22.1.1.cmml" xref="S3.p1.22.m22.1.1"><eq id="S3.p1.22.m22.1.1.2.cmml" xref="S3.p1.22.m22.1.1.2"></eq><ci id="S3.p1.22.m22.1.1.3.cmml" xref="S3.p1.22.m22.1.1.3">𝐴</ci><set id="S3.p1.22.m22.1.1.1.2.cmml" xref="S3.p1.22.m22.1.1.1.1"><apply id="S3.p1.22.m22.1.1.1.1.1.cmml" xref="S3.p1.22.m22.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m22.1.1.1.1.1.1.cmml" xref="S3.p1.22.m22.1.1.1.1.1">subscript</csymbol><apply id="S3.p1.22.m22.1.1.1.1.1.2.cmml" xref="S3.p1.22.m22.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m22.1.1.1.1.1.2.1.cmml" xref="S3.p1.22.m22.1.1.1.1.1">superscript</csymbol><ci id="S3.p1.22.m22.1.1.1.1.1.2.2.cmml" xref="S3.p1.22.m22.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.p1.22.m22.1.1.1.1.1.2.3.cmml" xref="S3.p1.22.m22.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.p1.22.m22.1.1.1.1.1.3.cmml" xref="S3.p1.22.m22.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.22.m22.1c">A=\{a^{l}_{i}\}</annotation></semantics></math> be the set of <math id="S3.p1.23.m23.1" class="ltx_Math" alttext="T\times L" display="inline"><semantics id="S3.p1.23.m23.1a"><mrow id="S3.p1.23.m23.1.1" xref="S3.p1.23.m23.1.1.cmml"><mi id="S3.p1.23.m23.1.1.2" xref="S3.p1.23.m23.1.1.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.23.m23.1.1.1" xref="S3.p1.23.m23.1.1.1.cmml">×</mo><mi id="S3.p1.23.m23.1.1.3" xref="S3.p1.23.m23.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.23.m23.1b"><apply id="S3.p1.23.m23.1.1.cmml" xref="S3.p1.23.m23.1.1"><times id="S3.p1.23.m23.1.1.1.cmml" xref="S3.p1.23.m23.1.1.1"></times><ci id="S3.p1.23.m23.1.1.2.cmml" xref="S3.p1.23.m23.1.1.2">𝑇</ci><ci id="S3.p1.23.m23.1.1.3.cmml" xref="S3.p1.23.m23.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.23.m23.1c">T\times L</annotation></semantics></math> <span id="S3.p1.26.4" class="ltx_text ltx_font_bold">attention outputs</span>, and <math id="S3.p1.24.m24.2" class="ltx_Math" alttext="M=\{m^{(l)}_{i}\}" display="inline"><semantics id="S3.p1.24.m24.2a"><mrow id="S3.p1.24.m24.2.2" xref="S3.p1.24.m24.2.2.cmml"><mi id="S3.p1.24.m24.2.2.3" xref="S3.p1.24.m24.2.2.3.cmml">M</mi><mo id="S3.p1.24.m24.2.2.2" xref="S3.p1.24.m24.2.2.2.cmml">=</mo><mrow id="S3.p1.24.m24.2.2.1.1" xref="S3.p1.24.m24.2.2.1.2.cmml"><mo stretchy="false" id="S3.p1.24.m24.2.2.1.1.2" xref="S3.p1.24.m24.2.2.1.2.cmml">{</mo><msubsup id="S3.p1.24.m24.2.2.1.1.1" xref="S3.p1.24.m24.2.2.1.1.1.cmml"><mi id="S3.p1.24.m24.2.2.1.1.1.2.2" xref="S3.p1.24.m24.2.2.1.1.1.2.2.cmml">m</mi><mi id="S3.p1.24.m24.2.2.1.1.1.3" xref="S3.p1.24.m24.2.2.1.1.1.3.cmml">i</mi><mrow id="S3.p1.24.m24.1.1.1.3" xref="S3.p1.24.m24.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.p1.24.m24.1.1.1.3.1" xref="S3.p1.24.m24.2.2.1.1.1.cmml">(</mo><mi id="S3.p1.24.m24.1.1.1.1" xref="S3.p1.24.m24.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.p1.24.m24.1.1.1.3.2" xref="S3.p1.24.m24.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.p1.24.m24.2.2.1.1.3" xref="S3.p1.24.m24.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.24.m24.2b"><apply id="S3.p1.24.m24.2.2.cmml" xref="S3.p1.24.m24.2.2"><eq id="S3.p1.24.m24.2.2.2.cmml" xref="S3.p1.24.m24.2.2.2"></eq><ci id="S3.p1.24.m24.2.2.3.cmml" xref="S3.p1.24.m24.2.2.3">𝑀</ci><set id="S3.p1.24.m24.2.2.1.2.cmml" xref="S3.p1.24.m24.2.2.1.1"><apply id="S3.p1.24.m24.2.2.1.1.1.cmml" xref="S3.p1.24.m24.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.24.m24.2.2.1.1.1.1.cmml" xref="S3.p1.24.m24.2.2.1.1.1">subscript</csymbol><apply id="S3.p1.24.m24.2.2.1.1.1.2.cmml" xref="S3.p1.24.m24.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.24.m24.2.2.1.1.1.2.1.cmml" xref="S3.p1.24.m24.2.2.1.1.1">superscript</csymbol><ci id="S3.p1.24.m24.2.2.1.1.1.2.2.cmml" xref="S3.p1.24.m24.2.2.1.1.1.2.2">𝑚</ci><ci id="S3.p1.24.m24.1.1.1.1.cmml" xref="S3.p1.24.m24.1.1.1.1">𝑙</ci></apply><ci id="S3.p1.24.m24.2.2.1.1.1.3.cmml" xref="S3.p1.24.m24.2.2.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.24.m24.2c">M=\{m^{(l)}_{i}\}</annotation></semantics></math> be the set of <math id="S3.p1.25.m25.1" class="ltx_Math" alttext="T\times L" display="inline"><semantics id="S3.p1.25.m25.1a"><mrow id="S3.p1.25.m25.1.1" xref="S3.p1.25.m25.1.1.cmml"><mi id="S3.p1.25.m25.1.1.2" xref="S3.p1.25.m25.1.1.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.25.m25.1.1.1" xref="S3.p1.25.m25.1.1.1.cmml">×</mo><mi id="S3.p1.25.m25.1.1.3" xref="S3.p1.25.m25.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.25.m25.1b"><apply id="S3.p1.25.m25.1.1.cmml" xref="S3.p1.25.m25.1.1"><times id="S3.p1.25.m25.1.1.1.cmml" xref="S3.p1.25.m25.1.1.1"></times><ci id="S3.p1.25.m25.1.1.2.cmml" xref="S3.p1.25.m25.1.1.2">𝑇</ci><ci id="S3.p1.25.m25.1.1.3.cmml" xref="S3.p1.25.m25.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.25.m25.1c">T\times L</annotation></semantics></math> <span id="S3.p1.26.5" class="ltx_text ltx_font_bold">MLP outputs</span>. We aim to investigate which intermediate hidden representations <math id="S3.p1.26.m26.1" class="ltx_Math" alttext="z\in Z=H\bigcup A\bigcup M" display="inline"><semantics id="S3.p1.26.m26.1a"><mrow id="S3.p1.26.m26.1.1" xref="S3.p1.26.m26.1.1.cmml"><mi id="S3.p1.26.m26.1.1.2" xref="S3.p1.26.m26.1.1.2.cmml">z</mi><mo id="S3.p1.26.m26.1.1.3" xref="S3.p1.26.m26.1.1.3.cmml">∈</mo><mi id="S3.p1.26.m26.1.1.4" xref="S3.p1.26.m26.1.1.4.cmml">Z</mi><mo id="S3.p1.26.m26.1.1.5" xref="S3.p1.26.m26.1.1.5.cmml">=</mo><mrow id="S3.p1.26.m26.1.1.6" xref="S3.p1.26.m26.1.1.6.cmml"><mi id="S3.p1.26.m26.1.1.6.2" xref="S3.p1.26.m26.1.1.6.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.p1.26.m26.1.1.6.1" xref="S3.p1.26.m26.1.1.6.1.cmml">​</mo><mrow id="S3.p1.26.m26.1.1.6.3" xref="S3.p1.26.m26.1.1.6.3.cmml"><mo id="S3.p1.26.m26.1.1.6.3.1" xref="S3.p1.26.m26.1.1.6.3.1.cmml">⋃</mo><mrow id="S3.p1.26.m26.1.1.6.3.2" xref="S3.p1.26.m26.1.1.6.3.2.cmml"><mi id="S3.p1.26.m26.1.1.6.3.2.2" xref="S3.p1.26.m26.1.1.6.3.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.p1.26.m26.1.1.6.3.2.1" xref="S3.p1.26.m26.1.1.6.3.2.1.cmml">​</mo><mrow id="S3.p1.26.m26.1.1.6.3.2.3" xref="S3.p1.26.m26.1.1.6.3.2.3.cmml"><mo id="S3.p1.26.m26.1.1.6.3.2.3.1" xref="S3.p1.26.m26.1.1.6.3.2.3.1.cmml">⋃</mo><mi id="S3.p1.26.m26.1.1.6.3.2.3.2" xref="S3.p1.26.m26.1.1.6.3.2.3.2.cmml">M</mi></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.26.m26.1b"><apply id="S3.p1.26.m26.1.1.cmml" xref="S3.p1.26.m26.1.1"><and id="S3.p1.26.m26.1.1a.cmml" xref="S3.p1.26.m26.1.1"></and><apply id="S3.p1.26.m26.1.1b.cmml" xref="S3.p1.26.m26.1.1"><in id="S3.p1.26.m26.1.1.3.cmml" xref="S3.p1.26.m26.1.1.3"></in><ci id="S3.p1.26.m26.1.1.2.cmml" xref="S3.p1.26.m26.1.1.2">𝑧</ci><ci id="S3.p1.26.m26.1.1.4.cmml" xref="S3.p1.26.m26.1.1.4">𝑍</ci></apply><apply id="S3.p1.26.m26.1.1c.cmml" xref="S3.p1.26.m26.1.1"><eq id="S3.p1.26.m26.1.1.5.cmml" xref="S3.p1.26.m26.1.1.5"></eq><share href="#S3.p1.26.m26.1.1.4.cmml" id="S3.p1.26.m26.1.1d.cmml" xref="S3.p1.26.m26.1.1"></share><apply id="S3.p1.26.m26.1.1.6.cmml" xref="S3.p1.26.m26.1.1.6"><times id="S3.p1.26.m26.1.1.6.1.cmml" xref="S3.p1.26.m26.1.1.6.1"></times><ci id="S3.p1.26.m26.1.1.6.2.cmml" xref="S3.p1.26.m26.1.1.6.2">𝐻</ci><apply id="S3.p1.26.m26.1.1.6.3.cmml" xref="S3.p1.26.m26.1.1.6.3"><union id="S3.p1.26.m26.1.1.6.3.1.cmml" xref="S3.p1.26.m26.1.1.6.3.1"></union><apply id="S3.p1.26.m26.1.1.6.3.2.cmml" xref="S3.p1.26.m26.1.1.6.3.2"><times id="S3.p1.26.m26.1.1.6.3.2.1.cmml" xref="S3.p1.26.m26.1.1.6.3.2.1"></times><ci id="S3.p1.26.m26.1.1.6.3.2.2.cmml" xref="S3.p1.26.m26.1.1.6.3.2.2">𝐴</ci><apply id="S3.p1.26.m26.1.1.6.3.2.3.cmml" xref="S3.p1.26.m26.1.1.6.3.2.3"><union id="S3.p1.26.m26.1.1.6.3.2.3.1.cmml" xref="S3.p1.26.m26.1.1.6.3.2.3.1"></union><ci id="S3.p1.26.m26.1.1.6.3.2.3.2.cmml" xref="S3.p1.26.m26.1.1.6.3.2.3.2">𝑀</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.26.m26.1c">z\in Z=H\bigcup A\bigcup M</annotation></semantics></math> are causally contributing to the generation of a factually incorrect entity. For further details on transformers, see <cite class="ltx_cite ltx_citemacro_citet">Vaswani et&nbsp;al. (<a href="#bib.bib49" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Mechanisms of Hallucinations</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Causal tracing of factual errors</h3>

<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Method.</h4>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.2" class="ltx_p">The intermediate hidden states <math id="S4.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">H</annotation></semantics></math> produced by <math id="S4.SS1.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">G</annotation></semantics></math> during model inference form a causal dependency graph <cite class="ltx_cite ltx_citemacro_cite">Pearl (<a href="#bib.bib39" title="" class="ltx_ref">2001</a>)</cite> that contains many paths from the input sequence to the output (next-token prediction), and we wish to understand if there are specific hidden states that are more important than others when producing a hallucination. This is a natural case for <span id="S4.SS1.SSS0.Px1.p1.2.1" class="ltx_text ltx_font_italic">causal mediation analysis</span>, which quantifies the contribution of intermediate variables in causal graphs. For more information about causal mediation analysis of language models, see <cite class="ltx_cite ltx_citemacro_citet">Vig et&nbsp;al. (<a href="#bib.bib50" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S4.SS1.SSS0.Px1.p2" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p2.11" class="ltx_p">We adapt the framework of <cite class="ltx_cite ltx_citemacro_citet">Meng et&nbsp;al. (<a href="#bib.bib31" title="" class="ltx_ref">2022a</a>)</cite> to locate LM components that cause factual errors via the task of factual open-domain questions on structured queries. In particular, given a fact represented as a subject-relation-object triple <math id="S4.SS1.SSS0.Px1.p2.1.m1.3" class="ltx_Math" alttext="(s,r,o)" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.1.m1.3a"><mrow id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.2.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.3.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.3.cmml">o</mi><mo stretchy="false" id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2.4" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.1.m1.3b"><vector id="S4.SS1.SSS0.Px1.p2.1.m1.3.4.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.4.2"><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p2.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.2.2">𝑟</ci><ci id="S4.SS1.SSS0.Px1.p2.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.3.3">𝑜</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.1.m1.3c">(s,r,o)</annotation></semantics></math>, we provide an LM <math id="S4.SS1.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.2.m2.1c">G</annotation></semantics></math> with a query prompt <math id="S4.SS1.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.3.m3.1a"><mi id="S4.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.3.m3.1b"><ci id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.3.m3.1c">u</annotation></semantics></math> containing <math id="S4.SS1.SSS0.Px1.p2.4.m4.2" class="ltx_Math" alttext="(s,r)" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.4.m4.2a"><mrow id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2.1" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p2.4.m4.2.2" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.2.cmml">r</mi><mo stretchy="false" id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2.3" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.4.m4.2b"><interval closure="open" id="S4.SS1.SSS0.Px1.p2.4.m4.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.3.2"><ci id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px1.p2.4.m4.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.2.2">𝑟</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.4.m4.2c">(s,r)</annotation></semantics></math> (e.g., “Toulouse is the twin city of __”) with <math id="S4.SS1.SSS0.Px1.p2.5.m5.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.5.m5.1a"><mi id="S4.SS1.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.5.m5.1b"><ci id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.5.m5.1c">o</annotation></semantics></math> as a true continuation (e.g., “Atlanta”). We examine the cases where <math id="S4.SS1.SSS0.Px1.p2.6.m6.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.6.m6.1a"><mi id="S4.SS1.SSS0.Px1.p2.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.6.m6.1b"><ci id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.6.m6.1c">G</annotation></semantics></math> predicts an incorrect object <math id="S4.SS1.SSS0.Px1.p2.7.m7.1" class="ltx_Math" alttext="o^{\prime}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.7.m7.1a"><msup id="S4.SS1.SSS0.Px1.p2.7.m7.1.1" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.7.m7.1b"><apply id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.7.m7.1c">o^{\prime}</annotation></semantics></math> as the next token(s) given <math id="S4.SS1.SSS0.Px1.p2.8.m8.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.8.m8.1a"><mi id="S4.SS1.SSS0.Px1.p2.8.m8.1.1" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.8.m8.1b"><ci id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.8.m8.1c">u</annotation></semantics></math>, and aim to locate which intermediate hidden states in the computation graph of <math id="S4.SS1.SSS0.Px1.p2.9.m9.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.9.m9.1a"><mi id="S4.SS1.SSS0.Px1.p2.9.m9.1.1" xref="S4.SS1.SSS0.Px1.p2.9.m9.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.9.m9.1b"><ci id="S4.SS1.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.9.m9.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.9.m9.1c">G</annotation></semantics></math> led to the hallucination. We consider <math id="S4.SS1.SSS0.Px1.p2.10.m10.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.10.m10.1a"><mi id="S4.SS1.SSS0.Px1.p2.10.m10.1.1" xref="S4.SS1.SSS0.Px1.p2.10.m10.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.10.m10.1b"><ci id="S4.SS1.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.10.m10.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.10.m10.1c">G</annotation></semantics></math> to be a “corrupted” model with certain modules failing to compute the “clean” representations that could otherwise lead to the correct answer <math id="S4.SS1.SSS0.Px1.p2.11.m11.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.11.m11.1a"><mi id="S4.SS1.SSS0.Px1.p2.11.m11.1.1" xref="S4.SS1.SSS0.Px1.p2.11.m11.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.11.m11.1b"><ci id="S4.SS1.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.11.m11.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.11.m11.1c">o</annotation></semantics></math>, and measure the contribution of each module through three model runs:</p>
</div>
<div id="S4.SS1.SSS0.Px1.p3" class="ltx_para">
<ol id="S4.I1" class="ltx_enumerate">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.6" class="ltx_p">In the <span id="S4.I1.i1.p1.6.1" class="ltx_text ltx_font_bold">hallucination run</span>, we pass <math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><mi id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><ci id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">u</annotation></semantics></math> into <math id="S4.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.I1.i1.p1.2.m2.1a"><mi id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><ci id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">G</annotation></semantics></math> and extract all intermediate hidden representations <math id="S4.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S4.I1.i1.p1.3.m3.1a"><mi id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><ci id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">Z</annotation></semantics></math> as defined in Section&nbsp;<a href="#S3" title="3 Background and Notation ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, and compute the log likelihood ratio <math id="S4.I1.i1.p1.4.m4.4" class="ltx_Math" alttext="y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}" display="inline"><semantics id="S4.I1.i1.p1.4.m4.4a"><mrow id="S4.I1.i1.p1.4.m4.4.5" xref="S4.I1.i1.p1.4.m4.4.5.cmml"><mi id="S4.I1.i1.p1.4.m4.4.5.2" xref="S4.I1.i1.p1.4.m4.4.5.2.cmml">y</mi><mo id="S4.I1.i1.p1.4.m4.4.5.1" xref="S4.I1.i1.p1.4.m4.4.5.1.cmml">=</mo><mrow id="S4.I1.i1.p1.4.m4.4.5.3" xref="S4.I1.i1.p1.4.m4.4.5.3.cmml"><mi id="S4.I1.i1.p1.4.m4.4.5.3.1" xref="S4.I1.i1.p1.4.m4.4.5.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.I1.i1.p1.4.m4.4.5.3a" xref="S4.I1.i1.p1.4.m4.4.5.3.cmml">⁡</mo><mfrac id="S4.I1.i1.p1.4.m4.4.4" xref="S4.I1.i1.p1.4.m4.4.4.cmml"><mrow id="S4.I1.i1.p1.4.m4.2.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.4" xref="S4.I1.i1.p1.4.m4.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.I1.i1.p1.4.m4.2.2.2.3" xref="S4.I1.i1.p1.4.m4.2.2.2.3.cmml">​</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml"><msup id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2.cmml">o</mi><mo id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mi id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1.cmml">​</mo><mrow id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.3.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mo stretchy="false" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.3.2.1" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml">(</mo><mi id="S4.I1.i1.p1.4.m4.1.1.1.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.cmml">u</mi><mo stretchy="false" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.3.2.2" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.3" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.I1.i1.p1.4.m4.4.4.4" xref="S4.I1.i1.p1.4.m4.4.4.4.cmml"><mi id="S4.I1.i1.p1.4.m4.4.4.4.4" xref="S4.I1.i1.p1.4.m4.4.4.4.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.I1.i1.p1.4.m4.4.4.4.3" xref="S4.I1.i1.p1.4.m4.4.4.4.3.cmml">​</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml"><mo stretchy="false" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml">(</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml"><mi id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2.cmml">o</mi><mo fence="false" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mi id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1.cmml">​</mo><mrow id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.3.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mo stretchy="false" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.3.2.1" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml">(</mo><mi id="S4.I1.i1.p1.4.m4.3.3.3.1" xref="S4.I1.i1.p1.4.m4.3.3.3.1.cmml">u</mi><mo stretchy="false" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.3.2.2" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.3" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.4b"><apply id="S4.I1.i1.p1.4.m4.4.5.cmml" xref="S4.I1.i1.p1.4.m4.4.5"><eq id="S4.I1.i1.p1.4.m4.4.5.1.cmml" xref="S4.I1.i1.p1.4.m4.4.5.1"></eq><ci id="S4.I1.i1.p1.4.m4.4.5.2.cmml" xref="S4.I1.i1.p1.4.m4.4.5.2">𝑦</ci><apply id="S4.I1.i1.p1.4.m4.4.5.3.cmml" xref="S4.I1.i1.p1.4.m4.4.5.3"><log id="S4.I1.i1.p1.4.m4.4.5.3.1.cmml" xref="S4.I1.i1.p1.4.m4.4.5.3.1"></log><apply id="S4.I1.i1.p1.4.m4.4.4.cmml" xref="S4.I1.i1.p1.4.m4.4.4"><divide id="S4.I1.i1.p1.4.m4.4.4.5.cmml" xref="S4.I1.i1.p1.4.m4.4.4"></divide><apply id="S4.I1.i1.p1.4.m4.2.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2"><times id="S4.I1.i1.p1.4.m4.2.2.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.3"></times><ci id="S4.I1.i1.p1.4.m4.2.2.2.4.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.4">𝑝</ci><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.1">conditional</csymbol><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2">superscript</csymbol><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.2">𝑜</ci><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.2.3">′</ci></apply><apply id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3"><times id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.1"></times><ci id="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2.cmml" xref="S4.I1.i1.p1.4.m4.2.2.2.2.1.1.3.2">𝐸</ci><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="S4.I1.i1.p1.4.m4.4.4.4.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4"><times id="S4.I1.i1.p1.4.m4.4.4.4.3.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.3"></times><ci id="S4.I1.i1.p1.4.m4.4.4.4.4.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.4">𝑝</ci><apply id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1"><csymbol cd="latexml" id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.1">conditional</csymbol><ci id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.2">𝑜</ci><apply id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3"><times id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.1"></times><ci id="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2.cmml" xref="S4.I1.i1.p1.4.m4.4.4.4.2.1.1.3.2">𝐸</ci><ci id="S4.I1.i1.p1.4.m4.3.3.3.1.cmml" xref="S4.I1.i1.p1.4.m4.3.3.3.1">𝑢</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.4c">y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}</annotation></semantics></math> between the true and hallucinated objects, which quantifies the “degree of hallucination” of <math id="S4.I1.i1.p1.5.m5.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.I1.i1.p1.5.m5.1a"><mi id="S4.I1.i1.p1.5.m5.1.1" xref="S4.I1.i1.p1.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.5.m5.1b"><ci id="S4.I1.i1.p1.5.m5.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.5.m5.1c">G</annotation></semantics></math>. For a hallucinating prediction, we would observe <math id="S4.I1.i1.p1.6.m6.1" class="ltx_Math" alttext="y>0" display="inline"><semantics id="S4.I1.i1.p1.6.m6.1a"><mrow id="S4.I1.i1.p1.6.m6.1.1" xref="S4.I1.i1.p1.6.m6.1.1.cmml"><mi id="S4.I1.i1.p1.6.m6.1.1.2" xref="S4.I1.i1.p1.6.m6.1.1.2.cmml">y</mi><mo id="S4.I1.i1.p1.6.m6.1.1.1" xref="S4.I1.i1.p1.6.m6.1.1.1.cmml">&gt;</mo><mn id="S4.I1.i1.p1.6.m6.1.1.3" xref="S4.I1.i1.p1.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.6.m6.1b"><apply id="S4.I1.i1.p1.6.m6.1.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1"><gt id="S4.I1.i1.p1.6.m6.1.1.1.cmml" xref="S4.I1.i1.p1.6.m6.1.1.1"></gt><ci id="S4.I1.i1.p1.6.m6.1.1.2.cmml" xref="S4.I1.i1.p1.6.m6.1.1.2">𝑦</ci><cn type="integer" id="S4.I1.i1.p1.6.m6.1.1.3.cmml" xref="S4.I1.i1.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.6.m6.1c">y&gt;0</annotation></semantics></math>.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.5" class="ltx_p">In the <span id="S4.I1.i2.p1.5.1" class="ltx_text ltx_font_bold">mitigation run</span>, we follow <cite class="ltx_cite ltx_citemacro_citet">Meng et&nbsp;al. (<a href="#bib.bib31" title="" class="ltx_ref">2022a</a>)</cite> and add a Gaussian noise <math id="S4.I1.i2.p1.1.m1.2" class="ltx_Math" alttext="\epsilon\sim\mathcal{N}(0,1)" display="inline"><semantics id="S4.I1.i2.p1.1.m1.2a"><mrow id="S4.I1.i2.p1.1.m1.2.3" xref="S4.I1.i2.p1.1.m1.2.3.cmml"><mi id="S4.I1.i2.p1.1.m1.2.3.2" xref="S4.I1.i2.p1.1.m1.2.3.2.cmml">ϵ</mi><mo id="S4.I1.i2.p1.1.m1.2.3.1" xref="S4.I1.i2.p1.1.m1.2.3.1.cmml">∼</mo><mrow id="S4.I1.i2.p1.1.m1.2.3.3" xref="S4.I1.i2.p1.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.1.m1.2.3.3.2" xref="S4.I1.i2.p1.1.m1.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.1.m1.2.3.3.1" xref="S4.I1.i2.p1.1.m1.2.3.3.1.cmml">​</mo><mrow id="S4.I1.i2.p1.1.m1.2.3.3.3.2" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="S4.I1.i2.p1.1.m1.2.3.3.3.2.1" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml">(</mo><mn id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">0</mn><mo id="S4.I1.i2.p1.1.m1.2.3.3.3.2.2" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml">,</mo><mn id="S4.I1.i2.p1.1.m1.2.2" xref="S4.I1.i2.p1.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.I1.i2.p1.1.m1.2.3.3.3.2.3" xref="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.2b"><apply id="S4.I1.i2.p1.1.m1.2.3.cmml" xref="S4.I1.i2.p1.1.m1.2.3"><csymbol cd="latexml" id="S4.I1.i2.p1.1.m1.2.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.1">similar-to</csymbol><ci id="S4.I1.i2.p1.1.m1.2.3.2.cmml" xref="S4.I1.i2.p1.1.m1.2.3.2">italic-ϵ</ci><apply id="S4.I1.i2.p1.1.m1.2.3.3.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3"><times id="S4.I1.i2.p1.1.m1.2.3.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3.1"></times><ci id="S4.I1.i2.p1.1.m1.2.3.3.2.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3.2">𝒩</ci><interval closure="open" id="S4.I1.i2.p1.1.m1.2.3.3.3.1.cmml" xref="S4.I1.i2.p1.1.m1.2.3.3.3.2"><cn type="integer" id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">0</cn><cn type="integer" id="S4.I1.i2.p1.1.m1.2.2.cmml" xref="S4.I1.i2.p1.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.2c">\epsilon\sim\mathcal{N}(0,1)</annotation></semantics></math> to the input token embeddings <math id="S4.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="E(u)" display="inline"><semantics id="S4.I1.i2.p1.2.m2.1a"><mrow id="S4.I1.i2.p1.2.m2.1.2" xref="S4.I1.i2.p1.2.m2.1.2.cmml"><mi id="S4.I1.i2.p1.2.m2.1.2.2" xref="S4.I1.i2.p1.2.m2.1.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.2.m2.1.2.1" xref="S4.I1.i2.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S4.I1.i2.p1.2.m2.1.2.3.2" xref="S4.I1.i2.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S4.I1.i2.p1.2.m2.1.2.3.2.1" xref="S4.I1.i2.p1.2.m2.1.2.cmml">(</mo><mi id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">u</mi><mo stretchy="false" id="S4.I1.i2.p1.2.m2.1.2.3.2.2" xref="S4.I1.i2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.2"><times id="S4.I1.i2.p1.2.m2.1.2.1.cmml" xref="S4.I1.i2.p1.2.m2.1.2.1"></times><ci id="S4.I1.i2.p1.2.m2.1.2.2.cmml" xref="S4.I1.i2.p1.2.m2.1.2.2">𝐸</ci><ci id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">E(u)</annotation></semantics></math>, so that when taking the intervened <math id="S4.I1.i2.p1.3.m3.2" class="ltx_Math" alttext="E^{*}(u)=E(u)+\epsilon" display="inline"><semantics id="S4.I1.i2.p1.3.m3.2a"><mrow id="S4.I1.i2.p1.3.m3.2.3" xref="S4.I1.i2.p1.3.m3.2.3.cmml"><mrow id="S4.I1.i2.p1.3.m3.2.3.2" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml"><msup id="S4.I1.i2.p1.3.m3.2.3.2.2" xref="S4.I1.i2.p1.3.m3.2.3.2.2.cmml"><mi id="S4.I1.i2.p1.3.m3.2.3.2.2.2" xref="S4.I1.i2.p1.3.m3.2.3.2.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.3.m3.2.3.2.2.3" xref="S4.I1.i2.p1.3.m3.2.3.2.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.3.m3.2.3.2.1" xref="S4.I1.i2.p1.3.m3.2.3.2.1.cmml">​</mo><mrow id="S4.I1.i2.p1.3.m3.2.3.2.3.2" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml"><mo stretchy="false" id="S4.I1.i2.p1.3.m3.2.3.2.3.2.1" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml">(</mo><mi id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml">u</mi><mo stretchy="false" id="S4.I1.i2.p1.3.m3.2.3.2.3.2.2" xref="S4.I1.i2.p1.3.m3.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.I1.i2.p1.3.m3.2.3.1" xref="S4.I1.i2.p1.3.m3.2.3.1.cmml">=</mo><mrow id="S4.I1.i2.p1.3.m3.2.3.3" xref="S4.I1.i2.p1.3.m3.2.3.3.cmml"><mrow id="S4.I1.i2.p1.3.m3.2.3.3.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml"><mi id="S4.I1.i2.p1.3.m3.2.3.3.2.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.3.m3.2.3.3.2.1" xref="S4.I1.i2.p1.3.m3.2.3.3.2.1.cmml">​</mo><mrow id="S4.I1.i2.p1.3.m3.2.3.3.2.3.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml"><mo stretchy="false" id="S4.I1.i2.p1.3.m3.2.3.3.2.3.2.1" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml">(</mo><mi id="S4.I1.i2.p1.3.m3.2.2" xref="S4.I1.i2.p1.3.m3.2.2.cmml">u</mi><mo stretchy="false" id="S4.I1.i2.p1.3.m3.2.3.3.2.3.2.2" xref="S4.I1.i2.p1.3.m3.2.3.3.2.cmml">)</mo></mrow></mrow><mo id="S4.I1.i2.p1.3.m3.2.3.3.1" xref="S4.I1.i2.p1.3.m3.2.3.3.1.cmml">+</mo><mi id="S4.I1.i2.p1.3.m3.2.3.3.3" xref="S4.I1.i2.p1.3.m3.2.3.3.3.cmml">ϵ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.2b"><apply id="S4.I1.i2.p1.3.m3.2.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3"><eq id="S4.I1.i2.p1.3.m3.2.3.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.1"></eq><apply id="S4.I1.i2.p1.3.m3.2.3.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2"><times id="S4.I1.i2.p1.3.m3.2.3.2.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.1"></times><apply id="S4.I1.i2.p1.3.m3.2.3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.2.3.2.2.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2">superscript</csymbol><ci id="S4.I1.i2.p1.3.m3.2.3.2.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2.2">𝐸</ci><times id="S4.I1.i2.p1.3.m3.2.3.2.2.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3.2.2.3"></times></apply><ci id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">𝑢</ci></apply><apply id="S4.I1.i2.p1.3.m3.2.3.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3"><plus id="S4.I1.i2.p1.3.m3.2.3.3.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.1"></plus><apply id="S4.I1.i2.p1.3.m3.2.3.3.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.2"><times id="S4.I1.i2.p1.3.m3.2.3.3.2.1.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.2.1"></times><ci id="S4.I1.i2.p1.3.m3.2.3.3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.2.2">𝐸</ci><ci id="S4.I1.i2.p1.3.m3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.2.2">𝑢</ci></apply><ci id="S4.I1.i2.p1.3.m3.2.3.3.3.cmml" xref="S4.I1.i2.p1.3.m3.2.3.3.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.2c">E^{*}(u)=E(u)+\epsilon</annotation></semantics></math> as inputs, the log-likelihood ratio between the hallucinated and the factual object would decrease
(i.e., we only take noises with <math id="S4.I1.i2.p1.4.m4.4" class="ltx_Math" alttext="y_{*}=\log\frac{p(o^{\prime}|E^{*}(u))}{p(o|E^{*}(u))}<y" display="inline"><semantics id="S4.I1.i2.p1.4.m4.4a"><mrow id="S4.I1.i2.p1.4.m4.4.5" xref="S4.I1.i2.p1.4.m4.4.5.cmml"><msub id="S4.I1.i2.p1.4.m4.4.5.2" xref="S4.I1.i2.p1.4.m4.4.5.2.cmml"><mi id="S4.I1.i2.p1.4.m4.4.5.2.2" xref="S4.I1.i2.p1.4.m4.4.5.2.2.cmml">y</mi><mo id="S4.I1.i2.p1.4.m4.4.5.2.3" xref="S4.I1.i2.p1.4.m4.4.5.2.3.cmml">∗</mo></msub><mo id="S4.I1.i2.p1.4.m4.4.5.3" xref="S4.I1.i2.p1.4.m4.4.5.3.cmml">=</mo><mrow id="S4.I1.i2.p1.4.m4.4.5.4" xref="S4.I1.i2.p1.4.m4.4.5.4.cmml"><mi id="S4.I1.i2.p1.4.m4.4.5.4.1" xref="S4.I1.i2.p1.4.m4.4.5.4.1.cmml">log</mi><mo lspace="0.167em" id="S4.I1.i2.p1.4.m4.4.5.4a" xref="S4.I1.i2.p1.4.m4.4.5.4.cmml">⁡</mo><mfrac id="S4.I1.i2.p1.4.m4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.cmml"><mrow id="S4.I1.i2.p1.4.m4.2.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.2.4" xref="S4.I1.i2.p1.4.m4.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.4.m4.2.2.2.3" xref="S4.I1.i2.p1.4.m4.2.2.2.3.cmml">​</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml"><msup id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2.cmml">o</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml"><msup id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.cmml"><mi id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1.cmml">​</mo><mrow id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.3.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml"><mo stretchy="false" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.3.2.1" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml">(</mo><mi id="S4.I1.i2.p1.4.m4.1.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.1.cmml">u</mi><mo stretchy="false" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.3.2.2" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.3" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.I1.i2.p1.4.m4.4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.4.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.4.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.4.m4.4.4.4.3" xref="S4.I1.i2.p1.4.m4.4.4.4.3.cmml">​</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml"><mo stretchy="false" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2.cmml">o</mi><mo fence="false" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1.cmml">|</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml"><msup id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.cmml"><mi id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2.cmml">E</mi><mo id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1.cmml">​</mo><mrow id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.3.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml"><mo stretchy="false" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.3.2.1" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml">(</mo><mi id="S4.I1.i2.p1.4.m4.3.3.3.1" xref="S4.I1.i2.p1.4.m4.3.3.3.1.cmml">u</mi><mo stretchy="false" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.3.2.2" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.3" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S4.I1.i2.p1.4.m4.4.5.5" xref="S4.I1.i2.p1.4.m4.4.5.5.cmml">&lt;</mo><mi id="S4.I1.i2.p1.4.m4.4.5.6" xref="S4.I1.i2.p1.4.m4.4.5.6.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.4b"><apply id="S4.I1.i2.p1.4.m4.4.5.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><and id="S4.I1.i2.p1.4.m4.4.5a.cmml" xref="S4.I1.i2.p1.4.m4.4.5"></and><apply id="S4.I1.i2.p1.4.m4.4.5b.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><eq id="S4.I1.i2.p1.4.m4.4.5.3.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3"></eq><apply id="S4.I1.i2.p1.4.m4.4.5.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.4.5.2.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2">subscript</csymbol><ci id="S4.I1.i2.p1.4.m4.4.5.2.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2.2">𝑦</ci><times id="S4.I1.i2.p1.4.m4.4.5.2.3.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2.3"></times></apply><apply id="S4.I1.i2.p1.4.m4.4.5.4.cmml" xref="S4.I1.i2.p1.4.m4.4.5.4"><log id="S4.I1.i2.p1.4.m4.4.5.4.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.4.1"></log><apply id="S4.I1.i2.p1.4.m4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4"><divide id="S4.I1.i2.p1.4.m4.4.4.5.cmml" xref="S4.I1.i2.p1.4.m4.4.4"></divide><apply id="S4.I1.i2.p1.4.m4.2.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2"><times id="S4.I1.i2.p1.4.m4.2.2.2.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.3"></times><ci id="S4.I1.i2.p1.4.m4.2.2.2.4.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.4">𝑝</ci><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.1">conditional</csymbol><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.2">𝑜</ci><ci id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.2.3">′</ci></apply><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3"><times id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.1"></times><apply id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.2">𝐸</ci><times id="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.4.m4.2.2.2.2.1.1.3.2.3"></times></apply><ci id="S4.I1.i2.p1.4.m4.1.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="S4.I1.i2.p1.4.m4.4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4"><times id="S4.I1.i2.p1.4.m4.4.4.4.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.3"></times><ci id="S4.I1.i2.p1.4.m4.4.4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.4">𝑝</ci><apply id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1"><csymbol cd="latexml" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.1">conditional</csymbol><ci id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.2">𝑜</ci><apply id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3"><times id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.1"></times><apply id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.2">𝐸</ci><times id="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.4.m4.4.4.4.2.1.1.3.2.3"></times></apply><ci id="S4.I1.i2.p1.4.m4.3.3.3.1.cmml" xref="S4.I1.i2.p1.4.m4.3.3.3.1">𝑢</ci></apply></apply></apply></apply></apply></apply><apply id="S4.I1.i2.p1.4.m4.4.5c.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><lt id="S4.I1.i2.p1.4.m4.4.5.5.cmml" xref="S4.I1.i2.p1.4.m4.4.5.5"></lt><share href="#S4.I1.i2.p1.4.m4.4.5.4.cmml" id="S4.I1.i2.p1.4.m4.4.5d.cmml" xref="S4.I1.i2.p1.4.m4.4.5"></share><ci id="S4.I1.i2.p1.4.m4.4.5.6.cmml" xref="S4.I1.i2.p1.4.m4.4.5.6">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.4c">y_{*}=\log\frac{p(o^{\prime}|E^{*}(u))}{p(o|E^{*}(u))}&lt;y</annotation></semantics></math>, indicating that the model becomes more “truthful” after noise injections). We again extract all intermediate hidden representations, denoted as <math id="S4.I1.i2.p1.5.m5.1" class="ltx_Math" alttext="Z^{*}" display="inline"><semantics id="S4.I1.i2.p1.5.m5.1a"><msup id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.2" xref="S4.I1.i2.p1.5.m5.1.1.2.cmml">Z</mi><mo id="S4.I1.i2.p1.5.m5.1.1.3" xref="S4.I1.i2.p1.5.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><apply id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.5.m5.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">superscript</csymbol><ci id="S4.I1.i2.p1.5.m5.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.2">𝑍</ci><times id="S4.I1.i2.p1.5.m5.1.1.3.cmml" xref="S4.I1.i2.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">Z^{*}</annotation></semantics></math>.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.7" class="ltx_p">In the <span id="S4.I1.i3.p1.7.1" class="ltx_text ltx_font_bold">mitigation-with-hallucination-state run</span>, we run <math id="S4.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.I1.i3.p1.1.m1.1a"><mi id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><ci id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">G</annotation></semantics></math> on <math id="S4.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.I1.i3.p1.2.m2.1a"><mi id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><ci id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">u</annotation></semantics></math> with perturbed input embeddings <math id="S4.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="E^{*}(u)" display="inline"><semantics id="S4.I1.i3.p1.3.m3.1a"><mrow id="S4.I1.i3.p1.3.m3.1.2" xref="S4.I1.i3.p1.3.m3.1.2.cmml"><msup id="S4.I1.i3.p1.3.m3.1.2.2" xref="S4.I1.i3.p1.3.m3.1.2.2.cmml"><mi id="S4.I1.i3.p1.3.m3.1.2.2.2" xref="S4.I1.i3.p1.3.m3.1.2.2.2.cmml">E</mi><mo id="S4.I1.i3.p1.3.m3.1.2.2.3" xref="S4.I1.i3.p1.3.m3.1.2.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S4.I1.i3.p1.3.m3.1.2.1" xref="S4.I1.i3.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S4.I1.i3.p1.3.m3.1.2.3.2" xref="S4.I1.i3.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S4.I1.i3.p1.3.m3.1.2.3.2.1" xref="S4.I1.i3.p1.3.m3.1.2.cmml">(</mo><mi id="S4.I1.i3.p1.3.m3.1.1" xref="S4.I1.i3.p1.3.m3.1.1.cmml">u</mi><mo stretchy="false" id="S4.I1.i3.p1.3.m3.1.2.3.2.2" xref="S4.I1.i3.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m3.1b"><apply id="S4.I1.i3.p1.3.m3.1.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2"><times id="S4.I1.i3.p1.3.m3.1.2.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.1"></times><apply id="S4.I1.i3.p1.3.m3.1.2.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.3.m3.1.2.2.1.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2">superscript</csymbol><ci id="S4.I1.i3.p1.3.m3.1.2.2.2.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.2">𝐸</ci><times id="S4.I1.i3.p1.3.m3.1.2.2.3.cmml" xref="S4.I1.i3.p1.3.m3.1.2.2.3"></times></apply><ci id="S4.I1.i3.p1.3.m3.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m3.1c">E^{*}(u)</annotation></semantics></math> as in the mitigation run, and hook <math id="S4.I1.i3.p1.4.m4.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.I1.i3.p1.4.m4.1a"><mi id="S4.I1.i3.p1.4.m4.1.1" xref="S4.I1.i3.p1.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.4.m4.1b"><ci id="S4.I1.i3.p1.4.m4.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.4.m4.1c">G</annotation></semantics></math> by forcing a particular hidden representation <math id="S4.I1.i3.p1.5.m5.1" class="ltx_Math" alttext="z^{*}\in Z^{*}" display="inline"><semantics id="S4.I1.i3.p1.5.m5.1a"><mrow id="S4.I1.i3.p1.5.m5.1.1" xref="S4.I1.i3.p1.5.m5.1.1.cmml"><msup id="S4.I1.i3.p1.5.m5.1.1.2" xref="S4.I1.i3.p1.5.m5.1.1.2.cmml"><mi id="S4.I1.i3.p1.5.m5.1.1.2.2" xref="S4.I1.i3.p1.5.m5.1.1.2.2.cmml">z</mi><mo id="S4.I1.i3.p1.5.m5.1.1.2.3" xref="S4.I1.i3.p1.5.m5.1.1.2.3.cmml">∗</mo></msup><mo id="S4.I1.i3.p1.5.m5.1.1.1" xref="S4.I1.i3.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.I1.i3.p1.5.m5.1.1.3" xref="S4.I1.i3.p1.5.m5.1.1.3.cmml"><mi id="S4.I1.i3.p1.5.m5.1.1.3.2" xref="S4.I1.i3.p1.5.m5.1.1.3.2.cmml">Z</mi><mo id="S4.I1.i3.p1.5.m5.1.1.3.3" xref="S4.I1.i3.p1.5.m5.1.1.3.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.5.m5.1b"><apply id="S4.I1.i3.p1.5.m5.1.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1"><in id="S4.I1.i3.p1.5.m5.1.1.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1.1"></in><apply id="S4.I1.i3.p1.5.m5.1.1.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.5.m5.1.1.2.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2">superscript</csymbol><ci id="S4.I1.i3.p1.5.m5.1.1.2.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2.2">𝑧</ci><times id="S4.I1.i3.p1.5.m5.1.1.2.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.2.3"></times></apply><apply id="S4.I1.i3.p1.5.m5.1.1.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.5.m5.1.1.3.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.I1.i3.p1.5.m5.1.1.3.2.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3.2">𝑍</ci><times id="S4.I1.i3.p1.5.m5.1.1.3.3.cmml" xref="S4.I1.i3.p1.5.m5.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.5.m5.1c">z^{*}\in Z^{*}</annotation></semantics></math> to be the hidden representation <math id="S4.I1.i3.p1.6.m6.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.I1.i3.p1.6.m6.1a"><mi id="S4.I1.i3.p1.6.m6.1.1" xref="S4.I1.i3.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.6.m6.1b"><ci id="S4.I1.i3.p1.6.m6.1.1.cmml" xref="S4.I1.i3.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.6.m6.1c">z</annotation></semantics></math> during the hallucination run. We then compute the log likelihood ratio <math id="S4.I1.i3.p1.7.m7.8" class="ltx_Math" alttext="y_{E^{*},z}=\log\frac{p(o^{\prime}|E^{*}(u),z)}{p(o|E^{*}(u),z)}" display="inline"><semantics id="S4.I1.i3.p1.7.m7.8a"><mrow id="S4.I1.i3.p1.7.m7.8.9" xref="S4.I1.i3.p1.7.m7.8.9.cmml"><msub id="S4.I1.i3.p1.7.m7.8.9.2" xref="S4.I1.i3.p1.7.m7.8.9.2.cmml"><mi id="S4.I1.i3.p1.7.m7.8.9.2.2" xref="S4.I1.i3.p1.7.m7.8.9.2.2.cmml">y</mi><mrow id="S4.I1.i3.p1.7.m7.2.2.2.2" xref="S4.I1.i3.p1.7.m7.2.2.2.3.cmml"><msup id="S4.I1.i3.p1.7.m7.2.2.2.2.1" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.cmml"><mi id="S4.I1.i3.p1.7.m7.2.2.2.2.1.2" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.2.cmml">E</mi><mo id="S4.I1.i3.p1.7.m7.2.2.2.2.1.3" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.3.cmml">∗</mo></msup><mo id="S4.I1.i3.p1.7.m7.2.2.2.2.2" xref="S4.I1.i3.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="S4.I1.i3.p1.7.m7.1.1.1.1" xref="S4.I1.i3.p1.7.m7.1.1.1.1.cmml">z</mi></mrow></msub><mo id="S4.I1.i3.p1.7.m7.8.9.1" xref="S4.I1.i3.p1.7.m7.8.9.1.cmml">=</mo><mrow id="S4.I1.i3.p1.7.m7.8.9.3" xref="S4.I1.i3.p1.7.m7.8.9.3.cmml"><mi id="S4.I1.i3.p1.7.m7.8.9.3.1" xref="S4.I1.i3.p1.7.m7.8.9.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.I1.i3.p1.7.m7.8.9.3a" xref="S4.I1.i3.p1.7.m7.8.9.3.cmml">⁡</mo><mfrac id="S4.I1.i3.p1.7.m7.8.8" xref="S4.I1.i3.p1.7.m7.8.8.cmml"><mrow id="S4.I1.i3.p1.7.m7.5.5.3" xref="S4.I1.i3.p1.7.m7.5.5.3.cmml"><mi id="S4.I1.i3.p1.7.m7.5.5.3.5" xref="S4.I1.i3.p1.7.m7.5.5.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.I1.i3.p1.7.m7.5.5.3.4" xref="S4.I1.i3.p1.7.m7.5.5.3.4.cmml">​</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml"><mo stretchy="false" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml">(</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml"><msup id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.cmml"><mi id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2.cmml">o</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3.cmml">′</mo></msup><mo fence="false" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2.cmml">|</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.2.cmml"><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml"><msup id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.cmml"><mi id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2.cmml">E</mi><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.3.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.3.2.1" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml">(</mo><mi id="S4.I1.i3.p1.7.m7.3.3.1.1" xref="S4.I1.i3.p1.7.m7.3.3.1.1.cmml">u</mi><mo stretchy="false" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.3.2.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.2.cmml">,</mo><mi id="S4.I1.i3.p1.7.m7.4.4.2.2" xref="S4.I1.i3.p1.7.m7.4.4.2.2.cmml">z</mi></mrow></mrow><mo stretchy="false" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.3" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.I1.i3.p1.7.m7.8.8.6" xref="S4.I1.i3.p1.7.m7.8.8.6.cmml"><mi id="S4.I1.i3.p1.7.m7.8.8.6.5" xref="S4.I1.i3.p1.7.m7.8.8.6.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.I1.i3.p1.7.m7.8.8.6.4" xref="S4.I1.i3.p1.7.m7.8.8.6.4.cmml">​</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml"><mo stretchy="false" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml">(</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml"><mi id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3.cmml">o</mi><mo fence="false" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2.cmml">|</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.2.cmml"><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml"><msup id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.cmml"><mi id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2.cmml">E</mi><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.3.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.3.2.1" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml">(</mo><mi id="S4.I1.i3.p1.7.m7.6.6.4.1" xref="S4.I1.i3.p1.7.m7.6.6.4.1.cmml">u</mi><mo stretchy="false" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.3.2.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.2" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.2.cmml">,</mo><mi id="S4.I1.i3.p1.7.m7.7.7.5.2" xref="S4.I1.i3.p1.7.m7.7.7.5.2.cmml">z</mi></mrow></mrow><mo stretchy="false" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.3" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.7.m7.8b"><apply id="S4.I1.i3.p1.7.m7.8.9.cmml" xref="S4.I1.i3.p1.7.m7.8.9"><eq id="S4.I1.i3.p1.7.m7.8.9.1.cmml" xref="S4.I1.i3.p1.7.m7.8.9.1"></eq><apply id="S4.I1.i3.p1.7.m7.8.9.2.cmml" xref="S4.I1.i3.p1.7.m7.8.9.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.8.9.2.1.cmml" xref="S4.I1.i3.p1.7.m7.8.9.2">subscript</csymbol><ci id="S4.I1.i3.p1.7.m7.8.9.2.2.cmml" xref="S4.I1.i3.p1.7.m7.8.9.2.2">𝑦</ci><list id="S4.I1.i3.p1.7.m7.2.2.2.3.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2"><apply id="S4.I1.i3.p1.7.m7.2.2.2.2.1.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.2.2.2.2.1.1.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.2.2.2.2.1.2.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.2">𝐸</ci><times id="S4.I1.i3.p1.7.m7.2.2.2.2.1.3.cmml" xref="S4.I1.i3.p1.7.m7.2.2.2.2.1.3"></times></apply><ci id="S4.I1.i3.p1.7.m7.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.1.1.1.1">𝑧</ci></list></apply><apply id="S4.I1.i3.p1.7.m7.8.9.3.cmml" xref="S4.I1.i3.p1.7.m7.8.9.3"><log id="S4.I1.i3.p1.7.m7.8.9.3.1.cmml" xref="S4.I1.i3.p1.7.m7.8.9.3.1"></log><apply id="S4.I1.i3.p1.7.m7.8.8.cmml" xref="S4.I1.i3.p1.7.m7.8.8"><divide id="S4.I1.i3.p1.7.m7.8.8.7.cmml" xref="S4.I1.i3.p1.7.m7.8.8"></divide><apply id="S4.I1.i3.p1.7.m7.5.5.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3"><times id="S4.I1.i3.p1.7.m7.5.5.3.4.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.4"></times><ci id="S4.I1.i3.p1.7.m7.5.5.3.5.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.5">𝑝</ci><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1"><csymbol cd="latexml" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.2">conditional</csymbol><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.2">𝑜</ci><ci id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.3.3">′</ci></apply><list id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1"><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1"><times id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.1"></times><apply id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.1.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.2">𝐸</ci><times id="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3.cmml" xref="S4.I1.i3.p1.7.m7.5.5.3.3.1.1.1.1.1.2.3"></times></apply><ci id="S4.I1.i3.p1.7.m7.3.3.1.1.cmml" xref="S4.I1.i3.p1.7.m7.3.3.1.1">𝑢</ci></apply><ci id="S4.I1.i3.p1.7.m7.4.4.2.2.cmml" xref="S4.I1.i3.p1.7.m7.4.4.2.2">𝑧</ci></list></apply></apply><apply id="S4.I1.i3.p1.7.m7.8.8.6.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6"><times id="S4.I1.i3.p1.7.m7.8.8.6.4.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.4"></times><ci id="S4.I1.i3.p1.7.m7.8.8.6.5.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.5">𝑝</ci><apply id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1"><csymbol cd="latexml" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.2">conditional</csymbol><ci id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.3">𝑜</ci><list id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1"><apply id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1"><times id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.1"></times><apply id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.1.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2">superscript</csymbol><ci id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.2">𝐸</ci><times id="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3.cmml" xref="S4.I1.i3.p1.7.m7.8.8.6.3.1.1.1.1.1.2.3"></times></apply><ci id="S4.I1.i3.p1.7.m7.6.6.4.1.cmml" xref="S4.I1.i3.p1.7.m7.6.6.4.1">𝑢</ci></apply><ci id="S4.I1.i3.p1.7.m7.7.7.5.2.cmml" xref="S4.I1.i3.p1.7.m7.7.7.5.2">𝑧</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.7.m7.8c">y_{E^{*},z}=\log\frac{p(o^{\prime}|E^{*}(u),z)}{p(o|E^{*}(u),z)}</annotation></semantics></math> to see how it changes compared to step 2.</p>
</div>
</li>
</ol>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2403.18167/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="90" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S4.F2.4.1" class="ltx_text ltx_font_bold">Average Indirect Effect (AIE)</span> of hidden representations produced by individual model components to non-factual hallucinations over ParaRel queries that are incorrectly answered by Llama-2-7b-chat. The relative indirect effect metric <math id="S4.F2.2.m1.2" class="ltx_Math" alttext="\Delta\overline{\text{IE}}(y,u)" display="inline"><semantics id="S4.F2.2.m1.2b"><mrow id="S4.F2.2.m1.2.3" xref="S4.F2.2.m1.2.3.cmml"><mi mathvariant="normal" id="S4.F2.2.m1.2.3.2" xref="S4.F2.2.m1.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.F2.2.m1.2.3.1" xref="S4.F2.2.m1.2.3.1.cmml">​</mo><mover accent="true" id="S4.F2.2.m1.2.3.3" xref="S4.F2.2.m1.2.3.3.cmml"><mtext id="S4.F2.2.m1.2.3.3.2" xref="S4.F2.2.m1.2.3.3.2a.cmml">IE</mtext><mo id="S4.F2.2.m1.2.3.3.1" xref="S4.F2.2.m1.2.3.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.F2.2.m1.2.3.1b" xref="S4.F2.2.m1.2.3.1.cmml">​</mo><mrow id="S4.F2.2.m1.2.3.4.2" xref="S4.F2.2.m1.2.3.4.1.cmml"><mo stretchy="false" id="S4.F2.2.m1.2.3.4.2.1" xref="S4.F2.2.m1.2.3.4.1.cmml">(</mo><mi id="S4.F2.2.m1.1.1" xref="S4.F2.2.m1.1.1.cmml">y</mi><mo id="S4.F2.2.m1.2.3.4.2.2" xref="S4.F2.2.m1.2.3.4.1.cmml">,</mo><mi id="S4.F2.2.m1.2.2" xref="S4.F2.2.m1.2.2.cmml">u</mi><mo stretchy="false" id="S4.F2.2.m1.2.3.4.2.3" xref="S4.F2.2.m1.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.2.m1.2c"><apply id="S4.F2.2.m1.2.3.cmml" xref="S4.F2.2.m1.2.3"><times id="S4.F2.2.m1.2.3.1.cmml" xref="S4.F2.2.m1.2.3.1"></times><ci id="S4.F2.2.m1.2.3.2.cmml" xref="S4.F2.2.m1.2.3.2">Δ</ci><apply id="S4.F2.2.m1.2.3.3.cmml" xref="S4.F2.2.m1.2.3.3"><ci id="S4.F2.2.m1.2.3.3.1.cmml" xref="S4.F2.2.m1.2.3.3.1">¯</ci><ci id="S4.F2.2.m1.2.3.3.2a.cmml" xref="S4.F2.2.m1.2.3.3.2"><mtext id="S4.F2.2.m1.2.3.3.2.cmml" xref="S4.F2.2.m1.2.3.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.F2.2.m1.2.3.4.1.cmml" xref="S4.F2.2.m1.2.3.4.2"><ci id="S4.F2.2.m1.1.1.cmml" xref="S4.F2.2.m1.1.1">𝑦</ci><ci id="S4.F2.2.m1.2.2.cmml" xref="S4.F2.2.m1.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.2.m1.2d">\Delta\overline{\text{IE}}(y,u)</annotation></semantics></math> of distinguishing early-site and late-site hallucinations is defined as the difference between the mean AIE of 1) the hidden representations of the last relation token by upper layer attentions/MLPs (blue dashed boxes), and 2) the hidden representations of the first subject token by lower layer attentions/MLPs (red dashed boxes).
</figcaption>
</figure>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.18167/assets/x3.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="461" height="480" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Early-site hallucinations (<math id="S4.F3.sf1.2.m1.2" class="ltx_Math" alttext="\Delta\overline{\text{IE}}(y,u)<0" display="inline"><semantics id="S4.F3.sf1.2.m1.2b"><mrow id="S4.F3.sf1.2.m1.2.3" xref="S4.F3.sf1.2.m1.2.3.cmml"><mrow id="S4.F3.sf1.2.m1.2.3.2" xref="S4.F3.sf1.2.m1.2.3.2.cmml"><mi mathvariant="normal" id="S4.F3.sf1.2.m1.2.3.2.2" xref="S4.F3.sf1.2.m1.2.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.F3.sf1.2.m1.2.3.2.1" xref="S4.F3.sf1.2.m1.2.3.2.1.cmml">​</mo><mover accent="true" id="S4.F3.sf1.2.m1.2.3.2.3" xref="S4.F3.sf1.2.m1.2.3.2.3.cmml"><mtext id="S4.F3.sf1.2.m1.2.3.2.3.2" xref="S4.F3.sf1.2.m1.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.F3.sf1.2.m1.2.3.2.3.1" xref="S4.F3.sf1.2.m1.2.3.2.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.F3.sf1.2.m1.2.3.2.1b" xref="S4.F3.sf1.2.m1.2.3.2.1.cmml">​</mo><mrow id="S4.F3.sf1.2.m1.2.3.2.4.2" xref="S4.F3.sf1.2.m1.2.3.2.4.1.cmml"><mo stretchy="false" id="S4.F3.sf1.2.m1.2.3.2.4.2.1" xref="S4.F3.sf1.2.m1.2.3.2.4.1.cmml">(</mo><mi id="S4.F3.sf1.2.m1.1.1" xref="S4.F3.sf1.2.m1.1.1.cmml">y</mi><mo id="S4.F3.sf1.2.m1.2.3.2.4.2.2" xref="S4.F3.sf1.2.m1.2.3.2.4.1.cmml">,</mo><mi id="S4.F3.sf1.2.m1.2.2" xref="S4.F3.sf1.2.m1.2.2.cmml">u</mi><mo stretchy="false" id="S4.F3.sf1.2.m1.2.3.2.4.2.3" xref="S4.F3.sf1.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.F3.sf1.2.m1.2.3.1" xref="S4.F3.sf1.2.m1.2.3.1.cmml">&lt;</mo><mn id="S4.F3.sf1.2.m1.2.3.3" xref="S4.F3.sf1.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.sf1.2.m1.2c"><apply id="S4.F3.sf1.2.m1.2.3.cmml" xref="S4.F3.sf1.2.m1.2.3"><lt id="S4.F3.sf1.2.m1.2.3.1.cmml" xref="S4.F3.sf1.2.m1.2.3.1"></lt><apply id="S4.F3.sf1.2.m1.2.3.2.cmml" xref="S4.F3.sf1.2.m1.2.3.2"><times id="S4.F3.sf1.2.m1.2.3.2.1.cmml" xref="S4.F3.sf1.2.m1.2.3.2.1"></times><ci id="S4.F3.sf1.2.m1.2.3.2.2.cmml" xref="S4.F3.sf1.2.m1.2.3.2.2">Δ</ci><apply id="S4.F3.sf1.2.m1.2.3.2.3.cmml" xref="S4.F3.sf1.2.m1.2.3.2.3"><ci id="S4.F3.sf1.2.m1.2.3.2.3.1.cmml" xref="S4.F3.sf1.2.m1.2.3.2.3.1">¯</ci><ci id="S4.F3.sf1.2.m1.2.3.2.3.2a.cmml" xref="S4.F3.sf1.2.m1.2.3.2.3.2"><mtext id="S4.F3.sf1.2.m1.2.3.2.3.2.cmml" xref="S4.F3.sf1.2.m1.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.F3.sf1.2.m1.2.3.2.4.1.cmml" xref="S4.F3.sf1.2.m1.2.3.2.4.2"><ci id="S4.F3.sf1.2.m1.1.1.cmml" xref="S4.F3.sf1.2.m1.1.1">𝑦</ci><ci id="S4.F3.sf1.2.m1.2.2.cmml" xref="S4.F3.sf1.2.m1.2.2">𝑢</ci></interval></apply><cn type="integer" id="S4.F3.sf1.2.m1.2.3.3.cmml" xref="S4.F3.sf1.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.sf1.2.m1.2d">\Delta\overline{\text{IE}}(y,u)&lt;0</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.18167/assets/x4.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="461" height="480" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Late-site hallucinations (<math id="S4.F3.sf2.2.m1.2" class="ltx_Math" alttext="\Delta\overline{\text{IE}}(y,u)\geq 0" display="inline"><semantics id="S4.F3.sf2.2.m1.2b"><mrow id="S4.F3.sf2.2.m1.2.3" xref="S4.F3.sf2.2.m1.2.3.cmml"><mrow id="S4.F3.sf2.2.m1.2.3.2" xref="S4.F3.sf2.2.m1.2.3.2.cmml"><mi mathvariant="normal" id="S4.F3.sf2.2.m1.2.3.2.2" xref="S4.F3.sf2.2.m1.2.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.F3.sf2.2.m1.2.3.2.1" xref="S4.F3.sf2.2.m1.2.3.2.1.cmml">​</mo><mover accent="true" id="S4.F3.sf2.2.m1.2.3.2.3" xref="S4.F3.sf2.2.m1.2.3.2.3.cmml"><mtext id="S4.F3.sf2.2.m1.2.3.2.3.2" xref="S4.F3.sf2.2.m1.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.F3.sf2.2.m1.2.3.2.3.1" xref="S4.F3.sf2.2.m1.2.3.2.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.F3.sf2.2.m1.2.3.2.1b" xref="S4.F3.sf2.2.m1.2.3.2.1.cmml">​</mo><mrow id="S4.F3.sf2.2.m1.2.3.2.4.2" xref="S4.F3.sf2.2.m1.2.3.2.4.1.cmml"><mo stretchy="false" id="S4.F3.sf2.2.m1.2.3.2.4.2.1" xref="S4.F3.sf2.2.m1.2.3.2.4.1.cmml">(</mo><mi id="S4.F3.sf2.2.m1.1.1" xref="S4.F3.sf2.2.m1.1.1.cmml">y</mi><mo id="S4.F3.sf2.2.m1.2.3.2.4.2.2" xref="S4.F3.sf2.2.m1.2.3.2.4.1.cmml">,</mo><mi id="S4.F3.sf2.2.m1.2.2" xref="S4.F3.sf2.2.m1.2.2.cmml">u</mi><mo stretchy="false" id="S4.F3.sf2.2.m1.2.3.2.4.2.3" xref="S4.F3.sf2.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.F3.sf2.2.m1.2.3.1" xref="S4.F3.sf2.2.m1.2.3.1.cmml">≥</mo><mn id="S4.F3.sf2.2.m1.2.3.3" xref="S4.F3.sf2.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.sf2.2.m1.2c"><apply id="S4.F3.sf2.2.m1.2.3.cmml" xref="S4.F3.sf2.2.m1.2.3"><geq id="S4.F3.sf2.2.m1.2.3.1.cmml" xref="S4.F3.sf2.2.m1.2.3.1"></geq><apply id="S4.F3.sf2.2.m1.2.3.2.cmml" xref="S4.F3.sf2.2.m1.2.3.2"><times id="S4.F3.sf2.2.m1.2.3.2.1.cmml" xref="S4.F3.sf2.2.m1.2.3.2.1"></times><ci id="S4.F3.sf2.2.m1.2.3.2.2.cmml" xref="S4.F3.sf2.2.m1.2.3.2.2">Δ</ci><apply id="S4.F3.sf2.2.m1.2.3.2.3.cmml" xref="S4.F3.sf2.2.m1.2.3.2.3"><ci id="S4.F3.sf2.2.m1.2.3.2.3.1.cmml" xref="S4.F3.sf2.2.m1.2.3.2.3.1">¯</ci><ci id="S4.F3.sf2.2.m1.2.3.2.3.2a.cmml" xref="S4.F3.sf2.2.m1.2.3.2.3.2"><mtext id="S4.F3.sf2.2.m1.2.3.2.3.2.cmml" xref="S4.F3.sf2.2.m1.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.F3.sf2.2.m1.2.3.2.4.1.cmml" xref="S4.F3.sf2.2.m1.2.3.2.4.2"><ci id="S4.F3.sf2.2.m1.1.1.cmml" xref="S4.F3.sf2.2.m1.1.1">𝑦</ci><ci id="S4.F3.sf2.2.m1.2.2.cmml" xref="S4.F3.sf2.2.m1.2.2">𝑢</ci></interval></apply><cn type="integer" id="S4.F3.sf2.2.m1.2.3.3.cmml" xref="S4.F3.sf2.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.sf2.2.m1.2d">\Delta\overline{\text{IE}}(y,u)\geq 0</annotation></semantics></math>)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.2.1" class="ltx_text ltx_font_bold">Average Indirect Effect (AIE)</span> of individual model components for (a) early-site (left column) and (b) late-site (right column) non-factual hallucinations. </figcaption>
</figure>
<div id="S4.SS1.SSS0.Px1.p4" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p4.3" class="ltx_p">Following previous work in causal mediation analysis <cite class="ltx_cite ltx_citemacro_cite">Vig et&nbsp;al. (<a href="#bib.bib50" title="" class="ltx_ref">2020</a>); Finlayson et&nbsp;al. (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>); Meng et&nbsp;al. (<a href="#bib.bib31" title="" class="ltx_ref">2022a</a>)</cite>, we define the <span id="S4.SS1.SSS0.Px1.p4.3.1" class="ltx_text ltx_font_bold">causal indirect effect</span> <math id="S4.SS1.SSS0.Px1.p4.1.m1.6" class="ltx_Math" alttext="\text{IE}(z;y,u,\epsilon)=y_{E^{*},z}-y_{*}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p4.1.m1.6a"><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.cmml"><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.cmml"><mtext id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2a.cmml">IE</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1.cmml">​</mo><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.3.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.3.3.cmml">z</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">;</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.4.4" xref="S4.SS1.SSS0.Px1.p4.1.m1.4.4.cmml">y</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.5.5" xref="S4.SS1.SSS0.Px1.p4.1.m1.5.5.cmml">u</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.4" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.6.6" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.6.cmml">ϵ</mi><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2.5" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1.cmml">=</mo><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.cmml"><msub id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2.cmml">y</mi><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml"><msup id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2.cmml">E</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3.cmml">∗</mo></msup><mo id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1.cmml">z</mi></mrow></msub><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1.cmml">−</mo><msub id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2.cmml">y</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3.cmml">∗</mo></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.1.m1.6b"><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7"><eq id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.1"></eq><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2"><times id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.1"></times><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2a.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2"><mtext id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.2">IE</mtext></ci><list id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.2.3.2"><ci id="S4.SS1.SSS0.Px1.p4.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.3.3">𝑧</ci><ci id="S4.SS1.SSS0.Px1.p4.1.m1.4.4.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.4.4">𝑦</ci><ci id="S4.SS1.SSS0.Px1.p4.1.m1.5.5.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.5.5">𝑢</ci><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.6.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.6">italic-ϵ</ci></list></apply><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3"><minus id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.1"></minus><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.2.2">𝑦</ci><list id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2"><apply id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.2">𝐸</ci><times id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.1.3"></times></apply><ci id="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1">𝑧</ci></list></apply><apply id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.2">𝑦</ci><times id="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.6.7.3.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.1.m1.6c">\text{IE}(z;y,u,\epsilon)=y_{E^{*},z}-y_{*}</annotation></semantics></math> of an intermediate hidden representation <math id="S4.SS1.SSS0.Px1.p4.2.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS1.SSS0.Px1.p4.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p4.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p4.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.2.m2.1c">z</annotation></semantics></math> as the decrease in the degree of hallucination after mitigating a single hidden state. Averaging over a set of factual queries and a sample of noises for each query, we obtain the average indirect effect (AIE) for each <math id="S4.SS1.SSS0.Px1.p4.3.m3.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS1.SSS0.Px1.p4.3.m3.1a"><mi id="S4.SS1.SSS0.Px1.p4.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p4.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.3.m3.1b"><ci id="S4.SS1.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.3.m3.1c">z</annotation></semantics></math> and its corresponding model component.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Experiments.</h4>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.7" class="ltx_p">We collect a set of factual knowledge queries from the ParaRel <cite class="ltx_cite ltx_citemacro_cite">Elazar et&nbsp;al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite> dataset of cloze-style factual knowledge queries. Each example in ParaRel contains a knowledge tuple <math id="S4.SS1.SSS0.Px2.p1.1.m1.3" class="ltx_Math" alttext="t_{c}=(s,r,o_{c})" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.3a"><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.cmml"><msub id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2.cmml">t</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.cmml">c</mi></msub><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p1.1.m1.2.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2.cmml">r</mi><mo id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.4" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">,</mo><msub id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.5" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.3b"><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3"><eq id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.2"></eq><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.2">𝑡</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.3.3">𝑐</ci></apply><vector id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1"><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.2.2">𝑟</ci><apply id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.3.3.1.1.1.3">𝑐</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.3c">t_{c}=(s,r,o_{c})</annotation></semantics></math> and a prompt generated from hand-curated templates. We evaluated three widely used pretrained LMs with different layouts: 1) Llama-2-7B-chat (32 layers, 7B parameters, fine-tuned on instruction following) <cite class="ltx_cite ltx_citemacro_cite">Touvron et&nbsp;al. (<a href="#bib.bib46" title="" class="ltx_ref">2023</a>)</cite>, 2) GPT-J (28 layers, 6B parameters) <cite class="ltx_cite ltx_citemacro_cite">Wang and Komatsuzaki (<a href="#bib.bib52" title="" class="ltx_ref">2021</a>)</cite>, and 3) GPT-2-XL (48 layers, 1.5B parameters) <cite class="ltx_cite ltx_citemacro_cite">Radford et&nbsp;al. (<a href="#bib.bib41" title="" class="ltx_ref">2019</a>)</cite>. For each prompt <math id="S4.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.1c">u</annotation></semantics></math>, we compute the LM predicted conditional probability <math id="S4.SS1.SSS0.Px2.p1.3.m3.2" class="ltx_Math" alttext="p(o|E(u))" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.3.m3.2a"><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2.cmml">​</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2.cmml">o</mi><mo fence="false" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1.cmml">|</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.3.2.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">u</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.3.2.2" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.3" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m3.2b"><apply id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2"><times id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.2"></times><ci id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.3">𝑝</ci><apply id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.2">𝑜</ci><apply id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3"><times id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.1"></times><ci id="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.2.2.1.1.1.3.2">𝐸</ci><ci id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m3.2c">p(o|E(u))</annotation></semantics></math> of the next token continuation, where <math id="S4.SS1.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.4.m4.1c">o</annotation></semantics></math> is taken from the collection of all capitalized alphabetical tokens in the model vocabulary. To resolve the ambiguity issue where a query may allow multiple correct answers, we define hallucinations as the cases where the LM assigns the highest probability to a token <math id="S4.SS1.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="o^{\prime}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.5.m5.1a"><msup id="S4.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.5.m5.1b"><apply id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.5.m5.1c">o^{\prime}</annotation></semantics></math> that is neither the suffix of the true object <math id="S4.SS1.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="o_{c}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.6.m6.1a"><msub id="S4.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml">o</mi><mi id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.6.m6.1c">o_{c}</annotation></semantics></math> nor the suffix of any other objects of the subject-relation pair <math id="S4.SS1.SSS0.Px2.p1.7.m7.2" class="ltx_Math" alttext="(s,r)" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.7.m7.2a"><mrow id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2.1" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml">s</mi><mo id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px2.p1.7.m7.2.2" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.2.cmml">r</mi><mo stretchy="false" id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2.3" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.7.m7.2b"><interval closure="open" id="S4.SS1.SSS0.Px2.p1.7.m7.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.3.2"><ci id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p1.7.m7.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.2.2">𝑟</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.7.m7.2c">(s,r)</annotation></semantics></math> returned by a WikiData API query search. <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>See Appendix <a href="#A1" title="Appendix A Dataset of Non-Factual Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a> for more details about dataset construction.</span></span></span></p>
</div>
</section>
<section id="S4.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4>

<div id="S4.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px3.p1.1" class="ltx_p">We compute the average causal indirect effect over queries from ParaRel for hidden states <math id="S4.SS1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="z\in Z" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml">z</mi><mo id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml">∈</mo><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1"><in id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.1"></in><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.2">𝑧</ci><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">z\in Z</annotation></semantics></math> across various sentence positions and transformer layers. Figure <a href="#S4.F2" title="Figure 2 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the AIE distributions for three model components of Llama-2-7B: the residual stream, the attention heads, and the MLPs. We observe two groups of hidden states yielding the highest attribution scores towards incorrectly predicted objects: 1) the hidden states of the subject tokens at lower transformer layers by MLPs, and 2) the hidden states of the last relation token at upper transformer layers by MLPs and attention heads. We observe similar causal effect distributional patterns for GPT models as well (see Appendix <a href="#A2.SS2" title="B.2 Causal tracing results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.2</span></a> for additional results). <cite class="ltx_cite ltx_citemacro_citet">Geva et&nbsp;al. (<a href="#bib.bib15" title="" class="ltx_ref">2023</a>)</cite> recently show that lower layer MLPs and upper layer attention heads are two most crucial LM components for successful factual knowledge recalling. Our causal tracing results not only confirm their finding from a contrapositive perspective, but also reveal an additional component (upper layer MLPs) as an important source of hallucinations.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Early- vs. late-site hallucination.</h4>

<div id="S4.SS1.SSS0.Px4.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px4.p1.3" class="ltx_p">Based on the findings above, we hypothesize that there are two different “mechanisms” that may cause non-factual hallucinations, as illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>: 1) the LM fails to retrieve correct information about the subject from lower layer components, and 2) the LM successfully retrieves some subject attributes from lower layer components, but the upper layer components fail to distinguish the correct object(s) among retrieved ones. In particular, let <math id="S4.SS1.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS1.SSS0.Px4.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.1.m1.1c">L</annotation></semantics></math> be the number of transformer layers of an LM, we define <span id="S4.SS1.SSS0.Px4.p1.3.1" class="ltx_text ltx_font_italic">early-site components</span> as attention heads and MLPs located in the first half of LM’s layers (<math id="S4.SS1.SSS0.Px4.p1.2.m2.1" class="ltx_Math" alttext="1\leq l\leq\frac{L}{2}" display="inline"><semantics id="S4.SS1.SSS0.Px4.p1.2.m2.1a"><mrow id="S4.SS1.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml"><mn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml">1</mn><mo id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml">≤</mo><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4.cmml">l</mi><mo id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5.cmml">≤</mo><mfrac id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.cmml"><mi id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2.cmml">L</mi><mn id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><and id="S4.SS1.SSS0.Px4.p1.2.m2.1.1a.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"></and><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1b.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><leq id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.3"></leq><cn type="integer" id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.2">1</cn><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.4">𝑙</ci></apply><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1c.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"><leq id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.5"></leq><share href="#S4.SS1.SSS0.Px4.p1.2.m2.1.1.4.cmml" id="S4.SS1.SSS0.Px4.p1.2.m2.1.1d.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1"></share><apply id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6"><divide id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.1.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6"></divide><ci id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.2">𝐿</ci><cn type="integer" id="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3.cmml" xref="S4.SS1.SSS0.Px4.p1.2.m2.1.1.6.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.2.m2.1c">1\leq l\leq\frac{L}{2}</annotation></semantics></math>), and <span id="S4.SS1.SSS0.Px4.p1.3.2" class="ltx_text ltx_font_italic">late-site components</span> as those located in the second half of LM’s layers (<math id="S4.SS1.SSS0.Px4.p1.3.m3.1" class="ltx_Math" alttext="\frac{L}{2}<l\leq L" display="inline"><semantics id="S4.SS1.SSS0.Px4.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px4.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml"><mfrac id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml">L</mi><mn id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml">2</mn></mfrac><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml">&lt;</mo><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4.cmml">l</mi><mo id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5.cmml">≤</mo><mi id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><and id="S4.SS1.SSS0.Px4.p1.3.m3.1.1a.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"></and><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1b.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><lt id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.3"></lt><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2"><divide id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2"></divide><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.2">𝐿</ci><cn type="integer" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.2.3">2</cn></apply><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.4">𝑙</ci></apply><apply id="S4.SS1.SSS0.Px4.p1.3.m3.1.1c.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"><leq id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.5"></leq><share href="#S4.SS1.SSS0.Px4.p1.3.m3.1.1.4.cmml" id="S4.SS1.SSS0.Px4.p1.3.m3.1.1d.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1"></share><ci id="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6.cmml" xref="S4.SS1.SSS0.Px4.p1.3.m3.1.1.6">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p1.3.m3.1c">\frac{L}{2}&lt;l\leq L</annotation></semantics></math>). We then define the <span id="S4.SS1.SSS0.Px4.p1.3.3" class="ltx_text ltx_font_bold">relative indirect effect</span> between intermediate representations by early- and late-site model components as:</p>
</div>
<div id="S4.SS1.SSS0.Px4.p2" class="ltx_para">
<table id="A4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E1.m1.6" class="ltx_Math" alttext="\displaystyle\Delta\overline{\text{IE}}(y,u)={\color[rgb]{0,0,1}\overline{\text{IE}}_{\text{late}}(y,u)}-{\color[rgb]{1,0,0}\overline{\text{IE}}_{\text{early}}(y,u)}" display="inline"><semantics id="S4.E1.m1.6a"><mrow id="S4.E1.m1.6.7" xref="S4.E1.m1.6.7.cmml"><mrow id="S4.E1.m1.6.7.2" xref="S4.E1.m1.6.7.2.cmml"><mi mathvariant="normal" id="S4.E1.m1.6.7.2.2" xref="S4.E1.m1.6.7.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.6.7.2.1" xref="S4.E1.m1.6.7.2.1.cmml">​</mo><mover accent="true" id="S4.E1.m1.6.7.2.3" xref="S4.E1.m1.6.7.2.3.cmml"><mtext id="S4.E1.m1.6.7.2.3.2" xref="S4.E1.m1.6.7.2.3.2a.cmml">IE</mtext><mo id="S4.E1.m1.6.7.2.3.1" xref="S4.E1.m1.6.7.2.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.E1.m1.6.7.2.1a" xref="S4.E1.m1.6.7.2.1.cmml">​</mo><mrow id="S4.E1.m1.6.7.2.4.2" xref="S4.E1.m1.6.7.2.4.1.cmml"><mo stretchy="false" id="S4.E1.m1.6.7.2.4.2.1" xref="S4.E1.m1.6.7.2.4.1.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">y</mi><mo id="S4.E1.m1.6.7.2.4.2.2" xref="S4.E1.m1.6.7.2.4.1.cmml">,</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">u</mi><mo stretchy="false" id="S4.E1.m1.6.7.2.4.2.3" xref="S4.E1.m1.6.7.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.6.7.1" xref="S4.E1.m1.6.7.1.cmml">=</mo><mrow id="S4.E1.m1.6.7.3" xref="S4.E1.m1.6.7.3.cmml"><mrow id="S4.E1.m1.6.7.3.2" xref="S4.E1.m1.6.7.3.2.cmml"><msub id="S4.E1.m1.6.7.3.2.2" xref="S4.E1.m1.6.7.3.2.2.cmml"><mover accent="true" id="S4.E1.m1.6.7.3.2.2.2" xref="S4.E1.m1.6.7.3.2.2.2.cmml"><mtext mathcolor="#0000FF" id="S4.E1.m1.6.7.3.2.2.2.2" xref="S4.E1.m1.6.7.3.2.2.2.2a.cmml">IE</mtext><mo mathcolor="#0000FF" id="S4.E1.m1.6.7.3.2.2.2.1" xref="S4.E1.m1.6.7.3.2.2.2.1.cmml">¯</mo></mover><mtext mathcolor="#0000FF" id="S4.E1.m1.6.7.3.2.2.3" xref="S4.E1.m1.6.7.3.2.2.3a.cmml">late</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.6.7.3.2.1" xref="S4.E1.m1.6.7.3.2.1.cmml">​</mo><mrow id="S4.E1.m1.6.7.3.2.3.2" xref="S4.E1.m1.6.7.3.2.3.1.cmml"><mo mathcolor="#0000FF" stretchy="false" id="S4.E1.m1.6.7.3.2.3.2.1" xref="S4.E1.m1.6.7.3.2.3.1.cmml">(</mo><mi mathcolor="#0000FF" id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3.cmml">y</mi><mo mathcolor="#0000FF" id="S4.E1.m1.6.7.3.2.3.2.2" xref="S4.E1.m1.6.7.3.2.3.1.cmml">,</mo><mi mathcolor="#0000FF" id="S4.E1.m1.4.4" xref="S4.E1.m1.4.4.cmml">u</mi><mo mathcolor="#0000FF" stretchy="false" id="S4.E1.m1.6.7.3.2.3.2.3" xref="S4.E1.m1.6.7.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.6.7.3.1" xref="S4.E1.m1.6.7.3.1.cmml">−</mo><mrow id="S4.E1.m1.6.7.3.3" xref="S4.E1.m1.6.7.3.3.cmml"><msub id="S4.E1.m1.6.7.3.3.2" xref="S4.E1.m1.6.7.3.3.2.cmml"><mover accent="true" id="S4.E1.m1.6.7.3.3.2.2" xref="S4.E1.m1.6.7.3.3.2.2.cmml"><mtext mathcolor="#FF0000" id="S4.E1.m1.6.7.3.3.2.2.2" xref="S4.E1.m1.6.7.3.3.2.2.2a.cmml">IE</mtext><mo mathcolor="#FF0000" id="S4.E1.m1.6.7.3.3.2.2.1" xref="S4.E1.m1.6.7.3.3.2.2.1.cmml">¯</mo></mover><mtext mathcolor="#FF0000" id="S4.E1.m1.6.7.3.3.2.3" xref="S4.E1.m1.6.7.3.3.2.3a.cmml">early</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.6.7.3.3.1" xref="S4.E1.m1.6.7.3.3.1.cmml">​</mo><mrow id="S4.E1.m1.6.7.3.3.3.2" xref="S4.E1.m1.6.7.3.3.3.1.cmml"><mo mathcolor="#FF0000" stretchy="false" id="S4.E1.m1.6.7.3.3.3.2.1" xref="S4.E1.m1.6.7.3.3.3.1.cmml">(</mo><mi mathcolor="#FF0000" id="S4.E1.m1.5.5" xref="S4.E1.m1.5.5.cmml">y</mi><mo mathcolor="#FF0000" id="S4.E1.m1.6.7.3.3.3.2.2" xref="S4.E1.m1.6.7.3.3.3.1.cmml">,</mo><mi mathcolor="#FF0000" id="S4.E1.m1.6.6" xref="S4.E1.m1.6.6.cmml">u</mi><mo mathcolor="#FF0000" stretchy="false" id="S4.E1.m1.6.7.3.3.3.2.3" xref="S4.E1.m1.6.7.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.6b"><apply id="S4.E1.m1.6.7.cmml" xref="S4.E1.m1.6.7"><eq id="S4.E1.m1.6.7.1.cmml" xref="S4.E1.m1.6.7.1"></eq><apply id="S4.E1.m1.6.7.2.cmml" xref="S4.E1.m1.6.7.2"><times id="S4.E1.m1.6.7.2.1.cmml" xref="S4.E1.m1.6.7.2.1"></times><ci id="S4.E1.m1.6.7.2.2.cmml" xref="S4.E1.m1.6.7.2.2">Δ</ci><apply id="S4.E1.m1.6.7.2.3.cmml" xref="S4.E1.m1.6.7.2.3"><ci id="S4.E1.m1.6.7.2.3.1.cmml" xref="S4.E1.m1.6.7.2.3.1">¯</ci><ci id="S4.E1.m1.6.7.2.3.2a.cmml" xref="S4.E1.m1.6.7.2.3.2"><mtext id="S4.E1.m1.6.7.2.3.2.cmml" xref="S4.E1.m1.6.7.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.E1.m1.6.7.2.4.1.cmml" xref="S4.E1.m1.6.7.2.4.2"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝑦</ci><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝑢</ci></interval></apply><apply id="S4.E1.m1.6.7.3.cmml" xref="S4.E1.m1.6.7.3"><minus id="S4.E1.m1.6.7.3.1.cmml" xref="S4.E1.m1.6.7.3.1"></minus><apply id="S4.E1.m1.6.7.3.2.cmml" xref="S4.E1.m1.6.7.3.2"><times id="S4.E1.m1.6.7.3.2.1.cmml" xref="S4.E1.m1.6.7.3.2.1"></times><apply id="S4.E1.m1.6.7.3.2.2.cmml" xref="S4.E1.m1.6.7.3.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.7.3.2.2.1.cmml" xref="S4.E1.m1.6.7.3.2.2">subscript</csymbol><apply id="S4.E1.m1.6.7.3.2.2.2.cmml" xref="S4.E1.m1.6.7.3.2.2.2"><ci id="S4.E1.m1.6.7.3.2.2.2.1.cmml" xref="S4.E1.m1.6.7.3.2.2.2.1">¯</ci><ci id="S4.E1.m1.6.7.3.2.2.2.2a.cmml" xref="S4.E1.m1.6.7.3.2.2.2.2"><mtext id="S4.E1.m1.6.7.3.2.2.2.2.cmml" xref="S4.E1.m1.6.7.3.2.2.2.2">IE</mtext></ci></apply><ci id="S4.E1.m1.6.7.3.2.2.3a.cmml" xref="S4.E1.m1.6.7.3.2.2.3"><mtext mathcolor="#0000FF" mathsize="70%" id="S4.E1.m1.6.7.3.2.2.3.cmml" xref="S4.E1.m1.6.7.3.2.2.3">late</mtext></ci></apply><interval closure="open" id="S4.E1.m1.6.7.3.2.3.1.cmml" xref="S4.E1.m1.6.7.3.2.3.2"><ci id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">𝑦</ci><ci id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4">𝑢</ci></interval></apply><apply id="S4.E1.m1.6.7.3.3.cmml" xref="S4.E1.m1.6.7.3.3"><times id="S4.E1.m1.6.7.3.3.1.cmml" xref="S4.E1.m1.6.7.3.3.1"></times><apply id="S4.E1.m1.6.7.3.3.2.cmml" xref="S4.E1.m1.6.7.3.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.7.3.3.2.1.cmml" xref="S4.E1.m1.6.7.3.3.2">subscript</csymbol><apply id="S4.E1.m1.6.7.3.3.2.2.cmml" xref="S4.E1.m1.6.7.3.3.2.2"><ci id="S4.E1.m1.6.7.3.3.2.2.1.cmml" xref="S4.E1.m1.6.7.3.3.2.2.1">¯</ci><ci id="S4.E1.m1.6.7.3.3.2.2.2a.cmml" xref="S4.E1.m1.6.7.3.3.2.2.2"><mtext id="S4.E1.m1.6.7.3.3.2.2.2.cmml" xref="S4.E1.m1.6.7.3.3.2.2.2">IE</mtext></ci></apply><ci id="S4.E1.m1.6.7.3.3.2.3a.cmml" xref="S4.E1.m1.6.7.3.3.2.3"><mtext mathcolor="#FF0000" mathsize="70%" id="S4.E1.m1.6.7.3.3.2.3.cmml" xref="S4.E1.m1.6.7.3.3.2.3">early</mtext></ci></apply><interval closure="open" id="S4.E1.m1.6.7.3.3.3.1.cmml" xref="S4.E1.m1.6.7.3.3.3.2"><ci id="S4.E1.m1.5.5.cmml" xref="S4.E1.m1.5.5">𝑦</ci><ci id="S4.E1.m1.6.6.cmml" xref="S4.E1.m1.6.6">𝑢</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.6c">\displaystyle\Delta\overline{\text{IE}}(y,u)={\color[rgb]{0,0,1}\overline{\text{IE}}_{\text{late}}(y,u)}-{\color[rgb]{1,0,0}\overline{\text{IE}}_{\text{early}}(y,u)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E2.m1.7" class="ltx_Math" alttext="\displaystyle=\frac{2}{L}\Big{[}{\color[rgb]{0,0,1}\sum_{l=1+\frac{L}{2}}^{L}\overline{\text{IE}}(z^{(l)}_{T},y,u)}-{\color[rgb]{1,0,0}\sum_{l=1}^{\frac{L}{2}}\overline{\text{IE}}(z^{(l)}_{0},y,u)}\Big{]}," display="inline"><semantics id="S4.E2.m1.7a"><mrow id="S4.E2.m1.7.7.1" xref="S4.E2.m1.7.7.1.1.cmml"><mrow id="S4.E2.m1.7.7.1.1" xref="S4.E2.m1.7.7.1.1.cmml"><mi id="S4.E2.m1.7.7.1.1.3" xref="S4.E2.m1.7.7.1.1.3.cmml"></mi><mo id="S4.E2.m1.7.7.1.1.2" xref="S4.E2.m1.7.7.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.7.7.1.1.1" xref="S4.E2.m1.7.7.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2.m1.7.7.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.3.cmml"><mfrac id="S4.E2.m1.7.7.1.1.1.3a" xref="S4.E2.m1.7.7.1.1.1.3.cmml"><mn id="S4.E2.m1.7.7.1.1.1.3.2" xref="S4.E2.m1.7.7.1.1.1.3.2.cmml">2</mn><mi id="S4.E2.m1.7.7.1.1.1.3.3" xref="S4.E2.m1.7.7.1.1.1.3.3.cmml">L</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.2.cmml"><mo maxsize="160%" minsize="160%" id="S4.E2.m1.7.7.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><munderover id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2a" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo mathcolor="#0000FF" movablelimits="false" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.cmml"><mi mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2.cmml">l</mi><mo mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.cmml"><mn mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2.cmml">1</mn><mo mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1.cmml">+</mo><mfrac mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.cmml"><mi mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2.cmml">L</mi><mn mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3.cmml">2</mn></mfrac></mrow></mrow><mi mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3.cmml">L</mi></munderover></mstyle><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml"><mtext mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2a.cmml">IE</mtext><mo mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mo mathcolor="#0000FF" stretchy="false" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml">T</mi><mrow id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo mathcolor="#0000FF" stretchy="false" id="S4.E2.m1.1.1.1.3.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi mathcolor="#0000FF" id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">l</mi><mo mathcolor="#0000FF" stretchy="false" id="S4.E2.m1.1.1.1.3.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi mathcolor="#0000FF" id="S4.E2.m1.3.3" xref="S4.E2.m1.3.3.cmml">y</mi><mo mathcolor="#0000FF" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi mathcolor="#0000FF" id="S4.E2.m1.4.4" xref="S4.E2.m1.4.4.cmml">u</mi><mo mathcolor="#0000FF" stretchy="false" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.5" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.7.7.1.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml"><munderover id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2a" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml"><mo mathcolor="#FF0000" movablelimits="false" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml"><mi mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2.cmml">l</mi><mo mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1.cmml">=</mo><mn mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mfrac mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml"><mi mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2.cmml">L</mi><mn mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3.cmml">2</mn></mfrac></munderover></mstyle><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.cmml"><mover accent="true" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.cmml"><mtext mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2a.cmml">IE</mtext><mo mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2.cmml">​</mo><mrow id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml"><mo mathcolor="#FF0000" stretchy="false" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">(</mo><msubsup id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml">z</mi><mn mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.cmml">0</mn><mrow id="S4.E2.m1.2.2.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo mathcolor="#FF0000" stretchy="false" id="S4.E2.m1.2.2.1.3.1" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mi mathcolor="#FF0000" id="S4.E2.m1.2.2.1.1" xref="S4.E2.m1.2.2.1.1.cmml">l</mi><mo mathcolor="#FF0000" stretchy="false" id="S4.E2.m1.2.2.1.3.2" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">,</mo><mi mathcolor="#FF0000" id="S4.E2.m1.5.5" xref="S4.E2.m1.5.5.cmml">y</mi><mo mathcolor="#FF0000" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.4" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">,</mo><mi mathcolor="#FF0000" id="S4.E2.m1.6.6" xref="S4.E2.m1.6.6.cmml">u</mi><mo mathcolor="#FF0000" stretchy="false" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.5" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo maxsize="160%" minsize="160%" id="S4.E2.m1.7.7.1.1.1.1.1.3" xref="S4.E2.m1.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E2.m1.7.7.1.2" xref="S4.E2.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.7b"><apply id="S4.E2.m1.7.7.1.1.cmml" xref="S4.E2.m1.7.7.1"><eq id="S4.E2.m1.7.7.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.2"></eq><csymbol cd="latexml" id="S4.E2.m1.7.7.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.3">absent</csymbol><apply id="S4.E2.m1.7.7.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1"><times id="S4.E2.m1.7.7.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.2"></times><apply id="S4.E2.m1.7.7.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.3"><divide id="S4.E2.m1.7.7.1.1.1.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.3"></divide><cn type="integer" id="S4.E2.m1.7.7.1.1.1.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.3.2">2</cn><ci id="S4.E2.m1.7.7.1.1.1.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.3.3">𝐿</ci></apply><apply id="S4.E2.m1.7.7.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1"><minus id="S4.E2.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.3"></minus><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3"><eq id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.2">𝑙</ci><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3"><plus id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.1"></plus><cn type="integer" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.2">1</cn><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3"><divide id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3"></divide><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.2">𝐿</ci><cn type="integer" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.2.3.3.3.3">2</cn></apply></apply></apply></apply><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1"><times id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3"><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1">¯</ci><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2">IE</mtext></ci></apply><vector id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑙</ci></apply><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3">𝑦</ci><ci id="S4.E2.m1.4.4.cmml" xref="S4.E2.m1.4.4">𝑢</ci></vector></apply></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2">subscript</csymbol><sum id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.2"></sum><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3"><eq id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.1"></eq><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.2">𝑙</ci><cn type="integer" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3"><divide id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3"></divide><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.2">𝐿</ci><cn type="integer" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.2.3.3">2</cn></apply></apply><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1"><times id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.2"></times><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3"><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.1">¯</ci><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2a.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2"><mtext id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.3.2">IE</mtext></ci></apply><vector id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1"><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1">superscript</csymbol><ci id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.2">𝑧</ci><ci id="S4.E2.m1.2.2.1.1.cmml" xref="S4.E2.m1.2.2.1.1">𝑙</ci></apply><cn type="integer" id="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E2.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3">0</cn></apply><ci id="S4.E2.m1.5.5.cmml" xref="S4.E2.m1.5.5">𝑦</ci><ci id="S4.E2.m1.6.6.cmml" xref="S4.E2.m1.6.6">𝑢</ci></vector></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.7c">\displaystyle=\frac{2}{L}\Big{[}{\color[rgb]{0,0,1}\sum_{l=1+\frac{L}{2}}^{L}\overline{\text{IE}}(z^{(l)}_{T},y,u)}-{\color[rgb]{1,0,0}\sum_{l=1}^{\frac{L}{2}}\overline{\text{IE}}(z^{(l)}_{0},y,u)}\Big{]},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.SSS0.Px4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.SSS0.Px4.p3.8" class="ltx_p">where <math id="S4.SS1.SSS0.Px4.p3.1.m1.2" class="ltx_Math" alttext="\color[rgb]{1,0,0}{\overline{\text{IE}}_{\text{early}}(y,u)}" display="inline"><semantics id="S4.SS1.SSS0.Px4.p3.1.m1.2a"><mrow id="S4.SS1.SSS0.Px4.p3.1.m1.2.3" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.cmml"><msub id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.cmml"><mover accent="true" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.cmml"><mtext mathcolor="#FF0000" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2a.cmml">IE</mtext><mo mathcolor="#FF0000" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1.cmml">¯</mo></mover><mtext mathcolor="#FF0000" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3a.cmml">early</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1.cmml">​</mo><mrow id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml"><mo mathcolor="#FF0000" stretchy="false" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2.1" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml">(</mo><mi mathcolor="#FF0000" id="S4.SS1.SSS0.Px4.p3.1.m1.1.1" xref="S4.SS1.SSS0.Px4.p3.1.m1.1.1.cmml">y</mi><mo mathcolor="#FF0000" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml">,</mo><mi mathcolor="#FF0000" id="S4.SS1.SSS0.Px4.p3.1.m1.2.2" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.2.cmml">u</mi><mo mathcolor="#FF0000" stretchy="false" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2.3" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.1.m1.2b"><apply id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3"><times id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.1"></times><apply id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2">subscript</csymbol><apply id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2"><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2"><mtext id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.2.2">IE</mtext></ci></apply><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3a.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3"><mtext mathcolor="#FF0000" mathsize="70%" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.2.3">early</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.3.3.2"><ci id="S4.SS1.SSS0.Px4.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.1.m1.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.1.m1.2c">\color[rgb]{1,0,0}{\overline{\text{IE}}_{\text{early}}(y,u)}</annotation></semantics></math> is the average indirect effect of early-site intermediate representations of the first subject token <math id="S4.SS1.SSS0.Px4.p3.2.m2.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="S4.SS1.SSS0.Px4.p3.2.m2.1a"><msub id="S4.SS1.SSS0.Px4.p3.2.m2.1.1" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2.cmml">w</mi><mn id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.2.m2.1b"><apply id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.2">𝑤</ci><cn type="integer" id="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.2.m2.1c">w_{0}</annotation></semantics></math> (hidden states in blue dashed boxes in Figure <a href="#S4.F2" title="Figure 2 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), and <math id="S4.SS1.SSS0.Px4.p3.3.m3.2" class="ltx_Math" alttext="\color[rgb]{0,0,1}{\overline{\text{IE}}_{\text{late}}(y,u)}" display="inline"><semantics id="S4.SS1.SSS0.Px4.p3.3.m3.2a"><mrow id="S4.SS1.SSS0.Px4.p3.3.m3.2.3" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.cmml"><msub id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.cmml"><mover accent="true" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.cmml"><mtext mathcolor="#0000FF" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2a.cmml">IE</mtext><mo mathcolor="#0000FF" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1.cmml">¯</mo></mover><mtext mathcolor="#0000FF" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3a.cmml">late</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1.cmml">​</mo><mrow id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml"><mo mathcolor="#0000FF" stretchy="false" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2.1" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml">(</mo><mi mathcolor="#0000FF" id="S4.SS1.SSS0.Px4.p3.3.m3.1.1" xref="S4.SS1.SSS0.Px4.p3.3.m3.1.1.cmml">y</mi><mo mathcolor="#0000FF" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml">,</mo><mi mathcolor="#0000FF" id="S4.SS1.SSS0.Px4.p3.3.m3.2.2" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.2.cmml">u</mi><mo mathcolor="#0000FF" stretchy="false" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2.3" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.3.m3.2b"><apply id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3"><times id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.1"></times><apply id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2">subscript</csymbol><apply id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2"><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2"><mtext id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.2.2">IE</mtext></ci></apply><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3a.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3"><mtext mathcolor="#0000FF" mathsize="70%" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.2.3">late</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.3.3.2"><ci id="S4.SS1.SSS0.Px4.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.3.m3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.3.m3.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.3.m3.2c">\color[rgb]{0,0,1}{\overline{\text{IE}}_{\text{late}}(y,u)}</annotation></semantics></math> is the average indirect effect of late-site intermediate representations of the last relation token <math id="S4.SS1.SSS0.Px4.p3.4.m4.1" class="ltx_Math" alttext="w_{T}" display="inline"><semantics id="S4.SS1.SSS0.Px4.p3.4.m4.1a"><msub id="S4.SS1.SSS0.Px4.p3.4.m4.1.1" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2.cmml">w</mi><mi id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.4.m4.1b"><apply id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.2">𝑤</ci><ci id="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p3.4.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.4.m4.1c">w_{T}</annotation></semantics></math> of <math id="S4.SS1.SSS0.Px4.p3.5.m5.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.SS1.SSS0.Px4.p3.5.m5.1a"><mi id="S4.SS1.SSS0.Px4.p3.5.m5.1.1" xref="S4.SS1.SSS0.Px4.p3.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.5.m5.1b"><ci id="S4.SS1.SSS0.Px4.p3.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.5.m5.1c">u</annotation></semantics></math> (hidden states in red dashed boxes in Figure <a href="#S4.F2" title="Figure 2 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). We categorize a hallucination <math id="S4.SS1.SSS0.Px4.p3.6.m6.3" class="ltx_Math" alttext="(u,o,o^{\prime})" display="inline"><semantics id="S4.SS1.SSS0.Px4.p3.6.m6.3a"><mrow id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.2" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.6.m6.1.1" xref="S4.SS1.SSS0.Px4.p3.6.m6.1.1.cmml">u</mi><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.3" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.6.m6.2.2" xref="S4.SS1.SSS0.Px4.p3.6.m6.2.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.4" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">,</mo><msup id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.cmml"><mi id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.5" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.6.m6.3b"><vector id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1"><ci id="S4.SS1.SSS0.Px4.p3.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.1.1">𝑢</ci><ci id="S4.SS1.SSS0.Px4.p3.6.m6.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.2.2">𝑜</ci><apply id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3.cmml" xref="S4.SS1.SSS0.Px4.p3.6.m6.3.3.1.1.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.6.m6.3c">(u,o,o^{\prime})</annotation></semantics></math> as <span id="S4.SS1.SSS0.Px4.p3.8.1" class="ltx_text ltx_font_bold">early-site</span> if its lower layer hidden representations have stronger AIEs (i.e. <math id="S4.SS1.SSS0.Px4.p3.7.m7.2" class="ltx_Math" alttext="\Delta\overline{\text{IE}}(y,u)<0" display="inline"><semantics id="S4.SS1.SSS0.Px4.p3.7.m7.2a"><mrow id="S4.SS1.SSS0.Px4.p3.7.m7.2.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.cmml"><mrow id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.cmml"><mi mathvariant="normal" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1.cmml">​</mo><mover accent="true" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1a" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1.cmml">​</mo><mrow id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.7.m7.1.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.7.m7.2.2" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.2.cmml">u</mi><mo stretchy="false" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1.cmml">&lt;</mo><mn id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.7.m7.2b"><apply id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3"><lt id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.1"></lt><apply id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2"><times id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.1"></times><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.2">Δ</ci><apply id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3"><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2"><mtext id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.2.4.2"><ci id="S4.SS1.SSS0.Px4.p3.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.7.m7.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.2">𝑢</ci></interval></apply><cn type="integer" id="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3.cmml" xref="S4.SS1.SSS0.Px4.p3.7.m7.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.7.m7.2c">\Delta\overline{\text{IE}}(y,u)&lt;0</annotation></semantics></math>), and otherwise categorize it as <span id="S4.SS1.SSS0.Px4.p3.8.2" class="ltx_text ltx_font_bold">late-site</span> (i.e. <math id="S4.SS1.SSS0.Px4.p3.8.m8.2" class="ltx_Math" alttext="\Delta\overline{\text{IE}}(y,u)\geq 0" display="inline"><semantics id="S4.SS1.SSS0.Px4.p3.8.m8.2a"><mrow id="S4.SS1.SSS0.Px4.p3.8.m8.2.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.cmml"><mrow id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.cmml"><mi mathvariant="normal" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1.cmml">​</mo><mover accent="true" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.cmml"><mtext id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2a.cmml">IE</mtext><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1a" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1.cmml">​</mo><mrow id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px4.p3.8.m8.1.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.1.1.cmml">y</mi><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px4.p3.8.m8.2.2" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.2.cmml">u</mi><mo stretchy="false" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1.cmml">≥</mo><mn id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px4.p3.8.m8.2b"><apply id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3"><geq id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.1"></geq><apply id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2"><times id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.1"></times><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.2">Δ</ci><apply id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3"><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.1">¯</ci><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2a.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2"><mtext id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.3.2">IE</mtext></ci></apply><interval closure="open" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.2.4.2"><ci id="S4.SS1.SSS0.Px4.p3.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.1.1">𝑦</ci><ci id="S4.SS1.SSS0.Px4.p3.8.m8.2.2.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.2">𝑢</ci></interval></apply><cn type="integer" id="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3.cmml" xref="S4.SS1.SSS0.Px4.p3.8.m8.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px4.p3.8.m8.2c">\Delta\overline{\text{IE}}(y,u)\geq 0</annotation></semantics></math>). We found that early-site and late-site hallucinations have very different AIE distributions: as shown in <a href="#S4.F3" title="Figure 3 ‣ Method. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, while most components that contribute significantly to early-site hallucinations are located in lower layers when processing subject tokens, late-site hallucinations are mostly caused by components concentrated in upper layers when processing the relation tokens.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<div id="S4.T1.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:179.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(73.2pt,-35.6pt) scale(1.65922729186998,1.65922729186998) ;">
<table id="S4.T1.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.4.4.5.1" class="ltx_tr">
<th id="S4.T1.4.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">Statistics</th>
<th id="S4.T1.4.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Early-site hall.</th>
<th id="S4.T1.4.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Late-site hall.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.4.4.6.1" class="ltx_tr">
<th id="S4.T1.4.4.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">Amount</th>
<td id="S4.T1.4.4.6.1.2" class="ltx_td ltx_align_center ltx_border_t">(1945 / 31.9%)</td>
<td id="S4.T1.4.4.6.1.3" class="ltx_td ltx_align_center ltx_border_t">(4152 / 68.1%)</td>
</tr>
<tr id="S4.T1.2.2.2" class="ltx_tr">
<th id="S4.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">s</annotation></semantics></math>-<math id="S4.T1.2.2.2.2.m2.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S4.T1.2.2.2.2.m2.1a"><mi id="S4.T1.2.2.2.2.m2.1.1" xref="S4.T1.2.2.2.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m2.1b"><ci id="S4.T1.2.2.2.2.m2.1.1.cmml" xref="S4.T1.2.2.2.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m2.1c">o</annotation></semantics></math> assoc.</th>
<td id="S4.T1.2.2.2.3" class="ltx_td ltx_align_center">0.40</td>
<td id="S4.T1.2.2.2.4" class="ltx_td ltx_align_center">0.88</td>
</tr>
<tr id="S4.T1.4.4.4" class="ltx_tr">
<th id="S4.T1.4.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="S4.T1.3.3.3.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.T1.3.3.3.1.m1.1a"><mi id="S4.T1.3.3.3.1.m1.1.1" xref="S4.T1.3.3.3.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.m1.1b"><ci id="S4.T1.3.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.m1.1c">s</annotation></semantics></math>-<math id="S4.T1.4.4.4.2.m2.1" class="ltx_Math" alttext="o^{\prime}" display="inline"><semantics id="S4.T1.4.4.4.2.m2.1a"><msup id="S4.T1.4.4.4.2.m2.1.1" xref="S4.T1.4.4.4.2.m2.1.1.cmml"><mi id="S4.T1.4.4.4.2.m2.1.1.2" xref="S4.T1.4.4.4.2.m2.1.1.2.cmml">o</mi><mo id="S4.T1.4.4.4.2.m2.1.1.3" xref="S4.T1.4.4.4.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.2.m2.1b"><apply id="S4.T1.4.4.4.2.m2.1.1.cmml" xref="S4.T1.4.4.4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.T1.4.4.4.2.m2.1.1.1.cmml" xref="S4.T1.4.4.4.2.m2.1.1">superscript</csymbol><ci id="S4.T1.4.4.4.2.m2.1.1.2.cmml" xref="S4.T1.4.4.4.2.m2.1.1.2">𝑜</ci><ci id="S4.T1.4.4.4.2.m2.1.1.3.cmml" xref="S4.T1.4.4.4.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.2.m2.1c">o^{\prime}</annotation></semantics></math> assoc.</th>
<td id="S4.T1.4.4.4.3" class="ltx_td ltx_align_center">0.85</td>
<td id="S4.T1.4.4.4.4" class="ltx_td ltx_align_center">2.03</td>
</tr>
<tr id="S4.T1.4.4.7.2" class="ltx_tr">
<th id="S4.T1.4.4.7.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">Robustness</th>
<td id="S4.T1.4.4.7.2.2" class="ltx_td ltx_align_center">0.78</td>
<td id="S4.T1.4.4.7.2.3" class="ltx_td ltx_align_center">0.51</td>
</tr>
<tr id="S4.T1.4.4.8.3" class="ltx_tr">
<th id="S4.T1.4.4.8.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">Uncertainty</th>
<td id="S4.T1.4.4.8.3.2" class="ltx_td ltx_align_center ltx_border_bb">4.39</td>
<td id="S4.T1.4.4.8.3.3" class="ltx_td ltx_align_center ltx_border_bb">4.17</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>External data and Llama-2-7b prediction features for two types of non-factual hallucination.</figcaption>
</figure>
</section>
<section id="S4.SS1.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">External manifestations of hallucination mechanisms.</h4>

<div id="S4.SS1.SSS0.Px5.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px5.p1.10" class="ltx_p">To verify that our categorization of hallucinations is not a fabricated dichotomy based solely on internal computation patterns, we next investigate whether there are any external features that can be leveraged to distinguish the two types of hallucinations. We consider the following features of query data and model predictions: the <span id="S4.SS1.SSS0.Px5.p1.10.1" class="ltx_text ltx_font_bold">subject-object association strength</span> is measured as the inner product between the input layer embeddings of a subject <math id="S4.SS1.SSS0.Px5.p1.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px5.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.1.m1.1c">s</annotation></semantics></math> and a true object <math id="S4.SS1.SSS0.Px5.p1.2.m2.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px5.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px5.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.2.m2.1c">o</annotation></semantics></math> or a hallucinating object <math id="S4.SS1.SSS0.Px5.p1.3.m3.1" class="ltx_Math" alttext="o^{\prime}" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.3.m3.1a"><msup id="S4.SS1.SSS0.Px5.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.3.m3.1c">o^{\prime}</annotation></semantics></math>; the <span id="S4.SS1.SSS0.Px5.p1.10.2" class="ltx_text ltx_font_bold">robustness</span> of a predicted object <math id="S4.SS1.SSS0.Px5.p1.4.m4.1" class="ltx_Math" alttext="o^{\prime}" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.4.m4.1a"><msup id="S4.SS1.SSS0.Px5.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.2" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.3" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.4.m4.1c">o^{\prime}</annotation></semantics></math> is measured as the percentage of Gaussian noise injected during the mitigation run in section <a href="#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> which, after being added to the input embeddings, fails to make the model prefer the true answer <math id="S4.SS1.SSS0.Px5.p1.5.m5.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.5.m5.1a"><mi id="S4.SS1.SSS0.Px5.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px5.p1.5.m5.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.5.m5.1b"><ci id="S4.SS1.SSS0.Px5.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.5.m5.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.5.m5.1c">o</annotation></semantics></math> over <math id="S4.SS1.SSS0.Px5.p1.6.m6.1" class="ltx_Math" alttext="o^{\prime}" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.6.m6.1a"><msup id="S4.SS1.SSS0.Px5.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.6.m6.1c">o^{\prime}</annotation></semantics></math> (i.e., <math id="S4.SS1.SSS0.Px5.p1.7.m7.1" class="ltx_Math" alttext="y_{*}<0<y" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.7.m7.1a"><mrow id="S4.SS1.SSS0.Px5.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.cmml"><msub id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2.cmml">y</mi><mo id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3.cmml">∗</mo></msub><mo id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3.cmml">&lt;</mo><mn id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4.cmml">0</mn><mo id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5.cmml">&lt;</mo><mi id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.7.m7.1b"><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"><and id="S4.SS1.SSS0.Px5.p1.7.m7.1.1a.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"></and><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1b.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"><lt id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.3"></lt><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.2">𝑦</ci><times id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.2.3"></times></apply><cn type="integer" id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.4">0</cn></apply><apply id="S4.SS1.SSS0.Px5.p1.7.m7.1.1c.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"><lt id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.5"></lt><share href="#S4.SS1.SSS0.Px5.p1.7.m7.1.1.4.cmml" id="S4.SS1.SSS0.Px5.p1.7.m7.1.1d.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1"></share><ci id="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6.cmml" xref="S4.SS1.SSS0.Px5.p1.7.m7.1.1.6">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.7.m7.1c">y_{*}&lt;0&lt;y</annotation></semantics></math>); the <span id="S4.SS1.SSS0.Px5.p1.10.3" class="ltx_text ltx_font_bold">uncertainty</span> of model prediction is measured by the entropy of the conditional next-token distribution <math id="S4.SS1.SSS0.Px5.p1.8.m8.1" class="ltx_Math" alttext="p(o|u)" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.8.m8.1a"><mrow id="S4.SS1.SSS0.Px5.p1.8.m8.1.1" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.3" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.2" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.2" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.3.cmml">u</mi></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.3" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.8.m8.1b"><apply id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1"><times id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.2"></times><ci id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.3">𝑝</ci><apply id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.8.m8.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.8.m8.1c">p(o|u)</annotation></semantics></math>. Table <a href="#S4.T1" title="Table 1 ‣ Early- vs. late-site hallucination. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the external measurements. We found that 1) subjects of late-site hallucinations (e.g., <span id="S4.SS1.SSS0.Px5.p1.10.4" class="ltx_text ltx_font_italic">Toulouse</span>) often have hallucinating objects (e.g., <span id="S4.SS1.SSS0.Px5.p1.10.5" class="ltx_text ltx_font_italic">Paris</span>) of much stronger association strengths than true objects (e.g., <span id="S4.SS1.SSS0.Px5.p1.10.6" class="ltx_text ltx_font_italic">Bologna</span>), so that the model fail to “offset” the prior propensity of model predicting <math id="S4.SS1.SSS0.Px5.p1.9.m9.1" class="ltx_Math" alttext="o^{\prime}" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.9.m9.1a"><msup id="S4.SS1.SSS0.Px5.p1.9.m9.1.1" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.cmml"><mi id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.2" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.2.cmml">o</mi><mo id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.3" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.9.m9.1b"><apply id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.2.cmml" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.2">𝑜</ci><ci id="S4.SS1.SSS0.Px5.p1.9.m9.1.1.3.cmml" xref="S4.SS1.SSS0.Px5.p1.9.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.9.m9.1c">o^{\prime}</annotation></semantics></math> upon seeing <math id="S4.SS1.SSS0.Px5.p1.10.m10.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.SSS0.Px5.p1.10.m10.1a"><mi id="S4.SS1.SSS0.Px5.p1.10.m10.1.1" xref="S4.SS1.SSS0.Px5.p1.10.m10.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px5.p1.10.m10.1b"><ci id="S4.SS1.SSS0.Px5.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px5.p1.10.m10.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px5.p1.10.m10.1c">s</annotation></semantics></math>. Subjects of early-site hallucinations (e.g., <span id="S4.SS1.SSS0.Px5.p1.10.7" class="ltx_text ltx_font_italic">Orica</span>), on the other hand, often have much weaker associations with both true (e.g., <span id="S4.SS1.SSS0.Px5.p1.10.8" class="ltx_text ltx_font_italic">Australia</span>) and hallucinating (e.g., <span id="S4.SS1.SSS0.Px5.p1.10.9" class="ltx_text ltx_font_italic">January</span>) objects; 2) late-site hallucinations are significantly less robust under input perturbations, probably because the model has already retrieved the correct object from early layers and is just “one step away” from distinguishing it; 3) the model is less certain about its predictions when generating early-site hallucinations, a pattern that is consistent with previous findings that epistemic hallucinations are often associated with high predictive uncertainty <cite class="ltx_cite ltx_citemacro_cite">Xiao and Wang (<a href="#bib.bib54" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2403.18167/assets/x5.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="415" height="465" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Average dot product between true object embedding and intermediate hidden representations by components of Llama-2-7b in each layer.</figcaption>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Inspection via embedding space projection</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In this section, we provide further evidence of the mechanistic difference between early- and late-site hallucinations by looking at the information that each model component writes into the residual stream during inference.</p>
</div>
<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Method.</h4>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p1.10" class="ltx_p">As Section <a href="#S3" title="3 Background and Notation ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> suggests, each attention or MLP module at layer <math id="S4.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">l</annotation></semantics></math> contributes to the model prediction by adding its output hidden state into the embeddings <math id="S4.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="h^{(l-1)}_{i}" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><msubsup id="S4.SS2.SSS0.Px1.p1.2.m2.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2.cmml">h</mi><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3.cmml">i</mi><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.2.2">ℎ</ci><apply id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.1.1.1.3">1</cn></apply></apply><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">h^{(l-1)}_{i}</annotation></semantics></math> produced by the previous layer. Recent work shows that the encoded knowledge of a module can be interpreted by applying the final-layer language model head projection (i.e. dot product) to its intermediate output hidden state, thereby obtaining a distribution over the vocabulary <cite class="ltx_cite ltx_citemacro_cite">Geva et&nbsp;al. (<a href="#bib.bib17" title="" class="ltx_ref">2022b</a>); Dar et&nbsp;al. (<a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite>. For each example of model hallucination <math id="S4.SS2.SSS0.Px1.p1.3.m3.3" class="ltx_Math" alttext="(u,o,o^{\prime})" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.3.m3.3a"><mrow id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml"><mo stretchy="false" id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">u</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">,</mo><mi id="S4.SS2.SSS0.Px1.p1.3.m3.2.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.2.2.cmml">o</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.4" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">,</mo><msup id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2.cmml">o</mi><mo id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.5" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.m3.3b"><vector id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1"><ci id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1">𝑢</ci><ci id="S4.SS2.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.2.2">𝑜</ci><apply id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.2">𝑜</ci><ci id="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.3.3.1.1.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.m3.3c">(u,o,o^{\prime})</annotation></semantics></math>, we use this method by first extracting the intermediate outputs <math id="S4.SS2.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="z\in A\bigcup M" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.4.m4.1a"><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml">z</mi><mo id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml">∈</mo><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">​</mo><mrow id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.cmml"><mo id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml">⋃</mo><mi id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml">M</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1"><in id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.1"></in><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.2">𝑧</ci><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3"><times id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.1"></times><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.2">𝐴</ci><apply id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3"><union id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.1"></union><ci id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.3.3.2">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.4.m4.1c">z\in A\bigcup M</annotation></semantics></math> of all MLPs and attention modules, and then taking the dot product <math id="S4.SS2.SSS0.Px1.p1.5.m5.2" class="ltx_Math" alttext="\tilde{p}(z,o)=z^{T}e_{o}" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.5.m5.2a"><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.cmml"><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.cmml"><mover accent="true" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2.cmml">p</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1.cmml">​</mo><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1.cmml">z</mi><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml">,</mo><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.2.cmml">o</mi><mo stretchy="false" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1.cmml">=</mo><mrow id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.cmml"><msup id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2.cmml">z</mi><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1.cmml">​</mo><msub id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.cmml"><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2.cmml">e</mi><mi id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3.cmml">o</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.5.m5.2b"><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3"><eq id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.1"></eq><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2"><times id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.1"></times><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2"><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.1">~</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.2.2">𝑝</ci></apply><interval closure="open" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.2.3.2"><ci id="S4.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.1.1">𝑧</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.2">𝑜</ci></interval></apply><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3"><times id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.1"></times><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.2">𝑧</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.2.3">𝑇</ci></apply><apply id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.2">𝑒</ci><ci id="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m5.2.3.3.3.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.5.m5.2c">\tilde{p}(z,o)=z^{T}e_{o}</annotation></semantics></math> between <math id="S4.SS2.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.6.m6.1a"><mi id="S4.SS2.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS2.SSS0.Px1.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.6.m6.1b"><ci id="S4.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.6.m6.1c">z</annotation></semantics></math> and the row vectors corresponding to <math id="S4.SS2.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.7.m7.1a"><mi id="S4.SS2.SSS0.Px1.p1.7.m7.1.1" xref="S4.SS2.SSS0.Px1.p1.7.m7.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.7.m7.1b"><ci id="S4.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.7.m7.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.7.m7.1c">o</annotation></semantics></math> in the final projection layer. The resulting embedding space projection (ESP) can be taken as an approximated contribution of <math id="S4.SS2.SSS0.Px1.p1.8.m8.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.8.m8.1a"><mi id="S4.SS2.SSS0.Px1.p1.8.m8.1.1" xref="S4.SS2.SSS0.Px1.p1.8.m8.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.8.m8.1b"><ci id="S4.SS2.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.8.m8.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.8.m8.1c">z</annotation></semantics></math> to <math id="S4.SS2.SSS0.Px1.p1.9.m9.1" class="ltx_Math" alttext="p(o|u)" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.9.m9.1a"><mrow id="S4.SS2.SSS0.Px1.p1.9.m9.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml">​</mo><mrow id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3.cmml">u</mi></mrow><mo stretchy="false" id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.9.m9.1b"><apply id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1"><times id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.2"></times><ci id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.3">𝑝</ci><apply id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.2">𝑜</ci><ci id="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.9.m9.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.9.m9.1c">p(o|u)</annotation></semantics></math>. By averaging the projections over all queries and all modules of the same type in each layer, we can then quantify how much knowledge about the correct answer <math id="S4.SS2.SSS0.Px1.p1.10.m10.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.10.m10.1a"><mi id="S4.SS2.SSS0.Px1.p1.10.m10.1.1" xref="S4.SS2.SSS0.Px1.p1.10.m10.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.10.m10.1b"><ci id="S4.SS2.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.10.m10.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.10.m10.1c">o</annotation></semantics></math> each layer contributes during inference.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4>

<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px2.p1.1" class="ltx_p">We compute the layerwise MLP and attention projections for the true objects averaged over three groups of queries: 1) factual answers (i.e. model correctly predicts <math id="S4.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.1c">o</annotation></semantics></math> as the next token), 2) early-site hallucinations, and 3) late-site hallucinations. Figure <a href="#S4.F4" title="Figure 4 ‣ External manifestations of hallucination mechanisms. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the results. We notice that 1) only lower layer MLPs write information about the true answer into the residual stream, and importantly, the contributions of lower layer MLPs are similar for late-site hallucinations and correctly answered queries, while being much less when the model generates early-site hallucinations. 2) For both types of hallucination, the self-attention components, particularly those in upper layers, write significantly less useful information compared to factually correct answers. Similar patterns observed in GPT models can be found in Appendix <a href="#A2.SS4" title="B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.4</span></a>.</p>
</div>
<div id="S4.SS2.SSS0.Px2.p2" class="ltx_para">
<p id="S4.SS2.SSS0.Px2.p2.1" class="ltx_p">Taken together, our analysis suggests that 1) <span id="S4.SS2.SSS0.Px2.p2.1.1" class="ltx_text ltx_font_italic">early-site MLPs, late-site self-attentions and late-site MLPs are the most crucial LM components of causing hallucinations</span>, and 2) <span id="S4.SS2.SSS0.Px2.p2.1.2" class="ltx_text ltx_font_italic">lower layer MLPs and upper layer attentions/MLPs do not always break down simultaneously, thus leading to two distinct mechanisms of LM factual errors.</span></p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Tracing LM Hallucinations During Pretraining</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We have identified two mechanisms of non-factual hallucinations in LMs. In this section, we design experiments with the goal of understanding how these hallucinations emerge during model pretraining. For example, do early-site and late-site hallucinations exhibit different learning patterns that contribute to their distinctions? We also aim to explore why the crucial early-site MLP and late-site attention components fail to “develop” properly.</p>
</div>
<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Data and models.</h4>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">To study language model hallucinations during pretraining, we evaluate the Pythia model suite <cite class="ltx_cite ltx_citemacro_cite">Biderman et&nbsp;al. (<a href="#bib.bib2" title="" class="ltx_ref">2023</a>)</cite> on ParaRel. Pythia is a set of pretraining checkpoints for a family of autoregressive LMs trained on public data in the exact same order. We first take the last checkpoint of Pythia with 1.4 billion parameters and repeat the same evaluation and filtering processes for other LMs on ParaRel dataset described in section <a href="#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>, and then perform causal mediation analysis on incorrectly answered queries to get AIEs for attention heads and MLPs, and categorize the queries into early-site and late-site hallucinations based on Equation <a href="#S4.E2" title="In Early- vs. late-site hallucination. ‣ 4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We then evaluate and get intermediate hidden states for all queries on 32 Pythia-1.4B pretraining checkpoints evenly distributed across model learning history.<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>See Appendix <a href="#A3" title="Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a> for details of Pythia evaluation.</span></span></span></p>
</div>
</section>
<section id="S5.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Development of factual association pipeline.</h4>

<div id="S5.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px2.p1.1" class="ltx_p">We replicate the embedding space projection (ESP) experiments in section <a href="#S4.SS2" title="4.2 Inspection via embedding space projection ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> on Pythia-1.4b checkpoints and compare the results across pretraining steps. For each Pythia-1.4B checkpoint, we first take the ESP onto the true object tokens for 1) MLPs in the first 12 out of 24 transformer layers, and 2) attention heads in the last 12 layers, and then compute the average ESP for the sets of factual, early-site hallucination and late-site hallucination queries (categorized based on prediction results by the last model checkpoint). Figure <a href="#S5.F5" title="Figure 5 ‣ Development of factual association pipeline. ‣ 5 Tracing LM Hallucinations During Pretraining ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the evolution trajectory of true object ESPs on 32 Pythia-1.4b checkpoints. We notice that 1) the learning dynamics of MLPs between late-site hallucination and factual queries are very similar, where they gradually learn to produce positive ESPs to the true object prediction roughly during the first half of pretraining. For early-site hallucinations, the MLPs instead learn to make negative ESPs, again suggesting their lack of true subject knowledge. 2) The upper-layer attentions of Pythia only learn to produce high ESPs for factual queries. Moreover, the attention modules will not learn to distinguish true objects until the early-site MLPs have grown mature (<math id="S5.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS0.SSS0.Px2.p1.1.m1.1a"><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.1.m1.1b"><csymbol cd="latexml" id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.1.m1.1c">\sim</annotation></semantics></math>70-<span id="S5.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">th</span> pretraining step). Taken together, our results suggest that <span id="S5.SS0.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_italic">the early-site MLPs and late-site attentions together form a two-step pipeline of fact recall that emerges progressively during pretraining, and failing to develop either of them will lead to non-factual hallucinations</span>.</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/2403.18167/assets/x6.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="415" height="418" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Average embedding space projections to the true object tokens for lower-layer MLPs (up) and upper-layer attention modules (down) of Pythia-1.4b pretraining checkpoints. The red vertical line indicates a “phase change” when the lower layer MLPs finish their learning, and upper layer attention heads start to develop. </figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Application to Hallucination Detection</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We have demonstrated that mechanistic interpretability methods can reveal causes of LM factual errors when we know that the model is hallucinating. In this section, we further show that the causal attribution features in our previous analyses can also predict whether an LM is generating hallucinations.</p>
</div>
<section id="S6.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Data.</h4>

<div id="S6.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S6.SS0.SSS0.Px1.p1.1" class="ltx_p">We study non-factual hallucinations by GPT2-XL <span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>We encountered GPU memory issues when implementing gradient-based baselines and causal approximations on larger LMs, so here we focused on GPT2-XL and leave experiments on other LMs for future work.</span></span></span> on three datasets: 1) the <span id="S6.SS0.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_bold">ParaRel</span> dataset used in section <a href="#S4" title="4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, 2) the <span id="S6.SS0.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_bold">Natural Questions</span> dataset <cite class="ltx_cite ltx_citemacro_cite">Kwiatkowski et&nbsp;al. (<a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite> that consists of Google search engine queries annotated with answers and supporting Wikipedia pages, and 3) the <span id="S6.SS0.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_bold">TruthfulQA</span> dataset by <cite class="ltx_cite ltx_citemacro_citet">Lin et&nbsp;al. (<a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite> consisting of adversarially constructed commonsense reasoning questions to measure whether an LM is truthful in generating answers. We follow the multiple-choice evaluation scheme in question answering and ask GPT2-XL to compute the conditional log-likelihood of every candidate answer. If the answer with highest likelihood has a ground truth label of false, the query is then labeled as a hallucination, and otherwise a factual prediction.</p>
</div>
</section>
<section id="S6.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Methods.</h4>

<div id="S6.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S6.SS0.SSS0.Px2.p1.3" class="ltx_p">We study the following classification problem: given a query <math id="S6.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S6.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S6.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S6.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S6.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px2.p1.1.m1.1c">u</annotation></semantics></math> and a next-word prediction <math id="S6.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="o" display="inline"><semantics id="S6.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S6.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S6.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S6.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px2.p1.2.m2.1c">o</annotation></semantics></math> by a language model, we wish to predict whether the model is hallucinating or not. We build logistic regression models to predict model factuality based on the causal effect scores of transformer modules to the log-likelihood <math id="S6.SS0.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="\log p(o|u)" display="inline"><semantics id="S6.SS0.SSS0.Px2.p1.3.m3.1a"><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3a" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml">u</mi></mrow><mo stretchy="false" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.3" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1"><times id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.2"></times><apply id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3"><log id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px2.p1.3.m3.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px2.p1.3.m3.1c">\log p(o|u)</annotation></semantics></math> of the model predicted next token, using the same causal intervention patching method as in Section&nbsp;<a href="#S4.SS1" title="4.1 Causal tracing of factual errors ‣ 4 Mechanisms of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>. Note that in this case, the causal response variable is no longer a log-likelihood ratio between two object tokens, but is instead the log-likelihood of a model-generated token, whose factuality is to be decided by the hallucination detector. We compute the AIE for each neuron in the intermediate outputs of the attention, MLP and residual stream modules across 48 layers, and concatenate the arrays of AIE scores of three modules to get a single 4,800-dimensional feature vector. Since performing causal mediation analysis over individual neurons is very expensive, we adopt the gradient-based approximation method of causal mediation effect by <cite class="ltx_cite ltx_citemacro_cite">Nanda (<a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite> to accelerate computations<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>See Appendix <a href="#A4" title="Appendix D Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a> for details of the causal effect approximation method.</span></span></span>.</p>
</div>
</section>
<section id="S6.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Baselines.</h4>

<div id="S6.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S6.SS0.SSS0.Px3.p1.3" class="ltx_p">We also test baseline logistic regression models using a suite of non-causal internal features that have been shown to be indicative of LM hallucinations: 1) the last-layer hidden state of the last token of the input sequence, which the model uses directly to generate the next token <cite class="ltx_cite ltx_citemacro_cite">Zhou et&nbsp;al. (<a href="#bib.bib60" title="" class="ltx_ref">2021</a>)</cite>; 2) the activation values <cite class="ltx_cite ltx_citemacro_cite">Li et&nbsp;al. (<a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite>; 3) the gradients <cite class="ltx_cite ltx_citemacro_cite">De&nbsp;Cao et&nbsp;al. (<a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite> with respect to <math id="S6.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="\log p(o|u)" display="inline"><semantics id="S6.SS0.SSS0.Px3.p1.1.m1.1a"><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.cmml"><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3a" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml">u</mi></mrow><mo stretchy="false" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px3.p1.1.m1.1b"><apply id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1"><times id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.2"></times><apply id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3"><log id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.1.m1.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px3.p1.1.m1.1c">\log p(o|u)</annotation></semantics></math>; 4) the activation * gradient values <cite class="ltx_cite ltx_citemacro_cite">Tang et&nbsp;al. (<a href="#bib.bib45" title="" class="ltx_ref">2022</a>)</cite> with respect to <math id="S6.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="\log p(o|u)" display="inline"><semantics id="S6.SS0.SSS0.Px3.p1.2.m2.1a"><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.cmml"><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3a" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml">u</mi></mrow><mo stretchy="false" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1"><times id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.2"></times><apply id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3"><log id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.2.m2.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px3.p1.2.m2.1c">\log p(o|u)</annotation></semantics></math>; and 5) the Integrated Gradient <cite class="ltx_cite ltx_citemacro_cite">Sundararajan et&nbsp;al. (<a href="#bib.bib44" title="" class="ltx_ref">2017</a>)</cite> with respect to <math id="S6.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="\log p(o|u)" display="inline"><semantics id="S6.SS0.SSS0.Px3.p1.3.m3.1a"><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml"><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3a" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml">⁡</mo><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml"><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2.cmml">o</mi><mo fence="false" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3.cmml">u</mi></mrow><mo stretchy="false" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.3" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1"><times id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.2"></times><apply id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3"><log id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.1"></log><ci id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.3.2">𝑝</ci></apply><apply id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.2">𝑜</ci><ci id="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3.cmml" xref="S6.SS0.SSS0.Px3.p1.3.m3.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS0.SSS0.Px3.p1.3.m3.1c">\log p(o|u)</annotation></semantics></math>. For baselines (2)-(4), we compute features for the same set of intermediate neurons as for the causal effect-based classifiers, so that the dimensions of baseline input feature vectors are the same as the IE-based feature vectors.</p>
</div>
</section>
<section id="S6.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4>

<div id="S6.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S6.SS0.SSS0.Px4.p1.1" class="ltx_p">For each dataset, we perform a 5-fold cross-validation and compute the mean predictive accuracy of every hallucination classifier over the validation sets. Table&nbsp;<a href="#S6.T2" title="Table 2 ‣ Results. ‣ 6 Application to Hallucination Detection ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> summarizes the results. We found that the causal indirect effect features best predict model hallucinations on all datasets, consistently exceeding all baseline models. Notably, all baselines except IG only make use of internal information without input perturbations, so their inferior performance compared to AIE suggests that counterfactual interventions of model inference process in causal mediation analysis are crucial for locating crucial components of causing factual errors. The IG baseline, as suggested by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Meng et&nbsp;al. (<a href="#bib.bib31" title="" class="ltx_ref">2022a</a>)</cite>, is often over-sensitive to input textual artifacts (e.g. rare words and typos), and therefore yields much less reliable predictions on the two QA datasets with diverse input formats.</p>
</div>
<figure id="S6.T2" class="ltx_table">
<div id="S6.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:225.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(66.4pt,-40.5pt) scale(1.56315535969405,1.56315535969405) ;">
<table id="S6.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T2.1.1.1.1" class="ltx_tr">
<th id="S6.T2.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S6.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">ParaRel</th>
<th id="S6.T2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">NaturalQA</th>
<th id="S6.T2.1.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">TruthfulQA</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T2.1.1.2.1" class="ltx_tr">
<th id="S6.T2.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Random</th>
<td id="S6.T2.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">50.0</td>
<td id="S6.T2.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">50.0</td>
<td id="S6.T2.1.1.2.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">50.0</td>
</tr>
<tr id="S6.T2.1.1.3.2" class="ltx_tr">
<th id="S6.T2.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">LHS</th>
<td id="S6.T2.1.1.3.2.2" class="ltx_td ltx_align_center">62.1</td>
<td id="S6.T2.1.1.3.2.3" class="ltx_td ltx_align_center">56.6</td>
<td id="S6.T2.1.1.3.2.4" class="ltx_td ltx_nopad_r ltx_align_center">50.4</td>
</tr>
<tr id="S6.T2.1.1.4.3" class="ltx_tr">
<th id="S6.T2.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Activation</th>
<td id="S6.T2.1.1.4.3.2" class="ltx_td ltx_align_center">67.8</td>
<td id="S6.T2.1.1.4.3.3" class="ltx_td ltx_align_center">62.6</td>
<td id="S6.T2.1.1.4.3.4" class="ltx_td ltx_nopad_r ltx_align_center">52.0</td>
</tr>
<tr id="S6.T2.1.1.5.4" class="ltx_tr">
<th id="S6.T2.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Gradient</th>
<td id="S6.T2.1.1.5.4.2" class="ltx_td ltx_align_center">68.8</td>
<td id="S6.T2.1.1.5.4.3" class="ltx_td ltx_align_center">66.1</td>
<td id="S6.T2.1.1.5.4.4" class="ltx_td ltx_nopad_r ltx_align_center">53.8</td>
</tr>
<tr id="S6.T2.1.1.6.5" class="ltx_tr">
<th id="S6.T2.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Grad. X Act.</th>
<td id="S6.T2.1.1.6.5.2" class="ltx_td ltx_align_center">68.9</td>
<td id="S6.T2.1.1.6.5.3" class="ltx_td ltx_align_center">68.3</td>
<td id="S6.T2.1.1.6.5.4" class="ltx_td ltx_nopad_r ltx_align_center">60.1</td>
</tr>
<tr id="S6.T2.1.1.7.6" class="ltx_tr">
<th id="S6.T2.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">IG</th>
<td id="S6.T2.1.1.7.6.2" class="ltx_td ltx_align_center">69.9</td>
<td id="S6.T2.1.1.7.6.3" class="ltx_td ltx_align_center">67.4</td>
<td id="S6.T2.1.1.7.6.4" class="ltx_td ltx_nopad_r ltx_align_center">53.2</td>
</tr>
<tr id="S6.T2.1.1.8.7" class="ltx_tr">
<th id="S6.T2.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">Causal IE</th>
<td id="S6.T2.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T2.1.1.8.7.2.1" class="ltx_text ltx_font_bold">70.7</span></td>
<td id="S6.T2.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T2.1.1.8.7.3.1" class="ltx_text ltx_font_bold">69.8</span></td>
<td id="S6.T2.1.1.8.7.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t"><span id="S6.T2.1.1.8.7.4.1" class="ltx_text ltx_font_bold">60.8</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Mean 5-fold cross-validation accuracy of hallucination classifiers trained using various internal features on three fact query datasets.</figcaption>
</figure>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">Through interpretability analysis, we identified two causes of language model non-factual hallucinations: 1) insufficient attribute knowledge in lower layer MLPs and 2) flawed object selection in upper layer attentions and MLPs. We also revealed distinguishing properties in data and model predictions, along with divergent pre-training trajectories for the two mechanistic types of hallucination. Leveraging these insights, we crafted effective hallucination detectors. Our work establishes a mechanistic understanding of LM factual errors, and may inspire future research on explainable approaches of hallucination mitigation.</p>
</div>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Limitation</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.1" class="ltx_p">Our study bears several limitations. Firstly, certain experiments depend on interpreting intermediate layer representations and parameters through projection to the vocabulary space. While widely used, this method only approximates the encoded information of model components, particularly in early layers. Secondly, our focus on non-factual hallucinations with simple input sequences may not fully capture real-world LM behavior. Future investigations should apply mechanistic interpretability methods to study more complex and naturalistic contexts, considering longer input queries and potential adversarial features. Thirdly, we did not explore methods to reduce LM hallucinations based on insights gained from our mechanistic analysis. Future work may consider develop efficient hallucination mitigation methods by performing targeted weight editing or inference time intervention on crucial model components identified in this study.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akyürek et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Ekin Akyürek, Tolga Bolukbasi, Frederick Liu, Binbin Xiong, Ian Tenney, Jacob Andreas, and Kelvin Guu. 2022.

</span>
<span class="ltx_bibblock">Towards tracing knowledge in language models back to the training data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics: EMNLP 2022</em>, pages 2429–2446.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Stella Biderman, Hailey Schoelkopf, Quentin&nbsp;Gregory Anthony, Herbie Bradley, Kyle O’Brien, Eric Hallahan, Mohammad&nbsp;Aflah Khan, Shivanshu Purohit, USVSN&nbsp;Sai Prashanth, Edward Raff, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pages 2397–2430. PMLR.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et&nbsp;al. (2022a)</span>
<span class="ltx_bibblock">
Meng Cao, Yue Dong, and Jackie Cheung. 2022a.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2022.acl-long.236" title="" class="ltx_ref ltx_href">Hallucinated but factual! inspecting the factuality of hallucinations in abstractive summarization</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 3340–3354, Dublin, Ireland. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et&nbsp;al. (2022b)</span>
<span class="ltx_bibblock">
Meng Cao, Yue Dong, Jingyi He, and Jackie Chi&nbsp;Kit Cheung. 2022b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2022.emnlp-main.663" title="" class="ltx_ref ltx_href">Learning with rejection for abstractive text summarization</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pages 9768–9780, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Roi Cohen, May Hamri, Mor Geva, and Amir Globerson. 2023.

</span>
<span class="ltx_bibblock">Lm vs lm: Detecting factual errors via cross examination.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.13281</em>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Conmy et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Arthur Conmy, Augustine&nbsp;N Mavor-Parker, Aengus Lynch, Stefan Heimersheim, and Adrià Garriga-Alonso. 2023.

</span>
<span class="ltx_bibblock">Towards automated circuit discovery for mechanistic interpretability.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.14997</em>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Damai Dai, Li&nbsp;Dong, Yaru Hao, Zhifang Sui, Baobao Chang, and Furu Wei. 2022.

</span>
<span class="ltx_bibblock">Knowledge neurons in pretrained transformers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 8493–8502.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dar et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Guy Dar, Mor Geva, Ankit Gupta, and Jonathan Berant. 2023.

</span>
<span class="ltx_bibblock">Analyzing transformers in embedding space.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Annual Meeting of the Association for Computational Linguistics</em>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">De&nbsp;Cao et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Nicola De&nbsp;Cao, Wilker Aziz, and Ivan Titov. 2021.

</span>
<span class="ltx_bibblock">Editing factual knowledge in language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 6491–6506.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Chenhe Dong, Yinghui Li, Haifan Gong, Miaoxin Chen, Junxin Li, Ying Shen, and Min Yang. 2022.

</span>
<span class="ltx_bibblock">A survey of natural language generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys</em>, 55(8):1–38.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elaraby et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Mohamed Elaraby, Mengyin Lu, Jacob Dunn, Xueying Zhang, Yu&nbsp;Wang, and Shizhu Liu. 2023.

</span>
<span class="ltx_bibblock">Halo: Estimation and reduction of hallucinations in open-source weak large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.11764</em>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elazar et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Yanai Elazar, Nora Kassner, Shauli Ravfogel, Abhilasha Ravichander, Eduard Hovy, Hinrich Schütze, and Yoav Goldberg. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1162/tacl_a_00410" title="" class="ltx_ref ltx_href">Measuring and improving consistency in pretrained language models</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association for Computational Linguistics</em>, 9:1012–1031.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elhage et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Nelson Elhage, Neel Nanda, Catherine Olsson, Tom Henighan, Nicholas Joseph, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, Tom Conerly, Nova DasSarma, Dawn Drain, Deep Ganguli, Zac Hatfield-Dodds, Danny Hernandez, Andy Jones, Jackson Kernion, Liane Lovitt, Kamal Ndousse, Dario Amodei, Tom Brown, Jack Clark, Jared Kaplan, Sam McCandlish, and Chris Olah. 2021.

</span>
<span class="ltx_bibblock">A mathematical framework for transformer circuits.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Transformer Circuits Thread</em>.

</span>
<span class="ltx_bibblock">Https://transformer-circuits.pub/2021/framework/index.html.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finlayson et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Matthew Finlayson, Aaron Mueller, Sebastian Gehrmann, Stuart&nbsp;M Shieber, Tal Linzen, and Yonatan Belinkov. 2021.

</span>
<span class="ltx_bibblock">Causal analysis of syntactic agreement mechanisms in neural language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers)</em>, pages 1828–1843.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Mor Geva, Jasmijn Bastings, Katja Filippova, and Amir Globerson. 2023.

</span>
<span class="ltx_bibblock">Dissecting recall of factual associations in auto-regressive language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.14767</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2022a)</span>
<span class="ltx_bibblock">
Mor Geva, Avi Caciularu, Guy Dar, Paul Roit, Shoval Sadde, Micah Shlain, Bar Tamir, and Yoav Goldberg. 2022a.

</span>
<span class="ltx_bibblock">Lm-debugger: An interactive tool for inspection and intervention in transformer-based language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the The 2022 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pages 12–21.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2022b)</span>
<span class="ltx_bibblock">
Mor Geva, Avi Caciularu, Kevin Wang, and Yoav Goldberg. 2022b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2022.emnlp-main.3" title="" class="ltx_ref ltx_href">Transformer feed-forward layers build predictions by promoting concepts in the vocabulary space</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pages 30–45, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Mor Geva, Roei Schuster, Jonathan Berant, and Omer Levy. 2021.

</span>
<span class="ltx_bibblock">Transformer feed-forward layers are key-value memories.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 5484–5495.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghandeharioun et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Asma Ghandeharioun, Avi Caciularu, Adam Pearce, Lucas Dixon, and Mor Geva. 2024.

</span>
<span class="ltx_bibblock">Patchscope: A unifying framework for inspecting hidden representations of language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.06102</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haviv et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Adi Haviv, Ori Ram, Ofir Press, Peter Izsak, and Omer Levy. 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2022.findings-emnlp.99" title="" class="ltx_ref ltx_href">Transformer language models without positional encodings still learn positional information</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics: EMNLP 2022</em>, pages 1382–1390, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hernandez et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Evan Hernandez, Arnab&nbsp;Sen Sharma, Tal Haklay, Kevin Meng, Martin Wattenberg, Jacob Andreas, Yonatan Belinkov, and David Bau. 2023.

</span>
<span class="ltx_bibblock">Linearity of relation decoding in transformer language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.09124</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Ziwei Ji, Nayeon Lee, Rita Frieske, Tiezheng Yu, Dan Su, Yan Xu, Etsuko Ishii, Ye&nbsp;Jin Bang, Andrea Madotto, and Pascale Fung. 2023.

</span>
<span class="ltx_bibblock">Survey of hallucination in natural language generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys</em>, 55(12):1–38.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Zhengbao Jiang, Frank&nbsp;F Xu, Jun Araki, and Graham Neubig. 2020.

</span>
<span class="ltx_bibblock">How can we know what language models know?

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association for Computational Linguistics</em>, 8:423–438.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaddour et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Jean Kaddour, Joshua Harris, Maximilian Mozes, Herbie Bradley, Roberta Raileanu, and Robert McHardy. 2023.

</span>
<span class="ltx_bibblock">Challenges and applications of large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.10169</em>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katz et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Shahar Katz, Yonatan Belinkov, Mor Geva, and Lior Wolf. 2024.

</span>
<span class="ltx_bibblock">Backward lens: Projecting language model gradients into the vocabulary space.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.12865</em>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, et&nbsp;al. 2019.

</span>
<span class="ltx_bibblock">Natural questions: a benchmark for question answering research.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association for Computational Linguistics</em>, 7:453–466.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Kenneth Li, Oam Patel, Fernanda Viégas, Hanspeter Pfister, and Martin Wattenberg. 2023.

</span>
<span class="ltx_bibblock">Inference-time intervention: Eliciting truthful answers from a language model.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.03341</em>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Stephanie Lin, Jacob Hilton, and Owain Evans. 2022.

</span>
<span class="ltx_bibblock">Truthfulqa: Measuring how models mimic human falsehoods.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 3214–3252.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Kaiji Lu, Zifan Wang, Piotr Mardziel, and Anupam Datta. 2021.

</span>
<span class="ltx_bibblock">Influence patterns for explaining information flow in bert.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34:4461–4474.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Manakul et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Potsawee Manakul, Adian Liusie, and Mark&nbsp;JF Gales. 2023.

</span>
<span class="ltx_bibblock">Selfcheckgpt: Zero-resource black-box hallucination detection for generative large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.08896</em>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et&nbsp;al. (2022a)</span>
<span class="ltx_bibblock">
Kevin Meng, David Bau, Alex Andonian, and Yonatan Belinkov. 2022a.

</span>
<span class="ltx_bibblock">Locating and editing factual associations in gpt.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:17359–17372.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et&nbsp;al. (2022b)</span>
<span class="ltx_bibblock">
Kevin Meng, Arnab&nbsp;Sen Sharma, Alex Andonian, Yonatan Belinkov, and David Bau. 2022b.

</span>
<span class="ltx_bibblock">Mass-editing memory in a transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.07229</em>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mitchell et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Eric Mitchell, Charles Lin, Antoine Bosselut, Chelsea Finn, and Christopher&nbsp;D Manning. 2021.

</span>
<span class="ltx_bibblock">Fast model editing at scale.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mündler et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Niels Mündler, Jingxuan He, Slobodan Jenko, and Martin Vechev. 2023.

</span>
<span class="ltx_bibblock">Self-contradictory hallucinations of large language models: Evaluation, detection and mitigation.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.15852</em>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nanda (2023)</span>
<span class="ltx_bibblock">
Neel Nanda. 2023.

</span>
<span class="ltx_bibblock">Attribution patching: Activation patching at industrial scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">URL: https://www. neelnanda. io/mechanistic-interpretability/attribution-patching</em>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nanda et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Neel Nanda, Lawrence Chan, Tom Lieberum, Jess Smith, and Jacob Steinhardt. 2022.

</span>
<span class="ltx_bibblock">Progress measures for grokking via mechanistic interpretability.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">The Eleventh International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nostalgebraist (2020)</span>
<span class="ltx_bibblock">
Nostalgebraist. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://www.lesswrong.com/posts/AcKRB8wDpdaN6v6ru/interpreting-gpt-the-logit-lens" title="" class="ltx_ref ltx_href">Interpreting gpt: the logit lens</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">LESSWRONG</em>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Olah (2022)</span>
<span class="ltx_bibblock">
Chris Olah. 2022.

</span>
<span class="ltx_bibblock">Mechanistic interpretability, variables, and the importance of interpretable bases.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Transformer Circuits Thread</em>.

</span>
<span class="ltx_bibblock">Https://transformer-circuits.pub/2022/mech-interp-essay/index.html.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pearl (2001)</span>
<span class="ltx_bibblock">
Judea Pearl. 2001.

</span>
<span class="ltx_bibblock">Direct and indirect effects.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proc. of the 17th Conference on Uncertainty in Artificial Intelligence, 2001</em>, pages 411–420.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petroni et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Fabio Petroni, Tim Rocktäschel, Sebastian Riedel, Patrick Lewis, Anton Bakhtin, Yuxiang Wu, and Alexander Miller. 2019.

</span>
<span class="ltx_bibblock">Language models as knowledge bases?

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pages 2463–2473.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et&nbsp;al. 2019.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">OpenAI blog</em>, 1(8):9.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Aarohi Srivastava, Abhinav Rastogi, Abhishek Rao, Abu Awal&nbsp;Md Shoeb, Abubakar Abid, Adam Fisch, Adam&nbsp;R Brown, Adam Santoro, Aditya Gupta, Adrià Garriga-Alonso, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Beyond the imitation game: Quantifying and extrapolating the capabilities of language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Transactions on Machine Learning Research</em>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stolfo et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Alessandro Stolfo, Yonatan Belinkov, and Mrinmaya Sachan. 2023.

</span>
<span class="ltx_bibblock">A mechanistic interpretation of arithmetic reasoning in language models using causal mediation analysis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 7035–7052.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sundararajan et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
Mukund Sundararajan, Ankur Taly, and Qiqi Yan. 2017.

</span>
<span class="ltx_bibblock">Axiomatic attribution for deep networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pages 3319–3328. PMLR.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Joël Tang, Marina Fomicheva, and Lucia Specia. 2022.

</span>
<span class="ltx_bibblock">Reducing hallucinations in neural machine translation with feature attribution.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.09878</em>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Turpin et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Miles Turpin, Julian Michael, Ethan Perez, and Samuel&nbsp;R Bowman. 2023.

</span>
<span class="ltx_bibblock">Language models don’t always say what they think: Unfaithful explanations in chain-of-thought prompting.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.04388</em>.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Varshney et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Neeraj Varshney, Wenlin Yao, Hongming Zhang, Jianshu Chen, and Dong Yu. 2023.

</span>
<span class="ltx_bibblock">A stitch in time saves nine: Detecting and mitigating hallucinations of llms by validating low-confidence generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.03987</em>.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan&nbsp;N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vig et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Jesse Vig, Sebastian Gehrmann, Yonatan Belinkov, Sharon Qian, Daniel Nevo, Yaron Singer, and Stuart Shieber. 2020.

</span>
<span class="ltx_bibblock">Investigating gender bias in language models using causal mediation analysis.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:12388–12401.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wallat et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Jonas Wallat, Jaspreet Singh, and Avishek Anand. 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2020.blackboxnlp-1.17" title="" class="ltx_ref ltx_href">BERTnesia: Investigating the capture and forgetting of knowledge in BERT</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Third BlackboxNLP Workshop on Analyzing and Interpreting Neural Networks for NLP</em>, pages 174–183, Online. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Komatsuzaki (2021)</span>
<span class="ltx_bibblock">
Ben Wang and Aran Komatsuzaki. 2021.

</span>
<span class="ltx_bibblock">GPT-J-6B: A 6 Billion Parameter Autoregressive Language Model.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/kingoflolz/mesh-transformer-jax" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/kingoflolz/mesh-transformer-jax</a>.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Kevin&nbsp;Ro Wang, Alexandre Variengien, Arthur Conmy, Buck Shlegeris, and Jacob Steinhardt. 2022.

</span>
<span class="ltx_bibblock">Interpretability in the wild: a circuit for indirect object identification in gpt-2 small.

</span>
<span class="ltx_bibblock">In <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">The Eleventh International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao and Wang (2021)</span>
<span class="ltx_bibblock">
Yijun Xiao and William&nbsp;Yang Wang. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.18653/v1/2021.eacl-main.236" title="" class="ltx_ref ltx_href">On hallucination and predictive uncertainty in conditional language generation</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 16th Conference of the European Chapter of the Association for Computational Linguistics: Main Volume</em>, pages 2734–2744, Online. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Qinan Yu, Jack Merullo, and Ellie Pavlick. 2023.

</span>
<span class="ltx_bibblock">Characterizing mechanisms for factual recall in language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.15910</em>.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuksekgonul et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Mert Yuksekgonul, Varun Chandrasekaran, Erik Jones, Suriya Gunasekar, Ranjita Naik, Hamid Palangi, Ece Kamar, and Besmira Nushi. 2023.

</span>
<span class="ltx_bibblock">Attention satisfies: A constraint-satisfaction lens on factual errors of language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.15098</em>.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
Muru Zhang, Ofir Press, William Merrill, Alisa Liu, and Noah&nbsp;A Smith. 2023a.

</span>
<span class="ltx_bibblock">How language model hallucinations can snowball.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.13534</em>.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
Yue Zhang, Yafu Li, Leyang Cui, Deng Cai, Lemao Liu, Tingchen Fu, Xinting Huang, Enbo Zhao, Yu&nbsp;Zhang, Yulong Chen, et&nbsp;al. 2023b.

</span>
<span class="ltx_bibblock">Siren’s song in the ai ocean: A survey on hallucination in large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.01219</em>.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Chunting Zhou, Pengfei Liu, Puxin Xu, Srini Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, Lili Yu, et&nbsp;al. 2023.

</span>
<span class="ltx_bibblock">Lima: Less is more for alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.11206</em>.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Chunting Zhou, Graham Neubig, Jiatao Gu, Mona Diab, Francisco Guzmán, Luke Zettlemoyer, and Marjan Ghazvininejad. 2021.

</span>
<span class="ltx_bibblock">Detecting hallucinated content in conditional neural sequence generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics: ACL-IJCNLP 2021</em>, pages 1393–1404.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Dataset of Non-Factual Hallucinations</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">We follow the data construction pipeline in <cite class="ltx_cite ltx_citemacro_cite">Dai et&nbsp;al. (<a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite> to generate each of our query input sequence from an entry in ParaRel <cite class="ltx_cite ltx_citemacro_cite">Elazar et&nbsp;al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite> containing a subject-relation-object knowledge tuple (e.g. (<span id="A1.p1.1.1" class="ltx_text ltx_font_italic">Toulouse</span>, <span id="A1.p1.1.2" class="ltx_text ltx_font_italic">is twin city of</span>, <span id="A1.p1.1.3" class="ltx_text ltx_font_italic">Atlanta</span>)) which exist as entities in WikiData. Each relation has a set of prompt templates (e.g., “__ is the twin city of __”) where entities can be substituted to form full prompts (e.g., “Toulouse is the twin city of __” as a prompt that queries the object).</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.6" class="ltx_p">After generating the query dataset, we ask a language model to predict the most likely capitalized alphanumeric token <math id="A1.p2.1.m1.1" class="ltx_Math" alttext="\hat{t}" display="inline"><semantics id="A1.p2.1.m1.1a"><mover accent="true" id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml"><mi id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml">t</mi><mo id="A1.p2.1.m1.1.1.1" xref="A1.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1"><ci id="A1.p2.1.m1.1.1.1.cmml" xref="A1.p2.1.m1.1.1.1">^</ci><ci id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\hat{t}</annotation></semantics></math> to continue a given prompt <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="u" display="inline"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">u</annotation></semantics></math> that contains a subject-relation pair. We define a prediction <math id="A1.p2.3.m3.1" class="ltx_Math" alttext="\hat{t}" display="inline"><semantics id="A1.p2.3.m3.1a"><mover accent="true" id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mi id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">t</mi><mo id="A1.p2.3.m3.1.1.1" xref="A1.p2.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><ci id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1.1">^</ci><ci id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">\hat{t}</annotation></semantics></math> to be <span id="A1.p2.6.1" class="ltx_text ltx_font_bold">factual</span> if it satisfies at least one of the following two conditions: 1) it is identical to or is a prefix of the ground-truth object <math id="A1.p2.4.m4.1" class="ltx_Math" alttext="o" display="inline"><semantics id="A1.p2.4.m4.1a"><mi id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><ci id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">o</annotation></semantics></math>; 2) it is identical to or is a prefix of one of the entities returned by executing a WikiData SPARQL <span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>https://query.wikidata.org/</span></span></span> query with <math id="A1.p2.5.m5.2" class="ltx_Math" alttext="(s,r)" display="inline"><semantics id="A1.p2.5.m5.2a"><mrow id="A1.p2.5.m5.2.3.2" xref="A1.p2.5.m5.2.3.1.cmml"><mo stretchy="false" id="A1.p2.5.m5.2.3.2.1" xref="A1.p2.5.m5.2.3.1.cmml">(</mo><mi id="A1.p2.5.m5.1.1" xref="A1.p2.5.m5.1.1.cmml">s</mi><mo id="A1.p2.5.m5.2.3.2.2" xref="A1.p2.5.m5.2.3.1.cmml">,</mo><mi id="A1.p2.5.m5.2.2" xref="A1.p2.5.m5.2.2.cmml">r</mi><mo stretchy="false" id="A1.p2.5.m5.2.3.2.3" xref="A1.p2.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.5.m5.2b"><interval closure="open" id="A1.p2.5.m5.2.3.1.cmml" xref="A1.p2.5.m5.2.3.2"><ci id="A1.p2.5.m5.1.1.cmml" xref="A1.p2.5.m5.1.1">𝑠</ci><ci id="A1.p2.5.m5.2.2.cmml" xref="A1.p2.5.m5.2.2">𝑟</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.m5.2c">(s,r)</annotation></semantics></math> as inputs. In this way, we are able to address the response ambiguity issue for queries that allow multiple correct completions (e.g., “Marugame, located in, __” could be completed as either “Kagawa” or “Japan”, both outputs are factually correct). Finally, for each model, we discard those queries with no capitalized alphanumeric tokens among model predicted top-50 most likely tokens over the entire vocabulary, as we found in most of these cases the log likelihood of <math id="A1.p2.6.m6.1" class="ltx_Math" alttext="\hat{t}" display="inline"><semantics id="A1.p2.6.m6.1a"><mover accent="true" id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml"><mi id="A1.p2.6.m6.1.1.2" xref="A1.p2.6.m6.1.1.2.cmml">t</mi><mo id="A1.p2.6.m6.1.1.1" xref="A1.p2.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><apply id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1"><ci id="A1.p2.6.m6.1.1.1.cmml" xref="A1.p2.6.m6.1.1.1">^</ci><ci id="A1.p2.6.m6.1.1.2.cmml" xref="A1.p2.6.m6.1.1.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">\hat{t}</annotation></semantics></math> would become negligible. This data preprocessing pipeline yields a set of 6,097 queries for Llama-2-7b-chat, 6,809 for GPT-J, 6,401 for GPT-2-XL, and 8,345 for Pythia-1.4B.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Causal Tracing of Hallucinations</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Experiment details</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.5" class="ltx_p">In the corrupted run, we follow <cite class="ltx_cite ltx_citemacro_cite">Meng et&nbsp;al. (<a href="#bib.bib31" title="" class="ltx_ref">2022a</a>)</cite> and corrupt the embeddings of the first token of each subject by adding Gaussian noise <math id="A2.SS1.p1.1.m1.2" class="ltx_Math" alttext="\epsilon\sim\mathcal{N}(0,1)" display="inline"><semantics id="A2.SS1.p1.1.m1.2a"><mrow id="A2.SS1.p1.1.m1.2.3" xref="A2.SS1.p1.1.m1.2.3.cmml"><mi id="A2.SS1.p1.1.m1.2.3.2" xref="A2.SS1.p1.1.m1.2.3.2.cmml">ϵ</mi><mo id="A2.SS1.p1.1.m1.2.3.1" xref="A2.SS1.p1.1.m1.2.3.1.cmml">∼</mo><mrow id="A2.SS1.p1.1.m1.2.3.3" xref="A2.SS1.p1.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p1.1.m1.2.3.3.2" xref="A2.SS1.p1.1.m1.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.1.m1.2.3.3.1" xref="A2.SS1.p1.1.m1.2.3.3.1.cmml">​</mo><mrow id="A2.SS1.p1.1.m1.2.3.3.3.2" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="A2.SS1.p1.1.m1.2.3.3.3.2.1" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml">(</mo><mn id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">0</mn><mo id="A2.SS1.p1.1.m1.2.3.3.3.2.2" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml">,</mo><mn id="A2.SS1.p1.1.m1.2.2" xref="A2.SS1.p1.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="A2.SS1.p1.1.m1.2.3.3.3.2.3" xref="A2.SS1.p1.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.2b"><apply id="A2.SS1.p1.1.m1.2.3.cmml" xref="A2.SS1.p1.1.m1.2.3"><csymbol cd="latexml" id="A2.SS1.p1.1.m1.2.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.1">similar-to</csymbol><ci id="A2.SS1.p1.1.m1.2.3.2.cmml" xref="A2.SS1.p1.1.m1.2.3.2">italic-ϵ</ci><apply id="A2.SS1.p1.1.m1.2.3.3.cmml" xref="A2.SS1.p1.1.m1.2.3.3"><times id="A2.SS1.p1.1.m1.2.3.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.3.1"></times><ci id="A2.SS1.p1.1.m1.2.3.3.2.cmml" xref="A2.SS1.p1.1.m1.2.3.3.2">𝒩</ci><interval closure="open" id="A2.SS1.p1.1.m1.2.3.3.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.3.3.2"><cn type="integer" id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1">0</cn><cn type="integer" id="A2.SS1.p1.1.m1.2.2.cmml" xref="A2.SS1.p1.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.2c">\epsilon\sim\mathcal{N}(0,1)</annotation></semantics></math>. In <cite class="ltx_cite ltx_citemacro_cite">Meng et&nbsp;al. (<a href="#bib.bib31" title="" class="ltx_ref">2022a</a>)</cite>, the authors perform embedding corruption by adding a Gaussian noise with a standard deviation <math id="A2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\sigma\approx 0.15" display="inline"><semantics id="A2.SS1.p1.2.m2.1a"><mrow id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mi id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">σ</mi><mo id="A2.SS1.p1.2.m2.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.cmml">≈</mo><mn id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml">0.15</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><approx id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1"></approx><ci id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2">𝜎</ci><cn type="float" id="A2.SS1.p1.2.m2.1.1.3.cmml" xref="A2.SS1.p1.2.m2.1.1.3">0.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">\sigma\approx 0.15</annotation></semantics></math>, which is three times of the estimated the observed standard deviation of token embeddings as sampled over a body of text. However, we found this standard deviation often to be too small to significantly change the relative log likelihood of a pair of true and incorrect object, so we set <math id="A2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\sigma=1" display="inline"><semantics id="A2.SS1.p1.3.m3.1a"><mrow id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml"><mi id="A2.SS1.p1.3.m3.1.1.2" xref="A2.SS1.p1.3.m3.1.1.2.cmml">σ</mi><mo id="A2.SS1.p1.3.m3.1.1.1" xref="A2.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS1.p1.3.m3.1.1.3" xref="A2.SS1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><apply id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1"><eq id="A2.SS1.p1.3.m3.1.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1.1"></eq><ci id="A2.SS1.p1.3.m3.1.1.2.cmml" xref="A2.SS1.p1.3.m3.1.1.2">𝜎</ci><cn type="integer" id="A2.SS1.p1.3.m3.1.1.3.cmml" xref="A2.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">\sigma=1</annotation></semantics></math> instead. For each run of text, the process is repeated multiple times with different samples of corruption noise, until we get a set of 10 independently sampled noises that can reduce the relative log likelihood <math id="A2.SS1.p1.4.m4.4" class="ltx_Math" alttext="y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}" display="inline"><semantics id="A2.SS1.p1.4.m4.4a"><mrow id="A2.SS1.p1.4.m4.4.5" xref="A2.SS1.p1.4.m4.4.5.cmml"><mi id="A2.SS1.p1.4.m4.4.5.2" xref="A2.SS1.p1.4.m4.4.5.2.cmml">y</mi><mo id="A2.SS1.p1.4.m4.4.5.1" xref="A2.SS1.p1.4.m4.4.5.1.cmml">=</mo><mrow id="A2.SS1.p1.4.m4.4.5.3" xref="A2.SS1.p1.4.m4.4.5.3.cmml"><mi id="A2.SS1.p1.4.m4.4.5.3.1" xref="A2.SS1.p1.4.m4.4.5.3.1.cmml">log</mi><mo lspace="0.167em" id="A2.SS1.p1.4.m4.4.5.3a" xref="A2.SS1.p1.4.m4.4.5.3.cmml">⁡</mo><mfrac id="A2.SS1.p1.4.m4.4.4" xref="A2.SS1.p1.4.m4.4.4.cmml"><mrow id="A2.SS1.p1.4.m4.2.2.2" xref="A2.SS1.p1.4.m4.2.2.2.cmml"><mi id="A2.SS1.p1.4.m4.2.2.2.4" xref="A2.SS1.p1.4.m4.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.4.m4.2.2.2.3" xref="A2.SS1.p1.4.m4.2.2.2.3.cmml">​</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml"><mo stretchy="false" id="A2.SS1.p1.4.m4.2.2.2.2.1.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml">(</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml"><msup id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2.cmml">o</mi><mo id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.1.cmml">|</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mi id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1.cmml">​</mo><mrow id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.3.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml"><mo stretchy="false" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.3.2.1" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml">(</mo><mi id="A2.SS1.p1.4.m4.1.1.1.1" xref="A2.SS1.p1.4.m4.1.1.1.1.cmml">u</mi><mo stretchy="false" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.3.2.2" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="A2.SS1.p1.4.m4.2.2.2.2.1.3" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.SS1.p1.4.m4.4.4.4" xref="A2.SS1.p1.4.m4.4.4.4.cmml"><mi id="A2.SS1.p1.4.m4.4.4.4.4" xref="A2.SS1.p1.4.m4.4.4.4.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.4.m4.4.4.4.3" xref="A2.SS1.p1.4.m4.4.4.4.3.cmml">​</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml"><mo stretchy="false" id="A2.SS1.p1.4.m4.4.4.4.2.1.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml">(</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml"><mi id="A2.SS1.p1.4.m4.4.4.4.2.1.1.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.2.cmml">o</mi><mo fence="false" id="A2.SS1.p1.4.m4.4.4.4.2.1.1.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.1.cmml">|</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mi id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1.cmml">​</mo><mrow id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.3.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml"><mo stretchy="false" id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.3.2.1" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml">(</mo><mi id="A2.SS1.p1.4.m4.3.3.3.1" xref="A2.SS1.p1.4.m4.3.3.3.1.cmml">u</mi><mo stretchy="false" id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.3.2.2" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="A2.SS1.p1.4.m4.4.4.4.2.1.3" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.4b"><apply id="A2.SS1.p1.4.m4.4.5.cmml" xref="A2.SS1.p1.4.m4.4.5"><eq id="A2.SS1.p1.4.m4.4.5.1.cmml" xref="A2.SS1.p1.4.m4.4.5.1"></eq><ci id="A2.SS1.p1.4.m4.4.5.2.cmml" xref="A2.SS1.p1.4.m4.4.5.2">𝑦</ci><apply id="A2.SS1.p1.4.m4.4.5.3.cmml" xref="A2.SS1.p1.4.m4.4.5.3"><log id="A2.SS1.p1.4.m4.4.5.3.1.cmml" xref="A2.SS1.p1.4.m4.4.5.3.1"></log><apply id="A2.SS1.p1.4.m4.4.4.cmml" xref="A2.SS1.p1.4.m4.4.4"><divide id="A2.SS1.p1.4.m4.4.4.5.cmml" xref="A2.SS1.p1.4.m4.4.4"></divide><apply id="A2.SS1.p1.4.m4.2.2.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2"><times id="A2.SS1.p1.4.m4.2.2.2.3.cmml" xref="A2.SS1.p1.4.m4.2.2.2.3"></times><ci id="A2.SS1.p1.4.m4.2.2.2.4.cmml" xref="A2.SS1.p1.4.m4.2.2.2.4">𝑝</ci><apply id="A2.SS1.p1.4.m4.2.2.2.2.1.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.1">conditional</csymbol><apply id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2">superscript</csymbol><ci id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.2">𝑜</ci><ci id="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.2.3">′</ci></apply><apply id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3"><times id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.1"></times><ci id="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2.cmml" xref="A2.SS1.p1.4.m4.2.2.2.2.1.1.3.2">𝐸</ci><ci id="A2.SS1.p1.4.m4.1.1.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1.1.1">𝑢</ci></apply></apply></apply><apply id="A2.SS1.p1.4.m4.4.4.4.cmml" xref="A2.SS1.p1.4.m4.4.4.4"><times id="A2.SS1.p1.4.m4.4.4.4.3.cmml" xref="A2.SS1.p1.4.m4.4.4.4.3"></times><ci id="A2.SS1.p1.4.m4.4.4.4.4.cmml" xref="A2.SS1.p1.4.m4.4.4.4.4">𝑝</ci><apply id="A2.SS1.p1.4.m4.4.4.4.2.1.1.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1"><csymbol cd="latexml" id="A2.SS1.p1.4.m4.4.4.4.2.1.1.1.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.1">conditional</csymbol><ci id="A2.SS1.p1.4.m4.4.4.4.2.1.1.2.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.2">𝑜</ci><apply id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3"><times id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.1"></times><ci id="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2.cmml" xref="A2.SS1.p1.4.m4.4.4.4.2.1.1.3.2">𝐸</ci><ci id="A2.SS1.p1.4.m4.3.3.3.1.cmml" xref="A2.SS1.p1.4.m4.3.3.3.1">𝑢</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.4c">y=\log\frac{p(o^{\prime}|E(u))}{p(o|E(u))}</annotation></semantics></math>. We found that on average, about 71.1% of the sampled noises reduces <math id="A2.SS1.p1.5.m5.1" class="ltx_Math" alttext="y" display="inline"><semantics id="A2.SS1.p1.5.m5.1a"><mi id="A2.SS1.p1.5.m5.1.1" xref="A2.SS1.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.5.m5.1b"><ci id="A2.SS1.p1.5.m5.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.5.m5.1c">y</annotation></semantics></math> (i.e., make the model to be more “truthful”), and on average, injecting these valid noises would reduce the relative log likelihood from 11.7 to 2.3.</p>
</div>
<figure id="A2.T3" class="ltx_table">
<div id="A2.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:85.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-101.8pt,20.1pt) scale(0.680542823623417,0.680542823623417) ;">
<table id="A2.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T3.1.1.1.1" class="ltx_tr">
<th id="A2.T3.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">prompt</th>
<th id="A2.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">subject</th>
<th id="A2.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">relation</th>
<th id="A2.T3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">true object</th>
<th id="A2.T3.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">predicted object</th>
<th id="A2.T3.1.1.1.1.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">hallucination mechanism</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T3.1.1.2.1" class="ltx_tr">
<th id="A2.T3.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Korrespodent is formed in</th>
<td id="A2.T3.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">Korrespodent</td>
<td id="A2.T3.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">country of origin</td>
<td id="A2.T3.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">Ukraine</td>
<td id="A2.T3.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">April</td>
<td id="A2.T3.1.1.2.1.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">early-site</td>
</tr>
<tr id="A2.T3.1.1.3.2" class="ltx_tr">
<th id="A2.T3.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Mantecadas, that was created in</th>
<td id="A2.T3.1.1.3.2.2" class="ltx_td ltx_align_center">Mantacedas</td>
<td id="A2.T3.1.1.3.2.3" class="ltx_td ltx_align_center">country of origin</td>
<td id="A2.T3.1.1.3.2.4" class="ltx_td ltx_align_center">Spain</td>
<td id="A2.T3.1.1.3.2.5" class="ltx_td ltx_align_center">Japan</td>
<td id="A2.T3.1.1.3.2.6" class="ltx_td ltx_nopad_r ltx_align_center">early-site</td>
</tr>
<tr id="A2.T3.1.1.4.3" class="ltx_tr">
<th id="A2.T3.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Asprey’s headquarters are in</th>
<td id="A2.T3.1.1.4.3.2" class="ltx_td ltx_align_center">Asprey</td>
<td id="A2.T3.1.1.4.3.3" class="ltx_td ltx_align_center">headquarters location</td>
<td id="A2.T3.1.1.4.3.4" class="ltx_td ltx_align_center">London</td>
<td id="A2.T3.1.1.4.3.5" class="ltx_td ltx_align_center">New</td>
<td id="A2.T3.1.1.4.3.6" class="ltx_td ltx_nopad_r ltx_align_center">early-site</td>
</tr>
<tr id="A2.T3.1.1.5.4" class="ltx_tr">
<th id="A2.T3.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Opgezwolle was developed in</th>
<td id="A2.T3.1.1.5.4.2" class="ltx_td ltx_align_center">Opgezwolle</td>
<td id="A2.T3.1.1.5.4.3" class="ltx_td ltx_align_center">country of origin</td>
<td id="A2.T3.1.1.5.4.4" class="ltx_td ltx_align_center">Netherlands</td>
<td id="A2.T3.1.1.5.4.5" class="ltx_td ltx_align_center">Belgium</td>
<td id="A2.T3.1.1.5.4.6" class="ltx_td ltx_nopad_r ltx_align_center">late-site</td>
</tr>
<tr id="A2.T3.1.1.6.5" class="ltx_tr">
<th id="A2.T3.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Israel maintains diplomatic relations with</th>
<td id="A2.T3.1.1.6.5.2" class="ltx_td ltx_align_center">Israel</td>
<td id="A2.T3.1.1.6.5.3" class="ltx_td ltx_align_center">diplomatic relation</td>
<td id="A2.T3.1.1.6.5.4" class="ltx_td ltx_align_center">India</td>
<td id="A2.T3.1.1.6.5.5" class="ltx_td ltx_align_center">Israel</td>
<td id="A2.T3.1.1.6.5.6" class="ltx_td ltx_nopad_r ltx_align_center">late-site</td>
</tr>
<tr id="A2.T3.1.1.7.6" class="ltx_tr">
<th id="A2.T3.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Germany shares its border with</th>
<td id="A2.T3.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_bb">Germany</td>
<td id="A2.T3.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_bb">shares border with</td>
<td id="A2.T3.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_bb">Luxemburg</td>
<td id="A2.T3.1.1.7.6.5" class="ltx_td ltx_align_center ltx_border_bb">Russia</td>
<td id="A2.T3.1.1.7.6.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">late-site</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Examples of early-site and late-site hallucinations made by GPT-2-XL.</figcaption>
</figure>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Causal tracing results on GPTs</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.1" class="ltx_p">Figure <a href="#A2.F6" title="Figure 6 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and <a href="#A2.F9" title="Figure 9 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> show the causal AIE distributions for GPT-2-XL and GPT-J on their hallucinating answers on Pararel, respectively. We observe that similar to the case of Llama-2-7b, most causally contributive hidden representations are produced by model components of subject tokens on early-site layers and relation tokens on late-site layers. Figure <a href="#A2.F7" title="Figure 7 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> and <a href="#A2.F10" title="Figure 10 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> further shows the breakdown AIE distributions for early-site and late-site hallucinations by two GPT models, using the same categorization metric of relative IE as for Llama-2-7b. Again, we found that early-site hallucinations are mostly caused by MLP modules in lower layers when enriching the subject tokens, while late-site hallucinations can be largely attributed to failures by upper layer attentions and MLPs when processing the relation tokens.</p>
</div>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Examples of early-site and late-site hallucinations</h3>

<div id="A2.SS3.p1" class="ltx_para">
<p id="A2.SS3.p1.1" class="ltx_p">Table <a href="#A2.T3" title="Table 3 ‣ B.1 Experiment details ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> presents several examples randomly drawn from the sets of early-site and late-site hallucinations made by GPT-2-XL. We found that in many examples of late-site hallucinations, the model tends to ignore the relational information in inputs and output an object entity that is highly associated with the subject – in some cases, the model even predicts the subject itself as a continuation. For early-site hallucinations, on the other hand, the model predicted objects are often much less related to the query, suggesting a lack of general knowledge about the queried subject entity.</p>
</div>
</section>
<section id="A2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Embedding space projection results on GPTs</h3>

<div id="A2.SS4.p1" class="ltx_para">
<p id="A2.SS4.p1.1" class="ltx_p">Figure <a href="#A2.F8" title="Figure 8 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and <a href="#A2.F11" title="Figure 11 ‣ B.4 Embedding space projection results on GPTs ‣ Appendix B Causal Tracing of Hallucinations ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> show the embedding space projection results for factually correct answers, early-site hallucinations and late-site hallucinations made by GPT-2-XL and GPT-J. Again, we observe that the layerwise MLP contribution profile to true answer is very similar for late-site hallucinations and factual predictions, suggesting that for some cases of factual errors, early-site MLPs are still functioning properly. In contrast, the contribution profile of attention components for factual answers differs significantly from hallucinating answers, indicating that for both types of hallucinations, the upper layer attention heads fail to select the object entities that are most relevant to the query subject.</p>
</div>
<figure id="A2.F6" class="ltx_figure"><img src="/html/2403.18167/assets/x7.png" id="A2.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="77" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="A2.F6.2.1" class="ltx_text ltx_font_bold">Average Indirect Effect (AIE)</span> of individual model components to non-factual hallucinations over ParaRel queries that are incorrectly answered by GPT-2-XL.</figcaption>
</figure>
<figure id="A2.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.18167/assets/x8.png" id="A2.F7.sf1.g1" class="ltx_graphics ltx_img_square" width="461" height="477" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Early-site hallucinations (<math id="A2.F7.sf1.2.m1.2" class="ltx_Math" alttext="\Delta\text{AIE}(y,u)<0" display="inline"><semantics id="A2.F7.sf1.2.m1.2b"><mrow id="A2.F7.sf1.2.m1.2.3" xref="A2.F7.sf1.2.m1.2.3.cmml"><mrow id="A2.F7.sf1.2.m1.2.3.2" xref="A2.F7.sf1.2.m1.2.3.2.cmml"><mi mathvariant="normal" id="A2.F7.sf1.2.m1.2.3.2.2" xref="A2.F7.sf1.2.m1.2.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A2.F7.sf1.2.m1.2.3.2.1" xref="A2.F7.sf1.2.m1.2.3.2.1.cmml">​</mo><mtext id="A2.F7.sf1.2.m1.2.3.2.3" xref="A2.F7.sf1.2.m1.2.3.2.3a.cmml">AIE</mtext><mo lspace="0em" rspace="0em" id="A2.F7.sf1.2.m1.2.3.2.1b" xref="A2.F7.sf1.2.m1.2.3.2.1.cmml">​</mo><mrow id="A2.F7.sf1.2.m1.2.3.2.4.2" xref="A2.F7.sf1.2.m1.2.3.2.4.1.cmml"><mo stretchy="false" id="A2.F7.sf1.2.m1.2.3.2.4.2.1" xref="A2.F7.sf1.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F7.sf1.2.m1.1.1" xref="A2.F7.sf1.2.m1.1.1.cmml">y</mi><mo id="A2.F7.sf1.2.m1.2.3.2.4.2.2" xref="A2.F7.sf1.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F7.sf1.2.m1.2.2" xref="A2.F7.sf1.2.m1.2.2.cmml">u</mi><mo stretchy="false" id="A2.F7.sf1.2.m1.2.3.2.4.2.3" xref="A2.F7.sf1.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F7.sf1.2.m1.2.3.1" xref="A2.F7.sf1.2.m1.2.3.1.cmml">&lt;</mo><mn id="A2.F7.sf1.2.m1.2.3.3" xref="A2.F7.sf1.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F7.sf1.2.m1.2c"><apply id="A2.F7.sf1.2.m1.2.3.cmml" xref="A2.F7.sf1.2.m1.2.3"><lt id="A2.F7.sf1.2.m1.2.3.1.cmml" xref="A2.F7.sf1.2.m1.2.3.1"></lt><apply id="A2.F7.sf1.2.m1.2.3.2.cmml" xref="A2.F7.sf1.2.m1.2.3.2"><times id="A2.F7.sf1.2.m1.2.3.2.1.cmml" xref="A2.F7.sf1.2.m1.2.3.2.1"></times><ci id="A2.F7.sf1.2.m1.2.3.2.2.cmml" xref="A2.F7.sf1.2.m1.2.3.2.2">Δ</ci><ci id="A2.F7.sf1.2.m1.2.3.2.3a.cmml" xref="A2.F7.sf1.2.m1.2.3.2.3"><mtext id="A2.F7.sf1.2.m1.2.3.2.3.cmml" xref="A2.F7.sf1.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F7.sf1.2.m1.2.3.2.4.1.cmml" xref="A2.F7.sf1.2.m1.2.3.2.4.2"><ci id="A2.F7.sf1.2.m1.1.1.cmml" xref="A2.F7.sf1.2.m1.1.1">𝑦</ci><ci id="A2.F7.sf1.2.m1.2.2.cmml" xref="A2.F7.sf1.2.m1.2.2">𝑢</ci></interval></apply><cn type="integer" id="A2.F7.sf1.2.m1.2.3.3.cmml" xref="A2.F7.sf1.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.sf1.2.m1.2d">\Delta\text{AIE}(y,u)&lt;0</annotation></semantics></math>).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.18167/assets/x9.png" id="A2.F7.sf2.g1" class="ltx_graphics ltx_img_square" width="461" height="477" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Late-site hallucinations (<math id="A2.F7.sf2.2.m1.2" class="ltx_Math" alttext="\Delta\text{AIE}(y,u)\geq 0" display="inline"><semantics id="A2.F7.sf2.2.m1.2b"><mrow id="A2.F7.sf2.2.m1.2.3" xref="A2.F7.sf2.2.m1.2.3.cmml"><mrow id="A2.F7.sf2.2.m1.2.3.2" xref="A2.F7.sf2.2.m1.2.3.2.cmml"><mi mathvariant="normal" id="A2.F7.sf2.2.m1.2.3.2.2" xref="A2.F7.sf2.2.m1.2.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A2.F7.sf2.2.m1.2.3.2.1" xref="A2.F7.sf2.2.m1.2.3.2.1.cmml">​</mo><mtext id="A2.F7.sf2.2.m1.2.3.2.3" xref="A2.F7.sf2.2.m1.2.3.2.3a.cmml">AIE</mtext><mo lspace="0em" rspace="0em" id="A2.F7.sf2.2.m1.2.3.2.1b" xref="A2.F7.sf2.2.m1.2.3.2.1.cmml">​</mo><mrow id="A2.F7.sf2.2.m1.2.3.2.4.2" xref="A2.F7.sf2.2.m1.2.3.2.4.1.cmml"><mo stretchy="false" id="A2.F7.sf2.2.m1.2.3.2.4.2.1" xref="A2.F7.sf2.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F7.sf2.2.m1.1.1" xref="A2.F7.sf2.2.m1.1.1.cmml">y</mi><mo id="A2.F7.sf2.2.m1.2.3.2.4.2.2" xref="A2.F7.sf2.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F7.sf2.2.m1.2.2" xref="A2.F7.sf2.2.m1.2.2.cmml">u</mi><mo stretchy="false" id="A2.F7.sf2.2.m1.2.3.2.4.2.3" xref="A2.F7.sf2.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F7.sf2.2.m1.2.3.1" xref="A2.F7.sf2.2.m1.2.3.1.cmml">≥</mo><mn id="A2.F7.sf2.2.m1.2.3.3" xref="A2.F7.sf2.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F7.sf2.2.m1.2c"><apply id="A2.F7.sf2.2.m1.2.3.cmml" xref="A2.F7.sf2.2.m1.2.3"><geq id="A2.F7.sf2.2.m1.2.3.1.cmml" xref="A2.F7.sf2.2.m1.2.3.1"></geq><apply id="A2.F7.sf2.2.m1.2.3.2.cmml" xref="A2.F7.sf2.2.m1.2.3.2"><times id="A2.F7.sf2.2.m1.2.3.2.1.cmml" xref="A2.F7.sf2.2.m1.2.3.2.1"></times><ci id="A2.F7.sf2.2.m1.2.3.2.2.cmml" xref="A2.F7.sf2.2.m1.2.3.2.2">Δ</ci><ci id="A2.F7.sf2.2.m1.2.3.2.3a.cmml" xref="A2.F7.sf2.2.m1.2.3.2.3"><mtext id="A2.F7.sf2.2.m1.2.3.2.3.cmml" xref="A2.F7.sf2.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F7.sf2.2.m1.2.3.2.4.1.cmml" xref="A2.F7.sf2.2.m1.2.3.2.4.2"><ci id="A2.F7.sf2.2.m1.1.1.cmml" xref="A2.F7.sf2.2.m1.1.1">𝑦</ci><ci id="A2.F7.sf2.2.m1.2.2.cmml" xref="A2.F7.sf2.2.m1.2.2">𝑢</ci></interval></apply><cn type="integer" id="A2.F7.sf2.2.m1.2.3.3.cmml" xref="A2.F7.sf2.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.sf2.2.m1.2d">\Delta\text{AIE}(y,u)\geq 0</annotation></semantics></math>).</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span id="A2.F7.2.1" class="ltx_text ltx_font_bold">Average Indirect Effect (AIE)</span> of individual model components of GPT-2-XL for (a) early-site (left column) and (b) late-site (right column) non-factual hallucinations. </figcaption>
</figure>
<figure id="A2.F8" class="ltx_figure"><img src="/html/2403.18167/assets/x10.png" id="A2.F8.g1" class="ltx_graphics ltx_centering ltx_img_square" width="437" height="496" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Average dot product between true object embedding and GPT-2-XL intermediate outputs in each layer.</figcaption>
</figure>
<figure id="A2.F9" class="ltx_figure"><img src="/html/2403.18167/assets/x11.png" id="A2.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="86" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span id="A2.F9.4.1" class="ltx_text ltx_font_bold">Average Indirect Effect (AIE)</span> of individual model components to non-factual hallucinations over 6,809 ParaRel queries that are incorrectly answered by GPT-J. <math id="A2.F9.2.m1.2" class="ltx_Math" alttext="\Delta\text{AIE}(y,u)" display="inline"><semantics id="A2.F9.2.m1.2b"><mrow id="A2.F9.2.m1.2.3" xref="A2.F9.2.m1.2.3.cmml"><mi mathvariant="normal" id="A2.F9.2.m1.2.3.2" xref="A2.F9.2.m1.2.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A2.F9.2.m1.2.3.1" xref="A2.F9.2.m1.2.3.1.cmml">​</mo><mtext id="A2.F9.2.m1.2.3.3" xref="A2.F9.2.m1.2.3.3a.cmml">AIE</mtext><mo lspace="0em" rspace="0em" id="A2.F9.2.m1.2.3.1b" xref="A2.F9.2.m1.2.3.1.cmml">​</mo><mrow id="A2.F9.2.m1.2.3.4.2" xref="A2.F9.2.m1.2.3.4.1.cmml"><mo stretchy="false" id="A2.F9.2.m1.2.3.4.2.1" xref="A2.F9.2.m1.2.3.4.1.cmml">(</mo><mi id="A2.F9.2.m1.1.1" xref="A2.F9.2.m1.1.1.cmml">y</mi><mo id="A2.F9.2.m1.2.3.4.2.2" xref="A2.F9.2.m1.2.3.4.1.cmml">,</mo><mi id="A2.F9.2.m1.2.2" xref="A2.F9.2.m1.2.2.cmml">u</mi><mo stretchy="false" id="A2.F9.2.m1.2.3.4.2.3" xref="A2.F9.2.m1.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F9.2.m1.2c"><apply id="A2.F9.2.m1.2.3.cmml" xref="A2.F9.2.m1.2.3"><times id="A2.F9.2.m1.2.3.1.cmml" xref="A2.F9.2.m1.2.3.1"></times><ci id="A2.F9.2.m1.2.3.2.cmml" xref="A2.F9.2.m1.2.3.2">Δ</ci><ci id="A2.F9.2.m1.2.3.3a.cmml" xref="A2.F9.2.m1.2.3.3"><mtext id="A2.F9.2.m1.2.3.3.cmml" xref="A2.F9.2.m1.2.3.3">AIE</mtext></ci><interval closure="open" id="A2.F9.2.m1.2.3.4.1.cmml" xref="A2.F9.2.m1.2.3.4.2"><ci id="A2.F9.2.m1.1.1.cmml" xref="A2.F9.2.m1.1.1">𝑦</ci><ci id="A2.F9.2.m1.2.2.cmml" xref="A2.F9.2.m1.2.2">𝑢</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.2.m1.2d">\Delta\text{AIE}(y,u)</annotation></semantics></math> is defined as the difference in AIE between 1) the attention outputs of the last 14 out of 28 transformer layers and 2) the MLP outputs of the first 14 out of 28 transformer layers of GPT-J.</figcaption>
</figure>
<figure id="A2.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F10.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.18167/assets/x12.png" id="A2.F10.sf1.g1" class="ltx_graphics ltx_img_square" width="461" height="473" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Early-site hallucinations (<math id="A2.F10.sf1.2.m1.2" class="ltx_Math" alttext="\Delta\text{AIE}(y,u)<0" display="inline"><semantics id="A2.F10.sf1.2.m1.2b"><mrow id="A2.F10.sf1.2.m1.2.3" xref="A2.F10.sf1.2.m1.2.3.cmml"><mrow id="A2.F10.sf1.2.m1.2.3.2" xref="A2.F10.sf1.2.m1.2.3.2.cmml"><mi mathvariant="normal" id="A2.F10.sf1.2.m1.2.3.2.2" xref="A2.F10.sf1.2.m1.2.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A2.F10.sf1.2.m1.2.3.2.1" xref="A2.F10.sf1.2.m1.2.3.2.1.cmml">​</mo><mtext id="A2.F10.sf1.2.m1.2.3.2.3" xref="A2.F10.sf1.2.m1.2.3.2.3a.cmml">AIE</mtext><mo lspace="0em" rspace="0em" id="A2.F10.sf1.2.m1.2.3.2.1b" xref="A2.F10.sf1.2.m1.2.3.2.1.cmml">​</mo><mrow id="A2.F10.sf1.2.m1.2.3.2.4.2" xref="A2.F10.sf1.2.m1.2.3.2.4.1.cmml"><mo stretchy="false" id="A2.F10.sf1.2.m1.2.3.2.4.2.1" xref="A2.F10.sf1.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F10.sf1.2.m1.1.1" xref="A2.F10.sf1.2.m1.1.1.cmml">y</mi><mo id="A2.F10.sf1.2.m1.2.3.2.4.2.2" xref="A2.F10.sf1.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F10.sf1.2.m1.2.2" xref="A2.F10.sf1.2.m1.2.2.cmml">u</mi><mo stretchy="false" id="A2.F10.sf1.2.m1.2.3.2.4.2.3" xref="A2.F10.sf1.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F10.sf1.2.m1.2.3.1" xref="A2.F10.sf1.2.m1.2.3.1.cmml">&lt;</mo><mn id="A2.F10.sf1.2.m1.2.3.3" xref="A2.F10.sf1.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F10.sf1.2.m1.2c"><apply id="A2.F10.sf1.2.m1.2.3.cmml" xref="A2.F10.sf1.2.m1.2.3"><lt id="A2.F10.sf1.2.m1.2.3.1.cmml" xref="A2.F10.sf1.2.m1.2.3.1"></lt><apply id="A2.F10.sf1.2.m1.2.3.2.cmml" xref="A2.F10.sf1.2.m1.2.3.2"><times id="A2.F10.sf1.2.m1.2.3.2.1.cmml" xref="A2.F10.sf1.2.m1.2.3.2.1"></times><ci id="A2.F10.sf1.2.m1.2.3.2.2.cmml" xref="A2.F10.sf1.2.m1.2.3.2.2">Δ</ci><ci id="A2.F10.sf1.2.m1.2.3.2.3a.cmml" xref="A2.F10.sf1.2.m1.2.3.2.3"><mtext id="A2.F10.sf1.2.m1.2.3.2.3.cmml" xref="A2.F10.sf1.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F10.sf1.2.m1.2.3.2.4.1.cmml" xref="A2.F10.sf1.2.m1.2.3.2.4.2"><ci id="A2.F10.sf1.2.m1.1.1.cmml" xref="A2.F10.sf1.2.m1.1.1">𝑦</ci><ci id="A2.F10.sf1.2.m1.2.2.cmml" xref="A2.F10.sf1.2.m1.2.2">𝑢</ci></interval></apply><cn type="integer" id="A2.F10.sf1.2.m1.2.3.3.cmml" xref="A2.F10.sf1.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F10.sf1.2.m1.2d">\Delta\text{AIE}(y,u)&lt;0</annotation></semantics></math>)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F10.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="" id="A2.F10.sf2.g1" class="ltx_graphics ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Late-site hallucinations (<math id="A2.F10.sf2.2.m1.2" class="ltx_Math" alttext="\Delta\text{AIE}(y,u)\geq 0" display="inline"><semantics id="A2.F10.sf2.2.m1.2b"><mrow id="A2.F10.sf2.2.m1.2.3" xref="A2.F10.sf2.2.m1.2.3.cmml"><mrow id="A2.F10.sf2.2.m1.2.3.2" xref="A2.F10.sf2.2.m1.2.3.2.cmml"><mi mathvariant="normal" id="A2.F10.sf2.2.m1.2.3.2.2" xref="A2.F10.sf2.2.m1.2.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A2.F10.sf2.2.m1.2.3.2.1" xref="A2.F10.sf2.2.m1.2.3.2.1.cmml">​</mo><mtext id="A2.F10.sf2.2.m1.2.3.2.3" xref="A2.F10.sf2.2.m1.2.3.2.3a.cmml">AIE</mtext><mo lspace="0em" rspace="0em" id="A2.F10.sf2.2.m1.2.3.2.1b" xref="A2.F10.sf2.2.m1.2.3.2.1.cmml">​</mo><mrow id="A2.F10.sf2.2.m1.2.3.2.4.2" xref="A2.F10.sf2.2.m1.2.3.2.4.1.cmml"><mo stretchy="false" id="A2.F10.sf2.2.m1.2.3.2.4.2.1" xref="A2.F10.sf2.2.m1.2.3.2.4.1.cmml">(</mo><mi id="A2.F10.sf2.2.m1.1.1" xref="A2.F10.sf2.2.m1.1.1.cmml">y</mi><mo id="A2.F10.sf2.2.m1.2.3.2.4.2.2" xref="A2.F10.sf2.2.m1.2.3.2.4.1.cmml">,</mo><mi id="A2.F10.sf2.2.m1.2.2" xref="A2.F10.sf2.2.m1.2.2.cmml">u</mi><mo stretchy="false" id="A2.F10.sf2.2.m1.2.3.2.4.2.3" xref="A2.F10.sf2.2.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow><mo id="A2.F10.sf2.2.m1.2.3.1" xref="A2.F10.sf2.2.m1.2.3.1.cmml">≥</mo><mn id="A2.F10.sf2.2.m1.2.3.3" xref="A2.F10.sf2.2.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F10.sf2.2.m1.2c"><apply id="A2.F10.sf2.2.m1.2.3.cmml" xref="A2.F10.sf2.2.m1.2.3"><geq id="A2.F10.sf2.2.m1.2.3.1.cmml" xref="A2.F10.sf2.2.m1.2.3.1"></geq><apply id="A2.F10.sf2.2.m1.2.3.2.cmml" xref="A2.F10.sf2.2.m1.2.3.2"><times id="A2.F10.sf2.2.m1.2.3.2.1.cmml" xref="A2.F10.sf2.2.m1.2.3.2.1"></times><ci id="A2.F10.sf2.2.m1.2.3.2.2.cmml" xref="A2.F10.sf2.2.m1.2.3.2.2">Δ</ci><ci id="A2.F10.sf2.2.m1.2.3.2.3a.cmml" xref="A2.F10.sf2.2.m1.2.3.2.3"><mtext id="A2.F10.sf2.2.m1.2.3.2.3.cmml" xref="A2.F10.sf2.2.m1.2.3.2.3">AIE</mtext></ci><interval closure="open" id="A2.F10.sf2.2.m1.2.3.2.4.1.cmml" xref="A2.F10.sf2.2.m1.2.3.2.4.2"><ci id="A2.F10.sf2.2.m1.1.1.cmml" xref="A2.F10.sf2.2.m1.1.1">𝑦</ci><ci id="A2.F10.sf2.2.m1.2.2.cmml" xref="A2.F10.sf2.2.m1.2.2">𝑢</ci></interval></apply><cn type="integer" id="A2.F10.sf2.2.m1.2.3.3.cmml" xref="A2.F10.sf2.2.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F10.sf2.2.m1.2d">\Delta\text{AIE}(y,u)\geq 0</annotation></semantics></math>)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span id="A2.F10.2.1" class="ltx_text ltx_font_bold">Average Indirect Effect (AIE)</span> of individual model components of GPT-J for (a) early-site (left column) and (b) late-site (right column) non-factual hallucinations. </figcaption>
</figure>
<figure id="A2.F11" class="ltx_figure"><img src="/html/2403.18167/assets/x14.png" id="A2.F11.g1" class="ltx_graphics ltx_centering ltx_img_square" width="438" height="490" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Average dot product between true object embedding and GPT-J intermediate outputs in each layer.</figcaption>
</figure>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Evaluation of Pythia Models</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">We evaluate Pythia-1.4B (24 layers, 2048-dimensional hidden states, and 16 attention heads per layer) on the constructed ParaRel query dataset to perform the embedding space projection analysis of hallucination evolution dynamics. Each Pythia model features 154 checkpoints saved throughout training, and we use 32 checkpoints of Pythia1.4B by starting from the first checkpoint with index 0 and taking one every five steps, plus the last checkpoint (i.e. checkpoint-0, checkpoint-5, checkpoint-10,…,checkpoint-150, checkpoint-153). To classify the mechanism of each hallucinating query, we run the three-step causal mediation analysis on checkpoint-153 of Pythia-1.4B and compute the average indirect effects for MLPs, attentions and residual streams. Same as GPT-2-XL experiments, we corrupt input queries by injecting standard Gaussian noises into the first subject token, and take for each query 10 independently sampled noise that reduce the relative object likelihood <math id="A3.p1.1.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">y</annotation></semantics></math>.</p>
</div>
<figure id="A3.T4" class="ltx_table">
<div id="A3.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:69pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-66.3pt,13.2pt) scale(0.723329542901977,0.723329542901977) ;">
<table id="A3.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T4.1.1.1.1" class="ltx_tr">
<th id="A3.T4.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">Question</th>
<th id="A3.T4.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">True answers</th>
<th id="A3.T4.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">False answer</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T4.1.1.2.1" class="ltx_tr">
<th id="A3.T4.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">who ordered the forbidden city to be built</th>
<td id="A3.T4.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">Zhu Di</td>
<td id="A3.T4.1.1.2.1.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">Emperor Qin Shi Huang</td>
</tr>
<tr id="A3.T4.1.1.3.2" class="ltx_tr">
<th id="A3.T4.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">who has won the most games in nfl 2017</th>
<td id="A3.T4.1.1.3.2.2" class="ltx_td ltx_align_left ltx_border_t">Dallas Cowboys</td>
<td id="A3.T4.1.1.3.2.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">Tom Brady</td>
</tr>
<tr id="A3.T4.1.1.4.3" class="ltx_tr">
<th id="A3.T4.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">
<table id="A3.T4.1.1.4.3.1.1" class="ltx_tabular ltx_align_middle">
<tbody><tr id="A3.T4.1.1.4.3.1.1.1" class="ltx_tr">
<td id="A3.T4.1.1.4.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">who was the famous scientist that</td>
</tr>
<tr id="A3.T4.1.1.4.3.1.1.2" class="ltx_tr">
<td id="A3.T4.1.1.4.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">ran the research lab moseley went to in manchester</td>
</tr>
</tbody></table>
</th>
<td id="A3.T4.1.1.4.3.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">Sir Ernest Rutherford</td>
<td id="A3.T4.1.1.4.3.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t">Albert Einstein</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Sample questions from the NaturalQA dataset.</figcaption>
</figure>
<figure id="A3.T5" class="ltx_table">
<div id="A3.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:152.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-106.5pt,37.4pt) scale(0.670574290549456,0.670574290549456) ;">
<table id="A3.T5.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T5.1.1.1.1" class="ltx_tr">
<th id="A3.T5.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Question</th>
<th id="A3.T5.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">True answers</th>
<th id="A3.T5.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">False answers</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T5.1.1.2.1" class="ltx_tr">
<td id="A3.T5.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">
<table id="A3.T5.1.1.2.1.1.1" class="ltx_tabular ltx_align_middle">
<tbody><tr id="A3.T5.1.1.2.1.1.1.1" class="ltx_tr">
<td id="A3.T5.1.1.2.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">What happens to you</td>
</tr>
<tr id="A3.T5.1.1.2.1.1.1.2" class="ltx_tr">
<td id="A3.T5.1.1.2.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">if you eat watermelon seeds?</td>
</tr>
</tbody></table>
</td>
<td id="A3.T5.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">
<table id="A3.T5.1.1.2.1.2.1" class="ltx_tabular ltx_align_middle">
<tbody><tr id="A3.T5.1.1.2.1.2.1.1" class="ltx_tr">
<td id="A3.T5.1.1.2.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">1) Nothing happens;</td>
</tr>
<tr id="A3.T5.1.1.2.1.2.1.2" class="ltx_tr">
<td id="A3.T5.1.1.2.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">2) You eat watermelon seeds;</td>
</tr>
<tr id="A3.T5.1.1.2.1.2.1.3" class="ltx_tr">
<td id="A3.T5.1.1.2.1.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">3) The watermelon seeds pass through your digestive system;</td>
</tr>
<tr id="A3.T5.1.1.2.1.2.1.4" class="ltx_tr">
<td id="A3.T5.1.1.2.1.2.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">4) You will not digest the watermelon seeds;</td>
</tr>
<tr id="A3.T5.1.1.2.1.2.1.5" class="ltx_tr">
<td id="A3.T5.1.1.2.1.2.1.5.1" class="ltx_td ltx_nopad_r ltx_align_left">5) The watermelon seeds will be excreted;</td>
</tr>
</tbody></table>
</td>
<td id="A3.T5.1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">
<table id="A3.T5.1.1.2.1.3.1" class="ltx_tabular ltx_align_middle">
<tbody><tr id="A3.T5.1.1.2.1.3.1.1" class="ltx_tr">
<td id="A3.T5.1.1.2.1.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">1) You grow watermelons in your stomach;</td>
</tr>
<tr id="A3.T5.1.1.2.1.3.1.2" class="ltx_tr">
<td id="A3.T5.1.1.2.1.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">2) You get sick;</td>
</tr>
<tr id="A3.T5.1.1.2.1.3.1.3" class="ltx_tr">
<td id="A3.T5.1.1.2.1.3.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">3) You have bad dreams;</td>
</tr>
<tr id="A3.T5.1.1.2.1.3.1.4" class="ltx_tr">
<td id="A3.T5.1.1.2.1.3.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">4) You die;</td>
</tr>
<tr id="A3.T5.1.1.2.1.3.1.5" class="ltx_tr">
<td id="A3.T5.1.1.2.1.3.1.5.1" class="ltx_td ltx_nopad_r ltx_align_left">5) You get indigestion;</td>
</tr>
<tr id="A3.T5.1.1.2.1.3.1.6" class="ltx_tr">
<td id="A3.T5.1.1.2.1.3.1.6.1" class="ltx_td ltx_nopad_r ltx_align_left">6) You fall unconscious;</td>
</tr>
<tr id="A3.T5.1.1.2.1.3.1.7" class="ltx_tr">
<td id="A3.T5.1.1.2.1.3.1.7.1" class="ltx_td ltx_nopad_r ltx_align_left">7) You digest the watermelon seeds</td>
</tr>
</tbody></table>
</td>
</tr>
<tr id="A3.T5.1.1.3.2" class="ltx_tr">
<td id="A3.T5.1.1.3.2.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<table id="A3.T5.1.1.3.2.1.1" class="ltx_tabular ltx_align_middle">
<tbody><tr id="A3.T5.1.1.3.2.1.1.1" class="ltx_tr">
<td id="A3.T5.1.1.3.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Who said, "Only the dead</td>
</tr>
<tr id="A3.T5.1.1.3.2.1.1.2" class="ltx_tr">
<td id="A3.T5.1.1.3.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">have seen the end of war?"</td>
</tr>
</tbody></table>
</td>
<td id="A3.T5.1.1.3.2.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<table id="A3.T5.1.1.3.2.2.1" class="ltx_tabular ltx_align_middle">
<tbody><tr id="A3.T5.1.1.3.2.2.1.1" class="ltx_tr">
<td id="A3.T5.1.1.3.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">1) George Santayana wrote</td>
</tr>
<tr id="A3.T5.1.1.3.2.2.1.2" class="ltx_tr">
<td id="A3.T5.1.1.3.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">"Only the dead have seen the end of war";</td>
</tr>
<tr id="A3.T5.1.1.3.2.2.1.3" class="ltx_tr">
<td id="A3.T5.1.1.3.2.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">2) General Douglas MacArthur misattributed</td>
</tr>
<tr id="A3.T5.1.1.3.2.2.1.4" class="ltx_tr">
<td id="A3.T5.1.1.3.2.2.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">the quote to Plato in a farewell speech</td>
</tr>
</tbody></table>
</td>
<td id="A3.T5.1.1.3.2.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<table id="A3.T5.1.1.3.2.3.1" class="ltx_tabular ltx_align_middle">
<tbody><tr id="A3.T5.1.1.3.2.3.1.1" class="ltx_tr">
<td id="A3.T5.1.1.3.2.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">1) Plato said, "Only the dead</td>
</tr>
<tr id="A3.T5.1.1.3.2.3.1.2" class="ltx_tr">
<td id="A3.T5.1.1.3.2.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">have seen the end of war";</td>
</tr>
<tr id="A3.T5.1.1.3.2.3.1.3" class="ltx_tr">
<td id="A3.T5.1.1.3.2.3.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">2) Douglas MacArthur first said,</td>
</tr>
<tr id="A3.T5.1.1.3.2.3.1.4" class="ltx_tr">
<td id="A3.T5.1.1.3.2.3.1.4.1" class="ltx_td ltx_nopad_r ltx_align_left">"Only the dead have seen the end of war"</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Sample questions from the TruthfulQA dataset.</figcaption>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Hallucination Detection</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Example data from Natural Questions and TruthfulQA</h3>

<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.1" class="ltx_p">See Table <a href="#A3.T4" title="Table 4 ‣ Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#A3.T5" title="Table 5 ‣ Appendix C Evaluation of Pythia Models ‣ Mechanisms of Non-Factual Hallucination in Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> show example entries from NaturalQA and TruthfulQA datasets respectively. Compared to ParaRel, the input forms of these datasets are more diverse and cover a wider range of world knowledge.</p>
</div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Details of causal attribution approximation</h3>

<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.9" class="ltx_p">To exactly compute neuron-level causal effects, one need to make thousands of forward model pass for each query by targeting one neuron at a time. We therefore apply the method of attribution patching introduced in <cite class="ltx_cite ltx_citemacro_cite">Nanda (<a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite> to approximately compute causal effects for all neurons through one forward and one backward pass. Formally, for an input prompt <math id="A4.SS2.p1.1.m1.1" class="ltx_Math" alttext="u" display="inline"><semantics id="A4.SS2.p1.1.m1.1a"><mi id="A4.SS2.p1.1.m1.1.1" xref="A4.SS2.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.1.m1.1b"><ci id="A4.SS2.p1.1.m1.1.1.cmml" xref="A4.SS2.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.1.m1.1c">u</annotation></semantics></math> and continuation sequence <math id="A4.SS2.p1.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A4.SS2.p1.2.m2.1a"><mi id="A4.SS2.p1.2.m2.1.1" xref="A4.SS2.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.2.m2.1b"><ci id="A4.SS2.p1.2.m2.1.1.cmml" xref="A4.SS2.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.2.m2.1c">c</annotation></semantics></math> which the model considers as the most likely answer (note that here <math id="A4.SS2.p1.3.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="A4.SS2.p1.3.m3.1a"><mi id="A4.SS2.p1.3.m3.1.1" xref="A4.SS2.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.3.m3.1b"><ci id="A4.SS2.p1.3.m3.1.1.cmml" xref="A4.SS2.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.3.m3.1c">y</annotation></semantics></math> is no longer the log probability ratio between two tokens, but the log probability of a sequence of tokens). Let <math id="A4.SS2.p1.4.m4.1" class="ltx_Math" alttext="z" display="inline"><semantics id="A4.SS2.p1.4.m4.1a"><mi id="A4.SS2.p1.4.m4.1.1" xref="A4.SS2.p1.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.4.m4.1b"><ci id="A4.SS2.p1.4.m4.1.1.cmml" xref="A4.SS2.p1.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.4.m4.1c">z</annotation></semantics></math>, <math id="A4.SS2.p1.5.m5.1" class="ltx_Math" alttext="z^{*}" display="inline"><semantics id="A4.SS2.p1.5.m5.1a"><msup id="A4.SS2.p1.5.m5.1.1" xref="A4.SS2.p1.5.m5.1.1.cmml"><mi id="A4.SS2.p1.5.m5.1.1.2" xref="A4.SS2.p1.5.m5.1.1.2.cmml">z</mi><mo id="A4.SS2.p1.5.m5.1.1.3" xref="A4.SS2.p1.5.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.5.m5.1b"><apply id="A4.SS2.p1.5.m5.1.1.cmml" xref="A4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A4.SS2.p1.5.m5.1.1.1.cmml" xref="A4.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="A4.SS2.p1.5.m5.1.1.2.cmml" xref="A4.SS2.p1.5.m5.1.1.2">𝑧</ci><times id="A4.SS2.p1.5.m5.1.1.3.cmml" xref="A4.SS2.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.5.m5.1c">z^{*}</annotation></semantics></math> be the activation values of a neuron (i.e. a dimension of the hidden state of an input token at a particular transformer layer) when taking the original and noise-injected input embeddings <math id="A4.SS2.p1.6.m6.4" class="ltx_Math" alttext="E(u),E^{*}(u)" display="inline"><semantics id="A4.SS2.p1.6.m6.4a"><mrow id="A4.SS2.p1.6.m6.4.4.2" xref="A4.SS2.p1.6.m6.4.4.3.cmml"><mrow id="A4.SS2.p1.6.m6.3.3.1.1" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml"><mi id="A4.SS2.p1.6.m6.3.3.1.1.2" xref="A4.SS2.p1.6.m6.3.3.1.1.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.6.m6.3.3.1.1.1" xref="A4.SS2.p1.6.m6.3.3.1.1.1.cmml">​</mo><mrow id="A4.SS2.p1.6.m6.3.3.1.1.3.2" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml"><mo stretchy="false" id="A4.SS2.p1.6.m6.3.3.1.1.3.2.1" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml">(</mo><mi id="A4.SS2.p1.6.m6.1.1" xref="A4.SS2.p1.6.m6.1.1.cmml">u</mi><mo stretchy="false" id="A4.SS2.p1.6.m6.3.3.1.1.3.2.2" xref="A4.SS2.p1.6.m6.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="A4.SS2.p1.6.m6.4.4.2.3" xref="A4.SS2.p1.6.m6.4.4.3.cmml">,</mo><mrow id="A4.SS2.p1.6.m6.4.4.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml"><msup id="A4.SS2.p1.6.m6.4.4.2.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.2.cmml"><mi id="A4.SS2.p1.6.m6.4.4.2.2.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.2.2.cmml">E</mi><mo id="A4.SS2.p1.6.m6.4.4.2.2.2.3" xref="A4.SS2.p1.6.m6.4.4.2.2.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="A4.SS2.p1.6.m6.4.4.2.2.1" xref="A4.SS2.p1.6.m6.4.4.2.2.1.cmml">​</mo><mrow id="A4.SS2.p1.6.m6.4.4.2.2.3.2" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml"><mo stretchy="false" id="A4.SS2.p1.6.m6.4.4.2.2.3.2.1" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml">(</mo><mi id="A4.SS2.p1.6.m6.2.2" xref="A4.SS2.p1.6.m6.2.2.cmml">u</mi><mo stretchy="false" id="A4.SS2.p1.6.m6.4.4.2.2.3.2.2" xref="A4.SS2.p1.6.m6.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.6.m6.4b"><list id="A4.SS2.p1.6.m6.4.4.3.cmml" xref="A4.SS2.p1.6.m6.4.4.2"><apply id="A4.SS2.p1.6.m6.3.3.1.1.cmml" xref="A4.SS2.p1.6.m6.3.3.1.1"><times id="A4.SS2.p1.6.m6.3.3.1.1.1.cmml" xref="A4.SS2.p1.6.m6.3.3.1.1.1"></times><ci id="A4.SS2.p1.6.m6.3.3.1.1.2.cmml" xref="A4.SS2.p1.6.m6.3.3.1.1.2">𝐸</ci><ci id="A4.SS2.p1.6.m6.1.1.cmml" xref="A4.SS2.p1.6.m6.1.1">𝑢</ci></apply><apply id="A4.SS2.p1.6.m6.4.4.2.2.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2"><times id="A4.SS2.p1.6.m6.4.4.2.2.1.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.1"></times><apply id="A4.SS2.p1.6.m6.4.4.2.2.2.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2"><csymbol cd="ambiguous" id="A4.SS2.p1.6.m6.4.4.2.2.2.1.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2">superscript</csymbol><ci id="A4.SS2.p1.6.m6.4.4.2.2.2.2.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2.2">𝐸</ci><times id="A4.SS2.p1.6.m6.4.4.2.2.2.3.cmml" xref="A4.SS2.p1.6.m6.4.4.2.2.2.3"></times></apply><ci id="A4.SS2.p1.6.m6.2.2.cmml" xref="A4.SS2.p1.6.m6.2.2">𝑢</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.6.m6.4c">E(u),E^{*}(u)</annotation></semantics></math> respectively, and let <math id="A4.SS2.p1.7.m7.3" class="ltx_Math" alttext="g(z)=\nabla_{z}y,g(z^{*})=\nabla_{z^{*}}y_{*}" display="inline"><semantics id="A4.SS2.p1.7.m7.3a"><mrow id="A4.SS2.p1.7.m7.3.3.2" xref="A4.SS2.p1.7.m7.3.3.3.cmml"><mrow id="A4.SS2.p1.7.m7.2.2.1.1" xref="A4.SS2.p1.7.m7.2.2.1.1.cmml"><mrow id="A4.SS2.p1.7.m7.2.2.1.1.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml"><mi id="A4.SS2.p1.7.m7.2.2.1.1.2.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.7.m7.2.2.1.1.2.1" xref="A4.SS2.p1.7.m7.2.2.1.1.2.1.cmml">​</mo><mrow id="A4.SS2.p1.7.m7.2.2.1.1.2.3.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml"><mo stretchy="false" id="A4.SS2.p1.7.m7.2.2.1.1.2.3.2.1" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml">(</mo><mi id="A4.SS2.p1.7.m7.1.1" xref="A4.SS2.p1.7.m7.1.1.cmml">z</mi><mo stretchy="false" id="A4.SS2.p1.7.m7.2.2.1.1.2.3.2.2" xref="A4.SS2.p1.7.m7.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.SS2.p1.7.m7.2.2.1.1.1" xref="A4.SS2.p1.7.m7.2.2.1.1.1.cmml">=</mo><mrow id="A4.SS2.p1.7.m7.2.2.1.1.3" xref="A4.SS2.p1.7.m7.2.2.1.1.3.cmml"><msub id="A4.SS2.p1.7.m7.2.2.1.1.3.1" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.cmml"><mo rspace="0.167em" id="A4.SS2.p1.7.m7.2.2.1.1.3.1.2" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.2.cmml">∇</mo><mi id="A4.SS2.p1.7.m7.2.2.1.1.3.1.3" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.3.cmml">z</mi></msub><mi id="A4.SS2.p1.7.m7.2.2.1.1.3.2" xref="A4.SS2.p1.7.m7.2.2.1.1.3.2.cmml">y</mi></mrow></mrow><mo id="A4.SS2.p1.7.m7.3.3.2.3" xref="A4.SS2.p1.7.m7.3.3.3a.cmml">,</mo><mrow id="A4.SS2.p1.7.m7.3.3.2.2" xref="A4.SS2.p1.7.m7.3.3.2.2.cmml"><mrow id="A4.SS2.p1.7.m7.3.3.2.2.1" xref="A4.SS2.p1.7.m7.3.3.2.2.1.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="A4.SS2.p1.7.m7.3.3.2.2.1.2" xref="A4.SS2.p1.7.m7.3.3.2.2.1.2.cmml">​</mo><mrow id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.2" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml">(</mo><msup id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2.cmml">z</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.SS2.p1.7.m7.3.3.2.2.2" xref="A4.SS2.p1.7.m7.3.3.2.2.2.cmml">=</mo><mrow id="A4.SS2.p1.7.m7.3.3.2.2.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.cmml"><msub id="A4.SS2.p1.7.m7.3.3.2.2.3.1" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.cmml"><mo rspace="0.167em" id="A4.SS2.p1.7.m7.3.3.2.2.3.1.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.2.cmml">∇</mo><msup id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2.cmml">z</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3.cmml">∗</mo></msup></msub><msub id="A4.SS2.p1.7.m7.3.3.2.2.3.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.cmml"><mi id="A4.SS2.p1.7.m7.3.3.2.2.3.2.2" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.2.cmml">y</mi><mo id="A4.SS2.p1.7.m7.3.3.2.2.3.2.3" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.3.cmml">∗</mo></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.7.m7.3b"><apply id="A4.SS2.p1.7.m7.3.3.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.3a.cmml" xref="A4.SS2.p1.7.m7.3.3.2.3">formulae-sequence</csymbol><apply id="A4.SS2.p1.7.m7.2.2.1.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1"><eq id="A4.SS2.p1.7.m7.2.2.1.1.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.1"></eq><apply id="A4.SS2.p1.7.m7.2.2.1.1.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.2"><times id="A4.SS2.p1.7.m7.2.2.1.1.2.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.2.1"></times><ci id="A4.SS2.p1.7.m7.2.2.1.1.2.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.2.2">𝑔</ci><ci id="A4.SS2.p1.7.m7.1.1.cmml" xref="A4.SS2.p1.7.m7.1.1">𝑧</ci></apply><apply id="A4.SS2.p1.7.m7.2.2.1.1.3.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3"><apply id="A4.SS2.p1.7.m7.2.2.1.1.3.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.2.2.1.1.3.1.1.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1">subscript</csymbol><ci id="A4.SS2.p1.7.m7.2.2.1.1.3.1.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.2">∇</ci><ci id="A4.SS2.p1.7.m7.2.2.1.1.3.1.3.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.1.3">𝑧</ci></apply><ci id="A4.SS2.p1.7.m7.2.2.1.1.3.2.cmml" xref="A4.SS2.p1.7.m7.2.2.1.1.3.2">𝑦</ci></apply></apply><apply id="A4.SS2.p1.7.m7.3.3.2.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2"><eq id="A4.SS2.p1.7.m7.3.3.2.2.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.2"></eq><apply id="A4.SS2.p1.7.m7.3.3.2.2.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1"><times id="A4.SS2.p1.7.m7.3.3.2.2.1.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.2"></times><ci id="A4.SS2.p1.7.m7.3.3.2.2.1.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.3">𝑔</ci><apply id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1">superscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.2">𝑧</ci><times id="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.1.1.1.1.3"></times></apply></apply><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3"><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.3.1.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1">subscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.3.1.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.2">∇</ci><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3">superscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.2">𝑧</ci><times id="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.1.3.3"></times></apply></apply><apply id="A4.SS2.p1.7.m7.3.3.2.2.3.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2"><csymbol cd="ambiguous" id="A4.SS2.p1.7.m7.3.3.2.2.3.2.1.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2">subscript</csymbol><ci id="A4.SS2.p1.7.m7.3.3.2.2.3.2.2.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.2">𝑦</ci><times id="A4.SS2.p1.7.m7.3.3.2.2.3.2.3.cmml" xref="A4.SS2.p1.7.m7.3.3.2.2.3.2.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.7.m7.3c">g(z)=\nabla_{z}y,g(z^{*})=\nabla_{z^{*}}y_{*}</annotation></semantics></math> be the gradient of the neuron w.r.t the relative log likelihood in the hallucination and the mitigation run with an input embedding noise <math id="A4.SS2.p1.8.m8.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="A4.SS2.p1.8.m8.1a"><mi id="A4.SS2.p1.8.m8.1.1" xref="A4.SS2.p1.8.m8.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.8.m8.1b"><ci id="A4.SS2.p1.8.m8.1.1.cmml" xref="A4.SS2.p1.8.m8.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.8.m8.1c">\epsilon</annotation></semantics></math> injected, we can approximate the causal indirect effect of <math id="A4.SS2.p1.9.m9.1" class="ltx_Math" alttext="z" display="inline"><semantics id="A4.SS2.p1.9.m9.1a"><mi id="A4.SS2.p1.9.m9.1.1" xref="A4.SS2.p1.9.m9.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.9.m9.1b"><ci id="A4.SS2.p1.9.m9.1.1.cmml" xref="A4.SS2.p1.9.m9.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.9.m9.1c">z</annotation></semantics></math> as follows:</p>
<table id="A4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A4.E3.m1.8" class="ltx_Math" alttext="\displaystyle\text{IE}(z,y,u,\epsilon)=y_{E^{*},z}-y_{*}\approx g(z^{*})(y-y_{*})" display="inline"><semantics id="A4.E3.m1.8a"><mrow id="A4.E3.m1.8.8" xref="A4.E3.m1.8.8.cmml"><mrow id="A4.E3.m1.8.8.4" xref="A4.E3.m1.8.8.4.cmml"><mtext id="A4.E3.m1.8.8.4.2" xref="A4.E3.m1.8.8.4.2a.cmml">IE</mtext><mo lspace="0em" rspace="0em" id="A4.E3.m1.8.8.4.1" xref="A4.E3.m1.8.8.4.1.cmml">​</mo><mrow id="A4.E3.m1.8.8.4.3.2" xref="A4.E3.m1.8.8.4.3.1.cmml"><mo stretchy="false" id="A4.E3.m1.8.8.4.3.2.1" xref="A4.E3.m1.8.8.4.3.1.cmml">(</mo><mi id="A4.E3.m1.3.3" xref="A4.E3.m1.3.3.cmml">z</mi><mo id="A4.E3.m1.8.8.4.3.2.2" xref="A4.E3.m1.8.8.4.3.1.cmml">,</mo><mi id="A4.E3.m1.4.4" xref="A4.E3.m1.4.4.cmml">y</mi><mo id="A4.E3.m1.8.8.4.3.2.3" xref="A4.E3.m1.8.8.4.3.1.cmml">,</mo><mi id="A4.E3.m1.5.5" xref="A4.E3.m1.5.5.cmml">u</mi><mo id="A4.E3.m1.8.8.4.3.2.4" xref="A4.E3.m1.8.8.4.3.1.cmml">,</mo><mi id="A4.E3.m1.6.6" xref="A4.E3.m1.6.6.cmml">ϵ</mi><mo stretchy="false" id="A4.E3.m1.8.8.4.3.2.5" xref="A4.E3.m1.8.8.4.3.1.cmml">)</mo></mrow></mrow><mo id="A4.E3.m1.8.8.5" xref="A4.E3.m1.8.8.5.cmml">=</mo><mrow id="A4.E3.m1.8.8.6" xref="A4.E3.m1.8.8.6.cmml"><msub id="A4.E3.m1.8.8.6.2" xref="A4.E3.m1.8.8.6.2.cmml"><mi id="A4.E3.m1.8.8.6.2.2" xref="A4.E3.m1.8.8.6.2.2.cmml">y</mi><mrow id="A4.E3.m1.2.2.2.2" xref="A4.E3.m1.2.2.2.3.cmml"><msup id="A4.E3.m1.2.2.2.2.1" xref="A4.E3.m1.2.2.2.2.1.cmml"><mi id="A4.E3.m1.2.2.2.2.1.2" xref="A4.E3.m1.2.2.2.2.1.2.cmml">E</mi><mo id="A4.E3.m1.2.2.2.2.1.3" xref="A4.E3.m1.2.2.2.2.1.3.cmml">∗</mo></msup><mo id="A4.E3.m1.2.2.2.2.2" xref="A4.E3.m1.2.2.2.3.cmml">,</mo><mi id="A4.E3.m1.1.1.1.1" xref="A4.E3.m1.1.1.1.1.cmml">z</mi></mrow></msub><mo id="A4.E3.m1.8.8.6.1" xref="A4.E3.m1.8.8.6.1.cmml">−</mo><msub id="A4.E3.m1.8.8.6.3" xref="A4.E3.m1.8.8.6.3.cmml"><mi id="A4.E3.m1.8.8.6.3.2" xref="A4.E3.m1.8.8.6.3.2.cmml">y</mi><mo id="A4.E3.m1.8.8.6.3.3" xref="A4.E3.m1.8.8.6.3.3.cmml">∗</mo></msub></mrow><mo id="A4.E3.m1.8.8.7" xref="A4.E3.m1.8.8.7.cmml">≈</mo><mrow id="A4.E3.m1.8.8.2" xref="A4.E3.m1.8.8.2.cmml"><mi id="A4.E3.m1.8.8.2.4" xref="A4.E3.m1.8.8.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="A4.E3.m1.8.8.2.3" xref="A4.E3.m1.8.8.2.3.cmml">​</mo><mrow id="A4.E3.m1.7.7.1.1.1" xref="A4.E3.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="A4.E3.m1.7.7.1.1.1.2" xref="A4.E3.m1.7.7.1.1.1.1.cmml">(</mo><msup id="A4.E3.m1.7.7.1.1.1.1" xref="A4.E3.m1.7.7.1.1.1.1.cmml"><mi id="A4.E3.m1.7.7.1.1.1.1.2" xref="A4.E3.m1.7.7.1.1.1.1.2.cmml">z</mi><mo id="A4.E3.m1.7.7.1.1.1.1.3" xref="A4.E3.m1.7.7.1.1.1.1.3.cmml">∗</mo></msup><mo stretchy="false" id="A4.E3.m1.7.7.1.1.1.3" xref="A4.E3.m1.7.7.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A4.E3.m1.8.8.2.3a" xref="A4.E3.m1.8.8.2.3.cmml">​</mo><mrow id="A4.E3.m1.8.8.2.2.1" xref="A4.E3.m1.8.8.2.2.1.1.cmml"><mo stretchy="false" id="A4.E3.m1.8.8.2.2.1.2" xref="A4.E3.m1.8.8.2.2.1.1.cmml">(</mo><mrow id="A4.E3.m1.8.8.2.2.1.1" xref="A4.E3.m1.8.8.2.2.1.1.cmml"><mi id="A4.E3.m1.8.8.2.2.1.1.2" xref="A4.E3.m1.8.8.2.2.1.1.2.cmml">y</mi><mo id="A4.E3.m1.8.8.2.2.1.1.1" xref="A4.E3.m1.8.8.2.2.1.1.1.cmml">−</mo><msub id="A4.E3.m1.8.8.2.2.1.1.3" xref="A4.E3.m1.8.8.2.2.1.1.3.cmml"><mi id="A4.E3.m1.8.8.2.2.1.1.3.2" xref="A4.E3.m1.8.8.2.2.1.1.3.2.cmml">y</mi><mo id="A4.E3.m1.8.8.2.2.1.1.3.3" xref="A4.E3.m1.8.8.2.2.1.1.3.3.cmml">∗</mo></msub></mrow><mo stretchy="false" id="A4.E3.m1.8.8.2.2.1.3" xref="A4.E3.m1.8.8.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.E3.m1.8b"><apply id="A4.E3.m1.8.8.cmml" xref="A4.E3.m1.8.8"><and id="A4.E3.m1.8.8a.cmml" xref="A4.E3.m1.8.8"></and><apply id="A4.E3.m1.8.8b.cmml" xref="A4.E3.m1.8.8"><eq id="A4.E3.m1.8.8.5.cmml" xref="A4.E3.m1.8.8.5"></eq><apply id="A4.E3.m1.8.8.4.cmml" xref="A4.E3.m1.8.8.4"><times id="A4.E3.m1.8.8.4.1.cmml" xref="A4.E3.m1.8.8.4.1"></times><ci id="A4.E3.m1.8.8.4.2a.cmml" xref="A4.E3.m1.8.8.4.2"><mtext id="A4.E3.m1.8.8.4.2.cmml" xref="A4.E3.m1.8.8.4.2">IE</mtext></ci><vector id="A4.E3.m1.8.8.4.3.1.cmml" xref="A4.E3.m1.8.8.4.3.2"><ci id="A4.E3.m1.3.3.cmml" xref="A4.E3.m1.3.3">𝑧</ci><ci id="A4.E3.m1.4.4.cmml" xref="A4.E3.m1.4.4">𝑦</ci><ci id="A4.E3.m1.5.5.cmml" xref="A4.E3.m1.5.5">𝑢</ci><ci id="A4.E3.m1.6.6.cmml" xref="A4.E3.m1.6.6">italic-ϵ</ci></vector></apply><apply id="A4.E3.m1.8.8.6.cmml" xref="A4.E3.m1.8.8.6"><minus id="A4.E3.m1.8.8.6.1.cmml" xref="A4.E3.m1.8.8.6.1"></minus><apply id="A4.E3.m1.8.8.6.2.cmml" xref="A4.E3.m1.8.8.6.2"><csymbol cd="ambiguous" id="A4.E3.m1.8.8.6.2.1.cmml" xref="A4.E3.m1.8.8.6.2">subscript</csymbol><ci id="A4.E3.m1.8.8.6.2.2.cmml" xref="A4.E3.m1.8.8.6.2.2">𝑦</ci><list id="A4.E3.m1.2.2.2.3.cmml" xref="A4.E3.m1.2.2.2.2"><apply id="A4.E3.m1.2.2.2.2.1.cmml" xref="A4.E3.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="A4.E3.m1.2.2.2.2.1.1.cmml" xref="A4.E3.m1.2.2.2.2.1">superscript</csymbol><ci id="A4.E3.m1.2.2.2.2.1.2.cmml" xref="A4.E3.m1.2.2.2.2.1.2">𝐸</ci><times id="A4.E3.m1.2.2.2.2.1.3.cmml" xref="A4.E3.m1.2.2.2.2.1.3"></times></apply><ci id="A4.E3.m1.1.1.1.1.cmml" xref="A4.E3.m1.1.1.1.1">𝑧</ci></list></apply><apply id="A4.E3.m1.8.8.6.3.cmml" xref="A4.E3.m1.8.8.6.3"><csymbol cd="ambiguous" id="A4.E3.m1.8.8.6.3.1.cmml" xref="A4.E3.m1.8.8.6.3">subscript</csymbol><ci id="A4.E3.m1.8.8.6.3.2.cmml" xref="A4.E3.m1.8.8.6.3.2">𝑦</ci><times id="A4.E3.m1.8.8.6.3.3.cmml" xref="A4.E3.m1.8.8.6.3.3"></times></apply></apply></apply><apply id="A4.E3.m1.8.8c.cmml" xref="A4.E3.m1.8.8"><approx id="A4.E3.m1.8.8.7.cmml" xref="A4.E3.m1.8.8.7"></approx><share href="#A4.E3.m1.8.8.6.cmml" id="A4.E3.m1.8.8d.cmml" xref="A4.E3.m1.8.8"></share><apply id="A4.E3.m1.8.8.2.cmml" xref="A4.E3.m1.8.8.2"><times id="A4.E3.m1.8.8.2.3.cmml" xref="A4.E3.m1.8.8.2.3"></times><ci id="A4.E3.m1.8.8.2.4.cmml" xref="A4.E3.m1.8.8.2.4">𝑔</ci><apply id="A4.E3.m1.7.7.1.1.1.1.cmml" xref="A4.E3.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="A4.E3.m1.7.7.1.1.1.1.1.cmml" xref="A4.E3.m1.7.7.1.1.1">superscript</csymbol><ci id="A4.E3.m1.7.7.1.1.1.1.2.cmml" xref="A4.E3.m1.7.7.1.1.1.1.2">𝑧</ci><times id="A4.E3.m1.7.7.1.1.1.1.3.cmml" xref="A4.E3.m1.7.7.1.1.1.1.3"></times></apply><apply id="A4.E3.m1.8.8.2.2.1.1.cmml" xref="A4.E3.m1.8.8.2.2.1"><minus id="A4.E3.m1.8.8.2.2.1.1.1.cmml" xref="A4.E3.m1.8.8.2.2.1.1.1"></minus><ci id="A4.E3.m1.8.8.2.2.1.1.2.cmml" xref="A4.E3.m1.8.8.2.2.1.1.2">𝑦</ci><apply id="A4.E3.m1.8.8.2.2.1.1.3.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3"><csymbol cd="ambiguous" id="A4.E3.m1.8.8.2.2.1.1.3.1.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3">subscript</csymbol><ci id="A4.E3.m1.8.8.2.2.1.1.3.2.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3.2">𝑦</ci><times id="A4.E3.m1.8.8.2.2.1.1.3.3.cmml" xref="A4.E3.m1.8.8.2.2.1.1.3.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E3.m1.8c">\displaystyle\text{IE}(z,y,u,\epsilon)=y_{E^{*},z}-y_{*}\approx g(z^{*})(y-y_{*})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="A4.SS2.p1.13" class="ltx_p">Intuitively, we are assuming that the response variable <math id="A4.SS2.p1.10.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="A4.SS2.p1.10.m1.1a"><mi id="A4.SS2.p1.10.m1.1.1" xref="A4.SS2.p1.10.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.10.m1.1b"><ci id="A4.SS2.p1.10.m1.1.1.cmml" xref="A4.SS2.p1.10.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.10.m1.1c">y</annotation></semantics></math> is a locally linear function of the activation value of <math id="A4.SS2.p1.11.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="A4.SS2.p1.11.m2.1a"><mi id="A4.SS2.p1.11.m2.1.1" xref="A4.SS2.p1.11.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.11.m2.1b"><ci id="A4.SS2.p1.11.m2.1.1.cmml" xref="A4.SS2.p1.11.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.11.m2.1c">z</annotation></semantics></math> (when keeping other neurons fixed), so the causal effect can be approximated as the multiplication of the gradient of <math id="A4.SS2.p1.12.m3.1" class="ltx_Math" alttext="z" display="inline"><semantics id="A4.SS2.p1.12.m3.1a"><mi id="A4.SS2.p1.12.m3.1.1" xref="A4.SS2.p1.12.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.12.m3.1b"><ci id="A4.SS2.p1.12.m3.1.1.cmml" xref="A4.SS2.p1.12.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.12.m3.1c">z</annotation></semantics></math> and the difference in its activation values after input perturbation. The approximations of AIE for each neuron <math id="A4.SS2.p1.13.m4.1" class="ltx_Math" alttext="z" display="inline"><semantics id="A4.SS2.p1.13.m4.1a"><mi id="A4.SS2.p1.13.m4.1.1" xref="A4.SS2.p1.13.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A4.SS2.p1.13.m4.1b"><ci id="A4.SS2.p1.13.m4.1.1.cmml" xref="A4.SS2.p1.13.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS2.p1.13.m4.1c">z</annotation></semantics></math> can also be computed by averaging the approximated IEs over independently sampled noises and over all input queries.</p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.18166" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.18167" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+2403.18167">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.18167" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.18168" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 17:54:20 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>