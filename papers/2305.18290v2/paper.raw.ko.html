<html lang="en" data-theme="light"><head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Direct Preference Optimization: Your Language Model is Secretly a Reward Model</title>
<!--Generated on Wed Feb  7 20:07:11 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="https://arxiv.org/static/browse/0.3.4/js/addons.js"></script>
<script src="https://arxiv.org/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="https://arxiv.org/html/2305.18290v2/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2305.18290v2">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
        <span class="color-scheme-icon" aria-label="Light mode"></span>
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="#myForm" onclick="event.preventDefault(); var modal = document.getElementById('myForm'); modal.style.display = 'block'; bugReportState.setInitiateWay('Header');">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2305.18290v2">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2305.18290v2" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
          <span class="color-scheme-icon"></span>
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC mobile collapse" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S1" title="1 Introduction ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S2" title="2 Related Work ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3" title="3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4" title="4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Direct Preference Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S5" title="5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Theoretical Analysis of DPO</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S5.SS1" title="5.1 Your Language Model Is Secretly a Reward Model ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Your Language Model Is Secretly a Reward Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S5.SS2" title="5.2 Instability of Actor-Critic Algorithms ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Instability of Actor-Critic Algorithms</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6" title="6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.SS1" title="6.1 How well can DPO optimize the RLHF objective? ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>How well can DPO optimize the RLHF objective?</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.SS2" title="6.2 Can DPO scale to real preference datasets? ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Can DPO scale to real preference datasets?</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.SS3" title="6.3 Generalization to a new input distribution ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Generalization to a new input distribution</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.SS4" title="6.4 Validating GPT-4 judgments with human judgments ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Validating GPT-4 judgments with human judgments</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S7" title="7 Discussion ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1" title="Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Mathematical Derivations</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS1" title="A.1 Deriving the Optimum of the KL-Constrained Reward Maximization Objective ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Deriving the Optimum of the KL-Constrained Reward Maximization Objective</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS2" title="A.2 Deriving the DPO Objective Under the Bradley-Terry Model ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Deriving the DPO Objective Under the Bradley-Terry Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS3" title="A.3 Deriving the DPO Objective Under the Plackett-Luce Model ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Deriving the DPO Objective Under the Plackett-Luce Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS4" title="A.4 Deriving the Gradient of the DPO Objective ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Deriving the Gradient of the DPO Objective</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS5" title="A.5 Proof of Lemma 1 and 2 ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Proof of Lemma 1 and 2</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS6" title="A.6 Proof of Theorem 1 ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.6 </span>Proof of Theorem 1</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A2" title="Appendix B DPO Implementation Details and Hyperparameters ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>DPO Implementation Details and Hyperparameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A3" title="Appendix C Further Details on the Experimental Set-Up ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Further Details on the Experimental Set-Up</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A3.SS1" title="C.1 IMDb Sentiment Experiment and Baseline Details ‣ Appendix C Further Details on the Experimental Set-Up ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>IMDb Sentiment Experiment and Baseline Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A3.SS2" title="C.2 GPT-4 prompts for computing summarization and dialogue win rates ‣ Appendix C Further Details on the Experimental Set-Up ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>GPT-4 prompts for computing summarization and dialogue win rates</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A3.SS3" title="C.3 Unlikelihood baseline ‣ Appendix C Further Details on the Experimental Set-Up ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Unlikelihood baseline</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4" title="Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Additional Empirical Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.SS1" title="D.1 Performance of Best of 𝑁 baseline for Various 𝑁 ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Performance of Best of <math alttext="N" class="ltx_Math" display="inline"><semantics><mi>N</mi><annotation-xml encoding="MathML-Content"><ci>𝑁</ci></annotation-xml><annotation encoding="application/x-tex">N</annotation><annotation encoding="application/x-llamapun">italic_N</annotation></semantics></math> baseline for Various <math alttext="N" class="ltx_Math" display="inline"><semantics><mi>N</mi><annotation-xml encoding="MathML-Content"><ci>𝑁</ci></annotation-xml><annotation encoding="application/x-tex">N</annotation><annotation encoding="application/x-llamapun">italic_N</annotation></semantics></math></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.SS2" title="D.2 Sample Responses and GPT-4 Judgments ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Sample Responses and GPT-4 Judgments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.SS3" title="D.3 Human study details ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>Human study details</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.SS3.SSS0.Px1" title="Participants. ‣ D.3 Human study details ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_title">Participants.</span></a></li>
</ol>
</li>
</ol>
</li>
</ol></nav>

<div class="ltx_page_content"><div class="section" id="target-section"><div id="license-tr">License: CC BY 4.0</div><div id="watermark-tr">arXiv:2305.18290v2 [cs.LG] 13 Dec 2023</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Direct Preference Optimization:
<br class="ltx_break">Your Language Model is Secretly a Reward Model</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rafael Rafailov  <span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">2</span></span></span></span> &amp;Archit Sharma<span class="ltx_note ltx_role_footnotemark" id="footnotex2"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>  <span class="ltx_note ltx_role_footnotemark" id="footnotex3"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">2</span></span></span></span> &amp;Eric Mitchell<span class="ltx_note ltx_role_footnotemark" id="footnotex4"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>  <span class="ltx_note ltx_role_footnotemark" id="footnotex5"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">2</span></span></span></span>
<br class="ltx_break">Stefano Ermon<span class="ltx_note ltx_role_footnotemark" id="footnotex6"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">2</span></span></span></span>  <span class="ltx_note ltx_role_footnotemark" id="footnotex7"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">3</span></span></span></span> &amp;Christopher D. Manning<span class="ltx_note ltx_role_footnotemark" id="footnotex8"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">2</span></span></span></span> &amp;Chelsea Finn<span class="ltx_note ltx_role_footnotemark" id="footnotex9"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">2</span></span></span></span>
<br class="ltx_break"><span class="ltx_note ltx_role_footnotemark" id="footnotex10"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">2</span></span></span></span>  Stanford University <span class="ltx_note ltx_role_footnotemark" id="footnotex11"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">3</span></span></span></span>  CZ Biohub 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">{rafailov,architsh,eric.mitchell}@cs.stanford.edu</span>
</span><span class="ltx_author_notes">Equal contribution; more junior authors listed earlier.</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id2.id1">대규모 비감독 언어 모델(LMs)은 광범위한 세계 지식과 일부 추론 기술을 배우는 반면, 훈련의 완전한 비감독 특성으로 인해 행동의 정확한 제어를 달성하는 것은 어렵다. 이러한 조향성을 얻기 위한 기존의 방법은 모델 세대의 상대적인 품질의 인간 라벨을 수집하고 이러한 선호도에 맞추기 위해 감독되지 않은 LM을 미세 조정하며, 종종 인간 피드백(RLHF)으로부터의 강화 학습과 함께 조정한다. 그러나 RLHF는 복잡하고 종종 불안정한 절차로, 먼저 인간의 선호도를 반영하는 보상 모델을 피팅한 다음 강화 학습을 사용하여 대규모 비지도 LM을 미세 조정하여 원래 모델에서 너무 멀리 표류하지 않고 추정된 보상을 최대화한다. 본 논문에서는 간단한 분류 손실만으로 표준 RLHF 문제를 해결할 수 있는 폐쇄형 최적 정책 추출이 가능한 RLHF 보상 모델의 새로운 파라미터화를 소개한다. <span class="ltx_text ltx_font_italic" id="id2.id1.1">Direct Preference Optimization</span> (DPO)라고 하는 결과 알고리즘은 안정적이고 수행적이며 계산적으로 가벼워 미세 조정 또는 중요한 하이퍼파라미터 튜닝을 수행하는 동안 LM에서 샘플링할 필요가 없다. 우리의 실험은 DPO가 기존의 방법뿐만 아니라 인간의 선호도와 일치하거나 더 나은 LM을 미세 조정할 수 있음을 보여준다. 특히, DPO와의 미세 조정은 세대의 감성을 제어하는 능력에서 PPO 기반 RLHF를 초과하고, 구현 및 훈련이 상당히 간단하면서 요약 및 싱글 턴 대화에서 응답 품질을 일치시키거나 개선한다.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">매우 큰 데이터 세트에 대해 훈련된 대규모 비감독 언어 모델(LMs)은 놀라운 능력(<cite class="ltx_cite ltx_citemacro_citep">(Chowdhery et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib11" title="">2022</a>; Brown et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib7" title="">2020b</a>; Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib40" title="">2023</a>; Bubeck et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib8" title="">2023</a>)</cite>)을 획득한다. 그러나, 이러한 모델들은 매우 다양한 목표들, 우선순위들, 및 기술 세트들을 갖는 인간에 의해 생성된 데이터에 대해 트레이닝된다. 이러한 목표 및 기술 집합 중 일부는 모방하는 것이 바람직하지 않을 수 있습니다. 예를 들어 AI 코딩 보조자가 <span class="ltx_text ltx_font_italic" id="S1.p1.1.1">understand</span> 일반적인 프로그래밍 오류를 수정하기를 원할 수 있지만 그럼에도 불구하고 코드를 생성할 때 학습 데이터에 존재하는 (잠재적으로 희귀한) 고품질 코딩 능력을 향해 모델을 편향하고자 합니다. 유사하게, 우리는 우리의 언어 모델이 50%의 사람들이 믿는 일반적인 오개념의 <span class="ltx_text ltx_font_italic" id="S1.p1.1.2">aware</span>이 되기를 원할 수 있지만, 우리는 확실히 모델이 그것에 대한 50%의 질의에서 이러한 오개념이 참이라고 주장하는 것을 원하지 않는다! 즉, 모델의 <em class="ltx_emph ltx_font_italic" id="S1.p1.1.3">desired response and behavior</em>을 매우 넓은 <span class="ltx_text ltx_font_italic" id="S1.p1.1.4">knowledge and abilities</span>은 안전하고 수행 가능하며 제어 가능한 <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib26" title="">2022</a>)</cite>인 AI 시스템을 구축하는 데 매우 중요합니다. 기존의 방법들은 일반적으로 강화 학습(reinforcement learning, RL)을 사용하여 인간의 선호도와 일치하도록 LMs을 조종하지만, 우리는 기존의 방법들이 사용하는 RL 기반 목적이 간단한 이진 교차 엔트로피 목적으로 정확하게 최적화되어 선호도 학습 파이프라인을 크게 단순화할 수 있음을 보여줄 것이다.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="120" id="S1.F1.g1" src="https://arxiv.org/html/2305.18290v2/extracted/5293438/figures/diagrams/teaser.png" width="598">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 1:</span><span class="ltx_text ltx_font_bold" id="S1.F1.3.1">DPO는 강화 학습을 피하면서 인간 선호도를 최적화한다. </span> 인간 피드백으로 언어 모델을 미세 조정하는 기존 방법은 먼저 응답 쌍에 대한 프롬프트 및 인간 선호도의 데이터 세트에 보상 모델을 적합시킨 다음 RL을 사용하여 학습된 보상을 최대화하는 정책을 찾는다. 대조적으로, DPO는 간단한 분류 목적으로 선호도를 가장 잘 충족하는 정책에 직접 최적화하여 해당 최적 정책이 닫힌 형태로 추출될 수 있는 <span class="ltx_text ltx_font_italic" id="S1.F1.4.2">implicit</span> 보상 모델을 피팅한다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">높은 수준에서 기존 방법은 인간이 안전하고 도움이 된다고 생각하는 행동의 유형을 나타내는 선별된 인간 선호 세트를 사용하여 원하는 행동을 언어 모델에 주입한다. 이 선호도 학습 단계는 대규모 텍스트 데이터 세트에 대한 대규모 비지도 사전 훈련의 초기 단계 이후에 발생한다. 선호도 학습에 대한 가장 간단한 접근법은 고품질 응답의 인간 시연에 대한 감독 미세 조정이지만, 가장 성공적인 방법의 클래스는 인간(또는 AI) 피드백(RLHF/RLAIF; <cite class="ltx_cite ltx_citemacro_citep">(Christiano et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib12" title="">2017</a>; Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib2" title="">2022b</a>)</cite>)으로부터의 강화 학습이다. RLHF 방법들은 보상 모델을 인간의 선호도의 데이터세트에 적합시킨 다음, RL을 사용하여 원래 모델로부터 과도하게 멀리 표류하지 않고 높은 보상이 할당된 응답을 생성하기 위해 언어 모델 정책을 최적화한다. RLHF는 인상적인 대화 및 코딩 능력을 가진 모델을 생성하지만, RLHF 파이프라인은 지도 학습보다 상당히 복잡하며, 이는 다수의 LMs를 훈련시키고 훈련 루프에서 LM 정책으로부터의 샘플링을 수반하여 상당한 계산 비용을 발생시킨다.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">본 논문에서는 명시적 보상 모델링이나 강화 학습 없이 인간의 선호를 고수하기 위해 언어 모델을 직접 최적화하는 방법을 보여준다. 본 논문에서는 기존의 RLHF 알고리즘과 동일한 목적(KL-divergence 제약 조건을 갖는 보상 최대화)을 암묵적으로 최적화하는 알고리즘인 <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">Direct Preference Optimization (DPO)</span>을 제안한다. 직관적으로, DPO 업데이트는 선호되지 않는 응답보다 선호되는 상대적 로그 확률을 증가시키지만, 순진한 확률 비율 목표로 발생하는 모델 변성을 방지하는 동적, 예당 중요도 가중치를 통합한다. 기존 알고리즘과 마찬가지로 DPO는 주어진 보상 함수가 경험적 선호도 데이터와 얼마나 잘 일치하는지 측정하는 이론적 선호도 모델(브래들리-테리 모델; <cite class="ltx_cite ltx_citemacro_cite">Bradley and Terry (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib5" title="">1952</a>)</cite>)에 의존한다. 그러나 기존의 방법들은 선호 모델을 이용하여 선호 손실을 정의하여 보상 모델을 학습시킨 후 학습된 보상 모델을 최적화하는 정책을 학습시키는 반면, DPO는 변수의 변화를 이용하여 선호 손실을 정책의 함수로 직접 정의한다. 따라서 모델 응답에 대한 인간 선호의 데이터 세트가 주어지면 DPO는 간단한 이진 교차 엔트로피 목표를 사용하여 정책을 최적화하여 선호 데이터에 맞는 암시적 보상 함수에 최적의 정책을 생성할 수 있다.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">우리의 주요 기여는 선호도로부터 언어 모델을 훈련시키기 위한 간단한 RL-프리 알고리즘인 직접 선호도 최적화(DPO)이다. 우리의 실험은 DPO가 최대 6B 매개 변수를 가진 언어 모델을 사용하여 감정 변조, 요약 및 대화와 같은 태스크의 선호도로부터 학습하기 위해 PPO 기반 RLHF를 포함한 기존 방법만큼 적어도 효과적임을 보여준다.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">증가하는 스케일의 자기 지도 언어 모델은 일부 작업을 0-shot <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib31" title="">2019</a>)</cite> 또는 적은shot 프롬프트 <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib6" title="">2020a</a>; Narayanan et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib25" title="">2021</a>; Chowdhery et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib11" title="">2022</a>)</cite>로 완료하는 것을 학습한다. 그러나, 다운스트림 태스크들에 대한 그들의 성능 및 사용자 의도와의 정렬은 명령어들의 데이터세트들 및 인간-작성된 완성들 <cite class="ltx_cite ltx_citemacro_citep">(Mishra et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib23" title="">2022</a>; Sanh et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib36" title="">2022</a>; Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib13" title="">2022</a>; Thoppilan et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib39" title="">2022</a>)</cite>에 대한 미세 조정에 의해 상당히 개선될 수 있다. 이러한 '명령-튜닝' 절차는 LLM들이 명령-튜닝 세트 외부의 명령들로 일반화할 수 있게 하고, 일반적으로 그들의 사용성 <cite class="ltx_cite ltx_citemacro_citep">(Chung et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib13" title="">2022</a>)</cite>를 증가시킬 수 있게 한다. 명령어 튜닝의 성공에도 불구하고, <span class="ltx_text ltx_font_italic" id="S2.p1.1.1">relative</span> 인간 응답 품질의 판단은 종종 전문가 시연보다 수집하기 쉬우며, 따라서 후속 작업은 인간 선호도의 데이터 세트로 미세 조정된 LLM을 가지고 번역의 숙련도 향상 <cite class="ltx_cite ltx_citemacro_citep">(Kreutzer et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib18" title="">2018</a>)</cite>, 요약 <cite class="ltx_cite ltx_citemacro_citep">(Stiennon et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib38" title="">2022</a>; Ziegler et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib49" title="">2020</a>)</cite>, 스토리텔링 <cite class="ltx_cite ltx_citemacro_citep">(Ziegler et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib49" title="">2020</a>)</cite>, 명령어 후속 <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib26" title="">2022</a>; Ramamurthy et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib32" title="">2023</a>)</cite>를 포함한다. 이러한 방법들은 먼저 Bradley-Terry 모델 <cite class="ltx_cite ltx_citemacro_citep">(Bradley and Terry, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib5" title="">1952</a>)</cite>와 같은 선호도 모델 하에서 선호도의 데이터세트와의 호환성을 위해 신경망 보상 함수를 최적화한 다음 강화 학습 알고리즘, 일반적으로 REINFORCE <cite class="ltx_cite ltx_citemacro_citep">(Williams, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib45" title="">1992</a>)</cite>, 근접 정책 최적화(PPO; <cite class="ltx_cite ltx_citemacro_cite">Schulman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib37" title="">2017</a>)</cite>), 또는 변형 <cite class="ltx_cite ltx_citemacro_citep">(Ramamurthy et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib32" title="">2023</a>)</cite>를 사용하여 주어진 보상을 최대화하기 위해 언어 모델을 미세 조정한다. 밀접하게 관련된 작업 라인은 LLM 주석에 대한 텍스트 루브릭 형태의 인간으로부터의 약한 감독만을 사용하여 안전성 또는 무해성 <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib2" title="">2022b</a>)</cite>와 같은 표적 속성에 대한 추가 합성 선호도 데이터를 생성하기 위해 인간 피드백으로 후속 지시를 위해 미세 조정된 LLM을 활용한다. 이러한 방법은 언어 모델을 훈련하는 작업의 한 몸체와 다양한 목표를 위한 강화 학습의 다른 작업체 <cite class="ltx_cite ltx_citemacro_citep">(Ranzato et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib33" title="">2015</a>; Paulus et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib27" title="">2018</a>; Wu and Hu, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib46" title="">2018</a>)</cite>와 인간의 선호도로부터 학습하는 일반적인 방법의 다른 작업체 <cite class="ltx_cite ltx_citemacro_citep">(Christiano et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib12" title="">2017</a>; Kupcsik et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib19" title="">2018</a>)</cite>의 융합을 나타낸다. 상대적 인간 선호도를 사용하는 매력에도 불구하고 강화 학습으로 대규모 언어 모델을 미세 조정하는 것은 여전히 중요한 실제 과제이며, 이 작업은 RL 없이 상대적 선호도를 최적화하는 이론적으로 정당화된 접근법을 제공한다.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">언어의 맥락 외에도 선호도로부터의 학습 정책은 강도 및 강화 학습 설정 모두에서 연구되었으며 몇 가지 접근법이 제안되었다. 보상보다는 행동의 선호도나 순위를 이용한 상황적 강도 학습은 상황적 결투 강도(CDB; <cite class="ltx_cite ltx_citemacro_cite">Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib48" title="">2012</a>); Dudík et al. (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib14" title="">2015</a>)</cite>)로 알려져 있다. 절대 보상이 없는 경우 CDB의 이론적 분석에서는 최적 정책의 개념을 <span class="ltx_text ltx_font_italic" id="S2.p2.1.1">von Neumann winner</span>, <span class="ltx_text ltx_font_italic" id="S2.p2.1.2">any</span> 기타 정책에 대한 예상 승률이 최소 50% <cite class="ltx_cite ltx_citemacro_citep">(Dudík et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib14" title="">2015</a>)</cite>로 대체합니다. 그러나 CDB 설정에서는 선호도 레이블이 온라인으로 주어지는 반면, 인간의 선호도로부터 학습하는 경우 일반적으로 오프라인 선호도 주석이 달린 액션 쌍 <cite class="ltx_cite ltx_citemacro_citep">(Yan et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib47" title="">2022</a>)</cite>의 고정 배치에서 학습한다. 마찬가지로 <span class="ltx_text ltx_font_italic" id="S2.p2.1.3">preference-based RL</span> (PbRL)은 보상 <cite class="ltx_cite ltx_citemacro_citep">(Busa-Fekete et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib9" title="">2014</a>; Saha et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib35" title="">2023</a>)</cite>보다는 <span class="ltx_text ltx_font_italic" id="S2.p2.1.4">unknown</span> ‘scoring’ 함수에 의해 생성된 이진 선호도로부터 학습한다. PbRL에 대한 다양한 알고리즘이 존재하는데, 이는 오프-정책 선호도 데이터를 재사용할 수 있는 방법을 포함하지만 일반적으로 먼저 잠재 스코어링 함수(즉, 보상 모델)를 명시적으로 추정하고 후속적으로 <cite class="ltx_cite ltx_citemacro_citep">(Jain et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib16" title="">2013</a>; Busa-Fekete et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib9" title="">2014</a>; Christiano et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib12" title="">2017</a>; Sadigh et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib34" title="">2017</a>; Kupcsik et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib19" title="">2018</a>)</cite>를 최적화하는 것을 포함한다. 대신 선호도를 충족시키기 위해 정책을 직접 최적화하는 단일 단계 정책 학습 접근법을 제시한다.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">우리는 <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib49" title="">Ziegler et al.</a></cite> (및 이후 <cite class="ltx_cite ltx_citemacro_citep">(Stiennon et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib38" title="">2022</a>; Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib1" title="">2022a</a>; Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib26" title="">2022</a>)</cite>)에서 RLHF 파이프라인을 검토한다. 일반적으로 1) 감독 미세 조정(supervised fine-tuning; SFT), 2) 선호도 샘플링 및 보상 학습, 3) RL 최적화 등의 세 단계를 포함한다.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.p2.1.1">SFT</span>: RLHF는 일반적으로 관심 있는 다운스트림 태스크(대화, 요약 등)에 대한 고품질 데이터에 대한 지도 학습으로 사전 훈련된 LM을 미세 조정함으로써 시작하여 모델 <math alttext="\pi^{\text{SFT}}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><msup id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">π</mi><mtext id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3a.cmml">SFT</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">superscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝜋</ci><ci id="S3.p2.1.m1.1.1.3a.cmml" xref="S3.p2.1.m1.1.1.3"><mtext id="S3.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.p2.1.m1.1.1.3">SFT</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\pi^{\text{SFT}}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_π start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT</annotation></semantics></math>를 얻는다.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.8"><span class="ltx_text ltx_font_bold" id="S3.p3.8.1">Reward Modelling Phase</span>: 두 번째 단계에서 SFT 모델은 프롬프트로 프롬프트 <math alttext="x" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_x</annotation></semantics></math>로 프롬프트되어 답변 쌍 <math alttext="(y_{1},y_{2})\sim\pi^{\text{SFT}}(y\mid x)" class="ltx_Math" display="inline" id="S3.p3.2.m2.3"><semantics id="S3.p3.2.m2.3a"><mrow id="S3.p3.2.m2.3.3" xref="S3.p3.2.m2.3.3.cmml"><mrow id="S3.p3.2.m2.2.2.2.2" xref="S3.p3.2.m2.2.2.2.3.cmml"><mo id="S3.p3.2.m2.2.2.2.2.3" stretchy="false" xref="S3.p3.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.p3.2.m2.1.1.1.1.1" xref="S3.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.p3.2.m2.1.1.1.1.1.2" xref="S3.p3.2.m2.1.1.1.1.1.2.cmml">y</mi><mn id="S3.p3.2.m2.1.1.1.1.1.3" xref="S3.p3.2.m2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p3.2.m2.2.2.2.2.4" xref="S3.p3.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.p3.2.m2.2.2.2.2.2" xref="S3.p3.2.m2.2.2.2.2.2.cmml"><mi id="S3.p3.2.m2.2.2.2.2.2.2" xref="S3.p3.2.m2.2.2.2.2.2.2.cmml">y</mi><mn id="S3.p3.2.m2.2.2.2.2.2.3" xref="S3.p3.2.m2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.p3.2.m2.2.2.2.2.5" stretchy="false" xref="S3.p3.2.m2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.p3.2.m2.3.3.4" xref="S3.p3.2.m2.3.3.4.cmml">∼</mo><mrow id="S3.p3.2.m2.3.3.3" xref="S3.p3.2.m2.3.3.3.cmml"><msup id="S3.p3.2.m2.3.3.3.3" xref="S3.p3.2.m2.3.3.3.3.cmml"><mi id="S3.p3.2.m2.3.3.3.3.2" xref="S3.p3.2.m2.3.3.3.3.2.cmml">π</mi><mtext id="S3.p3.2.m2.3.3.3.3.3" xref="S3.p3.2.m2.3.3.3.3.3a.cmml">SFT</mtext></msup><mo id="S3.p3.2.m2.3.3.3.2" xref="S3.p3.2.m2.3.3.3.2.cmml">⁢</mo><mrow id="S3.p3.2.m2.3.3.3.1.1" xref="S3.p3.2.m2.3.3.3.1.1.1.cmml"><mo id="S3.p3.2.m2.3.3.3.1.1.2" stretchy="false" xref="S3.p3.2.m2.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.p3.2.m2.3.3.3.1.1.1" xref="S3.p3.2.m2.3.3.3.1.1.1.cmml"><mi id="S3.p3.2.m2.3.3.3.1.1.1.2" xref="S3.p3.2.m2.3.3.3.1.1.1.2.cmml">y</mi><mo id="S3.p3.2.m2.3.3.3.1.1.1.1" xref="S3.p3.2.m2.3.3.3.1.1.1.1.cmml">∣</mo><mi id="S3.p3.2.m2.3.3.3.1.1.1.3" xref="S3.p3.2.m2.3.3.3.1.1.1.3.cmml">x</mi></mrow><mo id="S3.p3.2.m2.3.3.3.1.1.3" stretchy="false" xref="S3.p3.2.m2.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.3b"><apply id="S3.p3.2.m2.3.3.cmml" xref="S3.p3.2.m2.3.3"><csymbol cd="latexml" id="S3.p3.2.m2.3.3.4.cmml" xref="S3.p3.2.m2.3.3.4">similar-to</csymbol><interval closure="open" id="S3.p3.2.m2.2.2.2.3.cmml" xref="S3.p3.2.m2.2.2.2.2"><apply id="S3.p3.2.m2.1.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.p3.2.m2.1.1.1.1.1.2">𝑦</ci><cn id="S3.p3.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S3.p3.2.m2.1.1.1.1.1.3">1</cn></apply><apply id="S3.p3.2.m2.2.2.2.2.2.cmml" xref="S3.p3.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.2.m2.2.2.2.2.2.1.cmml" xref="S3.p3.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.2.m2.2.2.2.2.2.2.cmml" xref="S3.p3.2.m2.2.2.2.2.2.2">𝑦</ci><cn id="S3.p3.2.m2.2.2.2.2.2.3.cmml" type="integer" xref="S3.p3.2.m2.2.2.2.2.2.3">2</cn></apply></interval><apply id="S3.p3.2.m2.3.3.3.cmml" xref="S3.p3.2.m2.3.3.3"><times id="S3.p3.2.m2.3.3.3.2.cmml" xref="S3.p3.2.m2.3.3.3.2"></times><apply id="S3.p3.2.m2.3.3.3.3.cmml" xref="S3.p3.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.p3.2.m2.3.3.3.3.1.cmml" xref="S3.p3.2.m2.3.3.3.3">superscript</csymbol><ci id="S3.p3.2.m2.3.3.3.3.2.cmml" xref="S3.p3.2.m2.3.3.3.3.2">𝜋</ci><ci id="S3.p3.2.m2.3.3.3.3.3a.cmml" xref="S3.p3.2.m2.3.3.3.3.3"><mtext id="S3.p3.2.m2.3.3.3.3.3.cmml" mathsize="70%" xref="S3.p3.2.m2.3.3.3.3.3">SFT</mtext></ci></apply><apply id="S3.p3.2.m2.3.3.3.1.1.1.cmml" xref="S3.p3.2.m2.3.3.3.1.1"><csymbol cd="latexml" id="S3.p3.2.m2.3.3.3.1.1.1.1.cmml" xref="S3.p3.2.m2.3.3.3.1.1.1.1">conditional</csymbol><ci id="S3.p3.2.m2.3.3.3.1.1.1.2.cmml" xref="S3.p3.2.m2.3.3.3.1.1.1.2">𝑦</ci><ci id="S3.p3.2.m2.3.3.3.1.1.1.3.cmml" xref="S3.p3.2.m2.3.3.3.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.3c">(y_{1},y_{2})\sim\pi^{\text{SFT}}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.3d">( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∼ italic_π start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math>를 생성한다. 이어서, 이들은 하나의 답변에 대한 선호를 표현하는 인간 라벨러에게 제시되며, 여기서 <math alttext="y_{w}\succ y_{l}\mid x" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><mrow id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><msub id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml"><mi id="S3.p3.3.m3.1.1.2.2" xref="S3.p3.3.m3.1.1.2.2.cmml">y</mi><mi id="S3.p3.3.m3.1.1.2.3" xref="S3.p3.3.m3.1.1.2.3.cmml">w</mi></msub><mo id="S3.p3.3.m3.1.1.1" xref="S3.p3.3.m3.1.1.1.cmml">≻</mo><mrow id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml"><msub id="S3.p3.3.m3.1.1.3.2" xref="S3.p3.3.m3.1.1.3.2.cmml"><mi id="S3.p3.3.m3.1.1.3.2.2" xref="S3.p3.3.m3.1.1.3.2.2.cmml">y</mi><mi id="S3.p3.3.m3.1.1.3.2.3" xref="S3.p3.3.m3.1.1.3.2.3.cmml">l</mi></msub><mo id="S3.p3.3.m3.1.1.3.1" xref="S3.p3.3.m3.1.1.3.1.cmml">∣</mo><mi id="S3.p3.3.m3.1.1.3.3" xref="S3.p3.3.m3.1.1.3.3.cmml">x</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="latexml" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1">succeeds</csymbol><apply id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.2.1.cmml" xref="S3.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.2.cmml" xref="S3.p3.3.m3.1.1.2.2">𝑦</ci><ci id="S3.p3.3.m3.1.1.2.3.cmml" xref="S3.p3.3.m3.1.1.2.3">𝑤</ci></apply><apply id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3"><csymbol cd="latexml" id="S3.p3.3.m3.1.1.3.1.cmml" xref="S3.p3.3.m3.1.1.3.1">conditional</csymbol><apply id="S3.p3.3.m3.1.1.3.2.cmml" xref="S3.p3.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.3.2.1.cmml" xref="S3.p3.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.p3.3.m3.1.1.3.2.2.cmml" xref="S3.p3.3.m3.1.1.3.2.2">𝑦</ci><ci id="S3.p3.3.m3.1.1.3.2.3.cmml" xref="S3.p3.3.m3.1.1.3.2.3">𝑙</ci></apply><ci id="S3.p3.3.m3.1.1.3.3.cmml" xref="S3.p3.3.m3.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">y_{w}\succ y_{l}\mid x</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∣ italic_x</annotation></semantics></math>로 표기되며, 여기서 <math alttext="y_{w}" class="ltx_Math" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><msub id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">y</mi><mi id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">𝑦</ci><ci id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> 및 <math alttext="y_{l}" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><msub id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><mi id="S3.p3.5.m5.1.1.2" xref="S3.p3.5.m5.1.1.2.cmml">y</mi><mi id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.cmml" xref="S3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1.2">𝑦</ci><ci id="S3.p3.5.m5.1.1.3.cmml" xref="S3.p3.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">y_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>는 각각 <math alttext="(y_{1},y_{2})" class="ltx_Math" display="inline" id="S3.p3.6.m6.2"><semantics id="S3.p3.6.m6.2a"><mrow id="S3.p3.6.m6.2.2.2" xref="S3.p3.6.m6.2.2.3.cmml"><mo id="S3.p3.6.m6.2.2.2.3" stretchy="false" xref="S3.p3.6.m6.2.2.3.cmml">(</mo><msub id="S3.p3.6.m6.1.1.1.1" xref="S3.p3.6.m6.1.1.1.1.cmml"><mi id="S3.p3.6.m6.1.1.1.1.2" xref="S3.p3.6.m6.1.1.1.1.2.cmml">y</mi><mn id="S3.p3.6.m6.1.1.1.1.3" xref="S3.p3.6.m6.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p3.6.m6.2.2.2.4" xref="S3.p3.6.m6.2.2.3.cmml">,</mo><msub id="S3.p3.6.m6.2.2.2.2" xref="S3.p3.6.m6.2.2.2.2.cmml"><mi id="S3.p3.6.m6.2.2.2.2.2" xref="S3.p3.6.m6.2.2.2.2.2.cmml">y</mi><mn id="S3.p3.6.m6.2.2.2.2.3" xref="S3.p3.6.m6.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.p3.6.m6.2.2.2.5" stretchy="false" xref="S3.p3.6.m6.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.2b"><interval closure="open" id="S3.p3.6.m6.2.2.3.cmml" xref="S3.p3.6.m6.2.2.2"><apply id="S3.p3.6.m6.1.1.1.1.cmml" xref="S3.p3.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.1.1.1.cmml" xref="S3.p3.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.p3.6.m6.1.1.1.1.2.cmml" xref="S3.p3.6.m6.1.1.1.1.2">𝑦</ci><cn id="S3.p3.6.m6.1.1.1.1.3.cmml" type="integer" xref="S3.p3.6.m6.1.1.1.1.3">1</cn></apply><apply id="S3.p3.6.m6.2.2.2.2.cmml" xref="S3.p3.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.6.m6.2.2.2.2.1.cmml" xref="S3.p3.6.m6.2.2.2.2">subscript</csymbol><ci id="S3.p3.6.m6.2.2.2.2.2.cmml" xref="S3.p3.6.m6.2.2.2.2.2">𝑦</ci><cn id="S3.p3.6.m6.2.2.2.2.3.cmml" type="integer" xref="S3.p3.6.m6.2.2.2.2.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.2c">(y_{1},y_{2})</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.2d">( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> 사이에서 선호 및 불추천 완료를 나타낸다. 선호도는 액세스 권한이 없는 일부 잠재 보상 모델 <math alttext="r^{*}(y,x)" class="ltx_Math" display="inline" id="S3.p3.7.m7.2"><semantics id="S3.p3.7.m7.2a"><mrow id="S3.p3.7.m7.2.3" xref="S3.p3.7.m7.2.3.cmml"><msup id="S3.p3.7.m7.2.3.2" xref="S3.p3.7.m7.2.3.2.cmml"><mi id="S3.p3.7.m7.2.3.2.2" xref="S3.p3.7.m7.2.3.2.2.cmml">r</mi><mo id="S3.p3.7.m7.2.3.2.3" xref="S3.p3.7.m7.2.3.2.3.cmml">*</mo></msup><mo id="S3.p3.7.m7.2.3.1" xref="S3.p3.7.m7.2.3.1.cmml">⁢</mo><mrow id="S3.p3.7.m7.2.3.3.2" xref="S3.p3.7.m7.2.3.3.1.cmml"><mo id="S3.p3.7.m7.2.3.3.2.1" stretchy="false" xref="S3.p3.7.m7.2.3.3.1.cmml">(</mo><mi id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml">y</mi><mo id="S3.p3.7.m7.2.3.3.2.2" xref="S3.p3.7.m7.2.3.3.1.cmml">,</mo><mi id="S3.p3.7.m7.2.2" xref="S3.p3.7.m7.2.2.cmml">x</mi><mo id="S3.p3.7.m7.2.3.3.2.3" stretchy="false" xref="S3.p3.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.2b"><apply id="S3.p3.7.m7.2.3.cmml" xref="S3.p3.7.m7.2.3"><times id="S3.p3.7.m7.2.3.1.cmml" xref="S3.p3.7.m7.2.3.1"></times><apply id="S3.p3.7.m7.2.3.2.cmml" xref="S3.p3.7.m7.2.3.2"><csymbol cd="ambiguous" id="S3.p3.7.m7.2.3.2.1.cmml" xref="S3.p3.7.m7.2.3.2">superscript</csymbol><ci id="S3.p3.7.m7.2.3.2.2.cmml" xref="S3.p3.7.m7.2.3.2.2">𝑟</ci><times id="S3.p3.7.m7.2.3.2.3.cmml" xref="S3.p3.7.m7.2.3.2.3"></times></apply><interval closure="open" id="S3.p3.7.m7.2.3.3.1.cmml" xref="S3.p3.7.m7.2.3.3.2"><ci id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1">𝑦</ci><ci id="S3.p3.7.m7.2.2.cmml" xref="S3.p3.7.m7.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.2c">r^{*}(y,x)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.m7.2d">italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y , italic_x )</annotation></semantics></math>에 의해 생성된다고 가정한다. 선호도를 모델링하는 데 사용되는 많은 접근법이 있으며, 브래들리-테리(BT) <cite class="ltx_cite ltx_citemacro_cite">Bradley and Terry (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib5" title="">1952</a>)</cite> 모델은 인기 있는 선택이다(더 일반적인 Plackett-Luce 순위 모델 <cite class="ltx_cite ltx_citemacro_citep">(Plackett, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib30" title="">1975</a>; Luce, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib21" title="">2012</a>)</cite>는 여러 순위가 매겨진 답변에 액세스할 수 있는 경우에도 프레임워크와 호환된다). BT 모델은 인간 선호도 분포 <math alttext="p^{*}" class="ltx_Math" display="inline" id="S3.p3.8.m8.1"><semantics id="S3.p3.8.m8.1a"><msup id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml"><mi id="S3.p3.8.m8.1.1.2" xref="S3.p3.8.m8.1.1.2.cmml">p</mi><mo id="S3.p3.8.m8.1.1.3" xref="S3.p3.8.m8.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><apply id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p3.8.m8.1.1.1.cmml" xref="S3.p3.8.m8.1.1">superscript</csymbol><ci id="S3.p3.8.m8.1.1.2.cmml" xref="S3.p3.8.m8.1.1.2">𝑝</ci><times id="S3.p3.8.m8.1.1.3.cmml" xref="S3.p3.8.m8.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">p^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.m8.1d">italic_p start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>가 다음과 같이 기입될 수 있다고 규정한다:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p^{*}(y_{1}\succ y_{2}\mid x)=\frac{\exp\left(r^{*}(x,y_{1})\right)}{\exp\left%
(r^{*}(x,y_{1})\right)+\exp\left(r^{*}(x,y_{2})\right)}." class="ltx_Math" display="block" id="S3.E1.m1.10"><semantics id="S3.E1.m1.10a"><mrow id="S3.E1.m1.10.10.1" xref="S3.E1.m1.10.10.1.1.cmml"><mrow id="S3.E1.m1.10.10.1.1" xref="S3.E1.m1.10.10.1.1.cmml"><mrow id="S3.E1.m1.10.10.1.1.1" xref="S3.E1.m1.10.10.1.1.1.cmml"><msup id="S3.E1.m1.10.10.1.1.1.3" xref="S3.E1.m1.10.10.1.1.1.3.cmml"><mi id="S3.E1.m1.10.10.1.1.1.3.2" xref="S3.E1.m1.10.10.1.1.1.3.2.cmml">p</mi><mo id="S3.E1.m1.10.10.1.1.1.3.3" xref="S3.E1.m1.10.10.1.1.1.3.3.cmml">*</mo></msup><mo id="S3.E1.m1.10.10.1.1.1.2" xref="S3.E1.m1.10.10.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.10.10.1.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.10.10.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.10.10.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.10.10.1.1.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.10.10.1.1.1.1.1.1.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.10.10.1.1.1.1.1.1.2.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="S3.E1.m1.10.10.1.1.1.1.1.1.2.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E1.m1.10.10.1.1.1.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.cmml">≻</mo><mrow id="S3.E1.m1.10.10.1.1.1.1.1.1.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.cmml"><msub id="S3.E1.m1.10.10.1.1.1.1.1.1.3.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.2.cmml">y</mi><mn id="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo id="S3.E1.m1.10.10.1.1.1.1.1.1.3.1" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.1.cmml">∣</mo><mi id="S3.E1.m1.10.10.1.1.1.1.1.1.3.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S3.E1.m1.10.10.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.10.10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.10.10.1.1.2" xref="S3.E1.m1.10.10.1.1.2.cmml">=</mo><mfrac id="S3.E1.m1.9.9" xref="S3.E1.m1.9.9.cmml"><mrow id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.4.cmml"><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">exp</mi><mo id="S3.E1.m1.3.3.3.3a" xref="S3.E1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E1.m1.3.3.3.3.1" xref="S3.E1.m1.3.3.3.4.cmml"><mo id="S3.E1.m1.3.3.3.3.1.2" xref="S3.E1.m1.3.3.3.4.cmml">(</mo><mrow id="S3.E1.m1.3.3.3.3.1.1" xref="S3.E1.m1.3.3.3.3.1.1.cmml"><msup id="S3.E1.m1.3.3.3.3.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.3.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.3.2" xref="S3.E1.m1.3.3.3.3.1.1.3.2.cmml">r</mi><mo id="S3.E1.m1.3.3.3.3.1.1.3.3" xref="S3.E1.m1.3.3.3.3.1.1.3.3.cmml">*</mo></msup><mo id="S3.E1.m1.3.3.3.3.1.1.2" xref="S3.E1.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.3.3.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">x</mi><mo id="S3.E1.m1.3.3.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.1.2.cmml">,</mo><msub id="S3.E1.m1.3.3.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.2.cmml">y</mi><mn id="S3.E1.m1.3.3.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E1.m1.3.3.3.3.1.1.1.1.4" stretchy="false" xref="S3.E1.m1.3.3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.3.3.1.3" xref="S3.E1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.9.9.9" xref="S3.E1.m1.9.9.9.cmml"><mrow id="S3.E1.m1.8.8.8.5.1" xref="S3.E1.m1.8.8.8.5.2.cmml"><mi id="S3.E1.m1.5.5.5.2" xref="S3.E1.m1.5.5.5.2.cmml">exp</mi><mo id="S3.E1.m1.8.8.8.5.1a" xref="S3.E1.m1.8.8.8.5.2.cmml">⁡</mo><mrow id="S3.E1.m1.8.8.8.5.1.1" xref="S3.E1.m1.8.8.8.5.2.cmml"><mo id="S3.E1.m1.8.8.8.5.1.1.2" xref="S3.E1.m1.8.8.8.5.2.cmml">(</mo><mrow id="S3.E1.m1.8.8.8.5.1.1.1" xref="S3.E1.m1.8.8.8.5.1.1.1.cmml"><msup id="S3.E1.m1.8.8.8.5.1.1.1.3" xref="S3.E1.m1.8.8.8.5.1.1.1.3.cmml"><mi id="S3.E1.m1.8.8.8.5.1.1.1.3.2" xref="S3.E1.m1.8.8.8.5.1.1.1.3.2.cmml">r</mi><mo id="S3.E1.m1.8.8.8.5.1.1.1.3.3" xref="S3.E1.m1.8.8.8.5.1.1.1.3.3.cmml">*</mo></msup><mo id="S3.E1.m1.8.8.8.5.1.1.1.2" xref="S3.E1.m1.8.8.8.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.8.8.8.5.1.1.1.1.1" xref="S3.E1.m1.8.8.8.5.1.1.1.1.2.cmml"><mo id="S3.E1.m1.8.8.8.5.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.8.8.8.5.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.4.4.4.1" xref="S3.E1.m1.4.4.4.1.cmml">x</mi><mo id="S3.E1.m1.8.8.8.5.1.1.1.1.1.3" xref="S3.E1.m1.8.8.8.5.1.1.1.1.2.cmml">,</mo><msub id="S3.E1.m1.8.8.8.5.1.1.1.1.1.1" xref="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.2" xref="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.2.cmml">y</mi><mn id="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.3" xref="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E1.m1.8.8.8.5.1.1.1.1.1.4" stretchy="false" xref="S3.E1.m1.8.8.8.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.8.8.8.5.1.1.3" xref="S3.E1.m1.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.9.9.9.7" xref="S3.E1.m1.9.9.9.7.cmml">+</mo><mrow id="S3.E1.m1.9.9.9.6.1" xref="S3.E1.m1.9.9.9.6.2.cmml"><mi id="S3.E1.m1.7.7.7.4" xref="S3.E1.m1.7.7.7.4.cmml">exp</mi><mo id="S3.E1.m1.9.9.9.6.1a" xref="S3.E1.m1.9.9.9.6.2.cmml">⁡</mo><mrow id="S3.E1.m1.9.9.9.6.1.1" xref="S3.E1.m1.9.9.9.6.2.cmml"><mo id="S3.E1.m1.9.9.9.6.1.1.2" xref="S3.E1.m1.9.9.9.6.2.cmml">(</mo><mrow id="S3.E1.m1.9.9.9.6.1.1.1" xref="S3.E1.m1.9.9.9.6.1.1.1.cmml"><msup id="S3.E1.m1.9.9.9.6.1.1.1.3" xref="S3.E1.m1.9.9.9.6.1.1.1.3.cmml"><mi id="S3.E1.m1.9.9.9.6.1.1.1.3.2" xref="S3.E1.m1.9.9.9.6.1.1.1.3.2.cmml">r</mi><mo id="S3.E1.m1.9.9.9.6.1.1.1.3.3" xref="S3.E1.m1.9.9.9.6.1.1.1.3.3.cmml">*</mo></msup><mo id="S3.E1.m1.9.9.9.6.1.1.1.2" xref="S3.E1.m1.9.9.9.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.9.9.9.6.1.1.1.1.1" xref="S3.E1.m1.9.9.9.6.1.1.1.1.2.cmml"><mo id="S3.E1.m1.9.9.9.6.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.9.9.9.6.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.6.6.6.3" xref="S3.E1.m1.6.6.6.3.cmml">x</mi><mo id="S3.E1.m1.9.9.9.6.1.1.1.1.1.3" xref="S3.E1.m1.9.9.9.6.1.1.1.1.2.cmml">,</mo><msub id="S3.E1.m1.9.9.9.6.1.1.1.1.1.1" xref="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.2" xref="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.2.cmml">y</mi><mn id="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.3" xref="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E1.m1.9.9.9.6.1.1.1.1.1.4" stretchy="false" xref="S3.E1.m1.9.9.9.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.9.9.9.6.1.1.3" xref="S3.E1.m1.9.9.9.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E1.m1.10.10.1.2" lspace="0em" xref="S3.E1.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.10b"><apply id="S3.E1.m1.10.10.1.1.cmml" xref="S3.E1.m1.10.10.1"><eq id="S3.E1.m1.10.10.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.2"></eq><apply id="S3.E1.m1.10.10.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1"><times id="S3.E1.m1.10.10.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.2"></times><apply id="S3.E1.m1.10.10.1.1.1.3.cmml" xref="S3.E1.m1.10.10.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.10.10.1.1.1.3.1.cmml" xref="S3.E1.m1.10.10.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.10.10.1.1.1.3.2.cmml" xref="S3.E1.m1.10.10.1.1.1.3.2">𝑝</ci><times id="S3.E1.m1.10.10.1.1.1.3.3.cmml" xref="S3.E1.m1.10.10.1.1.1.3.3"></times></apply><apply id="S3.E1.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1">succeeds</csymbol><apply id="S3.E1.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.10.10.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2.2">𝑦</ci><cn id="S3.E1.m1.10.10.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E1.m1.10.10.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E1.m1.10.10.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.2">𝑦</ci><cn id="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.2.3">2</cn></apply><ci id="S3.E1.m1.10.10.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="S3.E1.m1.9.9.cmml" xref="S3.E1.m1.9.9"><divide id="S3.E1.m1.9.9.10.cmml" xref="S3.E1.m1.9.9"></divide><apply id="S3.E1.m1.3.3.3.4.cmml" xref="S3.E1.m1.3.3.3.3"><exp id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"></exp><apply id="S3.E1.m1.3.3.3.3.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1"><times id="S3.E1.m1.3.3.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2"></times><apply id="S3.E1.m1.3.3.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.3">superscript</csymbol><ci id="S3.E1.m1.3.3.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.3.2">𝑟</ci><times id="S3.E1.m1.3.3.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.3.3"></times></apply><interval closure="open" id="S3.E1.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑥</ci><apply id="S3.E1.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.2">𝑦</ci><cn id="S3.E1.m1.3.3.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.3">1</cn></apply></interval></apply></apply><apply id="S3.E1.m1.9.9.9.cmml" xref="S3.E1.m1.9.9.9"><plus id="S3.E1.m1.9.9.9.7.cmml" xref="S3.E1.m1.9.9.9.7"></plus><apply id="S3.E1.m1.8.8.8.5.2.cmml" xref="S3.E1.m1.8.8.8.5.1"><exp id="S3.E1.m1.5.5.5.2.cmml" xref="S3.E1.m1.5.5.5.2"></exp><apply id="S3.E1.m1.8.8.8.5.1.1.1.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1"><times id="S3.E1.m1.8.8.8.5.1.1.1.2.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1.2"></times><apply id="S3.E1.m1.8.8.8.5.1.1.1.3.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.8.5.1.1.1.3.1.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.8.8.8.5.1.1.1.3.2.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1.3.2">𝑟</ci><times id="S3.E1.m1.8.8.8.5.1.1.1.3.3.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1.3.3"></times></apply><interval closure="open" id="S3.E1.m1.8.8.8.5.1.1.1.1.2.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1.1.1"><ci id="S3.E1.m1.4.4.4.1.cmml" xref="S3.E1.m1.4.4.4.1">𝑥</ci><apply id="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.2">𝑦</ci><cn id="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.8.8.8.5.1.1.1.1.1.1.3">1</cn></apply></interval></apply></apply><apply id="S3.E1.m1.9.9.9.6.2.cmml" xref="S3.E1.m1.9.9.9.6.1"><exp id="S3.E1.m1.7.7.7.4.cmml" xref="S3.E1.m1.7.7.7.4"></exp><apply id="S3.E1.m1.9.9.9.6.1.1.1.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1"><times id="S3.E1.m1.9.9.9.6.1.1.1.2.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1.2"></times><apply id="S3.E1.m1.9.9.9.6.1.1.1.3.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.9.6.1.1.1.3.1.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.9.9.9.6.1.1.1.3.2.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1.3.2">𝑟</ci><times id="S3.E1.m1.9.9.9.6.1.1.1.3.3.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1.3.3"></times></apply><interval closure="open" id="S3.E1.m1.9.9.9.6.1.1.1.1.2.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1.1.1"><ci id="S3.E1.m1.6.6.6.3.cmml" xref="S3.E1.m1.6.6.6.3">𝑥</ci><apply id="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.2">𝑦</ci><cn id="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.9.9.9.6.1.1.1.1.1.1.3">2</cn></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.10c">p^{*}(y_{1}\succ y_{2}\mid x)=\frac{\exp\left(r^{*}(x,y_{1})\right)}{\exp\left%
(r^{*}(x,y_{1})\right)+\exp\left(r^{*}(x,y_{2})\right)}.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.10d">italic_p start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∣ italic_x ) = divide start_ARG roman_exp ( italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ) end_ARG start_ARG roman_exp ( italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ) + roman_exp ( italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.11"><math alttext="p^{*}" class="ltx_Math" display="inline" id="S3.p3.10.m2.1"><semantics id="S3.p3.10.m2.1a"><msup id="S3.p3.10.m2.1.1" xref="S3.p3.10.m2.1.1.cmml"><mi id="S3.p3.10.m2.1.1.2" xref="S3.p3.10.m2.1.1.2.cmml">p</mi><mo id="S3.p3.10.m2.1.1.3" xref="S3.p3.10.m2.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p3.10.m2.1b"><apply id="S3.p3.10.m2.1.1.cmml" xref="S3.p3.10.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.10.m2.1.1.1.cmml" xref="S3.p3.10.m2.1.1">superscript</csymbol><ci id="S3.p3.10.m2.1.1.2.cmml" xref="S3.p3.10.m2.1.1.2">𝑝</ci><times id="S3.p3.10.m2.1.1.3.cmml" xref="S3.p3.10.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m2.1c">p^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.10.m2.1d">italic_p start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>에서 샘플링된 비교 <math alttext="\mathcal{D}=\bigl{\{}x^{(i)},y_{w}^{(i)},y_{l}^{(i)}\bigr{\}}_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.p3.9.m1.6"><semantics id="S3.p3.9.m1.6a"><mrow id="S3.p3.9.m1.6.6" xref="S3.p3.9.m1.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.9.m1.6.6.5" xref="S3.p3.9.m1.6.6.5.cmml">𝒟</mi><mo id="S3.p3.9.m1.6.6.4" xref="S3.p3.9.m1.6.6.4.cmml">=</mo><msubsup id="S3.p3.9.m1.6.6.3" xref="S3.p3.9.m1.6.6.3.cmml"><mrow id="S3.p3.9.m1.6.6.3.3.3.3" xref="S3.p3.9.m1.6.6.3.3.3.4.cmml"><mo id="S3.p3.9.m1.6.6.3.3.3.3.4" maxsize="120%" minsize="120%" xref="S3.p3.9.m1.6.6.3.3.3.4.cmml">{</mo><msup id="S3.p3.9.m1.4.4.1.1.1.1.1" xref="S3.p3.9.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.p3.9.m1.4.4.1.1.1.1.1.2" xref="S3.p3.9.m1.4.4.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.p3.9.m1.1.1.1.3" xref="S3.p3.9.m1.4.4.1.1.1.1.1.cmml"><mo id="S3.p3.9.m1.1.1.1.3.1" stretchy="false" xref="S3.p3.9.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="S3.p3.9.m1.1.1.1.1" xref="S3.p3.9.m1.1.1.1.1.cmml">i</mi><mo id="S3.p3.9.m1.1.1.1.3.2" stretchy="false" xref="S3.p3.9.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.p3.9.m1.6.6.3.3.3.3.5" xref="S3.p3.9.m1.6.6.3.3.3.4.cmml">,</mo><msubsup id="S3.p3.9.m1.5.5.2.2.2.2.2" xref="S3.p3.9.m1.5.5.2.2.2.2.2.cmml"><mi id="S3.p3.9.m1.5.5.2.2.2.2.2.2.2" xref="S3.p3.9.m1.5.5.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.p3.9.m1.5.5.2.2.2.2.2.2.3" xref="S3.p3.9.m1.5.5.2.2.2.2.2.2.3.cmml">w</mi><mrow id="S3.p3.9.m1.2.2.1.3" xref="S3.p3.9.m1.5.5.2.2.2.2.2.cmml"><mo id="S3.p3.9.m1.2.2.1.3.1" stretchy="false" xref="S3.p3.9.m1.5.5.2.2.2.2.2.cmml">(</mo><mi id="S3.p3.9.m1.2.2.1.1" xref="S3.p3.9.m1.2.2.1.1.cmml">i</mi><mo id="S3.p3.9.m1.2.2.1.3.2" stretchy="false" xref="S3.p3.9.m1.5.5.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.p3.9.m1.6.6.3.3.3.3.6" xref="S3.p3.9.m1.6.6.3.3.3.4.cmml">,</mo><msubsup id="S3.p3.9.m1.6.6.3.3.3.3.3" xref="S3.p3.9.m1.6.6.3.3.3.3.3.cmml"><mi id="S3.p3.9.m1.6.6.3.3.3.3.3.2.2" xref="S3.p3.9.m1.6.6.3.3.3.3.3.2.2.cmml">y</mi><mi id="S3.p3.9.m1.6.6.3.3.3.3.3.2.3" xref="S3.p3.9.m1.6.6.3.3.3.3.3.2.3.cmml">l</mi><mrow id="S3.p3.9.m1.3.3.1.3" xref="S3.p3.9.m1.6.6.3.3.3.3.3.cmml"><mo id="S3.p3.9.m1.3.3.1.3.1" stretchy="false" xref="S3.p3.9.m1.6.6.3.3.3.3.3.cmml">(</mo><mi id="S3.p3.9.m1.3.3.1.1" xref="S3.p3.9.m1.3.3.1.1.cmml">i</mi><mo id="S3.p3.9.m1.3.3.1.3.2" stretchy="false" xref="S3.p3.9.m1.6.6.3.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.p3.9.m1.6.6.3.3.3.3.7" maxsize="120%" minsize="120%" xref="S3.p3.9.m1.6.6.3.3.3.4.cmml">}</mo></mrow><mrow id="S3.p3.9.m1.6.6.3.3.5" xref="S3.p3.9.m1.6.6.3.3.5.cmml"><mi id="S3.p3.9.m1.6.6.3.3.5.2" xref="S3.p3.9.m1.6.6.3.3.5.2.cmml">i</mi><mo id="S3.p3.9.m1.6.6.3.3.5.1" xref="S3.p3.9.m1.6.6.3.3.5.1.cmml">=</mo><mn id="S3.p3.9.m1.6.6.3.3.5.3" xref="S3.p3.9.m1.6.6.3.3.5.3.cmml">1</mn></mrow><mi id="S3.p3.9.m1.6.6.3.5" xref="S3.p3.9.m1.6.6.3.5.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.9.m1.6b"><apply id="S3.p3.9.m1.6.6.cmml" xref="S3.p3.9.m1.6.6"><eq id="S3.p3.9.m1.6.6.4.cmml" xref="S3.p3.9.m1.6.6.4"></eq><ci id="S3.p3.9.m1.6.6.5.cmml" xref="S3.p3.9.m1.6.6.5">𝒟</ci><apply id="S3.p3.9.m1.6.6.3.cmml" xref="S3.p3.9.m1.6.6.3"><csymbol cd="ambiguous" id="S3.p3.9.m1.6.6.3.4.cmml" xref="S3.p3.9.m1.6.6.3">superscript</csymbol><apply id="S3.p3.9.m1.6.6.3.3.cmml" xref="S3.p3.9.m1.6.6.3"><csymbol cd="ambiguous" id="S3.p3.9.m1.6.6.3.3.4.cmml" xref="S3.p3.9.m1.6.6.3">subscript</csymbol><set id="S3.p3.9.m1.6.6.3.3.3.4.cmml" xref="S3.p3.9.m1.6.6.3.3.3.3"><apply id="S3.p3.9.m1.4.4.1.1.1.1.1.cmml" xref="S3.p3.9.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.p3.9.m1.4.4.1.1.1.1.1">superscript</csymbol><ci id="S3.p3.9.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.p3.9.m1.4.4.1.1.1.1.1.2">𝑥</ci><ci id="S3.p3.9.m1.1.1.1.1.cmml" xref="S3.p3.9.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.p3.9.m1.5.5.2.2.2.2.2.cmml" xref="S3.p3.9.m1.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.9.m1.5.5.2.2.2.2.2.1.cmml" xref="S3.p3.9.m1.5.5.2.2.2.2.2">superscript</csymbol><apply id="S3.p3.9.m1.5.5.2.2.2.2.2.2.cmml" xref="S3.p3.9.m1.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.9.m1.5.5.2.2.2.2.2.2.1.cmml" xref="S3.p3.9.m1.5.5.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.9.m1.5.5.2.2.2.2.2.2.2.cmml" xref="S3.p3.9.m1.5.5.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.p3.9.m1.5.5.2.2.2.2.2.2.3.cmml" xref="S3.p3.9.m1.5.5.2.2.2.2.2.2.3">𝑤</ci></apply><ci id="S3.p3.9.m1.2.2.1.1.cmml" xref="S3.p3.9.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.p3.9.m1.6.6.3.3.3.3.3.cmml" xref="S3.p3.9.m1.6.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p3.9.m1.6.6.3.3.3.3.3.1.cmml" xref="S3.p3.9.m1.6.6.3.3.3.3.3">superscript</csymbol><apply id="S3.p3.9.m1.6.6.3.3.3.3.3.2.cmml" xref="S3.p3.9.m1.6.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p3.9.m1.6.6.3.3.3.3.3.2.1.cmml" xref="S3.p3.9.m1.6.6.3.3.3.3.3">subscript</csymbol><ci id="S3.p3.9.m1.6.6.3.3.3.3.3.2.2.cmml" xref="S3.p3.9.m1.6.6.3.3.3.3.3.2.2">𝑦</ci><ci id="S3.p3.9.m1.6.6.3.3.3.3.3.2.3.cmml" xref="S3.p3.9.m1.6.6.3.3.3.3.3.2.3">𝑙</ci></apply><ci id="S3.p3.9.m1.3.3.1.1.cmml" xref="S3.p3.9.m1.3.3.1.1">𝑖</ci></apply></set><apply id="S3.p3.9.m1.6.6.3.3.5.cmml" xref="S3.p3.9.m1.6.6.3.3.5"><eq id="S3.p3.9.m1.6.6.3.3.5.1.cmml" xref="S3.p3.9.m1.6.6.3.3.5.1"></eq><ci id="S3.p3.9.m1.6.6.3.3.5.2.cmml" xref="S3.p3.9.m1.6.6.3.3.5.2">𝑖</ci><cn id="S3.p3.9.m1.6.6.3.3.5.3.cmml" type="integer" xref="S3.p3.9.m1.6.6.3.3.5.3">1</cn></apply></apply><ci id="S3.p3.9.m1.6.6.3.5.cmml" xref="S3.p3.9.m1.6.6.3.5">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m1.6c">\mathcal{D}=\bigl{\{}x^{(i)},y_{w}^{(i)},y_{l}^{(i)}\bigr{\}}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.m1.6d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>의 정적 데이터세트에 대한 액세스를 가정하면, 보상 모델 <math alttext="r_{\phi}(x,y)" class="ltx_Math" display="inline" id="S3.p3.11.m3.2"><semantics id="S3.p3.11.m3.2a"><mrow id="S3.p3.11.m3.2.3" xref="S3.p3.11.m3.2.3.cmml"><msub id="S3.p3.11.m3.2.3.2" xref="S3.p3.11.m3.2.3.2.cmml"><mi id="S3.p3.11.m3.2.3.2.2" xref="S3.p3.11.m3.2.3.2.2.cmml">r</mi><mi id="S3.p3.11.m3.2.3.2.3" xref="S3.p3.11.m3.2.3.2.3.cmml">ϕ</mi></msub><mo id="S3.p3.11.m3.2.3.1" xref="S3.p3.11.m3.2.3.1.cmml">⁢</mo><mrow id="S3.p3.11.m3.2.3.3.2" xref="S3.p3.11.m3.2.3.3.1.cmml"><mo id="S3.p3.11.m3.2.3.3.2.1" stretchy="false" xref="S3.p3.11.m3.2.3.3.1.cmml">(</mo><mi id="S3.p3.11.m3.1.1" xref="S3.p3.11.m3.1.1.cmml">x</mi><mo id="S3.p3.11.m3.2.3.3.2.2" xref="S3.p3.11.m3.2.3.3.1.cmml">,</mo><mi id="S3.p3.11.m3.2.2" xref="S3.p3.11.m3.2.2.cmml">y</mi><mo id="S3.p3.11.m3.2.3.3.2.3" stretchy="false" xref="S3.p3.11.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.11.m3.2b"><apply id="S3.p3.11.m3.2.3.cmml" xref="S3.p3.11.m3.2.3"><times id="S3.p3.11.m3.2.3.1.cmml" xref="S3.p3.11.m3.2.3.1"></times><apply id="S3.p3.11.m3.2.3.2.cmml" xref="S3.p3.11.m3.2.3.2"><csymbol cd="ambiguous" id="S3.p3.11.m3.2.3.2.1.cmml" xref="S3.p3.11.m3.2.3.2">subscript</csymbol><ci id="S3.p3.11.m3.2.3.2.2.cmml" xref="S3.p3.11.m3.2.3.2.2">𝑟</ci><ci id="S3.p3.11.m3.2.3.2.3.cmml" xref="S3.p3.11.m3.2.3.2.3">italic-ϕ</ci></apply><interval closure="open" id="S3.p3.11.m3.2.3.3.1.cmml" xref="S3.p3.11.m3.2.3.3.2"><ci id="S3.p3.11.m3.1.1.cmml" xref="S3.p3.11.m3.1.1">𝑥</ci><ci id="S3.p3.11.m3.2.2.cmml" xref="S3.p3.11.m3.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m3.2c">r_{\phi}(x,y)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.11.m3.2d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y )</annotation></semantics></math>를 파라미터화하고 최대 우도를 통해 파라미터를 추정할 수 있다. 문제를 이진 분류로 프레이밍하면 음의 로그 우도 손실이 있습니다.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{R}(r_{\phi},\mathcal{D})=-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal%
{D}}\bigl{[}\log\sigma(r_{\phi}(x,y_{w})-r_{\phi}(x,y_{l}))\bigr{]}" class="ltx_Math" display="block" id="S3.E2.m1.8"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml"><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.cmml"><msub id="S3.E2.m1.7.7.1.3" xref="S3.E2.m1.7.7.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.7.7.1.3.2" xref="S3.E2.m1.7.7.1.3.2.cmml">ℒ</mi><mi id="S3.E2.m1.7.7.1.3.3" xref="S3.E2.m1.7.7.1.3.3.cmml">R</mi></msub><mo id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.2.cmml"><mo id="S3.E2.m1.7.7.1.1.1.2" stretchy="false" xref="S3.E2.m1.7.7.1.1.2.cmml">(</mo><msub id="S3.E2.m1.7.7.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml">r</mi><mi id="S3.E2.m1.7.7.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.3.cmml">ϕ</mi></msub><mo id="S3.E2.m1.7.7.1.1.1.3" xref="S3.E2.m1.7.7.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">𝒟</mi><mo id="S3.E2.m1.7.7.1.1.1.4" stretchy="false" xref="S3.E2.m1.7.7.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.3" xref="S3.E2.m1.8.8.3.cmml">=</mo><mrow id="S3.E2.m1.8.8.2" xref="S3.E2.m1.8.8.2.cmml"><mo id="S3.E2.m1.8.8.2a" xref="S3.E2.m1.8.8.2.cmml">−</mo><mrow id="S3.E2.m1.8.8.2.1" xref="S3.E2.m1.8.8.2.1.cmml"><msub id="S3.E2.m1.8.8.2.1.3" xref="S3.E2.m1.8.8.2.1.3.cmml"><mi id="S3.E2.m1.8.8.2.1.3.2" xref="S3.E2.m1.8.8.2.1.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml"><mrow id="S3.E2.m1.3.3.3.3.2" xref="S3.E2.m1.3.3.3.3.3.cmml"><mo id="S3.E2.m1.3.3.3.3.2.3" stretchy="false" xref="S3.E2.m1.3.3.3.3.3.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">x</mi><mo id="S3.E2.m1.3.3.3.3.2.4" xref="S3.E2.m1.3.3.3.3.3.cmml">,</mo><msub id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml">y</mi><mi id="S3.E2.m1.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.3.cmml">w</mi></msub><mo id="S3.E2.m1.3.3.3.3.2.5" xref="S3.E2.m1.3.3.3.3.3.cmml">,</mo><msub id="S3.E2.m1.3.3.3.3.2.2" xref="S3.E2.m1.3.3.3.3.2.2.cmml"><mi id="S3.E2.m1.3.3.3.3.2.2.2" xref="S3.E2.m1.3.3.3.3.2.2.2.cmml">y</mi><mi id="S3.E2.m1.3.3.3.3.2.2.3" xref="S3.E2.m1.3.3.3.3.2.2.3.cmml">l</mi></msub><mo id="S3.E2.m1.3.3.3.3.2.6" stretchy="false" xref="S3.E2.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="S3.E2.m1.3.3.3.4" xref="S3.E2.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.3.5" xref="S3.E2.m1.3.3.3.5.cmml">𝒟</mi></mrow></msub><mo id="S3.E2.m1.8.8.2.1.2" xref="S3.E2.m1.8.8.2.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.2.1.1.1" xref="S3.E2.m1.8.8.2.1.1.2.cmml"><mo id="S3.E2.m1.8.8.2.1.1.1.2" maxsize="120%" minsize="120%" xref="S3.E2.m1.8.8.2.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.8.8.2.1.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.cmml"><mrow id="S3.E2.m1.8.8.2.1.1.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.1.3.cmml"><mi id="S3.E2.m1.8.8.2.1.1.1.1.3.1" xref="S3.E2.m1.8.8.2.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E2.m1.8.8.2.1.1.1.1.3a" lspace="0.167em" xref="S3.E2.m1.8.8.2.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E2.m1.8.8.2.1.1.1.1.3.2" xref="S3.E2.m1.8.8.2.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S3.E2.m1.8.8.2.1.1.1.1.2" xref="S3.E2.m1.8.8.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.2.1.1.1.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">x</mi><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">w</mi></msub><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.3.cmml">ϕ</mi></msub><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.2.cmml"><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.2.cmml">(</mo><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">x</mi><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.2.cmml">,</mo><msub id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml">y</mi><mi id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml">l</mi></msub><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.4" stretchy="false" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.2.1.1.1.3" maxsize="120%" minsize="120%" xref="S3.E2.m1.8.8.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8"><eq id="S3.E2.m1.8.8.3.cmml" xref="S3.E2.m1.8.8.3"></eq><apply id="S3.E2.m1.7.7.1.cmml" xref="S3.E2.m1.7.7.1"><times id="S3.E2.m1.7.7.1.2.cmml" xref="S3.E2.m1.7.7.1.2"></times><apply id="S3.E2.m1.7.7.1.3.cmml" xref="S3.E2.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.3.1.cmml" xref="S3.E2.m1.7.7.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.3.2.cmml" xref="S3.E2.m1.7.7.1.3.2">ℒ</ci><ci id="S3.E2.m1.7.7.1.3.3.cmml" xref="S3.E2.m1.7.7.1.3.3">𝑅</ci></apply><interval closure="open" id="S3.E2.m1.7.7.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1"><apply id="S3.E2.m1.7.7.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2">𝑟</ci><ci id="S3.E2.m1.7.7.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3">italic-ϕ</ci></apply><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝒟</ci></interval></apply><apply id="S3.E2.m1.8.8.2.cmml" xref="S3.E2.m1.8.8.2"><minus id="S3.E2.m1.8.8.2.2.cmml" xref="S3.E2.m1.8.8.2"></minus><apply id="S3.E2.m1.8.8.2.1.cmml" xref="S3.E2.m1.8.8.2.1"><times id="S3.E2.m1.8.8.2.1.2.cmml" xref="S3.E2.m1.8.8.2.1.2"></times><apply id="S3.E2.m1.8.8.2.1.3.cmml" xref="S3.E2.m1.8.8.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.1.3.1.cmml" xref="S3.E2.m1.8.8.2.1.3">subscript</csymbol><ci id="S3.E2.m1.8.8.2.1.3.2.cmml" xref="S3.E2.m1.8.8.2.1.3.2">𝔼</ci><apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3"><csymbol cd="latexml" id="S3.E2.m1.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.4">similar-to</csymbol><vector id="S3.E2.m1.3.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.2"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑥</ci><apply id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="S3.E2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="S3.E2.m1.3.3.3.3.2.2.cmml" xref="S3.E2.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.2.2.1.cmml" xref="S3.E2.m1.3.3.3.3.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.2.2.2">𝑦</ci><ci id="S3.E2.m1.3.3.3.3.2.2.3.cmml" xref="S3.E2.m1.3.3.3.3.2.2.3">𝑙</ci></apply></vector><ci id="S3.E2.m1.3.3.3.5.cmml" xref="S3.E2.m1.3.3.3.5">𝒟</ci></apply></apply><apply id="S3.E2.m1.8.8.2.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.8.8.2.1.1.2.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.8.8.2.1.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1"><times id="S3.E2.m1.8.8.2.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.2"></times><apply id="S3.E2.m1.8.8.2.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.3"><log id="S3.E2.m1.8.8.2.1.1.1.1.3.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.3.1"></log><ci id="S3.E2.m1.8.8.2.1.1.1.1.3.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.3.2">𝜎</ci></apply><apply id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1"><minus id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.3"></minus><apply id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.3.3">italic-ϕ</ci></apply><interval closure="open" id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝑥</ci><apply id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑤</ci></apply></interval></apply><apply id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.2"></times><apply id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.3.3">italic-ϕ</ci></apply><interval closure="open" id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1"><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">𝑥</ci><apply id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.2">𝑦</ci><ci id="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.8.8.2.1.1.1.1.1.1.1.2.1.1.1.3">𝑙</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">\mathcal{L}_{R}(r_{\phi},\mathcal{D})=-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal%
{D}}\bigl{[}\log\sigma(r_{\phi}(x,y_{w})-r_{\phi}(x,y_{l}))\bigr{]}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.8d">caligraphic_L start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT , caligraphic_D ) = - blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ roman_log italic_σ ( italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) - italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.16">여기서 <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.p3.12.m1.1"><semantics id="S3.p3.12.m1.1a"><mi id="S3.p3.12.m1.1.1" xref="S3.p3.12.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.12.m1.1b"><ci id="S3.p3.12.m1.1.1.cmml" xref="S3.p3.12.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.p3.12.m1.1d">italic_σ</annotation></semantics></math>는 로지스틱 함수이다. LM들의 맥락에서, 네트워크 <math alttext="r_{\phi}(x,y)" class="ltx_Math" display="inline" id="S3.p3.13.m2.2"><semantics id="S3.p3.13.m2.2a"><mrow id="S3.p3.13.m2.2.3" xref="S3.p3.13.m2.2.3.cmml"><msub id="S3.p3.13.m2.2.3.2" xref="S3.p3.13.m2.2.3.2.cmml"><mi id="S3.p3.13.m2.2.3.2.2" xref="S3.p3.13.m2.2.3.2.2.cmml">r</mi><mi id="S3.p3.13.m2.2.3.2.3" xref="S3.p3.13.m2.2.3.2.3.cmml">ϕ</mi></msub><mo id="S3.p3.13.m2.2.3.1" xref="S3.p3.13.m2.2.3.1.cmml">⁢</mo><mrow id="S3.p3.13.m2.2.3.3.2" xref="S3.p3.13.m2.2.3.3.1.cmml"><mo id="S3.p3.13.m2.2.3.3.2.1" stretchy="false" xref="S3.p3.13.m2.2.3.3.1.cmml">(</mo><mi id="S3.p3.13.m2.1.1" xref="S3.p3.13.m2.1.1.cmml">x</mi><mo id="S3.p3.13.m2.2.3.3.2.2" xref="S3.p3.13.m2.2.3.3.1.cmml">,</mo><mi id="S3.p3.13.m2.2.2" xref="S3.p3.13.m2.2.2.cmml">y</mi><mo id="S3.p3.13.m2.2.3.3.2.3" stretchy="false" xref="S3.p3.13.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.13.m2.2b"><apply id="S3.p3.13.m2.2.3.cmml" xref="S3.p3.13.m2.2.3"><times id="S3.p3.13.m2.2.3.1.cmml" xref="S3.p3.13.m2.2.3.1"></times><apply id="S3.p3.13.m2.2.3.2.cmml" xref="S3.p3.13.m2.2.3.2"><csymbol cd="ambiguous" id="S3.p3.13.m2.2.3.2.1.cmml" xref="S3.p3.13.m2.2.3.2">subscript</csymbol><ci id="S3.p3.13.m2.2.3.2.2.cmml" xref="S3.p3.13.m2.2.3.2.2">𝑟</ci><ci id="S3.p3.13.m2.2.3.2.3.cmml" xref="S3.p3.13.m2.2.3.2.3">italic-ϕ</ci></apply><interval closure="open" id="S3.p3.13.m2.2.3.3.1.cmml" xref="S3.p3.13.m2.2.3.3.2"><ci id="S3.p3.13.m2.1.1.cmml" xref="S3.p3.13.m2.1.1">𝑥</ci><ci id="S3.p3.13.m2.2.2.cmml" xref="S3.p3.13.m2.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m2.2c">r_{\phi}(x,y)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.13.m2.2d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y )</annotation></semantics></math>는 종종 보상 값 <cite class="ltx_cite ltx_citemacro_cite">Ziegler et al. (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib49" title="">2020</a>)</cite>에 대한 단일 스칼라 예측을 생성하는 최종 변압기 층의 상부에 선형 층을 추가하여 SFT 모델 <math alttext="\pi^{\text{SFT}}(y\mid x)" class="ltx_Math" display="inline" id="S3.p3.14.m3.1"><semantics id="S3.p3.14.m3.1a"><mrow id="S3.p3.14.m3.1.1" xref="S3.p3.14.m3.1.1.cmml"><msup id="S3.p3.14.m3.1.1.3" xref="S3.p3.14.m3.1.1.3.cmml"><mi id="S3.p3.14.m3.1.1.3.2" xref="S3.p3.14.m3.1.1.3.2.cmml">π</mi><mtext id="S3.p3.14.m3.1.1.3.3" xref="S3.p3.14.m3.1.1.3.3a.cmml">SFT</mtext></msup><mo id="S3.p3.14.m3.1.1.2" xref="S3.p3.14.m3.1.1.2.cmml">⁢</mo><mrow id="S3.p3.14.m3.1.1.1.1" xref="S3.p3.14.m3.1.1.1.1.1.cmml"><mo id="S3.p3.14.m3.1.1.1.1.2" stretchy="false" xref="S3.p3.14.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.p3.14.m3.1.1.1.1.1" xref="S3.p3.14.m3.1.1.1.1.1.cmml"><mi id="S3.p3.14.m3.1.1.1.1.1.2" xref="S3.p3.14.m3.1.1.1.1.1.2.cmml">y</mi><mo id="S3.p3.14.m3.1.1.1.1.1.1" xref="S3.p3.14.m3.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.p3.14.m3.1.1.1.1.1.3" xref="S3.p3.14.m3.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.p3.14.m3.1.1.1.1.3" stretchy="false" xref="S3.p3.14.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.14.m3.1b"><apply id="S3.p3.14.m3.1.1.cmml" xref="S3.p3.14.m3.1.1"><times id="S3.p3.14.m3.1.1.2.cmml" xref="S3.p3.14.m3.1.1.2"></times><apply id="S3.p3.14.m3.1.1.3.cmml" xref="S3.p3.14.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p3.14.m3.1.1.3.1.cmml" xref="S3.p3.14.m3.1.1.3">superscript</csymbol><ci id="S3.p3.14.m3.1.1.3.2.cmml" xref="S3.p3.14.m3.1.1.3.2">𝜋</ci><ci id="S3.p3.14.m3.1.1.3.3a.cmml" xref="S3.p3.14.m3.1.1.3.3"><mtext id="S3.p3.14.m3.1.1.3.3.cmml" mathsize="70%" xref="S3.p3.14.m3.1.1.3.3">SFT</mtext></ci></apply><apply id="S3.p3.14.m3.1.1.1.1.1.cmml" xref="S3.p3.14.m3.1.1.1.1"><csymbol cd="latexml" id="S3.p3.14.m3.1.1.1.1.1.1.cmml" xref="S3.p3.14.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p3.14.m3.1.1.1.1.1.2.cmml" xref="S3.p3.14.m3.1.1.1.1.1.2">𝑦</ci><ci id="S3.p3.14.m3.1.1.1.1.1.3.cmml" xref="S3.p3.14.m3.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.14.m3.1c">\pi^{\text{SFT}}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.14.m3.1d">italic_π start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math>로부터 초기화된다. 더 낮은 분산을 갖는 보상 함수를 보장하기 위해, 선행 작업들은 모든 <math alttext="x" class="ltx_Math" display="inline" id="S3.p3.16.m5.1"><semantics id="S3.p3.16.m5.1a"><mi id="S3.p3.16.m5.1.1" xref="S3.p3.16.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.p3.16.m5.1b"><ci id="S3.p3.16.m5.1.1.cmml" xref="S3.p3.16.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.16.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.p3.16.m5.1d">italic_x</annotation></semantics></math>에 대해 <math alttext="\mathbb{E}_{x,y\sim\mathcal{D}}\left[r_{\phi}(x,y)\right]=0" class="ltx_Math" display="inline" id="S3.p3.15.m4.5"><semantics id="S3.p3.15.m4.5a"><mrow id="S3.p3.15.m4.5.5" xref="S3.p3.15.m4.5.5.cmml"><mrow id="S3.p3.15.m4.5.5.1" xref="S3.p3.15.m4.5.5.1.cmml"><msub id="S3.p3.15.m4.5.5.1.3" xref="S3.p3.15.m4.5.5.1.3.cmml"><mi id="S3.p3.15.m4.5.5.1.3.2" xref="S3.p3.15.m4.5.5.1.3.2.cmml">𝔼</mi><mrow id="S3.p3.15.m4.2.2.2" xref="S3.p3.15.m4.2.2.2.cmml"><mrow id="S3.p3.15.m4.2.2.2.4.2" xref="S3.p3.15.m4.2.2.2.4.1.cmml"><mi id="S3.p3.15.m4.1.1.1.1" xref="S3.p3.15.m4.1.1.1.1.cmml">x</mi><mo id="S3.p3.15.m4.2.2.2.4.2.1" xref="S3.p3.15.m4.2.2.2.4.1.cmml">,</mo><mi id="S3.p3.15.m4.2.2.2.2" xref="S3.p3.15.m4.2.2.2.2.cmml">y</mi></mrow><mo id="S3.p3.15.m4.2.2.2.3" xref="S3.p3.15.m4.2.2.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.p3.15.m4.2.2.2.5" xref="S3.p3.15.m4.2.2.2.5.cmml">𝒟</mi></mrow></msub><mo id="S3.p3.15.m4.5.5.1.2" xref="S3.p3.15.m4.5.5.1.2.cmml">⁢</mo><mrow id="S3.p3.15.m4.5.5.1.1.1" xref="S3.p3.15.m4.5.5.1.1.2.cmml"><mo id="S3.p3.15.m4.5.5.1.1.1.2" xref="S3.p3.15.m4.5.5.1.1.2.1.cmml">[</mo><mrow id="S3.p3.15.m4.5.5.1.1.1.1" xref="S3.p3.15.m4.5.5.1.1.1.1.cmml"><msub id="S3.p3.15.m4.5.5.1.1.1.1.2" xref="S3.p3.15.m4.5.5.1.1.1.1.2.cmml"><mi id="S3.p3.15.m4.5.5.1.1.1.1.2.2" xref="S3.p3.15.m4.5.5.1.1.1.1.2.2.cmml">r</mi><mi id="S3.p3.15.m4.5.5.1.1.1.1.2.3" xref="S3.p3.15.m4.5.5.1.1.1.1.2.3.cmml">ϕ</mi></msub><mo id="S3.p3.15.m4.5.5.1.1.1.1.1" xref="S3.p3.15.m4.5.5.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.p3.15.m4.5.5.1.1.1.1.3.2" xref="S3.p3.15.m4.5.5.1.1.1.1.3.1.cmml"><mo id="S3.p3.15.m4.5.5.1.1.1.1.3.2.1" stretchy="false" xref="S3.p3.15.m4.5.5.1.1.1.1.3.1.cmml">(</mo><mi id="S3.p3.15.m4.3.3" xref="S3.p3.15.m4.3.3.cmml">x</mi><mo id="S3.p3.15.m4.5.5.1.1.1.1.3.2.2" xref="S3.p3.15.m4.5.5.1.1.1.1.3.1.cmml">,</mo><mi id="S3.p3.15.m4.4.4" xref="S3.p3.15.m4.4.4.cmml">y</mi><mo id="S3.p3.15.m4.5.5.1.1.1.1.3.2.3" stretchy="false" xref="S3.p3.15.m4.5.5.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.p3.15.m4.5.5.1.1.1.3" xref="S3.p3.15.m4.5.5.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.p3.15.m4.5.5.2" xref="S3.p3.15.m4.5.5.2.cmml">=</mo><mn id="S3.p3.15.m4.5.5.3" xref="S3.p3.15.m4.5.5.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.15.m4.5b"><apply id="S3.p3.15.m4.5.5.cmml" xref="S3.p3.15.m4.5.5"><eq id="S3.p3.15.m4.5.5.2.cmml" xref="S3.p3.15.m4.5.5.2"></eq><apply id="S3.p3.15.m4.5.5.1.cmml" xref="S3.p3.15.m4.5.5.1"><times id="S3.p3.15.m4.5.5.1.2.cmml" xref="S3.p3.15.m4.5.5.1.2"></times><apply id="S3.p3.15.m4.5.5.1.3.cmml" xref="S3.p3.15.m4.5.5.1.3"><csymbol cd="ambiguous" id="S3.p3.15.m4.5.5.1.3.1.cmml" xref="S3.p3.15.m4.5.5.1.3">subscript</csymbol><ci id="S3.p3.15.m4.5.5.1.3.2.cmml" xref="S3.p3.15.m4.5.5.1.3.2">𝔼</ci><apply id="S3.p3.15.m4.2.2.2.cmml" xref="S3.p3.15.m4.2.2.2"><csymbol cd="latexml" id="S3.p3.15.m4.2.2.2.3.cmml" xref="S3.p3.15.m4.2.2.2.3">similar-to</csymbol><list id="S3.p3.15.m4.2.2.2.4.1.cmml" xref="S3.p3.15.m4.2.2.2.4.2"><ci id="S3.p3.15.m4.1.1.1.1.cmml" xref="S3.p3.15.m4.1.1.1.1">𝑥</ci><ci id="S3.p3.15.m4.2.2.2.2.cmml" xref="S3.p3.15.m4.2.2.2.2">𝑦</ci></list><ci id="S3.p3.15.m4.2.2.2.5.cmml" xref="S3.p3.15.m4.2.2.2.5">𝒟</ci></apply></apply><apply id="S3.p3.15.m4.5.5.1.1.2.cmml" xref="S3.p3.15.m4.5.5.1.1.1"><csymbol cd="latexml" id="S3.p3.15.m4.5.5.1.1.2.1.cmml" xref="S3.p3.15.m4.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S3.p3.15.m4.5.5.1.1.1.1.cmml" xref="S3.p3.15.m4.5.5.1.1.1.1"><times id="S3.p3.15.m4.5.5.1.1.1.1.1.cmml" xref="S3.p3.15.m4.5.5.1.1.1.1.1"></times><apply id="S3.p3.15.m4.5.5.1.1.1.1.2.cmml" xref="S3.p3.15.m4.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p3.15.m4.5.5.1.1.1.1.2.1.cmml" xref="S3.p3.15.m4.5.5.1.1.1.1.2">subscript</csymbol><ci id="S3.p3.15.m4.5.5.1.1.1.1.2.2.cmml" xref="S3.p3.15.m4.5.5.1.1.1.1.2.2">𝑟</ci><ci id="S3.p3.15.m4.5.5.1.1.1.1.2.3.cmml" xref="S3.p3.15.m4.5.5.1.1.1.1.2.3">italic-ϕ</ci></apply><interval closure="open" id="S3.p3.15.m4.5.5.1.1.1.1.3.1.cmml" xref="S3.p3.15.m4.5.5.1.1.1.1.3.2"><ci id="S3.p3.15.m4.3.3.cmml" xref="S3.p3.15.m4.3.3">𝑥</ci><ci id="S3.p3.15.m4.4.4.cmml" xref="S3.p3.15.m4.4.4">𝑦</ci></interval></apply></apply></apply><cn id="S3.p3.15.m4.5.5.3.cmml" type="integer" xref="S3.p3.15.m4.5.5.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.15.m4.5c">\mathbb{E}_{x,y\sim\mathcal{D}}\left[r_{\phi}(x,y)\right]=0</annotation><annotation encoding="application/x-llamapun" id="S3.p3.15.m4.5d">blackboard_E start_POSTSUBSCRIPT italic_x , italic_y ∼ caligraphic_D end_POSTSUBSCRIPT [ italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y ) ] = 0</annotation></semantics></math>와 같이 보상을 정규화한다.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.7"><span class="ltx_text ltx_font_bold" id="S3.p4.7.1">RL Fine-Tuning Phase</span>: RL phase 동안 학습된 보상 함수를 사용하여 언어 모델에 피드백을 제공한다. 특히, 다음과 같은 최적화 문제를 공식화한다.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\pi_{\theta}}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi_{\theta}(y\mid x)}%
\bigl{[}r_{\phi}(x,y)\bigr{]}-\beta\mathbb{D}_{\textrm{KL}}\bigl{[}\pi_{\theta%
}(y\mid x)\mid\mid\pi_{\text{ref}}(y\mid x)\bigr{]}" class="ltx_math_unparsed" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4b"><munder id="S3.E3.m1.4.5"><mi id="S3.E3.m1.4.5.2">max</mi><msub id="S3.E3.m1.4.5.3"><mi id="S3.E3.m1.4.5.3.2">π</mi><mi id="S3.E3.m1.4.5.3.3">θ</mi></msub></munder><msub id="S3.E3.m1.4.6"><mi id="S3.E3.m1.4.6.2">𝔼</mi><mrow id="S3.E3.m1.2.2.2.2"><mrow id="S3.E3.m1.1.1.1.1.1"><mi id="S3.E3.m1.1.1.1.1.1.2">x</mi><mo id="S3.E3.m1.1.1.1.1.1.1">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.1.3">𝒟</mi></mrow><mo id="S3.E3.m1.2.2.2.2.3">,</mo><mrow id="S3.E3.m1.2.2.2.2.2"><mi id="S3.E3.m1.2.2.2.2.2.3">y</mi><mo id="S3.E3.m1.2.2.2.2.2.2">∼</mo><mrow id="S3.E3.m1.2.2.2.2.2.1"><msub id="S3.E3.m1.2.2.2.2.2.1.3"><mi id="S3.E3.m1.2.2.2.2.2.1.3.2">π</mi><mi id="S3.E3.m1.2.2.2.2.2.1.3.3">θ</mi></msub><mo id="S3.E3.m1.2.2.2.2.2.1.2">⁢</mo><mrow id="S3.E3.m1.2.2.2.2.2.1.1.1"><mo id="S3.E3.m1.2.2.2.2.2.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E3.m1.2.2.2.2.2.1.1.1.1"><mi id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2">y</mi><mo id="S3.E3.m1.2.2.2.2.2.1.1.1.1.1">∣</mo><mi id="S3.E3.m1.2.2.2.2.2.1.1.1.1.3">x</mi></mrow><mo id="S3.E3.m1.2.2.2.2.2.1.1.1.3" stretchy="false">)</mo></mrow></mrow></mrow></mrow></msub><mrow id="S3.E3.m1.4.7"><mo id="S3.E3.m1.4.7.1" maxsize="120%" minsize="120%">[</mo><msub id="S3.E3.m1.4.7.2"><mi id="S3.E3.m1.4.7.2.2">r</mi><mi id="S3.E3.m1.4.7.2.3">ϕ</mi></msub><mrow id="S3.E3.m1.4.7.3"><mo id="S3.E3.m1.4.7.3.1" stretchy="false">(</mo><mi id="S3.E3.m1.3.3">x</mi><mo id="S3.E3.m1.4.7.3.2">,</mo><mi id="S3.E3.m1.4.4">y</mi><mo id="S3.E3.m1.4.7.3.3" stretchy="false">)</mo></mrow><mo id="S3.E3.m1.4.7.4" maxsize="120%" minsize="120%">]</mo></mrow><mo id="S3.E3.m1.4.8">−</mo><mi id="S3.E3.m1.4.9">β</mi><msub id="S3.E3.m1.4.10"><mi id="S3.E3.m1.4.10.2">𝔻</mi><mtext id="S3.E3.m1.4.10.3">KL</mtext></msub><mrow id="S3.E3.m1.4.11"><mo id="S3.E3.m1.4.11.1" maxsize="120%" minsize="120%">[</mo><msub id="S3.E3.m1.4.11.2"><mi id="S3.E3.m1.4.11.2.2">π</mi><mi id="S3.E3.m1.4.11.2.3">θ</mi></msub><mrow id="S3.E3.m1.4.11.3"><mo id="S3.E3.m1.4.11.3.1" stretchy="false">(</mo><mi id="S3.E3.m1.4.11.3.2">y</mi><mo id="S3.E3.m1.4.11.3.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S3.E3.m1.4.11.3.4">x</mi><mo id="S3.E3.m1.4.11.3.5" stretchy="false">)</mo></mrow><mo id="S3.E3.m1.4.11.4" lspace="0em" rspace="0.0835em">∣</mo><mo id="S3.E3.m1.4.11.5" lspace="0.0835em" rspace="0.167em">∣</mo><msub id="S3.E3.m1.4.11.6"><mi id="S3.E3.m1.4.11.6.2">π</mi><mtext id="S3.E3.m1.4.11.6.3">ref</mtext></msub><mrow id="S3.E3.m1.4.11.7"><mo id="S3.E3.m1.4.11.7.1" stretchy="false">(</mo><mi id="S3.E3.m1.4.11.7.2">y</mi><mo id="S3.E3.m1.4.11.7.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S3.E3.m1.4.11.7.4">x</mi><mo id="S3.E3.m1.4.11.7.5" stretchy="false">)</mo></mrow><mo id="S3.E3.m1.4.11.8" maxsize="120%" minsize="120%">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\max_{\pi_{\theta}}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi_{\theta}(y\mid x)}%
\bigl{[}r_{\phi}(x,y)\bigr{]}-\beta\mathbb{D}_{\textrm{KL}}\bigl{[}\pi_{\theta%
}(y\mid x)\mid\mid\pi_{\text{ref}}(y\mid x)\bigr{]}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">roman_max start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D , italic_y ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_POSTSUBSCRIPT [ italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y ) ] - italic_β blackboard_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT [ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) ∣ ∣ italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p4.6">여기서 <math alttext="\beta" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">italic_β</annotation></semantics></math>는 기본 참조 정책 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><msub id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">π</mi><mtext id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝜋</ci><ci id="S3.p4.2.m2.1.1.3a.cmml" xref="S3.p4.2.m2.1.1.3"><mtext id="S3.p4.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.p4.2.m2.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math>, 즉 초기 SFT 모델 <math alttext="\pi^{\text{SFT}}" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><msup id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">π</mi><mtext id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3a.cmml">SFT</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">superscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝜋</ci><ci id="S3.p4.3.m3.1.1.3a.cmml" xref="S3.p4.3.m3.1.1.3"><mtext id="S3.p4.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.p4.3.m3.1.1.3">SFT</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">\pi^{\text{SFT}}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">italic_π start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT</annotation></semantics></math>와의 편차를 제어하는 파라미터이다. 실제로, 언어 모델 정책 <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.p4.4.m4.1"><semantics id="S3.p4.4.m4.1a"><msub id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml"><mi id="S3.p4.4.m4.1.1.2" xref="S3.p4.4.m4.1.1.2.cmml">π</mi><mi id="S3.p4.4.m4.1.1.3" xref="S3.p4.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><apply id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p4.4.m4.1.1.1.cmml" xref="S3.p4.4.m4.1.1">subscript</csymbol><ci id="S3.p4.4.m4.1.1.2.cmml" xref="S3.p4.4.m4.1.1.2">𝜋</ci><ci id="S3.p4.4.m4.1.1.3.cmml" xref="S3.p4.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>도 <math alttext="\pi^{\text{SFT}}" class="ltx_Math" display="inline" id="S3.p4.5.m5.1"><semantics id="S3.p4.5.m5.1a"><msup id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml"><mi id="S3.p4.5.m5.1.1.2" xref="S3.p4.5.m5.1.1.2.cmml">π</mi><mtext id="S3.p4.5.m5.1.1.3" xref="S3.p4.5.m5.1.1.3a.cmml">SFT</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><apply id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.5.m5.1.1.1.cmml" xref="S3.p4.5.m5.1.1">superscript</csymbol><ci id="S3.p4.5.m5.1.1.2.cmml" xref="S3.p4.5.m5.1.1.2">𝜋</ci><ci id="S3.p4.5.m5.1.1.3a.cmml" xref="S3.p4.5.m5.1.1.3"><mtext id="S3.p4.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.p4.5.m5.1.1.3">SFT</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">\pi^{\text{SFT}}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.5.m5.1d">italic_π start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT</annotation></semantics></math>로 초기화된다. 추가된 제약 조건은 모델이 보상 모델이 정확한 분포에서 너무 멀리 벗어나는 것을 방지하고, 생성 다양성을 유지하고 단일 고보상 답변으로의 모드 붕괴를 방지하기 때문에 중요하다. 언어 생성의 이산적 특성으로 인해, 이 목표는 미분 가능하지 않으며, 일반적으로 강화 학습으로 최적화된다. 표준 접근법 <cite class="ltx_cite ltx_citemacro_citep">(Ziegler et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib49" title="">2020</a>; Stiennon et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib38" title="">2022</a>; Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib1" title="">2022a</a>; Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib26" title="">2022</a>)</cite>는 보상 함수 <math alttext="{r(x,y)=r_{\phi}(x,y)-\beta(\log\pi_{\theta}(y\mid x)-\log\pi_{\text{ref}}(y% \mid x))}" class="ltx_Math" display="inline" id="S3.p4.6.m6.5"><semantics id="S3.p4.6.m6.5a"><mrow id="S3.p4.6.m6.5.5" xref="S3.p4.6.m6.5.5.cmml"><mrow id="S3.p4.6.m6.5.5.3" xref="S3.p4.6.m6.5.5.3.cmml"><mi id="S3.p4.6.m6.5.5.3.2" xref="S3.p4.6.m6.5.5.3.2.cmml">r</mi><mo id="S3.p4.6.m6.5.5.3.1" xref="S3.p4.6.m6.5.5.3.1.cmml">⁢</mo><mrow id="S3.p4.6.m6.5.5.3.3.2" xref="S3.p4.6.m6.5.5.3.3.1.cmml"><mo id="S3.p4.6.m6.5.5.3.3.2.1" stretchy="false" xref="S3.p4.6.m6.5.5.3.3.1.cmml">(</mo><mi id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml">x</mi><mo id="S3.p4.6.m6.5.5.3.3.2.2" xref="S3.p4.6.m6.5.5.3.3.1.cmml">,</mo><mi id="S3.p4.6.m6.2.2" xref="S3.p4.6.m6.2.2.cmml">y</mi><mo id="S3.p4.6.m6.5.5.3.3.2.3" stretchy="false" xref="S3.p4.6.m6.5.5.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.p4.6.m6.5.5.2" xref="S3.p4.6.m6.5.5.2.cmml">=</mo><mrow id="S3.p4.6.m6.5.5.1" xref="S3.p4.6.m6.5.5.1.cmml"><mrow id="S3.p4.6.m6.5.5.1.3" xref="S3.p4.6.m6.5.5.1.3.cmml"><msub id="S3.p4.6.m6.5.5.1.3.2" xref="S3.p4.6.m6.5.5.1.3.2.cmml"><mi id="S3.p4.6.m6.5.5.1.3.2.2" xref="S3.p4.6.m6.5.5.1.3.2.2.cmml">r</mi><mi id="S3.p4.6.m6.5.5.1.3.2.3" xref="S3.p4.6.m6.5.5.1.3.2.3.cmml">ϕ</mi></msub><mo id="S3.p4.6.m6.5.5.1.3.1" xref="S3.p4.6.m6.5.5.1.3.1.cmml">⁢</mo><mrow id="S3.p4.6.m6.5.5.1.3.3.2" xref="S3.p4.6.m6.5.5.1.3.3.1.cmml"><mo id="S3.p4.6.m6.5.5.1.3.3.2.1" stretchy="false" xref="S3.p4.6.m6.5.5.1.3.3.1.cmml">(</mo><mi id="S3.p4.6.m6.3.3" xref="S3.p4.6.m6.3.3.cmml">x</mi><mo id="S3.p4.6.m6.5.5.1.3.3.2.2" xref="S3.p4.6.m6.5.5.1.3.3.1.cmml">,</mo><mi id="S3.p4.6.m6.4.4" xref="S3.p4.6.m6.4.4.cmml">y</mi><mo id="S3.p4.6.m6.5.5.1.3.3.2.3" stretchy="false" xref="S3.p4.6.m6.5.5.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.p4.6.m6.5.5.1.2" xref="S3.p4.6.m6.5.5.1.2.cmml">−</mo><mrow id="S3.p4.6.m6.5.5.1.1" xref="S3.p4.6.m6.5.5.1.1.cmml"><mi id="S3.p4.6.m6.5.5.1.1.3" xref="S3.p4.6.m6.5.5.1.1.3.cmml">β</mi><mo id="S3.p4.6.m6.5.5.1.1.2" xref="S3.p4.6.m6.5.5.1.1.2.cmml">⁢</mo><mrow id="S3.p4.6.m6.5.5.1.1.1.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.cmml"><mo id="S3.p4.6.m6.5.5.1.1.1.1.2" stretchy="false" xref="S3.p4.6.m6.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.p4.6.m6.5.5.1.1.1.1.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.cmml"><mrow id="S3.p4.6.m6.5.5.1.1.1.1.1.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.cmml"><mrow id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.cmml"><mi id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.2" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.2.cmml">π</mi><mi id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.3" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.1.2" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.3" xref="S3.p4.6.m6.5.5.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.p4.6.m6.5.5.1.1.1.1.1.2" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.cmml"><mrow id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.cmml"><mi id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3a" lspace="0.167em" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.cmml">⁡</mo><msub id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.cmml"><mi id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.2" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.2.cmml">π</mi><mtext id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.3" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.3a.cmml">ref</mtext></msub></mrow><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.2.2" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.2" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.2.cmml">y</mi><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.1" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.1.cmml">∣</mo><mi id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.3" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.p4.6.m6.5.5.1.1.1.1.3" stretchy="false" xref="S3.p4.6.m6.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.5b"><apply id="S3.p4.6.m6.5.5.cmml" xref="S3.p4.6.m6.5.5"><eq id="S3.p4.6.m6.5.5.2.cmml" xref="S3.p4.6.m6.5.5.2"></eq><apply id="S3.p4.6.m6.5.5.3.cmml" xref="S3.p4.6.m6.5.5.3"><times id="S3.p4.6.m6.5.5.3.1.cmml" xref="S3.p4.6.m6.5.5.3.1"></times><ci id="S3.p4.6.m6.5.5.3.2.cmml" xref="S3.p4.6.m6.5.5.3.2">𝑟</ci><interval closure="open" id="S3.p4.6.m6.5.5.3.3.1.cmml" xref="S3.p4.6.m6.5.5.3.3.2"><ci id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1">𝑥</ci><ci id="S3.p4.6.m6.2.2.cmml" xref="S3.p4.6.m6.2.2">𝑦</ci></interval></apply><apply id="S3.p4.6.m6.5.5.1.cmml" xref="S3.p4.6.m6.5.5.1"><minus id="S3.p4.6.m6.5.5.1.2.cmml" xref="S3.p4.6.m6.5.5.1.2"></minus><apply id="S3.p4.6.m6.5.5.1.3.cmml" xref="S3.p4.6.m6.5.5.1.3"><times id="S3.p4.6.m6.5.5.1.3.1.cmml" xref="S3.p4.6.m6.5.5.1.3.1"></times><apply id="S3.p4.6.m6.5.5.1.3.2.cmml" xref="S3.p4.6.m6.5.5.1.3.2"><csymbol cd="ambiguous" id="S3.p4.6.m6.5.5.1.3.2.1.cmml" xref="S3.p4.6.m6.5.5.1.3.2">subscript</csymbol><ci id="S3.p4.6.m6.5.5.1.3.2.2.cmml" xref="S3.p4.6.m6.5.5.1.3.2.2">𝑟</ci><ci id="S3.p4.6.m6.5.5.1.3.2.3.cmml" xref="S3.p4.6.m6.5.5.1.3.2.3">italic-ϕ</ci></apply><interval closure="open" id="S3.p4.6.m6.5.5.1.3.3.1.cmml" xref="S3.p4.6.m6.5.5.1.3.3.2"><ci id="S3.p4.6.m6.3.3.cmml" xref="S3.p4.6.m6.3.3">𝑥</ci><ci id="S3.p4.6.m6.4.4.cmml" xref="S3.p4.6.m6.4.4">𝑦</ci></interval></apply><apply id="S3.p4.6.m6.5.5.1.1.cmml" xref="S3.p4.6.m6.5.5.1.1"><times id="S3.p4.6.m6.5.5.1.1.2.cmml" xref="S3.p4.6.m6.5.5.1.1.2"></times><ci id="S3.p4.6.m6.5.5.1.1.3.cmml" xref="S3.p4.6.m6.5.5.1.1.3">𝛽</ci><apply id="S3.p4.6.m6.5.5.1.1.1.1.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1"><minus id="S3.p4.6.m6.5.5.1.1.1.1.1.3.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.3"></minus><apply id="S3.p4.6.m6.5.5.1.1.1.1.1.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1"><times id="S3.p4.6.m6.5.5.1.1.1.1.1.1.2.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.2"></times><apply id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3"><log id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.1"></log><apply id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.2">𝜋</ci><ci id="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.p4.6.m6.5.5.1.1.1.1.1.2.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2"><times id="S3.p4.6.m6.5.5.1.1.1.1.1.2.2.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.2"></times><apply id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3"><log id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.1"></log><apply id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.2.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.2">𝜋</ci><ci id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.3a.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.3"><mtext id="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.3.cmml" mathsize="70%" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.3.2.3">ref</mtext></ci></apply></apply><apply id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><ci id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.2">𝑦</ci><ci id="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.p4.6.m6.5.5.1.1.1.1.1.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.5c">{r(x,y)=r_{\phi}(x,y)-\beta(\log\pi_{\theta}(y\mid x)-\log\pi_{\text{ref}}(y% \mid x))}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.6.m6.5d">italic_r ( italic_x , italic_y ) = italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y ) - italic_β ( roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) - roman_log italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) )</annotation></semantics></math>를 구성하고 PPO <cite class="ltx_cite ltx_citemacro_cite">Schulman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib37" title="">2017</a>)</cite>를 사용하여 최대화하는 것이었다.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Direct Preference Optimization</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">미세 조정 언어 모델과 같은 대규모 문제에 강화 학습 알고리즘을 적용하는 어려움에 동기부여된 우리의 목표는 선호도를 직접 사용하여 정책 최적화를 위한 간단한 접근법을 도출하는 것이다. 보상을 학습한 다음 RL을 통해 최적화하는 이전의 RLHF 방법과 달리, 우리의 접근법은 RL 훈련 루프 없이 닫힌 형태로 최적의 정책을 추출할 수 있는 보상 모델 매개변수화의 특정 선택을 활용한다. 다음으로 자세히 설명하겠지만, 우리의 핵심 통찰력은 보상 함수에서 최적 정책으로의 분석 매핑을 활용하는 것이며, 이를 통해 보상 함수 이상의 손실 함수를 정책 이상의 손실 함수로 변환할 수 있다. 이 변수 변경 접근법은 브래들리-테리 모델과 같은 인간의 선호도에 대한 기존 모델 하에서 여전히 최적화하면서 명시적이고 독립 실행형 보상 모델을 맞추는 것을 피한다. 본질적으로 정책 네트워크는 언어 모델과 (묵시적) 보상을 모두 나타낸다.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">Deriving the DPO objective. </span> 우리는 선행 작업인 Eq.와 동일한 RL objective로 시작한다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3.E3" title="3 ‣ 3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">3</span></a>, 일반적인 보상 함수<math alttext="r" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">italic_r</annotation></semantics></math> 하에서. 이전 작업 <cite class="ltx_cite ltx_citemacro_citep">(Peters and Schaal, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib29" title="">2007</a>; Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib28" title="">2019</a>; Korbak et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib17" title="">2022</a>; Go et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib15" title="">2023</a>)</cite>에 이어 식에서 KL 제한 보상 최대화 목표에 대한 최적 해를 보여주는 것은 간단하다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3.E3" title="3 ‣ 3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">3</span></a> takes the form:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{r}(y\mid x)=\frac{1}{Z(x)}\pi_{\text{ref}}(y\mid x)\exp\left(\frac{1}{%
\beta}r(x,y)\right)," class="ltx_Math" display="block" id="S4.E4.m1.5"><semantics id="S4.E4.m1.5a"><mrow id="S4.E4.m1.5.5.1" xref="S4.E4.m1.5.5.1.1.cmml"><mrow id="S4.E4.m1.5.5.1.1" xref="S4.E4.m1.5.5.1.1.cmml"><mrow id="S4.E4.m1.5.5.1.1.1" xref="S4.E4.m1.5.5.1.1.1.cmml"><msub id="S4.E4.m1.5.5.1.1.1.3" xref="S4.E4.m1.5.5.1.1.1.3.cmml"><mi id="S4.E4.m1.5.5.1.1.1.3.2" xref="S4.E4.m1.5.5.1.1.1.3.2.cmml">π</mi><mi id="S4.E4.m1.5.5.1.1.1.3.3" xref="S4.E4.m1.5.5.1.1.1.3.3.cmml">r</mi></msub><mo id="S4.E4.m1.5.5.1.1.1.2" xref="S4.E4.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.5.5.1.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S4.E4.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S4.E4.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.5.5.1.1.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.5.5.1.1.1.1.1.1.2" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.E4.m1.5.5.1.1.1.1.1.1.3" xref="S4.E4.m1.5.5.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E4.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.E4.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.5.5.1.1.4" xref="S4.E4.m1.5.5.1.1.4.cmml">=</mo><mrow id="S4.E4.m1.5.5.1.1.3" xref="S4.E4.m1.5.5.1.1.3.cmml"><mfrac id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><mn id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml">1</mn><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.3.cmml">Z</mi><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.1.1.1.4.2" xref="S4.E4.m1.1.1.1.cmml"><mo id="S4.E4.m1.1.1.1.4.2.1" stretchy="false" xref="S4.E4.m1.1.1.1.cmml">(</mo><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">x</mi><mo id="S4.E4.m1.1.1.1.4.2.2" stretchy="false" xref="S4.E4.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S4.E4.m1.5.5.1.1.3.3" xref="S4.E4.m1.5.5.1.1.3.3.cmml">⁢</mo><msub id="S4.E4.m1.5.5.1.1.3.4" xref="S4.E4.m1.5.5.1.1.3.4.cmml"><mi id="S4.E4.m1.5.5.1.1.3.4.2" xref="S4.E4.m1.5.5.1.1.3.4.2.cmml">π</mi><mtext id="S4.E4.m1.5.5.1.1.3.4.3" xref="S4.E4.m1.5.5.1.1.3.4.3a.cmml">ref</mtext></msub><mo id="S4.E4.m1.5.5.1.1.3.3a" xref="S4.E4.m1.5.5.1.1.3.3.cmml">⁢</mo><mrow id="S4.E4.m1.5.5.1.1.2.1.1" xref="S4.E4.m1.5.5.1.1.2.1.1.1.cmml"><mo id="S4.E4.m1.5.5.1.1.2.1.1.2" stretchy="false" xref="S4.E4.m1.5.5.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.5.5.1.1.2.1.1.1" xref="S4.E4.m1.5.5.1.1.2.1.1.1.cmml"><mi id="S4.E4.m1.5.5.1.1.2.1.1.1.2" xref="S4.E4.m1.5.5.1.1.2.1.1.1.2.cmml">y</mi><mo id="S4.E4.m1.5.5.1.1.2.1.1.1.1" xref="S4.E4.m1.5.5.1.1.2.1.1.1.1.cmml">∣</mo><mi id="S4.E4.m1.5.5.1.1.2.1.1.1.3" xref="S4.E4.m1.5.5.1.1.2.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E4.m1.5.5.1.1.2.1.1.3" stretchy="false" xref="S4.E4.m1.5.5.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S4.E4.m1.5.5.1.1.3.3b" lspace="0.167em" xref="S4.E4.m1.5.5.1.1.3.3.cmml">⁢</mo><mrow id="S4.E4.m1.5.5.1.1.3.2.1" xref="S4.E4.m1.5.5.1.1.3.2.2.cmml"><mi id="S4.E4.m1.4.4" xref="S4.E4.m1.4.4.cmml">exp</mi><mo id="S4.E4.m1.5.5.1.1.3.2.1a" xref="S4.E4.m1.5.5.1.1.3.2.2.cmml">⁡</mo><mrow id="S4.E4.m1.5.5.1.1.3.2.1.1" xref="S4.E4.m1.5.5.1.1.3.2.2.cmml"><mo id="S4.E4.m1.5.5.1.1.3.2.1.1.2" xref="S4.E4.m1.5.5.1.1.3.2.2.cmml">(</mo><mrow id="S4.E4.m1.5.5.1.1.3.2.1.1.1" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.cmml"><mfrac id="S4.E4.m1.5.5.1.1.3.2.1.1.1.2" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.cmml"><mn id="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.2" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.2.cmml">1</mn><mi id="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.3" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="S4.E4.m1.5.5.1.1.3.2.1.1.1.1" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.1.cmml">⁢</mo><mi id="S4.E4.m1.5.5.1.1.3.2.1.1.1.3" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.3.cmml">r</mi><mo id="S4.E4.m1.5.5.1.1.3.2.1.1.1.1a" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.2" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.1.cmml"><mo id="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.2.1" stretchy="false" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.1.cmml">(</mo><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">x</mi><mo id="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.2.2" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.1.cmml">,</mo><mi id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3.cmml">y</mi><mo id="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.2.3" stretchy="false" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.5.5.1.1.3.2.1.1.3" xref="S4.E4.m1.5.5.1.1.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E4.m1.5.5.1.2" xref="S4.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.5b"><apply id="S4.E4.m1.5.5.1.1.cmml" xref="S4.E4.m1.5.5.1"><eq id="S4.E4.m1.5.5.1.1.4.cmml" xref="S4.E4.m1.5.5.1.1.4"></eq><apply id="S4.E4.m1.5.5.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1"><times id="S4.E4.m1.5.5.1.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.1.2"></times><apply id="S4.E4.m1.5.5.1.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.1.1.1.3.1.cmml" xref="S4.E4.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.5.5.1.1.1.3.2.cmml" xref="S4.E4.m1.5.5.1.1.1.3.2">𝜋</ci><ci id="S4.E4.m1.5.5.1.1.1.3.3.cmml" xref="S4.E4.m1.5.5.1.1.1.3.3">𝑟</ci></apply><apply id="S4.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E4.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E4.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S4.E4.m1.5.5.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.3"><times id="S4.E4.m1.5.5.1.1.3.3.cmml" xref="S4.E4.m1.5.5.1.1.3.3"></times><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><divide id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1"></divide><cn id="S4.E4.m1.1.1.3.cmml" type="integer" xref="S4.E4.m1.1.1.3">1</cn><apply id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><times id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.2"></times><ci id="S4.E4.m1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.3">𝑍</ci><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑥</ci></apply></apply><apply id="S4.E4.m1.5.5.1.1.3.4.cmml" xref="S4.E4.m1.5.5.1.1.3.4"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.1.1.3.4.1.cmml" xref="S4.E4.m1.5.5.1.1.3.4">subscript</csymbol><ci id="S4.E4.m1.5.5.1.1.3.4.2.cmml" xref="S4.E4.m1.5.5.1.1.3.4.2">𝜋</ci><ci id="S4.E4.m1.5.5.1.1.3.4.3a.cmml" xref="S4.E4.m1.5.5.1.1.3.4.3"><mtext id="S4.E4.m1.5.5.1.1.3.4.3.cmml" mathsize="70%" xref="S4.E4.m1.5.5.1.1.3.4.3">ref</mtext></ci></apply><apply id="S4.E4.m1.5.5.1.1.2.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="S4.E4.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.2.1.1.1.1">conditional</csymbol><ci id="S4.E4.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.2.1.1.1.2">𝑦</ci><ci id="S4.E4.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.2.1.1.1.3">𝑥</ci></apply><apply id="S4.E4.m1.5.5.1.1.3.2.2.cmml" xref="S4.E4.m1.5.5.1.1.3.2.1"><exp id="S4.E4.m1.4.4.cmml" xref="S4.E4.m1.4.4"></exp><apply id="S4.E4.m1.5.5.1.1.3.2.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1"><times id="S4.E4.m1.5.5.1.1.3.2.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.1"></times><apply id="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.2"><divide id="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.1.cmml" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.2"></divide><cn id="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.2.cmml" type="integer" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.2">1</cn><ci id="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.3.cmml" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.2.3">𝛽</ci></apply><ci id="S4.E4.m1.5.5.1.1.3.2.1.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.3">𝑟</ci><interval closure="open" id="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.1.cmml" xref="S4.E4.m1.5.5.1.1.3.2.1.1.1.4.2"><ci id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2">𝑥</ci><ci id="S4.E4.m1.3.3.cmml" xref="S4.E4.m1.3.3">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.5c">\pi_{r}(y\mid x)=\frac{1}{Z(x)}\pi_{\text{ref}}(y\mid x)\exp\left(\frac{1}{%
\beta}r(x,y)\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.5d">italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) = divide start_ARG 1 end_ARG start_ARG italic_Z ( italic_x ) end_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p2.8">여기서 <math alttext="Z(x)=\sum_{y}\pi_{\text{ref}}(y\mid x)\exp\left(\frac{1}{\beta}r(x,y)\right)" class="ltx_Math" display="inline" id="S4.p2.2.m1.6"><semantics id="S4.p2.2.m1.6a"><mrow id="S4.p2.2.m1.6.6" xref="S4.p2.2.m1.6.6.cmml"><mrow id="S4.p2.2.m1.6.6.4" xref="S4.p2.2.m1.6.6.4.cmml"><mi id="S4.p2.2.m1.6.6.4.2" xref="S4.p2.2.m1.6.6.4.2.cmml">Z</mi><mo id="S4.p2.2.m1.6.6.4.1" xref="S4.p2.2.m1.6.6.4.1.cmml">⁢</mo><mrow id="S4.p2.2.m1.6.6.4.3.2" xref="S4.p2.2.m1.6.6.4.cmml"><mo id="S4.p2.2.m1.6.6.4.3.2.1" stretchy="false" xref="S4.p2.2.m1.6.6.4.cmml">(</mo><mi id="S4.p2.2.m1.1.1" xref="S4.p2.2.m1.1.1.cmml">x</mi><mo id="S4.p2.2.m1.6.6.4.3.2.2" stretchy="false" xref="S4.p2.2.m1.6.6.4.cmml">)</mo></mrow></mrow><mo id="S4.p2.2.m1.6.6.3" rspace="0.111em" xref="S4.p2.2.m1.6.6.3.cmml">=</mo><mrow id="S4.p2.2.m1.6.6.2" xref="S4.p2.2.m1.6.6.2.cmml"><msub id="S4.p2.2.m1.6.6.2.3" xref="S4.p2.2.m1.6.6.2.3.cmml"><mo id="S4.p2.2.m1.6.6.2.3.2" xref="S4.p2.2.m1.6.6.2.3.2.cmml">∑</mo><mi id="S4.p2.2.m1.6.6.2.3.3" xref="S4.p2.2.m1.6.6.2.3.3.cmml">y</mi></msub><mrow id="S4.p2.2.m1.6.6.2.2" xref="S4.p2.2.m1.6.6.2.2.cmml"><msub id="S4.p2.2.m1.6.6.2.2.4" xref="S4.p2.2.m1.6.6.2.2.4.cmml"><mi id="S4.p2.2.m1.6.6.2.2.4.2" xref="S4.p2.2.m1.6.6.2.2.4.2.cmml">π</mi><mtext id="S4.p2.2.m1.6.6.2.2.4.3" xref="S4.p2.2.m1.6.6.2.2.4.3a.cmml">ref</mtext></msub><mo id="S4.p2.2.m1.6.6.2.2.3" xref="S4.p2.2.m1.6.6.2.2.3.cmml">⁢</mo><mrow id="S4.p2.2.m1.5.5.1.1.1.1" xref="S4.p2.2.m1.5.5.1.1.1.1.1.cmml"><mo id="S4.p2.2.m1.5.5.1.1.1.1.2" stretchy="false" xref="S4.p2.2.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S4.p2.2.m1.5.5.1.1.1.1.1" xref="S4.p2.2.m1.5.5.1.1.1.1.1.cmml"><mi id="S4.p2.2.m1.5.5.1.1.1.1.1.2" xref="S4.p2.2.m1.5.5.1.1.1.1.1.2.cmml">y</mi><mo id="S4.p2.2.m1.5.5.1.1.1.1.1.1" xref="S4.p2.2.m1.5.5.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.p2.2.m1.5.5.1.1.1.1.1.3" xref="S4.p2.2.m1.5.5.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.p2.2.m1.5.5.1.1.1.1.3" stretchy="false" xref="S4.p2.2.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.p2.2.m1.6.6.2.2.3a" lspace="0.167em" xref="S4.p2.2.m1.6.6.2.2.3.cmml">⁢</mo><mrow id="S4.p2.2.m1.6.6.2.2.2.1" xref="S4.p2.2.m1.6.6.2.2.2.2.cmml"><mi id="S4.p2.2.m1.4.4" xref="S4.p2.2.m1.4.4.cmml">exp</mi><mo id="S4.p2.2.m1.6.6.2.2.2.1a" xref="S4.p2.2.m1.6.6.2.2.2.2.cmml">⁡</mo><mrow id="S4.p2.2.m1.6.6.2.2.2.1.1" xref="S4.p2.2.m1.6.6.2.2.2.2.cmml"><mo id="S4.p2.2.m1.6.6.2.2.2.1.1.2" xref="S4.p2.2.m1.6.6.2.2.2.2.cmml">(</mo><mrow id="S4.p2.2.m1.6.6.2.2.2.1.1.1" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.cmml"><mfrac id="S4.p2.2.m1.6.6.2.2.2.1.1.1.2" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.cmml"><mn id="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.2" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.2.cmml">1</mn><mi id="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.3" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="S4.p2.2.m1.6.6.2.2.2.1.1.1.1" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S4.p2.2.m1.6.6.2.2.2.1.1.1.3" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.3.cmml">r</mi><mo id="S4.p2.2.m1.6.6.2.2.2.1.1.1.1a" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.2" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.1.cmml"><mo id="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.2.1" stretchy="false" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.1.cmml">(</mo><mi id="S4.p2.2.m1.2.2" xref="S4.p2.2.m1.2.2.cmml">x</mi><mo id="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.2.2" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.1.cmml">,</mo><mi id="S4.p2.2.m1.3.3" xref="S4.p2.2.m1.3.3.cmml">y</mi><mo id="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.2.3" stretchy="false" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="S4.p2.2.m1.6.6.2.2.2.1.1.3" xref="S4.p2.2.m1.6.6.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m1.6b"><apply id="S4.p2.2.m1.6.6.cmml" xref="S4.p2.2.m1.6.6"><eq id="S4.p2.2.m1.6.6.3.cmml" xref="S4.p2.2.m1.6.6.3"></eq><apply id="S4.p2.2.m1.6.6.4.cmml" xref="S4.p2.2.m1.6.6.4"><times id="S4.p2.2.m1.6.6.4.1.cmml" xref="S4.p2.2.m1.6.6.4.1"></times><ci id="S4.p2.2.m1.6.6.4.2.cmml" xref="S4.p2.2.m1.6.6.4.2">𝑍</ci><ci id="S4.p2.2.m1.1.1.cmml" xref="S4.p2.2.m1.1.1">𝑥</ci></apply><apply id="S4.p2.2.m1.6.6.2.cmml" xref="S4.p2.2.m1.6.6.2"><apply id="S4.p2.2.m1.6.6.2.3.cmml" xref="S4.p2.2.m1.6.6.2.3"><csymbol cd="ambiguous" id="S4.p2.2.m1.6.6.2.3.1.cmml" xref="S4.p2.2.m1.6.6.2.3">subscript</csymbol><sum id="S4.p2.2.m1.6.6.2.3.2.cmml" xref="S4.p2.2.m1.6.6.2.3.2"></sum><ci id="S4.p2.2.m1.6.6.2.3.3.cmml" xref="S4.p2.2.m1.6.6.2.3.3">𝑦</ci></apply><apply id="S4.p2.2.m1.6.6.2.2.cmml" xref="S4.p2.2.m1.6.6.2.2"><times id="S4.p2.2.m1.6.6.2.2.3.cmml" xref="S4.p2.2.m1.6.6.2.2.3"></times><apply id="S4.p2.2.m1.6.6.2.2.4.cmml" xref="S4.p2.2.m1.6.6.2.2.4"><csymbol cd="ambiguous" id="S4.p2.2.m1.6.6.2.2.4.1.cmml" xref="S4.p2.2.m1.6.6.2.2.4">subscript</csymbol><ci id="S4.p2.2.m1.6.6.2.2.4.2.cmml" xref="S4.p2.2.m1.6.6.2.2.4.2">𝜋</ci><ci id="S4.p2.2.m1.6.6.2.2.4.3a.cmml" xref="S4.p2.2.m1.6.6.2.2.4.3"><mtext id="S4.p2.2.m1.6.6.2.2.4.3.cmml" mathsize="70%" xref="S4.p2.2.m1.6.6.2.2.4.3">ref</mtext></ci></apply><apply id="S4.p2.2.m1.5.5.1.1.1.1.1.cmml" xref="S4.p2.2.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="S4.p2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.p2.2.m1.5.5.1.1.1.1.1.1">conditional</csymbol><ci id="S4.p2.2.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.p2.2.m1.5.5.1.1.1.1.1.2">𝑦</ci><ci id="S4.p2.2.m1.5.5.1.1.1.1.1.3.cmml" xref="S4.p2.2.m1.5.5.1.1.1.1.1.3">𝑥</ci></apply><apply id="S4.p2.2.m1.6.6.2.2.2.2.cmml" xref="S4.p2.2.m1.6.6.2.2.2.1"><exp id="S4.p2.2.m1.4.4.cmml" xref="S4.p2.2.m1.4.4"></exp><apply id="S4.p2.2.m1.6.6.2.2.2.1.1.1.cmml" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1"><times id="S4.p2.2.m1.6.6.2.2.2.1.1.1.1.cmml" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.1"></times><apply id="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.cmml" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.2"><divide id="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.1.cmml" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.2"></divide><cn id="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.2.cmml" type="integer" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.2">1</cn><ci id="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.3.cmml" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.2.3">𝛽</ci></apply><ci id="S4.p2.2.m1.6.6.2.2.2.1.1.1.3.cmml" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.3">𝑟</ci><interval closure="open" id="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.1.cmml" xref="S4.p2.2.m1.6.6.2.2.2.1.1.1.4.2"><ci id="S4.p2.2.m1.2.2.cmml" xref="S4.p2.2.m1.2.2">𝑥</ci><ci id="S4.p2.2.m1.3.3.cmml" xref="S4.p2.2.m1.3.3">𝑦</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m1.6c">Z(x)=\sum_{y}\pi_{\text{ref}}(y\mid x)\exp\left(\frac{1}{\beta}r(x,y)\right)</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m1.6d">italic_Z ( italic_x ) = ∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) )</annotation></semantics></math>는 파티션 함수이다. 완전한 도출은 부록 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS1" title="A.1 Deriving the Optimum of the KL-Constrained Reward Maximization Objective ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">A.1</span></a>를 참조한다. 그라운드-트루스 보상 함수 <math alttext="r^{*}" class="ltx_Math" display="inline" id="S4.p2.4.m3.1"><semantics id="S4.p2.4.m3.1a"><msup id="S4.p2.4.m3.1.1" xref="S4.p2.4.m3.1.1.cmml"><mi id="S4.p2.4.m3.1.1.2" xref="S4.p2.4.m3.1.1.2.cmml">r</mi><mo id="S4.p2.4.m3.1.1.3" xref="S4.p2.4.m3.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p2.4.m3.1b"><apply id="S4.p2.4.m3.1.1.cmml" xref="S4.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m3.1.1.1.cmml" xref="S4.p2.4.m3.1.1">superscript</csymbol><ci id="S4.p2.4.m3.1.1.2.cmml" xref="S4.p2.4.m3.1.1.2">𝑟</ci><times id="S4.p2.4.m3.1.1.3.cmml" xref="S4.p2.4.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m3.1c">r^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.4.m3.1d">italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>의 MLE 추정치 <math alttext="r_{\phi}" class="ltx_Math" display="inline" id="S4.p2.3.m2.1"><semantics id="S4.p2.3.m2.1a"><msub id="S4.p2.3.m2.1.1" xref="S4.p2.3.m2.1.1.cmml"><mi id="S4.p2.3.m2.1.1.2" xref="S4.p2.3.m2.1.1.2.cmml">r</mi><mi id="S4.p2.3.m2.1.1.3" xref="S4.p2.3.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.3.m2.1b"><apply id="S4.p2.3.m2.1.1.cmml" xref="S4.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m2.1.1.1.cmml" xref="S4.p2.3.m2.1.1">subscript</csymbol><ci id="S4.p2.3.m2.1.1.2.cmml" xref="S4.p2.3.m2.1.1.2">𝑟</ci><ci id="S4.p2.3.m2.1.1.3.cmml" xref="S4.p2.3.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m2.1c">r_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m2.1d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>를 사용하더라도, 분할 함수 <math alttext="Z(x)" class="ltx_Math" display="inline" id="S4.p2.5.m4.1"><semantics id="S4.p2.5.m4.1a"><mrow id="S4.p2.5.m4.1.2" xref="S4.p2.5.m4.1.2.cmml"><mi id="S4.p2.5.m4.1.2.2" xref="S4.p2.5.m4.1.2.2.cmml">Z</mi><mo id="S4.p2.5.m4.1.2.1" xref="S4.p2.5.m4.1.2.1.cmml">⁢</mo><mrow id="S4.p2.5.m4.1.2.3.2" xref="S4.p2.5.m4.1.2.cmml"><mo id="S4.p2.5.m4.1.2.3.2.1" stretchy="false" xref="S4.p2.5.m4.1.2.cmml">(</mo><mi id="S4.p2.5.m4.1.1" xref="S4.p2.5.m4.1.1.cmml">x</mi><mo id="S4.p2.5.m4.1.2.3.2.2" stretchy="false" xref="S4.p2.5.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.5.m4.1b"><apply id="S4.p2.5.m4.1.2.cmml" xref="S4.p2.5.m4.1.2"><times id="S4.p2.5.m4.1.2.1.cmml" xref="S4.p2.5.m4.1.2.1"></times><ci id="S4.p2.5.m4.1.2.2.cmml" xref="S4.p2.5.m4.1.2.2">𝑍</ci><ci id="S4.p2.5.m4.1.1.cmml" xref="S4.p2.5.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m4.1c">Z(x)</annotation><annotation encoding="application/x-llamapun" id="S4.p2.5.m4.1d">italic_Z ( italic_x )</annotation></semantics></math><cite class="ltx_cite ltx_citemacro_citep">(Korbak et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib17" title="">2022</a>; Go et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib15" title="">2023</a>)</cite>를 추정하는 것은 여전히 비용이 많이 들며, 이는 이러한 표현을 실제적으로 활용하기 어렵게 만든다. 그러나 식은 재정렬할 수 있습니다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E4" title="4 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a> 보상 함수를 해당 최적 정책 <math alttext="\pi_{r}" class="ltx_Math" display="inline" id="S4.p2.6.m5.1"><semantics id="S4.p2.6.m5.1a"><msub id="S4.p2.6.m5.1.1" xref="S4.p2.6.m5.1.1.cmml"><mi id="S4.p2.6.m5.1.1.2" xref="S4.p2.6.m5.1.1.2.cmml">π</mi><mi id="S4.p2.6.m5.1.1.3" xref="S4.p2.6.m5.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.6.m5.1b"><apply id="S4.p2.6.m5.1.1.cmml" xref="S4.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S4.p2.6.m5.1.1.1.cmml" xref="S4.p2.6.m5.1.1">subscript</csymbol><ci id="S4.p2.6.m5.1.1.2.cmml" xref="S4.p2.6.m5.1.1.2">𝜋</ci><ci id="S4.p2.6.m5.1.1.3.cmml" xref="S4.p2.6.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m5.1c">\pi_{r}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.6.m5.1d">italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, 기준 정책 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S4.p2.7.m6.1"><semantics id="S4.p2.7.m6.1a"><msub id="S4.p2.7.m6.1.1" xref="S4.p2.7.m6.1.1.cmml"><mi id="S4.p2.7.m6.1.1.2" xref="S4.p2.7.m6.1.1.2.cmml">π</mi><mtext id="S4.p2.7.m6.1.1.3" xref="S4.p2.7.m6.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p2.7.m6.1b"><apply id="S4.p2.7.m6.1.1.cmml" xref="S4.p2.7.m6.1.1"><csymbol cd="ambiguous" id="S4.p2.7.m6.1.1.1.cmml" xref="S4.p2.7.m6.1.1">subscript</csymbol><ci id="S4.p2.7.m6.1.1.2.cmml" xref="S4.p2.7.m6.1.1.2">𝜋</ci><ci id="S4.p2.7.m6.1.1.3a.cmml" xref="S4.p2.7.m6.1.1.3"><mtext id="S4.p2.7.m6.1.1.3.cmml" mathsize="70%" xref="S4.p2.7.m6.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m6.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.7.m6.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math>, 미지 파티션 함수 <math alttext="Z(\cdot)" class="ltx_Math" display="inline" id="S4.p2.8.m7.1"><semantics id="S4.p2.8.m7.1a"><mrow id="S4.p2.8.m7.1.2" xref="S4.p2.8.m7.1.2.cmml"><mi id="S4.p2.8.m7.1.2.2" xref="S4.p2.8.m7.1.2.2.cmml">Z</mi><mo id="S4.p2.8.m7.1.2.1" xref="S4.p2.8.m7.1.2.1.cmml">⁢</mo><mrow id="S4.p2.8.m7.1.2.3.2" xref="S4.p2.8.m7.1.2.cmml"><mo id="S4.p2.8.m7.1.2.3.2.1" stretchy="false" xref="S4.p2.8.m7.1.2.cmml">(</mo><mo id="S4.p2.8.m7.1.1" lspace="0em" rspace="0em" xref="S4.p2.8.m7.1.1.cmml">⋅</mo><mo id="S4.p2.8.m7.1.2.3.2.2" stretchy="false" xref="S4.p2.8.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.8.m7.1b"><apply id="S4.p2.8.m7.1.2.cmml" xref="S4.p2.8.m7.1.2"><times id="S4.p2.8.m7.1.2.1.cmml" xref="S4.p2.8.m7.1.2.1"></times><ci id="S4.p2.8.m7.1.2.2.cmml" xref="S4.p2.8.m7.1.2.2">𝑍</ci><ci id="S4.p2.8.m7.1.1.cmml" xref="S4.p2.8.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m7.1c">Z(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.p2.8.m7.1d">italic_Z ( ⋅ )</annotation></semantics></math>로 표현한다. 구체적으로, 우리는 먼저 식 양변에 로그를 취한다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E4" title="4 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a> and then with some algebra we obtain:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r(x,y)=\beta\log\frac{\pi_{r}(y\mid x)}{\pi_{\text{ref}}(y\mid x)}+\beta\log Z%
(x)." class="ltx_Math" display="block" id="S4.E5.m1.6"><semantics id="S4.E5.m1.6a"><mrow id="S4.E5.m1.6.6.1" xref="S4.E5.m1.6.6.1.1.cmml"><mrow id="S4.E5.m1.6.6.1.1" xref="S4.E5.m1.6.6.1.1.cmml"><mrow id="S4.E5.m1.6.6.1.1.2" xref="S4.E5.m1.6.6.1.1.2.cmml"><mi id="S4.E5.m1.6.6.1.1.2.2" xref="S4.E5.m1.6.6.1.1.2.2.cmml">r</mi><mo id="S4.E5.m1.6.6.1.1.2.1" xref="S4.E5.m1.6.6.1.1.2.1.cmml">⁢</mo><mrow id="S4.E5.m1.6.6.1.1.2.3.2" xref="S4.E5.m1.6.6.1.1.2.3.1.cmml"><mo id="S4.E5.m1.6.6.1.1.2.3.2.1" stretchy="false" xref="S4.E5.m1.6.6.1.1.2.3.1.cmml">(</mo><mi id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">x</mi><mo id="S4.E5.m1.6.6.1.1.2.3.2.2" xref="S4.E5.m1.6.6.1.1.2.3.1.cmml">,</mo><mi id="S4.E5.m1.4.4" xref="S4.E5.m1.4.4.cmml">y</mi><mo id="S4.E5.m1.6.6.1.1.2.3.2.3" stretchy="false" xref="S4.E5.m1.6.6.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.6.6.1.1.1" xref="S4.E5.m1.6.6.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.6.6.1.1.3" xref="S4.E5.m1.6.6.1.1.3.cmml"><mrow id="S4.E5.m1.6.6.1.1.3.2" xref="S4.E5.m1.6.6.1.1.3.2.cmml"><mi id="S4.E5.m1.6.6.1.1.3.2.2" xref="S4.E5.m1.6.6.1.1.3.2.2.cmml">β</mi><mo id="S4.E5.m1.6.6.1.1.3.2.1" lspace="0.167em" xref="S4.E5.m1.6.6.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.E5.m1.6.6.1.1.3.2.3" xref="S4.E5.m1.6.6.1.1.3.2.3.cmml"><mi id="S4.E5.m1.6.6.1.1.3.2.3.1" xref="S4.E5.m1.6.6.1.1.3.2.3.1.cmml">log</mi><mo id="S4.E5.m1.6.6.1.1.3.2.3a" lspace="0.167em" xref="S4.E5.m1.6.6.1.1.3.2.3.cmml">⁡</mo><mfrac id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.3.2.cmml">π</mi><mi id="S4.E5.m1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.3.3.cmml">r</mi></msub><mo id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.E5.m1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.E5.m1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E5.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E5.m1.2.2.2" xref="S4.E5.m1.2.2.2.cmml"><msub id="S4.E5.m1.2.2.2.3" xref="S4.E5.m1.2.2.2.3.cmml"><mi id="S4.E5.m1.2.2.2.3.2" xref="S4.E5.m1.2.2.2.3.2.cmml">π</mi><mtext id="S4.E5.m1.2.2.2.3.3" xref="S4.E5.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.2.cmml">⁢</mo><mrow id="S4.E5.m1.2.2.2.1.1" xref="S4.E5.m1.2.2.2.1.1.1.cmml"><mo id="S4.E5.m1.2.2.2.1.1.2" stretchy="false" xref="S4.E5.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.2.2.2.1.1.1" xref="S4.E5.m1.2.2.2.1.1.1.cmml"><mi id="S4.E5.m1.2.2.2.1.1.1.2" xref="S4.E5.m1.2.2.2.1.1.1.2.cmml">y</mi><mo id="S4.E5.m1.2.2.2.1.1.1.1" xref="S4.E5.m1.2.2.2.1.1.1.1.cmml">∣</mo><mi id="S4.E5.m1.2.2.2.1.1.1.3" xref="S4.E5.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E5.m1.2.2.2.1.1.3" stretchy="false" xref="S4.E5.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S4.E5.m1.6.6.1.1.3.1" xref="S4.E5.m1.6.6.1.1.3.1.cmml">+</mo><mrow id="S4.E5.m1.6.6.1.1.3.3" xref="S4.E5.m1.6.6.1.1.3.3.cmml"><mi id="S4.E5.m1.6.6.1.1.3.3.2" xref="S4.E5.m1.6.6.1.1.3.3.2.cmml">β</mi><mo id="S4.E5.m1.6.6.1.1.3.3.1" lspace="0.167em" xref="S4.E5.m1.6.6.1.1.3.3.1.cmml">⁢</mo><mrow id="S4.E5.m1.6.6.1.1.3.3.3" xref="S4.E5.m1.6.6.1.1.3.3.3.cmml"><mi id="S4.E5.m1.6.6.1.1.3.3.3.1" xref="S4.E5.m1.6.6.1.1.3.3.3.1.cmml">log</mi><mo id="S4.E5.m1.6.6.1.1.3.3.3a" lspace="0.167em" xref="S4.E5.m1.6.6.1.1.3.3.3.cmml">⁡</mo><mi id="S4.E5.m1.6.6.1.1.3.3.3.2" xref="S4.E5.m1.6.6.1.1.3.3.3.2.cmml">Z</mi></mrow><mo id="S4.E5.m1.6.6.1.1.3.3.1a" xref="S4.E5.m1.6.6.1.1.3.3.1.cmml">⁢</mo><mrow id="S4.E5.m1.6.6.1.1.3.3.4.2" xref="S4.E5.m1.6.6.1.1.3.3.cmml"><mo id="S4.E5.m1.6.6.1.1.3.3.4.2.1" stretchy="false" xref="S4.E5.m1.6.6.1.1.3.3.cmml">(</mo><mi id="S4.E5.m1.5.5" xref="S4.E5.m1.5.5.cmml">x</mi><mo id="S4.E5.m1.6.6.1.1.3.3.4.2.2" stretchy="false" xref="S4.E5.m1.6.6.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.6.6.1.2" lspace="0em" xref="S4.E5.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.6b"><apply id="S4.E5.m1.6.6.1.1.cmml" xref="S4.E5.m1.6.6.1"><eq id="S4.E5.m1.6.6.1.1.1.cmml" xref="S4.E5.m1.6.6.1.1.1"></eq><apply id="S4.E5.m1.6.6.1.1.2.cmml" xref="S4.E5.m1.6.6.1.1.2"><times id="S4.E5.m1.6.6.1.1.2.1.cmml" xref="S4.E5.m1.6.6.1.1.2.1"></times><ci id="S4.E5.m1.6.6.1.1.2.2.cmml" xref="S4.E5.m1.6.6.1.1.2.2">𝑟</ci><interval closure="open" id="S4.E5.m1.6.6.1.1.2.3.1.cmml" xref="S4.E5.m1.6.6.1.1.2.3.2"><ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">𝑥</ci><ci id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4">𝑦</ci></interval></apply><apply id="S4.E5.m1.6.6.1.1.3.cmml" xref="S4.E5.m1.6.6.1.1.3"><plus id="S4.E5.m1.6.6.1.1.3.1.cmml" xref="S4.E5.m1.6.6.1.1.3.1"></plus><apply id="S4.E5.m1.6.6.1.1.3.2.cmml" xref="S4.E5.m1.6.6.1.1.3.2"><times id="S4.E5.m1.6.6.1.1.3.2.1.cmml" xref="S4.E5.m1.6.6.1.1.3.2.1"></times><ci id="S4.E5.m1.6.6.1.1.3.2.2.cmml" xref="S4.E5.m1.6.6.1.1.3.2.2">𝛽</ci><apply id="S4.E5.m1.6.6.1.1.3.2.3.cmml" xref="S4.E5.m1.6.6.1.1.3.2.3"><log id="S4.E5.m1.6.6.1.1.3.2.3.1.cmml" xref="S4.E5.m1.6.6.1.1.3.2.3.1"></log><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><divide id="S4.E5.m1.2.2.3.cmml" xref="S4.E5.m1.2.2"></divide><apply id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><times id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.3.2">𝜋</ci><ci id="S4.E5.m1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.3.3">𝑟</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E5.m1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S4.E5.m1.2.2.2.cmml" xref="S4.E5.m1.2.2.2"><times id="S4.E5.m1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2"></times><apply id="S4.E5.m1.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.2.3.1.cmml" xref="S4.E5.m1.2.2.2.3">subscript</csymbol><ci id="S4.E5.m1.2.2.2.3.2.cmml" xref="S4.E5.m1.2.2.2.3.2">𝜋</ci><ci id="S4.E5.m1.2.2.2.3.3a.cmml" xref="S4.E5.m1.2.2.2.3.3"><mtext id="S4.E5.m1.2.2.2.3.3.cmml" mathsize="70%" xref="S4.E5.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="S4.E5.m1.2.2.2.1.1.1.cmml" xref="S4.E5.m1.2.2.2.1.1"><csymbol cd="latexml" id="S4.E5.m1.2.2.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.E5.m1.2.2.2.1.1.1.2.cmml" xref="S4.E5.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="S4.E5.m1.2.2.2.1.1.1.3.cmml" xref="S4.E5.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="S4.E5.m1.6.6.1.1.3.3.cmml" xref="S4.E5.m1.6.6.1.1.3.3"><times id="S4.E5.m1.6.6.1.1.3.3.1.cmml" xref="S4.E5.m1.6.6.1.1.3.3.1"></times><ci id="S4.E5.m1.6.6.1.1.3.3.2.cmml" xref="S4.E5.m1.6.6.1.1.3.3.2">𝛽</ci><apply id="S4.E5.m1.6.6.1.1.3.3.3.cmml" xref="S4.E5.m1.6.6.1.1.3.3.3"><log id="S4.E5.m1.6.6.1.1.3.3.3.1.cmml" xref="S4.E5.m1.6.6.1.1.3.3.3.1"></log><ci id="S4.E5.m1.6.6.1.1.3.3.3.2.cmml" xref="S4.E5.m1.6.6.1.1.3.3.3.2">𝑍</ci></apply><ci id="S4.E5.m1.5.5.cmml" xref="S4.E5.m1.5.5">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.6c">r(x,y)=\beta\log\frac{\pi_{r}(y\mid x)}{\pi_{\text{ref}}(y\mid x)}+\beta\log Z%
(x).</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.6d">italic_r ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG + italic_β roman_log italic_Z ( italic_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p2.15">이러한 재매개변수화를 ground-truth reward <math alttext="r^{*}" class="ltx_Math" display="inline" id="S4.p2.9.m1.1"><semantics id="S4.p2.9.m1.1a"><msup id="S4.p2.9.m1.1.1" xref="S4.p2.9.m1.1.1.cmml"><mi id="S4.p2.9.m1.1.1.2" xref="S4.p2.9.m1.1.1.2.cmml">r</mi><mo id="S4.p2.9.m1.1.1.3" xref="S4.p2.9.m1.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p2.9.m1.1b"><apply id="S4.p2.9.m1.1.1.cmml" xref="S4.p2.9.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.9.m1.1.1.1.cmml" xref="S4.p2.9.m1.1.1">superscript</csymbol><ci id="S4.p2.9.m1.1.1.2.cmml" xref="S4.p2.9.m1.1.1.2">𝑟</ci><times id="S4.p2.9.m1.1.1.3.cmml" xref="S4.p2.9.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m1.1c">r^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.9.m1.1d">italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>와 이에 대응하는 최적 모델 <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S4.p2.10.m2.1"><semantics id="S4.p2.10.m2.1a"><msup id="S4.p2.10.m2.1.1" xref="S4.p2.10.m2.1.1.cmml"><mi id="S4.p2.10.m2.1.1.2" xref="S4.p2.10.m2.1.1.2.cmml">π</mi><mo id="S4.p2.10.m2.1.1.3" xref="S4.p2.10.m2.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p2.10.m2.1b"><apply id="S4.p2.10.m2.1.1.cmml" xref="S4.p2.10.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.10.m2.1.1.1.cmml" xref="S4.p2.10.m2.1.1">superscript</csymbol><ci id="S4.p2.10.m2.1.1.2.cmml" xref="S4.p2.10.m2.1.1.2">𝜋</ci><times id="S4.p2.10.m2.1.1.3.cmml" xref="S4.p2.10.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m2.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.10.m2.1d">italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>에 적용할 수 있다. 다행히도 Bradley-Terry 모델은 두 완성 간의 보상 차이, 즉 <math alttext="{p^{*}(y_{1}\succ y_{2}\mid x)=\sigma(r^{*}(x,y_{1})-r^{*}(x,y_{2}))}" class="ltx_Math" display="inline" id="S4.p2.11.m3.4"><semantics id="S4.p2.11.m3.4a"><mrow id="S4.p2.11.m3.4.4" xref="S4.p2.11.m3.4.4.cmml"><mrow id="S4.p2.11.m3.3.3.1" xref="S4.p2.11.m3.3.3.1.cmml"><msup id="S4.p2.11.m3.3.3.1.3" xref="S4.p2.11.m3.3.3.1.3.cmml"><mi id="S4.p2.11.m3.3.3.1.3.2" xref="S4.p2.11.m3.3.3.1.3.2.cmml">p</mi><mo id="S4.p2.11.m3.3.3.1.3.3" xref="S4.p2.11.m3.3.3.1.3.3.cmml">*</mo></msup><mo id="S4.p2.11.m3.3.3.1.2" xref="S4.p2.11.m3.3.3.1.2.cmml">⁢</mo><mrow id="S4.p2.11.m3.3.3.1.1.1" xref="S4.p2.11.m3.3.3.1.1.1.1.cmml"><mo id="S4.p2.11.m3.3.3.1.1.1.2" stretchy="false" xref="S4.p2.11.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.p2.11.m3.3.3.1.1.1.1" xref="S4.p2.11.m3.3.3.1.1.1.1.cmml"><msub id="S4.p2.11.m3.3.3.1.1.1.1.2" xref="S4.p2.11.m3.3.3.1.1.1.1.2.cmml"><mi id="S4.p2.11.m3.3.3.1.1.1.1.2.2" xref="S4.p2.11.m3.3.3.1.1.1.1.2.2.cmml">y</mi><mn id="S4.p2.11.m3.3.3.1.1.1.1.2.3" xref="S4.p2.11.m3.3.3.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.p2.11.m3.3.3.1.1.1.1.1" xref="S4.p2.11.m3.3.3.1.1.1.1.1.cmml">≻</mo><mrow id="S4.p2.11.m3.3.3.1.1.1.1.3" xref="S4.p2.11.m3.3.3.1.1.1.1.3.cmml"><msub id="S4.p2.11.m3.3.3.1.1.1.1.3.2" xref="S4.p2.11.m3.3.3.1.1.1.1.3.2.cmml"><mi id="S4.p2.11.m3.3.3.1.1.1.1.3.2.2" xref="S4.p2.11.m3.3.3.1.1.1.1.3.2.2.cmml">y</mi><mn id="S4.p2.11.m3.3.3.1.1.1.1.3.2.3" xref="S4.p2.11.m3.3.3.1.1.1.1.3.2.3.cmml">2</mn></msub><mo id="S4.p2.11.m3.3.3.1.1.1.1.3.1" xref="S4.p2.11.m3.3.3.1.1.1.1.3.1.cmml">∣</mo><mi id="S4.p2.11.m3.3.3.1.1.1.1.3.3" xref="S4.p2.11.m3.3.3.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S4.p2.11.m3.3.3.1.1.1.3" stretchy="false" xref="S4.p2.11.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p2.11.m3.4.4.3" xref="S4.p2.11.m3.4.4.3.cmml">=</mo><mrow id="S4.p2.11.m3.4.4.2" xref="S4.p2.11.m3.4.4.2.cmml"><mi id="S4.p2.11.m3.4.4.2.3" xref="S4.p2.11.m3.4.4.2.3.cmml">σ</mi><mo id="S4.p2.11.m3.4.4.2.2" xref="S4.p2.11.m3.4.4.2.2.cmml">⁢</mo><mrow id="S4.p2.11.m3.4.4.2.1.1" xref="S4.p2.11.m3.4.4.2.1.1.1.cmml"><mo id="S4.p2.11.m3.4.4.2.1.1.2" stretchy="false" xref="S4.p2.11.m3.4.4.2.1.1.1.cmml">(</mo><mrow id="S4.p2.11.m3.4.4.2.1.1.1" xref="S4.p2.11.m3.4.4.2.1.1.1.cmml"><mrow id="S4.p2.11.m3.4.4.2.1.1.1.1" xref="S4.p2.11.m3.4.4.2.1.1.1.1.cmml"><msup id="S4.p2.11.m3.4.4.2.1.1.1.1.3" xref="S4.p2.11.m3.4.4.2.1.1.1.1.3.cmml"><mi id="S4.p2.11.m3.4.4.2.1.1.1.1.3.2" xref="S4.p2.11.m3.4.4.2.1.1.1.1.3.2.cmml">r</mi><mo id="S4.p2.11.m3.4.4.2.1.1.1.1.3.3" xref="S4.p2.11.m3.4.4.2.1.1.1.1.3.3.cmml">*</mo></msup><mo id="S4.p2.11.m3.4.4.2.1.1.1.1.2" xref="S4.p2.11.m3.4.4.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.2.cmml"><mo id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.2.cmml">(</mo><mi id="S4.p2.11.m3.1.1" xref="S4.p2.11.m3.1.1.cmml">x</mi><mo id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.3" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.2.cmml">,</mo><msub id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.2" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.3" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.4" stretchy="false" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.p2.11.m3.4.4.2.1.1.1.3" xref="S4.p2.11.m3.4.4.2.1.1.1.3.cmml">−</mo><mrow id="S4.p2.11.m3.4.4.2.1.1.1.2" xref="S4.p2.11.m3.4.4.2.1.1.1.2.cmml"><msup id="S4.p2.11.m3.4.4.2.1.1.1.2.3" xref="S4.p2.11.m3.4.4.2.1.1.1.2.3.cmml"><mi id="S4.p2.11.m3.4.4.2.1.1.1.2.3.2" xref="S4.p2.11.m3.4.4.2.1.1.1.2.3.2.cmml">r</mi><mo id="S4.p2.11.m3.4.4.2.1.1.1.2.3.3" xref="S4.p2.11.m3.4.4.2.1.1.1.2.3.3.cmml">*</mo></msup><mo id="S4.p2.11.m3.4.4.2.1.1.1.2.2" xref="S4.p2.11.m3.4.4.2.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.2.cmml"><mo id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.2" stretchy="false" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.2.cmml">(</mo><mi id="S4.p2.11.m3.2.2" xref="S4.p2.11.m3.2.2.cmml">x</mi><mo id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.3" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.2.cmml">,</mo><msub id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.cmml"><mi id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.2" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.2.cmml">y</mi><mn id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.3" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.3.cmml">2</mn></msub><mo id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.4" stretchy="false" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.p2.11.m3.4.4.2.1.1.3" stretchy="false" xref="S4.p2.11.m3.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.11.m3.4b"><apply id="S4.p2.11.m3.4.4.cmml" xref="S4.p2.11.m3.4.4"><eq id="S4.p2.11.m3.4.4.3.cmml" xref="S4.p2.11.m3.4.4.3"></eq><apply id="S4.p2.11.m3.3.3.1.cmml" xref="S4.p2.11.m3.3.3.1"><times id="S4.p2.11.m3.3.3.1.2.cmml" xref="S4.p2.11.m3.3.3.1.2"></times><apply id="S4.p2.11.m3.3.3.1.3.cmml" xref="S4.p2.11.m3.3.3.1.3"><csymbol cd="ambiguous" id="S4.p2.11.m3.3.3.1.3.1.cmml" xref="S4.p2.11.m3.3.3.1.3">superscript</csymbol><ci id="S4.p2.11.m3.3.3.1.3.2.cmml" xref="S4.p2.11.m3.3.3.1.3.2">𝑝</ci><times id="S4.p2.11.m3.3.3.1.3.3.cmml" xref="S4.p2.11.m3.3.3.1.3.3"></times></apply><apply id="S4.p2.11.m3.3.3.1.1.1.1.cmml" xref="S4.p2.11.m3.3.3.1.1.1"><csymbol cd="latexml" id="S4.p2.11.m3.3.3.1.1.1.1.1.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.1">succeeds</csymbol><apply id="S4.p2.11.m3.3.3.1.1.1.1.2.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.11.m3.3.3.1.1.1.1.2.1.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S4.p2.11.m3.3.3.1.1.1.1.2.2.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.2.2">𝑦</ci><cn id="S4.p2.11.m3.3.3.1.1.1.1.2.3.cmml" type="integer" xref="S4.p2.11.m3.3.3.1.1.1.1.2.3">1</cn></apply><apply id="S4.p2.11.m3.3.3.1.1.1.1.3.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.3"><csymbol cd="latexml" id="S4.p2.11.m3.3.3.1.1.1.1.3.1.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.3.1">conditional</csymbol><apply id="S4.p2.11.m3.3.3.1.1.1.1.3.2.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.p2.11.m3.3.3.1.1.1.1.3.2.1.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S4.p2.11.m3.3.3.1.1.1.1.3.2.2.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.3.2.2">𝑦</ci><cn id="S4.p2.11.m3.3.3.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.p2.11.m3.3.3.1.1.1.1.3.2.3">2</cn></apply><ci id="S4.p2.11.m3.3.3.1.1.1.1.3.3.cmml" xref="S4.p2.11.m3.3.3.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="S4.p2.11.m3.4.4.2.cmml" xref="S4.p2.11.m3.4.4.2"><times id="S4.p2.11.m3.4.4.2.2.cmml" xref="S4.p2.11.m3.4.4.2.2"></times><ci id="S4.p2.11.m3.4.4.2.3.cmml" xref="S4.p2.11.m3.4.4.2.3">𝜎</ci><apply id="S4.p2.11.m3.4.4.2.1.1.1.cmml" xref="S4.p2.11.m3.4.4.2.1.1"><minus id="S4.p2.11.m3.4.4.2.1.1.1.3.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.3"></minus><apply id="S4.p2.11.m3.4.4.2.1.1.1.1.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1"><times id="S4.p2.11.m3.4.4.2.1.1.1.1.2.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1.2"></times><apply id="S4.p2.11.m3.4.4.2.1.1.1.1.3.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.11.m3.4.4.2.1.1.1.1.3.1.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1.3">superscript</csymbol><ci id="S4.p2.11.m3.4.4.2.1.1.1.1.3.2.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1.3.2">𝑟</ci><times id="S4.p2.11.m3.4.4.2.1.1.1.1.3.3.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1.3.3"></times></apply><interval closure="open" id="S4.p2.11.m3.4.4.2.1.1.1.1.1.2.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.1"><ci id="S4.p2.11.m3.1.1.cmml" xref="S4.p2.11.m3.1.1">𝑥</ci><apply id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.2">𝑦</ci><cn id="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.p2.11.m3.4.4.2.1.1.1.1.1.1.1.3">1</cn></apply></interval></apply><apply id="S4.p2.11.m3.4.4.2.1.1.1.2.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2"><times id="S4.p2.11.m3.4.4.2.1.1.1.2.2.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2.2"></times><apply id="S4.p2.11.m3.4.4.2.1.1.1.2.3.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.p2.11.m3.4.4.2.1.1.1.2.3.1.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2.3">superscript</csymbol><ci id="S4.p2.11.m3.4.4.2.1.1.1.2.3.2.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2.3.2">𝑟</ci><times id="S4.p2.11.m3.4.4.2.1.1.1.2.3.3.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2.3.3"></times></apply><interval closure="open" id="S4.p2.11.m3.4.4.2.1.1.1.2.1.2.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.1"><ci id="S4.p2.11.m3.2.2.cmml" xref="S4.p2.11.m3.2.2">𝑥</ci><apply id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.1.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1">subscript</csymbol><ci id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.2.cmml" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.2">𝑦</ci><cn id="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.3.cmml" type="integer" xref="S4.p2.11.m3.4.4.2.1.1.1.2.1.1.1.3">2</cn></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m3.4c">{p^{*}(y_{1}\succ y_{2}\mid x)=\sigma(r^{*}(x,y_{1})-r^{*}(x,y_{2}))}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.11.m3.4d">italic_p start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∣ italic_x ) = italic_σ ( italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) - italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) )</annotation></semantics></math>에만 의존한다. 재매개변수화를 식에 대입합니다. <math alttext="r^{*}(x,y)" class="ltx_Math" display="inline" id="S4.p2.12.m4.2"><semantics id="S4.p2.12.m4.2a"><mrow id="S4.p2.12.m4.2.3" xref="S4.p2.12.m4.2.3.cmml"><msup id="S4.p2.12.m4.2.3.2" xref="S4.p2.12.m4.2.3.2.cmml"><mi id="S4.p2.12.m4.2.3.2.2" xref="S4.p2.12.m4.2.3.2.2.cmml">r</mi><mo id="S4.p2.12.m4.2.3.2.3" xref="S4.p2.12.m4.2.3.2.3.cmml">*</mo></msup><mo id="S4.p2.12.m4.2.3.1" xref="S4.p2.12.m4.2.3.1.cmml">⁢</mo><mrow id="S4.p2.12.m4.2.3.3.2" xref="S4.p2.12.m4.2.3.3.1.cmml"><mo id="S4.p2.12.m4.2.3.3.2.1" stretchy="false" xref="S4.p2.12.m4.2.3.3.1.cmml">(</mo><mi id="S4.p2.12.m4.1.1" xref="S4.p2.12.m4.1.1.cmml">x</mi><mo id="S4.p2.12.m4.2.3.3.2.2" xref="S4.p2.12.m4.2.3.3.1.cmml">,</mo><mi id="S4.p2.12.m4.2.2" xref="S4.p2.12.m4.2.2.cmml">y</mi><mo id="S4.p2.12.m4.2.3.3.2.3" stretchy="false" xref="S4.p2.12.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.12.m4.2b"><apply id="S4.p2.12.m4.2.3.cmml" xref="S4.p2.12.m4.2.3"><times id="S4.p2.12.m4.2.3.1.cmml" xref="S4.p2.12.m4.2.3.1"></times><apply id="S4.p2.12.m4.2.3.2.cmml" xref="S4.p2.12.m4.2.3.2"><csymbol cd="ambiguous" id="S4.p2.12.m4.2.3.2.1.cmml" xref="S4.p2.12.m4.2.3.2">superscript</csymbol><ci id="S4.p2.12.m4.2.3.2.2.cmml" xref="S4.p2.12.m4.2.3.2.2">𝑟</ci><times id="S4.p2.12.m4.2.3.2.3.cmml" xref="S4.p2.12.m4.2.3.2.3"></times></apply><interval closure="open" id="S4.p2.12.m4.2.3.3.1.cmml" xref="S4.p2.12.m4.2.3.3.2"><ci id="S4.p2.12.m4.1.1.cmml" xref="S4.p2.12.m4.1.1">𝑥</ci><ci id="S4.p2.12.m4.2.2.cmml" xref="S4.p2.12.m4.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.12.m4.2c">r^{*}(x,y)</annotation><annotation encoding="application/x-llamapun" id="S4.p2.12.m4.2d">italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y )</annotation></semantics></math>에 대한 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E5" title="5 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a>를 선호 모델 Eq. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3.E1" title="1 ‣ 3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">1</span></a>, 파티션 함수가 취소되고, 최적의 정책 <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S4.p2.13.m5.1"><semantics id="S4.p2.13.m5.1a"><msup id="S4.p2.13.m5.1.1" xref="S4.p2.13.m5.1.1.cmml"><mi id="S4.p2.13.m5.1.1.2" xref="S4.p2.13.m5.1.1.2.cmml">π</mi><mo id="S4.p2.13.m5.1.1.3" xref="S4.p2.13.m5.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p2.13.m5.1b"><apply id="S4.p2.13.m5.1.1.cmml" xref="S4.p2.13.m5.1.1"><csymbol cd="ambiguous" id="S4.p2.13.m5.1.1.1.cmml" xref="S4.p2.13.m5.1.1">superscript</csymbol><ci id="S4.p2.13.m5.1.1.2.cmml" xref="S4.p2.13.m5.1.1.2">𝜋</ci><times id="S4.p2.13.m5.1.1.3.cmml" xref="S4.p2.13.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.13.m5.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.13.m5.1d">italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>와 참조 정책 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S4.p2.14.m6.1"><semantics id="S4.p2.14.m6.1a"><msub id="S4.p2.14.m6.1.1" xref="S4.p2.14.m6.1.1.cmml"><mi id="S4.p2.14.m6.1.1.2" xref="S4.p2.14.m6.1.1.2.cmml">π</mi><mtext id="S4.p2.14.m6.1.1.3" xref="S4.p2.14.m6.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p2.14.m6.1b"><apply id="S4.p2.14.m6.1.1.cmml" xref="S4.p2.14.m6.1.1"><csymbol cd="ambiguous" id="S4.p2.14.m6.1.1.1.cmml" xref="S4.p2.14.m6.1.1">subscript</csymbol><ci id="S4.p2.14.m6.1.1.2.cmml" xref="S4.p2.14.m6.1.1.2">𝜋</ci><ci id="S4.p2.14.m6.1.1.3a.cmml" xref="S4.p2.14.m6.1.1.3"><mtext id="S4.p2.14.m6.1.1.3.cmml" mathsize="70%" xref="S4.p2.14.m6.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.14.m6.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.14.m6.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> 만으로 인간의 선호 확률을 표현할 수 있다. 따라서, Bradley-Terry 모델 하에서 최적의 RLHF 정책 <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S4.p2.15.m7.1"><semantics id="S4.p2.15.m7.1a"><msup id="S4.p2.15.m7.1.1" xref="S4.p2.15.m7.1.1.cmml"><mi id="S4.p2.15.m7.1.1.2" xref="S4.p2.15.m7.1.1.2.cmml">π</mi><mo id="S4.p2.15.m7.1.1.3" xref="S4.p2.15.m7.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p2.15.m7.1b"><apply id="S4.p2.15.m7.1.1.cmml" xref="S4.p2.15.m7.1.1"><csymbol cd="ambiguous" id="S4.p2.15.m7.1.1.1.cmml" xref="S4.p2.15.m7.1.1">superscript</csymbol><ci id="S4.p2.15.m7.1.1.2.cmml" xref="S4.p2.15.m7.1.1.2">𝜋</ci><times id="S4.p2.15.m7.1.1.3.cmml" xref="S4.p2.15.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.15.m7.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.15.m7.1d">italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>는 선호도 모델을 만족한다:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p^{*}(y_{1}\succ y_{2}\mid x)=\frac{1}{1+\exp\left(\beta\log\frac{\pi^{*}(y_{2%
}\mid x)}{\pi_{\text{ref}}(y_{2}\mid x)}-\beta\log\frac{\pi^{*}(y_{1}\mid x)}{%
\pi_{\text{ref}}(y_{1}\mid x)}\right)}" class="ltx_Math" display="block" id="S4.E6.m1.7"><semantics id="S4.E6.m1.7a"><mrow id="S4.E6.m1.7.7" xref="S4.E6.m1.7.7.cmml"><mrow id="S4.E6.m1.7.7.1" xref="S4.E6.m1.7.7.1.cmml"><msup id="S4.E6.m1.7.7.1.3" xref="S4.E6.m1.7.7.1.3.cmml"><mi id="S4.E6.m1.7.7.1.3.2" xref="S4.E6.m1.7.7.1.3.2.cmml">p</mi><mo id="S4.E6.m1.7.7.1.3.3" xref="S4.E6.m1.7.7.1.3.3.cmml">*</mo></msup><mo id="S4.E6.m1.7.7.1.2" xref="S4.E6.m1.7.7.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.7.7.1.1.1" xref="S4.E6.m1.7.7.1.1.1.1.cmml"><mo id="S4.E6.m1.7.7.1.1.1.2" stretchy="false" xref="S4.E6.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.7.7.1.1.1.1" xref="S4.E6.m1.7.7.1.1.1.1.cmml"><msub id="S4.E6.m1.7.7.1.1.1.1.2" xref="S4.E6.m1.7.7.1.1.1.1.2.cmml"><mi id="S4.E6.m1.7.7.1.1.1.1.2.2" xref="S4.E6.m1.7.7.1.1.1.1.2.2.cmml">y</mi><mn id="S4.E6.m1.7.7.1.1.1.1.2.3" xref="S4.E6.m1.7.7.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.E6.m1.7.7.1.1.1.1.1" xref="S4.E6.m1.7.7.1.1.1.1.1.cmml">≻</mo><mrow id="S4.E6.m1.7.7.1.1.1.1.3" xref="S4.E6.m1.7.7.1.1.1.1.3.cmml"><msub id="S4.E6.m1.7.7.1.1.1.1.3.2" xref="S4.E6.m1.7.7.1.1.1.1.3.2.cmml"><mi id="S4.E6.m1.7.7.1.1.1.1.3.2.2" xref="S4.E6.m1.7.7.1.1.1.1.3.2.2.cmml">y</mi><mn id="S4.E6.m1.7.7.1.1.1.1.3.2.3" xref="S4.E6.m1.7.7.1.1.1.1.3.2.3.cmml">2</mn></msub><mo id="S4.E6.m1.7.7.1.1.1.1.3.1" xref="S4.E6.m1.7.7.1.1.1.1.3.1.cmml">∣</mo><mi id="S4.E6.m1.7.7.1.1.1.1.3.3" xref="S4.E6.m1.7.7.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S4.E6.m1.7.7.1.1.1.3" stretchy="false" xref="S4.E6.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.7.7.2" xref="S4.E6.m1.7.7.2.cmml">=</mo><mfrac id="S4.E6.m1.6.6" xref="S4.E6.m1.6.6.cmml"><mn id="S4.E6.m1.6.6.8" xref="S4.E6.m1.6.6.8.cmml">1</mn><mrow id="S4.E6.m1.6.6.6" xref="S4.E6.m1.6.6.6.cmml"><mn id="S4.E6.m1.6.6.6.8" xref="S4.E6.m1.6.6.6.8.cmml">1</mn><mo id="S4.E6.m1.6.6.6.7" xref="S4.E6.m1.6.6.6.7.cmml">+</mo><mrow id="S4.E6.m1.6.6.6.6.1" xref="S4.E6.m1.6.6.6.6.2.cmml"><mi id="S4.E6.m1.5.5.5.5" xref="S4.E6.m1.5.5.5.5.cmml">exp</mi><mo id="S4.E6.m1.6.6.6.6.1a" xref="S4.E6.m1.6.6.6.6.2.cmml">⁡</mo><mrow id="S4.E6.m1.6.6.6.6.1.1" xref="S4.E6.m1.6.6.6.6.2.cmml"><mo id="S4.E6.m1.6.6.6.6.1.1.2" xref="S4.E6.m1.6.6.6.6.2.cmml">(</mo><mrow id="S4.E6.m1.6.6.6.6.1.1.1" xref="S4.E6.m1.6.6.6.6.1.1.1.cmml"><mrow id="S4.E6.m1.6.6.6.6.1.1.1.2" xref="S4.E6.m1.6.6.6.6.1.1.1.2.cmml"><mi id="S4.E6.m1.6.6.6.6.1.1.1.2.2" xref="S4.E6.m1.6.6.6.6.1.1.1.2.2.cmml">β</mi><mo id="S4.E6.m1.6.6.6.6.1.1.1.2.1" lspace="0.167em" xref="S4.E6.m1.6.6.6.6.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E6.m1.6.6.6.6.1.1.1.2.3" xref="S4.E6.m1.6.6.6.6.1.1.1.2.3.cmml"><mi id="S4.E6.m1.6.6.6.6.1.1.1.2.3.1" xref="S4.E6.m1.6.6.6.6.1.1.1.2.3.1.cmml">log</mi><mo id="S4.E6.m1.6.6.6.6.1.1.1.2.3a" lspace="0.167em" xref="S4.E6.m1.6.6.6.6.1.1.1.2.3.cmml">⁡</mo><mfrac id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml"><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><msup id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.3.2.cmml">π</mi><mo id="S4.E6.m1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.3.3.cmml">*</mo></msup><mo id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="S4.E6.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml">2</mn></msub><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E6.m1.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.cmml"><msub id="S4.E6.m1.2.2.2.2.2.3" xref="S4.E6.m1.2.2.2.2.2.3.cmml"><mi id="S4.E6.m1.2.2.2.2.2.3.2" xref="S4.E6.m1.2.2.2.2.2.3.2.cmml">π</mi><mtext id="S4.E6.m1.2.2.2.2.2.3.3" xref="S4.E6.m1.2.2.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="S4.E6.m1.2.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E6.m1.2.2.2.2.2.1.1" xref="S4.E6.m1.2.2.2.2.2.1.1.1.cmml"><mo id="S4.E6.m1.2.2.2.2.2.1.1.2" stretchy="false" xref="S4.E6.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.2.2.2.2.2.1.1.1" xref="S4.E6.m1.2.2.2.2.2.1.1.1.cmml"><msub id="S4.E6.m1.2.2.2.2.2.1.1.1.2" xref="S4.E6.m1.2.2.2.2.2.1.1.1.2.cmml"><mi id="S4.E6.m1.2.2.2.2.2.1.1.1.2.2" xref="S4.E6.m1.2.2.2.2.2.1.1.1.2.2.cmml">y</mi><mn id="S4.E6.m1.2.2.2.2.2.1.1.1.2.3" xref="S4.E6.m1.2.2.2.2.2.1.1.1.2.3.cmml">2</mn></msub><mo id="S4.E6.m1.2.2.2.2.2.1.1.1.1" xref="S4.E6.m1.2.2.2.2.2.1.1.1.1.cmml">∣</mo><mi id="S4.E6.m1.2.2.2.2.2.1.1.1.3" xref="S4.E6.m1.2.2.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E6.m1.2.2.2.2.2.1.1.3" stretchy="false" xref="S4.E6.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S4.E6.m1.6.6.6.6.1.1.1.1" xref="S4.E6.m1.6.6.6.6.1.1.1.1.cmml">−</mo><mrow id="S4.E6.m1.6.6.6.6.1.1.1.3" xref="S4.E6.m1.6.6.6.6.1.1.1.3.cmml"><mi id="S4.E6.m1.6.6.6.6.1.1.1.3.2" xref="S4.E6.m1.6.6.6.6.1.1.1.3.2.cmml">β</mi><mo id="S4.E6.m1.6.6.6.6.1.1.1.3.1" lspace="0.167em" xref="S4.E6.m1.6.6.6.6.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E6.m1.6.6.6.6.1.1.1.3.3" xref="S4.E6.m1.6.6.6.6.1.1.1.3.3.cmml"><mi id="S4.E6.m1.6.6.6.6.1.1.1.3.3.1" xref="S4.E6.m1.6.6.6.6.1.1.1.3.3.1.cmml">log</mi><mo id="S4.E6.m1.6.6.6.6.1.1.1.3.3a" lspace="0.167em" xref="S4.E6.m1.6.6.6.6.1.1.1.3.3.cmml">⁡</mo><mfrac id="S4.E6.m1.4.4.4.4" xref="S4.E6.m1.4.4.4.4.cmml"><mrow id="S4.E6.m1.3.3.3.3.1" xref="S4.E6.m1.3.3.3.3.1.cmml"><msup id="S4.E6.m1.3.3.3.3.1.3" xref="S4.E6.m1.3.3.3.3.1.3.cmml"><mi id="S4.E6.m1.3.3.3.3.1.3.2" xref="S4.E6.m1.3.3.3.3.1.3.2.cmml">π</mi><mo id="S4.E6.m1.3.3.3.3.1.3.3" xref="S4.E6.m1.3.3.3.3.1.3.3.cmml">*</mo></msup><mo id="S4.E6.m1.3.3.3.3.1.2" xref="S4.E6.m1.3.3.3.3.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.3.3.3.3.1.1.1" xref="S4.E6.m1.3.3.3.3.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.3.3.1.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.3.3.3.3.1.1.1.1" xref="S4.E6.m1.3.3.3.3.1.1.1.1.cmml"><msub id="S4.E6.m1.3.3.3.3.1.1.1.1.2" xref="S4.E6.m1.3.3.3.3.1.1.1.1.2.cmml"><mi id="S4.E6.m1.3.3.3.3.1.1.1.1.2.2" xref="S4.E6.m1.3.3.3.3.1.1.1.1.2.2.cmml">y</mi><mn id="S4.E6.m1.3.3.3.3.1.1.1.1.2.3" xref="S4.E6.m1.3.3.3.3.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.E6.m1.3.3.3.3.1.1.1.1.1" xref="S4.E6.m1.3.3.3.3.1.1.1.1.1.cmml">∣</mo><mi id="S4.E6.m1.3.3.3.3.1.1.1.1.3" xref="S4.E6.m1.3.3.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E6.m1.3.3.3.3.1.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E6.m1.4.4.4.4.2" xref="S4.E6.m1.4.4.4.4.2.cmml"><msub id="S4.E6.m1.4.4.4.4.2.3" xref="S4.E6.m1.4.4.4.4.2.3.cmml"><mi id="S4.E6.m1.4.4.4.4.2.3.2" xref="S4.E6.m1.4.4.4.4.2.3.2.cmml">π</mi><mtext id="S4.E6.m1.4.4.4.4.2.3.3" xref="S4.E6.m1.4.4.4.4.2.3.3a.cmml">ref</mtext></msub><mo id="S4.E6.m1.4.4.4.4.2.2" xref="S4.E6.m1.4.4.4.4.2.2.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.4.4.2.1.1" xref="S4.E6.m1.4.4.4.4.2.1.1.1.cmml"><mo id="S4.E6.m1.4.4.4.4.2.1.1.2" stretchy="false" xref="S4.E6.m1.4.4.4.4.2.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.4.4.4.4.2.1.1.1" xref="S4.E6.m1.4.4.4.4.2.1.1.1.cmml"><msub id="S4.E6.m1.4.4.4.4.2.1.1.1.2" xref="S4.E6.m1.4.4.4.4.2.1.1.1.2.cmml"><mi id="S4.E6.m1.4.4.4.4.2.1.1.1.2.2" xref="S4.E6.m1.4.4.4.4.2.1.1.1.2.2.cmml">y</mi><mn id="S4.E6.m1.4.4.4.4.2.1.1.1.2.3" xref="S4.E6.m1.4.4.4.4.2.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.E6.m1.4.4.4.4.2.1.1.1.1" xref="S4.E6.m1.4.4.4.4.2.1.1.1.1.cmml">∣</mo><mi id="S4.E6.m1.4.4.4.4.2.1.1.1.3" xref="S4.E6.m1.4.4.4.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E6.m1.4.4.4.4.2.1.1.3" stretchy="false" xref="S4.E6.m1.4.4.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E6.m1.6.6.6.6.1.1.3" xref="S4.E6.m1.6.6.6.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.7b"><apply id="S4.E6.m1.7.7.cmml" xref="S4.E6.m1.7.7"><eq id="S4.E6.m1.7.7.2.cmml" xref="S4.E6.m1.7.7.2"></eq><apply id="S4.E6.m1.7.7.1.cmml" xref="S4.E6.m1.7.7.1"><times id="S4.E6.m1.7.7.1.2.cmml" xref="S4.E6.m1.7.7.1.2"></times><apply id="S4.E6.m1.7.7.1.3.cmml" xref="S4.E6.m1.7.7.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.1.3.1.cmml" xref="S4.E6.m1.7.7.1.3">superscript</csymbol><ci id="S4.E6.m1.7.7.1.3.2.cmml" xref="S4.E6.m1.7.7.1.3.2">𝑝</ci><times id="S4.E6.m1.7.7.1.3.3.cmml" xref="S4.E6.m1.7.7.1.3.3"></times></apply><apply id="S4.E6.m1.7.7.1.1.1.1.cmml" xref="S4.E6.m1.7.7.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.7.7.1.1.1.1.1.cmml" xref="S4.E6.m1.7.7.1.1.1.1.1">succeeds</csymbol><apply id="S4.E6.m1.7.7.1.1.1.1.2.cmml" xref="S4.E6.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E6.m1.7.7.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.7.7.1.1.1.1.2.2.cmml" xref="S4.E6.m1.7.7.1.1.1.1.2.2">𝑦</ci><cn id="S4.E6.m1.7.7.1.1.1.1.2.3.cmml" type="integer" xref="S4.E6.m1.7.7.1.1.1.1.2.3">1</cn></apply><apply id="S4.E6.m1.7.7.1.1.1.1.3.cmml" xref="S4.E6.m1.7.7.1.1.1.1.3"><csymbol cd="latexml" id="S4.E6.m1.7.7.1.1.1.1.3.1.cmml" xref="S4.E6.m1.7.7.1.1.1.1.3.1">conditional</csymbol><apply id="S4.E6.m1.7.7.1.1.1.1.3.2.cmml" xref="S4.E6.m1.7.7.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.7.7.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E6.m1.7.7.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.7.7.1.1.1.1.3.2.2">𝑦</ci><cn id="S4.E6.m1.7.7.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.E6.m1.7.7.1.1.1.1.3.2.3">2</cn></apply><ci id="S4.E6.m1.7.7.1.1.1.1.3.3.cmml" xref="S4.E6.m1.7.7.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="S4.E6.m1.6.6.cmml" xref="S4.E6.m1.6.6"><divide id="S4.E6.m1.6.6.7.cmml" xref="S4.E6.m1.6.6"></divide><cn id="S4.E6.m1.6.6.8.cmml" type="integer" xref="S4.E6.m1.6.6.8">1</cn><apply id="S4.E6.m1.6.6.6.cmml" xref="S4.E6.m1.6.6.6"><plus id="S4.E6.m1.6.6.6.7.cmml" xref="S4.E6.m1.6.6.6.7"></plus><cn id="S4.E6.m1.6.6.6.8.cmml" type="integer" xref="S4.E6.m1.6.6.6.8">1</cn><apply id="S4.E6.m1.6.6.6.6.2.cmml" xref="S4.E6.m1.6.6.6.6.1"><exp id="S4.E6.m1.5.5.5.5.cmml" xref="S4.E6.m1.5.5.5.5"></exp><apply id="S4.E6.m1.6.6.6.6.1.1.1.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1"><minus id="S4.E6.m1.6.6.6.6.1.1.1.1.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.1"></minus><apply id="S4.E6.m1.6.6.6.6.1.1.1.2.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.2"><times id="S4.E6.m1.6.6.6.6.1.1.1.2.1.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.2.1"></times><ci id="S4.E6.m1.6.6.6.6.1.1.1.2.2.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.2.2">𝛽</ci><apply id="S4.E6.m1.6.6.6.6.1.1.1.2.3.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.2.3"><log id="S4.E6.m1.6.6.6.6.1.1.1.2.3.1.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.2.3.1"></log><apply id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2"><divide id="S4.E6.m1.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2"></divide><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.2"></times><apply id="S4.E6.m1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.3.2">𝜋</ci><times id="S4.E6.m1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3.3"></times></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><cn id="S4.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S4.E6.m1.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2"><times id="S4.E6.m1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2"></times><apply id="S4.E6.m1.2.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.2.3.1.cmml" xref="S4.E6.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.2.3.2.cmml" xref="S4.E6.m1.2.2.2.2.2.3.2">𝜋</ci><ci id="S4.E6.m1.2.2.2.2.2.3.3a.cmml" xref="S4.E6.m1.2.2.2.2.2.3.3"><mtext id="S4.E6.m1.2.2.2.2.2.3.3.cmml" mathsize="50%" xref="S4.E6.m1.2.2.2.2.2.3.3">ref</mtext></ci></apply><apply id="S4.E6.m1.2.2.2.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1.1"><csymbol cd="latexml" id="S4.E6.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1.1.1.1">conditional</csymbol><apply id="S4.E6.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E6.m1.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.1.1.1.2.2">𝑦</ci><cn id="S4.E6.m1.2.2.2.2.2.1.1.1.2.3.cmml" type="integer" xref="S4.E6.m1.2.2.2.2.2.1.1.1.2.3">2</cn></apply><ci id="S4.E6.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E6.m1.2.2.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="S4.E6.m1.6.6.6.6.1.1.1.3.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.3"><times id="S4.E6.m1.6.6.6.6.1.1.1.3.1.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.3.1"></times><ci id="S4.E6.m1.6.6.6.6.1.1.1.3.2.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.3.2">𝛽</ci><apply id="S4.E6.m1.6.6.6.6.1.1.1.3.3.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.3.3"><log id="S4.E6.m1.6.6.6.6.1.1.1.3.3.1.cmml" xref="S4.E6.m1.6.6.6.6.1.1.1.3.3.1"></log><apply id="S4.E6.m1.4.4.4.4.cmml" xref="S4.E6.m1.4.4.4.4"><divide id="S4.E6.m1.4.4.4.4.3.cmml" xref="S4.E6.m1.4.4.4.4"></divide><apply id="S4.E6.m1.3.3.3.3.1.cmml" xref="S4.E6.m1.3.3.3.3.1"><times id="S4.E6.m1.3.3.3.3.1.2.cmml" xref="S4.E6.m1.3.3.3.3.1.2"></times><apply id="S4.E6.m1.3.3.3.3.1.3.cmml" xref="S4.E6.m1.3.3.3.3.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.3.3.1.3.1.cmml" xref="S4.E6.m1.3.3.3.3.1.3">superscript</csymbol><ci id="S4.E6.m1.3.3.3.3.1.3.2.cmml" xref="S4.E6.m1.3.3.3.3.1.3.2">𝜋</ci><times id="S4.E6.m1.3.3.3.3.1.3.3.cmml" xref="S4.E6.m1.3.3.3.3.1.3.3"></times></apply><apply id="S4.E6.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1.1.1">conditional</csymbol><apply id="S4.E6.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.3.3.3.3.1.1.1.1.2.2.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1.1.2.2">𝑦</ci><cn id="S4.E6.m1.3.3.3.3.1.1.1.1.2.3.cmml" type="integer" xref="S4.E6.m1.3.3.3.3.1.1.1.1.2.3">1</cn></apply><ci id="S4.E6.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.3.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S4.E6.m1.4.4.4.4.2.cmml" xref="S4.E6.m1.4.4.4.4.2"><times id="S4.E6.m1.4.4.4.4.2.2.cmml" xref="S4.E6.m1.4.4.4.4.2.2"></times><apply id="S4.E6.m1.4.4.4.4.2.3.cmml" xref="S4.E6.m1.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.4.2.3.1.cmml" xref="S4.E6.m1.4.4.4.4.2.3">subscript</csymbol><ci id="S4.E6.m1.4.4.4.4.2.3.2.cmml" xref="S4.E6.m1.4.4.4.4.2.3.2">𝜋</ci><ci id="S4.E6.m1.4.4.4.4.2.3.3a.cmml" xref="S4.E6.m1.4.4.4.4.2.3.3"><mtext id="S4.E6.m1.4.4.4.4.2.3.3.cmml" mathsize="50%" xref="S4.E6.m1.4.4.4.4.2.3.3">ref</mtext></ci></apply><apply id="S4.E6.m1.4.4.4.4.2.1.1.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1.1"><csymbol cd="latexml" id="S4.E6.m1.4.4.4.4.2.1.1.1.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1.1.1.1">conditional</csymbol><apply id="S4.E6.m1.4.4.4.4.2.1.1.1.2.cmml" xref="S4.E6.m1.4.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.4.2.1.1.1.2.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.4.4.4.4.2.1.1.1.2.2.cmml" xref="S4.E6.m1.4.4.4.4.2.1.1.1.2.2">𝑦</ci><cn id="S4.E6.m1.4.4.4.4.2.1.1.1.2.3.cmml" type="integer" xref="S4.E6.m1.4.4.4.4.2.1.1.1.2.3">1</cn></apply><ci id="S4.E6.m1.4.4.4.4.2.1.1.1.3.cmml" xref="S4.E6.m1.4.4.4.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.7c">p^{*}(y_{1}\succ y_{2}\mid x)=\frac{1}{1+\exp\left(\beta\log\frac{\pi^{*}(y_{2%
}\mid x)}{\pi_{\text{ref}}(y_{2}\mid x)}-\beta\log\frac{\pi^{*}(y_{1}\mid x)}{%
\pi_{\text{ref}}(y_{1}\mid x)}\right)}</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.7d">italic_p start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∣ italic_x ) = divide start_ARG 1 end_ARG start_ARG 1 + roman_exp ( italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∣ italic_x ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∣ italic_x ) end_ARG ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p2.16">유도는 부록<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS2" title="A.2 Deriving the DPO Objective Under the Bradley-Terry Model ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">A.2</span></a>에 있다. 반면에 Eq. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E6" title="6 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">6</span></a>는 Bradley-Terry 모델을 이용하며, 부록<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS3" title="A.3 Deriving the DPO Objective Under the Plackett-Luce Model ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">A.3</span></a>에 나타난 보다 일반적인 Plackett-Luce 모델<cite class="ltx_cite ltx_citemacro_citep">(Plackett, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib30" title="">1975</a>; Luce, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib21" title="">2012</a>)</cite> 하에서 유사하게 식을 도출할 수 있다.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">이제 우리는 보상 모델이 아닌 최적 정책 측면에서 인간 선호 데이터의 확률을 갖게 되었으므로 매개변수화된 정책 <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S4.p3.1.m1.1"><semantics id="S4.p3.1.m1.1a"><msub id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">π</mi><mi id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝜋</ci><ci id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>에 대한 최대 가능성 목표를 공식화할 수 있다. 보상 모델링 접근법과 유사(i.e. Eq.<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3.E2" title="2 ‣ 3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">2</span></a>) 우리의 정책 목표는 다음과 같습니다.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{ref}})=-\mathbb{E}_{(x,y_{w},%
y_{l})\sim\mathcal{D}}\left[\log\sigma\left(\beta\log\frac{\pi_{\theta}(y_{w}%
\mid x)}{\pi_{\text{ref}}(y_{w}\mid x)}-\beta\log\frac{\pi_{\theta}(y_{l}\mid x%
)}{\pi_{\text{ref}}(y_{l}\mid x)}\right)\right]." class="ltx_Math" display="block" id="S4.E7.m1.8"><semantics id="S4.E7.m1.8a"><mrow id="S4.E7.m1.8.8.1" xref="S4.E7.m1.8.8.1.1.cmml"><mrow id="S4.E7.m1.8.8.1.1" xref="S4.E7.m1.8.8.1.1.cmml"><mrow id="S4.E7.m1.8.8.1.1.2" xref="S4.E7.m1.8.8.1.1.2.cmml"><msub id="S4.E7.m1.8.8.1.1.2.4" xref="S4.E7.m1.8.8.1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.8.8.1.1.2.4.2" xref="S4.E7.m1.8.8.1.1.2.4.2.cmml">ℒ</mi><mtext id="S4.E7.m1.8.8.1.1.2.4.3" xref="S4.E7.m1.8.8.1.1.2.4.3a.cmml">DPO</mtext></msub><mo id="S4.E7.m1.8.8.1.1.2.3" xref="S4.E7.m1.8.8.1.1.2.3.cmml">⁢</mo><mrow id="S4.E7.m1.8.8.1.1.2.2.2" xref="S4.E7.m1.8.8.1.1.2.2.3.cmml"><mo id="S4.E7.m1.8.8.1.1.2.2.2.3" stretchy="false" xref="S4.E7.m1.8.8.1.1.2.2.3.cmml">(</mo><msub id="S4.E7.m1.8.8.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.8.8.1.1.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.1.1.1.1.2.cmml">π</mi><mi id="S4.E7.m1.8.8.1.1.1.1.1.1.3" xref="S4.E7.m1.8.8.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.E7.m1.8.8.1.1.2.2.2.4" xref="S4.E7.m1.8.8.1.1.2.2.3.cmml">;</mo><msub id="S4.E7.m1.8.8.1.1.2.2.2.2" xref="S4.E7.m1.8.8.1.1.2.2.2.2.cmml"><mi id="S4.E7.m1.8.8.1.1.2.2.2.2.2" xref="S4.E7.m1.8.8.1.1.2.2.2.2.2.cmml">π</mi><mtext id="S4.E7.m1.8.8.1.1.2.2.2.2.3" xref="S4.E7.m1.8.8.1.1.2.2.2.2.3a.cmml">ref</mtext></msub><mo id="S4.E7.m1.8.8.1.1.2.2.2.5" stretchy="false" xref="S4.E7.m1.8.8.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.8.8.1.1.4" xref="S4.E7.m1.8.8.1.1.4.cmml">=</mo><mrow id="S4.E7.m1.8.8.1.1.3" xref="S4.E7.m1.8.8.1.1.3.cmml"><mo id="S4.E7.m1.8.8.1.1.3a" xref="S4.E7.m1.8.8.1.1.3.cmml">−</mo><mrow id="S4.E7.m1.8.8.1.1.3.1" xref="S4.E7.m1.8.8.1.1.3.1.cmml"><msub id="S4.E7.m1.8.8.1.1.3.1.3" xref="S4.E7.m1.8.8.1.1.3.1.3.cmml"><mi id="S4.E7.m1.8.8.1.1.3.1.3.2" xref="S4.E7.m1.8.8.1.1.3.1.3.2.cmml">𝔼</mi><mrow id="S4.E7.m1.3.3.3" xref="S4.E7.m1.3.3.3.cmml"><mrow id="S4.E7.m1.3.3.3.3.2" xref="S4.E7.m1.3.3.3.3.3.cmml"><mo id="S4.E7.m1.3.3.3.3.2.3" stretchy="false" xref="S4.E7.m1.3.3.3.3.3.cmml">(</mo><mi id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml">x</mi><mo id="S4.E7.m1.3.3.3.3.2.4" xref="S4.E7.m1.3.3.3.3.3.cmml">,</mo><msub id="S4.E7.m1.2.2.2.2.1.1" xref="S4.E7.m1.2.2.2.2.1.1.cmml"><mi id="S4.E7.m1.2.2.2.2.1.1.2" xref="S4.E7.m1.2.2.2.2.1.1.2.cmml">y</mi><mi id="S4.E7.m1.2.2.2.2.1.1.3" xref="S4.E7.m1.2.2.2.2.1.1.3.cmml">w</mi></msub><mo id="S4.E7.m1.3.3.3.3.2.5" xref="S4.E7.m1.3.3.3.3.3.cmml">,</mo><msub id="S4.E7.m1.3.3.3.3.2.2" xref="S4.E7.m1.3.3.3.3.2.2.cmml"><mi id="S4.E7.m1.3.3.3.3.2.2.2" xref="S4.E7.m1.3.3.3.3.2.2.2.cmml">y</mi><mi id="S4.E7.m1.3.3.3.3.2.2.3" xref="S4.E7.m1.3.3.3.3.2.2.3.cmml">l</mi></msub><mo id="S4.E7.m1.3.3.3.3.2.6" stretchy="false" xref="S4.E7.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="S4.E7.m1.3.3.3.4" xref="S4.E7.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.3.3.3.5" xref="S4.E7.m1.3.3.3.5.cmml">𝒟</mi></mrow></msub><mo id="S4.E7.m1.8.8.1.1.3.1.2" xref="S4.E7.m1.8.8.1.1.3.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.8.8.1.1.3.1.1.1" xref="S4.E7.m1.8.8.1.1.3.1.1.2.cmml"><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.2" xref="S4.E7.m1.8.8.1.1.3.1.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.8.8.1.1.3.1.1.1.1" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.cmml"><mrow id="S4.E7.m1.8.8.1.1.3.1.1.1.1.3" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.cmml"><mi id="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.1" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.1.3a" lspace="0.167em" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.cmml">⁡</mo><mi id="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.2" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.2.cmml">β</mi><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.1" lspace="0.167em" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3.1" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mfrac id="S4.E7.m1.5.5" xref="S4.E7.m1.5.5.cmml"><mrow id="S4.E7.m1.4.4.1" xref="S4.E7.m1.4.4.1.cmml"><msub id="S4.E7.m1.4.4.1.3" xref="S4.E7.m1.4.4.1.3.cmml"><mi id="S4.E7.m1.4.4.1.3.2" xref="S4.E7.m1.4.4.1.3.2.cmml">π</mi><mi id="S4.E7.m1.4.4.1.3.3" xref="S4.E7.m1.4.4.1.3.3.cmml">θ</mi></msub><mo id="S4.E7.m1.4.4.1.2" xref="S4.E7.m1.4.4.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.cmml"><mo id="S4.E7.m1.4.4.1.1.1.2" stretchy="false" xref="S4.E7.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.4.4.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.cmml"><msub id="S4.E7.m1.4.4.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.2.2" xref="S4.E7.m1.4.4.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E7.m1.4.4.1.1.1.1.2.3" xref="S4.E7.m1.4.4.1.1.1.1.2.3.cmml">w</mi></msub><mo id="S4.E7.m1.4.4.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.cmml">∣</mo><mi id="S4.E7.m1.4.4.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E7.m1.4.4.1.1.1.3" stretchy="false" xref="S4.E7.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E7.m1.5.5.2" xref="S4.E7.m1.5.5.2.cmml"><msub id="S4.E7.m1.5.5.2.3" xref="S4.E7.m1.5.5.2.3.cmml"><mi id="S4.E7.m1.5.5.2.3.2" xref="S4.E7.m1.5.5.2.3.2.cmml">π</mi><mtext id="S4.E7.m1.5.5.2.3.3" xref="S4.E7.m1.5.5.2.3.3a.cmml">ref</mtext></msub><mo id="S4.E7.m1.5.5.2.2" xref="S4.E7.m1.5.5.2.2.cmml">⁢</mo><mrow id="S4.E7.m1.5.5.2.1.1" xref="S4.E7.m1.5.5.2.1.1.1.cmml"><mo id="S4.E7.m1.5.5.2.1.1.2" stretchy="false" xref="S4.E7.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.5.5.2.1.1.1" xref="S4.E7.m1.5.5.2.1.1.1.cmml"><msub id="S4.E7.m1.5.5.2.1.1.1.2" xref="S4.E7.m1.5.5.2.1.1.1.2.cmml"><mi id="S4.E7.m1.5.5.2.1.1.1.2.2" xref="S4.E7.m1.5.5.2.1.1.1.2.2.cmml">y</mi><mi id="S4.E7.m1.5.5.2.1.1.1.2.3" xref="S4.E7.m1.5.5.2.1.1.1.2.3.cmml">w</mi></msub><mo id="S4.E7.m1.5.5.2.1.1.1.1" xref="S4.E7.m1.5.5.2.1.1.1.1.cmml">∣</mo><mi id="S4.E7.m1.5.5.2.1.1.1.3" xref="S4.E7.m1.5.5.2.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E7.m1.5.5.2.1.1.3" stretchy="false" xref="S4.E7.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.1" lspace="0.167em" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3.1" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3.1.cmml">log</mi><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3a" lspace="0.167em" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3.cmml">⁡</mo><mfrac id="S4.E7.m1.7.7" xref="S4.E7.m1.7.7.cmml"><mrow id="S4.E7.m1.6.6.1" xref="S4.E7.m1.6.6.1.cmml"><msub id="S4.E7.m1.6.6.1.3" xref="S4.E7.m1.6.6.1.3.cmml"><mi id="S4.E7.m1.6.6.1.3.2" xref="S4.E7.m1.6.6.1.3.2.cmml">π</mi><mi id="S4.E7.m1.6.6.1.3.3" xref="S4.E7.m1.6.6.1.3.3.cmml">θ</mi></msub><mo id="S4.E7.m1.6.6.1.2" xref="S4.E7.m1.6.6.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.6.6.1.1.1" xref="S4.E7.m1.6.6.1.1.1.1.cmml"><mo id="S4.E7.m1.6.6.1.1.1.2" stretchy="false" xref="S4.E7.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.6.6.1.1.1.1" xref="S4.E7.m1.6.6.1.1.1.1.cmml"><msub id="S4.E7.m1.6.6.1.1.1.1.2" xref="S4.E7.m1.6.6.1.1.1.1.2.cmml"><mi id="S4.E7.m1.6.6.1.1.1.1.2.2" xref="S4.E7.m1.6.6.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E7.m1.6.6.1.1.1.1.2.3" xref="S4.E7.m1.6.6.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S4.E7.m1.6.6.1.1.1.1.1" xref="S4.E7.m1.6.6.1.1.1.1.1.cmml">∣</mo><mi id="S4.E7.m1.6.6.1.1.1.1.3" xref="S4.E7.m1.6.6.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E7.m1.6.6.1.1.1.3" stretchy="false" xref="S4.E7.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E7.m1.7.7.2" xref="S4.E7.m1.7.7.2.cmml"><msub id="S4.E7.m1.7.7.2.3" xref="S4.E7.m1.7.7.2.3.cmml"><mi id="S4.E7.m1.7.7.2.3.2" xref="S4.E7.m1.7.7.2.3.2.cmml">π</mi><mtext id="S4.E7.m1.7.7.2.3.3" xref="S4.E7.m1.7.7.2.3.3a.cmml">ref</mtext></msub><mo id="S4.E7.m1.7.7.2.2" xref="S4.E7.m1.7.7.2.2.cmml">⁢</mo><mrow id="S4.E7.m1.7.7.2.1.1" xref="S4.E7.m1.7.7.2.1.1.1.cmml"><mo id="S4.E7.m1.7.7.2.1.1.2" stretchy="false" xref="S4.E7.m1.7.7.2.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.7.7.2.1.1.1" xref="S4.E7.m1.7.7.2.1.1.1.cmml"><msub id="S4.E7.m1.7.7.2.1.1.1.2" xref="S4.E7.m1.7.7.2.1.1.1.2.cmml"><mi id="S4.E7.m1.7.7.2.1.1.1.2.2" xref="S4.E7.m1.7.7.2.1.1.1.2.2.cmml">y</mi><mi id="S4.E7.m1.7.7.2.1.1.1.2.3" xref="S4.E7.m1.7.7.2.1.1.1.2.3.cmml">l</mi></msub><mo id="S4.E7.m1.7.7.2.1.1.1.1" xref="S4.E7.m1.7.7.2.1.1.1.1.cmml">∣</mo><mi id="S4.E7.m1.7.7.2.1.1.1.3" xref="S4.E7.m1.7.7.2.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E7.m1.7.7.2.1.1.3" stretchy="false" xref="S4.E7.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.3" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.8.8.1.1.3.1.1.1.3" xref="S4.E7.m1.8.8.1.1.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.8.8.1.2" lspace="0em" xref="S4.E7.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.8b"><apply id="S4.E7.m1.8.8.1.1.cmml" xref="S4.E7.m1.8.8.1"><eq id="S4.E7.m1.8.8.1.1.4.cmml" xref="S4.E7.m1.8.8.1.1.4"></eq><apply id="S4.E7.m1.8.8.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.2"><times id="S4.E7.m1.8.8.1.1.2.3.cmml" xref="S4.E7.m1.8.8.1.1.2.3"></times><apply id="S4.E7.m1.8.8.1.1.2.4.cmml" xref="S4.E7.m1.8.8.1.1.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.2.4.1.cmml" xref="S4.E7.m1.8.8.1.1.2.4">subscript</csymbol><ci id="S4.E7.m1.8.8.1.1.2.4.2.cmml" xref="S4.E7.m1.8.8.1.1.2.4.2">ℒ</ci><ci id="S4.E7.m1.8.8.1.1.2.4.3a.cmml" xref="S4.E7.m1.8.8.1.1.2.4.3"><mtext id="S4.E7.m1.8.8.1.1.2.4.3.cmml" mathsize="70%" xref="S4.E7.m1.8.8.1.1.2.4.3">DPO</mtext></ci></apply><list id="S4.E7.m1.8.8.1.1.2.2.3.cmml" xref="S4.E7.m1.8.8.1.1.2.2.2"><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.E7.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.3">𝜃</ci></apply><apply id="S4.E7.m1.8.8.1.1.2.2.2.2.cmml" xref="S4.E7.m1.8.8.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.2.2.2.2.1.cmml" xref="S4.E7.m1.8.8.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.8.8.1.1.2.2.2.2.2.cmml" xref="S4.E7.m1.8.8.1.1.2.2.2.2.2">𝜋</ci><ci id="S4.E7.m1.8.8.1.1.2.2.2.2.3a.cmml" xref="S4.E7.m1.8.8.1.1.2.2.2.2.3"><mtext id="S4.E7.m1.8.8.1.1.2.2.2.2.3.cmml" mathsize="70%" xref="S4.E7.m1.8.8.1.1.2.2.2.2.3">ref</mtext></ci></apply></list></apply><apply id="S4.E7.m1.8.8.1.1.3.cmml" xref="S4.E7.m1.8.8.1.1.3"><minus id="S4.E7.m1.8.8.1.1.3.2.cmml" xref="S4.E7.m1.8.8.1.1.3"></minus><apply id="S4.E7.m1.8.8.1.1.3.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1"><times id="S4.E7.m1.8.8.1.1.3.1.2.cmml" xref="S4.E7.m1.8.8.1.1.3.1.2"></times><apply id="S4.E7.m1.8.8.1.1.3.1.3.cmml" xref="S4.E7.m1.8.8.1.1.3.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.3.1.3.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.3">subscript</csymbol><ci id="S4.E7.m1.8.8.1.1.3.1.3.2.cmml" xref="S4.E7.m1.8.8.1.1.3.1.3.2">𝔼</ci><apply id="S4.E7.m1.3.3.3.cmml" xref="S4.E7.m1.3.3.3"><csymbol cd="latexml" id="S4.E7.m1.3.3.3.4.cmml" xref="S4.E7.m1.3.3.3.4">similar-to</csymbol><vector id="S4.E7.m1.3.3.3.3.3.cmml" xref="S4.E7.m1.3.3.3.3.2"><ci id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1">𝑥</ci><apply id="S4.E7.m1.2.2.2.2.1.1.cmml" xref="S4.E7.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E7.m1.2.2.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="S4.E7.m1.2.2.2.2.1.1.3.cmml" xref="S4.E7.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="S4.E7.m1.3.3.3.3.2.2.cmml" xref="S4.E7.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.3.3.2.2.1.cmml" xref="S4.E7.m1.3.3.3.3.2.2">subscript</csymbol><ci id="S4.E7.m1.3.3.3.3.2.2.2.cmml" xref="S4.E7.m1.3.3.3.3.2.2.2">𝑦</ci><ci id="S4.E7.m1.3.3.3.3.2.2.3.cmml" xref="S4.E7.m1.3.3.3.3.2.2.3">𝑙</ci></apply></vector><ci id="S4.E7.m1.3.3.3.5.cmml" xref="S4.E7.m1.3.3.3.5">𝒟</ci></apply></apply><apply id="S4.E7.m1.8.8.1.1.3.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.8.8.1.1.3.1.1.2.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.8.8.1.1.3.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1"><times id="S4.E7.m1.8.8.1.1.3.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.2"></times><apply id="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.3"><log id="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.1"></log><ci id="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.2.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.3.2">𝜎</ci></apply><apply id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1"><minus id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.1"></minus><apply id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2"><times id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.1"></times><ci id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.2">𝛽</ci><apply id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3"><log id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.2.3.1"></log><apply id="S4.E7.m1.5.5.cmml" xref="S4.E7.m1.5.5"><divide id="S4.E7.m1.5.5.3.cmml" xref="S4.E7.m1.5.5"></divide><apply id="S4.E7.m1.4.4.1.cmml" xref="S4.E7.m1.4.4.1"><times id="S4.E7.m1.4.4.1.2.cmml" xref="S4.E7.m1.4.4.1.2"></times><apply id="S4.E7.m1.4.4.1.3.cmml" xref="S4.E7.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.3.1.cmml" xref="S4.E7.m1.4.4.1.3">subscript</csymbol><ci id="S4.E7.m1.4.4.1.3.2.cmml" xref="S4.E7.m1.4.4.1.3.2">𝜋</ci><ci id="S4.E7.m1.4.4.1.3.3.cmml" xref="S4.E7.m1.4.4.1.3.3">𝜃</ci></apply><apply id="S4.E7.m1.4.4.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.4.4.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1">conditional</csymbol><apply id="S4.E7.m1.4.4.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.2.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.2.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.2.2">𝑦</ci><ci id="S4.E7.m1.4.4.1.1.1.1.2.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.2.3">𝑤</ci></apply><ci id="S4.E7.m1.4.4.1.1.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S4.E7.m1.5.5.2.cmml" xref="S4.E7.m1.5.5.2"><times id="S4.E7.m1.5.5.2.2.cmml" xref="S4.E7.m1.5.5.2.2"></times><apply id="S4.E7.m1.5.5.2.3.cmml" xref="S4.E7.m1.5.5.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.2.3.1.cmml" xref="S4.E7.m1.5.5.2.3">subscript</csymbol><ci id="S4.E7.m1.5.5.2.3.2.cmml" xref="S4.E7.m1.5.5.2.3.2">𝜋</ci><ci id="S4.E7.m1.5.5.2.3.3a.cmml" xref="S4.E7.m1.5.5.2.3.3"><mtext id="S4.E7.m1.5.5.2.3.3.cmml" mathsize="70%" xref="S4.E7.m1.5.5.2.3.3">ref</mtext></ci></apply><apply id="S4.E7.m1.5.5.2.1.1.1.cmml" xref="S4.E7.m1.5.5.2.1.1"><csymbol cd="latexml" id="S4.E7.m1.5.5.2.1.1.1.1.cmml" xref="S4.E7.m1.5.5.2.1.1.1.1">conditional</csymbol><apply id="S4.E7.m1.5.5.2.1.1.1.2.cmml" xref="S4.E7.m1.5.5.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.2.1.1.1.2.1.cmml" xref="S4.E7.m1.5.5.2.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.5.5.2.1.1.1.2.2.cmml" xref="S4.E7.m1.5.5.2.1.1.1.2.2">𝑦</ci><ci id="S4.E7.m1.5.5.2.1.1.1.2.3.cmml" xref="S4.E7.m1.5.5.2.1.1.1.2.3">𝑤</ci></apply><ci id="S4.E7.m1.5.5.2.1.1.1.3.cmml" xref="S4.E7.m1.5.5.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3"><times id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.2">𝛽</ci><apply id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3"><log id="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.8.8.1.1.3.1.1.1.1.1.1.1.3.3.1"></log><apply id="S4.E7.m1.7.7.cmml" xref="S4.E7.m1.7.7"><divide id="S4.E7.m1.7.7.3.cmml" xref="S4.E7.m1.7.7"></divide><apply id="S4.E7.m1.6.6.1.cmml" xref="S4.E7.m1.6.6.1"><times id="S4.E7.m1.6.6.1.2.cmml" xref="S4.E7.m1.6.6.1.2"></times><apply id="S4.E7.m1.6.6.1.3.cmml" xref="S4.E7.m1.6.6.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.1.3.1.cmml" xref="S4.E7.m1.6.6.1.3">subscript</csymbol><ci id="S4.E7.m1.6.6.1.3.2.cmml" xref="S4.E7.m1.6.6.1.3.2">𝜋</ci><ci id="S4.E7.m1.6.6.1.3.3.cmml" xref="S4.E7.m1.6.6.1.3.3">𝜃</ci></apply><apply id="S4.E7.m1.6.6.1.1.1.1.cmml" xref="S4.E7.m1.6.6.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.6.6.1.1.1.1.1.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1">conditional</csymbol><apply id="S4.E7.m1.6.6.1.1.1.1.2.cmml" xref="S4.E7.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.1.1.1.1.2.1.cmml" xref="S4.E7.m1.6.6.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.6.6.1.1.1.1.2.2.cmml" xref="S4.E7.m1.6.6.1.1.1.1.2.2">𝑦</ci><ci id="S4.E7.m1.6.6.1.1.1.1.2.3.cmml" xref="S4.E7.m1.6.6.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.E7.m1.6.6.1.1.1.1.3.cmml" xref="S4.E7.m1.6.6.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S4.E7.m1.7.7.2.cmml" xref="S4.E7.m1.7.7.2"><times id="S4.E7.m1.7.7.2.2.cmml" xref="S4.E7.m1.7.7.2.2"></times><apply id="S4.E7.m1.7.7.2.3.cmml" xref="S4.E7.m1.7.7.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.2.3.1.cmml" xref="S4.E7.m1.7.7.2.3">subscript</csymbol><ci id="S4.E7.m1.7.7.2.3.2.cmml" xref="S4.E7.m1.7.7.2.3.2">𝜋</ci><ci id="S4.E7.m1.7.7.2.3.3a.cmml" xref="S4.E7.m1.7.7.2.3.3"><mtext id="S4.E7.m1.7.7.2.3.3.cmml" mathsize="70%" xref="S4.E7.m1.7.7.2.3.3">ref</mtext></ci></apply><apply id="S4.E7.m1.7.7.2.1.1.1.cmml" xref="S4.E7.m1.7.7.2.1.1"><csymbol cd="latexml" id="S4.E7.m1.7.7.2.1.1.1.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1">conditional</csymbol><apply id="S4.E7.m1.7.7.2.1.1.1.2.cmml" xref="S4.E7.m1.7.7.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.2.1.1.1.2.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.7.7.2.1.1.1.2.2.cmml" xref="S4.E7.m1.7.7.2.1.1.1.2.2">𝑦</ci><ci id="S4.E7.m1.7.7.2.1.1.1.2.3.cmml" xref="S4.E7.m1.7.7.2.1.1.1.2.3">𝑙</ci></apply><ci id="S4.E7.m1.7.7.2.1.1.1.3.cmml" xref="S4.E7.m1.7.7.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.8c">\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{ref}})=-\mathbb{E}_{(x,y_{w},%
y_{l})\sim\mathcal{D}}\left[\log\sigma\left(\beta\log\frac{\pi_{\theta}(y_{w}%
\mid x)}{\pi_{\text{ref}}(y_{w}\mid x)}-\beta\log\frac{\pi_{\theta}(y_{l}\mid x%
)}{\pi_{\text{ref}}(y_{l}\mid x)}\right)\right].</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.8d">caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ; italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) = - blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ roman_log italic_σ ( italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∣ italic_x ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∣ italic_x ) end_ARG ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p3.2">이러한 방식으로, 최적의 정책이 단순히 <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S4.p3.2.m1.1"><semantics id="S4.p3.2.m1.1a"><msub id="S4.p3.2.m1.1.1" xref="S4.p3.2.m1.1.1.cmml"><mi id="S4.p3.2.m1.1.1.2" xref="S4.p3.2.m1.1.1.2.cmml">π</mi><mi id="S4.p3.2.m1.1.1.3" xref="S4.p3.2.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.2.m1.1b"><apply id="S4.p3.2.m1.1.1.cmml" xref="S4.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S4.p3.2.m1.1.1.1.cmml" xref="S4.p3.2.m1.1.1">subscript</csymbol><ci id="S4.p3.2.m1.1.1.2.cmml" xref="S4.p3.2.m1.1.1.2">𝜋</ci><ci id="S4.p3.2.m1.1.1.3.cmml" xref="S4.p3.2.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.2.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>인 대안적 파라미터화를 사용하여 암시적 보상을 피팅한다. 또한, 본 절차는 재파라미터화된 브래들리-테리 모델을 피팅하는 것과 동일하기 때문에 선호도 데이터 분포 <cite class="ltx_cite ltx_citemacro_cite">Bong and Rinaldo (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib4" title="">2022</a>)</cite>의 적절한 가정 하에서 일관성과 같은 특정 이론적 특성을 향유한다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S5" title="5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a> 절에서는 다른 작품과 관련하여 DPO의 이론적 속성에 대해 더 논의한다.</p>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.2"><span class="ltx_text ltx_font_bold" id="S4.p4.2.1">DPO update do? </span> DPO에 대한 기계론적 이해를 위해 손실 함수 <math alttext="\mathcal{L}_{\text{DPO}}" class="ltx_Math" display="inline" id="S4.p4.1.m1.1"><semantics id="S4.p4.1.m1.1a"><msub id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.p4.1.m1.1.1.3" xref="S4.p4.1.m1.1.1.3a.cmml">DPO</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1">subscript</csymbol><ci id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2">ℒ</ci><ci id="S4.p4.1.m1.1.1.3a.cmml" xref="S4.p4.1.m1.1.1.3"><mtext id="S4.p4.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.p4.1.m1.1.1.3">DPO</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">\mathcal{L}_{\text{DPO}}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT</annotation></semantics></math>의 기울기를 분석하는 것이 유용하다. 파라미터 <math alttext="\theta" class="ltx_Math" display="inline" id="S4.p4.2.m2.1"><semantics id="S4.p4.2.m2.1a"><mi id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><ci id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.p4.2.m2.1d">italic_θ</annotation></semantics></math>에 대한 그래디언트는 다음과 같이 기입될 수 있다:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.p4.3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\theta}\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{ref}})=\\
-\beta\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\bigg{[}\underbrace{\sigma(%
\hat{r}_{\theta}(x,y_{l})-\hat{r}_{\theta}(x,y_{w}))}_{\text{higher weight %
when reward estimate is wrong}}\bigg{[}\underbrace{\nabla_{\theta}\log\pi(y_{w%
}\mid x)}_{\text{increase likelihood of $y_{w}$}}-\underbrace{\nabla_{\theta}%
\log\pi(y_{l}\mid x)}_{\text{decrease likelihood of $y_{l}$}}\bigg{]}\bigg{]}," class="ltx_Math" display="block" id="S4.p4.3.m1.32"><semantics id="S4.p4.3.m1.32a"><mtable displaystyle="true" id="S4.p4.3.m1.32.32.4" rowspacing="0pt"><mtr id="S4.p4.3.m1.32.32.4a"><mtd class="ltx_align_left" columnalign="left" id="S4.p4.3.m1.32.32.4b"><mrow id="S4.p4.3.m1.31.31.3.30.14.14"><mrow id="S4.p4.3.m1.31.31.3.30.14.14.14"><mrow id="S4.p4.3.m1.31.31.3.30.14.14.14.4"><msub id="S4.p4.3.m1.31.31.3.30.14.14.14.4.1"><mo id="S4.p4.3.m1.3.3.3.1.1.1" xref="S4.p4.3.m1.3.3.3.1.1.1.cmml">∇</mo><mi id="S4.p4.3.m1.4.4.4.2.2.2.1" xref="S4.p4.3.m1.4.4.4.2.2.2.1.cmml">θ</mi></msub><msub id="S4.p4.3.m1.31.31.3.30.14.14.14.4.2"><mi class="ltx_font_mathcaligraphic" id="S4.p4.3.m1.5.5.5.3.3.3" xref="S4.p4.3.m1.5.5.5.3.3.3.cmml">ℒ</mi><mtext id="S4.p4.3.m1.6.6.6.4.4.4.1" xref="S4.p4.3.m1.6.6.6.4.4.4.1a.cmml">DPO</mtext></msub></mrow><mo id="S4.p4.3.m1.31.31.3.30.14.14.14.3" xref="S4.p4.3.m1.29.29.1.1.1.cmml">⁢</mo><mrow id="S4.p4.3.m1.31.31.3.30.14.14.14.2.2"><mo id="S4.p4.3.m1.7.7.7.5.5.5" stretchy="false" xref="S4.p4.3.m1.29.29.1.1.1.cmml">(</mo><msub id="S4.p4.3.m1.30.30.2.29.13.13.13.1.1.1"><mi id="S4.p4.3.m1.8.8.8.6.6.6" xref="S4.p4.3.m1.8.8.8.6.6.6.cmml">π</mi><mi id="S4.p4.3.m1.9.9.9.7.7.7.1" xref="S4.p4.3.m1.9.9.9.7.7.7.1.cmml">θ</mi></msub><mo id="S4.p4.3.m1.10.10.10.8.8.8" xref="S4.p4.3.m1.29.29.1.1.1.cmml">;</mo><msub id="S4.p4.3.m1.31.31.3.30.14.14.14.2.2.2"><mi id="S4.p4.3.m1.11.11.11.9.9.9" xref="S4.p4.3.m1.11.11.11.9.9.9.cmml">π</mi><mtext id="S4.p4.3.m1.12.12.12.10.10.10.1" xref="S4.p4.3.m1.12.12.12.10.10.10.1a.cmml">ref</mtext></msub><mo id="S4.p4.3.m1.13.13.13.11.11.11" stretchy="false" xref="S4.p4.3.m1.29.29.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p4.3.m1.14.14.14.12.12.12" xref="S4.p4.3.m1.14.14.14.12.12.12.cmml">=</mo><mi id="S4.p4.3.m1.31.31.3.30.14.14.15" xref="S4.p4.3.m1.29.29.1.1.1.cmml"></mi></mrow></mtd></mtr><mtr id="S4.p4.3.m1.32.32.4c"><mtd class="ltx_align_right" columnalign="right" id="S4.p4.3.m1.32.32.4d"><mrow id="S4.p4.3.m1.32.32.4.31.17.17.17"><mrow id="S4.p4.3.m1.32.32.4.31.17.17.17.1"><mo id="S4.p4.3.m1.32.32.4.31.17.17.17.1a" xref="S4.p4.3.m1.29.29.1.1.1.cmml">−</mo><mrow id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1"><mi id="S4.p4.3.m1.16.16.16.4.4.4" xref="S4.p4.3.m1.16.16.16.4.4.4.cmml">β</mi><mo id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.2" xref="S4.p4.3.m1.29.29.1.1.1.cmml">⁢</mo><msub id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.3"><mi id="S4.p4.3.m1.17.17.17.5.5.5" xref="S4.p4.3.m1.17.17.17.5.5.5.cmml">𝔼</mi><mrow id="S4.p4.3.m1.18.18.18.6.6.6.1" xref="S4.p4.3.m1.18.18.18.6.6.6.1.cmml"><mrow id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.3.cmml"><mo id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.3" stretchy="false" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.3.cmml">(</mo><mi id="S4.p4.3.m1.18.18.18.6.6.6.1.1" xref="S4.p4.3.m1.18.18.18.6.6.6.1.1.cmml">x</mi><mo id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.4" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.3.cmml">,</mo><msub id="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1" xref="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.cmml"><mi id="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.2" xref="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.2.cmml">y</mi><mi id="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.3" xref="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.3.cmml">w</mi></msub><mo id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.5" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.3.cmml">,</mo><msub id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.cmml"><mi id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.2" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.2.cmml">y</mi><mi id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.3" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.3.cmml">l</mi></msub><mo id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.6" stretchy="false" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.3.cmml">)</mo></mrow><mo id="S4.p4.3.m1.18.18.18.6.6.6.1.4" xref="S4.p4.3.m1.18.18.18.6.6.6.1.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.p4.3.m1.18.18.18.6.6.6.1.5" xref="S4.p4.3.m1.18.18.18.6.6.6.1.5.cmml">𝒟</mi></mrow></msub><mo id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.2a" xref="S4.p4.3.m1.29.29.1.1.1.cmml">⁢</mo><mrow id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.1.1"><mo id="S4.p4.3.m1.19.19.19.7.7.7" maxsize="210%" minsize="210%" xref="S4.p4.3.m1.29.29.1.1.1.cmml">[</mo><mrow id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.1.1.1"><munder id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.1.1.1.3"><munder accentunder="true" id="S4.p4.3.m1.20.20.20.8.8.8" xref="S4.p4.3.m1.20.20.20.8.8.8.cmml"><mrow id="S4.p4.3.m1.20.20.20.8.8.8.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.cmml"><mi id="S4.p4.3.m1.20.20.20.8.8.8.3.5" xref="S4.p4.3.m1.20.20.20.8.8.8.3.5.cmml">σ</mi><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.4" xref="S4.p4.3.m1.20.20.20.8.8.8.3.4.cmml">⁢</mo><mrow id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.cmml"><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.2" stretchy="false" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.cmml">(</mo><mrow id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.cmml"><mrow id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.cmml"><msub id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.cmml"><mover accent="true" id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.cmml"><mi id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.2" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.2.cmml">r</mi><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.1" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.2" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.2.cmml"><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.2.cmml">(</mo><mi id="S4.p4.3.m1.20.20.20.8.8.8.1.1" xref="S4.p4.3.m1.20.20.20.8.8.8.1.1.cmml">x</mi><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.2.cmml">,</mo><msub id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.cmml"><mi id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.2" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.2.cmml">y</mi><mi id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.4" stretchy="false" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.3.cmml">−</mo><mrow id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.cmml"><msub id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.cmml"><mover accent="true" id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.cmml"><mi id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.2" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.2.cmml">r</mi><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.1" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.1.cmml">^</mo></mover><mi id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.3.cmml">θ</mi></msub><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.2" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.2.cmml"><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.2" stretchy="false" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.2.cmml">(</mo><mi id="S4.p4.3.m1.20.20.20.8.8.8.2.2" xref="S4.p4.3.m1.20.20.20.8.8.8.2.2.cmml">x</mi><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.2.cmml">,</mo><msub id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.cmml"><mi id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.2" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.2.cmml">y</mi><mi id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.3" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.3.cmml">w</mi></msub><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.4" stretchy="false" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.3" stretchy="false" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p4.3.m1.20.20.20.8.8.8.4" xref="S4.p4.3.m1.20.20.20.8.8.8.4.cmml">⏟</mo></munder><mtext id="S4.p4.3.m1.21.21.21.9.9.9.1" xref="S4.p4.3.m1.21.21.21.9.9.9.1a.cmml">higher weight when reward estimate is wrong</mtext></munder><mo id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.1.1.1.2" xref="S4.p4.3.m1.29.29.1.1.1.cmml">⁢</mo><mrow id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.1.1.1.1.1"><mo id="S4.p4.3.m1.22.22.22.10.10.10" maxsize="210%" minsize="210%" xref="S4.p4.3.m1.29.29.1.1.1.cmml">[</mo><mrow id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.1.1.1.1.1.1"><munder id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.1.1.1.1.1.1.1"><munder accentunder="true" id="S4.p4.3.m1.23.23.23.11.11.11" xref="S4.p4.3.m1.23.23.23.11.11.11.cmml"><mrow id="S4.p4.3.m1.23.23.23.11.11.11.1" xref="S4.p4.3.m1.23.23.23.11.11.11.1.cmml"><mrow id="S4.p4.3.m1.23.23.23.11.11.11.1.3" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.cmml"><mrow id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.cmml"><msub id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.cmml"><mo id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.2" rspace="0.167em" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.2.cmml">∇</mo><mi id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.3" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.3.cmml">θ</mi></msub><mi id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.2" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.2.cmml">log</mi></mrow><mo id="S4.p4.3.m1.23.23.23.11.11.11.1.3a" lspace="0.167em" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.cmml">⁡</mo><mi id="S4.p4.3.m1.23.23.23.11.11.11.1.3.2" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.2.cmml">π</mi></mrow><mo id="S4.p4.3.m1.23.23.23.11.11.11.1.2" xref="S4.p4.3.m1.23.23.23.11.11.11.1.2.cmml">⁢</mo><mrow id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.cmml"><mo id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.2" stretchy="false" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.cmml">(</mo><mrow id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.cmml"><msub id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.cmml"><mi id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.2" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.2.cmml">y</mi><mi id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.3" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.3.cmml">w</mi></msub><mo id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.1" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.1.cmml">∣</mo><mi id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.3" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.3" stretchy="false" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p4.3.m1.23.23.23.11.11.11.2" xref="S4.p4.3.m1.23.23.23.11.11.11.2.cmml">⏟</mo></munder><mrow id="S4.p4.3.m1.1.1.1.1.1.1.1" xref="S4.p4.3.m1.1.1.1.1.1.1.1b.cmml"><mtext id="S4.p4.3.m1.1.1.1.1.1.1.1a" xref="S4.p4.3.m1.1.1.1.1.1.1.1b.cmml">increase likelihood of&nbsp;</mtext><msub id="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">y</mi><mi id="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.3" mathsize="98%" xref="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">w</mi></msub></mrow></munder><mo id="S4.p4.3.m1.24.24.24.12.12.12" xref="S4.p4.3.m1.24.24.24.12.12.12.cmml">−</mo><munder id="S4.p4.3.m1.32.32.4.31.17.17.17.1.1.1.1.1.1.1.1.2"><munder accentunder="true" id="S4.p4.3.m1.25.25.25.13.13.13" xref="S4.p4.3.m1.25.25.25.13.13.13.cmml"><mrow id="S4.p4.3.m1.25.25.25.13.13.13.1" xref="S4.p4.3.m1.25.25.25.13.13.13.1.cmml"><mrow id="S4.p4.3.m1.25.25.25.13.13.13.1.3" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.cmml"><mrow id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.cmml"><msub id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.cmml"><mo id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.2" rspace="0.167em" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.2.cmml">∇</mo><mi id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.3" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.3.cmml">θ</mi></msub><mi id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.2" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.2.cmml">log</mi></mrow><mo id="S4.p4.3.m1.25.25.25.13.13.13.1.3a" lspace="0.167em" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.cmml">⁡</mo><mi id="S4.p4.3.m1.25.25.25.13.13.13.1.3.2" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.2.cmml">π</mi></mrow><mo id="S4.p4.3.m1.25.25.25.13.13.13.1.2" xref="S4.p4.3.m1.25.25.25.13.13.13.1.2.cmml">⁢</mo><mrow id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.cmml"><mo id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.2" stretchy="false" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.cmml">(</mo><mrow id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.cmml"><msub id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.cmml"><mi id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.2" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.2.cmml">y</mi><mi id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.3" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.1" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.1.cmml">∣</mo><mi id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.3" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.3" stretchy="false" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p4.3.m1.25.25.25.13.13.13.2" xref="S4.p4.3.m1.25.25.25.13.13.13.2.cmml">⏟</mo></munder><mrow id="S4.p4.3.m1.2.2.2.2.2.2.1" xref="S4.p4.3.m1.2.2.2.2.2.2.1b.cmml"><mtext id="S4.p4.3.m1.2.2.2.2.2.2.1a" xref="S4.p4.3.m1.2.2.2.2.2.2.1b.cmml">decrease likelihood of&nbsp;</mtext><msub id="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1" xref="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.cmml"><mi id="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.2" xref="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.2.cmml">y</mi><mi id="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.3" mathsize="98%" xref="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.3.cmml">l</mi></msub></mrow></munder></mrow><mo id="S4.p4.3.m1.26.26.26.14.14.14" maxsize="210%" minsize="210%" xref="S4.p4.3.m1.29.29.1.1.1.cmml">]</mo></mrow></mrow><mo id="S4.p4.3.m1.27.27.27.15.15.15" maxsize="210%" minsize="210%" xref="S4.p4.3.m1.29.29.1.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.p4.3.m1.28.28.28.16.16.16" xref="S4.p4.3.m1.29.29.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.p4.3.m1.32b"><apply id="S4.p4.3.m1.29.29.1.1.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><eq id="S4.p4.3.m1.14.14.14.12.12.12.cmml" xref="S4.p4.3.m1.14.14.14.12.12.12"></eq><apply id="S4.p4.3.m1.29.29.1.1.1.2.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><times id="S4.p4.3.m1.29.29.1.1.1.2.3.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"></times><apply id="S4.p4.3.m1.29.29.1.1.1.2.4.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><apply id="S4.p4.3.m1.29.29.1.1.1.2.4.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.29.29.1.1.1.2.4.1.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.p4.3.m1.3.3.3.1.1.1.cmml" xref="S4.p4.3.m1.3.3.3.1.1.1">∇</ci><ci id="S4.p4.3.m1.4.4.4.2.2.2.1.cmml" xref="S4.p4.3.m1.4.4.4.2.2.2.1">𝜃</ci></apply><apply id="S4.p4.3.m1.29.29.1.1.1.2.4.2.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.29.29.1.1.1.2.4.2.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.p4.3.m1.5.5.5.3.3.3.cmml" xref="S4.p4.3.m1.5.5.5.3.3.3">ℒ</ci><ci id="S4.p4.3.m1.6.6.6.4.4.4.1a.cmml" xref="S4.p4.3.m1.6.6.6.4.4.4.1"><mtext id="S4.p4.3.m1.6.6.6.4.4.4.1.cmml" mathsize="70%" xref="S4.p4.3.m1.6.6.6.4.4.4.1">DPO</mtext></ci></apply></apply><list id="S4.p4.3.m1.29.29.1.1.1.2.2.3.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><apply id="S4.p4.3.m1.29.29.1.1.1.1.1.1.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.29.29.1.1.1.1.1.1.1.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.p4.3.m1.8.8.8.6.6.6.cmml" xref="S4.p4.3.m1.8.8.8.6.6.6">𝜋</ci><ci id="S4.p4.3.m1.9.9.9.7.7.7.1.cmml" xref="S4.p4.3.m1.9.9.9.7.7.7.1">𝜃</ci></apply><apply id="S4.p4.3.m1.29.29.1.1.1.2.2.2.2.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.29.29.1.1.1.2.2.2.2.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.p4.3.m1.11.11.11.9.9.9.cmml" xref="S4.p4.3.m1.11.11.11.9.9.9">𝜋</ci><ci id="S4.p4.3.m1.12.12.12.10.10.10.1a.cmml" xref="S4.p4.3.m1.12.12.12.10.10.10.1"><mtext id="S4.p4.3.m1.12.12.12.10.10.10.1.cmml" mathsize="70%" xref="S4.p4.3.m1.12.12.12.10.10.10.1">ref</mtext></ci></apply></list></apply><apply id="S4.p4.3.m1.29.29.1.1.1.3.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><minus id="S4.p4.3.m1.15.15.15.3.3.3.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"></minus><apply id="S4.p4.3.m1.29.29.1.1.1.3.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><times id="S4.p4.3.m1.29.29.1.1.1.3.1.2.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"></times><ci id="S4.p4.3.m1.16.16.16.4.4.4.cmml" xref="S4.p4.3.m1.16.16.16.4.4.4">𝛽</ci><apply id="S4.p4.3.m1.29.29.1.1.1.3.1.4.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.29.29.1.1.1.3.1.4.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.p4.3.m1.17.17.17.5.5.5.cmml" xref="S4.p4.3.m1.17.17.17.5.5.5">𝔼</ci><apply id="S4.p4.3.m1.18.18.18.6.6.6.1.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1"><csymbol cd="latexml" id="S4.p4.3.m1.18.18.18.6.6.6.1.4.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.4">similar-to</csymbol><vector id="S4.p4.3.m1.18.18.18.6.6.6.1.3.3.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.2"><ci id="S4.p4.3.m1.18.18.18.6.6.6.1.1.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.1">𝑥</ci><apply id="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1"><csymbol cd="ambiguous" id="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.1.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1">subscript</csymbol><ci id="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.2.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.2">𝑦</ci><ci id="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.3.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.2.1.1.3">𝑤</ci></apply><apply id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2"><csymbol cd="ambiguous" id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.1.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2">subscript</csymbol><ci id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.2.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.2">𝑦</ci><ci id="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.3.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.3.2.2.3">𝑙</ci></apply></vector><ci id="S4.p4.3.m1.18.18.18.6.6.6.1.5.cmml" xref="S4.p4.3.m1.18.18.18.6.6.6.1.5">𝒟</ci></apply></apply><apply id="S4.p4.3.m1.29.29.1.1.1.3.1.1.2.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="latexml" id="S4.p4.3.m1.29.29.1.1.1.3.1.1.2.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">delimited-[]</csymbol><apply id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><times id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.2.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"></times><apply id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.3.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.3.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">subscript</csymbol><apply id="S4.p4.3.m1.20.20.20.8.8.8.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8"><ci id="S4.p4.3.m1.20.20.20.8.8.8.4.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.4">⏟</ci><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3"><times id="S4.p4.3.m1.20.20.20.8.8.8.3.4.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.4"></times><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.5.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.5">𝜎</ci><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1"><minus id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.3.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.3"></minus><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1"><times id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.2"></times><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3">subscript</csymbol><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2"><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.1">^</ci><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.2.2">𝑟</ci></apply><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.3.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1"><ci id="S4.p4.3.m1.20.20.20.8.8.8.1.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.1.1">𝑥</ci><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.3.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.1.1.1.1.3">𝑙</ci></apply></interval></apply><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2"><times id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.2"></times><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3">subscript</csymbol><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2"><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.1">^</ci><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.2.2">𝑟</ci></apply><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.3.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.3.3">𝜃</ci></apply><interval closure="open" id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1"><ci id="S4.p4.3.m1.20.20.20.8.8.8.2.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.2.2">𝑥</ci><apply id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.1.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1">subscript</csymbol><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.2.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.2">𝑦</ci><ci id="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.3.cmml" xref="S4.p4.3.m1.20.20.20.8.8.8.3.3.1.1.2.1.1.1.3">𝑤</ci></apply></interval></apply></apply></apply></apply><ci id="S4.p4.3.m1.21.21.21.9.9.9.1a.cmml" xref="S4.p4.3.m1.21.21.21.9.9.9.1"><mtext id="S4.p4.3.m1.21.21.21.9.9.9.1.cmml" mathsize="70%" xref="S4.p4.3.m1.21.21.21.9.9.9.1">higher weight when reward estimate is wrong</mtext></ci></apply><apply id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.1.2.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="latexml" id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.1.2.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">delimited-[]</csymbol><apply id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><minus id="S4.p4.3.m1.24.24.24.12.12.12.cmml" xref="S4.p4.3.m1.24.24.24.12.12.12"></minus><apply id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">subscript</csymbol><apply id="S4.p4.3.m1.23.23.23.11.11.11.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11"><ci id="S4.p4.3.m1.23.23.23.11.11.11.2.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.2">⏟</ci><apply id="S4.p4.3.m1.23.23.23.11.11.11.1.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1"><times id="S4.p4.3.m1.23.23.23.11.11.11.1.2.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.2"></times><apply id="S4.p4.3.m1.23.23.23.11.11.11.1.3.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3"><apply id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1"><apply id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1"><csymbol cd="ambiguous" id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.1.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1">subscript</csymbol><ci id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.2.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.2">∇</ci><ci id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.3.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.1.3">𝜃</ci></apply><log id="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.2.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.1.2"></log></apply><ci id="S4.p4.3.m1.23.23.23.11.11.11.1.3.2.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.3.2">𝜋</ci></apply><apply id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1"><csymbol cd="latexml" id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.1.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.1">conditional</csymbol><apply id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.1.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2">subscript</csymbol><ci id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.2.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.2">𝑦</ci><ci id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.3.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.2.3">𝑤</ci></apply><ci id="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.3.cmml" xref="S4.p4.3.m1.23.23.23.11.11.11.1.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S4.p4.3.m1.1.1.1.1.1.1.1b.cmml" xref="S4.p4.3.m1.1.1.1.1.1.1.1"><mrow id="S4.p4.3.m1.1.1.1.1.1.1.1.cmml" xref="S4.p4.3.m1.1.1.1.1.1.1.1"><mtext id="S4.p4.3.m1.1.1.1.1.1.1.1a.cmml" mathsize="70%" xref="S4.p4.3.m1.1.1.1.1.1.1.1">increase likelihood of&nbsp;</mtext><msub id="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1"><mi id="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" mathsize="70%" xref="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.2">y</mi><mi id="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.p4.3.m1.1.1.1.1.1.1.1.1.1.m1.1.1.3">w</mi></msub></mrow></ci></apply><apply id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.p4.3.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.p4.3.m1.31.31.3.30.14.14.14.3">subscript</csymbol><apply id="S4.p4.3.m1.25.25.25.13.13.13.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13"><ci id="S4.p4.3.m1.25.25.25.13.13.13.2.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.2">⏟</ci><apply id="S4.p4.3.m1.25.25.25.13.13.13.1.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1"><times id="S4.p4.3.m1.25.25.25.13.13.13.1.2.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.2"></times><apply id="S4.p4.3.m1.25.25.25.13.13.13.1.3.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3"><apply id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1"><apply id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1"><csymbol cd="ambiguous" id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.1.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1">subscript</csymbol><ci id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.2.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.2">∇</ci><ci id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.3.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.1.3">𝜃</ci></apply><log id="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.2.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.1.2"></log></apply><ci id="S4.p4.3.m1.25.25.25.13.13.13.1.3.2.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.3.2">𝜋</ci></apply><apply id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1"><csymbol cd="latexml" id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.1.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.1">conditional</csymbol><apply id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.1.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2">subscript</csymbol><ci id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.2.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.2">𝑦</ci><ci id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.3.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.3.cmml" xref="S4.p4.3.m1.25.25.25.13.13.13.1.1.1.1.3">𝑥</ci></apply></apply></apply><ci id="S4.p4.3.m1.2.2.2.2.2.2.1b.cmml" xref="S4.p4.3.m1.2.2.2.2.2.2.1"><mrow id="S4.p4.3.m1.2.2.2.2.2.2.1.cmml" xref="S4.p4.3.m1.2.2.2.2.2.2.1"><mtext id="S4.p4.3.m1.2.2.2.2.2.2.1a.cmml" mathsize="70%" xref="S4.p4.3.m1.2.2.2.2.2.2.1">decrease likelihood of&nbsp;</mtext><msub id="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.cmml" xref="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1"><mi id="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.2.cmml" mathsize="70%" xref="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.2">y</mi><mi id="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.p4.3.m1.2.2.2.2.2.2.1.1.1.m1.1.1.3">l</mi></msub></mrow></ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m1.32c">\nabla_{\theta}\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{ref}})=\\
-\beta\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\bigg{[}\underbrace{\sigma(%
\hat{r}_{\theta}(x,y_{l})-\hat{r}_{\theta}(x,y_{w}))}_{\text{higher weight %
when reward estimate is wrong}}\bigg{[}\underbrace{\nabla_{\theta}\log\pi(y_{w%
}\mid x)}_{\text{increase likelihood of $y_{w}$}}-\underbrace{\nabla_{\theta}%
\log\pi(y_{l}\mid x)}_{\text{decrease likelihood of $y_{l}$}}\bigg{]}\bigg{]},</annotation><annotation encoding="application/x-llamapun" id="S4.p4.3.m1.32d">start_ROW start_CELL ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ; italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) = end_CELL end_ROW start_ROW start_CELL - italic_β blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ under⏟ start_ARG italic_σ ( over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) - over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) ) end_ARG start_POSTSUBSCRIPT higher weight when reward estimate is wrong end_POSTSUBSCRIPT [ under⏟ start_ARG ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log italic_π ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∣ italic_x ) end_ARG start_POSTSUBSCRIPT increase likelihood of italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT end_POSTSUBSCRIPT - under⏟ start_ARG ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log italic_π ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∣ italic_x ) end_ARG start_POSTSUBSCRIPT decrease likelihood of italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ] , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p4.11">여기서 <math alttext="\hat{r}_{\theta}(x,y)=\beta\log\frac{\pi_{\theta}(y\mid x)}{\pi_{\text{ref}}(y% \mid x)}" class="ltx_Math" display="inline" id="S4.p4.4.m1.4"><semantics id="S4.p4.4.m1.4a"><mrow id="S4.p4.4.m1.4.5" xref="S4.p4.4.m1.4.5.cmml"><mrow id="S4.p4.4.m1.4.5.2" xref="S4.p4.4.m1.4.5.2.cmml"><msub id="S4.p4.4.m1.4.5.2.2" xref="S4.p4.4.m1.4.5.2.2.cmml"><mover accent="true" id="S4.p4.4.m1.4.5.2.2.2" xref="S4.p4.4.m1.4.5.2.2.2.cmml"><mi id="S4.p4.4.m1.4.5.2.2.2.2" xref="S4.p4.4.m1.4.5.2.2.2.2.cmml">r</mi><mo id="S4.p4.4.m1.4.5.2.2.2.1" xref="S4.p4.4.m1.4.5.2.2.2.1.cmml">^</mo></mover><mi id="S4.p4.4.m1.4.5.2.2.3" xref="S4.p4.4.m1.4.5.2.2.3.cmml">θ</mi></msub><mo id="S4.p4.4.m1.4.5.2.1" xref="S4.p4.4.m1.4.5.2.1.cmml">⁢</mo><mrow id="S4.p4.4.m1.4.5.2.3.2" xref="S4.p4.4.m1.4.5.2.3.1.cmml"><mo id="S4.p4.4.m1.4.5.2.3.2.1" stretchy="false" xref="S4.p4.4.m1.4.5.2.3.1.cmml">(</mo><mi id="S4.p4.4.m1.3.3" xref="S4.p4.4.m1.3.3.cmml">x</mi><mo id="S4.p4.4.m1.4.5.2.3.2.2" xref="S4.p4.4.m1.4.5.2.3.1.cmml">,</mo><mi id="S4.p4.4.m1.4.4" xref="S4.p4.4.m1.4.4.cmml">y</mi><mo id="S4.p4.4.m1.4.5.2.3.2.3" stretchy="false" xref="S4.p4.4.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.p4.4.m1.4.5.1" xref="S4.p4.4.m1.4.5.1.cmml">=</mo><mrow id="S4.p4.4.m1.4.5.3" xref="S4.p4.4.m1.4.5.3.cmml"><mi id="S4.p4.4.m1.4.5.3.2" xref="S4.p4.4.m1.4.5.3.2.cmml">β</mi><mo id="S4.p4.4.m1.4.5.3.1" lspace="0.167em" xref="S4.p4.4.m1.4.5.3.1.cmml">⁢</mo><mrow id="S4.p4.4.m1.4.5.3.3" xref="S4.p4.4.m1.4.5.3.3.cmml"><mi id="S4.p4.4.m1.4.5.3.3.1" xref="S4.p4.4.m1.4.5.3.3.1.cmml">log</mi><mo id="S4.p4.4.m1.4.5.3.3a" lspace="0.167em" xref="S4.p4.4.m1.4.5.3.3.cmml">⁡</mo><mfrac id="S4.p4.4.m1.2.2" xref="S4.p4.4.m1.2.2.cmml"><mrow id="S4.p4.4.m1.1.1.1" xref="S4.p4.4.m1.1.1.1.cmml"><msub id="S4.p4.4.m1.1.1.1.3" xref="S4.p4.4.m1.1.1.1.3.cmml"><mi id="S4.p4.4.m1.1.1.1.3.2" xref="S4.p4.4.m1.1.1.1.3.2.cmml">π</mi><mi id="S4.p4.4.m1.1.1.1.3.3" xref="S4.p4.4.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.p4.4.m1.1.1.1.2" xref="S4.p4.4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.p4.4.m1.1.1.1.1.1" xref="S4.p4.4.m1.1.1.1.1.1.1.cmml"><mo id="S4.p4.4.m1.1.1.1.1.1.2" stretchy="false" xref="S4.p4.4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p4.4.m1.1.1.1.1.1.1" xref="S4.p4.4.m1.1.1.1.1.1.1.cmml"><mi id="S4.p4.4.m1.1.1.1.1.1.1.2" xref="S4.p4.4.m1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.p4.4.m1.1.1.1.1.1.1.1" xref="S4.p4.4.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.p4.4.m1.1.1.1.1.1.1.3" xref="S4.p4.4.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.p4.4.m1.1.1.1.1.1.3" stretchy="false" xref="S4.p4.4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.p4.4.m1.2.2.2" xref="S4.p4.4.m1.2.2.2.cmml"><msub id="S4.p4.4.m1.2.2.2.3" xref="S4.p4.4.m1.2.2.2.3.cmml"><mi id="S4.p4.4.m1.2.2.2.3.2" xref="S4.p4.4.m1.2.2.2.3.2.cmml">π</mi><mtext id="S4.p4.4.m1.2.2.2.3.3" xref="S4.p4.4.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="S4.p4.4.m1.2.2.2.2" xref="S4.p4.4.m1.2.2.2.2.cmml">⁢</mo><mrow id="S4.p4.4.m1.2.2.2.1.1" xref="S4.p4.4.m1.2.2.2.1.1.1.cmml"><mo id="S4.p4.4.m1.2.2.2.1.1.2" stretchy="false" xref="S4.p4.4.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.p4.4.m1.2.2.2.1.1.1" xref="S4.p4.4.m1.2.2.2.1.1.1.cmml"><mi id="S4.p4.4.m1.2.2.2.1.1.1.2" xref="S4.p4.4.m1.2.2.2.1.1.1.2.cmml">y</mi><mo id="S4.p4.4.m1.2.2.2.1.1.1.1" xref="S4.p4.4.m1.2.2.2.1.1.1.1.cmml">∣</mo><mi id="S4.p4.4.m1.2.2.2.1.1.1.3" xref="S4.p4.4.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S4.p4.4.m1.2.2.2.1.1.3" stretchy="false" xref="S4.p4.4.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.4.m1.4b"><apply id="S4.p4.4.m1.4.5.cmml" xref="S4.p4.4.m1.4.5"><eq id="S4.p4.4.m1.4.5.1.cmml" xref="S4.p4.4.m1.4.5.1"></eq><apply id="S4.p4.4.m1.4.5.2.cmml" xref="S4.p4.4.m1.4.5.2"><times id="S4.p4.4.m1.4.5.2.1.cmml" xref="S4.p4.4.m1.4.5.2.1"></times><apply id="S4.p4.4.m1.4.5.2.2.cmml" xref="S4.p4.4.m1.4.5.2.2"><csymbol cd="ambiguous" id="S4.p4.4.m1.4.5.2.2.1.cmml" xref="S4.p4.4.m1.4.5.2.2">subscript</csymbol><apply id="S4.p4.4.m1.4.5.2.2.2.cmml" xref="S4.p4.4.m1.4.5.2.2.2"><ci id="S4.p4.4.m1.4.5.2.2.2.1.cmml" xref="S4.p4.4.m1.4.5.2.2.2.1">^</ci><ci id="S4.p4.4.m1.4.5.2.2.2.2.cmml" xref="S4.p4.4.m1.4.5.2.2.2.2">𝑟</ci></apply><ci id="S4.p4.4.m1.4.5.2.2.3.cmml" xref="S4.p4.4.m1.4.5.2.2.3">𝜃</ci></apply><interval closure="open" id="S4.p4.4.m1.4.5.2.3.1.cmml" xref="S4.p4.4.m1.4.5.2.3.2"><ci id="S4.p4.4.m1.3.3.cmml" xref="S4.p4.4.m1.3.3">𝑥</ci><ci id="S4.p4.4.m1.4.4.cmml" xref="S4.p4.4.m1.4.4">𝑦</ci></interval></apply><apply id="S4.p4.4.m1.4.5.3.cmml" xref="S4.p4.4.m1.4.5.3"><times id="S4.p4.4.m1.4.5.3.1.cmml" xref="S4.p4.4.m1.4.5.3.1"></times><ci id="S4.p4.4.m1.4.5.3.2.cmml" xref="S4.p4.4.m1.4.5.3.2">𝛽</ci><apply id="S4.p4.4.m1.4.5.3.3.cmml" xref="S4.p4.4.m1.4.5.3.3"><log id="S4.p4.4.m1.4.5.3.3.1.cmml" xref="S4.p4.4.m1.4.5.3.3.1"></log><apply id="S4.p4.4.m1.2.2.cmml" xref="S4.p4.4.m1.2.2"><divide id="S4.p4.4.m1.2.2.3.cmml" xref="S4.p4.4.m1.2.2"></divide><apply id="S4.p4.4.m1.1.1.1.cmml" xref="S4.p4.4.m1.1.1.1"><times id="S4.p4.4.m1.1.1.1.2.cmml" xref="S4.p4.4.m1.1.1.1.2"></times><apply id="S4.p4.4.m1.1.1.1.3.cmml" xref="S4.p4.4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p4.4.m1.1.1.1.3.1.cmml" xref="S4.p4.4.m1.1.1.1.3">subscript</csymbol><ci id="S4.p4.4.m1.1.1.1.3.2.cmml" xref="S4.p4.4.m1.1.1.1.3.2">𝜋</ci><ci id="S4.p4.4.m1.1.1.1.3.3.cmml" xref="S4.p4.4.m1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.p4.4.m1.1.1.1.1.1.1.cmml" xref="S4.p4.4.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.p4.4.m1.1.1.1.1.1.1.1.cmml" xref="S4.p4.4.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.p4.4.m1.1.1.1.1.1.1.2.cmml" xref="S4.p4.4.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.p4.4.m1.1.1.1.1.1.1.3.cmml" xref="S4.p4.4.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S4.p4.4.m1.2.2.2.cmml" xref="S4.p4.4.m1.2.2.2"><times id="S4.p4.4.m1.2.2.2.2.cmml" xref="S4.p4.4.m1.2.2.2.2"></times><apply id="S4.p4.4.m1.2.2.2.3.cmml" xref="S4.p4.4.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.p4.4.m1.2.2.2.3.1.cmml" xref="S4.p4.4.m1.2.2.2.3">subscript</csymbol><ci id="S4.p4.4.m1.2.2.2.3.2.cmml" xref="S4.p4.4.m1.2.2.2.3.2">𝜋</ci><ci id="S4.p4.4.m1.2.2.2.3.3a.cmml" xref="S4.p4.4.m1.2.2.2.3.3"><mtext id="S4.p4.4.m1.2.2.2.3.3.cmml" mathsize="50%" xref="S4.p4.4.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="S4.p4.4.m1.2.2.2.1.1.1.cmml" xref="S4.p4.4.m1.2.2.2.1.1"><csymbol cd="latexml" id="S4.p4.4.m1.2.2.2.1.1.1.1.cmml" xref="S4.p4.4.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.p4.4.m1.2.2.2.1.1.1.2.cmml" xref="S4.p4.4.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="S4.p4.4.m1.2.2.2.1.1.1.3.cmml" xref="S4.p4.4.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m1.4c">\hat{r}_{\theta}(x,y)=\beta\log\frac{\pi_{\theta}(y\mid x)}{\pi_{\text{ref}}(y% \mid x)}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.4.m1.4d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG</annotation></semantics></math>는 언어 모델 <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S4.p4.5.m2.1"><semantics id="S4.p4.5.m2.1a"><msub id="S4.p4.5.m2.1.1" xref="S4.p4.5.m2.1.1.cmml"><mi id="S4.p4.5.m2.1.1.2" xref="S4.p4.5.m2.1.1.2.cmml">π</mi><mi id="S4.p4.5.m2.1.1.3" xref="S4.p4.5.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.5.m2.1b"><apply id="S4.p4.5.m2.1.1.cmml" xref="S4.p4.5.m2.1.1"><csymbol cd="ambiguous" id="S4.p4.5.m2.1.1.1.cmml" xref="S4.p4.5.m2.1.1">subscript</csymbol><ci id="S4.p4.5.m2.1.1.2.cmml" xref="S4.p4.5.m2.1.1.2">𝜋</ci><ci id="S4.p4.5.m2.1.1.3.cmml" xref="S4.p4.5.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.5.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> 및 참조 모델 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S4.p4.6.m3.1"><semantics id="S4.p4.6.m3.1a"><msub id="S4.p4.6.m3.1.1" xref="S4.p4.6.m3.1.1.cmml"><mi id="S4.p4.6.m3.1.1.2" xref="S4.p4.6.m3.1.1.2.cmml">π</mi><mtext id="S4.p4.6.m3.1.1.3" xref="S4.p4.6.m3.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p4.6.m3.1b"><apply id="S4.p4.6.m3.1.1.cmml" xref="S4.p4.6.m3.1.1"><csymbol cd="ambiguous" id="S4.p4.6.m3.1.1.1.cmml" xref="S4.p4.6.m3.1.1">subscript</csymbol><ci id="S4.p4.6.m3.1.1.2.cmml" xref="S4.p4.6.m3.1.1.2">𝜋</ci><ci id="S4.p4.6.m3.1.1.3a.cmml" xref="S4.p4.6.m3.1.1.3"><mtext id="S4.p4.6.m3.1.1.3.cmml" mathsize="70%" xref="S4.p4.6.m3.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m3.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.6.m3.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math>에 의해 암묵적으로 정의된 보상이다( Section <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S5" title="5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a>에서 더 많이). 직관적으로, 손실 함수 <math alttext="\mathcal{L}_{\text{DPO}}" class="ltx_Math" display="inline" id="S4.p4.7.m4.1"><semantics id="S4.p4.7.m4.1a"><msub id="S4.p4.7.m4.1.1" xref="S4.p4.7.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p4.7.m4.1.1.2" xref="S4.p4.7.m4.1.1.2.cmml">ℒ</mi><mtext id="S4.p4.7.m4.1.1.3" xref="S4.p4.7.m4.1.1.3a.cmml">DPO</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p4.7.m4.1b"><apply id="S4.p4.7.m4.1.1.cmml" xref="S4.p4.7.m4.1.1"><csymbol cd="ambiguous" id="S4.p4.7.m4.1.1.1.cmml" xref="S4.p4.7.m4.1.1">subscript</csymbol><ci id="S4.p4.7.m4.1.1.2.cmml" xref="S4.p4.7.m4.1.1.2">ℒ</ci><ci id="S4.p4.7.m4.1.1.3a.cmml" xref="S4.p4.7.m4.1.1.3"><mtext id="S4.p4.7.m4.1.1.3.cmml" mathsize="70%" xref="S4.p4.7.m4.1.1.3">DPO</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m4.1c">\mathcal{L}_{\text{DPO}}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.7.m4.1d">caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT</annotation></semantics></math>의 그래디언트는 선호되는 완성들 <math alttext="y_{w}" class="ltx_Math" display="inline" id="S4.p4.8.m5.1"><semantics id="S4.p4.8.m5.1a"><msub id="S4.p4.8.m5.1.1" xref="S4.p4.8.m5.1.1.cmml"><mi id="S4.p4.8.m5.1.1.2" xref="S4.p4.8.m5.1.1.2.cmml">y</mi><mi id="S4.p4.8.m5.1.1.3" xref="S4.p4.8.m5.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.8.m5.1b"><apply id="S4.p4.8.m5.1.1.cmml" xref="S4.p4.8.m5.1.1"><csymbol cd="ambiguous" id="S4.p4.8.m5.1.1.1.cmml" xref="S4.p4.8.m5.1.1">subscript</csymbol><ci id="S4.p4.8.m5.1.1.2.cmml" xref="S4.p4.8.m5.1.1.2">𝑦</ci><ci id="S4.p4.8.m5.1.1.3.cmml" xref="S4.p4.8.m5.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m5.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.8.m5.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math>의 우도를 증가시키고, 비선호되는 완성들 <math alttext="y_{l}" class="ltx_Math" display="inline" id="S4.p4.9.m6.1"><semantics id="S4.p4.9.m6.1a"><msub id="S4.p4.9.m6.1.1" xref="S4.p4.9.m6.1.1.cmml"><mi id="S4.p4.9.m6.1.1.2" xref="S4.p4.9.m6.1.1.2.cmml">y</mi><mi id="S4.p4.9.m6.1.1.3" xref="S4.p4.9.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.9.m6.1b"><apply id="S4.p4.9.m6.1.1.cmml" xref="S4.p4.9.m6.1.1"><csymbol cd="ambiguous" id="S4.p4.9.m6.1.1.1.cmml" xref="S4.p4.9.m6.1.1">subscript</csymbol><ci id="S4.p4.9.m6.1.1.2.cmml" xref="S4.p4.9.m6.1.1.2">𝑦</ci><ci id="S4.p4.9.m6.1.1.3.cmml" xref="S4.p4.9.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.9.m6.1c">y_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.9.m6.1d">italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>의 우도를 감소시킨다. 중요하게도, 예들은 암시적 보상 모델 <math alttext="\hat{r}_{\theta}" class="ltx_Math" display="inline" id="S4.p4.10.m7.1"><semantics id="S4.p4.10.m7.1a"><msub id="S4.p4.10.m7.1.1" xref="S4.p4.10.m7.1.1.cmml"><mover accent="true" id="S4.p4.10.m7.1.1.2" xref="S4.p4.10.m7.1.1.2.cmml"><mi id="S4.p4.10.m7.1.1.2.2" xref="S4.p4.10.m7.1.1.2.2.cmml">r</mi><mo id="S4.p4.10.m7.1.1.2.1" xref="S4.p4.10.m7.1.1.2.1.cmml">^</mo></mover><mi id="S4.p4.10.m7.1.1.3" xref="S4.p4.10.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.10.m7.1b"><apply id="S4.p4.10.m7.1.1.cmml" xref="S4.p4.10.m7.1.1"><csymbol cd="ambiguous" id="S4.p4.10.m7.1.1.1.cmml" xref="S4.p4.10.m7.1.1">subscript</csymbol><apply id="S4.p4.10.m7.1.1.2.cmml" xref="S4.p4.10.m7.1.1.2"><ci id="S4.p4.10.m7.1.1.2.1.cmml" xref="S4.p4.10.m7.1.1.2.1">^</ci><ci id="S4.p4.10.m7.1.1.2.2.cmml" xref="S4.p4.10.m7.1.1.2.2">𝑟</ci></apply><ci id="S4.p4.10.m7.1.1.3.cmml" xref="S4.p4.10.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.10.m7.1c">\hat{r}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.10.m7.1d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>가 얼마나 더 높은 비율로 불성실한 완성들을 평가하는지, <math alttext="\beta" class="ltx_Math" display="inline" id="S4.p4.11.m8.1"><semantics id="S4.p4.11.m8.1a"><mi id="S4.p4.11.m8.1.1" xref="S4.p4.11.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.p4.11.m8.1b"><ci id="S4.p4.11.m8.1.1.cmml" xref="S4.p4.11.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.11.m8.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.p4.11.m8.1d">italic_β</annotation></semantics></math>로 스케일링되는지, 즉 암시적 보상 모델이 KL 제약의 강도를 고려하여 얼마나 부정확하게 완성들을 주문하는지에 의해 칭량된다. 우리의 실험은 가중치 계수가 없는 이 방법의 순진한 버전으로서 언어 모델이 퇴보할 수 있기 때문에 이 가중치의 중요성을 제안한다(부록 표<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A3.T3" title="Table 3 ‣ C.3 Unlikelihood baseline ‣ Appendix C Further Details on the Experimental Set-Up ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<div class="ltx_para" id="S4.p5">
<p class="ltx_p" id="S4.p5.15"><span class="ltx_text ltx_font_bold" id="S4.p5.15.1">DPO outline. </span> 일반적인 DPO 파이프라인은 다음과 같다 : 1) 모든 프롬프트 <math alttext="x" class="ltx_Math" display="inline" id="S4.p5.2.m2.1"><semantics id="S4.p5.2.m2.1a"><mi id="S4.p5.2.m2.1.1" xref="S4.p5.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.p5.2.m2.1b"><ci id="S4.p5.2.m2.1.1.cmml" xref="S4.p5.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.p5.2.m2.1d">italic_x</annotation></semantics></math>에 대한 샘플 완성 <math alttext="y_{1},y_{2}\sim\pi_{\text{ref}}(\cdot\mid x)" class="ltx_math_unparsed" display="inline" id="S4.p5.1.m1.1"><semantics id="S4.p5.1.m1.1a"><mrow id="S4.p5.1.m1.1b"><msub id="S4.p5.1.m1.1.1"><mi id="S4.p5.1.m1.1.1.2">y</mi><mn id="S4.p5.1.m1.1.1.3">1</mn></msub><mo id="S4.p5.1.m1.1.2">,</mo><msub id="S4.p5.1.m1.1.3"><mi id="S4.p5.1.m1.1.3.2">y</mi><mn id="S4.p5.1.m1.1.3.3">2</mn></msub><mo id="S4.p5.1.m1.1.4">∼</mo><msub id="S4.p5.1.m1.1.5"><mi id="S4.p5.1.m1.1.5.2">π</mi><mtext id="S4.p5.1.m1.1.5.3">ref</mtext></msub><mrow id="S4.p5.1.m1.1.6"><mo id="S4.p5.1.m1.1.6.1" stretchy="false">(</mo><mo id="S4.p5.1.m1.1.6.2" lspace="0em" rspace="0em">⋅</mo><mo id="S4.p5.1.m1.1.6.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S4.p5.1.m1.1.6.4">x</mi><mo id="S4.p5.1.m1.1.6.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">y_{1},y_{2}\sim\pi_{\text{ref}}(\cdot\mid x)</annotation><annotation encoding="application/x-llamapun" id="S4.p5.1.m1.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∼ italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( ⋅ ∣ italic_x )</annotation></semantics></math>, 인간 선호도를 갖는 라벨을 구성하여 선호도 <math alttext="\mathcal{D}=\{x^{(i)},y_{w}^{(i)},y_{l})^{(i)}\}_{i=1}^{N}" class="ltx_math_unparsed" display="inline" id="S4.p5.3.m3.3"><semantics id="S4.p5.3.m3.3a"><mrow id="S4.p5.3.m3.3b"><mi class="ltx_font_mathcaligraphic" id="S4.p5.3.m3.3.4">𝒟</mi><mo id="S4.p5.3.m3.3.5">=</mo><msup id="S4.p5.3.m3.3.6"><mrow id="S4.p5.3.m3.3.6.2"><mo id="S4.p5.3.m3.3.6.2.1" stretchy="false">{</mo><msup id="S4.p5.3.m3.3.6.2.2"><mi id="S4.p5.3.m3.3.6.2.2.2">x</mi><mrow id="S4.p5.3.m3.1.1.1.3"><mo id="S4.p5.3.m3.1.1.1.3.1" stretchy="false">(</mo><mi id="S4.p5.3.m3.1.1.1.1">i</mi><mo id="S4.p5.3.m3.1.1.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="S4.p5.3.m3.3.6.2.3">,</mo><msubsup id="S4.p5.3.m3.3.6.2.4"><mi id="S4.p5.3.m3.3.6.2.4.2.2">y</mi><mi id="S4.p5.3.m3.3.6.2.4.2.3">w</mi><mrow id="S4.p5.3.m3.2.2.1.3"><mo id="S4.p5.3.m3.2.2.1.3.1" stretchy="false">(</mo><mi id="S4.p5.3.m3.2.2.1.1">i</mi><mo id="S4.p5.3.m3.2.2.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S4.p5.3.m3.3.6.2.5">,</mo><msub id="S4.p5.3.m3.3.6.2.6"><mi id="S4.p5.3.m3.3.6.2.6.2">y</mi><mi id="S4.p5.3.m3.3.6.2.6.3">l</mi></msub><mo id="S4.p5.3.m3.3.6.2.7" stretchy="false">)</mo></mrow><mrow id="S4.p5.3.m3.3.3.1.3"><mo id="S4.p5.3.m3.3.3.1.3.1" stretchy="false">(</mo><mi id="S4.p5.3.m3.3.3.1.1">i</mi><mo id="S4.p5.3.m3.3.3.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="S4.p5.3.m3.3.7" stretchy="false">}</mo><msub id="S4.p5.3.m3.3.8"><mi id="S4.p5.3.m3.3.8a"></mi><mrow id="S4.p5.3.m3.3.8.1"><mi id="S4.p5.3.m3.3.8.1.2">i</mi><mo id="S4.p5.3.m3.3.8.1.1">=</mo><mn id="S4.p5.3.m3.3.8.1.3">1</mn></mrow></msub><msup id="S4.p5.3.m3.3.9"><mi id="S4.p5.3.m3.3.9a"></mi><mi id="S4.p5.3.m3.3.9.1">N</mi></msup></mrow><annotation encoding="application/x-tex" id="S4.p5.3.m3.3c">\mathcal{D}=\{x^{(i)},y_{w}^{(i)},y_{l})^{(i)}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.3.m3.3d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>의 오프라인 데이터세트를 구성하고, 2) 주어진 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S4.p5.6.m6.1"><semantics id="S4.p5.6.m6.1a"><msub id="S4.p5.6.m6.1.1" xref="S4.p5.6.m6.1.1.cmml"><mi id="S4.p5.6.m6.1.1.2" xref="S4.p5.6.m6.1.1.2.cmml">π</mi><mtext id="S4.p5.6.m6.1.1.3" xref="S4.p5.6.m6.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p5.6.m6.1b"><apply id="S4.p5.6.m6.1.1.cmml" xref="S4.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p5.6.m6.1.1.1.cmml" xref="S4.p5.6.m6.1.1">subscript</csymbol><ci id="S4.p5.6.m6.1.1.2.cmml" xref="S4.p5.6.m6.1.1.2">𝜋</ci><ci id="S4.p5.6.m6.1.1.3a.cmml" xref="S4.p5.6.m6.1.1.3"><mtext id="S4.p5.6.m6.1.1.3.cmml" mathsize="70%" xref="S4.p5.6.m6.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.6.m6.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.6.m6.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> 및 <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.p5.7.m7.1"><semantics id="S4.p5.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p5.7.m7.1.1" xref="S4.p5.7.m7.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.p5.7.m7.1b"><ci id="S4.p5.7.m7.1.1.cmml" xref="S4.p5.7.m7.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.7.m7.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.7.m7.1d">caligraphic_D</annotation></semantics></math>에 대한 <math alttext="\mathcal{L}_{\text{DPO}}" class="ltx_Math" display="inline" id="S4.p5.5.m5.1"><semantics id="S4.p5.5.m5.1a"><msub id="S4.p5.5.m5.1.1" xref="S4.p5.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p5.5.m5.1.1.2" xref="S4.p5.5.m5.1.1.2.cmml">ℒ</mi><mtext id="S4.p5.5.m5.1.1.3" xref="S4.p5.5.m5.1.1.3a.cmml">DPO</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p5.5.m5.1b"><apply id="S4.p5.5.m5.1.1.cmml" xref="S4.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p5.5.m5.1.1.1.cmml" xref="S4.p5.5.m5.1.1">subscript</csymbol><ci id="S4.p5.5.m5.1.1.2.cmml" xref="S4.p5.5.m5.1.1.2">ℒ</ci><ci id="S4.p5.5.m5.1.1.3a.cmml" xref="S4.p5.5.m5.1.1.3"><mtext id="S4.p5.5.m5.1.1.3.cmml" mathsize="70%" xref="S4.p5.5.m5.1.1.3">DPO</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.5.m5.1c">\mathcal{L}_{\text{DPO}}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT</annotation></semantics></math> 및 원하는 <math alttext="\beta" class="ltx_Math" display="inline" id="S4.p5.8.m8.1"><semantics id="S4.p5.8.m8.1a"><mi id="S4.p5.8.m8.1.1" xref="S4.p5.8.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.p5.8.m8.1b"><ci id="S4.p5.8.m8.1.1.cmml" xref="S4.p5.8.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.8.m8.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.p5.8.m8.1d">italic_β</annotation></semantics></math>에 대해 언어 모델 <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S4.p5.4.m4.1"><semantics id="S4.p5.4.m4.1a"><msub id="S4.p5.4.m4.1.1" xref="S4.p5.4.m4.1.1.cmml"><mi id="S4.p5.4.m4.1.1.2" xref="S4.p5.4.m4.1.1.2.cmml">π</mi><mi id="S4.p5.4.m4.1.1.3" xref="S4.p5.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p5.4.m4.1b"><apply id="S4.p5.4.m4.1.1.cmml" xref="S4.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p5.4.m4.1.1.1.cmml" xref="S4.p5.4.m4.1.1">subscript</csymbol><ci id="S4.p5.4.m4.1.1.2.cmml" xref="S4.p5.4.m4.1.1.2">𝜋</ci><ci id="S4.p5.4.m4.1.1.3.cmml" xref="S4.p5.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.4.m4.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>를 최적화한다. 실제로는 샘플을 생성하고 인간의 선호도를 수집하는 대신 공개적으로 사용 가능한 선호도 데이터 세트를 재사용하고 싶다. 선호 데이터 세트는 <math alttext="\pi^{\text{SFT}}" class="ltx_Math" display="inline" id="S4.p5.9.m9.1"><semantics id="S4.p5.9.m9.1a"><msup id="S4.p5.9.m9.1.1" xref="S4.p5.9.m9.1.1.cmml"><mi id="S4.p5.9.m9.1.1.2" xref="S4.p5.9.m9.1.1.2.cmml">π</mi><mtext id="S4.p5.9.m9.1.1.3" xref="S4.p5.9.m9.1.1.3a.cmml">SFT</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.p5.9.m9.1b"><apply id="S4.p5.9.m9.1.1.cmml" xref="S4.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S4.p5.9.m9.1.1.1.cmml" xref="S4.p5.9.m9.1.1">superscript</csymbol><ci id="S4.p5.9.m9.1.1.2.cmml" xref="S4.p5.9.m9.1.1.2">𝜋</ci><ci id="S4.p5.9.m9.1.1.3a.cmml" xref="S4.p5.9.m9.1.1.3"><mtext id="S4.p5.9.m9.1.1.3.cmml" mathsize="70%" xref="S4.p5.9.m9.1.1.3">SFT</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.9.m9.1c">\pi^{\text{SFT}}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.9.m9.1d">italic_π start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT</annotation></semantics></math>를 사용하여 샘플링되므로, 사용할 수 있을 때마다 <math alttext="\pi_{\text{ref}}=\pi^{\text{SFT}}" class="ltx_Math" display="inline" id="S4.p5.10.m10.1"><semantics id="S4.p5.10.m10.1a"><mrow id="S4.p5.10.m10.1.1" xref="S4.p5.10.m10.1.1.cmml"><msub id="S4.p5.10.m10.1.1.2" xref="S4.p5.10.m10.1.1.2.cmml"><mi id="S4.p5.10.m10.1.1.2.2" xref="S4.p5.10.m10.1.1.2.2.cmml">π</mi><mtext id="S4.p5.10.m10.1.1.2.3" xref="S4.p5.10.m10.1.1.2.3a.cmml">ref</mtext></msub><mo id="S4.p5.10.m10.1.1.1" xref="S4.p5.10.m10.1.1.1.cmml">=</mo><msup id="S4.p5.10.m10.1.1.3" xref="S4.p5.10.m10.1.1.3.cmml"><mi id="S4.p5.10.m10.1.1.3.2" xref="S4.p5.10.m10.1.1.3.2.cmml">π</mi><mtext id="S4.p5.10.m10.1.1.3.3" xref="S4.p5.10.m10.1.1.3.3a.cmml">SFT</mtext></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.10.m10.1b"><apply id="S4.p5.10.m10.1.1.cmml" xref="S4.p5.10.m10.1.1"><eq id="S4.p5.10.m10.1.1.1.cmml" xref="S4.p5.10.m10.1.1.1"></eq><apply id="S4.p5.10.m10.1.1.2.cmml" xref="S4.p5.10.m10.1.1.2"><csymbol cd="ambiguous" id="S4.p5.10.m10.1.1.2.1.cmml" xref="S4.p5.10.m10.1.1.2">subscript</csymbol><ci id="S4.p5.10.m10.1.1.2.2.cmml" xref="S4.p5.10.m10.1.1.2.2">𝜋</ci><ci id="S4.p5.10.m10.1.1.2.3a.cmml" xref="S4.p5.10.m10.1.1.2.3"><mtext id="S4.p5.10.m10.1.1.2.3.cmml" mathsize="70%" xref="S4.p5.10.m10.1.1.2.3">ref</mtext></ci></apply><apply id="S4.p5.10.m10.1.1.3.cmml" xref="S4.p5.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.p5.10.m10.1.1.3.1.cmml" xref="S4.p5.10.m10.1.1.3">superscript</csymbol><ci id="S4.p5.10.m10.1.1.3.2.cmml" xref="S4.p5.10.m10.1.1.3.2">𝜋</ci><ci id="S4.p5.10.m10.1.1.3.3a.cmml" xref="S4.p5.10.m10.1.1.3.3"><mtext id="S4.p5.10.m10.1.1.3.3.cmml" mathsize="70%" xref="S4.p5.10.m10.1.1.3.3">SFT</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.10.m10.1c">\pi_{\text{ref}}=\pi^{\text{SFT}}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.10.m10.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT = italic_π start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT</annotation></semantics></math>를 초기화한다. 그러나, <math alttext="\pi^{\text{SFT}}" class="ltx_Math" display="inline" id="S4.p5.11.m11.1"><semantics id="S4.p5.11.m11.1a"><msup id="S4.p5.11.m11.1.1" xref="S4.p5.11.m11.1.1.cmml"><mi id="S4.p5.11.m11.1.1.2" xref="S4.p5.11.m11.1.1.2.cmml">π</mi><mtext id="S4.p5.11.m11.1.1.3" xref="S4.p5.11.m11.1.1.3a.cmml">SFT</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.p5.11.m11.1b"><apply id="S4.p5.11.m11.1.1.cmml" xref="S4.p5.11.m11.1.1"><csymbol cd="ambiguous" id="S4.p5.11.m11.1.1.1.cmml" xref="S4.p5.11.m11.1.1">superscript</csymbol><ci id="S4.p5.11.m11.1.1.2.cmml" xref="S4.p5.11.m11.1.1.2">𝜋</ci><ci id="S4.p5.11.m11.1.1.3a.cmml" xref="S4.p5.11.m11.1.1.3"><mtext id="S4.p5.11.m11.1.1.3.cmml" mathsize="70%" xref="S4.p5.11.m11.1.1.3">SFT</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.11.m11.1c">\pi^{\text{SFT}}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.11.m11.1d">italic_π start_POSTSUPERSCRIPT SFT end_POSTSUPERSCRIPT</annotation></semantics></math>를 이용할 수 없는 경우에는, 바람직한 완성도 <math alttext="{(x,y_{w})}" class="ltx_Math" display="inline" id="S4.p5.13.m13.2"><semantics id="S4.p5.13.m13.2a"><mrow id="S4.p5.13.m13.2.2.1" xref="S4.p5.13.m13.2.2.2.cmml"><mo id="S4.p5.13.m13.2.2.1.2" stretchy="false" xref="S4.p5.13.m13.2.2.2.cmml">(</mo><mi id="S4.p5.13.m13.1.1" xref="S4.p5.13.m13.1.1.cmml">x</mi><mo id="S4.p5.13.m13.2.2.1.3" xref="S4.p5.13.m13.2.2.2.cmml">,</mo><msub id="S4.p5.13.m13.2.2.1.1" xref="S4.p5.13.m13.2.2.1.1.cmml"><mi id="S4.p5.13.m13.2.2.1.1.2" xref="S4.p5.13.m13.2.2.1.1.2.cmml">y</mi><mi id="S4.p5.13.m13.2.2.1.1.3" xref="S4.p5.13.m13.2.2.1.1.3.cmml">w</mi></msub><mo id="S4.p5.13.m13.2.2.1.4" stretchy="false" xref="S4.p5.13.m13.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.13.m13.2b"><interval closure="open" id="S4.p5.13.m13.2.2.2.cmml" xref="S4.p5.13.m13.2.2.1"><ci id="S4.p5.13.m13.1.1.cmml" xref="S4.p5.13.m13.1.1">𝑥</ci><apply id="S4.p5.13.m13.2.2.1.1.cmml" xref="S4.p5.13.m13.2.2.1.1"><csymbol cd="ambiguous" id="S4.p5.13.m13.2.2.1.1.1.cmml" xref="S4.p5.13.m13.2.2.1.1">subscript</csymbol><ci id="S4.p5.13.m13.2.2.1.1.2.cmml" xref="S4.p5.13.m13.2.2.1.1.2">𝑦</ci><ci id="S4.p5.13.m13.2.2.1.1.3.cmml" xref="S4.p5.13.m13.2.2.1.1.3">𝑤</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.13.m13.2c">{(x,y_{w})}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.13.m13.2d">( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT )</annotation></semantics></math>, 즉 <math alttext="{\pi_{\text{ref}}=\operatorname*{arg\,max}_{\pi}\mathbb{E}_{x,y_{w}\sim% \mathcal{D}}\left[\log\pi(y_{w}\mid x)\right]}" class="ltx_Math" display="inline" id="S4.p5.14.m14.3"><semantics id="S4.p5.14.m14.3a"><mrow id="S4.p5.14.m14.3.3" xref="S4.p5.14.m14.3.3.cmml"><msub id="S4.p5.14.m14.3.3.3" xref="S4.p5.14.m14.3.3.3.cmml"><mi id="S4.p5.14.m14.3.3.3.2" xref="S4.p5.14.m14.3.3.3.2.cmml">π</mi><mtext id="S4.p5.14.m14.3.3.3.3" xref="S4.p5.14.m14.3.3.3.3a.cmml">ref</mtext></msub><mo id="S4.p5.14.m14.3.3.2" xref="S4.p5.14.m14.3.3.2.cmml">=</mo><mrow id="S4.p5.14.m14.3.3.1" xref="S4.p5.14.m14.3.3.1.cmml"><mrow id="S4.p5.14.m14.3.3.1.3" xref="S4.p5.14.m14.3.3.1.3.cmml"><msub id="S4.p5.14.m14.3.3.1.3.1" xref="S4.p5.14.m14.3.3.1.3.1.cmml"><mrow id="S4.p5.14.m14.3.3.1.3.1.2" xref="S4.p5.14.m14.3.3.1.3.1.2.cmml"><mi id="S4.p5.14.m14.3.3.1.3.1.2.2" xref="S4.p5.14.m14.3.3.1.3.1.2.2.cmml">arg</mi><mo id="S4.p5.14.m14.3.3.1.3.1.2.1" lspace="0.170em" xref="S4.p5.14.m14.3.3.1.3.1.2.1.cmml">⁢</mo><mi id="S4.p5.14.m14.3.3.1.3.1.2.3" xref="S4.p5.14.m14.3.3.1.3.1.2.3.cmml">max</mi></mrow><mi id="S4.p5.14.m14.3.3.1.3.1.3" xref="S4.p5.14.m14.3.3.1.3.1.3.cmml">π</mi></msub><mo id="S4.p5.14.m14.3.3.1.3a" xref="S4.p5.14.m14.3.3.1.3.cmml">⁡</mo><msub id="S4.p5.14.m14.3.3.1.3.2" xref="S4.p5.14.m14.3.3.1.3.2.cmml"><mi id="S4.p5.14.m14.3.3.1.3.2.2" xref="S4.p5.14.m14.3.3.1.3.2.2.cmml">𝔼</mi><mrow id="S4.p5.14.m14.2.2.2" xref="S4.p5.14.m14.2.2.2.cmml"><mrow id="S4.p5.14.m14.2.2.2.2.1" xref="S4.p5.14.m14.2.2.2.2.2.cmml"><mi id="S4.p5.14.m14.1.1.1.1" xref="S4.p5.14.m14.1.1.1.1.cmml">x</mi><mo id="S4.p5.14.m14.2.2.2.2.1.2" xref="S4.p5.14.m14.2.2.2.2.2.cmml">,</mo><msub id="S4.p5.14.m14.2.2.2.2.1.1" xref="S4.p5.14.m14.2.2.2.2.1.1.cmml"><mi id="S4.p5.14.m14.2.2.2.2.1.1.2" xref="S4.p5.14.m14.2.2.2.2.1.1.2.cmml">y</mi><mi id="S4.p5.14.m14.2.2.2.2.1.1.3" xref="S4.p5.14.m14.2.2.2.2.1.1.3.cmml">w</mi></msub></mrow><mo id="S4.p5.14.m14.2.2.2.3" xref="S4.p5.14.m14.2.2.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.p5.14.m14.2.2.2.4" xref="S4.p5.14.m14.2.2.2.4.cmml">𝒟</mi></mrow></msub></mrow><mo id="S4.p5.14.m14.3.3.1.2" xref="S4.p5.14.m14.3.3.1.2.cmml">⁢</mo><mrow id="S4.p5.14.m14.3.3.1.1.1" xref="S4.p5.14.m14.3.3.1.1.2.cmml"><mo id="S4.p5.14.m14.3.3.1.1.1.2" xref="S4.p5.14.m14.3.3.1.1.2.1.cmml">[</mo><mrow id="S4.p5.14.m14.3.3.1.1.1.1" xref="S4.p5.14.m14.3.3.1.1.1.1.cmml"><mrow id="S4.p5.14.m14.3.3.1.1.1.1.3" xref="S4.p5.14.m14.3.3.1.1.1.1.3.cmml"><mi id="S4.p5.14.m14.3.3.1.1.1.1.3.1" xref="S4.p5.14.m14.3.3.1.1.1.1.3.1.cmml">log</mi><mo id="S4.p5.14.m14.3.3.1.1.1.1.3a" lspace="0.167em" xref="S4.p5.14.m14.3.3.1.1.1.1.3.cmml">⁡</mo><mi id="S4.p5.14.m14.3.3.1.1.1.1.3.2" xref="S4.p5.14.m14.3.3.1.1.1.1.3.2.cmml">π</mi></mrow><mo id="S4.p5.14.m14.3.3.1.1.1.1.2" xref="S4.p5.14.m14.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.p5.14.m14.3.3.1.1.1.1.1.1" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.cmml"><mo id="S4.p5.14.m14.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.cmml"><msub id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.2" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.3" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.3.cmml">w</mi></msub><mo id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.1" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.3" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.p5.14.m14.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p5.14.m14.3.3.1.1.1.3" xref="S4.p5.14.m14.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.14.m14.3b"><apply id="S4.p5.14.m14.3.3.cmml" xref="S4.p5.14.m14.3.3"><eq id="S4.p5.14.m14.3.3.2.cmml" xref="S4.p5.14.m14.3.3.2"></eq><apply id="S4.p5.14.m14.3.3.3.cmml" xref="S4.p5.14.m14.3.3.3"><csymbol cd="ambiguous" id="S4.p5.14.m14.3.3.3.1.cmml" xref="S4.p5.14.m14.3.3.3">subscript</csymbol><ci id="S4.p5.14.m14.3.3.3.2.cmml" xref="S4.p5.14.m14.3.3.3.2">𝜋</ci><ci id="S4.p5.14.m14.3.3.3.3a.cmml" xref="S4.p5.14.m14.3.3.3.3"><mtext id="S4.p5.14.m14.3.3.3.3.cmml" mathsize="70%" xref="S4.p5.14.m14.3.3.3.3">ref</mtext></ci></apply><apply id="S4.p5.14.m14.3.3.1.cmml" xref="S4.p5.14.m14.3.3.1"><times id="S4.p5.14.m14.3.3.1.2.cmml" xref="S4.p5.14.m14.3.3.1.2"></times><apply id="S4.p5.14.m14.3.3.1.3.cmml" xref="S4.p5.14.m14.3.3.1.3"><apply id="S4.p5.14.m14.3.3.1.3.1.cmml" xref="S4.p5.14.m14.3.3.1.3.1"><csymbol cd="ambiguous" id="S4.p5.14.m14.3.3.1.3.1.1.cmml" xref="S4.p5.14.m14.3.3.1.3.1">subscript</csymbol><apply id="S4.p5.14.m14.3.3.1.3.1.2.cmml" xref="S4.p5.14.m14.3.3.1.3.1.2"><times id="S4.p5.14.m14.3.3.1.3.1.2.1.cmml" xref="S4.p5.14.m14.3.3.1.3.1.2.1"></times><ci id="S4.p5.14.m14.3.3.1.3.1.2.2.cmml" xref="S4.p5.14.m14.3.3.1.3.1.2.2">arg</ci><ci id="S4.p5.14.m14.3.3.1.3.1.2.3.cmml" xref="S4.p5.14.m14.3.3.1.3.1.2.3">max</ci></apply><ci id="S4.p5.14.m14.3.3.1.3.1.3.cmml" xref="S4.p5.14.m14.3.3.1.3.1.3">𝜋</ci></apply><apply id="S4.p5.14.m14.3.3.1.3.2.cmml" xref="S4.p5.14.m14.3.3.1.3.2"><csymbol cd="ambiguous" id="S4.p5.14.m14.3.3.1.3.2.1.cmml" xref="S4.p5.14.m14.3.3.1.3.2">subscript</csymbol><ci id="S4.p5.14.m14.3.3.1.3.2.2.cmml" xref="S4.p5.14.m14.3.3.1.3.2.2">𝔼</ci><apply id="S4.p5.14.m14.2.2.2.cmml" xref="S4.p5.14.m14.2.2.2"><csymbol cd="latexml" id="S4.p5.14.m14.2.2.2.3.cmml" xref="S4.p5.14.m14.2.2.2.3">similar-to</csymbol><list id="S4.p5.14.m14.2.2.2.2.2.cmml" xref="S4.p5.14.m14.2.2.2.2.1"><ci id="S4.p5.14.m14.1.1.1.1.cmml" xref="S4.p5.14.m14.1.1.1.1">𝑥</ci><apply id="S4.p5.14.m14.2.2.2.2.1.1.cmml" xref="S4.p5.14.m14.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.p5.14.m14.2.2.2.2.1.1.1.cmml" xref="S4.p5.14.m14.2.2.2.2.1.1">subscript</csymbol><ci id="S4.p5.14.m14.2.2.2.2.1.1.2.cmml" xref="S4.p5.14.m14.2.2.2.2.1.1.2">𝑦</ci><ci id="S4.p5.14.m14.2.2.2.2.1.1.3.cmml" xref="S4.p5.14.m14.2.2.2.2.1.1.3">𝑤</ci></apply></list><ci id="S4.p5.14.m14.2.2.2.4.cmml" xref="S4.p5.14.m14.2.2.2.4">𝒟</ci></apply></apply></apply><apply id="S4.p5.14.m14.3.3.1.1.2.cmml" xref="S4.p5.14.m14.3.3.1.1.1"><csymbol cd="latexml" id="S4.p5.14.m14.3.3.1.1.2.1.cmml" xref="S4.p5.14.m14.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S4.p5.14.m14.3.3.1.1.1.1.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1"><times id="S4.p5.14.m14.3.3.1.1.1.1.2.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.2"></times><apply id="S4.p5.14.m14.3.3.1.1.1.1.3.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.3"><log id="S4.p5.14.m14.3.3.1.1.1.1.3.1.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.3.1"></log><ci id="S4.p5.14.m14.3.3.1.1.1.1.3.2.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.3.2">𝜋</ci></apply><apply id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.2.3">𝑤</ci></apply><ci id="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.p5.14.m14.3.3.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.14.m14.3c">{\pi_{\text{ref}}=\operatorname*{arg\,max}_{\pi}\mathbb{E}_{x,y_{w}\sim% \mathcal{D}}\left[\log\pi(y_{w}\mid x)\right]}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.14.m14.3d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∼ caligraphic_D end_POSTSUBSCRIPT [ roman_log italic_π ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∣ italic_x ) ]</annotation></semantics></math>의 우도를 최대화하여 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S4.p5.12.m12.1"><semantics id="S4.p5.12.m12.1a"><msub id="S4.p5.12.m12.1.1" xref="S4.p5.12.m12.1.1.cmml"><mi id="S4.p5.12.m12.1.1.2" xref="S4.p5.12.m12.1.1.2.cmml">π</mi><mtext id="S4.p5.12.m12.1.1.3" xref="S4.p5.12.m12.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p5.12.m12.1b"><apply id="S4.p5.12.m12.1.1.cmml" xref="S4.p5.12.m12.1.1"><csymbol cd="ambiguous" id="S4.p5.12.m12.1.1.1.cmml" xref="S4.p5.12.m12.1.1">subscript</csymbol><ci id="S4.p5.12.m12.1.1.2.cmml" xref="S4.p5.12.m12.1.1.2">𝜋</ci><ci id="S4.p5.12.m12.1.1.3a.cmml" xref="S4.p5.12.m12.1.1.3"><mtext id="S4.p5.12.m12.1.1.3.cmml" mathsize="70%" xref="S4.p5.12.m12.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.12.m12.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.12.m12.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math>를 초기화한다. 이 절차는 사용할 수 없는 실제 참조 분포와 DPO에서 사용하는 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S4.p5.15.m15.1"><semantics id="S4.p5.15.m15.1a"><msub id="S4.p5.15.m15.1.1" xref="S4.p5.15.m15.1.1.cmml"><mi id="S4.p5.15.m15.1.1.2" xref="S4.p5.15.m15.1.1.2.cmml">π</mi><mtext id="S4.p5.15.m15.1.1.3" xref="S4.p5.15.m15.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p5.15.m15.1b"><apply id="S4.p5.15.m15.1.1.cmml" xref="S4.p5.15.m15.1.1"><csymbol cd="ambiguous" id="S4.p5.15.m15.1.1.1.cmml" xref="S4.p5.15.m15.1.1">subscript</csymbol><ci id="S4.p5.15.m15.1.1.2.cmml" xref="S4.p5.15.m15.1.1.2">𝜋</ci><ci id="S4.p5.15.m15.1.1.3a.cmml" xref="S4.p5.15.m15.1.1.3"><mtext id="S4.p5.15.m15.1.1.3.cmml" mathsize="70%" xref="S4.p5.15.m15.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.15.m15.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.15.m15.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> 사이의 분포 이동을 완화하는 데 도움이 됩니다. 구현 및 하이퍼파라미터와 관련된 자세한 내용은 부록<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A2" title="Appendix B DPO Implementation Details and Hyperparameters ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">B</span></a>에서 확인할 수 있다.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Theoretical Analysis of DPO</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">이 섹션에서는 DPO 방법에 대한 추가 해석을 제공하고 이론적 뒷받침을 제공하며 DPO의 이점을 RLHF에 사용되는 행위자 비판 알고리즘(예: PPO <cite class="ltx_cite ltx_citemacro_cite">Schulman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib37" title="">2017</a>)</cite>)의 문제와 연관시킨다.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Your Language Model Is Secretly a Reward Model</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.2">DPO는 명시적 보상을 피팅하는 것과 단일 최대 가능성 목표를 사용하여 정책을 학습하기 위해 RL을 수행하는 것 모두를 우회할 수 있다. 최적화 목표 식에 유의하십시오. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E5" title="5 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a>는 보상 파라미터화 <math alttext="r^{*}(x,y)=\beta\log\frac{\pi^{*}_{\theta}(y\mid x)}{\pi_{\text{ref}}(y\mid x)}" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.4"><semantics id="S5.SS1.p1.1.m1.4a"><mrow id="S5.SS1.p1.1.m1.4.5" xref="S5.SS1.p1.1.m1.4.5.cmml"><mrow id="S5.SS1.p1.1.m1.4.5.2" xref="S5.SS1.p1.1.m1.4.5.2.cmml"><msup id="S5.SS1.p1.1.m1.4.5.2.2" xref="S5.SS1.p1.1.m1.4.5.2.2.cmml"><mi id="S5.SS1.p1.1.m1.4.5.2.2.2" xref="S5.SS1.p1.1.m1.4.5.2.2.2.cmml">r</mi><mo id="S5.SS1.p1.1.m1.4.5.2.2.3" xref="S5.SS1.p1.1.m1.4.5.2.2.3.cmml">*</mo></msup><mo id="S5.SS1.p1.1.m1.4.5.2.1" xref="S5.SS1.p1.1.m1.4.5.2.1.cmml">⁢</mo><mrow id="S5.SS1.p1.1.m1.4.5.2.3.2" xref="S5.SS1.p1.1.m1.4.5.2.3.1.cmml"><mo id="S5.SS1.p1.1.m1.4.5.2.3.2.1" stretchy="false" xref="S5.SS1.p1.1.m1.4.5.2.3.1.cmml">(</mo><mi id="S5.SS1.p1.1.m1.3.3" xref="S5.SS1.p1.1.m1.3.3.cmml">x</mi><mo id="S5.SS1.p1.1.m1.4.5.2.3.2.2" xref="S5.SS1.p1.1.m1.4.5.2.3.1.cmml">,</mo><mi id="S5.SS1.p1.1.m1.4.4" xref="S5.SS1.p1.1.m1.4.4.cmml">y</mi><mo id="S5.SS1.p1.1.m1.4.5.2.3.2.3" stretchy="false" xref="S5.SS1.p1.1.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.SS1.p1.1.m1.4.5.1" xref="S5.SS1.p1.1.m1.4.5.1.cmml">=</mo><mrow id="S5.SS1.p1.1.m1.4.5.3" xref="S5.SS1.p1.1.m1.4.5.3.cmml"><mi id="S5.SS1.p1.1.m1.4.5.3.2" xref="S5.SS1.p1.1.m1.4.5.3.2.cmml">β</mi><mo id="S5.SS1.p1.1.m1.4.5.3.1" lspace="0.167em" xref="S5.SS1.p1.1.m1.4.5.3.1.cmml">⁢</mo><mrow id="S5.SS1.p1.1.m1.4.5.3.3" xref="S5.SS1.p1.1.m1.4.5.3.3.cmml"><mi id="S5.SS1.p1.1.m1.4.5.3.3.1" xref="S5.SS1.p1.1.m1.4.5.3.3.1.cmml">log</mi><mo id="S5.SS1.p1.1.m1.4.5.3.3a" lspace="0.167em" xref="S5.SS1.p1.1.m1.4.5.3.3.cmml">⁡</mo><mfrac id="S5.SS1.p1.1.m1.2.2" xref="S5.SS1.p1.1.m1.2.2.cmml"><mrow id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml"><msubsup id="S5.SS1.p1.1.m1.1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.1.3.cmml"><mi id="S5.SS1.p1.1.m1.1.1.1.3.2.2" xref="S5.SS1.p1.1.m1.1.1.1.3.2.2.cmml">π</mi><mi id="S5.SS1.p1.1.m1.1.1.1.3.3" xref="S5.SS1.p1.1.m1.1.1.1.3.3.cmml">θ</mi><mo id="S5.SS1.p1.1.m1.1.1.1.3.2.3" xref="S5.SS1.p1.1.m1.1.1.1.3.2.3.cmml">*</mo></msubsup><mo id="S5.SS1.p1.1.m1.1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS1.p1.1.m1.1.1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.cmml"><mo id="S5.SS1.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.p1.1.m1.1.1.1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.1.1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S5.SS1.p1.1.m1.1.1.1.1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.SS1.p1.1.m1.1.1.1.1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.SS1.p1.1.m1.2.2.2" xref="S5.SS1.p1.1.m1.2.2.2.cmml"><msub id="S5.SS1.p1.1.m1.2.2.2.3" xref="S5.SS1.p1.1.m1.2.2.2.3.cmml"><mi id="S5.SS1.p1.1.m1.2.2.2.3.2" xref="S5.SS1.p1.1.m1.2.2.2.3.2.cmml">π</mi><mtext id="S5.SS1.p1.1.m1.2.2.2.3.3" xref="S5.SS1.p1.1.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="S5.SS1.p1.1.m1.2.2.2.2" xref="S5.SS1.p1.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS1.p1.1.m1.2.2.2.1.1" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.cmml"><mo id="S5.SS1.p1.1.m1.2.2.2.1.1.2" stretchy="false" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S5.SS1.p1.1.m1.2.2.2.1.1.1" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.2.2.2.1.1.1.2" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.2.cmml">y</mi><mo id="S5.SS1.p1.1.m1.2.2.2.1.1.1.1" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.1.cmml">∣</mo><mi id="S5.SS1.p1.1.m1.2.2.2.1.1.1.3" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS1.p1.1.m1.2.2.2.1.1.3" stretchy="false" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.4b"><apply id="S5.SS1.p1.1.m1.4.5.cmml" xref="S5.SS1.p1.1.m1.4.5"><eq id="S5.SS1.p1.1.m1.4.5.1.cmml" xref="S5.SS1.p1.1.m1.4.5.1"></eq><apply id="S5.SS1.p1.1.m1.4.5.2.cmml" xref="S5.SS1.p1.1.m1.4.5.2"><times id="S5.SS1.p1.1.m1.4.5.2.1.cmml" xref="S5.SS1.p1.1.m1.4.5.2.1"></times><apply id="S5.SS1.p1.1.m1.4.5.2.2.cmml" xref="S5.SS1.p1.1.m1.4.5.2.2"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.4.5.2.2.1.cmml" xref="S5.SS1.p1.1.m1.4.5.2.2">superscript</csymbol><ci id="S5.SS1.p1.1.m1.4.5.2.2.2.cmml" xref="S5.SS1.p1.1.m1.4.5.2.2.2">𝑟</ci><times id="S5.SS1.p1.1.m1.4.5.2.2.3.cmml" xref="S5.SS1.p1.1.m1.4.5.2.2.3"></times></apply><interval closure="open" id="S5.SS1.p1.1.m1.4.5.2.3.1.cmml" xref="S5.SS1.p1.1.m1.4.5.2.3.2"><ci id="S5.SS1.p1.1.m1.3.3.cmml" xref="S5.SS1.p1.1.m1.3.3">𝑥</ci><ci id="S5.SS1.p1.1.m1.4.4.cmml" xref="S5.SS1.p1.1.m1.4.4">𝑦</ci></interval></apply><apply id="S5.SS1.p1.1.m1.4.5.3.cmml" xref="S5.SS1.p1.1.m1.4.5.3"><times id="S5.SS1.p1.1.m1.4.5.3.1.cmml" xref="S5.SS1.p1.1.m1.4.5.3.1"></times><ci id="S5.SS1.p1.1.m1.4.5.3.2.cmml" xref="S5.SS1.p1.1.m1.4.5.3.2">𝛽</ci><apply id="S5.SS1.p1.1.m1.4.5.3.3.cmml" xref="S5.SS1.p1.1.m1.4.5.3.3"><log id="S5.SS1.p1.1.m1.4.5.3.3.1.cmml" xref="S5.SS1.p1.1.m1.4.5.3.3.1"></log><apply id="S5.SS1.p1.1.m1.2.2.cmml" xref="S5.SS1.p1.1.m1.2.2"><divide id="S5.SS1.p1.1.m1.2.2.3.cmml" xref="S5.SS1.p1.1.m1.2.2"></divide><apply id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"><times id="S5.SS1.p1.1.m1.1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.1.2"></times><apply id="S5.SS1.p1.1.m1.1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.1.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1.3">subscript</csymbol><apply id="S5.SS1.p1.1.m1.1.1.1.3.2.cmml" xref="S5.SS1.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.1.3.2.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1.3">superscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.1.3.2.2.cmml" xref="S5.SS1.p1.1.m1.1.1.1.3.2.2">𝜋</ci><times id="S5.SS1.p1.1.m1.1.1.1.3.2.3.cmml" xref="S5.SS1.p1.1.m1.1.1.1.3.2.3"></times></apply><ci id="S5.SS1.p1.1.m1.1.1.1.3.3.cmml" xref="S5.SS1.p1.1.m1.1.1.1.3.3">𝜃</ci></apply><apply id="S5.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S5.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S5.SS1.p1.1.m1.2.2.2.cmml" xref="S5.SS1.p1.1.m1.2.2.2"><times id="S5.SS1.p1.1.m1.2.2.2.2.cmml" xref="S5.SS1.p1.1.m1.2.2.2.2"></times><apply id="S5.SS1.p1.1.m1.2.2.2.3.cmml" xref="S5.SS1.p1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.2.2.2.3.1.cmml" xref="S5.SS1.p1.1.m1.2.2.2.3">subscript</csymbol><ci id="S5.SS1.p1.1.m1.2.2.2.3.2.cmml" xref="S5.SS1.p1.1.m1.2.2.2.3.2">𝜋</ci><ci id="S5.SS1.p1.1.m1.2.2.2.3.3a.cmml" xref="S5.SS1.p1.1.m1.2.2.2.3.3"><mtext id="S5.SS1.p1.1.m1.2.2.2.3.3.cmml" mathsize="50%" xref="S5.SS1.p1.1.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="S5.SS1.p1.1.m1.2.2.2.1.1.1.cmml" xref="S5.SS1.p1.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="S5.SS1.p1.1.m1.2.2.2.1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S5.SS1.p1.1.m1.2.2.2.1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="S5.SS1.p1.1.m1.2.2.2.1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.4c">r^{*}(x,y)=\beta\log\frac{\pi^{*}_{\theta}(y\mid x)}{\pi_{\text{ref}}(y\mid x)}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.4d">italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG</annotation></semantics></math>를 갖는 Bradley-Terry 모델과 동등하며, Eq에서의 보상 모델 최적화와 동등하게 우리의 파라메트릭 모델 <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><msub id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">π</mi><mi id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">𝜋</ci><ci id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>를 최적화한다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3.E2" title="2 ‣ 3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">2</span></a> 변수의 변화 하에서. 이 섹션에서는 이러한 재매개 변수화 이면의 이론을 구축하고 학습된 보상 모델의 클래스를 제한하지 않으며 최적의 정책을 정확하게 복구할 수 있음을 보여준다. 우리는 보상 함수들 사이의 동등성 관계를 정의하는 것으로 시작한다.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition1.1.1.1">Definition 1</span></span><span class="ltx_text ltx_font_bold" id="Thmdefinition1.2.2">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="Thmdefinition1.p1">
<p class="ltx_p" id="Thmdefinition1.p1.4"><span class="ltx_text ltx_font_italic" id="Thmdefinition1.p1.4.4">We say that two reward functions <math alttext="r(x,y)" class="ltx_Math" display="inline" id="Thmdefinition1.p1.1.1.m1.2"><semantics id="Thmdefinition1.p1.1.1.m1.2a"><mrow id="Thmdefinition1.p1.1.1.m1.2.3" xref="Thmdefinition1.p1.1.1.m1.2.3.cmml"><mi id="Thmdefinition1.p1.1.1.m1.2.3.2" xref="Thmdefinition1.p1.1.1.m1.2.3.2.cmml">r</mi><mo id="Thmdefinition1.p1.1.1.m1.2.3.1" mathvariant="italic" xref="Thmdefinition1.p1.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.1.1.m1.2.3.3.2" xref="Thmdefinition1.p1.1.1.m1.2.3.3.1.cmml"><mo id="Thmdefinition1.p1.1.1.m1.2.3.3.2.1" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.1.1.m1.2.3.3.1.cmml">(</mo><mi id="Thmdefinition1.p1.1.1.m1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.cmml">x</mi><mo id="Thmdefinition1.p1.1.1.m1.2.3.3.2.2" mathvariant="normal" xref="Thmdefinition1.p1.1.1.m1.2.3.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.1.1.m1.2.2" xref="Thmdefinition1.p1.1.1.m1.2.2.cmml">y</mi><mo id="Thmdefinition1.p1.1.1.m1.2.3.3.2.3" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.1.1.m1.2b"><apply id="Thmdefinition1.p1.1.1.m1.2.3.cmml" xref="Thmdefinition1.p1.1.1.m1.2.3"><times id="Thmdefinition1.p1.1.1.m1.2.3.1.cmml" xref="Thmdefinition1.p1.1.1.m1.2.3.1"></times><ci id="Thmdefinition1.p1.1.1.m1.2.3.2.cmml" xref="Thmdefinition1.p1.1.1.m1.2.3.2">𝑟</ci><interval closure="open" id="Thmdefinition1.p1.1.1.m1.2.3.3.1.cmml" xref="Thmdefinition1.p1.1.1.m1.2.3.3.2"><ci id="Thmdefinition1.p1.1.1.m1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1">𝑥</ci><ci id="Thmdefinition1.p1.1.1.m1.2.2.cmml" xref="Thmdefinition1.p1.1.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.1.1.m1.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.1.1.m1.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math> and <math alttext="r^{\prime}(x,y)" class="ltx_Math" display="inline" id="Thmdefinition1.p1.2.2.m2.2"><semantics id="Thmdefinition1.p1.2.2.m2.2a"><mrow id="Thmdefinition1.p1.2.2.m2.2.3" xref="Thmdefinition1.p1.2.2.m2.2.3.cmml"><msup id="Thmdefinition1.p1.2.2.m2.2.3.2" xref="Thmdefinition1.p1.2.2.m2.2.3.2.cmml"><mi id="Thmdefinition1.p1.2.2.m2.2.3.2.2" xref="Thmdefinition1.p1.2.2.m2.2.3.2.2.cmml">r</mi><mo id="Thmdefinition1.p1.2.2.m2.2.3.2.3" mathvariant="normal" xref="Thmdefinition1.p1.2.2.m2.2.3.2.3.cmml">′</mo></msup><mo id="Thmdefinition1.p1.2.2.m2.2.3.1" mathvariant="italic" xref="Thmdefinition1.p1.2.2.m2.2.3.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.2.2.m2.2.3.3.2" xref="Thmdefinition1.p1.2.2.m2.2.3.3.1.cmml"><mo id="Thmdefinition1.p1.2.2.m2.2.3.3.2.1" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.2.2.m2.2.3.3.1.cmml">(</mo><mi id="Thmdefinition1.p1.2.2.m2.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.cmml">x</mi><mo id="Thmdefinition1.p1.2.2.m2.2.3.3.2.2" mathvariant="normal" xref="Thmdefinition1.p1.2.2.m2.2.3.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.2.2.m2.2.2" xref="Thmdefinition1.p1.2.2.m2.2.2.cmml">y</mi><mo id="Thmdefinition1.p1.2.2.m2.2.3.3.2.3" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.2.2.m2.2b"><apply id="Thmdefinition1.p1.2.2.m2.2.3.cmml" xref="Thmdefinition1.p1.2.2.m2.2.3"><times id="Thmdefinition1.p1.2.2.m2.2.3.1.cmml" xref="Thmdefinition1.p1.2.2.m2.2.3.1"></times><apply id="Thmdefinition1.p1.2.2.m2.2.3.2.cmml" xref="Thmdefinition1.p1.2.2.m2.2.3.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.2.2.m2.2.3.2.1.cmml" xref="Thmdefinition1.p1.2.2.m2.2.3.2">superscript</csymbol><ci id="Thmdefinition1.p1.2.2.m2.2.3.2.2.cmml" xref="Thmdefinition1.p1.2.2.m2.2.3.2.2">𝑟</ci><ci id="Thmdefinition1.p1.2.2.m2.2.3.2.3.cmml" xref="Thmdefinition1.p1.2.2.m2.2.3.2.3">normal-′</ci></apply><interval closure="open" id="Thmdefinition1.p1.2.2.m2.2.3.3.1.cmml" xref="Thmdefinition1.p1.2.2.m2.2.3.3.2"><ci id="Thmdefinition1.p1.2.2.m2.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1">𝑥</ci><ci id="Thmdefinition1.p1.2.2.m2.2.2.cmml" xref="Thmdefinition1.p1.2.2.m2.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.2.2.m2.2c">r^{\prime}(x,y)</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.2.2.m2.2d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y )</annotation></semantics></math> are equivalent iff <math alttext="{r(x,y)-r^{\prime}(x,y)=f(x)}" class="ltx_Math" display="inline" id="Thmdefinition1.p1.3.3.m3.5"><semantics id="Thmdefinition1.p1.3.3.m3.5a"><mrow id="Thmdefinition1.p1.3.3.m3.5.6" xref="Thmdefinition1.p1.3.3.m3.5.6.cmml"><mrow id="Thmdefinition1.p1.3.3.m3.5.6.2" xref="Thmdefinition1.p1.3.3.m3.5.6.2.cmml"><mrow id="Thmdefinition1.p1.3.3.m3.5.6.2.2" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.cmml"><mi id="Thmdefinition1.p1.3.3.m3.5.6.2.2.2" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.2.cmml">r</mi><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.2.1" mathvariant="italic" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.2" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.1.cmml"><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.2.1" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.1.cmml">(</mo><mi id="Thmdefinition1.p1.3.3.m3.1.1" xref="Thmdefinition1.p1.3.3.m3.1.1.cmml">x</mi><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.2.2" mathvariant="normal" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.3.3.m3.2.2" xref="Thmdefinition1.p1.3.3.m3.2.2.cmml">y</mi><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.2.3" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.1" mathvariant="normal" xref="Thmdefinition1.p1.3.3.m3.5.6.2.1.cmml">−</mo><mrow id="Thmdefinition1.p1.3.3.m3.5.6.2.3" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.cmml"><msup id="Thmdefinition1.p1.3.3.m3.5.6.2.3.2" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.cmml"><mi id="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.2" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.2.cmml">r</mi><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.3" mathvariant="normal" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.3.cmml">′</mo></msup><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.3.1" mathvariant="italic" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.2" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.1.cmml"><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.2.1" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.1.cmml">(</mo><mi id="Thmdefinition1.p1.3.3.m3.3.3" xref="Thmdefinition1.p1.3.3.m3.3.3.cmml">x</mi><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.2.2" mathvariant="normal" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.3.3.m3.4.4" xref="Thmdefinition1.p1.3.3.m3.4.4.cmml">y</mi><mo id="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.2.3" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="Thmdefinition1.p1.3.3.m3.5.6.1" mathvariant="normal" xref="Thmdefinition1.p1.3.3.m3.5.6.1.cmml">=</mo><mrow id="Thmdefinition1.p1.3.3.m3.5.6.3" xref="Thmdefinition1.p1.3.3.m3.5.6.3.cmml"><mi id="Thmdefinition1.p1.3.3.m3.5.6.3.2" xref="Thmdefinition1.p1.3.3.m3.5.6.3.2.cmml">f</mi><mo id="Thmdefinition1.p1.3.3.m3.5.6.3.1" mathvariant="italic" xref="Thmdefinition1.p1.3.3.m3.5.6.3.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.3.3.m3.5.6.3.3.2" xref="Thmdefinition1.p1.3.3.m3.5.6.3.cmml"><mo id="Thmdefinition1.p1.3.3.m3.5.6.3.3.2.1" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.5.6.3.cmml">(</mo><mi id="Thmdefinition1.p1.3.3.m3.5.5" xref="Thmdefinition1.p1.3.3.m3.5.5.cmml">x</mi><mo id="Thmdefinition1.p1.3.3.m3.5.6.3.3.2.2" mathvariant="normal" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.5.6.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.3.3.m3.5b"><apply id="Thmdefinition1.p1.3.3.m3.5.6.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6"><eq id="Thmdefinition1.p1.3.3.m3.5.6.1.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.1"></eq><apply id="Thmdefinition1.p1.3.3.m3.5.6.2.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2"><minus id="Thmdefinition1.p1.3.3.m3.5.6.2.1.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.1"></minus><apply id="Thmdefinition1.p1.3.3.m3.5.6.2.2.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2"><times id="Thmdefinition1.p1.3.3.m3.5.6.2.2.1.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.1"></times><ci id="Thmdefinition1.p1.3.3.m3.5.6.2.2.2.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.2">𝑟</ci><interval closure="open" id="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.1.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.2.3.2"><ci id="Thmdefinition1.p1.3.3.m3.1.1.cmml" xref="Thmdefinition1.p1.3.3.m3.1.1">𝑥</ci><ci id="Thmdefinition1.p1.3.3.m3.2.2.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2">𝑦</ci></interval></apply><apply id="Thmdefinition1.p1.3.3.m3.5.6.2.3.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3"><times id="Thmdefinition1.p1.3.3.m3.5.6.2.3.1.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.1"></times><apply id="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.1.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.2">superscript</csymbol><ci id="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.2.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.2">𝑟</ci><ci id="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.3.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.2.3">normal-′</ci></apply><interval closure="open" id="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.1.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.2.3.3.2"><ci id="Thmdefinition1.p1.3.3.m3.3.3.cmml" xref="Thmdefinition1.p1.3.3.m3.3.3">𝑥</ci><ci id="Thmdefinition1.p1.3.3.m3.4.4.cmml" xref="Thmdefinition1.p1.3.3.m3.4.4">𝑦</ci></interval></apply></apply><apply id="Thmdefinition1.p1.3.3.m3.5.6.3.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.3"><times id="Thmdefinition1.p1.3.3.m3.5.6.3.1.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.3.1"></times><ci id="Thmdefinition1.p1.3.3.m3.5.6.3.2.cmml" xref="Thmdefinition1.p1.3.3.m3.5.6.3.2">𝑓</ci><ci id="Thmdefinition1.p1.3.3.m3.5.5.cmml" xref="Thmdefinition1.p1.3.3.m3.5.5">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.3.3.m3.5c">{r(x,y)-r^{\prime}(x,y)=f(x)}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.3.3.m3.5d">italic_r ( italic_x , italic_y ) - italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_f ( italic_x )</annotation></semantics></math> for some function <math alttext="f" class="ltx_Math" display="inline" id="Thmdefinition1.p1.4.4.m4.1"><semantics id="Thmdefinition1.p1.4.4.m4.1a"><mi id="Thmdefinition1.p1.4.4.m4.1.1" xref="Thmdefinition1.p1.4.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.4.4.m4.1b"><ci id="Thmdefinition1.p1.4.4.m4.1.1.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.4.4.m4.1c">f</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.4.4.m4.1d">italic_f</annotation></semantics></math>.</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">이것은 보상 함수 집합을 클래스로 분할하는 등가 관계라는 것을 쉽게 알 수 있다. 다음 두 가지 레마를 말할 수 있습니다.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmlemma1.1.1.1">Lemma 1</span></span><span class="ltx_text ltx_font_bold" id="Thmlemma1.2.2">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="Thmlemma1.p1">
<p class="ltx_p" id="Thmlemma1.p1.1"><span class="ltx_text ltx_font_italic" id="Thmlemma1.p1.1.1">Plackett-Luce 아래에서, 특히 Bradley-Terry, 선호도 프레임워크, 동일한 클래스의 두 보상 함수는 동일한 선호도 분포를 유도한다. </span></p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmlemma2.1.1.1">Lemma 2</span></span><span class="ltx_text ltx_font_bold" id="Thmlemma2.2.2">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="Thmlemma2.p1">
<p class="ltx_p" id="Thmlemma2.p1.1"><span class="ltx_text ltx_font_italic" id="Thmlemma2.p1.1.1">동일한 동등성 클래스의 두 보상 함수는 제약된 RL 문제 하에서 동일한 최적 정책을 유도한다. </span></p>
</div>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">증명은 간단하며 부록 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS5" title="A.5 Proof of Lemma 1 and 2 ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">A.5</span></a>로 연기한다. 첫 번째 보조 문제는 모델 <cite class="ltx_cite ltx_citemacro_cite">Plackett (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib30" title="">1975</a>)</cite>의 Plackett-Luce 계열과 함께 잘 알려져 있는 사양 부족 문제이다. 이러한 지정 부족 때문에 일반적으로 Eq의 MLE 추정치에 대한 보장을 달성하기 위해 추가 식별 가능성 제약을 부과해야 한다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3.E2" title="2 ‣ 3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">2</span></a> <cite class="ltx_cite ltx_citemacro_cite">Bong and Rinaldo (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib4" title="">2022</a>)</cite> 두 번째 보조 정리는 동일한 클래스의 모든 보상 함수가 동일한 최적 정책을 산출한다고 명시하며, 따라서 최종 목적을 위해 우리는 최적 클래스에서 임의의 보상 함수를 복구하는 데에만 관심이 있다. 우리는 부록 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS6" title="A.6 Proof of Theorem 1 ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">A.6</span></a>에서 다음과 같은 정리를 증명한다:</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem1.1.1.1">Theorem 1</span></span><span class="ltx_text ltx_font_bold" id="Thmtheorem1.2.2">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="Thmtheorem1.p1">
<p class="ltx_p" id="Thmtheorem1.p1.3"><span class="ltx_text ltx_font_italic" id="Thmtheorem1.p1.3.3">Under mild assumptions, all reward classes consistent with the Plackett-Luce (and Bradley-Terry in particular) models can be represented with the reparameterization <math alttext="{r(x,y)=\beta\log\frac{\pi(y\mid x)}{\pi_{\text{ref}}(y\mid x)}}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.1.1.m1.4"><semantics id="Thmtheorem1.p1.1.1.m1.4a"><mrow id="Thmtheorem1.p1.1.1.m1.4.5" xref="Thmtheorem1.p1.1.1.m1.4.5.cmml"><mrow id="Thmtheorem1.p1.1.1.m1.4.5.2" xref="Thmtheorem1.p1.1.1.m1.4.5.2.cmml"><mi id="Thmtheorem1.p1.1.1.m1.4.5.2.2" xref="Thmtheorem1.p1.1.1.m1.4.5.2.2.cmml">r</mi><mo id="Thmtheorem1.p1.1.1.m1.4.5.2.1" mathvariant="italic" xref="Thmtheorem1.p1.1.1.m1.4.5.2.1.cmml">⁢</mo><mrow id="Thmtheorem1.p1.1.1.m1.4.5.2.3.2" xref="Thmtheorem1.p1.1.1.m1.4.5.2.3.1.cmml"><mo id="Thmtheorem1.p1.1.1.m1.4.5.2.3.2.1" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.1.1.m1.4.5.2.3.1.cmml">(</mo><mi id="Thmtheorem1.p1.1.1.m1.3.3" xref="Thmtheorem1.p1.1.1.m1.3.3.cmml">x</mi><mo id="Thmtheorem1.p1.1.1.m1.4.5.2.3.2.2" mathvariant="normal" xref="Thmtheorem1.p1.1.1.m1.4.5.2.3.1.cmml">,</mo><mi id="Thmtheorem1.p1.1.1.m1.4.4" xref="Thmtheorem1.p1.1.1.m1.4.4.cmml">y</mi><mo id="Thmtheorem1.p1.1.1.m1.4.5.2.3.2.3" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.1.1.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="Thmtheorem1.p1.1.1.m1.4.5.1" mathvariant="normal" xref="Thmtheorem1.p1.1.1.m1.4.5.1.cmml">=</mo><mrow id="Thmtheorem1.p1.1.1.m1.4.5.3" xref="Thmtheorem1.p1.1.1.m1.4.5.3.cmml"><mi id="Thmtheorem1.p1.1.1.m1.4.5.3.2" xref="Thmtheorem1.p1.1.1.m1.4.5.3.2.cmml">β</mi><mo id="Thmtheorem1.p1.1.1.m1.4.5.3.1" lspace="0.167em" mathvariant="italic" xref="Thmtheorem1.p1.1.1.m1.4.5.3.1.cmml">⁢</mo><mrow id="Thmtheorem1.p1.1.1.m1.4.5.3.3" xref="Thmtheorem1.p1.1.1.m1.4.5.3.3.cmml"><mi id="Thmtheorem1.p1.1.1.m1.4.5.3.3.1" mathvariant="normal" xref="Thmtheorem1.p1.1.1.m1.4.5.3.3.1.cmml">log</mi><mo id="Thmtheorem1.p1.1.1.m1.4.5.3.3a" lspace="0.167em" mathvariant="italic" xref="Thmtheorem1.p1.1.1.m1.4.5.3.3.cmml">⁡</mo><mfrac id="Thmtheorem1.p1.1.1.m1.2.2" xref="Thmtheorem1.p1.1.1.m1.2.2.cmml"><mrow id="Thmtheorem1.p1.1.1.m1.1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.1.cmml"><mi id="Thmtheorem1.p1.1.1.m1.1.1.1.3" xref="Thmtheorem1.p1.1.1.m1.1.1.1.3.cmml">π</mi><mo id="Thmtheorem1.p1.1.1.m1.1.1.1.2" mathvariant="italic" xref="Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml"><mo id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml"><mi id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.1" mathvariant="normal" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="Thmtheorem1.p1.1.1.m1.2.2.2" xref="Thmtheorem1.p1.1.1.m1.2.2.2.cmml"><msub id="Thmtheorem1.p1.1.1.m1.2.2.2.3" xref="Thmtheorem1.p1.1.1.m1.2.2.2.3.cmml"><mi id="Thmtheorem1.p1.1.1.m1.2.2.2.3.2" xref="Thmtheorem1.p1.1.1.m1.2.2.2.3.2.cmml">π</mi><mtext id="Thmtheorem1.p1.1.1.m1.2.2.2.3.3" xref="Thmtheorem1.p1.1.1.m1.2.2.2.3.3a.cmml">𝑟𝑒𝑓</mtext></msub><mo id="Thmtheorem1.p1.1.1.m1.2.2.2.2" mathvariant="italic" xref="Thmtheorem1.p1.1.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.cmml"><mo id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.2" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.cmml"><mi id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.2" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.2.cmml">y</mi><mo id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.1" mathvariant="normal" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.1.cmml">∣</mo><mi id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.3" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.3" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.1.1.m1.4b"><apply id="Thmtheorem1.p1.1.1.m1.4.5.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5"><eq id="Thmtheorem1.p1.1.1.m1.4.5.1.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.1"></eq><apply id="Thmtheorem1.p1.1.1.m1.4.5.2.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.2"><times id="Thmtheorem1.p1.1.1.m1.4.5.2.1.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.2.1"></times><ci id="Thmtheorem1.p1.1.1.m1.4.5.2.2.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.2.2">𝑟</ci><interval closure="open" id="Thmtheorem1.p1.1.1.m1.4.5.2.3.1.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.2.3.2"><ci id="Thmtheorem1.p1.1.1.m1.3.3.cmml" xref="Thmtheorem1.p1.1.1.m1.3.3">𝑥</ci><ci id="Thmtheorem1.p1.1.1.m1.4.4.cmml" xref="Thmtheorem1.p1.1.1.m1.4.4">𝑦</ci></interval></apply><apply id="Thmtheorem1.p1.1.1.m1.4.5.3.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.3"><times id="Thmtheorem1.p1.1.1.m1.4.5.3.1.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.3.1"></times><ci id="Thmtheorem1.p1.1.1.m1.4.5.3.2.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.3.2">𝛽</ci><apply id="Thmtheorem1.p1.1.1.m1.4.5.3.3.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.3.3"><log id="Thmtheorem1.p1.1.1.m1.4.5.3.3.1.cmml" xref="Thmtheorem1.p1.1.1.m1.4.5.3.3.1"></log><apply id="Thmtheorem1.p1.1.1.m1.2.2.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2"><divide id="Thmtheorem1.p1.1.1.m1.2.2.3.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2"></divide><apply id="Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1"><times id="Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.2"></times><ci id="Thmtheorem1.p1.1.1.m1.1.1.1.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.3">𝜋</ci><apply id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="Thmtheorem1.p1.1.1.m1.2.2.2.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2"><times id="Thmtheorem1.p1.1.1.m1.2.2.2.2.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2.2"></times><apply id="Thmtheorem1.p1.1.1.m1.2.2.2.3.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.1.1.m1.2.2.2.3.1.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2.3">subscript</csymbol><ci id="Thmtheorem1.p1.1.1.m1.2.2.2.3.2.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2.3.2">𝜋</ci><ci id="Thmtheorem1.p1.1.1.m1.2.2.2.3.3a.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2.3.3"><mtext id="Thmtheorem1.p1.1.1.m1.2.2.2.3.3.cmml" mathsize="50%" xref="Thmtheorem1.p1.1.1.m1.2.2.2.3.3">𝑟𝑒𝑓</mtext></ci></apply><apply id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.2.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.3.cmml" xref="Thmtheorem1.p1.1.1.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.1.1.m1.4c">{r(x,y)=\beta\log\frac{\pi(y\mid x)}{\pi_{\text{ref}}(y\mid x)}}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.1.1.m1.4d">italic_r ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π ( italic_y ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG</annotation></semantics></math> for some model <math alttext="\pi(y\mid x)" class="ltx_Math" display="inline" id="Thmtheorem1.p1.2.2.m2.1"><semantics id="Thmtheorem1.p1.2.2.m2.1a"><mrow id="Thmtheorem1.p1.2.2.m2.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="Thmtheorem1.p1.2.2.m2.1.1.3" xref="Thmtheorem1.p1.2.2.m2.1.1.3.cmml">π</mi><mo id="Thmtheorem1.p1.2.2.m2.1.1.2" mathvariant="italic" xref="Thmtheorem1.p1.2.2.m2.1.1.2.cmml">⁢</mo><mrow id="Thmtheorem1.p1.2.2.m2.1.1.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml"><mo id="Thmtheorem1.p1.2.2.m2.1.1.1.1.2" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml"><mi id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.cmml">y</mi><mo id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1" mathvariant="normal" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1.cmml">∣</mo><mi id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="Thmtheorem1.p1.2.2.m2.1.1.1.1.3" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.2.2.m2.1b"><apply id="Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1"><times id="Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.2"></times><ci id="Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3">𝜋</ci><apply id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1"><csymbol cd="latexml" id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.2">𝑦</ci><ci id="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.2.2.m2.1c">\pi(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.2.2.m2.1d">italic_π ( italic_y ∣ italic_x )</annotation></semantics></math> and a given reference model <math alttext="\pi_{\text{ref}}(y\mid x)" class="ltx_Math" display="inline" id="Thmtheorem1.p1.3.3.m3.1"><semantics id="Thmtheorem1.p1.3.3.m3.1a"><mrow id="Thmtheorem1.p1.3.3.m3.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.cmml"><msub id="Thmtheorem1.p1.3.3.m3.1.1.3" xref="Thmtheorem1.p1.3.3.m3.1.1.3.cmml"><mi id="Thmtheorem1.p1.3.3.m3.1.1.3.2" xref="Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml">π</mi><mtext id="Thmtheorem1.p1.3.3.m3.1.1.3.3" xref="Thmtheorem1.p1.3.3.m3.1.1.3.3a.cmml">𝑟𝑒𝑓</mtext></msub><mo id="Thmtheorem1.p1.3.3.m3.1.1.2" mathvariant="italic" xref="Thmtheorem1.p1.3.3.m3.1.1.2.cmml">⁢</mo><mrow id="Thmtheorem1.p1.3.3.m3.1.1.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml"><mo id="Thmtheorem1.p1.3.3.m3.1.1.1.1.2" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml"><mi id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.cmml">y</mi><mo id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1" mathvariant="normal" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.cmml">∣</mo><mi id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="Thmtheorem1.p1.3.3.m3.1.1.1.1.3" mathvariant="normal" stretchy="false" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.3.3.m3.1b"><apply id="Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1"><times id="Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.2"></times><apply id="Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.3.3.m3.1.1.3.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.3">subscript</csymbol><ci id="Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.3.2">𝜋</ci><ci id="Thmtheorem1.p1.3.3.m3.1.1.3.3a.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.3.3"><mtext id="Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml" mathsize="70%" xref="Thmtheorem1.p1.3.3.m3.1.1.3.3">𝑟𝑒𝑓</mtext></ci></apply><apply id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1"><csymbol cd="latexml" id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.2">𝑦</ci><ci id="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3.cmml" xref="Thmtheorem1.p1.3.3.m3.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.3.3.m3.1c">\pi_{\text{ref}}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.3.3.m3.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math>.</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_proof" id="S5.SS1.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof Sketch.</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.1.p1">
<p class="ltx_p" id="S5.SS1.1.p1.4">Eq에 의해 특정된 대응하는 최적 모델 <math alttext="\pi_{r}(y\mid x)" class="ltx_Math" display="inline" id="S5.SS1.1.p1.2.m2.1"><semantics id="S5.SS1.1.p1.2.m2.1a"><mrow id="S5.SS1.1.p1.2.m2.1.1" xref="S5.SS1.1.p1.2.m2.1.1.cmml"><msub id="S5.SS1.1.p1.2.m2.1.1.3" xref="S5.SS1.1.p1.2.m2.1.1.3.cmml"><mi id="S5.SS1.1.p1.2.m2.1.1.3.2" xref="S5.SS1.1.p1.2.m2.1.1.3.2.cmml">π</mi><mi id="S5.SS1.1.p1.2.m2.1.1.3.3" xref="S5.SS1.1.p1.2.m2.1.1.3.3.cmml">r</mi></msub><mo id="S5.SS1.1.p1.2.m2.1.1.2" xref="S5.SS1.1.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S5.SS1.1.p1.2.m2.1.1.1.1" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.cmml"><mo id="S5.SS1.1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.1.p1.2.m2.1.1.1.1.1" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S5.SS1.1.p1.2.m2.1.1.1.1.1.2" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.2.cmml">y</mi><mo id="S5.SS1.1.p1.2.m2.1.1.1.1.1.1" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.SS1.1.p1.2.m2.1.1.1.1.1.3" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS1.1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.2.m2.1b"><apply id="S5.SS1.1.p1.2.m2.1.1.cmml" xref="S5.SS1.1.p1.2.m2.1.1"><times id="S5.SS1.1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.1.p1.2.m2.1.1.2"></times><apply id="S5.SS1.1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.1.p1.2.m2.1.1.3.1.cmml" xref="S5.SS1.1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS1.1.p1.2.m2.1.1.3.2.cmml" xref="S5.SS1.1.p1.2.m2.1.1.3.2">𝜋</ci><ci id="S5.SS1.1.p1.2.m2.1.1.3.3.cmml" xref="S5.SS1.1.p1.2.m2.1.1.3.3">𝑟</ci></apply><apply id="S5.SS1.1.p1.2.m2.1.1.1.1.1.cmml" xref="S5.SS1.1.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS1.1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.2">𝑦</ci><ci id="S5.SS1.1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S5.SS1.1.p1.2.m2.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.2.m2.1c">\pi_{r}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math>를 유도하는 임의의 보상 함수 <math alttext="r(x,y)" class="ltx_Math" display="inline" id="S5.SS1.1.p1.1.m1.2"><semantics id="S5.SS1.1.p1.1.m1.2a"><mrow id="S5.SS1.1.p1.1.m1.2.3" xref="S5.SS1.1.p1.1.m1.2.3.cmml"><mi id="S5.SS1.1.p1.1.m1.2.3.2" xref="S5.SS1.1.p1.1.m1.2.3.2.cmml">r</mi><mo id="S5.SS1.1.p1.1.m1.2.3.1" xref="S5.SS1.1.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S5.SS1.1.p1.1.m1.2.3.3.2" xref="S5.SS1.1.p1.1.m1.2.3.3.1.cmml"><mo id="S5.SS1.1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S5.SS1.1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S5.SS1.1.p1.1.m1.1.1" xref="S5.SS1.1.p1.1.m1.1.1.cmml">x</mi><mo id="S5.SS1.1.p1.1.m1.2.3.3.2.2" xref="S5.SS1.1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S5.SS1.1.p1.1.m1.2.2" xref="S5.SS1.1.p1.1.m1.2.2.cmml">y</mi><mo id="S5.SS1.1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S5.SS1.1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.1.m1.2b"><apply id="S5.SS1.1.p1.1.m1.2.3.cmml" xref="S5.SS1.1.p1.1.m1.2.3"><times id="S5.SS1.1.p1.1.m1.2.3.1.cmml" xref="S5.SS1.1.p1.1.m1.2.3.1"></times><ci id="S5.SS1.1.p1.1.m1.2.3.2.cmml" xref="S5.SS1.1.p1.1.m1.2.3.2">𝑟</ci><interval closure="open" id="S5.SS1.1.p1.1.m1.2.3.3.1.cmml" xref="S5.SS1.1.p1.1.m1.2.3.3.2"><ci id="S5.SS1.1.p1.1.m1.1.1.cmml" xref="S5.SS1.1.p1.1.m1.1.1">𝑥</ci><ci id="S5.SS1.1.p1.1.m1.2.2.cmml" xref="S5.SS1.1.p1.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.1.m1.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.1.m1.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math>를 고려한다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E4" title="4 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>. 우리는 <math alttext="r" class="ltx_Math" display="inline" id="S5.SS1.1.p1.3.m3.1"><semantics id="S5.SS1.1.p1.3.m3.1a"><mi id="S5.SS1.1.p1.3.m3.1.1" xref="S5.SS1.1.p1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.3.m3.1b"><ci id="S5.SS1.1.p1.3.m3.1.1.cmml" xref="S5.SS1.1.p1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.3.m3.1c">r</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.3.m3.1d">italic_r</annotation></semantics></math>의 동등성 클래스로부터의 보상 함수가 위에서 주어진 재매개 변수화를 이용하여 표현될 수 있음을 보일 것이다. 우리는 프로젝션 <math alttext="f" class="ltx_Math" display="inline" id="S5.SS1.1.p1.4.m4.1"><semantics id="S5.SS1.1.p1.4.m4.1a"><mi id="S5.SS1.1.p1.4.m4.1.1" xref="S5.SS1.1.p1.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.4.m4.1b"><ci id="S5.SS1.1.p1.4.m4.1.1.cmml" xref="S5.SS1.1.p1.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.4.m4.1c">f</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.4.m4.1d">italic_f</annotation></semantics></math>를 다음과 같이 정의한다.</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(r;\pi_{\text{ref}},\beta)(x,y)=r(x,y)-\beta\log\sum_{y}\pi_{\text{ref}}(y%
\mid x)\exp\left(\frac{1}{\beta}r(x,y)\right)" class="ltx_Math" display="block" id="S5.E8.m1.12"><semantics id="S5.E8.m1.12a"><mrow id="S5.E8.m1.12.12" xref="S5.E8.m1.12.12.cmml"><mrow id="S5.E8.m1.10.10.1" xref="S5.E8.m1.10.10.1.cmml"><mi id="S5.E8.m1.10.10.1.3" xref="S5.E8.m1.10.10.1.3.cmml">f</mi><mo id="S5.E8.m1.10.10.1.2" xref="S5.E8.m1.10.10.1.2.cmml">⁢</mo><mrow id="S5.E8.m1.10.10.1.1.1" xref="S5.E8.m1.10.10.1.1.2.cmml"><mo id="S5.E8.m1.10.10.1.1.1.2" stretchy="false" xref="S5.E8.m1.10.10.1.1.2.cmml">(</mo><mi id="S5.E8.m1.1.1" xref="S5.E8.m1.1.1.cmml">r</mi><mo id="S5.E8.m1.10.10.1.1.1.3" xref="S5.E8.m1.10.10.1.1.2.cmml">;</mo><msub id="S5.E8.m1.10.10.1.1.1.1" xref="S5.E8.m1.10.10.1.1.1.1.cmml"><mi id="S5.E8.m1.10.10.1.1.1.1.2" xref="S5.E8.m1.10.10.1.1.1.1.2.cmml">π</mi><mtext id="S5.E8.m1.10.10.1.1.1.1.3" xref="S5.E8.m1.10.10.1.1.1.1.3a.cmml">ref</mtext></msub><mo id="S5.E8.m1.10.10.1.1.1.4" xref="S5.E8.m1.10.10.1.1.2.cmml">,</mo><mi id="S5.E8.m1.2.2" xref="S5.E8.m1.2.2.cmml">β</mi><mo id="S5.E8.m1.10.10.1.1.1.5" stretchy="false" xref="S5.E8.m1.10.10.1.1.2.cmml">)</mo></mrow><mo id="S5.E8.m1.10.10.1.2a" xref="S5.E8.m1.10.10.1.2.cmml">⁢</mo><mrow id="S5.E8.m1.10.10.1.4.2" xref="S5.E8.m1.10.10.1.4.1.cmml"><mo id="S5.E8.m1.10.10.1.4.2.1" stretchy="false" xref="S5.E8.m1.10.10.1.4.1.cmml">(</mo><mi id="S5.E8.m1.3.3" xref="S5.E8.m1.3.3.cmml">x</mi><mo id="S5.E8.m1.10.10.1.4.2.2" xref="S5.E8.m1.10.10.1.4.1.cmml">,</mo><mi id="S5.E8.m1.4.4" xref="S5.E8.m1.4.4.cmml">y</mi><mo id="S5.E8.m1.10.10.1.4.2.3" stretchy="false" xref="S5.E8.m1.10.10.1.4.1.cmml">)</mo></mrow></mrow><mo id="S5.E8.m1.12.12.4" xref="S5.E8.m1.12.12.4.cmml">=</mo><mrow id="S5.E8.m1.12.12.3" xref="S5.E8.m1.12.12.3.cmml"><mrow id="S5.E8.m1.12.12.3.4" xref="S5.E8.m1.12.12.3.4.cmml"><mi id="S5.E8.m1.12.12.3.4.2" xref="S5.E8.m1.12.12.3.4.2.cmml">r</mi><mo id="S5.E8.m1.12.12.3.4.1" xref="S5.E8.m1.12.12.3.4.1.cmml">⁢</mo><mrow id="S5.E8.m1.12.12.3.4.3.2" xref="S5.E8.m1.12.12.3.4.3.1.cmml"><mo id="S5.E8.m1.12.12.3.4.3.2.1" stretchy="false" xref="S5.E8.m1.12.12.3.4.3.1.cmml">(</mo><mi id="S5.E8.m1.5.5" xref="S5.E8.m1.5.5.cmml">x</mi><mo id="S5.E8.m1.12.12.3.4.3.2.2" xref="S5.E8.m1.12.12.3.4.3.1.cmml">,</mo><mi id="S5.E8.m1.6.6" xref="S5.E8.m1.6.6.cmml">y</mi><mo id="S5.E8.m1.12.12.3.4.3.2.3" stretchy="false" xref="S5.E8.m1.12.12.3.4.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E8.m1.12.12.3.3" xref="S5.E8.m1.12.12.3.3.cmml">−</mo><mrow id="S5.E8.m1.12.12.3.2" xref="S5.E8.m1.12.12.3.2.cmml"><mi id="S5.E8.m1.12.12.3.2.4" xref="S5.E8.m1.12.12.3.2.4.cmml">β</mi><mo id="S5.E8.m1.12.12.3.2.3" lspace="0.167em" xref="S5.E8.m1.12.12.3.2.3.cmml">⁢</mo><mi id="S5.E8.m1.12.12.3.2.5" xref="S5.E8.m1.12.12.3.2.5.cmml">log</mi><mo id="S5.E8.m1.12.12.3.2.3a" xref="S5.E8.m1.12.12.3.2.3.cmml">⁢</mo><mrow id="S5.E8.m1.12.12.3.2.2" xref="S5.E8.m1.12.12.3.2.2.cmml"><munder id="S5.E8.m1.12.12.3.2.2.3" xref="S5.E8.m1.12.12.3.2.2.3.cmml"><mo id="S5.E8.m1.12.12.3.2.2.3.2" movablelimits="false" xref="S5.E8.m1.12.12.3.2.2.3.2.cmml">∑</mo><mi id="S5.E8.m1.12.12.3.2.2.3.3" xref="S5.E8.m1.12.12.3.2.2.3.3.cmml">y</mi></munder><mrow id="S5.E8.m1.12.12.3.2.2.2" xref="S5.E8.m1.12.12.3.2.2.2.cmml"><msub id="S5.E8.m1.12.12.3.2.2.2.4" xref="S5.E8.m1.12.12.3.2.2.2.4.cmml"><mi id="S5.E8.m1.12.12.3.2.2.2.4.2" xref="S5.E8.m1.12.12.3.2.2.2.4.2.cmml">π</mi><mtext id="S5.E8.m1.12.12.3.2.2.2.4.3" xref="S5.E8.m1.12.12.3.2.2.2.4.3a.cmml">ref</mtext></msub><mo id="S5.E8.m1.12.12.3.2.2.2.3" xref="S5.E8.m1.12.12.3.2.2.2.3.cmml">⁢</mo><mrow id="S5.E8.m1.11.11.2.1.1.1.1.1" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.cmml"><mo id="S5.E8.m1.11.11.2.1.1.1.1.1.2" stretchy="false" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E8.m1.11.11.2.1.1.1.1.1.1" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.cmml"><mi id="S5.E8.m1.11.11.2.1.1.1.1.1.1.2" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.2.cmml">y</mi><mo id="S5.E8.m1.11.11.2.1.1.1.1.1.1.1" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.E8.m1.11.11.2.1.1.1.1.1.1.3" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.E8.m1.11.11.2.1.1.1.1.1.3" stretchy="false" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.E8.m1.12.12.3.2.2.2.3a" lspace="0.167em" xref="S5.E8.m1.12.12.3.2.2.2.3.cmml">⁢</mo><mrow id="S5.E8.m1.12.12.3.2.2.2.2.1" xref="S5.E8.m1.12.12.3.2.2.2.2.2.cmml"><mi id="S5.E8.m1.9.9" xref="S5.E8.m1.9.9.cmml">exp</mi><mo id="S5.E8.m1.12.12.3.2.2.2.2.1a" xref="S5.E8.m1.12.12.3.2.2.2.2.2.cmml">⁡</mo><mrow id="S5.E8.m1.12.12.3.2.2.2.2.1.1" xref="S5.E8.m1.12.12.3.2.2.2.2.2.cmml"><mo id="S5.E8.m1.12.12.3.2.2.2.2.1.1.2" xref="S5.E8.m1.12.12.3.2.2.2.2.2.cmml">(</mo><mrow id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.cmml"><mfrac id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.cmml"><mn id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.2" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.2.cmml">1</mn><mi id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.3" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.1" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.3" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.3.cmml">r</mi><mo id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.1a" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.2" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.1.cmml"><mo id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.2.1" stretchy="false" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.1.cmml">(</mo><mi id="S5.E8.m1.7.7" xref="S5.E8.m1.7.7.cmml">x</mi><mo id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.2.2" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.1.cmml">,</mo><mi id="S5.E8.m1.8.8" xref="S5.E8.m1.8.8.cmml">y</mi><mo id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.2.3" stretchy="false" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="S5.E8.m1.12.12.3.2.2.2.2.1.1.3" xref="S5.E8.m1.12.12.3.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E8.m1.12b"><apply id="S5.E8.m1.12.12.cmml" xref="S5.E8.m1.12.12"><eq id="S5.E8.m1.12.12.4.cmml" xref="S5.E8.m1.12.12.4"></eq><apply id="S5.E8.m1.10.10.1.cmml" xref="S5.E8.m1.10.10.1"><times id="S5.E8.m1.10.10.1.2.cmml" xref="S5.E8.m1.10.10.1.2"></times><ci id="S5.E8.m1.10.10.1.3.cmml" xref="S5.E8.m1.10.10.1.3">𝑓</ci><list id="S5.E8.m1.10.10.1.1.2.cmml" xref="S5.E8.m1.10.10.1.1.1"><ci id="S5.E8.m1.1.1.cmml" xref="S5.E8.m1.1.1">𝑟</ci><apply id="S5.E8.m1.10.10.1.1.1.1.cmml" xref="S5.E8.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S5.E8.m1.10.10.1.1.1.1.1.cmml" xref="S5.E8.m1.10.10.1.1.1.1">subscript</csymbol><ci id="S5.E8.m1.10.10.1.1.1.1.2.cmml" xref="S5.E8.m1.10.10.1.1.1.1.2">𝜋</ci><ci id="S5.E8.m1.10.10.1.1.1.1.3a.cmml" xref="S5.E8.m1.10.10.1.1.1.1.3"><mtext id="S5.E8.m1.10.10.1.1.1.1.3.cmml" mathsize="70%" xref="S5.E8.m1.10.10.1.1.1.1.3">ref</mtext></ci></apply><ci id="S5.E8.m1.2.2.cmml" xref="S5.E8.m1.2.2">𝛽</ci></list><interval closure="open" id="S5.E8.m1.10.10.1.4.1.cmml" xref="S5.E8.m1.10.10.1.4.2"><ci id="S5.E8.m1.3.3.cmml" xref="S5.E8.m1.3.3">𝑥</ci><ci id="S5.E8.m1.4.4.cmml" xref="S5.E8.m1.4.4">𝑦</ci></interval></apply><apply id="S5.E8.m1.12.12.3.cmml" xref="S5.E8.m1.12.12.3"><minus id="S5.E8.m1.12.12.3.3.cmml" xref="S5.E8.m1.12.12.3.3"></minus><apply id="S5.E8.m1.12.12.3.4.cmml" xref="S5.E8.m1.12.12.3.4"><times id="S5.E8.m1.12.12.3.4.1.cmml" xref="S5.E8.m1.12.12.3.4.1"></times><ci id="S5.E8.m1.12.12.3.4.2.cmml" xref="S5.E8.m1.12.12.3.4.2">𝑟</ci><interval closure="open" id="S5.E8.m1.12.12.3.4.3.1.cmml" xref="S5.E8.m1.12.12.3.4.3.2"><ci id="S5.E8.m1.5.5.cmml" xref="S5.E8.m1.5.5">𝑥</ci><ci id="S5.E8.m1.6.6.cmml" xref="S5.E8.m1.6.6">𝑦</ci></interval></apply><apply id="S5.E8.m1.12.12.3.2.cmml" xref="S5.E8.m1.12.12.3.2"><times id="S5.E8.m1.12.12.3.2.3.cmml" xref="S5.E8.m1.12.12.3.2.3"></times><ci id="S5.E8.m1.12.12.3.2.4.cmml" xref="S5.E8.m1.12.12.3.2.4">𝛽</ci><log id="S5.E8.m1.12.12.3.2.5.cmml" xref="S5.E8.m1.12.12.3.2.5"></log><apply id="S5.E8.m1.12.12.3.2.2.cmml" xref="S5.E8.m1.12.12.3.2.2"><apply id="S5.E8.m1.12.12.3.2.2.3.cmml" xref="S5.E8.m1.12.12.3.2.2.3"><csymbol cd="ambiguous" id="S5.E8.m1.12.12.3.2.2.3.1.cmml" xref="S5.E8.m1.12.12.3.2.2.3">subscript</csymbol><sum id="S5.E8.m1.12.12.3.2.2.3.2.cmml" xref="S5.E8.m1.12.12.3.2.2.3.2"></sum><ci id="S5.E8.m1.12.12.3.2.2.3.3.cmml" xref="S5.E8.m1.12.12.3.2.2.3.3">𝑦</ci></apply><apply id="S5.E8.m1.12.12.3.2.2.2.cmml" xref="S5.E8.m1.12.12.3.2.2.2"><times id="S5.E8.m1.12.12.3.2.2.2.3.cmml" xref="S5.E8.m1.12.12.3.2.2.2.3"></times><apply id="S5.E8.m1.12.12.3.2.2.2.4.cmml" xref="S5.E8.m1.12.12.3.2.2.2.4"><csymbol cd="ambiguous" id="S5.E8.m1.12.12.3.2.2.2.4.1.cmml" xref="S5.E8.m1.12.12.3.2.2.2.4">subscript</csymbol><ci id="S5.E8.m1.12.12.3.2.2.2.4.2.cmml" xref="S5.E8.m1.12.12.3.2.2.2.4.2">𝜋</ci><ci id="S5.E8.m1.12.12.3.2.2.2.4.3a.cmml" xref="S5.E8.m1.12.12.3.2.2.2.4.3"><mtext id="S5.E8.m1.12.12.3.2.2.2.4.3.cmml" mathsize="70%" xref="S5.E8.m1.12.12.3.2.2.2.4.3">ref</mtext></ci></apply><apply id="S5.E8.m1.11.11.2.1.1.1.1.1.1.cmml" xref="S5.E8.m1.11.11.2.1.1.1.1.1"><csymbol cd="latexml" id="S5.E8.m1.11.11.2.1.1.1.1.1.1.1.cmml" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.E8.m1.11.11.2.1.1.1.1.1.1.2.cmml" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.2">𝑦</ci><ci id="S5.E8.m1.11.11.2.1.1.1.1.1.1.3.cmml" xref="S5.E8.m1.11.11.2.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S5.E8.m1.12.12.3.2.2.2.2.2.cmml" xref="S5.E8.m1.12.12.3.2.2.2.2.1"><exp id="S5.E8.m1.9.9.cmml" xref="S5.E8.m1.9.9"></exp><apply id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.cmml" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1"><times id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.1.cmml" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.1"></times><apply id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.cmml" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2"><divide id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.1.cmml" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2"></divide><cn id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.2.cmml" type="integer" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.2">1</cn><ci id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.3.cmml" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.2.3">𝛽</ci></apply><ci id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.3.cmml" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.3">𝑟</ci><interval closure="open" id="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.1.cmml" xref="S5.E8.m1.12.12.3.2.2.2.2.1.1.1.4.2"><ci id="S5.E8.m1.7.7.cmml" xref="S5.E8.m1.7.7">𝑥</ci><ci id="S5.E8.m1.8.8.cmml" xref="S5.E8.m1.8.8">𝑦</ci></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E8.m1.12c">f(r;\pi_{\text{ref}},\beta)(x,y)=r(x,y)-\beta\log\sum_{y}\pi_{\text{ref}}(y%
\mid x)\exp\left(\frac{1}{\beta}r(x,y)\right)</annotation><annotation encoding="application/x-llamapun" id="S5.E8.m1.12d">italic_f ( italic_r ; italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT , italic_β ) ( italic_x , italic_y ) = italic_r ( italic_x , italic_y ) - italic_β roman_log ∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS1.1.p1.13">The operator <math alttext="f" class="ltx_Math" display="inline" id="S5.SS1.1.p1.5.m1.1"><semantics id="S5.SS1.1.p1.5.m1.1a"><mi id="S5.SS1.1.p1.5.m1.1.1" xref="S5.SS1.1.p1.5.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.5.m1.1b"><ci id="S5.SS1.1.p1.5.m1.1.1.cmml" xref="S5.SS1.1.p1.5.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.5.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.5.m1.1d">italic_f</annotation></semantics></math> simply normalizes the reward function with the logarithm of the partition function of <math alttext="\pi_{r}" class="ltx_Math" display="inline" id="S5.SS1.1.p1.6.m2.1"><semantics id="S5.SS1.1.p1.6.m2.1a"><msub id="S5.SS1.1.p1.6.m2.1.1" xref="S5.SS1.1.p1.6.m2.1.1.cmml"><mi id="S5.SS1.1.p1.6.m2.1.1.2" xref="S5.SS1.1.p1.6.m2.1.1.2.cmml">π</mi><mi id="S5.SS1.1.p1.6.m2.1.1.3" xref="S5.SS1.1.p1.6.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.6.m2.1b"><apply id="S5.SS1.1.p1.6.m2.1.1.cmml" xref="S5.SS1.1.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.1.p1.6.m2.1.1.1.cmml" xref="S5.SS1.1.p1.6.m2.1.1">subscript</csymbol><ci id="S5.SS1.1.p1.6.m2.1.1.2.cmml" xref="S5.SS1.1.p1.6.m2.1.1.2">𝜋</ci><ci id="S5.SS1.1.p1.6.m2.1.1.3.cmml" xref="S5.SS1.1.p1.6.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.6.m2.1c">\pi_{r}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.6.m2.1d">italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>. Since the added normalization term is only a function of the prefix <math alttext="x" class="ltx_Math" display="inline" id="S5.SS1.1.p1.7.m3.1"><semantics id="S5.SS1.1.p1.7.m3.1a"><mi id="S5.SS1.1.p1.7.m3.1.1" xref="S5.SS1.1.p1.7.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.7.m3.1b"><ci id="S5.SS1.1.p1.7.m3.1.1.cmml" xref="S5.SS1.1.p1.7.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.7.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.7.m3.1d">italic_x</annotation></semantics></math>, <math alttext="f(r;\pi_{\text{ref}},\beta)(x,y)" class="ltx_Math" display="inline" id="S5.SS1.1.p1.8.m4.5"><semantics id="S5.SS1.1.p1.8.m4.5a"><mrow id="S5.SS1.1.p1.8.m4.5.5" xref="S5.SS1.1.p1.8.m4.5.5.cmml"><mi id="S5.SS1.1.p1.8.m4.5.5.3" xref="S5.SS1.1.p1.8.m4.5.5.3.cmml">f</mi><mo id="S5.SS1.1.p1.8.m4.5.5.2" xref="S5.SS1.1.p1.8.m4.5.5.2.cmml">⁢</mo><mrow id="S5.SS1.1.p1.8.m4.5.5.1.1" xref="S5.SS1.1.p1.8.m4.5.5.1.2.cmml"><mo id="S5.SS1.1.p1.8.m4.5.5.1.1.2" stretchy="false" xref="S5.SS1.1.p1.8.m4.5.5.1.2.cmml">(</mo><mi id="S5.SS1.1.p1.8.m4.1.1" xref="S5.SS1.1.p1.8.m4.1.1.cmml">r</mi><mo id="S5.SS1.1.p1.8.m4.5.5.1.1.3" xref="S5.SS1.1.p1.8.m4.5.5.1.2.cmml">;</mo><msub id="S5.SS1.1.p1.8.m4.5.5.1.1.1" xref="S5.SS1.1.p1.8.m4.5.5.1.1.1.cmml"><mi id="S5.SS1.1.p1.8.m4.5.5.1.1.1.2" xref="S5.SS1.1.p1.8.m4.5.5.1.1.1.2.cmml">π</mi><mtext id="S5.SS1.1.p1.8.m4.5.5.1.1.1.3" xref="S5.SS1.1.p1.8.m4.5.5.1.1.1.3a.cmml">ref</mtext></msub><mo id="S5.SS1.1.p1.8.m4.5.5.1.1.4" xref="S5.SS1.1.p1.8.m4.5.5.1.2.cmml">,</mo><mi id="S5.SS1.1.p1.8.m4.2.2" xref="S5.SS1.1.p1.8.m4.2.2.cmml">β</mi><mo id="S5.SS1.1.p1.8.m4.5.5.1.1.5" stretchy="false" xref="S5.SS1.1.p1.8.m4.5.5.1.2.cmml">)</mo></mrow><mo id="S5.SS1.1.p1.8.m4.5.5.2a" xref="S5.SS1.1.p1.8.m4.5.5.2.cmml">⁢</mo><mrow id="S5.SS1.1.p1.8.m4.5.5.4.2" xref="S5.SS1.1.p1.8.m4.5.5.4.1.cmml"><mo id="S5.SS1.1.p1.8.m4.5.5.4.2.1" stretchy="false" xref="S5.SS1.1.p1.8.m4.5.5.4.1.cmml">(</mo><mi id="S5.SS1.1.p1.8.m4.3.3" xref="S5.SS1.1.p1.8.m4.3.3.cmml">x</mi><mo id="S5.SS1.1.p1.8.m4.5.5.4.2.2" xref="S5.SS1.1.p1.8.m4.5.5.4.1.cmml">,</mo><mi id="S5.SS1.1.p1.8.m4.4.4" xref="S5.SS1.1.p1.8.m4.4.4.cmml">y</mi><mo id="S5.SS1.1.p1.8.m4.5.5.4.2.3" stretchy="false" xref="S5.SS1.1.p1.8.m4.5.5.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.8.m4.5b"><apply id="S5.SS1.1.p1.8.m4.5.5.cmml" xref="S5.SS1.1.p1.8.m4.5.5"><times id="S5.SS1.1.p1.8.m4.5.5.2.cmml" xref="S5.SS1.1.p1.8.m4.5.5.2"></times><ci id="S5.SS1.1.p1.8.m4.5.5.3.cmml" xref="S5.SS1.1.p1.8.m4.5.5.3">𝑓</ci><list id="S5.SS1.1.p1.8.m4.5.5.1.2.cmml" xref="S5.SS1.1.p1.8.m4.5.5.1.1"><ci id="S5.SS1.1.p1.8.m4.1.1.cmml" xref="S5.SS1.1.p1.8.m4.1.1">𝑟</ci><apply id="S5.SS1.1.p1.8.m4.5.5.1.1.1.cmml" xref="S5.SS1.1.p1.8.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.1.p1.8.m4.5.5.1.1.1.1.cmml" xref="S5.SS1.1.p1.8.m4.5.5.1.1.1">subscript</csymbol><ci id="S5.SS1.1.p1.8.m4.5.5.1.1.1.2.cmml" xref="S5.SS1.1.p1.8.m4.5.5.1.1.1.2">𝜋</ci><ci id="S5.SS1.1.p1.8.m4.5.5.1.1.1.3a.cmml" xref="S5.SS1.1.p1.8.m4.5.5.1.1.1.3"><mtext id="S5.SS1.1.p1.8.m4.5.5.1.1.1.3.cmml" mathsize="70%" xref="S5.SS1.1.p1.8.m4.5.5.1.1.1.3">ref</mtext></ci></apply><ci id="S5.SS1.1.p1.8.m4.2.2.cmml" xref="S5.SS1.1.p1.8.m4.2.2">𝛽</ci></list><interval closure="open" id="S5.SS1.1.p1.8.m4.5.5.4.1.cmml" xref="S5.SS1.1.p1.8.m4.5.5.4.2"><ci id="S5.SS1.1.p1.8.m4.3.3.cmml" xref="S5.SS1.1.p1.8.m4.3.3">𝑥</ci><ci id="S5.SS1.1.p1.8.m4.4.4.cmml" xref="S5.SS1.1.p1.8.m4.4.4">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.8.m4.5c">f(r;\pi_{\text{ref}},\beta)(x,y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.8.m4.5d">italic_f ( italic_r ; italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT , italic_β ) ( italic_x , italic_y )</annotation></semantics></math> is a reward function in the equivalence class of <math alttext="r(x,y)" class="ltx_Math" display="inline" id="S5.SS1.1.p1.9.m5.2"><semantics id="S5.SS1.1.p1.9.m5.2a"><mrow id="S5.SS1.1.p1.9.m5.2.3" xref="S5.SS1.1.p1.9.m5.2.3.cmml"><mi id="S5.SS1.1.p1.9.m5.2.3.2" xref="S5.SS1.1.p1.9.m5.2.3.2.cmml">r</mi><mo id="S5.SS1.1.p1.9.m5.2.3.1" xref="S5.SS1.1.p1.9.m5.2.3.1.cmml">⁢</mo><mrow id="S5.SS1.1.p1.9.m5.2.3.3.2" xref="S5.SS1.1.p1.9.m5.2.3.3.1.cmml"><mo id="S5.SS1.1.p1.9.m5.2.3.3.2.1" stretchy="false" xref="S5.SS1.1.p1.9.m5.2.3.3.1.cmml">(</mo><mi id="S5.SS1.1.p1.9.m5.1.1" xref="S5.SS1.1.p1.9.m5.1.1.cmml">x</mi><mo id="S5.SS1.1.p1.9.m5.2.3.3.2.2" xref="S5.SS1.1.p1.9.m5.2.3.3.1.cmml">,</mo><mi id="S5.SS1.1.p1.9.m5.2.2" xref="S5.SS1.1.p1.9.m5.2.2.cmml">y</mi><mo id="S5.SS1.1.p1.9.m5.2.3.3.2.3" stretchy="false" xref="S5.SS1.1.p1.9.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.9.m5.2b"><apply id="S5.SS1.1.p1.9.m5.2.3.cmml" xref="S5.SS1.1.p1.9.m5.2.3"><times id="S5.SS1.1.p1.9.m5.2.3.1.cmml" xref="S5.SS1.1.p1.9.m5.2.3.1"></times><ci id="S5.SS1.1.p1.9.m5.2.3.2.cmml" xref="S5.SS1.1.p1.9.m5.2.3.2">𝑟</ci><interval closure="open" id="S5.SS1.1.p1.9.m5.2.3.3.1.cmml" xref="S5.SS1.1.p1.9.m5.2.3.3.2"><ci id="S5.SS1.1.p1.9.m5.1.1.cmml" xref="S5.SS1.1.p1.9.m5.1.1">𝑥</ci><ci id="S5.SS1.1.p1.9.m5.2.2.cmml" xref="S5.SS1.1.p1.9.m5.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.9.m5.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.9.m5.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math>. Finally, replacing <math alttext="r" class="ltx_Math" display="inline" id="S5.SS1.1.p1.10.m6.1"><semantics id="S5.SS1.1.p1.10.m6.1a"><mi id="S5.SS1.1.p1.10.m6.1.1" xref="S5.SS1.1.p1.10.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.10.m6.1b"><ci id="S5.SS1.1.p1.10.m6.1.1.cmml" xref="S5.SS1.1.p1.10.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.10.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.10.m6.1d">italic_r</annotation></semantics></math> with the RHS of Eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E5" title="5 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a> (which holds for any reward function), we have <math alttext="f(r;\pi_{\text{ref}},\beta)(x,y)=\beta\log\frac{\pi_{r}(y\mid x)}{\pi_{\text{% ref}}(y\mid x)}" class="ltx_Math" display="inline" id="S5.SS1.1.p1.11.m7.7"><semantics id="S5.SS1.1.p1.11.m7.7a"><mrow id="S5.SS1.1.p1.11.m7.7.7" xref="S5.SS1.1.p1.11.m7.7.7.cmml"><mrow id="S5.SS1.1.p1.11.m7.7.7.1" xref="S5.SS1.1.p1.11.m7.7.7.1.cmml"><mi id="S5.SS1.1.p1.11.m7.7.7.1.3" xref="S5.SS1.1.p1.11.m7.7.7.1.3.cmml">f</mi><mo id="S5.SS1.1.p1.11.m7.7.7.1.2" xref="S5.SS1.1.p1.11.m7.7.7.1.2.cmml">⁢</mo><mrow id="S5.SS1.1.p1.11.m7.7.7.1.1.1" xref="S5.SS1.1.p1.11.m7.7.7.1.1.2.cmml"><mo id="S5.SS1.1.p1.11.m7.7.7.1.1.1.2" stretchy="false" xref="S5.SS1.1.p1.11.m7.7.7.1.1.2.cmml">(</mo><mi id="S5.SS1.1.p1.11.m7.3.3" xref="S5.SS1.1.p1.11.m7.3.3.cmml">r</mi><mo id="S5.SS1.1.p1.11.m7.7.7.1.1.1.3" xref="S5.SS1.1.p1.11.m7.7.7.1.1.2.cmml">;</mo><msub id="S5.SS1.1.p1.11.m7.7.7.1.1.1.1" xref="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.cmml"><mi id="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.2" xref="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.2.cmml">π</mi><mtext id="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.3" xref="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.3a.cmml">ref</mtext></msub><mo id="S5.SS1.1.p1.11.m7.7.7.1.1.1.4" xref="S5.SS1.1.p1.11.m7.7.7.1.1.2.cmml">,</mo><mi id="S5.SS1.1.p1.11.m7.4.4" xref="S5.SS1.1.p1.11.m7.4.4.cmml">β</mi><mo id="S5.SS1.1.p1.11.m7.7.7.1.1.1.5" stretchy="false" xref="S5.SS1.1.p1.11.m7.7.7.1.1.2.cmml">)</mo></mrow><mo id="S5.SS1.1.p1.11.m7.7.7.1.2a" xref="S5.SS1.1.p1.11.m7.7.7.1.2.cmml">⁢</mo><mrow id="S5.SS1.1.p1.11.m7.7.7.1.4.2" xref="S5.SS1.1.p1.11.m7.7.7.1.4.1.cmml"><mo id="S5.SS1.1.p1.11.m7.7.7.1.4.2.1" stretchy="false" xref="S5.SS1.1.p1.11.m7.7.7.1.4.1.cmml">(</mo><mi id="S5.SS1.1.p1.11.m7.5.5" xref="S5.SS1.1.p1.11.m7.5.5.cmml">x</mi><mo id="S5.SS1.1.p1.11.m7.7.7.1.4.2.2" xref="S5.SS1.1.p1.11.m7.7.7.1.4.1.cmml">,</mo><mi id="S5.SS1.1.p1.11.m7.6.6" xref="S5.SS1.1.p1.11.m7.6.6.cmml">y</mi><mo id="S5.SS1.1.p1.11.m7.7.7.1.4.2.3" stretchy="false" xref="S5.SS1.1.p1.11.m7.7.7.1.4.1.cmml">)</mo></mrow></mrow><mo id="S5.SS1.1.p1.11.m7.7.7.2" xref="S5.SS1.1.p1.11.m7.7.7.2.cmml">=</mo><mrow id="S5.SS1.1.p1.11.m7.7.7.3" xref="S5.SS1.1.p1.11.m7.7.7.3.cmml"><mi id="S5.SS1.1.p1.11.m7.7.7.3.2" xref="S5.SS1.1.p1.11.m7.7.7.3.2.cmml">β</mi><mo id="S5.SS1.1.p1.11.m7.7.7.3.1" lspace="0.167em" xref="S5.SS1.1.p1.11.m7.7.7.3.1.cmml">⁢</mo><mrow id="S5.SS1.1.p1.11.m7.7.7.3.3" xref="S5.SS1.1.p1.11.m7.7.7.3.3.cmml"><mi id="S5.SS1.1.p1.11.m7.7.7.3.3.1" xref="S5.SS1.1.p1.11.m7.7.7.3.3.1.cmml">log</mi><mo id="S5.SS1.1.p1.11.m7.7.7.3.3a" lspace="0.167em" xref="S5.SS1.1.p1.11.m7.7.7.3.3.cmml">⁡</mo><mfrac id="S5.SS1.1.p1.11.m7.2.2" xref="S5.SS1.1.p1.11.m7.2.2.cmml"><mrow id="S5.SS1.1.p1.11.m7.1.1.1" xref="S5.SS1.1.p1.11.m7.1.1.1.cmml"><msub id="S5.SS1.1.p1.11.m7.1.1.1.3" xref="S5.SS1.1.p1.11.m7.1.1.1.3.cmml"><mi id="S5.SS1.1.p1.11.m7.1.1.1.3.2" xref="S5.SS1.1.p1.11.m7.1.1.1.3.2.cmml">π</mi><mi id="S5.SS1.1.p1.11.m7.1.1.1.3.3" xref="S5.SS1.1.p1.11.m7.1.1.1.3.3.cmml">r</mi></msub><mo id="S5.SS1.1.p1.11.m7.1.1.1.2" xref="S5.SS1.1.p1.11.m7.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS1.1.p1.11.m7.1.1.1.1.1" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.cmml"><mo id="S5.SS1.1.p1.11.m7.1.1.1.1.1.2" stretchy="false" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.1.p1.11.m7.1.1.1.1.1.1" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.cmml"><mi id="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.2" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.2.cmml">y</mi><mo id="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.1" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.3" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS1.1.p1.11.m7.1.1.1.1.1.3" stretchy="false" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.SS1.1.p1.11.m7.2.2.2" xref="S5.SS1.1.p1.11.m7.2.2.2.cmml"><msub id="S5.SS1.1.p1.11.m7.2.2.2.3" xref="S5.SS1.1.p1.11.m7.2.2.2.3.cmml"><mi id="S5.SS1.1.p1.11.m7.2.2.2.3.2" xref="S5.SS1.1.p1.11.m7.2.2.2.3.2.cmml">π</mi><mtext id="S5.SS1.1.p1.11.m7.2.2.2.3.3" xref="S5.SS1.1.p1.11.m7.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="S5.SS1.1.p1.11.m7.2.2.2.2" xref="S5.SS1.1.p1.11.m7.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS1.1.p1.11.m7.2.2.2.1.1" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.cmml"><mo id="S5.SS1.1.p1.11.m7.2.2.2.1.1.2" stretchy="false" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.cmml">(</mo><mrow id="S5.SS1.1.p1.11.m7.2.2.2.1.1.1" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.cmml"><mi id="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.2" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.2.cmml">y</mi><mo id="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.1" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.1.cmml">∣</mo><mi id="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.3" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS1.1.p1.11.m7.2.2.2.1.1.3" stretchy="false" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.11.m7.7b"><apply id="S5.SS1.1.p1.11.m7.7.7.cmml" xref="S5.SS1.1.p1.11.m7.7.7"><eq id="S5.SS1.1.p1.11.m7.7.7.2.cmml" xref="S5.SS1.1.p1.11.m7.7.7.2"></eq><apply id="S5.SS1.1.p1.11.m7.7.7.1.cmml" xref="S5.SS1.1.p1.11.m7.7.7.1"><times id="S5.SS1.1.p1.11.m7.7.7.1.2.cmml" xref="S5.SS1.1.p1.11.m7.7.7.1.2"></times><ci id="S5.SS1.1.p1.11.m7.7.7.1.3.cmml" xref="S5.SS1.1.p1.11.m7.7.7.1.3">𝑓</ci><list id="S5.SS1.1.p1.11.m7.7.7.1.1.2.cmml" xref="S5.SS1.1.p1.11.m7.7.7.1.1.1"><ci id="S5.SS1.1.p1.11.m7.3.3.cmml" xref="S5.SS1.1.p1.11.m7.3.3">𝑟</ci><apply id="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.cmml" xref="S5.SS1.1.p1.11.m7.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.1.cmml" xref="S5.SS1.1.p1.11.m7.7.7.1.1.1.1">subscript</csymbol><ci id="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.2.cmml" xref="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.2">𝜋</ci><ci id="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.3a.cmml" xref="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.3"><mtext id="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.3.cmml" mathsize="70%" xref="S5.SS1.1.p1.11.m7.7.7.1.1.1.1.3">ref</mtext></ci></apply><ci id="S5.SS1.1.p1.11.m7.4.4.cmml" xref="S5.SS1.1.p1.11.m7.4.4">𝛽</ci></list><interval closure="open" id="S5.SS1.1.p1.11.m7.7.7.1.4.1.cmml" xref="S5.SS1.1.p1.11.m7.7.7.1.4.2"><ci id="S5.SS1.1.p1.11.m7.5.5.cmml" xref="S5.SS1.1.p1.11.m7.5.5">𝑥</ci><ci id="S5.SS1.1.p1.11.m7.6.6.cmml" xref="S5.SS1.1.p1.11.m7.6.6">𝑦</ci></interval></apply><apply id="S5.SS1.1.p1.11.m7.7.7.3.cmml" xref="S5.SS1.1.p1.11.m7.7.7.3"><times id="S5.SS1.1.p1.11.m7.7.7.3.1.cmml" xref="S5.SS1.1.p1.11.m7.7.7.3.1"></times><ci id="S5.SS1.1.p1.11.m7.7.7.3.2.cmml" xref="S5.SS1.1.p1.11.m7.7.7.3.2">𝛽</ci><apply id="S5.SS1.1.p1.11.m7.7.7.3.3.cmml" xref="S5.SS1.1.p1.11.m7.7.7.3.3"><log id="S5.SS1.1.p1.11.m7.7.7.3.3.1.cmml" xref="S5.SS1.1.p1.11.m7.7.7.3.3.1"></log><apply id="S5.SS1.1.p1.11.m7.2.2.cmml" xref="S5.SS1.1.p1.11.m7.2.2"><divide id="S5.SS1.1.p1.11.m7.2.2.3.cmml" xref="S5.SS1.1.p1.11.m7.2.2"></divide><apply id="S5.SS1.1.p1.11.m7.1.1.1.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1"><times id="S5.SS1.1.p1.11.m7.1.1.1.2.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1.2"></times><apply id="S5.SS1.1.p1.11.m7.1.1.1.3.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.1.p1.11.m7.1.1.1.3.1.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1.3">subscript</csymbol><ci id="S5.SS1.1.p1.11.m7.1.1.1.3.2.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1.3.2">𝜋</ci><ci id="S5.SS1.1.p1.11.m7.1.1.1.3.3.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1.3.3">𝑟</ci></apply><apply id="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.1.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.2.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.2">𝑦</ci><ci id="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.3.cmml" xref="S5.SS1.1.p1.11.m7.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S5.SS1.1.p1.11.m7.2.2.2.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2"><times id="S5.SS1.1.p1.11.m7.2.2.2.2.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2.2"></times><apply id="S5.SS1.1.p1.11.m7.2.2.2.3.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS1.1.p1.11.m7.2.2.2.3.1.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2.3">subscript</csymbol><ci id="S5.SS1.1.p1.11.m7.2.2.2.3.2.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2.3.2">𝜋</ci><ci id="S5.SS1.1.p1.11.m7.2.2.2.3.3a.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2.3.3"><mtext id="S5.SS1.1.p1.11.m7.2.2.2.3.3.cmml" mathsize="50%" xref="S5.SS1.1.p1.11.m7.2.2.2.3.3">ref</mtext></ci></apply><apply id="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1"><csymbol cd="latexml" id="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.1.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.1">conditional</csymbol><ci id="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.2.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.2">𝑦</ci><ci id="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.3.cmml" xref="S5.SS1.1.p1.11.m7.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.11.m7.7c">f(r;\pi_{\text{ref}},\beta)(x,y)=\beta\log\frac{\pi_{r}(y\mid x)}{\pi_{\text{% ref}}(y\mid x)}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.11.m7.7d">italic_f ( italic_r ; italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT , italic_β ) ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG</annotation></semantics></math>. That is, the projection <math alttext="f" class="ltx_Math" display="inline" id="S5.SS1.1.p1.12.m8.1"><semantics id="S5.SS1.1.p1.12.m8.1a"><mi id="S5.SS1.1.p1.12.m8.1.1" xref="S5.SS1.1.p1.12.m8.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.12.m8.1b"><ci id="S5.SS1.1.p1.12.m8.1.1.cmml" xref="S5.SS1.1.p1.12.m8.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.12.m8.1c">f</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.12.m8.1d">italic_f</annotation></semantics></math> produces a member of the equivalence class of <math alttext="r" class="ltx_Math" display="inline" id="S5.SS1.1.p1.13.m9.1"><semantics id="S5.SS1.1.p1.13.m9.1a"><mi id="S5.SS1.1.p1.13.m9.1.1" xref="S5.SS1.1.p1.13.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.1.p1.13.m9.1b"><ci id="S5.SS1.1.p1.13.m9.1.1.cmml" xref="S5.SS1.1.p1.13.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.p1.13.m9.1c">r</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.p1.13.m9.1d">italic_r</annotation></semantics></math> with the desired form, and we do not lose any generality in our reward model from the proposed reparameterization. ∎</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_para" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.4">우리는 대안적으로 Theorem<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#Thmtheorem1" title="Theorem 1. ‣ 5.1 Your Language Model Is Secretly a Reward Model ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">1</span></a>를 DPO 재매개 변수화가 각 동등성 클래스 내에서 정확히 어떤 보상 함수, 즉 만족시키는 보상 함수를 선택하는지를 지정하는 것으로 볼 수 있다:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{y}\underbrace{\pi_{\text{ref}}(y\mid x)\exp\left(\frac{1}{\beta}r(x,y)%
\right)}_{=\pi(y\mid x)\text{, using Thm.~{}\ref{thm:main} reparam.}}=1," class="ltx_Math" display="block" id="S5.E9.m1.7"><semantics id="S5.E9.m1.7a"><mrow id="S5.E9.m1.7.7.1" xref="S5.E9.m1.7.7.1.1.cmml"><mrow id="S5.E9.m1.7.7.1.1" xref="S5.E9.m1.7.7.1.1.cmml"><mrow id="S5.E9.m1.7.7.1.1.2" xref="S5.E9.m1.7.7.1.1.2.cmml"><munder id="S5.E9.m1.7.7.1.1.2.1" xref="S5.E9.m1.7.7.1.1.2.1.cmml"><mo id="S5.E9.m1.7.7.1.1.2.1.2" movablelimits="false" xref="S5.E9.m1.7.7.1.1.2.1.2.cmml">∑</mo><mi id="S5.E9.m1.7.7.1.1.2.1.3" xref="S5.E9.m1.7.7.1.1.2.1.3.cmml">y</mi></munder><munder id="S5.E9.m1.7.7.1.1.2.2" xref="S5.E9.m1.7.7.1.1.2.2.cmml"><munder accentunder="true" id="S5.E9.m1.5.5" xref="S5.E9.m1.5.5.cmml"><mrow id="S5.E9.m1.5.5.5" xref="S5.E9.m1.5.5.5.cmml"><msub id="S5.E9.m1.5.5.5.7" xref="S5.E9.m1.5.5.5.7.cmml"><mi id="S5.E9.m1.5.5.5.7.2" xref="S5.E9.m1.5.5.5.7.2.cmml">π</mi><mtext id="S5.E9.m1.5.5.5.7.3" xref="S5.E9.m1.5.5.5.7.3a.cmml">ref</mtext></msub><mo id="S5.E9.m1.5.5.5.6" xref="S5.E9.m1.5.5.5.6.cmml">⁢</mo><mrow id="S5.E9.m1.4.4.4.4.1" xref="S5.E9.m1.4.4.4.4.1.1.cmml"><mo id="S5.E9.m1.4.4.4.4.1.2" stretchy="false" xref="S5.E9.m1.4.4.4.4.1.1.cmml">(</mo><mrow id="S5.E9.m1.4.4.4.4.1.1" xref="S5.E9.m1.4.4.4.4.1.1.cmml"><mi id="S5.E9.m1.4.4.4.4.1.1.2" xref="S5.E9.m1.4.4.4.4.1.1.2.cmml">y</mi><mo id="S5.E9.m1.4.4.4.4.1.1.1" xref="S5.E9.m1.4.4.4.4.1.1.1.cmml">∣</mo><mi id="S5.E9.m1.4.4.4.4.1.1.3" xref="S5.E9.m1.4.4.4.4.1.1.3.cmml">x</mi></mrow><mo id="S5.E9.m1.4.4.4.4.1.3" stretchy="false" xref="S5.E9.m1.4.4.4.4.1.1.cmml">)</mo></mrow><mo id="S5.E9.m1.5.5.5.6a" lspace="0.167em" xref="S5.E9.m1.5.5.5.6.cmml">⁢</mo><mrow id="S5.E9.m1.5.5.5.5.1" xref="S5.E9.m1.5.5.5.5.2.cmml"><mi id="S5.E9.m1.3.3.3.3" xref="S5.E9.m1.3.3.3.3.cmml">exp</mi><mo id="S5.E9.m1.5.5.5.5.1a" xref="S5.E9.m1.5.5.5.5.2.cmml">⁡</mo><mrow id="S5.E9.m1.5.5.5.5.1.1" xref="S5.E9.m1.5.5.5.5.2.cmml"><mo id="S5.E9.m1.5.5.5.5.1.1.2" xref="S5.E9.m1.5.5.5.5.2.cmml">(</mo><mrow id="S5.E9.m1.5.5.5.5.1.1.1" xref="S5.E9.m1.5.5.5.5.1.1.1.cmml"><mfrac id="S5.E9.m1.5.5.5.5.1.1.1.2" xref="S5.E9.m1.5.5.5.5.1.1.1.2.cmml"><mn id="S5.E9.m1.5.5.5.5.1.1.1.2.2" xref="S5.E9.m1.5.5.5.5.1.1.1.2.2.cmml">1</mn><mi id="S5.E9.m1.5.5.5.5.1.1.1.2.3" xref="S5.E9.m1.5.5.5.5.1.1.1.2.3.cmml">β</mi></mfrac><mo id="S5.E9.m1.5.5.5.5.1.1.1.1" xref="S5.E9.m1.5.5.5.5.1.1.1.1.cmml">⁢</mo><mi id="S5.E9.m1.5.5.5.5.1.1.1.3" xref="S5.E9.m1.5.5.5.5.1.1.1.3.cmml">r</mi><mo id="S5.E9.m1.5.5.5.5.1.1.1.1a" xref="S5.E9.m1.5.5.5.5.1.1.1.1.cmml">⁢</mo><mrow id="S5.E9.m1.5.5.5.5.1.1.1.4.2" xref="S5.E9.m1.5.5.5.5.1.1.1.4.1.cmml"><mo id="S5.E9.m1.5.5.5.5.1.1.1.4.2.1" stretchy="false" xref="S5.E9.m1.5.5.5.5.1.1.1.4.1.cmml">(</mo><mi id="S5.E9.m1.1.1.1.1" xref="S5.E9.m1.1.1.1.1.cmml">x</mi><mo id="S5.E9.m1.5.5.5.5.1.1.1.4.2.2" xref="S5.E9.m1.5.5.5.5.1.1.1.4.1.cmml">,</mo><mi id="S5.E9.m1.2.2.2.2" xref="S5.E9.m1.2.2.2.2.cmml">y</mi><mo id="S5.E9.m1.5.5.5.5.1.1.1.4.2.3" stretchy="false" xref="S5.E9.m1.5.5.5.5.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="S5.E9.m1.5.5.5.5.1.1.3" xref="S5.E9.m1.5.5.5.5.2.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E9.m1.5.5.6" xref="S5.E9.m1.5.5.6.cmml">⏟</mo></munder><mrow id="S5.E9.m1.6.6.1" xref="S5.E9.m1.6.6.1.cmml"><mi id="S5.E9.m1.6.6.1.3" xref="S5.E9.m1.6.6.1.3.cmml"></mi><mo id="S5.E9.m1.6.6.1.2" xref="S5.E9.m1.6.6.1.2.cmml">=</mo><mrow id="S5.E9.m1.6.6.1.1" xref="S5.E9.m1.6.6.1.1.cmml"><mi id="S5.E9.m1.6.6.1.1.3" xref="S5.E9.m1.6.6.1.1.3.cmml">π</mi><mo id="S5.E9.m1.6.6.1.1.2" xref="S5.E9.m1.6.6.1.1.2.cmml">⁢</mo><mrow id="S5.E9.m1.6.6.1.1.1.1" xref="S5.E9.m1.6.6.1.1.1.1.1.cmml"><mo id="S5.E9.m1.6.6.1.1.1.1.2" stretchy="false" xref="S5.E9.m1.6.6.1.1.1.1.1.cmml">(</mo><mrow id="S5.E9.m1.6.6.1.1.1.1.1" xref="S5.E9.m1.6.6.1.1.1.1.1.cmml"><mi id="S5.E9.m1.6.6.1.1.1.1.1.2" xref="S5.E9.m1.6.6.1.1.1.1.1.2.cmml">y</mi><mo id="S5.E9.m1.6.6.1.1.1.1.1.1" xref="S5.E9.m1.6.6.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.E9.m1.6.6.1.1.1.1.1.3" xref="S5.E9.m1.6.6.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.E9.m1.6.6.1.1.1.1.3" stretchy="false" xref="S5.E9.m1.6.6.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.E9.m1.6.6.1.1.2a" xref="S5.E9.m1.6.6.1.1.2.cmml">⁢</mo><mrow id="S5.E9.m1.6.6.1.1.4" xref="S5.E9.m1.6.6.1.1.4f.cmml"><mtext id="S5.E9.m1.6.6.1.1.4a" xref="S5.E9.m1.6.6.1.1.4f.cmml">, using Thm.&nbsp;</mtext><mtext id="S5.E9.m1.6.6.1.1.4b" xref="S5.E9.m1.6.6.1.1.4f.cmml"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#Thmtheorem1" style="font-size:70%;" title="Theorem 1. ‣ 5.1 Your Language Model Is Secretly a Reward Model ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">1</span></a></mtext><mtext id="S5.E9.m1.6.6.1.1.4e" xref="S5.E9.m1.6.6.1.1.4f.cmml">&nbsp;reparam.</mtext></mrow></mrow></mrow></munder></mrow><mo id="S5.E9.m1.7.7.1.1.1" xref="S5.E9.m1.7.7.1.1.1.cmml">=</mo><mn id="S5.E9.m1.7.7.1.1.3" xref="S5.E9.m1.7.7.1.1.3.cmml">1</mn></mrow><mo id="S5.E9.m1.7.7.1.2" xref="S5.E9.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E9.m1.7b"><apply id="S5.E9.m1.7.7.1.1.cmml" xref="S5.E9.m1.7.7.1"><eq id="S5.E9.m1.7.7.1.1.1.cmml" xref="S5.E9.m1.7.7.1.1.1"></eq><apply id="S5.E9.m1.7.7.1.1.2.cmml" xref="S5.E9.m1.7.7.1.1.2"><apply id="S5.E9.m1.7.7.1.1.2.1.cmml" xref="S5.E9.m1.7.7.1.1.2.1"><csymbol cd="ambiguous" id="S5.E9.m1.7.7.1.1.2.1.1.cmml" xref="S5.E9.m1.7.7.1.1.2.1">subscript</csymbol><sum id="S5.E9.m1.7.7.1.1.2.1.2.cmml" xref="S5.E9.m1.7.7.1.1.2.1.2"></sum><ci id="S5.E9.m1.7.7.1.1.2.1.3.cmml" xref="S5.E9.m1.7.7.1.1.2.1.3">𝑦</ci></apply><apply id="S5.E9.m1.7.7.1.1.2.2.cmml" xref="S5.E9.m1.7.7.1.1.2.2"><csymbol cd="ambiguous" id="S5.E9.m1.7.7.1.1.2.2.1.cmml" xref="S5.E9.m1.7.7.1.1.2.2">subscript</csymbol><apply id="S5.E9.m1.5.5.cmml" xref="S5.E9.m1.5.5"><ci id="S5.E9.m1.5.5.6.cmml" xref="S5.E9.m1.5.5.6">⏟</ci><apply id="S5.E9.m1.5.5.5.cmml" xref="S5.E9.m1.5.5.5"><times id="S5.E9.m1.5.5.5.6.cmml" xref="S5.E9.m1.5.5.5.6"></times><apply id="S5.E9.m1.5.5.5.7.cmml" xref="S5.E9.m1.5.5.5.7"><csymbol cd="ambiguous" id="S5.E9.m1.5.5.5.7.1.cmml" xref="S5.E9.m1.5.5.5.7">subscript</csymbol><ci id="S5.E9.m1.5.5.5.7.2.cmml" xref="S5.E9.m1.5.5.5.7.2">𝜋</ci><ci id="S5.E9.m1.5.5.5.7.3a.cmml" xref="S5.E9.m1.5.5.5.7.3"><mtext id="S5.E9.m1.5.5.5.7.3.cmml" mathsize="70%" xref="S5.E9.m1.5.5.5.7.3">ref</mtext></ci></apply><apply id="S5.E9.m1.4.4.4.4.1.1.cmml" xref="S5.E9.m1.4.4.4.4.1"><csymbol cd="latexml" id="S5.E9.m1.4.4.4.4.1.1.1.cmml" xref="S5.E9.m1.4.4.4.4.1.1.1">conditional</csymbol><ci id="S5.E9.m1.4.4.4.4.1.1.2.cmml" xref="S5.E9.m1.4.4.4.4.1.1.2">𝑦</ci><ci id="S5.E9.m1.4.4.4.4.1.1.3.cmml" xref="S5.E9.m1.4.4.4.4.1.1.3">𝑥</ci></apply><apply id="S5.E9.m1.5.5.5.5.2.cmml" xref="S5.E9.m1.5.5.5.5.1"><exp id="S5.E9.m1.3.3.3.3.cmml" xref="S5.E9.m1.3.3.3.3"></exp><apply id="S5.E9.m1.5.5.5.5.1.1.1.cmml" xref="S5.E9.m1.5.5.5.5.1.1.1"><times id="S5.E9.m1.5.5.5.5.1.1.1.1.cmml" xref="S5.E9.m1.5.5.5.5.1.1.1.1"></times><apply id="S5.E9.m1.5.5.5.5.1.1.1.2.cmml" xref="S5.E9.m1.5.5.5.5.1.1.1.2"><divide id="S5.E9.m1.5.5.5.5.1.1.1.2.1.cmml" xref="S5.E9.m1.5.5.5.5.1.1.1.2"></divide><cn id="S5.E9.m1.5.5.5.5.1.1.1.2.2.cmml" type="integer" xref="S5.E9.m1.5.5.5.5.1.1.1.2.2">1</cn><ci id="S5.E9.m1.5.5.5.5.1.1.1.2.3.cmml" xref="S5.E9.m1.5.5.5.5.1.1.1.2.3">𝛽</ci></apply><ci id="S5.E9.m1.5.5.5.5.1.1.1.3.cmml" xref="S5.E9.m1.5.5.5.5.1.1.1.3">𝑟</ci><interval closure="open" id="S5.E9.m1.5.5.5.5.1.1.1.4.1.cmml" xref="S5.E9.m1.5.5.5.5.1.1.1.4.2"><ci id="S5.E9.m1.1.1.1.1.cmml" xref="S5.E9.m1.1.1.1.1">𝑥</ci><ci id="S5.E9.m1.2.2.2.2.cmml" xref="S5.E9.m1.2.2.2.2">𝑦</ci></interval></apply></apply></apply></apply><apply id="S5.E9.m1.6.6.1.cmml" xref="S5.E9.m1.6.6.1"><eq id="S5.E9.m1.6.6.1.2.cmml" xref="S5.E9.m1.6.6.1.2"></eq><csymbol cd="latexml" id="S5.E9.m1.6.6.1.3.cmml" xref="S5.E9.m1.6.6.1.3">absent</csymbol><apply id="S5.E9.m1.6.6.1.1.cmml" xref="S5.E9.m1.6.6.1.1"><times id="S5.E9.m1.6.6.1.1.2.cmml" xref="S5.E9.m1.6.6.1.1.2"></times><ci id="S5.E9.m1.6.6.1.1.3.cmml" xref="S5.E9.m1.6.6.1.1.3">𝜋</ci><apply id="S5.E9.m1.6.6.1.1.1.1.1.cmml" xref="S5.E9.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S5.E9.m1.6.6.1.1.1.1.1.1.cmml" xref="S5.E9.m1.6.6.1.1.1.1.1.1">conditional</csymbol><ci id="S5.E9.m1.6.6.1.1.1.1.1.2.cmml" xref="S5.E9.m1.6.6.1.1.1.1.1.2">𝑦</ci><ci id="S5.E9.m1.6.6.1.1.1.1.1.3.cmml" xref="S5.E9.m1.6.6.1.1.1.1.1.3">𝑥</ci></apply><ci id="S5.E9.m1.6.6.1.1.4f.cmml" xref="S5.E9.m1.6.6.1.1.4"><mrow id="S5.E9.m1.6.6.1.1.4.cmml" xref="S5.E9.m1.6.6.1.1.4"><mtext id="S5.E9.m1.6.6.1.1.4a.cmml" mathsize="70%" xref="S5.E9.m1.6.6.1.1.4">, using Thm.&nbsp;</mtext><mtext id="S5.E9.m1.6.6.1.1.4b.cmml" mathsize="70%" xref="S5.E9.m1.6.6.1.1.4"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#Thmtheorem1" style="font-size:70%;" title="Theorem 1. ‣ 5.1 Your Language Model Is Secretly a Reward Model ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">1</span></a></mtext><mtext id="S5.E9.m1.6.6.1.1.4e.cmml" mathsize="70%" xref="S5.E9.m1.6.6.1.1.4">&nbsp;reparam.</mtext></mrow></ci></apply></apply></apply></apply><cn id="S5.E9.m1.7.7.1.1.3.cmml" type="integer" xref="S5.E9.m1.7.7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E9.m1.7c">\sum_{y}\underbrace{\pi_{\text{ref}}(y\mid x)\exp\left(\frac{1}{\beta}r(x,y)%
\right)}_{=\pi(y\mid x)\text{, using Thm.~{}\ref{thm:main} reparam.}}=1,</annotation><annotation encoding="application/x-llamapun" id="S5.E9.m1.7d">∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT under⏟ start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) ) end_ARG start_POSTSUBSCRIPT = italic_π ( italic_y ∣ italic_x ) , using Thm. reparam. end_POSTSUBSCRIPT = 1 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS1.p4.3">즉, <math alttext="\pi(y\mid x)" class="ltx_Math" display="inline" id="S5.SS1.p4.1.m1.1"><semantics id="S5.SS1.p4.1.m1.1a"><mrow id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml"><mi id="S5.SS1.p4.1.m1.1.1.3" xref="S5.SS1.p4.1.m1.1.1.3.cmml">π</mi><mo id="S5.SS1.p4.1.m1.1.1.2" xref="S5.SS1.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S5.SS1.p4.1.m1.1.1.1.1" xref="S5.SS1.p4.1.m1.1.1.1.1.1.cmml"><mo id="S5.SS1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S5.SS1.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.p4.1.m1.1.1.1.1.1" xref="S5.SS1.p4.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS1.p4.1.m1.1.1.1.1.1.2" xref="S5.SS1.p4.1.m1.1.1.1.1.1.2.cmml">y</mi><mo id="S5.SS1.p4.1.m1.1.1.1.1.1.1" xref="S5.SS1.p4.1.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.SS1.p4.1.m1.1.1.1.1.1.3" xref="S5.SS1.p4.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S5.SS1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><apply id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1"><times id="S5.SS1.p4.1.m1.1.1.2.cmml" xref="S5.SS1.p4.1.m1.1.1.2"></times><ci id="S5.SS1.p4.1.m1.1.1.3.cmml" xref="S5.SS1.p4.1.m1.1.1.3">𝜋</ci><apply id="S5.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1.1.1"><csymbol cd="latexml" id="S5.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS1.p4.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S5.SS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS1.p4.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">\pi(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.1.m1.1d">italic_π ( italic_y ∣ italic_x )</annotation></semantics></math>는 유효한 분포(확률은 양수이고 합은 1)이다. 그러나 식은 다음과 같다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E4" title="4 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>, 우리는 Eq. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S5.E9" title="9 ‣ 5.1 Your Language Model Is Secretly a Reward Model ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">9</span></a>는 보상 함수 <math alttext="r(x,y)" class="ltx_Math" display="inline" id="S5.SS1.p4.2.m2.2"><semantics id="S5.SS1.p4.2.m2.2a"><mrow id="S5.SS1.p4.2.m2.2.3" xref="S5.SS1.p4.2.m2.2.3.cmml"><mi id="S5.SS1.p4.2.m2.2.3.2" xref="S5.SS1.p4.2.m2.2.3.2.cmml">r</mi><mo id="S5.SS1.p4.2.m2.2.3.1" xref="S5.SS1.p4.2.m2.2.3.1.cmml">⁢</mo><mrow id="S5.SS1.p4.2.m2.2.3.3.2" xref="S5.SS1.p4.2.m2.2.3.3.1.cmml"><mo id="S5.SS1.p4.2.m2.2.3.3.2.1" stretchy="false" xref="S5.SS1.p4.2.m2.2.3.3.1.cmml">(</mo><mi id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml">x</mi><mo id="S5.SS1.p4.2.m2.2.3.3.2.2" xref="S5.SS1.p4.2.m2.2.3.3.1.cmml">,</mo><mi id="S5.SS1.p4.2.m2.2.2" xref="S5.SS1.p4.2.m2.2.2.cmml">y</mi><mo id="S5.SS1.p4.2.m2.2.3.3.2.3" stretchy="false" xref="S5.SS1.p4.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.2b"><apply id="S5.SS1.p4.2.m2.2.3.cmml" xref="S5.SS1.p4.2.m2.2.3"><times id="S5.SS1.p4.2.m2.2.3.1.cmml" xref="S5.SS1.p4.2.m2.2.3.1"></times><ci id="S5.SS1.p4.2.m2.2.3.2.cmml" xref="S5.SS1.p4.2.m2.2.3.2">𝑟</ci><interval closure="open" id="S5.SS1.p4.2.m2.2.3.3.1.cmml" xref="S5.SS1.p4.2.m2.2.3.3.2"><ci id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1">𝑥</ci><ci id="S5.SS1.p4.2.m2.2.2.cmml" xref="S5.SS1.p4.2.m2.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.2.m2.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math>에 의해 유도된 최적 정책의 분할 함수이다. DPO 알고리즘의 핵심 통찰은 표현 가능한 보상 모델의 클래스를 보존하지만 Eq에서 최적의 정책을 명시적으로 만들기 위해 과소 제약된 Plackett-Luce(및 특히 Bradley-Terry) 선호 모델 패밀리에 특정 제약을 가할 수 있다는 것이다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E4" title="4 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a> 모든 프롬프트에 대해 분석적으로 다루기 쉬운 <math alttext="x" class="ltx_Math" display="inline" id="S5.SS1.p4.3.m3.1"><semantics id="S5.SS1.p4.3.m3.1a"><mi id="S5.SS1.p4.3.m3.1.1" xref="S5.SS1.p4.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.3.m3.1b"><ci id="S5.SS1.p4.3.m3.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.3.m3.1d">italic_x</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Instability of Actor-Critic Algorithms</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.4">또한 프레임워크를 사용하여 PPO와 같은 RLHF에 사용되는 표준 액터-크리틱 알고리즘으로 불안정성을 진단할 수 있다. RLHF 파이프라인을 따르고 섹션 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3" title="3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">3</span></a>에 설명된 RL 미세 조정 단계에 중점을 둔다. 우리는 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3.E3" title="3 ‣ 3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">3</span></a>에 요약된 제약된 RL 문제에 대해 추론 프레임워크 <cite class="ltx_cite ltx_citemacro_cite">Levine (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib20" title="">2018</a>)</cite>로 컨트롤에 대한 연결을 그릴 수 있다. 매개 변수화된 모델 <math alttext="\pi_{\theta}(y\mid x)" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><msub id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml"><mi id="S5.SS2.p1.1.m1.1.1.3.2" xref="S5.SS2.p1.1.m1.1.1.3.2.cmml">π</mi><mi id="S5.SS2.p1.1.m1.1.1.3.3" xref="S5.SS2.p1.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S5.SS2.p1.1.m1.1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S5.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S5.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS2.p1.1.m1.1.1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.1.1.1.2.cmml">y</mi><mo id="S5.SS2.p1.1.m1.1.1.1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.SS2.p1.1.m1.1.1.1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S5.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><times id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2"></times><apply id="S5.SS2.p1.1.m1.1.1.3.cmml" xref="S5.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p1.1.m1.1.1.3.1.cmml" xref="S5.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S5.SS2.p1.1.m1.1.1.3.2.cmml" xref="S5.SS2.p1.1.m1.1.1.3.2">𝜋</ci><ci id="S5.SS2.p1.1.m1.1.1.3.3.cmml" xref="S5.SS2.p1.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S5.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S5.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S5.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS2.p1.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\pi_{\theta}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math>를 가정하고, <math alttext="\mathbb{D}_{\text{KL}}[\pi_{\theta}(y|x)\mid\mid\pi^{*}(y\mid x)]" class="ltx_math_unparsed" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mrow id="S5.SS2.p1.2.m2.1b"><msub id="S5.SS2.p1.2.m2.1.1"><mi id="S5.SS2.p1.2.m2.1.1.2">𝔻</mi><mtext id="S5.SS2.p1.2.m2.1.1.3">KL</mtext></msub><mrow id="S5.SS2.p1.2.m2.1.2"><mo id="S5.SS2.p1.2.m2.1.2.1" stretchy="false">[</mo><msub id="S5.SS2.p1.2.m2.1.2.2"><mi id="S5.SS2.p1.2.m2.1.2.2.2">π</mi><mi id="S5.SS2.p1.2.m2.1.2.2.3">θ</mi></msub><mrow id="S5.SS2.p1.2.m2.1.2.3"><mo id="S5.SS2.p1.2.m2.1.2.3.1" stretchy="false">(</mo><mi id="S5.SS2.p1.2.m2.1.2.3.2">y</mi><mo fence="false" id="S5.SS2.p1.2.m2.1.2.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S5.SS2.p1.2.m2.1.2.3.4">x</mi><mo id="S5.SS2.p1.2.m2.1.2.3.5" stretchy="false">)</mo></mrow><mo id="S5.SS2.p1.2.m2.1.2.4" lspace="0em" rspace="0.0835em">∣</mo><mo id="S5.SS2.p1.2.m2.1.2.5" lspace="0.0835em" rspace="0.167em">∣</mo><msup id="S5.SS2.p1.2.m2.1.2.6"><mi id="S5.SS2.p1.2.m2.1.2.6.2">π</mi><mo id="S5.SS2.p1.2.m2.1.2.6.3">*</mo></msup><mrow id="S5.SS2.p1.2.m2.1.2.7"><mo id="S5.SS2.p1.2.m2.1.2.7.1" stretchy="false">(</mo><mi id="S5.SS2.p1.2.m2.1.2.7.2">y</mi><mo id="S5.SS2.p1.2.m2.1.2.7.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S5.SS2.p1.2.m2.1.2.7.4">x</mi><mo id="S5.SS2.p1.2.m2.1.2.7.5" stretchy="false">)</mo></mrow><mo id="S5.SS2.p1.2.m2.1.2.8" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\mathbb{D}_{\text{KL}}[\pi_{\theta}(y|x)\mid\mid\pi^{*}(y\mid x)]</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">blackboard_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT [ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y | italic_x ) ∣ ∣ italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y ∣ italic_x ) ]</annotation></semantics></math>를 최소화하며, 여기서 <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><msup id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mi id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">π</mi><mo id="S5.SS2.p1.3.m3.1.1.3" xref="S5.SS2.p1.3.m3.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S5.SS2.p1.3.m3.1.1.2.cmml" xref="S5.SS2.p1.3.m3.1.1.2">𝜋</ci><times id="S5.SS2.p1.3.m3.1.1.3.cmml" xref="S5.SS2.p1.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>는 Eq로부터의 최적 정책이다. 보상 함수 <math alttext="r_{\phi}(y,x)" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.2"><semantics id="S5.SS2.p1.4.m4.2a"><mrow id="S5.SS2.p1.4.m4.2.3" xref="S5.SS2.p1.4.m4.2.3.cmml"><msub id="S5.SS2.p1.4.m4.2.3.2" xref="S5.SS2.p1.4.m4.2.3.2.cmml"><mi id="S5.SS2.p1.4.m4.2.3.2.2" xref="S5.SS2.p1.4.m4.2.3.2.2.cmml">r</mi><mi id="S5.SS2.p1.4.m4.2.3.2.3" xref="S5.SS2.p1.4.m4.2.3.2.3.cmml">ϕ</mi></msub><mo id="S5.SS2.p1.4.m4.2.3.1" xref="S5.SS2.p1.4.m4.2.3.1.cmml">⁢</mo><mrow id="S5.SS2.p1.4.m4.2.3.3.2" xref="S5.SS2.p1.4.m4.2.3.3.1.cmml"><mo id="S5.SS2.p1.4.m4.2.3.3.2.1" stretchy="false" xref="S5.SS2.p1.4.m4.2.3.3.1.cmml">(</mo><mi id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml">y</mi><mo id="S5.SS2.p1.4.m4.2.3.3.2.2" xref="S5.SS2.p1.4.m4.2.3.3.1.cmml">,</mo><mi id="S5.SS2.p1.4.m4.2.2" xref="S5.SS2.p1.4.m4.2.2.cmml">x</mi><mo id="S5.SS2.p1.4.m4.2.3.3.2.3" stretchy="false" xref="S5.SS2.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.2b"><apply id="S5.SS2.p1.4.m4.2.3.cmml" xref="S5.SS2.p1.4.m4.2.3"><times id="S5.SS2.p1.4.m4.2.3.1.cmml" xref="S5.SS2.p1.4.m4.2.3.1"></times><apply id="S5.SS2.p1.4.m4.2.3.2.cmml" xref="S5.SS2.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.2.3.2.1.cmml" xref="S5.SS2.p1.4.m4.2.3.2">subscript</csymbol><ci id="S5.SS2.p1.4.m4.2.3.2.2.cmml" xref="S5.SS2.p1.4.m4.2.3.2.2">𝑟</ci><ci id="S5.SS2.p1.4.m4.2.3.2.3.cmml" xref="S5.SS2.p1.4.m4.2.3.2.3">italic-ϕ</ci></apply><interval closure="open" id="S5.SS2.p1.4.m4.2.3.3.1.cmml" xref="S5.SS2.p1.4.m4.2.3.3.2"><ci id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">𝑦</ci><ci id="S5.SS2.p1.4.m4.2.2.cmml" xref="S5.SS2.p1.4.m4.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.2c">r_{\phi}(y,x)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.4.m4.2d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y , italic_x )</annotation></semantics></math>에 의해 유도된 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E7" title="7 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">7</span></a>. 몇 가지 대수를 사용하면 최적화 목표를 달성할 수 있습니다.</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\pi_{\theta}}\mathbb{E}_{\pi_{\theta}(y\mid x)}\bigg{[}\underbrace{r_{%
\phi}(x,y)-\beta\log\sum_{y}\pi_{\text{ref}}(y\mid x)\exp\left(\frac{1}{\beta}%
r_{\phi}(x,y)\right)}_{f(r_{\phi},\pi_{\text{ref}},\beta)}-\underbrace{\beta%
\log\frac{\pi_{\theta}(y\mid x)}{\pi_{\text{ref}}(y\mid x)}}_{\text{KL}}\bigg{]}" class="ltx_Math" display="block" id="S5.E10.m1.14"><semantics id="S5.E10.m1.14a"><mrow id="S5.E10.m1.14.14" xref="S5.E10.m1.14.14.cmml"><mrow id="S5.E10.m1.14.14.3" xref="S5.E10.m1.14.14.3.cmml"><munder id="S5.E10.m1.14.14.3.1" xref="S5.E10.m1.14.14.3.1.cmml"><mi id="S5.E10.m1.14.14.3.1.2" xref="S5.E10.m1.14.14.3.1.2.cmml">max</mi><msub id="S5.E10.m1.14.14.3.1.3" xref="S5.E10.m1.14.14.3.1.3.cmml"><mi id="S5.E10.m1.14.14.3.1.3.2" xref="S5.E10.m1.14.14.3.1.3.2.cmml">π</mi><mi id="S5.E10.m1.14.14.3.1.3.3" xref="S5.E10.m1.14.14.3.1.3.3.cmml">θ</mi></msub></munder><mo id="S5.E10.m1.14.14.3a" lspace="0.167em" xref="S5.E10.m1.14.14.3.cmml">⁡</mo><msub id="S5.E10.m1.14.14.3.2" xref="S5.E10.m1.14.14.3.2.cmml"><mi id="S5.E10.m1.14.14.3.2.2" xref="S5.E10.m1.14.14.3.2.2.cmml">𝔼</mi><mrow id="S5.E10.m1.1.1.1" xref="S5.E10.m1.1.1.1.cmml"><msub id="S5.E10.m1.1.1.1.3" xref="S5.E10.m1.1.1.1.3.cmml"><mi id="S5.E10.m1.1.1.1.3.2" xref="S5.E10.m1.1.1.1.3.2.cmml">π</mi><mi id="S5.E10.m1.1.1.1.3.3" xref="S5.E10.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.E10.m1.1.1.1.2" xref="S5.E10.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E10.m1.1.1.1.1.1" xref="S5.E10.m1.1.1.1.1.1.1.cmml"><mo id="S5.E10.m1.1.1.1.1.1.2" stretchy="false" xref="S5.E10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E10.m1.1.1.1.1.1.1" xref="S5.E10.m1.1.1.1.1.1.1.cmml"><mi id="S5.E10.m1.1.1.1.1.1.1.2" xref="S5.E10.m1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S5.E10.m1.1.1.1.1.1.1.1" xref="S5.E10.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.E10.m1.1.1.1.1.1.1.3" xref="S5.E10.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.E10.m1.1.1.1.1.1.3" stretchy="false" xref="S5.E10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mo id="S5.E10.m1.14.14.2" xref="S5.E10.m1.14.14.2.cmml">⁢</mo><mrow id="S5.E10.m1.14.14.1.1" xref="S5.E10.m1.14.14.1.2.cmml"><mo id="S5.E10.m1.14.14.1.1.2" maxsize="210%" minsize="210%" xref="S5.E10.m1.14.14.1.2.1.cmml">[</mo><mrow id="S5.E10.m1.14.14.1.1.1" xref="S5.E10.m1.14.14.1.1.1.cmml"><munder id="S5.E10.m1.14.14.1.1.1.2" xref="S5.E10.m1.14.14.1.1.1.2.cmml"><munder accentunder="true" id="S5.E10.m1.8.8" xref="S5.E10.m1.8.8.cmml"><mrow id="S5.E10.m1.8.8.7" xref="S5.E10.m1.8.8.7.cmml"><mrow id="S5.E10.m1.8.8.7.9" xref="S5.E10.m1.8.8.7.9.cmml"><msub id="S5.E10.m1.8.8.7.9.2" xref="S5.E10.m1.8.8.7.9.2.cmml"><mi id="S5.E10.m1.8.8.7.9.2.2" xref="S5.E10.m1.8.8.7.9.2.2.cmml">r</mi><mi id="S5.E10.m1.8.8.7.9.2.3" xref="S5.E10.m1.8.8.7.9.2.3.cmml">ϕ</mi></msub><mo id="S5.E10.m1.8.8.7.9.1" xref="S5.E10.m1.8.8.7.9.1.cmml">⁢</mo><mrow id="S5.E10.m1.8.8.7.9.3.2" xref="S5.E10.m1.8.8.7.9.3.1.cmml"><mo id="S5.E10.m1.8.8.7.9.3.2.1" stretchy="false" xref="S5.E10.m1.8.8.7.9.3.1.cmml">(</mo><mi id="S5.E10.m1.2.2.1.1" xref="S5.E10.m1.2.2.1.1.cmml">x</mi><mo id="S5.E10.m1.8.8.7.9.3.2.2" xref="S5.E10.m1.8.8.7.9.3.1.cmml">,</mo><mi id="S5.E10.m1.3.3.2.2" xref="S5.E10.m1.3.3.2.2.cmml">y</mi><mo id="S5.E10.m1.8.8.7.9.3.2.3" stretchy="false" xref="S5.E10.m1.8.8.7.9.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E10.m1.8.8.7.8" xref="S5.E10.m1.8.8.7.8.cmml">−</mo><mrow id="S5.E10.m1.8.8.7.7" xref="S5.E10.m1.8.8.7.7.cmml"><mi id="S5.E10.m1.8.8.7.7.4" xref="S5.E10.m1.8.8.7.7.4.cmml">β</mi><mo id="S5.E10.m1.8.8.7.7.3" lspace="0.167em" xref="S5.E10.m1.8.8.7.7.3.cmml">⁢</mo><mi id="S5.E10.m1.8.8.7.7.5" xref="S5.E10.m1.8.8.7.7.5.cmml">log</mi><mo id="S5.E10.m1.8.8.7.7.3a" xref="S5.E10.m1.8.8.7.7.3.cmml">⁢</mo><mrow id="S5.E10.m1.8.8.7.7.2" xref="S5.E10.m1.8.8.7.7.2.cmml"><munder id="S5.E10.m1.8.8.7.7.2.3" xref="S5.E10.m1.8.8.7.7.2.3.cmml"><mo id="S5.E10.m1.8.8.7.7.2.3.2" movablelimits="false" xref="S5.E10.m1.8.8.7.7.2.3.2.cmml">∑</mo><mi id="S5.E10.m1.8.8.7.7.2.3.3" xref="S5.E10.m1.8.8.7.7.2.3.3.cmml">y</mi></munder><mrow id="S5.E10.m1.8.8.7.7.2.2" xref="S5.E10.m1.8.8.7.7.2.2.cmml"><msub id="S5.E10.m1.8.8.7.7.2.2.4" xref="S5.E10.m1.8.8.7.7.2.2.4.cmml"><mi id="S5.E10.m1.8.8.7.7.2.2.4.2" xref="S5.E10.m1.8.8.7.7.2.2.4.2.cmml">π</mi><mtext id="S5.E10.m1.8.8.7.7.2.2.4.3" xref="S5.E10.m1.8.8.7.7.2.2.4.3a.cmml">ref</mtext></msub><mo id="S5.E10.m1.8.8.7.7.2.2.3" xref="S5.E10.m1.8.8.7.7.2.2.3.cmml">⁢</mo><mrow id="S5.E10.m1.7.7.6.6.1.1.1.1" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.cmml"><mo id="S5.E10.m1.7.7.6.6.1.1.1.1.2" stretchy="false" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.cmml">(</mo><mrow id="S5.E10.m1.7.7.6.6.1.1.1.1.1" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.cmml"><mi id="S5.E10.m1.7.7.6.6.1.1.1.1.1.2" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.2.cmml">y</mi><mo id="S5.E10.m1.7.7.6.6.1.1.1.1.1.1" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.E10.m1.7.7.6.6.1.1.1.1.1.3" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.E10.m1.7.7.6.6.1.1.1.1.3" stretchy="false" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.E10.m1.8.8.7.7.2.2.3a" lspace="0.167em" xref="S5.E10.m1.8.8.7.7.2.2.3.cmml">⁢</mo><mrow id="S5.E10.m1.8.8.7.7.2.2.2.1" xref="S5.E10.m1.8.8.7.7.2.2.2.2.cmml"><mi id="S5.E10.m1.6.6.5.5" xref="S5.E10.m1.6.6.5.5.cmml">exp</mi><mo id="S5.E10.m1.8.8.7.7.2.2.2.1a" xref="S5.E10.m1.8.8.7.7.2.2.2.2.cmml">⁡</mo><mrow id="S5.E10.m1.8.8.7.7.2.2.2.1.1" xref="S5.E10.m1.8.8.7.7.2.2.2.2.cmml"><mo id="S5.E10.m1.8.8.7.7.2.2.2.1.1.2" xref="S5.E10.m1.8.8.7.7.2.2.2.2.cmml">(</mo><mrow id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.cmml"><mfrac id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.cmml"><mn id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.2" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.2.cmml">1</mn><mi id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.3" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.1" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.cmml"><mi id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.2" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.2.cmml">r</mi><mi id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.3" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.1a" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.2" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.1.cmml"><mo id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.2.1" stretchy="false" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.1.cmml">(</mo><mi id="S5.E10.m1.4.4.3.3" xref="S5.E10.m1.4.4.3.3.cmml">x</mi><mo id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.2.2" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.1.cmml">,</mo><mi id="S5.E10.m1.5.5.4.4" xref="S5.E10.m1.5.5.4.4.cmml">y</mi><mo id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.2.3" stretchy="false" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="S5.E10.m1.8.8.7.7.2.2.2.1.1.3" xref="S5.E10.m1.8.8.7.7.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S5.E10.m1.8.8.8" xref="S5.E10.m1.8.8.8.cmml">⏟</mo></munder><mrow id="S5.E10.m1.11.11.3" xref="S5.E10.m1.11.11.3.cmml"><mi id="S5.E10.m1.11.11.3.5" xref="S5.E10.m1.11.11.3.5.cmml">f</mi><mo id="S5.E10.m1.11.11.3.4" xref="S5.E10.m1.11.11.3.4.cmml">⁢</mo><mrow id="S5.E10.m1.11.11.3.3.2" xref="S5.E10.m1.11.11.3.3.3.cmml"><mo id="S5.E10.m1.11.11.3.3.2.3" stretchy="false" xref="S5.E10.m1.11.11.3.3.3.cmml">(</mo><msub id="S5.E10.m1.10.10.2.2.1.1" xref="S5.E10.m1.10.10.2.2.1.1.cmml"><mi id="S5.E10.m1.10.10.2.2.1.1.2" xref="S5.E10.m1.10.10.2.2.1.1.2.cmml">r</mi><mi id="S5.E10.m1.10.10.2.2.1.1.3" xref="S5.E10.m1.10.10.2.2.1.1.3.cmml">ϕ</mi></msub><mo id="S5.E10.m1.11.11.3.3.2.4" xref="S5.E10.m1.11.11.3.3.3.cmml">,</mo><msub id="S5.E10.m1.11.11.3.3.2.2" xref="S5.E10.m1.11.11.3.3.2.2.cmml"><mi id="S5.E10.m1.11.11.3.3.2.2.2" xref="S5.E10.m1.11.11.3.3.2.2.2.cmml">π</mi><mtext id="S5.E10.m1.11.11.3.3.2.2.3" xref="S5.E10.m1.11.11.3.3.2.2.3a.cmml">ref</mtext></msub><mo id="S5.E10.m1.11.11.3.3.2.5" xref="S5.E10.m1.11.11.3.3.3.cmml">,</mo><mi id="S5.E10.m1.9.9.1.1" xref="S5.E10.m1.9.9.1.1.cmml">β</mi><mo id="S5.E10.m1.11.11.3.3.2.6" stretchy="false" xref="S5.E10.m1.11.11.3.3.3.cmml">)</mo></mrow></mrow></munder><mo id="S5.E10.m1.14.14.1.1.1.1" xref="S5.E10.m1.14.14.1.1.1.1.cmml">−</mo><munder id="S5.E10.m1.14.14.1.1.1.3" xref="S5.E10.m1.14.14.1.1.1.3.cmml"><munder accentunder="true" id="S5.E10.m1.13.13" xref="S5.E10.m1.13.13.cmml"><mrow id="S5.E10.m1.13.13.2" xref="S5.E10.m1.13.13.2.cmml"><mi id="S5.E10.m1.13.13.2.4" xref="S5.E10.m1.13.13.2.4.cmml">β</mi><mo id="S5.E10.m1.13.13.2.3" lspace="0.167em" xref="S5.E10.m1.13.13.2.3.cmml">⁢</mo><mrow id="S5.E10.m1.13.13.2.5" xref="S5.E10.m1.13.13.2.5.cmml"><mi id="S5.E10.m1.13.13.2.5.1" xref="S5.E10.m1.13.13.2.5.1.cmml">log</mi><mo id="S5.E10.m1.13.13.2.5a" lspace="0.167em" xref="S5.E10.m1.13.13.2.5.cmml">⁡</mo><mfrac id="S5.E10.m1.13.13.2.2" xref="S5.E10.m1.13.13.2.2.cmml"><mrow id="S5.E10.m1.12.12.1.1.1" xref="S5.E10.m1.12.12.1.1.1.cmml"><msub id="S5.E10.m1.12.12.1.1.1.3" xref="S5.E10.m1.12.12.1.1.1.3.cmml"><mi id="S5.E10.m1.12.12.1.1.1.3.2" xref="S5.E10.m1.12.12.1.1.1.3.2.cmml">π</mi><mi id="S5.E10.m1.12.12.1.1.1.3.3" xref="S5.E10.m1.12.12.1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.E10.m1.12.12.1.1.1.2" xref="S5.E10.m1.12.12.1.1.1.2.cmml">⁢</mo><mrow id="S5.E10.m1.12.12.1.1.1.1.1" xref="S5.E10.m1.12.12.1.1.1.1.1.1.cmml"><mo id="S5.E10.m1.12.12.1.1.1.1.1.2" stretchy="false" xref="S5.E10.m1.12.12.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E10.m1.12.12.1.1.1.1.1.1" xref="S5.E10.m1.12.12.1.1.1.1.1.1.cmml"><mi id="S5.E10.m1.12.12.1.1.1.1.1.1.2" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2.cmml">y</mi><mo id="S5.E10.m1.12.12.1.1.1.1.1.1.1" xref="S5.E10.m1.12.12.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S5.E10.m1.12.12.1.1.1.1.1.1.3" xref="S5.E10.m1.12.12.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S5.E10.m1.12.12.1.1.1.1.1.3" stretchy="false" xref="S5.E10.m1.12.12.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.E10.m1.13.13.2.2.2" xref="S5.E10.m1.13.13.2.2.2.cmml"><msub id="S5.E10.m1.13.13.2.2.2.3" xref="S5.E10.m1.13.13.2.2.2.3.cmml"><mi id="S5.E10.m1.13.13.2.2.2.3.2" xref="S5.E10.m1.13.13.2.2.2.3.2.cmml">π</mi><mtext id="S5.E10.m1.13.13.2.2.2.3.3" xref="S5.E10.m1.13.13.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="S5.E10.m1.13.13.2.2.2.2" xref="S5.E10.m1.13.13.2.2.2.2.cmml">⁢</mo><mrow id="S5.E10.m1.13.13.2.2.2.1.1" xref="S5.E10.m1.13.13.2.2.2.1.1.1.cmml"><mo id="S5.E10.m1.13.13.2.2.2.1.1.2" stretchy="false" xref="S5.E10.m1.13.13.2.2.2.1.1.1.cmml">(</mo><mrow id="S5.E10.m1.13.13.2.2.2.1.1.1" xref="S5.E10.m1.13.13.2.2.2.1.1.1.cmml"><mi id="S5.E10.m1.13.13.2.2.2.1.1.1.2" xref="S5.E10.m1.13.13.2.2.2.1.1.1.2.cmml">y</mi><mo id="S5.E10.m1.13.13.2.2.2.1.1.1.1" xref="S5.E10.m1.13.13.2.2.2.1.1.1.1.cmml">∣</mo><mi id="S5.E10.m1.13.13.2.2.2.1.1.1.3" xref="S5.E10.m1.13.13.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S5.E10.m1.13.13.2.2.2.1.1.3" stretchy="false" xref="S5.E10.m1.13.13.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S5.E10.m1.13.13.3" xref="S5.E10.m1.13.13.3.cmml">⏟</mo></munder><mtext id="S5.E10.m1.14.14.1.1.1.3.2" xref="S5.E10.m1.14.14.1.1.1.3.2a.cmml">KL</mtext></munder></mrow><mo id="S5.E10.m1.14.14.1.1.3" maxsize="210%" minsize="210%" xref="S5.E10.m1.14.14.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E10.m1.14b"><apply id="S5.E10.m1.14.14.cmml" xref="S5.E10.m1.14.14"><times id="S5.E10.m1.14.14.2.cmml" xref="S5.E10.m1.14.14.2"></times><apply id="S5.E10.m1.14.14.3.cmml" xref="S5.E10.m1.14.14.3"><apply id="S5.E10.m1.14.14.3.1.cmml" xref="S5.E10.m1.14.14.3.1"><csymbol cd="ambiguous" id="S5.E10.m1.14.14.3.1.1.cmml" xref="S5.E10.m1.14.14.3.1">subscript</csymbol><max id="S5.E10.m1.14.14.3.1.2.cmml" xref="S5.E10.m1.14.14.3.1.2"></max><apply id="S5.E10.m1.14.14.3.1.3.cmml" xref="S5.E10.m1.14.14.3.1.3"><csymbol cd="ambiguous" id="S5.E10.m1.14.14.3.1.3.1.cmml" xref="S5.E10.m1.14.14.3.1.3">subscript</csymbol><ci id="S5.E10.m1.14.14.3.1.3.2.cmml" xref="S5.E10.m1.14.14.3.1.3.2">𝜋</ci><ci id="S5.E10.m1.14.14.3.1.3.3.cmml" xref="S5.E10.m1.14.14.3.1.3.3">𝜃</ci></apply></apply><apply id="S5.E10.m1.14.14.3.2.cmml" xref="S5.E10.m1.14.14.3.2"><csymbol cd="ambiguous" id="S5.E10.m1.14.14.3.2.1.cmml" xref="S5.E10.m1.14.14.3.2">subscript</csymbol><ci id="S5.E10.m1.14.14.3.2.2.cmml" xref="S5.E10.m1.14.14.3.2.2">𝔼</ci><apply id="S5.E10.m1.1.1.1.cmml" xref="S5.E10.m1.1.1.1"><times id="S5.E10.m1.1.1.1.2.cmml" xref="S5.E10.m1.1.1.1.2"></times><apply id="S5.E10.m1.1.1.1.3.cmml" xref="S5.E10.m1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E10.m1.1.1.1.3.1.cmml" xref="S5.E10.m1.1.1.1.3">subscript</csymbol><ci id="S5.E10.m1.1.1.1.3.2.cmml" xref="S5.E10.m1.1.1.1.3.2">𝜋</ci><ci id="S5.E10.m1.1.1.1.3.3.cmml" xref="S5.E10.m1.1.1.1.3.3">𝜃</ci></apply><apply id="S5.E10.m1.1.1.1.1.1.1.cmml" xref="S5.E10.m1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E10.m1.1.1.1.1.1.1.1.cmml" xref="S5.E10.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.E10.m1.1.1.1.1.1.1.2.cmml" xref="S5.E10.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S5.E10.m1.1.1.1.1.1.1.3.cmml" xref="S5.E10.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply><apply id="S5.E10.m1.14.14.1.2.cmml" xref="S5.E10.m1.14.14.1.1"><csymbol cd="latexml" id="S5.E10.m1.14.14.1.2.1.cmml" xref="S5.E10.m1.14.14.1.1.2">delimited-[]</csymbol><apply id="S5.E10.m1.14.14.1.1.1.cmml" xref="S5.E10.m1.14.14.1.1.1"><minus id="S5.E10.m1.14.14.1.1.1.1.cmml" xref="S5.E10.m1.14.14.1.1.1.1"></minus><apply id="S5.E10.m1.14.14.1.1.1.2.cmml" xref="S5.E10.m1.14.14.1.1.1.2"><csymbol cd="ambiguous" id="S5.E10.m1.14.14.1.1.1.2.1.cmml" xref="S5.E10.m1.14.14.1.1.1.2">subscript</csymbol><apply id="S5.E10.m1.8.8.cmml" xref="S5.E10.m1.8.8"><ci id="S5.E10.m1.8.8.8.cmml" xref="S5.E10.m1.8.8.8">⏟</ci><apply id="S5.E10.m1.8.8.7.cmml" xref="S5.E10.m1.8.8.7"><minus id="S5.E10.m1.8.8.7.8.cmml" xref="S5.E10.m1.8.8.7.8"></minus><apply id="S5.E10.m1.8.8.7.9.cmml" xref="S5.E10.m1.8.8.7.9"><times id="S5.E10.m1.8.8.7.9.1.cmml" xref="S5.E10.m1.8.8.7.9.1"></times><apply id="S5.E10.m1.8.8.7.9.2.cmml" xref="S5.E10.m1.8.8.7.9.2"><csymbol cd="ambiguous" id="S5.E10.m1.8.8.7.9.2.1.cmml" xref="S5.E10.m1.8.8.7.9.2">subscript</csymbol><ci id="S5.E10.m1.8.8.7.9.2.2.cmml" xref="S5.E10.m1.8.8.7.9.2.2">𝑟</ci><ci id="S5.E10.m1.8.8.7.9.2.3.cmml" xref="S5.E10.m1.8.8.7.9.2.3">italic-ϕ</ci></apply><interval closure="open" id="S5.E10.m1.8.8.7.9.3.1.cmml" xref="S5.E10.m1.8.8.7.9.3.2"><ci id="S5.E10.m1.2.2.1.1.cmml" xref="S5.E10.m1.2.2.1.1">𝑥</ci><ci id="S5.E10.m1.3.3.2.2.cmml" xref="S5.E10.m1.3.3.2.2">𝑦</ci></interval></apply><apply id="S5.E10.m1.8.8.7.7.cmml" xref="S5.E10.m1.8.8.7.7"><times id="S5.E10.m1.8.8.7.7.3.cmml" xref="S5.E10.m1.8.8.7.7.3"></times><ci id="S5.E10.m1.8.8.7.7.4.cmml" xref="S5.E10.m1.8.8.7.7.4">𝛽</ci><log id="S5.E10.m1.8.8.7.7.5.cmml" xref="S5.E10.m1.8.8.7.7.5"></log><apply id="S5.E10.m1.8.8.7.7.2.cmml" xref="S5.E10.m1.8.8.7.7.2"><apply id="S5.E10.m1.8.8.7.7.2.3.cmml" xref="S5.E10.m1.8.8.7.7.2.3"><csymbol cd="ambiguous" id="S5.E10.m1.8.8.7.7.2.3.1.cmml" xref="S5.E10.m1.8.8.7.7.2.3">subscript</csymbol><sum id="S5.E10.m1.8.8.7.7.2.3.2.cmml" xref="S5.E10.m1.8.8.7.7.2.3.2"></sum><ci id="S5.E10.m1.8.8.7.7.2.3.3.cmml" xref="S5.E10.m1.8.8.7.7.2.3.3">𝑦</ci></apply><apply id="S5.E10.m1.8.8.7.7.2.2.cmml" xref="S5.E10.m1.8.8.7.7.2.2"><times id="S5.E10.m1.8.8.7.7.2.2.3.cmml" xref="S5.E10.m1.8.8.7.7.2.2.3"></times><apply id="S5.E10.m1.8.8.7.7.2.2.4.cmml" xref="S5.E10.m1.8.8.7.7.2.2.4"><csymbol cd="ambiguous" id="S5.E10.m1.8.8.7.7.2.2.4.1.cmml" xref="S5.E10.m1.8.8.7.7.2.2.4">subscript</csymbol><ci id="S5.E10.m1.8.8.7.7.2.2.4.2.cmml" xref="S5.E10.m1.8.8.7.7.2.2.4.2">𝜋</ci><ci id="S5.E10.m1.8.8.7.7.2.2.4.3a.cmml" xref="S5.E10.m1.8.8.7.7.2.2.4.3"><mtext id="S5.E10.m1.8.8.7.7.2.2.4.3.cmml" mathsize="70%" xref="S5.E10.m1.8.8.7.7.2.2.4.3">ref</mtext></ci></apply><apply id="S5.E10.m1.7.7.6.6.1.1.1.1.1.cmml" xref="S5.E10.m1.7.7.6.6.1.1.1.1"><csymbol cd="latexml" id="S5.E10.m1.7.7.6.6.1.1.1.1.1.1.cmml" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.1">conditional</csymbol><ci id="S5.E10.m1.7.7.6.6.1.1.1.1.1.2.cmml" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.2">𝑦</ci><ci id="S5.E10.m1.7.7.6.6.1.1.1.1.1.3.cmml" xref="S5.E10.m1.7.7.6.6.1.1.1.1.1.3">𝑥</ci></apply><apply id="S5.E10.m1.8.8.7.7.2.2.2.2.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1"><exp id="S5.E10.m1.6.6.5.5.cmml" xref="S5.E10.m1.6.6.5.5"></exp><apply id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1"><times id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.1.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.1"></times><apply id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2"><divide id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.1.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2"></divide><cn id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.2.cmml" type="integer" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.2">1</cn><ci id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.3.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.2.3">𝛽</ci></apply><apply id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.1.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3">subscript</csymbol><ci id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.2.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.2">𝑟</ci><ci id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.3.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.3.3">italic-ϕ</ci></apply><interval closure="open" id="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.1.cmml" xref="S5.E10.m1.8.8.7.7.2.2.2.1.1.1.4.2"><ci id="S5.E10.m1.4.4.3.3.cmml" xref="S5.E10.m1.4.4.3.3">𝑥</ci><ci id="S5.E10.m1.5.5.4.4.cmml" xref="S5.E10.m1.5.5.4.4">𝑦</ci></interval></apply></apply></apply></apply></apply></apply></apply><apply id="S5.E10.m1.11.11.3.cmml" xref="S5.E10.m1.11.11.3"><times id="S5.E10.m1.11.11.3.4.cmml" xref="S5.E10.m1.11.11.3.4"></times><ci id="S5.E10.m1.11.11.3.5.cmml" xref="S5.E10.m1.11.11.3.5">𝑓</ci><vector id="S5.E10.m1.11.11.3.3.3.cmml" xref="S5.E10.m1.11.11.3.3.2"><apply id="S5.E10.m1.10.10.2.2.1.1.cmml" xref="S5.E10.m1.10.10.2.2.1.1"><csymbol cd="ambiguous" id="S5.E10.m1.10.10.2.2.1.1.1.cmml" xref="S5.E10.m1.10.10.2.2.1.1">subscript</csymbol><ci id="S5.E10.m1.10.10.2.2.1.1.2.cmml" xref="S5.E10.m1.10.10.2.2.1.1.2">𝑟</ci><ci id="S5.E10.m1.10.10.2.2.1.1.3.cmml" xref="S5.E10.m1.10.10.2.2.1.1.3">italic-ϕ</ci></apply><apply id="S5.E10.m1.11.11.3.3.2.2.cmml" xref="S5.E10.m1.11.11.3.3.2.2"><csymbol cd="ambiguous" id="S5.E10.m1.11.11.3.3.2.2.1.cmml" xref="S5.E10.m1.11.11.3.3.2.2">subscript</csymbol><ci id="S5.E10.m1.11.11.3.3.2.2.2.cmml" xref="S5.E10.m1.11.11.3.3.2.2.2">𝜋</ci><ci id="S5.E10.m1.11.11.3.3.2.2.3a.cmml" xref="S5.E10.m1.11.11.3.3.2.2.3"><mtext id="S5.E10.m1.11.11.3.3.2.2.3.cmml" mathsize="50%" xref="S5.E10.m1.11.11.3.3.2.2.3">ref</mtext></ci></apply><ci id="S5.E10.m1.9.9.1.1.cmml" xref="S5.E10.m1.9.9.1.1">𝛽</ci></vector></apply></apply><apply id="S5.E10.m1.14.14.1.1.1.3.cmml" xref="S5.E10.m1.14.14.1.1.1.3"><csymbol cd="ambiguous" id="S5.E10.m1.14.14.1.1.1.3.1.cmml" xref="S5.E10.m1.14.14.1.1.1.3">subscript</csymbol><apply id="S5.E10.m1.13.13.cmml" xref="S5.E10.m1.13.13"><ci id="S5.E10.m1.13.13.3.cmml" xref="S5.E10.m1.13.13.3">⏟</ci><apply id="S5.E10.m1.13.13.2.cmml" xref="S5.E10.m1.13.13.2"><times id="S5.E10.m1.13.13.2.3.cmml" xref="S5.E10.m1.13.13.2.3"></times><ci id="S5.E10.m1.13.13.2.4.cmml" xref="S5.E10.m1.13.13.2.4">𝛽</ci><apply id="S5.E10.m1.13.13.2.5.cmml" xref="S5.E10.m1.13.13.2.5"><log id="S5.E10.m1.13.13.2.5.1.cmml" xref="S5.E10.m1.13.13.2.5.1"></log><apply id="S5.E10.m1.13.13.2.2.cmml" xref="S5.E10.m1.13.13.2.2"><divide id="S5.E10.m1.13.13.2.2.3.cmml" xref="S5.E10.m1.13.13.2.2"></divide><apply id="S5.E10.m1.12.12.1.1.1.cmml" xref="S5.E10.m1.12.12.1.1.1"><times id="S5.E10.m1.12.12.1.1.1.2.cmml" xref="S5.E10.m1.12.12.1.1.1.2"></times><apply id="S5.E10.m1.12.12.1.1.1.3.cmml" xref="S5.E10.m1.12.12.1.1.1.3"><csymbol cd="ambiguous" id="S5.E10.m1.12.12.1.1.1.3.1.cmml" xref="S5.E10.m1.12.12.1.1.1.3">subscript</csymbol><ci id="S5.E10.m1.12.12.1.1.1.3.2.cmml" xref="S5.E10.m1.12.12.1.1.1.3.2">𝜋</ci><ci id="S5.E10.m1.12.12.1.1.1.3.3.cmml" xref="S5.E10.m1.12.12.1.1.1.3.3">𝜃</ci></apply><apply id="S5.E10.m1.12.12.1.1.1.1.1.1.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1"><csymbol cd="latexml" id="S5.E10.m1.12.12.1.1.1.1.1.1.1.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.E10.m1.12.12.1.1.1.1.1.1.2.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.2">𝑦</ci><ci id="S5.E10.m1.12.12.1.1.1.1.1.1.3.cmml" xref="S5.E10.m1.12.12.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S5.E10.m1.13.13.2.2.2.cmml" xref="S5.E10.m1.13.13.2.2.2"><times id="S5.E10.m1.13.13.2.2.2.2.cmml" xref="S5.E10.m1.13.13.2.2.2.2"></times><apply id="S5.E10.m1.13.13.2.2.2.3.cmml" xref="S5.E10.m1.13.13.2.2.2.3"><csymbol cd="ambiguous" id="S5.E10.m1.13.13.2.2.2.3.1.cmml" xref="S5.E10.m1.13.13.2.2.2.3">subscript</csymbol><ci id="S5.E10.m1.13.13.2.2.2.3.2.cmml" xref="S5.E10.m1.13.13.2.2.2.3.2">𝜋</ci><ci id="S5.E10.m1.13.13.2.2.2.3.3a.cmml" xref="S5.E10.m1.13.13.2.2.2.3.3"><mtext id="S5.E10.m1.13.13.2.2.2.3.3.cmml" mathsize="70%" xref="S5.E10.m1.13.13.2.2.2.3.3">ref</mtext></ci></apply><apply id="S5.E10.m1.13.13.2.2.2.1.1.1.cmml" xref="S5.E10.m1.13.13.2.2.2.1.1"><csymbol cd="latexml" id="S5.E10.m1.13.13.2.2.2.1.1.1.1.cmml" xref="S5.E10.m1.13.13.2.2.2.1.1.1.1">conditional</csymbol><ci id="S5.E10.m1.13.13.2.2.2.1.1.1.2.cmml" xref="S5.E10.m1.13.13.2.2.2.1.1.1.2">𝑦</ci><ci id="S5.E10.m1.13.13.2.2.2.1.1.1.3.cmml" xref="S5.E10.m1.13.13.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><ci id="S5.E10.m1.14.14.1.1.1.3.2a.cmml" xref="S5.E10.m1.14.14.1.1.1.3.2"><mtext id="S5.E10.m1.14.14.1.1.1.3.2.cmml" mathsize="70%" xref="S5.E10.m1.14.14.1.1.1.3.2">KL</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E10.m1.14c">\max_{\pi_{\theta}}\mathbb{E}_{\pi_{\theta}(y\mid x)}\bigg{[}\underbrace{r_{%
\phi}(x,y)-\beta\log\sum_{y}\pi_{\text{ref}}(y\mid x)\exp\left(\frac{1}{\beta}%
r_{\phi}(x,y)\right)}_{f(r_{\phi},\pi_{\text{ref}},\beta)}-\underbrace{\beta%
\log\frac{\pi_{\theta}(y\mid x)}{\pi_{\text{ref}}(y\mid x)}}_{\text{KL}}\bigg{]}</annotation><annotation encoding="application/x-llamapun" id="S5.E10.m1.14d">roman_max start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_POSTSUBSCRIPT [ under⏟ start_ARG italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y ) - italic_β roman_log ∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y ) ) end_ARG start_POSTSUBSCRIPT italic_f ( italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT , italic_β ) end_POSTSUBSCRIPT - under⏟ start_ARG italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG end_ARG start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS2.p1.7">이는 <math alttext="r_{\phi}" class="ltx_Math" display="inline" id="S5.SS2.p1.5.m1.1"><semantics id="S5.SS2.p1.5.m1.1a"><msub id="S5.SS2.p1.5.m1.1.1" xref="S5.SS2.p1.5.m1.1.1.cmml"><mi id="S5.SS2.p1.5.m1.1.1.2" xref="S5.SS2.p1.5.m1.1.1.2.cmml">r</mi><mi id="S5.SS2.p1.5.m1.1.1.3" xref="S5.SS2.p1.5.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m1.1b"><apply id="S5.SS2.p1.5.m1.1.1.cmml" xref="S5.SS2.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.5.m1.1.1.1.cmml" xref="S5.SS2.p1.5.m1.1.1">subscript</csymbol><ci id="S5.SS2.p1.5.m1.1.1.2.cmml" xref="S5.SS2.p1.5.m1.1.1.2">𝑟</ci><ci id="S5.SS2.p1.5.m1.1.1.3.cmml" xref="S5.SS2.p1.5.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m1.1c">r_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.5.m1.1d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>의 보상 클래스에 대한 DPO 등가 보상을 사용하여 선행 작업 <cite class="ltx_cite ltx_citemacro_citep">(Ziegler et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib49" title="">2020</a>; Stiennon et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib38" title="">2022</a>; Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib1" title="">2022a</a>; Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib26" title="">2022</a>)</cite>에서 최적화된 것과 동일한 목적이다. 이 설정에서, <math alttext="f(r_{\phi},\pi_{\text{ref}},\beta)" class="ltx_Math" display="inline" id="S5.SS2.p1.6.m2.3"><semantics id="S5.SS2.p1.6.m2.3a"><mrow id="S5.SS2.p1.6.m2.3.3" xref="S5.SS2.p1.6.m2.3.3.cmml"><mi id="S5.SS2.p1.6.m2.3.3.4" xref="S5.SS2.p1.6.m2.3.3.4.cmml">f</mi><mo id="S5.SS2.p1.6.m2.3.3.3" xref="S5.SS2.p1.6.m2.3.3.3.cmml">⁢</mo><mrow id="S5.SS2.p1.6.m2.3.3.2.2" xref="S5.SS2.p1.6.m2.3.3.2.3.cmml"><mo id="S5.SS2.p1.6.m2.3.3.2.2.3" stretchy="false" xref="S5.SS2.p1.6.m2.3.3.2.3.cmml">(</mo><msub id="S5.SS2.p1.6.m2.2.2.1.1.1" xref="S5.SS2.p1.6.m2.2.2.1.1.1.cmml"><mi id="S5.SS2.p1.6.m2.2.2.1.1.1.2" xref="S5.SS2.p1.6.m2.2.2.1.1.1.2.cmml">r</mi><mi id="S5.SS2.p1.6.m2.2.2.1.1.1.3" xref="S5.SS2.p1.6.m2.2.2.1.1.1.3.cmml">ϕ</mi></msub><mo id="S5.SS2.p1.6.m2.3.3.2.2.4" xref="S5.SS2.p1.6.m2.3.3.2.3.cmml">,</mo><msub id="S5.SS2.p1.6.m2.3.3.2.2.2" xref="S5.SS2.p1.6.m2.3.3.2.2.2.cmml"><mi id="S5.SS2.p1.6.m2.3.3.2.2.2.2" xref="S5.SS2.p1.6.m2.3.3.2.2.2.2.cmml">π</mi><mtext id="S5.SS2.p1.6.m2.3.3.2.2.2.3" xref="S5.SS2.p1.6.m2.3.3.2.2.2.3a.cmml">ref</mtext></msub><mo id="S5.SS2.p1.6.m2.3.3.2.2.5" xref="S5.SS2.p1.6.m2.3.3.2.3.cmml">,</mo><mi id="S5.SS2.p1.6.m2.1.1" xref="S5.SS2.p1.6.m2.1.1.cmml">β</mi><mo id="S5.SS2.p1.6.m2.3.3.2.2.6" stretchy="false" xref="S5.SS2.p1.6.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m2.3b"><apply id="S5.SS2.p1.6.m2.3.3.cmml" xref="S5.SS2.p1.6.m2.3.3"><times id="S5.SS2.p1.6.m2.3.3.3.cmml" xref="S5.SS2.p1.6.m2.3.3.3"></times><ci id="S5.SS2.p1.6.m2.3.3.4.cmml" xref="S5.SS2.p1.6.m2.3.3.4">𝑓</ci><vector id="S5.SS2.p1.6.m2.3.3.2.3.cmml" xref="S5.SS2.p1.6.m2.3.3.2.2"><apply id="S5.SS2.p1.6.m2.2.2.1.1.1.cmml" xref="S5.SS2.p1.6.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.6.m2.2.2.1.1.1.1.cmml" xref="S5.SS2.p1.6.m2.2.2.1.1.1">subscript</csymbol><ci id="S5.SS2.p1.6.m2.2.2.1.1.1.2.cmml" xref="S5.SS2.p1.6.m2.2.2.1.1.1.2">𝑟</ci><ci id="S5.SS2.p1.6.m2.2.2.1.1.1.3.cmml" xref="S5.SS2.p1.6.m2.2.2.1.1.1.3">italic-ϕ</ci></apply><apply id="S5.SS2.p1.6.m2.3.3.2.2.2.cmml" xref="S5.SS2.p1.6.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S5.SS2.p1.6.m2.3.3.2.2.2.1.cmml" xref="S5.SS2.p1.6.m2.3.3.2.2.2">subscript</csymbol><ci id="S5.SS2.p1.6.m2.3.3.2.2.2.2.cmml" xref="S5.SS2.p1.6.m2.3.3.2.2.2.2">𝜋</ci><ci id="S5.SS2.p1.6.m2.3.3.2.2.2.3a.cmml" xref="S5.SS2.p1.6.m2.3.3.2.2.2.3"><mtext id="S5.SS2.p1.6.m2.3.3.2.2.2.3.cmml" mathsize="70%" xref="S5.SS2.p1.6.m2.3.3.2.2.2.3">ref</mtext></ci></apply><ci id="S5.SS2.p1.6.m2.1.1.cmml" xref="S5.SS2.p1.6.m2.1.1">𝛽</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m2.3c">f(r_{\phi},\pi_{\text{ref}},\beta)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.6.m2.3d">italic_f ( italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT , italic_β )</annotation></semantics></math>에서의 정규화 용어를 참조 정책 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S5.SS2.p1.7.m3.1"><semantics id="S5.SS2.p1.7.m3.1a"><msub id="S5.SS2.p1.7.m3.1.1" xref="S5.SS2.p1.7.m3.1.1.cmml"><mi id="S5.SS2.p1.7.m3.1.1.2" xref="S5.SS2.p1.7.m3.1.1.2.cmml">π</mi><mtext id="S5.SS2.p1.7.m3.1.1.3" xref="S5.SS2.p1.7.m3.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m3.1b"><apply id="S5.SS2.p1.7.m3.1.1.cmml" xref="S5.SS2.p1.7.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.7.m3.1.1.1.cmml" xref="S5.SS2.p1.7.m3.1.1">subscript</csymbol><ci id="S5.SS2.p1.7.m3.1.1.2.cmml" xref="S5.SS2.p1.7.m3.1.1.2">𝜋</ci><ci id="S5.SS2.p1.7.m3.1.1.3a.cmml" xref="S5.SS2.p1.7.m3.1.1.3"><mtext id="S5.SS2.p1.7.m3.1.1.3.cmml" mathsize="70%" xref="S5.SS2.p1.7.m3.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m3.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.7.m3.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math>의 소프트값 함수로 해석할 수 있다. 이 항은 최적해에 영향을 미치지 않지만, 그렇지 않으면 목표의 정책 기울기가 분산이 높아 학습을 불안정하게 만들 수 있다. 학습된 값 함수를 사용하여 정규화 항을 수용할 수 있지만 최적화하기 어려울 수도 있습니다. 대안적으로, 선행 작업들은 인간 완료 기준선, 본질적으로 정규화 항의 단일 샘플 몬테카를로 추정치를 사용하여 정규화된 보상을 갖는다. 대조적으로, DPO 재매개변수는 기준선이 필요하지 않은 보상 함수를 산출한다.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">이 절에서는 선호도에서 직접 정책을 훈련하는 DPO의 능력을 경험적으로 평가한다. 먼저, 잘 통제된 텍스트 생성 환경에서 우리는 PPO와 같은 일반적인 선호도 학습 알고리즘과 비교하여 DPO가 보상 최대화와 참조 정책으로 KL-발산을 얼마나 효율적으로 상쇄하는지 묻는다. 다음으로 요약 및 대화를 포함하여 더 큰 모델과 더 어려운 RLHF 태스크에 대한 DPO의 성능을 평가한다. 우리는 하이퍼파라미터의 튜닝이 거의 없는 경우, DPO는 학습된 보상 함수 하에서 <math alttext="N" class="ltx_Math" display="inline" id="S6.p1.1.m1.1"><semantics id="S6.p1.1.m1.1a"><mi id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><ci id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.1d">italic_N</annotation></semantics></math> 샘플링된 궤적 중 가장 좋은 궤적을 반환할 뿐만 아니라 PPO를 사용하여 RLHF와 같은 강한 기준선보다 잘 또는 더 잘 수행하는 경향이 있음을 발견했다. 이러한 결과를 제시하기 전에 실험 설정을 설명합니다. 자세한 내용은 부록 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A3" title="Appendix C Further Details on the Experimental Set-Up ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">C</span></a>에 나와 있습니다.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.8"><span class="ltx_text ltx_font_bold" id="S6.p2.8.1">Tasks. </span> 우리의 실험은 세 가지 다른 개방형 텍스트 생성 작업을 탐구한다. 모든 실험에 대해 알고리즘은 선호도 <math alttext="\mathcal{D}=\bigl{\{}x^{(i)},y_{w}^{(i)},y_{l}^{(i)}\bigr{\}}_{i=1}^{N}" class="ltx_Math" display="inline" id="S6.p2.1.m1.6"><semantics id="S6.p2.1.m1.6a"><mrow id="S6.p2.1.m1.6.6" xref="S6.p2.1.m1.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.p2.1.m1.6.6.5" xref="S6.p2.1.m1.6.6.5.cmml">𝒟</mi><mo id="S6.p2.1.m1.6.6.4" xref="S6.p2.1.m1.6.6.4.cmml">=</mo><msubsup id="S6.p2.1.m1.6.6.3" xref="S6.p2.1.m1.6.6.3.cmml"><mrow id="S6.p2.1.m1.6.6.3.3.3.3" xref="S6.p2.1.m1.6.6.3.3.3.4.cmml"><mo id="S6.p2.1.m1.6.6.3.3.3.3.4" maxsize="120%" minsize="120%" xref="S6.p2.1.m1.6.6.3.3.3.4.cmml">{</mo><msup id="S6.p2.1.m1.4.4.1.1.1.1.1" xref="S6.p2.1.m1.4.4.1.1.1.1.1.cmml"><mi id="S6.p2.1.m1.4.4.1.1.1.1.1.2" xref="S6.p2.1.m1.4.4.1.1.1.1.1.2.cmml">x</mi><mrow id="S6.p2.1.m1.1.1.1.3" xref="S6.p2.1.m1.4.4.1.1.1.1.1.cmml"><mo id="S6.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S6.p2.1.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="S6.p2.1.m1.1.1.1.1" xref="S6.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="S6.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S6.p2.1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S6.p2.1.m1.6.6.3.3.3.3.5" xref="S6.p2.1.m1.6.6.3.3.3.4.cmml">,</mo><msubsup id="S6.p2.1.m1.5.5.2.2.2.2.2" xref="S6.p2.1.m1.5.5.2.2.2.2.2.cmml"><mi id="S6.p2.1.m1.5.5.2.2.2.2.2.2.2" xref="S6.p2.1.m1.5.5.2.2.2.2.2.2.2.cmml">y</mi><mi id="S6.p2.1.m1.5.5.2.2.2.2.2.2.3" xref="S6.p2.1.m1.5.5.2.2.2.2.2.2.3.cmml">w</mi><mrow id="S6.p2.1.m1.2.2.1.3" xref="S6.p2.1.m1.5.5.2.2.2.2.2.cmml"><mo id="S6.p2.1.m1.2.2.1.3.1" stretchy="false" xref="S6.p2.1.m1.5.5.2.2.2.2.2.cmml">(</mo><mi id="S6.p2.1.m1.2.2.1.1" xref="S6.p2.1.m1.2.2.1.1.cmml">i</mi><mo id="S6.p2.1.m1.2.2.1.3.2" stretchy="false" xref="S6.p2.1.m1.5.5.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S6.p2.1.m1.6.6.3.3.3.3.6" xref="S6.p2.1.m1.6.6.3.3.3.4.cmml">,</mo><msubsup id="S6.p2.1.m1.6.6.3.3.3.3.3" xref="S6.p2.1.m1.6.6.3.3.3.3.3.cmml"><mi id="S6.p2.1.m1.6.6.3.3.3.3.3.2.2" xref="S6.p2.1.m1.6.6.3.3.3.3.3.2.2.cmml">y</mi><mi id="S6.p2.1.m1.6.6.3.3.3.3.3.2.3" xref="S6.p2.1.m1.6.6.3.3.3.3.3.2.3.cmml">l</mi><mrow id="S6.p2.1.m1.3.3.1.3" xref="S6.p2.1.m1.6.6.3.3.3.3.3.cmml"><mo id="S6.p2.1.m1.3.3.1.3.1" stretchy="false" xref="S6.p2.1.m1.6.6.3.3.3.3.3.cmml">(</mo><mi id="S6.p2.1.m1.3.3.1.1" xref="S6.p2.1.m1.3.3.1.1.cmml">i</mi><mo id="S6.p2.1.m1.3.3.1.3.2" stretchy="false" xref="S6.p2.1.m1.6.6.3.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S6.p2.1.m1.6.6.3.3.3.3.7" maxsize="120%" minsize="120%" xref="S6.p2.1.m1.6.6.3.3.3.4.cmml">}</mo></mrow><mrow id="S6.p2.1.m1.6.6.3.3.5" xref="S6.p2.1.m1.6.6.3.3.5.cmml"><mi id="S6.p2.1.m1.6.6.3.3.5.2" xref="S6.p2.1.m1.6.6.3.3.5.2.cmml">i</mi><mo id="S6.p2.1.m1.6.6.3.3.5.1" xref="S6.p2.1.m1.6.6.3.3.5.1.cmml">=</mo><mn id="S6.p2.1.m1.6.6.3.3.5.3" xref="S6.p2.1.m1.6.6.3.3.5.3.cmml">1</mn></mrow><mi id="S6.p2.1.m1.6.6.3.5" xref="S6.p2.1.m1.6.6.3.5.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.6b"><apply id="S6.p2.1.m1.6.6.cmml" xref="S6.p2.1.m1.6.6"><eq id="S6.p2.1.m1.6.6.4.cmml" xref="S6.p2.1.m1.6.6.4"></eq><ci id="S6.p2.1.m1.6.6.5.cmml" xref="S6.p2.1.m1.6.6.5">𝒟</ci><apply id="S6.p2.1.m1.6.6.3.cmml" xref="S6.p2.1.m1.6.6.3"><csymbol cd="ambiguous" id="S6.p2.1.m1.6.6.3.4.cmml" xref="S6.p2.1.m1.6.6.3">superscript</csymbol><apply id="S6.p2.1.m1.6.6.3.3.cmml" xref="S6.p2.1.m1.6.6.3"><csymbol cd="ambiguous" id="S6.p2.1.m1.6.6.3.3.4.cmml" xref="S6.p2.1.m1.6.6.3">subscript</csymbol><set id="S6.p2.1.m1.6.6.3.3.3.4.cmml" xref="S6.p2.1.m1.6.6.3.3.3.3"><apply id="S6.p2.1.m1.4.4.1.1.1.1.1.cmml" xref="S6.p2.1.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.p2.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S6.p2.1.m1.4.4.1.1.1.1.1">superscript</csymbol><ci id="S6.p2.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S6.p2.1.m1.4.4.1.1.1.1.1.2">𝑥</ci><ci id="S6.p2.1.m1.1.1.1.1.cmml" xref="S6.p2.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S6.p2.1.m1.5.5.2.2.2.2.2.cmml" xref="S6.p2.1.m1.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S6.p2.1.m1.5.5.2.2.2.2.2.1.cmml" xref="S6.p2.1.m1.5.5.2.2.2.2.2">superscript</csymbol><apply id="S6.p2.1.m1.5.5.2.2.2.2.2.2.cmml" xref="S6.p2.1.m1.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S6.p2.1.m1.5.5.2.2.2.2.2.2.1.cmml" xref="S6.p2.1.m1.5.5.2.2.2.2.2">subscript</csymbol><ci id="S6.p2.1.m1.5.5.2.2.2.2.2.2.2.cmml" xref="S6.p2.1.m1.5.5.2.2.2.2.2.2.2">𝑦</ci><ci id="S6.p2.1.m1.5.5.2.2.2.2.2.2.3.cmml" xref="S6.p2.1.m1.5.5.2.2.2.2.2.2.3">𝑤</ci></apply><ci id="S6.p2.1.m1.2.2.1.1.cmml" xref="S6.p2.1.m1.2.2.1.1">𝑖</ci></apply><apply id="S6.p2.1.m1.6.6.3.3.3.3.3.cmml" xref="S6.p2.1.m1.6.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S6.p2.1.m1.6.6.3.3.3.3.3.1.cmml" xref="S6.p2.1.m1.6.6.3.3.3.3.3">superscript</csymbol><apply id="S6.p2.1.m1.6.6.3.3.3.3.3.2.cmml" xref="S6.p2.1.m1.6.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S6.p2.1.m1.6.6.3.3.3.3.3.2.1.cmml" xref="S6.p2.1.m1.6.6.3.3.3.3.3">subscript</csymbol><ci id="S6.p2.1.m1.6.6.3.3.3.3.3.2.2.cmml" xref="S6.p2.1.m1.6.6.3.3.3.3.3.2.2">𝑦</ci><ci id="S6.p2.1.m1.6.6.3.3.3.3.3.2.3.cmml" xref="S6.p2.1.m1.6.6.3.3.3.3.3.2.3">𝑙</ci></apply><ci id="S6.p2.1.m1.3.3.1.1.cmml" xref="S6.p2.1.m1.3.3.1.1">𝑖</ci></apply></set><apply id="S6.p2.1.m1.6.6.3.3.5.cmml" xref="S6.p2.1.m1.6.6.3.3.5"><eq id="S6.p2.1.m1.6.6.3.3.5.1.cmml" xref="S6.p2.1.m1.6.6.3.3.5.1"></eq><ci id="S6.p2.1.m1.6.6.3.3.5.2.cmml" xref="S6.p2.1.m1.6.6.3.3.5.2">𝑖</ci><cn id="S6.p2.1.m1.6.6.3.3.5.3.cmml" type="integer" xref="S6.p2.1.m1.6.6.3.3.5.3">1</cn></apply></apply><ci id="S6.p2.1.m1.6.6.3.5.cmml" xref="S6.p2.1.m1.6.6.3.5">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.6c">\mathcal{D}=\bigl{\{}x^{(i)},y_{w}^{(i)},y_{l}^{(i)}\bigr{\}}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S6.p2.1.m1.6d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>의 데이터 세트로부터 정책을 학습한다. <span class="ltx_text ltx_font_bold" id="S6.p2.8.2">controlled sentiment generation</span>, <math alttext="x" class="ltx_Math" display="inline" id="S6.p2.2.m2.1"><semantics id="S6.p2.2.m2.1a"><mi id="S6.p2.2.m2.1.1" xref="S6.p2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S6.p2.2.m2.1b"><ci id="S6.p2.2.m2.1.1.cmml" xref="S6.p2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S6.p2.2.m2.1d">italic_x</annotation></semantics></math>는 IMDb dataset <cite class="ltx_cite ltx_citemacro_cite">Maas et al. (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib22" title="">2011</a>)</cite>로부터 영화 리뷰의 접두사이며, 정책은 긍정적인 감성으로 <math alttext="y" class="ltx_Math" display="inline" id="S6.p2.3.m3.1"><semantics id="S6.p2.3.m3.1a"><mi id="S6.p2.3.m3.1.1" xref="S6.p2.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S6.p2.3.m3.1b"><ci id="S6.p2.3.m3.1.1.cmml" xref="S6.p2.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S6.p2.3.m3.1d">italic_y</annotation></semantics></math>를 생성해야 한다. 통제된 평가를 수행하기 위해 이 실험을 위해 사전 훈련된 감정 분류기를 사용하여 세대에 걸쳐 <span class="ltx_text ltx_font_italic" id="S6.p2.8.3">generate</span> 선호도 쌍이 있으며, 여기서 <math alttext="p(\text{positive}\mid x,y_{w})&gt;p(\text{positive}\mid x,y_{l})" class="ltx_Math" display="inline" id="S6.p2.4.m4.4"><semantics id="S6.p2.4.m4.4a"><mrow id="S6.p2.4.m4.4.4" xref="S6.p2.4.m4.4.4.cmml"><mrow id="S6.p2.4.m4.3.3.1" xref="S6.p2.4.m4.3.3.1.cmml"><mi id="S6.p2.4.m4.3.3.1.3" xref="S6.p2.4.m4.3.3.1.3.cmml">p</mi><mo id="S6.p2.4.m4.3.3.1.2" xref="S6.p2.4.m4.3.3.1.2.cmml">⁢</mo><mrow id="S6.p2.4.m4.3.3.1.1.1" xref="S6.p2.4.m4.3.3.1.1.1.1.cmml"><mo id="S6.p2.4.m4.3.3.1.1.1.2" stretchy="false" xref="S6.p2.4.m4.3.3.1.1.1.1.cmml">(</mo><mrow id="S6.p2.4.m4.3.3.1.1.1.1" xref="S6.p2.4.m4.3.3.1.1.1.1.cmml"><mtext id="S6.p2.4.m4.3.3.1.1.1.1.3" xref="S6.p2.4.m4.3.3.1.1.1.1.3a.cmml">positive</mtext><mo id="S6.p2.4.m4.3.3.1.1.1.1.2" xref="S6.p2.4.m4.3.3.1.1.1.1.2.cmml">∣</mo><mrow id="S6.p2.4.m4.3.3.1.1.1.1.1.1" xref="S6.p2.4.m4.3.3.1.1.1.1.1.2.cmml"><mi id="S6.p2.4.m4.1.1" xref="S6.p2.4.m4.1.1.cmml">x</mi><mo id="S6.p2.4.m4.3.3.1.1.1.1.1.1.2" xref="S6.p2.4.m4.3.3.1.1.1.1.1.2.cmml">,</mo><msub id="S6.p2.4.m4.3.3.1.1.1.1.1.1.1" xref="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.cmml"><mi id="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.2" xref="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.3" xref="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.3.cmml">w</mi></msub></mrow></mrow><mo id="S6.p2.4.m4.3.3.1.1.1.3" stretchy="false" xref="S6.p2.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.p2.4.m4.4.4.3" xref="S6.p2.4.m4.4.4.3.cmml">&gt;</mo><mrow id="S6.p2.4.m4.4.4.2" xref="S6.p2.4.m4.4.4.2.cmml"><mi id="S6.p2.4.m4.4.4.2.3" xref="S6.p2.4.m4.4.4.2.3.cmml">p</mi><mo id="S6.p2.4.m4.4.4.2.2" xref="S6.p2.4.m4.4.4.2.2.cmml">⁢</mo><mrow id="S6.p2.4.m4.4.4.2.1.1" xref="S6.p2.4.m4.4.4.2.1.1.1.cmml"><mo id="S6.p2.4.m4.4.4.2.1.1.2" stretchy="false" xref="S6.p2.4.m4.4.4.2.1.1.1.cmml">(</mo><mrow id="S6.p2.4.m4.4.4.2.1.1.1" xref="S6.p2.4.m4.4.4.2.1.1.1.cmml"><mtext id="S6.p2.4.m4.4.4.2.1.1.1.3" xref="S6.p2.4.m4.4.4.2.1.1.1.3a.cmml">positive</mtext><mo id="S6.p2.4.m4.4.4.2.1.1.1.2" xref="S6.p2.4.m4.4.4.2.1.1.1.2.cmml">∣</mo><mrow id="S6.p2.4.m4.4.4.2.1.1.1.1.1" xref="S6.p2.4.m4.4.4.2.1.1.1.1.2.cmml"><mi id="S6.p2.4.m4.2.2" xref="S6.p2.4.m4.2.2.cmml">x</mi><mo id="S6.p2.4.m4.4.4.2.1.1.1.1.1.2" xref="S6.p2.4.m4.4.4.2.1.1.1.1.2.cmml">,</mo><msub id="S6.p2.4.m4.4.4.2.1.1.1.1.1.1" xref="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.cmml"><mi id="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.2" xref="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.2.cmml">y</mi><mi id="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.3" xref="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.3.cmml">l</mi></msub></mrow></mrow><mo id="S6.p2.4.m4.4.4.2.1.1.3" stretchy="false" xref="S6.p2.4.m4.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.4.m4.4b"><apply id="S6.p2.4.m4.4.4.cmml" xref="S6.p2.4.m4.4.4"><gt id="S6.p2.4.m4.4.4.3.cmml" xref="S6.p2.4.m4.4.4.3"></gt><apply id="S6.p2.4.m4.3.3.1.cmml" xref="S6.p2.4.m4.3.3.1"><times id="S6.p2.4.m4.3.3.1.2.cmml" xref="S6.p2.4.m4.3.3.1.2"></times><ci id="S6.p2.4.m4.3.3.1.3.cmml" xref="S6.p2.4.m4.3.3.1.3">𝑝</ci><apply id="S6.p2.4.m4.3.3.1.1.1.1.cmml" xref="S6.p2.4.m4.3.3.1.1.1"><csymbol cd="latexml" id="S6.p2.4.m4.3.3.1.1.1.1.2.cmml" xref="S6.p2.4.m4.3.3.1.1.1.1.2">conditional</csymbol><ci id="S6.p2.4.m4.3.3.1.1.1.1.3a.cmml" xref="S6.p2.4.m4.3.3.1.1.1.1.3"><mtext id="S6.p2.4.m4.3.3.1.1.1.1.3.cmml" xref="S6.p2.4.m4.3.3.1.1.1.1.3">positive</mtext></ci><list id="S6.p2.4.m4.3.3.1.1.1.1.1.2.cmml" xref="S6.p2.4.m4.3.3.1.1.1.1.1.1"><ci id="S6.p2.4.m4.1.1.cmml" xref="S6.p2.4.m4.1.1">𝑥</ci><apply id="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.cmml" xref="S6.p2.4.m4.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.1.cmml" xref="S6.p2.4.m4.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.2.cmml" xref="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.3.cmml" xref="S6.p2.4.m4.3.3.1.1.1.1.1.1.1.3">𝑤</ci></apply></list></apply></apply><apply id="S6.p2.4.m4.4.4.2.cmml" xref="S6.p2.4.m4.4.4.2"><times id="S6.p2.4.m4.4.4.2.2.cmml" xref="S6.p2.4.m4.4.4.2.2"></times><ci id="S6.p2.4.m4.4.4.2.3.cmml" xref="S6.p2.4.m4.4.4.2.3">𝑝</ci><apply id="S6.p2.4.m4.4.4.2.1.1.1.cmml" xref="S6.p2.4.m4.4.4.2.1.1"><csymbol cd="latexml" id="S6.p2.4.m4.4.4.2.1.1.1.2.cmml" xref="S6.p2.4.m4.4.4.2.1.1.1.2">conditional</csymbol><ci id="S6.p2.4.m4.4.4.2.1.1.1.3a.cmml" xref="S6.p2.4.m4.4.4.2.1.1.1.3"><mtext id="S6.p2.4.m4.4.4.2.1.1.1.3.cmml" xref="S6.p2.4.m4.4.4.2.1.1.1.3">positive</mtext></ci><list id="S6.p2.4.m4.4.4.2.1.1.1.1.2.cmml" xref="S6.p2.4.m4.4.4.2.1.1.1.1.1"><ci id="S6.p2.4.m4.2.2.cmml" xref="S6.p2.4.m4.2.2">𝑥</ci><apply id="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.cmml" xref="S6.p2.4.m4.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S6.p2.4.m4.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.2.cmml" xref="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.2">𝑦</ci><ci id="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.3.cmml" xref="S6.p2.4.m4.4.4.2.1.1.1.1.1.1.3">𝑙</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.4.m4.4c">p(\text{positive}\mid x,y_{w})&gt;p(\text{positive}\mid x,y_{l})</annotation><annotation encoding="application/x-llamapun" id="S6.p2.4.m4.4d">italic_p ( positive ∣ italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) &gt; italic_p ( positive ∣ italic_x , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math>이다. SFT의 경우 IMDB 데이터 세트의 열차 분할 리뷰에서 수렴할 때까지 GPT-2-크기를 미세 조정한다(App<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A3.SS1" title="C.1 IMDb Sentiment Experiment and Baseline Details ‣ Appendix C Further Details on the Experimental Set-Up ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">C.1</span></a>의 추가 세부 정보). <span class="ltx_text ltx_font_bold" id="S6.p2.8.4">summarization</span>, <math alttext="x" class="ltx_Math" display="inline" id="S6.p2.5.m5.1"><semantics id="S6.p2.5.m5.1a"><mi id="S6.p2.5.m5.1.1" xref="S6.p2.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S6.p2.5.m5.1b"><ci id="S6.p2.5.m5.1.1.cmml" xref="S6.p2.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S6.p2.5.m5.1d">italic_x</annotation></semantics></math>는 Reddit의 포럼 게시물입니다. 정책은 게시물에 있는 주요 요점의 요약 <math alttext="y" class="ltx_Math" display="inline" id="S6.p2.6.m6.1"><semantics id="S6.p2.6.m6.1a"><mi id="S6.p2.6.m6.1.1" xref="S6.p2.6.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S6.p2.6.m6.1b"><ci id="S6.p2.6.m6.1.1.cmml" xref="S6.p2.6.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.6.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S6.p2.6.m6.1d">italic_y</annotation></semantics></math>를 생성해야 합니다. 이전 작업에 이어 Reddit TL;DR 요약 데이터 세트 <cite class="ltx_cite ltx_citemacro_citep">(Völske et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib41" title="">2017</a>)</cite>와 함께 <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib38" title="">Stiennon et al.</a></cite>에 의해 수집된 인간 선호도를 사용한다. 우리는 RLHF를 위한 TRLX <cite class="ltx_cite ltx_citemacro_citep">(von Werra et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib42" title="">2023</a>)</cite> 프레임워크와 함께 사람이 쓴 포럼 게시물 <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/CarperAI/openai_summarize_tldr_sft" title="">https://huggingface.co/CarperAI/openai_summarize_tldr_sft</a></span></span></span>에서 미세 조정된 SFT 모델을 사용한다. 인간 선호도 데이터 세트는 다르지만 유사하게 훈련된 SFT 모델의 샘플에 대해 <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib38" title="">Stiennon et al.</a></cite>에 의해 수집되었다. 마지막으로, <span class="ltx_text ltx_font_bold" id="S6.p2.8.5">single-turn dialogue</span>, <math alttext="x" class="ltx_Math" display="inline" id="S6.p2.7.m7.1"><semantics id="S6.p2.7.m7.1a"><mi id="S6.p2.7.m7.1.1" xref="S6.p2.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S6.p2.7.m7.1b"><ci id="S6.p2.7.m7.1.1.cmml" xref="S6.p2.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S6.p2.7.m7.1d">italic_x</annotation></semantics></math>는 인간 질의로서, 천체물리학에 관한 질문에서부터 관계 조언에 대한 요청까지의 모든 것일 수 있다. 정책은 사용자의 쿼리에 대한 매력적이고 유용한 응답 <math alttext="y" class="ltx_Math" display="inline" id="S6.p2.8.m8.1"><semantics id="S6.p2.8.m8.1a"><mi id="S6.p2.8.m8.1.1" xref="S6.p2.8.m8.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S6.p2.8.m8.1b"><ci id="S6.p2.8.m8.1.1.cmml" xref="S6.p2.8.m8.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.8.m8.1c">y</annotation><annotation encoding="application/x-llamapun" id="S6.p2.8.m8.1d">italic_y</annotation></semantics></math>를 생성해야 하며, 인간과 자동화된 어시스턴트 사이의 170k 대화가 포함된 Anthropic Helpful 및 Harmless 대화 데이터 세트 <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib1" title="">2022a</a>)</cite>를 사용한다. 각 전사체는 인간이 선호하는 응답을 나타내는 선호 라벨과 함께 큰(알 수 없지만) 언어 모델에 의해 생성된 응답 쌍으로 끝난다. 이 설정에서는 사전 훈련된 SFT 모델을 사용할 수 없으므로 SFT 모델을 형성하기 위해 선호하는 완성에서만 기성 언어 모델을 미세 조정한다.</p>
</div>
<figure class="ltx_figure" id="S6.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" height="311" id="S6.F2.g1" src="https://arxiv.org/html/2305.18290v2/x1.png" width="415"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" height="305" id="S6.F2.g2" src="https://arxiv.org/html/2305.18290v2/x2.png" width="407"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 2:</span><span class="ltx_text ltx_font_bold" id="S6.F2.3.1">Left. </span> The frontier of expected reward vs KL to the reference policy. DPO는 모든 KL 값에 대해 가장 높은 예상 보상을 제공하여 최적화의 품질을 보여준다. <span class="ltx_text ltx_font_bold" id="S6.F2.4.2">Right. </span> TL;DR 요약 승률 vs. GPT-4를 평가자로 사용하여 사람이 작성한 요약입니다. DPO는 요약에 대한 PPO의 베스트 케이스 성능을 초과하지만 샘플링 온도 변화에 더 강력합니다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1"><span class="ltx_text ltx_font_bold" id="S6.p3.1.1">Evaluation. </span> 우리의 실험은 평가에 두 가지 다른 접근법을 사용한다. 제한된 보상 최대화 목표를 최적화하는데 있어서 각 알고리즘의 효용성을 분석하기 위해, 제어된 감정 생성 설정에서 기준 정책으로부터 달성된 보상과 KL-발산의 프론티어를 통해 각 알고리즘을 평가한다. 이 프론티어는 지상-진실 보상 함수(감성 분류기)에 적합하기 때문에 계산이 가능하다. 그러나 현실 세계에서는 Ground truth 보상 함수가 알려져 있지 않기 때문에, 우리는 GPT-4를 요약 및 싱글 턴 대화 설정에서 요약 품질 및 응답 유용성의 인간 평가를 위한 프록시로 사용하여 기준 정책에 대해 <span class="ltx_text ltx_font_italic" id="S6.p3.1.2">win rate</span>으로 알고리즘을 평가한다. 요약에는 테스트 세트의 참조 요약을 베이스라인으로 사용하고 대화에는 테스트 데이터 세트의 선호 반응을 베이스라인으로 사용한다. 기존 연구에서 LMs가 기존 메트릭 <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib10" title="">2023</a>)</cite>보다 더 나은 자동화된 평가자가 될 수 있다고 제안하지만, Sec에서 평가를 위한 GPT-4의 사용을 정당화하기 위해 인간 연구를 수행한다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.SS4" title="6.4 Validating GPT-4 judgments with human judgments ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">6.4</span></a>. 우리는 GPT-4 판단이 일반적으로 인간 간 주석자 일치보다 유사하거나 높은 GPT-4와의 인간 일치와 인간과 강한 상관관계가 있음을 발견했다.</p>
</div>
<div class="ltx_para" id="S6.p4">
<p class="ltx_p" id="S6.p4.8"><span class="ltx_text ltx_font_bold" id="S6.p4.8.2">Methods. </span> DPO 외에도 인간의 선호도를 준수하기 위해 언어 모델을 훈련하는 몇 가지 기존 접근법을 평가한다. 요약 작업에서 <span class="ltx_text ltx_font_bold" id="S6.p4.8.3">GPT-J</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang and Komatsuzaki, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib43" title="">2021</a>)</cite>로 제로샷 프롬프트를 탐색하고 대화 작업에서 <span class="ltx_text ltx_font_bold" id="S6.p4.8.4">Pythia-2.8B</span> <cite class="ltx_cite ltx_citemacro_citep">(Biderman et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib3" title="">2023</a>)</cite>로 2샷 프롬프트를 탐색합니다. 또한 <span class="ltx_text ltx_font_bold" id="S6.p4.8.5">SFT</span> 모델뿐만 아니라 <span class="ltx_text ltx_font_bold" id="S6.p4.8.6">Preferred-FT</span> 모델도 평가합니다. 이 모델은 SFT 모델(컨트롤된 감정 및 요약) 또는 일반 LM(단일 회전 대화)에서 선택한 완료 <math alttext="y_{w}" class="ltx_Math" display="inline" id="S6.p4.1.m1.1"><semantics id="S6.p4.1.m1.1a"><msub id="S6.p4.1.m1.1.1" xref="S6.p4.1.m1.1.1.cmml"><mi id="S6.p4.1.m1.1.1.2" xref="S6.p4.1.m1.1.1.2.cmml">y</mi><mi id="S6.p4.1.m1.1.1.3" xref="S6.p4.1.m1.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S6.p4.1.m1.1b"><apply id="S6.p4.1.m1.1.1.cmml" xref="S6.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S6.p4.1.m1.1.1.1.cmml" xref="S6.p4.1.m1.1.1">subscript</csymbol><ci id="S6.p4.1.m1.1.1.2.cmml" xref="S6.p4.1.m1.1.1.2">𝑦</ci><ci id="S6.p4.1.m1.1.1.3.cmml" xref="S6.p4.1.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.1.m1.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S6.p4.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math>에 대한 지도 학습으로 미세 조정된 모델입니다. 또 다른 의사 지도 방법은 <span class="ltx_text ltx_font_bold" id="S6.p4.8.7">Unlikelihood</span> <cite class="ltx_cite ltx_citemacro_citep">(Welleck et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib44" title="">2019</a>)</cite>인데, 이는 단순히 정책을 최적화하여 <math alttext="y_{w}" class="ltx_Math" display="inline" id="S6.p4.2.m2.1"><semantics id="S6.p4.2.m2.1a"><msub id="S6.p4.2.m2.1.1" xref="S6.p4.2.m2.1.1.cmml"><mi id="S6.p4.2.m2.1.1.2" xref="S6.p4.2.m2.1.1.2.cmml">y</mi><mi id="S6.p4.2.m2.1.1.3" xref="S6.p4.2.m2.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S6.p4.2.m2.1b"><apply id="S6.p4.2.m2.1.1.cmml" xref="S6.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S6.p4.2.m2.1.1.1.cmml" xref="S6.p4.2.m2.1.1">subscript</csymbol><ci id="S6.p4.2.m2.1.1.2.cmml" xref="S6.p4.2.m2.1.1.2">𝑦</ci><ci id="S6.p4.2.m2.1.1.3.cmml" xref="S6.p4.2.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.2.m2.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S6.p4.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math>에 할당된 확률과 <span class="ltx_text ltx_font_italic" id="S6.p4.8.8">minimize</span> <math alttext="y_{l}" class="ltx_Math" display="inline" id="S6.p4.3.m3.1"><semantics id="S6.p4.3.m3.1a"><msub id="S6.p4.3.m3.1.1" xref="S6.p4.3.m3.1.1.cmml"><mi id="S6.p4.3.m3.1.1.2" xref="S6.p4.3.m3.1.1.2.cmml">y</mi><mi id="S6.p4.3.m3.1.1.3" xref="S6.p4.3.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S6.p4.3.m3.1b"><apply id="S6.p4.3.m3.1.1.cmml" xref="S6.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S6.p4.3.m3.1.1.1.cmml" xref="S6.p4.3.m3.1.1">subscript</csymbol><ci id="S6.p4.3.m3.1.1.2.cmml" xref="S6.p4.3.m3.1.1.2">𝑦</ci><ci id="S6.p4.3.m3.1.1.3.cmml" xref="S6.p4.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.3.m3.1c">y_{l}</annotation><annotation encoding="application/x-llamapun" id="S6.p4.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>에 할당된 확률을 최대화하며; ‘unlikelihood’ 용어에 선택적 계수 <math alttext="\alpha\in[0,1]" class="ltx_Math" display="inline" id="S6.p4.4.m4.2"><semantics id="S6.p4.4.m4.2a"><mrow id="S6.p4.4.m4.2.3" xref="S6.p4.4.m4.2.3.cmml"><mi id="S6.p4.4.m4.2.3.2" xref="S6.p4.4.m4.2.3.2.cmml">α</mi><mo id="S6.p4.4.m4.2.3.1" xref="S6.p4.4.m4.2.3.1.cmml">∈</mo><mrow id="S6.p4.4.m4.2.3.3.2" xref="S6.p4.4.m4.2.3.3.1.cmml"><mo id="S6.p4.4.m4.2.3.3.2.1" stretchy="false" xref="S6.p4.4.m4.2.3.3.1.cmml">[</mo><mn id="S6.p4.4.m4.1.1" xref="S6.p4.4.m4.1.1.cmml">0</mn><mo id="S6.p4.4.m4.2.3.3.2.2" xref="S6.p4.4.m4.2.3.3.1.cmml">,</mo><mn id="S6.p4.4.m4.2.2" xref="S6.p4.4.m4.2.2.cmml">1</mn><mo id="S6.p4.4.m4.2.3.3.2.3" stretchy="false" xref="S6.p4.4.m4.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p4.4.m4.2b"><apply id="S6.p4.4.m4.2.3.cmml" xref="S6.p4.4.m4.2.3"><in id="S6.p4.4.m4.2.3.1.cmml" xref="S6.p4.4.m4.2.3.1"></in><ci id="S6.p4.4.m4.2.3.2.cmml" xref="S6.p4.4.m4.2.3.2">𝛼</ci><interval closure="closed" id="S6.p4.4.m4.2.3.3.1.cmml" xref="S6.p4.4.m4.2.3.3.2"><cn id="S6.p4.4.m4.1.1.cmml" type="integer" xref="S6.p4.4.m4.1.1">0</cn><cn id="S6.p4.4.m4.2.2.cmml" type="integer" xref="S6.p4.4.m4.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.4.m4.2c">\alpha\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S6.p4.4.m4.2d">italic_α ∈ [ 0 , 1 ]</annotation></semantics></math>를 사용한다. 또한 선호도 데이터로부터 학습된 보상 함수를 사용하여 <span class="ltx_text ltx_font_bold" id="S6.p4.8.9">PPO</span> <cite class="ltx_cite ltx_citemacro_citep">(Schulman et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib37" title="">2017</a>)</cite>와 제어된 감성 설정에서 사용할 수 있는 그라운드 트루스 보상 함수로부터 학습하는 오라클인 <span class="ltx_text ltx_font_bold" id="S6.p4.8.10">PPO-GT</span>을 고려한다. 감성 실험에서 우리는 PPO-GT의 두 가지 구현, 즉 -the-shelf 버전 <cite class="ltx_cite ltx_citemacro_cite">von Werra et al. (<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib42" title="">2023</a>)</cite>와 보상을 정규화하고 성능을 향상시키기 위해 하이퍼파라미터를 추가로 조정하는 수정된 버전을 사용한다(학습된 보상으로 'normal' PPO를 실행할 때도 이러한 수정을 사용한다). 마지막으로, <span class="ltx_text ltx_font_bold" id="S6.p4.5.1">Best of <math alttext="N" class="ltx_Math" display="inline" id="S6.p4.5.1.m1.1"><semantics id="S6.p4.5.1.m1.1a"><mi id="S6.p4.5.1.m1.1.1" xref="S6.p4.5.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.p4.5.1.m1.1b"><ci id="S6.p4.5.1.m1.1.1.cmml" xref="S6.p4.5.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.5.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.p4.5.1.m1.1d">italic_N</annotation></semantics></math></span> baseline, sampling <math alttext="N" class="ltx_Math" display="inline" id="S6.p4.6.m5.1"><semantics id="S6.p4.6.m5.1a"><mi id="S6.p4.6.m5.1.1" xref="S6.p4.6.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.p4.6.m5.1b"><ci id="S6.p4.6.m5.1.1.cmml" xref="S6.p4.6.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.6.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.p4.6.m5.1d">italic_N</annotation></semantics></math> responses from the SFT model (or Preferred-FT in dialogue) and return the highest-scoring response to the reward function learned from the preference dataset. 이 고성능 방법은 보상 모델의 품질을 PPO 최적화와 분리하지만 테스트 시간에 모든 쿼리에 대해 샘플링 <math alttext="N" class="ltx_Math" display="inline" id="S6.p4.8.m7.1"><semantics id="S6.p4.8.m7.1a"><mi id="S6.p4.8.m7.1.1" xref="S6.p4.8.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.p4.8.m7.1b"><ci id="S6.p4.8.m7.1.1.cmml" xref="S6.p4.8.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.8.m7.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.p4.8.m7.1d">italic_N</annotation></semantics></math> 완성도를 요구하기 때문에 중간 <math alttext="N" class="ltx_Math" display="inline" id="S6.p4.7.m6.1"><semantics id="S6.p4.7.m6.1a"><mi id="S6.p4.7.m6.1.1" xref="S6.p4.7.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.p4.7.m6.1b"><ci id="S6.p4.7.m6.1.1.cmml" xref="S6.p4.7.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p4.7.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.p4.7.m6.1d">italic_N</annotation></semantics></math>에 대해서도 계산적으로 비실용적이다.</p>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>How well can DPO optimize the RLHF objective?</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S6.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" height="311" id="S6.F3.g1" src="https://arxiv.org/html/2305.18290v2/x3.png" width="415"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" height="305" id="S6.F3.g2" src="https://arxiv.org/html/2305.18290v2/x4.png" width="407"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 3:</span><span class="ltx_text ltx_font_bold" id="S6.F3.3.1">Left. </span> Win rates computed by GPT-4 for Anthropic-HH one-step dialogue; DPO는 Anthropic-HH 테스트 세트에서 선택된 요약보다 개선된 유일한 방법입니다. <span class="ltx_text ltx_font_bold" id="S6.F3.4.2">Right. </span> 훈련 과정에서 서로 다른 샘플링 온도에 대한 승리율입니다. 데이터 세트 라벨에 대한 DPO의 개선은 다양한 샘플링 온도에 대한 훈련 과정에서 상당히 안정적이다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.4">일반적인 RLHF 알고리즘에서 사용되는 KL 제약 보상 최대화 목표는 보상이 참조 정책에서 멀리 벗어나는 것을 제한하면서 보상의 활용 균형을 맞춘다. 따라서 알고리즘을 비교할 때 달성된 보상과 KL 불일치를 모두 고려해야 하며, 약간 더 높은 보상을 달성하지만 훨씬 더 높은 KL을 달성하는 것이 반드시 바람직한 것은 아니다. 그림 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.F2" title="Figure 2 ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">2</span></a>는 감성 설정에서 다양한 알고리즘에 대한 reward-KL 프론티어를 보여준다. 우리는 각 실행에서 정책 보수성을 위해 다른 하이퍼파라미터를 사용하여 각 알고리즘에 대해 다중 훈련 실행을 실행한다(PPO의 경우 목표 KL <math alttext="\in\{3,6,9,12\}" class="ltx_Math" display="inline" id="S6.SS1.p1.1.m1.4"><semantics id="S6.SS1.p1.1.m1.4a"><mrow id="S6.SS1.p1.1.m1.4.5" xref="S6.SS1.p1.1.m1.4.5.cmml"><mi id="S6.SS1.p1.1.m1.4.5.2" xref="S6.SS1.p1.1.m1.4.5.2.cmml"></mi><mo id="S6.SS1.p1.1.m1.4.5.1" xref="S6.SS1.p1.1.m1.4.5.1.cmml">∈</mo><mrow id="S6.SS1.p1.1.m1.4.5.3.2" xref="S6.SS1.p1.1.m1.4.5.3.1.cmml"><mo id="S6.SS1.p1.1.m1.4.5.3.2.1" stretchy="false" xref="S6.SS1.p1.1.m1.4.5.3.1.cmml">{</mo><mn id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml">3</mn><mo id="S6.SS1.p1.1.m1.4.5.3.2.2" xref="S6.SS1.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p1.1.m1.2.2" xref="S6.SS1.p1.1.m1.2.2.cmml">6</mn><mo id="S6.SS1.p1.1.m1.4.5.3.2.3" xref="S6.SS1.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p1.1.m1.3.3" xref="S6.SS1.p1.1.m1.3.3.cmml">9</mn><mo id="S6.SS1.p1.1.m1.4.5.3.2.4" xref="S6.SS1.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p1.1.m1.4.4" xref="S6.SS1.p1.1.m1.4.4.cmml">12</mn><mo id="S6.SS1.p1.1.m1.4.5.3.2.5" stretchy="false" xref="S6.SS1.p1.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.4b"><apply id="S6.SS1.p1.1.m1.4.5.cmml" xref="S6.SS1.p1.1.m1.4.5"><in id="S6.SS1.p1.1.m1.4.5.1.cmml" xref="S6.SS1.p1.1.m1.4.5.1"></in><csymbol cd="latexml" id="S6.SS1.p1.1.m1.4.5.2.cmml" xref="S6.SS1.p1.1.m1.4.5.2">absent</csymbol><set id="S6.SS1.p1.1.m1.4.5.3.1.cmml" xref="S6.SS1.p1.1.m1.4.5.3.2"><cn id="S6.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S6.SS1.p1.1.m1.1.1">3</cn><cn id="S6.SS1.p1.1.m1.2.2.cmml" type="integer" xref="S6.SS1.p1.1.m1.2.2">6</cn><cn id="S6.SS1.p1.1.m1.3.3.cmml" type="integer" xref="S6.SS1.p1.1.m1.3.3">9</cn><cn id="S6.SS1.p1.1.m1.4.4.cmml" type="integer" xref="S6.SS1.p1.1.m1.4.4">12</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.4c">\in\{3,6,9,12\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.1.m1.4d">∈ { 3 , 6 , 9 , 12 }</annotation></semantics></math>, PPO의 경우 <math alttext="\beta\in\{0.05,0.1,1,5\}" class="ltx_Math" display="inline" id="S6.SS1.p1.2.m2.4"><semantics id="S6.SS1.p1.2.m2.4a"><mrow id="S6.SS1.p1.2.m2.4.5" xref="S6.SS1.p1.2.m2.4.5.cmml"><mi id="S6.SS1.p1.2.m2.4.5.2" xref="S6.SS1.p1.2.m2.4.5.2.cmml">β</mi><mo id="S6.SS1.p1.2.m2.4.5.1" xref="S6.SS1.p1.2.m2.4.5.1.cmml">∈</mo><mrow id="S6.SS1.p1.2.m2.4.5.3.2" xref="S6.SS1.p1.2.m2.4.5.3.1.cmml"><mo id="S6.SS1.p1.2.m2.4.5.3.2.1" stretchy="false" xref="S6.SS1.p1.2.m2.4.5.3.1.cmml">{</mo><mn id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml">0.05</mn><mo id="S6.SS1.p1.2.m2.4.5.3.2.2" xref="S6.SS1.p1.2.m2.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p1.2.m2.2.2" xref="S6.SS1.p1.2.m2.2.2.cmml">0.1</mn><mo id="S6.SS1.p1.2.m2.4.5.3.2.3" xref="S6.SS1.p1.2.m2.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p1.2.m2.3.3" xref="S6.SS1.p1.2.m2.3.3.cmml">1</mn><mo id="S6.SS1.p1.2.m2.4.5.3.2.4" xref="S6.SS1.p1.2.m2.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p1.2.m2.4.4" xref="S6.SS1.p1.2.m2.4.4.cmml">5</mn><mo id="S6.SS1.p1.2.m2.4.5.3.2.5" stretchy="false" xref="S6.SS1.p1.2.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.4b"><apply id="S6.SS1.p1.2.m2.4.5.cmml" xref="S6.SS1.p1.2.m2.4.5"><in id="S6.SS1.p1.2.m2.4.5.1.cmml" xref="S6.SS1.p1.2.m2.4.5.1"></in><ci id="S6.SS1.p1.2.m2.4.5.2.cmml" xref="S6.SS1.p1.2.m2.4.5.2">𝛽</ci><set id="S6.SS1.p1.2.m2.4.5.3.1.cmml" xref="S6.SS1.p1.2.m2.4.5.3.2"><cn id="S6.SS1.p1.2.m2.1.1.cmml" type="float" xref="S6.SS1.p1.2.m2.1.1">0.05</cn><cn id="S6.SS1.p1.2.m2.2.2.cmml" type="float" xref="S6.SS1.p1.2.m2.2.2">0.1</cn><cn id="S6.SS1.p1.2.m2.3.3.cmml" type="integer" xref="S6.SS1.p1.2.m2.3.3">1</cn><cn id="S6.SS1.p1.2.m2.4.4.cmml" type="integer" xref="S6.SS1.p1.2.m2.4.4">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.4c">\beta\in\{0.05,0.1,1,5\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.2.m2.4d">italic_β ∈ { 0.05 , 0.1 , 1 , 5 }</annotation></semantics></math>, <math alttext="\alpha\in\{0.05,0.1,0.5,1\}" class="ltx_Math" display="inline" id="S6.SS1.p1.3.m3.4"><semantics id="S6.SS1.p1.3.m3.4a"><mrow id="S6.SS1.p1.3.m3.4.5" xref="S6.SS1.p1.3.m3.4.5.cmml"><mi id="S6.SS1.p1.3.m3.4.5.2" xref="S6.SS1.p1.3.m3.4.5.2.cmml">α</mi><mo id="S6.SS1.p1.3.m3.4.5.1" xref="S6.SS1.p1.3.m3.4.5.1.cmml">∈</mo><mrow id="S6.SS1.p1.3.m3.4.5.3.2" xref="S6.SS1.p1.3.m3.4.5.3.1.cmml"><mo id="S6.SS1.p1.3.m3.4.5.3.2.1" stretchy="false" xref="S6.SS1.p1.3.m3.4.5.3.1.cmml">{</mo><mn id="S6.SS1.p1.3.m3.1.1" xref="S6.SS1.p1.3.m3.1.1.cmml">0.05</mn><mo id="S6.SS1.p1.3.m3.4.5.3.2.2" xref="S6.SS1.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p1.3.m3.2.2" xref="S6.SS1.p1.3.m3.2.2.cmml">0.1</mn><mo id="S6.SS1.p1.3.m3.4.5.3.2.3" xref="S6.SS1.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p1.3.m3.3.3" xref="S6.SS1.p1.3.m3.3.3.cmml">0.5</mn><mo id="S6.SS1.p1.3.m3.4.5.3.2.4" xref="S6.SS1.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S6.SS1.p1.3.m3.4.4" xref="S6.SS1.p1.3.m3.4.4.cmml">1</mn><mo id="S6.SS1.p1.3.m3.4.5.3.2.5" stretchy="false" xref="S6.SS1.p1.3.m3.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.3.m3.4b"><apply id="S6.SS1.p1.3.m3.4.5.cmml" xref="S6.SS1.p1.3.m3.4.5"><in id="S6.SS1.p1.3.m3.4.5.1.cmml" xref="S6.SS1.p1.3.m3.4.5.1"></in><ci id="S6.SS1.p1.3.m3.4.5.2.cmml" xref="S6.SS1.p1.3.m3.4.5.2">𝛼</ci><set id="S6.SS1.p1.3.m3.4.5.3.1.cmml" xref="S6.SS1.p1.3.m3.4.5.3.2"><cn id="S6.SS1.p1.3.m3.1.1.cmml" type="float" xref="S6.SS1.p1.3.m3.1.1">0.05</cn><cn id="S6.SS1.p1.3.m3.2.2.cmml" type="float" xref="S6.SS1.p1.3.m3.2.2">0.1</cn><cn id="S6.SS1.p1.3.m3.3.3.cmml" type="float" xref="S6.SS1.p1.3.m3.3.3">0.5</cn><cn id="S6.SS1.p1.3.m3.4.4.cmml" type="integer" xref="S6.SS1.p1.3.m3.4.4">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.3.m3.4c">\alpha\in\{0.05,0.1,0.5,1\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.3.m3.4d">italic_α ∈ { 0.05 , 0.1 , 0.5 , 1 }</annotation></semantics></math>, Unlikelihood의 경우 랜덤 시드, preferred-FT의 경우 랜덤 시드). 이 스윕에는 총 22개의 런이 포함됩니다. 수렴될 때까지 각 100 단계의 훈련 단계 후에, 참조 정책 <math alttext="\text{KL}\left(\pi\mid\mid\pi_{\text{ref}}\right)" class="ltx_math_unparsed" display="inline" id="S6.SS1.p1.4.m4.1"><semantics id="S6.SS1.p1.4.m4.1a"><mrow id="S6.SS1.p1.4.m4.1b"><mtext id="S6.SS1.p1.4.m4.1.1">KL</mtext><mrow id="S6.SS1.p1.4.m4.1.2"><mo id="S6.SS1.p1.4.m4.1.2.1">(</mo><mi id="S6.SS1.p1.4.m4.1.2.2">π</mi><mo id="S6.SS1.p1.4.m4.1.2.3" lspace="0em" rspace="0.0835em">∣</mo><mo id="S6.SS1.p1.4.m4.1.2.4" lspace="0.0835em" rspace="0.167em">∣</mo><msub id="S6.SS1.p1.4.m4.1.2.5"><mi id="S6.SS1.p1.4.m4.1.2.5.2">π</mi><mtext id="S6.SS1.p1.4.m4.1.2.5.3">ref</mtext></msub><mo id="S6.SS1.p1.4.m4.1.2.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S6.SS1.p1.4.m4.1c">\text{KL}\left(\pi\mid\mid\pi_{\text{ref}}\right)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.4.m4.1d">KL ( italic_π ∣ ∣ italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT )</annotation></semantics></math>와 함께 평균 시퀀스 수준 KL<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>That is, the sum of the per-timestep KL-divergences.</span></span></span>뿐만 아니라 진정한 보상 함수 하에서 평균 보상을 계산하는 테스트 프롬프트 세트에 대해 각 정책을 평가한다. 우리는 DPO가 가장 효율적인 프론티어를 생산하여 가장 높은 보상을 달성하면서도 낮은 KL을 달성한다는 것을 발견했다. 이 결과는 여러 가지 이유로 특히 주목할 만하다. 첫째, DPO와 PPO는 동일한 목적을 최적화하지만, DPO는 특히 더 효율적이다; DPO의 보상/KL 트레이드오프는 PPO를 엄격하게 지배한다. 둘째, DPO는 PPO, <em class="ltx_emph ltx_font_italic" id="S6.SS1.p1.4.1">even when PPO can access ground truth rewards</em> (PPO-GT).</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Can DPO scale to real preference datasets?</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.2">다음으로, 요약과 싱글 턴 대화에서 DPO의 미세 조정 성능을 평가한다. 요약하기 위해 ROUGE와 같은 자동 평가 메트릭은 인간 선호도 <cite class="ltx_cite ltx_citemacro_citep">(Stiennon et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib38" title="">2022</a>)</cite>와 상관 관계가 좋지 않을 수 있으며 이전 연구에서는 보다 효과적인 요약을 제공하기 위해 인간 선호도에 PPO를 사용하여 LM을 미세 조정한다는 것을 발견했다. TL;DR 요약 데이터 세트의 테스트 분할에 대한 완성도를 샘플링하고 테스트 세트의 참조 완성도에 대한 평균 승률을 계산하여 다양한 방법을 평가한다. 모든 방법에 대한 완성은 0.0에서 1.0까지 다양한 온도에서 샘플링되며 승률은 그림 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.F2" title="Figure 2 ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">2</span></a> (오른쪽)에 나와 있다. DPO, PPO 및 Preferred-FT는 모두 동일한 GPT-J SFT 모델<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/CarperAI/openai_summarize_tldr_sft" title="">https://huggingface.co/CarperAI/openai_summarize_tldr_sft</a></span></span></span>을 미세 조정합니다. DPO는 0.0의 온도에서 약 61%의 승률을 가지며, 최적 샘플링 온도인 0.0에서 PPO의 성능인 57%를 초과한다. 또한, DPO는 <math alttext="N" class="ltx_Math" display="inline" id="S6.SS2.p1.1.m1.1"><semantics id="S6.SS2.p1.1.m1.1a"><mi id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><ci id="S6.SS2.p1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.m1.1d">italic_N</annotation></semantics></math> 기준선의 최고에 비해 더 높은 최대 승률을 달성한다. 우리는 DPO의 <math alttext="\beta" class="ltx_Math" display="inline" id="S6.SS2.p1.2.m2.1"><semantics id="S6.SS2.p1.2.m2.1a"><mi id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><ci id="S6.SS2.p1.2.m2.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.2.m2.1d">italic_β</annotation></semantics></math> 하이퍼파라미터를 의미 있게 조정하지 않았기 때문에 이러한 결과는 DPO의 잠재력을 과소평가할 수 있다는 점에 주목한다. 또한, DPO가 PPO보다 샘플링 온도에 훨씬 더 강하다는 것을 발견했으며, 그 성능은 고온에서 기본 GPT-J 모델의 성능으로 떨어질 수 있다. 선호FT는 SFT 모델보다 크게 개선되지 않습니다. 우리는 또한 온도 0.25의 DPO 샘플이 온도 0의 PPO 샘플보다 58% 더 선호되는 섹션 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.SS4" title="6.4 Validating GPT-4 judgments with human judgments ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">6.4</span></a>의 인간 평가에서 DPO와 PPO 정면을 비교한다.</p>
</div>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1">단일 회전 대화에서는 인간 보조 상호 작용의 한 단계로 Anthropic HH 데이터 세트 <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib1" title="">2022a</a>)</cite>의 테스트 분할 하위 집합에 대해 다른 방법을 평가한다. GPT-4 평가는 다양한 방법에 대한 승률을 계산하기 위한 참조로 테스트에서 선호되는 완료를 사용한다. 이 작업에 대한 표준 SFT 모델이 없기 때문에 사전 훈련된 피티아-2.8B에서 시작하여 Preferred-FT를 사용하여 선택된 완성들에 대한 참조 모델을 완성들이 모델의 분포 내에 있도록 훈련시킨 다음 DPO를 사용하여 훈련시킨다. 또한 128개의 Preferred-FT 완성 중 베스트(이 작업에 대한 128개의 완성에서 Best of <math alttext="N" class="ltx_Math" display="inline" id="S6.SS2.p2.1.m1.1"><semantics id="S6.SS2.p2.1.m1.1a"><mi id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.1b"><ci id="S6.SS2.p2.1.m1.1.1.cmml" xref="S6.SS2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.1.m1.1d">italic_N</annotation></semantics></math> baseline plateaus; 부록 그림 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.F4" title="Figure 4 ‣ D.1 Performance of Best of 𝑁 baseline for Various 𝑁 ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a> 참조)와 2-shot 프롬프트 버전의 Pythia-2.8B 기본 모델과 비교하여 각 방법에 대한 최상의 수행 온도에 대해 DPO가 잘 수행되거나 더 나은 것을 찾는다. 또한 잘 알려진 소스 <span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/CarperAI/trlx/tree/main/examples/hh" title="">https://github.com/CarperAI/trlx/tree/main/examples/hh</a></span></span></span>의 Anthropic HH 데이터 세트 <span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/reciprocate/ppo_hh_pythia-6B" title="">https://huggingface.co/reciprocate/ppo_hh_pythia-6B</a></span></span></span>에서 PPO로 훈련된 RLHF 모델을 평가하지만 기본 피티아-2.8B 모델보다 더 나은 성능을 제공하는 프롬프트 또는 샘플링 온도를 찾을 수 없다. TL;DR의 결과와 두 방법이 동일한 보상 함수를 최적화한다는 사실에 기초하여 PPO 수준의 성능을 위해 Best of 128을 대략적인 프록시로 간주한다. 전반적으로 DPO는 인류 HH 데이터 세트에서 선호되는 완성도를 개선하는 유일한 계산 효율적인 방법이며 계산적으로 까다로운 128개의 기준선 중 Best와 유사하거나 더 나은 성능을 제공한다. 마지막으로 그림 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.F3" title="Figure 3 ‣ 6.1 How well can DPO optimize the RLHF objective? ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">3</span></a>는 DPO가 비교적 빠르게 최상의 성능으로 수렴함을 보여준다.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Generalization to a new input distribution</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table ltx_align_floatright" id="S6.T1">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T1.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T1.2.3.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S6.T1.2.3.1.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T1.2.3.1.2">
<span class="ltx_text ltx_font_bold" id="S6.T1.2.3.1.2.1" style="font-size:90%;">Win rate vs. ground truth</span><span class="ltx_text" id="S6.T1.2.3.1.2.2" style="font-size:90%;"></span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T1.2.2.3"><span class="ltx_text ltx_font_bold" id="S6.T1.2.2.3.1" style="font-size:90%;">Alg.</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.1.1.1">
<span class="ltx_text" id="S6.T1.1.1.1.1" style="font-size:90%;">Temp </span><math alttext="0" class="ltx_Math" display="inline" id="S6.T1.1.1.1.m1.1"><semantics id="S6.T1.1.1.1.m1.1a"><mn id="S6.T1.1.1.1.m1.1.1" mathsize="90%" xref="S6.T1.1.1.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S6.T1.1.1.1.m1.1b"><cn id="S6.T1.1.1.1.m1.1.1.cmml" type="integer" xref="S6.T1.1.1.1.m1.1.1">0</cn></annotation-xml></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.2.2.2">
<span class="ltx_text" id="S6.T1.2.2.2.1" style="font-size:90%;">Temp </span><math alttext="0.25" class="ltx_Math" display="inline" id="S6.T1.2.2.2.m1.1"><semantics id="S6.T1.2.2.2.m1.1a"><mn id="S6.T1.2.2.2.m1.1.1" mathsize="90%" xref="S6.T1.2.2.2.m1.1.1.cmml">0.25</mn><annotation-xml encoding="MathML-Content" id="S6.T1.2.2.2.m1.1b"><cn id="S6.T1.2.2.2.m1.1.1.cmml" type="float" xref="S6.T1.2.2.2.m1.1.1">0.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.2.2.2.m1.1c">0.25</annotation><annotation encoding="application/x-llamapun" id="S6.T1.2.2.2.m1.1d">0.25</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S6.T1.2.4.2.1"><span class="ltx_text" id="S6.T1.2.4.2.1.1" style="font-size:90%;">DPO</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.2.4.2.2"><span class="ltx_text" id="S6.T1.2.4.2.2.1" style="font-size:90%;">0.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.2.4.2.3"><span class="ltx_text" id="S6.T1.2.4.2.3.1" style="font-size:90%;">0.31</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S6.T1.2.5.3.1"><span class="ltx_text" id="S6.T1.2.5.3.1.1" style="font-size:90%;">PPO</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.2.5.3.2"><span class="ltx_text" id="S6.T1.2.5.3.2.1" style="font-size:90%;">0.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T1.2.5.3.3"><span class="ltx_text" id="S6.T1.2.5.3.3.1" style="font-size:90%;">0.23</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">표 1:</span>GPT-4 win rates vs. 배포 외 CNN/DailyMail 입력 기사에 대한 사실 요약입니다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">분포 변화에 따른 PPO 및 DPO의 성능을 추가로 비교하기 위해, TL;DR(0 및 0.25)의 최상의 샘플링 온도를 사용하여 CNN/DailyMail 데이터 세트 <cite class="ltx_cite ltx_citemacro_citep">(Nallapati et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib24" title="">2016</a>)</cite>의 테스트 분할에서 다른 분포, 뉴스 기사에 대한 Reddit TL;DR 요약 실험의 PPO 및 DPO 정책을 평가한다. 결과는 표 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.T1" title="Table 1 ‣ 6.3 Generalization to a new input distribution ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">1</span></a>에 제시되어 있다. 우리는 Reddit TL;DR에 사용한 것과 동일한 GPT-4(C) 프롬프트를 사용하여 데이터 세트의 그라운드-진실 요약에 대한 GPT-4 승률을 계산했지만 "포럼 포스트"라는 단어를 "뉴스 기사"로 대체했다. 이 새로운 배포의 경우 DPO는 PPO 정책을 상당한 차이로 계속 능가합니다. 이 실험은 DPO가 레이블이 지정되지 않은 추가 Reddit TL;DR 프롬프트를 사용하지 않더라도 DPO 정책이 PPO 정책과 유사하게 일반화할 수 있다는 초기 증거를 제공한다.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Validating GPT-4 judgments with human judgments</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">우리는 TL;DR 요약 실험 결과와 두 개의 서로 다른 GPT-4 프롬프트를 사용하여 GPT-4의 판단의 신뢰성을 검증하기 위해 인간 연구를 수행한다. <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.1">GPT-4 (S)</span> (단순) 프롬프트는 게시물에서 중요한 정보를 더 잘 요약하는 요약에 대해 간단히 묻습니다. <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.2">GPT-4 (C)</span> (concise) 프롬프트도 어떤 요약이 더 간결한지 묻습니다. GPT-4가 <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.3">GPT-4 (S)</span> 프롬프트에서 인간보다 더 길고 반복적인 요약을 선호한다는 것을 발견하기 때문에 이 프롬프트를 평가합니다. 전체 프롬프트는 부록 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A3.SS2" title="C.2 GPT-4 prompts for computing summarization and dialogue win rates ‣ Appendix C Further Details on the Experimental Set-Up ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">C.2</span></a>를 참조하십시오. 가장 높은(DPO, 온도 0.25), 가장 낮은(PPO, 온도 1.0) 및 a를 사용하여 세 가지 비교를 수행한다.</p>
</div>
<figure class="ltx_table ltx_align_floatright" id="S6.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T2.1.1.1">
<td class="ltx_td ltx_border_tt" id="S6.T2.1.1.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T2.1.1.1.2.1" style="font-size:90%;">DPO</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T2.1.1.1.3.1" style="font-size:90%;">SFT</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T2.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T2.1.1.1.4.1" style="font-size:90%;">PPO-1</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.2.2">
<td class="ltx_td ltx_align_left" id="S6.T2.1.2.2.1"><span class="ltx_text" id="S6.T2.1.2.2.1.1" style="font-size:90%;">N respondents</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.2.2.2"><span class="ltx_text" id="S6.T2.1.2.2.2.1" style="font-size:90%;">272</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.2.2.3"><span class="ltx_text" id="S6.T2.1.2.2.3.1" style="font-size:90%;">122</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.2.2.4"><span class="ltx_text" id="S6.T2.1.2.2.4.1" style="font-size:90%;">199</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.1.3.3.1"><span class="ltx_text" id="S6.T2.1.3.3.1.1" style="font-size:90%;">GPT-4 (S) win %</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.3.3.2"><span class="ltx_text" id="S6.T2.1.3.3.2.1" style="font-size:90%;">47</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.3.3.3"><span class="ltx_text" id="S6.T2.1.3.3.3.1" style="font-size:90%;">27</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.3.3.4"><span class="ltx_text" id="S6.T2.1.3.3.4.1" style="font-size:90%;">13</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.4.4">
<td class="ltx_td ltx_align_left" id="S6.T2.1.4.4.1"><span class="ltx_text" id="S6.T2.1.4.4.1.1" style="font-size:90%;">GPT-4 (C) win %</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.4.4.2"><span class="ltx_text" id="S6.T2.1.4.4.2.1" style="font-size:90%;">54</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.4.4.3"><span class="ltx_text" id="S6.T2.1.4.4.3.1" style="font-size:90%;">32</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.4.4.4"><span class="ltx_text" id="S6.T2.1.4.4.4.1" style="font-size:90%;">12</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.5.5">
<td class="ltx_td ltx_align_left" id="S6.T2.1.5.5.1"><span class="ltx_text" id="S6.T2.1.5.5.1.1" style="font-size:90%;">Human win %</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.5.5.2"><span class="ltx_text" id="S6.T2.1.5.5.2.1" style="font-size:90%;">58</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.5.5.3"><span class="ltx_text" id="S6.T2.1.5.5.3.1" style="font-size:90%;">43</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.5.5.4"><span class="ltx_text" id="S6.T2.1.5.5.4.1" style="font-size:90%;">17</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.1.6.6.1"><span class="ltx_text" id="S6.T2.1.6.6.1.1" style="font-size:90%;">GPT-4 (S)-H agree</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.6.6.2"><span class="ltx_text" id="S6.T2.1.6.6.2.1" style="font-size:90%;">70</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.6.6.3"><span class="ltx_text" id="S6.T2.1.6.6.3.1" style="font-size:90%;">77</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T2.1.6.6.4"><span class="ltx_text" id="S6.T2.1.6.6.4.1" style="font-size:90%;">86</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.7.7">
<td class="ltx_td ltx_align_left" id="S6.T2.1.7.7.1"><span class="ltx_text" id="S6.T2.1.7.7.1.1" style="font-size:90%;">GPT-4 (C)-H agree</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.7.7.2"><span class="ltx_text" id="S6.T2.1.7.7.2.1" style="font-size:90%;">67</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.7.7.3"><span class="ltx_text" id="S6.T2.1.7.7.3.1" style="font-size:90%;">79</span></td>
<td class="ltx_td ltx_align_center" id="S6.T2.1.7.7.4"><span class="ltx_text" id="S6.T2.1.7.7.4.1" style="font-size:90%;">85</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.1.8.8">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T2.1.8.8.1"><span class="ltx_text" id="S6.T2.1.8.8.1.1" style="font-size:90%;">H-H agree</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.1.8.8.2"><span class="ltx_text" id="S6.T2.1.8.8.2.1" style="font-size:90%;">65</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.1.8.8.3"><span class="ltx_text" id="S6.T2.1.8.8.3.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T2.1.8.8.4"><span class="ltx_text" id="S6.T2.1.8.8.4.1" style="font-size:90%;">87</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">표 2:</span> TL;DR 요약 샘플에 대한 인간 및 GPT-4 승률 및 판단당 일치 비교. <span class="ltx_text ltx_font_bold" id="S6.T2.6.1">인간은 GPT-4와 서로 동의하는 만큼 동의한다. </span> 각 실험은 명시된 방법의 요약과 온도 0인 PPO의 요약을 비교한다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">SFT(middle-performing), temp. 0.25(middle-performing) 방법은 다양한 샘플 품질을 포괄하는 것을 목표로 하며, 세 가지 방법 모두 탐욕적으로 샘플링된 PPO(최상의 성능 온도)와 비교된다. 우리는 두 프롬프트 모두에서 GPT-4가 인간이 서로 동의하는 만큼 종종 인간과 동의하는 경향이 있음을 발견하여 GPT-4가 인간 평가에 대한 합리적인 대리인임을 시사한다(제한된 인간 평가자로 인해 DPO 및 PPO-1 비교를 위해 여러 인간 판단만 수집한다). 전반적으로 <span class="ltx_text ltx_font_bold" id="S6.SS4.p2.1.1">GPT-4 (C)</span> 프롬프트는 일반적으로 사람을 더 대표하는 승률을 제공하므로 섹션 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.SS2" title="6.2 Can DPO scale to real preference datasets? ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">6.2</span></a>의 주요 결과에 이 프롬프트를 사용합니다. 평가자에게 제시된 웹 인터페이스 및 인간 지원자 목록을 포함한 인간 연구에 대한 추가 세부 사항은 부록 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.SS3" title="D.3 Human study details ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">D.3</span></a>를 참조한다.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">선호도로부터 배우는 것은 훈련 가능한 정렬된 언어 모델을 위한 강력하고 확장 가능한 프레임워크이다. 우리는 강화 학습 없이 선호도로부터 언어 모델을 훈련하기 위한 간단한 훈련 패러다임인 DPO를 도입했다. 선호도 학습 문제를 표준 RL 설정으로 강제하여 off-the-shelf RL 알고리즘을 사용하기보다는, DPO는 강화 학습이나 일반성의 손실 없이 간단한 교차 엔트로피 손실로 언어 모델이 인간의 선호도 <span class="ltx_text ltx_font_italic" id="S7.p1.1.1">directly</span>을 만족하도록 훈련시킬 수 있는 언어 모델 정책과 보상 함수 간의 매핑을 식별한다. 하이퍼파라미터의 튜닝이 사실상 없는 상태에서, DPO는 PPO에 기초한 알고리즘들을 포함하는 기존의 RLHF 알고리즘들보다 유사하게 또는 더 잘 수행하는데, 따라서 DPO는 인간의 선호도들로부터 더 많은 언어 모델들을 트레이닝하는 것에 대한 장벽을 의미있게 감소시킨다.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1"><span class="ltx_text ltx_font_bold" id="S7.p2.1.1">Limitations &amp; Future Work. </span> 우리의 결과는 향후 작업에 대한 몇 가지 중요한 질문을 제기한다. DPO 정책은 명시적 보상 함수로부터의 학습과 비교하여 어떻게 분배에서 일반화되는가? 우리의 초기 결과는 DPO 정책이 PPO 기반 모델과 유사하게 일반화될 수 있음을 시사하지만 보다 포괄적인 연구가 필요하다. 예를 들어 DPO 정책에서 자체 라벨링을 사용한 훈련도 마찬가지로 라벨이 지정되지 않은 프롬프트를 효과적으로 사용할 수 있습니까? 다른 측면에서, 보상 과잉 최적화는 직접 선호도 최적화 설정에서 어떻게 나타나며, 그림 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S6.F3" title="Figure 3 ‣ 6.1 How well can DPO optimize the RLHF objective? ‣ 6 Experiments ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">3</span></a>-right의 성능이 약간 감소하는 경우입니까? 또한 6B 매개변수까지 모델을 평가하지만 DPO를 최대 10배 더 큰 최신 모델로 확장하는 탐색은 향후 작업을 위한 흥미로운 방향이다. 평가와 관련하여 GPT-4에 의해 계산된 승률이 신속한 영향을 받는다는 것을 발견했으며 향후 작업은 자동화된 시스템에서 고품질 판단을 이끌어내는 가장 좋은 방법을 연구할 수 있다. 마지막으로, DPO의 많은 가능한 응용은 다른 양식에서 생성 모델을 훈련하는 것을 포함하여 인간의 선호도에서 언어 모델을 훈련하는 것 이상으로 존재한다.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">EM은 감사하게도 Knight-Hennessy 대학원 펠로우십의 자금을 인정한다 CF와 CM은 CIFAR 펠로우입니다. 이 작업은 부분적으로 Stanford Accelerator for Learning (SAL) 및 Stanford Institute for Human-Centered Artificial Intelligence (HAI) <span class="ltx_text ltx_font_italic" id="Sx1.p1.1.1">Generative AI for the Future of Learning</span> seed grant 프로그램에 의해 지원되었다. Stanford Center for Research on Foundation Models (CRFM)은 이 연구에서 실험에 사용된 컴퓨팅 리소스의 일부를 제공했다. 이 작업은 ONR 보조금 N00014-20-1-2675에 의해 부분적으로 지원되었다.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et&nbsp;al. [2022a]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Y.&nbsp;Bai, A.&nbsp;Jones, K.&nbsp;Ndousse, A.&nbsp;Askell, A.&nbsp;Chen, N.&nbsp;DasSarma, D.&nbsp;Drain,
S.&nbsp;Fort, D.&nbsp;Ganguli, T.&nbsp;Henighan, N.&nbsp;Joseph, S.&nbsp;Kadavath, J.&nbsp;Kernion,
T.&nbsp;Conerly, S.&nbsp;El-Showk, N.&nbsp;Elhage, Z.&nbsp;Hatfield-Dodds, D.&nbsp;Hernandez, T.&nbsp;Hume,
S.&nbsp;Johnston, S.&nbsp;Kravec, L.&nbsp;Lovitt, N.&nbsp;Nanda, C.&nbsp;Olsson, D.&nbsp;Amodei, T.&nbsp;Brown,
J.&nbsp;Clark, S.&nbsp;McCandlish, C.&nbsp;Olah, B.&nbsp;Mann, and J.&nbsp;Kaplan.

</span>
<span class="ltx_bibblock">Training a helpful and harmless assistant with reinforcement learning
from human feedback, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et&nbsp;al. [2022b]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Y.&nbsp;Bai, S.&nbsp;Kadavath, S.&nbsp;Kundu, A.&nbsp;Askell, J.&nbsp;Kernion, A.&nbsp;Jones, A.&nbsp;Chen,
A.&nbsp;Goldie, A.&nbsp;Mirhoseini, C.&nbsp;McKinnon, C.&nbsp;Chen, C.&nbsp;Olsson, C.&nbsp;Olah,
D.&nbsp;Hernandez, D.&nbsp;Drain, D.&nbsp;Ganguli, D.&nbsp;Li, E.&nbsp;Tran-Johnson, E.&nbsp;Perez,
J.&nbsp;Kerr, J.&nbsp;Mueller, J.&nbsp;Ladish, J.&nbsp;Landau, K.&nbsp;Ndousse, K.&nbsp;Lukosuite,
L.&nbsp;Lovitt, M.&nbsp;Sellitto, N.&nbsp;Elhage, N.&nbsp;Schiefer, N.&nbsp;Mercado, N.&nbsp;DasSarma,
R.&nbsp;Lasenby, R.&nbsp;Larson, S.&nbsp;Ringer, S.&nbsp;Johnston, S.&nbsp;Kravec, S.&nbsp;E. Showk,
S.&nbsp;Fort, T.&nbsp;Lanham, T.&nbsp;Telleen-Lawton, T.&nbsp;Conerly, T.&nbsp;Henighan, T.&nbsp;Hume,
S.&nbsp;R. Bowman, Z.&nbsp;Hatfield-Dodds, B.&nbsp;Mann, D.&nbsp;Amodei, N.&nbsp;Joseph,
S.&nbsp;McCandlish, T.&nbsp;Brown, and J.&nbsp;Kaplan.

</span>
<span class="ltx_bibblock">Constitutional ai: Harmlessness from ai feedback, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Biderman, H.&nbsp;Schoelkopf, Q.&nbsp;Anthony, H.&nbsp;Bradley, K.&nbsp;O’Brien, E.&nbsp;Hallahan,
M.&nbsp;A. Khan, S.&nbsp;Purohit, U.&nbsp;S. Prashanth, E.&nbsp;Raff, A.&nbsp;Skowron, L.&nbsp;Sutawika,
and O.&nbsp;van&nbsp;der Wal.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training
and scaling, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bong and Rinaldo [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
H.&nbsp;Bong and A.&nbsp;Rinaldo.

</span>
<span class="ltx_bibblock">Generalized results for the existence and consistency of the MLE in
the Bradley-Terry-Luce model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">International Conference on Machine Learning</em>, 2022.

</span>
<span class="ltx_bibblock">arXiv:2110.11487.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bradley and Terry [1952]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;A. Bradley and M.&nbsp;E. Terry.

</span>
<span class="ltx_bibblock">Rank analysis of incomplete block designs: I. the method of paired
comparisons.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Biometrika</em>, 39(3/4):324–345, 1952.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="https://doi.org/10.2307/2334029" title="">https://doi.org/10.2307/2334029</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. [2020a]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
T.&nbsp;Brown, B.&nbsp;Mann, N.&nbsp;Ryder, M.&nbsp;Subbiah, J.&nbsp;D. Kaplan, P.&nbsp;Dhariwal,
A.&nbsp;Neelakantan, P.&nbsp;Shyam, G.&nbsp;Sastry, A.&nbsp;Askell, S.&nbsp;Agarwal, A.&nbsp;Herbert-Voss,
G.&nbsp;Krueger, T.&nbsp;Henighan, R.&nbsp;Child, A.&nbsp;Ramesh, D.&nbsp;Ziegler, J.&nbsp;Wu, C.&nbsp;Winter,
C.&nbsp;Hesse, M.&nbsp;Chen, E.&nbsp;Sigler, M.&nbsp;Litwin, S.&nbsp;Gray, B.&nbsp;Chess, J.&nbsp;Clark,
C.&nbsp;Berner, S.&nbsp;McCandlish, A.&nbsp;Radford, I.&nbsp;Sutskever, and D.&nbsp;Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In H.&nbsp;Larochelle, M.&nbsp;Ranzato, R.&nbsp;Hadsell, M.&nbsp;Balcan, and H.&nbsp;Lin,
editors, <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;33,
pages 1877–1901. Curran Associates, Inc., 2020a.

</span>
<span class="ltx_bibblock">URL
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2020/file/1457c0d6bfcb4967418bfb8ac142f64a-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2020/file/1457c0d6bfcb4967418bfb8ac142f64a-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. [2020b]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
T.&nbsp;Brown, B.&nbsp;Mann, N.&nbsp;Ryder, M.&nbsp;Subbiah, J.&nbsp;D. Kaplan, P.&nbsp;Dhariwal,
A.&nbsp;Neelakantan, P.&nbsp;Shyam, G.&nbsp;Sastry, A.&nbsp;Askell, et&nbsp;al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Advances in neural information processing systems</em>,
33:1877–1901, 2020b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bubeck et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Bubeck, V.&nbsp;Chandrasekaran, R.&nbsp;Eldan, J.&nbsp;Gehrke, E.&nbsp;Horvitz, E.&nbsp;Kamar,
P.&nbsp;Lee, Y.&nbsp;T. Lee, Y.&nbsp;Li, S.&nbsp;Lundberg, H.&nbsp;Nori, H.&nbsp;Palangi, M.&nbsp;T. Ribeiro,
and Y.&nbsp;Zhang.

</span>
<span class="ltx_bibblock">Sparks of artificial general intelligence: Early experiments with
GPT-4, 2023.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:2303.12712.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Busa-Fekete et&nbsp;al. [2014]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;Busa-Fekete, B.&nbsp;Szörényi, P.&nbsp;Weng, W.&nbsp;Cheng, and
E.&nbsp;Hüllermeier.

</span>
<span class="ltx_bibblock">Preference-based reinforcement learning: evolutionary direct policy
search using a preference-based racing algorithm.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Machine Learning</em>, 97(3):327–351, July
2014.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.1007/s10994-014-5458-8" title="">10.1007/s10994-014-5458-8</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/s10994-014-5458-8" title="">https://doi.org/10.1007/s10994-014-5458-8</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Y.&nbsp;Chen, R.&nbsp;Wang, H.&nbsp;Jiang, S.&nbsp;Shi, and R.-L. Xu.

</span>
<span class="ltx_bibblock">Exploring the use of large language models for reference-free text
quality evaluation: A preliminary empirical study.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ArXiv</em>, abs/2304.00723, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhery et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A.&nbsp;Chowdhery, S.&nbsp;Narang, J.&nbsp;Devlin, M.&nbsp;Bosma, G.&nbsp;Mishra, A.&nbsp;Roberts, P.&nbsp;Barham,
H.&nbsp;W. Chung, C.&nbsp;Sutton, S.&nbsp;Gehrmann, et&nbsp;al.

</span>
<span class="ltx_bibblock">Palm: Scaling language modeling with pathways.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2204.02311</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Christiano et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
P.&nbsp;F. Christiano, J.&nbsp;Leike, T.&nbsp;Brown, M.&nbsp;Martic, S.&nbsp;Legg, and D.&nbsp;Amodei.

</span>
<span class="ltx_bibblock">Deep reinforcement learning from human preferences.

</span>
<span class="ltx_bibblock">In I.&nbsp;Guyon, U.&nbsp;V. Luxburg, S.&nbsp;Bengio, H.&nbsp;Wallach, R.&nbsp;Fergus,
S.&nbsp;Vishwanathan, and R.&nbsp;Garnett, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances in Neural
Information Processing Systems</em>, volume&nbsp;30. Curran Associates, Inc., 2017.

</span>
<span class="ltx_bibblock">URL
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/d5e2c0adad503c91f91df240d0cd4e49-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2017/file/d5e2c0adad503c91f91df240d0cd4e49-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
H.&nbsp;W. Chung, L.&nbsp;Hou, S.&nbsp;Longpre, B.&nbsp;Zoph, Y.&nbsp;Tay, W.&nbsp;Fedus, Y.&nbsp;Li, X.&nbsp;Wang,
M.&nbsp;Dehghani, S.&nbsp;Brahma, A.&nbsp;Webson, S.&nbsp;S. Gu, Z.&nbsp;Dai, M.&nbsp;Suzgun, X.&nbsp;Chen,
A.&nbsp;Chowdhery, A.&nbsp;Castro-Ros, M.&nbsp;Pellat, K.&nbsp;Robinson, D.&nbsp;Valter, S.&nbsp;Narang,
G.&nbsp;Mishra, A.&nbsp;Yu, V.&nbsp;Zhao, Y.&nbsp;Huang, A.&nbsp;Dai, H.&nbsp;Yu, S.&nbsp;Petrov, E.&nbsp;H. Chi,
J.&nbsp;Dean, J.&nbsp;Devlin, A.&nbsp;Roberts, D.&nbsp;Zhou, Q.&nbsp;V. Le, and J.&nbsp;Wei.

</span>
<span class="ltx_bibblock">Scaling instruction-finetuned language models, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dudík et&nbsp;al. [2015]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
M.&nbsp;Dudík, K.&nbsp;Hofmann, R.&nbsp;E. Schapire, A.&nbsp;Slivkins, and M.&nbsp;Zoghi.

</span>
<span class="ltx_bibblock">Contextual dueling bandits.

</span>
<span class="ltx_bibblock">In P.&nbsp;Grünwald, E.&nbsp;Hazan, and S.&nbsp;Kale, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of
The 28th Conference on Learning Theory</em>, volume&nbsp;40 of <em class="ltx_emph ltx_font_italic" id="bib.bib14.2.2">Proceedings of
Machine Learning Research</em>, pages 563–587, Paris, France, 03–06 Jul 2015.
PMLR.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v40/Dudik15.html" title="">https://proceedings.mlr.press/v40/Dudik15.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Go et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Go, T.&nbsp;Korbak, G.&nbsp;Kruszewski, J.&nbsp;Rozen, N.&nbsp;Ryu, and M.&nbsp;Dymetman.

</span>
<span class="ltx_bibblock">Aligning language models with preferences through f-divergence
minimization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 40th International Conference on Machine
Learning</em>, ICML’23. JMLR.org, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jain et&nbsp;al. [2013]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A.&nbsp;Jain, B.&nbsp;Wojcik, T.&nbsp;Joachims, and A.&nbsp;Saxena.

</span>
<span class="ltx_bibblock">Learning trajectory preferences for manipulators via iterative
improvement.

</span>
<span class="ltx_bibblock">In C.&nbsp;Burges, L.&nbsp;Bottou, M.&nbsp;Welling, Z.&nbsp;Ghahramani, and
K.&nbsp;Weinberger, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Advances in Neural Information Processing
Systems</em>, volume&nbsp;26. Curran Associates, Inc., 2013.

</span>
<span class="ltx_bibblock">URL
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2013/file/c058f544c737782deacefa532d9add4c-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2013/file/c058f544c737782deacefa532d9add4c-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Korbak et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
T.&nbsp;Korbak, H.&nbsp;Elsahar, G.&nbsp;Kruszewski, and M.&nbsp;Dymetman.

</span>
<span class="ltx_bibblock">On reinforcement learning and distribution matching for fine-tuning
language models with no catastrophic forgetting.

</span>
<span class="ltx_bibblock">In S.&nbsp;Koyejo, S.&nbsp;Mohamed, A.&nbsp;Agarwal, D.&nbsp;Belgrave, K.&nbsp;Cho, and A.&nbsp;Oh,
editors, <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;35,
pages 16203–16220. Curran Associates, Inc., 2022.

</span>
<span class="ltx_bibblock">URL
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2022/file/67496dfa96afddab795530cc7c69b57a-Paper-Conference.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2022/file/67496dfa96afddab795530cc7c69b57a-Paper-Conference.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kreutzer et&nbsp;al. [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
J.&nbsp;Kreutzer, J.&nbsp;Uyheng, and S.&nbsp;Riezler.

</span>
<span class="ltx_bibblock">Reliability and learnability of human bandit feedback for
sequence-to-sequence reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 56th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pages 1777–1788,
Melbourne, Australia, July 2018. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.18653/v1/P18-1165" title="">10.18653/v1/P18-1165</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P18-1165" title="">https://aclanthology.org/P18-1165</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kupcsik et&nbsp;al. [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A.&nbsp;Kupcsik, D.&nbsp;Hsu, and W.&nbsp;S. Lee.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Learning Dynamic Robot-to-Human Object Handover from Human
Feedback</em>, pages 161–176.

</span>
<span class="ltx_bibblock">Springer International Publishing, 01 2018.

</span>
<span class="ltx_bibblock">ISBN 978-3-319-51531-1.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.1007/978-3-319-51532-8_10" title="">10.1007/978-3-319-51532-8_10</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levine [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Levine.

</span>
<span class="ltx_bibblock">Reinforcement learning and control as probabilistic inference:
Tutorial and review, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luce [2012]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;D. Luce.

</span>
<span class="ltx_bibblock">Individual choice behavior: A theoretical analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Courier Corporation</em>, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maas et&nbsp;al. [2011]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A.&nbsp;L. Maas, R.&nbsp;E. Daly, P.&nbsp;T. Pham, D.&nbsp;Huang, A.&nbsp;Y. Ng, and C.&nbsp;Potts.

</span>
<span class="ltx_bibblock">Learning word vectors for sentiment analysis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 49th Annual Meeting of the Association
for Computational Linguistics: Human Language Technologies</em>, pages 142–150,
Portland, Oregon, USA, June 2011. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://www.aclweb.org/anthology/P11-1015" title="">http://www.aclweb.org/anthology/P11-1015</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mishra et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Mishra, D.&nbsp;Khashabi, C.&nbsp;Baral, and H.&nbsp;Hajishirzi.

</span>
<span class="ltx_bibblock">Cross-task generalization via natural language crowdsourcing
instructions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the 60th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pages 3470–3487,
Dublin, Ireland, May 2022. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.18653/v1/2022.acl-long.244" title="">10.18653/v1/2022.acl-long.244</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2022.acl-long.244" title="">https://aclanthology.org/2022.acl-long.244</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nallapati et&nbsp;al. [2016]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;Nallapati, B.&nbsp;Zhou, C.&nbsp;dos Santos, Ç.&nbsp;Gulçehre, and B.&nbsp;Xiang.

</span>
<span class="ltx_bibblock">Abstractive text summarization using sequence-to-sequence RNNs and
beyond.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 20th SIGNLL Conference on Computational
Natural Language Learning</em>, pages 280–290, Berlin, Germany, Aug. 2016.
Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.18653/v1/K16-1028" title="">10.18653/v1/K16-1028</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/K16-1028" title="">https://aclanthology.org/K16-1028</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narayanan et&nbsp;al. [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Narayanan, M.&nbsp;Shoeybi, J.&nbsp;Casper, P.&nbsp;LeGresley, M.&nbsp;Patwary, V.&nbsp;Korthikanti,
D.&nbsp;Vainbrand, P.&nbsp;Kashinkunti, J.&nbsp;Bernauer, B.&nbsp;Catanzaro, A.&nbsp;Phanishayee, and
M.&nbsp;Zaharia.

</span>
<span class="ltx_bibblock">Efficient large-scale language model training on gpu clusters using
megatron-lm.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the International Conference for High
Performance Computing, Networking, Storage and Analysis</em>, SC ’21, New York,
NY, USA, 2021. Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450384421.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.1145/3458817.3476209" title="">10.1145/3458817.3476209</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3458817.3476209" title="">https://doi.org/10.1145/3458817.3476209</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
L.&nbsp;Ouyang, J.&nbsp;Wu, X.&nbsp;Jiang, D.&nbsp;Almeida, C.&nbsp;Wainwright, P.&nbsp;Mishkin, C.&nbsp;Zhang,
S.&nbsp;Agarwal, K.&nbsp;Slama, A.&nbsp;Ray, J.&nbsp;Schulman, J.&nbsp;Hilton, F.&nbsp;Kelton, L.&nbsp;Miller,
M.&nbsp;Simens, A.&nbsp;Askell, P.&nbsp;Welinder, P.&nbsp;F. Christiano, J.&nbsp;Leike, and R.&nbsp;Lowe.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock">In S.&nbsp;Koyejo, S.&nbsp;Mohamed, A.&nbsp;Agarwal, D.&nbsp;Belgrave, K.&nbsp;Cho, and A.&nbsp;Oh,
editors, <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;35,
pages 27730–27744. Curran Associates, Inc., 2022.

</span>
<span class="ltx_bibblock">URL
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2022/file/b1efde53be364a73914f58805a001731-Paper-Conference.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2022/file/b1efde53be364a73914f58805a001731-Paper-Conference.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paulus et&nbsp;al. [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;Paulus, C.&nbsp;Xiong, and R.&nbsp;Socher.

</span>
<span class="ltx_bibblock">A deep reinforced model for abstractive summarization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">International Conference on Learning Representations</em>, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=HkAClQgA-" title="">https://openreview.net/forum?id=HkAClQgA-</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et&nbsp;al. [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
X.&nbsp;B. Peng, A.&nbsp;Kumar, G.&nbsp;Zhang, and S.&nbsp;Levine.

</span>
<span class="ltx_bibblock">Advantage-weighted regression: Simple and scalable off-policy
reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:1910.00177</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peters and Schaal [2007]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
J.&nbsp;Peters and S.&nbsp;Schaal.

</span>
<span class="ltx_bibblock">Reinforcement learning by reward-weighted regression for operational
space control.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 24th international conference on Machine
learning</em>, pages 745–750, 2007.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Plackett [1975]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;L. Plackett.

</span>
<span class="ltx_bibblock">The analysis of permutations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Journal of the Royal Statistical Society. Series C (Applied
Statistics)</em>, 24(2):193–202, 1975.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="https://doi.org/10.2307/2346567" title="">https://doi.org/10.2307/2346567</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A.&nbsp;Radford, J.&nbsp;Wu, R.&nbsp;Child, D.&nbsp;Luan, D.&nbsp;Amodei, and I.&nbsp;Sutskever.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners, 2019.

</span>
<span class="ltx_bibblock">Ms., OpenAI.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramamurthy et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;Ramamurthy, P.&nbsp;Ammanabrolu, K.&nbsp;Brantley, J.&nbsp;Hessel, R.&nbsp;Sifa, C.&nbsp;Bauckhage,
H.&nbsp;Hajishirzi, and Y.&nbsp;Choi.

</span>
<span class="ltx_bibblock">Is reinforcement learning (not) for natural language processing:
Benchmarks, baselines, and building blocks for natural language policy
optimization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">The Eleventh International Conference on Learning
Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=8aHzds2uUyB" title="">https://openreview.net/forum?id=8aHzds2uUyB</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ranzato et&nbsp;al. [2015]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
M.&nbsp;Ranzato, S.&nbsp;Chopra, M.&nbsp;Auli, and W.&nbsp;Zaremba.

</span>
<span class="ltx_bibblock">Sequence level training with recurrent neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">CoRR</em>, abs/1511.06732, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sadigh et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;Sadigh, A.&nbsp;D. Dragan, S.&nbsp;Sastry, and S.&nbsp;A. Seshia.

</span>
<span class="ltx_bibblock">Active preference-based learning of reward functions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Robotics: Science and Systems (RSS)</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saha et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A.&nbsp;Saha, A.&nbsp;Pacchiano, and J.&nbsp;Lee.

</span>
<span class="ltx_bibblock">Dueling rl: Reinforcement learning with trajectory preferences.

</span>
<span class="ltx_bibblock">In F.&nbsp;Ruiz, J.&nbsp;Dy, and J.-W. van&nbsp;de Meent, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings
of The 26th International Conference on Artificial Intelligence and
Statistics</em>, volume 206 of <em class="ltx_emph ltx_font_italic" id="bib.bib35.2.2">Proceedings of Machine Learning Research</em>,
pages 6263–6289. PMLR, 25–27 Apr 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v206/saha23a.html" title="">https://proceedings.mlr.press/v206/saha23a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
V.&nbsp;Sanh, A.&nbsp;Webson, C.&nbsp;Raffel, S.&nbsp;Bach, L.&nbsp;Sutawika, Z.&nbsp;Alyafeai, A.&nbsp;Chaffin,
A.&nbsp;Stiegler, A.&nbsp;Raja, M.&nbsp;Dey, M.&nbsp;S. Bari, C.&nbsp;Xu, U.&nbsp;Thakker, S.&nbsp;S. Sharma,
E.&nbsp;Szczechla, T.&nbsp;Kim, G.&nbsp;Chhablani, N.&nbsp;Nayak, D.&nbsp;Datta, J.&nbsp;Chang, M.&nbsp;T.-J.
Jiang, H.&nbsp;Wang, M.&nbsp;Manica, S.&nbsp;Shen, Z.&nbsp;X. Yong, H.&nbsp;Pandey, R.&nbsp;Bawden,
T.&nbsp;Wang, T.&nbsp;Neeraj, J.&nbsp;Rozen, A.&nbsp;Sharma, A.&nbsp;Santilli, T.&nbsp;Fevry, J.&nbsp;A. Fries,
R.&nbsp;Teehan, T.&nbsp;L. Scao, S.&nbsp;Biderman, L.&nbsp;Gao, T.&nbsp;Wolf, and A.&nbsp;M. Rush.

</span>
<span class="ltx_bibblock">Multitask prompted training enables zero-shot task generalization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">International Conference on Learning Representations</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=9Vrb9D0WI4" title="">https://openreview.net/forum?id=9Vrb9D0WI4</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
J.&nbsp;Schulman, F.&nbsp;Wolski, P.&nbsp;Dhariwal, A.&nbsp;Radford, and O.&nbsp;Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stiennon et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
N.&nbsp;Stiennon, L.&nbsp;Ouyang, J.&nbsp;Wu, D.&nbsp;M. Ziegler, R.&nbsp;Lowe, C.&nbsp;Voss, A.&nbsp;Radford,
D.&nbsp;Amodei, and P.&nbsp;Christiano.

</span>
<span class="ltx_bibblock">Learning to summarize from human feedback, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thoppilan et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;Thoppilan, D.&nbsp;D. Freitas, J.&nbsp;Hall, N.&nbsp;Shazeer, A.&nbsp;Kulshreshtha, H.-T. Cheng,
A.&nbsp;Jin, T.&nbsp;Bos, L.&nbsp;Baker, Y.&nbsp;Du, Y.&nbsp;Li, H.&nbsp;Lee, H.&nbsp;S. Zheng, A.&nbsp;Ghafouri,
M.&nbsp;Menegali, Y.&nbsp;Huang, M.&nbsp;Krikun, D.&nbsp;Lepikhin, J.&nbsp;Qin, D.&nbsp;Chen, Y.&nbsp;Xu,
Z.&nbsp;Chen, A.&nbsp;Roberts, M.&nbsp;Bosma, V.&nbsp;Zhao, Y.&nbsp;Zhou, C.-C. Chang, I.&nbsp;Krivokon,
W.&nbsp;Rusch, M.&nbsp;Pickett, P.&nbsp;Srinivasan, L.&nbsp;Man, K.&nbsp;Meier-Hellstern, M.&nbsp;R.
Morris, T.&nbsp;Doshi, R.&nbsp;D. Santos, T.&nbsp;Duke, J.&nbsp;Soraker, B.&nbsp;Zevenbergen,
V.&nbsp;Prabhakaran, M.&nbsp;Diaz, B.&nbsp;Hutchinson, K.&nbsp;Olson, A.&nbsp;Molina, E.&nbsp;Hoffman-John,
J.&nbsp;Lee, L.&nbsp;Aroyo, R.&nbsp;Rajakumar, A.&nbsp;Butryna, M.&nbsp;Lamm, V.&nbsp;Kuzmina, J.&nbsp;Fenton,
A.&nbsp;Cohen, R.&nbsp;Bernstein, R.&nbsp;Kurzweil, B.&nbsp;Aguera-Arcas, C.&nbsp;Cui, M.&nbsp;Croak,
E.&nbsp;Chi, and Q.&nbsp;Le.

</span>
<span class="ltx_bibblock">Lamda: Language models for dialog applications, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
H.&nbsp;Touvron, T.&nbsp;Lavril, G.&nbsp;Izacard, X.&nbsp;Martinet, M.-A. Lachaux, T.&nbsp;Lacroix,
B.&nbsp;Rozière, N.&nbsp;Goyal, E.&nbsp;Hambro, F.&nbsp;Azhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Völske et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
M.&nbsp;Völske, M.&nbsp;Potthast, S.&nbsp;Syed, and B.&nbsp;Stein.

</span>
<span class="ltx_bibblock">TL;DR: Mining Reddit to learn automatic summarization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Proceedings of the Workshop on New Frontiers in
Summarization</em>, pages 59–63, Copenhagen, Denmark, Sept. 2017. Association
for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.18653/v1/W17-4508" title="">10.18653/v1/W17-4508</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/W17-4508" title="">https://aclanthology.org/W17-4508</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">von Werra et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
L.&nbsp;von Werra, J.&nbsp;Tow, reciprocated, S.&nbsp;Matiana, A.&nbsp;Havrilla, cat state,
L.&nbsp;Castricato, Alan, D.&nbsp;V. Phung, A.&nbsp;Thakur, A.&nbsp;Bukhtiyarov, aaronrmm,
F.&nbsp;Milo, Daniel, D.&nbsp;King, D.&nbsp;Shin, E.&nbsp;Kim, J.&nbsp;Wei, M.&nbsp;Romero, N.&nbsp;Pochinkov,
O.&nbsp;Sanseviero, R.&nbsp;Adithyan, S.&nbsp;Siu, T.&nbsp;Simonini, V.&nbsp;Blagojevic, X.&nbsp;Song,
Z.&nbsp;Witten, alexandremuzio, and crumb.

</span>
<span class="ltx_bibblock">CarperAI/trlx: v0.6.0: LLaMa (Alpaca), Benchmark Util, T5 ILQL,
Tests, Mar. 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.5281/zenodo.7790115" title="">https://doi.org/10.5281/zenodo.7790115</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Komatsuzaki [2021]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
B.&nbsp;Wang and A.&nbsp;Komatsuzaki.

</span>
<span class="ltx_bibblock">GPT-J-6B: A 6 Billion Parameter Autoregressive Language Model.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/kingoflolz/mesh-transformer-jax" title="">https://github.com/kingoflolz/mesh-transformer-jax</a>, May 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Welleck et&nbsp;al. [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
S.&nbsp;Welleck, I.&nbsp;Kulikov, S.&nbsp;Roller, E.&nbsp;Dinan, K.&nbsp;Cho, and J.&nbsp;Weston.

</span>
<span class="ltx_bibblock">Neural text generation with unlikelihood training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:1908.04319</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams [1992]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
R.&nbsp;J. Williams.

</span>
<span class="ltx_bibblock">Simple statistical gradient-following algorithms for connectionist
reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Mach. Learn.</em>, 8(3–4):229–256, may
1992.

</span>
<span class="ltx_bibblock">ISSN 0885-6125.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.1007/BF00992696" title="">10.1007/BF00992696</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/BF00992696" title="">https://doi.org/10.1007/BF00992696</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu and Hu [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Y.&nbsp;Wu and B.&nbsp;Hu.

</span>
<span class="ltx_bibblock">Learning to extract coherent summary via deep reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Proceedings of the Thirty-Second AAAI Conference on
Artificial Intelligence and Thirtieth Innovative Applications of Artificial
Intelligence Conference and Eighth AAAI Symposium on Educational Advances in
Artificial Intelligence</em>, AAAI’18/IAAI’18/EAAI’18. AAAI Press, 2018.

</span>
<span class="ltx_bibblock">ISBN 978-1-57735-800-8.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
X.&nbsp;Yan, C.&nbsp;Luo, C.&nbsp;L.&nbsp;A. Clarke, N.&nbsp;Craswell, E.&nbsp;M. Voorhees, and P.&nbsp;Castells.

</span>
<span class="ltx_bibblock">Human preferences as dueling bandits.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Proceedings of the 45th International ACM SIGIR Conference
on Research and Development in Information Retrieval</em>, SIGIR ’22, page
567–577, New York, NY, USA, 2022. Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450387323.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.1145/3477495.3531991" title="">10.1145/3477495.3531991</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3477495.3531991" title="">https://doi.org/10.1145/3477495.3531991</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et&nbsp;al. [2012]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Y.&nbsp;Yue, J.&nbsp;Broder, R.&nbsp;Kleinberg, and T.&nbsp;Joachims.

</span>
<span class="ltx_bibblock">The k-armed dueling bandits problem.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Journal of Computer and System Sciences</em>, 78(5):1538–1556, 2012.

</span>
<span class="ltx_bibblock">ISSN 0022-0000.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="https://doi.org/10.1016/j.jcss.2011.12.028" title="">https://doi.org/10.1016/j.jcss.2011.12.028</a>.

</span>
<span class="ltx_bibblock">URL
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S0022000012000281" title="">https://www.sciencedirect.com/science/article/pii/S0022000012000281</a>.

</span>
<span class="ltx_bibblock">JCSS Special Issue: Cloud Computing 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ziegler et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
D.&nbsp;M. Ziegler, N.&nbsp;Stiennon, J.&nbsp;Wu, T.&nbsp;B. Brown, A.&nbsp;Radford, D.&nbsp;Amodei,
P.&nbsp;Christiano, and G.&nbsp;Irving.

</span>
<span class="ltx_bibblock">Fine-tuning language models from human preferences, 2020.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Author Contributions</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="Ax1.p1">
<p class="ltx_p" id="Ax1.p1.1"><span class="ltx_text ltx_font_bold" id="Ax1.p1.1.1">모든 저자</span>은 실험에 대한 설계, 분석 및 반복, 논문 작성 및 편집, 일반적으로 프로젝트의 진행 상황을 관리하는 데 귀중한 기여를 제공했다.</p>
</div>
<div class="ltx_para" id="Ax1.p2">
<p class="ltx_p" id="Ax1.p2.1"><span class="ltx_text ltx_font_bold" id="Ax1.p2.1.1">RR</span>은 <span class="ltx_text ltx_font_bold" id="Ax1.p2.1.2">EM</span>과의 논의에서 자기회귀 보상 모델을 사용하여 제안되었으며, DPO 목적을 도출했으며, 알고리즘의 이론적 특성을 증명하고 관련 섹션 및 부록을 작성했다. 그는 또한 실험을 조직하는 것을 제안하고 도왔고 PPO와 보상 학습 기준선의 일부를 기여했다.</p>
</div>
<div class="ltx_para" id="Ax1.p3">
<p class="ltx_p" id="Ax1.p3.1"><span class="ltx_text ltx_font_bold" id="Ax1.p3.1.1">AS</span>은 PPO의 대안으로 가중치 회귀 방법을 사용하는 것에 대한 논의를 시작했으며, 프로젝트 관련 조직은 DPO와 가중치 회귀 및 비우도를 연결하는 초기 분석을 작성했으며, DPO + 기본 구현의 설계 및 반복, DPO에 대한 초기 탐색 실험, 실질적인 실험 조직 및 설계(데이터 세트, 기준선, 평가); 통제된 감정 생성 및 요약을 위한 모델 훈련 및 평가, GPT-4 평가(특히 요약)를 위한 설계 반복; 추상, 사전림/방법 및 실험에 대한 실질적인 작성 기여, 다른 섹션에 대한 편집 기여.</p>
</div>
<div class="ltx_para" id="Ax1.p4">
<p class="ltx_p" id="Ax1.p4.1"><span class="ltx_text ltx_font_bold" id="Ax1.p4.1.1">EM</span>은 자기회귀 보상 함수 학습에 대한 초기 토론에 대한 입력을 제공했으며, DPO의 첫 번째 구현을 작성하고 첫 번째 DPO 실험을 실행했으며, 종이 실험에 사용된 대규모(요약 및 대화) DPO 모델을 훈련했으며, 초기 GPT-4 승률 평가를 수행하고 관련 인프라를 설정했으며, 인간 연구의 결과를 위해 참가자를 모집하고, 수행 및 분석했으며, 초록, 소개, 관련 작업, 토론 및 대부분의 실험을 작성했으며, 나머지 논문의 편집을 지원했다.</p>
</div>
<div class="ltx_para" id="Ax1.p5">
<p class="ltx_p" id="Ax1.p5.1"><span class="ltx_text ltx_font_bold" id="Ax1.p5.1.1">CF, CM, &amp; SE</span>는 연구를 감독하고 아이디어와 실험을 제안했으며 논문 작성에 도움을 주었다.</p>
</div>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Mathematical Derivations</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Deriving the Optimum of the KL-Constrained Reward Maximization Objective</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.3">이 부록에서, 우리는 Eq를 도출할 것이다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E4" title="4 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>. (p<0.05). <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S3.E3" title="3 ‣ 3 Preliminaries ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">3</span></a>, 우리는 다음의 목적을 최적화한다:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\pi}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi}\bigl{[}r(x,y)\bigr{]}-\beta%
\mathbb{D}_{\textrm{KL}}\bigl{[}\pi(y|x)||\pi_{\text{ref}}(y|x)\bigr{]}" class="ltx_math_unparsed" display="block" id="A1.E11.m1.4"><semantics id="A1.E11.m1.4a"><mrow id="A1.E11.m1.4b"><munder id="A1.E11.m1.4.5"><mi id="A1.E11.m1.4.5.2">max</mi><mi id="A1.E11.m1.4.5.3">π</mi></munder><msub id="A1.E11.m1.4.6"><mi id="A1.E11.m1.4.6.2">𝔼</mi><mrow id="A1.E11.m1.2.2.2.2"><mrow id="A1.E11.m1.1.1.1.1.1"><mi id="A1.E11.m1.1.1.1.1.1.2">x</mi><mo id="A1.E11.m1.1.1.1.1.1.1">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E11.m1.1.1.1.1.1.3">𝒟</mi></mrow><mo id="A1.E11.m1.2.2.2.2.3">,</mo><mrow id="A1.E11.m1.2.2.2.2.2"><mi id="A1.E11.m1.2.2.2.2.2.2">y</mi><mo id="A1.E11.m1.2.2.2.2.2.1">∼</mo><mi id="A1.E11.m1.2.2.2.2.2.3">π</mi></mrow></mrow></msub><mrow id="A1.E11.m1.4.7"><mo id="A1.E11.m1.4.7.1" maxsize="120%" minsize="120%">[</mo><mi id="A1.E11.m1.4.7.2">r</mi><mrow id="A1.E11.m1.4.7.3"><mo id="A1.E11.m1.4.7.3.1" stretchy="false">(</mo><mi id="A1.E11.m1.3.3">x</mi><mo id="A1.E11.m1.4.7.3.2">,</mo><mi id="A1.E11.m1.4.4">y</mi><mo id="A1.E11.m1.4.7.3.3" stretchy="false">)</mo></mrow><mo id="A1.E11.m1.4.7.4" maxsize="120%" minsize="120%">]</mo></mrow><mo id="A1.E11.m1.4.8">−</mo><mi id="A1.E11.m1.4.9">β</mi><msub id="A1.E11.m1.4.10"><mi id="A1.E11.m1.4.10.2">𝔻</mi><mtext id="A1.E11.m1.4.10.3">KL</mtext></msub><mrow id="A1.E11.m1.4.11"><mo id="A1.E11.m1.4.11.1" maxsize="120%" minsize="120%">[</mo><mi id="A1.E11.m1.4.11.2">π</mi><mrow id="A1.E11.m1.4.11.3"><mo id="A1.E11.m1.4.11.3.1" stretchy="false">(</mo><mi id="A1.E11.m1.4.11.3.2">y</mi><mo fence="false" id="A1.E11.m1.4.11.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E11.m1.4.11.3.4">x</mi><mo id="A1.E11.m1.4.11.3.5" stretchy="false">)</mo></mrow><mo fence="false" id="A1.E11.m1.4.11.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E11.m1.4.11.5" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E11.m1.4.11.6"><mi id="A1.E11.m1.4.11.6.2">π</mi><mtext id="A1.E11.m1.4.11.6.3">ref</mtext></msub><mrow id="A1.E11.m1.4.11.7"><mo id="A1.E11.m1.4.11.7.1" stretchy="false">(</mo><mi id="A1.E11.m1.4.11.7.2">y</mi><mo fence="false" id="A1.E11.m1.4.11.7.3" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E11.m1.4.11.7.4">x</mi><mo id="A1.E11.m1.4.11.7.5" stretchy="false">)</mo></mrow><mo id="A1.E11.m1.4.11.8" maxsize="120%" minsize="120%">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E11.m1.4c">\max_{\pi}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi}\bigl{[}r(x,y)\bigr{]}-\beta%
\mathbb{D}_{\textrm{KL}}\bigl{[}\pi(y|x)||\pi_{\text{ref}}(y|x)\bigr{]}</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.4d">roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D , italic_y ∼ italic_π end_POSTSUBSCRIPT [ italic_r ( italic_x , italic_y ) ] - italic_β blackboard_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT [ italic_π ( italic_y | italic_x ) | | italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.2">임의의 보상 함수 <math alttext="r(x,y)" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.2"><semantics id="A1.SS1.p1.1.m1.2a"><mrow id="A1.SS1.p1.1.m1.2.3" xref="A1.SS1.p1.1.m1.2.3.cmml"><mi id="A1.SS1.p1.1.m1.2.3.2" xref="A1.SS1.p1.1.m1.2.3.2.cmml">r</mi><mo id="A1.SS1.p1.1.m1.2.3.1" xref="A1.SS1.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A1.SS1.p1.1.m1.2.3.3.2" xref="A1.SS1.p1.1.m1.2.3.3.1.cmml"><mo id="A1.SS1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="A1.SS1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">x</mi><mo id="A1.SS1.p1.1.m1.2.3.3.2.2" xref="A1.SS1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="A1.SS1.p1.1.m1.2.2" xref="A1.SS1.p1.1.m1.2.2.cmml">y</mi><mo id="A1.SS1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="A1.SS1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.2b"><apply id="A1.SS1.p1.1.m1.2.3.cmml" xref="A1.SS1.p1.1.m1.2.3"><times id="A1.SS1.p1.1.m1.2.3.1.cmml" xref="A1.SS1.p1.1.m1.2.3.1"></times><ci id="A1.SS1.p1.1.m1.2.3.2.cmml" xref="A1.SS1.p1.1.m1.2.3.2">𝑟</ci><interval closure="open" id="A1.SS1.p1.1.m1.2.3.3.1.cmml" xref="A1.SS1.p1.1.m1.2.3.3.2"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑥</ci><ci id="A1.SS1.p1.1.m1.2.2.cmml" xref="A1.SS1.p1.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math>, 참조 모델 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><msub id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml">π</mi><mtext id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2">𝜋</ci><ci id="A1.SS1.p1.2.m2.1.1.3a.cmml" xref="A1.SS1.p1.2.m2.1.1.3"><mtext id="A1.SS1.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="A1.SS1.p1.2.m2.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> 및 일반 비모수 정책 클래스 하에서. 이제 우리는...</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx1">
<tbody id="A1.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\max_{\pi}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi}" class="ltx_Math" display="inline" id="A1.Ex1.m1.2"><semantics id="A1.Ex1.m1.2a"><mrow id="A1.Ex1.m1.2.3" xref="A1.Ex1.m1.2.3.cmml"><munder id="A1.Ex1.m1.2.3.1" xref="A1.Ex1.m1.2.3.1.cmml"><mi id="A1.Ex1.m1.2.3.1.2" xref="A1.Ex1.m1.2.3.1.2.cmml">max</mi><mi id="A1.Ex1.m1.2.3.1.3" xref="A1.Ex1.m1.2.3.1.3.cmml">π</mi></munder><mo id="A1.Ex1.m1.2.3a" lspace="0.167em" xref="A1.Ex1.m1.2.3.cmml">⁡</mo><msub id="A1.Ex1.m1.2.3.2" xref="A1.Ex1.m1.2.3.2.cmml"><mi id="A1.Ex1.m1.2.3.2.2" xref="A1.Ex1.m1.2.3.2.2.cmml">𝔼</mi><mrow id="A1.Ex1.m1.2.2.2.2" xref="A1.Ex1.m1.2.2.2.3.cmml"><mrow id="A1.Ex1.m1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.2.cmml">x</mi><mo id="A1.Ex1.m1.1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m1.1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.3.cmml">𝒟</mi></mrow><mo id="A1.Ex1.m1.2.2.2.2.3" xref="A1.Ex1.m1.2.2.2.3a.cmml">,</mo><mrow id="A1.Ex1.m1.2.2.2.2.2" xref="A1.Ex1.m1.2.2.2.2.2.cmml"><mi id="A1.Ex1.m1.2.2.2.2.2.2" xref="A1.Ex1.m1.2.2.2.2.2.2.cmml">y</mi><mo id="A1.Ex1.m1.2.2.2.2.2.1" xref="A1.Ex1.m1.2.2.2.2.2.1.cmml">∼</mo><mi id="A1.Ex1.m1.2.2.2.2.2.3" xref="A1.Ex1.m1.2.2.2.2.2.3.cmml">π</mi></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.2b"><apply id="A1.Ex1.m1.2.3.cmml" xref="A1.Ex1.m1.2.3"><apply id="A1.Ex1.m1.2.3.1.cmml" xref="A1.Ex1.m1.2.3.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.3.1.1.cmml" xref="A1.Ex1.m1.2.3.1">subscript</csymbol><max id="A1.Ex1.m1.2.3.1.2.cmml" xref="A1.Ex1.m1.2.3.1.2"></max><ci id="A1.Ex1.m1.2.3.1.3.cmml" xref="A1.Ex1.m1.2.3.1.3">𝜋</ci></apply><apply id="A1.Ex1.m1.2.3.2.cmml" xref="A1.Ex1.m1.2.3.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.3.2.1.cmml" xref="A1.Ex1.m1.2.3.2">subscript</csymbol><ci id="A1.Ex1.m1.2.3.2.2.cmml" xref="A1.Ex1.m1.2.3.2.2">𝔼</ci><apply id="A1.Ex1.m1.2.2.2.3.cmml" xref="A1.Ex1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.2.2.3a.cmml" xref="A1.Ex1.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.Ex1.m1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex1.m1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1">similar-to</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.2">𝑥</ci><ci id="A1.Ex1.m1.1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.3">𝒟</ci></apply><apply id="A1.Ex1.m1.2.2.2.2.2.cmml" xref="A1.Ex1.m1.2.2.2.2.2"><csymbol cd="latexml" id="A1.Ex1.m1.2.2.2.2.2.1.cmml" xref="A1.Ex1.m1.2.2.2.2.2.1">similar-to</csymbol><ci id="A1.Ex1.m1.2.2.2.2.2.2.cmml" xref="A1.Ex1.m1.2.2.2.2.2.2">𝑦</ci><ci id="A1.Ex1.m1.2.2.2.2.2.3.cmml" xref="A1.Ex1.m1.2.2.2.2.2.3">𝜋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.2c">\displaystyle\max_{\pi}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.2d">roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D , italic_y ∼ italic_π end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\bigl{[}r(x,y)\bigr{]}-\beta\mathbb{D}_{\textrm{KL}}\bigl{[}\pi(y%
|x)\mid\mid\pi_{\text{ref}}(y|x)\bigr{]}" class="ltx_math_unparsed" display="inline" id="A1.Ex1.m2.2"><semantics id="A1.Ex1.m2.2a"><mrow id="A1.Ex1.m2.2b"><mrow id="A1.Ex1.m2.2.3"><mo id="A1.Ex1.m2.2.3.1" maxsize="120%" minsize="120%">[</mo><mi id="A1.Ex1.m2.2.3.2">r</mi><mrow id="A1.Ex1.m2.2.3.3"><mo id="A1.Ex1.m2.2.3.3.1" stretchy="false">(</mo><mi id="A1.Ex1.m2.1.1">x</mi><mo id="A1.Ex1.m2.2.3.3.2">,</mo><mi id="A1.Ex1.m2.2.2">y</mi><mo id="A1.Ex1.m2.2.3.3.3" stretchy="false">)</mo></mrow><mo id="A1.Ex1.m2.2.3.4" maxsize="120%" minsize="120%">]</mo></mrow><mo id="A1.Ex1.m2.2.4">−</mo><mi id="A1.Ex1.m2.2.5">β</mi><msub id="A1.Ex1.m2.2.6"><mi id="A1.Ex1.m2.2.6.2">𝔻</mi><mtext id="A1.Ex1.m2.2.6.3">KL</mtext></msub><mrow id="A1.Ex1.m2.2.7"><mo id="A1.Ex1.m2.2.7.1" maxsize="120%" minsize="120%">[</mo><mi id="A1.Ex1.m2.2.7.2">π</mi><mrow id="A1.Ex1.m2.2.7.3"><mo id="A1.Ex1.m2.2.7.3.1" stretchy="false">(</mo><mi id="A1.Ex1.m2.2.7.3.2">y</mi><mo fence="false" id="A1.Ex1.m2.2.7.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="A1.Ex1.m2.2.7.3.4">x</mi><mo id="A1.Ex1.m2.2.7.3.5" stretchy="false">)</mo></mrow><mo id="A1.Ex1.m2.2.7.4" lspace="0em" rspace="0.0835em">∣</mo><mo id="A1.Ex1.m2.2.7.5" lspace="0.0835em" rspace="0.167em">∣</mo><msub id="A1.Ex1.m2.2.7.6"><mi id="A1.Ex1.m2.2.7.6.2">π</mi><mtext id="A1.Ex1.m2.2.7.6.3">ref</mtext></msub><mrow id="A1.Ex1.m2.2.7.7"><mo id="A1.Ex1.m2.2.7.7.1" stretchy="false">(</mo><mi id="A1.Ex1.m2.2.7.7.2">y</mi><mo fence="false" id="A1.Ex1.m2.2.7.7.3" rspace="0.167em" stretchy="false">|</mo><mi id="A1.Ex1.m2.2.7.7.4">x</mi><mo id="A1.Ex1.m2.2.7.7.5" stretchy="false">)</mo></mrow><mo id="A1.Ex1.m2.2.7.8" maxsize="120%" minsize="120%">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex1.m2.2c">\displaystyle\bigl{[}r(x,y)\bigr{]}-\beta\mathbb{D}_{\textrm{KL}}\bigl{[}\pi(y%
|x)\mid\mid\pi_{\text{ref}}(y|x)\bigr{]}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m2.2d">[ italic_r ( italic_x , italic_y ) ] - italic_β blackboard_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT [ italic_π ( italic_y | italic_x ) ∣ ∣ italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\max_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\mathbb{E}_{y\sim\pi(y|x)%
}\left[r(x,y)-\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}\right]" class="ltx_Math" display="inline" id="A1.Ex2.m1.6"><semantics id="A1.Ex2.m1.6a"><mrow id="A1.Ex2.m1.6.6" xref="A1.Ex2.m1.6.6.cmml"><mi id="A1.Ex2.m1.6.6.3" xref="A1.Ex2.m1.6.6.3.cmml"></mi><mo id="A1.Ex2.m1.6.6.2" xref="A1.Ex2.m1.6.6.2.cmml">=</mo><mrow id="A1.Ex2.m1.6.6.1" xref="A1.Ex2.m1.6.6.1.cmml"><mrow id="A1.Ex2.m1.6.6.1.3" xref="A1.Ex2.m1.6.6.1.3.cmml"><munder id="A1.Ex2.m1.6.6.1.3.1" xref="A1.Ex2.m1.6.6.1.3.1.cmml"><mi id="A1.Ex2.m1.6.6.1.3.1.2" xref="A1.Ex2.m1.6.6.1.3.1.2.cmml">max</mi><mi id="A1.Ex2.m1.6.6.1.3.1.3" xref="A1.Ex2.m1.6.6.1.3.1.3.cmml">π</mi></munder><mo id="A1.Ex2.m1.6.6.1.3a" lspace="0.167em" xref="A1.Ex2.m1.6.6.1.3.cmml">⁡</mo><mrow id="A1.Ex2.m1.6.6.1.3.2" xref="A1.Ex2.m1.6.6.1.3.2.cmml"><msub id="A1.Ex2.m1.6.6.1.3.2.2" xref="A1.Ex2.m1.6.6.1.3.2.2.cmml"><mi id="A1.Ex2.m1.6.6.1.3.2.2.2" xref="A1.Ex2.m1.6.6.1.3.2.2.2.cmml">𝔼</mi><mrow id="A1.Ex2.m1.6.6.1.3.2.2.3" xref="A1.Ex2.m1.6.6.1.3.2.2.3.cmml"><mi id="A1.Ex2.m1.6.6.1.3.2.2.3.2" xref="A1.Ex2.m1.6.6.1.3.2.2.3.2.cmml">x</mi><mo id="A1.Ex2.m1.6.6.1.3.2.2.3.1" xref="A1.Ex2.m1.6.6.1.3.2.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex2.m1.6.6.1.3.2.2.3.3" xref="A1.Ex2.m1.6.6.1.3.2.2.3.3.cmml">𝒟</mi></mrow></msub><mo id="A1.Ex2.m1.6.6.1.3.2.1" xref="A1.Ex2.m1.6.6.1.3.2.1.cmml">⁢</mo><msub id="A1.Ex2.m1.6.6.1.3.2.3" xref="A1.Ex2.m1.6.6.1.3.2.3.cmml"><mi id="A1.Ex2.m1.6.6.1.3.2.3.2" xref="A1.Ex2.m1.6.6.1.3.2.3.2.cmml">𝔼</mi><mrow id="A1.Ex2.m1.1.1.1" xref="A1.Ex2.m1.1.1.1.cmml"><mi id="A1.Ex2.m1.1.1.1.3" xref="A1.Ex2.m1.1.1.1.3.cmml">y</mi><mo id="A1.Ex2.m1.1.1.1.2" xref="A1.Ex2.m1.1.1.1.2.cmml">∼</mo><mrow id="A1.Ex2.m1.1.1.1.1" xref="A1.Ex2.m1.1.1.1.1.cmml"><mi id="A1.Ex2.m1.1.1.1.1.3" xref="A1.Ex2.m1.1.1.1.1.3.cmml">π</mi><mo id="A1.Ex2.m1.1.1.1.1.2" xref="A1.Ex2.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex2.m1.1.1.1.1.1.1" xref="A1.Ex2.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex2.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2.m1.1.1.1.1.1.1.1" xref="A1.Ex2.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex2.m1.1.1.1.1.1.1.1.2" xref="A1.Ex2.m1.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex2.m1.1.1.1.1.1.1.1.1" xref="A1.Ex2.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex2.m1.1.1.1.1.1.1.1.3" xref="A1.Ex2.m1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex2.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow><mo id="A1.Ex2.m1.6.6.1.2" xref="A1.Ex2.m1.6.6.1.2.cmml">⁢</mo><mrow id="A1.Ex2.m1.6.6.1.1.1" xref="A1.Ex2.m1.6.6.1.1.2.cmml"><mo id="A1.Ex2.m1.6.6.1.1.1.2" xref="A1.Ex2.m1.6.6.1.1.2.1.cmml">[</mo><mrow id="A1.Ex2.m1.6.6.1.1.1.1" xref="A1.Ex2.m1.6.6.1.1.1.1.cmml"><mrow id="A1.Ex2.m1.6.6.1.1.1.1.2" xref="A1.Ex2.m1.6.6.1.1.1.1.2.cmml"><mi id="A1.Ex2.m1.6.6.1.1.1.1.2.2" xref="A1.Ex2.m1.6.6.1.1.1.1.2.2.cmml">r</mi><mo id="A1.Ex2.m1.6.6.1.1.1.1.2.1" xref="A1.Ex2.m1.6.6.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex2.m1.6.6.1.1.1.1.2.3.2" xref="A1.Ex2.m1.6.6.1.1.1.1.2.3.1.cmml"><mo id="A1.Ex2.m1.6.6.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.Ex2.m1.6.6.1.1.1.1.2.3.1.cmml">(</mo><mi id="A1.Ex2.m1.4.4" xref="A1.Ex2.m1.4.4.cmml">x</mi><mo id="A1.Ex2.m1.6.6.1.1.1.1.2.3.2.2" xref="A1.Ex2.m1.6.6.1.1.1.1.2.3.1.cmml">,</mo><mi id="A1.Ex2.m1.5.5" xref="A1.Ex2.m1.5.5.cmml">y</mi><mo id="A1.Ex2.m1.6.6.1.1.1.1.2.3.2.3" stretchy="false" xref="A1.Ex2.m1.6.6.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex2.m1.6.6.1.1.1.1.1" xref="A1.Ex2.m1.6.6.1.1.1.1.1.cmml">−</mo><mrow id="A1.Ex2.m1.6.6.1.1.1.1.3" xref="A1.Ex2.m1.6.6.1.1.1.1.3.cmml"><mi id="A1.Ex2.m1.6.6.1.1.1.1.3.2" xref="A1.Ex2.m1.6.6.1.1.1.1.3.2.cmml">β</mi><mo id="A1.Ex2.m1.6.6.1.1.1.1.3.1" lspace="0.167em" xref="A1.Ex2.m1.6.6.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex2.m1.6.6.1.1.1.1.3.3" xref="A1.Ex2.m1.6.6.1.1.1.1.3.3.cmml"><mi id="A1.Ex2.m1.6.6.1.1.1.1.3.3.1" xref="A1.Ex2.m1.6.6.1.1.1.1.3.3.1.cmml">log</mi><mo id="A1.Ex2.m1.6.6.1.1.1.1.3.3a" lspace="0.167em" xref="A1.Ex2.m1.6.6.1.1.1.1.3.3.cmml">⁡</mo><mstyle displaystyle="true" id="A1.Ex2.m1.3.3" xref="A1.Ex2.m1.3.3.cmml"><mfrac id="A1.Ex2.m1.3.3a" xref="A1.Ex2.m1.3.3.cmml"><mrow id="A1.Ex2.m1.2.2.1" xref="A1.Ex2.m1.2.2.1.cmml"><mi id="A1.Ex2.m1.2.2.1.3" xref="A1.Ex2.m1.2.2.1.3.cmml">π</mi><mo id="A1.Ex2.m1.2.2.1.2" xref="A1.Ex2.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.Ex2.m1.2.2.1.1.1" xref="A1.Ex2.m1.2.2.1.1.1.1.cmml"><mo id="A1.Ex2.m1.2.2.1.1.1.2" stretchy="false" xref="A1.Ex2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2.m1.2.2.1.1.1.1" xref="A1.Ex2.m1.2.2.1.1.1.1.cmml"><mi id="A1.Ex2.m1.2.2.1.1.1.1.2" xref="A1.Ex2.m1.2.2.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex2.m1.2.2.1.1.1.1.1" xref="A1.Ex2.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex2.m1.2.2.1.1.1.1.3" xref="A1.Ex2.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex2.m1.2.2.1.1.1.3" stretchy="false" xref="A1.Ex2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex2.m1.3.3.2" xref="A1.Ex2.m1.3.3.2.cmml"><msub id="A1.Ex2.m1.3.3.2.3" xref="A1.Ex2.m1.3.3.2.3.cmml"><mi id="A1.Ex2.m1.3.3.2.3.2" xref="A1.Ex2.m1.3.3.2.3.2.cmml">π</mi><mtext id="A1.Ex2.m1.3.3.2.3.3" xref="A1.Ex2.m1.3.3.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex2.m1.3.3.2.2" xref="A1.Ex2.m1.3.3.2.2.cmml">⁢</mo><mrow id="A1.Ex2.m1.3.3.2.1.1" xref="A1.Ex2.m1.3.3.2.1.1.1.cmml"><mo id="A1.Ex2.m1.3.3.2.1.1.2" stretchy="false" xref="A1.Ex2.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="A1.Ex2.m1.3.3.2.1.1.1" xref="A1.Ex2.m1.3.3.2.1.1.1.cmml"><mi id="A1.Ex2.m1.3.3.2.1.1.1.2" xref="A1.Ex2.m1.3.3.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex2.m1.3.3.2.1.1.1.1" xref="A1.Ex2.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex2.m1.3.3.2.1.1.1.3" xref="A1.Ex2.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex2.m1.3.3.2.1.1.3" stretchy="false" xref="A1.Ex2.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="A1.Ex2.m1.6.6.1.1.1.3" xref="A1.Ex2.m1.6.6.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2.m1.6b"><apply id="A1.Ex2.m1.6.6.cmml" xref="A1.Ex2.m1.6.6"><eq id="A1.Ex2.m1.6.6.2.cmml" xref="A1.Ex2.m1.6.6.2"></eq><csymbol cd="latexml" id="A1.Ex2.m1.6.6.3.cmml" xref="A1.Ex2.m1.6.6.3">absent</csymbol><apply id="A1.Ex2.m1.6.6.1.cmml" xref="A1.Ex2.m1.6.6.1"><times id="A1.Ex2.m1.6.6.1.2.cmml" xref="A1.Ex2.m1.6.6.1.2"></times><apply id="A1.Ex2.m1.6.6.1.3.cmml" xref="A1.Ex2.m1.6.6.1.3"><apply id="A1.Ex2.m1.6.6.1.3.1.cmml" xref="A1.Ex2.m1.6.6.1.3.1"><csymbol cd="ambiguous" id="A1.Ex2.m1.6.6.1.3.1.1.cmml" xref="A1.Ex2.m1.6.6.1.3.1">subscript</csymbol><max id="A1.Ex2.m1.6.6.1.3.1.2.cmml" xref="A1.Ex2.m1.6.6.1.3.1.2"></max><ci id="A1.Ex2.m1.6.6.1.3.1.3.cmml" xref="A1.Ex2.m1.6.6.1.3.1.3">𝜋</ci></apply><apply id="A1.Ex2.m1.6.6.1.3.2.cmml" xref="A1.Ex2.m1.6.6.1.3.2"><times id="A1.Ex2.m1.6.6.1.3.2.1.cmml" xref="A1.Ex2.m1.6.6.1.3.2.1"></times><apply id="A1.Ex2.m1.6.6.1.3.2.2.cmml" xref="A1.Ex2.m1.6.6.1.3.2.2"><csymbol cd="ambiguous" id="A1.Ex2.m1.6.6.1.3.2.2.1.cmml" xref="A1.Ex2.m1.6.6.1.3.2.2">subscript</csymbol><ci id="A1.Ex2.m1.6.6.1.3.2.2.2.cmml" xref="A1.Ex2.m1.6.6.1.3.2.2.2">𝔼</ci><apply id="A1.Ex2.m1.6.6.1.3.2.2.3.cmml" xref="A1.Ex2.m1.6.6.1.3.2.2.3"><csymbol cd="latexml" id="A1.Ex2.m1.6.6.1.3.2.2.3.1.cmml" xref="A1.Ex2.m1.6.6.1.3.2.2.3.1">similar-to</csymbol><ci id="A1.Ex2.m1.6.6.1.3.2.2.3.2.cmml" xref="A1.Ex2.m1.6.6.1.3.2.2.3.2">𝑥</ci><ci id="A1.Ex2.m1.6.6.1.3.2.2.3.3.cmml" xref="A1.Ex2.m1.6.6.1.3.2.2.3.3">𝒟</ci></apply></apply><apply id="A1.Ex2.m1.6.6.1.3.2.3.cmml" xref="A1.Ex2.m1.6.6.1.3.2.3"><csymbol cd="ambiguous" id="A1.Ex2.m1.6.6.1.3.2.3.1.cmml" xref="A1.Ex2.m1.6.6.1.3.2.3">subscript</csymbol><ci id="A1.Ex2.m1.6.6.1.3.2.3.2.cmml" xref="A1.Ex2.m1.6.6.1.3.2.3.2">𝔼</ci><apply id="A1.Ex2.m1.1.1.1.cmml" xref="A1.Ex2.m1.1.1.1"><csymbol cd="latexml" id="A1.Ex2.m1.1.1.1.2.cmml" xref="A1.Ex2.m1.1.1.1.2">similar-to</csymbol><ci id="A1.Ex2.m1.1.1.1.3.cmml" xref="A1.Ex2.m1.1.1.1.3">𝑦</ci><apply id="A1.Ex2.m1.1.1.1.1.cmml" xref="A1.Ex2.m1.1.1.1.1"><times id="A1.Ex2.m1.1.1.1.1.2.cmml" xref="A1.Ex2.m1.1.1.1.1.2"></times><ci id="A1.Ex2.m1.1.1.1.1.3.cmml" xref="A1.Ex2.m1.1.1.1.1.3">𝜋</ci><apply id="A1.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex2.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex2.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2.m1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex2.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2.m1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.Ex2.m1.6.6.1.1.2.cmml" xref="A1.Ex2.m1.6.6.1.1.1"><csymbol cd="latexml" id="A1.Ex2.m1.6.6.1.1.2.1.cmml" xref="A1.Ex2.m1.6.6.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex2.m1.6.6.1.1.1.1.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1"><minus id="A1.Ex2.m1.6.6.1.1.1.1.1.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.1"></minus><apply id="A1.Ex2.m1.6.6.1.1.1.1.2.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.2"><times id="A1.Ex2.m1.6.6.1.1.1.1.2.1.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.2.1"></times><ci id="A1.Ex2.m1.6.6.1.1.1.1.2.2.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.2.2">𝑟</ci><interval closure="open" id="A1.Ex2.m1.6.6.1.1.1.1.2.3.1.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.2.3.2"><ci id="A1.Ex2.m1.4.4.cmml" xref="A1.Ex2.m1.4.4">𝑥</ci><ci id="A1.Ex2.m1.5.5.cmml" xref="A1.Ex2.m1.5.5">𝑦</ci></interval></apply><apply id="A1.Ex2.m1.6.6.1.1.1.1.3.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.3"><times id="A1.Ex2.m1.6.6.1.1.1.1.3.1.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.3.1"></times><ci id="A1.Ex2.m1.6.6.1.1.1.1.3.2.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.3.2">𝛽</ci><apply id="A1.Ex2.m1.6.6.1.1.1.1.3.3.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.3.3"><log id="A1.Ex2.m1.6.6.1.1.1.1.3.3.1.cmml" xref="A1.Ex2.m1.6.6.1.1.1.1.3.3.1"></log><apply id="A1.Ex2.m1.3.3.cmml" xref="A1.Ex2.m1.3.3"><divide id="A1.Ex2.m1.3.3.3.cmml" xref="A1.Ex2.m1.3.3"></divide><apply id="A1.Ex2.m1.2.2.1.cmml" xref="A1.Ex2.m1.2.2.1"><times id="A1.Ex2.m1.2.2.1.2.cmml" xref="A1.Ex2.m1.2.2.1.2"></times><ci id="A1.Ex2.m1.2.2.1.3.cmml" xref="A1.Ex2.m1.2.2.1.3">𝜋</ci><apply id="A1.Ex2.m1.2.2.1.1.1.1.cmml" xref="A1.Ex2.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.Ex2.m1.2.2.1.1.1.1.1.cmml" xref="A1.Ex2.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex2.m1.2.2.1.1.1.1.2.cmml" xref="A1.Ex2.m1.2.2.1.1.1.1.2">𝑦</ci><ci id="A1.Ex2.m1.2.2.1.1.1.1.3.cmml" xref="A1.Ex2.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex2.m1.3.3.2.cmml" xref="A1.Ex2.m1.3.3.2"><times id="A1.Ex2.m1.3.3.2.2.cmml" xref="A1.Ex2.m1.3.3.2.2"></times><apply id="A1.Ex2.m1.3.3.2.3.cmml" xref="A1.Ex2.m1.3.3.2.3"><csymbol cd="ambiguous" id="A1.Ex2.m1.3.3.2.3.1.cmml" xref="A1.Ex2.m1.3.3.2.3">subscript</csymbol><ci id="A1.Ex2.m1.3.3.2.3.2.cmml" xref="A1.Ex2.m1.3.3.2.3.2">𝜋</ci><ci id="A1.Ex2.m1.3.3.2.3.3a.cmml" xref="A1.Ex2.m1.3.3.2.3.3"><mtext id="A1.Ex2.m1.3.3.2.3.3.cmml" mathsize="70%" xref="A1.Ex2.m1.3.3.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex2.m1.3.3.2.1.1.1.cmml" xref="A1.Ex2.m1.3.3.2.1.1"><csymbol cd="latexml" id="A1.Ex2.m1.3.3.2.1.1.1.1.cmml" xref="A1.Ex2.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex2.m1.3.3.2.1.1.1.2.cmml" xref="A1.Ex2.m1.3.3.2.1.1.1.2">𝑦</ci><ci id="A1.Ex2.m1.3.3.2.1.1.1.3.cmml" xref="A1.Ex2.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2.m1.6c">\displaystyle=\max_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\mathbb{E}_{y\sim\pi(y|x)%
}\left[r(x,y)-\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2.m1.6d">= roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_y ∼ italic_π ( italic_y | italic_x ) end_POSTSUBSCRIPT [ italic_r ( italic_x , italic_y ) - italic_β roman_log divide start_ARG italic_π ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\min_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\mathbb{E}_{y\sim\pi(y|x)%
}\left[\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}-\frac{1}{\beta}r(x,y)\right]" class="ltx_Math" display="inline" id="A1.Ex3.m1.6"><semantics id="A1.Ex3.m1.6a"><mrow id="A1.Ex3.m1.6.6" xref="A1.Ex3.m1.6.6.cmml"><mi id="A1.Ex3.m1.6.6.3" xref="A1.Ex3.m1.6.6.3.cmml"></mi><mo id="A1.Ex3.m1.6.6.2" xref="A1.Ex3.m1.6.6.2.cmml">=</mo><mrow id="A1.Ex3.m1.6.6.1" xref="A1.Ex3.m1.6.6.1.cmml"><mrow id="A1.Ex3.m1.6.6.1.3" xref="A1.Ex3.m1.6.6.1.3.cmml"><munder id="A1.Ex3.m1.6.6.1.3.1" xref="A1.Ex3.m1.6.6.1.3.1.cmml"><mi id="A1.Ex3.m1.6.6.1.3.1.2" xref="A1.Ex3.m1.6.6.1.3.1.2.cmml">min</mi><mi id="A1.Ex3.m1.6.6.1.3.1.3" xref="A1.Ex3.m1.6.6.1.3.1.3.cmml">π</mi></munder><mo id="A1.Ex3.m1.6.6.1.3a" lspace="0.167em" xref="A1.Ex3.m1.6.6.1.3.cmml">⁡</mo><mrow id="A1.Ex3.m1.6.6.1.3.2" xref="A1.Ex3.m1.6.6.1.3.2.cmml"><msub id="A1.Ex3.m1.6.6.1.3.2.2" xref="A1.Ex3.m1.6.6.1.3.2.2.cmml"><mi id="A1.Ex3.m1.6.6.1.3.2.2.2" xref="A1.Ex3.m1.6.6.1.3.2.2.2.cmml">𝔼</mi><mrow id="A1.Ex3.m1.6.6.1.3.2.2.3" xref="A1.Ex3.m1.6.6.1.3.2.2.3.cmml"><mi id="A1.Ex3.m1.6.6.1.3.2.2.3.2" xref="A1.Ex3.m1.6.6.1.3.2.2.3.2.cmml">x</mi><mo id="A1.Ex3.m1.6.6.1.3.2.2.3.1" xref="A1.Ex3.m1.6.6.1.3.2.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex3.m1.6.6.1.3.2.2.3.3" xref="A1.Ex3.m1.6.6.1.3.2.2.3.3.cmml">𝒟</mi></mrow></msub><mo id="A1.Ex3.m1.6.6.1.3.2.1" xref="A1.Ex3.m1.6.6.1.3.2.1.cmml">⁢</mo><msub id="A1.Ex3.m1.6.6.1.3.2.3" xref="A1.Ex3.m1.6.6.1.3.2.3.cmml"><mi id="A1.Ex3.m1.6.6.1.3.2.3.2" xref="A1.Ex3.m1.6.6.1.3.2.3.2.cmml">𝔼</mi><mrow id="A1.Ex3.m1.1.1.1" xref="A1.Ex3.m1.1.1.1.cmml"><mi id="A1.Ex3.m1.1.1.1.3" xref="A1.Ex3.m1.1.1.1.3.cmml">y</mi><mo id="A1.Ex3.m1.1.1.1.2" xref="A1.Ex3.m1.1.1.1.2.cmml">∼</mo><mrow id="A1.Ex3.m1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.cmml"><mi id="A1.Ex3.m1.1.1.1.1.3" xref="A1.Ex3.m1.1.1.1.1.3.cmml">π</mi><mo id="A1.Ex3.m1.1.1.1.1.2" xref="A1.Ex3.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex3.m1.1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex3.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex3.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex3.m1.1.1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex3.m1.1.1.1.1.1.1.1.2" xref="A1.Ex3.m1.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex3.m1.1.1.1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex3.m1.1.1.1.1.1.1.1.3" xref="A1.Ex3.m1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex3.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow><mo id="A1.Ex3.m1.6.6.1.2" xref="A1.Ex3.m1.6.6.1.2.cmml">⁢</mo><mrow id="A1.Ex3.m1.6.6.1.1.1" xref="A1.Ex3.m1.6.6.1.1.2.cmml"><mo id="A1.Ex3.m1.6.6.1.1.1.2" xref="A1.Ex3.m1.6.6.1.1.2.1.cmml">[</mo><mrow id="A1.Ex3.m1.6.6.1.1.1.1" xref="A1.Ex3.m1.6.6.1.1.1.1.cmml"><mrow id="A1.Ex3.m1.6.6.1.1.1.1.2" xref="A1.Ex3.m1.6.6.1.1.1.1.2.cmml"><mi id="A1.Ex3.m1.6.6.1.1.1.1.2.1" xref="A1.Ex3.m1.6.6.1.1.1.1.2.1.cmml">log</mi><mo id="A1.Ex3.m1.6.6.1.1.1.1.2a" lspace="0.167em" xref="A1.Ex3.m1.6.6.1.1.1.1.2.cmml">⁡</mo><mstyle displaystyle="true" id="A1.Ex3.m1.3.3" xref="A1.Ex3.m1.3.3.cmml"><mfrac id="A1.Ex3.m1.3.3a" xref="A1.Ex3.m1.3.3.cmml"><mrow id="A1.Ex3.m1.2.2.1" xref="A1.Ex3.m1.2.2.1.cmml"><mi id="A1.Ex3.m1.2.2.1.3" xref="A1.Ex3.m1.2.2.1.3.cmml">π</mi><mo id="A1.Ex3.m1.2.2.1.2" xref="A1.Ex3.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.Ex3.m1.2.2.1.1.1" xref="A1.Ex3.m1.2.2.1.1.1.1.cmml"><mo id="A1.Ex3.m1.2.2.1.1.1.2" stretchy="false" xref="A1.Ex3.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.Ex3.m1.2.2.1.1.1.1" xref="A1.Ex3.m1.2.2.1.1.1.1.cmml"><mi id="A1.Ex3.m1.2.2.1.1.1.1.2" xref="A1.Ex3.m1.2.2.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex3.m1.2.2.1.1.1.1.1" xref="A1.Ex3.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex3.m1.2.2.1.1.1.1.3" xref="A1.Ex3.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex3.m1.2.2.1.1.1.3" stretchy="false" xref="A1.Ex3.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex3.m1.3.3.2" xref="A1.Ex3.m1.3.3.2.cmml"><msub id="A1.Ex3.m1.3.3.2.3" xref="A1.Ex3.m1.3.3.2.3.cmml"><mi id="A1.Ex3.m1.3.3.2.3.2" xref="A1.Ex3.m1.3.3.2.3.2.cmml">π</mi><mtext id="A1.Ex3.m1.3.3.2.3.3" xref="A1.Ex3.m1.3.3.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex3.m1.3.3.2.2" xref="A1.Ex3.m1.3.3.2.2.cmml">⁢</mo><mrow id="A1.Ex3.m1.3.3.2.1.1" xref="A1.Ex3.m1.3.3.2.1.1.1.cmml"><mo id="A1.Ex3.m1.3.3.2.1.1.2" stretchy="false" xref="A1.Ex3.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="A1.Ex3.m1.3.3.2.1.1.1" xref="A1.Ex3.m1.3.3.2.1.1.1.cmml"><mi id="A1.Ex3.m1.3.3.2.1.1.1.2" xref="A1.Ex3.m1.3.3.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex3.m1.3.3.2.1.1.1.1" xref="A1.Ex3.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex3.m1.3.3.2.1.1.1.3" xref="A1.Ex3.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex3.m1.3.3.2.1.1.3" stretchy="false" xref="A1.Ex3.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.Ex3.m1.6.6.1.1.1.1.1" xref="A1.Ex3.m1.6.6.1.1.1.1.1.cmml">−</mo><mrow id="A1.Ex3.m1.6.6.1.1.1.1.3" xref="A1.Ex3.m1.6.6.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="A1.Ex3.m1.6.6.1.1.1.1.3.2" xref="A1.Ex3.m1.6.6.1.1.1.1.3.2.cmml"><mfrac id="A1.Ex3.m1.6.6.1.1.1.1.3.2a" xref="A1.Ex3.m1.6.6.1.1.1.1.3.2.cmml"><mn id="A1.Ex3.m1.6.6.1.1.1.1.3.2.2" xref="A1.Ex3.m1.6.6.1.1.1.1.3.2.2.cmml">1</mn><mi id="A1.Ex3.m1.6.6.1.1.1.1.3.2.3" xref="A1.Ex3.m1.6.6.1.1.1.1.3.2.3.cmml">β</mi></mfrac></mstyle><mo id="A1.Ex3.m1.6.6.1.1.1.1.3.1" xref="A1.Ex3.m1.6.6.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex3.m1.6.6.1.1.1.1.3.3" xref="A1.Ex3.m1.6.6.1.1.1.1.3.3.cmml">r</mi><mo id="A1.Ex3.m1.6.6.1.1.1.1.3.1a" xref="A1.Ex3.m1.6.6.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex3.m1.6.6.1.1.1.1.3.4.2" xref="A1.Ex3.m1.6.6.1.1.1.1.3.4.1.cmml"><mo id="A1.Ex3.m1.6.6.1.1.1.1.3.4.2.1" stretchy="false" xref="A1.Ex3.m1.6.6.1.1.1.1.3.4.1.cmml">(</mo><mi id="A1.Ex3.m1.4.4" xref="A1.Ex3.m1.4.4.cmml">x</mi><mo id="A1.Ex3.m1.6.6.1.1.1.1.3.4.2.2" xref="A1.Ex3.m1.6.6.1.1.1.1.3.4.1.cmml">,</mo><mi id="A1.Ex3.m1.5.5" xref="A1.Ex3.m1.5.5.cmml">y</mi><mo id="A1.Ex3.m1.6.6.1.1.1.1.3.4.2.3" stretchy="false" xref="A1.Ex3.m1.6.6.1.1.1.1.3.4.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex3.m1.6.6.1.1.1.3" xref="A1.Ex3.m1.6.6.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex3.m1.6b"><apply id="A1.Ex3.m1.6.6.cmml" xref="A1.Ex3.m1.6.6"><eq id="A1.Ex3.m1.6.6.2.cmml" xref="A1.Ex3.m1.6.6.2"></eq><csymbol cd="latexml" id="A1.Ex3.m1.6.6.3.cmml" xref="A1.Ex3.m1.6.6.3">absent</csymbol><apply id="A1.Ex3.m1.6.6.1.cmml" xref="A1.Ex3.m1.6.6.1"><times id="A1.Ex3.m1.6.6.1.2.cmml" xref="A1.Ex3.m1.6.6.1.2"></times><apply id="A1.Ex3.m1.6.6.1.3.cmml" xref="A1.Ex3.m1.6.6.1.3"><apply id="A1.Ex3.m1.6.6.1.3.1.cmml" xref="A1.Ex3.m1.6.6.1.3.1"><csymbol cd="ambiguous" id="A1.Ex3.m1.6.6.1.3.1.1.cmml" xref="A1.Ex3.m1.6.6.1.3.1">subscript</csymbol><min id="A1.Ex3.m1.6.6.1.3.1.2.cmml" xref="A1.Ex3.m1.6.6.1.3.1.2"></min><ci id="A1.Ex3.m1.6.6.1.3.1.3.cmml" xref="A1.Ex3.m1.6.6.1.3.1.3">𝜋</ci></apply><apply id="A1.Ex3.m1.6.6.1.3.2.cmml" xref="A1.Ex3.m1.6.6.1.3.2"><times id="A1.Ex3.m1.6.6.1.3.2.1.cmml" xref="A1.Ex3.m1.6.6.1.3.2.1"></times><apply id="A1.Ex3.m1.6.6.1.3.2.2.cmml" xref="A1.Ex3.m1.6.6.1.3.2.2"><csymbol cd="ambiguous" id="A1.Ex3.m1.6.6.1.3.2.2.1.cmml" xref="A1.Ex3.m1.6.6.1.3.2.2">subscript</csymbol><ci id="A1.Ex3.m1.6.6.1.3.2.2.2.cmml" xref="A1.Ex3.m1.6.6.1.3.2.2.2">𝔼</ci><apply id="A1.Ex3.m1.6.6.1.3.2.2.3.cmml" xref="A1.Ex3.m1.6.6.1.3.2.2.3"><csymbol cd="latexml" id="A1.Ex3.m1.6.6.1.3.2.2.3.1.cmml" xref="A1.Ex3.m1.6.6.1.3.2.2.3.1">similar-to</csymbol><ci id="A1.Ex3.m1.6.6.1.3.2.2.3.2.cmml" xref="A1.Ex3.m1.6.6.1.3.2.2.3.2">𝑥</ci><ci id="A1.Ex3.m1.6.6.1.3.2.2.3.3.cmml" xref="A1.Ex3.m1.6.6.1.3.2.2.3.3">𝒟</ci></apply></apply><apply id="A1.Ex3.m1.6.6.1.3.2.3.cmml" xref="A1.Ex3.m1.6.6.1.3.2.3"><csymbol cd="ambiguous" id="A1.Ex3.m1.6.6.1.3.2.3.1.cmml" xref="A1.Ex3.m1.6.6.1.3.2.3">subscript</csymbol><ci id="A1.Ex3.m1.6.6.1.3.2.3.2.cmml" xref="A1.Ex3.m1.6.6.1.3.2.3.2">𝔼</ci><apply id="A1.Ex3.m1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1"><csymbol cd="latexml" id="A1.Ex3.m1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1.2">similar-to</csymbol><ci id="A1.Ex3.m1.1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.1.3">𝑦</ci><apply id="A1.Ex3.m1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1"><times id="A1.Ex3.m1.1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1.1.2"></times><ci id="A1.Ex3.m1.1.1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.1.1.3">𝜋</ci><apply id="A1.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex3.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex3.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex3.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.Ex3.m1.6.6.1.1.2.cmml" xref="A1.Ex3.m1.6.6.1.1.1"><csymbol cd="latexml" id="A1.Ex3.m1.6.6.1.1.2.1.cmml" xref="A1.Ex3.m1.6.6.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex3.m1.6.6.1.1.1.1.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1"><minus id="A1.Ex3.m1.6.6.1.1.1.1.1.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.1"></minus><apply id="A1.Ex3.m1.6.6.1.1.1.1.2.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.2"><log id="A1.Ex3.m1.6.6.1.1.1.1.2.1.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.2.1"></log><apply id="A1.Ex3.m1.3.3.cmml" xref="A1.Ex3.m1.3.3"><divide id="A1.Ex3.m1.3.3.3.cmml" xref="A1.Ex3.m1.3.3"></divide><apply id="A1.Ex3.m1.2.2.1.cmml" xref="A1.Ex3.m1.2.2.1"><times id="A1.Ex3.m1.2.2.1.2.cmml" xref="A1.Ex3.m1.2.2.1.2"></times><ci id="A1.Ex3.m1.2.2.1.3.cmml" xref="A1.Ex3.m1.2.2.1.3">𝜋</ci><apply id="A1.Ex3.m1.2.2.1.1.1.1.cmml" xref="A1.Ex3.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.Ex3.m1.2.2.1.1.1.1.1.cmml" xref="A1.Ex3.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex3.m1.2.2.1.1.1.1.2.cmml" xref="A1.Ex3.m1.2.2.1.1.1.1.2">𝑦</ci><ci id="A1.Ex3.m1.2.2.1.1.1.1.3.cmml" xref="A1.Ex3.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex3.m1.3.3.2.cmml" xref="A1.Ex3.m1.3.3.2"><times id="A1.Ex3.m1.3.3.2.2.cmml" xref="A1.Ex3.m1.3.3.2.2"></times><apply id="A1.Ex3.m1.3.3.2.3.cmml" xref="A1.Ex3.m1.3.3.2.3"><csymbol cd="ambiguous" id="A1.Ex3.m1.3.3.2.3.1.cmml" xref="A1.Ex3.m1.3.3.2.3">subscript</csymbol><ci id="A1.Ex3.m1.3.3.2.3.2.cmml" xref="A1.Ex3.m1.3.3.2.3.2">𝜋</ci><ci id="A1.Ex3.m1.3.3.2.3.3a.cmml" xref="A1.Ex3.m1.3.3.2.3.3"><mtext id="A1.Ex3.m1.3.3.2.3.3.cmml" mathsize="70%" xref="A1.Ex3.m1.3.3.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex3.m1.3.3.2.1.1.1.cmml" xref="A1.Ex3.m1.3.3.2.1.1"><csymbol cd="latexml" id="A1.Ex3.m1.3.3.2.1.1.1.1.cmml" xref="A1.Ex3.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex3.m1.3.3.2.1.1.1.2.cmml" xref="A1.Ex3.m1.3.3.2.1.1.1.2">𝑦</ci><ci id="A1.Ex3.m1.3.3.2.1.1.1.3.cmml" xref="A1.Ex3.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply><apply id="A1.Ex3.m1.6.6.1.1.1.1.3.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.3"><times id="A1.Ex3.m1.6.6.1.1.1.1.3.1.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.3.1"></times><apply id="A1.Ex3.m1.6.6.1.1.1.1.3.2.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.3.2"><divide id="A1.Ex3.m1.6.6.1.1.1.1.3.2.1.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.3.2"></divide><cn id="A1.Ex3.m1.6.6.1.1.1.1.3.2.2.cmml" type="integer" xref="A1.Ex3.m1.6.6.1.1.1.1.3.2.2">1</cn><ci id="A1.Ex3.m1.6.6.1.1.1.1.3.2.3.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.3.2.3">𝛽</ci></apply><ci id="A1.Ex3.m1.6.6.1.1.1.1.3.3.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.3.3">𝑟</ci><interval closure="open" id="A1.Ex3.m1.6.6.1.1.1.1.3.4.1.cmml" xref="A1.Ex3.m1.6.6.1.1.1.1.3.4.2"><ci id="A1.Ex3.m1.4.4.cmml" xref="A1.Ex3.m1.4.4">𝑥</ci><ci id="A1.Ex3.m1.5.5.cmml" xref="A1.Ex3.m1.5.5">𝑦</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex3.m1.6c">\displaystyle=\min_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\mathbb{E}_{y\sim\pi(y|x)%
}\left[\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}-\frac{1}{\beta}r(x,y)\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex3.m1.6d">= roman_min start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_y ∼ italic_π ( italic_y | italic_x ) end_POSTSUBSCRIPT [ roman_log divide start_ARG italic_π ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG - divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\min_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\mathbb{E}_{y\sim\pi(y|x)%
}\left[\log\frac{\pi(y|x)}{\frac{1}{Z(x)}\pi_{\text{ref}}(y|x)\exp\left(\frac{%
1}{\beta}r(x,y)\right)}-\log Z(x)\right]" class="ltx_Math" display="inline" id="A1.E12.m1.10"><semantics id="A1.E12.m1.10a"><mrow id="A1.E12.m1.10.10" xref="A1.E12.m1.10.10.cmml"><mi id="A1.E12.m1.10.10.3" xref="A1.E12.m1.10.10.3.cmml"></mi><mo id="A1.E12.m1.10.10.2" xref="A1.E12.m1.10.10.2.cmml">=</mo><mrow id="A1.E12.m1.10.10.1" xref="A1.E12.m1.10.10.1.cmml"><mrow id="A1.E12.m1.10.10.1.3" xref="A1.E12.m1.10.10.1.3.cmml"><munder id="A1.E12.m1.10.10.1.3.1" xref="A1.E12.m1.10.10.1.3.1.cmml"><mi id="A1.E12.m1.10.10.1.3.1.2" xref="A1.E12.m1.10.10.1.3.1.2.cmml">min</mi><mi id="A1.E12.m1.10.10.1.3.1.3" xref="A1.E12.m1.10.10.1.3.1.3.cmml">π</mi></munder><mo id="A1.E12.m1.10.10.1.3a" lspace="0.167em" xref="A1.E12.m1.10.10.1.3.cmml">⁡</mo><mrow id="A1.E12.m1.10.10.1.3.2" xref="A1.E12.m1.10.10.1.3.2.cmml"><msub id="A1.E12.m1.10.10.1.3.2.2" xref="A1.E12.m1.10.10.1.3.2.2.cmml"><mi id="A1.E12.m1.10.10.1.3.2.2.2" xref="A1.E12.m1.10.10.1.3.2.2.2.cmml">𝔼</mi><mrow id="A1.E12.m1.10.10.1.3.2.2.3" xref="A1.E12.m1.10.10.1.3.2.2.3.cmml"><mi id="A1.E12.m1.10.10.1.3.2.2.3.2" xref="A1.E12.m1.10.10.1.3.2.2.3.2.cmml">x</mi><mo id="A1.E12.m1.10.10.1.3.2.2.3.1" xref="A1.E12.m1.10.10.1.3.2.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E12.m1.10.10.1.3.2.2.3.3" xref="A1.E12.m1.10.10.1.3.2.2.3.3.cmml">𝒟</mi></mrow></msub><mo id="A1.E12.m1.10.10.1.3.2.1" xref="A1.E12.m1.10.10.1.3.2.1.cmml">⁢</mo><msub id="A1.E12.m1.10.10.1.3.2.3" xref="A1.E12.m1.10.10.1.3.2.3.cmml"><mi id="A1.E12.m1.10.10.1.3.2.3.2" xref="A1.E12.m1.10.10.1.3.2.3.2.cmml">𝔼</mi><mrow id="A1.E12.m1.1.1.1" xref="A1.E12.m1.1.1.1.cmml"><mi id="A1.E12.m1.1.1.1.3" xref="A1.E12.m1.1.1.1.3.cmml">y</mi><mo id="A1.E12.m1.1.1.1.2" xref="A1.E12.m1.1.1.1.2.cmml">∼</mo><mrow id="A1.E12.m1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.cmml"><mi id="A1.E12.m1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.3.cmml">π</mi><mo id="A1.E12.m1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E12.m1.1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E12.m1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E12.m1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E12.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow><mo id="A1.E12.m1.10.10.1.2" xref="A1.E12.m1.10.10.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.10.10.1.1.1" xref="A1.E12.m1.10.10.1.1.2.cmml"><mo id="A1.E12.m1.10.10.1.1.1.2" xref="A1.E12.m1.10.10.1.1.2.1.cmml">[</mo><mrow id="A1.E12.m1.10.10.1.1.1.1" xref="A1.E12.m1.10.10.1.1.1.1.cmml"><mrow id="A1.E12.m1.10.10.1.1.1.1.2" xref="A1.E12.m1.10.10.1.1.1.1.2.cmml"><mi id="A1.E12.m1.10.10.1.1.1.1.2.1" xref="A1.E12.m1.10.10.1.1.1.1.2.1.cmml">log</mi><mo id="A1.E12.m1.10.10.1.1.1.1.2a" lspace="0.167em" xref="A1.E12.m1.10.10.1.1.1.1.2.cmml">⁡</mo><mstyle displaystyle="true" id="A1.E12.m1.8.8" xref="A1.E12.m1.8.8.cmml"><mfrac id="A1.E12.m1.8.8a" xref="A1.E12.m1.8.8.cmml"><mrow id="A1.E12.m1.2.2.1" xref="A1.E12.m1.2.2.1.cmml"><mi id="A1.E12.m1.2.2.1.3" xref="A1.E12.m1.2.2.1.3.cmml">π</mi><mo id="A1.E12.m1.2.2.1.2" xref="A1.E12.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.2.2.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.cmml"><mo id="A1.E12.m1.2.2.1.1.1.2" stretchy="false" xref="A1.E12.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.E12.m1.2.2.1.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.cmml"><mi id="A1.E12.m1.2.2.1.1.1.1.2" xref="A1.E12.m1.2.2.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E12.m1.2.2.1.1.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="A1.E12.m1.2.2.1.1.1.1.3" xref="A1.E12.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E12.m1.2.2.1.1.1.3" stretchy="false" xref="A1.E12.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E12.m1.8.8.7" xref="A1.E12.m1.8.8.7.cmml"><mfrac id="A1.E12.m1.3.3.2.1" xref="A1.E12.m1.3.3.2.1.cmml"><mn id="A1.E12.m1.3.3.2.1.3" xref="A1.E12.m1.3.3.2.1.3.cmml">1</mn><mrow id="A1.E12.m1.3.3.2.1.1" xref="A1.E12.m1.3.3.2.1.1.cmml"><mi id="A1.E12.m1.3.3.2.1.1.3" xref="A1.E12.m1.3.3.2.1.1.3.cmml">Z</mi><mo id="A1.E12.m1.3.3.2.1.1.2" xref="A1.E12.m1.3.3.2.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.3.3.2.1.1.4.2" xref="A1.E12.m1.3.3.2.1.1.cmml"><mo id="A1.E12.m1.3.3.2.1.1.4.2.1" stretchy="false" xref="A1.E12.m1.3.3.2.1.1.cmml">(</mo><mi id="A1.E12.m1.3.3.2.1.1.1" xref="A1.E12.m1.3.3.2.1.1.1.cmml">x</mi><mo id="A1.E12.m1.3.3.2.1.1.4.2.2" stretchy="false" xref="A1.E12.m1.3.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.E12.m1.8.8.7.7" xref="A1.E12.m1.8.8.7.7.cmml">⁢</mo><msub id="A1.E12.m1.8.8.7.8" xref="A1.E12.m1.8.8.7.8.cmml"><mi id="A1.E12.m1.8.8.7.8.2" xref="A1.E12.m1.8.8.7.8.2.cmml">π</mi><mtext id="A1.E12.m1.8.8.7.8.3" xref="A1.E12.m1.8.8.7.8.3a.cmml">ref</mtext></msub><mo id="A1.E12.m1.8.8.7.7a" xref="A1.E12.m1.8.8.7.7.cmml">⁢</mo><mrow id="A1.E12.m1.7.7.6.5.1" xref="A1.E12.m1.7.7.6.5.1.1.cmml"><mo id="A1.E12.m1.7.7.6.5.1.2" stretchy="false" xref="A1.E12.m1.7.7.6.5.1.1.cmml">(</mo><mrow id="A1.E12.m1.7.7.6.5.1.1" xref="A1.E12.m1.7.7.6.5.1.1.cmml"><mi id="A1.E12.m1.7.7.6.5.1.1.2" xref="A1.E12.m1.7.7.6.5.1.1.2.cmml">y</mi><mo fence="false" id="A1.E12.m1.7.7.6.5.1.1.1" xref="A1.E12.m1.7.7.6.5.1.1.1.cmml">|</mo><mi id="A1.E12.m1.7.7.6.5.1.1.3" xref="A1.E12.m1.7.7.6.5.1.1.3.cmml">x</mi></mrow><mo id="A1.E12.m1.7.7.6.5.1.3" stretchy="false" xref="A1.E12.m1.7.7.6.5.1.1.cmml">)</mo></mrow><mo id="A1.E12.m1.8.8.7.7b" lspace="0.167em" xref="A1.E12.m1.8.8.7.7.cmml">⁢</mo><mrow id="A1.E12.m1.8.8.7.6.1" xref="A1.E12.m1.8.8.7.6.2.cmml"><mi id="A1.E12.m1.6.6.5.4" xref="A1.E12.m1.6.6.5.4.cmml">exp</mi><mo id="A1.E12.m1.8.8.7.6.1a" xref="A1.E12.m1.8.8.7.6.2.cmml">⁡</mo><mrow id="A1.E12.m1.8.8.7.6.1.1" xref="A1.E12.m1.8.8.7.6.2.cmml"><mo id="A1.E12.m1.8.8.7.6.1.1.2" xref="A1.E12.m1.8.8.7.6.2.cmml">(</mo><mrow id="A1.E12.m1.8.8.7.6.1.1.1" xref="A1.E12.m1.8.8.7.6.1.1.1.cmml"><mfrac id="A1.E12.m1.8.8.7.6.1.1.1.2" xref="A1.E12.m1.8.8.7.6.1.1.1.2.cmml"><mn id="A1.E12.m1.8.8.7.6.1.1.1.2.2" xref="A1.E12.m1.8.8.7.6.1.1.1.2.2.cmml">1</mn><mi id="A1.E12.m1.8.8.7.6.1.1.1.2.3" xref="A1.E12.m1.8.8.7.6.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.E12.m1.8.8.7.6.1.1.1.1" xref="A1.E12.m1.8.8.7.6.1.1.1.1.cmml">⁢</mo><mi id="A1.E12.m1.8.8.7.6.1.1.1.3" xref="A1.E12.m1.8.8.7.6.1.1.1.3.cmml">r</mi><mo id="A1.E12.m1.8.8.7.6.1.1.1.1a" xref="A1.E12.m1.8.8.7.6.1.1.1.1.cmml">⁢</mo><mrow id="A1.E12.m1.8.8.7.6.1.1.1.4.2" xref="A1.E12.m1.8.8.7.6.1.1.1.4.1.cmml"><mo id="A1.E12.m1.8.8.7.6.1.1.1.4.2.1" stretchy="false" xref="A1.E12.m1.8.8.7.6.1.1.1.4.1.cmml">(</mo><mi id="A1.E12.m1.4.4.3.2" xref="A1.E12.m1.4.4.3.2.cmml">x</mi><mo id="A1.E12.m1.8.8.7.6.1.1.1.4.2.2" xref="A1.E12.m1.8.8.7.6.1.1.1.4.1.cmml">,</mo><mi id="A1.E12.m1.5.5.4.3" xref="A1.E12.m1.5.5.4.3.cmml">y</mi><mo id="A1.E12.m1.8.8.7.6.1.1.1.4.2.3" stretchy="false" xref="A1.E12.m1.8.8.7.6.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.8.8.7.6.1.1.3" xref="A1.E12.m1.8.8.7.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.E12.m1.10.10.1.1.1.1.1" xref="A1.E12.m1.10.10.1.1.1.1.1.cmml">−</mo><mrow id="A1.E12.m1.10.10.1.1.1.1.3" xref="A1.E12.m1.10.10.1.1.1.1.3.cmml"><mrow id="A1.E12.m1.10.10.1.1.1.1.3.2" xref="A1.E12.m1.10.10.1.1.1.1.3.2.cmml"><mi id="A1.E12.m1.10.10.1.1.1.1.3.2.1" xref="A1.E12.m1.10.10.1.1.1.1.3.2.1.cmml">log</mi><mo id="A1.E12.m1.10.10.1.1.1.1.3.2a" lspace="0.167em" xref="A1.E12.m1.10.10.1.1.1.1.3.2.cmml">⁡</mo><mi id="A1.E12.m1.10.10.1.1.1.1.3.2.2" xref="A1.E12.m1.10.10.1.1.1.1.3.2.2.cmml">Z</mi></mrow><mo id="A1.E12.m1.10.10.1.1.1.1.3.1" xref="A1.E12.m1.10.10.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E12.m1.10.10.1.1.1.1.3.3.2" xref="A1.E12.m1.10.10.1.1.1.1.3.cmml"><mo id="A1.E12.m1.10.10.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.E12.m1.10.10.1.1.1.1.3.cmml">(</mo><mi id="A1.E12.m1.9.9" xref="A1.E12.m1.9.9.cmml">x</mi><mo id="A1.E12.m1.10.10.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.E12.m1.10.10.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E12.m1.10.10.1.1.1.3" xref="A1.E12.m1.10.10.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.10b"><apply id="A1.E12.m1.10.10.cmml" xref="A1.E12.m1.10.10"><eq id="A1.E12.m1.10.10.2.cmml" xref="A1.E12.m1.10.10.2"></eq><csymbol cd="latexml" id="A1.E12.m1.10.10.3.cmml" xref="A1.E12.m1.10.10.3">absent</csymbol><apply id="A1.E12.m1.10.10.1.cmml" xref="A1.E12.m1.10.10.1"><times id="A1.E12.m1.10.10.1.2.cmml" xref="A1.E12.m1.10.10.1.2"></times><apply id="A1.E12.m1.10.10.1.3.cmml" xref="A1.E12.m1.10.10.1.3"><apply id="A1.E12.m1.10.10.1.3.1.cmml" xref="A1.E12.m1.10.10.1.3.1"><csymbol cd="ambiguous" id="A1.E12.m1.10.10.1.3.1.1.cmml" xref="A1.E12.m1.10.10.1.3.1">subscript</csymbol><min id="A1.E12.m1.10.10.1.3.1.2.cmml" xref="A1.E12.m1.10.10.1.3.1.2"></min><ci id="A1.E12.m1.10.10.1.3.1.3.cmml" xref="A1.E12.m1.10.10.1.3.1.3">𝜋</ci></apply><apply id="A1.E12.m1.10.10.1.3.2.cmml" xref="A1.E12.m1.10.10.1.3.2"><times id="A1.E12.m1.10.10.1.3.2.1.cmml" xref="A1.E12.m1.10.10.1.3.2.1"></times><apply id="A1.E12.m1.10.10.1.3.2.2.cmml" xref="A1.E12.m1.10.10.1.3.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.10.10.1.3.2.2.1.cmml" xref="A1.E12.m1.10.10.1.3.2.2">subscript</csymbol><ci id="A1.E12.m1.10.10.1.3.2.2.2.cmml" xref="A1.E12.m1.10.10.1.3.2.2.2">𝔼</ci><apply id="A1.E12.m1.10.10.1.3.2.2.3.cmml" xref="A1.E12.m1.10.10.1.3.2.2.3"><csymbol cd="latexml" id="A1.E12.m1.10.10.1.3.2.2.3.1.cmml" xref="A1.E12.m1.10.10.1.3.2.2.3.1">similar-to</csymbol><ci id="A1.E12.m1.10.10.1.3.2.2.3.2.cmml" xref="A1.E12.m1.10.10.1.3.2.2.3.2">𝑥</ci><ci id="A1.E12.m1.10.10.1.3.2.2.3.3.cmml" xref="A1.E12.m1.10.10.1.3.2.2.3.3">𝒟</ci></apply></apply><apply id="A1.E12.m1.10.10.1.3.2.3.cmml" xref="A1.E12.m1.10.10.1.3.2.3"><csymbol cd="ambiguous" id="A1.E12.m1.10.10.1.3.2.3.1.cmml" xref="A1.E12.m1.10.10.1.3.2.3">subscript</csymbol><ci id="A1.E12.m1.10.10.1.3.2.3.2.cmml" xref="A1.E12.m1.10.10.1.3.2.3.2">𝔼</ci><apply id="A1.E12.m1.1.1.1.cmml" xref="A1.E12.m1.1.1.1"><csymbol cd="latexml" id="A1.E12.m1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.2">similar-to</csymbol><ci id="A1.E12.m1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.3">𝑦</ci><apply id="A1.E12.m1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1"><times id="A1.E12.m1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.2"></times><ci id="A1.E12.m1.1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.1.3">𝜋</ci><apply id="A1.E12.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E12.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.E12.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E12.m1.10.10.1.1.2.cmml" xref="A1.E12.m1.10.10.1.1.1"><csymbol cd="latexml" id="A1.E12.m1.10.10.1.1.2.1.cmml" xref="A1.E12.m1.10.10.1.1.1.2">delimited-[]</csymbol><apply id="A1.E12.m1.10.10.1.1.1.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1"><minus id="A1.E12.m1.10.10.1.1.1.1.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1"></minus><apply id="A1.E12.m1.10.10.1.1.1.1.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.2"><log id="A1.E12.m1.10.10.1.1.1.1.2.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.2.1"></log><apply id="A1.E12.m1.8.8.cmml" xref="A1.E12.m1.8.8"><divide id="A1.E12.m1.8.8.8.cmml" xref="A1.E12.m1.8.8"></divide><apply id="A1.E12.m1.2.2.1.cmml" xref="A1.E12.m1.2.2.1"><times id="A1.E12.m1.2.2.1.2.cmml" xref="A1.E12.m1.2.2.1.2"></times><ci id="A1.E12.m1.2.2.1.3.cmml" xref="A1.E12.m1.2.2.1.3">𝜋</ci><apply id="A1.E12.m1.2.2.1.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.E12.m1.2.2.1.1.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="A1.E12.m1.2.2.1.1.1.1.2.cmml" xref="A1.E12.m1.2.2.1.1.1.1.2">𝑦</ci><ci id="A1.E12.m1.2.2.1.1.1.1.3.cmml" xref="A1.E12.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.E12.m1.8.8.7.cmml" xref="A1.E12.m1.8.8.7"><times id="A1.E12.m1.8.8.7.7.cmml" xref="A1.E12.m1.8.8.7.7"></times><apply id="A1.E12.m1.3.3.2.1.cmml" xref="A1.E12.m1.3.3.2.1"><divide id="A1.E12.m1.3.3.2.1.2.cmml" xref="A1.E12.m1.3.3.2.1"></divide><cn id="A1.E12.m1.3.3.2.1.3.cmml" type="integer" xref="A1.E12.m1.3.3.2.1.3">1</cn><apply id="A1.E12.m1.3.3.2.1.1.cmml" xref="A1.E12.m1.3.3.2.1.1"><times id="A1.E12.m1.3.3.2.1.1.2.cmml" xref="A1.E12.m1.3.3.2.1.1.2"></times><ci id="A1.E12.m1.3.3.2.1.1.3.cmml" xref="A1.E12.m1.3.3.2.1.1.3">𝑍</ci><ci id="A1.E12.m1.3.3.2.1.1.1.cmml" xref="A1.E12.m1.3.3.2.1.1.1">𝑥</ci></apply></apply><apply id="A1.E12.m1.8.8.7.8.cmml" xref="A1.E12.m1.8.8.7.8"><csymbol cd="ambiguous" id="A1.E12.m1.8.8.7.8.1.cmml" xref="A1.E12.m1.8.8.7.8">subscript</csymbol><ci id="A1.E12.m1.8.8.7.8.2.cmml" xref="A1.E12.m1.8.8.7.8.2">𝜋</ci><ci id="A1.E12.m1.8.8.7.8.3a.cmml" xref="A1.E12.m1.8.8.7.8.3"><mtext id="A1.E12.m1.8.8.7.8.3.cmml" mathsize="70%" xref="A1.E12.m1.8.8.7.8.3">ref</mtext></ci></apply><apply id="A1.E12.m1.7.7.6.5.1.1.cmml" xref="A1.E12.m1.7.7.6.5.1"><csymbol cd="latexml" id="A1.E12.m1.7.7.6.5.1.1.1.cmml" xref="A1.E12.m1.7.7.6.5.1.1.1">conditional</csymbol><ci id="A1.E12.m1.7.7.6.5.1.1.2.cmml" xref="A1.E12.m1.7.7.6.5.1.1.2">𝑦</ci><ci id="A1.E12.m1.7.7.6.5.1.1.3.cmml" xref="A1.E12.m1.7.7.6.5.1.1.3">𝑥</ci></apply><apply id="A1.E12.m1.8.8.7.6.2.cmml" xref="A1.E12.m1.8.8.7.6.1"><exp id="A1.E12.m1.6.6.5.4.cmml" xref="A1.E12.m1.6.6.5.4"></exp><apply id="A1.E12.m1.8.8.7.6.1.1.1.cmml" xref="A1.E12.m1.8.8.7.6.1.1.1"><times id="A1.E12.m1.8.8.7.6.1.1.1.1.cmml" xref="A1.E12.m1.8.8.7.6.1.1.1.1"></times><apply id="A1.E12.m1.8.8.7.6.1.1.1.2.cmml" xref="A1.E12.m1.8.8.7.6.1.1.1.2"><divide id="A1.E12.m1.8.8.7.6.1.1.1.2.1.cmml" xref="A1.E12.m1.8.8.7.6.1.1.1.2"></divide><cn id="A1.E12.m1.8.8.7.6.1.1.1.2.2.cmml" type="integer" xref="A1.E12.m1.8.8.7.6.1.1.1.2.2">1</cn><ci id="A1.E12.m1.8.8.7.6.1.1.1.2.3.cmml" xref="A1.E12.m1.8.8.7.6.1.1.1.2.3">𝛽</ci></apply><ci id="A1.E12.m1.8.8.7.6.1.1.1.3.cmml" xref="A1.E12.m1.8.8.7.6.1.1.1.3">𝑟</ci><interval closure="open" id="A1.E12.m1.8.8.7.6.1.1.1.4.1.cmml" xref="A1.E12.m1.8.8.7.6.1.1.1.4.2"><ci id="A1.E12.m1.4.4.3.2.cmml" xref="A1.E12.m1.4.4.3.2">𝑥</ci><ci id="A1.E12.m1.5.5.4.3.cmml" xref="A1.E12.m1.5.5.4.3">𝑦</ci></interval></apply></apply></apply></apply></apply><apply id="A1.E12.m1.10.10.1.1.1.1.3.cmml" xref="A1.E12.m1.10.10.1.1.1.1.3"><times id="A1.E12.m1.10.10.1.1.1.1.3.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.3.1"></times><apply id="A1.E12.m1.10.10.1.1.1.1.3.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.3.2"><log id="A1.E12.m1.10.10.1.1.1.1.3.2.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.3.2.1"></log><ci id="A1.E12.m1.10.10.1.1.1.1.3.2.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.3.2.2">𝑍</ci></apply><ci id="A1.E12.m1.9.9.cmml" xref="A1.E12.m1.9.9">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.10c">\displaystyle=\min_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\mathbb{E}_{y\sim\pi(y|x)%
}\left[\log\frac{\pi(y|x)}{\frac{1}{Z(x)}\pi_{\text{ref}}(y|x)\exp\left(\frac{%
1}{\beta}r(x,y)\right)}-\log Z(x)\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.10d">= roman_min start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_y ∼ italic_π ( italic_y | italic_x ) end_POSTSUBSCRIPT [ roman_log divide start_ARG italic_π ( italic_y | italic_x ) end_ARG start_ARG divide start_ARG 1 end_ARG start_ARG italic_Z ( italic_x ) end_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) ) end_ARG - roman_log italic_Z ( italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">여기서, 파티션 함수는:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Z(x)=\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y)\right)." class="ltx_Math" display="block" id="A1.Ex4.m1.5"><semantics id="A1.Ex4.m1.5a"><mrow id="A1.Ex4.m1.5.5.1" xref="A1.Ex4.m1.5.5.1.1.cmml"><mrow id="A1.Ex4.m1.5.5.1.1" xref="A1.Ex4.m1.5.5.1.1.cmml"><mrow id="A1.Ex4.m1.5.5.1.1.4" xref="A1.Ex4.m1.5.5.1.1.4.cmml"><mi id="A1.Ex4.m1.5.5.1.1.4.2" xref="A1.Ex4.m1.5.5.1.1.4.2.cmml">Z</mi><mo id="A1.Ex4.m1.5.5.1.1.4.1" xref="A1.Ex4.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="A1.Ex4.m1.5.5.1.1.4.3.2" xref="A1.Ex4.m1.5.5.1.1.4.cmml"><mo id="A1.Ex4.m1.5.5.1.1.4.3.2.1" stretchy="false" xref="A1.Ex4.m1.5.5.1.1.4.cmml">(</mo><mi id="A1.Ex4.m1.1.1" xref="A1.Ex4.m1.1.1.cmml">x</mi><mo id="A1.Ex4.m1.5.5.1.1.4.3.2.2" stretchy="false" xref="A1.Ex4.m1.5.5.1.1.4.cmml">)</mo></mrow></mrow><mo id="A1.Ex4.m1.5.5.1.1.3" rspace="0.111em" xref="A1.Ex4.m1.5.5.1.1.3.cmml">=</mo><mrow id="A1.Ex4.m1.5.5.1.1.2" xref="A1.Ex4.m1.5.5.1.1.2.cmml"><munder id="A1.Ex4.m1.5.5.1.1.2.3" xref="A1.Ex4.m1.5.5.1.1.2.3.cmml"><mo id="A1.Ex4.m1.5.5.1.1.2.3.2" movablelimits="false" xref="A1.Ex4.m1.5.5.1.1.2.3.2.cmml">∑</mo><mi id="A1.Ex4.m1.5.5.1.1.2.3.3" xref="A1.Ex4.m1.5.5.1.1.2.3.3.cmml">y</mi></munder><mrow id="A1.Ex4.m1.5.5.1.1.2.2" xref="A1.Ex4.m1.5.5.1.1.2.2.cmml"><msub id="A1.Ex4.m1.5.5.1.1.2.2.4" xref="A1.Ex4.m1.5.5.1.1.2.2.4.cmml"><mi id="A1.Ex4.m1.5.5.1.1.2.2.4.2" xref="A1.Ex4.m1.5.5.1.1.2.2.4.2.cmml">π</mi><mtext id="A1.Ex4.m1.5.5.1.1.2.2.4.3" xref="A1.Ex4.m1.5.5.1.1.2.2.4.3a.cmml">ref</mtext></msub><mo id="A1.Ex4.m1.5.5.1.1.2.2.3" xref="A1.Ex4.m1.5.5.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.Ex4.m1.5.5.1.1.1.1.1.1" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex4.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex4.m1.5.5.1.1.1.1.1.1.1" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.2" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.1" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.3" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex4.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex4.m1.5.5.1.1.2.2.3a" lspace="0.167em" xref="A1.Ex4.m1.5.5.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.Ex4.m1.5.5.1.1.2.2.2.1" xref="A1.Ex4.m1.5.5.1.1.2.2.2.2.cmml"><mi id="A1.Ex4.m1.4.4" xref="A1.Ex4.m1.4.4.cmml">exp</mi><mo id="A1.Ex4.m1.5.5.1.1.2.2.2.1a" xref="A1.Ex4.m1.5.5.1.1.2.2.2.2.cmml">⁡</mo><mrow id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1" xref="A1.Ex4.m1.5.5.1.1.2.2.2.2.cmml"><mo id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.2" xref="A1.Ex4.m1.5.5.1.1.2.2.2.2.cmml">(</mo><mrow id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.cmml"><mfrac id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.cmml"><mn id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.2" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.3" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.1" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.3" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.3.cmml">r</mi><mo id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.1a" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.2" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.1.cmml"><mo id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.2.1" stretchy="false" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.1.cmml">(</mo><mi id="A1.Ex4.m1.2.2" xref="A1.Ex4.m1.2.2.cmml">x</mi><mo id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.2.2" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.1.cmml">,</mo><mi id="A1.Ex4.m1.3.3" xref="A1.Ex4.m1.3.3.cmml">y</mi><mo id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.2.3" stretchy="false" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.3" xref="A1.Ex4.m1.5.5.1.1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="A1.Ex4.m1.5.5.1.2" lspace="0em" xref="A1.Ex4.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex4.m1.5b"><apply id="A1.Ex4.m1.5.5.1.1.cmml" xref="A1.Ex4.m1.5.5.1"><eq id="A1.Ex4.m1.5.5.1.1.3.cmml" xref="A1.Ex4.m1.5.5.1.1.3"></eq><apply id="A1.Ex4.m1.5.5.1.1.4.cmml" xref="A1.Ex4.m1.5.5.1.1.4"><times id="A1.Ex4.m1.5.5.1.1.4.1.cmml" xref="A1.Ex4.m1.5.5.1.1.4.1"></times><ci id="A1.Ex4.m1.5.5.1.1.4.2.cmml" xref="A1.Ex4.m1.5.5.1.1.4.2">𝑍</ci><ci id="A1.Ex4.m1.1.1.cmml" xref="A1.Ex4.m1.1.1">𝑥</ci></apply><apply id="A1.Ex4.m1.5.5.1.1.2.cmml" xref="A1.Ex4.m1.5.5.1.1.2"><apply id="A1.Ex4.m1.5.5.1.1.2.3.cmml" xref="A1.Ex4.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex4.m1.5.5.1.1.2.3.1.cmml" xref="A1.Ex4.m1.5.5.1.1.2.3">subscript</csymbol><sum id="A1.Ex4.m1.5.5.1.1.2.3.2.cmml" xref="A1.Ex4.m1.5.5.1.1.2.3.2"></sum><ci id="A1.Ex4.m1.5.5.1.1.2.3.3.cmml" xref="A1.Ex4.m1.5.5.1.1.2.3.3">𝑦</ci></apply><apply id="A1.Ex4.m1.5.5.1.1.2.2.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2"><times id="A1.Ex4.m1.5.5.1.1.2.2.3.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.3"></times><apply id="A1.Ex4.m1.5.5.1.1.2.2.4.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.4"><csymbol cd="ambiguous" id="A1.Ex4.m1.5.5.1.1.2.2.4.1.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.4">subscript</csymbol><ci id="A1.Ex4.m1.5.5.1.1.2.2.4.2.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.4.2">𝜋</ci><ci id="A1.Ex4.m1.5.5.1.1.2.2.4.3a.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.4.3"><mtext id="A1.Ex4.m1.5.5.1.1.2.2.4.3.cmml" mathsize="70%" xref="A1.Ex4.m1.5.5.1.1.2.2.4.3">ref</mtext></ci></apply><apply id="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex4.m1.5.5.1.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex4.m1.5.5.1.1.2.2.2.2.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1"><exp id="A1.Ex4.m1.4.4.cmml" xref="A1.Ex4.m1.4.4"></exp><apply id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1"><times id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.1.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.1"></times><apply id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2"><divide id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.1.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2"></divide><cn id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.2.cmml" type="integer" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.2">1</cn><ci id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.3.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.2.3">𝛽</ci></apply><ci id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.3.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.1.cmml" xref="A1.Ex4.m1.5.5.1.1.2.2.2.1.1.1.4.2"><ci id="A1.Ex4.m1.2.2.cmml" xref="A1.Ex4.m1.2.2">𝑥</ci><ci id="A1.Ex4.m1.3.3.cmml" xref="A1.Ex4.m1.3.3">𝑦</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex4.m1.5c">Z(x)=\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y)\right).</annotation><annotation encoding="application/x-llamapun" id="A1.Ex4.m1.5d">italic_Z ( italic_x ) = ∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.3">파티션 함수는 단지 <math alttext="x" class="ltx_Math" display="inline" id="A1.SS1.p3.1.m1.1"><semantics id="A1.SS1.p3.1.m1.1a"><mi id="A1.SS1.p3.1.m1.1.1" xref="A1.SS1.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.1.m1.1b"><ci id="A1.SS1.p3.1.m1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.1.m1.1d">italic_x</annotation></semantics></math> 및 참조 정책 <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="A1.SS1.p3.2.m2.1"><semantics id="A1.SS1.p3.2.m2.1a"><msub id="A1.SS1.p3.2.m2.1.1" xref="A1.SS1.p3.2.m2.1.1.cmml"><mi id="A1.SS1.p3.2.m2.1.1.2" xref="A1.SS1.p3.2.m2.1.1.2.cmml">π</mi><mtext id="A1.SS1.p3.2.m2.1.1.3" xref="A1.SS1.p3.2.m2.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.2.m2.1b"><apply id="A1.SS1.p3.2.m2.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p3.2.m2.1.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p3.2.m2.1.1.2.cmml" xref="A1.SS1.p3.2.m2.1.1.2">𝜋</ci><ci id="A1.SS1.p3.2.m2.1.1.3a.cmml" xref="A1.SS1.p3.2.m2.1.1.3"><mtext id="A1.SS1.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="A1.SS1.p3.2.m2.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.2.m2.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.2.m2.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math>의 함수이지만, 정책 <math alttext="\pi" class="ltx_Math" display="inline" id="A1.SS1.p3.3.m3.1"><semantics id="A1.SS1.p3.3.m3.1a"><mi id="A1.SS1.p3.3.m3.1.1" xref="A1.SS1.p3.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.3.m3.1b"><ci id="A1.SS1.p3.3.m3.1.1.cmml" xref="A1.SS1.p3.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.3.m3.1d">italic_π</annotation></semantics></math>에 의존하지 않는다는 점에 유의한다. 이제 정의를 내릴 수 있어</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi^{*}(y|x)=\frac{1}{Z(x)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y%
)\right)," class="ltx_Math" display="block" id="A1.Ex5.m1.5"><semantics id="A1.Ex5.m1.5a"><mrow id="A1.Ex5.m1.5.5.1" xref="A1.Ex5.m1.5.5.1.1.cmml"><mrow id="A1.Ex5.m1.5.5.1.1" xref="A1.Ex5.m1.5.5.1.1.cmml"><mrow id="A1.Ex5.m1.5.5.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.cmml"><msup id="A1.Ex5.m1.5.5.1.1.1.3" xref="A1.Ex5.m1.5.5.1.1.1.3.cmml"><mi id="A1.Ex5.m1.5.5.1.1.1.3.2" xref="A1.Ex5.m1.5.5.1.1.1.3.2.cmml">π</mi><mo id="A1.Ex5.m1.5.5.1.1.1.3.3" xref="A1.Ex5.m1.5.5.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.Ex5.m1.5.5.1.1.1.2" xref="A1.Ex5.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex5.m1.5.5.1.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex5.m1.5.5.1.1.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.cmml"><mi id="A1.Ex5.m1.5.5.1.1.1.1.1.1.2" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex5.m1.5.5.1.1.1.1.1.1.3" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex5.m1.5.5.1.1.4" xref="A1.Ex5.m1.5.5.1.1.4.cmml">=</mo><mrow id="A1.Ex5.m1.5.5.1.1.3" xref="A1.Ex5.m1.5.5.1.1.3.cmml"><mfrac id="A1.Ex5.m1.1.1" xref="A1.Ex5.m1.1.1.cmml"><mn id="A1.Ex5.m1.1.1.3" xref="A1.Ex5.m1.1.1.3.cmml">1</mn><mrow id="A1.Ex5.m1.1.1.1" xref="A1.Ex5.m1.1.1.1.cmml"><mi id="A1.Ex5.m1.1.1.1.3" xref="A1.Ex5.m1.1.1.1.3.cmml">Z</mi><mo id="A1.Ex5.m1.1.1.1.2" xref="A1.Ex5.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex5.m1.1.1.1.4.2" xref="A1.Ex5.m1.1.1.1.cmml"><mo id="A1.Ex5.m1.1.1.1.4.2.1" stretchy="false" xref="A1.Ex5.m1.1.1.1.cmml">(</mo><mi id="A1.Ex5.m1.1.1.1.1" xref="A1.Ex5.m1.1.1.1.1.cmml">x</mi><mo id="A1.Ex5.m1.1.1.1.4.2.2" stretchy="false" xref="A1.Ex5.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.Ex5.m1.5.5.1.1.3.3" xref="A1.Ex5.m1.5.5.1.1.3.3.cmml">⁢</mo><msub id="A1.Ex5.m1.5.5.1.1.3.4" xref="A1.Ex5.m1.5.5.1.1.3.4.cmml"><mi id="A1.Ex5.m1.5.5.1.1.3.4.2" xref="A1.Ex5.m1.5.5.1.1.3.4.2.cmml">π</mi><mtext id="A1.Ex5.m1.5.5.1.1.3.4.3" xref="A1.Ex5.m1.5.5.1.1.3.4.3a.cmml">ref</mtext></msub><mo id="A1.Ex5.m1.5.5.1.1.3.3a" xref="A1.Ex5.m1.5.5.1.1.3.3.cmml">⁢</mo><mrow id="A1.Ex5.m1.5.5.1.1.2.1.1" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.cmml"><mo id="A1.Ex5.m1.5.5.1.1.2.1.1.2" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.Ex5.m1.5.5.1.1.2.1.1.1" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.cmml"><mi id="A1.Ex5.m1.5.5.1.1.2.1.1.1.2" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex5.m1.5.5.1.1.2.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex5.m1.5.5.1.1.2.1.1.1.3" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex5.m1.5.5.1.1.2.1.1.3" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex5.m1.5.5.1.1.3.3b" lspace="0.167em" xref="A1.Ex5.m1.5.5.1.1.3.3.cmml">⁢</mo><mrow id="A1.Ex5.m1.5.5.1.1.3.2.1" xref="A1.Ex5.m1.5.5.1.1.3.2.2.cmml"><mi id="A1.Ex5.m1.4.4" xref="A1.Ex5.m1.4.4.cmml">exp</mi><mo id="A1.Ex5.m1.5.5.1.1.3.2.1a" xref="A1.Ex5.m1.5.5.1.1.3.2.2.cmml">⁡</mo><mrow id="A1.Ex5.m1.5.5.1.1.3.2.1.1" xref="A1.Ex5.m1.5.5.1.1.3.2.2.cmml"><mo id="A1.Ex5.m1.5.5.1.1.3.2.1.1.2" xref="A1.Ex5.m1.5.5.1.1.3.2.2.cmml">(</mo><mrow id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.cmml"><mfrac id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.cmml"><mn id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.2" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.3" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.3" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.3.cmml">r</mi><mo id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.1a" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.2" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.1.cmml"><mo id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.2.1" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.1.cmml">(</mo><mi id="A1.Ex5.m1.2.2" xref="A1.Ex5.m1.2.2.cmml">x</mi><mo id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.2.2" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.1.cmml">,</mo><mi id="A1.Ex5.m1.3.3" xref="A1.Ex5.m1.3.3.cmml">y</mi><mo id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.2.3" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex5.m1.5.5.1.1.3.2.1.1.3" xref="A1.Ex5.m1.5.5.1.1.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.Ex5.m1.5.5.1.2" xref="A1.Ex5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m1.5b"><apply id="A1.Ex5.m1.5.5.1.1.cmml" xref="A1.Ex5.m1.5.5.1"><eq id="A1.Ex5.m1.5.5.1.1.4.cmml" xref="A1.Ex5.m1.5.5.1.1.4"></eq><apply id="A1.Ex5.m1.5.5.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1"><times id="A1.Ex5.m1.5.5.1.1.1.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.2"></times><apply id="A1.Ex5.m1.5.5.1.1.1.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.1.1.3.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.3">superscript</csymbol><ci id="A1.Ex5.m1.5.5.1.1.1.3.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.3.2">𝜋</ci><times id="A1.Ex5.m1.5.5.1.1.1.3.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.3.3"></times></apply><apply id="A1.Ex5.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex5.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex5.m1.5.5.1.1.3.cmml" xref="A1.Ex5.m1.5.5.1.1.3"><times id="A1.Ex5.m1.5.5.1.1.3.3.cmml" xref="A1.Ex5.m1.5.5.1.1.3.3"></times><apply id="A1.Ex5.m1.1.1.cmml" xref="A1.Ex5.m1.1.1"><divide id="A1.Ex5.m1.1.1.2.cmml" xref="A1.Ex5.m1.1.1"></divide><cn id="A1.Ex5.m1.1.1.3.cmml" type="integer" xref="A1.Ex5.m1.1.1.3">1</cn><apply id="A1.Ex5.m1.1.1.1.cmml" xref="A1.Ex5.m1.1.1.1"><times id="A1.Ex5.m1.1.1.1.2.cmml" xref="A1.Ex5.m1.1.1.1.2"></times><ci id="A1.Ex5.m1.1.1.1.3.cmml" xref="A1.Ex5.m1.1.1.1.3">𝑍</ci><ci id="A1.Ex5.m1.1.1.1.1.cmml" xref="A1.Ex5.m1.1.1.1.1">𝑥</ci></apply></apply><apply id="A1.Ex5.m1.5.5.1.1.3.4.cmml" xref="A1.Ex5.m1.5.5.1.1.3.4"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.1.3.4.1.cmml" xref="A1.Ex5.m1.5.5.1.1.3.4">subscript</csymbol><ci id="A1.Ex5.m1.5.5.1.1.3.4.2.cmml" xref="A1.Ex5.m1.5.5.1.1.3.4.2">𝜋</ci><ci id="A1.Ex5.m1.5.5.1.1.3.4.3a.cmml" xref="A1.Ex5.m1.5.5.1.1.3.4.3"><mtext id="A1.Ex5.m1.5.5.1.1.3.4.3.cmml" mathsize="70%" xref="A1.Ex5.m1.5.5.1.1.3.4.3">ref</mtext></ci></apply><apply id="A1.Ex5.m1.5.5.1.1.2.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="A1.Ex5.m1.5.5.1.1.2.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex5.m1.5.5.1.1.2.1.1.1.2.cmml" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.2">𝑦</ci><ci id="A1.Ex5.m1.5.5.1.1.2.1.1.1.3.cmml" xref="A1.Ex5.m1.5.5.1.1.2.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex5.m1.5.5.1.1.3.2.2.cmml" xref="A1.Ex5.m1.5.5.1.1.3.2.1"><exp id="A1.Ex5.m1.4.4.cmml" xref="A1.Ex5.m1.4.4"></exp><apply id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1"><times id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.1"></times><apply id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.cmml" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2"><divide id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.1.cmml" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2"></divide><cn id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.2.cmml" type="integer" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.2">1</cn><ci id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.3.cmml" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.2.3">𝛽</ci></apply><ci id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.3.cmml" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.1.cmml" xref="A1.Ex5.m1.5.5.1.1.3.2.1.1.1.4.2"><ci id="A1.Ex5.m1.2.2.cmml" xref="A1.Ex5.m1.2.2">𝑥</ci><ci id="A1.Ex5.m1.3.3.cmml" xref="A1.Ex5.m1.3.3">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m1.5c">\pi^{*}(y|x)=\frac{1}{Z(x)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y%
)\right),</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m1.5d">italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y | italic_x ) = divide start_ARG 1 end_ARG start_ARG italic_Z ( italic_x ) end_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.5">which is a valid probability distribution as <math alttext="\pi^{*}(y|x)\geq 0" class="ltx_Math" display="inline" id="A1.SS1.p4.1.m1.1"><semantics id="A1.SS1.p4.1.m1.1a"><mrow id="A1.SS1.p4.1.m1.1.1" xref="A1.SS1.p4.1.m1.1.1.cmml"><mrow id="A1.SS1.p4.1.m1.1.1.1" xref="A1.SS1.p4.1.m1.1.1.1.cmml"><msup id="A1.SS1.p4.1.m1.1.1.1.3" xref="A1.SS1.p4.1.m1.1.1.1.3.cmml"><mi id="A1.SS1.p4.1.m1.1.1.1.3.2" xref="A1.SS1.p4.1.m1.1.1.1.3.2.cmml">π</mi><mo id="A1.SS1.p4.1.m1.1.1.1.3.3" xref="A1.SS1.p4.1.m1.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.SS1.p4.1.m1.1.1.1.2" xref="A1.SS1.p4.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p4.1.m1.1.1.1.1.1" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><mo id="A1.SS1.p4.1.m1.1.1.1.1.1.2" stretchy="false" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p4.1.m1.1.1.1.1.1.1" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.p4.1.m1.1.1.1.1.1.1.2" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS1.p4.1.m1.1.1.1.1.1.1.1" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS1.p4.1.m1.1.1.1.1.1.1.3" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS1.p4.1.m1.1.1.1.1.1.3" stretchy="false" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS1.p4.1.m1.1.1.2" xref="A1.SS1.p4.1.m1.1.1.2.cmml">≥</mo><mn id="A1.SS1.p4.1.m1.1.1.3" xref="A1.SS1.p4.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.1.m1.1b"><apply id="A1.SS1.p4.1.m1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1"><geq id="A1.SS1.p4.1.m1.1.1.2.cmml" xref="A1.SS1.p4.1.m1.1.1.2"></geq><apply id="A1.SS1.p4.1.m1.1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1.1"><times id="A1.SS1.p4.1.m1.1.1.1.2.cmml" xref="A1.SS1.p4.1.m1.1.1.1.2"></times><apply id="A1.SS1.p4.1.m1.1.1.1.3.cmml" xref="A1.SS1.p4.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p4.1.m1.1.1.1.3.1.cmml" xref="A1.SS1.p4.1.m1.1.1.1.3">superscript</csymbol><ci id="A1.SS1.p4.1.m1.1.1.1.3.2.cmml" xref="A1.SS1.p4.1.m1.1.1.1.3.2">𝜋</ci><times id="A1.SS1.p4.1.m1.1.1.1.3.3.cmml" xref="A1.SS1.p4.1.m1.1.1.1.3.3"></times></apply><apply id="A1.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.p4.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><cn id="A1.SS1.p4.1.m1.1.1.3.cmml" type="integer" xref="A1.SS1.p4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.1.m1.1c">\pi^{*}(y|x)\geq 0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.1.m1.1d">italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y | italic_x ) ≥ 0</annotation></semantics></math> for all <math alttext="y" class="ltx_Math" display="inline" id="A1.SS1.p4.2.m2.1"><semantics id="A1.SS1.p4.2.m2.1a"><mi id="A1.SS1.p4.2.m2.1.1" xref="A1.SS1.p4.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.2.m2.1b"><ci id="A1.SS1.p4.2.m2.1.1.cmml" xref="A1.SS1.p4.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.2.m2.1d">italic_y</annotation></semantics></math> and <math alttext="\sum_{y}\pi^{*}(y|x)=1" class="ltx_Math" display="inline" id="A1.SS1.p4.3.m3.1"><semantics id="A1.SS1.p4.3.m3.1a"><mrow id="A1.SS1.p4.3.m3.1.1" xref="A1.SS1.p4.3.m3.1.1.cmml"><mrow id="A1.SS1.p4.3.m3.1.1.1" xref="A1.SS1.p4.3.m3.1.1.1.cmml"><msub id="A1.SS1.p4.3.m3.1.1.1.2" xref="A1.SS1.p4.3.m3.1.1.1.2.cmml"><mo id="A1.SS1.p4.3.m3.1.1.1.2.2" xref="A1.SS1.p4.3.m3.1.1.1.2.2.cmml">∑</mo><mi id="A1.SS1.p4.3.m3.1.1.1.2.3" xref="A1.SS1.p4.3.m3.1.1.1.2.3.cmml">y</mi></msub><mrow id="A1.SS1.p4.3.m3.1.1.1.1" xref="A1.SS1.p4.3.m3.1.1.1.1.cmml"><msup id="A1.SS1.p4.3.m3.1.1.1.1.3" xref="A1.SS1.p4.3.m3.1.1.1.1.3.cmml"><mi id="A1.SS1.p4.3.m3.1.1.1.1.3.2" xref="A1.SS1.p4.3.m3.1.1.1.1.3.2.cmml">π</mi><mo id="A1.SS1.p4.3.m3.1.1.1.1.3.3" xref="A1.SS1.p4.3.m3.1.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.SS1.p4.3.m3.1.1.1.1.2" xref="A1.SS1.p4.3.m3.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p4.3.m3.1.1.1.1.1.1" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.cmml"><mo id="A1.SS1.p4.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p4.3.m3.1.1.1.1.1.1.1" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.2" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.1" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.3" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS1.p4.3.m3.1.1.1.1.1.1.3" stretchy="false" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS1.p4.3.m3.1.1.2" xref="A1.SS1.p4.3.m3.1.1.2.cmml">=</mo><mn id="A1.SS1.p4.3.m3.1.1.3" xref="A1.SS1.p4.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.3.m3.1b"><apply id="A1.SS1.p4.3.m3.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1"><eq id="A1.SS1.p4.3.m3.1.1.2.cmml" xref="A1.SS1.p4.3.m3.1.1.2"></eq><apply id="A1.SS1.p4.3.m3.1.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1.1"><apply id="A1.SS1.p4.3.m3.1.1.1.2.cmml" xref="A1.SS1.p4.3.m3.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p4.3.m3.1.1.1.2.1.cmml" xref="A1.SS1.p4.3.m3.1.1.1.2">subscript</csymbol><sum id="A1.SS1.p4.3.m3.1.1.1.2.2.cmml" xref="A1.SS1.p4.3.m3.1.1.1.2.2"></sum><ci id="A1.SS1.p4.3.m3.1.1.1.2.3.cmml" xref="A1.SS1.p4.3.m3.1.1.1.2.3">𝑦</ci></apply><apply id="A1.SS1.p4.3.m3.1.1.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1"><times id="A1.SS1.p4.3.m3.1.1.1.1.2.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1.2"></times><apply id="A1.SS1.p4.3.m3.1.1.1.1.3.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p4.3.m3.1.1.1.1.3.1.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1.3">superscript</csymbol><ci id="A1.SS1.p4.3.m3.1.1.1.1.3.2.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1.3.2">𝜋</ci><times id="A1.SS1.p4.3.m3.1.1.1.1.3.3.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1.3.3"></times></apply><apply id="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.p4.3.m3.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply><cn id="A1.SS1.p4.3.m3.1.1.3.cmml" type="integer" xref="A1.SS1.p4.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.3.m3.1c">\sum_{y}\pi^{*}(y|x)=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.3.m3.1d">∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y | italic_x ) = 1</annotation></semantics></math>. Since <math alttext="Z(x)" class="ltx_Math" display="inline" id="A1.SS1.p4.4.m4.1"><semantics id="A1.SS1.p4.4.m4.1a"><mrow id="A1.SS1.p4.4.m4.1.2" xref="A1.SS1.p4.4.m4.1.2.cmml"><mi id="A1.SS1.p4.4.m4.1.2.2" xref="A1.SS1.p4.4.m4.1.2.2.cmml">Z</mi><mo id="A1.SS1.p4.4.m4.1.2.1" xref="A1.SS1.p4.4.m4.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.p4.4.m4.1.2.3.2" xref="A1.SS1.p4.4.m4.1.2.cmml"><mo id="A1.SS1.p4.4.m4.1.2.3.2.1" stretchy="false" xref="A1.SS1.p4.4.m4.1.2.cmml">(</mo><mi id="A1.SS1.p4.4.m4.1.1" xref="A1.SS1.p4.4.m4.1.1.cmml">x</mi><mo id="A1.SS1.p4.4.m4.1.2.3.2.2" stretchy="false" xref="A1.SS1.p4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.4.m4.1b"><apply id="A1.SS1.p4.4.m4.1.2.cmml" xref="A1.SS1.p4.4.m4.1.2"><times id="A1.SS1.p4.4.m4.1.2.1.cmml" xref="A1.SS1.p4.4.m4.1.2.1"></times><ci id="A1.SS1.p4.4.m4.1.2.2.cmml" xref="A1.SS1.p4.4.m4.1.2.2">𝑍</ci><ci id="A1.SS1.p4.4.m4.1.1.cmml" xref="A1.SS1.p4.4.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.4.m4.1c">Z(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.4.m4.1d">italic_Z ( italic_x )</annotation></semantics></math> is not a function of <math alttext="y" class="ltx_Math" display="inline" id="A1.SS1.p4.5.m5.1"><semantics id="A1.SS1.p4.5.m5.1a"><mi id="A1.SS1.p4.5.m5.1.1" xref="A1.SS1.p4.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.5.m5.1b"><ci id="A1.SS1.p4.5.m5.1.1.cmml" xref="A1.SS1.p4.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.5.m5.1c">y</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.5.m5.1d">italic_y</annotation></semantics></math>, we can then re-organize the final objective in Eq <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.Ex1" title="A.1 Deriving the Optimum of the KL-Constrained Reward Maximization Objective ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">A.1</span></a> as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx2">
<tbody id="A1.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\left[\mathbb{E}_{y\sim\pi%
(y|x)}\left[\log\frac{\pi(y|x)}{\pi^{*}(y|x)}\right]-\log Z(x)\right]=" class="ltx_Math" display="inline" id="A1.E13.m1.5"><semantics id="A1.E13.m1.5a"><mrow id="A1.E13.m1.5.5" xref="A1.E13.m1.5.5.cmml"><mrow id="A1.E13.m1.5.5.1" xref="A1.E13.m1.5.5.1.cmml"><mrow id="A1.E13.m1.5.5.1.3" xref="A1.E13.m1.5.5.1.3.cmml"><munder id="A1.E13.m1.5.5.1.3.1" xref="A1.E13.m1.5.5.1.3.1.cmml"><mi id="A1.E13.m1.5.5.1.3.1.2" xref="A1.E13.m1.5.5.1.3.1.2.cmml">min</mi><mi id="A1.E13.m1.5.5.1.3.1.3" xref="A1.E13.m1.5.5.1.3.1.3.cmml">π</mi></munder><mo id="A1.E13.m1.5.5.1.3a" lspace="0.167em" xref="A1.E13.m1.5.5.1.3.cmml">⁡</mo><msub id="A1.E13.m1.5.5.1.3.2" xref="A1.E13.m1.5.5.1.3.2.cmml"><mi id="A1.E13.m1.5.5.1.3.2.2" xref="A1.E13.m1.5.5.1.3.2.2.cmml">𝔼</mi><mrow id="A1.E13.m1.5.5.1.3.2.3" xref="A1.E13.m1.5.5.1.3.2.3.cmml"><mi id="A1.E13.m1.5.5.1.3.2.3.2" xref="A1.E13.m1.5.5.1.3.2.3.2.cmml">x</mi><mo id="A1.E13.m1.5.5.1.3.2.3.1" xref="A1.E13.m1.5.5.1.3.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.5.5.1.3.2.3.3" xref="A1.E13.m1.5.5.1.3.2.3.3.cmml">𝒟</mi></mrow></msub></mrow><mo id="A1.E13.m1.5.5.1.2" xref="A1.E13.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.5.5.1.1.1" xref="A1.E13.m1.5.5.1.1.2.cmml"><mo id="A1.E13.m1.5.5.1.1.1.2" xref="A1.E13.m1.5.5.1.1.2.1.cmml">[</mo><mrow id="A1.E13.m1.5.5.1.1.1.1" xref="A1.E13.m1.5.5.1.1.1.1.cmml"><mrow id="A1.E13.m1.5.5.1.1.1.1.1" xref="A1.E13.m1.5.5.1.1.1.1.1.cmml"><msub id="A1.E13.m1.5.5.1.1.1.1.1.3" xref="A1.E13.m1.5.5.1.1.1.1.1.3.cmml"><mi id="A1.E13.m1.5.5.1.1.1.1.1.3.2" xref="A1.E13.m1.5.5.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E13.m1.1.1.1" xref="A1.E13.m1.1.1.1.cmml"><mi id="A1.E13.m1.1.1.1.3" xref="A1.E13.m1.1.1.1.3.cmml">y</mi><mo id="A1.E13.m1.1.1.1.2" xref="A1.E13.m1.1.1.1.2.cmml">∼</mo><mrow id="A1.E13.m1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.cmml"><mi id="A1.E13.m1.1.1.1.1.3" xref="A1.E13.m1.1.1.1.1.3.cmml">π</mi><mo id="A1.E13.m1.1.1.1.1.2" xref="A1.E13.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E13.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E13.m1.1.1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E13.m1.1.1.1.1.1.1.1.2" xref="A1.E13.m1.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E13.m1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E13.m1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E13.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E13.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo id="A1.E13.m1.5.5.1.1.1.1.1.2" xref="A1.E13.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.5.5.1.1.1.1.1.1.1" xref="A1.E13.m1.5.5.1.1.1.1.1.1.2.cmml"><mo id="A1.E13.m1.5.5.1.1.1.1.1.1.1.2" xref="A1.E13.m1.5.5.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E13.m1.5.5.1.1.1.1.1.1.1.1" xref="A1.E13.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E13.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">log</mi><mo id="A1.E13.m1.5.5.1.1.1.1.1.1.1.1a" lspace="0.167em" xref="A1.E13.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁡</mo><mstyle displaystyle="true" id="A1.E13.m1.3.3" xref="A1.E13.m1.3.3.cmml"><mfrac id="A1.E13.m1.3.3a" xref="A1.E13.m1.3.3.cmml"><mrow id="A1.E13.m1.2.2.1" xref="A1.E13.m1.2.2.1.cmml"><mi id="A1.E13.m1.2.2.1.3" xref="A1.E13.m1.2.2.1.3.cmml">π</mi><mo id="A1.E13.m1.2.2.1.2" xref="A1.E13.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.2.2.1.1.1" xref="A1.E13.m1.2.2.1.1.1.1.cmml"><mo id="A1.E13.m1.2.2.1.1.1.2" stretchy="false" xref="A1.E13.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.E13.m1.2.2.1.1.1.1" xref="A1.E13.m1.2.2.1.1.1.1.cmml"><mi id="A1.E13.m1.2.2.1.1.1.1.2" xref="A1.E13.m1.2.2.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E13.m1.2.2.1.1.1.1.1" xref="A1.E13.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="A1.E13.m1.2.2.1.1.1.1.3" xref="A1.E13.m1.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E13.m1.2.2.1.1.1.3" stretchy="false" xref="A1.E13.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E13.m1.3.3.2" xref="A1.E13.m1.3.3.2.cmml"><msup id="A1.E13.m1.3.3.2.3" xref="A1.E13.m1.3.3.2.3.cmml"><mi id="A1.E13.m1.3.3.2.3.2" xref="A1.E13.m1.3.3.2.3.2.cmml">π</mi><mo id="A1.E13.m1.3.3.2.3.3" xref="A1.E13.m1.3.3.2.3.3.cmml">*</mo></msup><mo id="A1.E13.m1.3.3.2.2" xref="A1.E13.m1.3.3.2.2.cmml">⁢</mo><mrow id="A1.E13.m1.3.3.2.1.1" xref="A1.E13.m1.3.3.2.1.1.1.cmml"><mo id="A1.E13.m1.3.3.2.1.1.2" stretchy="false" xref="A1.E13.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="A1.E13.m1.3.3.2.1.1.1" xref="A1.E13.m1.3.3.2.1.1.1.cmml"><mi id="A1.E13.m1.3.3.2.1.1.1.2" xref="A1.E13.m1.3.3.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E13.m1.3.3.2.1.1.1.1" xref="A1.E13.m1.3.3.2.1.1.1.1.cmml">|</mo><mi id="A1.E13.m1.3.3.2.1.1.1.3" xref="A1.E13.m1.3.3.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E13.m1.3.3.2.1.1.3" stretchy="false" xref="A1.E13.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A1.E13.m1.5.5.1.1.1.1.1.1.1.3" xref="A1.E13.m1.5.5.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E13.m1.5.5.1.1.1.1.2" xref="A1.E13.m1.5.5.1.1.1.1.2.cmml">−</mo><mrow id="A1.E13.m1.5.5.1.1.1.1.3" xref="A1.E13.m1.5.5.1.1.1.1.3.cmml"><mrow id="A1.E13.m1.5.5.1.1.1.1.3.2" xref="A1.E13.m1.5.5.1.1.1.1.3.2.cmml"><mi id="A1.E13.m1.5.5.1.1.1.1.3.2.1" xref="A1.E13.m1.5.5.1.1.1.1.3.2.1.cmml">log</mi><mo id="A1.E13.m1.5.5.1.1.1.1.3.2a" lspace="0.167em" xref="A1.E13.m1.5.5.1.1.1.1.3.2.cmml">⁡</mo><mi id="A1.E13.m1.5.5.1.1.1.1.3.2.2" xref="A1.E13.m1.5.5.1.1.1.1.3.2.2.cmml">Z</mi></mrow><mo id="A1.E13.m1.5.5.1.1.1.1.3.1" xref="A1.E13.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E13.m1.5.5.1.1.1.1.3.3.2" xref="A1.E13.m1.5.5.1.1.1.1.3.cmml"><mo id="A1.E13.m1.5.5.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.E13.m1.5.5.1.1.1.1.3.cmml">(</mo><mi id="A1.E13.m1.4.4" xref="A1.E13.m1.4.4.cmml">x</mi><mo id="A1.E13.m1.5.5.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.E13.m1.5.5.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E13.m1.5.5.1.1.1.3" xref="A1.E13.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E13.m1.5.5.2" xref="A1.E13.m1.5.5.2.cmml">=</mo><mi id="A1.E13.m1.5.5.3" xref="A1.E13.m1.5.5.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m1.5b"><apply id="A1.E13.m1.5.5.cmml" xref="A1.E13.m1.5.5"><eq id="A1.E13.m1.5.5.2.cmml" xref="A1.E13.m1.5.5.2"></eq><apply id="A1.E13.m1.5.5.1.cmml" xref="A1.E13.m1.5.5.1"><times id="A1.E13.m1.5.5.1.2.cmml" xref="A1.E13.m1.5.5.1.2"></times><apply id="A1.E13.m1.5.5.1.3.cmml" xref="A1.E13.m1.5.5.1.3"><apply id="A1.E13.m1.5.5.1.3.1.cmml" xref="A1.E13.m1.5.5.1.3.1"><csymbol cd="ambiguous" id="A1.E13.m1.5.5.1.3.1.1.cmml" xref="A1.E13.m1.5.5.1.3.1">subscript</csymbol><min id="A1.E13.m1.5.5.1.3.1.2.cmml" xref="A1.E13.m1.5.5.1.3.1.2"></min><ci id="A1.E13.m1.5.5.1.3.1.3.cmml" xref="A1.E13.m1.5.5.1.3.1.3">𝜋</ci></apply><apply id="A1.E13.m1.5.5.1.3.2.cmml" xref="A1.E13.m1.5.5.1.3.2"><csymbol cd="ambiguous" id="A1.E13.m1.5.5.1.3.2.1.cmml" xref="A1.E13.m1.5.5.1.3.2">subscript</csymbol><ci id="A1.E13.m1.5.5.1.3.2.2.cmml" xref="A1.E13.m1.5.5.1.3.2.2">𝔼</ci><apply id="A1.E13.m1.5.5.1.3.2.3.cmml" xref="A1.E13.m1.5.5.1.3.2.3"><csymbol cd="latexml" id="A1.E13.m1.5.5.1.3.2.3.1.cmml" xref="A1.E13.m1.5.5.1.3.2.3.1">similar-to</csymbol><ci id="A1.E13.m1.5.5.1.3.2.3.2.cmml" xref="A1.E13.m1.5.5.1.3.2.3.2">𝑥</ci><ci id="A1.E13.m1.5.5.1.3.2.3.3.cmml" xref="A1.E13.m1.5.5.1.3.2.3.3">𝒟</ci></apply></apply></apply><apply id="A1.E13.m1.5.5.1.1.2.cmml" xref="A1.E13.m1.5.5.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.5.5.1.1.2.1.cmml" xref="A1.E13.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="A1.E13.m1.5.5.1.1.1.1.cmml" xref="A1.E13.m1.5.5.1.1.1.1"><minus id="A1.E13.m1.5.5.1.1.1.1.2.cmml" xref="A1.E13.m1.5.5.1.1.1.1.2"></minus><apply id="A1.E13.m1.5.5.1.1.1.1.1.cmml" xref="A1.E13.m1.5.5.1.1.1.1.1"><times id="A1.E13.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.E13.m1.5.5.1.1.1.1.1.2"></times><apply id="A1.E13.m1.5.5.1.1.1.1.1.3.cmml" xref="A1.E13.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.5.5.1.1.1.1.1.3.1.cmml" xref="A1.E13.m1.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E13.m1.5.5.1.1.1.1.1.3.2.cmml" xref="A1.E13.m1.5.5.1.1.1.1.1.3.2">𝔼</ci><apply id="A1.E13.m1.1.1.1.cmml" xref="A1.E13.m1.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.2">similar-to</csymbol><ci id="A1.E13.m1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.3">𝑦</ci><apply id="A1.E13.m1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1"><times id="A1.E13.m1.1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.1.2"></times><ci id="A1.E13.m1.1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.1.3">𝜋</ci><apply id="A1.E13.m1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E13.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.E13.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply><apply id="A1.E13.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.5.5.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E13.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.5.5.1.1.1.1.1.1.1.1"><log id="A1.E13.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.5.5.1.1.1.1.1.1.1.1.1"></log><apply id="A1.E13.m1.3.3.cmml" xref="A1.E13.m1.3.3"><divide id="A1.E13.m1.3.3.3.cmml" xref="A1.E13.m1.3.3"></divide><apply id="A1.E13.m1.2.2.1.cmml" xref="A1.E13.m1.2.2.1"><times id="A1.E13.m1.2.2.1.2.cmml" xref="A1.E13.m1.2.2.1.2"></times><ci id="A1.E13.m1.2.2.1.3.cmml" xref="A1.E13.m1.2.2.1.3">𝜋</ci><apply id="A1.E13.m1.2.2.1.1.1.1.cmml" xref="A1.E13.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.2.2.1.1.1.1.1.cmml" xref="A1.E13.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="A1.E13.m1.2.2.1.1.1.1.2.cmml" xref="A1.E13.m1.2.2.1.1.1.1.2">𝑦</ci><ci id="A1.E13.m1.2.2.1.1.1.1.3.cmml" xref="A1.E13.m1.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.E13.m1.3.3.2.cmml" xref="A1.E13.m1.3.3.2"><times id="A1.E13.m1.3.3.2.2.cmml" xref="A1.E13.m1.3.3.2.2"></times><apply id="A1.E13.m1.3.3.2.3.cmml" xref="A1.E13.m1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.2.3.1.cmml" xref="A1.E13.m1.3.3.2.3">superscript</csymbol><ci id="A1.E13.m1.3.3.2.3.2.cmml" xref="A1.E13.m1.3.3.2.3.2">𝜋</ci><times id="A1.E13.m1.3.3.2.3.3.cmml" xref="A1.E13.m1.3.3.2.3.3"></times></apply><apply id="A1.E13.m1.3.3.2.1.1.1.cmml" xref="A1.E13.m1.3.3.2.1.1"><csymbol cd="latexml" id="A1.E13.m1.3.3.2.1.1.1.1.cmml" xref="A1.E13.m1.3.3.2.1.1.1.1">conditional</csymbol><ci id="A1.E13.m1.3.3.2.1.1.1.2.cmml" xref="A1.E13.m1.3.3.2.1.1.1.2">𝑦</ci><ci id="A1.E13.m1.3.3.2.1.1.1.3.cmml" xref="A1.E13.m1.3.3.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E13.m1.5.5.1.1.1.1.3.cmml" xref="A1.E13.m1.5.5.1.1.1.1.3"><times id="A1.E13.m1.5.5.1.1.1.1.3.1.cmml" xref="A1.E13.m1.5.5.1.1.1.1.3.1"></times><apply id="A1.E13.m1.5.5.1.1.1.1.3.2.cmml" xref="A1.E13.m1.5.5.1.1.1.1.3.2"><log id="A1.E13.m1.5.5.1.1.1.1.3.2.1.cmml" xref="A1.E13.m1.5.5.1.1.1.1.3.2.1"></log><ci id="A1.E13.m1.5.5.1.1.1.1.3.2.2.cmml" xref="A1.E13.m1.5.5.1.1.1.1.3.2.2">𝑍</ci></apply><ci id="A1.E13.m1.4.4.cmml" xref="A1.E13.m1.4.4">𝑥</ci></apply></apply></apply></apply><csymbol cd="latexml" id="A1.E13.m1.5.5.3.cmml" xref="A1.E13.m1.5.5.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.5c">\displaystyle\min_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\left[\mathbb{E}_{y\sim\pi%
(y|x)}\left[\log\frac{\pi(y|x)}{\pi^{*}(y|x)}\right]-\log Z(x)\right]=</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.5d">roman_min start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT [ blackboard_E start_POSTSUBSCRIPT italic_y ∼ italic_π ( italic_y | italic_x ) end_POSTSUBSCRIPT [ roman_log divide start_ARG italic_π ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y | italic_x ) end_ARG ] - roman_log italic_Z ( italic_x ) ] =</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="A1.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\left[\mathbb{D}_{\text{KL%
}}(\pi(y|x)\mid\mid\pi^{*}(y|x))-\log Z(x)\right]" class="ltx_math_unparsed" display="inline" id="A1.E14.m1.1"><semantics id="A1.E14.m1.1a"><mrow id="A1.E14.m1.1b"><munder id="A1.E14.m1.1.1"><mi id="A1.E14.m1.1.1.2">min</mi><mi id="A1.E14.m1.1.1.3">π</mi></munder><msub id="A1.E14.m1.1.2"><mi id="A1.E14.m1.1.2.2">𝔼</mi><mrow id="A1.E14.m1.1.2.3"><mi id="A1.E14.m1.1.2.3.2">x</mi><mo id="A1.E14.m1.1.2.3.1">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E14.m1.1.2.3.3">𝒟</mi></mrow></msub><mrow id="A1.E14.m1.1.3"><mo id="A1.E14.m1.1.3.1">[</mo><msub id="A1.E14.m1.1.3.2"><mi id="A1.E14.m1.1.3.2.2">𝔻</mi><mtext id="A1.E14.m1.1.3.2.3">KL</mtext></msub><mrow id="A1.E14.m1.1.3.3"><mo id="A1.E14.m1.1.3.3.1" stretchy="false">(</mo><mi id="A1.E14.m1.1.3.3.2">π</mi><mrow id="A1.E14.m1.1.3.3.3"><mo id="A1.E14.m1.1.3.3.3.1" stretchy="false">(</mo><mi id="A1.E14.m1.1.3.3.3.2">y</mi><mo fence="false" id="A1.E14.m1.1.3.3.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E14.m1.1.3.3.3.4">x</mi><mo id="A1.E14.m1.1.3.3.3.5" stretchy="false">)</mo></mrow><mo id="A1.E14.m1.1.3.3.4" lspace="0em" rspace="0.0835em">∣</mo><mo id="A1.E14.m1.1.3.3.5" lspace="0.0835em" rspace="0.167em">∣</mo><msup id="A1.E14.m1.1.3.3.6"><mi id="A1.E14.m1.1.3.3.6.2">π</mi><mo id="A1.E14.m1.1.3.3.6.3">*</mo></msup><mrow id="A1.E14.m1.1.3.3.7"><mo id="A1.E14.m1.1.3.3.7.1" stretchy="false">(</mo><mi id="A1.E14.m1.1.3.3.7.2">y</mi><mo fence="false" id="A1.E14.m1.1.3.3.7.3" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E14.m1.1.3.3.7.4">x</mi><mo id="A1.E14.m1.1.3.3.7.5" stretchy="false">)</mo></mrow><mo id="A1.E14.m1.1.3.3.8" stretchy="false">)</mo></mrow><mo id="A1.E14.m1.1.3.4">−</mo><mi id="A1.E14.m1.1.3.5">log</mi><mi id="A1.E14.m1.1.3.6">Z</mi><mrow id="A1.E14.m1.1.3.7"><mo id="A1.E14.m1.1.3.7.1" stretchy="false">(</mo><mi id="A1.E14.m1.1.3.7.2">x</mi><mo id="A1.E14.m1.1.3.7.3" stretchy="false">)</mo></mrow><mo id="A1.E14.m1.1.3.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E14.m1.1c">\displaystyle\min_{\pi}\mathbb{E}_{x\sim\mathcal{D}}\left[\mathbb{D}_{\text{KL%
}}(\pi(y|x)\mid\mid\pi^{*}(y|x))-\log Z(x)\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.1d">roman_min start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT [ blackboard_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT ( italic_π ( italic_y | italic_x ) ∣ ∣ italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y | italic_x ) ) - roman_log italic_Z ( italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p4.7">이제, <math alttext="Z(x)" class="ltx_Math" display="inline" id="A1.SS1.p4.6.m1.1"><semantics id="A1.SS1.p4.6.m1.1a"><mrow id="A1.SS1.p4.6.m1.1.2" xref="A1.SS1.p4.6.m1.1.2.cmml"><mi id="A1.SS1.p4.6.m1.1.2.2" xref="A1.SS1.p4.6.m1.1.2.2.cmml">Z</mi><mo id="A1.SS1.p4.6.m1.1.2.1" xref="A1.SS1.p4.6.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.p4.6.m1.1.2.3.2" xref="A1.SS1.p4.6.m1.1.2.cmml"><mo id="A1.SS1.p4.6.m1.1.2.3.2.1" stretchy="false" xref="A1.SS1.p4.6.m1.1.2.cmml">(</mo><mi id="A1.SS1.p4.6.m1.1.1" xref="A1.SS1.p4.6.m1.1.1.cmml">x</mi><mo id="A1.SS1.p4.6.m1.1.2.3.2.2" stretchy="false" xref="A1.SS1.p4.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.6.m1.1b"><apply id="A1.SS1.p4.6.m1.1.2.cmml" xref="A1.SS1.p4.6.m1.1.2"><times id="A1.SS1.p4.6.m1.1.2.1.cmml" xref="A1.SS1.p4.6.m1.1.2.1"></times><ci id="A1.SS1.p4.6.m1.1.2.2.cmml" xref="A1.SS1.p4.6.m1.1.2.2">𝑍</ci><ci id="A1.SS1.p4.6.m1.1.1.cmml" xref="A1.SS1.p4.6.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.6.m1.1c">Z(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.6.m1.1d">italic_Z ( italic_x )</annotation></semantics></math>는 <math alttext="\pi" class="ltx_Math" display="inline" id="A1.SS1.p4.7.m2.1"><semantics id="A1.SS1.p4.7.m2.1a"><mi id="A1.SS1.p4.7.m2.1.1" xref="A1.SS1.p4.7.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.7.m2.1b"><ci id="A1.SS1.p4.7.m2.1.1.cmml" xref="A1.SS1.p4.7.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.7.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.7.m2.1d">italic_π</annotation></semantics></math>에 의존하지 않기 때문에, 최소는 첫 번째 KL 용어를 최소화하는 정책에 의해 달성된다. 깁스의 부등식은 두 분포가 동일한 경우에만 KL-발산이 0에서 최소화된다는 것을 말해준다. 따라서 우리는 최적의 솔루션을 가지고 있다:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi(y|x)=\pi^{*}(y|x)=\frac{1}{Z(x)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{%
\beta}r(x,y)\right)" class="ltx_Math" display="block" id="A1.E15.m1.8"><semantics id="A1.E15.m1.8a"><mrow id="A1.E15.m1.8.8" xref="A1.E15.m1.8.8.cmml"><mrow id="A1.E15.m1.5.5.1" xref="A1.E15.m1.5.5.1.cmml"><mi id="A1.E15.m1.5.5.1.3" xref="A1.E15.m1.5.5.1.3.cmml">π</mi><mo id="A1.E15.m1.5.5.1.2" xref="A1.E15.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.E15.m1.5.5.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.cmml"><mo id="A1.E15.m1.5.5.1.1.1.2" stretchy="false" xref="A1.E15.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="A1.E15.m1.5.5.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.cmml"><mi id="A1.E15.m1.5.5.1.1.1.1.2" xref="A1.E15.m1.5.5.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E15.m1.5.5.1.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="A1.E15.m1.5.5.1.1.1.1.3" xref="A1.E15.m1.5.5.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E15.m1.5.5.1.1.1.3" stretchy="false" xref="A1.E15.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.8.8.6" xref="A1.E15.m1.8.8.6.cmml">=</mo><mrow id="A1.E15.m1.6.6.2" xref="A1.E15.m1.6.6.2.cmml"><msup id="A1.E15.m1.6.6.2.3" xref="A1.E15.m1.6.6.2.3.cmml"><mi id="A1.E15.m1.6.6.2.3.2" xref="A1.E15.m1.6.6.2.3.2.cmml">π</mi><mo id="A1.E15.m1.6.6.2.3.3" xref="A1.E15.m1.6.6.2.3.3.cmml">*</mo></msup><mo id="A1.E15.m1.6.6.2.2" xref="A1.E15.m1.6.6.2.2.cmml">⁢</mo><mrow id="A1.E15.m1.6.6.2.1.1" xref="A1.E15.m1.6.6.2.1.1.1.cmml"><mo id="A1.E15.m1.6.6.2.1.1.2" stretchy="false" xref="A1.E15.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="A1.E15.m1.6.6.2.1.1.1" xref="A1.E15.m1.6.6.2.1.1.1.cmml"><mi id="A1.E15.m1.6.6.2.1.1.1.2" xref="A1.E15.m1.6.6.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E15.m1.6.6.2.1.1.1.1" xref="A1.E15.m1.6.6.2.1.1.1.1.cmml">|</mo><mi id="A1.E15.m1.6.6.2.1.1.1.3" xref="A1.E15.m1.6.6.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E15.m1.6.6.2.1.1.3" stretchy="false" xref="A1.E15.m1.6.6.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.8.8.7" xref="A1.E15.m1.8.8.7.cmml">=</mo><mrow id="A1.E15.m1.8.8.4" xref="A1.E15.m1.8.8.4.cmml"><mfrac id="A1.E15.m1.1.1" xref="A1.E15.m1.1.1.cmml"><mn id="A1.E15.m1.1.1.3" xref="A1.E15.m1.1.1.3.cmml">1</mn><mrow id="A1.E15.m1.1.1.1" xref="A1.E15.m1.1.1.1.cmml"><mi id="A1.E15.m1.1.1.1.3" xref="A1.E15.m1.1.1.1.3.cmml">Z</mi><mo id="A1.E15.m1.1.1.1.2" xref="A1.E15.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E15.m1.1.1.1.4.2" xref="A1.E15.m1.1.1.1.cmml"><mo id="A1.E15.m1.1.1.1.4.2.1" stretchy="false" xref="A1.E15.m1.1.1.1.cmml">(</mo><mi id="A1.E15.m1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.cmml">x</mi><mo id="A1.E15.m1.1.1.1.4.2.2" stretchy="false" xref="A1.E15.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.E15.m1.8.8.4.3" xref="A1.E15.m1.8.8.4.3.cmml">⁢</mo><msub id="A1.E15.m1.8.8.4.4" xref="A1.E15.m1.8.8.4.4.cmml"><mi id="A1.E15.m1.8.8.4.4.2" xref="A1.E15.m1.8.8.4.4.2.cmml">π</mi><mtext id="A1.E15.m1.8.8.4.4.3" xref="A1.E15.m1.8.8.4.4.3a.cmml">ref</mtext></msub><mo id="A1.E15.m1.8.8.4.3a" xref="A1.E15.m1.8.8.4.3.cmml">⁢</mo><mrow id="A1.E15.m1.7.7.3.1.1" xref="A1.E15.m1.7.7.3.1.1.1.cmml"><mo id="A1.E15.m1.7.7.3.1.1.2" stretchy="false" xref="A1.E15.m1.7.7.3.1.1.1.cmml">(</mo><mrow id="A1.E15.m1.7.7.3.1.1.1" xref="A1.E15.m1.7.7.3.1.1.1.cmml"><mi id="A1.E15.m1.7.7.3.1.1.1.2" xref="A1.E15.m1.7.7.3.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E15.m1.7.7.3.1.1.1.1" xref="A1.E15.m1.7.7.3.1.1.1.1.cmml">|</mo><mi id="A1.E15.m1.7.7.3.1.1.1.3" xref="A1.E15.m1.7.7.3.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E15.m1.7.7.3.1.1.3" stretchy="false" xref="A1.E15.m1.7.7.3.1.1.1.cmml">)</mo></mrow><mo id="A1.E15.m1.8.8.4.3b" lspace="0.167em" xref="A1.E15.m1.8.8.4.3.cmml">⁢</mo><mrow id="A1.E15.m1.8.8.4.2.1" xref="A1.E15.m1.8.8.4.2.2.cmml"><mi id="A1.E15.m1.4.4" xref="A1.E15.m1.4.4.cmml">exp</mi><mo id="A1.E15.m1.8.8.4.2.1a" xref="A1.E15.m1.8.8.4.2.2.cmml">⁡</mo><mrow id="A1.E15.m1.8.8.4.2.1.1" xref="A1.E15.m1.8.8.4.2.2.cmml"><mo id="A1.E15.m1.8.8.4.2.1.1.2" xref="A1.E15.m1.8.8.4.2.2.cmml">(</mo><mrow id="A1.E15.m1.8.8.4.2.1.1.1" xref="A1.E15.m1.8.8.4.2.1.1.1.cmml"><mfrac id="A1.E15.m1.8.8.4.2.1.1.1.2" xref="A1.E15.m1.8.8.4.2.1.1.1.2.cmml"><mn id="A1.E15.m1.8.8.4.2.1.1.1.2.2" xref="A1.E15.m1.8.8.4.2.1.1.1.2.2.cmml">1</mn><mi id="A1.E15.m1.8.8.4.2.1.1.1.2.3" xref="A1.E15.m1.8.8.4.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.E15.m1.8.8.4.2.1.1.1.1" xref="A1.E15.m1.8.8.4.2.1.1.1.1.cmml">⁢</mo><mi id="A1.E15.m1.8.8.4.2.1.1.1.3" xref="A1.E15.m1.8.8.4.2.1.1.1.3.cmml">r</mi><mo id="A1.E15.m1.8.8.4.2.1.1.1.1a" xref="A1.E15.m1.8.8.4.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.E15.m1.8.8.4.2.1.1.1.4.2" xref="A1.E15.m1.8.8.4.2.1.1.1.4.1.cmml"><mo id="A1.E15.m1.8.8.4.2.1.1.1.4.2.1" stretchy="false" xref="A1.E15.m1.8.8.4.2.1.1.1.4.1.cmml">(</mo><mi id="A1.E15.m1.2.2" xref="A1.E15.m1.2.2.cmml">x</mi><mo id="A1.E15.m1.8.8.4.2.1.1.1.4.2.2" xref="A1.E15.m1.8.8.4.2.1.1.1.4.1.cmml">,</mo><mi id="A1.E15.m1.3.3" xref="A1.E15.m1.3.3.cmml">y</mi><mo id="A1.E15.m1.8.8.4.2.1.1.1.4.2.3" stretchy="false" xref="A1.E15.m1.8.8.4.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.8.8.4.2.1.1.3" xref="A1.E15.m1.8.8.4.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.8b"><apply id="A1.E15.m1.8.8.cmml" xref="A1.E15.m1.8.8"><and id="A1.E15.m1.8.8a.cmml" xref="A1.E15.m1.8.8"></and><apply id="A1.E15.m1.8.8b.cmml" xref="A1.E15.m1.8.8"><eq id="A1.E15.m1.8.8.6.cmml" xref="A1.E15.m1.8.8.6"></eq><apply id="A1.E15.m1.5.5.1.cmml" xref="A1.E15.m1.5.5.1"><times id="A1.E15.m1.5.5.1.2.cmml" xref="A1.E15.m1.5.5.1.2"></times><ci id="A1.E15.m1.5.5.1.3.cmml" xref="A1.E15.m1.5.5.1.3">𝜋</ci><apply id="A1.E15.m1.5.5.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1"><csymbol cd="latexml" id="A1.E15.m1.5.5.1.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="A1.E15.m1.5.5.1.1.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.1.1.2">𝑦</ci><ci id="A1.E15.m1.5.5.1.1.1.1.3.cmml" xref="A1.E15.m1.5.5.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.E15.m1.6.6.2.cmml" xref="A1.E15.m1.6.6.2"><times id="A1.E15.m1.6.6.2.2.cmml" xref="A1.E15.m1.6.6.2.2"></times><apply id="A1.E15.m1.6.6.2.3.cmml" xref="A1.E15.m1.6.6.2.3"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.2.3.1.cmml" xref="A1.E15.m1.6.6.2.3">superscript</csymbol><ci id="A1.E15.m1.6.6.2.3.2.cmml" xref="A1.E15.m1.6.6.2.3.2">𝜋</ci><times id="A1.E15.m1.6.6.2.3.3.cmml" xref="A1.E15.m1.6.6.2.3.3"></times></apply><apply id="A1.E15.m1.6.6.2.1.1.1.cmml" xref="A1.E15.m1.6.6.2.1.1"><csymbol cd="latexml" id="A1.E15.m1.6.6.2.1.1.1.1.cmml" xref="A1.E15.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="A1.E15.m1.6.6.2.1.1.1.2.cmml" xref="A1.E15.m1.6.6.2.1.1.1.2">𝑦</ci><ci id="A1.E15.m1.6.6.2.1.1.1.3.cmml" xref="A1.E15.m1.6.6.2.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="A1.E15.m1.8.8c.cmml" xref="A1.E15.m1.8.8"><eq id="A1.E15.m1.8.8.7.cmml" xref="A1.E15.m1.8.8.7"></eq><share href="#A1.E15.m1.6.6.2.cmml" id="A1.E15.m1.8.8d.cmml" xref="A1.E15.m1.8.8"></share><apply id="A1.E15.m1.8.8.4.cmml" xref="A1.E15.m1.8.8.4"><times id="A1.E15.m1.8.8.4.3.cmml" xref="A1.E15.m1.8.8.4.3"></times><apply id="A1.E15.m1.1.1.cmml" xref="A1.E15.m1.1.1"><divide id="A1.E15.m1.1.1.2.cmml" xref="A1.E15.m1.1.1"></divide><cn id="A1.E15.m1.1.1.3.cmml" type="integer" xref="A1.E15.m1.1.1.3">1</cn><apply id="A1.E15.m1.1.1.1.cmml" xref="A1.E15.m1.1.1.1"><times id="A1.E15.m1.1.1.1.2.cmml" xref="A1.E15.m1.1.1.1.2"></times><ci id="A1.E15.m1.1.1.1.3.cmml" xref="A1.E15.m1.1.1.1.3">𝑍</ci><ci id="A1.E15.m1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1">𝑥</ci></apply></apply><apply id="A1.E15.m1.8.8.4.4.cmml" xref="A1.E15.m1.8.8.4.4"><csymbol cd="ambiguous" id="A1.E15.m1.8.8.4.4.1.cmml" xref="A1.E15.m1.8.8.4.4">subscript</csymbol><ci id="A1.E15.m1.8.8.4.4.2.cmml" xref="A1.E15.m1.8.8.4.4.2">𝜋</ci><ci id="A1.E15.m1.8.8.4.4.3a.cmml" xref="A1.E15.m1.8.8.4.4.3"><mtext id="A1.E15.m1.8.8.4.4.3.cmml" mathsize="70%" xref="A1.E15.m1.8.8.4.4.3">ref</mtext></ci></apply><apply id="A1.E15.m1.7.7.3.1.1.1.cmml" xref="A1.E15.m1.7.7.3.1.1"><csymbol cd="latexml" id="A1.E15.m1.7.7.3.1.1.1.1.cmml" xref="A1.E15.m1.7.7.3.1.1.1.1">conditional</csymbol><ci id="A1.E15.m1.7.7.3.1.1.1.2.cmml" xref="A1.E15.m1.7.7.3.1.1.1.2">𝑦</ci><ci id="A1.E15.m1.7.7.3.1.1.1.3.cmml" xref="A1.E15.m1.7.7.3.1.1.1.3">𝑥</ci></apply><apply id="A1.E15.m1.8.8.4.2.2.cmml" xref="A1.E15.m1.8.8.4.2.1"><exp id="A1.E15.m1.4.4.cmml" xref="A1.E15.m1.4.4"></exp><apply id="A1.E15.m1.8.8.4.2.1.1.1.cmml" xref="A1.E15.m1.8.8.4.2.1.1.1"><times id="A1.E15.m1.8.8.4.2.1.1.1.1.cmml" xref="A1.E15.m1.8.8.4.2.1.1.1.1"></times><apply id="A1.E15.m1.8.8.4.2.1.1.1.2.cmml" xref="A1.E15.m1.8.8.4.2.1.1.1.2"><divide id="A1.E15.m1.8.8.4.2.1.1.1.2.1.cmml" xref="A1.E15.m1.8.8.4.2.1.1.1.2"></divide><cn id="A1.E15.m1.8.8.4.2.1.1.1.2.2.cmml" type="integer" xref="A1.E15.m1.8.8.4.2.1.1.1.2.2">1</cn><ci id="A1.E15.m1.8.8.4.2.1.1.1.2.3.cmml" xref="A1.E15.m1.8.8.4.2.1.1.1.2.3">𝛽</ci></apply><ci id="A1.E15.m1.8.8.4.2.1.1.1.3.cmml" xref="A1.E15.m1.8.8.4.2.1.1.1.3">𝑟</ci><interval closure="open" id="A1.E15.m1.8.8.4.2.1.1.1.4.1.cmml" xref="A1.E15.m1.8.8.4.2.1.1.1.4.2"><ci id="A1.E15.m1.2.2.cmml" xref="A1.E15.m1.2.2">𝑥</ci><ci id="A1.E15.m1.3.3.cmml" xref="A1.E15.m1.3.3">𝑦</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.8c">\pi(y|x)=\pi^{*}(y|x)=\frac{1}{Z(x)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{%
\beta}r(x,y)\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.8d">italic_π ( italic_y | italic_x ) = italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y | italic_x ) = divide start_ARG 1 end_ARG start_ARG italic_Z ( italic_x ) end_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p4.8">for all <math alttext="x\in\mathcal{D}" class="ltx_Math" display="inline" id="A1.SS1.p4.8.m1.1"><semantics id="A1.SS1.p4.8.m1.1a"><mrow id="A1.SS1.p4.8.m1.1.1" xref="A1.SS1.p4.8.m1.1.1.cmml"><mi id="A1.SS1.p4.8.m1.1.1.2" xref="A1.SS1.p4.8.m1.1.1.2.cmml">x</mi><mo id="A1.SS1.p4.8.m1.1.1.1" xref="A1.SS1.p4.8.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p4.8.m1.1.1.3" xref="A1.SS1.p4.8.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.8.m1.1b"><apply id="A1.SS1.p4.8.m1.1.1.cmml" xref="A1.SS1.p4.8.m1.1.1"><in id="A1.SS1.p4.8.m1.1.1.1.cmml" xref="A1.SS1.p4.8.m1.1.1.1"></in><ci id="A1.SS1.p4.8.m1.1.1.2.cmml" xref="A1.SS1.p4.8.m1.1.1.2">𝑥</ci><ci id="A1.SS1.p4.8.m1.1.1.3.cmml" xref="A1.SS1.p4.8.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.8.m1.1c">x\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.8.m1.1d">italic_x ∈ caligraphic_D</annotation></semantics></math>. 이로써 도출이 완료된다.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Deriving the DPO Objective Under the Bradley-Terry Model</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">브래들리-테리 선호 모델에서 DPO 목표를 도출하는 것은 간단합니다.</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p^{*}(y_{1}\succ y_{2}|x)=\frac{\exp\left(r^{*}(x,y_{1})\right)}{\exp\left(r^{%
*}(x,y_{1})\right)+\exp\left(r^{*}(x,y_{2})\right)}" class="ltx_Math" display="block" id="A1.E16.m1.10"><semantics id="A1.E16.m1.10a"><mrow id="A1.E16.m1.10.10" xref="A1.E16.m1.10.10.cmml"><mrow id="A1.E16.m1.10.10.1" xref="A1.E16.m1.10.10.1.cmml"><msup id="A1.E16.m1.10.10.1.3" xref="A1.E16.m1.10.10.1.3.cmml"><mi id="A1.E16.m1.10.10.1.3.2" xref="A1.E16.m1.10.10.1.3.2.cmml">p</mi><mo id="A1.E16.m1.10.10.1.3.3" xref="A1.E16.m1.10.10.1.3.3.cmml">*</mo></msup><mo id="A1.E16.m1.10.10.1.2" xref="A1.E16.m1.10.10.1.2.cmml">⁢</mo><mrow id="A1.E16.m1.10.10.1.1.1" xref="A1.E16.m1.10.10.1.1.1.1.cmml"><mo id="A1.E16.m1.10.10.1.1.1.2" stretchy="false" xref="A1.E16.m1.10.10.1.1.1.1.cmml">(</mo><mrow id="A1.E16.m1.10.10.1.1.1.1" xref="A1.E16.m1.10.10.1.1.1.1.cmml"><msub id="A1.E16.m1.10.10.1.1.1.1.2" xref="A1.E16.m1.10.10.1.1.1.1.2.cmml"><mi id="A1.E16.m1.10.10.1.1.1.1.2.2" xref="A1.E16.m1.10.10.1.1.1.1.2.2.cmml">y</mi><mn id="A1.E16.m1.10.10.1.1.1.1.2.3" xref="A1.E16.m1.10.10.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A1.E16.m1.10.10.1.1.1.1.1" xref="A1.E16.m1.10.10.1.1.1.1.1.cmml">≻</mo><mrow id="A1.E16.m1.10.10.1.1.1.1.3" xref="A1.E16.m1.10.10.1.1.1.1.3.cmml"><msub id="A1.E16.m1.10.10.1.1.1.1.3.2" xref="A1.E16.m1.10.10.1.1.1.1.3.2.cmml"><mi id="A1.E16.m1.10.10.1.1.1.1.3.2.2" xref="A1.E16.m1.10.10.1.1.1.1.3.2.2.cmml">y</mi><mn id="A1.E16.m1.10.10.1.1.1.1.3.2.3" xref="A1.E16.m1.10.10.1.1.1.1.3.2.3.cmml">2</mn></msub><mo fence="false" id="A1.E16.m1.10.10.1.1.1.1.3.1" xref="A1.E16.m1.10.10.1.1.1.1.3.1.cmml">|</mo><mi id="A1.E16.m1.10.10.1.1.1.1.3.3" xref="A1.E16.m1.10.10.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="A1.E16.m1.10.10.1.1.1.3" stretchy="false" xref="A1.E16.m1.10.10.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.10.10.2" xref="A1.E16.m1.10.10.2.cmml">=</mo><mfrac id="A1.E16.m1.9.9" xref="A1.E16.m1.9.9.cmml"><mrow id="A1.E16.m1.3.3.3.3" xref="A1.E16.m1.3.3.3.4.cmml"><mi id="A1.E16.m1.2.2.2.2" xref="A1.E16.m1.2.2.2.2.cmml">exp</mi><mo id="A1.E16.m1.3.3.3.3a" xref="A1.E16.m1.3.3.3.4.cmml">⁡</mo><mrow id="A1.E16.m1.3.3.3.3.1" xref="A1.E16.m1.3.3.3.4.cmml"><mo id="A1.E16.m1.3.3.3.3.1.2" xref="A1.E16.m1.3.3.3.4.cmml">(</mo><mrow id="A1.E16.m1.3.3.3.3.1.1" xref="A1.E16.m1.3.3.3.3.1.1.cmml"><msup id="A1.E16.m1.3.3.3.3.1.1.3" xref="A1.E16.m1.3.3.3.3.1.1.3.cmml"><mi id="A1.E16.m1.3.3.3.3.1.1.3.2" xref="A1.E16.m1.3.3.3.3.1.1.3.2.cmml">r</mi><mo id="A1.E16.m1.3.3.3.3.1.1.3.3" xref="A1.E16.m1.3.3.3.3.1.1.3.3.cmml">*</mo></msup><mo id="A1.E16.m1.3.3.3.3.1.1.2" xref="A1.E16.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E16.m1.3.3.3.3.1.1.1.1" xref="A1.E16.m1.3.3.3.3.1.1.1.2.cmml"><mo id="A1.E16.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="A1.E16.m1.3.3.3.3.1.1.1.2.cmml">(</mo><mi id="A1.E16.m1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.cmml">x</mi><mo id="A1.E16.m1.3.3.3.3.1.1.1.1.3" xref="A1.E16.m1.3.3.3.3.1.1.1.2.cmml">,</mo><msub id="A1.E16.m1.3.3.3.3.1.1.1.1.1" xref="A1.E16.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="A1.E16.m1.3.3.3.3.1.1.1.1.1.2" xref="A1.E16.m1.3.3.3.3.1.1.1.1.1.2.cmml">y</mi><mn id="A1.E16.m1.3.3.3.3.1.1.1.1.1.3" xref="A1.E16.m1.3.3.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.E16.m1.3.3.3.3.1.1.1.1.4" stretchy="false" xref="A1.E16.m1.3.3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.3.3.3.3.1.3" xref="A1.E16.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="A1.E16.m1.9.9.9" xref="A1.E16.m1.9.9.9.cmml"><mrow id="A1.E16.m1.8.8.8.5.1" xref="A1.E16.m1.8.8.8.5.2.cmml"><mi id="A1.E16.m1.5.5.5.2" xref="A1.E16.m1.5.5.5.2.cmml">exp</mi><mo id="A1.E16.m1.8.8.8.5.1a" xref="A1.E16.m1.8.8.8.5.2.cmml">⁡</mo><mrow id="A1.E16.m1.8.8.8.5.1.1" xref="A1.E16.m1.8.8.8.5.2.cmml"><mo id="A1.E16.m1.8.8.8.5.1.1.2" xref="A1.E16.m1.8.8.8.5.2.cmml">(</mo><mrow id="A1.E16.m1.8.8.8.5.1.1.1" xref="A1.E16.m1.8.8.8.5.1.1.1.cmml"><msup id="A1.E16.m1.8.8.8.5.1.1.1.3" xref="A1.E16.m1.8.8.8.5.1.1.1.3.cmml"><mi id="A1.E16.m1.8.8.8.5.1.1.1.3.2" xref="A1.E16.m1.8.8.8.5.1.1.1.3.2.cmml">r</mi><mo id="A1.E16.m1.8.8.8.5.1.1.1.3.3" xref="A1.E16.m1.8.8.8.5.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.E16.m1.8.8.8.5.1.1.1.2" xref="A1.E16.m1.8.8.8.5.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.m1.8.8.8.5.1.1.1.1.1" xref="A1.E16.m1.8.8.8.5.1.1.1.1.2.cmml"><mo id="A1.E16.m1.8.8.8.5.1.1.1.1.1.2" stretchy="false" xref="A1.E16.m1.8.8.8.5.1.1.1.1.2.cmml">(</mo><mi id="A1.E16.m1.4.4.4.1" xref="A1.E16.m1.4.4.4.1.cmml">x</mi><mo id="A1.E16.m1.8.8.8.5.1.1.1.1.1.3" xref="A1.E16.m1.8.8.8.5.1.1.1.1.2.cmml">,</mo><msub id="A1.E16.m1.8.8.8.5.1.1.1.1.1.1" xref="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.cmml"><mi id="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.2" xref="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.2.cmml">y</mi><mn id="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.3" xref="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.E16.m1.8.8.8.5.1.1.1.1.1.4" stretchy="false" xref="A1.E16.m1.8.8.8.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.8.8.8.5.1.1.3" xref="A1.E16.m1.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.9.9.9.7" xref="A1.E16.m1.9.9.9.7.cmml">+</mo><mrow id="A1.E16.m1.9.9.9.6.1" xref="A1.E16.m1.9.9.9.6.2.cmml"><mi id="A1.E16.m1.7.7.7.4" xref="A1.E16.m1.7.7.7.4.cmml">exp</mi><mo id="A1.E16.m1.9.9.9.6.1a" xref="A1.E16.m1.9.9.9.6.2.cmml">⁡</mo><mrow id="A1.E16.m1.9.9.9.6.1.1" xref="A1.E16.m1.9.9.9.6.2.cmml"><mo id="A1.E16.m1.9.9.9.6.1.1.2" xref="A1.E16.m1.9.9.9.6.2.cmml">(</mo><mrow id="A1.E16.m1.9.9.9.6.1.1.1" xref="A1.E16.m1.9.9.9.6.1.1.1.cmml"><msup id="A1.E16.m1.9.9.9.6.1.1.1.3" xref="A1.E16.m1.9.9.9.6.1.1.1.3.cmml"><mi id="A1.E16.m1.9.9.9.6.1.1.1.3.2" xref="A1.E16.m1.9.9.9.6.1.1.1.3.2.cmml">r</mi><mo id="A1.E16.m1.9.9.9.6.1.1.1.3.3" xref="A1.E16.m1.9.9.9.6.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.E16.m1.9.9.9.6.1.1.1.2" xref="A1.E16.m1.9.9.9.6.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.m1.9.9.9.6.1.1.1.1.1" xref="A1.E16.m1.9.9.9.6.1.1.1.1.2.cmml"><mo id="A1.E16.m1.9.9.9.6.1.1.1.1.1.2" stretchy="false" xref="A1.E16.m1.9.9.9.6.1.1.1.1.2.cmml">(</mo><mi id="A1.E16.m1.6.6.6.3" xref="A1.E16.m1.6.6.6.3.cmml">x</mi><mo id="A1.E16.m1.9.9.9.6.1.1.1.1.1.3" xref="A1.E16.m1.9.9.9.6.1.1.1.1.2.cmml">,</mo><msub id="A1.E16.m1.9.9.9.6.1.1.1.1.1.1" xref="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.cmml"><mi id="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.2" xref="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.2.cmml">y</mi><mn id="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.3" xref="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="A1.E16.m1.9.9.9.6.1.1.1.1.1.4" stretchy="false" xref="A1.E16.m1.9.9.9.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.9.9.9.6.1.1.3" xref="A1.E16.m1.9.9.9.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.10b"><apply id="A1.E16.m1.10.10.cmml" xref="A1.E16.m1.10.10"><eq id="A1.E16.m1.10.10.2.cmml" xref="A1.E16.m1.10.10.2"></eq><apply id="A1.E16.m1.10.10.1.cmml" xref="A1.E16.m1.10.10.1"><times id="A1.E16.m1.10.10.1.2.cmml" xref="A1.E16.m1.10.10.1.2"></times><apply id="A1.E16.m1.10.10.1.3.cmml" xref="A1.E16.m1.10.10.1.3"><csymbol cd="ambiguous" id="A1.E16.m1.10.10.1.3.1.cmml" xref="A1.E16.m1.10.10.1.3">superscript</csymbol><ci id="A1.E16.m1.10.10.1.3.2.cmml" xref="A1.E16.m1.10.10.1.3.2">𝑝</ci><times id="A1.E16.m1.10.10.1.3.3.cmml" xref="A1.E16.m1.10.10.1.3.3"></times></apply><apply id="A1.E16.m1.10.10.1.1.1.1.cmml" xref="A1.E16.m1.10.10.1.1.1"><csymbol cd="latexml" id="A1.E16.m1.10.10.1.1.1.1.1.cmml" xref="A1.E16.m1.10.10.1.1.1.1.1">succeeds</csymbol><apply id="A1.E16.m1.10.10.1.1.1.1.2.cmml" xref="A1.E16.m1.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.m1.10.10.1.1.1.1.2.1.cmml" xref="A1.E16.m1.10.10.1.1.1.1.2">subscript</csymbol><ci id="A1.E16.m1.10.10.1.1.1.1.2.2.cmml" xref="A1.E16.m1.10.10.1.1.1.1.2.2">𝑦</ci><cn id="A1.E16.m1.10.10.1.1.1.1.2.3.cmml" type="integer" xref="A1.E16.m1.10.10.1.1.1.1.2.3">1</cn></apply><apply id="A1.E16.m1.10.10.1.1.1.1.3.cmml" xref="A1.E16.m1.10.10.1.1.1.1.3"><csymbol cd="latexml" id="A1.E16.m1.10.10.1.1.1.1.3.1.cmml" xref="A1.E16.m1.10.10.1.1.1.1.3.1">conditional</csymbol><apply id="A1.E16.m1.10.10.1.1.1.1.3.2.cmml" xref="A1.E16.m1.10.10.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.10.10.1.1.1.1.3.2.1.cmml" xref="A1.E16.m1.10.10.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E16.m1.10.10.1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.10.10.1.1.1.1.3.2.2">𝑦</ci><cn id="A1.E16.m1.10.10.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E16.m1.10.10.1.1.1.1.3.2.3">2</cn></apply><ci id="A1.E16.m1.10.10.1.1.1.1.3.3.cmml" xref="A1.E16.m1.10.10.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="A1.E16.m1.9.9.cmml" xref="A1.E16.m1.9.9"><divide id="A1.E16.m1.9.9.10.cmml" xref="A1.E16.m1.9.9"></divide><apply id="A1.E16.m1.3.3.3.4.cmml" xref="A1.E16.m1.3.3.3.3"><exp id="A1.E16.m1.2.2.2.2.cmml" xref="A1.E16.m1.2.2.2.2"></exp><apply id="A1.E16.m1.3.3.3.3.1.1.cmml" xref="A1.E16.m1.3.3.3.3.1.1"><times id="A1.E16.m1.3.3.3.3.1.1.2.cmml" xref="A1.E16.m1.3.3.3.3.1.1.2"></times><apply id="A1.E16.m1.3.3.3.3.1.1.3.cmml" xref="A1.E16.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="A1.E16.m1.3.3.3.3.1.1.3.1.cmml" xref="A1.E16.m1.3.3.3.3.1.1.3">superscript</csymbol><ci id="A1.E16.m1.3.3.3.3.1.1.3.2.cmml" xref="A1.E16.m1.3.3.3.3.1.1.3.2">𝑟</ci><times id="A1.E16.m1.3.3.3.3.1.1.3.3.cmml" xref="A1.E16.m1.3.3.3.3.1.1.3.3"></times></apply><interval closure="open" id="A1.E16.m1.3.3.3.3.1.1.1.2.cmml" xref="A1.E16.m1.3.3.3.3.1.1.1.1"><ci id="A1.E16.m1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1">𝑥</ci><apply id="A1.E16.m1.3.3.3.3.1.1.1.1.1.cmml" xref="A1.E16.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A1.E16.m1.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="A1.E16.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="A1.E16.m1.3.3.3.3.1.1.1.1.1.2">𝑦</ci><cn id="A1.E16.m1.3.3.3.3.1.1.1.1.1.3.cmml" type="integer" xref="A1.E16.m1.3.3.3.3.1.1.1.1.1.3">1</cn></apply></interval></apply></apply><apply id="A1.E16.m1.9.9.9.cmml" xref="A1.E16.m1.9.9.9"><plus id="A1.E16.m1.9.9.9.7.cmml" xref="A1.E16.m1.9.9.9.7"></plus><apply id="A1.E16.m1.8.8.8.5.2.cmml" xref="A1.E16.m1.8.8.8.5.1"><exp id="A1.E16.m1.5.5.5.2.cmml" xref="A1.E16.m1.5.5.5.2"></exp><apply id="A1.E16.m1.8.8.8.5.1.1.1.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1"><times id="A1.E16.m1.8.8.8.5.1.1.1.2.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1.2"></times><apply id="A1.E16.m1.8.8.8.5.1.1.1.3.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1.3"><csymbol cd="ambiguous" id="A1.E16.m1.8.8.8.5.1.1.1.3.1.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1.3">superscript</csymbol><ci id="A1.E16.m1.8.8.8.5.1.1.1.3.2.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1.3.2">𝑟</ci><times id="A1.E16.m1.8.8.8.5.1.1.1.3.3.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1.3.3"></times></apply><interval closure="open" id="A1.E16.m1.8.8.8.5.1.1.1.1.2.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1.1.1"><ci id="A1.E16.m1.4.4.4.1.cmml" xref="A1.E16.m1.4.4.4.1">𝑥</ci><apply id="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.2">𝑦</ci><cn id="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E16.m1.8.8.8.5.1.1.1.1.1.1.3">1</cn></apply></interval></apply></apply><apply id="A1.E16.m1.9.9.9.6.2.cmml" xref="A1.E16.m1.9.9.9.6.1"><exp id="A1.E16.m1.7.7.7.4.cmml" xref="A1.E16.m1.7.7.7.4"></exp><apply id="A1.E16.m1.9.9.9.6.1.1.1.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1"><times id="A1.E16.m1.9.9.9.6.1.1.1.2.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1.2"></times><apply id="A1.E16.m1.9.9.9.6.1.1.1.3.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1.3"><csymbol cd="ambiguous" id="A1.E16.m1.9.9.9.6.1.1.1.3.1.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1.3">superscript</csymbol><ci id="A1.E16.m1.9.9.9.6.1.1.1.3.2.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1.3.2">𝑟</ci><times id="A1.E16.m1.9.9.9.6.1.1.1.3.3.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1.3.3"></times></apply><interval closure="open" id="A1.E16.m1.9.9.9.6.1.1.1.1.2.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1.1.1"><ci id="A1.E16.m1.6.6.6.3.cmml" xref="A1.E16.m1.6.6.6.3">𝑥</ci><apply id="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.2">𝑦</ci><cn id="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E16.m1.9.9.9.6.1.1.1.1.1.1.3">2</cn></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.10c">p^{*}(y_{1}\succ y_{2}|x)=\frac{\exp\left(r^{*}(x,y_{1})\right)}{\exp\left(r^{%
*}(x,y_{1})\right)+\exp\left(r^{*}(x,y_{2})\right)}</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.10d">italic_p start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x ) = divide start_ARG roman_exp ( italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ) end_ARG start_ARG roman_exp ( italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ) + roman_exp ( italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1">섹션 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4" title="4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>에서 우리는 해당 최적 정책을 통해 (이용할 수 없는) 그라운드-진실 보상을 표현할 수 있음을 보여주었다:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r^{*}(x,y)=\beta\log\frac{\pi^{*}(y|x)}{\pi_{\text{ref}}(y|x)}+\beta\log Z(x)" class="ltx_Math" display="block" id="A1.E17.m1.5"><semantics id="A1.E17.m1.5a"><mrow id="A1.E17.m1.5.6" xref="A1.E17.m1.5.6.cmml"><mrow id="A1.E17.m1.5.6.2" xref="A1.E17.m1.5.6.2.cmml"><msup id="A1.E17.m1.5.6.2.2" xref="A1.E17.m1.5.6.2.2.cmml"><mi id="A1.E17.m1.5.6.2.2.2" xref="A1.E17.m1.5.6.2.2.2.cmml">r</mi><mo id="A1.E17.m1.5.6.2.2.3" xref="A1.E17.m1.5.6.2.2.3.cmml">*</mo></msup><mo id="A1.E17.m1.5.6.2.1" xref="A1.E17.m1.5.6.2.1.cmml">⁢</mo><mrow id="A1.E17.m1.5.6.2.3.2" xref="A1.E17.m1.5.6.2.3.1.cmml"><mo id="A1.E17.m1.5.6.2.3.2.1" stretchy="false" xref="A1.E17.m1.5.6.2.3.1.cmml">(</mo><mi id="A1.E17.m1.3.3" xref="A1.E17.m1.3.3.cmml">x</mi><mo id="A1.E17.m1.5.6.2.3.2.2" xref="A1.E17.m1.5.6.2.3.1.cmml">,</mo><mi id="A1.E17.m1.4.4" xref="A1.E17.m1.4.4.cmml">y</mi><mo id="A1.E17.m1.5.6.2.3.2.3" stretchy="false" xref="A1.E17.m1.5.6.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.5.6.1" xref="A1.E17.m1.5.6.1.cmml">=</mo><mrow id="A1.E17.m1.5.6.3" xref="A1.E17.m1.5.6.3.cmml"><mrow id="A1.E17.m1.5.6.3.2" xref="A1.E17.m1.5.6.3.2.cmml"><mi id="A1.E17.m1.5.6.3.2.2" xref="A1.E17.m1.5.6.3.2.2.cmml">β</mi><mo id="A1.E17.m1.5.6.3.2.1" lspace="0.167em" xref="A1.E17.m1.5.6.3.2.1.cmml">⁢</mo><mrow id="A1.E17.m1.5.6.3.2.3" xref="A1.E17.m1.5.6.3.2.3.cmml"><mi id="A1.E17.m1.5.6.3.2.3.1" xref="A1.E17.m1.5.6.3.2.3.1.cmml">log</mi><mo id="A1.E17.m1.5.6.3.2.3a" lspace="0.167em" xref="A1.E17.m1.5.6.3.2.3.cmml">⁡</mo><mfrac id="A1.E17.m1.2.2" xref="A1.E17.m1.2.2.cmml"><mrow id="A1.E17.m1.1.1.1" xref="A1.E17.m1.1.1.1.cmml"><msup id="A1.E17.m1.1.1.1.3" xref="A1.E17.m1.1.1.1.3.cmml"><mi id="A1.E17.m1.1.1.1.3.2" xref="A1.E17.m1.1.1.1.3.2.cmml">π</mi><mo id="A1.E17.m1.1.1.1.3.3" xref="A1.E17.m1.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.E17.m1.1.1.1.2" xref="A1.E17.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E17.m1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.cmml"><mo id="A1.E17.m1.1.1.1.1.1.2" stretchy="false" xref="A1.E17.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.cmml"><mi id="A1.E17.m1.1.1.1.1.1.1.2" xref="A1.E17.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E17.m1.1.1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E17.m1.1.1.1.1.1.1.3" xref="A1.E17.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E17.m1.1.1.1.1.1.3" stretchy="false" xref="A1.E17.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E17.m1.2.2.2" xref="A1.E17.m1.2.2.2.cmml"><msub id="A1.E17.m1.2.2.2.3" xref="A1.E17.m1.2.2.2.3.cmml"><mi id="A1.E17.m1.2.2.2.3.2" xref="A1.E17.m1.2.2.2.3.2.cmml">π</mi><mtext id="A1.E17.m1.2.2.2.3.3" xref="A1.E17.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.E17.m1.2.2.2.2" xref="A1.E17.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.E17.m1.2.2.2.1.1" xref="A1.E17.m1.2.2.2.1.1.1.cmml"><mo id="A1.E17.m1.2.2.2.1.1.2" stretchy="false" xref="A1.E17.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.2.2.2.1.1.1" xref="A1.E17.m1.2.2.2.1.1.1.cmml"><mi id="A1.E17.m1.2.2.2.1.1.1.2" xref="A1.E17.m1.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.E17.m1.2.2.2.1.1.1.1" xref="A1.E17.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.E17.m1.2.2.2.1.1.1.3" xref="A1.E17.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E17.m1.2.2.2.1.1.3" stretchy="false" xref="A1.E17.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.E17.m1.5.6.3.1" xref="A1.E17.m1.5.6.3.1.cmml">+</mo><mrow id="A1.E17.m1.5.6.3.3" xref="A1.E17.m1.5.6.3.3.cmml"><mi id="A1.E17.m1.5.6.3.3.2" xref="A1.E17.m1.5.6.3.3.2.cmml">β</mi><mo id="A1.E17.m1.5.6.3.3.1" lspace="0.167em" xref="A1.E17.m1.5.6.3.3.1.cmml">⁢</mo><mrow id="A1.E17.m1.5.6.3.3.3" xref="A1.E17.m1.5.6.3.3.3.cmml"><mi id="A1.E17.m1.5.6.3.3.3.1" xref="A1.E17.m1.5.6.3.3.3.1.cmml">log</mi><mo id="A1.E17.m1.5.6.3.3.3a" lspace="0.167em" xref="A1.E17.m1.5.6.3.3.3.cmml">⁡</mo><mi id="A1.E17.m1.5.6.3.3.3.2" xref="A1.E17.m1.5.6.3.3.3.2.cmml">Z</mi></mrow><mo id="A1.E17.m1.5.6.3.3.1a" xref="A1.E17.m1.5.6.3.3.1.cmml">⁢</mo><mrow id="A1.E17.m1.5.6.3.3.4.2" xref="A1.E17.m1.5.6.3.3.cmml"><mo id="A1.E17.m1.5.6.3.3.4.2.1" stretchy="false" xref="A1.E17.m1.5.6.3.3.cmml">(</mo><mi id="A1.E17.m1.5.5" xref="A1.E17.m1.5.5.cmml">x</mi><mo id="A1.E17.m1.5.6.3.3.4.2.2" stretchy="false" xref="A1.E17.m1.5.6.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.5b"><apply id="A1.E17.m1.5.6.cmml" xref="A1.E17.m1.5.6"><eq id="A1.E17.m1.5.6.1.cmml" xref="A1.E17.m1.5.6.1"></eq><apply id="A1.E17.m1.5.6.2.cmml" xref="A1.E17.m1.5.6.2"><times id="A1.E17.m1.5.6.2.1.cmml" xref="A1.E17.m1.5.6.2.1"></times><apply id="A1.E17.m1.5.6.2.2.cmml" xref="A1.E17.m1.5.6.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.5.6.2.2.1.cmml" xref="A1.E17.m1.5.6.2.2">superscript</csymbol><ci id="A1.E17.m1.5.6.2.2.2.cmml" xref="A1.E17.m1.5.6.2.2.2">𝑟</ci><times id="A1.E17.m1.5.6.2.2.3.cmml" xref="A1.E17.m1.5.6.2.2.3"></times></apply><interval closure="open" id="A1.E17.m1.5.6.2.3.1.cmml" xref="A1.E17.m1.5.6.2.3.2"><ci id="A1.E17.m1.3.3.cmml" xref="A1.E17.m1.3.3">𝑥</ci><ci id="A1.E17.m1.4.4.cmml" xref="A1.E17.m1.4.4">𝑦</ci></interval></apply><apply id="A1.E17.m1.5.6.3.cmml" xref="A1.E17.m1.5.6.3"><plus id="A1.E17.m1.5.6.3.1.cmml" xref="A1.E17.m1.5.6.3.1"></plus><apply id="A1.E17.m1.5.6.3.2.cmml" xref="A1.E17.m1.5.6.3.2"><times id="A1.E17.m1.5.6.3.2.1.cmml" xref="A1.E17.m1.5.6.3.2.1"></times><ci id="A1.E17.m1.5.6.3.2.2.cmml" xref="A1.E17.m1.5.6.3.2.2">𝛽</ci><apply id="A1.E17.m1.5.6.3.2.3.cmml" xref="A1.E17.m1.5.6.3.2.3"><log id="A1.E17.m1.5.6.3.2.3.1.cmml" xref="A1.E17.m1.5.6.3.2.3.1"></log><apply id="A1.E17.m1.2.2.cmml" xref="A1.E17.m1.2.2"><divide id="A1.E17.m1.2.2.3.cmml" xref="A1.E17.m1.2.2"></divide><apply id="A1.E17.m1.1.1.1.cmml" xref="A1.E17.m1.1.1.1"><times id="A1.E17.m1.1.1.1.2.cmml" xref="A1.E17.m1.1.1.1.2"></times><apply id="A1.E17.m1.1.1.1.3.cmml" xref="A1.E17.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E17.m1.1.1.1.3.1.cmml" xref="A1.E17.m1.1.1.1.3">superscript</csymbol><ci id="A1.E17.m1.1.1.1.3.2.cmml" xref="A1.E17.m1.1.1.1.3.2">𝜋</ci><times id="A1.E17.m1.1.1.1.3.3.cmml" xref="A1.E17.m1.1.1.1.3.3"></times></apply><apply id="A1.E17.m1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E17.m1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E17.m1.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.E17.m1.1.1.1.1.1.1.3.cmml" xref="A1.E17.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.E17.m1.2.2.2.cmml" xref="A1.E17.m1.2.2.2"><times id="A1.E17.m1.2.2.2.2.cmml" xref="A1.E17.m1.2.2.2.2"></times><apply id="A1.E17.m1.2.2.2.3.cmml" xref="A1.E17.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.2.3.1.cmml" xref="A1.E17.m1.2.2.2.3">subscript</csymbol><ci id="A1.E17.m1.2.2.2.3.2.cmml" xref="A1.E17.m1.2.2.2.3.2">𝜋</ci><ci id="A1.E17.m1.2.2.2.3.3a.cmml" xref="A1.E17.m1.2.2.2.3.3"><mtext id="A1.E17.m1.2.2.2.3.3.cmml" mathsize="70%" xref="A1.E17.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.E17.m1.2.2.2.1.1.1.cmml" xref="A1.E17.m1.2.2.2.1.1"><csymbol cd="latexml" id="A1.E17.m1.2.2.2.1.1.1.1.cmml" xref="A1.E17.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.E17.m1.2.2.2.1.1.1.2.cmml" xref="A1.E17.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.E17.m1.2.2.2.1.1.1.3.cmml" xref="A1.E17.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.E17.m1.5.6.3.3.cmml" xref="A1.E17.m1.5.6.3.3"><times id="A1.E17.m1.5.6.3.3.1.cmml" xref="A1.E17.m1.5.6.3.3.1"></times><ci id="A1.E17.m1.5.6.3.3.2.cmml" xref="A1.E17.m1.5.6.3.3.2">𝛽</ci><apply id="A1.E17.m1.5.6.3.3.3.cmml" xref="A1.E17.m1.5.6.3.3.3"><log id="A1.E17.m1.5.6.3.3.3.1.cmml" xref="A1.E17.m1.5.6.3.3.3.1"></log><ci id="A1.E17.m1.5.6.3.3.3.2.cmml" xref="A1.E17.m1.5.6.3.3.3.2">𝑍</ci></apply><ci id="A1.E17.m1.5.5.cmml" xref="A1.E17.m1.5.5">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.5c">r^{*}(x,y)=\beta\log\frac{\pi^{*}(y|x)}{\pi_{\text{ref}}(y|x)}+\beta\log Z(x)</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.5d">italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG + italic_β roman_log italic_Z ( italic_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.1">식을 대입한다. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.E17" title="17 ‣ A.2 Deriving the DPO Objective Under the Bradley-Terry Model ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">17</span></a> into Eq. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.E16" title="16 ‣ A.2 Deriving the DPO Objective Under the Bradley-Terry Model ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">16</span></a> we obtain:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx3">
<tbody id="A1.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p^{*}(y_{1}\succ y_{2}|x)" class="ltx_Math" display="inline" id="A1.Ex6.m1.1"><semantics id="A1.Ex6.m1.1a"><mrow id="A1.Ex6.m1.1.1" xref="A1.Ex6.m1.1.1.cmml"><msup id="A1.Ex6.m1.1.1.3" xref="A1.Ex6.m1.1.1.3.cmml"><mi id="A1.Ex6.m1.1.1.3.2" xref="A1.Ex6.m1.1.1.3.2.cmml">p</mi><mo id="A1.Ex6.m1.1.1.3.3" xref="A1.Ex6.m1.1.1.3.3.cmml">*</mo></msup><mo id="A1.Ex6.m1.1.1.2" xref="A1.Ex6.m1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex6.m1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.cmml"><mo id="A1.Ex6.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex6.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.cmml"><msub id="A1.Ex6.m1.1.1.1.1.1.2" xref="A1.Ex6.m1.1.1.1.1.1.2.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.2.2" xref="A1.Ex6.m1.1.1.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex6.m1.1.1.1.1.1.2.3" xref="A1.Ex6.m1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A1.Ex6.m1.1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.1.cmml">≻</mo><mrow id="A1.Ex6.m1.1.1.1.1.1.3" xref="A1.Ex6.m1.1.1.1.1.1.3.cmml"><msub id="A1.Ex6.m1.1.1.1.1.1.3.2" xref="A1.Ex6.m1.1.1.1.1.1.3.2.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.3.2.2" xref="A1.Ex6.m1.1.1.1.1.1.3.2.2.cmml">y</mi><mn id="A1.Ex6.m1.1.1.1.1.1.3.2.3" xref="A1.Ex6.m1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo fence="false" id="A1.Ex6.m1.1.1.1.1.1.3.1" xref="A1.Ex6.m1.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.Ex6.m1.1.1.1.1.1.3.3" xref="A1.Ex6.m1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="A1.Ex6.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m1.1b"><apply id="A1.Ex6.m1.1.1.cmml" xref="A1.Ex6.m1.1.1"><times id="A1.Ex6.m1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.2"></times><apply id="A1.Ex6.m1.1.1.3.cmml" xref="A1.Ex6.m1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.3.1.cmml" xref="A1.Ex6.m1.1.1.3">superscript</csymbol><ci id="A1.Ex6.m1.1.1.3.2.cmml" xref="A1.Ex6.m1.1.1.3.2">𝑝</ci><times id="A1.Ex6.m1.1.1.3.3.cmml" xref="A1.Ex6.m1.1.1.3.3"></times></apply><apply id="A1.Ex6.m1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex6.m1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1">succeeds</csymbol><apply id="A1.Ex6.m1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex6.m1.1.1.1.1.1.2.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.2.2">𝑦</ci><cn id="A1.Ex6.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.1.1.1.2.3">1</cn></apply><apply id="A1.Ex6.m1.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.Ex6.m1.1.1.1.1.1.3.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.3.1">conditional</csymbol><apply id="A1.Ex6.m1.1.1.1.1.1.3.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.Ex6.m1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.3.2.2">𝑦</ci><cn id="A1.Ex6.m1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.1.1.1.3.2.3">2</cn></apply><ci id="A1.Ex6.m1.1.1.1.1.1.3.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m1.1c">\displaystyle p^{*}(y_{1}\succ y_{2}|x)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex6.m1.1d">italic_p start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\exp\left(\beta\log\frac{\pi^{*}(y_{1}|x)}{\pi_{\text{ref}%
}(y_{1}|x)}+\beta\log Z(x)\right)}{\exp\left(\beta\log\frac{\pi^{*}(y_{1}|x)}{%
\pi_{\text{ref}}(y_{1}|x)}+\beta\log Z(x)\right)+\exp\left(\beta\log\frac{\pi^%
{*}(y_{2}|x)}{\pi_{\text{ref}}(y_{2}|x)}+\beta\log Z(x)\right)}" class="ltx_Math" display="inline" id="A1.Ex6.m2.15"><semantics id="A1.Ex6.m2.15a"><mrow id="A1.Ex6.m2.15.16" xref="A1.Ex6.m2.15.16.cmml"><mi id="A1.Ex6.m2.15.16.2" xref="A1.Ex6.m2.15.16.2.cmml"></mi><mo id="A1.Ex6.m2.15.16.1" xref="A1.Ex6.m2.15.16.1.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex6.m2.15.15" xref="A1.Ex6.m2.15.15.cmml"><mfrac id="A1.Ex6.m2.15.15a" xref="A1.Ex6.m2.15.15.cmml"><mrow id="A1.Ex6.m2.5.5.5.5" xref="A1.Ex6.m2.5.5.5.6.cmml"><mi id="A1.Ex6.m2.4.4.4.4" xref="A1.Ex6.m2.4.4.4.4.cmml">exp</mi><mo id="A1.Ex6.m2.5.5.5.5a" xref="A1.Ex6.m2.5.5.5.6.cmml">⁡</mo><mrow id="A1.Ex6.m2.5.5.5.5.1" xref="A1.Ex6.m2.5.5.5.6.cmml"><mo id="A1.Ex6.m2.5.5.5.5.1.2" xref="A1.Ex6.m2.5.5.5.6.cmml">(</mo><mrow id="A1.Ex6.m2.5.5.5.5.1.1" xref="A1.Ex6.m2.5.5.5.5.1.1.cmml"><mrow id="A1.Ex6.m2.5.5.5.5.1.1.2" xref="A1.Ex6.m2.5.5.5.5.1.1.2.cmml"><mi id="A1.Ex6.m2.5.5.5.5.1.1.2.2" xref="A1.Ex6.m2.5.5.5.5.1.1.2.2.cmml">β</mi><mo id="A1.Ex6.m2.5.5.5.5.1.1.2.1" lspace="0.167em" xref="A1.Ex6.m2.5.5.5.5.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex6.m2.5.5.5.5.1.1.2.3" xref="A1.Ex6.m2.5.5.5.5.1.1.2.3.cmml"><mi id="A1.Ex6.m2.5.5.5.5.1.1.2.3.1" xref="A1.Ex6.m2.5.5.5.5.1.1.2.3.1.cmml">log</mi><mo id="A1.Ex6.m2.5.5.5.5.1.1.2.3a" lspace="0.167em" xref="A1.Ex6.m2.5.5.5.5.1.1.2.3.cmml">⁡</mo><mfrac id="A1.Ex6.m2.2.2.2.2" xref="A1.Ex6.m2.2.2.2.2.cmml"><mrow id="A1.Ex6.m2.1.1.1.1.1" xref="A1.Ex6.m2.1.1.1.1.1.cmml"><msup id="A1.Ex6.m2.1.1.1.1.1.3" xref="A1.Ex6.m2.1.1.1.1.1.3.cmml"><mi id="A1.Ex6.m2.1.1.1.1.1.3.2" xref="A1.Ex6.m2.1.1.1.1.1.3.2.cmml">π</mi><mo id="A1.Ex6.m2.1.1.1.1.1.3.3" xref="A1.Ex6.m2.1.1.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.Ex6.m2.1.1.1.1.1.2" xref="A1.Ex6.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex6.m2.1.1.1.1.1.1.1" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex6.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m2.1.1.1.1.1.1.1.1" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex6.m2.1.1.1.1.1.1.1.1.2" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.Ex6.m2.1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex6.m2.1.1.1.1.1.1.1.1.3" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex6.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex6.m2.2.2.2.2.2" xref="A1.Ex6.m2.2.2.2.2.2.cmml"><msub id="A1.Ex6.m2.2.2.2.2.2.3" xref="A1.Ex6.m2.2.2.2.2.2.3.cmml"><mi id="A1.Ex6.m2.2.2.2.2.2.3.2" xref="A1.Ex6.m2.2.2.2.2.2.3.2.cmml">π</mi><mtext id="A1.Ex6.m2.2.2.2.2.2.3.3" xref="A1.Ex6.m2.2.2.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex6.m2.2.2.2.2.2.2" xref="A1.Ex6.m2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.Ex6.m2.2.2.2.2.2.1.1" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.cmml"><mo id="A1.Ex6.m2.2.2.2.2.2.1.1.2" stretchy="false" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m2.2.2.2.2.2.1.1.1" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.cmml"><msub id="A1.Ex6.m2.2.2.2.2.2.1.1.1.2" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.cmml"><mi id="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.2" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.3" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.Ex6.m2.2.2.2.2.2.1.1.1.1" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex6.m2.2.2.2.2.2.1.1.1.3" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex6.m2.2.2.2.2.2.1.1.3" stretchy="false" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex6.m2.5.5.5.5.1.1.1" xref="A1.Ex6.m2.5.5.5.5.1.1.1.cmml">+</mo><mrow id="A1.Ex6.m2.5.5.5.5.1.1.3" xref="A1.Ex6.m2.5.5.5.5.1.1.3.cmml"><mi id="A1.Ex6.m2.5.5.5.5.1.1.3.2" xref="A1.Ex6.m2.5.5.5.5.1.1.3.2.cmml">β</mi><mo id="A1.Ex6.m2.5.5.5.5.1.1.3.1" lspace="0.167em" xref="A1.Ex6.m2.5.5.5.5.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex6.m2.5.5.5.5.1.1.3.3" xref="A1.Ex6.m2.5.5.5.5.1.1.3.3.cmml"><mi id="A1.Ex6.m2.5.5.5.5.1.1.3.3.1" xref="A1.Ex6.m2.5.5.5.5.1.1.3.3.1.cmml">log</mi><mo id="A1.Ex6.m2.5.5.5.5.1.1.3.3a" lspace="0.167em" xref="A1.Ex6.m2.5.5.5.5.1.1.3.3.cmml">⁡</mo><mi id="A1.Ex6.m2.5.5.5.5.1.1.3.3.2" xref="A1.Ex6.m2.5.5.5.5.1.1.3.3.2.cmml">Z</mi></mrow><mo id="A1.Ex6.m2.5.5.5.5.1.1.3.1a" xref="A1.Ex6.m2.5.5.5.5.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex6.m2.5.5.5.5.1.1.3.4.2" xref="A1.Ex6.m2.5.5.5.5.1.1.3.cmml"><mo id="A1.Ex6.m2.5.5.5.5.1.1.3.4.2.1" stretchy="false" xref="A1.Ex6.m2.5.5.5.5.1.1.3.cmml">(</mo><mi id="A1.Ex6.m2.3.3.3.3" xref="A1.Ex6.m2.3.3.3.3.cmml">x</mi><mo id="A1.Ex6.m2.5.5.5.5.1.1.3.4.2.2" stretchy="false" xref="A1.Ex6.m2.5.5.5.5.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex6.m2.5.5.5.5.1.3" xref="A1.Ex6.m2.5.5.5.6.cmml">)</mo></mrow></mrow><mrow id="A1.Ex6.m2.15.15.15" xref="A1.Ex6.m2.15.15.15.cmml"><mrow id="A1.Ex6.m2.14.14.14.9.1" xref="A1.Ex6.m2.14.14.14.9.2.cmml"><mi id="A1.Ex6.m2.11.11.11.6" xref="A1.Ex6.m2.11.11.11.6.cmml">exp</mi><mo id="A1.Ex6.m2.14.14.14.9.1a" xref="A1.Ex6.m2.14.14.14.9.2.cmml">⁡</mo><mrow id="A1.Ex6.m2.14.14.14.9.1.1" xref="A1.Ex6.m2.14.14.14.9.2.cmml"><mo id="A1.Ex6.m2.14.14.14.9.1.1.2" xref="A1.Ex6.m2.14.14.14.9.2.cmml">(</mo><mrow id="A1.Ex6.m2.14.14.14.9.1.1.1" xref="A1.Ex6.m2.14.14.14.9.1.1.1.cmml"><mrow id="A1.Ex6.m2.14.14.14.9.1.1.1.2" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.cmml"><mi id="A1.Ex6.m2.14.14.14.9.1.1.1.2.2" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.2.cmml">β</mi><mo id="A1.Ex6.m2.14.14.14.9.1.1.1.2.1" lspace="0.167em" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex6.m2.14.14.14.9.1.1.1.2.3" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.3.cmml"><mi id="A1.Ex6.m2.14.14.14.9.1.1.1.2.3.1" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.3.1.cmml">log</mi><mo id="A1.Ex6.m2.14.14.14.9.1.1.1.2.3a" lspace="0.167em" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.3.cmml">⁡</mo><mfrac id="A1.Ex6.m2.7.7.7.2" xref="A1.Ex6.m2.7.7.7.2.cmml"><mrow id="A1.Ex6.m2.6.6.6.1.1" xref="A1.Ex6.m2.6.6.6.1.1.cmml"><msup id="A1.Ex6.m2.6.6.6.1.1.3" xref="A1.Ex6.m2.6.6.6.1.1.3.cmml"><mi id="A1.Ex6.m2.6.6.6.1.1.3.2" xref="A1.Ex6.m2.6.6.6.1.1.3.2.cmml">π</mi><mo id="A1.Ex6.m2.6.6.6.1.1.3.3" xref="A1.Ex6.m2.6.6.6.1.1.3.3.cmml">*</mo></msup><mo id="A1.Ex6.m2.6.6.6.1.1.2" xref="A1.Ex6.m2.6.6.6.1.1.2.cmml">⁢</mo><mrow id="A1.Ex6.m2.6.6.6.1.1.1.1" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.cmml"><mo id="A1.Ex6.m2.6.6.6.1.1.1.1.2" stretchy="false" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m2.6.6.6.1.1.1.1.1" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.cmml"><msub id="A1.Ex6.m2.6.6.6.1.1.1.1.1.2" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.cmml"><mi id="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.2" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.3" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.Ex6.m2.6.6.6.1.1.1.1.1.1" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex6.m2.6.6.6.1.1.1.1.1.3" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex6.m2.6.6.6.1.1.1.1.3" stretchy="false" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex6.m2.7.7.7.2.2" xref="A1.Ex6.m2.7.7.7.2.2.cmml"><msub id="A1.Ex6.m2.7.7.7.2.2.3" xref="A1.Ex6.m2.7.7.7.2.2.3.cmml"><mi id="A1.Ex6.m2.7.7.7.2.2.3.2" xref="A1.Ex6.m2.7.7.7.2.2.3.2.cmml">π</mi><mtext id="A1.Ex6.m2.7.7.7.2.2.3.3" xref="A1.Ex6.m2.7.7.7.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex6.m2.7.7.7.2.2.2" xref="A1.Ex6.m2.7.7.7.2.2.2.cmml">⁢</mo><mrow id="A1.Ex6.m2.7.7.7.2.2.1.1" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.cmml"><mo id="A1.Ex6.m2.7.7.7.2.2.1.1.2" stretchy="false" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m2.7.7.7.2.2.1.1.1" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.cmml"><msub id="A1.Ex6.m2.7.7.7.2.2.1.1.1.2" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.cmml"><mi id="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.2" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.3" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.Ex6.m2.7.7.7.2.2.1.1.1.1" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex6.m2.7.7.7.2.2.1.1.1.3" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex6.m2.7.7.7.2.2.1.1.3" stretchy="false" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex6.m2.14.14.14.9.1.1.1.1" xref="A1.Ex6.m2.14.14.14.9.1.1.1.1.cmml">+</mo><mrow id="A1.Ex6.m2.14.14.14.9.1.1.1.3" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.cmml"><mi id="A1.Ex6.m2.14.14.14.9.1.1.1.3.2" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.2.cmml">β</mi><mo id="A1.Ex6.m2.14.14.14.9.1.1.1.3.1" lspace="0.167em" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex6.m2.14.14.14.9.1.1.1.3.3" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.cmml"><mi id="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.1" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.1.cmml">log</mi><mo id="A1.Ex6.m2.14.14.14.9.1.1.1.3.3a" lspace="0.167em" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.cmml">⁡</mo><mi id="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.2" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.2.cmml">Z</mi></mrow><mo id="A1.Ex6.m2.14.14.14.9.1.1.1.3.1a" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex6.m2.14.14.14.9.1.1.1.3.4.2" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.cmml"><mo id="A1.Ex6.m2.14.14.14.9.1.1.1.3.4.2.1" stretchy="false" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.cmml">(</mo><mi id="A1.Ex6.m2.10.10.10.5" xref="A1.Ex6.m2.10.10.10.5.cmml">x</mi><mo id="A1.Ex6.m2.14.14.14.9.1.1.1.3.4.2.2" stretchy="false" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex6.m2.14.14.14.9.1.1.3" xref="A1.Ex6.m2.14.14.14.9.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex6.m2.15.15.15.11" xref="A1.Ex6.m2.15.15.15.11.cmml">+</mo><mrow id="A1.Ex6.m2.15.15.15.10.1" xref="A1.Ex6.m2.15.15.15.10.2.cmml"><mi id="A1.Ex6.m2.13.13.13.8" xref="A1.Ex6.m2.13.13.13.8.cmml">exp</mi><mo id="A1.Ex6.m2.15.15.15.10.1a" xref="A1.Ex6.m2.15.15.15.10.2.cmml">⁡</mo><mrow id="A1.Ex6.m2.15.15.15.10.1.1" xref="A1.Ex6.m2.15.15.15.10.2.cmml"><mo id="A1.Ex6.m2.15.15.15.10.1.1.2" xref="A1.Ex6.m2.15.15.15.10.2.cmml">(</mo><mrow id="A1.Ex6.m2.15.15.15.10.1.1.1" xref="A1.Ex6.m2.15.15.15.10.1.1.1.cmml"><mrow id="A1.Ex6.m2.15.15.15.10.1.1.1.2" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.cmml"><mi id="A1.Ex6.m2.15.15.15.10.1.1.1.2.2" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.2.cmml">β</mi><mo id="A1.Ex6.m2.15.15.15.10.1.1.1.2.1" lspace="0.167em" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex6.m2.15.15.15.10.1.1.1.2.3" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.3.cmml"><mi id="A1.Ex6.m2.15.15.15.10.1.1.1.2.3.1" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.3.1.cmml">log</mi><mo id="A1.Ex6.m2.15.15.15.10.1.1.1.2.3a" lspace="0.167em" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.3.cmml">⁡</mo><mfrac id="A1.Ex6.m2.9.9.9.4" xref="A1.Ex6.m2.9.9.9.4.cmml"><mrow id="A1.Ex6.m2.8.8.8.3.1" xref="A1.Ex6.m2.8.8.8.3.1.cmml"><msup id="A1.Ex6.m2.8.8.8.3.1.3" xref="A1.Ex6.m2.8.8.8.3.1.3.cmml"><mi id="A1.Ex6.m2.8.8.8.3.1.3.2" xref="A1.Ex6.m2.8.8.8.3.1.3.2.cmml">π</mi><mo id="A1.Ex6.m2.8.8.8.3.1.3.3" xref="A1.Ex6.m2.8.8.8.3.1.3.3.cmml">*</mo></msup><mo id="A1.Ex6.m2.8.8.8.3.1.2" xref="A1.Ex6.m2.8.8.8.3.1.2.cmml">⁢</mo><mrow id="A1.Ex6.m2.8.8.8.3.1.1.1" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.cmml"><mo id="A1.Ex6.m2.8.8.8.3.1.1.1.2" stretchy="false" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m2.8.8.8.3.1.1.1.1" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.cmml"><msub id="A1.Ex6.m2.8.8.8.3.1.1.1.1.2" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.cmml"><mi id="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.2" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.3" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.3.cmml">2</mn></msub><mo fence="false" id="A1.Ex6.m2.8.8.8.3.1.1.1.1.1" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex6.m2.8.8.8.3.1.1.1.1.3" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex6.m2.8.8.8.3.1.1.1.3" stretchy="false" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex6.m2.9.9.9.4.2" xref="A1.Ex6.m2.9.9.9.4.2.cmml"><msub id="A1.Ex6.m2.9.9.9.4.2.3" xref="A1.Ex6.m2.9.9.9.4.2.3.cmml"><mi id="A1.Ex6.m2.9.9.9.4.2.3.2" xref="A1.Ex6.m2.9.9.9.4.2.3.2.cmml">π</mi><mtext id="A1.Ex6.m2.9.9.9.4.2.3.3" xref="A1.Ex6.m2.9.9.9.4.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex6.m2.9.9.9.4.2.2" xref="A1.Ex6.m2.9.9.9.4.2.2.cmml">⁢</mo><mrow id="A1.Ex6.m2.9.9.9.4.2.1.1" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.cmml"><mo id="A1.Ex6.m2.9.9.9.4.2.1.1.2" stretchy="false" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m2.9.9.9.4.2.1.1.1" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.cmml"><msub id="A1.Ex6.m2.9.9.9.4.2.1.1.1.2" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.cmml"><mi id="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.2" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.3" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.3.cmml">2</mn></msub><mo fence="false" id="A1.Ex6.m2.9.9.9.4.2.1.1.1.1" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex6.m2.9.9.9.4.2.1.1.1.3" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex6.m2.9.9.9.4.2.1.1.3" stretchy="false" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex6.m2.15.15.15.10.1.1.1.1" xref="A1.Ex6.m2.15.15.15.10.1.1.1.1.cmml">+</mo><mrow id="A1.Ex6.m2.15.15.15.10.1.1.1.3" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.cmml"><mi id="A1.Ex6.m2.15.15.15.10.1.1.1.3.2" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.2.cmml">β</mi><mo id="A1.Ex6.m2.15.15.15.10.1.1.1.3.1" lspace="0.167em" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex6.m2.15.15.15.10.1.1.1.3.3" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.cmml"><mi id="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.1" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.1.cmml">log</mi><mo id="A1.Ex6.m2.15.15.15.10.1.1.1.3.3a" lspace="0.167em" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.cmml">⁡</mo><mi id="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.2" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.2.cmml">Z</mi></mrow><mo id="A1.Ex6.m2.15.15.15.10.1.1.1.3.1a" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex6.m2.15.15.15.10.1.1.1.3.4.2" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.cmml"><mo id="A1.Ex6.m2.15.15.15.10.1.1.1.3.4.2.1" stretchy="false" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.cmml">(</mo><mi id="A1.Ex6.m2.12.12.12.7" xref="A1.Ex6.m2.12.12.12.7.cmml">x</mi><mo id="A1.Ex6.m2.15.15.15.10.1.1.1.3.4.2.2" stretchy="false" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex6.m2.15.15.15.10.1.1.3" xref="A1.Ex6.m2.15.15.15.10.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m2.15b"><apply id="A1.Ex6.m2.15.16.cmml" xref="A1.Ex6.m2.15.16"><eq id="A1.Ex6.m2.15.16.1.cmml" xref="A1.Ex6.m2.15.16.1"></eq><csymbol cd="latexml" id="A1.Ex6.m2.15.16.2.cmml" xref="A1.Ex6.m2.15.16.2">absent</csymbol><apply id="A1.Ex6.m2.15.15.cmml" xref="A1.Ex6.m2.15.15"><divide id="A1.Ex6.m2.15.15.16.cmml" xref="A1.Ex6.m2.15.15"></divide><apply id="A1.Ex6.m2.5.5.5.6.cmml" xref="A1.Ex6.m2.5.5.5.5"><exp id="A1.Ex6.m2.4.4.4.4.cmml" xref="A1.Ex6.m2.4.4.4.4"></exp><apply id="A1.Ex6.m2.5.5.5.5.1.1.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1"><plus id="A1.Ex6.m2.5.5.5.5.1.1.1.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.1"></plus><apply id="A1.Ex6.m2.5.5.5.5.1.1.2.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.2"><times id="A1.Ex6.m2.5.5.5.5.1.1.2.1.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.2.1"></times><ci id="A1.Ex6.m2.5.5.5.5.1.1.2.2.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.2.2">𝛽</ci><apply id="A1.Ex6.m2.5.5.5.5.1.1.2.3.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.2.3"><log id="A1.Ex6.m2.5.5.5.5.1.1.2.3.1.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.2.3.1"></log><apply id="A1.Ex6.m2.2.2.2.2.cmml" xref="A1.Ex6.m2.2.2.2.2"><divide id="A1.Ex6.m2.2.2.2.2.3.cmml" xref="A1.Ex6.m2.2.2.2.2"></divide><apply id="A1.Ex6.m2.1.1.1.1.1.cmml" xref="A1.Ex6.m2.1.1.1.1.1"><times id="A1.Ex6.m2.1.1.1.1.1.2.cmml" xref="A1.Ex6.m2.1.1.1.1.1.2"></times><apply id="A1.Ex6.m2.1.1.1.1.1.3.cmml" xref="A1.Ex6.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex6.m2.1.1.1.1.1.3.1.cmml" xref="A1.Ex6.m2.1.1.1.1.1.3">superscript</csymbol><ci id="A1.Ex6.m2.1.1.1.1.1.3.2.cmml" xref="A1.Ex6.m2.1.1.1.1.1.3.2">𝜋</ci><times id="A1.Ex6.m2.1.1.1.1.1.3.3.cmml" xref="A1.Ex6.m2.1.1.1.1.1.3.3"></times></apply><apply id="A1.Ex6.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex6.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.2">𝑦</ci><cn id="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.2.3">1</cn></apply><ci id="A1.Ex6.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex6.m2.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex6.m2.2.2.2.2.2.cmml" xref="A1.Ex6.m2.2.2.2.2.2"><times id="A1.Ex6.m2.2.2.2.2.2.2.cmml" xref="A1.Ex6.m2.2.2.2.2.2.2"></times><apply id="A1.Ex6.m2.2.2.2.2.2.3.cmml" xref="A1.Ex6.m2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m2.2.2.2.2.2.3.1.cmml" xref="A1.Ex6.m2.2.2.2.2.2.3">subscript</csymbol><ci id="A1.Ex6.m2.2.2.2.2.2.3.2.cmml" xref="A1.Ex6.m2.2.2.2.2.2.3.2">𝜋</ci><ci id="A1.Ex6.m2.2.2.2.2.2.3.3a.cmml" xref="A1.Ex6.m2.2.2.2.2.2.3.3"><mtext id="A1.Ex6.m2.2.2.2.2.2.3.3.cmml" mathsize="50%" xref="A1.Ex6.m2.2.2.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex6.m2.2.2.2.2.2.1.1.1.cmml" xref="A1.Ex6.m2.2.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.Ex6.m2.2.2.2.2.2.1.1.1.1.cmml" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.1">conditional</csymbol><apply id="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.cmml" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.1.cmml" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.2.cmml" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.2">𝑦</ci><cn id="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.3.cmml" type="integer" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.2.3">1</cn></apply><ci id="A1.Ex6.m2.2.2.2.2.2.1.1.1.3.cmml" xref="A1.Ex6.m2.2.2.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.Ex6.m2.5.5.5.5.1.1.3.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.3"><times id="A1.Ex6.m2.5.5.5.5.1.1.3.1.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.3.1"></times><ci id="A1.Ex6.m2.5.5.5.5.1.1.3.2.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.3.2">𝛽</ci><apply id="A1.Ex6.m2.5.5.5.5.1.1.3.3.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.3.3"><log id="A1.Ex6.m2.5.5.5.5.1.1.3.3.1.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.3.3.1"></log><ci id="A1.Ex6.m2.5.5.5.5.1.1.3.3.2.cmml" xref="A1.Ex6.m2.5.5.5.5.1.1.3.3.2">𝑍</ci></apply><ci id="A1.Ex6.m2.3.3.3.3.cmml" xref="A1.Ex6.m2.3.3.3.3">𝑥</ci></apply></apply></apply><apply id="A1.Ex6.m2.15.15.15.cmml" xref="A1.Ex6.m2.15.15.15"><plus id="A1.Ex6.m2.15.15.15.11.cmml" xref="A1.Ex6.m2.15.15.15.11"></plus><apply id="A1.Ex6.m2.14.14.14.9.2.cmml" xref="A1.Ex6.m2.14.14.14.9.1"><exp id="A1.Ex6.m2.11.11.11.6.cmml" xref="A1.Ex6.m2.11.11.11.6"></exp><apply id="A1.Ex6.m2.14.14.14.9.1.1.1.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1"><plus id="A1.Ex6.m2.14.14.14.9.1.1.1.1.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.1"></plus><apply id="A1.Ex6.m2.14.14.14.9.1.1.1.2.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2"><times id="A1.Ex6.m2.14.14.14.9.1.1.1.2.1.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.1"></times><ci id="A1.Ex6.m2.14.14.14.9.1.1.1.2.2.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.2">𝛽</ci><apply id="A1.Ex6.m2.14.14.14.9.1.1.1.2.3.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.3"><log id="A1.Ex6.m2.14.14.14.9.1.1.1.2.3.1.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.2.3.1"></log><apply id="A1.Ex6.m2.7.7.7.2.cmml" xref="A1.Ex6.m2.7.7.7.2"><divide id="A1.Ex6.m2.7.7.7.2.3.cmml" xref="A1.Ex6.m2.7.7.7.2"></divide><apply id="A1.Ex6.m2.6.6.6.1.1.cmml" xref="A1.Ex6.m2.6.6.6.1.1"><times id="A1.Ex6.m2.6.6.6.1.1.2.cmml" xref="A1.Ex6.m2.6.6.6.1.1.2"></times><apply id="A1.Ex6.m2.6.6.6.1.1.3.cmml" xref="A1.Ex6.m2.6.6.6.1.1.3"><csymbol cd="ambiguous" id="A1.Ex6.m2.6.6.6.1.1.3.1.cmml" xref="A1.Ex6.m2.6.6.6.1.1.3">superscript</csymbol><ci id="A1.Ex6.m2.6.6.6.1.1.3.2.cmml" xref="A1.Ex6.m2.6.6.6.1.1.3.2">𝜋</ci><times id="A1.Ex6.m2.6.6.6.1.1.3.3.cmml" xref="A1.Ex6.m2.6.6.6.1.1.3.3"></times></apply><apply id="A1.Ex6.m2.6.6.6.1.1.1.1.1.cmml" xref="A1.Ex6.m2.6.6.6.1.1.1.1"><csymbol cd="latexml" id="A1.Ex6.m2.6.6.6.1.1.1.1.1.1.cmml" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.1">conditional</csymbol><apply id="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.cmml" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.2.cmml" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.2">𝑦</ci><cn id="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.2.3">1</cn></apply><ci id="A1.Ex6.m2.6.6.6.1.1.1.1.1.3.cmml" xref="A1.Ex6.m2.6.6.6.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex6.m2.7.7.7.2.2.cmml" xref="A1.Ex6.m2.7.7.7.2.2"><times id="A1.Ex6.m2.7.7.7.2.2.2.cmml" xref="A1.Ex6.m2.7.7.7.2.2.2"></times><apply id="A1.Ex6.m2.7.7.7.2.2.3.cmml" xref="A1.Ex6.m2.7.7.7.2.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m2.7.7.7.2.2.3.1.cmml" xref="A1.Ex6.m2.7.7.7.2.2.3">subscript</csymbol><ci id="A1.Ex6.m2.7.7.7.2.2.3.2.cmml" xref="A1.Ex6.m2.7.7.7.2.2.3.2">𝜋</ci><ci id="A1.Ex6.m2.7.7.7.2.2.3.3a.cmml" xref="A1.Ex6.m2.7.7.7.2.2.3.3"><mtext id="A1.Ex6.m2.7.7.7.2.2.3.3.cmml" mathsize="50%" xref="A1.Ex6.m2.7.7.7.2.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex6.m2.7.7.7.2.2.1.1.1.cmml" xref="A1.Ex6.m2.7.7.7.2.2.1.1"><csymbol cd="latexml" id="A1.Ex6.m2.7.7.7.2.2.1.1.1.1.cmml" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.1">conditional</csymbol><apply id="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.cmml" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.1.cmml" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.2.cmml" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.2">𝑦</ci><cn id="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.3.cmml" type="integer" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.2.3">1</cn></apply><ci id="A1.Ex6.m2.7.7.7.2.2.1.1.1.3.cmml" xref="A1.Ex6.m2.7.7.7.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.Ex6.m2.14.14.14.9.1.1.1.3.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3"><times id="A1.Ex6.m2.14.14.14.9.1.1.1.3.1.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.1"></times><ci id="A1.Ex6.m2.14.14.14.9.1.1.1.3.2.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.2">𝛽</ci><apply id="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.3"><log id="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.1.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.1"></log><ci id="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.2.cmml" xref="A1.Ex6.m2.14.14.14.9.1.1.1.3.3.2">𝑍</ci></apply><ci id="A1.Ex6.m2.10.10.10.5.cmml" xref="A1.Ex6.m2.10.10.10.5">𝑥</ci></apply></apply></apply><apply id="A1.Ex6.m2.15.15.15.10.2.cmml" xref="A1.Ex6.m2.15.15.15.10.1"><exp id="A1.Ex6.m2.13.13.13.8.cmml" xref="A1.Ex6.m2.13.13.13.8"></exp><apply id="A1.Ex6.m2.15.15.15.10.1.1.1.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1"><plus id="A1.Ex6.m2.15.15.15.10.1.1.1.1.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.1"></plus><apply id="A1.Ex6.m2.15.15.15.10.1.1.1.2.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2"><times id="A1.Ex6.m2.15.15.15.10.1.1.1.2.1.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.1"></times><ci id="A1.Ex6.m2.15.15.15.10.1.1.1.2.2.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.2">𝛽</ci><apply id="A1.Ex6.m2.15.15.15.10.1.1.1.2.3.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.3"><log id="A1.Ex6.m2.15.15.15.10.1.1.1.2.3.1.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.2.3.1"></log><apply id="A1.Ex6.m2.9.9.9.4.cmml" xref="A1.Ex6.m2.9.9.9.4"><divide id="A1.Ex6.m2.9.9.9.4.3.cmml" xref="A1.Ex6.m2.9.9.9.4"></divide><apply id="A1.Ex6.m2.8.8.8.3.1.cmml" xref="A1.Ex6.m2.8.8.8.3.1"><times id="A1.Ex6.m2.8.8.8.3.1.2.cmml" xref="A1.Ex6.m2.8.8.8.3.1.2"></times><apply id="A1.Ex6.m2.8.8.8.3.1.3.cmml" xref="A1.Ex6.m2.8.8.8.3.1.3"><csymbol cd="ambiguous" id="A1.Ex6.m2.8.8.8.3.1.3.1.cmml" xref="A1.Ex6.m2.8.8.8.3.1.3">superscript</csymbol><ci id="A1.Ex6.m2.8.8.8.3.1.3.2.cmml" xref="A1.Ex6.m2.8.8.8.3.1.3.2">𝜋</ci><times id="A1.Ex6.m2.8.8.8.3.1.3.3.cmml" xref="A1.Ex6.m2.8.8.8.3.1.3.3"></times></apply><apply id="A1.Ex6.m2.8.8.8.3.1.1.1.1.cmml" xref="A1.Ex6.m2.8.8.8.3.1.1.1"><csymbol cd="latexml" id="A1.Ex6.m2.8.8.8.3.1.1.1.1.1.cmml" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.1">conditional</csymbol><apply id="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.cmml" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.1.cmml" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.2.cmml" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.2">𝑦</ci><cn id="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.2.3">2</cn></apply><ci id="A1.Ex6.m2.8.8.8.3.1.1.1.1.3.cmml" xref="A1.Ex6.m2.8.8.8.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex6.m2.9.9.9.4.2.cmml" xref="A1.Ex6.m2.9.9.9.4.2"><times id="A1.Ex6.m2.9.9.9.4.2.2.cmml" xref="A1.Ex6.m2.9.9.9.4.2.2"></times><apply id="A1.Ex6.m2.9.9.9.4.2.3.cmml" xref="A1.Ex6.m2.9.9.9.4.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m2.9.9.9.4.2.3.1.cmml" xref="A1.Ex6.m2.9.9.9.4.2.3">subscript</csymbol><ci id="A1.Ex6.m2.9.9.9.4.2.3.2.cmml" xref="A1.Ex6.m2.9.9.9.4.2.3.2">𝜋</ci><ci id="A1.Ex6.m2.9.9.9.4.2.3.3a.cmml" xref="A1.Ex6.m2.9.9.9.4.2.3.3"><mtext id="A1.Ex6.m2.9.9.9.4.2.3.3.cmml" mathsize="50%" xref="A1.Ex6.m2.9.9.9.4.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex6.m2.9.9.9.4.2.1.1.1.cmml" xref="A1.Ex6.m2.9.9.9.4.2.1.1"><csymbol cd="latexml" id="A1.Ex6.m2.9.9.9.4.2.1.1.1.1.cmml" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.1">conditional</csymbol><apply id="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.cmml" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.1.cmml" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.2.cmml" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.2">𝑦</ci><cn id="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.3.cmml" type="integer" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.2.3">2</cn></apply><ci id="A1.Ex6.m2.9.9.9.4.2.1.1.1.3.cmml" xref="A1.Ex6.m2.9.9.9.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.Ex6.m2.15.15.15.10.1.1.1.3.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3"><times id="A1.Ex6.m2.15.15.15.10.1.1.1.3.1.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.1"></times><ci id="A1.Ex6.m2.15.15.15.10.1.1.1.3.2.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.2">𝛽</ci><apply id="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.3"><log id="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.1.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.1"></log><ci id="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.2.cmml" xref="A1.Ex6.m2.15.15.15.10.1.1.1.3.3.2">𝑍</ci></apply><ci id="A1.Ex6.m2.12.12.12.7.cmml" xref="A1.Ex6.m2.12.12.12.7">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m2.15c">\displaystyle=\frac{\exp\left(\beta\log\frac{\pi^{*}(y_{1}|x)}{\pi_{\text{ref}%
}(y_{1}|x)}+\beta\log Z(x)\right)}{\exp\left(\beta\log\frac{\pi^{*}(y_{1}|x)}{%
\pi_{\text{ref}}(y_{1}|x)}+\beta\log Z(x)\right)+\exp\left(\beta\log\frac{\pi^%
{*}(y_{2}|x)}{\pi_{\text{ref}}(y_{2}|x)}+\beta\log Z(x)\right)}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex6.m2.15d">= divide start_ARG roman_exp ( italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG + italic_β roman_log italic_Z ( italic_x ) ) end_ARG start_ARG roman_exp ( italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG + italic_β roman_log italic_Z ( italic_x ) ) + roman_exp ( italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x ) end_ARG + italic_β roman_log italic_Z ( italic_x ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{1+\exp\left(\beta\log\frac{\pi^{*}(y_{2}|x)}{\pi_{\text%
{ref}}(y_{2}|x)}-\beta\log\frac{\pi^{*}(y_{1}|x)}{\pi_{\text{ref}}(y_{1}|x)}%
\right)}" class="ltx_Math" display="inline" id="A1.Ex7.m1.6"><semantics id="A1.Ex7.m1.6a"><mrow id="A1.Ex7.m1.6.7" xref="A1.Ex7.m1.6.7.cmml"><mi id="A1.Ex7.m1.6.7.2" xref="A1.Ex7.m1.6.7.2.cmml"></mi><mo id="A1.Ex7.m1.6.7.1" xref="A1.Ex7.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex7.m1.6.6" xref="A1.Ex7.m1.6.6.cmml"><mfrac id="A1.Ex7.m1.6.6a" xref="A1.Ex7.m1.6.6.cmml"><mn id="A1.Ex7.m1.6.6.8" xref="A1.Ex7.m1.6.6.8.cmml">1</mn><mrow id="A1.Ex7.m1.6.6.6" xref="A1.Ex7.m1.6.6.6.cmml"><mn id="A1.Ex7.m1.6.6.6.8" xref="A1.Ex7.m1.6.6.6.8.cmml">1</mn><mo id="A1.Ex7.m1.6.6.6.7" xref="A1.Ex7.m1.6.6.6.7.cmml">+</mo><mrow id="A1.Ex7.m1.6.6.6.6.1" xref="A1.Ex7.m1.6.6.6.6.2.cmml"><mi id="A1.Ex7.m1.5.5.5.5" xref="A1.Ex7.m1.5.5.5.5.cmml">exp</mi><mo id="A1.Ex7.m1.6.6.6.6.1a" xref="A1.Ex7.m1.6.6.6.6.2.cmml">⁡</mo><mrow id="A1.Ex7.m1.6.6.6.6.1.1" xref="A1.Ex7.m1.6.6.6.6.2.cmml"><mo id="A1.Ex7.m1.6.6.6.6.1.1.2" xref="A1.Ex7.m1.6.6.6.6.2.cmml">(</mo><mrow id="A1.Ex7.m1.6.6.6.6.1.1.1" xref="A1.Ex7.m1.6.6.6.6.1.1.1.cmml"><mrow id="A1.Ex7.m1.6.6.6.6.1.1.1.2" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.cmml"><mi id="A1.Ex7.m1.6.6.6.6.1.1.1.2.2" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.2.cmml">β</mi><mo id="A1.Ex7.m1.6.6.6.6.1.1.1.2.1" lspace="0.167em" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex7.m1.6.6.6.6.1.1.1.2.3" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.3.cmml"><mi id="A1.Ex7.m1.6.6.6.6.1.1.1.2.3.1" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.3.1.cmml">log</mi><mo id="A1.Ex7.m1.6.6.6.6.1.1.1.2.3a" lspace="0.167em" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.3.cmml">⁡</mo><mfrac id="A1.Ex7.m1.2.2.2.2" xref="A1.Ex7.m1.2.2.2.2.cmml"><mrow id="A1.Ex7.m1.1.1.1.1.1" xref="A1.Ex7.m1.1.1.1.1.1.cmml"><msup id="A1.Ex7.m1.1.1.1.1.1.3" xref="A1.Ex7.m1.1.1.1.1.1.3.cmml"><mi id="A1.Ex7.m1.1.1.1.1.1.3.2" xref="A1.Ex7.m1.1.1.1.1.1.3.2.cmml">π</mi><mo id="A1.Ex7.m1.1.1.1.1.1.3.3" xref="A1.Ex7.m1.1.1.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.Ex7.m1.1.1.1.1.1.2" xref="A1.Ex7.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex7.m1.1.1.1.1.1.1.1" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex7.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex7.m1.1.1.1.1.1.1.1.1" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex7.m1.1.1.1.1.1.1.1.1.2" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.3.cmml">2</mn></msub><mo fence="false" id="A1.Ex7.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex7.m1.1.1.1.1.1.1.1.1.3" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex7.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex7.m1.2.2.2.2.2" xref="A1.Ex7.m1.2.2.2.2.2.cmml"><msub id="A1.Ex7.m1.2.2.2.2.2.3" xref="A1.Ex7.m1.2.2.2.2.2.3.cmml"><mi id="A1.Ex7.m1.2.2.2.2.2.3.2" xref="A1.Ex7.m1.2.2.2.2.2.3.2.cmml">π</mi><mtext id="A1.Ex7.m1.2.2.2.2.2.3.3" xref="A1.Ex7.m1.2.2.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex7.m1.2.2.2.2.2.2" xref="A1.Ex7.m1.2.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.Ex7.m1.2.2.2.2.2.1.1" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.cmml"><mo id="A1.Ex7.m1.2.2.2.2.2.1.1.2" stretchy="false" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex7.m1.2.2.2.2.2.1.1.1" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.cmml"><msub id="A1.Ex7.m1.2.2.2.2.2.1.1.1.2" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.cmml"><mi id="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.2" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.3" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.3.cmml">2</mn></msub><mo fence="false" id="A1.Ex7.m1.2.2.2.2.2.1.1.1.1" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex7.m1.2.2.2.2.2.1.1.1.3" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex7.m1.2.2.2.2.2.1.1.3" stretchy="false" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex7.m1.6.6.6.6.1.1.1.1" xref="A1.Ex7.m1.6.6.6.6.1.1.1.1.cmml">−</mo><mrow id="A1.Ex7.m1.6.6.6.6.1.1.1.3" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.cmml"><mi id="A1.Ex7.m1.6.6.6.6.1.1.1.3.2" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.2.cmml">β</mi><mo id="A1.Ex7.m1.6.6.6.6.1.1.1.3.1" lspace="0.167em" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex7.m1.6.6.6.6.1.1.1.3.3" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.3.cmml"><mi id="A1.Ex7.m1.6.6.6.6.1.1.1.3.3.1" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.3.1.cmml">log</mi><mo id="A1.Ex7.m1.6.6.6.6.1.1.1.3.3a" lspace="0.167em" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.3.cmml">⁡</mo><mfrac id="A1.Ex7.m1.4.4.4.4" xref="A1.Ex7.m1.4.4.4.4.cmml"><mrow id="A1.Ex7.m1.3.3.3.3.1" xref="A1.Ex7.m1.3.3.3.3.1.cmml"><msup id="A1.Ex7.m1.3.3.3.3.1.3" xref="A1.Ex7.m1.3.3.3.3.1.3.cmml"><mi id="A1.Ex7.m1.3.3.3.3.1.3.2" xref="A1.Ex7.m1.3.3.3.3.1.3.2.cmml">π</mi><mo id="A1.Ex7.m1.3.3.3.3.1.3.3" xref="A1.Ex7.m1.3.3.3.3.1.3.3.cmml">*</mo></msup><mo id="A1.Ex7.m1.3.3.3.3.1.2" xref="A1.Ex7.m1.3.3.3.3.1.2.cmml">⁢</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.cmml"><mo id="A1.Ex7.m1.3.3.3.3.1.1.1.2" stretchy="false" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.cmml"><msub id="A1.Ex7.m1.3.3.3.3.1.1.1.1.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.cmml"><mi id="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.3" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex7.m1.3.3.3.3.1.1.1.1.3" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex7.m1.3.3.3.3.1.1.1.3" stretchy="false" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex7.m1.4.4.4.4.2" xref="A1.Ex7.m1.4.4.4.4.2.cmml"><msub id="A1.Ex7.m1.4.4.4.4.2.3" xref="A1.Ex7.m1.4.4.4.4.2.3.cmml"><mi id="A1.Ex7.m1.4.4.4.4.2.3.2" xref="A1.Ex7.m1.4.4.4.4.2.3.2.cmml">π</mi><mtext id="A1.Ex7.m1.4.4.4.4.2.3.3" xref="A1.Ex7.m1.4.4.4.4.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex7.m1.4.4.4.4.2.2" xref="A1.Ex7.m1.4.4.4.4.2.2.cmml">⁢</mo><mrow id="A1.Ex7.m1.4.4.4.4.2.1.1" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.cmml"><mo id="A1.Ex7.m1.4.4.4.4.2.1.1.2" stretchy="false" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.cmml">(</mo><mrow id="A1.Ex7.m1.4.4.4.4.2.1.1.1" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.cmml"><msub id="A1.Ex7.m1.4.4.4.4.2.1.1.1.2" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.cmml"><mi id="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.2" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.3" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.Ex7.m1.4.4.4.4.2.1.1.1.1" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex7.m1.4.4.4.4.2.1.1.1.3" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex7.m1.4.4.4.4.2.1.1.3" stretchy="false" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="A1.Ex7.m1.6.6.6.6.1.1.3" xref="A1.Ex7.m1.6.6.6.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex7.m1.6b"><apply id="A1.Ex7.m1.6.7.cmml" xref="A1.Ex7.m1.6.7"><eq id="A1.Ex7.m1.6.7.1.cmml" xref="A1.Ex7.m1.6.7.1"></eq><csymbol cd="latexml" id="A1.Ex7.m1.6.7.2.cmml" xref="A1.Ex7.m1.6.7.2">absent</csymbol><apply id="A1.Ex7.m1.6.6.cmml" xref="A1.Ex7.m1.6.6"><divide id="A1.Ex7.m1.6.6.7.cmml" xref="A1.Ex7.m1.6.6"></divide><cn id="A1.Ex7.m1.6.6.8.cmml" type="integer" xref="A1.Ex7.m1.6.6.8">1</cn><apply id="A1.Ex7.m1.6.6.6.cmml" xref="A1.Ex7.m1.6.6.6"><plus id="A1.Ex7.m1.6.6.6.7.cmml" xref="A1.Ex7.m1.6.6.6.7"></plus><cn id="A1.Ex7.m1.6.6.6.8.cmml" type="integer" xref="A1.Ex7.m1.6.6.6.8">1</cn><apply id="A1.Ex7.m1.6.6.6.6.2.cmml" xref="A1.Ex7.m1.6.6.6.6.1"><exp id="A1.Ex7.m1.5.5.5.5.cmml" xref="A1.Ex7.m1.5.5.5.5"></exp><apply id="A1.Ex7.m1.6.6.6.6.1.1.1.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1"><minus id="A1.Ex7.m1.6.6.6.6.1.1.1.1.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.1"></minus><apply id="A1.Ex7.m1.6.6.6.6.1.1.1.2.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2"><times id="A1.Ex7.m1.6.6.6.6.1.1.1.2.1.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.1"></times><ci id="A1.Ex7.m1.6.6.6.6.1.1.1.2.2.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.2">𝛽</ci><apply id="A1.Ex7.m1.6.6.6.6.1.1.1.2.3.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.3"><log id="A1.Ex7.m1.6.6.6.6.1.1.1.2.3.1.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.2.3.1"></log><apply id="A1.Ex7.m1.2.2.2.2.cmml" xref="A1.Ex7.m1.2.2.2.2"><divide id="A1.Ex7.m1.2.2.2.2.3.cmml" xref="A1.Ex7.m1.2.2.2.2"></divide><apply id="A1.Ex7.m1.1.1.1.1.1.cmml" xref="A1.Ex7.m1.1.1.1.1.1"><times id="A1.Ex7.m1.1.1.1.1.1.2.cmml" xref="A1.Ex7.m1.1.1.1.1.1.2"></times><apply id="A1.Ex7.m1.1.1.1.1.1.3.cmml" xref="A1.Ex7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex7.m1.1.1.1.1.1.3.1.cmml" xref="A1.Ex7.m1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.Ex7.m1.1.1.1.1.1.3.2.cmml" xref="A1.Ex7.m1.1.1.1.1.1.3.2">𝜋</ci><times id="A1.Ex7.m1.1.1.1.1.1.3.3.cmml" xref="A1.Ex7.m1.1.1.1.1.1.3.3"></times></apply><apply id="A1.Ex7.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><cn id="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.2.3">2</cn></apply><ci id="A1.Ex7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex7.m1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex7.m1.2.2.2.2.2.cmml" xref="A1.Ex7.m1.2.2.2.2.2"><times id="A1.Ex7.m1.2.2.2.2.2.2.cmml" xref="A1.Ex7.m1.2.2.2.2.2.2"></times><apply id="A1.Ex7.m1.2.2.2.2.2.3.cmml" xref="A1.Ex7.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex7.m1.2.2.2.2.2.3.1.cmml" xref="A1.Ex7.m1.2.2.2.2.2.3">subscript</csymbol><ci id="A1.Ex7.m1.2.2.2.2.2.3.2.cmml" xref="A1.Ex7.m1.2.2.2.2.2.3.2">𝜋</ci><ci id="A1.Ex7.m1.2.2.2.2.2.3.3a.cmml" xref="A1.Ex7.m1.2.2.2.2.2.3.3"><mtext id="A1.Ex7.m1.2.2.2.2.2.3.3.cmml" mathsize="50%" xref="A1.Ex7.m1.2.2.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex7.m1.2.2.2.2.2.1.1.1.cmml" xref="A1.Ex7.m1.2.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.Ex7.m1.2.2.2.2.2.1.1.1.1.cmml" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.1">conditional</csymbol><apply id="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.cmml" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.2">𝑦</ci><cn id="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.3.cmml" type="integer" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.2.3">2</cn></apply><ci id="A1.Ex7.m1.2.2.2.2.2.1.1.1.3.cmml" xref="A1.Ex7.m1.2.2.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.Ex7.m1.6.6.6.6.1.1.1.3.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3"><times id="A1.Ex7.m1.6.6.6.6.1.1.1.3.1.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.1"></times><ci id="A1.Ex7.m1.6.6.6.6.1.1.1.3.2.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.2">𝛽</ci><apply id="A1.Ex7.m1.6.6.6.6.1.1.1.3.3.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.3"><log id="A1.Ex7.m1.6.6.6.6.1.1.1.3.3.1.cmml" xref="A1.Ex7.m1.6.6.6.6.1.1.1.3.3.1"></log><apply id="A1.Ex7.m1.4.4.4.4.cmml" xref="A1.Ex7.m1.4.4.4.4"><divide id="A1.Ex7.m1.4.4.4.4.3.cmml" xref="A1.Ex7.m1.4.4.4.4"></divide><apply id="A1.Ex7.m1.3.3.3.3.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1"><times id="A1.Ex7.m1.3.3.3.3.1.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.2"></times><apply id="A1.Ex7.m1.3.3.3.3.1.3.cmml" xref="A1.Ex7.m1.3.3.3.3.1.3"><csymbol cd="ambiguous" id="A1.Ex7.m1.3.3.3.3.1.3.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.3">superscript</csymbol><ci id="A1.Ex7.m1.3.3.3.3.1.3.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.3.2">𝜋</ci><times id="A1.Ex7.m1.3.3.3.3.1.3.3.cmml" xref="A1.Ex7.m1.3.3.3.3.1.3.3"></times></apply><apply id="A1.Ex7.m1.3.3.3.3.1.1.1.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1"><csymbol cd="latexml" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1">conditional</csymbol><apply id="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.2">𝑦</ci><cn id="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.3">1</cn></apply><ci id="A1.Ex7.m1.3.3.3.3.1.1.1.1.3.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex7.m1.4.4.4.4.2.cmml" xref="A1.Ex7.m1.4.4.4.4.2"><times id="A1.Ex7.m1.4.4.4.4.2.2.cmml" xref="A1.Ex7.m1.4.4.4.4.2.2"></times><apply id="A1.Ex7.m1.4.4.4.4.2.3.cmml" xref="A1.Ex7.m1.4.4.4.4.2.3"><csymbol cd="ambiguous" id="A1.Ex7.m1.4.4.4.4.2.3.1.cmml" xref="A1.Ex7.m1.4.4.4.4.2.3">subscript</csymbol><ci id="A1.Ex7.m1.4.4.4.4.2.3.2.cmml" xref="A1.Ex7.m1.4.4.4.4.2.3.2">𝜋</ci><ci id="A1.Ex7.m1.4.4.4.4.2.3.3a.cmml" xref="A1.Ex7.m1.4.4.4.4.2.3.3"><mtext id="A1.Ex7.m1.4.4.4.4.2.3.3.cmml" mathsize="50%" xref="A1.Ex7.m1.4.4.4.4.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex7.m1.4.4.4.4.2.1.1.1.cmml" xref="A1.Ex7.m1.4.4.4.4.2.1.1"><csymbol cd="latexml" id="A1.Ex7.m1.4.4.4.4.2.1.1.1.1.cmml" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.1">conditional</csymbol><apply id="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.cmml" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.1.cmml" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.2.cmml" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.2">𝑦</ci><cn id="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.3.cmml" type="integer" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.2.3">1</cn></apply><ci id="A1.Ex7.m1.4.4.4.4.2.1.1.1.3.cmml" xref="A1.Ex7.m1.4.4.4.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex7.m1.6c">\displaystyle=\frac{1}{1+\exp\left(\beta\log\frac{\pi^{*}(y_{2}|x)}{\pi_{\text%
{ref}}(y_{2}|x)}-\beta\log\frac{\pi^{*}(y_{1}|x)}{\pi_{\text{ref}}(y_{1}|x)}%
\right)}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex7.m1.6d">= divide start_ARG 1 end_ARG start_ARG 1 + roman_exp ( italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma\left(\beta\log\frac{\pi^{*}(y_{1}|x)}{\pi_{\text{ref}}(y_%
{1}|x)}-\beta\log\frac{\pi^{*}(y_{2}|x)}{\pi_{\text{ref}}(y_{2}|x)}\right)." class="ltx_Math" display="inline" id="A1.Ex8.m1.5"><semantics id="A1.Ex8.m1.5a"><mrow id="A1.Ex8.m1.5.5.1" xref="A1.Ex8.m1.5.5.1.1.cmml"><mrow id="A1.Ex8.m1.5.5.1.1" xref="A1.Ex8.m1.5.5.1.1.cmml"><mi id="A1.Ex8.m1.5.5.1.1.3" xref="A1.Ex8.m1.5.5.1.1.3.cmml"></mi><mo id="A1.Ex8.m1.5.5.1.1.2" xref="A1.Ex8.m1.5.5.1.1.2.cmml">=</mo><mrow id="A1.Ex8.m1.5.5.1.1.1" xref="A1.Ex8.m1.5.5.1.1.1.cmml"><mi id="A1.Ex8.m1.5.5.1.1.1.3" xref="A1.Ex8.m1.5.5.1.1.1.3.cmml">σ</mi><mo id="A1.Ex8.m1.5.5.1.1.1.2" xref="A1.Ex8.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex8.m1.5.5.1.1.1.1.1" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A1.Ex8.m1.5.5.1.1.1.1.1.2" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.5.5.1.1.1.1.1.1" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.2" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.2.cmml">β</mi><mo id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.1" lspace="0.167em" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3.1" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3.cmml">⁡</mo><mstyle displaystyle="true" id="A1.Ex8.m1.2.2" xref="A1.Ex8.m1.2.2.cmml"><mfrac id="A1.Ex8.m1.2.2a" xref="A1.Ex8.m1.2.2.cmml"><mrow id="A1.Ex8.m1.1.1.1" xref="A1.Ex8.m1.1.1.1.cmml"><msup id="A1.Ex8.m1.1.1.1.3" xref="A1.Ex8.m1.1.1.1.3.cmml"><mi id="A1.Ex8.m1.1.1.1.3.2" xref="A1.Ex8.m1.1.1.1.3.2.cmml">π</mi><mo id="A1.Ex8.m1.1.1.1.3.3" xref="A1.Ex8.m1.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.Ex8.m1.1.1.1.2" xref="A1.Ex8.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex8.m1.1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex8.m1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.1.1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.1.1.1.cmml"><msub id="A1.Ex8.m1.1.1.1.1.1.1.2" xref="A1.Ex8.m1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex8.m1.1.1.1.1.1.1.2.2" xref="A1.Ex8.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex8.m1.1.1.1.1.1.1.2.3" xref="A1.Ex8.m1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.Ex8.m1.1.1.1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex8.m1.1.1.1.1.1.1.3" xref="A1.Ex8.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex8.m1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex8.m1.2.2.2" xref="A1.Ex8.m1.2.2.2.cmml"><msub id="A1.Ex8.m1.2.2.2.3" xref="A1.Ex8.m1.2.2.2.3.cmml"><mi id="A1.Ex8.m1.2.2.2.3.2" xref="A1.Ex8.m1.2.2.2.3.2.cmml">π</mi><mtext id="A1.Ex8.m1.2.2.2.3.3" xref="A1.Ex8.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex8.m1.2.2.2.2" xref="A1.Ex8.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.Ex8.m1.2.2.2.1.1" xref="A1.Ex8.m1.2.2.2.1.1.1.cmml"><mo id="A1.Ex8.m1.2.2.2.1.1.2" stretchy="false" xref="A1.Ex8.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.2.2.2.1.1.1" xref="A1.Ex8.m1.2.2.2.1.1.1.cmml"><msub id="A1.Ex8.m1.2.2.2.1.1.1.2" xref="A1.Ex8.m1.2.2.2.1.1.1.2.cmml"><mi id="A1.Ex8.m1.2.2.2.1.1.1.2.2" xref="A1.Ex8.m1.2.2.2.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex8.m1.2.2.2.1.1.1.2.3" xref="A1.Ex8.m1.2.2.2.1.1.1.2.3.cmml">1</mn></msub><mo fence="false" id="A1.Ex8.m1.2.2.2.1.1.1.1" xref="A1.Ex8.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex8.m1.2.2.2.1.1.1.3" xref="A1.Ex8.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex8.m1.2.2.2.1.1.3" stretchy="false" xref="A1.Ex8.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="A1.Ex8.m1.5.5.1.1.1.1.1.1.1" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.2" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.1" lspace="0.167em" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3.1" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3.1.cmml">log</mi><mo id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3a" lspace="0.167em" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3.cmml">⁡</mo><mstyle displaystyle="true" id="A1.Ex8.m1.4.4" xref="A1.Ex8.m1.4.4.cmml"><mfrac id="A1.Ex8.m1.4.4a" xref="A1.Ex8.m1.4.4.cmml"><mrow id="A1.Ex8.m1.3.3.1" xref="A1.Ex8.m1.3.3.1.cmml"><msup id="A1.Ex8.m1.3.3.1.3" xref="A1.Ex8.m1.3.3.1.3.cmml"><mi id="A1.Ex8.m1.3.3.1.3.2" xref="A1.Ex8.m1.3.3.1.3.2.cmml">π</mi><mo id="A1.Ex8.m1.3.3.1.3.3" xref="A1.Ex8.m1.3.3.1.3.3.cmml">*</mo></msup><mo id="A1.Ex8.m1.3.3.1.2" xref="A1.Ex8.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.Ex8.m1.3.3.1.1.1" xref="A1.Ex8.m1.3.3.1.1.1.1.cmml"><mo id="A1.Ex8.m1.3.3.1.1.1.2" stretchy="false" xref="A1.Ex8.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.3.3.1.1.1.1" xref="A1.Ex8.m1.3.3.1.1.1.1.cmml"><msub id="A1.Ex8.m1.3.3.1.1.1.1.2" xref="A1.Ex8.m1.3.3.1.1.1.1.2.cmml"><mi id="A1.Ex8.m1.3.3.1.1.1.1.2.2" xref="A1.Ex8.m1.3.3.1.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex8.m1.3.3.1.1.1.1.2.3" xref="A1.Ex8.m1.3.3.1.1.1.1.2.3.cmml">2</mn></msub><mo fence="false" id="A1.Ex8.m1.3.3.1.1.1.1.1" xref="A1.Ex8.m1.3.3.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex8.m1.3.3.1.1.1.1.3" xref="A1.Ex8.m1.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex8.m1.3.3.1.1.1.3" stretchy="false" xref="A1.Ex8.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex8.m1.4.4.2" xref="A1.Ex8.m1.4.4.2.cmml"><msub id="A1.Ex8.m1.4.4.2.3" xref="A1.Ex8.m1.4.4.2.3.cmml"><mi id="A1.Ex8.m1.4.4.2.3.2" xref="A1.Ex8.m1.4.4.2.3.2.cmml">π</mi><mtext id="A1.Ex8.m1.4.4.2.3.3" xref="A1.Ex8.m1.4.4.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex8.m1.4.4.2.2" xref="A1.Ex8.m1.4.4.2.2.cmml">⁢</mo><mrow id="A1.Ex8.m1.4.4.2.1.1" xref="A1.Ex8.m1.4.4.2.1.1.1.cmml"><mo id="A1.Ex8.m1.4.4.2.1.1.2" stretchy="false" xref="A1.Ex8.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.4.4.2.1.1.1" xref="A1.Ex8.m1.4.4.2.1.1.1.cmml"><msub id="A1.Ex8.m1.4.4.2.1.1.1.2" xref="A1.Ex8.m1.4.4.2.1.1.1.2.cmml"><mi id="A1.Ex8.m1.4.4.2.1.1.1.2.2" xref="A1.Ex8.m1.4.4.2.1.1.1.2.2.cmml">y</mi><mn id="A1.Ex8.m1.4.4.2.1.1.1.2.3" xref="A1.Ex8.m1.4.4.2.1.1.1.2.3.cmml">2</mn></msub><mo fence="false" id="A1.Ex8.m1.4.4.2.1.1.1.1" xref="A1.Ex8.m1.4.4.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex8.m1.4.4.2.1.1.1.3" xref="A1.Ex8.m1.4.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex8.m1.4.4.2.1.1.3" stretchy="false" xref="A1.Ex8.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="A1.Ex8.m1.5.5.1.1.1.1.1.3" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex8.m1.5.5.1.2" lspace="0em" xref="A1.Ex8.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex8.m1.5b"><apply id="A1.Ex8.m1.5.5.1.1.cmml" xref="A1.Ex8.m1.5.5.1"><eq id="A1.Ex8.m1.5.5.1.1.2.cmml" xref="A1.Ex8.m1.5.5.1.1.2"></eq><csymbol cd="latexml" id="A1.Ex8.m1.5.5.1.1.3.cmml" xref="A1.Ex8.m1.5.5.1.1.3">absent</csymbol><apply id="A1.Ex8.m1.5.5.1.1.1.cmml" xref="A1.Ex8.m1.5.5.1.1.1"><times id="A1.Ex8.m1.5.5.1.1.1.2.cmml" xref="A1.Ex8.m1.5.5.1.1.1.2"></times><ci id="A1.Ex8.m1.5.5.1.1.1.3.cmml" xref="A1.Ex8.m1.5.5.1.1.1.3">𝜎</ci><apply id="A1.Ex8.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1"><minus id="A1.Ex8.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.1"></minus><apply id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2"><times id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.1"></times><ci id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.2">𝛽</ci><apply id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3"><log id="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.2.3.1"></log><apply id="A1.Ex8.m1.2.2.cmml" xref="A1.Ex8.m1.2.2"><divide id="A1.Ex8.m1.2.2.3.cmml" xref="A1.Ex8.m1.2.2"></divide><apply id="A1.Ex8.m1.1.1.1.cmml" xref="A1.Ex8.m1.1.1.1"><times id="A1.Ex8.m1.1.1.1.2.cmml" xref="A1.Ex8.m1.1.1.1.2"></times><apply id="A1.Ex8.m1.1.1.1.3.cmml" xref="A1.Ex8.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.1.1.1.3.1.cmml" xref="A1.Ex8.m1.1.1.1.3">superscript</csymbol><ci id="A1.Ex8.m1.1.1.1.3.2.cmml" xref="A1.Ex8.m1.1.1.1.3.2">𝜋</ci><times id="A1.Ex8.m1.1.1.1.3.3.cmml" xref="A1.Ex8.m1.1.1.1.3.3"></times></apply><apply id="A1.Ex8.m1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex8.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.Ex8.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex8.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex8.m1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex8.m1.1.1.1.1.1.1.2.2">𝑦</ci><cn id="A1.Ex8.m1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex8.m1.1.1.1.1.1.1.2.3">1</cn></apply><ci id="A1.Ex8.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex8.m1.2.2.2.cmml" xref="A1.Ex8.m1.2.2.2"><times id="A1.Ex8.m1.2.2.2.2.cmml" xref="A1.Ex8.m1.2.2.2.2"></times><apply id="A1.Ex8.m1.2.2.2.3.cmml" xref="A1.Ex8.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.2.2.2.3.1.cmml" xref="A1.Ex8.m1.2.2.2.3">subscript</csymbol><ci id="A1.Ex8.m1.2.2.2.3.2.cmml" xref="A1.Ex8.m1.2.2.2.3.2">𝜋</ci><ci id="A1.Ex8.m1.2.2.2.3.3a.cmml" xref="A1.Ex8.m1.2.2.2.3.3"><mtext id="A1.Ex8.m1.2.2.2.3.3.cmml" mathsize="70%" xref="A1.Ex8.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex8.m1.2.2.2.1.1.1.cmml" xref="A1.Ex8.m1.2.2.2.1.1"><csymbol cd="latexml" id="A1.Ex8.m1.2.2.2.1.1.1.1.cmml" xref="A1.Ex8.m1.2.2.2.1.1.1.1">conditional</csymbol><apply id="A1.Ex8.m1.2.2.2.1.1.1.2.cmml" xref="A1.Ex8.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.2.2.2.1.1.1.2.1.cmml" xref="A1.Ex8.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex8.m1.2.2.2.1.1.1.2.2.cmml" xref="A1.Ex8.m1.2.2.2.1.1.1.2.2">𝑦</ci><cn id="A1.Ex8.m1.2.2.2.1.1.1.2.3.cmml" type="integer" xref="A1.Ex8.m1.2.2.2.1.1.1.2.3">1</cn></apply><ci id="A1.Ex8.m1.2.2.2.1.1.1.3.cmml" xref="A1.Ex8.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3"><times id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.1"></times><ci id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.2">𝛽</ci><apply id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3"><log id="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex8.m1.5.5.1.1.1.1.1.1.3.3.1"></log><apply id="A1.Ex8.m1.4.4.cmml" xref="A1.Ex8.m1.4.4"><divide id="A1.Ex8.m1.4.4.3.cmml" xref="A1.Ex8.m1.4.4"></divide><apply id="A1.Ex8.m1.3.3.1.cmml" xref="A1.Ex8.m1.3.3.1"><times id="A1.Ex8.m1.3.3.1.2.cmml" xref="A1.Ex8.m1.3.3.1.2"></times><apply id="A1.Ex8.m1.3.3.1.3.cmml" xref="A1.Ex8.m1.3.3.1.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.3.3.1.3.1.cmml" xref="A1.Ex8.m1.3.3.1.3">superscript</csymbol><ci id="A1.Ex8.m1.3.3.1.3.2.cmml" xref="A1.Ex8.m1.3.3.1.3.2">𝜋</ci><times id="A1.Ex8.m1.3.3.1.3.3.cmml" xref="A1.Ex8.m1.3.3.1.3.3"></times></apply><apply id="A1.Ex8.m1.3.3.1.1.1.1.cmml" xref="A1.Ex8.m1.3.3.1.1.1"><csymbol cd="latexml" id="A1.Ex8.m1.3.3.1.1.1.1.1.cmml" xref="A1.Ex8.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="A1.Ex8.m1.3.3.1.1.1.1.2.cmml" xref="A1.Ex8.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.3.3.1.1.1.1.2.1.cmml" xref="A1.Ex8.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex8.m1.3.3.1.1.1.1.2.2.cmml" xref="A1.Ex8.m1.3.3.1.1.1.1.2.2">𝑦</ci><cn id="A1.Ex8.m1.3.3.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex8.m1.3.3.1.1.1.1.2.3">2</cn></apply><ci id="A1.Ex8.m1.3.3.1.1.1.1.3.cmml" xref="A1.Ex8.m1.3.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex8.m1.4.4.2.cmml" xref="A1.Ex8.m1.4.4.2"><times id="A1.Ex8.m1.4.4.2.2.cmml" xref="A1.Ex8.m1.4.4.2.2"></times><apply id="A1.Ex8.m1.4.4.2.3.cmml" xref="A1.Ex8.m1.4.4.2.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.4.4.2.3.1.cmml" xref="A1.Ex8.m1.4.4.2.3">subscript</csymbol><ci id="A1.Ex8.m1.4.4.2.3.2.cmml" xref="A1.Ex8.m1.4.4.2.3.2">𝜋</ci><ci id="A1.Ex8.m1.4.4.2.3.3a.cmml" xref="A1.Ex8.m1.4.4.2.3.3"><mtext id="A1.Ex8.m1.4.4.2.3.3.cmml" mathsize="70%" xref="A1.Ex8.m1.4.4.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex8.m1.4.4.2.1.1.1.cmml" xref="A1.Ex8.m1.4.4.2.1.1"><csymbol cd="latexml" id="A1.Ex8.m1.4.4.2.1.1.1.1.cmml" xref="A1.Ex8.m1.4.4.2.1.1.1.1">conditional</csymbol><apply id="A1.Ex8.m1.4.4.2.1.1.1.2.cmml" xref="A1.Ex8.m1.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.4.4.2.1.1.1.2.1.cmml" xref="A1.Ex8.m1.4.4.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex8.m1.4.4.2.1.1.1.2.2.cmml" xref="A1.Ex8.m1.4.4.2.1.1.1.2.2">𝑦</ci><cn id="A1.Ex8.m1.4.4.2.1.1.1.2.3.cmml" type="integer" xref="A1.Ex8.m1.4.4.2.1.1.1.2.3">2</cn></apply><ci id="A1.Ex8.m1.4.4.2.1.1.1.3.cmml" xref="A1.Ex8.m1.4.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex8.m1.5c">\displaystyle=\sigma\left(\beta\log\frac{\pi^{*}(y_{1}|x)}{\pi_{\text{ref}}(y_%
{1}|x)}-\beta\log\frac{\pi^{*}(y_{2}|x)}{\pi_{\text{ref}}(y_{2}|x)}\right).</annotation><annotation encoding="application/x-llamapun" id="A1.Ex8.m1.5d">= italic_σ ( italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_x ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_x ) end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.1">마지막 줄은 식 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E7" title="7 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">7</span></a>의 인스턴스당 손실이다.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Deriving the DPO Objective Under the Plackett-Luce Model</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.4">Plackett-Luce 모델 <cite class="ltx_cite ltx_citemacro_citep">[Plackett, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib30" title="">1975</a>, Luce, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib21" title="">2012</a>]</cite>는 브래들리-테리 모델을 단순히 쌍별 비교가 아닌 순위별로 일반화한 것이다. 브래들리-테리 모델과 유사하게, 그것은 가능한 선택들의 집합이 제시될 때, 사람들은 그 선택에 대한 일부 잠재 보상 함수의 값에 비례하는 확률을 갖는 선택을 선호한다고 규정한다. 우리의 맥락에서, 프롬프트 <math alttext="x" class="ltx_Math" display="inline" id="A1.SS3.p1.1.m1.1"><semantics id="A1.SS3.p1.1.m1.1a"><mi id="A1.SS3.p1.1.m1.1.1" xref="A1.SS3.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.1b"><ci id="A1.SS3.p1.1.m1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.1.m1.1d">italic_x</annotation></semantics></math> 및 <math alttext="K" class="ltx_Math" display="inline" id="A1.SS3.p1.2.m2.1"><semantics id="A1.SS3.p1.2.m2.1a"><mi id="A1.SS3.p1.2.m2.1.1" xref="A1.SS3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.2.m2.1b"><ci id="A1.SS3.p1.2.m2.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.2.m2.1d">italic_K</annotation></semantics></math> 답변의 집합 <math alttext="y_{1},\ldots,y_{K}" class="ltx_Math" display="inline" id="A1.SS3.p1.3.m3.3"><semantics id="A1.SS3.p1.3.m3.3a"><mrow id="A1.SS3.p1.3.m3.3.3.2" xref="A1.SS3.p1.3.m3.3.3.3.cmml"><msub id="A1.SS3.p1.3.m3.2.2.1.1" xref="A1.SS3.p1.3.m3.2.2.1.1.cmml"><mi id="A1.SS3.p1.3.m3.2.2.1.1.2" xref="A1.SS3.p1.3.m3.2.2.1.1.2.cmml">y</mi><mn id="A1.SS3.p1.3.m3.2.2.1.1.3" xref="A1.SS3.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="A1.SS3.p1.3.m3.3.3.2.3" xref="A1.SS3.p1.3.m3.3.3.3.cmml">,</mo><mi id="A1.SS3.p1.3.m3.1.1" mathvariant="normal" xref="A1.SS3.p1.3.m3.1.1.cmml">…</mi><mo id="A1.SS3.p1.3.m3.3.3.2.4" xref="A1.SS3.p1.3.m3.3.3.3.cmml">,</mo><msub id="A1.SS3.p1.3.m3.3.3.2.2" xref="A1.SS3.p1.3.m3.3.3.2.2.cmml"><mi id="A1.SS3.p1.3.m3.3.3.2.2.2" xref="A1.SS3.p1.3.m3.3.3.2.2.2.cmml">y</mi><mi id="A1.SS3.p1.3.m3.3.3.2.2.3" xref="A1.SS3.p1.3.m3.3.3.2.2.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.3.m3.3b"><list id="A1.SS3.p1.3.m3.3.3.3.cmml" xref="A1.SS3.p1.3.m3.3.3.2"><apply id="A1.SS3.p1.3.m3.2.2.1.1.cmml" xref="A1.SS3.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.3.m3.2.2.1.1.1.cmml" xref="A1.SS3.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="A1.SS3.p1.3.m3.2.2.1.1.2.cmml" xref="A1.SS3.p1.3.m3.2.2.1.1.2">𝑦</ci><cn id="A1.SS3.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="A1.SS3.p1.3.m3.2.2.1.1.3">1</cn></apply><ci id="A1.SS3.p1.3.m3.1.1.cmml" xref="A1.SS3.p1.3.m3.1.1">…</ci><apply id="A1.SS3.p1.3.m3.3.3.2.2.cmml" xref="A1.SS3.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS3.p1.3.m3.3.3.2.2.1.cmml" xref="A1.SS3.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="A1.SS3.p1.3.m3.3.3.2.2.2.cmml" xref="A1.SS3.p1.3.m3.3.3.2.2.2">𝑦</ci><ci id="A1.SS3.p1.3.m3.3.3.2.2.3.cmml" xref="A1.SS3.p1.3.m3.3.3.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.3.m3.3c">y_{1},\ldots,y_{K}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.3.m3.3d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> 사용자가 답변의 순위를 부여하는 순열 <math alttext="\tau:[K]\to[K]" class="ltx_Math" display="inline" id="A1.SS3.p1.4.m4.2"><semantics id="A1.SS3.p1.4.m4.2a"><mrow id="A1.SS3.p1.4.m4.2.3" xref="A1.SS3.p1.4.m4.2.3.cmml"><mi id="A1.SS3.p1.4.m4.2.3.2" xref="A1.SS3.p1.4.m4.2.3.2.cmml">τ</mi><mo id="A1.SS3.p1.4.m4.2.3.1" lspace="0.278em" rspace="0.278em" xref="A1.SS3.p1.4.m4.2.3.1.cmml">:</mo><mrow id="A1.SS3.p1.4.m4.2.3.3" xref="A1.SS3.p1.4.m4.2.3.3.cmml"><mrow id="A1.SS3.p1.4.m4.2.3.3.2.2" xref="A1.SS3.p1.4.m4.2.3.3.2.1.cmml"><mo id="A1.SS3.p1.4.m4.2.3.3.2.2.1" stretchy="false" xref="A1.SS3.p1.4.m4.2.3.3.2.1.1.cmml">[</mo><mi id="A1.SS3.p1.4.m4.1.1" xref="A1.SS3.p1.4.m4.1.1.cmml">K</mi><mo id="A1.SS3.p1.4.m4.2.3.3.2.2.2" stretchy="false" xref="A1.SS3.p1.4.m4.2.3.3.2.1.1.cmml">]</mo></mrow><mo id="A1.SS3.p1.4.m4.2.3.3.1" stretchy="false" xref="A1.SS3.p1.4.m4.2.3.3.1.cmml">→</mo><mrow id="A1.SS3.p1.4.m4.2.3.3.3.2" xref="A1.SS3.p1.4.m4.2.3.3.3.1.cmml"><mo id="A1.SS3.p1.4.m4.2.3.3.3.2.1" stretchy="false" xref="A1.SS3.p1.4.m4.2.3.3.3.1.1.cmml">[</mo><mi id="A1.SS3.p1.4.m4.2.2" xref="A1.SS3.p1.4.m4.2.2.cmml">K</mi><mo id="A1.SS3.p1.4.m4.2.3.3.3.2.2" stretchy="false" xref="A1.SS3.p1.4.m4.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.4.m4.2b"><apply id="A1.SS3.p1.4.m4.2.3.cmml" xref="A1.SS3.p1.4.m4.2.3"><ci id="A1.SS3.p1.4.m4.2.3.1.cmml" xref="A1.SS3.p1.4.m4.2.3.1">:</ci><ci id="A1.SS3.p1.4.m4.2.3.2.cmml" xref="A1.SS3.p1.4.m4.2.3.2">𝜏</ci><apply id="A1.SS3.p1.4.m4.2.3.3.cmml" xref="A1.SS3.p1.4.m4.2.3.3"><ci id="A1.SS3.p1.4.m4.2.3.3.1.cmml" xref="A1.SS3.p1.4.m4.2.3.3.1">→</ci><apply id="A1.SS3.p1.4.m4.2.3.3.2.1.cmml" xref="A1.SS3.p1.4.m4.2.3.3.2.2"><csymbol cd="latexml" id="A1.SS3.p1.4.m4.2.3.3.2.1.1.cmml" xref="A1.SS3.p1.4.m4.2.3.3.2.2.1">delimited-[]</csymbol><ci id="A1.SS3.p1.4.m4.1.1.cmml" xref="A1.SS3.p1.4.m4.1.1">𝐾</ci></apply><apply id="A1.SS3.p1.4.m4.2.3.3.3.1.cmml" xref="A1.SS3.p1.4.m4.2.3.3.3.2"><csymbol cd="latexml" id="A1.SS3.p1.4.m4.2.3.3.3.1.1.cmml" xref="A1.SS3.p1.4.m4.2.3.3.3.2.1">delimited-[]</csymbol><ci id="A1.SS3.p1.4.m4.2.2.cmml" xref="A1.SS3.p1.4.m4.2.2">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.4.m4.2c">\tau:[K]\to[K]</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.4.m4.2d">italic_τ : [ italic_K ] → [ italic_K ]</annotation></semantics></math>를 출력할 것이다. Plackett-Luce 모델은 다음과 같이 규정하고 있다.</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p^{*}(\tau|y_{1},\ldots,y_{K},x)=\prod_{k=1}^{K}\frac{\exp(r^{*}(x,y_{\tau(k)}%
))}{\sum_{j=k}^{K}\exp(r^{*}(x,y_{\tau(j)}))}" class="ltx_Math" display="block" id="A1.E18.m1.11"><semantics id="A1.E18.m1.11a"><mrow id="A1.E18.m1.11.11" xref="A1.E18.m1.11.11.cmml"><mrow id="A1.E18.m1.11.11.1" xref="A1.E18.m1.11.11.1.cmml"><msup id="A1.E18.m1.11.11.1.3" xref="A1.E18.m1.11.11.1.3.cmml"><mi id="A1.E18.m1.11.11.1.3.2" xref="A1.E18.m1.11.11.1.3.2.cmml">p</mi><mo id="A1.E18.m1.11.11.1.3.3" xref="A1.E18.m1.11.11.1.3.3.cmml">*</mo></msup><mo id="A1.E18.m1.11.11.1.2" xref="A1.E18.m1.11.11.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.11.11.1.1.1" xref="A1.E18.m1.11.11.1.1.1.1.cmml"><mo id="A1.E18.m1.11.11.1.1.1.2" stretchy="false" xref="A1.E18.m1.11.11.1.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.11.11.1.1.1.1" xref="A1.E18.m1.11.11.1.1.1.1.cmml"><mi id="A1.E18.m1.11.11.1.1.1.1.4" xref="A1.E18.m1.11.11.1.1.1.1.4.cmml">τ</mi><mo fence="false" id="A1.E18.m1.11.11.1.1.1.1.3" xref="A1.E18.m1.11.11.1.1.1.1.3.cmml">|</mo><mrow id="A1.E18.m1.11.11.1.1.1.1.2.2" xref="A1.E18.m1.11.11.1.1.1.1.2.3.cmml"><msub id="A1.E18.m1.11.11.1.1.1.1.1.1.1" xref="A1.E18.m1.11.11.1.1.1.1.1.1.1.cmml"><mi id="A1.E18.m1.11.11.1.1.1.1.1.1.1.2" xref="A1.E18.m1.11.11.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="A1.E18.m1.11.11.1.1.1.1.1.1.1.3" xref="A1.E18.m1.11.11.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.E18.m1.11.11.1.1.1.1.2.2.3" xref="A1.E18.m1.11.11.1.1.1.1.2.3.cmml">,</mo><mi id="A1.E18.m1.9.9" mathvariant="normal" xref="A1.E18.m1.9.9.cmml">…</mi><mo id="A1.E18.m1.11.11.1.1.1.1.2.2.4" xref="A1.E18.m1.11.11.1.1.1.1.2.3.cmml">,</mo><msub id="A1.E18.m1.11.11.1.1.1.1.2.2.2" xref="A1.E18.m1.11.11.1.1.1.1.2.2.2.cmml"><mi id="A1.E18.m1.11.11.1.1.1.1.2.2.2.2" xref="A1.E18.m1.11.11.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A1.E18.m1.11.11.1.1.1.1.2.2.2.3" xref="A1.E18.m1.11.11.1.1.1.1.2.2.2.3.cmml">K</mi></msub><mo id="A1.E18.m1.11.11.1.1.1.1.2.2.5" xref="A1.E18.m1.11.11.1.1.1.1.2.3.cmml">,</mo><mi id="A1.E18.m1.10.10" xref="A1.E18.m1.10.10.cmml">x</mi></mrow></mrow><mo id="A1.E18.m1.11.11.1.1.1.3" stretchy="false" xref="A1.E18.m1.11.11.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.11.11.2" rspace="0.111em" xref="A1.E18.m1.11.11.2.cmml">=</mo><mrow id="A1.E18.m1.11.11.3" xref="A1.E18.m1.11.11.3.cmml"><munderover id="A1.E18.m1.11.11.3.1" xref="A1.E18.m1.11.11.3.1.cmml"><mo id="A1.E18.m1.11.11.3.1.2.2" movablelimits="false" xref="A1.E18.m1.11.11.3.1.2.2.cmml">∏</mo><mrow id="A1.E18.m1.11.11.3.1.2.3" xref="A1.E18.m1.11.11.3.1.2.3.cmml"><mi id="A1.E18.m1.11.11.3.1.2.3.2" xref="A1.E18.m1.11.11.3.1.2.3.2.cmml">k</mi><mo id="A1.E18.m1.11.11.3.1.2.3.1" xref="A1.E18.m1.11.11.3.1.2.3.1.cmml">=</mo><mn id="A1.E18.m1.11.11.3.1.2.3.3" xref="A1.E18.m1.11.11.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E18.m1.11.11.3.1.3" xref="A1.E18.m1.11.11.3.1.3.cmml">K</mi></munderover><mfrac id="A1.E18.m1.8.8" xref="A1.E18.m1.8.8.cmml"><mrow id="A1.E18.m1.4.4.4.4" xref="A1.E18.m1.4.4.4.5.cmml"><mi id="A1.E18.m1.3.3.3.3" xref="A1.E18.m1.3.3.3.3.cmml">exp</mi><mo id="A1.E18.m1.4.4.4.4a" xref="A1.E18.m1.4.4.4.5.cmml">⁡</mo><mrow id="A1.E18.m1.4.4.4.4.1" xref="A1.E18.m1.4.4.4.5.cmml"><mo id="A1.E18.m1.4.4.4.4.1.2" stretchy="false" xref="A1.E18.m1.4.4.4.5.cmml">(</mo><mrow id="A1.E18.m1.4.4.4.4.1.1" xref="A1.E18.m1.4.4.4.4.1.1.cmml"><msup id="A1.E18.m1.4.4.4.4.1.1.3" xref="A1.E18.m1.4.4.4.4.1.1.3.cmml"><mi id="A1.E18.m1.4.4.4.4.1.1.3.2" xref="A1.E18.m1.4.4.4.4.1.1.3.2.cmml">r</mi><mo id="A1.E18.m1.4.4.4.4.1.1.3.3" xref="A1.E18.m1.4.4.4.4.1.1.3.3.cmml">*</mo></msup><mo id="A1.E18.m1.4.4.4.4.1.1.2" xref="A1.E18.m1.4.4.4.4.1.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.4.4.4.4.1.1.1.1" xref="A1.E18.m1.4.4.4.4.1.1.1.2.cmml"><mo id="A1.E18.m1.4.4.4.4.1.1.1.1.2" stretchy="false" xref="A1.E18.m1.4.4.4.4.1.1.1.2.cmml">(</mo><mi id="A1.E18.m1.2.2.2.2" xref="A1.E18.m1.2.2.2.2.cmml">x</mi><mo id="A1.E18.m1.4.4.4.4.1.1.1.1.3" xref="A1.E18.m1.4.4.4.4.1.1.1.2.cmml">,</mo><msub id="A1.E18.m1.4.4.4.4.1.1.1.1.1" xref="A1.E18.m1.4.4.4.4.1.1.1.1.1.cmml"><mi id="A1.E18.m1.4.4.4.4.1.1.1.1.1.2" xref="A1.E18.m1.4.4.4.4.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.E18.m1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.cmml"><mi id="A1.E18.m1.1.1.1.1.1.3" xref="A1.E18.m1.1.1.1.1.1.3.cmml">τ</mi><mo id="A1.E18.m1.1.1.1.1.1.2" xref="A1.E18.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.1.1.1.1.1.4.2" xref="A1.E18.m1.1.1.1.1.1.cmml"><mo id="A1.E18.m1.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.E18.m1.1.1.1.1.1.cmml">(</mo><mi id="A1.E18.m1.1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.1.cmml">k</mi><mo id="A1.E18.m1.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.E18.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.E18.m1.4.4.4.4.1.1.1.1.4" stretchy="false" xref="A1.E18.m1.4.4.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.4.4.4.4.1.3" stretchy="false" xref="A1.E18.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="A1.E18.m1.8.8.8" xref="A1.E18.m1.8.8.8.cmml"><msubsup id="A1.E18.m1.8.8.8.5" xref="A1.E18.m1.8.8.8.5.cmml"><mo id="A1.E18.m1.8.8.8.5.2.2" xref="A1.E18.m1.8.8.8.5.2.2.cmml">∑</mo><mrow id="A1.E18.m1.8.8.8.5.2.3" xref="A1.E18.m1.8.8.8.5.2.3.cmml"><mi id="A1.E18.m1.8.8.8.5.2.3.2" xref="A1.E18.m1.8.8.8.5.2.3.2.cmml">j</mi><mo id="A1.E18.m1.8.8.8.5.2.3.1" xref="A1.E18.m1.8.8.8.5.2.3.1.cmml">=</mo><mi id="A1.E18.m1.8.8.8.5.2.3.3" xref="A1.E18.m1.8.8.8.5.2.3.3.cmml">k</mi></mrow><mi id="A1.E18.m1.8.8.8.5.3" xref="A1.E18.m1.8.8.8.5.3.cmml">K</mi></msubsup><mrow id="A1.E18.m1.8.8.8.4.1" xref="A1.E18.m1.8.8.8.4.2.cmml"><mi id="A1.E18.m1.7.7.7.3" xref="A1.E18.m1.7.7.7.3.cmml">exp</mi><mo id="A1.E18.m1.8.8.8.4.1a" xref="A1.E18.m1.8.8.8.4.2.cmml">⁡</mo><mrow id="A1.E18.m1.8.8.8.4.1.1" xref="A1.E18.m1.8.8.8.4.2.cmml"><mo id="A1.E18.m1.8.8.8.4.1.1.2" stretchy="false" xref="A1.E18.m1.8.8.8.4.2.cmml">(</mo><mrow id="A1.E18.m1.8.8.8.4.1.1.1" xref="A1.E18.m1.8.8.8.4.1.1.1.cmml"><msup id="A1.E18.m1.8.8.8.4.1.1.1.3" xref="A1.E18.m1.8.8.8.4.1.1.1.3.cmml"><mi id="A1.E18.m1.8.8.8.4.1.1.1.3.2" xref="A1.E18.m1.8.8.8.4.1.1.1.3.2.cmml">r</mi><mo id="A1.E18.m1.8.8.8.4.1.1.1.3.3" xref="A1.E18.m1.8.8.8.4.1.1.1.3.3.cmml">*</mo></msup><mo id="A1.E18.m1.8.8.8.4.1.1.1.2" xref="A1.E18.m1.8.8.8.4.1.1.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.8.8.8.4.1.1.1.1.1" xref="A1.E18.m1.8.8.8.4.1.1.1.1.2.cmml"><mo id="A1.E18.m1.8.8.8.4.1.1.1.1.1.2" stretchy="false" xref="A1.E18.m1.8.8.8.4.1.1.1.1.2.cmml">(</mo><mi id="A1.E18.m1.6.6.6.2" xref="A1.E18.m1.6.6.6.2.cmml">x</mi><mo id="A1.E18.m1.8.8.8.4.1.1.1.1.1.3" xref="A1.E18.m1.8.8.8.4.1.1.1.1.2.cmml">,</mo><msub id="A1.E18.m1.8.8.8.4.1.1.1.1.1.1" xref="A1.E18.m1.8.8.8.4.1.1.1.1.1.1.cmml"><mi id="A1.E18.m1.8.8.8.4.1.1.1.1.1.1.2" xref="A1.E18.m1.8.8.8.4.1.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.E18.m1.5.5.5.1.1" xref="A1.E18.m1.5.5.5.1.1.cmml"><mi id="A1.E18.m1.5.5.5.1.1.3" xref="A1.E18.m1.5.5.5.1.1.3.cmml">τ</mi><mo id="A1.E18.m1.5.5.5.1.1.2" xref="A1.E18.m1.5.5.5.1.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.5.5.5.1.1.4.2" xref="A1.E18.m1.5.5.5.1.1.cmml"><mo id="A1.E18.m1.5.5.5.1.1.4.2.1" stretchy="false" xref="A1.E18.m1.5.5.5.1.1.cmml">(</mo><mi id="A1.E18.m1.5.5.5.1.1.1" xref="A1.E18.m1.5.5.5.1.1.1.cmml">j</mi><mo id="A1.E18.m1.5.5.5.1.1.4.2.2" stretchy="false" xref="A1.E18.m1.5.5.5.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.E18.m1.8.8.8.4.1.1.1.1.1.4" stretchy="false" xref="A1.E18.m1.8.8.8.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E18.m1.8.8.8.4.1.1.3" stretchy="false" xref="A1.E18.m1.8.8.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m1.11b"><apply id="A1.E18.m1.11.11.cmml" xref="A1.E18.m1.11.11"><eq id="A1.E18.m1.11.11.2.cmml" xref="A1.E18.m1.11.11.2"></eq><apply id="A1.E18.m1.11.11.1.cmml" xref="A1.E18.m1.11.11.1"><times id="A1.E18.m1.11.11.1.2.cmml" xref="A1.E18.m1.11.11.1.2"></times><apply id="A1.E18.m1.11.11.1.3.cmml" xref="A1.E18.m1.11.11.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.11.11.1.3.1.cmml" xref="A1.E18.m1.11.11.1.3">superscript</csymbol><ci id="A1.E18.m1.11.11.1.3.2.cmml" xref="A1.E18.m1.11.11.1.3.2">𝑝</ci><times id="A1.E18.m1.11.11.1.3.3.cmml" xref="A1.E18.m1.11.11.1.3.3"></times></apply><apply id="A1.E18.m1.11.11.1.1.1.1.cmml" xref="A1.E18.m1.11.11.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.11.11.1.1.1.1.3.cmml" xref="A1.E18.m1.11.11.1.1.1.1.3">conditional</csymbol><ci id="A1.E18.m1.11.11.1.1.1.1.4.cmml" xref="A1.E18.m1.11.11.1.1.1.1.4">𝜏</ci><list id="A1.E18.m1.11.11.1.1.1.1.2.3.cmml" xref="A1.E18.m1.11.11.1.1.1.1.2.2"><apply id="A1.E18.m1.11.11.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.11.11.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.11.11.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.11.11.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.11.11.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.11.11.1.1.1.1.1.1.1.2">𝑦</ci><cn id="A1.E18.m1.11.11.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E18.m1.11.11.1.1.1.1.1.1.1.3">1</cn></apply><ci id="A1.E18.m1.9.9.cmml" xref="A1.E18.m1.9.9">…</ci><apply id="A1.E18.m1.11.11.1.1.1.1.2.2.2.cmml" xref="A1.E18.m1.11.11.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E18.m1.11.11.1.1.1.1.2.2.2.1.cmml" xref="A1.E18.m1.11.11.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E18.m1.11.11.1.1.1.1.2.2.2.2.cmml" xref="A1.E18.m1.11.11.1.1.1.1.2.2.2.2">𝑦</ci><ci id="A1.E18.m1.11.11.1.1.1.1.2.2.2.3.cmml" xref="A1.E18.m1.11.11.1.1.1.1.2.2.2.3">𝐾</ci></apply><ci id="A1.E18.m1.10.10.cmml" xref="A1.E18.m1.10.10">𝑥</ci></list></apply></apply><apply id="A1.E18.m1.11.11.3.cmml" xref="A1.E18.m1.11.11.3"><apply id="A1.E18.m1.11.11.3.1.cmml" xref="A1.E18.m1.11.11.3.1"><csymbol cd="ambiguous" id="A1.E18.m1.11.11.3.1.1.cmml" xref="A1.E18.m1.11.11.3.1">superscript</csymbol><apply id="A1.E18.m1.11.11.3.1.2.cmml" xref="A1.E18.m1.11.11.3.1"><csymbol cd="ambiguous" id="A1.E18.m1.11.11.3.1.2.1.cmml" xref="A1.E18.m1.11.11.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.E18.m1.11.11.3.1.2.2.cmml" xref="A1.E18.m1.11.11.3.1.2.2">product</csymbol><apply id="A1.E18.m1.11.11.3.1.2.3.cmml" xref="A1.E18.m1.11.11.3.1.2.3"><eq id="A1.E18.m1.11.11.3.1.2.3.1.cmml" xref="A1.E18.m1.11.11.3.1.2.3.1"></eq><ci id="A1.E18.m1.11.11.3.1.2.3.2.cmml" xref="A1.E18.m1.11.11.3.1.2.3.2">𝑘</ci><cn id="A1.E18.m1.11.11.3.1.2.3.3.cmml" type="integer" xref="A1.E18.m1.11.11.3.1.2.3.3">1</cn></apply></apply><ci id="A1.E18.m1.11.11.3.1.3.cmml" xref="A1.E18.m1.11.11.3.1.3">𝐾</ci></apply><apply id="A1.E18.m1.8.8.cmml" xref="A1.E18.m1.8.8"><divide id="A1.E18.m1.8.8.9.cmml" xref="A1.E18.m1.8.8"></divide><apply id="A1.E18.m1.4.4.4.5.cmml" xref="A1.E18.m1.4.4.4.4"><exp id="A1.E18.m1.3.3.3.3.cmml" xref="A1.E18.m1.3.3.3.3"></exp><apply id="A1.E18.m1.4.4.4.4.1.1.cmml" xref="A1.E18.m1.4.4.4.4.1.1"><times id="A1.E18.m1.4.4.4.4.1.1.2.cmml" xref="A1.E18.m1.4.4.4.4.1.1.2"></times><apply id="A1.E18.m1.4.4.4.4.1.1.3.cmml" xref="A1.E18.m1.4.4.4.4.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.4.4.4.4.1.1.3.1.cmml" xref="A1.E18.m1.4.4.4.4.1.1.3">superscript</csymbol><ci id="A1.E18.m1.4.4.4.4.1.1.3.2.cmml" xref="A1.E18.m1.4.4.4.4.1.1.3.2">𝑟</ci><times id="A1.E18.m1.4.4.4.4.1.1.3.3.cmml" xref="A1.E18.m1.4.4.4.4.1.1.3.3"></times></apply><interval closure="open" id="A1.E18.m1.4.4.4.4.1.1.1.2.cmml" xref="A1.E18.m1.4.4.4.4.1.1.1.1"><ci id="A1.E18.m1.2.2.2.2.cmml" xref="A1.E18.m1.2.2.2.2">𝑥</ci><apply id="A1.E18.m1.4.4.4.4.1.1.1.1.1.cmml" xref="A1.E18.m1.4.4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="A1.E18.m1.4.4.4.4.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.4.4.4.4.1.1.1.1.1.2.cmml" xref="A1.E18.m1.4.4.4.4.1.1.1.1.1.2">𝑦</ci><apply id="A1.E18.m1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1"><times id="A1.E18.m1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.2"></times><ci id="A1.E18.m1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.3">𝜏</ci><ci id="A1.E18.m1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">𝑘</ci></apply></apply></interval></apply></apply><apply id="A1.E18.m1.8.8.8.cmml" xref="A1.E18.m1.8.8.8"><apply id="A1.E18.m1.8.8.8.5.cmml" xref="A1.E18.m1.8.8.8.5"><csymbol cd="ambiguous" id="A1.E18.m1.8.8.8.5.1.cmml" xref="A1.E18.m1.8.8.8.5">superscript</csymbol><apply id="A1.E18.m1.8.8.8.5.2.cmml" xref="A1.E18.m1.8.8.8.5"><csymbol cd="ambiguous" id="A1.E18.m1.8.8.8.5.2.1.cmml" xref="A1.E18.m1.8.8.8.5">subscript</csymbol><sum id="A1.E18.m1.8.8.8.5.2.2.cmml" xref="A1.E18.m1.8.8.8.5.2.2"></sum><apply id="A1.E18.m1.8.8.8.5.2.3.cmml" xref="A1.E18.m1.8.8.8.5.2.3"><eq id="A1.E18.m1.8.8.8.5.2.3.1.cmml" xref="A1.E18.m1.8.8.8.5.2.3.1"></eq><ci id="A1.E18.m1.8.8.8.5.2.3.2.cmml" xref="A1.E18.m1.8.8.8.5.2.3.2">𝑗</ci><ci id="A1.E18.m1.8.8.8.5.2.3.3.cmml" xref="A1.E18.m1.8.8.8.5.2.3.3">𝑘</ci></apply></apply><ci id="A1.E18.m1.8.8.8.5.3.cmml" xref="A1.E18.m1.8.8.8.5.3">𝐾</ci></apply><apply id="A1.E18.m1.8.8.8.4.2.cmml" xref="A1.E18.m1.8.8.8.4.1"><exp id="A1.E18.m1.7.7.7.3.cmml" xref="A1.E18.m1.7.7.7.3"></exp><apply id="A1.E18.m1.8.8.8.4.1.1.1.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1"><times id="A1.E18.m1.8.8.8.4.1.1.1.2.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1.2"></times><apply id="A1.E18.m1.8.8.8.4.1.1.1.3.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.8.8.8.4.1.1.1.3.1.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1.3">superscript</csymbol><ci id="A1.E18.m1.8.8.8.4.1.1.1.3.2.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1.3.2">𝑟</ci><times id="A1.E18.m1.8.8.8.4.1.1.1.3.3.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1.3.3"></times></apply><interval closure="open" id="A1.E18.m1.8.8.8.4.1.1.1.1.2.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1.1.1"><ci id="A1.E18.m1.6.6.6.2.cmml" xref="A1.E18.m1.6.6.6.2">𝑥</ci><apply id="A1.E18.m1.8.8.8.4.1.1.1.1.1.1.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m1.8.8.8.4.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m1.8.8.8.4.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.8.8.8.4.1.1.1.1.1.1.2">𝑦</ci><apply id="A1.E18.m1.5.5.5.1.1.cmml" xref="A1.E18.m1.5.5.5.1.1"><times id="A1.E18.m1.5.5.5.1.1.2.cmml" xref="A1.E18.m1.5.5.5.1.1.2"></times><ci id="A1.E18.m1.5.5.5.1.1.3.cmml" xref="A1.E18.m1.5.5.5.1.1.3">𝜏</ci><ci id="A1.E18.m1.5.5.5.1.1.1.cmml" xref="A1.E18.m1.5.5.5.1.1.1">𝑗</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.11c">p^{*}(\tau|y_{1},\ldots,y_{K},x)=\prod_{k=1}^{K}\frac{\exp(r^{*}(x,y_{\tau(k)}%
))}{\sum_{j=k}^{K}\exp(r^{*}(x,y_{\tau(j)}))}</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m1.11d">italic_p start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_τ | italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_x ) = ∏ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG roman_exp ( italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_k ) end_POSTSUBSCRIPT ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_j ) end_POSTSUBSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.2"><math alttext="K=2" class="ltx_Math" display="inline" id="A1.SS3.p2.1.m1.1"><semantics id="A1.SS3.p2.1.m1.1a"><mrow id="A1.SS3.p2.1.m1.1.1" xref="A1.SS3.p2.1.m1.1.1.cmml"><mi id="A1.SS3.p2.1.m1.1.1.2" xref="A1.SS3.p2.1.m1.1.1.2.cmml">K</mi><mo id="A1.SS3.p2.1.m1.1.1.1" xref="A1.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS3.p2.1.m1.1.1.3" xref="A1.SS3.p2.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.1.m1.1b"><apply id="A1.SS3.p2.1.m1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1"><eq id="A1.SS3.p2.1.m1.1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1.1"></eq><ci id="A1.SS3.p2.1.m1.1.1.2.cmml" xref="A1.SS3.p2.1.m1.1.1.2">𝐾</ci><cn id="A1.SS3.p2.1.m1.1.1.3.cmml" type="integer" xref="A1.SS3.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.1.m1.1c">K=2</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.1.m1.1d">italic_K = 2</annotation></semantics></math>일 때, 수학식 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.E18" title="18 ‣ A.3 Deriving the DPO Objective Under the Plackett-Luce Model ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">18</span></a>가 Bradley-Terry 모델로 감소함을 주목한다. 그러나 일반적인 Plackett-Luce 모델의 경우 Eq. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E5" title="5 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a> 및 그것의 최적 정책에 의해 파라미터화된 보상 함수를 대체한다. 부록 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.SS2" title="A.2 Deriving the DPO Objective Under the Bradley-Terry Model ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">A.2</span></a>와 유사하게, 정규화 상수 <math alttext="Z(x)" class="ltx_Math" display="inline" id="A1.SS3.p2.2.m2.1"><semantics id="A1.SS3.p2.2.m2.1a"><mrow id="A1.SS3.p2.2.m2.1.2" xref="A1.SS3.p2.2.m2.1.2.cmml"><mi id="A1.SS3.p2.2.m2.1.2.2" xref="A1.SS3.p2.2.m2.1.2.2.cmml">Z</mi><mo id="A1.SS3.p2.2.m2.1.2.1" xref="A1.SS3.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS3.p2.2.m2.1.2.3.2" xref="A1.SS3.p2.2.m2.1.2.cmml"><mo id="A1.SS3.p2.2.m2.1.2.3.2.1" stretchy="false" xref="A1.SS3.p2.2.m2.1.2.cmml">(</mo><mi id="A1.SS3.p2.2.m2.1.1" xref="A1.SS3.p2.2.m2.1.1.cmml">x</mi><mo id="A1.SS3.p2.2.m2.1.2.3.2.2" stretchy="false" xref="A1.SS3.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.2.m2.1b"><apply id="A1.SS3.p2.2.m2.1.2.cmml" xref="A1.SS3.p2.2.m2.1.2"><times id="A1.SS3.p2.2.m2.1.2.1.cmml" xref="A1.SS3.p2.2.m2.1.2.1"></times><ci id="A1.SS3.p2.2.m2.1.2.2.cmml" xref="A1.SS3.p2.2.m2.1.2.2">𝑍</ci><ci id="A1.SS3.p2.2.m2.1.1.cmml" xref="A1.SS3.p2.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.2.m2.1c">Z(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.2.m2.1d">italic_Z ( italic_x )</annotation></semantics></math>는 상쇄되고 우리는 다음과 같이 남게 된다:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p^{*}(\tau|y_{1},\ldots,y_{K},x)=\prod_{k=1}^{K}\frac{\exp\left(\beta\log\frac%
{\pi^{*}(y_{\tau(k)}|x)}{\pi_{\text{ref}}(y_{\tau(k)}|x)}\right)}{\sum_{j=k}^{%
K}\exp\left(\beta\log\frac{\pi^{*}(y_{\tau(j)}|x)}{\pi_{\text{ref}}(y_{\tau(j)%
}|x)}\right)}" class="ltx_Math" display="block" id="A1.E19.m1.15"><semantics id="A1.E19.m1.15a"><mrow id="A1.E19.m1.15.15" xref="A1.E19.m1.15.15.cmml"><mrow id="A1.E19.m1.15.15.1" xref="A1.E19.m1.15.15.1.cmml"><msup id="A1.E19.m1.15.15.1.3" xref="A1.E19.m1.15.15.1.3.cmml"><mi id="A1.E19.m1.15.15.1.3.2" xref="A1.E19.m1.15.15.1.3.2.cmml">p</mi><mo id="A1.E19.m1.15.15.1.3.3" xref="A1.E19.m1.15.15.1.3.3.cmml">*</mo></msup><mo id="A1.E19.m1.15.15.1.2" xref="A1.E19.m1.15.15.1.2.cmml">⁢</mo><mrow id="A1.E19.m1.15.15.1.1.1" xref="A1.E19.m1.15.15.1.1.1.1.cmml"><mo id="A1.E19.m1.15.15.1.1.1.2" stretchy="false" xref="A1.E19.m1.15.15.1.1.1.1.cmml">(</mo><mrow id="A1.E19.m1.15.15.1.1.1.1" xref="A1.E19.m1.15.15.1.1.1.1.cmml"><mi id="A1.E19.m1.15.15.1.1.1.1.4" xref="A1.E19.m1.15.15.1.1.1.1.4.cmml">τ</mi><mo fence="false" id="A1.E19.m1.15.15.1.1.1.1.3" xref="A1.E19.m1.15.15.1.1.1.1.3.cmml">|</mo><mrow id="A1.E19.m1.15.15.1.1.1.1.2.2" xref="A1.E19.m1.15.15.1.1.1.1.2.3.cmml"><msub id="A1.E19.m1.15.15.1.1.1.1.1.1.1" xref="A1.E19.m1.15.15.1.1.1.1.1.1.1.cmml"><mi id="A1.E19.m1.15.15.1.1.1.1.1.1.1.2" xref="A1.E19.m1.15.15.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="A1.E19.m1.15.15.1.1.1.1.1.1.1.3" xref="A1.E19.m1.15.15.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.E19.m1.15.15.1.1.1.1.2.2.3" xref="A1.E19.m1.15.15.1.1.1.1.2.3.cmml">,</mo><mi id="A1.E19.m1.13.13" mathvariant="normal" xref="A1.E19.m1.13.13.cmml">…</mi><mo id="A1.E19.m1.15.15.1.1.1.1.2.2.4" xref="A1.E19.m1.15.15.1.1.1.1.2.3.cmml">,</mo><msub id="A1.E19.m1.15.15.1.1.1.1.2.2.2" xref="A1.E19.m1.15.15.1.1.1.1.2.2.2.cmml"><mi id="A1.E19.m1.15.15.1.1.1.1.2.2.2.2" xref="A1.E19.m1.15.15.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A1.E19.m1.15.15.1.1.1.1.2.2.2.3" xref="A1.E19.m1.15.15.1.1.1.1.2.2.2.3.cmml">K</mi></msub><mo id="A1.E19.m1.15.15.1.1.1.1.2.2.5" xref="A1.E19.m1.15.15.1.1.1.1.2.3.cmml">,</mo><mi id="A1.E19.m1.14.14" xref="A1.E19.m1.14.14.cmml">x</mi></mrow></mrow><mo id="A1.E19.m1.15.15.1.1.1.3" stretchy="false" xref="A1.E19.m1.15.15.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E19.m1.15.15.2" rspace="0.111em" xref="A1.E19.m1.15.15.2.cmml">=</mo><mrow id="A1.E19.m1.15.15.3" xref="A1.E19.m1.15.15.3.cmml"><munderover id="A1.E19.m1.15.15.3.1" xref="A1.E19.m1.15.15.3.1.cmml"><mo id="A1.E19.m1.15.15.3.1.2.2" movablelimits="false" xref="A1.E19.m1.15.15.3.1.2.2.cmml">∏</mo><mrow id="A1.E19.m1.15.15.3.1.2.3" xref="A1.E19.m1.15.15.3.1.2.3.cmml"><mi id="A1.E19.m1.15.15.3.1.2.3.2" xref="A1.E19.m1.15.15.3.1.2.3.2.cmml">k</mi><mo id="A1.E19.m1.15.15.3.1.2.3.1" xref="A1.E19.m1.15.15.3.1.2.3.1.cmml">=</mo><mn id="A1.E19.m1.15.15.3.1.2.3.3" xref="A1.E19.m1.15.15.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E19.m1.15.15.3.1.3" xref="A1.E19.m1.15.15.3.1.3.cmml">K</mi></munderover><mfrac id="A1.E19.m1.12.12" xref="A1.E19.m1.12.12.cmml"><mrow id="A1.E19.m1.6.6.6.6" xref="A1.E19.m1.6.6.6.7.cmml"><mi id="A1.E19.m1.5.5.5.5" xref="A1.E19.m1.5.5.5.5.cmml">exp</mi><mo id="A1.E19.m1.6.6.6.6a" xref="A1.E19.m1.6.6.6.7.cmml">⁡</mo><mrow id="A1.E19.m1.6.6.6.6.1" xref="A1.E19.m1.6.6.6.7.cmml"><mo id="A1.E19.m1.6.6.6.6.1.2" xref="A1.E19.m1.6.6.6.7.cmml">(</mo><mrow id="A1.E19.m1.6.6.6.6.1.1" xref="A1.E19.m1.6.6.6.6.1.1.cmml"><mi id="A1.E19.m1.6.6.6.6.1.1.2" xref="A1.E19.m1.6.6.6.6.1.1.2.cmml">β</mi><mo id="A1.E19.m1.6.6.6.6.1.1.1" lspace="0.167em" xref="A1.E19.m1.6.6.6.6.1.1.1.cmml">⁢</mo><mrow id="A1.E19.m1.6.6.6.6.1.1.3" xref="A1.E19.m1.6.6.6.6.1.1.3.cmml"><mi id="A1.E19.m1.6.6.6.6.1.1.3.1" xref="A1.E19.m1.6.6.6.6.1.1.3.1.cmml">log</mi><mo id="A1.E19.m1.6.6.6.6.1.1.3a" lspace="0.167em" xref="A1.E19.m1.6.6.6.6.1.1.3.cmml">⁡</mo><mfrac id="A1.E19.m1.4.4.4.4" xref="A1.E19.m1.4.4.4.4.cmml"><mrow id="A1.E19.m1.2.2.2.2.2" xref="A1.E19.m1.2.2.2.2.2.cmml"><msup id="A1.E19.m1.2.2.2.2.2.4" xref="A1.E19.m1.2.2.2.2.2.4.cmml"><mi id="A1.E19.m1.2.2.2.2.2.4.2" xref="A1.E19.m1.2.2.2.2.2.4.2.cmml">π</mi><mo id="A1.E19.m1.2.2.2.2.2.4.3" xref="A1.E19.m1.2.2.2.2.2.4.3.cmml">*</mo></msup><mo id="A1.E19.m1.2.2.2.2.2.3" xref="A1.E19.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="A1.E19.m1.2.2.2.2.2.2.1" xref="A1.E19.m1.2.2.2.2.2.2.1.1.cmml"><mo id="A1.E19.m1.2.2.2.2.2.2.1.2" stretchy="false" xref="A1.E19.m1.2.2.2.2.2.2.1.1.cmml">(</mo><mrow id="A1.E19.m1.2.2.2.2.2.2.1.1" xref="A1.E19.m1.2.2.2.2.2.2.1.1.cmml"><msub id="A1.E19.m1.2.2.2.2.2.2.1.1.2" xref="A1.E19.m1.2.2.2.2.2.2.1.1.2.cmml"><mi id="A1.E19.m1.2.2.2.2.2.2.1.1.2.2" xref="A1.E19.m1.2.2.2.2.2.2.1.1.2.2.cmml">y</mi><mrow id="A1.E19.m1.1.1.1.1.1.1.1" xref="A1.E19.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E19.m1.1.1.1.1.1.1.1.3" xref="A1.E19.m1.1.1.1.1.1.1.1.3.cmml">τ</mi><mo id="A1.E19.m1.1.1.1.1.1.1.1.2" xref="A1.E19.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E19.m1.1.1.1.1.1.1.1.4.2" xref="A1.E19.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E19.m1.1.1.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.E19.m1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E19.m1.1.1.1.1.1.1.1.1" xref="A1.E19.m1.1.1.1.1.1.1.1.1.cmml">k</mi><mo id="A1.E19.m1.1.1.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.E19.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo fence="false" id="A1.E19.m1.2.2.2.2.2.2.1.1.1" xref="A1.E19.m1.2.2.2.2.2.2.1.1.1.cmml">|</mo><mi id="A1.E19.m1.2.2.2.2.2.2.1.1.3" xref="A1.E19.m1.2.2.2.2.2.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E19.m1.2.2.2.2.2.2.1.3" stretchy="false" xref="A1.E19.m1.2.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E19.m1.4.4.4.4.4" xref="A1.E19.m1.4.4.4.4.4.cmml"><msub id="A1.E19.m1.4.4.4.4.4.4" xref="A1.E19.m1.4.4.4.4.4.4.cmml"><mi id="A1.E19.m1.4.4.4.4.4.4.2" xref="A1.E19.m1.4.4.4.4.4.4.2.cmml">π</mi><mtext id="A1.E19.m1.4.4.4.4.4.4.3" xref="A1.E19.m1.4.4.4.4.4.4.3a.cmml">ref</mtext></msub><mo id="A1.E19.m1.4.4.4.4.4.3" xref="A1.E19.m1.4.4.4.4.4.3.cmml">⁢</mo><mrow id="A1.E19.m1.4.4.4.4.4.2.1" xref="A1.E19.m1.4.4.4.4.4.2.1.1.cmml"><mo id="A1.E19.m1.4.4.4.4.4.2.1.2" stretchy="false" xref="A1.E19.m1.4.4.4.4.4.2.1.1.cmml">(</mo><mrow id="A1.E19.m1.4.4.4.4.4.2.1.1" xref="A1.E19.m1.4.4.4.4.4.2.1.1.cmml"><msub id="A1.E19.m1.4.4.4.4.4.2.1.1.2" xref="A1.E19.m1.4.4.4.4.4.2.1.1.2.cmml"><mi id="A1.E19.m1.4.4.4.4.4.2.1.1.2.2" xref="A1.E19.m1.4.4.4.4.4.2.1.1.2.2.cmml">y</mi><mrow id="A1.E19.m1.3.3.3.3.3.1.1" xref="A1.E19.m1.3.3.3.3.3.1.1.cmml"><mi id="A1.E19.m1.3.3.3.3.3.1.1.3" xref="A1.E19.m1.3.3.3.3.3.1.1.3.cmml">τ</mi><mo id="A1.E19.m1.3.3.3.3.3.1.1.2" xref="A1.E19.m1.3.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E19.m1.3.3.3.3.3.1.1.4.2" xref="A1.E19.m1.3.3.3.3.3.1.1.cmml"><mo id="A1.E19.m1.3.3.3.3.3.1.1.4.2.1" stretchy="false" xref="A1.E19.m1.3.3.3.3.3.1.1.cmml">(</mo><mi id="A1.E19.m1.3.3.3.3.3.1.1.1" xref="A1.E19.m1.3.3.3.3.3.1.1.1.cmml">k</mi><mo id="A1.E19.m1.3.3.3.3.3.1.1.4.2.2" stretchy="false" xref="A1.E19.m1.3.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></msub><mo fence="false" id="A1.E19.m1.4.4.4.4.4.2.1.1.1" xref="A1.E19.m1.4.4.4.4.4.2.1.1.1.cmml">|</mo><mi id="A1.E19.m1.4.4.4.4.4.2.1.1.3" xref="A1.E19.m1.4.4.4.4.4.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E19.m1.4.4.4.4.4.2.1.3" stretchy="false" xref="A1.E19.m1.4.4.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.E19.m1.6.6.6.6.1.3" xref="A1.E19.m1.6.6.6.7.cmml">)</mo></mrow></mrow><mrow id="A1.E19.m1.12.12.12" xref="A1.E19.m1.12.12.12.cmml"><msubsup id="A1.E19.m1.12.12.12.7" xref="A1.E19.m1.12.12.12.7.cmml"><mo id="A1.E19.m1.12.12.12.7.2.2" xref="A1.E19.m1.12.12.12.7.2.2.cmml">∑</mo><mrow id="A1.E19.m1.12.12.12.7.2.3" xref="A1.E19.m1.12.12.12.7.2.3.cmml"><mi id="A1.E19.m1.12.12.12.7.2.3.2" xref="A1.E19.m1.12.12.12.7.2.3.2.cmml">j</mi><mo id="A1.E19.m1.12.12.12.7.2.3.1" xref="A1.E19.m1.12.12.12.7.2.3.1.cmml">=</mo><mi id="A1.E19.m1.12.12.12.7.2.3.3" xref="A1.E19.m1.12.12.12.7.2.3.3.cmml">k</mi></mrow><mi id="A1.E19.m1.12.12.12.7.3" xref="A1.E19.m1.12.12.12.7.3.cmml">K</mi></msubsup><mrow id="A1.E19.m1.12.12.12.6.1" xref="A1.E19.m1.12.12.12.6.2.cmml"><mi id="A1.E19.m1.11.11.11.5" xref="A1.E19.m1.11.11.11.5.cmml">exp</mi><mo id="A1.E19.m1.12.12.12.6.1a" xref="A1.E19.m1.12.12.12.6.2.cmml">⁡</mo><mrow id="A1.E19.m1.12.12.12.6.1.1" xref="A1.E19.m1.12.12.12.6.2.cmml"><mo id="A1.E19.m1.12.12.12.6.1.1.2" xref="A1.E19.m1.12.12.12.6.2.cmml">(</mo><mrow id="A1.E19.m1.12.12.12.6.1.1.1" xref="A1.E19.m1.12.12.12.6.1.1.1.cmml"><mi id="A1.E19.m1.12.12.12.6.1.1.1.2" xref="A1.E19.m1.12.12.12.6.1.1.1.2.cmml">β</mi><mo id="A1.E19.m1.12.12.12.6.1.1.1.1" lspace="0.167em" xref="A1.E19.m1.12.12.12.6.1.1.1.1.cmml">⁢</mo><mrow id="A1.E19.m1.12.12.12.6.1.1.1.3" xref="A1.E19.m1.12.12.12.6.1.1.1.3.cmml"><mi id="A1.E19.m1.12.12.12.6.1.1.1.3.1" xref="A1.E19.m1.12.12.12.6.1.1.1.3.1.cmml">log</mi><mo id="A1.E19.m1.12.12.12.6.1.1.1.3a" lspace="0.167em" xref="A1.E19.m1.12.12.12.6.1.1.1.3.cmml">⁡</mo><mfrac id="A1.E19.m1.10.10.10.4" xref="A1.E19.m1.10.10.10.4.cmml"><mrow id="A1.E19.m1.8.8.8.2.2" xref="A1.E19.m1.8.8.8.2.2.cmml"><msup id="A1.E19.m1.8.8.8.2.2.4" xref="A1.E19.m1.8.8.8.2.2.4.cmml"><mi id="A1.E19.m1.8.8.8.2.2.4.2" xref="A1.E19.m1.8.8.8.2.2.4.2.cmml">π</mi><mo id="A1.E19.m1.8.8.8.2.2.4.3" xref="A1.E19.m1.8.8.8.2.2.4.3.cmml">*</mo></msup><mo id="A1.E19.m1.8.8.8.2.2.3" xref="A1.E19.m1.8.8.8.2.2.3.cmml">⁢</mo><mrow id="A1.E19.m1.8.8.8.2.2.2.1" xref="A1.E19.m1.8.8.8.2.2.2.1.1.cmml"><mo id="A1.E19.m1.8.8.8.2.2.2.1.2" stretchy="false" xref="A1.E19.m1.8.8.8.2.2.2.1.1.cmml">(</mo><mrow id="A1.E19.m1.8.8.8.2.2.2.1.1" xref="A1.E19.m1.8.8.8.2.2.2.1.1.cmml"><msub id="A1.E19.m1.8.8.8.2.2.2.1.1.2" xref="A1.E19.m1.8.8.8.2.2.2.1.1.2.cmml"><mi id="A1.E19.m1.8.8.8.2.2.2.1.1.2.2" xref="A1.E19.m1.8.8.8.2.2.2.1.1.2.2.cmml">y</mi><mrow id="A1.E19.m1.7.7.7.1.1.1.1" xref="A1.E19.m1.7.7.7.1.1.1.1.cmml"><mi id="A1.E19.m1.7.7.7.1.1.1.1.3" xref="A1.E19.m1.7.7.7.1.1.1.1.3.cmml">τ</mi><mo id="A1.E19.m1.7.7.7.1.1.1.1.2" xref="A1.E19.m1.7.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E19.m1.7.7.7.1.1.1.1.4.2" xref="A1.E19.m1.7.7.7.1.1.1.1.cmml"><mo id="A1.E19.m1.7.7.7.1.1.1.1.4.2.1" stretchy="false" xref="A1.E19.m1.7.7.7.1.1.1.1.cmml">(</mo><mi id="A1.E19.m1.7.7.7.1.1.1.1.1" xref="A1.E19.m1.7.7.7.1.1.1.1.1.cmml">j</mi><mo id="A1.E19.m1.7.7.7.1.1.1.1.4.2.2" stretchy="false" xref="A1.E19.m1.7.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo fence="false" id="A1.E19.m1.8.8.8.2.2.2.1.1.1" xref="A1.E19.m1.8.8.8.2.2.2.1.1.1.cmml">|</mo><mi id="A1.E19.m1.8.8.8.2.2.2.1.1.3" xref="A1.E19.m1.8.8.8.2.2.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E19.m1.8.8.8.2.2.2.1.3" stretchy="false" xref="A1.E19.m1.8.8.8.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E19.m1.10.10.10.4.4" xref="A1.E19.m1.10.10.10.4.4.cmml"><msub id="A1.E19.m1.10.10.10.4.4.4" xref="A1.E19.m1.10.10.10.4.4.4.cmml"><mi id="A1.E19.m1.10.10.10.4.4.4.2" xref="A1.E19.m1.10.10.10.4.4.4.2.cmml">π</mi><mtext id="A1.E19.m1.10.10.10.4.4.4.3" xref="A1.E19.m1.10.10.10.4.4.4.3a.cmml">ref</mtext></msub><mo id="A1.E19.m1.10.10.10.4.4.3" xref="A1.E19.m1.10.10.10.4.4.3.cmml">⁢</mo><mrow id="A1.E19.m1.10.10.10.4.4.2.1" xref="A1.E19.m1.10.10.10.4.4.2.1.1.cmml"><mo id="A1.E19.m1.10.10.10.4.4.2.1.2" stretchy="false" xref="A1.E19.m1.10.10.10.4.4.2.1.1.cmml">(</mo><mrow id="A1.E19.m1.10.10.10.4.4.2.1.1" xref="A1.E19.m1.10.10.10.4.4.2.1.1.cmml"><msub id="A1.E19.m1.10.10.10.4.4.2.1.1.2" xref="A1.E19.m1.10.10.10.4.4.2.1.1.2.cmml"><mi id="A1.E19.m1.10.10.10.4.4.2.1.1.2.2" xref="A1.E19.m1.10.10.10.4.4.2.1.1.2.2.cmml">y</mi><mrow id="A1.E19.m1.9.9.9.3.3.1.1" xref="A1.E19.m1.9.9.9.3.3.1.1.cmml"><mi id="A1.E19.m1.9.9.9.3.3.1.1.3" xref="A1.E19.m1.9.9.9.3.3.1.1.3.cmml">τ</mi><mo id="A1.E19.m1.9.9.9.3.3.1.1.2" xref="A1.E19.m1.9.9.9.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E19.m1.9.9.9.3.3.1.1.4.2" xref="A1.E19.m1.9.9.9.3.3.1.1.cmml"><mo id="A1.E19.m1.9.9.9.3.3.1.1.4.2.1" stretchy="false" xref="A1.E19.m1.9.9.9.3.3.1.1.cmml">(</mo><mi id="A1.E19.m1.9.9.9.3.3.1.1.1" xref="A1.E19.m1.9.9.9.3.3.1.1.1.cmml">j</mi><mo id="A1.E19.m1.9.9.9.3.3.1.1.4.2.2" stretchy="false" xref="A1.E19.m1.9.9.9.3.3.1.1.cmml">)</mo></mrow></mrow></msub><mo fence="false" id="A1.E19.m1.10.10.10.4.4.2.1.1.1" xref="A1.E19.m1.10.10.10.4.4.2.1.1.1.cmml">|</mo><mi id="A1.E19.m1.10.10.10.4.4.2.1.1.3" xref="A1.E19.m1.10.10.10.4.4.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E19.m1.10.10.10.4.4.2.1.3" stretchy="false" xref="A1.E19.m1.10.10.10.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.E19.m1.12.12.12.6.1.1.3" xref="A1.E19.m1.12.12.12.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E19.m1.15b"><apply id="A1.E19.m1.15.15.cmml" xref="A1.E19.m1.15.15"><eq id="A1.E19.m1.15.15.2.cmml" xref="A1.E19.m1.15.15.2"></eq><apply id="A1.E19.m1.15.15.1.cmml" xref="A1.E19.m1.15.15.1"><times id="A1.E19.m1.15.15.1.2.cmml" xref="A1.E19.m1.15.15.1.2"></times><apply id="A1.E19.m1.15.15.1.3.cmml" xref="A1.E19.m1.15.15.1.3"><csymbol cd="ambiguous" id="A1.E19.m1.15.15.1.3.1.cmml" xref="A1.E19.m1.15.15.1.3">superscript</csymbol><ci id="A1.E19.m1.15.15.1.3.2.cmml" xref="A1.E19.m1.15.15.1.3.2">𝑝</ci><times id="A1.E19.m1.15.15.1.3.3.cmml" xref="A1.E19.m1.15.15.1.3.3"></times></apply><apply id="A1.E19.m1.15.15.1.1.1.1.cmml" xref="A1.E19.m1.15.15.1.1.1"><csymbol cd="latexml" id="A1.E19.m1.15.15.1.1.1.1.3.cmml" xref="A1.E19.m1.15.15.1.1.1.1.3">conditional</csymbol><ci id="A1.E19.m1.15.15.1.1.1.1.4.cmml" xref="A1.E19.m1.15.15.1.1.1.1.4">𝜏</ci><list id="A1.E19.m1.15.15.1.1.1.1.2.3.cmml" xref="A1.E19.m1.15.15.1.1.1.1.2.2"><apply id="A1.E19.m1.15.15.1.1.1.1.1.1.1.cmml" xref="A1.E19.m1.15.15.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E19.m1.15.15.1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m1.15.15.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E19.m1.15.15.1.1.1.1.1.1.1.2.cmml" xref="A1.E19.m1.15.15.1.1.1.1.1.1.1.2">𝑦</ci><cn id="A1.E19.m1.15.15.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E19.m1.15.15.1.1.1.1.1.1.1.3">1</cn></apply><ci id="A1.E19.m1.13.13.cmml" xref="A1.E19.m1.13.13">…</ci><apply id="A1.E19.m1.15.15.1.1.1.1.2.2.2.cmml" xref="A1.E19.m1.15.15.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E19.m1.15.15.1.1.1.1.2.2.2.1.cmml" xref="A1.E19.m1.15.15.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E19.m1.15.15.1.1.1.1.2.2.2.2.cmml" xref="A1.E19.m1.15.15.1.1.1.1.2.2.2.2">𝑦</ci><ci id="A1.E19.m1.15.15.1.1.1.1.2.2.2.3.cmml" xref="A1.E19.m1.15.15.1.1.1.1.2.2.2.3">𝐾</ci></apply><ci id="A1.E19.m1.14.14.cmml" xref="A1.E19.m1.14.14">𝑥</ci></list></apply></apply><apply id="A1.E19.m1.15.15.3.cmml" xref="A1.E19.m1.15.15.3"><apply id="A1.E19.m1.15.15.3.1.cmml" xref="A1.E19.m1.15.15.3.1"><csymbol cd="ambiguous" id="A1.E19.m1.15.15.3.1.1.cmml" xref="A1.E19.m1.15.15.3.1">superscript</csymbol><apply id="A1.E19.m1.15.15.3.1.2.cmml" xref="A1.E19.m1.15.15.3.1"><csymbol cd="ambiguous" id="A1.E19.m1.15.15.3.1.2.1.cmml" xref="A1.E19.m1.15.15.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.E19.m1.15.15.3.1.2.2.cmml" xref="A1.E19.m1.15.15.3.1.2.2">product</csymbol><apply id="A1.E19.m1.15.15.3.1.2.3.cmml" xref="A1.E19.m1.15.15.3.1.2.3"><eq id="A1.E19.m1.15.15.3.1.2.3.1.cmml" xref="A1.E19.m1.15.15.3.1.2.3.1"></eq><ci id="A1.E19.m1.15.15.3.1.2.3.2.cmml" xref="A1.E19.m1.15.15.3.1.2.3.2">𝑘</ci><cn id="A1.E19.m1.15.15.3.1.2.3.3.cmml" type="integer" xref="A1.E19.m1.15.15.3.1.2.3.3">1</cn></apply></apply><ci id="A1.E19.m1.15.15.3.1.3.cmml" xref="A1.E19.m1.15.15.3.1.3">𝐾</ci></apply><apply id="A1.E19.m1.12.12.cmml" xref="A1.E19.m1.12.12"><divide id="A1.E19.m1.12.12.13.cmml" xref="A1.E19.m1.12.12"></divide><apply id="A1.E19.m1.6.6.6.7.cmml" xref="A1.E19.m1.6.6.6.6"><exp id="A1.E19.m1.5.5.5.5.cmml" xref="A1.E19.m1.5.5.5.5"></exp><apply id="A1.E19.m1.6.6.6.6.1.1.cmml" xref="A1.E19.m1.6.6.6.6.1.1"><times id="A1.E19.m1.6.6.6.6.1.1.1.cmml" xref="A1.E19.m1.6.6.6.6.1.1.1"></times><ci id="A1.E19.m1.6.6.6.6.1.1.2.cmml" xref="A1.E19.m1.6.6.6.6.1.1.2">𝛽</ci><apply id="A1.E19.m1.6.6.6.6.1.1.3.cmml" xref="A1.E19.m1.6.6.6.6.1.1.3"><log id="A1.E19.m1.6.6.6.6.1.1.3.1.cmml" xref="A1.E19.m1.6.6.6.6.1.1.3.1"></log><apply id="A1.E19.m1.4.4.4.4.cmml" xref="A1.E19.m1.4.4.4.4"><divide id="A1.E19.m1.4.4.4.4.5.cmml" xref="A1.E19.m1.4.4.4.4"></divide><apply id="A1.E19.m1.2.2.2.2.2.cmml" xref="A1.E19.m1.2.2.2.2.2"><times id="A1.E19.m1.2.2.2.2.2.3.cmml" xref="A1.E19.m1.2.2.2.2.2.3"></times><apply id="A1.E19.m1.2.2.2.2.2.4.cmml" xref="A1.E19.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="A1.E19.m1.2.2.2.2.2.4.1.cmml" xref="A1.E19.m1.2.2.2.2.2.4">superscript</csymbol><ci id="A1.E19.m1.2.2.2.2.2.4.2.cmml" xref="A1.E19.m1.2.2.2.2.2.4.2">𝜋</ci><times id="A1.E19.m1.2.2.2.2.2.4.3.cmml" xref="A1.E19.m1.2.2.2.2.2.4.3"></times></apply><apply id="A1.E19.m1.2.2.2.2.2.2.1.1.cmml" xref="A1.E19.m1.2.2.2.2.2.2.1"><csymbol cd="latexml" id="A1.E19.m1.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E19.m1.2.2.2.2.2.2.1.1.1">conditional</csymbol><apply id="A1.E19.m1.2.2.2.2.2.2.1.1.2.cmml" xref="A1.E19.m1.2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E19.m1.2.2.2.2.2.2.1.1.2.1.cmml" xref="A1.E19.m1.2.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="A1.E19.m1.2.2.2.2.2.2.1.1.2.2.cmml" xref="A1.E19.m1.2.2.2.2.2.2.1.1.2.2">𝑦</ci><apply id="A1.E19.m1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1"><times id="A1.E19.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.2"></times><ci id="A1.E19.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.3">𝜏</ci><ci id="A1.E19.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m1.1.1.1.1.1.1.1.1">𝑘</ci></apply></apply><ci id="A1.E19.m1.2.2.2.2.2.2.1.1.3.cmml" xref="A1.E19.m1.2.2.2.2.2.2.1.1.3">𝑥</ci></apply></apply><apply id="A1.E19.m1.4.4.4.4.4.cmml" xref="A1.E19.m1.4.4.4.4.4"><times id="A1.E19.m1.4.4.4.4.4.3.cmml" xref="A1.E19.m1.4.4.4.4.4.3"></times><apply id="A1.E19.m1.4.4.4.4.4.4.cmml" xref="A1.E19.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="A1.E19.m1.4.4.4.4.4.4.1.cmml" xref="A1.E19.m1.4.4.4.4.4.4">subscript</csymbol><ci id="A1.E19.m1.4.4.4.4.4.4.2.cmml" xref="A1.E19.m1.4.4.4.4.4.4.2">𝜋</ci><ci id="A1.E19.m1.4.4.4.4.4.4.3a.cmml" xref="A1.E19.m1.4.4.4.4.4.4.3"><mtext id="A1.E19.m1.4.4.4.4.4.4.3.cmml" mathsize="50%" xref="A1.E19.m1.4.4.4.4.4.4.3">ref</mtext></ci></apply><apply id="A1.E19.m1.4.4.4.4.4.2.1.1.cmml" xref="A1.E19.m1.4.4.4.4.4.2.1"><csymbol cd="latexml" id="A1.E19.m1.4.4.4.4.4.2.1.1.1.cmml" xref="A1.E19.m1.4.4.4.4.4.2.1.1.1">conditional</csymbol><apply id="A1.E19.m1.4.4.4.4.4.2.1.1.2.cmml" xref="A1.E19.m1.4.4.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="A1.E19.m1.4.4.4.4.4.2.1.1.2.1.cmml" xref="A1.E19.m1.4.4.4.4.4.2.1.1.2">subscript</csymbol><ci id="A1.E19.m1.4.4.4.4.4.2.1.1.2.2.cmml" xref="A1.E19.m1.4.4.4.4.4.2.1.1.2.2">𝑦</ci><apply id="A1.E19.m1.3.3.3.3.3.1.1.cmml" xref="A1.E19.m1.3.3.3.3.3.1.1"><times id="A1.E19.m1.3.3.3.3.3.1.1.2.cmml" xref="A1.E19.m1.3.3.3.3.3.1.1.2"></times><ci id="A1.E19.m1.3.3.3.3.3.1.1.3.cmml" xref="A1.E19.m1.3.3.3.3.3.1.1.3">𝜏</ci><ci id="A1.E19.m1.3.3.3.3.3.1.1.1.cmml" xref="A1.E19.m1.3.3.3.3.3.1.1.1">𝑘</ci></apply></apply><ci id="A1.E19.m1.4.4.4.4.4.2.1.1.3.cmml" xref="A1.E19.m1.4.4.4.4.4.2.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E19.m1.12.12.12.cmml" xref="A1.E19.m1.12.12.12"><apply id="A1.E19.m1.12.12.12.7.cmml" xref="A1.E19.m1.12.12.12.7"><csymbol cd="ambiguous" id="A1.E19.m1.12.12.12.7.1.cmml" xref="A1.E19.m1.12.12.12.7">superscript</csymbol><apply id="A1.E19.m1.12.12.12.7.2.cmml" xref="A1.E19.m1.12.12.12.7"><csymbol cd="ambiguous" id="A1.E19.m1.12.12.12.7.2.1.cmml" xref="A1.E19.m1.12.12.12.7">subscript</csymbol><sum id="A1.E19.m1.12.12.12.7.2.2.cmml" xref="A1.E19.m1.12.12.12.7.2.2"></sum><apply id="A1.E19.m1.12.12.12.7.2.3.cmml" xref="A1.E19.m1.12.12.12.7.2.3"><eq id="A1.E19.m1.12.12.12.7.2.3.1.cmml" xref="A1.E19.m1.12.12.12.7.2.3.1"></eq><ci id="A1.E19.m1.12.12.12.7.2.3.2.cmml" xref="A1.E19.m1.12.12.12.7.2.3.2">𝑗</ci><ci id="A1.E19.m1.12.12.12.7.2.3.3.cmml" xref="A1.E19.m1.12.12.12.7.2.3.3">𝑘</ci></apply></apply><ci id="A1.E19.m1.12.12.12.7.3.cmml" xref="A1.E19.m1.12.12.12.7.3">𝐾</ci></apply><apply id="A1.E19.m1.12.12.12.6.2.cmml" xref="A1.E19.m1.12.12.12.6.1"><exp id="A1.E19.m1.11.11.11.5.cmml" xref="A1.E19.m1.11.11.11.5"></exp><apply id="A1.E19.m1.12.12.12.6.1.1.1.cmml" xref="A1.E19.m1.12.12.12.6.1.1.1"><times id="A1.E19.m1.12.12.12.6.1.1.1.1.cmml" xref="A1.E19.m1.12.12.12.6.1.1.1.1"></times><ci id="A1.E19.m1.12.12.12.6.1.1.1.2.cmml" xref="A1.E19.m1.12.12.12.6.1.1.1.2">𝛽</ci><apply id="A1.E19.m1.12.12.12.6.1.1.1.3.cmml" xref="A1.E19.m1.12.12.12.6.1.1.1.3"><log id="A1.E19.m1.12.12.12.6.1.1.1.3.1.cmml" xref="A1.E19.m1.12.12.12.6.1.1.1.3.1"></log><apply id="A1.E19.m1.10.10.10.4.cmml" xref="A1.E19.m1.10.10.10.4"><divide id="A1.E19.m1.10.10.10.4.5.cmml" xref="A1.E19.m1.10.10.10.4"></divide><apply id="A1.E19.m1.8.8.8.2.2.cmml" xref="A1.E19.m1.8.8.8.2.2"><times id="A1.E19.m1.8.8.8.2.2.3.cmml" xref="A1.E19.m1.8.8.8.2.2.3"></times><apply id="A1.E19.m1.8.8.8.2.2.4.cmml" xref="A1.E19.m1.8.8.8.2.2.4"><csymbol cd="ambiguous" id="A1.E19.m1.8.8.8.2.2.4.1.cmml" xref="A1.E19.m1.8.8.8.2.2.4">superscript</csymbol><ci id="A1.E19.m1.8.8.8.2.2.4.2.cmml" xref="A1.E19.m1.8.8.8.2.2.4.2">𝜋</ci><times id="A1.E19.m1.8.8.8.2.2.4.3.cmml" xref="A1.E19.m1.8.8.8.2.2.4.3"></times></apply><apply id="A1.E19.m1.8.8.8.2.2.2.1.1.cmml" xref="A1.E19.m1.8.8.8.2.2.2.1"><csymbol cd="latexml" id="A1.E19.m1.8.8.8.2.2.2.1.1.1.cmml" xref="A1.E19.m1.8.8.8.2.2.2.1.1.1">conditional</csymbol><apply id="A1.E19.m1.8.8.8.2.2.2.1.1.2.cmml" xref="A1.E19.m1.8.8.8.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E19.m1.8.8.8.2.2.2.1.1.2.1.cmml" xref="A1.E19.m1.8.8.8.2.2.2.1.1.2">subscript</csymbol><ci id="A1.E19.m1.8.8.8.2.2.2.1.1.2.2.cmml" xref="A1.E19.m1.8.8.8.2.2.2.1.1.2.2">𝑦</ci><apply id="A1.E19.m1.7.7.7.1.1.1.1.cmml" xref="A1.E19.m1.7.7.7.1.1.1.1"><times id="A1.E19.m1.7.7.7.1.1.1.1.2.cmml" xref="A1.E19.m1.7.7.7.1.1.1.1.2"></times><ci id="A1.E19.m1.7.7.7.1.1.1.1.3.cmml" xref="A1.E19.m1.7.7.7.1.1.1.1.3">𝜏</ci><ci id="A1.E19.m1.7.7.7.1.1.1.1.1.cmml" xref="A1.E19.m1.7.7.7.1.1.1.1.1">𝑗</ci></apply></apply><ci id="A1.E19.m1.8.8.8.2.2.2.1.1.3.cmml" xref="A1.E19.m1.8.8.8.2.2.2.1.1.3">𝑥</ci></apply></apply><apply id="A1.E19.m1.10.10.10.4.4.cmml" xref="A1.E19.m1.10.10.10.4.4"><times id="A1.E19.m1.10.10.10.4.4.3.cmml" xref="A1.E19.m1.10.10.10.4.4.3"></times><apply id="A1.E19.m1.10.10.10.4.4.4.cmml" xref="A1.E19.m1.10.10.10.4.4.4"><csymbol cd="ambiguous" id="A1.E19.m1.10.10.10.4.4.4.1.cmml" xref="A1.E19.m1.10.10.10.4.4.4">subscript</csymbol><ci id="A1.E19.m1.10.10.10.4.4.4.2.cmml" xref="A1.E19.m1.10.10.10.4.4.4.2">𝜋</ci><ci id="A1.E19.m1.10.10.10.4.4.4.3a.cmml" xref="A1.E19.m1.10.10.10.4.4.4.3"><mtext id="A1.E19.m1.10.10.10.4.4.4.3.cmml" mathsize="50%" xref="A1.E19.m1.10.10.10.4.4.4.3">ref</mtext></ci></apply><apply id="A1.E19.m1.10.10.10.4.4.2.1.1.cmml" xref="A1.E19.m1.10.10.10.4.4.2.1"><csymbol cd="latexml" id="A1.E19.m1.10.10.10.4.4.2.1.1.1.cmml" xref="A1.E19.m1.10.10.10.4.4.2.1.1.1">conditional</csymbol><apply id="A1.E19.m1.10.10.10.4.4.2.1.1.2.cmml" xref="A1.E19.m1.10.10.10.4.4.2.1.1.2"><csymbol cd="ambiguous" id="A1.E19.m1.10.10.10.4.4.2.1.1.2.1.cmml" xref="A1.E19.m1.10.10.10.4.4.2.1.1.2">subscript</csymbol><ci id="A1.E19.m1.10.10.10.4.4.2.1.1.2.2.cmml" xref="A1.E19.m1.10.10.10.4.4.2.1.1.2.2">𝑦</ci><apply id="A1.E19.m1.9.9.9.3.3.1.1.cmml" xref="A1.E19.m1.9.9.9.3.3.1.1"><times id="A1.E19.m1.9.9.9.3.3.1.1.2.cmml" xref="A1.E19.m1.9.9.9.3.3.1.1.2"></times><ci id="A1.E19.m1.9.9.9.3.3.1.1.3.cmml" xref="A1.E19.m1.9.9.9.3.3.1.1.3">𝜏</ci><ci id="A1.E19.m1.9.9.9.3.3.1.1.1.cmml" xref="A1.E19.m1.9.9.9.3.3.1.1.1">𝑗</ci></apply></apply><ci id="A1.E19.m1.10.10.10.4.4.2.1.1.3.cmml" xref="A1.E19.m1.10.10.10.4.4.2.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E19.m1.15c">p^{*}(\tau|y_{1},\ldots,y_{K},x)=\prod_{k=1}^{K}\frac{\exp\left(\beta\log\frac%
{\pi^{*}(y_{\tau(k)}|x)}{\pi_{\text{ref}}(y_{\tau(k)}|x)}\right)}{\sum_{j=k}^{%
K}\exp\left(\beta\log\frac{\pi^{*}(y_{\tau(j)}|x)}{\pi_{\text{ref}}(y_{\tau(j)%
}|x)}\right)}</annotation><annotation encoding="application/x-llamapun" id="A1.E19.m1.15d">italic_p start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_τ | italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_x ) = ∏ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG roman_exp ( italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_τ ( italic_k ) end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_τ ( italic_k ) end_POSTSUBSCRIPT | italic_x ) end_ARG ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_τ ( italic_j ) end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_τ ( italic_j ) end_POSTSUBSCRIPT | italic_x ) end_ARG ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS3.p3">
<p class="ltx_p" id="A1.SS3.p3.1">섹션 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4" title="4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>의 접근법과 유사하게, 프롬프트 및 사용자 지정 순위의 데이터세트 <math alttext="\mathcal{D}=\{\tau^{(i)},y_{1}^{(i)},\ldots,y_{K}^{(i)},x^{(i)}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="A1.SS3.p3.1.m1.9"><semantics id="A1.SS3.p3.1.m1.9a"><mrow id="A1.SS3.p3.1.m1.9.9" xref="A1.SS3.p3.1.m1.9.9.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS3.p3.1.m1.9.9.6" xref="A1.SS3.p3.1.m1.9.9.6.cmml">𝒟</mi><mo id="A1.SS3.p3.1.m1.9.9.5" xref="A1.SS3.p3.1.m1.9.9.5.cmml">=</mo><msubsup id="A1.SS3.p3.1.m1.9.9.4" xref="A1.SS3.p3.1.m1.9.9.4.cmml"><mrow id="A1.SS3.p3.1.m1.9.9.4.4.4.4" xref="A1.SS3.p3.1.m1.9.9.4.4.4.5.cmml"><mo id="A1.SS3.p3.1.m1.9.9.4.4.4.4.5" stretchy="false" xref="A1.SS3.p3.1.m1.9.9.4.4.4.5.cmml">{</mo><msup id="A1.SS3.p3.1.m1.6.6.1.1.1.1.1" xref="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.cmml"><mi id="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.2" xref="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.2.cmml">τ</mi><mrow id="A1.SS3.p3.1.m1.1.1.1.3" xref="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.cmml"><mo id="A1.SS3.p3.1.m1.1.1.1.3.1" stretchy="false" xref="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.cmml">(</mo><mi id="A1.SS3.p3.1.m1.1.1.1.1" xref="A1.SS3.p3.1.m1.1.1.1.1.cmml">i</mi><mo id="A1.SS3.p3.1.m1.1.1.1.3.2" stretchy="false" xref="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A1.SS3.p3.1.m1.9.9.4.4.4.4.6" xref="A1.SS3.p3.1.m1.9.9.4.4.4.5.cmml">,</mo><msubsup id="A1.SS3.p3.1.m1.7.7.2.2.2.2.2" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.cmml"><mi id="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.2" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.2.cmml">y</mi><mn id="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.3" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.3.cmml">1</mn><mrow id="A1.SS3.p3.1.m1.2.2.1.3" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.cmml"><mo id="A1.SS3.p3.1.m1.2.2.1.3.1" stretchy="false" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.cmml">(</mo><mi id="A1.SS3.p3.1.m1.2.2.1.1" xref="A1.SS3.p3.1.m1.2.2.1.1.cmml">i</mi><mo id="A1.SS3.p3.1.m1.2.2.1.3.2" stretchy="false" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.SS3.p3.1.m1.9.9.4.4.4.4.7" xref="A1.SS3.p3.1.m1.9.9.4.4.4.5.cmml">,</mo><mi id="A1.SS3.p3.1.m1.5.5" mathvariant="normal" xref="A1.SS3.p3.1.m1.5.5.cmml">…</mi><mo id="A1.SS3.p3.1.m1.9.9.4.4.4.4.8" xref="A1.SS3.p3.1.m1.9.9.4.4.4.5.cmml">,</mo><msubsup id="A1.SS3.p3.1.m1.8.8.3.3.3.3.3" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.cmml"><mi id="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.2" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.2.cmml">y</mi><mi id="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.3" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.3.cmml">K</mi><mrow id="A1.SS3.p3.1.m1.3.3.1.3" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.cmml"><mo id="A1.SS3.p3.1.m1.3.3.1.3.1" stretchy="false" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.cmml">(</mo><mi id="A1.SS3.p3.1.m1.3.3.1.1" xref="A1.SS3.p3.1.m1.3.3.1.1.cmml">i</mi><mo id="A1.SS3.p3.1.m1.3.3.1.3.2" stretchy="false" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="A1.SS3.p3.1.m1.9.9.4.4.4.4.9" xref="A1.SS3.p3.1.m1.9.9.4.4.4.5.cmml">,</mo><msup id="A1.SS3.p3.1.m1.9.9.4.4.4.4.4" xref="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.cmml"><mi id="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.2" xref="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.2.cmml">x</mi><mrow id="A1.SS3.p3.1.m1.4.4.1.3" xref="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.cmml"><mo id="A1.SS3.p3.1.m1.4.4.1.3.1" stretchy="false" xref="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.cmml">(</mo><mi id="A1.SS3.p3.1.m1.4.4.1.1" xref="A1.SS3.p3.1.m1.4.4.1.1.cmml">i</mi><mo id="A1.SS3.p3.1.m1.4.4.1.3.2" stretchy="false" xref="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.cmml">)</mo></mrow></msup><mo id="A1.SS3.p3.1.m1.9.9.4.4.4.4.10" stretchy="false" xref="A1.SS3.p3.1.m1.9.9.4.4.4.5.cmml">}</mo></mrow><mrow id="A1.SS3.p3.1.m1.9.9.4.4.6" xref="A1.SS3.p3.1.m1.9.9.4.4.6.cmml"><mi id="A1.SS3.p3.1.m1.9.9.4.4.6.2" xref="A1.SS3.p3.1.m1.9.9.4.4.6.2.cmml">i</mi><mo id="A1.SS3.p3.1.m1.9.9.4.4.6.1" xref="A1.SS3.p3.1.m1.9.9.4.4.6.1.cmml">=</mo><mn id="A1.SS3.p3.1.m1.9.9.4.4.6.3" xref="A1.SS3.p3.1.m1.9.9.4.4.6.3.cmml">1</mn></mrow><mi id="A1.SS3.p3.1.m1.9.9.4.6" xref="A1.SS3.p3.1.m1.9.9.4.6.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p3.1.m1.9b"><apply id="A1.SS3.p3.1.m1.9.9.cmml" xref="A1.SS3.p3.1.m1.9.9"><eq id="A1.SS3.p3.1.m1.9.9.5.cmml" xref="A1.SS3.p3.1.m1.9.9.5"></eq><ci id="A1.SS3.p3.1.m1.9.9.6.cmml" xref="A1.SS3.p3.1.m1.9.9.6">𝒟</ci><apply id="A1.SS3.p3.1.m1.9.9.4.cmml" xref="A1.SS3.p3.1.m1.9.9.4"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.9.9.4.5.cmml" xref="A1.SS3.p3.1.m1.9.9.4">superscript</csymbol><apply id="A1.SS3.p3.1.m1.9.9.4.4.cmml" xref="A1.SS3.p3.1.m1.9.9.4"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.9.9.4.4.5.cmml" xref="A1.SS3.p3.1.m1.9.9.4">subscript</csymbol><set id="A1.SS3.p3.1.m1.9.9.4.4.4.5.cmml" xref="A1.SS3.p3.1.m1.9.9.4.4.4.4"><apply id="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.cmml" xref="A1.SS3.p3.1.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.1.cmml" xref="A1.SS3.p3.1.m1.6.6.1.1.1.1.1">superscript</csymbol><ci id="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.SS3.p3.1.m1.6.6.1.1.1.1.1.2">𝜏</ci><ci id="A1.SS3.p3.1.m1.1.1.1.1.cmml" xref="A1.SS3.p3.1.m1.1.1.1.1">𝑖</ci></apply><apply id="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.cmml" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.1.cmml" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2">superscript</csymbol><apply id="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.cmml" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.1.cmml" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2">subscript</csymbol><ci id="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.2.cmml" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.2">𝑦</ci><cn id="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.3.cmml" type="integer" xref="A1.SS3.p3.1.m1.7.7.2.2.2.2.2.2.3">1</cn></apply><ci id="A1.SS3.p3.1.m1.2.2.1.1.cmml" xref="A1.SS3.p3.1.m1.2.2.1.1">𝑖</ci></apply><ci id="A1.SS3.p3.1.m1.5.5.cmml" xref="A1.SS3.p3.1.m1.5.5">…</ci><apply id="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.cmml" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.1.cmml" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3">superscript</csymbol><apply id="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.cmml" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.1.cmml" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3">subscript</csymbol><ci id="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.2.cmml" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.2">𝑦</ci><ci id="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.3.cmml" xref="A1.SS3.p3.1.m1.8.8.3.3.3.3.3.2.3">𝐾</ci></apply><ci id="A1.SS3.p3.1.m1.3.3.1.1.cmml" xref="A1.SS3.p3.1.m1.3.3.1.1">𝑖</ci></apply><apply id="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.cmml" xref="A1.SS3.p3.1.m1.9.9.4.4.4.4.4"><csymbol cd="ambiguous" id="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.1.cmml" xref="A1.SS3.p3.1.m1.9.9.4.4.4.4.4">superscript</csymbol><ci id="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.2.cmml" xref="A1.SS3.p3.1.m1.9.9.4.4.4.4.4.2">𝑥</ci><ci id="A1.SS3.p3.1.m1.4.4.1.1.cmml" xref="A1.SS3.p3.1.m1.4.4.1.1">𝑖</ci></apply></set><apply id="A1.SS3.p3.1.m1.9.9.4.4.6.cmml" xref="A1.SS3.p3.1.m1.9.9.4.4.6"><eq id="A1.SS3.p3.1.m1.9.9.4.4.6.1.cmml" xref="A1.SS3.p3.1.m1.9.9.4.4.6.1"></eq><ci id="A1.SS3.p3.1.m1.9.9.4.4.6.2.cmml" xref="A1.SS3.p3.1.m1.9.9.4.4.6.2">𝑖</ci><cn id="A1.SS3.p3.1.m1.9.9.4.4.6.3.cmml" type="integer" xref="A1.SS3.p3.1.m1.9.9.4.4.6.3">1</cn></apply></apply><ci id="A1.SS3.p3.1.m1.9.9.4.6.cmml" xref="A1.SS3.p3.1.m1.9.9.4.6">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p3.1.m1.9c">\mathcal{D}=\{\tau^{(i)},y_{1}^{(i)},\ldots,y_{K}^{(i)},x^{(i)}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p3.1.m1.9d">caligraphic_D = { italic_τ start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>에 대한 액세스를 갖는 경우, 파라미터화된 모델을 사용할 수 있고 이 목적을 최대 우도로 최적화할 수 있다:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{DPO}}(\pi_{\theta},\pi_{\text{ref}})=-\mathbb{E}_{\tau,y_{1%
},\ldots,y_{K},x\sim\mathcal{D}}\left[\log\prod_{k=1}^{K}\frac{\exp\left(\beta%
\log\frac{\pi_{\theta}(y_{\tau(k)}|x)}{\pi_{\text{ref}}(y_{\tau(k)}|x)}\right)%
}{\sum_{j=k}^{K}\exp\left(\beta\log\frac{\pi_{\theta}(y_{\tau(j)}|x)}{\pi_{%
\text{ref}}(y_{\tau(j)}|x)}\right)}\right]" class="ltx_Math" display="block" id="A1.E20.m1.20"><semantics id="A1.E20.m1.20a"><mrow id="A1.E20.m1.20.20" xref="A1.E20.m1.20.20.cmml"><mrow id="A1.E20.m1.19.19.2" xref="A1.E20.m1.19.19.2.cmml"><msub id="A1.E20.m1.19.19.2.4" xref="A1.E20.m1.19.19.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E20.m1.19.19.2.4.2" xref="A1.E20.m1.19.19.2.4.2.cmml">ℒ</mi><mtext id="A1.E20.m1.19.19.2.4.3" xref="A1.E20.m1.19.19.2.4.3a.cmml">DPO</mtext></msub><mo id="A1.E20.m1.19.19.2.3" xref="A1.E20.m1.19.19.2.3.cmml">⁢</mo><mrow id="A1.E20.m1.19.19.2.2.2" xref="A1.E20.m1.19.19.2.2.3.cmml"><mo id="A1.E20.m1.19.19.2.2.2.3" stretchy="false" xref="A1.E20.m1.19.19.2.2.3.cmml">(</mo><msub id="A1.E20.m1.18.18.1.1.1.1" xref="A1.E20.m1.18.18.1.1.1.1.cmml"><mi id="A1.E20.m1.18.18.1.1.1.1.2" xref="A1.E20.m1.18.18.1.1.1.1.2.cmml">π</mi><mi id="A1.E20.m1.18.18.1.1.1.1.3" xref="A1.E20.m1.18.18.1.1.1.1.3.cmml">θ</mi></msub><mo id="A1.E20.m1.19.19.2.2.2.4" xref="A1.E20.m1.19.19.2.2.3.cmml">,</mo><msub id="A1.E20.m1.19.19.2.2.2.2" xref="A1.E20.m1.19.19.2.2.2.2.cmml"><mi id="A1.E20.m1.19.19.2.2.2.2.2" xref="A1.E20.m1.19.19.2.2.2.2.2.cmml">π</mi><mtext id="A1.E20.m1.19.19.2.2.2.2.3" xref="A1.E20.m1.19.19.2.2.2.2.3a.cmml">ref</mtext></msub><mo id="A1.E20.m1.19.19.2.2.2.5" stretchy="false" xref="A1.E20.m1.19.19.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E20.m1.20.20.4" xref="A1.E20.m1.20.20.4.cmml">=</mo><mrow id="A1.E20.m1.20.20.3" xref="A1.E20.m1.20.20.3.cmml"><mo id="A1.E20.m1.20.20.3a" xref="A1.E20.m1.20.20.3.cmml">−</mo><mrow id="A1.E20.m1.20.20.3.1" xref="A1.E20.m1.20.20.3.1.cmml"><msub id="A1.E20.m1.20.20.3.1.3" xref="A1.E20.m1.20.20.3.1.3.cmml"><mi id="A1.E20.m1.20.20.3.1.3.2" xref="A1.E20.m1.20.20.3.1.3.2.cmml">𝔼</mi><mrow id="A1.E20.m1.5.5.5" xref="A1.E20.m1.5.5.5.cmml"><mrow id="A1.E20.m1.5.5.5.5.2" xref="A1.E20.m1.5.5.5.5.3.cmml"><mi id="A1.E20.m1.1.1.1.1" xref="A1.E20.m1.1.1.1.1.cmml">τ</mi><mo id="A1.E20.m1.5.5.5.5.2.3" xref="A1.E20.m1.5.5.5.5.3.cmml">,</mo><msub id="A1.E20.m1.4.4.4.4.1.1" xref="A1.E20.m1.4.4.4.4.1.1.cmml"><mi id="A1.E20.m1.4.4.4.4.1.1.2" xref="A1.E20.m1.4.4.4.4.1.1.2.cmml">y</mi><mn id="A1.E20.m1.4.4.4.4.1.1.3" xref="A1.E20.m1.4.4.4.4.1.1.3.cmml">1</mn></msub><mo id="A1.E20.m1.5.5.5.5.2.4" xref="A1.E20.m1.5.5.5.5.3.cmml">,</mo><mi id="A1.E20.m1.2.2.2.2" mathvariant="normal" xref="A1.E20.m1.2.2.2.2.cmml">…</mi><mo id="A1.E20.m1.5.5.5.5.2.5" xref="A1.E20.m1.5.5.5.5.3.cmml">,</mo><msub id="A1.E20.m1.5.5.5.5.2.2" xref="A1.E20.m1.5.5.5.5.2.2.cmml"><mi id="A1.E20.m1.5.5.5.5.2.2.2" xref="A1.E20.m1.5.5.5.5.2.2.2.cmml">y</mi><mi id="A1.E20.m1.5.5.5.5.2.2.3" xref="A1.E20.m1.5.5.5.5.2.2.3.cmml">K</mi></msub><mo id="A1.E20.m1.5.5.5.5.2.6" xref="A1.E20.m1.5.5.5.5.3.cmml">,</mo><mi id="A1.E20.m1.3.3.3.3" xref="A1.E20.m1.3.3.3.3.cmml">x</mi></mrow><mo id="A1.E20.m1.5.5.5.6" xref="A1.E20.m1.5.5.5.6.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E20.m1.5.5.5.7" xref="A1.E20.m1.5.5.5.7.cmml">𝒟</mi></mrow></msub><mo id="A1.E20.m1.20.20.3.1.2" xref="A1.E20.m1.20.20.3.1.2.cmml">⁢</mo><mrow id="A1.E20.m1.20.20.3.1.1.1" xref="A1.E20.m1.20.20.3.1.1.2.cmml"><mo id="A1.E20.m1.20.20.3.1.1.1.2" xref="A1.E20.m1.20.20.3.1.1.2.1.cmml">[</mo><mrow id="A1.E20.m1.20.20.3.1.1.1.1" xref="A1.E20.m1.20.20.3.1.1.1.1.cmml"><mi id="A1.E20.m1.20.20.3.1.1.1.1.2" xref="A1.E20.m1.20.20.3.1.1.1.1.2.cmml">log</mi><mo id="A1.E20.m1.20.20.3.1.1.1.1.1" xref="A1.E20.m1.20.20.3.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.E20.m1.20.20.3.1.1.1.1.3" xref="A1.E20.m1.20.20.3.1.1.1.1.3.cmml"><munderover id="A1.E20.m1.20.20.3.1.1.1.1.3.1" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.cmml"><mo id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.2" movablelimits="false" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.2.cmml">∏</mo><mrow id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.cmml"><mi id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.2" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.1" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.3" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E20.m1.20.20.3.1.1.1.1.3.1.3" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.3.cmml">K</mi></munderover><mfrac id="A1.E20.m1.17.17" xref="A1.E20.m1.17.17.cmml"><mrow id="A1.E20.m1.11.11.6.6" xref="A1.E20.m1.11.11.6.7.cmml"><mi id="A1.E20.m1.10.10.5.5" xref="A1.E20.m1.10.10.5.5.cmml">exp</mi><mo id="A1.E20.m1.11.11.6.6a" xref="A1.E20.m1.11.11.6.7.cmml">⁡</mo><mrow id="A1.E20.m1.11.11.6.6.1" xref="A1.E20.m1.11.11.6.7.cmml"><mo id="A1.E20.m1.11.11.6.6.1.2" xref="A1.E20.m1.11.11.6.7.cmml">(</mo><mrow id="A1.E20.m1.11.11.6.6.1.1" xref="A1.E20.m1.11.11.6.6.1.1.cmml"><mi id="A1.E20.m1.11.11.6.6.1.1.2" xref="A1.E20.m1.11.11.6.6.1.1.2.cmml">β</mi><mo id="A1.E20.m1.11.11.6.6.1.1.1" lspace="0.167em" xref="A1.E20.m1.11.11.6.6.1.1.1.cmml">⁢</mo><mrow id="A1.E20.m1.11.11.6.6.1.1.3" xref="A1.E20.m1.11.11.6.6.1.1.3.cmml"><mi id="A1.E20.m1.11.11.6.6.1.1.3.1" xref="A1.E20.m1.11.11.6.6.1.1.3.1.cmml">log</mi><mo id="A1.E20.m1.11.11.6.6.1.1.3a" lspace="0.167em" xref="A1.E20.m1.11.11.6.6.1.1.3.cmml">⁡</mo><mfrac id="A1.E20.m1.9.9.4.4" xref="A1.E20.m1.9.9.4.4.cmml"><mrow id="A1.E20.m1.7.7.2.2.2" xref="A1.E20.m1.7.7.2.2.2.cmml"><msub id="A1.E20.m1.7.7.2.2.2.4" xref="A1.E20.m1.7.7.2.2.2.4.cmml"><mi id="A1.E20.m1.7.7.2.2.2.4.2" xref="A1.E20.m1.7.7.2.2.2.4.2.cmml">π</mi><mi id="A1.E20.m1.7.7.2.2.2.4.3" xref="A1.E20.m1.7.7.2.2.2.4.3.cmml">θ</mi></msub><mo id="A1.E20.m1.7.7.2.2.2.3" xref="A1.E20.m1.7.7.2.2.2.3.cmml">⁢</mo><mrow id="A1.E20.m1.7.7.2.2.2.2.1" xref="A1.E20.m1.7.7.2.2.2.2.1.1.cmml"><mo id="A1.E20.m1.7.7.2.2.2.2.1.2" stretchy="false" xref="A1.E20.m1.7.7.2.2.2.2.1.1.cmml">(</mo><mrow id="A1.E20.m1.7.7.2.2.2.2.1.1" xref="A1.E20.m1.7.7.2.2.2.2.1.1.cmml"><msub id="A1.E20.m1.7.7.2.2.2.2.1.1.2" xref="A1.E20.m1.7.7.2.2.2.2.1.1.2.cmml"><mi id="A1.E20.m1.7.7.2.2.2.2.1.1.2.2" xref="A1.E20.m1.7.7.2.2.2.2.1.1.2.2.cmml">y</mi><mrow id="A1.E20.m1.6.6.1.1.1.1.1" xref="A1.E20.m1.6.6.1.1.1.1.1.cmml"><mi id="A1.E20.m1.6.6.1.1.1.1.1.3" xref="A1.E20.m1.6.6.1.1.1.1.1.3.cmml">τ</mi><mo id="A1.E20.m1.6.6.1.1.1.1.1.2" xref="A1.E20.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E20.m1.6.6.1.1.1.1.1.4.2" xref="A1.E20.m1.6.6.1.1.1.1.1.cmml"><mo id="A1.E20.m1.6.6.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.E20.m1.6.6.1.1.1.1.1.cmml">(</mo><mi id="A1.E20.m1.6.6.1.1.1.1.1.1" xref="A1.E20.m1.6.6.1.1.1.1.1.1.cmml">k</mi><mo id="A1.E20.m1.6.6.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.E20.m1.6.6.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo fence="false" id="A1.E20.m1.7.7.2.2.2.2.1.1.1" xref="A1.E20.m1.7.7.2.2.2.2.1.1.1.cmml">|</mo><mi id="A1.E20.m1.7.7.2.2.2.2.1.1.3" xref="A1.E20.m1.7.7.2.2.2.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E20.m1.7.7.2.2.2.2.1.3" stretchy="false" xref="A1.E20.m1.7.7.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E20.m1.9.9.4.4.4" xref="A1.E20.m1.9.9.4.4.4.cmml"><msub id="A1.E20.m1.9.9.4.4.4.4" xref="A1.E20.m1.9.9.4.4.4.4.cmml"><mi id="A1.E20.m1.9.9.4.4.4.4.2" xref="A1.E20.m1.9.9.4.4.4.4.2.cmml">π</mi><mtext id="A1.E20.m1.9.9.4.4.4.4.3" xref="A1.E20.m1.9.9.4.4.4.4.3a.cmml">ref</mtext></msub><mo id="A1.E20.m1.9.9.4.4.4.3" xref="A1.E20.m1.9.9.4.4.4.3.cmml">⁢</mo><mrow id="A1.E20.m1.9.9.4.4.4.2.1" xref="A1.E20.m1.9.9.4.4.4.2.1.1.cmml"><mo id="A1.E20.m1.9.9.4.4.4.2.1.2" stretchy="false" xref="A1.E20.m1.9.9.4.4.4.2.1.1.cmml">(</mo><mrow id="A1.E20.m1.9.9.4.4.4.2.1.1" xref="A1.E20.m1.9.9.4.4.4.2.1.1.cmml"><msub id="A1.E20.m1.9.9.4.4.4.2.1.1.2" xref="A1.E20.m1.9.9.4.4.4.2.1.1.2.cmml"><mi id="A1.E20.m1.9.9.4.4.4.2.1.1.2.2" xref="A1.E20.m1.9.9.4.4.4.2.1.1.2.2.cmml">y</mi><mrow id="A1.E20.m1.8.8.3.3.3.1.1" xref="A1.E20.m1.8.8.3.3.3.1.1.cmml"><mi id="A1.E20.m1.8.8.3.3.3.1.1.3" xref="A1.E20.m1.8.8.3.3.3.1.1.3.cmml">τ</mi><mo id="A1.E20.m1.8.8.3.3.3.1.1.2" xref="A1.E20.m1.8.8.3.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E20.m1.8.8.3.3.3.1.1.4.2" xref="A1.E20.m1.8.8.3.3.3.1.1.cmml"><mo id="A1.E20.m1.8.8.3.3.3.1.1.4.2.1" stretchy="false" xref="A1.E20.m1.8.8.3.3.3.1.1.cmml">(</mo><mi id="A1.E20.m1.8.8.3.3.3.1.1.1" xref="A1.E20.m1.8.8.3.3.3.1.1.1.cmml">k</mi><mo id="A1.E20.m1.8.8.3.3.3.1.1.4.2.2" stretchy="false" xref="A1.E20.m1.8.8.3.3.3.1.1.cmml">)</mo></mrow></mrow></msub><mo fence="false" id="A1.E20.m1.9.9.4.4.4.2.1.1.1" xref="A1.E20.m1.9.9.4.4.4.2.1.1.1.cmml">|</mo><mi id="A1.E20.m1.9.9.4.4.4.2.1.1.3" xref="A1.E20.m1.9.9.4.4.4.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E20.m1.9.9.4.4.4.2.1.3" stretchy="false" xref="A1.E20.m1.9.9.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.E20.m1.11.11.6.6.1.3" xref="A1.E20.m1.11.11.6.7.cmml">)</mo></mrow></mrow><mrow id="A1.E20.m1.17.17.12" xref="A1.E20.m1.17.17.12.cmml"><msubsup id="A1.E20.m1.17.17.12.7" xref="A1.E20.m1.17.17.12.7.cmml"><mo id="A1.E20.m1.17.17.12.7.2.2" xref="A1.E20.m1.17.17.12.7.2.2.cmml">∑</mo><mrow id="A1.E20.m1.17.17.12.7.2.3" xref="A1.E20.m1.17.17.12.7.2.3.cmml"><mi id="A1.E20.m1.17.17.12.7.2.3.2" xref="A1.E20.m1.17.17.12.7.2.3.2.cmml">j</mi><mo id="A1.E20.m1.17.17.12.7.2.3.1" xref="A1.E20.m1.17.17.12.7.2.3.1.cmml">=</mo><mi id="A1.E20.m1.17.17.12.7.2.3.3" xref="A1.E20.m1.17.17.12.7.2.3.3.cmml">k</mi></mrow><mi id="A1.E20.m1.17.17.12.7.3" xref="A1.E20.m1.17.17.12.7.3.cmml">K</mi></msubsup><mrow id="A1.E20.m1.17.17.12.6.1" xref="A1.E20.m1.17.17.12.6.2.cmml"><mi id="A1.E20.m1.16.16.11.5" xref="A1.E20.m1.16.16.11.5.cmml">exp</mi><mo id="A1.E20.m1.17.17.12.6.1a" xref="A1.E20.m1.17.17.12.6.2.cmml">⁡</mo><mrow id="A1.E20.m1.17.17.12.6.1.1" xref="A1.E20.m1.17.17.12.6.2.cmml"><mo id="A1.E20.m1.17.17.12.6.1.1.2" xref="A1.E20.m1.17.17.12.6.2.cmml">(</mo><mrow id="A1.E20.m1.17.17.12.6.1.1.1" xref="A1.E20.m1.17.17.12.6.1.1.1.cmml"><mi id="A1.E20.m1.17.17.12.6.1.1.1.2" xref="A1.E20.m1.17.17.12.6.1.1.1.2.cmml">β</mi><mo id="A1.E20.m1.17.17.12.6.1.1.1.1" lspace="0.167em" xref="A1.E20.m1.17.17.12.6.1.1.1.1.cmml">⁢</mo><mrow id="A1.E20.m1.17.17.12.6.1.1.1.3" xref="A1.E20.m1.17.17.12.6.1.1.1.3.cmml"><mi id="A1.E20.m1.17.17.12.6.1.1.1.3.1" xref="A1.E20.m1.17.17.12.6.1.1.1.3.1.cmml">log</mi><mo id="A1.E20.m1.17.17.12.6.1.1.1.3a" lspace="0.167em" xref="A1.E20.m1.17.17.12.6.1.1.1.3.cmml">⁡</mo><mfrac id="A1.E20.m1.15.15.10.4" xref="A1.E20.m1.15.15.10.4.cmml"><mrow id="A1.E20.m1.13.13.8.2.2" xref="A1.E20.m1.13.13.8.2.2.cmml"><msub id="A1.E20.m1.13.13.8.2.2.4" xref="A1.E20.m1.13.13.8.2.2.4.cmml"><mi id="A1.E20.m1.13.13.8.2.2.4.2" xref="A1.E20.m1.13.13.8.2.2.4.2.cmml">π</mi><mi id="A1.E20.m1.13.13.8.2.2.4.3" xref="A1.E20.m1.13.13.8.2.2.4.3.cmml">θ</mi></msub><mo id="A1.E20.m1.13.13.8.2.2.3" xref="A1.E20.m1.13.13.8.2.2.3.cmml">⁢</mo><mrow id="A1.E20.m1.13.13.8.2.2.2.1" xref="A1.E20.m1.13.13.8.2.2.2.1.1.cmml"><mo id="A1.E20.m1.13.13.8.2.2.2.1.2" stretchy="false" xref="A1.E20.m1.13.13.8.2.2.2.1.1.cmml">(</mo><mrow id="A1.E20.m1.13.13.8.2.2.2.1.1" xref="A1.E20.m1.13.13.8.2.2.2.1.1.cmml"><msub id="A1.E20.m1.13.13.8.2.2.2.1.1.2" xref="A1.E20.m1.13.13.8.2.2.2.1.1.2.cmml"><mi id="A1.E20.m1.13.13.8.2.2.2.1.1.2.2" xref="A1.E20.m1.13.13.8.2.2.2.1.1.2.2.cmml">y</mi><mrow id="A1.E20.m1.12.12.7.1.1.1.1" xref="A1.E20.m1.12.12.7.1.1.1.1.cmml"><mi id="A1.E20.m1.12.12.7.1.1.1.1.3" xref="A1.E20.m1.12.12.7.1.1.1.1.3.cmml">τ</mi><mo id="A1.E20.m1.12.12.7.1.1.1.1.2" xref="A1.E20.m1.12.12.7.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E20.m1.12.12.7.1.1.1.1.4.2" xref="A1.E20.m1.12.12.7.1.1.1.1.cmml"><mo id="A1.E20.m1.12.12.7.1.1.1.1.4.2.1" stretchy="false" xref="A1.E20.m1.12.12.7.1.1.1.1.cmml">(</mo><mi id="A1.E20.m1.12.12.7.1.1.1.1.1" xref="A1.E20.m1.12.12.7.1.1.1.1.1.cmml">j</mi><mo id="A1.E20.m1.12.12.7.1.1.1.1.4.2.2" stretchy="false" xref="A1.E20.m1.12.12.7.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo fence="false" id="A1.E20.m1.13.13.8.2.2.2.1.1.1" xref="A1.E20.m1.13.13.8.2.2.2.1.1.1.cmml">|</mo><mi id="A1.E20.m1.13.13.8.2.2.2.1.1.3" xref="A1.E20.m1.13.13.8.2.2.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E20.m1.13.13.8.2.2.2.1.3" stretchy="false" xref="A1.E20.m1.13.13.8.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E20.m1.15.15.10.4.4" xref="A1.E20.m1.15.15.10.4.4.cmml"><msub id="A1.E20.m1.15.15.10.4.4.4" xref="A1.E20.m1.15.15.10.4.4.4.cmml"><mi id="A1.E20.m1.15.15.10.4.4.4.2" xref="A1.E20.m1.15.15.10.4.4.4.2.cmml">π</mi><mtext id="A1.E20.m1.15.15.10.4.4.4.3" xref="A1.E20.m1.15.15.10.4.4.4.3a.cmml">ref</mtext></msub><mo id="A1.E20.m1.15.15.10.4.4.3" xref="A1.E20.m1.15.15.10.4.4.3.cmml">⁢</mo><mrow id="A1.E20.m1.15.15.10.4.4.2.1" xref="A1.E20.m1.15.15.10.4.4.2.1.1.cmml"><mo id="A1.E20.m1.15.15.10.4.4.2.1.2" stretchy="false" xref="A1.E20.m1.15.15.10.4.4.2.1.1.cmml">(</mo><mrow id="A1.E20.m1.15.15.10.4.4.2.1.1" xref="A1.E20.m1.15.15.10.4.4.2.1.1.cmml"><msub id="A1.E20.m1.15.15.10.4.4.2.1.1.2" xref="A1.E20.m1.15.15.10.4.4.2.1.1.2.cmml"><mi id="A1.E20.m1.15.15.10.4.4.2.1.1.2.2" xref="A1.E20.m1.15.15.10.4.4.2.1.1.2.2.cmml">y</mi><mrow id="A1.E20.m1.14.14.9.3.3.1.1" xref="A1.E20.m1.14.14.9.3.3.1.1.cmml"><mi id="A1.E20.m1.14.14.9.3.3.1.1.3" xref="A1.E20.m1.14.14.9.3.3.1.1.3.cmml">τ</mi><mo id="A1.E20.m1.14.14.9.3.3.1.1.2" xref="A1.E20.m1.14.14.9.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E20.m1.14.14.9.3.3.1.1.4.2" xref="A1.E20.m1.14.14.9.3.3.1.1.cmml"><mo id="A1.E20.m1.14.14.9.3.3.1.1.4.2.1" stretchy="false" xref="A1.E20.m1.14.14.9.3.3.1.1.cmml">(</mo><mi id="A1.E20.m1.14.14.9.3.3.1.1.1" xref="A1.E20.m1.14.14.9.3.3.1.1.1.cmml">j</mi><mo id="A1.E20.m1.14.14.9.3.3.1.1.4.2.2" stretchy="false" xref="A1.E20.m1.14.14.9.3.3.1.1.cmml">)</mo></mrow></mrow></msub><mo fence="false" id="A1.E20.m1.15.15.10.4.4.2.1.1.1" xref="A1.E20.m1.15.15.10.4.4.2.1.1.1.cmml">|</mo><mi id="A1.E20.m1.15.15.10.4.4.2.1.1.3" xref="A1.E20.m1.15.15.10.4.4.2.1.1.3.cmml">x</mi></mrow><mo id="A1.E20.m1.15.15.10.4.4.2.1.3" stretchy="false" xref="A1.E20.m1.15.15.10.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.E20.m1.17.17.12.6.1.1.3" xref="A1.E20.m1.17.17.12.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow><mo id="A1.E20.m1.20.20.3.1.1.1.3" xref="A1.E20.m1.20.20.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E20.m1.20b"><apply id="A1.E20.m1.20.20.cmml" xref="A1.E20.m1.20.20"><eq id="A1.E20.m1.20.20.4.cmml" xref="A1.E20.m1.20.20.4"></eq><apply id="A1.E20.m1.19.19.2.cmml" xref="A1.E20.m1.19.19.2"><times id="A1.E20.m1.19.19.2.3.cmml" xref="A1.E20.m1.19.19.2.3"></times><apply id="A1.E20.m1.19.19.2.4.cmml" xref="A1.E20.m1.19.19.2.4"><csymbol cd="ambiguous" id="A1.E20.m1.19.19.2.4.1.cmml" xref="A1.E20.m1.19.19.2.4">subscript</csymbol><ci id="A1.E20.m1.19.19.2.4.2.cmml" xref="A1.E20.m1.19.19.2.4.2">ℒ</ci><ci id="A1.E20.m1.19.19.2.4.3a.cmml" xref="A1.E20.m1.19.19.2.4.3"><mtext id="A1.E20.m1.19.19.2.4.3.cmml" mathsize="70%" xref="A1.E20.m1.19.19.2.4.3">DPO</mtext></ci></apply><interval closure="open" id="A1.E20.m1.19.19.2.2.3.cmml" xref="A1.E20.m1.19.19.2.2.2"><apply id="A1.E20.m1.18.18.1.1.1.1.cmml" xref="A1.E20.m1.18.18.1.1.1.1"><csymbol cd="ambiguous" id="A1.E20.m1.18.18.1.1.1.1.1.cmml" xref="A1.E20.m1.18.18.1.1.1.1">subscript</csymbol><ci id="A1.E20.m1.18.18.1.1.1.1.2.cmml" xref="A1.E20.m1.18.18.1.1.1.1.2">𝜋</ci><ci id="A1.E20.m1.18.18.1.1.1.1.3.cmml" xref="A1.E20.m1.18.18.1.1.1.1.3">𝜃</ci></apply><apply id="A1.E20.m1.19.19.2.2.2.2.cmml" xref="A1.E20.m1.19.19.2.2.2.2"><csymbol cd="ambiguous" id="A1.E20.m1.19.19.2.2.2.2.1.cmml" xref="A1.E20.m1.19.19.2.2.2.2">subscript</csymbol><ci id="A1.E20.m1.19.19.2.2.2.2.2.cmml" xref="A1.E20.m1.19.19.2.2.2.2.2">𝜋</ci><ci id="A1.E20.m1.19.19.2.2.2.2.3a.cmml" xref="A1.E20.m1.19.19.2.2.2.2.3"><mtext id="A1.E20.m1.19.19.2.2.2.2.3.cmml" mathsize="70%" xref="A1.E20.m1.19.19.2.2.2.2.3">ref</mtext></ci></apply></interval></apply><apply id="A1.E20.m1.20.20.3.cmml" xref="A1.E20.m1.20.20.3"><minus id="A1.E20.m1.20.20.3.2.cmml" xref="A1.E20.m1.20.20.3"></minus><apply id="A1.E20.m1.20.20.3.1.cmml" xref="A1.E20.m1.20.20.3.1"><times id="A1.E20.m1.20.20.3.1.2.cmml" xref="A1.E20.m1.20.20.3.1.2"></times><apply id="A1.E20.m1.20.20.3.1.3.cmml" xref="A1.E20.m1.20.20.3.1.3"><csymbol cd="ambiguous" id="A1.E20.m1.20.20.3.1.3.1.cmml" xref="A1.E20.m1.20.20.3.1.3">subscript</csymbol><ci id="A1.E20.m1.20.20.3.1.3.2.cmml" xref="A1.E20.m1.20.20.3.1.3.2">𝔼</ci><apply id="A1.E20.m1.5.5.5.cmml" xref="A1.E20.m1.5.5.5"><csymbol cd="latexml" id="A1.E20.m1.5.5.5.6.cmml" xref="A1.E20.m1.5.5.5.6">similar-to</csymbol><list id="A1.E20.m1.5.5.5.5.3.cmml" xref="A1.E20.m1.5.5.5.5.2"><ci id="A1.E20.m1.1.1.1.1.cmml" xref="A1.E20.m1.1.1.1.1">𝜏</ci><apply id="A1.E20.m1.4.4.4.4.1.1.cmml" xref="A1.E20.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="A1.E20.m1.4.4.4.4.1.1.1.cmml" xref="A1.E20.m1.4.4.4.4.1.1">subscript</csymbol><ci id="A1.E20.m1.4.4.4.4.1.1.2.cmml" xref="A1.E20.m1.4.4.4.4.1.1.2">𝑦</ci><cn id="A1.E20.m1.4.4.4.4.1.1.3.cmml" type="integer" xref="A1.E20.m1.4.4.4.4.1.1.3">1</cn></apply><ci id="A1.E20.m1.2.2.2.2.cmml" xref="A1.E20.m1.2.2.2.2">…</ci><apply id="A1.E20.m1.5.5.5.5.2.2.cmml" xref="A1.E20.m1.5.5.5.5.2.2"><csymbol cd="ambiguous" id="A1.E20.m1.5.5.5.5.2.2.1.cmml" xref="A1.E20.m1.5.5.5.5.2.2">subscript</csymbol><ci id="A1.E20.m1.5.5.5.5.2.2.2.cmml" xref="A1.E20.m1.5.5.5.5.2.2.2">𝑦</ci><ci id="A1.E20.m1.5.5.5.5.2.2.3.cmml" xref="A1.E20.m1.5.5.5.5.2.2.3">𝐾</ci></apply><ci id="A1.E20.m1.3.3.3.3.cmml" xref="A1.E20.m1.3.3.3.3">𝑥</ci></list><ci id="A1.E20.m1.5.5.5.7.cmml" xref="A1.E20.m1.5.5.5.7">𝒟</ci></apply></apply><apply id="A1.E20.m1.20.20.3.1.1.2.cmml" xref="A1.E20.m1.20.20.3.1.1.1"><csymbol cd="latexml" id="A1.E20.m1.20.20.3.1.1.2.1.cmml" xref="A1.E20.m1.20.20.3.1.1.1.2">delimited-[]</csymbol><apply id="A1.E20.m1.20.20.3.1.1.1.1.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1"><times id="A1.E20.m1.20.20.3.1.1.1.1.1.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.1"></times><log id="A1.E20.m1.20.20.3.1.1.1.1.2.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.2"></log><apply id="A1.E20.m1.20.20.3.1.1.1.1.3.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3"><apply id="A1.E20.m1.20.20.3.1.1.1.1.3.1.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E20.m1.20.20.3.1.1.1.1.3.1.1.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1">superscript</csymbol><apply id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1"><csymbol cd="ambiguous" id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.1.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.2.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.2">product</csymbol><apply id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3"><eq id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.1.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.1"></eq><ci id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.2.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.2">𝑘</ci><cn id="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="A1.E20.m1.20.20.3.1.1.1.1.3.1.3.cmml" xref="A1.E20.m1.20.20.3.1.1.1.1.3.1.3">𝐾</ci></apply><apply id="A1.E20.m1.17.17.cmml" xref="A1.E20.m1.17.17"><divide id="A1.E20.m1.17.17.13.cmml" xref="A1.E20.m1.17.17"></divide><apply id="A1.E20.m1.11.11.6.7.cmml" xref="A1.E20.m1.11.11.6.6"><exp id="A1.E20.m1.10.10.5.5.cmml" xref="A1.E20.m1.10.10.5.5"></exp><apply id="A1.E20.m1.11.11.6.6.1.1.cmml" xref="A1.E20.m1.11.11.6.6.1.1"><times id="A1.E20.m1.11.11.6.6.1.1.1.cmml" xref="A1.E20.m1.11.11.6.6.1.1.1"></times><ci id="A1.E20.m1.11.11.6.6.1.1.2.cmml" xref="A1.E20.m1.11.11.6.6.1.1.2">𝛽</ci><apply id="A1.E20.m1.11.11.6.6.1.1.3.cmml" xref="A1.E20.m1.11.11.6.6.1.1.3"><log id="A1.E20.m1.11.11.6.6.1.1.3.1.cmml" xref="A1.E20.m1.11.11.6.6.1.1.3.1"></log><apply id="A1.E20.m1.9.9.4.4.cmml" xref="A1.E20.m1.9.9.4.4"><divide id="A1.E20.m1.9.9.4.4.5.cmml" xref="A1.E20.m1.9.9.4.4"></divide><apply id="A1.E20.m1.7.7.2.2.2.cmml" xref="A1.E20.m1.7.7.2.2.2"><times id="A1.E20.m1.7.7.2.2.2.3.cmml" xref="A1.E20.m1.7.7.2.2.2.3"></times><apply id="A1.E20.m1.7.7.2.2.2.4.cmml" xref="A1.E20.m1.7.7.2.2.2.4"><csymbol cd="ambiguous" id="A1.E20.m1.7.7.2.2.2.4.1.cmml" xref="A1.E20.m1.7.7.2.2.2.4">subscript</csymbol><ci id="A1.E20.m1.7.7.2.2.2.4.2.cmml" xref="A1.E20.m1.7.7.2.2.2.4.2">𝜋</ci><ci id="A1.E20.m1.7.7.2.2.2.4.3.cmml" xref="A1.E20.m1.7.7.2.2.2.4.3">𝜃</ci></apply><apply id="A1.E20.m1.7.7.2.2.2.2.1.1.cmml" xref="A1.E20.m1.7.7.2.2.2.2.1"><csymbol cd="latexml" id="A1.E20.m1.7.7.2.2.2.2.1.1.1.cmml" xref="A1.E20.m1.7.7.2.2.2.2.1.1.1">conditional</csymbol><apply id="A1.E20.m1.7.7.2.2.2.2.1.1.2.cmml" xref="A1.E20.m1.7.7.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E20.m1.7.7.2.2.2.2.1.1.2.1.cmml" xref="A1.E20.m1.7.7.2.2.2.2.1.1.2">subscript</csymbol><ci id="A1.E20.m1.7.7.2.2.2.2.1.1.2.2.cmml" xref="A1.E20.m1.7.7.2.2.2.2.1.1.2.2">𝑦</ci><apply id="A1.E20.m1.6.6.1.1.1.1.1.cmml" xref="A1.E20.m1.6.6.1.1.1.1.1"><times id="A1.E20.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E20.m1.6.6.1.1.1.1.1.2"></times><ci id="A1.E20.m1.6.6.1.1.1.1.1.3.cmml" xref="A1.E20.m1.6.6.1.1.1.1.1.3">𝜏</ci><ci id="A1.E20.m1.6.6.1.1.1.1.1.1.cmml" xref="A1.E20.m1.6.6.1.1.1.1.1.1">𝑘</ci></apply></apply><ci id="A1.E20.m1.7.7.2.2.2.2.1.1.3.cmml" xref="A1.E20.m1.7.7.2.2.2.2.1.1.3">𝑥</ci></apply></apply><apply id="A1.E20.m1.9.9.4.4.4.cmml" xref="A1.E20.m1.9.9.4.4.4"><times id="A1.E20.m1.9.9.4.4.4.3.cmml" xref="A1.E20.m1.9.9.4.4.4.3"></times><apply id="A1.E20.m1.9.9.4.4.4.4.cmml" xref="A1.E20.m1.9.9.4.4.4.4"><csymbol cd="ambiguous" id="A1.E20.m1.9.9.4.4.4.4.1.cmml" xref="A1.E20.m1.9.9.4.4.4.4">subscript</csymbol><ci id="A1.E20.m1.9.9.4.4.4.4.2.cmml" xref="A1.E20.m1.9.9.4.4.4.4.2">𝜋</ci><ci id="A1.E20.m1.9.9.4.4.4.4.3a.cmml" xref="A1.E20.m1.9.9.4.4.4.4.3"><mtext id="A1.E20.m1.9.9.4.4.4.4.3.cmml" mathsize="50%" xref="A1.E20.m1.9.9.4.4.4.4.3">ref</mtext></ci></apply><apply id="A1.E20.m1.9.9.4.4.4.2.1.1.cmml" xref="A1.E20.m1.9.9.4.4.4.2.1"><csymbol cd="latexml" id="A1.E20.m1.9.9.4.4.4.2.1.1.1.cmml" xref="A1.E20.m1.9.9.4.4.4.2.1.1.1">conditional</csymbol><apply id="A1.E20.m1.9.9.4.4.4.2.1.1.2.cmml" xref="A1.E20.m1.9.9.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="A1.E20.m1.9.9.4.4.4.2.1.1.2.1.cmml" xref="A1.E20.m1.9.9.4.4.4.2.1.1.2">subscript</csymbol><ci id="A1.E20.m1.9.9.4.4.4.2.1.1.2.2.cmml" xref="A1.E20.m1.9.9.4.4.4.2.1.1.2.2">𝑦</ci><apply id="A1.E20.m1.8.8.3.3.3.1.1.cmml" xref="A1.E20.m1.8.8.3.3.3.1.1"><times id="A1.E20.m1.8.8.3.3.3.1.1.2.cmml" xref="A1.E20.m1.8.8.3.3.3.1.1.2"></times><ci id="A1.E20.m1.8.8.3.3.3.1.1.3.cmml" xref="A1.E20.m1.8.8.3.3.3.1.1.3">𝜏</ci><ci id="A1.E20.m1.8.8.3.3.3.1.1.1.cmml" xref="A1.E20.m1.8.8.3.3.3.1.1.1">𝑘</ci></apply></apply><ci id="A1.E20.m1.9.9.4.4.4.2.1.1.3.cmml" xref="A1.E20.m1.9.9.4.4.4.2.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E20.m1.17.17.12.cmml" xref="A1.E20.m1.17.17.12"><apply id="A1.E20.m1.17.17.12.7.cmml" xref="A1.E20.m1.17.17.12.7"><csymbol cd="ambiguous" id="A1.E20.m1.17.17.12.7.1.cmml" xref="A1.E20.m1.17.17.12.7">superscript</csymbol><apply id="A1.E20.m1.17.17.12.7.2.cmml" xref="A1.E20.m1.17.17.12.7"><csymbol cd="ambiguous" id="A1.E20.m1.17.17.12.7.2.1.cmml" xref="A1.E20.m1.17.17.12.7">subscript</csymbol><sum id="A1.E20.m1.17.17.12.7.2.2.cmml" xref="A1.E20.m1.17.17.12.7.2.2"></sum><apply id="A1.E20.m1.17.17.12.7.2.3.cmml" xref="A1.E20.m1.17.17.12.7.2.3"><eq id="A1.E20.m1.17.17.12.7.2.3.1.cmml" xref="A1.E20.m1.17.17.12.7.2.3.1"></eq><ci id="A1.E20.m1.17.17.12.7.2.3.2.cmml" xref="A1.E20.m1.17.17.12.7.2.3.2">𝑗</ci><ci id="A1.E20.m1.17.17.12.7.2.3.3.cmml" xref="A1.E20.m1.17.17.12.7.2.3.3">𝑘</ci></apply></apply><ci id="A1.E20.m1.17.17.12.7.3.cmml" xref="A1.E20.m1.17.17.12.7.3">𝐾</ci></apply><apply id="A1.E20.m1.17.17.12.6.2.cmml" xref="A1.E20.m1.17.17.12.6.1"><exp id="A1.E20.m1.16.16.11.5.cmml" xref="A1.E20.m1.16.16.11.5"></exp><apply id="A1.E20.m1.17.17.12.6.1.1.1.cmml" xref="A1.E20.m1.17.17.12.6.1.1.1"><times id="A1.E20.m1.17.17.12.6.1.1.1.1.cmml" xref="A1.E20.m1.17.17.12.6.1.1.1.1"></times><ci id="A1.E20.m1.17.17.12.6.1.1.1.2.cmml" xref="A1.E20.m1.17.17.12.6.1.1.1.2">𝛽</ci><apply id="A1.E20.m1.17.17.12.6.1.1.1.3.cmml" xref="A1.E20.m1.17.17.12.6.1.1.1.3"><log id="A1.E20.m1.17.17.12.6.1.1.1.3.1.cmml" xref="A1.E20.m1.17.17.12.6.1.1.1.3.1"></log><apply id="A1.E20.m1.15.15.10.4.cmml" xref="A1.E20.m1.15.15.10.4"><divide id="A1.E20.m1.15.15.10.4.5.cmml" xref="A1.E20.m1.15.15.10.4"></divide><apply id="A1.E20.m1.13.13.8.2.2.cmml" xref="A1.E20.m1.13.13.8.2.2"><times id="A1.E20.m1.13.13.8.2.2.3.cmml" xref="A1.E20.m1.13.13.8.2.2.3"></times><apply id="A1.E20.m1.13.13.8.2.2.4.cmml" xref="A1.E20.m1.13.13.8.2.2.4"><csymbol cd="ambiguous" id="A1.E20.m1.13.13.8.2.2.4.1.cmml" xref="A1.E20.m1.13.13.8.2.2.4">subscript</csymbol><ci id="A1.E20.m1.13.13.8.2.2.4.2.cmml" xref="A1.E20.m1.13.13.8.2.2.4.2">𝜋</ci><ci id="A1.E20.m1.13.13.8.2.2.4.3.cmml" xref="A1.E20.m1.13.13.8.2.2.4.3">𝜃</ci></apply><apply id="A1.E20.m1.13.13.8.2.2.2.1.1.cmml" xref="A1.E20.m1.13.13.8.2.2.2.1"><csymbol cd="latexml" id="A1.E20.m1.13.13.8.2.2.2.1.1.1.cmml" xref="A1.E20.m1.13.13.8.2.2.2.1.1.1">conditional</csymbol><apply id="A1.E20.m1.13.13.8.2.2.2.1.1.2.cmml" xref="A1.E20.m1.13.13.8.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E20.m1.13.13.8.2.2.2.1.1.2.1.cmml" xref="A1.E20.m1.13.13.8.2.2.2.1.1.2">subscript</csymbol><ci id="A1.E20.m1.13.13.8.2.2.2.1.1.2.2.cmml" xref="A1.E20.m1.13.13.8.2.2.2.1.1.2.2">𝑦</ci><apply id="A1.E20.m1.12.12.7.1.1.1.1.cmml" xref="A1.E20.m1.12.12.7.1.1.1.1"><times id="A1.E20.m1.12.12.7.1.1.1.1.2.cmml" xref="A1.E20.m1.12.12.7.1.1.1.1.2"></times><ci id="A1.E20.m1.12.12.7.1.1.1.1.3.cmml" xref="A1.E20.m1.12.12.7.1.1.1.1.3">𝜏</ci><ci id="A1.E20.m1.12.12.7.1.1.1.1.1.cmml" xref="A1.E20.m1.12.12.7.1.1.1.1.1">𝑗</ci></apply></apply><ci id="A1.E20.m1.13.13.8.2.2.2.1.1.3.cmml" xref="A1.E20.m1.13.13.8.2.2.2.1.1.3">𝑥</ci></apply></apply><apply id="A1.E20.m1.15.15.10.4.4.cmml" xref="A1.E20.m1.15.15.10.4.4"><times id="A1.E20.m1.15.15.10.4.4.3.cmml" xref="A1.E20.m1.15.15.10.4.4.3"></times><apply id="A1.E20.m1.15.15.10.4.4.4.cmml" xref="A1.E20.m1.15.15.10.4.4.4"><csymbol cd="ambiguous" id="A1.E20.m1.15.15.10.4.4.4.1.cmml" xref="A1.E20.m1.15.15.10.4.4.4">subscript</csymbol><ci id="A1.E20.m1.15.15.10.4.4.4.2.cmml" xref="A1.E20.m1.15.15.10.4.4.4.2">𝜋</ci><ci id="A1.E20.m1.15.15.10.4.4.4.3a.cmml" xref="A1.E20.m1.15.15.10.4.4.4.3"><mtext id="A1.E20.m1.15.15.10.4.4.4.3.cmml" mathsize="50%" xref="A1.E20.m1.15.15.10.4.4.4.3">ref</mtext></ci></apply><apply id="A1.E20.m1.15.15.10.4.4.2.1.1.cmml" xref="A1.E20.m1.15.15.10.4.4.2.1"><csymbol cd="latexml" id="A1.E20.m1.15.15.10.4.4.2.1.1.1.cmml" xref="A1.E20.m1.15.15.10.4.4.2.1.1.1">conditional</csymbol><apply id="A1.E20.m1.15.15.10.4.4.2.1.1.2.cmml" xref="A1.E20.m1.15.15.10.4.4.2.1.1.2"><csymbol cd="ambiguous" id="A1.E20.m1.15.15.10.4.4.2.1.1.2.1.cmml" xref="A1.E20.m1.15.15.10.4.4.2.1.1.2">subscript</csymbol><ci id="A1.E20.m1.15.15.10.4.4.2.1.1.2.2.cmml" xref="A1.E20.m1.15.15.10.4.4.2.1.1.2.2">𝑦</ci><apply id="A1.E20.m1.14.14.9.3.3.1.1.cmml" xref="A1.E20.m1.14.14.9.3.3.1.1"><times id="A1.E20.m1.14.14.9.3.3.1.1.2.cmml" xref="A1.E20.m1.14.14.9.3.3.1.1.2"></times><ci id="A1.E20.m1.14.14.9.3.3.1.1.3.cmml" xref="A1.E20.m1.14.14.9.3.3.1.1.3">𝜏</ci><ci id="A1.E20.m1.14.14.9.3.3.1.1.1.cmml" xref="A1.E20.m1.14.14.9.3.3.1.1.1">𝑗</ci></apply></apply><ci id="A1.E20.m1.15.15.10.4.4.2.1.1.3.cmml" xref="A1.E20.m1.15.15.10.4.4.2.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E20.m1.20c">\mathcal{L}_{\text{DPO}}(\pi_{\theta},\pi_{\text{ref}})=-\mathbb{E}_{\tau,y_{1%
},\ldots,y_{K},x\sim\mathcal{D}}\left[\log\prod_{k=1}^{K}\frac{\exp\left(\beta%
\log\frac{\pi_{\theta}(y_{\tau(k)}|x)}{\pi_{\text{ref}}(y_{\tau(k)}|x)}\right)%
}{\sum_{j=k}^{K}\exp\left(\beta\log\frac{\pi_{\theta}(y_{\tau(j)}|x)}{\pi_{%
\text{ref}}(y_{\tau(j)}|x)}\right)}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E20.m1.20d">caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) = - blackboard_E start_POSTSUBSCRIPT italic_τ , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_x ∼ caligraphic_D end_POSTSUBSCRIPT [ roman_log ∏ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG roman_exp ( italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_τ ( italic_k ) end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_τ ( italic_k ) end_POSTSUBSCRIPT | italic_x ) end_ARG ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_τ ( italic_j ) end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_τ ( italic_j ) end_POSTSUBSCRIPT | italic_x ) end_ARG ) end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Deriving the Gradient of the DPO Objective</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">이 절에서 우리는 DPO 목표의 기울기를 도출한다:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx4">
<tbody id="A1.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla_{\theta}\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{%
ref}})=-\nabla_{\theta}\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\left[\log%
\sigma\left(\beta\log\frac{\pi_{\theta}(y_{l}|x)}{\pi_{\text{ref}}(y_{l}|x)}-%
\beta\log\frac{\pi_{\theta}(y_{w}|x)}{\pi_{\text{ref}}(y_{w}|x)}\right)\right]" class="ltx_Math" display="inline" id="A1.E21.m1.10"><semantics id="A1.E21.m1.10a"><mrow id="A1.E21.m1.10.10" xref="A1.E21.m1.10.10.cmml"><mrow id="A1.E21.m1.9.9.2" xref="A1.E21.m1.9.9.2.cmml"><mrow id="A1.E21.m1.9.9.2.4" xref="A1.E21.m1.9.9.2.4.cmml"><msub id="A1.E21.m1.9.9.2.4.1" xref="A1.E21.m1.9.9.2.4.1.cmml"><mo id="A1.E21.m1.9.9.2.4.1.2" xref="A1.E21.m1.9.9.2.4.1.2.cmml">∇</mo><mi id="A1.E21.m1.9.9.2.4.1.3" xref="A1.E21.m1.9.9.2.4.1.3.cmml">θ</mi></msub><msub id="A1.E21.m1.9.9.2.4.2" xref="A1.E21.m1.9.9.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E21.m1.9.9.2.4.2.2" xref="A1.E21.m1.9.9.2.4.2.2.cmml">ℒ</mi><mtext id="A1.E21.m1.9.9.2.4.2.3" xref="A1.E21.m1.9.9.2.4.2.3a.cmml">DPO</mtext></msub></mrow><mo id="A1.E21.m1.9.9.2.3" xref="A1.E21.m1.9.9.2.3.cmml">⁢</mo><mrow id="A1.E21.m1.9.9.2.2.2" xref="A1.E21.m1.9.9.2.2.3.cmml"><mo id="A1.E21.m1.9.9.2.2.2.3" stretchy="false" xref="A1.E21.m1.9.9.2.2.3.cmml">(</mo><msub id="A1.E21.m1.8.8.1.1.1.1" xref="A1.E21.m1.8.8.1.1.1.1.cmml"><mi id="A1.E21.m1.8.8.1.1.1.1.2" xref="A1.E21.m1.8.8.1.1.1.1.2.cmml">π</mi><mi id="A1.E21.m1.8.8.1.1.1.1.3" xref="A1.E21.m1.8.8.1.1.1.1.3.cmml">θ</mi></msub><mo id="A1.E21.m1.9.9.2.2.2.4" xref="A1.E21.m1.9.9.2.2.3.cmml">;</mo><msub id="A1.E21.m1.9.9.2.2.2.2" xref="A1.E21.m1.9.9.2.2.2.2.cmml"><mi id="A1.E21.m1.9.9.2.2.2.2.2" xref="A1.E21.m1.9.9.2.2.2.2.2.cmml">π</mi><mtext id="A1.E21.m1.9.9.2.2.2.2.3" xref="A1.E21.m1.9.9.2.2.2.2.3a.cmml">ref</mtext></msub><mo id="A1.E21.m1.9.9.2.2.2.5" stretchy="false" xref="A1.E21.m1.9.9.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E21.m1.10.10.4" xref="A1.E21.m1.10.10.4.cmml">=</mo><mrow id="A1.E21.m1.10.10.3" xref="A1.E21.m1.10.10.3.cmml"><mo id="A1.E21.m1.10.10.3a" rspace="0.167em" xref="A1.E21.m1.10.10.3.cmml">−</mo><mrow id="A1.E21.m1.10.10.3.1" xref="A1.E21.m1.10.10.3.1.cmml"><mrow id="A1.E21.m1.10.10.3.1.3" xref="A1.E21.m1.10.10.3.1.3.cmml"><msub id="A1.E21.m1.10.10.3.1.3.1" xref="A1.E21.m1.10.10.3.1.3.1.cmml"><mo id="A1.E21.m1.10.10.3.1.3.1.2" rspace="0.167em" xref="A1.E21.m1.10.10.3.1.3.1.2.cmml">∇</mo><mi id="A1.E21.m1.10.10.3.1.3.1.3" xref="A1.E21.m1.10.10.3.1.3.1.3.cmml">θ</mi></msub><msub id="A1.E21.m1.10.10.3.1.3.2" xref="A1.E21.m1.10.10.3.1.3.2.cmml"><mi id="A1.E21.m1.10.10.3.1.3.2.2" xref="A1.E21.m1.10.10.3.1.3.2.2.cmml">𝔼</mi><mrow id="A1.E21.m1.3.3.3" xref="A1.E21.m1.3.3.3.cmml"><mrow id="A1.E21.m1.3.3.3.3.2" xref="A1.E21.m1.3.3.3.3.3.cmml"><mo id="A1.E21.m1.3.3.3.3.2.3" stretchy="false" xref="A1.E21.m1.3.3.3.3.3.cmml">(</mo><mi id="A1.E21.m1.1.1.1.1" xref="A1.E21.m1.1.1.1.1.cmml">x</mi><mo id="A1.E21.m1.3.3.3.3.2.4" xref="A1.E21.m1.3.3.3.3.3.cmml">,</mo><msub id="A1.E21.m1.2.2.2.2.1.1" xref="A1.E21.m1.2.2.2.2.1.1.cmml"><mi id="A1.E21.m1.2.2.2.2.1.1.2" xref="A1.E21.m1.2.2.2.2.1.1.2.cmml">y</mi><mi id="A1.E21.m1.2.2.2.2.1.1.3" xref="A1.E21.m1.2.2.2.2.1.1.3.cmml">w</mi></msub><mo id="A1.E21.m1.3.3.3.3.2.5" xref="A1.E21.m1.3.3.3.3.3.cmml">,</mo><msub id="A1.E21.m1.3.3.3.3.2.2" xref="A1.E21.m1.3.3.3.3.2.2.cmml"><mi id="A1.E21.m1.3.3.3.3.2.2.2" xref="A1.E21.m1.3.3.3.3.2.2.2.cmml">y</mi><mi id="A1.E21.m1.3.3.3.3.2.2.3" xref="A1.E21.m1.3.3.3.3.2.2.3.cmml">l</mi></msub><mo id="A1.E21.m1.3.3.3.3.2.6" stretchy="false" xref="A1.E21.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="A1.E21.m1.3.3.3.4" xref="A1.E21.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E21.m1.3.3.3.5" xref="A1.E21.m1.3.3.3.5.cmml">𝒟</mi></mrow></msub></mrow><mo id="A1.E21.m1.10.10.3.1.2" xref="A1.E21.m1.10.10.3.1.2.cmml">⁢</mo><mrow id="A1.E21.m1.10.10.3.1.1.1" xref="A1.E21.m1.10.10.3.1.1.2.cmml"><mo id="A1.E21.m1.10.10.3.1.1.1.2" xref="A1.E21.m1.10.10.3.1.1.2.1.cmml">[</mo><mrow id="A1.E21.m1.10.10.3.1.1.1.1" xref="A1.E21.m1.10.10.3.1.1.1.1.cmml"><mrow id="A1.E21.m1.10.10.3.1.1.1.1.3" xref="A1.E21.m1.10.10.3.1.1.1.1.3.cmml"><mi id="A1.E21.m1.10.10.3.1.1.1.1.3.1" xref="A1.E21.m1.10.10.3.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E21.m1.10.10.3.1.1.1.1.3a" lspace="0.167em" xref="A1.E21.m1.10.10.3.1.1.1.1.3.cmml">⁡</mo><mi id="A1.E21.m1.10.10.3.1.1.1.1.3.2" xref="A1.E21.m1.10.10.3.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="A1.E21.m1.10.10.3.1.1.1.1.2" xref="A1.E21.m1.10.10.3.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E21.m1.10.10.3.1.1.1.1.1.1" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.cmml"><mo id="A1.E21.m1.10.10.3.1.1.1.1.1.1.2" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.cmml"><mrow id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.2" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.2.cmml">β</mi><mo id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.1" lspace="0.167em" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3.1" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mstyle displaystyle="true" id="A1.E21.m1.5.5" xref="A1.E21.m1.5.5.cmml"><mfrac id="A1.E21.m1.5.5a" xref="A1.E21.m1.5.5.cmml"><mrow id="A1.E21.m1.4.4.1" xref="A1.E21.m1.4.4.1.cmml"><msub id="A1.E21.m1.4.4.1.3" xref="A1.E21.m1.4.4.1.3.cmml"><mi id="A1.E21.m1.4.4.1.3.2" xref="A1.E21.m1.4.4.1.3.2.cmml">π</mi><mi id="A1.E21.m1.4.4.1.3.3" xref="A1.E21.m1.4.4.1.3.3.cmml">θ</mi></msub><mo id="A1.E21.m1.4.4.1.2" xref="A1.E21.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.E21.m1.4.4.1.1.1" xref="A1.E21.m1.4.4.1.1.1.1.cmml"><mo id="A1.E21.m1.4.4.1.1.1.2" stretchy="false" xref="A1.E21.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.E21.m1.4.4.1.1.1.1" xref="A1.E21.m1.4.4.1.1.1.1.cmml"><msub id="A1.E21.m1.4.4.1.1.1.1.2" xref="A1.E21.m1.4.4.1.1.1.1.2.cmml"><mi id="A1.E21.m1.4.4.1.1.1.1.2.2" xref="A1.E21.m1.4.4.1.1.1.1.2.2.cmml">y</mi><mi id="A1.E21.m1.4.4.1.1.1.1.2.3" xref="A1.E21.m1.4.4.1.1.1.1.2.3.cmml">l</mi></msub><mo fence="false" id="A1.E21.m1.4.4.1.1.1.1.1" xref="A1.E21.m1.4.4.1.1.1.1.1.cmml">|</mo><mi id="A1.E21.m1.4.4.1.1.1.1.3" xref="A1.E21.m1.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E21.m1.4.4.1.1.1.3" stretchy="false" xref="A1.E21.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E21.m1.5.5.2" xref="A1.E21.m1.5.5.2.cmml"><msub id="A1.E21.m1.5.5.2.3" xref="A1.E21.m1.5.5.2.3.cmml"><mi id="A1.E21.m1.5.5.2.3.2" xref="A1.E21.m1.5.5.2.3.2.cmml">π</mi><mtext id="A1.E21.m1.5.5.2.3.3" xref="A1.E21.m1.5.5.2.3.3a.cmml">ref</mtext></msub><mo id="A1.E21.m1.5.5.2.2" xref="A1.E21.m1.5.5.2.2.cmml">⁢</mo><mrow id="A1.E21.m1.5.5.2.1.1" xref="A1.E21.m1.5.5.2.1.1.1.cmml"><mo id="A1.E21.m1.5.5.2.1.1.2" stretchy="false" xref="A1.E21.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="A1.E21.m1.5.5.2.1.1.1" xref="A1.E21.m1.5.5.2.1.1.1.cmml"><msub id="A1.E21.m1.5.5.2.1.1.1.2" xref="A1.E21.m1.5.5.2.1.1.1.2.cmml"><mi id="A1.E21.m1.5.5.2.1.1.1.2.2" xref="A1.E21.m1.5.5.2.1.1.1.2.2.cmml">y</mi><mi id="A1.E21.m1.5.5.2.1.1.1.2.3" xref="A1.E21.m1.5.5.2.1.1.1.2.3.cmml">l</mi></msub><mo fence="false" id="A1.E21.m1.5.5.2.1.1.1.1" xref="A1.E21.m1.5.5.2.1.1.1.1.cmml">|</mo><mi id="A1.E21.m1.5.5.2.1.1.1.3" xref="A1.E21.m1.5.5.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E21.m1.5.5.2.1.1.3" stretchy="false" xref="A1.E21.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.1" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.2" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.1" lspace="0.167em" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3.1" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3.1.cmml">log</mi><mo id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3a" lspace="0.167em" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3.cmml">⁡</mo><mstyle displaystyle="true" id="A1.E21.m1.7.7" xref="A1.E21.m1.7.7.cmml"><mfrac id="A1.E21.m1.7.7a" xref="A1.E21.m1.7.7.cmml"><mrow id="A1.E21.m1.6.6.1" xref="A1.E21.m1.6.6.1.cmml"><msub id="A1.E21.m1.6.6.1.3" xref="A1.E21.m1.6.6.1.3.cmml"><mi id="A1.E21.m1.6.6.1.3.2" xref="A1.E21.m1.6.6.1.3.2.cmml">π</mi><mi id="A1.E21.m1.6.6.1.3.3" xref="A1.E21.m1.6.6.1.3.3.cmml">θ</mi></msub><mo id="A1.E21.m1.6.6.1.2" xref="A1.E21.m1.6.6.1.2.cmml">⁢</mo><mrow id="A1.E21.m1.6.6.1.1.1" xref="A1.E21.m1.6.6.1.1.1.1.cmml"><mo id="A1.E21.m1.6.6.1.1.1.2" stretchy="false" xref="A1.E21.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="A1.E21.m1.6.6.1.1.1.1" xref="A1.E21.m1.6.6.1.1.1.1.cmml"><msub id="A1.E21.m1.6.6.1.1.1.1.2" xref="A1.E21.m1.6.6.1.1.1.1.2.cmml"><mi id="A1.E21.m1.6.6.1.1.1.1.2.2" xref="A1.E21.m1.6.6.1.1.1.1.2.2.cmml">y</mi><mi id="A1.E21.m1.6.6.1.1.1.1.2.3" xref="A1.E21.m1.6.6.1.1.1.1.2.3.cmml">w</mi></msub><mo fence="false" id="A1.E21.m1.6.6.1.1.1.1.1" xref="A1.E21.m1.6.6.1.1.1.1.1.cmml">|</mo><mi id="A1.E21.m1.6.6.1.1.1.1.3" xref="A1.E21.m1.6.6.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E21.m1.6.6.1.1.1.3" stretchy="false" xref="A1.E21.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E21.m1.7.7.2" xref="A1.E21.m1.7.7.2.cmml"><msub id="A1.E21.m1.7.7.2.3" xref="A1.E21.m1.7.7.2.3.cmml"><mi id="A1.E21.m1.7.7.2.3.2" xref="A1.E21.m1.7.7.2.3.2.cmml">π</mi><mtext id="A1.E21.m1.7.7.2.3.3" xref="A1.E21.m1.7.7.2.3.3a.cmml">ref</mtext></msub><mo id="A1.E21.m1.7.7.2.2" xref="A1.E21.m1.7.7.2.2.cmml">⁢</mo><mrow id="A1.E21.m1.7.7.2.1.1" xref="A1.E21.m1.7.7.2.1.1.1.cmml"><mo id="A1.E21.m1.7.7.2.1.1.2" stretchy="false" xref="A1.E21.m1.7.7.2.1.1.1.cmml">(</mo><mrow id="A1.E21.m1.7.7.2.1.1.1" xref="A1.E21.m1.7.7.2.1.1.1.cmml"><msub id="A1.E21.m1.7.7.2.1.1.1.2" xref="A1.E21.m1.7.7.2.1.1.1.2.cmml"><mi id="A1.E21.m1.7.7.2.1.1.1.2.2" xref="A1.E21.m1.7.7.2.1.1.1.2.2.cmml">y</mi><mi id="A1.E21.m1.7.7.2.1.1.1.2.3" xref="A1.E21.m1.7.7.2.1.1.1.2.3.cmml">w</mi></msub><mo fence="false" id="A1.E21.m1.7.7.2.1.1.1.1" xref="A1.E21.m1.7.7.2.1.1.1.1.cmml">|</mo><mi id="A1.E21.m1.7.7.2.1.1.1.3" xref="A1.E21.m1.7.7.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E21.m1.7.7.2.1.1.3" stretchy="false" xref="A1.E21.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="A1.E21.m1.10.10.3.1.1.1.1.1.1.3" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E21.m1.10.10.3.1.1.1.3" xref="A1.E21.m1.10.10.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E21.m1.10b"><apply id="A1.E21.m1.10.10.cmml" xref="A1.E21.m1.10.10"><eq id="A1.E21.m1.10.10.4.cmml" xref="A1.E21.m1.10.10.4"></eq><apply id="A1.E21.m1.9.9.2.cmml" xref="A1.E21.m1.9.9.2"><times id="A1.E21.m1.9.9.2.3.cmml" xref="A1.E21.m1.9.9.2.3"></times><apply id="A1.E21.m1.9.9.2.4.cmml" xref="A1.E21.m1.9.9.2.4"><apply id="A1.E21.m1.9.9.2.4.1.cmml" xref="A1.E21.m1.9.9.2.4.1"><csymbol cd="ambiguous" id="A1.E21.m1.9.9.2.4.1.1.cmml" xref="A1.E21.m1.9.9.2.4.1">subscript</csymbol><ci id="A1.E21.m1.9.9.2.4.1.2.cmml" xref="A1.E21.m1.9.9.2.4.1.2">∇</ci><ci id="A1.E21.m1.9.9.2.4.1.3.cmml" xref="A1.E21.m1.9.9.2.4.1.3">𝜃</ci></apply><apply id="A1.E21.m1.9.9.2.4.2.cmml" xref="A1.E21.m1.9.9.2.4.2"><csymbol cd="ambiguous" id="A1.E21.m1.9.9.2.4.2.1.cmml" xref="A1.E21.m1.9.9.2.4.2">subscript</csymbol><ci id="A1.E21.m1.9.9.2.4.2.2.cmml" xref="A1.E21.m1.9.9.2.4.2.2">ℒ</ci><ci id="A1.E21.m1.9.9.2.4.2.3a.cmml" xref="A1.E21.m1.9.9.2.4.2.3"><mtext id="A1.E21.m1.9.9.2.4.2.3.cmml" mathsize="70%" xref="A1.E21.m1.9.9.2.4.2.3">DPO</mtext></ci></apply></apply><list id="A1.E21.m1.9.9.2.2.3.cmml" xref="A1.E21.m1.9.9.2.2.2"><apply id="A1.E21.m1.8.8.1.1.1.1.cmml" xref="A1.E21.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="A1.E21.m1.8.8.1.1.1.1.1.cmml" xref="A1.E21.m1.8.8.1.1.1.1">subscript</csymbol><ci id="A1.E21.m1.8.8.1.1.1.1.2.cmml" xref="A1.E21.m1.8.8.1.1.1.1.2">𝜋</ci><ci id="A1.E21.m1.8.8.1.1.1.1.3.cmml" xref="A1.E21.m1.8.8.1.1.1.1.3">𝜃</ci></apply><apply id="A1.E21.m1.9.9.2.2.2.2.cmml" xref="A1.E21.m1.9.9.2.2.2.2"><csymbol cd="ambiguous" id="A1.E21.m1.9.9.2.2.2.2.1.cmml" xref="A1.E21.m1.9.9.2.2.2.2">subscript</csymbol><ci id="A1.E21.m1.9.9.2.2.2.2.2.cmml" xref="A1.E21.m1.9.9.2.2.2.2.2">𝜋</ci><ci id="A1.E21.m1.9.9.2.2.2.2.3a.cmml" xref="A1.E21.m1.9.9.2.2.2.2.3"><mtext id="A1.E21.m1.9.9.2.2.2.2.3.cmml" mathsize="70%" xref="A1.E21.m1.9.9.2.2.2.2.3">ref</mtext></ci></apply></list></apply><apply id="A1.E21.m1.10.10.3.cmml" xref="A1.E21.m1.10.10.3"><minus id="A1.E21.m1.10.10.3.2.cmml" xref="A1.E21.m1.10.10.3"></minus><apply id="A1.E21.m1.10.10.3.1.cmml" xref="A1.E21.m1.10.10.3.1"><times id="A1.E21.m1.10.10.3.1.2.cmml" xref="A1.E21.m1.10.10.3.1.2"></times><apply id="A1.E21.m1.10.10.3.1.3.cmml" xref="A1.E21.m1.10.10.3.1.3"><apply id="A1.E21.m1.10.10.3.1.3.1.cmml" xref="A1.E21.m1.10.10.3.1.3.1"><csymbol cd="ambiguous" id="A1.E21.m1.10.10.3.1.3.1.1.cmml" xref="A1.E21.m1.10.10.3.1.3.1">subscript</csymbol><ci id="A1.E21.m1.10.10.3.1.3.1.2.cmml" xref="A1.E21.m1.10.10.3.1.3.1.2">∇</ci><ci id="A1.E21.m1.10.10.3.1.3.1.3.cmml" xref="A1.E21.m1.10.10.3.1.3.1.3">𝜃</ci></apply><apply id="A1.E21.m1.10.10.3.1.3.2.cmml" xref="A1.E21.m1.10.10.3.1.3.2"><csymbol cd="ambiguous" id="A1.E21.m1.10.10.3.1.3.2.1.cmml" xref="A1.E21.m1.10.10.3.1.3.2">subscript</csymbol><ci id="A1.E21.m1.10.10.3.1.3.2.2.cmml" xref="A1.E21.m1.10.10.3.1.3.2.2">𝔼</ci><apply id="A1.E21.m1.3.3.3.cmml" xref="A1.E21.m1.3.3.3"><csymbol cd="latexml" id="A1.E21.m1.3.3.3.4.cmml" xref="A1.E21.m1.3.3.3.4">similar-to</csymbol><vector id="A1.E21.m1.3.3.3.3.3.cmml" xref="A1.E21.m1.3.3.3.3.2"><ci id="A1.E21.m1.1.1.1.1.cmml" xref="A1.E21.m1.1.1.1.1">𝑥</ci><apply id="A1.E21.m1.2.2.2.2.1.1.cmml" xref="A1.E21.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E21.m1.2.2.2.2.1.1.1.cmml" xref="A1.E21.m1.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E21.m1.2.2.2.2.1.1.2.cmml" xref="A1.E21.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="A1.E21.m1.2.2.2.2.1.1.3.cmml" xref="A1.E21.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="A1.E21.m1.3.3.3.3.2.2.cmml" xref="A1.E21.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="A1.E21.m1.3.3.3.3.2.2.1.cmml" xref="A1.E21.m1.3.3.3.3.2.2">subscript</csymbol><ci id="A1.E21.m1.3.3.3.3.2.2.2.cmml" xref="A1.E21.m1.3.3.3.3.2.2.2">𝑦</ci><ci id="A1.E21.m1.3.3.3.3.2.2.3.cmml" xref="A1.E21.m1.3.3.3.3.2.2.3">𝑙</ci></apply></vector><ci id="A1.E21.m1.3.3.3.5.cmml" xref="A1.E21.m1.3.3.3.5">𝒟</ci></apply></apply></apply><apply id="A1.E21.m1.10.10.3.1.1.2.cmml" xref="A1.E21.m1.10.10.3.1.1.1"><csymbol cd="latexml" id="A1.E21.m1.10.10.3.1.1.2.1.cmml" xref="A1.E21.m1.10.10.3.1.1.1.2">delimited-[]</csymbol><apply id="A1.E21.m1.10.10.3.1.1.1.1.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1"><times id="A1.E21.m1.10.10.3.1.1.1.1.2.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.2"></times><apply id="A1.E21.m1.10.10.3.1.1.1.1.3.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.3"><log id="A1.E21.m1.10.10.3.1.1.1.1.3.1.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.3.1"></log><ci id="A1.E21.m1.10.10.3.1.1.1.1.3.2.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.3.2">𝜎</ci></apply><apply id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1"><minus id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.1"></minus><apply id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2"><times id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.1"></times><ci id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.2">𝛽</ci><apply id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3"><log id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.2.3.1"></log><apply id="A1.E21.m1.5.5.cmml" xref="A1.E21.m1.5.5"><divide id="A1.E21.m1.5.5.3.cmml" xref="A1.E21.m1.5.5"></divide><apply id="A1.E21.m1.4.4.1.cmml" xref="A1.E21.m1.4.4.1"><times id="A1.E21.m1.4.4.1.2.cmml" xref="A1.E21.m1.4.4.1.2"></times><apply id="A1.E21.m1.4.4.1.3.cmml" xref="A1.E21.m1.4.4.1.3"><csymbol cd="ambiguous" id="A1.E21.m1.4.4.1.3.1.cmml" xref="A1.E21.m1.4.4.1.3">subscript</csymbol><ci id="A1.E21.m1.4.4.1.3.2.cmml" xref="A1.E21.m1.4.4.1.3.2">𝜋</ci><ci id="A1.E21.m1.4.4.1.3.3.cmml" xref="A1.E21.m1.4.4.1.3.3">𝜃</ci></apply><apply id="A1.E21.m1.4.4.1.1.1.1.cmml" xref="A1.E21.m1.4.4.1.1.1"><csymbol cd="latexml" id="A1.E21.m1.4.4.1.1.1.1.1.cmml" xref="A1.E21.m1.4.4.1.1.1.1.1">conditional</csymbol><apply id="A1.E21.m1.4.4.1.1.1.1.2.cmml" xref="A1.E21.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E21.m1.4.4.1.1.1.1.2.1.cmml" xref="A1.E21.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="A1.E21.m1.4.4.1.1.1.1.2.2.cmml" xref="A1.E21.m1.4.4.1.1.1.1.2.2">𝑦</ci><ci id="A1.E21.m1.4.4.1.1.1.1.2.3.cmml" xref="A1.E21.m1.4.4.1.1.1.1.2.3">𝑙</ci></apply><ci id="A1.E21.m1.4.4.1.1.1.1.3.cmml" xref="A1.E21.m1.4.4.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.E21.m1.5.5.2.cmml" xref="A1.E21.m1.5.5.2"><times id="A1.E21.m1.5.5.2.2.cmml" xref="A1.E21.m1.5.5.2.2"></times><apply id="A1.E21.m1.5.5.2.3.cmml" xref="A1.E21.m1.5.5.2.3"><csymbol cd="ambiguous" id="A1.E21.m1.5.5.2.3.1.cmml" xref="A1.E21.m1.5.5.2.3">subscript</csymbol><ci id="A1.E21.m1.5.5.2.3.2.cmml" xref="A1.E21.m1.5.5.2.3.2">𝜋</ci><ci id="A1.E21.m1.5.5.2.3.3a.cmml" xref="A1.E21.m1.5.5.2.3.3"><mtext id="A1.E21.m1.5.5.2.3.3.cmml" mathsize="70%" xref="A1.E21.m1.5.5.2.3.3">ref</mtext></ci></apply><apply id="A1.E21.m1.5.5.2.1.1.1.cmml" xref="A1.E21.m1.5.5.2.1.1"><csymbol cd="latexml" id="A1.E21.m1.5.5.2.1.1.1.1.cmml" xref="A1.E21.m1.5.5.2.1.1.1.1">conditional</csymbol><apply id="A1.E21.m1.5.5.2.1.1.1.2.cmml" xref="A1.E21.m1.5.5.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E21.m1.5.5.2.1.1.1.2.1.cmml" xref="A1.E21.m1.5.5.2.1.1.1.2">subscript</csymbol><ci id="A1.E21.m1.5.5.2.1.1.1.2.2.cmml" xref="A1.E21.m1.5.5.2.1.1.1.2.2">𝑦</ci><ci id="A1.E21.m1.5.5.2.1.1.1.2.3.cmml" xref="A1.E21.m1.5.5.2.1.1.1.2.3">𝑙</ci></apply><ci id="A1.E21.m1.5.5.2.1.1.1.3.cmml" xref="A1.E21.m1.5.5.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3"><times id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.1"></times><ci id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.2">𝛽</ci><apply id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3"><log id="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E21.m1.10.10.3.1.1.1.1.1.1.1.3.3.1"></log><apply id="A1.E21.m1.7.7.cmml" xref="A1.E21.m1.7.7"><divide id="A1.E21.m1.7.7.3.cmml" xref="A1.E21.m1.7.7"></divide><apply id="A1.E21.m1.6.6.1.cmml" xref="A1.E21.m1.6.6.1"><times id="A1.E21.m1.6.6.1.2.cmml" xref="A1.E21.m1.6.6.1.2"></times><apply id="A1.E21.m1.6.6.1.3.cmml" xref="A1.E21.m1.6.6.1.3"><csymbol cd="ambiguous" id="A1.E21.m1.6.6.1.3.1.cmml" xref="A1.E21.m1.6.6.1.3">subscript</csymbol><ci id="A1.E21.m1.6.6.1.3.2.cmml" xref="A1.E21.m1.6.6.1.3.2">𝜋</ci><ci id="A1.E21.m1.6.6.1.3.3.cmml" xref="A1.E21.m1.6.6.1.3.3">𝜃</ci></apply><apply id="A1.E21.m1.6.6.1.1.1.1.cmml" xref="A1.E21.m1.6.6.1.1.1"><csymbol cd="latexml" id="A1.E21.m1.6.6.1.1.1.1.1.cmml" xref="A1.E21.m1.6.6.1.1.1.1.1">conditional</csymbol><apply id="A1.E21.m1.6.6.1.1.1.1.2.cmml" xref="A1.E21.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E21.m1.6.6.1.1.1.1.2.1.cmml" xref="A1.E21.m1.6.6.1.1.1.1.2">subscript</csymbol><ci id="A1.E21.m1.6.6.1.1.1.1.2.2.cmml" xref="A1.E21.m1.6.6.1.1.1.1.2.2">𝑦</ci><ci id="A1.E21.m1.6.6.1.1.1.1.2.3.cmml" xref="A1.E21.m1.6.6.1.1.1.1.2.3">𝑤</ci></apply><ci id="A1.E21.m1.6.6.1.1.1.1.3.cmml" xref="A1.E21.m1.6.6.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.E21.m1.7.7.2.cmml" xref="A1.E21.m1.7.7.2"><times id="A1.E21.m1.7.7.2.2.cmml" xref="A1.E21.m1.7.7.2.2"></times><apply id="A1.E21.m1.7.7.2.3.cmml" xref="A1.E21.m1.7.7.2.3"><csymbol cd="ambiguous" id="A1.E21.m1.7.7.2.3.1.cmml" xref="A1.E21.m1.7.7.2.3">subscript</csymbol><ci id="A1.E21.m1.7.7.2.3.2.cmml" xref="A1.E21.m1.7.7.2.3.2">𝜋</ci><ci id="A1.E21.m1.7.7.2.3.3a.cmml" xref="A1.E21.m1.7.7.2.3.3"><mtext id="A1.E21.m1.7.7.2.3.3.cmml" mathsize="70%" xref="A1.E21.m1.7.7.2.3.3">ref</mtext></ci></apply><apply id="A1.E21.m1.7.7.2.1.1.1.cmml" xref="A1.E21.m1.7.7.2.1.1"><csymbol cd="latexml" id="A1.E21.m1.7.7.2.1.1.1.1.cmml" xref="A1.E21.m1.7.7.2.1.1.1.1">conditional</csymbol><apply id="A1.E21.m1.7.7.2.1.1.1.2.cmml" xref="A1.E21.m1.7.7.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E21.m1.7.7.2.1.1.1.2.1.cmml" xref="A1.E21.m1.7.7.2.1.1.1.2">subscript</csymbol><ci id="A1.E21.m1.7.7.2.1.1.1.2.2.cmml" xref="A1.E21.m1.7.7.2.1.1.1.2.2">𝑦</ci><ci id="A1.E21.m1.7.7.2.1.1.1.2.3.cmml" xref="A1.E21.m1.7.7.2.1.1.1.2.3">𝑤</ci></apply><ci id="A1.E21.m1.7.7.2.1.1.1.3.cmml" xref="A1.E21.m1.7.7.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E21.m1.10c">\displaystyle\nabla_{\theta}\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{%
ref}})=-\nabla_{\theta}\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\left[\log%
\sigma\left(\beta\log\frac{\pi_{\theta}(y_{l}|x)}{\pi_{\text{ref}}(y_{l}|x)}-%
\beta\log\frac{\pi_{\theta}(y_{w}|x)}{\pi_{\text{ref}}(y_{w}|x)}\right)\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E21.m1.10d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ; italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) = - ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ roman_log italic_σ ( italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) end_ARG ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS4.p2">
<p class="ltx_p" id="A1.SS4.p2.2">우리는 식 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A1.E21" title="21 ‣ A.4 Deriving the Gradient of the DPO Objective ‣ Appendix A Mathematical Derivations ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">21</span></a>의 RHS를 다시 쓸 수 있다.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx5">
<tbody id="A1.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla_{\theta}\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{%
ref}})=-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\left[\frac{\sigma^{\prime}%
\left(u\right)}{\sigma\left(u\right)}\nabla_{\theta}\left(u\right)\right]," class="ltx_Math" display="inline" id="A1.E22.m1.7"><semantics id="A1.E22.m1.7a"><mrow id="A1.E22.m1.7.7.1" xref="A1.E22.m1.7.7.1.1.cmml"><mrow id="A1.E22.m1.7.7.1.1" xref="A1.E22.m1.7.7.1.1.cmml"><mrow id="A1.E22.m1.7.7.1.1.2" xref="A1.E22.m1.7.7.1.1.2.cmml"><mrow id="A1.E22.m1.7.7.1.1.2.4" xref="A1.E22.m1.7.7.1.1.2.4.cmml"><msub id="A1.E22.m1.7.7.1.1.2.4.1" xref="A1.E22.m1.7.7.1.1.2.4.1.cmml"><mo id="A1.E22.m1.7.7.1.1.2.4.1.2" xref="A1.E22.m1.7.7.1.1.2.4.1.2.cmml">∇</mo><mi id="A1.E22.m1.7.7.1.1.2.4.1.3" xref="A1.E22.m1.7.7.1.1.2.4.1.3.cmml">θ</mi></msub><msub id="A1.E22.m1.7.7.1.1.2.4.2" xref="A1.E22.m1.7.7.1.1.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E22.m1.7.7.1.1.2.4.2.2" xref="A1.E22.m1.7.7.1.1.2.4.2.2.cmml">ℒ</mi><mtext id="A1.E22.m1.7.7.1.1.2.4.2.3" xref="A1.E22.m1.7.7.1.1.2.4.2.3a.cmml">DPO</mtext></msub></mrow><mo id="A1.E22.m1.7.7.1.1.2.3" xref="A1.E22.m1.7.7.1.1.2.3.cmml">⁢</mo><mrow id="A1.E22.m1.7.7.1.1.2.2.2" xref="A1.E22.m1.7.7.1.1.2.2.3.cmml"><mo id="A1.E22.m1.7.7.1.1.2.2.2.3" stretchy="false" xref="A1.E22.m1.7.7.1.1.2.2.3.cmml">(</mo><msub id="A1.E22.m1.7.7.1.1.1.1.1.1" xref="A1.E22.m1.7.7.1.1.1.1.1.1.cmml"><mi id="A1.E22.m1.7.7.1.1.1.1.1.1.2" xref="A1.E22.m1.7.7.1.1.1.1.1.1.2.cmml">π</mi><mi id="A1.E22.m1.7.7.1.1.1.1.1.1.3" xref="A1.E22.m1.7.7.1.1.1.1.1.1.3.cmml">θ</mi></msub><mo id="A1.E22.m1.7.7.1.1.2.2.2.4" xref="A1.E22.m1.7.7.1.1.2.2.3.cmml">;</mo><msub id="A1.E22.m1.7.7.1.1.2.2.2.2" xref="A1.E22.m1.7.7.1.1.2.2.2.2.cmml"><mi id="A1.E22.m1.7.7.1.1.2.2.2.2.2" xref="A1.E22.m1.7.7.1.1.2.2.2.2.2.cmml">π</mi><mtext id="A1.E22.m1.7.7.1.1.2.2.2.2.3" xref="A1.E22.m1.7.7.1.1.2.2.2.2.3a.cmml">ref</mtext></msub><mo id="A1.E22.m1.7.7.1.1.2.2.2.5" stretchy="false" xref="A1.E22.m1.7.7.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E22.m1.7.7.1.1.4" xref="A1.E22.m1.7.7.1.1.4.cmml">=</mo><mrow id="A1.E22.m1.7.7.1.1.3" xref="A1.E22.m1.7.7.1.1.3.cmml"><mo id="A1.E22.m1.7.7.1.1.3a" xref="A1.E22.m1.7.7.1.1.3.cmml">−</mo><mrow id="A1.E22.m1.7.7.1.1.3.1" xref="A1.E22.m1.7.7.1.1.3.1.cmml"><msub id="A1.E22.m1.7.7.1.1.3.1.3" xref="A1.E22.m1.7.7.1.1.3.1.3.cmml"><mi id="A1.E22.m1.7.7.1.1.3.1.3.2" xref="A1.E22.m1.7.7.1.1.3.1.3.2.cmml">𝔼</mi><mrow id="A1.E22.m1.3.3.3" xref="A1.E22.m1.3.3.3.cmml"><mrow id="A1.E22.m1.3.3.3.3.2" xref="A1.E22.m1.3.3.3.3.3.cmml"><mo id="A1.E22.m1.3.3.3.3.2.3" stretchy="false" xref="A1.E22.m1.3.3.3.3.3.cmml">(</mo><mi id="A1.E22.m1.1.1.1.1" xref="A1.E22.m1.1.1.1.1.cmml">x</mi><mo id="A1.E22.m1.3.3.3.3.2.4" xref="A1.E22.m1.3.3.3.3.3.cmml">,</mo><msub id="A1.E22.m1.2.2.2.2.1.1" xref="A1.E22.m1.2.2.2.2.1.1.cmml"><mi id="A1.E22.m1.2.2.2.2.1.1.2" xref="A1.E22.m1.2.2.2.2.1.1.2.cmml">y</mi><mi id="A1.E22.m1.2.2.2.2.1.1.3" xref="A1.E22.m1.2.2.2.2.1.1.3.cmml">w</mi></msub><mo id="A1.E22.m1.3.3.3.3.2.5" xref="A1.E22.m1.3.3.3.3.3.cmml">,</mo><msub id="A1.E22.m1.3.3.3.3.2.2" xref="A1.E22.m1.3.3.3.3.2.2.cmml"><mi id="A1.E22.m1.3.3.3.3.2.2.2" xref="A1.E22.m1.3.3.3.3.2.2.2.cmml">y</mi><mi id="A1.E22.m1.3.3.3.3.2.2.3" xref="A1.E22.m1.3.3.3.3.2.2.3.cmml">l</mi></msub><mo id="A1.E22.m1.3.3.3.3.2.6" stretchy="false" xref="A1.E22.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="A1.E22.m1.3.3.3.4" xref="A1.E22.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E22.m1.3.3.3.5" xref="A1.E22.m1.3.3.3.5.cmml">𝒟</mi></mrow></msub><mo id="A1.E22.m1.7.7.1.1.3.1.2" xref="A1.E22.m1.7.7.1.1.3.1.2.cmml">⁢</mo><mrow id="A1.E22.m1.7.7.1.1.3.1.1.1" xref="A1.E22.m1.7.7.1.1.3.1.1.2.cmml"><mo id="A1.E22.m1.7.7.1.1.3.1.1.1.2" xref="A1.E22.m1.7.7.1.1.3.1.1.2.1.cmml">[</mo><mrow id="A1.E22.m1.7.7.1.1.3.1.1.1.1" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E22.m1.5.5" xref="A1.E22.m1.5.5.cmml"><mfrac id="A1.E22.m1.5.5a" xref="A1.E22.m1.5.5.cmml"><mrow id="A1.E22.m1.4.4.1" xref="A1.E22.m1.4.4.1.cmml"><msup id="A1.E22.m1.4.4.1.3" xref="A1.E22.m1.4.4.1.3.cmml"><mi id="A1.E22.m1.4.4.1.3.2" xref="A1.E22.m1.4.4.1.3.2.cmml">σ</mi><mo id="A1.E22.m1.4.4.1.3.3" xref="A1.E22.m1.4.4.1.3.3.cmml">′</mo></msup><mo id="A1.E22.m1.4.4.1.2" xref="A1.E22.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.E22.m1.4.4.1.4.2" xref="A1.E22.m1.4.4.1.cmml"><mo id="A1.E22.m1.4.4.1.4.2.1" xref="A1.E22.m1.4.4.1.cmml">(</mo><mi id="A1.E22.m1.4.4.1.1" xref="A1.E22.m1.4.4.1.1.cmml">u</mi><mo id="A1.E22.m1.4.4.1.4.2.2" xref="A1.E22.m1.4.4.1.cmml">)</mo></mrow></mrow><mrow id="A1.E22.m1.5.5.2" xref="A1.E22.m1.5.5.2.cmml"><mi id="A1.E22.m1.5.5.2.3" xref="A1.E22.m1.5.5.2.3.cmml">σ</mi><mo id="A1.E22.m1.5.5.2.2" xref="A1.E22.m1.5.5.2.2.cmml">⁢</mo><mrow id="A1.E22.m1.5.5.2.4.2" xref="A1.E22.m1.5.5.2.cmml"><mo id="A1.E22.m1.5.5.2.4.2.1" xref="A1.E22.m1.5.5.2.cmml">(</mo><mi id="A1.E22.m1.5.5.2.1" xref="A1.E22.m1.5.5.2.1.cmml">u</mi><mo id="A1.E22.m1.5.5.2.4.2.2" xref="A1.E22.m1.5.5.2.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="A1.E22.m1.7.7.1.1.3.1.1.1.1.2" lspace="0.167em" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.2.cmml"><msub id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.cmml"><mo id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.2" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.2.cmml">∇</mo><mi id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.3" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><mrow id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.2" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.2.cmml"><mo id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.2.1" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E22.m1.6.6" xref="A1.E22.m1.6.6.cmml">u</mi><mo id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.2.2" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E22.m1.7.7.1.1.3.1.1.1.3" xref="A1.E22.m1.7.7.1.1.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="A1.E22.m1.7.7.1.2" xref="A1.E22.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E22.m1.7b"><apply id="A1.E22.m1.7.7.1.1.cmml" xref="A1.E22.m1.7.7.1"><eq id="A1.E22.m1.7.7.1.1.4.cmml" xref="A1.E22.m1.7.7.1.1.4"></eq><apply id="A1.E22.m1.7.7.1.1.2.cmml" xref="A1.E22.m1.7.7.1.1.2"><times id="A1.E22.m1.7.7.1.1.2.3.cmml" xref="A1.E22.m1.7.7.1.1.2.3"></times><apply id="A1.E22.m1.7.7.1.1.2.4.cmml" xref="A1.E22.m1.7.7.1.1.2.4"><apply id="A1.E22.m1.7.7.1.1.2.4.1.cmml" xref="A1.E22.m1.7.7.1.1.2.4.1"><csymbol cd="ambiguous" id="A1.E22.m1.7.7.1.1.2.4.1.1.cmml" xref="A1.E22.m1.7.7.1.1.2.4.1">subscript</csymbol><ci id="A1.E22.m1.7.7.1.1.2.4.1.2.cmml" xref="A1.E22.m1.7.7.1.1.2.4.1.2">∇</ci><ci id="A1.E22.m1.7.7.1.1.2.4.1.3.cmml" xref="A1.E22.m1.7.7.1.1.2.4.1.3">𝜃</ci></apply><apply id="A1.E22.m1.7.7.1.1.2.4.2.cmml" xref="A1.E22.m1.7.7.1.1.2.4.2"><csymbol cd="ambiguous" id="A1.E22.m1.7.7.1.1.2.4.2.1.cmml" xref="A1.E22.m1.7.7.1.1.2.4.2">subscript</csymbol><ci id="A1.E22.m1.7.7.1.1.2.4.2.2.cmml" xref="A1.E22.m1.7.7.1.1.2.4.2.2">ℒ</ci><ci id="A1.E22.m1.7.7.1.1.2.4.2.3a.cmml" xref="A1.E22.m1.7.7.1.1.2.4.2.3"><mtext id="A1.E22.m1.7.7.1.1.2.4.2.3.cmml" mathsize="70%" xref="A1.E22.m1.7.7.1.1.2.4.2.3">DPO</mtext></ci></apply></apply><list id="A1.E22.m1.7.7.1.1.2.2.3.cmml" xref="A1.E22.m1.7.7.1.1.2.2.2"><apply id="A1.E22.m1.7.7.1.1.1.1.1.1.cmml" xref="A1.E22.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E22.m1.7.7.1.1.1.1.1.1.1.cmml" xref="A1.E22.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E22.m1.7.7.1.1.1.1.1.1.2.cmml" xref="A1.E22.m1.7.7.1.1.1.1.1.1.2">𝜋</ci><ci id="A1.E22.m1.7.7.1.1.1.1.1.1.3.cmml" xref="A1.E22.m1.7.7.1.1.1.1.1.1.3">𝜃</ci></apply><apply id="A1.E22.m1.7.7.1.1.2.2.2.2.cmml" xref="A1.E22.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E22.m1.7.7.1.1.2.2.2.2.1.cmml" xref="A1.E22.m1.7.7.1.1.2.2.2.2">subscript</csymbol><ci id="A1.E22.m1.7.7.1.1.2.2.2.2.2.cmml" xref="A1.E22.m1.7.7.1.1.2.2.2.2.2">𝜋</ci><ci id="A1.E22.m1.7.7.1.1.2.2.2.2.3a.cmml" xref="A1.E22.m1.7.7.1.1.2.2.2.2.3"><mtext id="A1.E22.m1.7.7.1.1.2.2.2.2.3.cmml" mathsize="70%" xref="A1.E22.m1.7.7.1.1.2.2.2.2.3">ref</mtext></ci></apply></list></apply><apply id="A1.E22.m1.7.7.1.1.3.cmml" xref="A1.E22.m1.7.7.1.1.3"><minus id="A1.E22.m1.7.7.1.1.3.2.cmml" xref="A1.E22.m1.7.7.1.1.3"></minus><apply id="A1.E22.m1.7.7.1.1.3.1.cmml" xref="A1.E22.m1.7.7.1.1.3.1"><times id="A1.E22.m1.7.7.1.1.3.1.2.cmml" xref="A1.E22.m1.7.7.1.1.3.1.2"></times><apply id="A1.E22.m1.7.7.1.1.3.1.3.cmml" xref="A1.E22.m1.7.7.1.1.3.1.3"><csymbol cd="ambiguous" id="A1.E22.m1.7.7.1.1.3.1.3.1.cmml" xref="A1.E22.m1.7.7.1.1.3.1.3">subscript</csymbol><ci id="A1.E22.m1.7.7.1.1.3.1.3.2.cmml" xref="A1.E22.m1.7.7.1.1.3.1.3.2">𝔼</ci><apply id="A1.E22.m1.3.3.3.cmml" xref="A1.E22.m1.3.3.3"><csymbol cd="latexml" id="A1.E22.m1.3.3.3.4.cmml" xref="A1.E22.m1.3.3.3.4">similar-to</csymbol><vector id="A1.E22.m1.3.3.3.3.3.cmml" xref="A1.E22.m1.3.3.3.3.2"><ci id="A1.E22.m1.1.1.1.1.cmml" xref="A1.E22.m1.1.1.1.1">𝑥</ci><apply id="A1.E22.m1.2.2.2.2.1.1.cmml" xref="A1.E22.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E22.m1.2.2.2.2.1.1.1.cmml" xref="A1.E22.m1.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E22.m1.2.2.2.2.1.1.2.cmml" xref="A1.E22.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="A1.E22.m1.2.2.2.2.1.1.3.cmml" xref="A1.E22.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="A1.E22.m1.3.3.3.3.2.2.cmml" xref="A1.E22.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="A1.E22.m1.3.3.3.3.2.2.1.cmml" xref="A1.E22.m1.3.3.3.3.2.2">subscript</csymbol><ci id="A1.E22.m1.3.3.3.3.2.2.2.cmml" xref="A1.E22.m1.3.3.3.3.2.2.2">𝑦</ci><ci id="A1.E22.m1.3.3.3.3.2.2.3.cmml" xref="A1.E22.m1.3.3.3.3.2.2.3">𝑙</ci></apply></vector><ci id="A1.E22.m1.3.3.3.5.cmml" xref="A1.E22.m1.3.3.3.5">𝒟</ci></apply></apply><apply id="A1.E22.m1.7.7.1.1.3.1.1.2.cmml" xref="A1.E22.m1.7.7.1.1.3.1.1.1"><csymbol cd="latexml" id="A1.E22.m1.7.7.1.1.3.1.1.2.1.cmml" xref="A1.E22.m1.7.7.1.1.3.1.1.1.2">delimited-[]</csymbol><apply id="A1.E22.m1.7.7.1.1.3.1.1.1.1.cmml" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1"><times id="A1.E22.m1.7.7.1.1.3.1.1.1.1.2.cmml" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.2"></times><apply id="A1.E22.m1.5.5.cmml" xref="A1.E22.m1.5.5"><divide id="A1.E22.m1.5.5.3.cmml" xref="A1.E22.m1.5.5"></divide><apply id="A1.E22.m1.4.4.1.cmml" xref="A1.E22.m1.4.4.1"><times id="A1.E22.m1.4.4.1.2.cmml" xref="A1.E22.m1.4.4.1.2"></times><apply id="A1.E22.m1.4.4.1.3.cmml" xref="A1.E22.m1.4.4.1.3"><csymbol cd="ambiguous" id="A1.E22.m1.4.4.1.3.1.cmml" xref="A1.E22.m1.4.4.1.3">superscript</csymbol><ci id="A1.E22.m1.4.4.1.3.2.cmml" xref="A1.E22.m1.4.4.1.3.2">𝜎</ci><ci id="A1.E22.m1.4.4.1.3.3.cmml" xref="A1.E22.m1.4.4.1.3.3">′</ci></apply><ci id="A1.E22.m1.4.4.1.1.cmml" xref="A1.E22.m1.4.4.1.1">𝑢</ci></apply><apply id="A1.E22.m1.5.5.2.cmml" xref="A1.E22.m1.5.5.2"><times id="A1.E22.m1.5.5.2.2.cmml" xref="A1.E22.m1.5.5.2.2"></times><ci id="A1.E22.m1.5.5.2.3.cmml" xref="A1.E22.m1.5.5.2.3">𝜎</ci><ci id="A1.E22.m1.5.5.2.1.cmml" xref="A1.E22.m1.5.5.2.1">𝑢</ci></apply></apply><apply id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.2.cmml" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1"><apply id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.cmml" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.2">∇</ci><ci id="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="A1.E22.m1.7.7.1.1.3.1.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="A1.E22.m1.6.6.cmml" xref="A1.E22.m1.6.6">𝑢</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E22.m1.7c">\displaystyle\nabla_{\theta}\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{%
ref}})=-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\left[\frac{\sigma^{\prime}%
\left(u\right)}{\sigma\left(u\right)}\nabla_{\theta}\left(u\right)\right],</annotation><annotation encoding="application/x-llamapun" id="A1.E22.m1.7d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ; italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) = - blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ divide start_ARG italic_σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_u ) end_ARG start_ARG italic_σ ( italic_u ) end_ARG ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_u ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS4.p2.1">where <math alttext="u=\beta\log\frac{\pi_{\theta}(y_{l}|x)}{\pi_{\text{ref}}(y_{l}|x)}-\beta\log% \frac{\pi_{\theta}(y_{w}|x)}{\pi_{\text{ref}}(y_{w}|x)}" class="ltx_Math" display="inline" id="A1.SS4.p2.1.m1.4"><semantics id="A1.SS4.p2.1.m1.4a"><mrow id="A1.SS4.p2.1.m1.4.5" xref="A1.SS4.p2.1.m1.4.5.cmml"><mi id="A1.SS4.p2.1.m1.4.5.2" xref="A1.SS4.p2.1.m1.4.5.2.cmml">u</mi><mo id="A1.SS4.p2.1.m1.4.5.1" xref="A1.SS4.p2.1.m1.4.5.1.cmml">=</mo><mrow id="A1.SS4.p2.1.m1.4.5.3" xref="A1.SS4.p2.1.m1.4.5.3.cmml"><mrow id="A1.SS4.p2.1.m1.4.5.3.2" xref="A1.SS4.p2.1.m1.4.5.3.2.cmml"><mi id="A1.SS4.p2.1.m1.4.5.3.2.2" xref="A1.SS4.p2.1.m1.4.5.3.2.2.cmml">β</mi><mo id="A1.SS4.p2.1.m1.4.5.3.2.1" lspace="0.167em" xref="A1.SS4.p2.1.m1.4.5.3.2.1.cmml">⁢</mo><mrow id="A1.SS4.p2.1.m1.4.5.3.2.3" xref="A1.SS4.p2.1.m1.4.5.3.2.3.cmml"><mi id="A1.SS4.p2.1.m1.4.5.3.2.3.1" xref="A1.SS4.p2.1.m1.4.5.3.2.3.1.cmml">log</mi><mo id="A1.SS4.p2.1.m1.4.5.3.2.3a" lspace="0.167em" xref="A1.SS4.p2.1.m1.4.5.3.2.3.cmml">⁡</mo><mfrac id="A1.SS4.p2.1.m1.2.2" xref="A1.SS4.p2.1.m1.2.2.cmml"><mrow id="A1.SS4.p2.1.m1.1.1.1" xref="A1.SS4.p2.1.m1.1.1.1.cmml"><msub id="A1.SS4.p2.1.m1.1.1.1.3" xref="A1.SS4.p2.1.m1.1.1.1.3.cmml"><mi id="A1.SS4.p2.1.m1.1.1.1.3.2" xref="A1.SS4.p2.1.m1.1.1.1.3.2.cmml">π</mi><mi id="A1.SS4.p2.1.m1.1.1.1.3.3" xref="A1.SS4.p2.1.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="A1.SS4.p2.1.m1.1.1.1.2" xref="A1.SS4.p2.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS4.p2.1.m1.1.1.1.1.1" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.cmml"><mo id="A1.SS4.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS4.p2.1.m1.1.1.1.1.1.1" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.cmml"><msub id="A1.SS4.p2.1.m1.1.1.1.1.1.1.2" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.cmml"><mi id="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.2" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.3" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.3.cmml">l</mi></msub><mo fence="false" id="A1.SS4.p2.1.m1.1.1.1.1.1.1.1" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS4.p2.1.m1.1.1.1.1.1.1.3" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS4.p2.1.m1.2.2.2" xref="A1.SS4.p2.1.m1.2.2.2.cmml"><msub id="A1.SS4.p2.1.m1.2.2.2.3" xref="A1.SS4.p2.1.m1.2.2.2.3.cmml"><mi id="A1.SS4.p2.1.m1.2.2.2.3.2" xref="A1.SS4.p2.1.m1.2.2.2.3.2.cmml">π</mi><mtext id="A1.SS4.p2.1.m1.2.2.2.3.3" xref="A1.SS4.p2.1.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.SS4.p2.1.m1.2.2.2.2" xref="A1.SS4.p2.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS4.p2.1.m1.2.2.2.1.1" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.cmml"><mo id="A1.SS4.p2.1.m1.2.2.2.1.1.2" stretchy="false" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS4.p2.1.m1.2.2.2.1.1.1" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.cmml"><msub id="A1.SS4.p2.1.m1.2.2.2.1.1.1.2" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.cmml"><mi id="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.2" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.2.cmml">y</mi><mi id="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.3" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.3.cmml">l</mi></msub><mo fence="false" id="A1.SS4.p2.1.m1.2.2.2.1.1.1.1" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.SS4.p2.1.m1.2.2.2.1.1.1.3" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p2.1.m1.2.2.2.1.1.3" stretchy="false" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.SS4.p2.1.m1.4.5.3.1" xref="A1.SS4.p2.1.m1.4.5.3.1.cmml">−</mo><mrow id="A1.SS4.p2.1.m1.4.5.3.3" xref="A1.SS4.p2.1.m1.4.5.3.3.cmml"><mi id="A1.SS4.p2.1.m1.4.5.3.3.2" xref="A1.SS4.p2.1.m1.4.5.3.3.2.cmml">β</mi><mo id="A1.SS4.p2.1.m1.4.5.3.3.1" lspace="0.167em" xref="A1.SS4.p2.1.m1.4.5.3.3.1.cmml">⁢</mo><mrow id="A1.SS4.p2.1.m1.4.5.3.3.3" xref="A1.SS4.p2.1.m1.4.5.3.3.3.cmml"><mi id="A1.SS4.p2.1.m1.4.5.3.3.3.1" xref="A1.SS4.p2.1.m1.4.5.3.3.3.1.cmml">log</mi><mo id="A1.SS4.p2.1.m1.4.5.3.3.3a" lspace="0.167em" xref="A1.SS4.p2.1.m1.4.5.3.3.3.cmml">⁡</mo><mfrac id="A1.SS4.p2.1.m1.4.4" xref="A1.SS4.p2.1.m1.4.4.cmml"><mrow id="A1.SS4.p2.1.m1.3.3.1" xref="A1.SS4.p2.1.m1.3.3.1.cmml"><msub id="A1.SS4.p2.1.m1.3.3.1.3" xref="A1.SS4.p2.1.m1.3.3.1.3.cmml"><mi id="A1.SS4.p2.1.m1.3.3.1.3.2" xref="A1.SS4.p2.1.m1.3.3.1.3.2.cmml">π</mi><mi id="A1.SS4.p2.1.m1.3.3.1.3.3" xref="A1.SS4.p2.1.m1.3.3.1.3.3.cmml">θ</mi></msub><mo id="A1.SS4.p2.1.m1.3.3.1.2" xref="A1.SS4.p2.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.SS4.p2.1.m1.3.3.1.1.1" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.cmml"><mo id="A1.SS4.p2.1.m1.3.3.1.1.1.2" stretchy="false" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.SS4.p2.1.m1.3.3.1.1.1.1" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.cmml"><msub id="A1.SS4.p2.1.m1.3.3.1.1.1.1.2" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.cmml"><mi id="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.2" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.2.cmml">y</mi><mi id="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.3" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.3.cmml">w</mi></msub><mo fence="false" id="A1.SS4.p2.1.m1.3.3.1.1.1.1.1" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.1.cmml">|</mo><mi id="A1.SS4.p2.1.m1.3.3.1.1.1.1.3" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p2.1.m1.3.3.1.1.1.3" stretchy="false" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS4.p2.1.m1.4.4.2" xref="A1.SS4.p2.1.m1.4.4.2.cmml"><msub id="A1.SS4.p2.1.m1.4.4.2.3" xref="A1.SS4.p2.1.m1.4.4.2.3.cmml"><mi id="A1.SS4.p2.1.m1.4.4.2.3.2" xref="A1.SS4.p2.1.m1.4.4.2.3.2.cmml">π</mi><mtext id="A1.SS4.p2.1.m1.4.4.2.3.3" xref="A1.SS4.p2.1.m1.4.4.2.3.3a.cmml">ref</mtext></msub><mo id="A1.SS4.p2.1.m1.4.4.2.2" xref="A1.SS4.p2.1.m1.4.4.2.2.cmml">⁢</mo><mrow id="A1.SS4.p2.1.m1.4.4.2.1.1" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.cmml"><mo id="A1.SS4.p2.1.m1.4.4.2.1.1.2" stretchy="false" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="A1.SS4.p2.1.m1.4.4.2.1.1.1" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.cmml"><msub id="A1.SS4.p2.1.m1.4.4.2.1.1.1.2" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.cmml"><mi id="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.2" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.2.cmml">y</mi><mi id="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.3" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.3.cmml">w</mi></msub><mo fence="false" id="A1.SS4.p2.1.m1.4.4.2.1.1.1.1" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.1.cmml">|</mo><mi id="A1.SS4.p2.1.m1.4.4.2.1.1.1.3" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p2.1.m1.4.4.2.1.1.3" stretchy="false" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.1.m1.4b"><apply id="A1.SS4.p2.1.m1.4.5.cmml" xref="A1.SS4.p2.1.m1.4.5"><eq id="A1.SS4.p2.1.m1.4.5.1.cmml" xref="A1.SS4.p2.1.m1.4.5.1"></eq><ci id="A1.SS4.p2.1.m1.4.5.2.cmml" xref="A1.SS4.p2.1.m1.4.5.2">𝑢</ci><apply id="A1.SS4.p2.1.m1.4.5.3.cmml" xref="A1.SS4.p2.1.m1.4.5.3"><minus id="A1.SS4.p2.1.m1.4.5.3.1.cmml" xref="A1.SS4.p2.1.m1.4.5.3.1"></minus><apply id="A1.SS4.p2.1.m1.4.5.3.2.cmml" xref="A1.SS4.p2.1.m1.4.5.3.2"><times id="A1.SS4.p2.1.m1.4.5.3.2.1.cmml" xref="A1.SS4.p2.1.m1.4.5.3.2.1"></times><ci id="A1.SS4.p2.1.m1.4.5.3.2.2.cmml" xref="A1.SS4.p2.1.m1.4.5.3.2.2">𝛽</ci><apply id="A1.SS4.p2.1.m1.4.5.3.2.3.cmml" xref="A1.SS4.p2.1.m1.4.5.3.2.3"><log id="A1.SS4.p2.1.m1.4.5.3.2.3.1.cmml" xref="A1.SS4.p2.1.m1.4.5.3.2.3.1"></log><apply id="A1.SS4.p2.1.m1.2.2.cmml" xref="A1.SS4.p2.1.m1.2.2"><divide id="A1.SS4.p2.1.m1.2.2.3.cmml" xref="A1.SS4.p2.1.m1.2.2"></divide><apply id="A1.SS4.p2.1.m1.1.1.1.cmml" xref="A1.SS4.p2.1.m1.1.1.1"><times id="A1.SS4.p2.1.m1.1.1.1.2.cmml" xref="A1.SS4.p2.1.m1.1.1.1.2"></times><apply id="A1.SS4.p2.1.m1.1.1.1.3.cmml" xref="A1.SS4.p2.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p2.1.m1.1.1.1.3.1.cmml" xref="A1.SS4.p2.1.m1.1.1.1.3">subscript</csymbol><ci id="A1.SS4.p2.1.m1.1.1.1.3.2.cmml" xref="A1.SS4.p2.1.m1.1.1.1.3.2">𝜋</ci><ci id="A1.SS4.p2.1.m1.1.1.1.3.3.cmml" xref="A1.SS4.p2.1.m1.1.1.1.3.3">𝜃</ci></apply><apply id="A1.SS4.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS4.p2.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS4.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.2.cmml" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="A1.SS4.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS4.p2.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.SS4.p2.1.m1.2.2.2.cmml" xref="A1.SS4.p2.1.m1.2.2.2"><times id="A1.SS4.p2.1.m1.2.2.2.2.cmml" xref="A1.SS4.p2.1.m1.2.2.2.2"></times><apply id="A1.SS4.p2.1.m1.2.2.2.3.cmml" xref="A1.SS4.p2.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS4.p2.1.m1.2.2.2.3.1.cmml" xref="A1.SS4.p2.1.m1.2.2.2.3">subscript</csymbol><ci id="A1.SS4.p2.1.m1.2.2.2.3.2.cmml" xref="A1.SS4.p2.1.m1.2.2.2.3.2">𝜋</ci><ci id="A1.SS4.p2.1.m1.2.2.2.3.3a.cmml" xref="A1.SS4.p2.1.m1.2.2.2.3.3"><mtext id="A1.SS4.p2.1.m1.2.2.2.3.3.cmml" mathsize="50%" xref="A1.SS4.p2.1.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.SS4.p2.1.m1.2.2.2.1.1.1.cmml" xref="A1.SS4.p2.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="A1.SS4.p2.1.m1.2.2.2.1.1.1.1.cmml" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.1">conditional</csymbol><apply id="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.cmml" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.1.cmml" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.2.cmml" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.2">𝑦</ci><ci id="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.3.cmml" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.2.3">𝑙</ci></apply><ci id="A1.SS4.p2.1.m1.2.2.2.1.1.1.3.cmml" xref="A1.SS4.p2.1.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.SS4.p2.1.m1.4.5.3.3.cmml" xref="A1.SS4.p2.1.m1.4.5.3.3"><times id="A1.SS4.p2.1.m1.4.5.3.3.1.cmml" xref="A1.SS4.p2.1.m1.4.5.3.3.1"></times><ci id="A1.SS4.p2.1.m1.4.5.3.3.2.cmml" xref="A1.SS4.p2.1.m1.4.5.3.3.2">𝛽</ci><apply id="A1.SS4.p2.1.m1.4.5.3.3.3.cmml" xref="A1.SS4.p2.1.m1.4.5.3.3.3"><log id="A1.SS4.p2.1.m1.4.5.3.3.3.1.cmml" xref="A1.SS4.p2.1.m1.4.5.3.3.3.1"></log><apply id="A1.SS4.p2.1.m1.4.4.cmml" xref="A1.SS4.p2.1.m1.4.4"><divide id="A1.SS4.p2.1.m1.4.4.3.cmml" xref="A1.SS4.p2.1.m1.4.4"></divide><apply id="A1.SS4.p2.1.m1.3.3.1.cmml" xref="A1.SS4.p2.1.m1.3.3.1"><times id="A1.SS4.p2.1.m1.3.3.1.2.cmml" xref="A1.SS4.p2.1.m1.3.3.1.2"></times><apply id="A1.SS4.p2.1.m1.3.3.1.3.cmml" xref="A1.SS4.p2.1.m1.3.3.1.3"><csymbol cd="ambiguous" id="A1.SS4.p2.1.m1.3.3.1.3.1.cmml" xref="A1.SS4.p2.1.m1.3.3.1.3">subscript</csymbol><ci id="A1.SS4.p2.1.m1.3.3.1.3.2.cmml" xref="A1.SS4.p2.1.m1.3.3.1.3.2">𝜋</ci><ci id="A1.SS4.p2.1.m1.3.3.1.3.3.cmml" xref="A1.SS4.p2.1.m1.3.3.1.3.3">𝜃</ci></apply><apply id="A1.SS4.p2.1.m1.3.3.1.1.1.1.cmml" xref="A1.SS4.p2.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="A1.SS4.p2.1.m1.3.3.1.1.1.1.1.cmml" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.cmml" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.1.cmml" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.2.cmml" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.2">𝑦</ci><ci id="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.3.cmml" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.2.3">𝑤</ci></apply><ci id="A1.SS4.p2.1.m1.3.3.1.1.1.1.3.cmml" xref="A1.SS4.p2.1.m1.3.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.SS4.p2.1.m1.4.4.2.cmml" xref="A1.SS4.p2.1.m1.4.4.2"><times id="A1.SS4.p2.1.m1.4.4.2.2.cmml" xref="A1.SS4.p2.1.m1.4.4.2.2"></times><apply id="A1.SS4.p2.1.m1.4.4.2.3.cmml" xref="A1.SS4.p2.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="A1.SS4.p2.1.m1.4.4.2.3.1.cmml" xref="A1.SS4.p2.1.m1.4.4.2.3">subscript</csymbol><ci id="A1.SS4.p2.1.m1.4.4.2.3.2.cmml" xref="A1.SS4.p2.1.m1.4.4.2.3.2">𝜋</ci><ci id="A1.SS4.p2.1.m1.4.4.2.3.3a.cmml" xref="A1.SS4.p2.1.m1.4.4.2.3.3"><mtext id="A1.SS4.p2.1.m1.4.4.2.3.3.cmml" mathsize="50%" xref="A1.SS4.p2.1.m1.4.4.2.3.3">ref</mtext></ci></apply><apply id="A1.SS4.p2.1.m1.4.4.2.1.1.1.cmml" xref="A1.SS4.p2.1.m1.4.4.2.1.1"><csymbol cd="latexml" id="A1.SS4.p2.1.m1.4.4.2.1.1.1.1.cmml" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.1">conditional</csymbol><apply id="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.cmml" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.1.cmml" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.2">subscript</csymbol><ci id="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.2.cmml" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.2">𝑦</ci><ci id="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.3.cmml" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.2.3">𝑤</ci></apply><ci id="A1.SS4.p2.1.m1.4.4.2.1.1.1.3.cmml" xref="A1.SS4.p2.1.m1.4.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.1.m1.4c">u=\beta\log\frac{\pi_{\theta}(y_{l}|x)}{\pi_{\text{ref}}(y_{l}|x)}-\beta\log% \frac{\pi_{\theta}(y_{w}|x)}{\pi_{\text{ref}}(y_{w}|x)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.1.m1.4d">italic_u = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) end_ARG</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="A1.SS4.p3">
<p class="ltx_p" id="A1.SS4.p3.2">Using the properties of sigmoid function <math alttext="\sigma^{\prime}(x)=\sigma(x)(1-\sigma(x))" class="ltx_Math" display="inline" id="A1.SS4.p3.1.m1.4"><semantics id="A1.SS4.p3.1.m1.4a"><mrow id="A1.SS4.p3.1.m1.4.4" xref="A1.SS4.p3.1.m1.4.4.cmml"><mrow id="A1.SS4.p3.1.m1.4.4.3" xref="A1.SS4.p3.1.m1.4.4.3.cmml"><msup id="A1.SS4.p3.1.m1.4.4.3.2" xref="A1.SS4.p3.1.m1.4.4.3.2.cmml"><mi id="A1.SS4.p3.1.m1.4.4.3.2.2" xref="A1.SS4.p3.1.m1.4.4.3.2.2.cmml">σ</mi><mo id="A1.SS4.p3.1.m1.4.4.3.2.3" xref="A1.SS4.p3.1.m1.4.4.3.2.3.cmml">′</mo></msup><mo id="A1.SS4.p3.1.m1.4.4.3.1" xref="A1.SS4.p3.1.m1.4.4.3.1.cmml">⁢</mo><mrow id="A1.SS4.p3.1.m1.4.4.3.3.2" xref="A1.SS4.p3.1.m1.4.4.3.cmml"><mo id="A1.SS4.p3.1.m1.4.4.3.3.2.1" stretchy="false" xref="A1.SS4.p3.1.m1.4.4.3.cmml">(</mo><mi id="A1.SS4.p3.1.m1.1.1" xref="A1.SS4.p3.1.m1.1.1.cmml">x</mi><mo id="A1.SS4.p3.1.m1.4.4.3.3.2.2" stretchy="false" xref="A1.SS4.p3.1.m1.4.4.3.cmml">)</mo></mrow></mrow><mo id="A1.SS4.p3.1.m1.4.4.2" xref="A1.SS4.p3.1.m1.4.4.2.cmml">=</mo><mrow id="A1.SS4.p3.1.m1.4.4.1" xref="A1.SS4.p3.1.m1.4.4.1.cmml"><mi id="A1.SS4.p3.1.m1.4.4.1.3" xref="A1.SS4.p3.1.m1.4.4.1.3.cmml">σ</mi><mo id="A1.SS4.p3.1.m1.4.4.1.2" xref="A1.SS4.p3.1.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.SS4.p3.1.m1.4.4.1.4.2" xref="A1.SS4.p3.1.m1.4.4.1.cmml"><mo id="A1.SS4.p3.1.m1.4.4.1.4.2.1" stretchy="false" xref="A1.SS4.p3.1.m1.4.4.1.cmml">(</mo><mi id="A1.SS4.p3.1.m1.2.2" xref="A1.SS4.p3.1.m1.2.2.cmml">x</mi><mo id="A1.SS4.p3.1.m1.4.4.1.4.2.2" stretchy="false" xref="A1.SS4.p3.1.m1.4.4.1.cmml">)</mo></mrow><mo id="A1.SS4.p3.1.m1.4.4.1.2a" xref="A1.SS4.p3.1.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.SS4.p3.1.m1.4.4.1.1.1" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.cmml"><mo id="A1.SS4.p3.1.m1.4.4.1.1.1.2" stretchy="false" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.SS4.p3.1.m1.4.4.1.1.1.1" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.cmml"><mn id="A1.SS4.p3.1.m1.4.4.1.1.1.1.2" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.2.cmml">1</mn><mo id="A1.SS4.p3.1.m1.4.4.1.1.1.1.1" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.1.cmml">−</mo><mrow id="A1.SS4.p3.1.m1.4.4.1.1.1.1.3" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.cmml"><mi id="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.2" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.2.cmml">σ</mi><mo id="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.1" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.3.2" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.cmml"><mo id="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.cmml">(</mo><mi id="A1.SS4.p3.1.m1.3.3" xref="A1.SS4.p3.1.m1.3.3.cmml">x</mi><mo id="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS4.p3.1.m1.4.4.1.1.1.3" stretchy="false" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.1.m1.4b"><apply id="A1.SS4.p3.1.m1.4.4.cmml" xref="A1.SS4.p3.1.m1.4.4"><eq id="A1.SS4.p3.1.m1.4.4.2.cmml" xref="A1.SS4.p3.1.m1.4.4.2"></eq><apply id="A1.SS4.p3.1.m1.4.4.3.cmml" xref="A1.SS4.p3.1.m1.4.4.3"><times id="A1.SS4.p3.1.m1.4.4.3.1.cmml" xref="A1.SS4.p3.1.m1.4.4.3.1"></times><apply id="A1.SS4.p3.1.m1.4.4.3.2.cmml" xref="A1.SS4.p3.1.m1.4.4.3.2"><csymbol cd="ambiguous" id="A1.SS4.p3.1.m1.4.4.3.2.1.cmml" xref="A1.SS4.p3.1.m1.4.4.3.2">superscript</csymbol><ci id="A1.SS4.p3.1.m1.4.4.3.2.2.cmml" xref="A1.SS4.p3.1.m1.4.4.3.2.2">𝜎</ci><ci id="A1.SS4.p3.1.m1.4.4.3.2.3.cmml" xref="A1.SS4.p3.1.m1.4.4.3.2.3">′</ci></apply><ci id="A1.SS4.p3.1.m1.1.1.cmml" xref="A1.SS4.p3.1.m1.1.1">𝑥</ci></apply><apply id="A1.SS4.p3.1.m1.4.4.1.cmml" xref="A1.SS4.p3.1.m1.4.4.1"><times id="A1.SS4.p3.1.m1.4.4.1.2.cmml" xref="A1.SS4.p3.1.m1.4.4.1.2"></times><ci id="A1.SS4.p3.1.m1.4.4.1.3.cmml" xref="A1.SS4.p3.1.m1.4.4.1.3">𝜎</ci><ci id="A1.SS4.p3.1.m1.2.2.cmml" xref="A1.SS4.p3.1.m1.2.2">𝑥</ci><apply id="A1.SS4.p3.1.m1.4.4.1.1.1.1.cmml" xref="A1.SS4.p3.1.m1.4.4.1.1.1"><minus id="A1.SS4.p3.1.m1.4.4.1.1.1.1.1.cmml" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.1"></minus><cn id="A1.SS4.p3.1.m1.4.4.1.1.1.1.2.cmml" type="integer" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.2">1</cn><apply id="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.cmml" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.3"><times id="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.1.cmml" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.1"></times><ci id="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.2.cmml" xref="A1.SS4.p3.1.m1.4.4.1.1.1.1.3.2">𝜎</ci><ci id="A1.SS4.p3.1.m1.3.3.cmml" xref="A1.SS4.p3.1.m1.3.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.1.m1.4c">\sigma^{\prime}(x)=\sigma(x)(1-\sigma(x))</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.1.m1.4d">italic_σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x ) = italic_σ ( italic_x ) ( 1 - italic_σ ( italic_x ) )</annotation></semantics></math> and <math alttext="\sigma(-x)=1-\sigma(x)" class="ltx_Math" display="inline" id="A1.SS4.p3.2.m2.2"><semantics id="A1.SS4.p3.2.m2.2a"><mrow id="A1.SS4.p3.2.m2.2.2" xref="A1.SS4.p3.2.m2.2.2.cmml"><mrow id="A1.SS4.p3.2.m2.2.2.1" xref="A1.SS4.p3.2.m2.2.2.1.cmml"><mi id="A1.SS4.p3.2.m2.2.2.1.3" xref="A1.SS4.p3.2.m2.2.2.1.3.cmml">σ</mi><mo id="A1.SS4.p3.2.m2.2.2.1.2" xref="A1.SS4.p3.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="A1.SS4.p3.2.m2.2.2.1.1.1" xref="A1.SS4.p3.2.m2.2.2.1.1.1.1.cmml"><mo id="A1.SS4.p3.2.m2.2.2.1.1.1.2" stretchy="false" xref="A1.SS4.p3.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.SS4.p3.2.m2.2.2.1.1.1.1" xref="A1.SS4.p3.2.m2.2.2.1.1.1.1.cmml"><mo id="A1.SS4.p3.2.m2.2.2.1.1.1.1a" xref="A1.SS4.p3.2.m2.2.2.1.1.1.1.cmml">−</mo><mi id="A1.SS4.p3.2.m2.2.2.1.1.1.1.2" xref="A1.SS4.p3.2.m2.2.2.1.1.1.1.2.cmml">x</mi></mrow><mo id="A1.SS4.p3.2.m2.2.2.1.1.1.3" stretchy="false" xref="A1.SS4.p3.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS4.p3.2.m2.2.2.2" xref="A1.SS4.p3.2.m2.2.2.2.cmml">=</mo><mrow id="A1.SS4.p3.2.m2.2.2.3" xref="A1.SS4.p3.2.m2.2.2.3.cmml"><mn id="A1.SS4.p3.2.m2.2.2.3.2" xref="A1.SS4.p3.2.m2.2.2.3.2.cmml">1</mn><mo id="A1.SS4.p3.2.m2.2.2.3.1" xref="A1.SS4.p3.2.m2.2.2.3.1.cmml">−</mo><mrow id="A1.SS4.p3.2.m2.2.2.3.3" xref="A1.SS4.p3.2.m2.2.2.3.3.cmml"><mi id="A1.SS4.p3.2.m2.2.2.3.3.2" xref="A1.SS4.p3.2.m2.2.2.3.3.2.cmml">σ</mi><mo id="A1.SS4.p3.2.m2.2.2.3.3.1" xref="A1.SS4.p3.2.m2.2.2.3.3.1.cmml">⁢</mo><mrow id="A1.SS4.p3.2.m2.2.2.3.3.3.2" xref="A1.SS4.p3.2.m2.2.2.3.3.cmml"><mo id="A1.SS4.p3.2.m2.2.2.3.3.3.2.1" stretchy="false" xref="A1.SS4.p3.2.m2.2.2.3.3.cmml">(</mo><mi id="A1.SS4.p3.2.m2.1.1" xref="A1.SS4.p3.2.m2.1.1.cmml">x</mi><mo id="A1.SS4.p3.2.m2.2.2.3.3.3.2.2" stretchy="false" xref="A1.SS4.p3.2.m2.2.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.2.m2.2b"><apply id="A1.SS4.p3.2.m2.2.2.cmml" xref="A1.SS4.p3.2.m2.2.2"><eq id="A1.SS4.p3.2.m2.2.2.2.cmml" xref="A1.SS4.p3.2.m2.2.2.2"></eq><apply id="A1.SS4.p3.2.m2.2.2.1.cmml" xref="A1.SS4.p3.2.m2.2.2.1"><times id="A1.SS4.p3.2.m2.2.2.1.2.cmml" xref="A1.SS4.p3.2.m2.2.2.1.2"></times><ci id="A1.SS4.p3.2.m2.2.2.1.3.cmml" xref="A1.SS4.p3.2.m2.2.2.1.3">𝜎</ci><apply id="A1.SS4.p3.2.m2.2.2.1.1.1.1.cmml" xref="A1.SS4.p3.2.m2.2.2.1.1.1"><minus id="A1.SS4.p3.2.m2.2.2.1.1.1.1.1.cmml" xref="A1.SS4.p3.2.m2.2.2.1.1.1"></minus><ci id="A1.SS4.p3.2.m2.2.2.1.1.1.1.2.cmml" xref="A1.SS4.p3.2.m2.2.2.1.1.1.1.2">𝑥</ci></apply></apply><apply id="A1.SS4.p3.2.m2.2.2.3.cmml" xref="A1.SS4.p3.2.m2.2.2.3"><minus id="A1.SS4.p3.2.m2.2.2.3.1.cmml" xref="A1.SS4.p3.2.m2.2.2.3.1"></minus><cn id="A1.SS4.p3.2.m2.2.2.3.2.cmml" type="integer" xref="A1.SS4.p3.2.m2.2.2.3.2">1</cn><apply id="A1.SS4.p3.2.m2.2.2.3.3.cmml" xref="A1.SS4.p3.2.m2.2.2.3.3"><times id="A1.SS4.p3.2.m2.2.2.3.3.1.cmml" xref="A1.SS4.p3.2.m2.2.2.3.3.1"></times><ci id="A1.SS4.p3.2.m2.2.2.3.3.2.cmml" xref="A1.SS4.p3.2.m2.2.2.3.3.2">𝜎</ci><ci id="A1.SS4.p3.2.m2.1.1.cmml" xref="A1.SS4.p3.2.m2.1.1">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.2.m2.2c">\sigma(-x)=1-\sigma(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.2.m2.2d">italic_σ ( - italic_x ) = 1 - italic_σ ( italic_x )</annotation></semantics></math>, we obtain the final gradient</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.SS4.p3.3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\theta}\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{ref}})=\\
-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\bigg{[}\beta\sigma\left(\beta\log%
\frac{\pi_{\theta}(y_{w}|x)}{\pi_{\text{ref}}(y_{w}|x)}-\beta\log\frac{\pi_{%
\theta}(y_{l}|x)}{\pi_{\text{ref}}(y_{l}|x)}\right)\bigg{[}\nabla_{\theta}\log%
\pi(y_{w}\mid x)-\nabla_{\theta}\log\pi(y_{l}\mid x)\bigg{]}\bigg{]}," class="ltx_Math" display="block" id="A1.SS4.p3.3.m1.56"><semantics id="A1.SS4.p3.3.m1.56a"><mtable displaystyle="true" id="A1.SS4.p3.3.m1.56.56.4" rowspacing="0pt"><mtr id="A1.SS4.p3.3.m1.56.56.4a"><mtd class="ltx_align_left" columnalign="left" id="A1.SS4.p3.3.m1.56.56.4b"><mrow id="A1.SS4.p3.3.m1.55.55.3.54.14.14"><mrow id="A1.SS4.p3.3.m1.55.55.3.54.14.14.14"><mrow id="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.4"><msub id="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.4.1"><mo id="A1.SS4.p3.3.m1.1.1.1.1.1.1" xref="A1.SS4.p3.3.m1.1.1.1.1.1.1.cmml">∇</mo><mi id="A1.SS4.p3.3.m1.2.2.2.2.2.2.1" xref="A1.SS4.p3.3.m1.2.2.2.2.2.2.1.cmml">θ</mi></msub><msub id="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.4.2"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p3.3.m1.3.3.3.3.3.3" xref="A1.SS4.p3.3.m1.3.3.3.3.3.3.cmml">ℒ</mi><mtext id="A1.SS4.p3.3.m1.4.4.4.4.4.4.1" xref="A1.SS4.p3.3.m1.4.4.4.4.4.4.1a.cmml">DPO</mtext></msub></mrow><mo id="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.2.2"><mo id="A1.SS4.p3.3.m1.5.5.5.5.5.5" stretchy="false" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">(</mo><msub id="A1.SS4.p3.3.m1.54.54.2.53.13.13.13.1.1.1"><mi id="A1.SS4.p3.3.m1.6.6.6.6.6.6" xref="A1.SS4.p3.3.m1.6.6.6.6.6.6.cmml">π</mi><mi id="A1.SS4.p3.3.m1.7.7.7.7.7.7.1" xref="A1.SS4.p3.3.m1.7.7.7.7.7.7.1.cmml">θ</mi></msub><mo id="A1.SS4.p3.3.m1.8.8.8.8.8.8" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">;</mo><msub id="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.2.2.2"><mi id="A1.SS4.p3.3.m1.9.9.9.9.9.9" xref="A1.SS4.p3.3.m1.9.9.9.9.9.9.cmml">π</mi><mtext id="A1.SS4.p3.3.m1.10.10.10.10.10.10.1" xref="A1.SS4.p3.3.m1.10.10.10.10.10.10.1a.cmml">ref</mtext></msub><mo id="A1.SS4.p3.3.m1.11.11.11.11.11.11" stretchy="false" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS4.p3.3.m1.12.12.12.12.12.12" xref="A1.SS4.p3.3.m1.12.12.12.12.12.12.cmml">=</mo><mi id="A1.SS4.p3.3.m1.55.55.3.54.14.14.15" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml"></mi></mrow></mtd></mtr><mtr id="A1.SS4.p3.3.m1.56.56.4c"><mtd class="ltx_align_right" columnalign="right" id="A1.SS4.p3.3.m1.56.56.4d"><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41"><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1"><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1a" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">−</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1"><msub id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.3"><mi id="A1.SS4.p3.3.m1.14.14.14.2.2.2" xref="A1.SS4.p3.3.m1.14.14.14.2.2.2.cmml">𝔼</mi><mrow id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.cmml"><mrow id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.3.cmml"><mo id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.3" stretchy="false" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.3.cmml">(</mo><mi id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.1" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.1.cmml">x</mi><mo id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.4" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.3.cmml">,</mo><msub id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.cmml"><mi id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.2" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.2.cmml">y</mi><mi id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.3" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.3.cmml">w</mi></msub><mo id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.5" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.3.cmml">,</mo><msub id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.cmml"><mi id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.2" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.2.cmml">y</mi><mi id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.3" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.3.cmml">l</mi></msub><mo id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.6" stretchy="false" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.3.cmml">)</mo></mrow><mo id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.4" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.5" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.5.cmml">𝒟</mi></mrow></msub><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.2" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1"><mo id="A1.SS4.p3.3.m1.16.16.16.4.4.4" maxsize="210%" minsize="210%" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">[</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1"><mi id="A1.SS4.p3.3.m1.17.17.17.5.5.5" xref="A1.SS4.p3.3.m1.17.17.17.5.5.5.cmml">β</mi><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.3" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁢</mo><mi id="A1.SS4.p3.3.m1.18.18.18.6.6.6" xref="A1.SS4.p3.3.m1.18.18.18.6.6.6.cmml">σ</mi><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.3a" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1"><mo id="A1.SS4.p3.3.m1.19.19.19.7.7.7" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">(</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1.1"><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1.1.1"><mi id="A1.SS4.p3.3.m1.20.20.20.8.8.8" xref="A1.SS4.p3.3.m1.20.20.20.8.8.8.cmml">β</mi><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1.1.1.1" lspace="0.167em" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1.1.1.2"><mi id="A1.SS4.p3.3.m1.21.21.21.9.9.9" xref="A1.SS4.p3.3.m1.21.21.21.9.9.9.cmml">log</mi><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1.1.1.2a" lspace="0.167em" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁡</mo><mfrac id="A1.SS4.p3.3.m1.22.22.22.10.10.10" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.cmml"><mrow id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.cmml"><msub id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.cmml"><mi id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.2" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.2.cmml">π</mi><mi id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.3" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.3.cmml">θ</mi></msub><mo id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.2" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.2.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.cmml"><mo id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.2" stretchy="false" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.cmml">(</mo><mrow id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.cmml"><msub id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.cmml"><mi id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.2" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.2.cmml">y</mi><mi id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.3" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.3.cmml">w</mi></msub><mo fence="false" id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.1" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.1.cmml">|</mo><mi id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.3" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.3" stretchy="false" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.cmml"><msub id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.cmml"><mi id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.2" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.2.cmml">π</mi><mtext id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.3" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.3a.cmml">ref</mtext></msub><mo id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.2" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.2.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.cmml"><mo id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.2" stretchy="false" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.cmml">(</mo><mrow id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.cmml"><msub id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.cmml"><mi id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.2" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.2.cmml">y</mi><mi id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.3" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.3.cmml">w</mi></msub><mo fence="false" id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.1" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.1.cmml">|</mo><mi id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.3" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.3" stretchy="false" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.SS4.p3.3.m1.23.23.23.11.11.11" xref="A1.SS4.p3.3.m1.23.23.23.11.11.11.cmml">−</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1.1.2"><mi id="A1.SS4.p3.3.m1.24.24.24.12.12.12" xref="A1.SS4.p3.3.m1.24.24.24.12.12.12.cmml">β</mi><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1.1.2.1" lspace="0.167em" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1.1.2.2"><mi id="A1.SS4.p3.3.m1.25.25.25.13.13.13" xref="A1.SS4.p3.3.m1.25.25.25.13.13.13.cmml">log</mi><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.1.1.1.2.2a" lspace="0.167em" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁡</mo><mfrac id="A1.SS4.p3.3.m1.26.26.26.14.14.14" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.cmml"><mrow id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.cmml"><msub id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.cmml"><mi id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.2" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.2.cmml">π</mi><mi id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.3" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.3.cmml">θ</mi></msub><mo id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.2" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.2.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.cmml"><mo id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.2" stretchy="false" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.cmml">(</mo><mrow id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.cmml"><msub id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.cmml"><mi id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.2" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.2.cmml">y</mi><mi id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.3" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.3.cmml">l</mi></msub><mo fence="false" id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.1" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.1.cmml">|</mo><mi id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.3" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.3" stretchy="false" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.cmml"><msub id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.cmml"><mi id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.2" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.2.cmml">π</mi><mtext id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.3" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.3a.cmml">ref</mtext></msub><mo id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.2" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.2.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.cmml"><mo id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.2" stretchy="false" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.cmml">(</mo><mrow id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.cmml"><msub id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.cmml"><mi id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.2" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.2.cmml">y</mi><mi id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.3" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.3.cmml">l</mi></msub><mo fence="false" id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.1" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.1.cmml">|</mo><mi id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.3" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.3" stretchy="false" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="A1.SS4.p3.3.m1.27.27.27.15.15.15" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">)</mo></mrow><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.3b" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1"><mo id="A1.SS4.p3.3.m1.28.28.28.16.16.16" maxsize="210%" minsize="210%" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">[</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1"><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.1"><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.1.3"><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.1.3.1"><msub id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.1.3.1.1"><mo id="A1.SS4.p3.3.m1.29.29.29.17.17.17" rspace="0.167em" xref="A1.SS4.p3.3.m1.29.29.29.17.17.17.cmml">∇</mo><mi id="A1.SS4.p3.3.m1.30.30.30.18.18.18.1" xref="A1.SS4.p3.3.m1.30.30.30.18.18.18.1.cmml">θ</mi></msub><mi id="A1.SS4.p3.3.m1.31.31.31.19.19.19" xref="A1.SS4.p3.3.m1.31.31.31.19.19.19.cmml">log</mi></mrow><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.1.3a" lspace="0.167em" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁡</mo><mi id="A1.SS4.p3.3.m1.32.32.32.20.20.20" xref="A1.SS4.p3.3.m1.32.32.32.20.20.20.cmml">π</mi></mrow><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.1.2" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.1.1.1"><mo id="A1.SS4.p3.3.m1.33.33.33.21.21.21" stretchy="false" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">(</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.1.1.1.1"><msub id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.1.1.1.1.1"><mi id="A1.SS4.p3.3.m1.34.34.34.22.22.22" xref="A1.SS4.p3.3.m1.34.34.34.22.22.22.cmml">y</mi><mi id="A1.SS4.p3.3.m1.35.35.35.23.23.23.1" xref="A1.SS4.p3.3.m1.35.35.35.23.23.23.1.cmml">w</mi></msub><mo id="A1.SS4.p3.3.m1.36.36.36.24.24.24" xref="A1.SS4.p3.3.m1.36.36.36.24.24.24.cmml">∣</mo><mi id="A1.SS4.p3.3.m1.37.37.37.25.25.25" xref="A1.SS4.p3.3.m1.37.37.37.25.25.25.cmml">x</mi></mrow><mo id="A1.SS4.p3.3.m1.38.38.38.26.26.26" stretchy="false" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS4.p3.3.m1.39.39.39.27.27.27" xref="A1.SS4.p3.3.m1.39.39.39.27.27.27.cmml">−</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.2"><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.2.3"><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.2.3.1"><msub id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.2.3.1.1"><mo id="A1.SS4.p3.3.m1.40.40.40.28.28.28" rspace="0.167em" xref="A1.SS4.p3.3.m1.40.40.40.28.28.28.cmml">∇</mo><mi id="A1.SS4.p3.3.m1.41.41.41.29.29.29.1" xref="A1.SS4.p3.3.m1.41.41.41.29.29.29.1.cmml">θ</mi></msub><mi id="A1.SS4.p3.3.m1.42.42.42.30.30.30" xref="A1.SS4.p3.3.m1.42.42.42.30.30.30.cmml">log</mi></mrow><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.2.3a" lspace="0.167em" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁡</mo><mi id="A1.SS4.p3.3.m1.43.43.43.31.31.31" xref="A1.SS4.p3.3.m1.43.43.43.31.31.31.cmml">π</mi></mrow><mo id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.2.2" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">⁢</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.2.1.1"><mo id="A1.SS4.p3.3.m1.44.44.44.32.32.32" stretchy="false" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">(</mo><mrow id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.2.1.1.1"><msub id="A1.SS4.p3.3.m1.56.56.4.55.41.41.41.1.1.1.1.1.2.1.1.2.1.1.1.1"><mi id="A1.SS4.p3.3.m1.45.45.45.33.33.33" xref="A1.SS4.p3.3.m1.45.45.45.33.33.33.cmml">y</mi><mi id="A1.SS4.p3.3.m1.46.46.46.34.34.34.1" xref="A1.SS4.p3.3.m1.46.46.46.34.34.34.1.cmml">l</mi></msub><mo id="A1.SS4.p3.3.m1.47.47.47.35.35.35" xref="A1.SS4.p3.3.m1.47.47.47.35.35.35.cmml">∣</mo><mi id="A1.SS4.p3.3.m1.48.48.48.36.36.36" xref="A1.SS4.p3.3.m1.48.48.48.36.36.36.cmml">x</mi></mrow><mo id="A1.SS4.p3.3.m1.49.49.49.37.37.37" stretchy="false" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS4.p3.3.m1.50.50.50.38.38.38" maxsize="210%" minsize="210%" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">]</mo></mrow></mrow><mo id="A1.SS4.p3.3.m1.51.51.51.39.39.39" maxsize="210%" minsize="210%" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.SS4.p3.3.m1.52.52.52.40.40.40" xref="A1.SS4.p3.3.m1.53.53.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.3.m1.56b"><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><eq id="A1.SS4.p3.3.m1.12.12.12.12.12.12.cmml" xref="A1.SS4.p3.3.m1.12.12.12.12.12.12"></eq><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><times id="A1.SS4.p3.3.m1.53.53.1.1.1.2.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"></times><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.2.4.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.2.4.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.53.53.1.1.1.2.4.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.1.1.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.1.1.1.1.1.1">∇</ci><ci id="A1.SS4.p3.3.m1.2.2.2.2.2.2.1.cmml" xref="A1.SS4.p3.3.m1.2.2.2.2.2.2.1">𝜃</ci></apply><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.2.4.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.53.53.1.1.1.2.4.2.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.3.3.3.3.3.3.cmml" xref="A1.SS4.p3.3.m1.3.3.3.3.3.3">ℒ</ci><ci id="A1.SS4.p3.3.m1.4.4.4.4.4.4.1a.cmml" xref="A1.SS4.p3.3.m1.4.4.4.4.4.4.1"><mtext id="A1.SS4.p3.3.m1.4.4.4.4.4.4.1.cmml" mathsize="70%" xref="A1.SS4.p3.3.m1.4.4.4.4.4.4.1">DPO</mtext></ci></apply></apply><list id="A1.SS4.p3.3.m1.53.53.1.1.1.2.2.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.53.53.1.1.1.1.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.6.6.6.6.6.6.cmml" xref="A1.SS4.p3.3.m1.6.6.6.6.6.6">𝜋</ci><ci id="A1.SS4.p3.3.m1.7.7.7.7.7.7.1.cmml" xref="A1.SS4.p3.3.m1.7.7.7.7.7.7.1">𝜃</ci></apply><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.2.2.2.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.53.53.1.1.1.2.2.2.2.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.9.9.9.9.9.9.cmml" xref="A1.SS4.p3.3.m1.9.9.9.9.9.9">𝜋</ci><ci id="A1.SS4.p3.3.m1.10.10.10.10.10.10.1a.cmml" xref="A1.SS4.p3.3.m1.10.10.10.10.10.10.1"><mtext id="A1.SS4.p3.3.m1.10.10.10.10.10.10.1.cmml" mathsize="70%" xref="A1.SS4.p3.3.m1.10.10.10.10.10.10.1">ref</mtext></ci></apply></list></apply><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><minus id="A1.SS4.p3.3.m1.13.13.13.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"></minus><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><times id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"></times><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.3.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.14.14.14.2.2.2.cmml" xref="A1.SS4.p3.3.m1.14.14.14.2.2.2">𝔼</ci><apply id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1"><csymbol cd="latexml" id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.4.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.4">similar-to</csymbol><vector id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.3.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2"><ci id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.1.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.1">𝑥</ci><apply id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.1.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1">subscript</csymbol><ci id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.2.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.2">𝑦</ci><ci id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.3.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.2.1.1.3">𝑤</ci></apply><apply id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.1.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2">subscript</csymbol><ci id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.2.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.2">𝑦</ci><ci id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.3.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.3.2.2.3">𝑙</ci></apply></vector><ci id="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.5.cmml" xref="A1.SS4.p3.3.m1.15.15.15.3.3.3.1.5">𝒟</ci></apply></apply><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="latexml" id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.2.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">delimited-[]</csymbol><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><times id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"></times><ci id="A1.SS4.p3.3.m1.17.17.17.5.5.5.cmml" xref="A1.SS4.p3.3.m1.17.17.17.5.5.5">𝛽</ci><ci id="A1.SS4.p3.3.m1.18.18.18.6.6.6.cmml" xref="A1.SS4.p3.3.m1.18.18.18.6.6.6">𝜎</ci><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><minus id="A1.SS4.p3.3.m1.23.23.23.11.11.11.cmml" xref="A1.SS4.p3.3.m1.23.23.23.11.11.11"></minus><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><times id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"></times><ci id="A1.SS4.p3.3.m1.20.20.20.8.8.8.cmml" xref="A1.SS4.p3.3.m1.20.20.20.8.8.8">𝛽</ci><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><log id="A1.SS4.p3.3.m1.21.21.21.9.9.9.cmml" xref="A1.SS4.p3.3.m1.21.21.21.9.9.9"></log><apply id="A1.SS4.p3.3.m1.22.22.22.10.10.10.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10"><divide id="A1.SS4.p3.3.m1.22.22.22.10.10.10.3.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10"></divide><apply id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1"><times id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.2.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.2"></times><apply id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.1.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.2.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.2">𝜋</ci><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.3.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.3.3">𝜃</ci></apply><apply id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1"><csymbol cd="latexml" id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.1">conditional</csymbol><apply id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.1.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2">subscript</csymbol><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.2.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.2">𝑦</ci><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.3.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.2.3">𝑤</ci></apply><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.3.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2"><times id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.2.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.2"></times><apply id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.1.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.2.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.2">𝜋</ci><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.3a.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.3"><mtext id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.3.cmml" mathsize="70%" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.3.3">ref</mtext></ci></apply><apply id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1"><csymbol cd="latexml" id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.1">conditional</csymbol><apply id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.1.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2">subscript</csymbol><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.2.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.2">𝑦</ci><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.3.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.2.3">𝑤</ci></apply><ci id="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.3.cmml" xref="A1.SS4.p3.3.m1.22.22.22.10.10.10.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><times id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"></times><ci id="A1.SS4.p3.3.m1.24.24.24.12.12.12.cmml" xref="A1.SS4.p3.3.m1.24.24.24.12.12.12">𝛽</ci><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.1.1.1.3.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><log id="A1.SS4.p3.3.m1.25.25.25.13.13.13.cmml" xref="A1.SS4.p3.3.m1.25.25.25.13.13.13"></log><apply id="A1.SS4.p3.3.m1.26.26.26.14.14.14.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14"><divide id="A1.SS4.p3.3.m1.26.26.26.14.14.14.3.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14"></divide><apply id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1"><times id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.2.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.2"></times><apply id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.1.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.2.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.2">𝜋</ci><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.3.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.3.3">𝜃</ci></apply><apply id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1"><csymbol cd="latexml" id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.1">conditional</csymbol><apply id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.1.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2">subscript</csymbol><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.2.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.2">𝑦</ci><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.3.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.2.3">𝑙</ci></apply><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.3.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2"><times id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.2.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.2"></times><apply id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.1.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.2.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.2">𝜋</ci><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.3a.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.3"><mtext id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.3.cmml" mathsize="70%" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.3.3">ref</mtext></ci></apply><apply id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1"><csymbol cd="latexml" id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.1">conditional</csymbol><apply id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.1.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2">subscript</csymbol><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.2.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.2">𝑦</ci><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.3.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.2.3">𝑙</ci></apply><ci id="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.3.cmml" xref="A1.SS4.p3.3.m1.26.26.26.14.14.14.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="latexml" id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.2.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">delimited-[]</csymbol><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><minus id="A1.SS4.p3.3.m1.39.39.39.27.27.27.cmml" xref="A1.SS4.p3.3.m1.39.39.39.27.27.27"></minus><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><times id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.1.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"></times><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.1.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.1.3.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.1.3.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.1.3.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.29.29.29.17.17.17.cmml" xref="A1.SS4.p3.3.m1.29.29.29.17.17.17">∇</ci><ci id="A1.SS4.p3.3.m1.30.30.30.18.18.18.1.cmml" xref="A1.SS4.p3.3.m1.30.30.30.18.18.18.1">𝜃</ci></apply><log id="A1.SS4.p3.3.m1.31.31.31.19.19.19.cmml" xref="A1.SS4.p3.3.m1.31.31.31.19.19.19"></log></apply><ci id="A1.SS4.p3.3.m1.32.32.32.20.20.20.cmml" xref="A1.SS4.p3.3.m1.32.32.32.20.20.20">𝜋</ci></apply><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="latexml" id="A1.SS4.p3.3.m1.36.36.36.24.24.24.cmml" xref="A1.SS4.p3.3.m1.36.36.36.24.24.24">conditional</csymbol><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.34.34.34.22.22.22.cmml" xref="A1.SS4.p3.3.m1.34.34.34.22.22.22">𝑦</ci><ci id="A1.SS4.p3.3.m1.35.35.35.23.23.23.1.cmml" xref="A1.SS4.p3.3.m1.35.35.35.23.23.23.1">𝑤</ci></apply><ci id="A1.SS4.p3.3.m1.37.37.37.25.25.25.cmml" xref="A1.SS4.p3.3.m1.37.37.37.25.25.25">𝑥</ci></apply></apply><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><times id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.2.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"></times><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.2.3.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.2.3.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.2.3.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.2.3.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.40.40.40.28.28.28.cmml" xref="A1.SS4.p3.3.m1.40.40.40.28.28.28">∇</ci><ci id="A1.SS4.p3.3.m1.41.41.41.29.29.29.1.cmml" xref="A1.SS4.p3.3.m1.41.41.41.29.29.29.1">𝜃</ci></apply><log id="A1.SS4.p3.3.m1.42.42.42.30.30.30.cmml" xref="A1.SS4.p3.3.m1.42.42.42.30.30.30"></log></apply><ci id="A1.SS4.p3.3.m1.43.43.43.31.31.31.cmml" xref="A1.SS4.p3.3.m1.43.43.43.31.31.31">𝜋</ci></apply><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.2.1.1.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="latexml" id="A1.SS4.p3.3.m1.47.47.47.35.35.35.cmml" xref="A1.SS4.p3.3.m1.47.47.47.35.35.35">conditional</csymbol><apply id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.2.1.1.1.2.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3"><csymbol cd="ambiguous" id="A1.SS4.p3.3.m1.53.53.1.1.1.3.1.1.1.1.2.1.1.2.1.1.1.2.1.cmml" xref="A1.SS4.p3.3.m1.55.55.3.54.14.14.14.3">subscript</csymbol><ci id="A1.SS4.p3.3.m1.45.45.45.33.33.33.cmml" xref="A1.SS4.p3.3.m1.45.45.45.33.33.33">𝑦</ci><ci id="A1.SS4.p3.3.m1.46.46.46.34.34.34.1.cmml" xref="A1.SS4.p3.3.m1.46.46.46.34.34.34.1">𝑙</ci></apply><ci id="A1.SS4.p3.3.m1.48.48.48.36.36.36.cmml" xref="A1.SS4.p3.3.m1.48.48.48.36.36.36">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.3.m1.56c">\nabla_{\theta}\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{ref}})=\\
-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\bigg{[}\beta\sigma\left(\beta\log%
\frac{\pi_{\theta}(y_{w}|x)}{\pi_{\text{ref}}(y_{w}|x)}-\beta\log\frac{\pi_{%
\theta}(y_{l}|x)}{\pi_{\text{ref}}(y_{l}|x)}\right)\bigg{[}\nabla_{\theta}\log%
\pi(y_{w}\mid x)-\nabla_{\theta}\log\pi(y_{l}\mid x)\bigg{]}\bigg{]},</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.3.m1.56d">start_ROW start_CELL ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ; italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) = end_CELL end_ROW start_ROW start_CELL - blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ italic_β italic_σ ( italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) end_ARG ) [ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log italic_π ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∣ italic_x ) - ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log italic_π ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∣ italic_x ) ] ] , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS4.p4">
<p class="ltx_p" id="A1.SS4.p4.1">After using the reward substitution of <math alttext="\hat{r}_{\theta}(x,y)=\beta\log\frac{\pi_{\theta}(y\mid x)}{\pi_{\text{ref}}(y% \mid x)}" class="ltx_Math" display="inline" id="A1.SS4.p4.1.m1.4"><semantics id="A1.SS4.p4.1.m1.4a"><mrow id="A1.SS4.p4.1.m1.4.5" xref="A1.SS4.p4.1.m1.4.5.cmml"><mrow id="A1.SS4.p4.1.m1.4.5.2" xref="A1.SS4.p4.1.m1.4.5.2.cmml"><msub id="A1.SS4.p4.1.m1.4.5.2.2" xref="A1.SS4.p4.1.m1.4.5.2.2.cmml"><mover accent="true" id="A1.SS4.p4.1.m1.4.5.2.2.2" xref="A1.SS4.p4.1.m1.4.5.2.2.2.cmml"><mi id="A1.SS4.p4.1.m1.4.5.2.2.2.2" xref="A1.SS4.p4.1.m1.4.5.2.2.2.2.cmml">r</mi><mo id="A1.SS4.p4.1.m1.4.5.2.2.2.1" xref="A1.SS4.p4.1.m1.4.5.2.2.2.1.cmml">^</mo></mover><mi id="A1.SS4.p4.1.m1.4.5.2.2.3" xref="A1.SS4.p4.1.m1.4.5.2.2.3.cmml">θ</mi></msub><mo id="A1.SS4.p4.1.m1.4.5.2.1" xref="A1.SS4.p4.1.m1.4.5.2.1.cmml">⁢</mo><mrow id="A1.SS4.p4.1.m1.4.5.2.3.2" xref="A1.SS4.p4.1.m1.4.5.2.3.1.cmml"><mo id="A1.SS4.p4.1.m1.4.5.2.3.2.1" stretchy="false" xref="A1.SS4.p4.1.m1.4.5.2.3.1.cmml">(</mo><mi id="A1.SS4.p4.1.m1.3.3" xref="A1.SS4.p4.1.m1.3.3.cmml">x</mi><mo id="A1.SS4.p4.1.m1.4.5.2.3.2.2" xref="A1.SS4.p4.1.m1.4.5.2.3.1.cmml">,</mo><mi id="A1.SS4.p4.1.m1.4.4" xref="A1.SS4.p4.1.m1.4.4.cmml">y</mi><mo id="A1.SS4.p4.1.m1.4.5.2.3.2.3" stretchy="false" xref="A1.SS4.p4.1.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS4.p4.1.m1.4.5.1" xref="A1.SS4.p4.1.m1.4.5.1.cmml">=</mo><mrow id="A1.SS4.p4.1.m1.4.5.3" xref="A1.SS4.p4.1.m1.4.5.3.cmml"><mi id="A1.SS4.p4.1.m1.4.5.3.2" xref="A1.SS4.p4.1.m1.4.5.3.2.cmml">β</mi><mo id="A1.SS4.p4.1.m1.4.5.3.1" lspace="0.167em" xref="A1.SS4.p4.1.m1.4.5.3.1.cmml">⁢</mo><mrow id="A1.SS4.p4.1.m1.4.5.3.3" xref="A1.SS4.p4.1.m1.4.5.3.3.cmml"><mi id="A1.SS4.p4.1.m1.4.5.3.3.1" xref="A1.SS4.p4.1.m1.4.5.3.3.1.cmml">log</mi><mo id="A1.SS4.p4.1.m1.4.5.3.3a" lspace="0.167em" xref="A1.SS4.p4.1.m1.4.5.3.3.cmml">⁡</mo><mfrac id="A1.SS4.p4.1.m1.2.2" xref="A1.SS4.p4.1.m1.2.2.cmml"><mrow id="A1.SS4.p4.1.m1.1.1.1" xref="A1.SS4.p4.1.m1.1.1.1.cmml"><msub id="A1.SS4.p4.1.m1.1.1.1.3" xref="A1.SS4.p4.1.m1.1.1.1.3.cmml"><mi id="A1.SS4.p4.1.m1.1.1.1.3.2" xref="A1.SS4.p4.1.m1.1.1.1.3.2.cmml">π</mi><mi id="A1.SS4.p4.1.m1.1.1.1.3.3" xref="A1.SS4.p4.1.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="A1.SS4.p4.1.m1.1.1.1.2" xref="A1.SS4.p4.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS4.p4.1.m1.1.1.1.1.1" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.cmml"><mo id="A1.SS4.p4.1.m1.1.1.1.1.1.2" stretchy="false" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS4.p4.1.m1.1.1.1.1.1.1" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.SS4.p4.1.m1.1.1.1.1.1.1.2" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo id="A1.SS4.p4.1.m1.1.1.1.1.1.1.1" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="A1.SS4.p4.1.m1.1.1.1.1.1.1.3" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p4.1.m1.1.1.1.1.1.3" stretchy="false" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS4.p4.1.m1.2.2.2" xref="A1.SS4.p4.1.m1.2.2.2.cmml"><msub id="A1.SS4.p4.1.m1.2.2.2.3" xref="A1.SS4.p4.1.m1.2.2.2.3.cmml"><mi id="A1.SS4.p4.1.m1.2.2.2.3.2" xref="A1.SS4.p4.1.m1.2.2.2.3.2.cmml">π</mi><mtext id="A1.SS4.p4.1.m1.2.2.2.3.3" xref="A1.SS4.p4.1.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.SS4.p4.1.m1.2.2.2.2" xref="A1.SS4.p4.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS4.p4.1.m1.2.2.2.1.1" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.cmml"><mo id="A1.SS4.p4.1.m1.2.2.2.1.1.2" stretchy="false" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS4.p4.1.m1.2.2.2.1.1.1" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.cmml"><mi id="A1.SS4.p4.1.m1.2.2.2.1.1.1.2" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.2.cmml">y</mi><mo id="A1.SS4.p4.1.m1.2.2.2.1.1.1.1" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.1.cmml">∣</mo><mi id="A1.SS4.p4.1.m1.2.2.2.1.1.1.3" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS4.p4.1.m1.2.2.2.1.1.3" stretchy="false" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p4.1.m1.4b"><apply id="A1.SS4.p4.1.m1.4.5.cmml" xref="A1.SS4.p4.1.m1.4.5"><eq id="A1.SS4.p4.1.m1.4.5.1.cmml" xref="A1.SS4.p4.1.m1.4.5.1"></eq><apply id="A1.SS4.p4.1.m1.4.5.2.cmml" xref="A1.SS4.p4.1.m1.4.5.2"><times id="A1.SS4.p4.1.m1.4.5.2.1.cmml" xref="A1.SS4.p4.1.m1.4.5.2.1"></times><apply id="A1.SS4.p4.1.m1.4.5.2.2.cmml" xref="A1.SS4.p4.1.m1.4.5.2.2"><csymbol cd="ambiguous" id="A1.SS4.p4.1.m1.4.5.2.2.1.cmml" xref="A1.SS4.p4.1.m1.4.5.2.2">subscript</csymbol><apply id="A1.SS4.p4.1.m1.4.5.2.2.2.cmml" xref="A1.SS4.p4.1.m1.4.5.2.2.2"><ci id="A1.SS4.p4.1.m1.4.5.2.2.2.1.cmml" xref="A1.SS4.p4.1.m1.4.5.2.2.2.1">^</ci><ci id="A1.SS4.p4.1.m1.4.5.2.2.2.2.cmml" xref="A1.SS4.p4.1.m1.4.5.2.2.2.2">𝑟</ci></apply><ci id="A1.SS4.p4.1.m1.4.5.2.2.3.cmml" xref="A1.SS4.p4.1.m1.4.5.2.2.3">𝜃</ci></apply><interval closure="open" id="A1.SS4.p4.1.m1.4.5.2.3.1.cmml" xref="A1.SS4.p4.1.m1.4.5.2.3.2"><ci id="A1.SS4.p4.1.m1.3.3.cmml" xref="A1.SS4.p4.1.m1.3.3">𝑥</ci><ci id="A1.SS4.p4.1.m1.4.4.cmml" xref="A1.SS4.p4.1.m1.4.4">𝑦</ci></interval></apply><apply id="A1.SS4.p4.1.m1.4.5.3.cmml" xref="A1.SS4.p4.1.m1.4.5.3"><times id="A1.SS4.p4.1.m1.4.5.3.1.cmml" xref="A1.SS4.p4.1.m1.4.5.3.1"></times><ci id="A1.SS4.p4.1.m1.4.5.3.2.cmml" xref="A1.SS4.p4.1.m1.4.5.3.2">𝛽</ci><apply id="A1.SS4.p4.1.m1.4.5.3.3.cmml" xref="A1.SS4.p4.1.m1.4.5.3.3"><log id="A1.SS4.p4.1.m1.4.5.3.3.1.cmml" xref="A1.SS4.p4.1.m1.4.5.3.3.1"></log><apply id="A1.SS4.p4.1.m1.2.2.cmml" xref="A1.SS4.p4.1.m1.2.2"><divide id="A1.SS4.p4.1.m1.2.2.3.cmml" xref="A1.SS4.p4.1.m1.2.2"></divide><apply id="A1.SS4.p4.1.m1.1.1.1.cmml" xref="A1.SS4.p4.1.m1.1.1.1"><times id="A1.SS4.p4.1.m1.1.1.1.2.cmml" xref="A1.SS4.p4.1.m1.1.1.1.2"></times><apply id="A1.SS4.p4.1.m1.1.1.1.3.cmml" xref="A1.SS4.p4.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p4.1.m1.1.1.1.3.1.cmml" xref="A1.SS4.p4.1.m1.1.1.1.3">subscript</csymbol><ci id="A1.SS4.p4.1.m1.1.1.1.3.2.cmml" xref="A1.SS4.p4.1.m1.1.1.1.3.2">𝜋</ci><ci id="A1.SS4.p4.1.m1.1.1.1.3.3.cmml" xref="A1.SS4.p4.1.m1.1.1.1.3.3">𝜃</ci></apply><apply id="A1.SS4.p4.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS4.p4.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS4.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS4.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS4.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS4.p4.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.SS4.p4.1.m1.2.2.2.cmml" xref="A1.SS4.p4.1.m1.2.2.2"><times id="A1.SS4.p4.1.m1.2.2.2.2.cmml" xref="A1.SS4.p4.1.m1.2.2.2.2"></times><apply id="A1.SS4.p4.1.m1.2.2.2.3.cmml" xref="A1.SS4.p4.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS4.p4.1.m1.2.2.2.3.1.cmml" xref="A1.SS4.p4.1.m1.2.2.2.3">subscript</csymbol><ci id="A1.SS4.p4.1.m1.2.2.2.3.2.cmml" xref="A1.SS4.p4.1.m1.2.2.2.3.2">𝜋</ci><ci id="A1.SS4.p4.1.m1.2.2.2.3.3a.cmml" xref="A1.SS4.p4.1.m1.2.2.2.3.3"><mtext id="A1.SS4.p4.1.m1.2.2.2.3.3.cmml" mathsize="50%" xref="A1.SS4.p4.1.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.SS4.p4.1.m1.2.2.2.1.1.1.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="A1.SS4.p4.1.m1.2.2.2.1.1.1.1.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.SS4.p4.1.m1.2.2.2.1.1.1.2.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.SS4.p4.1.m1.2.2.2.1.1.1.3.cmml" xref="A1.SS4.p4.1.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p4.1.m1.4c">\hat{r}_{\theta}(x,y)=\beta\log\frac{\pi_{\theta}(y\mid x)}{\pi_{\text{ref}}(y% \mid x)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p4.1.m1.4d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG</annotation></semantics></math> we obtain the final form of the gradient from Section <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4" title="4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Proof of Lemma 1 and 2</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.1">이 절에서는 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S5" title="5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a>절에서 두 개의 lemmas를 증명할 것이다.</p>
</div>
<div class="ltx_para" id="A1.SS5.p2">
<p class="ltx_p" id="A1.SS5.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS5.p2.1.1">Lemma 1 Restated. </span><span class="ltx_text ltx_font_italic" id="A1.SS5.p2.1.2">Plackett-Luce 선호도 프레임워크 하에서, 특히 Bradley-Terry 프레임워크에서는 동일한 동등성 클래스의 두 보상 함수가 동일한 선호도 분포를 유도한다. </span></p>
</div>
<div class="ltx_proof" id="A1.SS5.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS5.1.p1">
<p class="ltx_p" id="A1.SS5.1.p1.10">We say that two reward functions <math alttext="r(x,y)" class="ltx_Math" display="inline" id="A1.SS5.1.p1.1.m1.2"><semantics id="A1.SS5.1.p1.1.m1.2a"><mrow id="A1.SS5.1.p1.1.m1.2.3" xref="A1.SS5.1.p1.1.m1.2.3.cmml"><mi id="A1.SS5.1.p1.1.m1.2.3.2" xref="A1.SS5.1.p1.1.m1.2.3.2.cmml">r</mi><mo id="A1.SS5.1.p1.1.m1.2.3.1" xref="A1.SS5.1.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A1.SS5.1.p1.1.m1.2.3.3.2" xref="A1.SS5.1.p1.1.m1.2.3.3.1.cmml"><mo id="A1.SS5.1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="A1.SS5.1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="A1.SS5.1.p1.1.m1.1.1" xref="A1.SS5.1.p1.1.m1.1.1.cmml">x</mi><mo id="A1.SS5.1.p1.1.m1.2.3.3.2.2" xref="A1.SS5.1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="A1.SS5.1.p1.1.m1.2.2" xref="A1.SS5.1.p1.1.m1.2.2.cmml">y</mi><mo id="A1.SS5.1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="A1.SS5.1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.1.m1.2b"><apply id="A1.SS5.1.p1.1.m1.2.3.cmml" xref="A1.SS5.1.p1.1.m1.2.3"><times id="A1.SS5.1.p1.1.m1.2.3.1.cmml" xref="A1.SS5.1.p1.1.m1.2.3.1"></times><ci id="A1.SS5.1.p1.1.m1.2.3.2.cmml" xref="A1.SS5.1.p1.1.m1.2.3.2">𝑟</ci><interval closure="open" id="A1.SS5.1.p1.1.m1.2.3.3.1.cmml" xref="A1.SS5.1.p1.1.m1.2.3.3.2"><ci id="A1.SS5.1.p1.1.m1.1.1.cmml" xref="A1.SS5.1.p1.1.m1.1.1">𝑥</ci><ci id="A1.SS5.1.p1.1.m1.2.2.cmml" xref="A1.SS5.1.p1.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.1.m1.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.1.m1.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math> and <math alttext="r^{\prime}(x,y)" class="ltx_Math" display="inline" id="A1.SS5.1.p1.2.m2.2"><semantics id="A1.SS5.1.p1.2.m2.2a"><mrow id="A1.SS5.1.p1.2.m2.2.3" xref="A1.SS5.1.p1.2.m2.2.3.cmml"><msup id="A1.SS5.1.p1.2.m2.2.3.2" xref="A1.SS5.1.p1.2.m2.2.3.2.cmml"><mi id="A1.SS5.1.p1.2.m2.2.3.2.2" xref="A1.SS5.1.p1.2.m2.2.3.2.2.cmml">r</mi><mo id="A1.SS5.1.p1.2.m2.2.3.2.3" xref="A1.SS5.1.p1.2.m2.2.3.2.3.cmml">′</mo></msup><mo id="A1.SS5.1.p1.2.m2.2.3.1" xref="A1.SS5.1.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="A1.SS5.1.p1.2.m2.2.3.3.2" xref="A1.SS5.1.p1.2.m2.2.3.3.1.cmml"><mo id="A1.SS5.1.p1.2.m2.2.3.3.2.1" stretchy="false" xref="A1.SS5.1.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="A1.SS5.1.p1.2.m2.1.1" xref="A1.SS5.1.p1.2.m2.1.1.cmml">x</mi><mo id="A1.SS5.1.p1.2.m2.2.3.3.2.2" xref="A1.SS5.1.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="A1.SS5.1.p1.2.m2.2.2" xref="A1.SS5.1.p1.2.m2.2.2.cmml">y</mi><mo id="A1.SS5.1.p1.2.m2.2.3.3.2.3" stretchy="false" xref="A1.SS5.1.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.2.m2.2b"><apply id="A1.SS5.1.p1.2.m2.2.3.cmml" xref="A1.SS5.1.p1.2.m2.2.3"><times id="A1.SS5.1.p1.2.m2.2.3.1.cmml" xref="A1.SS5.1.p1.2.m2.2.3.1"></times><apply id="A1.SS5.1.p1.2.m2.2.3.2.cmml" xref="A1.SS5.1.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="A1.SS5.1.p1.2.m2.2.3.2.1.cmml" xref="A1.SS5.1.p1.2.m2.2.3.2">superscript</csymbol><ci id="A1.SS5.1.p1.2.m2.2.3.2.2.cmml" xref="A1.SS5.1.p1.2.m2.2.3.2.2">𝑟</ci><ci id="A1.SS5.1.p1.2.m2.2.3.2.3.cmml" xref="A1.SS5.1.p1.2.m2.2.3.2.3">′</ci></apply><interval closure="open" id="A1.SS5.1.p1.2.m2.2.3.3.1.cmml" xref="A1.SS5.1.p1.2.m2.2.3.3.2"><ci id="A1.SS5.1.p1.2.m2.1.1.cmml" xref="A1.SS5.1.p1.2.m2.1.1">𝑥</ci><ci id="A1.SS5.1.p1.2.m2.2.2.cmml" xref="A1.SS5.1.p1.2.m2.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.2.m2.2c">r^{\prime}(x,y)</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.2.m2.2d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y )</annotation></semantics></math> are from the same equivalence class if <math alttext="r^{\prime}(x,y)=r(x,y)+f(x)" class="ltx_Math" display="inline" id="A1.SS5.1.p1.3.m3.5"><semantics id="A1.SS5.1.p1.3.m3.5a"><mrow id="A1.SS5.1.p1.3.m3.5.6" xref="A1.SS5.1.p1.3.m3.5.6.cmml"><mrow id="A1.SS5.1.p1.3.m3.5.6.2" xref="A1.SS5.1.p1.3.m3.5.6.2.cmml"><msup id="A1.SS5.1.p1.3.m3.5.6.2.2" xref="A1.SS5.1.p1.3.m3.5.6.2.2.cmml"><mi id="A1.SS5.1.p1.3.m3.5.6.2.2.2" xref="A1.SS5.1.p1.3.m3.5.6.2.2.2.cmml">r</mi><mo id="A1.SS5.1.p1.3.m3.5.6.2.2.3" xref="A1.SS5.1.p1.3.m3.5.6.2.2.3.cmml">′</mo></msup><mo id="A1.SS5.1.p1.3.m3.5.6.2.1" xref="A1.SS5.1.p1.3.m3.5.6.2.1.cmml">⁢</mo><mrow id="A1.SS5.1.p1.3.m3.5.6.2.3.2" xref="A1.SS5.1.p1.3.m3.5.6.2.3.1.cmml"><mo id="A1.SS5.1.p1.3.m3.5.6.2.3.2.1" stretchy="false" xref="A1.SS5.1.p1.3.m3.5.6.2.3.1.cmml">(</mo><mi id="A1.SS5.1.p1.3.m3.1.1" xref="A1.SS5.1.p1.3.m3.1.1.cmml">x</mi><mo id="A1.SS5.1.p1.3.m3.5.6.2.3.2.2" xref="A1.SS5.1.p1.3.m3.5.6.2.3.1.cmml">,</mo><mi id="A1.SS5.1.p1.3.m3.2.2" xref="A1.SS5.1.p1.3.m3.2.2.cmml">y</mi><mo id="A1.SS5.1.p1.3.m3.5.6.2.3.2.3" stretchy="false" xref="A1.SS5.1.p1.3.m3.5.6.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS5.1.p1.3.m3.5.6.1" xref="A1.SS5.1.p1.3.m3.5.6.1.cmml">=</mo><mrow id="A1.SS5.1.p1.3.m3.5.6.3" xref="A1.SS5.1.p1.3.m3.5.6.3.cmml"><mrow id="A1.SS5.1.p1.3.m3.5.6.3.2" xref="A1.SS5.1.p1.3.m3.5.6.3.2.cmml"><mi id="A1.SS5.1.p1.3.m3.5.6.3.2.2" xref="A1.SS5.1.p1.3.m3.5.6.3.2.2.cmml">r</mi><mo id="A1.SS5.1.p1.3.m3.5.6.3.2.1" xref="A1.SS5.1.p1.3.m3.5.6.3.2.1.cmml">⁢</mo><mrow id="A1.SS5.1.p1.3.m3.5.6.3.2.3.2" xref="A1.SS5.1.p1.3.m3.5.6.3.2.3.1.cmml"><mo id="A1.SS5.1.p1.3.m3.5.6.3.2.3.2.1" stretchy="false" xref="A1.SS5.1.p1.3.m3.5.6.3.2.3.1.cmml">(</mo><mi id="A1.SS5.1.p1.3.m3.3.3" xref="A1.SS5.1.p1.3.m3.3.3.cmml">x</mi><mo id="A1.SS5.1.p1.3.m3.5.6.3.2.3.2.2" xref="A1.SS5.1.p1.3.m3.5.6.3.2.3.1.cmml">,</mo><mi id="A1.SS5.1.p1.3.m3.4.4" xref="A1.SS5.1.p1.3.m3.4.4.cmml">y</mi><mo id="A1.SS5.1.p1.3.m3.5.6.3.2.3.2.3" stretchy="false" xref="A1.SS5.1.p1.3.m3.5.6.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS5.1.p1.3.m3.5.6.3.1" xref="A1.SS5.1.p1.3.m3.5.6.3.1.cmml">+</mo><mrow id="A1.SS5.1.p1.3.m3.5.6.3.3" xref="A1.SS5.1.p1.3.m3.5.6.3.3.cmml"><mi id="A1.SS5.1.p1.3.m3.5.6.3.3.2" xref="A1.SS5.1.p1.3.m3.5.6.3.3.2.cmml">f</mi><mo id="A1.SS5.1.p1.3.m3.5.6.3.3.1" xref="A1.SS5.1.p1.3.m3.5.6.3.3.1.cmml">⁢</mo><mrow id="A1.SS5.1.p1.3.m3.5.6.3.3.3.2" xref="A1.SS5.1.p1.3.m3.5.6.3.3.cmml"><mo id="A1.SS5.1.p1.3.m3.5.6.3.3.3.2.1" stretchy="false" xref="A1.SS5.1.p1.3.m3.5.6.3.3.cmml">(</mo><mi id="A1.SS5.1.p1.3.m3.5.5" xref="A1.SS5.1.p1.3.m3.5.5.cmml">x</mi><mo id="A1.SS5.1.p1.3.m3.5.6.3.3.3.2.2" stretchy="false" xref="A1.SS5.1.p1.3.m3.5.6.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.3.m3.5b"><apply id="A1.SS5.1.p1.3.m3.5.6.cmml" xref="A1.SS5.1.p1.3.m3.5.6"><eq id="A1.SS5.1.p1.3.m3.5.6.1.cmml" xref="A1.SS5.1.p1.3.m3.5.6.1"></eq><apply id="A1.SS5.1.p1.3.m3.5.6.2.cmml" xref="A1.SS5.1.p1.3.m3.5.6.2"><times id="A1.SS5.1.p1.3.m3.5.6.2.1.cmml" xref="A1.SS5.1.p1.3.m3.5.6.2.1"></times><apply id="A1.SS5.1.p1.3.m3.5.6.2.2.cmml" xref="A1.SS5.1.p1.3.m3.5.6.2.2"><csymbol cd="ambiguous" id="A1.SS5.1.p1.3.m3.5.6.2.2.1.cmml" xref="A1.SS5.1.p1.3.m3.5.6.2.2">superscript</csymbol><ci id="A1.SS5.1.p1.3.m3.5.6.2.2.2.cmml" xref="A1.SS5.1.p1.3.m3.5.6.2.2.2">𝑟</ci><ci id="A1.SS5.1.p1.3.m3.5.6.2.2.3.cmml" xref="A1.SS5.1.p1.3.m3.5.6.2.2.3">′</ci></apply><interval closure="open" id="A1.SS5.1.p1.3.m3.5.6.2.3.1.cmml" xref="A1.SS5.1.p1.3.m3.5.6.2.3.2"><ci id="A1.SS5.1.p1.3.m3.1.1.cmml" xref="A1.SS5.1.p1.3.m3.1.1">𝑥</ci><ci id="A1.SS5.1.p1.3.m3.2.2.cmml" xref="A1.SS5.1.p1.3.m3.2.2">𝑦</ci></interval></apply><apply id="A1.SS5.1.p1.3.m3.5.6.3.cmml" xref="A1.SS5.1.p1.3.m3.5.6.3"><plus id="A1.SS5.1.p1.3.m3.5.6.3.1.cmml" xref="A1.SS5.1.p1.3.m3.5.6.3.1"></plus><apply id="A1.SS5.1.p1.3.m3.5.6.3.2.cmml" xref="A1.SS5.1.p1.3.m3.5.6.3.2"><times id="A1.SS5.1.p1.3.m3.5.6.3.2.1.cmml" xref="A1.SS5.1.p1.3.m3.5.6.3.2.1"></times><ci id="A1.SS5.1.p1.3.m3.5.6.3.2.2.cmml" xref="A1.SS5.1.p1.3.m3.5.6.3.2.2">𝑟</ci><interval closure="open" id="A1.SS5.1.p1.3.m3.5.6.3.2.3.1.cmml" xref="A1.SS5.1.p1.3.m3.5.6.3.2.3.2"><ci id="A1.SS5.1.p1.3.m3.3.3.cmml" xref="A1.SS5.1.p1.3.m3.3.3">𝑥</ci><ci id="A1.SS5.1.p1.3.m3.4.4.cmml" xref="A1.SS5.1.p1.3.m3.4.4">𝑦</ci></interval></apply><apply id="A1.SS5.1.p1.3.m3.5.6.3.3.cmml" xref="A1.SS5.1.p1.3.m3.5.6.3.3"><times id="A1.SS5.1.p1.3.m3.5.6.3.3.1.cmml" xref="A1.SS5.1.p1.3.m3.5.6.3.3.1"></times><ci id="A1.SS5.1.p1.3.m3.5.6.3.3.2.cmml" xref="A1.SS5.1.p1.3.m3.5.6.3.3.2">𝑓</ci><ci id="A1.SS5.1.p1.3.m3.5.5.cmml" xref="A1.SS5.1.p1.3.m3.5.5">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.3.m3.5c">r^{\prime}(x,y)=r(x,y)+f(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.3.m3.5d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_r ( italic_x , italic_y ) + italic_f ( italic_x )</annotation></semantics></math> for some function <math alttext="f" class="ltx_Math" display="inline" id="A1.SS5.1.p1.4.m4.1"><semantics id="A1.SS5.1.p1.4.m4.1a"><mi id="A1.SS5.1.p1.4.m4.1.1" xref="A1.SS5.1.p1.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.4.m4.1b"><ci id="A1.SS5.1.p1.4.m4.1.1.cmml" xref="A1.SS5.1.p1.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.4.m4.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.4.m4.1d">italic_f</annotation></semantics></math>. We consider the general Plackett-Luce (with the Bradley-Terry model a special case for <math alttext="K=2" class="ltx_Math" display="inline" id="A1.SS5.1.p1.5.m5.1"><semantics id="A1.SS5.1.p1.5.m5.1a"><mrow id="A1.SS5.1.p1.5.m5.1.1" xref="A1.SS5.1.p1.5.m5.1.1.cmml"><mi id="A1.SS5.1.p1.5.m5.1.1.2" xref="A1.SS5.1.p1.5.m5.1.1.2.cmml">K</mi><mo id="A1.SS5.1.p1.5.m5.1.1.1" xref="A1.SS5.1.p1.5.m5.1.1.1.cmml">=</mo><mn id="A1.SS5.1.p1.5.m5.1.1.3" xref="A1.SS5.1.p1.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.5.m5.1b"><apply id="A1.SS5.1.p1.5.m5.1.1.cmml" xref="A1.SS5.1.p1.5.m5.1.1"><eq id="A1.SS5.1.p1.5.m5.1.1.1.cmml" xref="A1.SS5.1.p1.5.m5.1.1.1"></eq><ci id="A1.SS5.1.p1.5.m5.1.1.2.cmml" xref="A1.SS5.1.p1.5.m5.1.1.2">𝐾</ci><cn id="A1.SS5.1.p1.5.m5.1.1.3.cmml" type="integer" xref="A1.SS5.1.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.5.m5.1c">K=2</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.5.m5.1d">italic_K = 2</annotation></semantics></math>) and denote the probability distribution over rankings induced by a particular reward function <math alttext="r(x,y)" class="ltx_Math" display="inline" id="A1.SS5.1.p1.6.m6.2"><semantics id="A1.SS5.1.p1.6.m6.2a"><mrow id="A1.SS5.1.p1.6.m6.2.3" xref="A1.SS5.1.p1.6.m6.2.3.cmml"><mi id="A1.SS5.1.p1.6.m6.2.3.2" xref="A1.SS5.1.p1.6.m6.2.3.2.cmml">r</mi><mo id="A1.SS5.1.p1.6.m6.2.3.1" xref="A1.SS5.1.p1.6.m6.2.3.1.cmml">⁢</mo><mrow id="A1.SS5.1.p1.6.m6.2.3.3.2" xref="A1.SS5.1.p1.6.m6.2.3.3.1.cmml"><mo id="A1.SS5.1.p1.6.m6.2.3.3.2.1" stretchy="false" xref="A1.SS5.1.p1.6.m6.2.3.3.1.cmml">(</mo><mi id="A1.SS5.1.p1.6.m6.1.1" xref="A1.SS5.1.p1.6.m6.1.1.cmml">x</mi><mo id="A1.SS5.1.p1.6.m6.2.3.3.2.2" xref="A1.SS5.1.p1.6.m6.2.3.3.1.cmml">,</mo><mi id="A1.SS5.1.p1.6.m6.2.2" xref="A1.SS5.1.p1.6.m6.2.2.cmml">y</mi><mo id="A1.SS5.1.p1.6.m6.2.3.3.2.3" stretchy="false" xref="A1.SS5.1.p1.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.6.m6.2b"><apply id="A1.SS5.1.p1.6.m6.2.3.cmml" xref="A1.SS5.1.p1.6.m6.2.3"><times id="A1.SS5.1.p1.6.m6.2.3.1.cmml" xref="A1.SS5.1.p1.6.m6.2.3.1"></times><ci id="A1.SS5.1.p1.6.m6.2.3.2.cmml" xref="A1.SS5.1.p1.6.m6.2.3.2">𝑟</ci><interval closure="open" id="A1.SS5.1.p1.6.m6.2.3.3.1.cmml" xref="A1.SS5.1.p1.6.m6.2.3.3.2"><ci id="A1.SS5.1.p1.6.m6.1.1.cmml" xref="A1.SS5.1.p1.6.m6.1.1">𝑥</ci><ci id="A1.SS5.1.p1.6.m6.2.2.cmml" xref="A1.SS5.1.p1.6.m6.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.6.m6.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.6.m6.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math> as <math alttext="p_{r}" class="ltx_Math" display="inline" id="A1.SS5.1.p1.7.m7.1"><semantics id="A1.SS5.1.p1.7.m7.1a"><msub id="A1.SS5.1.p1.7.m7.1.1" xref="A1.SS5.1.p1.7.m7.1.1.cmml"><mi id="A1.SS5.1.p1.7.m7.1.1.2" xref="A1.SS5.1.p1.7.m7.1.1.2.cmml">p</mi><mi id="A1.SS5.1.p1.7.m7.1.1.3" xref="A1.SS5.1.p1.7.m7.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.7.m7.1b"><apply id="A1.SS5.1.p1.7.m7.1.1.cmml" xref="A1.SS5.1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS5.1.p1.7.m7.1.1.1.cmml" xref="A1.SS5.1.p1.7.m7.1.1">subscript</csymbol><ci id="A1.SS5.1.p1.7.m7.1.1.2.cmml" xref="A1.SS5.1.p1.7.m7.1.1.2">𝑝</ci><ci id="A1.SS5.1.p1.7.m7.1.1.3.cmml" xref="A1.SS5.1.p1.7.m7.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.7.m7.1c">p_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.7.m7.1d">italic_p start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>. For any prompt <math alttext="x" class="ltx_Math" display="inline" id="A1.SS5.1.p1.8.m8.1"><semantics id="A1.SS5.1.p1.8.m8.1a"><mi id="A1.SS5.1.p1.8.m8.1.1" xref="A1.SS5.1.p1.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.8.m8.1b"><ci id="A1.SS5.1.p1.8.m8.1.1.cmml" xref="A1.SS5.1.p1.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.8.m8.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.8.m8.1d">italic_x</annotation></semantics></math>, answers <math alttext="y_{1},\ldots,y_{K}" class="ltx_Math" display="inline" id="A1.SS5.1.p1.9.m9.3"><semantics id="A1.SS5.1.p1.9.m9.3a"><mrow id="A1.SS5.1.p1.9.m9.3.3.2" xref="A1.SS5.1.p1.9.m9.3.3.3.cmml"><msub id="A1.SS5.1.p1.9.m9.2.2.1.1" xref="A1.SS5.1.p1.9.m9.2.2.1.1.cmml"><mi id="A1.SS5.1.p1.9.m9.2.2.1.1.2" xref="A1.SS5.1.p1.9.m9.2.2.1.1.2.cmml">y</mi><mn id="A1.SS5.1.p1.9.m9.2.2.1.1.3" xref="A1.SS5.1.p1.9.m9.2.2.1.1.3.cmml">1</mn></msub><mo id="A1.SS5.1.p1.9.m9.3.3.2.3" xref="A1.SS5.1.p1.9.m9.3.3.3.cmml">,</mo><mi id="A1.SS5.1.p1.9.m9.1.1" mathvariant="normal" xref="A1.SS5.1.p1.9.m9.1.1.cmml">…</mi><mo id="A1.SS5.1.p1.9.m9.3.3.2.4" xref="A1.SS5.1.p1.9.m9.3.3.3.cmml">,</mo><msub id="A1.SS5.1.p1.9.m9.3.3.2.2" xref="A1.SS5.1.p1.9.m9.3.3.2.2.cmml"><mi id="A1.SS5.1.p1.9.m9.3.3.2.2.2" xref="A1.SS5.1.p1.9.m9.3.3.2.2.2.cmml">y</mi><mi id="A1.SS5.1.p1.9.m9.3.3.2.2.3" xref="A1.SS5.1.p1.9.m9.3.3.2.2.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.9.m9.3b"><list id="A1.SS5.1.p1.9.m9.3.3.3.cmml" xref="A1.SS5.1.p1.9.m9.3.3.2"><apply id="A1.SS5.1.p1.9.m9.2.2.1.1.cmml" xref="A1.SS5.1.p1.9.m9.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS5.1.p1.9.m9.2.2.1.1.1.cmml" xref="A1.SS5.1.p1.9.m9.2.2.1.1">subscript</csymbol><ci id="A1.SS5.1.p1.9.m9.2.2.1.1.2.cmml" xref="A1.SS5.1.p1.9.m9.2.2.1.1.2">𝑦</ci><cn id="A1.SS5.1.p1.9.m9.2.2.1.1.3.cmml" type="integer" xref="A1.SS5.1.p1.9.m9.2.2.1.1.3">1</cn></apply><ci id="A1.SS5.1.p1.9.m9.1.1.cmml" xref="A1.SS5.1.p1.9.m9.1.1">…</ci><apply id="A1.SS5.1.p1.9.m9.3.3.2.2.cmml" xref="A1.SS5.1.p1.9.m9.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS5.1.p1.9.m9.3.3.2.2.1.cmml" xref="A1.SS5.1.p1.9.m9.3.3.2.2">subscript</csymbol><ci id="A1.SS5.1.p1.9.m9.3.3.2.2.2.cmml" xref="A1.SS5.1.p1.9.m9.3.3.2.2.2">𝑦</ci><ci id="A1.SS5.1.p1.9.m9.3.3.2.2.3.cmml" xref="A1.SS5.1.p1.9.m9.3.3.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.9.m9.3c">y_{1},\ldots,y_{K}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.9.m9.3d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and ranking <math alttext="\tau" class="ltx_Math" display="inline" id="A1.SS5.1.p1.10.m10.1"><semantics id="A1.SS5.1.p1.10.m10.1a"><mi id="A1.SS5.1.p1.10.m10.1.1" xref="A1.SS5.1.p1.10.m10.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.1.p1.10.m10.1b"><ci id="A1.SS5.1.p1.10.m10.1.1.cmml" xref="A1.SS5.1.p1.10.m10.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.1.p1.10.m10.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.1.p1.10.m10.1d">italic_τ</annotation></semantics></math> we have:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx6">
<tbody id="A1.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p_{r^{\prime}}(\tau|y_{1},\ldots,y_{K},x)" class="ltx_Math" display="inline" id="A1.Ex9.m1.3"><semantics id="A1.Ex9.m1.3a"><mrow id="A1.Ex9.m1.3.3" xref="A1.Ex9.m1.3.3.cmml"><msub id="A1.Ex9.m1.3.3.3" xref="A1.Ex9.m1.3.3.3.cmml"><mi id="A1.Ex9.m1.3.3.3.2" xref="A1.Ex9.m1.3.3.3.2.cmml">p</mi><msup id="A1.Ex9.m1.3.3.3.3" xref="A1.Ex9.m1.3.3.3.3.cmml"><mi id="A1.Ex9.m1.3.3.3.3.2" xref="A1.Ex9.m1.3.3.3.3.2.cmml">r</mi><mo id="A1.Ex9.m1.3.3.3.3.3" xref="A1.Ex9.m1.3.3.3.3.3.cmml">′</mo></msup></msub><mo id="A1.Ex9.m1.3.3.2" xref="A1.Ex9.m1.3.3.2.cmml">⁢</mo><mrow id="A1.Ex9.m1.3.3.1.1" xref="A1.Ex9.m1.3.3.1.1.1.cmml"><mo id="A1.Ex9.m1.3.3.1.1.2" stretchy="false" xref="A1.Ex9.m1.3.3.1.1.1.cmml">(</mo><mrow id="A1.Ex9.m1.3.3.1.1.1" xref="A1.Ex9.m1.3.3.1.1.1.cmml"><mi id="A1.Ex9.m1.3.3.1.1.1.4" xref="A1.Ex9.m1.3.3.1.1.1.4.cmml">τ</mi><mo fence="false" id="A1.Ex9.m1.3.3.1.1.1.3" xref="A1.Ex9.m1.3.3.1.1.1.3.cmml">|</mo><mrow id="A1.Ex9.m1.3.3.1.1.1.2.2" xref="A1.Ex9.m1.3.3.1.1.1.2.3.cmml"><msub id="A1.Ex9.m1.3.3.1.1.1.1.1.1" xref="A1.Ex9.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A1.Ex9.m1.3.3.1.1.1.1.1.1.2" xref="A1.Ex9.m1.3.3.1.1.1.1.1.1.2.cmml">y</mi><mn id="A1.Ex9.m1.3.3.1.1.1.1.1.1.3" xref="A1.Ex9.m1.3.3.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.Ex9.m1.3.3.1.1.1.2.2.3" xref="A1.Ex9.m1.3.3.1.1.1.2.3.cmml">,</mo><mi id="A1.Ex9.m1.1.1" mathvariant="normal" xref="A1.Ex9.m1.1.1.cmml">…</mi><mo id="A1.Ex9.m1.3.3.1.1.1.2.2.4" xref="A1.Ex9.m1.3.3.1.1.1.2.3.cmml">,</mo><msub id="A1.Ex9.m1.3.3.1.1.1.2.2.2" xref="A1.Ex9.m1.3.3.1.1.1.2.2.2.cmml"><mi id="A1.Ex9.m1.3.3.1.1.1.2.2.2.2" xref="A1.Ex9.m1.3.3.1.1.1.2.2.2.2.cmml">y</mi><mi id="A1.Ex9.m1.3.3.1.1.1.2.2.2.3" xref="A1.Ex9.m1.3.3.1.1.1.2.2.2.3.cmml">K</mi></msub><mo id="A1.Ex9.m1.3.3.1.1.1.2.2.5" xref="A1.Ex9.m1.3.3.1.1.1.2.3.cmml">,</mo><mi id="A1.Ex9.m1.2.2" xref="A1.Ex9.m1.2.2.cmml">x</mi></mrow></mrow><mo id="A1.Ex9.m1.3.3.1.1.3" stretchy="false" xref="A1.Ex9.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex9.m1.3b"><apply id="A1.Ex9.m1.3.3.cmml" xref="A1.Ex9.m1.3.3"><times id="A1.Ex9.m1.3.3.2.cmml" xref="A1.Ex9.m1.3.3.2"></times><apply id="A1.Ex9.m1.3.3.3.cmml" xref="A1.Ex9.m1.3.3.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.3.3.3.1.cmml" xref="A1.Ex9.m1.3.3.3">subscript</csymbol><ci id="A1.Ex9.m1.3.3.3.2.cmml" xref="A1.Ex9.m1.3.3.3.2">𝑝</ci><apply id="A1.Ex9.m1.3.3.3.3.cmml" xref="A1.Ex9.m1.3.3.3.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.3.3.3.3.1.cmml" xref="A1.Ex9.m1.3.3.3.3">superscript</csymbol><ci id="A1.Ex9.m1.3.3.3.3.2.cmml" xref="A1.Ex9.m1.3.3.3.3.2">𝑟</ci><ci id="A1.Ex9.m1.3.3.3.3.3.cmml" xref="A1.Ex9.m1.3.3.3.3.3">′</ci></apply></apply><apply id="A1.Ex9.m1.3.3.1.1.1.cmml" xref="A1.Ex9.m1.3.3.1.1"><csymbol cd="latexml" id="A1.Ex9.m1.3.3.1.1.1.3.cmml" xref="A1.Ex9.m1.3.3.1.1.1.3">conditional</csymbol><ci id="A1.Ex9.m1.3.3.1.1.1.4.cmml" xref="A1.Ex9.m1.3.3.1.1.1.4">𝜏</ci><list id="A1.Ex9.m1.3.3.1.1.1.2.3.cmml" xref="A1.Ex9.m1.3.3.1.1.1.2.2"><apply id="A1.Ex9.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex9.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex9.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.Ex9.m1.3.3.1.1.1.1.1.1.2">𝑦</ci><cn id="A1.Ex9.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex9.m1.3.3.1.1.1.1.1.1.3">1</cn></apply><ci id="A1.Ex9.m1.1.1.cmml" xref="A1.Ex9.m1.1.1">…</ci><apply id="A1.Ex9.m1.3.3.1.1.1.2.2.2.cmml" xref="A1.Ex9.m1.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.Ex9.m1.3.3.1.1.1.2.2.2.1.cmml" xref="A1.Ex9.m1.3.3.1.1.1.2.2.2">subscript</csymbol><ci id="A1.Ex9.m1.3.3.1.1.1.2.2.2.2.cmml" xref="A1.Ex9.m1.3.3.1.1.1.2.2.2.2">𝑦</ci><ci id="A1.Ex9.m1.3.3.1.1.1.2.2.2.3.cmml" xref="A1.Ex9.m1.3.3.1.1.1.2.2.2.3">𝐾</ci></apply><ci id="A1.Ex9.m1.2.2.cmml" xref="A1.Ex9.m1.2.2">𝑥</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex9.m1.3c">\displaystyle p_{r^{\prime}}(\tau|y_{1},\ldots,y_{K},x)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex9.m1.3d">italic_p start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_τ | italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_x )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\prod_{k=1}^{K}\frac{\exp(r^{\prime}(x,y_{\tau(k)}))}{\sum_{j=k}%
^{K}\exp(r^{\prime}(x,y_{\tau(j)}))}" class="ltx_Math" display="inline" id="A1.Ex9.m2.8"><semantics id="A1.Ex9.m2.8a"><mrow id="A1.Ex9.m2.8.9" xref="A1.Ex9.m2.8.9.cmml"><mi id="A1.Ex9.m2.8.9.2" xref="A1.Ex9.m2.8.9.2.cmml"></mi><mo id="A1.Ex9.m2.8.9.1" xref="A1.Ex9.m2.8.9.1.cmml">=</mo><mrow id="A1.Ex9.m2.8.9.3" xref="A1.Ex9.m2.8.9.3.cmml"><mstyle displaystyle="true" id="A1.Ex9.m2.8.9.3.1" xref="A1.Ex9.m2.8.9.3.1.cmml"><munderover id="A1.Ex9.m2.8.9.3.1a" xref="A1.Ex9.m2.8.9.3.1.cmml"><mo id="A1.Ex9.m2.8.9.3.1.2.2" movablelimits="false" xref="A1.Ex9.m2.8.9.3.1.2.2.cmml">∏</mo><mrow id="A1.Ex9.m2.8.9.3.1.2.3" xref="A1.Ex9.m2.8.9.3.1.2.3.cmml"><mi id="A1.Ex9.m2.8.9.3.1.2.3.2" xref="A1.Ex9.m2.8.9.3.1.2.3.2.cmml">k</mi><mo id="A1.Ex9.m2.8.9.3.1.2.3.1" xref="A1.Ex9.m2.8.9.3.1.2.3.1.cmml">=</mo><mn id="A1.Ex9.m2.8.9.3.1.2.3.3" xref="A1.Ex9.m2.8.9.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.Ex9.m2.8.9.3.1.3" xref="A1.Ex9.m2.8.9.3.1.3.cmml">K</mi></munderover></mstyle><mstyle displaystyle="true" id="A1.Ex9.m2.8.8" xref="A1.Ex9.m2.8.8.cmml"><mfrac id="A1.Ex9.m2.8.8a" xref="A1.Ex9.m2.8.8.cmml"><mrow id="A1.Ex9.m2.4.4.4.4" xref="A1.Ex9.m2.4.4.4.5.cmml"><mi id="A1.Ex9.m2.3.3.3.3" xref="A1.Ex9.m2.3.3.3.3.cmml">exp</mi><mo id="A1.Ex9.m2.4.4.4.4a" xref="A1.Ex9.m2.4.4.4.5.cmml">⁡</mo><mrow id="A1.Ex9.m2.4.4.4.4.1" xref="A1.Ex9.m2.4.4.4.5.cmml"><mo id="A1.Ex9.m2.4.4.4.4.1.2" stretchy="false" xref="A1.Ex9.m2.4.4.4.5.cmml">(</mo><mrow id="A1.Ex9.m2.4.4.4.4.1.1" xref="A1.Ex9.m2.4.4.4.4.1.1.cmml"><msup id="A1.Ex9.m2.4.4.4.4.1.1.3" xref="A1.Ex9.m2.4.4.4.4.1.1.3.cmml"><mi id="A1.Ex9.m2.4.4.4.4.1.1.3.2" xref="A1.Ex9.m2.4.4.4.4.1.1.3.2.cmml">r</mi><mo id="A1.Ex9.m2.4.4.4.4.1.1.3.3" xref="A1.Ex9.m2.4.4.4.4.1.1.3.3.cmml">′</mo></msup><mo id="A1.Ex9.m2.4.4.4.4.1.1.2" xref="A1.Ex9.m2.4.4.4.4.1.1.2.cmml">⁢</mo><mrow id="A1.Ex9.m2.4.4.4.4.1.1.1.1" xref="A1.Ex9.m2.4.4.4.4.1.1.1.2.cmml"><mo id="A1.Ex9.m2.4.4.4.4.1.1.1.1.2" stretchy="false" xref="A1.Ex9.m2.4.4.4.4.1.1.1.2.cmml">(</mo><mi id="A1.Ex9.m2.2.2.2.2" xref="A1.Ex9.m2.2.2.2.2.cmml">x</mi><mo id="A1.Ex9.m2.4.4.4.4.1.1.1.1.3" xref="A1.Ex9.m2.4.4.4.4.1.1.1.2.cmml">,</mo><msub id="A1.Ex9.m2.4.4.4.4.1.1.1.1.1" xref="A1.Ex9.m2.4.4.4.4.1.1.1.1.1.cmml"><mi id="A1.Ex9.m2.4.4.4.4.1.1.1.1.1.2" xref="A1.Ex9.m2.4.4.4.4.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.Ex9.m2.1.1.1.1.1" xref="A1.Ex9.m2.1.1.1.1.1.cmml"><mi id="A1.Ex9.m2.1.1.1.1.1.3" xref="A1.Ex9.m2.1.1.1.1.1.3.cmml">τ</mi><mo id="A1.Ex9.m2.1.1.1.1.1.2" xref="A1.Ex9.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex9.m2.1.1.1.1.1.4.2" xref="A1.Ex9.m2.1.1.1.1.1.cmml"><mo id="A1.Ex9.m2.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.Ex9.m2.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex9.m2.1.1.1.1.1.1" xref="A1.Ex9.m2.1.1.1.1.1.1.cmml">k</mi><mo id="A1.Ex9.m2.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.Ex9.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.Ex9.m2.4.4.4.4.1.1.1.1.4" stretchy="false" xref="A1.Ex9.m2.4.4.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex9.m2.4.4.4.4.1.3" stretchy="false" xref="A1.Ex9.m2.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="A1.Ex9.m2.8.8.8" xref="A1.Ex9.m2.8.8.8.cmml"><msubsup id="A1.Ex9.m2.8.8.8.5" xref="A1.Ex9.m2.8.8.8.5.cmml"><mo id="A1.Ex9.m2.8.8.8.5.2.2" xref="A1.Ex9.m2.8.8.8.5.2.2.cmml">∑</mo><mrow id="A1.Ex9.m2.8.8.8.5.2.3" xref="A1.Ex9.m2.8.8.8.5.2.3.cmml"><mi id="A1.Ex9.m2.8.8.8.5.2.3.2" xref="A1.Ex9.m2.8.8.8.5.2.3.2.cmml">j</mi><mo id="A1.Ex9.m2.8.8.8.5.2.3.1" xref="A1.Ex9.m2.8.8.8.5.2.3.1.cmml">=</mo><mi id="A1.Ex9.m2.8.8.8.5.2.3.3" xref="A1.Ex9.m2.8.8.8.5.2.3.3.cmml">k</mi></mrow><mi id="A1.Ex9.m2.8.8.8.5.3" xref="A1.Ex9.m2.8.8.8.5.3.cmml">K</mi></msubsup><mrow id="A1.Ex9.m2.8.8.8.4.1" xref="A1.Ex9.m2.8.8.8.4.2.cmml"><mi id="A1.Ex9.m2.7.7.7.3" xref="A1.Ex9.m2.7.7.7.3.cmml">exp</mi><mo id="A1.Ex9.m2.8.8.8.4.1a" xref="A1.Ex9.m2.8.8.8.4.2.cmml">⁡</mo><mrow id="A1.Ex9.m2.8.8.8.4.1.1" xref="A1.Ex9.m2.8.8.8.4.2.cmml"><mo id="A1.Ex9.m2.8.8.8.4.1.1.2" stretchy="false" xref="A1.Ex9.m2.8.8.8.4.2.cmml">(</mo><mrow id="A1.Ex9.m2.8.8.8.4.1.1.1" xref="A1.Ex9.m2.8.8.8.4.1.1.1.cmml"><msup id="A1.Ex9.m2.8.8.8.4.1.1.1.3" xref="A1.Ex9.m2.8.8.8.4.1.1.1.3.cmml"><mi id="A1.Ex9.m2.8.8.8.4.1.1.1.3.2" xref="A1.Ex9.m2.8.8.8.4.1.1.1.3.2.cmml">r</mi><mo id="A1.Ex9.m2.8.8.8.4.1.1.1.3.3" xref="A1.Ex9.m2.8.8.8.4.1.1.1.3.3.cmml">′</mo></msup><mo id="A1.Ex9.m2.8.8.8.4.1.1.1.2" xref="A1.Ex9.m2.8.8.8.4.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex9.m2.8.8.8.4.1.1.1.1.1" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.2.cmml"><mo id="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.2" stretchy="false" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.2.cmml">(</mo><mi id="A1.Ex9.m2.6.6.6.2" xref="A1.Ex9.m2.6.6.6.2.cmml">x</mi><mo id="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.3" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.2.cmml">,</mo><msub id="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1.cmml"><mi id="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1.2" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.Ex9.m2.5.5.5.1.1" xref="A1.Ex9.m2.5.5.5.1.1.cmml"><mi id="A1.Ex9.m2.5.5.5.1.1.3" xref="A1.Ex9.m2.5.5.5.1.1.3.cmml">τ</mi><mo id="A1.Ex9.m2.5.5.5.1.1.2" xref="A1.Ex9.m2.5.5.5.1.1.2.cmml">⁢</mo><mrow id="A1.Ex9.m2.5.5.5.1.1.4.2" xref="A1.Ex9.m2.5.5.5.1.1.cmml"><mo id="A1.Ex9.m2.5.5.5.1.1.4.2.1" stretchy="false" xref="A1.Ex9.m2.5.5.5.1.1.cmml">(</mo><mi id="A1.Ex9.m2.5.5.5.1.1.1" xref="A1.Ex9.m2.5.5.5.1.1.1.cmml">j</mi><mo id="A1.Ex9.m2.5.5.5.1.1.4.2.2" stretchy="false" xref="A1.Ex9.m2.5.5.5.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.4" stretchy="false" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex9.m2.8.8.8.4.1.1.3" stretchy="false" xref="A1.Ex9.m2.8.8.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex9.m2.8b"><apply id="A1.Ex9.m2.8.9.cmml" xref="A1.Ex9.m2.8.9"><eq id="A1.Ex9.m2.8.9.1.cmml" xref="A1.Ex9.m2.8.9.1"></eq><csymbol cd="latexml" id="A1.Ex9.m2.8.9.2.cmml" xref="A1.Ex9.m2.8.9.2">absent</csymbol><apply id="A1.Ex9.m2.8.9.3.cmml" xref="A1.Ex9.m2.8.9.3"><apply id="A1.Ex9.m2.8.9.3.1.cmml" xref="A1.Ex9.m2.8.9.3.1"><csymbol cd="ambiguous" id="A1.Ex9.m2.8.9.3.1.1.cmml" xref="A1.Ex9.m2.8.9.3.1">superscript</csymbol><apply id="A1.Ex9.m2.8.9.3.1.2.cmml" xref="A1.Ex9.m2.8.9.3.1"><csymbol cd="ambiguous" id="A1.Ex9.m2.8.9.3.1.2.1.cmml" xref="A1.Ex9.m2.8.9.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.Ex9.m2.8.9.3.1.2.2.cmml" xref="A1.Ex9.m2.8.9.3.1.2.2">product</csymbol><apply id="A1.Ex9.m2.8.9.3.1.2.3.cmml" xref="A1.Ex9.m2.8.9.3.1.2.3"><eq id="A1.Ex9.m2.8.9.3.1.2.3.1.cmml" xref="A1.Ex9.m2.8.9.3.1.2.3.1"></eq><ci id="A1.Ex9.m2.8.9.3.1.2.3.2.cmml" xref="A1.Ex9.m2.8.9.3.1.2.3.2">𝑘</ci><cn id="A1.Ex9.m2.8.9.3.1.2.3.3.cmml" type="integer" xref="A1.Ex9.m2.8.9.3.1.2.3.3">1</cn></apply></apply><ci id="A1.Ex9.m2.8.9.3.1.3.cmml" xref="A1.Ex9.m2.8.9.3.1.3">𝐾</ci></apply><apply id="A1.Ex9.m2.8.8.cmml" xref="A1.Ex9.m2.8.8"><divide id="A1.Ex9.m2.8.8.9.cmml" xref="A1.Ex9.m2.8.8"></divide><apply id="A1.Ex9.m2.4.4.4.5.cmml" xref="A1.Ex9.m2.4.4.4.4"><exp id="A1.Ex9.m2.3.3.3.3.cmml" xref="A1.Ex9.m2.3.3.3.3"></exp><apply id="A1.Ex9.m2.4.4.4.4.1.1.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1"><times id="A1.Ex9.m2.4.4.4.4.1.1.2.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1.2"></times><apply id="A1.Ex9.m2.4.4.4.4.1.1.3.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1.3"><csymbol cd="ambiguous" id="A1.Ex9.m2.4.4.4.4.1.1.3.1.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1.3">superscript</csymbol><ci id="A1.Ex9.m2.4.4.4.4.1.1.3.2.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1.3.2">𝑟</ci><ci id="A1.Ex9.m2.4.4.4.4.1.1.3.3.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1.3.3">′</ci></apply><interval closure="open" id="A1.Ex9.m2.4.4.4.4.1.1.1.2.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1.1.1"><ci id="A1.Ex9.m2.2.2.2.2.cmml" xref="A1.Ex9.m2.2.2.2.2">𝑥</ci><apply id="A1.Ex9.m2.4.4.4.4.1.1.1.1.1.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex9.m2.4.4.4.4.1.1.1.1.1.1.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex9.m2.4.4.4.4.1.1.1.1.1.2.cmml" xref="A1.Ex9.m2.4.4.4.4.1.1.1.1.1.2">𝑦</ci><apply id="A1.Ex9.m2.1.1.1.1.1.cmml" xref="A1.Ex9.m2.1.1.1.1.1"><times id="A1.Ex9.m2.1.1.1.1.1.2.cmml" xref="A1.Ex9.m2.1.1.1.1.1.2"></times><ci id="A1.Ex9.m2.1.1.1.1.1.3.cmml" xref="A1.Ex9.m2.1.1.1.1.1.3">𝜏</ci><ci id="A1.Ex9.m2.1.1.1.1.1.1.cmml" xref="A1.Ex9.m2.1.1.1.1.1.1">𝑘</ci></apply></apply></interval></apply></apply><apply id="A1.Ex9.m2.8.8.8.cmml" xref="A1.Ex9.m2.8.8.8"><apply id="A1.Ex9.m2.8.8.8.5.cmml" xref="A1.Ex9.m2.8.8.8.5"><csymbol cd="ambiguous" id="A1.Ex9.m2.8.8.8.5.1.cmml" xref="A1.Ex9.m2.8.8.8.5">superscript</csymbol><apply id="A1.Ex9.m2.8.8.8.5.2.cmml" xref="A1.Ex9.m2.8.8.8.5"><csymbol cd="ambiguous" id="A1.Ex9.m2.8.8.8.5.2.1.cmml" xref="A1.Ex9.m2.8.8.8.5">subscript</csymbol><sum id="A1.Ex9.m2.8.8.8.5.2.2.cmml" xref="A1.Ex9.m2.8.8.8.5.2.2"></sum><apply id="A1.Ex9.m2.8.8.8.5.2.3.cmml" xref="A1.Ex9.m2.8.8.8.5.2.3"><eq id="A1.Ex9.m2.8.8.8.5.2.3.1.cmml" xref="A1.Ex9.m2.8.8.8.5.2.3.1"></eq><ci id="A1.Ex9.m2.8.8.8.5.2.3.2.cmml" xref="A1.Ex9.m2.8.8.8.5.2.3.2">𝑗</ci><ci id="A1.Ex9.m2.8.8.8.5.2.3.3.cmml" xref="A1.Ex9.m2.8.8.8.5.2.3.3">𝑘</ci></apply></apply><ci id="A1.Ex9.m2.8.8.8.5.3.cmml" xref="A1.Ex9.m2.8.8.8.5.3">𝐾</ci></apply><apply id="A1.Ex9.m2.8.8.8.4.2.cmml" xref="A1.Ex9.m2.8.8.8.4.1"><exp id="A1.Ex9.m2.7.7.7.3.cmml" xref="A1.Ex9.m2.7.7.7.3"></exp><apply id="A1.Ex9.m2.8.8.8.4.1.1.1.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1"><times id="A1.Ex9.m2.8.8.8.4.1.1.1.2.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1.2"></times><apply id="A1.Ex9.m2.8.8.8.4.1.1.1.3.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex9.m2.8.8.8.4.1.1.1.3.1.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1.3">superscript</csymbol><ci id="A1.Ex9.m2.8.8.8.4.1.1.1.3.2.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1.3.2">𝑟</ci><ci id="A1.Ex9.m2.8.8.8.4.1.1.1.3.3.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1.3.3">′</ci></apply><interval closure="open" id="A1.Ex9.m2.8.8.8.4.1.1.1.1.2.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.1"><ci id="A1.Ex9.m2.6.6.6.2.cmml" xref="A1.Ex9.m2.6.6.6.2">𝑥</ci><apply id="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1.1.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1.2.cmml" xref="A1.Ex9.m2.8.8.8.4.1.1.1.1.1.1.2">𝑦</ci><apply id="A1.Ex9.m2.5.5.5.1.1.cmml" xref="A1.Ex9.m2.5.5.5.1.1"><times id="A1.Ex9.m2.5.5.5.1.1.2.cmml" xref="A1.Ex9.m2.5.5.5.1.1.2"></times><ci id="A1.Ex9.m2.5.5.5.1.1.3.cmml" xref="A1.Ex9.m2.5.5.5.1.1.3">𝜏</ci><ci id="A1.Ex9.m2.5.5.5.1.1.1.cmml" xref="A1.Ex9.m2.5.5.5.1.1.1">𝑗</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex9.m2.8c">\displaystyle=\prod_{k=1}^{K}\frac{\exp(r^{\prime}(x,y_{\tau(k)}))}{\sum_{j=k}%
^{K}\exp(r^{\prime}(x,y_{\tau(j)}))}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex9.m2.8d">= ∏ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG roman_exp ( italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_k ) end_POSTSUBSCRIPT ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_j ) end_POSTSUBSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\prod_{k=1}^{K}\frac{\exp(r(x,y_{\tau(k)})+f(x))}{\sum_{j=k}^{K}%
\exp(r(x,y_{\tau(j)})+f(x))}" class="ltx_Math" display="inline" id="A1.Ex10.m1.10"><semantics id="A1.Ex10.m1.10a"><mrow id="A1.Ex10.m1.10.11" xref="A1.Ex10.m1.10.11.cmml"><mi id="A1.Ex10.m1.10.11.2" xref="A1.Ex10.m1.10.11.2.cmml"></mi><mo id="A1.Ex10.m1.10.11.1" xref="A1.Ex10.m1.10.11.1.cmml">=</mo><mrow id="A1.Ex10.m1.10.11.3" xref="A1.Ex10.m1.10.11.3.cmml"><mstyle displaystyle="true" id="A1.Ex10.m1.10.11.3.1" xref="A1.Ex10.m1.10.11.3.1.cmml"><munderover id="A1.Ex10.m1.10.11.3.1a" xref="A1.Ex10.m1.10.11.3.1.cmml"><mo id="A1.Ex10.m1.10.11.3.1.2.2" movablelimits="false" xref="A1.Ex10.m1.10.11.3.1.2.2.cmml">∏</mo><mrow id="A1.Ex10.m1.10.11.3.1.2.3" xref="A1.Ex10.m1.10.11.3.1.2.3.cmml"><mi id="A1.Ex10.m1.10.11.3.1.2.3.2" xref="A1.Ex10.m1.10.11.3.1.2.3.2.cmml">k</mi><mo id="A1.Ex10.m1.10.11.3.1.2.3.1" xref="A1.Ex10.m1.10.11.3.1.2.3.1.cmml">=</mo><mn id="A1.Ex10.m1.10.11.3.1.2.3.3" xref="A1.Ex10.m1.10.11.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.Ex10.m1.10.11.3.1.3" xref="A1.Ex10.m1.10.11.3.1.3.cmml">K</mi></munderover></mstyle><mstyle displaystyle="true" id="A1.Ex10.m1.10.10" xref="A1.Ex10.m1.10.10.cmml"><mfrac id="A1.Ex10.m1.10.10a" xref="A1.Ex10.m1.10.10.cmml"><mrow id="A1.Ex10.m1.5.5.5.5" xref="A1.Ex10.m1.5.5.5.6.cmml"><mi id="A1.Ex10.m1.4.4.4.4" xref="A1.Ex10.m1.4.4.4.4.cmml">exp</mi><mo id="A1.Ex10.m1.5.5.5.5a" xref="A1.Ex10.m1.5.5.5.6.cmml">⁡</mo><mrow id="A1.Ex10.m1.5.5.5.5.1" xref="A1.Ex10.m1.5.5.5.6.cmml"><mo id="A1.Ex10.m1.5.5.5.5.1.2" stretchy="false" xref="A1.Ex10.m1.5.5.5.6.cmml">(</mo><mrow id="A1.Ex10.m1.5.5.5.5.1.1" xref="A1.Ex10.m1.5.5.5.5.1.1.cmml"><mrow id="A1.Ex10.m1.5.5.5.5.1.1.1" xref="A1.Ex10.m1.5.5.5.5.1.1.1.cmml"><mi id="A1.Ex10.m1.5.5.5.5.1.1.1.3" xref="A1.Ex10.m1.5.5.5.5.1.1.1.3.cmml">r</mi><mo id="A1.Ex10.m1.5.5.5.5.1.1.1.2" xref="A1.Ex10.m1.5.5.5.5.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.2.cmml"><mo id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.2" stretchy="false" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.2.cmml">(</mo><mi id="A1.Ex10.m1.2.2.2.2" xref="A1.Ex10.m1.2.2.2.2.cmml">x</mi><mo id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.3" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.2.cmml">,</mo><msub id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.Ex10.m1.1.1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.1.1.1.1.1.3" xref="A1.Ex10.m1.1.1.1.1.1.3.cmml">τ</mi><mo id="A1.Ex10.m1.1.1.1.1.1.2" xref="A1.Ex10.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex10.m1.1.1.1.1.1.4.2" xref="A1.Ex10.m1.1.1.1.1.1.cmml"><mo id="A1.Ex10.m1.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.Ex10.m1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex10.m1.1.1.1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.1.1.cmml">k</mi><mo id="A1.Ex10.m1.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.Ex10.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.4" stretchy="false" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.5.5.5.5.1.1.2" xref="A1.Ex10.m1.5.5.5.5.1.1.2.cmml">+</mo><mrow id="A1.Ex10.m1.5.5.5.5.1.1.3" xref="A1.Ex10.m1.5.5.5.5.1.1.3.cmml"><mi id="A1.Ex10.m1.5.5.5.5.1.1.3.2" xref="A1.Ex10.m1.5.5.5.5.1.1.3.2.cmml">f</mi><mo id="A1.Ex10.m1.5.5.5.5.1.1.3.1" xref="A1.Ex10.m1.5.5.5.5.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex10.m1.5.5.5.5.1.1.3.3.2" xref="A1.Ex10.m1.5.5.5.5.1.1.3.cmml"><mo id="A1.Ex10.m1.5.5.5.5.1.1.3.3.2.1" stretchy="false" xref="A1.Ex10.m1.5.5.5.5.1.1.3.cmml">(</mo><mi id="A1.Ex10.m1.3.3.3.3" xref="A1.Ex10.m1.3.3.3.3.cmml">x</mi><mo id="A1.Ex10.m1.5.5.5.5.1.1.3.3.2.2" stretchy="false" xref="A1.Ex10.m1.5.5.5.5.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex10.m1.5.5.5.5.1.3" stretchy="false" xref="A1.Ex10.m1.5.5.5.6.cmml">)</mo></mrow></mrow><mrow id="A1.Ex10.m1.10.10.10" xref="A1.Ex10.m1.10.10.10.cmml"><msubsup id="A1.Ex10.m1.10.10.10.6" xref="A1.Ex10.m1.10.10.10.6.cmml"><mo id="A1.Ex10.m1.10.10.10.6.2.2" xref="A1.Ex10.m1.10.10.10.6.2.2.cmml">∑</mo><mrow id="A1.Ex10.m1.10.10.10.6.2.3" xref="A1.Ex10.m1.10.10.10.6.2.3.cmml"><mi id="A1.Ex10.m1.10.10.10.6.2.3.2" xref="A1.Ex10.m1.10.10.10.6.2.3.2.cmml">j</mi><mo id="A1.Ex10.m1.10.10.10.6.2.3.1" xref="A1.Ex10.m1.10.10.10.6.2.3.1.cmml">=</mo><mi id="A1.Ex10.m1.10.10.10.6.2.3.3" xref="A1.Ex10.m1.10.10.10.6.2.3.3.cmml">k</mi></mrow><mi id="A1.Ex10.m1.10.10.10.6.3" xref="A1.Ex10.m1.10.10.10.6.3.cmml">K</mi></msubsup><mrow id="A1.Ex10.m1.10.10.10.5.1" xref="A1.Ex10.m1.10.10.10.5.2.cmml"><mi id="A1.Ex10.m1.9.9.9.4" xref="A1.Ex10.m1.9.9.9.4.cmml">exp</mi><mo id="A1.Ex10.m1.10.10.10.5.1a" xref="A1.Ex10.m1.10.10.10.5.2.cmml">⁡</mo><mrow id="A1.Ex10.m1.10.10.10.5.1.1" xref="A1.Ex10.m1.10.10.10.5.2.cmml"><mo id="A1.Ex10.m1.10.10.10.5.1.1.2" stretchy="false" xref="A1.Ex10.m1.10.10.10.5.2.cmml">(</mo><mrow id="A1.Ex10.m1.10.10.10.5.1.1.1" xref="A1.Ex10.m1.10.10.10.5.1.1.1.cmml"><mrow id="A1.Ex10.m1.10.10.10.5.1.1.1.1" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.cmml"><mi id="A1.Ex10.m1.10.10.10.5.1.1.1.1.3" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.3.cmml">r</mi><mo id="A1.Ex10.m1.10.10.10.5.1.1.1.1.2" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.2.cmml"><mo id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.2.cmml">(</mo><mi id="A1.Ex10.m1.7.7.7.2" xref="A1.Ex10.m1.7.7.7.2.cmml">x</mi><mo id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.3" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.2.cmml">,</mo><msub id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1.2" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.Ex10.m1.6.6.6.1.1" xref="A1.Ex10.m1.6.6.6.1.1.cmml"><mi id="A1.Ex10.m1.6.6.6.1.1.3" xref="A1.Ex10.m1.6.6.6.1.1.3.cmml">τ</mi><mo id="A1.Ex10.m1.6.6.6.1.1.2" xref="A1.Ex10.m1.6.6.6.1.1.2.cmml">⁢</mo><mrow id="A1.Ex10.m1.6.6.6.1.1.4.2" xref="A1.Ex10.m1.6.6.6.1.1.cmml"><mo id="A1.Ex10.m1.6.6.6.1.1.4.2.1" stretchy="false" xref="A1.Ex10.m1.6.6.6.1.1.cmml">(</mo><mi id="A1.Ex10.m1.6.6.6.1.1.1" xref="A1.Ex10.m1.6.6.6.1.1.1.cmml">j</mi><mo id="A1.Ex10.m1.6.6.6.1.1.4.2.2" stretchy="false" xref="A1.Ex10.m1.6.6.6.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.4" stretchy="false" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex10.m1.10.10.10.5.1.1.1.2" xref="A1.Ex10.m1.10.10.10.5.1.1.1.2.cmml">+</mo><mrow id="A1.Ex10.m1.10.10.10.5.1.1.1.3" xref="A1.Ex10.m1.10.10.10.5.1.1.1.3.cmml"><mi id="A1.Ex10.m1.10.10.10.5.1.1.1.3.2" xref="A1.Ex10.m1.10.10.10.5.1.1.1.3.2.cmml">f</mi><mo id="A1.Ex10.m1.10.10.10.5.1.1.1.3.1" xref="A1.Ex10.m1.10.10.10.5.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex10.m1.10.10.10.5.1.1.1.3.3.2" xref="A1.Ex10.m1.10.10.10.5.1.1.1.3.cmml"><mo id="A1.Ex10.m1.10.10.10.5.1.1.1.3.3.2.1" stretchy="false" xref="A1.Ex10.m1.10.10.10.5.1.1.1.3.cmml">(</mo><mi id="A1.Ex10.m1.8.8.8.3" xref="A1.Ex10.m1.8.8.8.3.cmml">x</mi><mo id="A1.Ex10.m1.10.10.10.5.1.1.1.3.3.2.2" stretchy="false" xref="A1.Ex10.m1.10.10.10.5.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex10.m1.10.10.10.5.1.1.3" stretchy="false" xref="A1.Ex10.m1.10.10.10.5.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex10.m1.10b"><apply id="A1.Ex10.m1.10.11.cmml" xref="A1.Ex10.m1.10.11"><eq id="A1.Ex10.m1.10.11.1.cmml" xref="A1.Ex10.m1.10.11.1"></eq><csymbol cd="latexml" id="A1.Ex10.m1.10.11.2.cmml" xref="A1.Ex10.m1.10.11.2">absent</csymbol><apply id="A1.Ex10.m1.10.11.3.cmml" xref="A1.Ex10.m1.10.11.3"><apply id="A1.Ex10.m1.10.11.3.1.cmml" xref="A1.Ex10.m1.10.11.3.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.10.11.3.1.1.cmml" xref="A1.Ex10.m1.10.11.3.1">superscript</csymbol><apply id="A1.Ex10.m1.10.11.3.1.2.cmml" xref="A1.Ex10.m1.10.11.3.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.10.11.3.1.2.1.cmml" xref="A1.Ex10.m1.10.11.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.Ex10.m1.10.11.3.1.2.2.cmml" xref="A1.Ex10.m1.10.11.3.1.2.2">product</csymbol><apply id="A1.Ex10.m1.10.11.3.1.2.3.cmml" xref="A1.Ex10.m1.10.11.3.1.2.3"><eq id="A1.Ex10.m1.10.11.3.1.2.3.1.cmml" xref="A1.Ex10.m1.10.11.3.1.2.3.1"></eq><ci id="A1.Ex10.m1.10.11.3.1.2.3.2.cmml" xref="A1.Ex10.m1.10.11.3.1.2.3.2">𝑘</ci><cn id="A1.Ex10.m1.10.11.3.1.2.3.3.cmml" type="integer" xref="A1.Ex10.m1.10.11.3.1.2.3.3">1</cn></apply></apply><ci id="A1.Ex10.m1.10.11.3.1.3.cmml" xref="A1.Ex10.m1.10.11.3.1.3">𝐾</ci></apply><apply id="A1.Ex10.m1.10.10.cmml" xref="A1.Ex10.m1.10.10"><divide id="A1.Ex10.m1.10.10.11.cmml" xref="A1.Ex10.m1.10.10"></divide><apply id="A1.Ex10.m1.5.5.5.6.cmml" xref="A1.Ex10.m1.5.5.5.5"><exp id="A1.Ex10.m1.4.4.4.4.cmml" xref="A1.Ex10.m1.4.4.4.4"></exp><apply id="A1.Ex10.m1.5.5.5.5.1.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1"><plus id="A1.Ex10.m1.5.5.5.5.1.1.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.2"></plus><apply id="A1.Ex10.m1.5.5.5.5.1.1.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1"><times id="A1.Ex10.m1.5.5.5.5.1.1.1.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.2"></times><ci id="A1.Ex10.m1.5.5.5.5.1.1.1.3.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex10.m1.5.5.5.5.1.1.1.1.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1"><ci id="A1.Ex10.m1.2.2.2.2.cmml" xref="A1.Ex10.m1.2.2.2.2">𝑥</ci><apply id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2">𝑦</ci><apply id="A1.Ex10.m1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.1.1.1.1.1"><times id="A1.Ex10.m1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.1.1.1.1.1.2"></times><ci id="A1.Ex10.m1.1.1.1.1.1.3.cmml" xref="A1.Ex10.m1.1.1.1.1.1.3">𝜏</ci><ci id="A1.Ex10.m1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1">𝑘</ci></apply></apply></interval></apply><apply id="A1.Ex10.m1.5.5.5.5.1.1.3.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.3"><times id="A1.Ex10.m1.5.5.5.5.1.1.3.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.3.1"></times><ci id="A1.Ex10.m1.5.5.5.5.1.1.3.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.3.2">𝑓</ci><ci id="A1.Ex10.m1.3.3.3.3.cmml" xref="A1.Ex10.m1.3.3.3.3">𝑥</ci></apply></apply></apply><apply id="A1.Ex10.m1.10.10.10.cmml" xref="A1.Ex10.m1.10.10.10"><apply id="A1.Ex10.m1.10.10.10.6.cmml" xref="A1.Ex10.m1.10.10.10.6"><csymbol cd="ambiguous" id="A1.Ex10.m1.10.10.10.6.1.cmml" xref="A1.Ex10.m1.10.10.10.6">superscript</csymbol><apply id="A1.Ex10.m1.10.10.10.6.2.cmml" xref="A1.Ex10.m1.10.10.10.6"><csymbol cd="ambiguous" id="A1.Ex10.m1.10.10.10.6.2.1.cmml" xref="A1.Ex10.m1.10.10.10.6">subscript</csymbol><sum id="A1.Ex10.m1.10.10.10.6.2.2.cmml" xref="A1.Ex10.m1.10.10.10.6.2.2"></sum><apply id="A1.Ex10.m1.10.10.10.6.2.3.cmml" xref="A1.Ex10.m1.10.10.10.6.2.3"><eq id="A1.Ex10.m1.10.10.10.6.2.3.1.cmml" xref="A1.Ex10.m1.10.10.10.6.2.3.1"></eq><ci id="A1.Ex10.m1.10.10.10.6.2.3.2.cmml" xref="A1.Ex10.m1.10.10.10.6.2.3.2">𝑗</ci><ci id="A1.Ex10.m1.10.10.10.6.2.3.3.cmml" xref="A1.Ex10.m1.10.10.10.6.2.3.3">𝑘</ci></apply></apply><ci id="A1.Ex10.m1.10.10.10.6.3.cmml" xref="A1.Ex10.m1.10.10.10.6.3">𝐾</ci></apply><apply id="A1.Ex10.m1.10.10.10.5.2.cmml" xref="A1.Ex10.m1.10.10.10.5.1"><exp id="A1.Ex10.m1.9.9.9.4.cmml" xref="A1.Ex10.m1.9.9.9.4"></exp><apply id="A1.Ex10.m1.10.10.10.5.1.1.1.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1"><plus id="A1.Ex10.m1.10.10.10.5.1.1.1.2.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.2"></plus><apply id="A1.Ex10.m1.10.10.10.5.1.1.1.1.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1"><times id="A1.Ex10.m1.10.10.10.5.1.1.1.1.2.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.2"></times><ci id="A1.Ex10.m1.10.10.10.5.1.1.1.1.3.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1"><ci id="A1.Ex10.m1.7.7.7.2.cmml" xref="A1.Ex10.m1.7.7.7.2">𝑥</ci><apply id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.1.1.1.1.2">𝑦</ci><apply id="A1.Ex10.m1.6.6.6.1.1.cmml" xref="A1.Ex10.m1.6.6.6.1.1"><times id="A1.Ex10.m1.6.6.6.1.1.2.cmml" xref="A1.Ex10.m1.6.6.6.1.1.2"></times><ci id="A1.Ex10.m1.6.6.6.1.1.3.cmml" xref="A1.Ex10.m1.6.6.6.1.1.3">𝜏</ci><ci id="A1.Ex10.m1.6.6.6.1.1.1.cmml" xref="A1.Ex10.m1.6.6.6.1.1.1">𝑗</ci></apply></apply></interval></apply><apply id="A1.Ex10.m1.10.10.10.5.1.1.1.3.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.3"><times id="A1.Ex10.m1.10.10.10.5.1.1.1.3.1.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.3.1"></times><ci id="A1.Ex10.m1.10.10.10.5.1.1.1.3.2.cmml" xref="A1.Ex10.m1.10.10.10.5.1.1.1.3.2">𝑓</ci><ci id="A1.Ex10.m1.8.8.8.3.cmml" xref="A1.Ex10.m1.8.8.8.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex10.m1.10c">\displaystyle=\prod_{k=1}^{K}\frac{\exp(r(x,y_{\tau(k)})+f(x))}{\sum_{j=k}^{K}%
\exp(r(x,y_{\tau(j)})+f(x))}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex10.m1.10d">= ∏ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG roman_exp ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_k ) end_POSTSUBSCRIPT ) + italic_f ( italic_x ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_j ) end_POSTSUBSCRIPT ) + italic_f ( italic_x ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\prod_{k=1}^{K}\frac{\exp(f(x))\exp(r(x,y_{\tau(k)}))}{\exp(f(x)%
)\sum_{j=k}^{K}\exp(r(x,y_{\tau(j)}))}" class="ltx_Math" display="inline" id="A1.Ex11.m1.14"><semantics id="A1.Ex11.m1.14a"><mrow id="A1.Ex11.m1.14.15" xref="A1.Ex11.m1.14.15.cmml"><mi id="A1.Ex11.m1.14.15.2" xref="A1.Ex11.m1.14.15.2.cmml"></mi><mo id="A1.Ex11.m1.14.15.1" xref="A1.Ex11.m1.14.15.1.cmml">=</mo><mrow id="A1.Ex11.m1.14.15.3" xref="A1.Ex11.m1.14.15.3.cmml"><mstyle displaystyle="true" id="A1.Ex11.m1.14.15.3.1" xref="A1.Ex11.m1.14.15.3.1.cmml"><munderover id="A1.Ex11.m1.14.15.3.1a" xref="A1.Ex11.m1.14.15.3.1.cmml"><mo id="A1.Ex11.m1.14.15.3.1.2.2" movablelimits="false" xref="A1.Ex11.m1.14.15.3.1.2.2.cmml">∏</mo><mrow id="A1.Ex11.m1.14.15.3.1.2.3" xref="A1.Ex11.m1.14.15.3.1.2.3.cmml"><mi id="A1.Ex11.m1.14.15.3.1.2.3.2" xref="A1.Ex11.m1.14.15.3.1.2.3.2.cmml">k</mi><mo id="A1.Ex11.m1.14.15.3.1.2.3.1" xref="A1.Ex11.m1.14.15.3.1.2.3.1.cmml">=</mo><mn id="A1.Ex11.m1.14.15.3.1.2.3.3" xref="A1.Ex11.m1.14.15.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.Ex11.m1.14.15.3.1.3" xref="A1.Ex11.m1.14.15.3.1.3.cmml">K</mi></munderover></mstyle><mstyle displaystyle="true" id="A1.Ex11.m1.14.14" xref="A1.Ex11.m1.14.14.cmml"><mfrac id="A1.Ex11.m1.14.14a" xref="A1.Ex11.m1.14.14.cmml"><mrow id="A1.Ex11.m1.7.7.7" xref="A1.Ex11.m1.7.7.7.cmml"><mrow id="A1.Ex11.m1.6.6.6.6.1" xref="A1.Ex11.m1.6.6.6.6.2.cmml"><mi id="A1.Ex11.m1.3.3.3.3" xref="A1.Ex11.m1.3.3.3.3.cmml">exp</mi><mo id="A1.Ex11.m1.6.6.6.6.1a" xref="A1.Ex11.m1.6.6.6.6.2.cmml">⁡</mo><mrow id="A1.Ex11.m1.6.6.6.6.1.1" xref="A1.Ex11.m1.6.6.6.6.2.cmml"><mo id="A1.Ex11.m1.6.6.6.6.1.1.2" stretchy="false" xref="A1.Ex11.m1.6.6.6.6.2.cmml">(</mo><mrow id="A1.Ex11.m1.6.6.6.6.1.1.1" xref="A1.Ex11.m1.6.6.6.6.1.1.1.cmml"><mi id="A1.Ex11.m1.6.6.6.6.1.1.1.2" xref="A1.Ex11.m1.6.6.6.6.1.1.1.2.cmml">f</mi><mo id="A1.Ex11.m1.6.6.6.6.1.1.1.1" xref="A1.Ex11.m1.6.6.6.6.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex11.m1.6.6.6.6.1.1.1.3.2" xref="A1.Ex11.m1.6.6.6.6.1.1.1.cmml"><mo id="A1.Ex11.m1.6.6.6.6.1.1.1.3.2.1" stretchy="false" xref="A1.Ex11.m1.6.6.6.6.1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.2.2.2.2" xref="A1.Ex11.m1.2.2.2.2.cmml">x</mi><mo id="A1.Ex11.m1.6.6.6.6.1.1.1.3.2.2" stretchy="false" xref="A1.Ex11.m1.6.6.6.6.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.6.6.6.6.1.1.3" stretchy="false" xref="A1.Ex11.m1.6.6.6.6.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.7.7.7.8" lspace="0.167em" xref="A1.Ex11.m1.7.7.7.8.cmml">⁢</mo><mrow id="A1.Ex11.m1.7.7.7.7.1" xref="A1.Ex11.m1.7.7.7.7.2.cmml"><mi id="A1.Ex11.m1.5.5.5.5" xref="A1.Ex11.m1.5.5.5.5.cmml">exp</mi><mo id="A1.Ex11.m1.7.7.7.7.1a" xref="A1.Ex11.m1.7.7.7.7.2.cmml">⁡</mo><mrow id="A1.Ex11.m1.7.7.7.7.1.1" xref="A1.Ex11.m1.7.7.7.7.2.cmml"><mo id="A1.Ex11.m1.7.7.7.7.1.1.2" stretchy="false" xref="A1.Ex11.m1.7.7.7.7.2.cmml">(</mo><mrow id="A1.Ex11.m1.7.7.7.7.1.1.1" xref="A1.Ex11.m1.7.7.7.7.1.1.1.cmml"><mi id="A1.Ex11.m1.7.7.7.7.1.1.1.3" xref="A1.Ex11.m1.7.7.7.7.1.1.1.3.cmml">r</mi><mo id="A1.Ex11.m1.7.7.7.7.1.1.1.2" xref="A1.Ex11.m1.7.7.7.7.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex11.m1.7.7.7.7.1.1.1.1.1" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.2.cmml"><mo id="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.2" stretchy="false" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.2.cmml">(</mo><mi id="A1.Ex11.m1.4.4.4.4" xref="A1.Ex11.m1.4.4.4.4.cmml">x</mi><mo id="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.3" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.2.cmml">,</mo><msub id="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1.cmml"><mi id="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1.2" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.Ex11.m1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.cmml"><mi id="A1.Ex11.m1.1.1.1.1.1.3" xref="A1.Ex11.m1.1.1.1.1.1.3.cmml">τ</mi><mo id="A1.Ex11.m1.1.1.1.1.1.2" xref="A1.Ex11.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex11.m1.1.1.1.1.1.4.2" xref="A1.Ex11.m1.1.1.1.1.1.cmml"><mo id="A1.Ex11.m1.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.Ex11.m1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.cmml">k</mi><mo id="A1.Ex11.m1.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.Ex11.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.4" stretchy="false" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.7.7.7.7.1.1.3" stretchy="false" xref="A1.Ex11.m1.7.7.7.7.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A1.Ex11.m1.14.14.14" xref="A1.Ex11.m1.14.14.14.cmml"><mrow id="A1.Ex11.m1.13.13.13.6.1" xref="A1.Ex11.m1.13.13.13.6.2.cmml"><mi id="A1.Ex11.m1.10.10.10.3" xref="A1.Ex11.m1.10.10.10.3.cmml">exp</mi><mo id="A1.Ex11.m1.13.13.13.6.1a" xref="A1.Ex11.m1.13.13.13.6.2.cmml">⁡</mo><mrow id="A1.Ex11.m1.13.13.13.6.1.1" xref="A1.Ex11.m1.13.13.13.6.2.cmml"><mo id="A1.Ex11.m1.13.13.13.6.1.1.2" stretchy="false" xref="A1.Ex11.m1.13.13.13.6.2.cmml">(</mo><mrow id="A1.Ex11.m1.13.13.13.6.1.1.1" xref="A1.Ex11.m1.13.13.13.6.1.1.1.cmml"><mi id="A1.Ex11.m1.13.13.13.6.1.1.1.2" xref="A1.Ex11.m1.13.13.13.6.1.1.1.2.cmml">f</mi><mo id="A1.Ex11.m1.13.13.13.6.1.1.1.1" xref="A1.Ex11.m1.13.13.13.6.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex11.m1.13.13.13.6.1.1.1.3.2" xref="A1.Ex11.m1.13.13.13.6.1.1.1.cmml"><mo id="A1.Ex11.m1.13.13.13.6.1.1.1.3.2.1" stretchy="false" xref="A1.Ex11.m1.13.13.13.6.1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.9.9.9.2" xref="A1.Ex11.m1.9.9.9.2.cmml">x</mi><mo id="A1.Ex11.m1.13.13.13.6.1.1.1.3.2.2" stretchy="false" xref="A1.Ex11.m1.13.13.13.6.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.13.13.13.6.1.1.3" stretchy="false" xref="A1.Ex11.m1.13.13.13.6.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.14.14.14.8" xref="A1.Ex11.m1.14.14.14.8.cmml">⁢</mo><mrow id="A1.Ex11.m1.14.14.14.7" xref="A1.Ex11.m1.14.14.14.7.cmml"><msubsup id="A1.Ex11.m1.14.14.14.7.2" xref="A1.Ex11.m1.14.14.14.7.2.cmml"><mo id="A1.Ex11.m1.14.14.14.7.2.2.2" xref="A1.Ex11.m1.14.14.14.7.2.2.2.cmml">∑</mo><mrow id="A1.Ex11.m1.14.14.14.7.2.2.3" xref="A1.Ex11.m1.14.14.14.7.2.2.3.cmml"><mi id="A1.Ex11.m1.14.14.14.7.2.2.3.2" xref="A1.Ex11.m1.14.14.14.7.2.2.3.2.cmml">j</mi><mo id="A1.Ex11.m1.14.14.14.7.2.2.3.1" xref="A1.Ex11.m1.14.14.14.7.2.2.3.1.cmml">=</mo><mi id="A1.Ex11.m1.14.14.14.7.2.2.3.3" xref="A1.Ex11.m1.14.14.14.7.2.2.3.3.cmml">k</mi></mrow><mi id="A1.Ex11.m1.14.14.14.7.2.3" xref="A1.Ex11.m1.14.14.14.7.2.3.cmml">K</mi></msubsup><mrow id="A1.Ex11.m1.14.14.14.7.1.1" xref="A1.Ex11.m1.14.14.14.7.1.2.cmml"><mi id="A1.Ex11.m1.12.12.12.5" xref="A1.Ex11.m1.12.12.12.5.cmml">exp</mi><mo id="A1.Ex11.m1.14.14.14.7.1.1a" xref="A1.Ex11.m1.14.14.14.7.1.2.cmml">⁡</mo><mrow id="A1.Ex11.m1.14.14.14.7.1.1.1" xref="A1.Ex11.m1.14.14.14.7.1.2.cmml"><mo id="A1.Ex11.m1.14.14.14.7.1.1.1.2" stretchy="false" xref="A1.Ex11.m1.14.14.14.7.1.2.cmml">(</mo><mrow id="A1.Ex11.m1.14.14.14.7.1.1.1.1" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.cmml"><mi id="A1.Ex11.m1.14.14.14.7.1.1.1.1.3" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.3.cmml">r</mi><mo id="A1.Ex11.m1.14.14.14.7.1.1.1.1.2" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.2.cmml"><mo id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.2.cmml">(</mo><mi id="A1.Ex11.m1.11.11.11.4" xref="A1.Ex11.m1.11.11.11.4.cmml">x</mi><mo id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.3" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.2.cmml">,</mo><msub id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1.2" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.Ex11.m1.8.8.8.1.1" xref="A1.Ex11.m1.8.8.8.1.1.cmml"><mi id="A1.Ex11.m1.8.8.8.1.1.3" xref="A1.Ex11.m1.8.8.8.1.1.3.cmml">τ</mi><mo id="A1.Ex11.m1.8.8.8.1.1.2" xref="A1.Ex11.m1.8.8.8.1.1.2.cmml">⁢</mo><mrow id="A1.Ex11.m1.8.8.8.1.1.4.2" xref="A1.Ex11.m1.8.8.8.1.1.cmml"><mo id="A1.Ex11.m1.8.8.8.1.1.4.2.1" stretchy="false" xref="A1.Ex11.m1.8.8.8.1.1.cmml">(</mo><mi id="A1.Ex11.m1.8.8.8.1.1.1" xref="A1.Ex11.m1.8.8.8.1.1.1.cmml">j</mi><mo id="A1.Ex11.m1.8.8.8.1.1.4.2.2" stretchy="false" xref="A1.Ex11.m1.8.8.8.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.4" stretchy="false" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex11.m1.14.14.14.7.1.1.1.3" stretchy="false" xref="A1.Ex11.m1.14.14.14.7.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex11.m1.14b"><apply id="A1.Ex11.m1.14.15.cmml" xref="A1.Ex11.m1.14.15"><eq id="A1.Ex11.m1.14.15.1.cmml" xref="A1.Ex11.m1.14.15.1"></eq><csymbol cd="latexml" id="A1.Ex11.m1.14.15.2.cmml" xref="A1.Ex11.m1.14.15.2">absent</csymbol><apply id="A1.Ex11.m1.14.15.3.cmml" xref="A1.Ex11.m1.14.15.3"><apply id="A1.Ex11.m1.14.15.3.1.cmml" xref="A1.Ex11.m1.14.15.3.1"><csymbol cd="ambiguous" id="A1.Ex11.m1.14.15.3.1.1.cmml" xref="A1.Ex11.m1.14.15.3.1">superscript</csymbol><apply id="A1.Ex11.m1.14.15.3.1.2.cmml" xref="A1.Ex11.m1.14.15.3.1"><csymbol cd="ambiguous" id="A1.Ex11.m1.14.15.3.1.2.1.cmml" xref="A1.Ex11.m1.14.15.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.Ex11.m1.14.15.3.1.2.2.cmml" xref="A1.Ex11.m1.14.15.3.1.2.2">product</csymbol><apply id="A1.Ex11.m1.14.15.3.1.2.3.cmml" xref="A1.Ex11.m1.14.15.3.1.2.3"><eq id="A1.Ex11.m1.14.15.3.1.2.3.1.cmml" xref="A1.Ex11.m1.14.15.3.1.2.3.1"></eq><ci id="A1.Ex11.m1.14.15.3.1.2.3.2.cmml" xref="A1.Ex11.m1.14.15.3.1.2.3.2">𝑘</ci><cn id="A1.Ex11.m1.14.15.3.1.2.3.3.cmml" type="integer" xref="A1.Ex11.m1.14.15.3.1.2.3.3">1</cn></apply></apply><ci id="A1.Ex11.m1.14.15.3.1.3.cmml" xref="A1.Ex11.m1.14.15.3.1.3">𝐾</ci></apply><apply id="A1.Ex11.m1.14.14.cmml" xref="A1.Ex11.m1.14.14"><divide id="A1.Ex11.m1.14.14.15.cmml" xref="A1.Ex11.m1.14.14"></divide><apply id="A1.Ex11.m1.7.7.7.cmml" xref="A1.Ex11.m1.7.7.7"><times id="A1.Ex11.m1.7.7.7.8.cmml" xref="A1.Ex11.m1.7.7.7.8"></times><apply id="A1.Ex11.m1.6.6.6.6.2.cmml" xref="A1.Ex11.m1.6.6.6.6.1"><exp id="A1.Ex11.m1.3.3.3.3.cmml" xref="A1.Ex11.m1.3.3.3.3"></exp><apply id="A1.Ex11.m1.6.6.6.6.1.1.1.cmml" xref="A1.Ex11.m1.6.6.6.6.1.1.1"><times id="A1.Ex11.m1.6.6.6.6.1.1.1.1.cmml" xref="A1.Ex11.m1.6.6.6.6.1.1.1.1"></times><ci id="A1.Ex11.m1.6.6.6.6.1.1.1.2.cmml" xref="A1.Ex11.m1.6.6.6.6.1.1.1.2">𝑓</ci><ci id="A1.Ex11.m1.2.2.2.2.cmml" xref="A1.Ex11.m1.2.2.2.2">𝑥</ci></apply></apply><apply id="A1.Ex11.m1.7.7.7.7.2.cmml" xref="A1.Ex11.m1.7.7.7.7.1"><exp id="A1.Ex11.m1.5.5.5.5.cmml" xref="A1.Ex11.m1.5.5.5.5"></exp><apply id="A1.Ex11.m1.7.7.7.7.1.1.1.cmml" xref="A1.Ex11.m1.7.7.7.7.1.1.1"><times id="A1.Ex11.m1.7.7.7.7.1.1.1.2.cmml" xref="A1.Ex11.m1.7.7.7.7.1.1.1.2"></times><ci id="A1.Ex11.m1.7.7.7.7.1.1.1.3.cmml" xref="A1.Ex11.m1.7.7.7.7.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex11.m1.7.7.7.7.1.1.1.1.2.cmml" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.1"><ci id="A1.Ex11.m1.4.4.4.4.cmml" xref="A1.Ex11.m1.4.4.4.4">𝑥</ci><apply id="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.7.7.7.7.1.1.1.1.1.1.2">𝑦</ci><apply id="A1.Ex11.m1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1"><times id="A1.Ex11.m1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.1.1.1.1.1.2"></times><ci id="A1.Ex11.m1.1.1.1.1.1.3.cmml" xref="A1.Ex11.m1.1.1.1.1.1.3">𝜏</ci><ci id="A1.Ex11.m1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1">𝑘</ci></apply></apply></interval></apply></apply></apply><apply id="A1.Ex11.m1.14.14.14.cmml" xref="A1.Ex11.m1.14.14.14"><times id="A1.Ex11.m1.14.14.14.8.cmml" xref="A1.Ex11.m1.14.14.14.8"></times><apply id="A1.Ex11.m1.13.13.13.6.2.cmml" xref="A1.Ex11.m1.13.13.13.6.1"><exp id="A1.Ex11.m1.10.10.10.3.cmml" xref="A1.Ex11.m1.10.10.10.3"></exp><apply id="A1.Ex11.m1.13.13.13.6.1.1.1.cmml" xref="A1.Ex11.m1.13.13.13.6.1.1.1"><times id="A1.Ex11.m1.13.13.13.6.1.1.1.1.cmml" xref="A1.Ex11.m1.13.13.13.6.1.1.1.1"></times><ci id="A1.Ex11.m1.13.13.13.6.1.1.1.2.cmml" xref="A1.Ex11.m1.13.13.13.6.1.1.1.2">𝑓</ci><ci id="A1.Ex11.m1.9.9.9.2.cmml" xref="A1.Ex11.m1.9.9.9.2">𝑥</ci></apply></apply><apply id="A1.Ex11.m1.14.14.14.7.cmml" xref="A1.Ex11.m1.14.14.14.7"><apply id="A1.Ex11.m1.14.14.14.7.2.cmml" xref="A1.Ex11.m1.14.14.14.7.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.14.14.14.7.2.1.cmml" xref="A1.Ex11.m1.14.14.14.7.2">superscript</csymbol><apply id="A1.Ex11.m1.14.14.14.7.2.2.cmml" xref="A1.Ex11.m1.14.14.14.7.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.14.14.14.7.2.2.1.cmml" xref="A1.Ex11.m1.14.14.14.7.2">subscript</csymbol><sum id="A1.Ex11.m1.14.14.14.7.2.2.2.cmml" xref="A1.Ex11.m1.14.14.14.7.2.2.2"></sum><apply id="A1.Ex11.m1.14.14.14.7.2.2.3.cmml" xref="A1.Ex11.m1.14.14.14.7.2.2.3"><eq id="A1.Ex11.m1.14.14.14.7.2.2.3.1.cmml" xref="A1.Ex11.m1.14.14.14.7.2.2.3.1"></eq><ci id="A1.Ex11.m1.14.14.14.7.2.2.3.2.cmml" xref="A1.Ex11.m1.14.14.14.7.2.2.3.2">𝑗</ci><ci id="A1.Ex11.m1.14.14.14.7.2.2.3.3.cmml" xref="A1.Ex11.m1.14.14.14.7.2.2.3.3">𝑘</ci></apply></apply><ci id="A1.Ex11.m1.14.14.14.7.2.3.cmml" xref="A1.Ex11.m1.14.14.14.7.2.3">𝐾</ci></apply><apply id="A1.Ex11.m1.14.14.14.7.1.2.cmml" xref="A1.Ex11.m1.14.14.14.7.1.1"><exp id="A1.Ex11.m1.12.12.12.5.cmml" xref="A1.Ex11.m1.12.12.12.5"></exp><apply id="A1.Ex11.m1.14.14.14.7.1.1.1.1.cmml" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1"><times id="A1.Ex11.m1.14.14.14.7.1.1.1.1.2.cmml" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.2"></times><ci id="A1.Ex11.m1.14.14.14.7.1.1.1.1.3.cmml" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1"><ci id="A1.Ex11.m1.11.11.11.4.cmml" xref="A1.Ex11.m1.11.11.11.4">𝑥</ci><apply id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.14.14.14.7.1.1.1.1.1.1.1.2">𝑦</ci><apply id="A1.Ex11.m1.8.8.8.1.1.cmml" xref="A1.Ex11.m1.8.8.8.1.1"><times id="A1.Ex11.m1.8.8.8.1.1.2.cmml" xref="A1.Ex11.m1.8.8.8.1.1.2"></times><ci id="A1.Ex11.m1.8.8.8.1.1.3.cmml" xref="A1.Ex11.m1.8.8.8.1.1.3">𝜏</ci><ci id="A1.Ex11.m1.8.8.8.1.1.1.cmml" xref="A1.Ex11.m1.8.8.8.1.1.1">𝑗</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex11.m1.14c">\displaystyle=\prod_{k=1}^{K}\frac{\exp(f(x))\exp(r(x,y_{\tau(k)}))}{\exp(f(x)%
)\sum_{j=k}^{K}\exp(r(x,y_{\tau(j)}))}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex11.m1.14d">= ∏ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG roman_exp ( italic_f ( italic_x ) ) roman_exp ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_k ) end_POSTSUBSCRIPT ) ) end_ARG start_ARG roman_exp ( italic_f ( italic_x ) ) ∑ start_POSTSUBSCRIPT italic_j = italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_j ) end_POSTSUBSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\prod_{k=1}^{K}\frac{\exp(r(x,y_{\tau(k)}))}{\sum_{j=k}^{K}\exp(%
r(x,y_{\tau(j)}))}" class="ltx_Math" display="inline" id="A1.Ex12.m1.8"><semantics id="A1.Ex12.m1.8a"><mrow id="A1.Ex12.m1.8.9" xref="A1.Ex12.m1.8.9.cmml"><mi id="A1.Ex12.m1.8.9.2" xref="A1.Ex12.m1.8.9.2.cmml"></mi><mo id="A1.Ex12.m1.8.9.1" xref="A1.Ex12.m1.8.9.1.cmml">=</mo><mrow id="A1.Ex12.m1.8.9.3" xref="A1.Ex12.m1.8.9.3.cmml"><mstyle displaystyle="true" id="A1.Ex12.m1.8.9.3.1" xref="A1.Ex12.m1.8.9.3.1.cmml"><munderover id="A1.Ex12.m1.8.9.3.1a" xref="A1.Ex12.m1.8.9.3.1.cmml"><mo id="A1.Ex12.m1.8.9.3.1.2.2" movablelimits="false" xref="A1.Ex12.m1.8.9.3.1.2.2.cmml">∏</mo><mrow id="A1.Ex12.m1.8.9.3.1.2.3" xref="A1.Ex12.m1.8.9.3.1.2.3.cmml"><mi id="A1.Ex12.m1.8.9.3.1.2.3.2" xref="A1.Ex12.m1.8.9.3.1.2.3.2.cmml">k</mi><mo id="A1.Ex12.m1.8.9.3.1.2.3.1" xref="A1.Ex12.m1.8.9.3.1.2.3.1.cmml">=</mo><mn id="A1.Ex12.m1.8.9.3.1.2.3.3" xref="A1.Ex12.m1.8.9.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.Ex12.m1.8.9.3.1.3" xref="A1.Ex12.m1.8.9.3.1.3.cmml">K</mi></munderover></mstyle><mstyle displaystyle="true" id="A1.Ex12.m1.8.8" xref="A1.Ex12.m1.8.8.cmml"><mfrac id="A1.Ex12.m1.8.8a" xref="A1.Ex12.m1.8.8.cmml"><mrow id="A1.Ex12.m1.4.4.4.4" xref="A1.Ex12.m1.4.4.4.5.cmml"><mi id="A1.Ex12.m1.3.3.3.3" xref="A1.Ex12.m1.3.3.3.3.cmml">exp</mi><mo id="A1.Ex12.m1.4.4.4.4a" xref="A1.Ex12.m1.4.4.4.5.cmml">⁡</mo><mrow id="A1.Ex12.m1.4.4.4.4.1" xref="A1.Ex12.m1.4.4.4.5.cmml"><mo id="A1.Ex12.m1.4.4.4.4.1.2" stretchy="false" xref="A1.Ex12.m1.4.4.4.5.cmml">(</mo><mrow id="A1.Ex12.m1.4.4.4.4.1.1" xref="A1.Ex12.m1.4.4.4.4.1.1.cmml"><mi id="A1.Ex12.m1.4.4.4.4.1.1.3" xref="A1.Ex12.m1.4.4.4.4.1.1.3.cmml">r</mi><mo id="A1.Ex12.m1.4.4.4.4.1.1.2" xref="A1.Ex12.m1.4.4.4.4.1.1.2.cmml">⁢</mo><mrow id="A1.Ex12.m1.4.4.4.4.1.1.1.1" xref="A1.Ex12.m1.4.4.4.4.1.1.1.2.cmml"><mo id="A1.Ex12.m1.4.4.4.4.1.1.1.1.2" stretchy="false" xref="A1.Ex12.m1.4.4.4.4.1.1.1.2.cmml">(</mo><mi id="A1.Ex12.m1.2.2.2.2" xref="A1.Ex12.m1.2.2.2.2.cmml">x</mi><mo id="A1.Ex12.m1.4.4.4.4.1.1.1.1.3" xref="A1.Ex12.m1.4.4.4.4.1.1.1.2.cmml">,</mo><msub id="A1.Ex12.m1.4.4.4.4.1.1.1.1.1" xref="A1.Ex12.m1.4.4.4.4.1.1.1.1.1.cmml"><mi id="A1.Ex12.m1.4.4.4.4.1.1.1.1.1.2" xref="A1.Ex12.m1.4.4.4.4.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.Ex12.m1.1.1.1.1.1" xref="A1.Ex12.m1.1.1.1.1.1.cmml"><mi id="A1.Ex12.m1.1.1.1.1.1.3" xref="A1.Ex12.m1.1.1.1.1.1.3.cmml">τ</mi><mo id="A1.Ex12.m1.1.1.1.1.1.2" xref="A1.Ex12.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex12.m1.1.1.1.1.1.4.2" xref="A1.Ex12.m1.1.1.1.1.1.cmml"><mo id="A1.Ex12.m1.1.1.1.1.1.4.2.1" stretchy="false" xref="A1.Ex12.m1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex12.m1.1.1.1.1.1.1" xref="A1.Ex12.m1.1.1.1.1.1.1.cmml">k</mi><mo id="A1.Ex12.m1.1.1.1.1.1.4.2.2" stretchy="false" xref="A1.Ex12.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.Ex12.m1.4.4.4.4.1.1.1.1.4" stretchy="false" xref="A1.Ex12.m1.4.4.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex12.m1.4.4.4.4.1.3" stretchy="false" xref="A1.Ex12.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="A1.Ex12.m1.8.8.8" xref="A1.Ex12.m1.8.8.8.cmml"><msubsup id="A1.Ex12.m1.8.8.8.5" xref="A1.Ex12.m1.8.8.8.5.cmml"><mo id="A1.Ex12.m1.8.8.8.5.2.2" xref="A1.Ex12.m1.8.8.8.5.2.2.cmml">∑</mo><mrow id="A1.Ex12.m1.8.8.8.5.2.3" xref="A1.Ex12.m1.8.8.8.5.2.3.cmml"><mi id="A1.Ex12.m1.8.8.8.5.2.3.2" xref="A1.Ex12.m1.8.8.8.5.2.3.2.cmml">j</mi><mo id="A1.Ex12.m1.8.8.8.5.2.3.1" xref="A1.Ex12.m1.8.8.8.5.2.3.1.cmml">=</mo><mi id="A1.Ex12.m1.8.8.8.5.2.3.3" xref="A1.Ex12.m1.8.8.8.5.2.3.3.cmml">k</mi></mrow><mi id="A1.Ex12.m1.8.8.8.5.3" xref="A1.Ex12.m1.8.8.8.5.3.cmml">K</mi></msubsup><mrow id="A1.Ex12.m1.8.8.8.4.1" xref="A1.Ex12.m1.8.8.8.4.2.cmml"><mi id="A1.Ex12.m1.7.7.7.3" xref="A1.Ex12.m1.7.7.7.3.cmml">exp</mi><mo id="A1.Ex12.m1.8.8.8.4.1a" xref="A1.Ex12.m1.8.8.8.4.2.cmml">⁡</mo><mrow id="A1.Ex12.m1.8.8.8.4.1.1" xref="A1.Ex12.m1.8.8.8.4.2.cmml"><mo id="A1.Ex12.m1.8.8.8.4.1.1.2" stretchy="false" xref="A1.Ex12.m1.8.8.8.4.2.cmml">(</mo><mrow id="A1.Ex12.m1.8.8.8.4.1.1.1" xref="A1.Ex12.m1.8.8.8.4.1.1.1.cmml"><mi id="A1.Ex12.m1.8.8.8.4.1.1.1.3" xref="A1.Ex12.m1.8.8.8.4.1.1.1.3.cmml">r</mi><mo id="A1.Ex12.m1.8.8.8.4.1.1.1.2" xref="A1.Ex12.m1.8.8.8.4.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex12.m1.8.8.8.4.1.1.1.1.1" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.2.cmml"><mo id="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.2" stretchy="false" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.2.cmml">(</mo><mi id="A1.Ex12.m1.6.6.6.2" xref="A1.Ex12.m1.6.6.6.2.cmml">x</mi><mo id="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.3" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.2.cmml">,</mo><msub id="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1.cmml"><mi id="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1.2" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1.2.cmml">y</mi><mrow id="A1.Ex12.m1.5.5.5.1.1" xref="A1.Ex12.m1.5.5.5.1.1.cmml"><mi id="A1.Ex12.m1.5.5.5.1.1.3" xref="A1.Ex12.m1.5.5.5.1.1.3.cmml">τ</mi><mo id="A1.Ex12.m1.5.5.5.1.1.2" xref="A1.Ex12.m1.5.5.5.1.1.2.cmml">⁢</mo><mrow id="A1.Ex12.m1.5.5.5.1.1.4.2" xref="A1.Ex12.m1.5.5.5.1.1.cmml"><mo id="A1.Ex12.m1.5.5.5.1.1.4.2.1" stretchy="false" xref="A1.Ex12.m1.5.5.5.1.1.cmml">(</mo><mi id="A1.Ex12.m1.5.5.5.1.1.1" xref="A1.Ex12.m1.5.5.5.1.1.1.cmml">j</mi><mo id="A1.Ex12.m1.5.5.5.1.1.4.2.2" stretchy="false" xref="A1.Ex12.m1.5.5.5.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.4" stretchy="false" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex12.m1.8.8.8.4.1.1.3" stretchy="false" xref="A1.Ex12.m1.8.8.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex12.m1.8b"><apply id="A1.Ex12.m1.8.9.cmml" xref="A1.Ex12.m1.8.9"><eq id="A1.Ex12.m1.8.9.1.cmml" xref="A1.Ex12.m1.8.9.1"></eq><csymbol cd="latexml" id="A1.Ex12.m1.8.9.2.cmml" xref="A1.Ex12.m1.8.9.2">absent</csymbol><apply id="A1.Ex12.m1.8.9.3.cmml" xref="A1.Ex12.m1.8.9.3"><apply id="A1.Ex12.m1.8.9.3.1.cmml" xref="A1.Ex12.m1.8.9.3.1"><csymbol cd="ambiguous" id="A1.Ex12.m1.8.9.3.1.1.cmml" xref="A1.Ex12.m1.8.9.3.1">superscript</csymbol><apply id="A1.Ex12.m1.8.9.3.1.2.cmml" xref="A1.Ex12.m1.8.9.3.1"><csymbol cd="ambiguous" id="A1.Ex12.m1.8.9.3.1.2.1.cmml" xref="A1.Ex12.m1.8.9.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.Ex12.m1.8.9.3.1.2.2.cmml" xref="A1.Ex12.m1.8.9.3.1.2.2">product</csymbol><apply id="A1.Ex12.m1.8.9.3.1.2.3.cmml" xref="A1.Ex12.m1.8.9.3.1.2.3"><eq id="A1.Ex12.m1.8.9.3.1.2.3.1.cmml" xref="A1.Ex12.m1.8.9.3.1.2.3.1"></eq><ci id="A1.Ex12.m1.8.9.3.1.2.3.2.cmml" xref="A1.Ex12.m1.8.9.3.1.2.3.2">𝑘</ci><cn id="A1.Ex12.m1.8.9.3.1.2.3.3.cmml" type="integer" xref="A1.Ex12.m1.8.9.3.1.2.3.3">1</cn></apply></apply><ci id="A1.Ex12.m1.8.9.3.1.3.cmml" xref="A1.Ex12.m1.8.9.3.1.3">𝐾</ci></apply><apply id="A1.Ex12.m1.8.8.cmml" xref="A1.Ex12.m1.8.8"><divide id="A1.Ex12.m1.8.8.9.cmml" xref="A1.Ex12.m1.8.8"></divide><apply id="A1.Ex12.m1.4.4.4.5.cmml" xref="A1.Ex12.m1.4.4.4.4"><exp id="A1.Ex12.m1.3.3.3.3.cmml" xref="A1.Ex12.m1.3.3.3.3"></exp><apply id="A1.Ex12.m1.4.4.4.4.1.1.cmml" xref="A1.Ex12.m1.4.4.4.4.1.1"><times id="A1.Ex12.m1.4.4.4.4.1.1.2.cmml" xref="A1.Ex12.m1.4.4.4.4.1.1.2"></times><ci id="A1.Ex12.m1.4.4.4.4.1.1.3.cmml" xref="A1.Ex12.m1.4.4.4.4.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex12.m1.4.4.4.4.1.1.1.2.cmml" xref="A1.Ex12.m1.4.4.4.4.1.1.1.1"><ci id="A1.Ex12.m1.2.2.2.2.cmml" xref="A1.Ex12.m1.2.2.2.2">𝑥</ci><apply id="A1.Ex12.m1.4.4.4.4.1.1.1.1.1.cmml" xref="A1.Ex12.m1.4.4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex12.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.4.4.4.4.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex12.m1.4.4.4.4.1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.4.4.4.4.1.1.1.1.1.2">𝑦</ci><apply id="A1.Ex12.m1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1"><times id="A1.Ex12.m1.1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.1.1.1.2"></times><ci id="A1.Ex12.m1.1.1.1.1.1.3.cmml" xref="A1.Ex12.m1.1.1.1.1.1.3">𝜏</ci><ci id="A1.Ex12.m1.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.1.1.1.1.1.1">𝑘</ci></apply></apply></interval></apply></apply><apply id="A1.Ex12.m1.8.8.8.cmml" xref="A1.Ex12.m1.8.8.8"><apply id="A1.Ex12.m1.8.8.8.5.cmml" xref="A1.Ex12.m1.8.8.8.5"><csymbol cd="ambiguous" id="A1.Ex12.m1.8.8.8.5.1.cmml" xref="A1.Ex12.m1.8.8.8.5">superscript</csymbol><apply id="A1.Ex12.m1.8.8.8.5.2.cmml" xref="A1.Ex12.m1.8.8.8.5"><csymbol cd="ambiguous" id="A1.Ex12.m1.8.8.8.5.2.1.cmml" xref="A1.Ex12.m1.8.8.8.5">subscript</csymbol><sum id="A1.Ex12.m1.8.8.8.5.2.2.cmml" xref="A1.Ex12.m1.8.8.8.5.2.2"></sum><apply id="A1.Ex12.m1.8.8.8.5.2.3.cmml" xref="A1.Ex12.m1.8.8.8.5.2.3"><eq id="A1.Ex12.m1.8.8.8.5.2.3.1.cmml" xref="A1.Ex12.m1.8.8.8.5.2.3.1"></eq><ci id="A1.Ex12.m1.8.8.8.5.2.3.2.cmml" xref="A1.Ex12.m1.8.8.8.5.2.3.2">𝑗</ci><ci id="A1.Ex12.m1.8.8.8.5.2.3.3.cmml" xref="A1.Ex12.m1.8.8.8.5.2.3.3">𝑘</ci></apply></apply><ci id="A1.Ex12.m1.8.8.8.5.3.cmml" xref="A1.Ex12.m1.8.8.8.5.3">𝐾</ci></apply><apply id="A1.Ex12.m1.8.8.8.4.2.cmml" xref="A1.Ex12.m1.8.8.8.4.1"><exp id="A1.Ex12.m1.7.7.7.3.cmml" xref="A1.Ex12.m1.7.7.7.3"></exp><apply id="A1.Ex12.m1.8.8.8.4.1.1.1.cmml" xref="A1.Ex12.m1.8.8.8.4.1.1.1"><times id="A1.Ex12.m1.8.8.8.4.1.1.1.2.cmml" xref="A1.Ex12.m1.8.8.8.4.1.1.1.2"></times><ci id="A1.Ex12.m1.8.8.8.4.1.1.1.3.cmml" xref="A1.Ex12.m1.8.8.8.4.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex12.m1.8.8.8.4.1.1.1.1.2.cmml" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.1"><ci id="A1.Ex12.m1.6.6.6.2.cmml" xref="A1.Ex12.m1.6.6.6.2">𝑥</ci><apply id="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.8.8.8.4.1.1.1.1.1.1.2">𝑦</ci><apply id="A1.Ex12.m1.5.5.5.1.1.cmml" xref="A1.Ex12.m1.5.5.5.1.1"><times id="A1.Ex12.m1.5.5.5.1.1.2.cmml" xref="A1.Ex12.m1.5.5.5.1.1.2"></times><ci id="A1.Ex12.m1.5.5.5.1.1.3.cmml" xref="A1.Ex12.m1.5.5.5.1.1.3">𝜏</ci><ci id="A1.Ex12.m1.5.5.5.1.1.1.cmml" xref="A1.Ex12.m1.5.5.5.1.1.1">𝑗</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex12.m1.8c">\displaystyle=\prod_{k=1}^{K}\frac{\exp(r(x,y_{\tau(k)}))}{\sum_{j=k}^{K}\exp(%
r(x,y_{\tau(j)}))}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex12.m1.8d">= ∏ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG roman_exp ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_k ) end_POSTSUBSCRIPT ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT italic_τ ( italic_j ) end_POSTSUBSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=p_{r}(\tau|y_{1},\ldots,y_{K},x)," class="ltx_Math" display="inline" id="A1.Ex13.m1.3"><semantics id="A1.Ex13.m1.3a"><mrow id="A1.Ex13.m1.3.3.1" xref="A1.Ex13.m1.3.3.1.1.cmml"><mrow id="A1.Ex13.m1.3.3.1.1" xref="A1.Ex13.m1.3.3.1.1.cmml"><mi id="A1.Ex13.m1.3.3.1.1.3" xref="A1.Ex13.m1.3.3.1.1.3.cmml"></mi><mo id="A1.Ex13.m1.3.3.1.1.2" xref="A1.Ex13.m1.3.3.1.1.2.cmml">=</mo><mrow id="A1.Ex13.m1.3.3.1.1.1" xref="A1.Ex13.m1.3.3.1.1.1.cmml"><msub id="A1.Ex13.m1.3.3.1.1.1.3" xref="A1.Ex13.m1.3.3.1.1.1.3.cmml"><mi id="A1.Ex13.m1.3.3.1.1.1.3.2" xref="A1.Ex13.m1.3.3.1.1.1.3.2.cmml">p</mi><mi id="A1.Ex13.m1.3.3.1.1.1.3.3" xref="A1.Ex13.m1.3.3.1.1.1.3.3.cmml">r</mi></msub><mo id="A1.Ex13.m1.3.3.1.1.1.2" xref="A1.Ex13.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex13.m1.3.3.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml"><mo id="A1.Ex13.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex13.m1.3.3.1.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A1.Ex13.m1.3.3.1.1.1.1.1.1.4" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.4.cmml">τ</mi><mo fence="false" id="A1.Ex13.m1.3.3.1.1.1.1.1.1.3" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.3.cmml"><msub id="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.3" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="A1.Ex13.m1.1.1" mathvariant="normal" xref="A1.Ex13.m1.1.1.cmml">…</mi><mo id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.4" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.2" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.3" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml">K</mi></msub><mo id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.5" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="A1.Ex13.m1.2.2" xref="A1.Ex13.m1.2.2.cmml">x</mi></mrow></mrow><mo id="A1.Ex13.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex13.m1.3.3.1.2" xref="A1.Ex13.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex13.m1.3b"><apply id="A1.Ex13.m1.3.3.1.1.cmml" xref="A1.Ex13.m1.3.3.1"><eq id="A1.Ex13.m1.3.3.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="A1.Ex13.m1.3.3.1.1.3.cmml" xref="A1.Ex13.m1.3.3.1.1.3">absent</csymbol><apply id="A1.Ex13.m1.3.3.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1"><times id="A1.Ex13.m1.3.3.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.1.2"></times><apply id="A1.Ex13.m1.3.3.1.1.1.3.cmml" xref="A1.Ex13.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.1.3.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.1.3.2.cmml" xref="A1.Ex13.m1.3.3.1.1.1.3.2">𝑝</ci><ci id="A1.Ex13.m1.3.3.1.1.1.3.3.cmml" xref="A1.Ex13.m1.3.3.1.1.1.3.3">𝑟</ci></apply><apply id="A1.Ex13.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex13.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.3">conditional</csymbol><ci id="A1.Ex13.m1.3.3.1.1.1.1.1.1.4.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.4">𝜏</ci><list id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2"><apply id="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑦</ci><cn id="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="A1.Ex13.m1.1.1.cmml" xref="A1.Ex13.m1.1.1">…</ci><apply id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.Ex13.m1.3.3.1.1.1.1.1.1.2.2.2.3">𝐾</ci></apply><ci id="A1.Ex13.m1.2.2.cmml" xref="A1.Ex13.m1.2.2">𝑥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex13.m1.3c">\displaystyle=p_{r}(\tau|y_{1},\ldots,y_{K},x),</annotation><annotation encoding="application/x-llamapun" id="A1.Ex13.m1.3d">= italic_p start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_τ | italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS5.1.p1.11">그것은 증명을 완성한다. ∎</p>
</div>
</div>
<div class="ltx_para" id="A1.SS5.p3">
<p class="ltx_p" id="A1.SS5.p3.1"><span class="ltx_text ltx_font_bold" id="A1.SS5.p3.1.1">Lemma 2 Restated. </span><span class="ltx_text ltx_font_italic" id="A1.SS5.p3.1.2">동일한 동등성 클래스의 두 보상 함수는 제약된 RL 문제에서 동일한 최적 정책을 유도합니다. </span></p>
</div>
<div class="ltx_proof" id="A1.SS5.2">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS5.2.p1">
<p class="ltx_p" id="A1.SS5.2.p1.4">Let us consider two reward functions from the same class, such that <math alttext="r^{\prime}(x,y)=r(x,y)+f(x)" class="ltx_Math" display="inline" id="A1.SS5.2.p1.1.m1.5"><semantics id="A1.SS5.2.p1.1.m1.5a"><mrow id="A1.SS5.2.p1.1.m1.5.6" xref="A1.SS5.2.p1.1.m1.5.6.cmml"><mrow id="A1.SS5.2.p1.1.m1.5.6.2" xref="A1.SS5.2.p1.1.m1.5.6.2.cmml"><msup id="A1.SS5.2.p1.1.m1.5.6.2.2" xref="A1.SS5.2.p1.1.m1.5.6.2.2.cmml"><mi id="A1.SS5.2.p1.1.m1.5.6.2.2.2" xref="A1.SS5.2.p1.1.m1.5.6.2.2.2.cmml">r</mi><mo id="A1.SS5.2.p1.1.m1.5.6.2.2.3" xref="A1.SS5.2.p1.1.m1.5.6.2.2.3.cmml">′</mo></msup><mo id="A1.SS5.2.p1.1.m1.5.6.2.1" xref="A1.SS5.2.p1.1.m1.5.6.2.1.cmml">⁢</mo><mrow id="A1.SS5.2.p1.1.m1.5.6.2.3.2" xref="A1.SS5.2.p1.1.m1.5.6.2.3.1.cmml"><mo id="A1.SS5.2.p1.1.m1.5.6.2.3.2.1" stretchy="false" xref="A1.SS5.2.p1.1.m1.5.6.2.3.1.cmml">(</mo><mi id="A1.SS5.2.p1.1.m1.1.1" xref="A1.SS5.2.p1.1.m1.1.1.cmml">x</mi><mo id="A1.SS5.2.p1.1.m1.5.6.2.3.2.2" xref="A1.SS5.2.p1.1.m1.5.6.2.3.1.cmml">,</mo><mi id="A1.SS5.2.p1.1.m1.2.2" xref="A1.SS5.2.p1.1.m1.2.2.cmml">y</mi><mo id="A1.SS5.2.p1.1.m1.5.6.2.3.2.3" stretchy="false" xref="A1.SS5.2.p1.1.m1.5.6.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS5.2.p1.1.m1.5.6.1" xref="A1.SS5.2.p1.1.m1.5.6.1.cmml">=</mo><mrow id="A1.SS5.2.p1.1.m1.5.6.3" xref="A1.SS5.2.p1.1.m1.5.6.3.cmml"><mrow id="A1.SS5.2.p1.1.m1.5.6.3.2" xref="A1.SS5.2.p1.1.m1.5.6.3.2.cmml"><mi id="A1.SS5.2.p1.1.m1.5.6.3.2.2" xref="A1.SS5.2.p1.1.m1.5.6.3.2.2.cmml">r</mi><mo id="A1.SS5.2.p1.1.m1.5.6.3.2.1" xref="A1.SS5.2.p1.1.m1.5.6.3.2.1.cmml">⁢</mo><mrow id="A1.SS5.2.p1.1.m1.5.6.3.2.3.2" xref="A1.SS5.2.p1.1.m1.5.6.3.2.3.1.cmml"><mo id="A1.SS5.2.p1.1.m1.5.6.3.2.3.2.1" stretchy="false" xref="A1.SS5.2.p1.1.m1.5.6.3.2.3.1.cmml">(</mo><mi id="A1.SS5.2.p1.1.m1.3.3" xref="A1.SS5.2.p1.1.m1.3.3.cmml">x</mi><mo id="A1.SS5.2.p1.1.m1.5.6.3.2.3.2.2" xref="A1.SS5.2.p1.1.m1.5.6.3.2.3.1.cmml">,</mo><mi id="A1.SS5.2.p1.1.m1.4.4" xref="A1.SS5.2.p1.1.m1.4.4.cmml">y</mi><mo id="A1.SS5.2.p1.1.m1.5.6.3.2.3.2.3" stretchy="false" xref="A1.SS5.2.p1.1.m1.5.6.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS5.2.p1.1.m1.5.6.3.1" xref="A1.SS5.2.p1.1.m1.5.6.3.1.cmml">+</mo><mrow id="A1.SS5.2.p1.1.m1.5.6.3.3" xref="A1.SS5.2.p1.1.m1.5.6.3.3.cmml"><mi id="A1.SS5.2.p1.1.m1.5.6.3.3.2" xref="A1.SS5.2.p1.1.m1.5.6.3.3.2.cmml">f</mi><mo id="A1.SS5.2.p1.1.m1.5.6.3.3.1" xref="A1.SS5.2.p1.1.m1.5.6.3.3.1.cmml">⁢</mo><mrow id="A1.SS5.2.p1.1.m1.5.6.3.3.3.2" xref="A1.SS5.2.p1.1.m1.5.6.3.3.cmml"><mo id="A1.SS5.2.p1.1.m1.5.6.3.3.3.2.1" stretchy="false" xref="A1.SS5.2.p1.1.m1.5.6.3.3.cmml">(</mo><mi id="A1.SS5.2.p1.1.m1.5.5" xref="A1.SS5.2.p1.1.m1.5.5.cmml">x</mi><mo id="A1.SS5.2.p1.1.m1.5.6.3.3.3.2.2" stretchy="false" xref="A1.SS5.2.p1.1.m1.5.6.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.2.p1.1.m1.5b"><apply id="A1.SS5.2.p1.1.m1.5.6.cmml" xref="A1.SS5.2.p1.1.m1.5.6"><eq id="A1.SS5.2.p1.1.m1.5.6.1.cmml" xref="A1.SS5.2.p1.1.m1.5.6.1"></eq><apply id="A1.SS5.2.p1.1.m1.5.6.2.cmml" xref="A1.SS5.2.p1.1.m1.5.6.2"><times id="A1.SS5.2.p1.1.m1.5.6.2.1.cmml" xref="A1.SS5.2.p1.1.m1.5.6.2.1"></times><apply id="A1.SS5.2.p1.1.m1.5.6.2.2.cmml" xref="A1.SS5.2.p1.1.m1.5.6.2.2"><csymbol cd="ambiguous" id="A1.SS5.2.p1.1.m1.5.6.2.2.1.cmml" xref="A1.SS5.2.p1.1.m1.5.6.2.2">superscript</csymbol><ci id="A1.SS5.2.p1.1.m1.5.6.2.2.2.cmml" xref="A1.SS5.2.p1.1.m1.5.6.2.2.2">𝑟</ci><ci id="A1.SS5.2.p1.1.m1.5.6.2.2.3.cmml" xref="A1.SS5.2.p1.1.m1.5.6.2.2.3">′</ci></apply><interval closure="open" id="A1.SS5.2.p1.1.m1.5.6.2.3.1.cmml" xref="A1.SS5.2.p1.1.m1.5.6.2.3.2"><ci id="A1.SS5.2.p1.1.m1.1.1.cmml" xref="A1.SS5.2.p1.1.m1.1.1">𝑥</ci><ci id="A1.SS5.2.p1.1.m1.2.2.cmml" xref="A1.SS5.2.p1.1.m1.2.2">𝑦</ci></interval></apply><apply id="A1.SS5.2.p1.1.m1.5.6.3.cmml" xref="A1.SS5.2.p1.1.m1.5.6.3"><plus id="A1.SS5.2.p1.1.m1.5.6.3.1.cmml" xref="A1.SS5.2.p1.1.m1.5.6.3.1"></plus><apply id="A1.SS5.2.p1.1.m1.5.6.3.2.cmml" xref="A1.SS5.2.p1.1.m1.5.6.3.2"><times id="A1.SS5.2.p1.1.m1.5.6.3.2.1.cmml" xref="A1.SS5.2.p1.1.m1.5.6.3.2.1"></times><ci id="A1.SS5.2.p1.1.m1.5.6.3.2.2.cmml" xref="A1.SS5.2.p1.1.m1.5.6.3.2.2">𝑟</ci><interval closure="open" id="A1.SS5.2.p1.1.m1.5.6.3.2.3.1.cmml" xref="A1.SS5.2.p1.1.m1.5.6.3.2.3.2"><ci id="A1.SS5.2.p1.1.m1.3.3.cmml" xref="A1.SS5.2.p1.1.m1.3.3">𝑥</ci><ci id="A1.SS5.2.p1.1.m1.4.4.cmml" xref="A1.SS5.2.p1.1.m1.4.4">𝑦</ci></interval></apply><apply id="A1.SS5.2.p1.1.m1.5.6.3.3.cmml" xref="A1.SS5.2.p1.1.m1.5.6.3.3"><times id="A1.SS5.2.p1.1.m1.5.6.3.3.1.cmml" xref="A1.SS5.2.p1.1.m1.5.6.3.3.1"></times><ci id="A1.SS5.2.p1.1.m1.5.6.3.3.2.cmml" xref="A1.SS5.2.p1.1.m1.5.6.3.3.2">𝑓</ci><ci id="A1.SS5.2.p1.1.m1.5.5.cmml" xref="A1.SS5.2.p1.1.m1.5.5">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.2.p1.1.m1.5c">r^{\prime}(x,y)=r(x,y)+f(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.2.p1.1.m1.5d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_r ( italic_x , italic_y ) + italic_f ( italic_x )</annotation></semantics></math> and, let us denote as <math alttext="\pi_{r}" class="ltx_Math" display="inline" id="A1.SS5.2.p1.2.m2.1"><semantics id="A1.SS5.2.p1.2.m2.1a"><msub id="A1.SS5.2.p1.2.m2.1.1" xref="A1.SS5.2.p1.2.m2.1.1.cmml"><mi id="A1.SS5.2.p1.2.m2.1.1.2" xref="A1.SS5.2.p1.2.m2.1.1.2.cmml">π</mi><mi id="A1.SS5.2.p1.2.m2.1.1.3" xref="A1.SS5.2.p1.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.2.p1.2.m2.1b"><apply id="A1.SS5.2.p1.2.m2.1.1.cmml" xref="A1.SS5.2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS5.2.p1.2.m2.1.1.1.cmml" xref="A1.SS5.2.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS5.2.p1.2.m2.1.1.2.cmml" xref="A1.SS5.2.p1.2.m2.1.1.2">𝜋</ci><ci id="A1.SS5.2.p1.2.m2.1.1.3.cmml" xref="A1.SS5.2.p1.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.2.p1.2.m2.1c">\pi_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.2.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\pi_{r^{\prime}}" class="ltx_Math" display="inline" id="A1.SS5.2.p1.3.m3.1"><semantics id="A1.SS5.2.p1.3.m3.1a"><msub id="A1.SS5.2.p1.3.m3.1.1" xref="A1.SS5.2.p1.3.m3.1.1.cmml"><mi id="A1.SS5.2.p1.3.m3.1.1.2" xref="A1.SS5.2.p1.3.m3.1.1.2.cmml">π</mi><msup id="A1.SS5.2.p1.3.m3.1.1.3" xref="A1.SS5.2.p1.3.m3.1.1.3.cmml"><mi id="A1.SS5.2.p1.3.m3.1.1.3.2" xref="A1.SS5.2.p1.3.m3.1.1.3.2.cmml">r</mi><mo id="A1.SS5.2.p1.3.m3.1.1.3.3" xref="A1.SS5.2.p1.3.m3.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.2.p1.3.m3.1b"><apply id="A1.SS5.2.p1.3.m3.1.1.cmml" xref="A1.SS5.2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS5.2.p1.3.m3.1.1.1.cmml" xref="A1.SS5.2.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS5.2.p1.3.m3.1.1.2.cmml" xref="A1.SS5.2.p1.3.m3.1.1.2">𝜋</ci><apply id="A1.SS5.2.p1.3.m3.1.1.3.cmml" xref="A1.SS5.2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS5.2.p1.3.m3.1.1.3.1.cmml" xref="A1.SS5.2.p1.3.m3.1.1.3">superscript</csymbol><ci id="A1.SS5.2.p1.3.m3.1.1.3.2.cmml" xref="A1.SS5.2.p1.3.m3.1.1.3.2">𝑟</ci><ci id="A1.SS5.2.p1.3.m3.1.1.3.3.cmml" xref="A1.SS5.2.p1.3.m3.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.2.p1.3.m3.1c">\pi_{r^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.2.p1.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> the corresponding optimal policies. By Eq. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E4" title="4 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>, for all <math alttext="x,y" class="ltx_Math" display="inline" id="A1.SS5.2.p1.4.m4.2"><semantics id="A1.SS5.2.p1.4.m4.2a"><mrow id="A1.SS5.2.p1.4.m4.2.3.2" xref="A1.SS5.2.p1.4.m4.2.3.1.cmml"><mi id="A1.SS5.2.p1.4.m4.1.1" xref="A1.SS5.2.p1.4.m4.1.1.cmml">x</mi><mo id="A1.SS5.2.p1.4.m4.2.3.2.1" xref="A1.SS5.2.p1.4.m4.2.3.1.cmml">,</mo><mi id="A1.SS5.2.p1.4.m4.2.2" xref="A1.SS5.2.p1.4.m4.2.2.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.2.p1.4.m4.2b"><list id="A1.SS5.2.p1.4.m4.2.3.1.cmml" xref="A1.SS5.2.p1.4.m4.2.3.2"><ci id="A1.SS5.2.p1.4.m4.1.1.cmml" xref="A1.SS5.2.p1.4.m4.1.1">𝑥</ci><ci id="A1.SS5.2.p1.4.m4.2.2.cmml" xref="A1.SS5.2.p1.4.m4.2.2">𝑦</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.2.p1.4.m4.2c">x,y</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.2.p1.4.m4.2d">italic_x , italic_y</annotation></semantics></math> we have</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx7">
<tbody id="A1.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\pi_{r^{\prime}}(y|x)" class="ltx_Math" display="inline" id="A1.Ex14.m1.1"><semantics id="A1.Ex14.m1.1a"><mrow id="A1.Ex14.m1.1.1" xref="A1.Ex14.m1.1.1.cmml"><msub id="A1.Ex14.m1.1.1.3" xref="A1.Ex14.m1.1.1.3.cmml"><mi id="A1.Ex14.m1.1.1.3.2" xref="A1.Ex14.m1.1.1.3.2.cmml">π</mi><msup id="A1.Ex14.m1.1.1.3.3" xref="A1.Ex14.m1.1.1.3.3.cmml"><mi id="A1.Ex14.m1.1.1.3.3.2" xref="A1.Ex14.m1.1.1.3.3.2.cmml">r</mi><mo id="A1.Ex14.m1.1.1.3.3.3" xref="A1.Ex14.m1.1.1.3.3.3.cmml">′</mo></msup></msub><mo id="A1.Ex14.m1.1.1.2" xref="A1.Ex14.m1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex14.m1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.1.cmml"><mo id="A1.Ex14.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex14.m1.1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.1.cmml"><mi id="A1.Ex14.m1.1.1.1.1.1.2" xref="A1.Ex14.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex14.m1.1.1.1.1.1.1" xref="A1.Ex14.m1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex14.m1.1.1.1.1.1.3" xref="A1.Ex14.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex14.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex14.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex14.m1.1b"><apply id="A1.Ex14.m1.1.1.cmml" xref="A1.Ex14.m1.1.1"><times id="A1.Ex14.m1.1.1.2.cmml" xref="A1.Ex14.m1.1.1.2"></times><apply id="A1.Ex14.m1.1.1.3.cmml" xref="A1.Ex14.m1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.3.1.cmml" xref="A1.Ex14.m1.1.1.3">subscript</csymbol><ci id="A1.Ex14.m1.1.1.3.2.cmml" xref="A1.Ex14.m1.1.1.3.2">𝜋</ci><apply id="A1.Ex14.m1.1.1.3.3.cmml" xref="A1.Ex14.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.3.3.1.cmml" xref="A1.Ex14.m1.1.1.3.3">superscript</csymbol><ci id="A1.Ex14.m1.1.1.3.3.2.cmml" xref="A1.Ex14.m1.1.1.3.3.2">𝑟</ci><ci id="A1.Ex14.m1.1.1.3.3.3.cmml" xref="A1.Ex14.m1.1.1.3.3.3">′</ci></apply></apply><apply id="A1.Ex14.m1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex14.m1.1.1.1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex14.m1.1.1.1.1.1.2.cmml" xref="A1.Ex14.m1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex14.m1.1.1.1.1.1.3.cmml" xref="A1.Ex14.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex14.m1.1c">\displaystyle\pi_{r^{\prime}}(y|x)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex14.m1.1d">italic_π start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_y | italic_x )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r%
^{\prime}(x,y)\right)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r^{\prime}%
(x,y)\right)" class="ltx_Math" display="inline" id="A1.Ex14.m2.10"><semantics id="A1.Ex14.m2.10a"><mrow id="A1.Ex14.m2.10.10" xref="A1.Ex14.m2.10.10.cmml"><mi id="A1.Ex14.m2.10.10.4" xref="A1.Ex14.m2.10.10.4.cmml"></mi><mo id="A1.Ex14.m2.10.10.3" xref="A1.Ex14.m2.10.10.3.cmml">=</mo><mrow id="A1.Ex14.m2.10.10.2" xref="A1.Ex14.m2.10.10.2.cmml"><mstyle displaystyle="true" id="A1.Ex14.m2.5.5" xref="A1.Ex14.m2.5.5.cmml"><mfrac id="A1.Ex14.m2.5.5a" xref="A1.Ex14.m2.5.5.cmml"><mn id="A1.Ex14.m2.5.5.7" xref="A1.Ex14.m2.5.5.7.cmml">1</mn><mrow id="A1.Ex14.m2.5.5.5" xref="A1.Ex14.m2.5.5.5.cmml"><msub id="A1.Ex14.m2.5.5.5.6" xref="A1.Ex14.m2.5.5.5.6.cmml"><mo id="A1.Ex14.m2.5.5.5.6.2" xref="A1.Ex14.m2.5.5.5.6.2.cmml">∑</mo><mi id="A1.Ex14.m2.5.5.5.6.3" xref="A1.Ex14.m2.5.5.5.6.3.cmml">y</mi></msub><mrow id="A1.Ex14.m2.5.5.5.5" xref="A1.Ex14.m2.5.5.5.5.cmml"><msub id="A1.Ex14.m2.5.5.5.5.4" xref="A1.Ex14.m2.5.5.5.5.4.cmml"><mi id="A1.Ex14.m2.5.5.5.5.4.2" xref="A1.Ex14.m2.5.5.5.5.4.2.cmml">π</mi><mtext id="A1.Ex14.m2.5.5.5.5.4.3" xref="A1.Ex14.m2.5.5.5.5.4.3a.cmml">ref</mtext></msub><mo id="A1.Ex14.m2.5.5.5.5.3" xref="A1.Ex14.m2.5.5.5.5.3.cmml">⁢</mo><mrow id="A1.Ex14.m2.4.4.4.4.1.1" xref="A1.Ex14.m2.4.4.4.4.1.1.1.cmml"><mo id="A1.Ex14.m2.4.4.4.4.1.1.2" stretchy="false" xref="A1.Ex14.m2.4.4.4.4.1.1.1.cmml">(</mo><mrow id="A1.Ex14.m2.4.4.4.4.1.1.1" xref="A1.Ex14.m2.4.4.4.4.1.1.1.cmml"><mi id="A1.Ex14.m2.4.4.4.4.1.1.1.2" xref="A1.Ex14.m2.4.4.4.4.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex14.m2.4.4.4.4.1.1.1.1" xref="A1.Ex14.m2.4.4.4.4.1.1.1.1.cmml">|</mo><mi id="A1.Ex14.m2.4.4.4.4.1.1.1.3" xref="A1.Ex14.m2.4.4.4.4.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex14.m2.4.4.4.4.1.1.3" stretchy="false" xref="A1.Ex14.m2.4.4.4.4.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex14.m2.5.5.5.5.3a" lspace="0.167em" xref="A1.Ex14.m2.5.5.5.5.3.cmml">⁢</mo><mrow id="A1.Ex14.m2.5.5.5.5.2.1" xref="A1.Ex14.m2.5.5.5.5.2.2.cmml"><mi id="A1.Ex14.m2.3.3.3.3" xref="A1.Ex14.m2.3.3.3.3.cmml">exp</mi><mo id="A1.Ex14.m2.5.5.5.5.2.1a" xref="A1.Ex14.m2.5.5.5.5.2.2.cmml">⁡</mo><mrow id="A1.Ex14.m2.5.5.5.5.2.1.1" xref="A1.Ex14.m2.5.5.5.5.2.2.cmml"><mo id="A1.Ex14.m2.5.5.5.5.2.1.1.2" xref="A1.Ex14.m2.5.5.5.5.2.2.cmml">(</mo><mrow id="A1.Ex14.m2.5.5.5.5.2.1.1.1" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.cmml"><mfrac id="A1.Ex14.m2.5.5.5.5.2.1.1.1.2" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.cmml"><mn id="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.2" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.3" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.Ex14.m2.5.5.5.5.2.1.1.1.1" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.1.cmml">⁢</mo><msup id="A1.Ex14.m2.5.5.5.5.2.1.1.1.3" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.cmml"><mi id="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.2" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.2.cmml">r</mi><mo id="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.3" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.3.cmml">′</mo></msup><mo id="A1.Ex14.m2.5.5.5.5.2.1.1.1.1a" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.2" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.1.cmml"><mo id="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.2.1" stretchy="false" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.1.cmml">(</mo><mi id="A1.Ex14.m2.1.1.1.1" xref="A1.Ex14.m2.1.1.1.1.cmml">x</mi><mo id="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.2.2" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.1.cmml">,</mo><mi id="A1.Ex14.m2.2.2.2.2" xref="A1.Ex14.m2.2.2.2.2.cmml">y</mi><mo id="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.2.3" stretchy="false" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex14.m2.5.5.5.5.2.1.1.3" xref="A1.Ex14.m2.5.5.5.5.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mstyle><mo id="A1.Ex14.m2.10.10.2.3" xref="A1.Ex14.m2.10.10.2.3.cmml">⁢</mo><msub id="A1.Ex14.m2.10.10.2.4" xref="A1.Ex14.m2.10.10.2.4.cmml"><mi id="A1.Ex14.m2.10.10.2.4.2" xref="A1.Ex14.m2.10.10.2.4.2.cmml">π</mi><mtext id="A1.Ex14.m2.10.10.2.4.3" xref="A1.Ex14.m2.10.10.2.4.3a.cmml">ref</mtext></msub><mo id="A1.Ex14.m2.10.10.2.3a" xref="A1.Ex14.m2.10.10.2.3.cmml">⁢</mo><mrow id="A1.Ex14.m2.9.9.1.1.1" xref="A1.Ex14.m2.9.9.1.1.1.1.cmml"><mo id="A1.Ex14.m2.9.9.1.1.1.2" stretchy="false" xref="A1.Ex14.m2.9.9.1.1.1.1.cmml">(</mo><mrow id="A1.Ex14.m2.9.9.1.1.1.1" xref="A1.Ex14.m2.9.9.1.1.1.1.cmml"><mi id="A1.Ex14.m2.9.9.1.1.1.1.2" xref="A1.Ex14.m2.9.9.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex14.m2.9.9.1.1.1.1.1" xref="A1.Ex14.m2.9.9.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex14.m2.9.9.1.1.1.1.3" xref="A1.Ex14.m2.9.9.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex14.m2.9.9.1.1.1.3" stretchy="false" xref="A1.Ex14.m2.9.9.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex14.m2.10.10.2.3b" lspace="0.167em" xref="A1.Ex14.m2.10.10.2.3.cmml">⁢</mo><mrow id="A1.Ex14.m2.10.10.2.2.1" xref="A1.Ex14.m2.10.10.2.2.2.cmml"><mi id="A1.Ex14.m2.8.8" xref="A1.Ex14.m2.8.8.cmml">exp</mi><mo id="A1.Ex14.m2.10.10.2.2.1a" xref="A1.Ex14.m2.10.10.2.2.2.cmml">⁡</mo><mrow id="A1.Ex14.m2.10.10.2.2.1.1" xref="A1.Ex14.m2.10.10.2.2.2.cmml"><mo id="A1.Ex14.m2.10.10.2.2.1.1.2" xref="A1.Ex14.m2.10.10.2.2.2.cmml">(</mo><mrow id="A1.Ex14.m2.10.10.2.2.1.1.1" xref="A1.Ex14.m2.10.10.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A1.Ex14.m2.10.10.2.2.1.1.1.2" xref="A1.Ex14.m2.10.10.2.2.1.1.1.2.cmml"><mfrac id="A1.Ex14.m2.10.10.2.2.1.1.1.2a" xref="A1.Ex14.m2.10.10.2.2.1.1.1.2.cmml"><mn id="A1.Ex14.m2.10.10.2.2.1.1.1.2.2" xref="A1.Ex14.m2.10.10.2.2.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex14.m2.10.10.2.2.1.1.1.2.3" xref="A1.Ex14.m2.10.10.2.2.1.1.1.2.3.cmml">β</mi></mfrac></mstyle><mo id="A1.Ex14.m2.10.10.2.2.1.1.1.1" xref="A1.Ex14.m2.10.10.2.2.1.1.1.1.cmml">⁢</mo><msup id="A1.Ex14.m2.10.10.2.2.1.1.1.3" xref="A1.Ex14.m2.10.10.2.2.1.1.1.3.cmml"><mi id="A1.Ex14.m2.10.10.2.2.1.1.1.3.2" xref="A1.Ex14.m2.10.10.2.2.1.1.1.3.2.cmml">r</mi><mo id="A1.Ex14.m2.10.10.2.2.1.1.1.3.3" xref="A1.Ex14.m2.10.10.2.2.1.1.1.3.3.cmml">′</mo></msup><mo id="A1.Ex14.m2.10.10.2.2.1.1.1.1a" xref="A1.Ex14.m2.10.10.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex14.m2.10.10.2.2.1.1.1.4.2" xref="A1.Ex14.m2.10.10.2.2.1.1.1.4.1.cmml"><mo id="A1.Ex14.m2.10.10.2.2.1.1.1.4.2.1" stretchy="false" xref="A1.Ex14.m2.10.10.2.2.1.1.1.4.1.cmml">(</mo><mi id="A1.Ex14.m2.6.6" xref="A1.Ex14.m2.6.6.cmml">x</mi><mo id="A1.Ex14.m2.10.10.2.2.1.1.1.4.2.2" xref="A1.Ex14.m2.10.10.2.2.1.1.1.4.1.cmml">,</mo><mi id="A1.Ex14.m2.7.7" xref="A1.Ex14.m2.7.7.cmml">y</mi><mo id="A1.Ex14.m2.10.10.2.2.1.1.1.4.2.3" stretchy="false" xref="A1.Ex14.m2.10.10.2.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex14.m2.10.10.2.2.1.1.3" xref="A1.Ex14.m2.10.10.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex14.m2.10b"><apply id="A1.Ex14.m2.10.10.cmml" xref="A1.Ex14.m2.10.10"><eq id="A1.Ex14.m2.10.10.3.cmml" xref="A1.Ex14.m2.10.10.3"></eq><csymbol cd="latexml" id="A1.Ex14.m2.10.10.4.cmml" xref="A1.Ex14.m2.10.10.4">absent</csymbol><apply id="A1.Ex14.m2.10.10.2.cmml" xref="A1.Ex14.m2.10.10.2"><times id="A1.Ex14.m2.10.10.2.3.cmml" xref="A1.Ex14.m2.10.10.2.3"></times><apply id="A1.Ex14.m2.5.5.cmml" xref="A1.Ex14.m2.5.5"><divide id="A1.Ex14.m2.5.5.6.cmml" xref="A1.Ex14.m2.5.5"></divide><cn id="A1.Ex14.m2.5.5.7.cmml" type="integer" xref="A1.Ex14.m2.5.5.7">1</cn><apply id="A1.Ex14.m2.5.5.5.cmml" xref="A1.Ex14.m2.5.5.5"><apply id="A1.Ex14.m2.5.5.5.6.cmml" xref="A1.Ex14.m2.5.5.5.6"><csymbol cd="ambiguous" id="A1.Ex14.m2.5.5.5.6.1.cmml" xref="A1.Ex14.m2.5.5.5.6">subscript</csymbol><sum id="A1.Ex14.m2.5.5.5.6.2.cmml" xref="A1.Ex14.m2.5.5.5.6.2"></sum><ci id="A1.Ex14.m2.5.5.5.6.3.cmml" xref="A1.Ex14.m2.5.5.5.6.3">𝑦</ci></apply><apply id="A1.Ex14.m2.5.5.5.5.cmml" xref="A1.Ex14.m2.5.5.5.5"><times id="A1.Ex14.m2.5.5.5.5.3.cmml" xref="A1.Ex14.m2.5.5.5.5.3"></times><apply id="A1.Ex14.m2.5.5.5.5.4.cmml" xref="A1.Ex14.m2.5.5.5.5.4"><csymbol cd="ambiguous" id="A1.Ex14.m2.5.5.5.5.4.1.cmml" xref="A1.Ex14.m2.5.5.5.5.4">subscript</csymbol><ci id="A1.Ex14.m2.5.5.5.5.4.2.cmml" xref="A1.Ex14.m2.5.5.5.5.4.2">𝜋</ci><ci id="A1.Ex14.m2.5.5.5.5.4.3a.cmml" xref="A1.Ex14.m2.5.5.5.5.4.3"><mtext id="A1.Ex14.m2.5.5.5.5.4.3.cmml" mathsize="70%" xref="A1.Ex14.m2.5.5.5.5.4.3">ref</mtext></ci></apply><apply id="A1.Ex14.m2.4.4.4.4.1.1.1.cmml" xref="A1.Ex14.m2.4.4.4.4.1.1"><csymbol cd="latexml" id="A1.Ex14.m2.4.4.4.4.1.1.1.1.cmml" xref="A1.Ex14.m2.4.4.4.4.1.1.1.1">conditional</csymbol><ci id="A1.Ex14.m2.4.4.4.4.1.1.1.2.cmml" xref="A1.Ex14.m2.4.4.4.4.1.1.1.2">𝑦</ci><ci id="A1.Ex14.m2.4.4.4.4.1.1.1.3.cmml" xref="A1.Ex14.m2.4.4.4.4.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex14.m2.5.5.5.5.2.2.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1"><exp id="A1.Ex14.m2.3.3.3.3.cmml" xref="A1.Ex14.m2.3.3.3.3"></exp><apply id="A1.Ex14.m2.5.5.5.5.2.1.1.1.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1"><times id="A1.Ex14.m2.5.5.5.5.2.1.1.1.1.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.1"></times><apply id="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.2"><divide id="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.1.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.2"></divide><cn id="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.2.cmml" type="integer" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.2">1</cn><ci id="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.3.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.2.3">𝛽</ci></apply><apply id="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.1.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.3">superscript</csymbol><ci id="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.2.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.2">𝑟</ci><ci id="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.3.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.3.3">′</ci></apply><interval closure="open" id="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.1.cmml" xref="A1.Ex14.m2.5.5.5.5.2.1.1.1.4.2"><ci id="A1.Ex14.m2.1.1.1.1.cmml" xref="A1.Ex14.m2.1.1.1.1">𝑥</ci><ci id="A1.Ex14.m2.2.2.2.2.cmml" xref="A1.Ex14.m2.2.2.2.2">𝑦</ci></interval></apply></apply></apply></apply></apply><apply id="A1.Ex14.m2.10.10.2.4.cmml" xref="A1.Ex14.m2.10.10.2.4"><csymbol cd="ambiguous" id="A1.Ex14.m2.10.10.2.4.1.cmml" xref="A1.Ex14.m2.10.10.2.4">subscript</csymbol><ci id="A1.Ex14.m2.10.10.2.4.2.cmml" xref="A1.Ex14.m2.10.10.2.4.2">𝜋</ci><ci id="A1.Ex14.m2.10.10.2.4.3a.cmml" xref="A1.Ex14.m2.10.10.2.4.3"><mtext id="A1.Ex14.m2.10.10.2.4.3.cmml" mathsize="70%" xref="A1.Ex14.m2.10.10.2.4.3">ref</mtext></ci></apply><apply id="A1.Ex14.m2.9.9.1.1.1.1.cmml" xref="A1.Ex14.m2.9.9.1.1.1"><csymbol cd="latexml" id="A1.Ex14.m2.9.9.1.1.1.1.1.cmml" xref="A1.Ex14.m2.9.9.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex14.m2.9.9.1.1.1.1.2.cmml" xref="A1.Ex14.m2.9.9.1.1.1.1.2">𝑦</ci><ci id="A1.Ex14.m2.9.9.1.1.1.1.3.cmml" xref="A1.Ex14.m2.9.9.1.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex14.m2.10.10.2.2.2.cmml" xref="A1.Ex14.m2.10.10.2.2.1"><exp id="A1.Ex14.m2.8.8.cmml" xref="A1.Ex14.m2.8.8"></exp><apply id="A1.Ex14.m2.10.10.2.2.1.1.1.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1"><times id="A1.Ex14.m2.10.10.2.2.1.1.1.1.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1.1"></times><apply id="A1.Ex14.m2.10.10.2.2.1.1.1.2.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1.2"><divide id="A1.Ex14.m2.10.10.2.2.1.1.1.2.1.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1.2"></divide><cn id="A1.Ex14.m2.10.10.2.2.1.1.1.2.2.cmml" type="integer" xref="A1.Ex14.m2.10.10.2.2.1.1.1.2.2">1</cn><ci id="A1.Ex14.m2.10.10.2.2.1.1.1.2.3.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1.2.3">𝛽</ci></apply><apply id="A1.Ex14.m2.10.10.2.2.1.1.1.3.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex14.m2.10.10.2.2.1.1.1.3.1.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1.3">superscript</csymbol><ci id="A1.Ex14.m2.10.10.2.2.1.1.1.3.2.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1.3.2">𝑟</ci><ci id="A1.Ex14.m2.10.10.2.2.1.1.1.3.3.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1.3.3">′</ci></apply><interval closure="open" id="A1.Ex14.m2.10.10.2.2.1.1.1.4.1.cmml" xref="A1.Ex14.m2.10.10.2.2.1.1.1.4.2"><ci id="A1.Ex14.m2.6.6.cmml" xref="A1.Ex14.m2.6.6">𝑥</ci><ci id="A1.Ex14.m2.7.7.cmml" xref="A1.Ex14.m2.7.7">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex14.m2.10c">\displaystyle=\frac{1}{\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r%
^{\prime}(x,y)\right)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r^{\prime}%
(x,y)\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex14.m2.10d">= divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) ) end_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}(%
r(x,y)+f(x))\right)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}(r(x,y)+f(x)%
)\right)" class="ltx_Math" display="inline" id="A1.Ex15.m1.12"><semantics id="A1.Ex15.m1.12a"><mrow id="A1.Ex15.m1.12.12" xref="A1.Ex15.m1.12.12.cmml"><mi id="A1.Ex15.m1.12.12.4" xref="A1.Ex15.m1.12.12.4.cmml"></mi><mo id="A1.Ex15.m1.12.12.3" xref="A1.Ex15.m1.12.12.3.cmml">=</mo><mrow id="A1.Ex15.m1.12.12.2" xref="A1.Ex15.m1.12.12.2.cmml"><mstyle displaystyle="true" id="A1.Ex15.m1.6.6" xref="A1.Ex15.m1.6.6.cmml"><mfrac id="A1.Ex15.m1.6.6a" xref="A1.Ex15.m1.6.6.cmml"><mn id="A1.Ex15.m1.6.6.8" xref="A1.Ex15.m1.6.6.8.cmml">1</mn><mrow id="A1.Ex15.m1.6.6.6" xref="A1.Ex15.m1.6.6.6.cmml"><msub id="A1.Ex15.m1.6.6.6.7" xref="A1.Ex15.m1.6.6.6.7.cmml"><mo id="A1.Ex15.m1.6.6.6.7.2" xref="A1.Ex15.m1.6.6.6.7.2.cmml">∑</mo><mi id="A1.Ex15.m1.6.6.6.7.3" xref="A1.Ex15.m1.6.6.6.7.3.cmml">y</mi></msub><mrow id="A1.Ex15.m1.6.6.6.6" xref="A1.Ex15.m1.6.6.6.6.cmml"><msub id="A1.Ex15.m1.6.6.6.6.4" xref="A1.Ex15.m1.6.6.6.6.4.cmml"><mi id="A1.Ex15.m1.6.6.6.6.4.2" xref="A1.Ex15.m1.6.6.6.6.4.2.cmml">π</mi><mtext id="A1.Ex15.m1.6.6.6.6.4.3" xref="A1.Ex15.m1.6.6.6.6.4.3a.cmml">ref</mtext></msub><mo id="A1.Ex15.m1.6.6.6.6.3" xref="A1.Ex15.m1.6.6.6.6.3.cmml">⁢</mo><mrow id="A1.Ex15.m1.5.5.5.5.1.1" xref="A1.Ex15.m1.5.5.5.5.1.1.1.cmml"><mo id="A1.Ex15.m1.5.5.5.5.1.1.2" stretchy="false" xref="A1.Ex15.m1.5.5.5.5.1.1.1.cmml">(</mo><mrow id="A1.Ex15.m1.5.5.5.5.1.1.1" xref="A1.Ex15.m1.5.5.5.5.1.1.1.cmml"><mi id="A1.Ex15.m1.5.5.5.5.1.1.1.2" xref="A1.Ex15.m1.5.5.5.5.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex15.m1.5.5.5.5.1.1.1.1" xref="A1.Ex15.m1.5.5.5.5.1.1.1.1.cmml">|</mo><mi id="A1.Ex15.m1.5.5.5.5.1.1.1.3" xref="A1.Ex15.m1.5.5.5.5.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex15.m1.5.5.5.5.1.1.3" stretchy="false" xref="A1.Ex15.m1.5.5.5.5.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex15.m1.6.6.6.6.3a" lspace="0.167em" xref="A1.Ex15.m1.6.6.6.6.3.cmml">⁢</mo><mrow id="A1.Ex15.m1.6.6.6.6.2.1" xref="A1.Ex15.m1.6.6.6.6.2.2.cmml"><mi id="A1.Ex15.m1.4.4.4.4" xref="A1.Ex15.m1.4.4.4.4.cmml">exp</mi><mo id="A1.Ex15.m1.6.6.6.6.2.1a" xref="A1.Ex15.m1.6.6.6.6.2.2.cmml">⁡</mo><mrow id="A1.Ex15.m1.6.6.6.6.2.1.1" xref="A1.Ex15.m1.6.6.6.6.2.2.cmml"><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.2" xref="A1.Ex15.m1.6.6.6.6.2.2.cmml">(</mo><mrow id="A1.Ex15.m1.6.6.6.6.2.1.1.1" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.cmml"><mfrac id="A1.Ex15.m1.6.6.6.6.2.1.1.1.3" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.cmml"><mn id="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.2" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.2.cmml">1</mn><mi id="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.3" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.3.cmml">β</mi></mfrac><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.2" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.cmml"><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.cmml"><mrow id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.2" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.2.cmml">r</mi><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.1" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.2" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.1.cmml"><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="A1.Ex15.m1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.cmml">x</mi><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.2.2" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="A1.Ex15.m1.2.2.2.2" xref="A1.Ex15.m1.2.2.2.2.cmml">y</mi><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.1" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.2" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.2.cmml">f</mi><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.1" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.3.2" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.cmml"><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.Ex15.m1.3.3.3.3" xref="A1.Ex15.m1.3.3.3.3.cmml">x</mi><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex15.m1.6.6.6.6.2.1.1.3" xref="A1.Ex15.m1.6.6.6.6.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mstyle><mo id="A1.Ex15.m1.12.12.2.3" xref="A1.Ex15.m1.12.12.2.3.cmml">⁢</mo><msub id="A1.Ex15.m1.12.12.2.4" xref="A1.Ex15.m1.12.12.2.4.cmml"><mi id="A1.Ex15.m1.12.12.2.4.2" xref="A1.Ex15.m1.12.12.2.4.2.cmml">π</mi><mtext id="A1.Ex15.m1.12.12.2.4.3" xref="A1.Ex15.m1.12.12.2.4.3a.cmml">ref</mtext></msub><mo id="A1.Ex15.m1.12.12.2.3a" xref="A1.Ex15.m1.12.12.2.3.cmml">⁢</mo><mrow id="A1.Ex15.m1.11.11.1.1.1" xref="A1.Ex15.m1.11.11.1.1.1.1.cmml"><mo id="A1.Ex15.m1.11.11.1.1.1.2" stretchy="false" xref="A1.Ex15.m1.11.11.1.1.1.1.cmml">(</mo><mrow id="A1.Ex15.m1.11.11.1.1.1.1" xref="A1.Ex15.m1.11.11.1.1.1.1.cmml"><mi id="A1.Ex15.m1.11.11.1.1.1.1.2" xref="A1.Ex15.m1.11.11.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex15.m1.11.11.1.1.1.1.1" xref="A1.Ex15.m1.11.11.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex15.m1.11.11.1.1.1.1.3" xref="A1.Ex15.m1.11.11.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex15.m1.11.11.1.1.1.3" stretchy="false" xref="A1.Ex15.m1.11.11.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex15.m1.12.12.2.3b" lspace="0.167em" xref="A1.Ex15.m1.12.12.2.3.cmml">⁢</mo><mrow id="A1.Ex15.m1.12.12.2.2.1" xref="A1.Ex15.m1.12.12.2.2.2.cmml"><mi id="A1.Ex15.m1.10.10" xref="A1.Ex15.m1.10.10.cmml">exp</mi><mo id="A1.Ex15.m1.12.12.2.2.1a" xref="A1.Ex15.m1.12.12.2.2.2.cmml">⁡</mo><mrow id="A1.Ex15.m1.12.12.2.2.1.1" xref="A1.Ex15.m1.12.12.2.2.2.cmml"><mo id="A1.Ex15.m1.12.12.2.2.1.1.2" xref="A1.Ex15.m1.12.12.2.2.2.cmml">(</mo><mrow id="A1.Ex15.m1.12.12.2.2.1.1.1" xref="A1.Ex15.m1.12.12.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A1.Ex15.m1.12.12.2.2.1.1.1.3" xref="A1.Ex15.m1.12.12.2.2.1.1.1.3.cmml"><mfrac id="A1.Ex15.m1.12.12.2.2.1.1.1.3a" xref="A1.Ex15.m1.12.12.2.2.1.1.1.3.cmml"><mn id="A1.Ex15.m1.12.12.2.2.1.1.1.3.2" xref="A1.Ex15.m1.12.12.2.2.1.1.1.3.2.cmml">1</mn><mi id="A1.Ex15.m1.12.12.2.2.1.1.1.3.3" xref="A1.Ex15.m1.12.12.2.2.1.1.1.3.3.cmml">β</mi></mfrac></mstyle><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.2" xref="A1.Ex15.m1.12.12.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.cmml"><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.cmml"><mrow id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.2" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.2.cmml">r</mi><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.1" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.2" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.1.cmml"><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="A1.Ex15.m1.7.7" xref="A1.Ex15.m1.7.7.cmml">x</mi><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.2.2" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="A1.Ex15.m1.8.8" xref="A1.Ex15.m1.8.8.cmml">y</mi><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.1" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.2" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.2.cmml">f</mi><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.1" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.3.2" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.cmml"><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.Ex15.m1.9.9" xref="A1.Ex15.m1.9.9.cmml">x</mi><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex15.m1.12.12.2.2.1.1.3" xref="A1.Ex15.m1.12.12.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex15.m1.12b"><apply id="A1.Ex15.m1.12.12.cmml" xref="A1.Ex15.m1.12.12"><eq id="A1.Ex15.m1.12.12.3.cmml" xref="A1.Ex15.m1.12.12.3"></eq><csymbol cd="latexml" id="A1.Ex15.m1.12.12.4.cmml" xref="A1.Ex15.m1.12.12.4">absent</csymbol><apply id="A1.Ex15.m1.12.12.2.cmml" xref="A1.Ex15.m1.12.12.2"><times id="A1.Ex15.m1.12.12.2.3.cmml" xref="A1.Ex15.m1.12.12.2.3"></times><apply id="A1.Ex15.m1.6.6.cmml" xref="A1.Ex15.m1.6.6"><divide id="A1.Ex15.m1.6.6.7.cmml" xref="A1.Ex15.m1.6.6"></divide><cn id="A1.Ex15.m1.6.6.8.cmml" type="integer" xref="A1.Ex15.m1.6.6.8">1</cn><apply id="A1.Ex15.m1.6.6.6.cmml" xref="A1.Ex15.m1.6.6.6"><apply id="A1.Ex15.m1.6.6.6.7.cmml" xref="A1.Ex15.m1.6.6.6.7"><csymbol cd="ambiguous" id="A1.Ex15.m1.6.6.6.7.1.cmml" xref="A1.Ex15.m1.6.6.6.7">subscript</csymbol><sum id="A1.Ex15.m1.6.6.6.7.2.cmml" xref="A1.Ex15.m1.6.6.6.7.2"></sum><ci id="A1.Ex15.m1.6.6.6.7.3.cmml" xref="A1.Ex15.m1.6.6.6.7.3">𝑦</ci></apply><apply id="A1.Ex15.m1.6.6.6.6.cmml" xref="A1.Ex15.m1.6.6.6.6"><times id="A1.Ex15.m1.6.6.6.6.3.cmml" xref="A1.Ex15.m1.6.6.6.6.3"></times><apply id="A1.Ex15.m1.6.6.6.6.4.cmml" xref="A1.Ex15.m1.6.6.6.6.4"><csymbol cd="ambiguous" id="A1.Ex15.m1.6.6.6.6.4.1.cmml" xref="A1.Ex15.m1.6.6.6.6.4">subscript</csymbol><ci id="A1.Ex15.m1.6.6.6.6.4.2.cmml" xref="A1.Ex15.m1.6.6.6.6.4.2">𝜋</ci><ci id="A1.Ex15.m1.6.6.6.6.4.3a.cmml" xref="A1.Ex15.m1.6.6.6.6.4.3"><mtext id="A1.Ex15.m1.6.6.6.6.4.3.cmml" mathsize="70%" xref="A1.Ex15.m1.6.6.6.6.4.3">ref</mtext></ci></apply><apply id="A1.Ex15.m1.5.5.5.5.1.1.1.cmml" xref="A1.Ex15.m1.5.5.5.5.1.1"><csymbol cd="latexml" id="A1.Ex15.m1.5.5.5.5.1.1.1.1.cmml" xref="A1.Ex15.m1.5.5.5.5.1.1.1.1">conditional</csymbol><ci id="A1.Ex15.m1.5.5.5.5.1.1.1.2.cmml" xref="A1.Ex15.m1.5.5.5.5.1.1.1.2">𝑦</ci><ci id="A1.Ex15.m1.5.5.5.5.1.1.1.3.cmml" xref="A1.Ex15.m1.5.5.5.5.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex15.m1.6.6.6.6.2.2.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1"><exp id="A1.Ex15.m1.4.4.4.4.cmml" xref="A1.Ex15.m1.4.4.4.4"></exp><apply id="A1.Ex15.m1.6.6.6.6.2.1.1.1.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1"><times id="A1.Ex15.m1.6.6.6.6.2.1.1.1.2.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.2"></times><apply id="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.3"><divide id="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.1.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.3"></divide><cn id="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.2.cmml" type="integer" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.2">1</cn><ci id="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.3.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.3.3">𝛽</ci></apply><apply id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1"><plus id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.1"></plus><apply id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2"><times id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.1"></times><ci id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.2">𝑟</ci><interval closure="open" id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.2.3.2"><ci id="A1.Ex15.m1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1">𝑥</ci><ci id="A1.Ex15.m1.2.2.2.2.cmml" xref="A1.Ex15.m1.2.2.2.2">𝑦</ci></interval></apply><apply id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3"><times id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.1"></times><ci id="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex15.m1.6.6.6.6.2.1.1.1.1.1.1.3.2">𝑓</ci><ci id="A1.Ex15.m1.3.3.3.3.cmml" xref="A1.Ex15.m1.3.3.3.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply><apply id="A1.Ex15.m1.12.12.2.4.cmml" xref="A1.Ex15.m1.12.12.2.4"><csymbol cd="ambiguous" id="A1.Ex15.m1.12.12.2.4.1.cmml" xref="A1.Ex15.m1.12.12.2.4">subscript</csymbol><ci id="A1.Ex15.m1.12.12.2.4.2.cmml" xref="A1.Ex15.m1.12.12.2.4.2">𝜋</ci><ci id="A1.Ex15.m1.12.12.2.4.3a.cmml" xref="A1.Ex15.m1.12.12.2.4.3"><mtext id="A1.Ex15.m1.12.12.2.4.3.cmml" mathsize="70%" xref="A1.Ex15.m1.12.12.2.4.3">ref</mtext></ci></apply><apply id="A1.Ex15.m1.11.11.1.1.1.1.cmml" xref="A1.Ex15.m1.11.11.1.1.1"><csymbol cd="latexml" id="A1.Ex15.m1.11.11.1.1.1.1.1.cmml" xref="A1.Ex15.m1.11.11.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex15.m1.11.11.1.1.1.1.2.cmml" xref="A1.Ex15.m1.11.11.1.1.1.1.2">𝑦</ci><ci id="A1.Ex15.m1.11.11.1.1.1.1.3.cmml" xref="A1.Ex15.m1.11.11.1.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex15.m1.12.12.2.2.2.cmml" xref="A1.Ex15.m1.12.12.2.2.1"><exp id="A1.Ex15.m1.10.10.cmml" xref="A1.Ex15.m1.10.10"></exp><apply id="A1.Ex15.m1.12.12.2.2.1.1.1.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1"><times id="A1.Ex15.m1.12.12.2.2.1.1.1.2.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.2"></times><apply id="A1.Ex15.m1.12.12.2.2.1.1.1.3.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.3"><divide id="A1.Ex15.m1.12.12.2.2.1.1.1.3.1.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.3"></divide><cn id="A1.Ex15.m1.12.12.2.2.1.1.1.3.2.cmml" type="integer" xref="A1.Ex15.m1.12.12.2.2.1.1.1.3.2">1</cn><ci id="A1.Ex15.m1.12.12.2.2.1.1.1.3.3.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.3.3">𝛽</ci></apply><apply id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1"><plus id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.1"></plus><apply id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2"><times id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.1"></times><ci id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.2">𝑟</ci><interval closure="open" id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.2.3.2"><ci id="A1.Ex15.m1.7.7.cmml" xref="A1.Ex15.m1.7.7">𝑥</ci><ci id="A1.Ex15.m1.8.8.cmml" xref="A1.Ex15.m1.8.8">𝑦</ci></interval></apply><apply id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3"><times id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.1"></times><ci id="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex15.m1.12.12.2.2.1.1.1.1.1.1.3.2">𝑓</ci><ci id="A1.Ex15.m1.9.9.cmml" xref="A1.Ex15.m1.9.9">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex15.m1.12c">\displaystyle=\frac{1}{\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}(%
r(x,y)+f(x))\right)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}(r(x,y)+f(x)%
)\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex15.m1.12d">= divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG ( italic_r ( italic_x , italic_y ) + italic_f ( italic_x ) ) ) end_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG ( italic_r ( italic_x , italic_y ) + italic_f ( italic_x ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{\exp\left(\frac{1}{\beta}f(x)\right)\sum_{y}\pi_{\text{%
ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y)\right)}\pi_{\text{ref}}(y|x)\exp%
\left(\frac{1}{\beta}r(x,y)\right)\exp\left(\frac{1}{\beta}f(x)\right)" class="ltx_Math" display="inline" id="A1.Ex16.m1.16"><semantics id="A1.Ex16.m1.16a"><mrow id="A1.Ex16.m1.16.16" xref="A1.Ex16.m1.16.16.cmml"><mi id="A1.Ex16.m1.16.16.5" xref="A1.Ex16.m1.16.16.5.cmml"></mi><mo id="A1.Ex16.m1.16.16.4" xref="A1.Ex16.m1.16.16.4.cmml">=</mo><mrow id="A1.Ex16.m1.16.16.3" xref="A1.Ex16.m1.16.16.3.cmml"><mstyle displaystyle="true" id="A1.Ex16.m1.8.8" xref="A1.Ex16.m1.8.8.cmml"><mfrac id="A1.Ex16.m1.8.8a" xref="A1.Ex16.m1.8.8.cmml"><mn id="A1.Ex16.m1.8.8.10" xref="A1.Ex16.m1.8.8.10.cmml">1</mn><mrow id="A1.Ex16.m1.8.8.8" xref="A1.Ex16.m1.8.8.8.cmml"><mrow id="A1.Ex16.m1.6.6.6.6.1" xref="A1.Ex16.m1.6.6.6.6.2.cmml"><mi id="A1.Ex16.m1.2.2.2.2" xref="A1.Ex16.m1.2.2.2.2.cmml">exp</mi><mo id="A1.Ex16.m1.6.6.6.6.1a" xref="A1.Ex16.m1.6.6.6.6.2.cmml">⁡</mo><mrow id="A1.Ex16.m1.6.6.6.6.1.1" xref="A1.Ex16.m1.6.6.6.6.2.cmml"><mo id="A1.Ex16.m1.6.6.6.6.1.1.2" xref="A1.Ex16.m1.6.6.6.6.2.cmml">(</mo><mrow id="A1.Ex16.m1.6.6.6.6.1.1.1" xref="A1.Ex16.m1.6.6.6.6.1.1.1.cmml"><mfrac id="A1.Ex16.m1.6.6.6.6.1.1.1.2" xref="A1.Ex16.m1.6.6.6.6.1.1.1.2.cmml"><mn id="A1.Ex16.m1.6.6.6.6.1.1.1.2.2" xref="A1.Ex16.m1.6.6.6.6.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex16.m1.6.6.6.6.1.1.1.2.3" xref="A1.Ex16.m1.6.6.6.6.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.Ex16.m1.6.6.6.6.1.1.1.1" xref="A1.Ex16.m1.6.6.6.6.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex16.m1.6.6.6.6.1.1.1.3" xref="A1.Ex16.m1.6.6.6.6.1.1.1.3.cmml">f</mi><mo id="A1.Ex16.m1.6.6.6.6.1.1.1.1a" xref="A1.Ex16.m1.6.6.6.6.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex16.m1.6.6.6.6.1.1.1.4.2" xref="A1.Ex16.m1.6.6.6.6.1.1.1.cmml"><mo id="A1.Ex16.m1.6.6.6.6.1.1.1.4.2.1" stretchy="false" xref="A1.Ex16.m1.6.6.6.6.1.1.1.cmml">(</mo><mi id="A1.Ex16.m1.1.1.1.1" xref="A1.Ex16.m1.1.1.1.1.cmml">x</mi><mo id="A1.Ex16.m1.6.6.6.6.1.1.1.4.2.2" stretchy="false" xref="A1.Ex16.m1.6.6.6.6.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex16.m1.6.6.6.6.1.1.3" xref="A1.Ex16.m1.6.6.6.6.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex16.m1.8.8.8.9" xref="A1.Ex16.m1.8.8.8.9.cmml">⁢</mo><mrow id="A1.Ex16.m1.8.8.8.8" xref="A1.Ex16.m1.8.8.8.8.cmml"><msub id="A1.Ex16.m1.8.8.8.8.3" xref="A1.Ex16.m1.8.8.8.8.3.cmml"><mo id="A1.Ex16.m1.8.8.8.8.3.2" xref="A1.Ex16.m1.8.8.8.8.3.2.cmml">∑</mo><mi id="A1.Ex16.m1.8.8.8.8.3.3" xref="A1.Ex16.m1.8.8.8.8.3.3.cmml">y</mi></msub><mrow id="A1.Ex16.m1.8.8.8.8.2" xref="A1.Ex16.m1.8.8.8.8.2.cmml"><msub id="A1.Ex16.m1.8.8.8.8.2.4" xref="A1.Ex16.m1.8.8.8.8.2.4.cmml"><mi id="A1.Ex16.m1.8.8.8.8.2.4.2" xref="A1.Ex16.m1.8.8.8.8.2.4.2.cmml">π</mi><mtext id="A1.Ex16.m1.8.8.8.8.2.4.3" xref="A1.Ex16.m1.8.8.8.8.2.4.3a.cmml">ref</mtext></msub><mo id="A1.Ex16.m1.8.8.8.8.2.3" xref="A1.Ex16.m1.8.8.8.8.2.3.cmml">⁢</mo><mrow id="A1.Ex16.m1.7.7.7.7.1.1.1" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.cmml"><mo id="A1.Ex16.m1.7.7.7.7.1.1.1.2" stretchy="false" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.cmml">(</mo><mrow id="A1.Ex16.m1.7.7.7.7.1.1.1.1" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.cmml"><mi id="A1.Ex16.m1.7.7.7.7.1.1.1.1.2" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex16.m1.7.7.7.7.1.1.1.1.1" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex16.m1.7.7.7.7.1.1.1.1.3" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex16.m1.7.7.7.7.1.1.1.3" stretchy="false" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex16.m1.8.8.8.8.2.3a" lspace="0.167em" xref="A1.Ex16.m1.8.8.8.8.2.3.cmml">⁢</mo><mrow id="A1.Ex16.m1.8.8.8.8.2.2.1" xref="A1.Ex16.m1.8.8.8.8.2.2.2.cmml"><mi id="A1.Ex16.m1.5.5.5.5" xref="A1.Ex16.m1.5.5.5.5.cmml">exp</mi><mo id="A1.Ex16.m1.8.8.8.8.2.2.1a" xref="A1.Ex16.m1.8.8.8.8.2.2.2.cmml">⁡</mo><mrow id="A1.Ex16.m1.8.8.8.8.2.2.1.1" xref="A1.Ex16.m1.8.8.8.8.2.2.2.cmml"><mo id="A1.Ex16.m1.8.8.8.8.2.2.1.1.2" xref="A1.Ex16.m1.8.8.8.8.2.2.2.cmml">(</mo><mrow id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.cmml"><mfrac id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.cmml"><mn id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.2" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.3" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.1" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.3" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.3.cmml">r</mi><mo id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.1a" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.2" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.1.cmml"><mo id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.2.1" stretchy="false" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.1.cmml">(</mo><mi id="A1.Ex16.m1.3.3.3.3" xref="A1.Ex16.m1.3.3.3.3.cmml">x</mi><mo id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.2.2" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.1.cmml">,</mo><mi id="A1.Ex16.m1.4.4.4.4" xref="A1.Ex16.m1.4.4.4.4.cmml">y</mi><mo id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.2.3" stretchy="false" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex16.m1.8.8.8.8.2.2.1.1.3" xref="A1.Ex16.m1.8.8.8.8.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mfrac></mstyle><mo id="A1.Ex16.m1.16.16.3.4" xref="A1.Ex16.m1.16.16.3.4.cmml">⁢</mo><msub id="A1.Ex16.m1.16.16.3.5" xref="A1.Ex16.m1.16.16.3.5.cmml"><mi id="A1.Ex16.m1.16.16.3.5.2" xref="A1.Ex16.m1.16.16.3.5.2.cmml">π</mi><mtext id="A1.Ex16.m1.16.16.3.5.3" xref="A1.Ex16.m1.16.16.3.5.3a.cmml">ref</mtext></msub><mo id="A1.Ex16.m1.16.16.3.4a" xref="A1.Ex16.m1.16.16.3.4.cmml">⁢</mo><mrow id="A1.Ex16.m1.14.14.1.1.1" xref="A1.Ex16.m1.14.14.1.1.1.1.cmml"><mo id="A1.Ex16.m1.14.14.1.1.1.2" stretchy="false" xref="A1.Ex16.m1.14.14.1.1.1.1.cmml">(</mo><mrow id="A1.Ex16.m1.14.14.1.1.1.1" xref="A1.Ex16.m1.14.14.1.1.1.1.cmml"><mi id="A1.Ex16.m1.14.14.1.1.1.1.2" xref="A1.Ex16.m1.14.14.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex16.m1.14.14.1.1.1.1.1" xref="A1.Ex16.m1.14.14.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex16.m1.14.14.1.1.1.1.3" xref="A1.Ex16.m1.14.14.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex16.m1.14.14.1.1.1.3" stretchy="false" xref="A1.Ex16.m1.14.14.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex16.m1.16.16.3.4b" lspace="0.167em" xref="A1.Ex16.m1.16.16.3.4.cmml">⁢</mo><mrow id="A1.Ex16.m1.15.15.2.2.1" xref="A1.Ex16.m1.15.15.2.2.2.cmml"><mi id="A1.Ex16.m1.11.11" xref="A1.Ex16.m1.11.11.cmml">exp</mi><mo id="A1.Ex16.m1.15.15.2.2.1a" xref="A1.Ex16.m1.15.15.2.2.2.cmml">⁡</mo><mrow id="A1.Ex16.m1.15.15.2.2.1.1" xref="A1.Ex16.m1.15.15.2.2.2.cmml"><mo id="A1.Ex16.m1.15.15.2.2.1.1.2" xref="A1.Ex16.m1.15.15.2.2.2.cmml">(</mo><mrow id="A1.Ex16.m1.15.15.2.2.1.1.1" xref="A1.Ex16.m1.15.15.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A1.Ex16.m1.15.15.2.2.1.1.1.2" xref="A1.Ex16.m1.15.15.2.2.1.1.1.2.cmml"><mfrac id="A1.Ex16.m1.15.15.2.2.1.1.1.2a" xref="A1.Ex16.m1.15.15.2.2.1.1.1.2.cmml"><mn id="A1.Ex16.m1.15.15.2.2.1.1.1.2.2" xref="A1.Ex16.m1.15.15.2.2.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex16.m1.15.15.2.2.1.1.1.2.3" xref="A1.Ex16.m1.15.15.2.2.1.1.1.2.3.cmml">β</mi></mfrac></mstyle><mo id="A1.Ex16.m1.15.15.2.2.1.1.1.1" xref="A1.Ex16.m1.15.15.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex16.m1.15.15.2.2.1.1.1.3" xref="A1.Ex16.m1.15.15.2.2.1.1.1.3.cmml">r</mi><mo id="A1.Ex16.m1.15.15.2.2.1.1.1.1a" xref="A1.Ex16.m1.15.15.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex16.m1.15.15.2.2.1.1.1.4.2" xref="A1.Ex16.m1.15.15.2.2.1.1.1.4.1.cmml"><mo id="A1.Ex16.m1.15.15.2.2.1.1.1.4.2.1" stretchy="false" xref="A1.Ex16.m1.15.15.2.2.1.1.1.4.1.cmml">(</mo><mi id="A1.Ex16.m1.9.9" xref="A1.Ex16.m1.9.9.cmml">x</mi><mo id="A1.Ex16.m1.15.15.2.2.1.1.1.4.2.2" xref="A1.Ex16.m1.15.15.2.2.1.1.1.4.1.cmml">,</mo><mi id="A1.Ex16.m1.10.10" xref="A1.Ex16.m1.10.10.cmml">y</mi><mo id="A1.Ex16.m1.15.15.2.2.1.1.1.4.2.3" stretchy="false" xref="A1.Ex16.m1.15.15.2.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex16.m1.15.15.2.2.1.1.3" xref="A1.Ex16.m1.15.15.2.2.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex16.m1.16.16.3.4c" lspace="0.167em" xref="A1.Ex16.m1.16.16.3.4.cmml">⁢</mo><mrow id="A1.Ex16.m1.16.16.3.3.1" xref="A1.Ex16.m1.16.16.3.3.2.cmml"><mi id="A1.Ex16.m1.13.13" xref="A1.Ex16.m1.13.13.cmml">exp</mi><mo id="A1.Ex16.m1.16.16.3.3.1a" xref="A1.Ex16.m1.16.16.3.3.2.cmml">⁡</mo><mrow id="A1.Ex16.m1.16.16.3.3.1.1" xref="A1.Ex16.m1.16.16.3.3.2.cmml"><mo id="A1.Ex16.m1.16.16.3.3.1.1.2" xref="A1.Ex16.m1.16.16.3.3.2.cmml">(</mo><mrow id="A1.Ex16.m1.16.16.3.3.1.1.1" xref="A1.Ex16.m1.16.16.3.3.1.1.1.cmml"><mstyle displaystyle="true" id="A1.Ex16.m1.16.16.3.3.1.1.1.2" xref="A1.Ex16.m1.16.16.3.3.1.1.1.2.cmml"><mfrac id="A1.Ex16.m1.16.16.3.3.1.1.1.2a" xref="A1.Ex16.m1.16.16.3.3.1.1.1.2.cmml"><mn id="A1.Ex16.m1.16.16.3.3.1.1.1.2.2" xref="A1.Ex16.m1.16.16.3.3.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex16.m1.16.16.3.3.1.1.1.2.3" xref="A1.Ex16.m1.16.16.3.3.1.1.1.2.3.cmml">β</mi></mfrac></mstyle><mo id="A1.Ex16.m1.16.16.3.3.1.1.1.1" xref="A1.Ex16.m1.16.16.3.3.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex16.m1.16.16.3.3.1.1.1.3" xref="A1.Ex16.m1.16.16.3.3.1.1.1.3.cmml">f</mi><mo id="A1.Ex16.m1.16.16.3.3.1.1.1.1a" xref="A1.Ex16.m1.16.16.3.3.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex16.m1.16.16.3.3.1.1.1.4.2" xref="A1.Ex16.m1.16.16.3.3.1.1.1.cmml"><mo id="A1.Ex16.m1.16.16.3.3.1.1.1.4.2.1" stretchy="false" xref="A1.Ex16.m1.16.16.3.3.1.1.1.cmml">(</mo><mi id="A1.Ex16.m1.12.12" xref="A1.Ex16.m1.12.12.cmml">x</mi><mo id="A1.Ex16.m1.16.16.3.3.1.1.1.4.2.2" stretchy="false" xref="A1.Ex16.m1.16.16.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex16.m1.16.16.3.3.1.1.3" xref="A1.Ex16.m1.16.16.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex16.m1.16b"><apply id="A1.Ex16.m1.16.16.cmml" xref="A1.Ex16.m1.16.16"><eq id="A1.Ex16.m1.16.16.4.cmml" xref="A1.Ex16.m1.16.16.4"></eq><csymbol cd="latexml" id="A1.Ex16.m1.16.16.5.cmml" xref="A1.Ex16.m1.16.16.5">absent</csymbol><apply id="A1.Ex16.m1.16.16.3.cmml" xref="A1.Ex16.m1.16.16.3"><times id="A1.Ex16.m1.16.16.3.4.cmml" xref="A1.Ex16.m1.16.16.3.4"></times><apply id="A1.Ex16.m1.8.8.cmml" xref="A1.Ex16.m1.8.8"><divide id="A1.Ex16.m1.8.8.9.cmml" xref="A1.Ex16.m1.8.8"></divide><cn id="A1.Ex16.m1.8.8.10.cmml" type="integer" xref="A1.Ex16.m1.8.8.10">1</cn><apply id="A1.Ex16.m1.8.8.8.cmml" xref="A1.Ex16.m1.8.8.8"><times id="A1.Ex16.m1.8.8.8.9.cmml" xref="A1.Ex16.m1.8.8.8.9"></times><apply id="A1.Ex16.m1.6.6.6.6.2.cmml" xref="A1.Ex16.m1.6.6.6.6.1"><exp id="A1.Ex16.m1.2.2.2.2.cmml" xref="A1.Ex16.m1.2.2.2.2"></exp><apply id="A1.Ex16.m1.6.6.6.6.1.1.1.cmml" xref="A1.Ex16.m1.6.6.6.6.1.1.1"><times id="A1.Ex16.m1.6.6.6.6.1.1.1.1.cmml" xref="A1.Ex16.m1.6.6.6.6.1.1.1.1"></times><apply id="A1.Ex16.m1.6.6.6.6.1.1.1.2.cmml" xref="A1.Ex16.m1.6.6.6.6.1.1.1.2"><divide id="A1.Ex16.m1.6.6.6.6.1.1.1.2.1.cmml" xref="A1.Ex16.m1.6.6.6.6.1.1.1.2"></divide><cn id="A1.Ex16.m1.6.6.6.6.1.1.1.2.2.cmml" type="integer" xref="A1.Ex16.m1.6.6.6.6.1.1.1.2.2">1</cn><ci id="A1.Ex16.m1.6.6.6.6.1.1.1.2.3.cmml" xref="A1.Ex16.m1.6.6.6.6.1.1.1.2.3">𝛽</ci></apply><ci id="A1.Ex16.m1.6.6.6.6.1.1.1.3.cmml" xref="A1.Ex16.m1.6.6.6.6.1.1.1.3">𝑓</ci><ci id="A1.Ex16.m1.1.1.1.1.cmml" xref="A1.Ex16.m1.1.1.1.1">𝑥</ci></apply></apply><apply id="A1.Ex16.m1.8.8.8.8.cmml" xref="A1.Ex16.m1.8.8.8.8"><apply id="A1.Ex16.m1.8.8.8.8.3.cmml" xref="A1.Ex16.m1.8.8.8.8.3"><csymbol cd="ambiguous" id="A1.Ex16.m1.8.8.8.8.3.1.cmml" xref="A1.Ex16.m1.8.8.8.8.3">subscript</csymbol><sum id="A1.Ex16.m1.8.8.8.8.3.2.cmml" xref="A1.Ex16.m1.8.8.8.8.3.2"></sum><ci id="A1.Ex16.m1.8.8.8.8.3.3.cmml" xref="A1.Ex16.m1.8.8.8.8.3.3">𝑦</ci></apply><apply id="A1.Ex16.m1.8.8.8.8.2.cmml" xref="A1.Ex16.m1.8.8.8.8.2"><times id="A1.Ex16.m1.8.8.8.8.2.3.cmml" xref="A1.Ex16.m1.8.8.8.8.2.3"></times><apply id="A1.Ex16.m1.8.8.8.8.2.4.cmml" xref="A1.Ex16.m1.8.8.8.8.2.4"><csymbol cd="ambiguous" id="A1.Ex16.m1.8.8.8.8.2.4.1.cmml" xref="A1.Ex16.m1.8.8.8.8.2.4">subscript</csymbol><ci id="A1.Ex16.m1.8.8.8.8.2.4.2.cmml" xref="A1.Ex16.m1.8.8.8.8.2.4.2">𝜋</ci><ci id="A1.Ex16.m1.8.8.8.8.2.4.3a.cmml" xref="A1.Ex16.m1.8.8.8.8.2.4.3"><mtext id="A1.Ex16.m1.8.8.8.8.2.4.3.cmml" mathsize="70%" xref="A1.Ex16.m1.8.8.8.8.2.4.3">ref</mtext></ci></apply><apply id="A1.Ex16.m1.7.7.7.7.1.1.1.1.cmml" xref="A1.Ex16.m1.7.7.7.7.1.1.1"><csymbol cd="latexml" id="A1.Ex16.m1.7.7.7.7.1.1.1.1.1.cmml" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex16.m1.7.7.7.7.1.1.1.1.2.cmml" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.2">𝑦</ci><ci id="A1.Ex16.m1.7.7.7.7.1.1.1.1.3.cmml" xref="A1.Ex16.m1.7.7.7.7.1.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex16.m1.8.8.8.8.2.2.2.cmml" xref="A1.Ex16.m1.8.8.8.8.2.2.1"><exp id="A1.Ex16.m1.5.5.5.5.cmml" xref="A1.Ex16.m1.5.5.5.5"></exp><apply id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.cmml" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1"><times id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.1.cmml" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.1"></times><apply id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.cmml" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2"><divide id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.1.cmml" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2"></divide><cn id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.2.cmml" type="integer" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.2">1</cn><ci id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.3.cmml" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.2.3">𝛽</ci></apply><ci id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.3.cmml" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.1.cmml" xref="A1.Ex16.m1.8.8.8.8.2.2.1.1.1.4.2"><ci id="A1.Ex16.m1.3.3.3.3.cmml" xref="A1.Ex16.m1.3.3.3.3">𝑥</ci><ci id="A1.Ex16.m1.4.4.4.4.cmml" xref="A1.Ex16.m1.4.4.4.4">𝑦</ci></interval></apply></apply></apply></apply></apply></apply><apply id="A1.Ex16.m1.16.16.3.5.cmml" xref="A1.Ex16.m1.16.16.3.5"><csymbol cd="ambiguous" id="A1.Ex16.m1.16.16.3.5.1.cmml" xref="A1.Ex16.m1.16.16.3.5">subscript</csymbol><ci id="A1.Ex16.m1.16.16.3.5.2.cmml" xref="A1.Ex16.m1.16.16.3.5.2">𝜋</ci><ci id="A1.Ex16.m1.16.16.3.5.3a.cmml" xref="A1.Ex16.m1.16.16.3.5.3"><mtext id="A1.Ex16.m1.16.16.3.5.3.cmml" mathsize="70%" xref="A1.Ex16.m1.16.16.3.5.3">ref</mtext></ci></apply><apply id="A1.Ex16.m1.14.14.1.1.1.1.cmml" xref="A1.Ex16.m1.14.14.1.1.1"><csymbol cd="latexml" id="A1.Ex16.m1.14.14.1.1.1.1.1.cmml" xref="A1.Ex16.m1.14.14.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex16.m1.14.14.1.1.1.1.2.cmml" xref="A1.Ex16.m1.14.14.1.1.1.1.2">𝑦</ci><ci id="A1.Ex16.m1.14.14.1.1.1.1.3.cmml" xref="A1.Ex16.m1.14.14.1.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex16.m1.15.15.2.2.2.cmml" xref="A1.Ex16.m1.15.15.2.2.1"><exp id="A1.Ex16.m1.11.11.cmml" xref="A1.Ex16.m1.11.11"></exp><apply id="A1.Ex16.m1.15.15.2.2.1.1.1.cmml" xref="A1.Ex16.m1.15.15.2.2.1.1.1"><times id="A1.Ex16.m1.15.15.2.2.1.1.1.1.cmml" xref="A1.Ex16.m1.15.15.2.2.1.1.1.1"></times><apply id="A1.Ex16.m1.15.15.2.2.1.1.1.2.cmml" xref="A1.Ex16.m1.15.15.2.2.1.1.1.2"><divide id="A1.Ex16.m1.15.15.2.2.1.1.1.2.1.cmml" xref="A1.Ex16.m1.15.15.2.2.1.1.1.2"></divide><cn id="A1.Ex16.m1.15.15.2.2.1.1.1.2.2.cmml" type="integer" xref="A1.Ex16.m1.15.15.2.2.1.1.1.2.2">1</cn><ci id="A1.Ex16.m1.15.15.2.2.1.1.1.2.3.cmml" xref="A1.Ex16.m1.15.15.2.2.1.1.1.2.3">𝛽</ci></apply><ci id="A1.Ex16.m1.15.15.2.2.1.1.1.3.cmml" xref="A1.Ex16.m1.15.15.2.2.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex16.m1.15.15.2.2.1.1.1.4.1.cmml" xref="A1.Ex16.m1.15.15.2.2.1.1.1.4.2"><ci id="A1.Ex16.m1.9.9.cmml" xref="A1.Ex16.m1.9.9">𝑥</ci><ci id="A1.Ex16.m1.10.10.cmml" xref="A1.Ex16.m1.10.10">𝑦</ci></interval></apply></apply><apply id="A1.Ex16.m1.16.16.3.3.2.cmml" xref="A1.Ex16.m1.16.16.3.3.1"><exp id="A1.Ex16.m1.13.13.cmml" xref="A1.Ex16.m1.13.13"></exp><apply id="A1.Ex16.m1.16.16.3.3.1.1.1.cmml" xref="A1.Ex16.m1.16.16.3.3.1.1.1"><times id="A1.Ex16.m1.16.16.3.3.1.1.1.1.cmml" xref="A1.Ex16.m1.16.16.3.3.1.1.1.1"></times><apply id="A1.Ex16.m1.16.16.3.3.1.1.1.2.cmml" xref="A1.Ex16.m1.16.16.3.3.1.1.1.2"><divide id="A1.Ex16.m1.16.16.3.3.1.1.1.2.1.cmml" xref="A1.Ex16.m1.16.16.3.3.1.1.1.2"></divide><cn id="A1.Ex16.m1.16.16.3.3.1.1.1.2.2.cmml" type="integer" xref="A1.Ex16.m1.16.16.3.3.1.1.1.2.2">1</cn><ci id="A1.Ex16.m1.16.16.3.3.1.1.1.2.3.cmml" xref="A1.Ex16.m1.16.16.3.3.1.1.1.2.3">𝛽</ci></apply><ci id="A1.Ex16.m1.16.16.3.3.1.1.1.3.cmml" xref="A1.Ex16.m1.16.16.3.3.1.1.1.3">𝑓</ci><ci id="A1.Ex16.m1.12.12.cmml" xref="A1.Ex16.m1.12.12">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex16.m1.16c">\displaystyle=\frac{1}{\exp\left(\frac{1}{\beta}f(x)\right)\sum_{y}\pi_{\text{%
ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y)\right)}\pi_{\text{ref}}(y|x)\exp%
\left(\frac{1}{\beta}r(x,y)\right)\exp\left(\frac{1}{\beta}f(x)\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex16.m1.16d">= divide start_ARG 1 end_ARG start_ARG roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_f ( italic_x ) ) ∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) ) end_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_f ( italic_x ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r%
(x,y)\right)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y)\right)" class="ltx_Math" display="inline" id="A1.Ex17.m1.10"><semantics id="A1.Ex17.m1.10a"><mrow id="A1.Ex17.m1.10.10" xref="A1.Ex17.m1.10.10.cmml"><mi id="A1.Ex17.m1.10.10.4" xref="A1.Ex17.m1.10.10.4.cmml"></mi><mo id="A1.Ex17.m1.10.10.3" xref="A1.Ex17.m1.10.10.3.cmml">=</mo><mrow id="A1.Ex17.m1.10.10.2" xref="A1.Ex17.m1.10.10.2.cmml"><mstyle displaystyle="true" id="A1.Ex17.m1.5.5" xref="A1.Ex17.m1.5.5.cmml"><mfrac id="A1.Ex17.m1.5.5a" xref="A1.Ex17.m1.5.5.cmml"><mn id="A1.Ex17.m1.5.5.7" xref="A1.Ex17.m1.5.5.7.cmml">1</mn><mrow id="A1.Ex17.m1.5.5.5" xref="A1.Ex17.m1.5.5.5.cmml"><msub id="A1.Ex17.m1.5.5.5.6" xref="A1.Ex17.m1.5.5.5.6.cmml"><mo id="A1.Ex17.m1.5.5.5.6.2" xref="A1.Ex17.m1.5.5.5.6.2.cmml">∑</mo><mi id="A1.Ex17.m1.5.5.5.6.3" xref="A1.Ex17.m1.5.5.5.6.3.cmml">y</mi></msub><mrow id="A1.Ex17.m1.5.5.5.5" xref="A1.Ex17.m1.5.5.5.5.cmml"><msub id="A1.Ex17.m1.5.5.5.5.4" xref="A1.Ex17.m1.5.5.5.5.4.cmml"><mi id="A1.Ex17.m1.5.5.5.5.4.2" xref="A1.Ex17.m1.5.5.5.5.4.2.cmml">π</mi><mtext id="A1.Ex17.m1.5.5.5.5.4.3" xref="A1.Ex17.m1.5.5.5.5.4.3a.cmml">ref</mtext></msub><mo id="A1.Ex17.m1.5.5.5.5.3" xref="A1.Ex17.m1.5.5.5.5.3.cmml">⁢</mo><mrow id="A1.Ex17.m1.4.4.4.4.1.1" xref="A1.Ex17.m1.4.4.4.4.1.1.1.cmml"><mo id="A1.Ex17.m1.4.4.4.4.1.1.2" stretchy="false" xref="A1.Ex17.m1.4.4.4.4.1.1.1.cmml">(</mo><mrow id="A1.Ex17.m1.4.4.4.4.1.1.1" xref="A1.Ex17.m1.4.4.4.4.1.1.1.cmml"><mi id="A1.Ex17.m1.4.4.4.4.1.1.1.2" xref="A1.Ex17.m1.4.4.4.4.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex17.m1.4.4.4.4.1.1.1.1" xref="A1.Ex17.m1.4.4.4.4.1.1.1.1.cmml">|</mo><mi id="A1.Ex17.m1.4.4.4.4.1.1.1.3" xref="A1.Ex17.m1.4.4.4.4.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex17.m1.4.4.4.4.1.1.3" stretchy="false" xref="A1.Ex17.m1.4.4.4.4.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex17.m1.5.5.5.5.3a" lspace="0.167em" xref="A1.Ex17.m1.5.5.5.5.3.cmml">⁢</mo><mrow id="A1.Ex17.m1.5.5.5.5.2.1" xref="A1.Ex17.m1.5.5.5.5.2.2.cmml"><mi id="A1.Ex17.m1.3.3.3.3" xref="A1.Ex17.m1.3.3.3.3.cmml">exp</mi><mo id="A1.Ex17.m1.5.5.5.5.2.1a" xref="A1.Ex17.m1.5.5.5.5.2.2.cmml">⁡</mo><mrow id="A1.Ex17.m1.5.5.5.5.2.1.1" xref="A1.Ex17.m1.5.5.5.5.2.2.cmml"><mo id="A1.Ex17.m1.5.5.5.5.2.1.1.2" xref="A1.Ex17.m1.5.5.5.5.2.2.cmml">(</mo><mrow id="A1.Ex17.m1.5.5.5.5.2.1.1.1" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.cmml"><mfrac id="A1.Ex17.m1.5.5.5.5.2.1.1.1.2" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.cmml"><mn id="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.2" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.3" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.Ex17.m1.5.5.5.5.2.1.1.1.1" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex17.m1.5.5.5.5.2.1.1.1.3" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.3.cmml">r</mi><mo id="A1.Ex17.m1.5.5.5.5.2.1.1.1.1a" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.2" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.1.cmml"><mo id="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.2.1" stretchy="false" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.1.cmml">(</mo><mi id="A1.Ex17.m1.1.1.1.1" xref="A1.Ex17.m1.1.1.1.1.cmml">x</mi><mo id="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.2.2" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.1.cmml">,</mo><mi id="A1.Ex17.m1.2.2.2.2" xref="A1.Ex17.m1.2.2.2.2.cmml">y</mi><mo id="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.2.3" stretchy="false" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex17.m1.5.5.5.5.2.1.1.3" xref="A1.Ex17.m1.5.5.5.5.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mstyle><mo id="A1.Ex17.m1.10.10.2.3" xref="A1.Ex17.m1.10.10.2.3.cmml">⁢</mo><msub id="A1.Ex17.m1.10.10.2.4" xref="A1.Ex17.m1.10.10.2.4.cmml"><mi id="A1.Ex17.m1.10.10.2.4.2" xref="A1.Ex17.m1.10.10.2.4.2.cmml">π</mi><mtext id="A1.Ex17.m1.10.10.2.4.3" xref="A1.Ex17.m1.10.10.2.4.3a.cmml">ref</mtext></msub><mo id="A1.Ex17.m1.10.10.2.3a" xref="A1.Ex17.m1.10.10.2.3.cmml">⁢</mo><mrow id="A1.Ex17.m1.9.9.1.1.1" xref="A1.Ex17.m1.9.9.1.1.1.1.cmml"><mo id="A1.Ex17.m1.9.9.1.1.1.2" stretchy="false" xref="A1.Ex17.m1.9.9.1.1.1.1.cmml">(</mo><mrow id="A1.Ex17.m1.9.9.1.1.1.1" xref="A1.Ex17.m1.9.9.1.1.1.1.cmml"><mi id="A1.Ex17.m1.9.9.1.1.1.1.2" xref="A1.Ex17.m1.9.9.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex17.m1.9.9.1.1.1.1.1" xref="A1.Ex17.m1.9.9.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex17.m1.9.9.1.1.1.1.3" xref="A1.Ex17.m1.9.9.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex17.m1.9.9.1.1.1.3" stretchy="false" xref="A1.Ex17.m1.9.9.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex17.m1.10.10.2.3b" lspace="0.167em" xref="A1.Ex17.m1.10.10.2.3.cmml">⁢</mo><mrow id="A1.Ex17.m1.10.10.2.2.1" xref="A1.Ex17.m1.10.10.2.2.2.cmml"><mi id="A1.Ex17.m1.8.8" xref="A1.Ex17.m1.8.8.cmml">exp</mi><mo id="A1.Ex17.m1.10.10.2.2.1a" xref="A1.Ex17.m1.10.10.2.2.2.cmml">⁡</mo><mrow id="A1.Ex17.m1.10.10.2.2.1.1" xref="A1.Ex17.m1.10.10.2.2.2.cmml"><mo id="A1.Ex17.m1.10.10.2.2.1.1.2" xref="A1.Ex17.m1.10.10.2.2.2.cmml">(</mo><mrow id="A1.Ex17.m1.10.10.2.2.1.1.1" xref="A1.Ex17.m1.10.10.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A1.Ex17.m1.10.10.2.2.1.1.1.2" xref="A1.Ex17.m1.10.10.2.2.1.1.1.2.cmml"><mfrac id="A1.Ex17.m1.10.10.2.2.1.1.1.2a" xref="A1.Ex17.m1.10.10.2.2.1.1.1.2.cmml"><mn id="A1.Ex17.m1.10.10.2.2.1.1.1.2.2" xref="A1.Ex17.m1.10.10.2.2.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex17.m1.10.10.2.2.1.1.1.2.3" xref="A1.Ex17.m1.10.10.2.2.1.1.1.2.3.cmml">β</mi></mfrac></mstyle><mo id="A1.Ex17.m1.10.10.2.2.1.1.1.1" xref="A1.Ex17.m1.10.10.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex17.m1.10.10.2.2.1.1.1.3" xref="A1.Ex17.m1.10.10.2.2.1.1.1.3.cmml">r</mi><mo id="A1.Ex17.m1.10.10.2.2.1.1.1.1a" xref="A1.Ex17.m1.10.10.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex17.m1.10.10.2.2.1.1.1.4.2" xref="A1.Ex17.m1.10.10.2.2.1.1.1.4.1.cmml"><mo id="A1.Ex17.m1.10.10.2.2.1.1.1.4.2.1" stretchy="false" xref="A1.Ex17.m1.10.10.2.2.1.1.1.4.1.cmml">(</mo><mi id="A1.Ex17.m1.6.6" xref="A1.Ex17.m1.6.6.cmml">x</mi><mo id="A1.Ex17.m1.10.10.2.2.1.1.1.4.2.2" xref="A1.Ex17.m1.10.10.2.2.1.1.1.4.1.cmml">,</mo><mi id="A1.Ex17.m1.7.7" xref="A1.Ex17.m1.7.7.cmml">y</mi><mo id="A1.Ex17.m1.10.10.2.2.1.1.1.4.2.3" stretchy="false" xref="A1.Ex17.m1.10.10.2.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex17.m1.10.10.2.2.1.1.3" xref="A1.Ex17.m1.10.10.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex17.m1.10b"><apply id="A1.Ex17.m1.10.10.cmml" xref="A1.Ex17.m1.10.10"><eq id="A1.Ex17.m1.10.10.3.cmml" xref="A1.Ex17.m1.10.10.3"></eq><csymbol cd="latexml" id="A1.Ex17.m1.10.10.4.cmml" xref="A1.Ex17.m1.10.10.4">absent</csymbol><apply id="A1.Ex17.m1.10.10.2.cmml" xref="A1.Ex17.m1.10.10.2"><times id="A1.Ex17.m1.10.10.2.3.cmml" xref="A1.Ex17.m1.10.10.2.3"></times><apply id="A1.Ex17.m1.5.5.cmml" xref="A1.Ex17.m1.5.5"><divide id="A1.Ex17.m1.5.5.6.cmml" xref="A1.Ex17.m1.5.5"></divide><cn id="A1.Ex17.m1.5.5.7.cmml" type="integer" xref="A1.Ex17.m1.5.5.7">1</cn><apply id="A1.Ex17.m1.5.5.5.cmml" xref="A1.Ex17.m1.5.5.5"><apply id="A1.Ex17.m1.5.5.5.6.cmml" xref="A1.Ex17.m1.5.5.5.6"><csymbol cd="ambiguous" id="A1.Ex17.m1.5.5.5.6.1.cmml" xref="A1.Ex17.m1.5.5.5.6">subscript</csymbol><sum id="A1.Ex17.m1.5.5.5.6.2.cmml" xref="A1.Ex17.m1.5.5.5.6.2"></sum><ci id="A1.Ex17.m1.5.5.5.6.3.cmml" xref="A1.Ex17.m1.5.5.5.6.3">𝑦</ci></apply><apply id="A1.Ex17.m1.5.5.5.5.cmml" xref="A1.Ex17.m1.5.5.5.5"><times id="A1.Ex17.m1.5.5.5.5.3.cmml" xref="A1.Ex17.m1.5.5.5.5.3"></times><apply id="A1.Ex17.m1.5.5.5.5.4.cmml" xref="A1.Ex17.m1.5.5.5.5.4"><csymbol cd="ambiguous" id="A1.Ex17.m1.5.5.5.5.4.1.cmml" xref="A1.Ex17.m1.5.5.5.5.4">subscript</csymbol><ci id="A1.Ex17.m1.5.5.5.5.4.2.cmml" xref="A1.Ex17.m1.5.5.5.5.4.2">𝜋</ci><ci id="A1.Ex17.m1.5.5.5.5.4.3a.cmml" xref="A1.Ex17.m1.5.5.5.5.4.3"><mtext id="A1.Ex17.m1.5.5.5.5.4.3.cmml" mathsize="70%" xref="A1.Ex17.m1.5.5.5.5.4.3">ref</mtext></ci></apply><apply id="A1.Ex17.m1.4.4.4.4.1.1.1.cmml" xref="A1.Ex17.m1.4.4.4.4.1.1"><csymbol cd="latexml" id="A1.Ex17.m1.4.4.4.4.1.1.1.1.cmml" xref="A1.Ex17.m1.4.4.4.4.1.1.1.1">conditional</csymbol><ci id="A1.Ex17.m1.4.4.4.4.1.1.1.2.cmml" xref="A1.Ex17.m1.4.4.4.4.1.1.1.2">𝑦</ci><ci id="A1.Ex17.m1.4.4.4.4.1.1.1.3.cmml" xref="A1.Ex17.m1.4.4.4.4.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex17.m1.5.5.5.5.2.2.cmml" xref="A1.Ex17.m1.5.5.5.5.2.1"><exp id="A1.Ex17.m1.3.3.3.3.cmml" xref="A1.Ex17.m1.3.3.3.3"></exp><apply id="A1.Ex17.m1.5.5.5.5.2.1.1.1.cmml" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1"><times id="A1.Ex17.m1.5.5.5.5.2.1.1.1.1.cmml" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.1"></times><apply id="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.cmml" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.2"><divide id="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.1.cmml" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.2"></divide><cn id="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.2.cmml" type="integer" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.2">1</cn><ci id="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.3.cmml" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.2.3">𝛽</ci></apply><ci id="A1.Ex17.m1.5.5.5.5.2.1.1.1.3.cmml" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.1.cmml" xref="A1.Ex17.m1.5.5.5.5.2.1.1.1.4.2"><ci id="A1.Ex17.m1.1.1.1.1.cmml" xref="A1.Ex17.m1.1.1.1.1">𝑥</ci><ci id="A1.Ex17.m1.2.2.2.2.cmml" xref="A1.Ex17.m1.2.2.2.2">𝑦</ci></interval></apply></apply></apply></apply></apply><apply id="A1.Ex17.m1.10.10.2.4.cmml" xref="A1.Ex17.m1.10.10.2.4"><csymbol cd="ambiguous" id="A1.Ex17.m1.10.10.2.4.1.cmml" xref="A1.Ex17.m1.10.10.2.4">subscript</csymbol><ci id="A1.Ex17.m1.10.10.2.4.2.cmml" xref="A1.Ex17.m1.10.10.2.4.2">𝜋</ci><ci id="A1.Ex17.m1.10.10.2.4.3a.cmml" xref="A1.Ex17.m1.10.10.2.4.3"><mtext id="A1.Ex17.m1.10.10.2.4.3.cmml" mathsize="70%" xref="A1.Ex17.m1.10.10.2.4.3">ref</mtext></ci></apply><apply id="A1.Ex17.m1.9.9.1.1.1.1.cmml" xref="A1.Ex17.m1.9.9.1.1.1"><csymbol cd="latexml" id="A1.Ex17.m1.9.9.1.1.1.1.1.cmml" xref="A1.Ex17.m1.9.9.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex17.m1.9.9.1.1.1.1.2.cmml" xref="A1.Ex17.m1.9.9.1.1.1.1.2">𝑦</ci><ci id="A1.Ex17.m1.9.9.1.1.1.1.3.cmml" xref="A1.Ex17.m1.9.9.1.1.1.1.3">𝑥</ci></apply><apply id="A1.Ex17.m1.10.10.2.2.2.cmml" xref="A1.Ex17.m1.10.10.2.2.1"><exp id="A1.Ex17.m1.8.8.cmml" xref="A1.Ex17.m1.8.8"></exp><apply id="A1.Ex17.m1.10.10.2.2.1.1.1.cmml" xref="A1.Ex17.m1.10.10.2.2.1.1.1"><times id="A1.Ex17.m1.10.10.2.2.1.1.1.1.cmml" xref="A1.Ex17.m1.10.10.2.2.1.1.1.1"></times><apply id="A1.Ex17.m1.10.10.2.2.1.1.1.2.cmml" xref="A1.Ex17.m1.10.10.2.2.1.1.1.2"><divide id="A1.Ex17.m1.10.10.2.2.1.1.1.2.1.cmml" xref="A1.Ex17.m1.10.10.2.2.1.1.1.2"></divide><cn id="A1.Ex17.m1.10.10.2.2.1.1.1.2.2.cmml" type="integer" xref="A1.Ex17.m1.10.10.2.2.1.1.1.2.2">1</cn><ci id="A1.Ex17.m1.10.10.2.2.1.1.1.2.3.cmml" xref="A1.Ex17.m1.10.10.2.2.1.1.1.2.3">𝛽</ci></apply><ci id="A1.Ex17.m1.10.10.2.2.1.1.1.3.cmml" xref="A1.Ex17.m1.10.10.2.2.1.1.1.3">𝑟</ci><interval closure="open" id="A1.Ex17.m1.10.10.2.2.1.1.1.4.1.cmml" xref="A1.Ex17.m1.10.10.2.2.1.1.1.4.2"><ci id="A1.Ex17.m1.6.6.cmml" xref="A1.Ex17.m1.6.6">𝑥</ci><ci id="A1.Ex17.m1.7.7.cmml" xref="A1.Ex17.m1.7.7">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex17.m1.10c">\displaystyle=\frac{1}{\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r%
(x,y)\right)}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y)\right)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex17.m1.10d">= divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) ) end_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\pi_{r}(y|x)," class="ltx_Math" display="inline" id="A1.Ex18.m1.1"><semantics id="A1.Ex18.m1.1a"><mrow id="A1.Ex18.m1.1.1.1" xref="A1.Ex18.m1.1.1.1.1.cmml"><mrow id="A1.Ex18.m1.1.1.1.1" xref="A1.Ex18.m1.1.1.1.1.cmml"><mi id="A1.Ex18.m1.1.1.1.1.3" xref="A1.Ex18.m1.1.1.1.1.3.cmml"></mi><mo id="A1.Ex18.m1.1.1.1.1.2" xref="A1.Ex18.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.Ex18.m1.1.1.1.1.1" xref="A1.Ex18.m1.1.1.1.1.1.cmml"><msub id="A1.Ex18.m1.1.1.1.1.1.3" xref="A1.Ex18.m1.1.1.1.1.1.3.cmml"><mi id="A1.Ex18.m1.1.1.1.1.1.3.2" xref="A1.Ex18.m1.1.1.1.1.1.3.2.cmml">π</mi><mi id="A1.Ex18.m1.1.1.1.1.1.3.3" xref="A1.Ex18.m1.1.1.1.1.1.3.3.cmml">r</mi></msub><mo id="A1.Ex18.m1.1.1.1.1.1.2" xref="A1.Ex18.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex18.m1.1.1.1.1.1.1.1" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex18.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex18.m1.1.1.1.1.1.1.1.1" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex18.m1.1.1.1.1.1.1.1.1.2" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex18.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex18.m1.1.1.1.1.1.1.1.1.3" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex18.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex18.m1.1.1.1.2" xref="A1.Ex18.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex18.m1.1b"><apply id="A1.Ex18.m1.1.1.1.1.cmml" xref="A1.Ex18.m1.1.1.1"><eq id="A1.Ex18.m1.1.1.1.1.2.cmml" xref="A1.Ex18.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="A1.Ex18.m1.1.1.1.1.3.cmml" xref="A1.Ex18.m1.1.1.1.1.3">absent</csymbol><apply id="A1.Ex18.m1.1.1.1.1.1.cmml" xref="A1.Ex18.m1.1.1.1.1.1"><times id="A1.Ex18.m1.1.1.1.1.1.2.cmml" xref="A1.Ex18.m1.1.1.1.1.1.2"></times><apply id="A1.Ex18.m1.1.1.1.1.1.3.cmml" xref="A1.Ex18.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex18.m1.1.1.1.1.1.3.1.cmml" xref="A1.Ex18.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex18.m1.1.1.1.1.1.3.2.cmml" xref="A1.Ex18.m1.1.1.1.1.1.3.2">𝜋</ci><ci id="A1.Ex18.m1.1.1.1.1.1.3.3.cmml" xref="A1.Ex18.m1.1.1.1.1.1.3.3">𝑟</ci></apply><apply id="A1.Ex18.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex18.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex18.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex18.m1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex18.m1.1c">\displaystyle=\pi_{r}(y|x),</annotation><annotation encoding="application/x-llamapun" id="A1.Ex18.m1.1d">= italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_y | italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS5.2.p1.5">그것은 증명을 완성한다. ∎</p>
</div>
</div>
</section>
<section class="ltx_subsection" id="A1.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Proof of Theorem 1</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS6.p1">
<p class="ltx_p" id="A1.SS6.p1.1">이 절에서는 정리<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#Thmtheorem1" title="Theorem 1. ‣ 5.1 Your Language Model Is Secretly a Reward Model ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">1</span></a>의 결과를 확장하기로 한다.</p>
</div>
<div class="ltx_para" id="A1.SS6.p2">
<p class="ltx_p" id="A1.SS6.p2.6"><span class="ltx_text ltx_font_bold" id="A1.SS6.p2.6.7">Theorem 1 Restated.</span><span class="ltx_text ltx_font_italic" id="A1.SS6.p2.6.6"> Assume, we have a reference model, such that <math alttext="\pi_{\text{ref}}(y|x)>0" class="ltx_Math" display="inline" id="A1.SS6.p2.1.1.m1.1"><semantics id="A1.SS6.p2.1.1.m1.1a"><mrow id="A1.SS6.p2.1.1.m1.1.1" xref="A1.SS6.p2.1.1.m1.1.1.cmml"><mrow id="A1.SS6.p2.1.1.m1.1.1.1" xref="A1.SS6.p2.1.1.m1.1.1.1.cmml"><msub id="A1.SS6.p2.1.1.m1.1.1.1.3" xref="A1.SS6.p2.1.1.m1.1.1.1.3.cmml"><mi id="A1.SS6.p2.1.1.m1.1.1.1.3.2" xref="A1.SS6.p2.1.1.m1.1.1.1.3.2.cmml">π</mi><mtext id="A1.SS6.p2.1.1.m1.1.1.1.3.3" xref="A1.SS6.p2.1.1.m1.1.1.1.3.3a.cmml">𝑟𝑒𝑓</mtext></msub><mo id="A1.SS6.p2.1.1.m1.1.1.1.2" mathvariant="italic" xref="A1.SS6.p2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.p2.1.1.m1.1.1.1.1.1" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.cmml"><mo id="A1.SS6.p2.1.1.m1.1.1.1.1.1.2" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.p2.1.1.m1.1.1.1.1.1.1" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.2" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.1" mathvariant="normal" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.3" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.p2.1.1.m1.1.1.1.1.1.3" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.p2.1.1.m1.1.1.2" mathvariant="normal" xref="A1.SS6.p2.1.1.m1.1.1.2.cmml">&gt;</mo><mn id="A1.SS6.p2.1.1.m1.1.1.3" mathvariant="normal" xref="A1.SS6.p2.1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.1.1.m1.1b"><apply id="A1.SS6.p2.1.1.m1.1.1.cmml" xref="A1.SS6.p2.1.1.m1.1.1"><gt id="A1.SS6.p2.1.1.m1.1.1.2.cmml" xref="A1.SS6.p2.1.1.m1.1.1.2"></gt><apply id="A1.SS6.p2.1.1.m1.1.1.1.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1"><times id="A1.SS6.p2.1.1.m1.1.1.1.2.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1.2"></times><apply id="A1.SS6.p2.1.1.m1.1.1.1.3.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS6.p2.1.1.m1.1.1.1.3.1.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1.3">subscript</csymbol><ci id="A1.SS6.p2.1.1.m1.1.1.1.3.2.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1.3.2">𝜋</ci><ci id="A1.SS6.p2.1.1.m1.1.1.1.3.3a.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1.3.3"><mtext id="A1.SS6.p2.1.1.m1.1.1.1.3.3.cmml" mathsize="70%" xref="A1.SS6.p2.1.1.m1.1.1.1.3.3">𝑟𝑒𝑓</mtext></ci></apply><apply id="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS6.p2.1.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><cn id="A1.SS6.p2.1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS6.p2.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.1.1.m1.1c">\pi_{\text{ref}}(y|x)&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.1.1.m1.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) &gt; 0</annotation></semantics></math> for all pairs of prompts <math alttext="x" class="ltx_Math" display="inline" id="A1.SS6.p2.2.2.m2.1"><semantics id="A1.SS6.p2.2.2.m2.1a"><mi id="A1.SS6.p2.2.2.m2.1.1" xref="A1.SS6.p2.2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.2.2.m2.1b"><ci id="A1.SS6.p2.2.2.m2.1.1.cmml" xref="A1.SS6.p2.2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.2.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.2.2.m2.1d">italic_x</annotation></semantics></math> and answers <math alttext="y" class="ltx_Math" display="inline" id="A1.SS6.p2.3.3.m3.1"><semantics id="A1.SS6.p2.3.3.m3.1a"><mi id="A1.SS6.p2.3.3.m3.1.1" xref="A1.SS6.p2.3.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.3.3.m3.1b"><ci id="A1.SS6.p2.3.3.m3.1.1.cmml" xref="A1.SS6.p2.3.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.3.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.3.3.m3.1d">italic_y</annotation></semantics></math> and a parameter <math alttext="\beta>0" class="ltx_Math" display="inline" id="A1.SS6.p2.4.4.m4.1"><semantics id="A1.SS6.p2.4.4.m4.1a"><mrow id="A1.SS6.p2.4.4.m4.1.1" xref="A1.SS6.p2.4.4.m4.1.1.cmml"><mi id="A1.SS6.p2.4.4.m4.1.1.2" xref="A1.SS6.p2.4.4.m4.1.1.2.cmml">β</mi><mo id="A1.SS6.p2.4.4.m4.1.1.1" mathvariant="normal" xref="A1.SS6.p2.4.4.m4.1.1.1.cmml">&gt;</mo><mn id="A1.SS6.p2.4.4.m4.1.1.3" mathvariant="normal" xref="A1.SS6.p2.4.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.4.4.m4.1b"><apply id="A1.SS6.p2.4.4.m4.1.1.cmml" xref="A1.SS6.p2.4.4.m4.1.1"><gt id="A1.SS6.p2.4.4.m4.1.1.1.cmml" xref="A1.SS6.p2.4.4.m4.1.1.1"></gt><ci id="A1.SS6.p2.4.4.m4.1.1.2.cmml" xref="A1.SS6.p2.4.4.m4.1.1.2">𝛽</ci><cn id="A1.SS6.p2.4.4.m4.1.1.3.cmml" type="integer" xref="A1.SS6.p2.4.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.4.4.m4.1c">\beta&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.4.4.m4.1d">italic_β &gt; 0</annotation></semantics></math>. All reward equivalence classes, as defined in Section <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S5" title="5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a> can be represented with the reparameterization <math alttext="r(x,y)=\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}" class="ltx_Math" display="inline" id="A1.SS6.p2.5.5.m5.4"><semantics id="A1.SS6.p2.5.5.m5.4a"><mrow id="A1.SS6.p2.5.5.m5.4.5" xref="A1.SS6.p2.5.5.m5.4.5.cmml"><mrow id="A1.SS6.p2.5.5.m5.4.5.2" xref="A1.SS6.p2.5.5.m5.4.5.2.cmml"><mi id="A1.SS6.p2.5.5.m5.4.5.2.2" xref="A1.SS6.p2.5.5.m5.4.5.2.2.cmml">r</mi><mo id="A1.SS6.p2.5.5.m5.4.5.2.1" mathvariant="italic" xref="A1.SS6.p2.5.5.m5.4.5.2.1.cmml">⁢</mo><mrow id="A1.SS6.p2.5.5.m5.4.5.2.3.2" xref="A1.SS6.p2.5.5.m5.4.5.2.3.1.cmml"><mo id="A1.SS6.p2.5.5.m5.4.5.2.3.2.1" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.5.5.m5.4.5.2.3.1.cmml">(</mo><mi id="A1.SS6.p2.5.5.m5.3.3" xref="A1.SS6.p2.5.5.m5.3.3.cmml">x</mi><mo id="A1.SS6.p2.5.5.m5.4.5.2.3.2.2" mathvariant="normal" xref="A1.SS6.p2.5.5.m5.4.5.2.3.1.cmml">,</mo><mi id="A1.SS6.p2.5.5.m5.4.4" xref="A1.SS6.p2.5.5.m5.4.4.cmml">y</mi><mo id="A1.SS6.p2.5.5.m5.4.5.2.3.2.3" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.5.5.m5.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.p2.5.5.m5.4.5.1" mathvariant="normal" xref="A1.SS6.p2.5.5.m5.4.5.1.cmml">=</mo><mrow id="A1.SS6.p2.5.5.m5.4.5.3" xref="A1.SS6.p2.5.5.m5.4.5.3.cmml"><mi id="A1.SS6.p2.5.5.m5.4.5.3.2" xref="A1.SS6.p2.5.5.m5.4.5.3.2.cmml">β</mi><mo id="A1.SS6.p2.5.5.m5.4.5.3.1" lspace="0.167em" mathvariant="italic" xref="A1.SS6.p2.5.5.m5.4.5.3.1.cmml">⁢</mo><mrow id="A1.SS6.p2.5.5.m5.4.5.3.3" xref="A1.SS6.p2.5.5.m5.4.5.3.3.cmml"><mi id="A1.SS6.p2.5.5.m5.4.5.3.3.1" mathvariant="normal" xref="A1.SS6.p2.5.5.m5.4.5.3.3.1.cmml">log</mi><mo id="A1.SS6.p2.5.5.m5.4.5.3.3a" lspace="0.167em" mathvariant="italic" xref="A1.SS6.p2.5.5.m5.4.5.3.3.cmml">⁡</mo><mfrac id="A1.SS6.p2.5.5.m5.2.2" xref="A1.SS6.p2.5.5.m5.2.2.cmml"><mrow id="A1.SS6.p2.5.5.m5.1.1.1" xref="A1.SS6.p2.5.5.m5.1.1.1.cmml"><mi id="A1.SS6.p2.5.5.m5.1.1.1.3" xref="A1.SS6.p2.5.5.m5.1.1.1.3.cmml">π</mi><mo id="A1.SS6.p2.5.5.m5.1.1.1.2" mathvariant="italic" xref="A1.SS6.p2.5.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.p2.5.5.m5.1.1.1.1.1" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.cmml"><mo id="A1.SS6.p2.5.5.m5.1.1.1.1.1.2" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.p2.5.5.m5.1.1.1.1.1.1" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.cmml"><mi id="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.2" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.1" mathvariant="normal" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.3" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.p2.5.5.m5.1.1.1.1.1.3" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS6.p2.5.5.m5.2.2.2" xref="A1.SS6.p2.5.5.m5.2.2.2.cmml"><msub id="A1.SS6.p2.5.5.m5.2.2.2.3" xref="A1.SS6.p2.5.5.m5.2.2.2.3.cmml"><mi id="A1.SS6.p2.5.5.m5.2.2.2.3.2" xref="A1.SS6.p2.5.5.m5.2.2.2.3.2.cmml">π</mi><mtext id="A1.SS6.p2.5.5.m5.2.2.2.3.3" xref="A1.SS6.p2.5.5.m5.2.2.2.3.3a.cmml">𝑟𝑒𝑓</mtext></msub><mo id="A1.SS6.p2.5.5.m5.2.2.2.2" mathvariant="italic" xref="A1.SS6.p2.5.5.m5.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS6.p2.5.5.m5.2.2.2.1.1" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.cmml"><mo id="A1.SS6.p2.5.5.m5.2.2.2.1.1.2" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS6.p2.5.5.m5.2.2.2.1.1.1" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.cmml"><mi id="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.2" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.1" mathvariant="normal" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.3" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.p2.5.5.m5.2.2.2.1.1.3" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.5.5.m5.4b"><apply id="A1.SS6.p2.5.5.m5.4.5.cmml" xref="A1.SS6.p2.5.5.m5.4.5"><eq id="A1.SS6.p2.5.5.m5.4.5.1.cmml" xref="A1.SS6.p2.5.5.m5.4.5.1"></eq><apply id="A1.SS6.p2.5.5.m5.4.5.2.cmml" xref="A1.SS6.p2.5.5.m5.4.5.2"><times id="A1.SS6.p2.5.5.m5.4.5.2.1.cmml" xref="A1.SS6.p2.5.5.m5.4.5.2.1"></times><ci id="A1.SS6.p2.5.5.m5.4.5.2.2.cmml" xref="A1.SS6.p2.5.5.m5.4.5.2.2">𝑟</ci><interval closure="open" id="A1.SS6.p2.5.5.m5.4.5.2.3.1.cmml" xref="A1.SS6.p2.5.5.m5.4.5.2.3.2"><ci id="A1.SS6.p2.5.5.m5.3.3.cmml" xref="A1.SS6.p2.5.5.m5.3.3">𝑥</ci><ci id="A1.SS6.p2.5.5.m5.4.4.cmml" xref="A1.SS6.p2.5.5.m5.4.4">𝑦</ci></interval></apply><apply id="A1.SS6.p2.5.5.m5.4.5.3.cmml" xref="A1.SS6.p2.5.5.m5.4.5.3"><times id="A1.SS6.p2.5.5.m5.4.5.3.1.cmml" xref="A1.SS6.p2.5.5.m5.4.5.3.1"></times><ci id="A1.SS6.p2.5.5.m5.4.5.3.2.cmml" xref="A1.SS6.p2.5.5.m5.4.5.3.2">𝛽</ci><apply id="A1.SS6.p2.5.5.m5.4.5.3.3.cmml" xref="A1.SS6.p2.5.5.m5.4.5.3.3"><log id="A1.SS6.p2.5.5.m5.4.5.3.3.1.cmml" xref="A1.SS6.p2.5.5.m5.4.5.3.3.1"></log><apply id="A1.SS6.p2.5.5.m5.2.2.cmml" xref="A1.SS6.p2.5.5.m5.2.2"><divide id="A1.SS6.p2.5.5.m5.2.2.3.cmml" xref="A1.SS6.p2.5.5.m5.2.2"></divide><apply id="A1.SS6.p2.5.5.m5.1.1.1.cmml" xref="A1.SS6.p2.5.5.m5.1.1.1"><times id="A1.SS6.p2.5.5.m5.1.1.1.2.cmml" xref="A1.SS6.p2.5.5.m5.1.1.1.2"></times><ci id="A1.SS6.p2.5.5.m5.1.1.1.3.cmml" xref="A1.SS6.p2.5.5.m5.1.1.1.3">𝜋</ci><apply id="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.cmml" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.1.cmml" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.2.cmml" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.3.cmml" xref="A1.SS6.p2.5.5.m5.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.SS6.p2.5.5.m5.2.2.2.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2"><times id="A1.SS6.p2.5.5.m5.2.2.2.2.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2.2"></times><apply id="A1.SS6.p2.5.5.m5.2.2.2.3.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS6.p2.5.5.m5.2.2.2.3.1.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2.3">subscript</csymbol><ci id="A1.SS6.p2.5.5.m5.2.2.2.3.2.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2.3.2">𝜋</ci><ci id="A1.SS6.p2.5.5.m5.2.2.2.3.3a.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2.3.3"><mtext id="A1.SS6.p2.5.5.m5.2.2.2.3.3.cmml" mathsize="50%" xref="A1.SS6.p2.5.5.m5.2.2.2.3.3">𝑟𝑒𝑓</mtext></ci></apply><apply id="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1"><csymbol cd="latexml" id="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.1.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.2.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.3.cmml" xref="A1.SS6.p2.5.5.m5.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.5.5.m5.4c">r(x,y)=\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.5.5.m5.4d">italic_r ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG</annotation></semantics></math> for some model <math alttext="\pi(y|x)" class="ltx_Math" display="inline" id="A1.SS6.p2.6.6.m6.1"><semantics id="A1.SS6.p2.6.6.m6.1a"><mrow id="A1.SS6.p2.6.6.m6.1.1" xref="A1.SS6.p2.6.6.m6.1.1.cmml"><mi id="A1.SS6.p2.6.6.m6.1.1.3" xref="A1.SS6.p2.6.6.m6.1.1.3.cmml">π</mi><mo id="A1.SS6.p2.6.6.m6.1.1.2" mathvariant="italic" xref="A1.SS6.p2.6.6.m6.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.p2.6.6.m6.1.1.1.1" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.cmml"><mo id="A1.SS6.p2.6.6.m6.1.1.1.1.2" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.p2.6.6.m6.1.1.1.1.1" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.cmml"><mi id="A1.SS6.p2.6.6.m6.1.1.1.1.1.2" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.p2.6.6.m6.1.1.1.1.1.1" mathvariant="normal" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.p2.6.6.m6.1.1.1.1.1.3" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.p2.6.6.m6.1.1.1.1.3" mathvariant="normal" stretchy="false" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p2.6.6.m6.1b"><apply id="A1.SS6.p2.6.6.m6.1.1.cmml" xref="A1.SS6.p2.6.6.m6.1.1"><times id="A1.SS6.p2.6.6.m6.1.1.2.cmml" xref="A1.SS6.p2.6.6.m6.1.1.2"></times><ci id="A1.SS6.p2.6.6.m6.1.1.3.cmml" xref="A1.SS6.p2.6.6.m6.1.1.3">𝜋</ci><apply id="A1.SS6.p2.6.6.m6.1.1.1.1.1.cmml" xref="A1.SS6.p2.6.6.m6.1.1.1.1"><csymbol cd="latexml" id="A1.SS6.p2.6.6.m6.1.1.1.1.1.1.cmml" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.p2.6.6.m6.1.1.1.1.1.2.cmml" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.p2.6.6.m6.1.1.1.1.1.3.cmml" xref="A1.SS6.p2.6.6.m6.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p2.6.6.m6.1c">\pi(y|x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p2.6.6.m6.1d">italic_π ( italic_y | italic_x )</annotation></semantics></math>. </span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_proof" id="A1.SS6.2">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS6.1.p1">
<p class="ltx_p" id="A1.SS6.1.p1.2">KL 제약 RL 문제 하에서 최적 모델 <math alttext="\pi_{r}(y|x)" class="ltx_Math" display="inline" id="A1.SS6.1.p1.2.m2.1"><semantics id="A1.SS6.1.p1.2.m2.1a"><mrow id="A1.SS6.1.p1.2.m2.1.1" xref="A1.SS6.1.p1.2.m2.1.1.cmml"><msub id="A1.SS6.1.p1.2.m2.1.1.3" xref="A1.SS6.1.p1.2.m2.1.1.3.cmml"><mi id="A1.SS6.1.p1.2.m2.1.1.3.2" xref="A1.SS6.1.p1.2.m2.1.1.3.2.cmml">π</mi><mi id="A1.SS6.1.p1.2.m2.1.1.3.3" xref="A1.SS6.1.p1.2.m2.1.1.3.3.cmml">r</mi></msub><mo id="A1.SS6.1.p1.2.m2.1.1.2" xref="A1.SS6.1.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.1.p1.2.m2.1.1.1.1" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.cmml"><mo id="A1.SS6.1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.1.p1.2.m2.1.1.1.1.1" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS6.1.p1.2.m2.1.1.1.1.1.2" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.1.p1.2.m2.1.1.1.1.1.1" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.1.p1.2.m2.1.1.1.1.1.3" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.1.p1.2.m2.1b"><apply id="A1.SS6.1.p1.2.m2.1.1.cmml" xref="A1.SS6.1.p1.2.m2.1.1"><times id="A1.SS6.1.p1.2.m2.1.1.2.cmml" xref="A1.SS6.1.p1.2.m2.1.1.2"></times><apply id="A1.SS6.1.p1.2.m2.1.1.3.cmml" xref="A1.SS6.1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS6.1.p1.2.m2.1.1.3.1.cmml" xref="A1.SS6.1.p1.2.m2.1.1.3">subscript</csymbol><ci id="A1.SS6.1.p1.2.m2.1.1.3.2.cmml" xref="A1.SS6.1.p1.2.m2.1.1.3.2">𝜋</ci><ci id="A1.SS6.1.p1.2.m2.1.1.3.3.cmml" xref="A1.SS6.1.p1.2.m2.1.1.3.3">𝑟</ci></apply><apply id="A1.SS6.1.p1.2.m2.1.1.1.1.1.cmml" xref="A1.SS6.1.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="A1.SS6.1.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.1.p1.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.1.p1.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS6.1.p1.2.m2.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.1.p1.2.m2.1c">\pi_{r}(y|x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.1.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_y | italic_x )</annotation></semantics></math>를 유도하는 임의의 보상 함수 <math alttext="r(x,y)" class="ltx_Math" display="inline" id="A1.SS6.1.p1.1.m1.2"><semantics id="A1.SS6.1.p1.1.m1.2a"><mrow id="A1.SS6.1.p1.1.m1.2.3" xref="A1.SS6.1.p1.1.m1.2.3.cmml"><mi id="A1.SS6.1.p1.1.m1.2.3.2" xref="A1.SS6.1.p1.1.m1.2.3.2.cmml">r</mi><mo id="A1.SS6.1.p1.1.m1.2.3.1" xref="A1.SS6.1.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A1.SS6.1.p1.1.m1.2.3.3.2" xref="A1.SS6.1.p1.1.m1.2.3.3.1.cmml"><mo id="A1.SS6.1.p1.1.m1.2.3.3.2.1" stretchy="false" xref="A1.SS6.1.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="A1.SS6.1.p1.1.m1.1.1" xref="A1.SS6.1.p1.1.m1.1.1.cmml">x</mi><mo id="A1.SS6.1.p1.1.m1.2.3.3.2.2" xref="A1.SS6.1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="A1.SS6.1.p1.1.m1.2.2" xref="A1.SS6.1.p1.1.m1.2.2.cmml">y</mi><mo id="A1.SS6.1.p1.1.m1.2.3.3.2.3" stretchy="false" xref="A1.SS6.1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.1.p1.1.m1.2b"><apply id="A1.SS6.1.p1.1.m1.2.3.cmml" xref="A1.SS6.1.p1.1.m1.2.3"><times id="A1.SS6.1.p1.1.m1.2.3.1.cmml" xref="A1.SS6.1.p1.1.m1.2.3.1"></times><ci id="A1.SS6.1.p1.1.m1.2.3.2.cmml" xref="A1.SS6.1.p1.1.m1.2.3.2">𝑟</ci><interval closure="open" id="A1.SS6.1.p1.1.m1.2.3.3.1.cmml" xref="A1.SS6.1.p1.1.m1.2.3.3.2"><ci id="A1.SS6.1.p1.1.m1.1.1.cmml" xref="A1.SS6.1.p1.1.m1.1.1">𝑥</ci><ci id="A1.SS6.1.p1.1.m1.2.2.cmml" xref="A1.SS6.1.p1.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.1.p1.1.m1.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.1.p1.1.m1.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math>를 고려하며, <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E4" title="4 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>에 의해 주어진 솔루션을 고려한다. 다음 식. <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S4.E5" title="5 ‣ 4 Direct Preference Optimization ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a>, 우리가 양쪽을 로그-선형화할 때 우리는 얻는다:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r(x,y)=\beta\log\frac{\pi_{r}(y|x)}{\pi_{\text{ref}}(y|x)}+\beta\log Z(x)" class="ltx_Math" display="block" id="A1.Ex19.m1.5"><semantics id="A1.Ex19.m1.5a"><mrow id="A1.Ex19.m1.5.6" xref="A1.Ex19.m1.5.6.cmml"><mrow id="A1.Ex19.m1.5.6.2" xref="A1.Ex19.m1.5.6.2.cmml"><mi id="A1.Ex19.m1.5.6.2.2" xref="A1.Ex19.m1.5.6.2.2.cmml">r</mi><mo id="A1.Ex19.m1.5.6.2.1" xref="A1.Ex19.m1.5.6.2.1.cmml">⁢</mo><mrow id="A1.Ex19.m1.5.6.2.3.2" xref="A1.Ex19.m1.5.6.2.3.1.cmml"><mo id="A1.Ex19.m1.5.6.2.3.2.1" stretchy="false" xref="A1.Ex19.m1.5.6.2.3.1.cmml">(</mo><mi id="A1.Ex19.m1.3.3" xref="A1.Ex19.m1.3.3.cmml">x</mi><mo id="A1.Ex19.m1.5.6.2.3.2.2" xref="A1.Ex19.m1.5.6.2.3.1.cmml">,</mo><mi id="A1.Ex19.m1.4.4" xref="A1.Ex19.m1.4.4.cmml">y</mi><mo id="A1.Ex19.m1.5.6.2.3.2.3" stretchy="false" xref="A1.Ex19.m1.5.6.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex19.m1.5.6.1" xref="A1.Ex19.m1.5.6.1.cmml">=</mo><mrow id="A1.Ex19.m1.5.6.3" xref="A1.Ex19.m1.5.6.3.cmml"><mrow id="A1.Ex19.m1.5.6.3.2" xref="A1.Ex19.m1.5.6.3.2.cmml"><mi id="A1.Ex19.m1.5.6.3.2.2" xref="A1.Ex19.m1.5.6.3.2.2.cmml">β</mi><mo id="A1.Ex19.m1.5.6.3.2.1" lspace="0.167em" xref="A1.Ex19.m1.5.6.3.2.1.cmml">⁢</mo><mrow id="A1.Ex19.m1.5.6.3.2.3" xref="A1.Ex19.m1.5.6.3.2.3.cmml"><mi id="A1.Ex19.m1.5.6.3.2.3.1" xref="A1.Ex19.m1.5.6.3.2.3.1.cmml">log</mi><mo id="A1.Ex19.m1.5.6.3.2.3a" lspace="0.167em" xref="A1.Ex19.m1.5.6.3.2.3.cmml">⁡</mo><mfrac id="A1.Ex19.m1.2.2" xref="A1.Ex19.m1.2.2.cmml"><mrow id="A1.Ex19.m1.1.1.1" xref="A1.Ex19.m1.1.1.1.cmml"><msub id="A1.Ex19.m1.1.1.1.3" xref="A1.Ex19.m1.1.1.1.3.cmml"><mi id="A1.Ex19.m1.1.1.1.3.2" xref="A1.Ex19.m1.1.1.1.3.2.cmml">π</mi><mi id="A1.Ex19.m1.1.1.1.3.3" xref="A1.Ex19.m1.1.1.1.3.3.cmml">r</mi></msub><mo id="A1.Ex19.m1.1.1.1.2" xref="A1.Ex19.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex19.m1.1.1.1.1.1" xref="A1.Ex19.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex19.m1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex19.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex19.m1.1.1.1.1.1.1" xref="A1.Ex19.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex19.m1.1.1.1.1.1.1.2" xref="A1.Ex19.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex19.m1.1.1.1.1.1.1.1" xref="A1.Ex19.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex19.m1.1.1.1.1.1.1.3" xref="A1.Ex19.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex19.m1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex19.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex19.m1.2.2.2" xref="A1.Ex19.m1.2.2.2.cmml"><msub id="A1.Ex19.m1.2.2.2.3" xref="A1.Ex19.m1.2.2.2.3.cmml"><mi id="A1.Ex19.m1.2.2.2.3.2" xref="A1.Ex19.m1.2.2.2.3.2.cmml">π</mi><mtext id="A1.Ex19.m1.2.2.2.3.3" xref="A1.Ex19.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex19.m1.2.2.2.2" xref="A1.Ex19.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.Ex19.m1.2.2.2.1.1" xref="A1.Ex19.m1.2.2.2.1.1.1.cmml"><mo id="A1.Ex19.m1.2.2.2.1.1.2" stretchy="false" xref="A1.Ex19.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex19.m1.2.2.2.1.1.1" xref="A1.Ex19.m1.2.2.2.1.1.1.cmml"><mi id="A1.Ex19.m1.2.2.2.1.1.1.2" xref="A1.Ex19.m1.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex19.m1.2.2.2.1.1.1.1" xref="A1.Ex19.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex19.m1.2.2.2.1.1.1.3" xref="A1.Ex19.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex19.m1.2.2.2.1.1.3" stretchy="false" xref="A1.Ex19.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex19.m1.5.6.3.1" xref="A1.Ex19.m1.5.6.3.1.cmml">+</mo><mrow id="A1.Ex19.m1.5.6.3.3" xref="A1.Ex19.m1.5.6.3.3.cmml"><mi id="A1.Ex19.m1.5.6.3.3.2" xref="A1.Ex19.m1.5.6.3.3.2.cmml">β</mi><mo id="A1.Ex19.m1.5.6.3.3.1" lspace="0.167em" xref="A1.Ex19.m1.5.6.3.3.1.cmml">⁢</mo><mrow id="A1.Ex19.m1.5.6.3.3.3" xref="A1.Ex19.m1.5.6.3.3.3.cmml"><mi id="A1.Ex19.m1.5.6.3.3.3.1" xref="A1.Ex19.m1.5.6.3.3.3.1.cmml">log</mi><mo id="A1.Ex19.m1.5.6.3.3.3a" lspace="0.167em" xref="A1.Ex19.m1.5.6.3.3.3.cmml">⁡</mo><mi id="A1.Ex19.m1.5.6.3.3.3.2" xref="A1.Ex19.m1.5.6.3.3.3.2.cmml">Z</mi></mrow><mo id="A1.Ex19.m1.5.6.3.3.1a" xref="A1.Ex19.m1.5.6.3.3.1.cmml">⁢</mo><mrow id="A1.Ex19.m1.5.6.3.3.4.2" xref="A1.Ex19.m1.5.6.3.3.cmml"><mo id="A1.Ex19.m1.5.6.3.3.4.2.1" stretchy="false" xref="A1.Ex19.m1.5.6.3.3.cmml">(</mo><mi id="A1.Ex19.m1.5.5" xref="A1.Ex19.m1.5.5.cmml">x</mi><mo id="A1.Ex19.m1.5.6.3.3.4.2.2" stretchy="false" xref="A1.Ex19.m1.5.6.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex19.m1.5b"><apply id="A1.Ex19.m1.5.6.cmml" xref="A1.Ex19.m1.5.6"><eq id="A1.Ex19.m1.5.6.1.cmml" xref="A1.Ex19.m1.5.6.1"></eq><apply id="A1.Ex19.m1.5.6.2.cmml" xref="A1.Ex19.m1.5.6.2"><times id="A1.Ex19.m1.5.6.2.1.cmml" xref="A1.Ex19.m1.5.6.2.1"></times><ci id="A1.Ex19.m1.5.6.2.2.cmml" xref="A1.Ex19.m1.5.6.2.2">𝑟</ci><interval closure="open" id="A1.Ex19.m1.5.6.2.3.1.cmml" xref="A1.Ex19.m1.5.6.2.3.2"><ci id="A1.Ex19.m1.3.3.cmml" xref="A1.Ex19.m1.3.3">𝑥</ci><ci id="A1.Ex19.m1.4.4.cmml" xref="A1.Ex19.m1.4.4">𝑦</ci></interval></apply><apply id="A1.Ex19.m1.5.6.3.cmml" xref="A1.Ex19.m1.5.6.3"><plus id="A1.Ex19.m1.5.6.3.1.cmml" xref="A1.Ex19.m1.5.6.3.1"></plus><apply id="A1.Ex19.m1.5.6.3.2.cmml" xref="A1.Ex19.m1.5.6.3.2"><times id="A1.Ex19.m1.5.6.3.2.1.cmml" xref="A1.Ex19.m1.5.6.3.2.1"></times><ci id="A1.Ex19.m1.5.6.3.2.2.cmml" xref="A1.Ex19.m1.5.6.3.2.2">𝛽</ci><apply id="A1.Ex19.m1.5.6.3.2.3.cmml" xref="A1.Ex19.m1.5.6.3.2.3"><log id="A1.Ex19.m1.5.6.3.2.3.1.cmml" xref="A1.Ex19.m1.5.6.3.2.3.1"></log><apply id="A1.Ex19.m1.2.2.cmml" xref="A1.Ex19.m1.2.2"><divide id="A1.Ex19.m1.2.2.3.cmml" xref="A1.Ex19.m1.2.2"></divide><apply id="A1.Ex19.m1.1.1.1.cmml" xref="A1.Ex19.m1.1.1.1"><times id="A1.Ex19.m1.1.1.1.2.cmml" xref="A1.Ex19.m1.1.1.1.2"></times><apply id="A1.Ex19.m1.1.1.1.3.cmml" xref="A1.Ex19.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex19.m1.1.1.1.3.1.cmml" xref="A1.Ex19.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex19.m1.1.1.1.3.2.cmml" xref="A1.Ex19.m1.1.1.1.3.2">𝜋</ci><ci id="A1.Ex19.m1.1.1.1.3.3.cmml" xref="A1.Ex19.m1.1.1.1.3.3">𝑟</ci></apply><apply id="A1.Ex19.m1.1.1.1.1.1.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex19.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex19.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex19.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex19.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex19.m1.2.2.2.cmml" xref="A1.Ex19.m1.2.2.2"><times id="A1.Ex19.m1.2.2.2.2.cmml" xref="A1.Ex19.m1.2.2.2.2"></times><apply id="A1.Ex19.m1.2.2.2.3.cmml" xref="A1.Ex19.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex19.m1.2.2.2.3.1.cmml" xref="A1.Ex19.m1.2.2.2.3">subscript</csymbol><ci id="A1.Ex19.m1.2.2.2.3.2.cmml" xref="A1.Ex19.m1.2.2.2.3.2">𝜋</ci><ci id="A1.Ex19.m1.2.2.2.3.3a.cmml" xref="A1.Ex19.m1.2.2.2.3.3"><mtext id="A1.Ex19.m1.2.2.2.3.3.cmml" mathsize="70%" xref="A1.Ex19.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex19.m1.2.2.2.1.1.1.cmml" xref="A1.Ex19.m1.2.2.2.1.1"><csymbol cd="latexml" id="A1.Ex19.m1.2.2.2.1.1.1.1.cmml" xref="A1.Ex19.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex19.m1.2.2.2.1.1.1.2.cmml" xref="A1.Ex19.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.Ex19.m1.2.2.2.1.1.1.3.cmml" xref="A1.Ex19.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.Ex19.m1.5.6.3.3.cmml" xref="A1.Ex19.m1.5.6.3.3"><times id="A1.Ex19.m1.5.6.3.3.1.cmml" xref="A1.Ex19.m1.5.6.3.3.1"></times><ci id="A1.Ex19.m1.5.6.3.3.2.cmml" xref="A1.Ex19.m1.5.6.3.3.2">𝛽</ci><apply id="A1.Ex19.m1.5.6.3.3.3.cmml" xref="A1.Ex19.m1.5.6.3.3.3"><log id="A1.Ex19.m1.5.6.3.3.3.1.cmml" xref="A1.Ex19.m1.5.6.3.3.3.1"></log><ci id="A1.Ex19.m1.5.6.3.3.3.2.cmml" xref="A1.Ex19.m1.5.6.3.3.3.2">𝑍</ci></apply><ci id="A1.Ex19.m1.5.5.cmml" xref="A1.Ex19.m1.5.5">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex19.m1.5c">r(x,y)=\beta\log\frac{\pi_{r}(y|x)}{\pi_{\text{ref}}(y|x)}+\beta\log Z(x)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex19.m1.5d">italic_r ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG + italic_β roman_log italic_Z ( italic_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS6.1.p1.7">where <math alttext="Z(x)=\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y)\right)" class="ltx_Math" display="inline" id="A1.SS6.1.p1.3.m1.6"><semantics id="A1.SS6.1.p1.3.m1.6a"><mrow id="A1.SS6.1.p1.3.m1.6.6" xref="A1.SS6.1.p1.3.m1.6.6.cmml"><mrow id="A1.SS6.1.p1.3.m1.6.6.4" xref="A1.SS6.1.p1.3.m1.6.6.4.cmml"><mi id="A1.SS6.1.p1.3.m1.6.6.4.2" xref="A1.SS6.1.p1.3.m1.6.6.4.2.cmml">Z</mi><mo id="A1.SS6.1.p1.3.m1.6.6.4.1" xref="A1.SS6.1.p1.3.m1.6.6.4.1.cmml">⁢</mo><mrow id="A1.SS6.1.p1.3.m1.6.6.4.3.2" xref="A1.SS6.1.p1.3.m1.6.6.4.cmml"><mo id="A1.SS6.1.p1.3.m1.6.6.4.3.2.1" stretchy="false" xref="A1.SS6.1.p1.3.m1.6.6.4.cmml">(</mo><mi id="A1.SS6.1.p1.3.m1.1.1" xref="A1.SS6.1.p1.3.m1.1.1.cmml">x</mi><mo id="A1.SS6.1.p1.3.m1.6.6.4.3.2.2" stretchy="false" xref="A1.SS6.1.p1.3.m1.6.6.4.cmml">)</mo></mrow></mrow><mo id="A1.SS6.1.p1.3.m1.6.6.3" rspace="0.111em" xref="A1.SS6.1.p1.3.m1.6.6.3.cmml">=</mo><mrow id="A1.SS6.1.p1.3.m1.6.6.2" xref="A1.SS6.1.p1.3.m1.6.6.2.cmml"><msub id="A1.SS6.1.p1.3.m1.6.6.2.3" xref="A1.SS6.1.p1.3.m1.6.6.2.3.cmml"><mo id="A1.SS6.1.p1.3.m1.6.6.2.3.2" xref="A1.SS6.1.p1.3.m1.6.6.2.3.2.cmml">∑</mo><mi id="A1.SS6.1.p1.3.m1.6.6.2.3.3" xref="A1.SS6.1.p1.3.m1.6.6.2.3.3.cmml">y</mi></msub><mrow id="A1.SS6.1.p1.3.m1.6.6.2.2" xref="A1.SS6.1.p1.3.m1.6.6.2.2.cmml"><msub id="A1.SS6.1.p1.3.m1.6.6.2.2.4" xref="A1.SS6.1.p1.3.m1.6.6.2.2.4.cmml"><mi id="A1.SS6.1.p1.3.m1.6.6.2.2.4.2" xref="A1.SS6.1.p1.3.m1.6.6.2.2.4.2.cmml">π</mi><mtext id="A1.SS6.1.p1.3.m1.6.6.2.2.4.3" xref="A1.SS6.1.p1.3.m1.6.6.2.2.4.3a.cmml">ref</mtext></msub><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.3" xref="A1.SS6.1.p1.3.m1.6.6.2.2.3.cmml">⁢</mo><mrow id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.cmml"><mo id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.2" stretchy="false" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.cmml"><mi id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.2" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.1" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.3" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.3" stretchy="false" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.3a" lspace="0.167em" xref="A1.SS6.1.p1.3.m1.6.6.2.2.3.cmml">⁢</mo><mrow id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.2.cmml"><mi id="A1.SS6.1.p1.3.m1.4.4" xref="A1.SS6.1.p1.3.m1.4.4.cmml">exp</mi><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1a" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.2.cmml">⁡</mo><mrow id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.2.cmml"><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.2" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.2.cmml">(</mo><mrow id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.cmml"><mfrac id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.cmml"><mn id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.2" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.2.cmml">1</mn><mi id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.3" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.1" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.3" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.3.cmml">r</mi><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.1a" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.2" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.1.cmml"><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.2.1" stretchy="false" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.1.cmml">(</mo><mi id="A1.SS6.1.p1.3.m1.2.2" xref="A1.SS6.1.p1.3.m1.2.2.cmml">x</mi><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.2.2" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.1.cmml">,</mo><mi id="A1.SS6.1.p1.3.m1.3.3" xref="A1.SS6.1.p1.3.m1.3.3.cmml">y</mi><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.2.3" stretchy="false" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.3" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.1.p1.3.m1.6b"><apply id="A1.SS6.1.p1.3.m1.6.6.cmml" xref="A1.SS6.1.p1.3.m1.6.6"><eq id="A1.SS6.1.p1.3.m1.6.6.3.cmml" xref="A1.SS6.1.p1.3.m1.6.6.3"></eq><apply id="A1.SS6.1.p1.3.m1.6.6.4.cmml" xref="A1.SS6.1.p1.3.m1.6.6.4"><times id="A1.SS6.1.p1.3.m1.6.6.4.1.cmml" xref="A1.SS6.1.p1.3.m1.6.6.4.1"></times><ci id="A1.SS6.1.p1.3.m1.6.6.4.2.cmml" xref="A1.SS6.1.p1.3.m1.6.6.4.2">𝑍</ci><ci id="A1.SS6.1.p1.3.m1.1.1.cmml" xref="A1.SS6.1.p1.3.m1.1.1">𝑥</ci></apply><apply id="A1.SS6.1.p1.3.m1.6.6.2.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2"><apply id="A1.SS6.1.p1.3.m1.6.6.2.3.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.3"><csymbol cd="ambiguous" id="A1.SS6.1.p1.3.m1.6.6.2.3.1.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.3">subscript</csymbol><sum id="A1.SS6.1.p1.3.m1.6.6.2.3.2.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.3.2"></sum><ci id="A1.SS6.1.p1.3.m1.6.6.2.3.3.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.3.3">𝑦</ci></apply><apply id="A1.SS6.1.p1.3.m1.6.6.2.2.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2"><times id="A1.SS6.1.p1.3.m1.6.6.2.2.3.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.3"></times><apply id="A1.SS6.1.p1.3.m1.6.6.2.2.4.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.4"><csymbol cd="ambiguous" id="A1.SS6.1.p1.3.m1.6.6.2.2.4.1.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.4">subscript</csymbol><ci id="A1.SS6.1.p1.3.m1.6.6.2.2.4.2.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.4.2">𝜋</ci><ci id="A1.SS6.1.p1.3.m1.6.6.2.2.4.3a.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.4.3"><mtext id="A1.SS6.1.p1.3.m1.6.6.2.2.4.3.cmml" mathsize="70%" xref="A1.SS6.1.p1.3.m1.6.6.2.2.4.3">ref</mtext></ci></apply><apply id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.cmml" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.3.cmml" xref="A1.SS6.1.p1.3.m1.5.5.1.1.1.1.1.3">𝑥</ci></apply><apply id="A1.SS6.1.p1.3.m1.6.6.2.2.2.2.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1"><exp id="A1.SS6.1.p1.3.m1.4.4.cmml" xref="A1.SS6.1.p1.3.m1.4.4"></exp><apply id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1"><times id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.1.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.1"></times><apply id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2"><divide id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.1.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2"></divide><cn id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.2.cmml" type="integer" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.2">1</cn><ci id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.3.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.2.3">𝛽</ci></apply><ci id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.3.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.3">𝑟</ci><interval closure="open" id="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.1.cmml" xref="A1.SS6.1.p1.3.m1.6.6.2.2.2.1.1.1.4.2"><ci id="A1.SS6.1.p1.3.m1.2.2.cmml" xref="A1.SS6.1.p1.3.m1.2.2">𝑥</ci><ci id="A1.SS6.1.p1.3.m1.3.3.cmml" xref="A1.SS6.1.p1.3.m1.3.3">𝑦</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.1.p1.3.m1.6c">Z(x)=\sum_{y}\pi_{\text{ref}}(y|x)\exp\left(\frac{1}{\beta}r(x,y)\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.1.p1.3.m1.6d">italic_Z ( italic_x ) = ∑ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_r ( italic_x , italic_y ) )</annotation></semantics></math> (notice that <math alttext="Z(x)" class="ltx_Math" display="inline" id="A1.SS6.1.p1.4.m2.1"><semantics id="A1.SS6.1.p1.4.m2.1a"><mrow id="A1.SS6.1.p1.4.m2.1.2" xref="A1.SS6.1.p1.4.m2.1.2.cmml"><mi id="A1.SS6.1.p1.4.m2.1.2.2" xref="A1.SS6.1.p1.4.m2.1.2.2.cmml">Z</mi><mo id="A1.SS6.1.p1.4.m2.1.2.1" xref="A1.SS6.1.p1.4.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS6.1.p1.4.m2.1.2.3.2" xref="A1.SS6.1.p1.4.m2.1.2.cmml"><mo id="A1.SS6.1.p1.4.m2.1.2.3.2.1" stretchy="false" xref="A1.SS6.1.p1.4.m2.1.2.cmml">(</mo><mi id="A1.SS6.1.p1.4.m2.1.1" xref="A1.SS6.1.p1.4.m2.1.1.cmml">x</mi><mo id="A1.SS6.1.p1.4.m2.1.2.3.2.2" stretchy="false" xref="A1.SS6.1.p1.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.1.p1.4.m2.1b"><apply id="A1.SS6.1.p1.4.m2.1.2.cmml" xref="A1.SS6.1.p1.4.m2.1.2"><times id="A1.SS6.1.p1.4.m2.1.2.1.cmml" xref="A1.SS6.1.p1.4.m2.1.2.1"></times><ci id="A1.SS6.1.p1.4.m2.1.2.2.cmml" xref="A1.SS6.1.p1.4.m2.1.2.2">𝑍</ci><ci id="A1.SS6.1.p1.4.m2.1.1.cmml" xref="A1.SS6.1.p1.4.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.1.p1.4.m2.1c">Z(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.1.p1.4.m2.1d">italic_Z ( italic_x )</annotation></semantics></math> also depends on the reward function <math alttext="r" class="ltx_Math" display="inline" id="A1.SS6.1.p1.5.m3.1"><semantics id="A1.SS6.1.p1.5.m3.1a"><mi id="A1.SS6.1.p1.5.m3.1.1" xref="A1.SS6.1.p1.5.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.1.p1.5.m3.1b"><ci id="A1.SS6.1.p1.5.m3.1.1.cmml" xref="A1.SS6.1.p1.5.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.1.p1.5.m3.1c">r</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.1.p1.5.m3.1d">italic_r</annotation></semantics></math>). Using the operator <math alttext="r^{\prime}(x,y)=f(r,\pi_{\text{ref}},\beta)(x,y)=r(x,y)-\beta\log Z(x)" class="ltx_Math" display="inline" id="A1.SS6.1.p1.6.m4.10"><semantics id="A1.SS6.1.p1.6.m4.10a"><mrow id="A1.SS6.1.p1.6.m4.10.10" xref="A1.SS6.1.p1.6.m4.10.10.cmml"><mrow id="A1.SS6.1.p1.6.m4.10.10.3" xref="A1.SS6.1.p1.6.m4.10.10.3.cmml"><msup id="A1.SS6.1.p1.6.m4.10.10.3.2" xref="A1.SS6.1.p1.6.m4.10.10.3.2.cmml"><mi id="A1.SS6.1.p1.6.m4.10.10.3.2.2" xref="A1.SS6.1.p1.6.m4.10.10.3.2.2.cmml">r</mi><mo id="A1.SS6.1.p1.6.m4.10.10.3.2.3" xref="A1.SS6.1.p1.6.m4.10.10.3.2.3.cmml">′</mo></msup><mo id="A1.SS6.1.p1.6.m4.10.10.3.1" xref="A1.SS6.1.p1.6.m4.10.10.3.1.cmml">⁢</mo><mrow id="A1.SS6.1.p1.6.m4.10.10.3.3.2" xref="A1.SS6.1.p1.6.m4.10.10.3.3.1.cmml"><mo id="A1.SS6.1.p1.6.m4.10.10.3.3.2.1" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.3.3.1.cmml">(</mo><mi id="A1.SS6.1.p1.6.m4.1.1" xref="A1.SS6.1.p1.6.m4.1.1.cmml">x</mi><mo id="A1.SS6.1.p1.6.m4.10.10.3.3.2.2" xref="A1.SS6.1.p1.6.m4.10.10.3.3.1.cmml">,</mo><mi id="A1.SS6.1.p1.6.m4.2.2" xref="A1.SS6.1.p1.6.m4.2.2.cmml">y</mi><mo id="A1.SS6.1.p1.6.m4.10.10.3.3.2.3" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.3.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.1.p1.6.m4.10.10.4" xref="A1.SS6.1.p1.6.m4.10.10.4.cmml">=</mo><mrow id="A1.SS6.1.p1.6.m4.10.10.1" xref="A1.SS6.1.p1.6.m4.10.10.1.cmml"><mi id="A1.SS6.1.p1.6.m4.10.10.1.3" xref="A1.SS6.1.p1.6.m4.10.10.1.3.cmml">f</mi><mo id="A1.SS6.1.p1.6.m4.10.10.1.2" xref="A1.SS6.1.p1.6.m4.10.10.1.2.cmml">⁢</mo><mrow id="A1.SS6.1.p1.6.m4.10.10.1.1.1" xref="A1.SS6.1.p1.6.m4.10.10.1.1.2.cmml"><mo id="A1.SS6.1.p1.6.m4.10.10.1.1.1.2" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.1.1.2.cmml">(</mo><mi id="A1.SS6.1.p1.6.m4.3.3" xref="A1.SS6.1.p1.6.m4.3.3.cmml">r</mi><mo id="A1.SS6.1.p1.6.m4.10.10.1.1.1.3" xref="A1.SS6.1.p1.6.m4.10.10.1.1.2.cmml">,</mo><msub id="A1.SS6.1.p1.6.m4.10.10.1.1.1.1" xref="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.cmml"><mi id="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.2" xref="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.2.cmml">π</mi><mtext id="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.3" xref="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.3a.cmml">ref</mtext></msub><mo id="A1.SS6.1.p1.6.m4.10.10.1.1.1.4" xref="A1.SS6.1.p1.6.m4.10.10.1.1.2.cmml">,</mo><mi id="A1.SS6.1.p1.6.m4.4.4" xref="A1.SS6.1.p1.6.m4.4.4.cmml">β</mi><mo id="A1.SS6.1.p1.6.m4.10.10.1.1.1.5" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.1.1.2.cmml">)</mo></mrow><mo id="A1.SS6.1.p1.6.m4.10.10.1.2a" xref="A1.SS6.1.p1.6.m4.10.10.1.2.cmml">⁢</mo><mrow id="A1.SS6.1.p1.6.m4.10.10.1.4.2" xref="A1.SS6.1.p1.6.m4.10.10.1.4.1.cmml"><mo id="A1.SS6.1.p1.6.m4.10.10.1.4.2.1" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.1.4.1.cmml">(</mo><mi id="A1.SS6.1.p1.6.m4.5.5" xref="A1.SS6.1.p1.6.m4.5.5.cmml">x</mi><mo id="A1.SS6.1.p1.6.m4.10.10.1.4.2.2" xref="A1.SS6.1.p1.6.m4.10.10.1.4.1.cmml">,</mo><mi id="A1.SS6.1.p1.6.m4.6.6" xref="A1.SS6.1.p1.6.m4.6.6.cmml">y</mi><mo id="A1.SS6.1.p1.6.m4.10.10.1.4.2.3" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.1.p1.6.m4.10.10.5" xref="A1.SS6.1.p1.6.m4.10.10.5.cmml">=</mo><mrow id="A1.SS6.1.p1.6.m4.10.10.6" xref="A1.SS6.1.p1.6.m4.10.10.6.cmml"><mrow id="A1.SS6.1.p1.6.m4.10.10.6.2" xref="A1.SS6.1.p1.6.m4.10.10.6.2.cmml"><mi id="A1.SS6.1.p1.6.m4.10.10.6.2.2" xref="A1.SS6.1.p1.6.m4.10.10.6.2.2.cmml">r</mi><mo id="A1.SS6.1.p1.6.m4.10.10.6.2.1" xref="A1.SS6.1.p1.6.m4.10.10.6.2.1.cmml">⁢</mo><mrow id="A1.SS6.1.p1.6.m4.10.10.6.2.3.2" xref="A1.SS6.1.p1.6.m4.10.10.6.2.3.1.cmml"><mo id="A1.SS6.1.p1.6.m4.10.10.6.2.3.2.1" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.6.2.3.1.cmml">(</mo><mi id="A1.SS6.1.p1.6.m4.7.7" xref="A1.SS6.1.p1.6.m4.7.7.cmml">x</mi><mo id="A1.SS6.1.p1.6.m4.10.10.6.2.3.2.2" xref="A1.SS6.1.p1.6.m4.10.10.6.2.3.1.cmml">,</mo><mi id="A1.SS6.1.p1.6.m4.8.8" xref="A1.SS6.1.p1.6.m4.8.8.cmml">y</mi><mo id="A1.SS6.1.p1.6.m4.10.10.6.2.3.2.3" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.6.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.1.p1.6.m4.10.10.6.1" xref="A1.SS6.1.p1.6.m4.10.10.6.1.cmml">−</mo><mrow id="A1.SS6.1.p1.6.m4.10.10.6.3" xref="A1.SS6.1.p1.6.m4.10.10.6.3.cmml"><mi id="A1.SS6.1.p1.6.m4.10.10.6.3.2" xref="A1.SS6.1.p1.6.m4.10.10.6.3.2.cmml">β</mi><mo id="A1.SS6.1.p1.6.m4.10.10.6.3.1" lspace="0.167em" xref="A1.SS6.1.p1.6.m4.10.10.6.3.1.cmml">⁢</mo><mrow id="A1.SS6.1.p1.6.m4.10.10.6.3.3" xref="A1.SS6.1.p1.6.m4.10.10.6.3.3.cmml"><mi id="A1.SS6.1.p1.6.m4.10.10.6.3.3.1" xref="A1.SS6.1.p1.6.m4.10.10.6.3.3.1.cmml">log</mi><mo id="A1.SS6.1.p1.6.m4.10.10.6.3.3a" lspace="0.167em" xref="A1.SS6.1.p1.6.m4.10.10.6.3.3.cmml">⁡</mo><mi id="A1.SS6.1.p1.6.m4.10.10.6.3.3.2" xref="A1.SS6.1.p1.6.m4.10.10.6.3.3.2.cmml">Z</mi></mrow><mo id="A1.SS6.1.p1.6.m4.10.10.6.3.1a" xref="A1.SS6.1.p1.6.m4.10.10.6.3.1.cmml">⁢</mo><mrow id="A1.SS6.1.p1.6.m4.10.10.6.3.4.2" xref="A1.SS6.1.p1.6.m4.10.10.6.3.cmml"><mo id="A1.SS6.1.p1.6.m4.10.10.6.3.4.2.1" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.6.3.cmml">(</mo><mi id="A1.SS6.1.p1.6.m4.9.9" xref="A1.SS6.1.p1.6.m4.9.9.cmml">x</mi><mo id="A1.SS6.1.p1.6.m4.10.10.6.3.4.2.2" stretchy="false" xref="A1.SS6.1.p1.6.m4.10.10.6.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.1.p1.6.m4.10b"><apply id="A1.SS6.1.p1.6.m4.10.10.cmml" xref="A1.SS6.1.p1.6.m4.10.10"><and id="A1.SS6.1.p1.6.m4.10.10a.cmml" xref="A1.SS6.1.p1.6.m4.10.10"></and><apply id="A1.SS6.1.p1.6.m4.10.10b.cmml" xref="A1.SS6.1.p1.6.m4.10.10"><eq id="A1.SS6.1.p1.6.m4.10.10.4.cmml" xref="A1.SS6.1.p1.6.m4.10.10.4"></eq><apply id="A1.SS6.1.p1.6.m4.10.10.3.cmml" xref="A1.SS6.1.p1.6.m4.10.10.3"><times id="A1.SS6.1.p1.6.m4.10.10.3.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.3.1"></times><apply id="A1.SS6.1.p1.6.m4.10.10.3.2.cmml" xref="A1.SS6.1.p1.6.m4.10.10.3.2"><csymbol cd="ambiguous" id="A1.SS6.1.p1.6.m4.10.10.3.2.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.3.2">superscript</csymbol><ci id="A1.SS6.1.p1.6.m4.10.10.3.2.2.cmml" xref="A1.SS6.1.p1.6.m4.10.10.3.2.2">𝑟</ci><ci id="A1.SS6.1.p1.6.m4.10.10.3.2.3.cmml" xref="A1.SS6.1.p1.6.m4.10.10.3.2.3">′</ci></apply><interval closure="open" id="A1.SS6.1.p1.6.m4.10.10.3.3.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.3.3.2"><ci id="A1.SS6.1.p1.6.m4.1.1.cmml" xref="A1.SS6.1.p1.6.m4.1.1">𝑥</ci><ci id="A1.SS6.1.p1.6.m4.2.2.cmml" xref="A1.SS6.1.p1.6.m4.2.2">𝑦</ci></interval></apply><apply id="A1.SS6.1.p1.6.m4.10.10.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.1"><times id="A1.SS6.1.p1.6.m4.10.10.1.2.cmml" xref="A1.SS6.1.p1.6.m4.10.10.1.2"></times><ci id="A1.SS6.1.p1.6.m4.10.10.1.3.cmml" xref="A1.SS6.1.p1.6.m4.10.10.1.3">𝑓</ci><vector id="A1.SS6.1.p1.6.m4.10.10.1.1.2.cmml" xref="A1.SS6.1.p1.6.m4.10.10.1.1.1"><ci id="A1.SS6.1.p1.6.m4.3.3.cmml" xref="A1.SS6.1.p1.6.m4.3.3">𝑟</ci><apply id="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.1.1.1.1">subscript</csymbol><ci id="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.2.cmml" xref="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.2">𝜋</ci><ci id="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.3a.cmml" xref="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.3"><mtext id="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.3.cmml" mathsize="70%" xref="A1.SS6.1.p1.6.m4.10.10.1.1.1.1.3">ref</mtext></ci></apply><ci id="A1.SS6.1.p1.6.m4.4.4.cmml" xref="A1.SS6.1.p1.6.m4.4.4">𝛽</ci></vector><interval closure="open" id="A1.SS6.1.p1.6.m4.10.10.1.4.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.1.4.2"><ci id="A1.SS6.1.p1.6.m4.5.5.cmml" xref="A1.SS6.1.p1.6.m4.5.5">𝑥</ci><ci id="A1.SS6.1.p1.6.m4.6.6.cmml" xref="A1.SS6.1.p1.6.m4.6.6">𝑦</ci></interval></apply></apply><apply id="A1.SS6.1.p1.6.m4.10.10c.cmml" xref="A1.SS6.1.p1.6.m4.10.10"><eq id="A1.SS6.1.p1.6.m4.10.10.5.cmml" xref="A1.SS6.1.p1.6.m4.10.10.5"></eq><share href="#A1.SS6.1.p1.6.m4.10.10.1.cmml" id="A1.SS6.1.p1.6.m4.10.10d.cmml" xref="A1.SS6.1.p1.6.m4.10.10"></share><apply id="A1.SS6.1.p1.6.m4.10.10.6.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6"><minus id="A1.SS6.1.p1.6.m4.10.10.6.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.1"></minus><apply id="A1.SS6.1.p1.6.m4.10.10.6.2.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.2"><times id="A1.SS6.1.p1.6.m4.10.10.6.2.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.2.1"></times><ci id="A1.SS6.1.p1.6.m4.10.10.6.2.2.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.2.2">𝑟</ci><interval closure="open" id="A1.SS6.1.p1.6.m4.10.10.6.2.3.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.2.3.2"><ci id="A1.SS6.1.p1.6.m4.7.7.cmml" xref="A1.SS6.1.p1.6.m4.7.7">𝑥</ci><ci id="A1.SS6.1.p1.6.m4.8.8.cmml" xref="A1.SS6.1.p1.6.m4.8.8">𝑦</ci></interval></apply><apply id="A1.SS6.1.p1.6.m4.10.10.6.3.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.3"><times id="A1.SS6.1.p1.6.m4.10.10.6.3.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.3.1"></times><ci id="A1.SS6.1.p1.6.m4.10.10.6.3.2.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.3.2">𝛽</ci><apply id="A1.SS6.1.p1.6.m4.10.10.6.3.3.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.3.3"><log id="A1.SS6.1.p1.6.m4.10.10.6.3.3.1.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.3.3.1"></log><ci id="A1.SS6.1.p1.6.m4.10.10.6.3.3.2.cmml" xref="A1.SS6.1.p1.6.m4.10.10.6.3.3.2">𝑍</ci></apply><ci id="A1.SS6.1.p1.6.m4.9.9.cmml" xref="A1.SS6.1.p1.6.m4.9.9">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.1.p1.6.m4.10c">r^{\prime}(x,y)=f(r,\pi_{\text{ref}},\beta)(x,y)=r(x,y)-\beta\log Z(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.1.p1.6.m4.10d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_f ( italic_r , italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT , italic_β ) ( italic_x , italic_y ) = italic_r ( italic_x , italic_y ) - italic_β roman_log italic_Z ( italic_x )</annotation></semantics></math>, we see that this new reward function is within the equivalence class of <math alttext="r" class="ltx_Math" display="inline" id="A1.SS6.1.p1.7.m5.1"><semantics id="A1.SS6.1.p1.7.m5.1a"><mi id="A1.SS6.1.p1.7.m5.1.1" xref="A1.SS6.1.p1.7.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.1.p1.7.m5.1b"><ci id="A1.SS6.1.p1.7.m5.1.1.cmml" xref="A1.SS6.1.p1.7.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.1.p1.7.m5.1c">r</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.1.p1.7.m5.1d">italic_r</annotation></semantics></math> and, we have: </p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r^{\prime}(x,y)=\beta\log\frac{\pi_{r}(y|x)}{\pi_{\text{ref}}(y|x)}" class="ltx_Math" display="block" id="A1.Ex20.m1.4"><semantics id="A1.Ex20.m1.4a"><mrow id="A1.Ex20.m1.4.5" xref="A1.Ex20.m1.4.5.cmml"><mrow id="A1.Ex20.m1.4.5.2" xref="A1.Ex20.m1.4.5.2.cmml"><msup id="A1.Ex20.m1.4.5.2.2" xref="A1.Ex20.m1.4.5.2.2.cmml"><mi id="A1.Ex20.m1.4.5.2.2.2" xref="A1.Ex20.m1.4.5.2.2.2.cmml">r</mi><mo id="A1.Ex20.m1.4.5.2.2.3" xref="A1.Ex20.m1.4.5.2.2.3.cmml">′</mo></msup><mo id="A1.Ex20.m1.4.5.2.1" xref="A1.Ex20.m1.4.5.2.1.cmml">⁢</mo><mrow id="A1.Ex20.m1.4.5.2.3.2" xref="A1.Ex20.m1.4.5.2.3.1.cmml"><mo id="A1.Ex20.m1.4.5.2.3.2.1" stretchy="false" xref="A1.Ex20.m1.4.5.2.3.1.cmml">(</mo><mi id="A1.Ex20.m1.3.3" xref="A1.Ex20.m1.3.3.cmml">x</mi><mo id="A1.Ex20.m1.4.5.2.3.2.2" xref="A1.Ex20.m1.4.5.2.3.1.cmml">,</mo><mi id="A1.Ex20.m1.4.4" xref="A1.Ex20.m1.4.4.cmml">y</mi><mo id="A1.Ex20.m1.4.5.2.3.2.3" stretchy="false" xref="A1.Ex20.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex20.m1.4.5.1" xref="A1.Ex20.m1.4.5.1.cmml">=</mo><mrow id="A1.Ex20.m1.4.5.3" xref="A1.Ex20.m1.4.5.3.cmml"><mi id="A1.Ex20.m1.4.5.3.2" xref="A1.Ex20.m1.4.5.3.2.cmml">β</mi><mo id="A1.Ex20.m1.4.5.3.1" lspace="0.167em" xref="A1.Ex20.m1.4.5.3.1.cmml">⁢</mo><mrow id="A1.Ex20.m1.4.5.3.3" xref="A1.Ex20.m1.4.5.3.3.cmml"><mi id="A1.Ex20.m1.4.5.3.3.1" xref="A1.Ex20.m1.4.5.3.3.1.cmml">log</mi><mo id="A1.Ex20.m1.4.5.3.3a" lspace="0.167em" xref="A1.Ex20.m1.4.5.3.3.cmml">⁡</mo><mfrac id="A1.Ex20.m1.2.2" xref="A1.Ex20.m1.2.2.cmml"><mrow id="A1.Ex20.m1.1.1.1" xref="A1.Ex20.m1.1.1.1.cmml"><msub id="A1.Ex20.m1.1.1.1.3" xref="A1.Ex20.m1.1.1.1.3.cmml"><mi id="A1.Ex20.m1.1.1.1.3.2" xref="A1.Ex20.m1.1.1.1.3.2.cmml">π</mi><mi id="A1.Ex20.m1.1.1.1.3.3" xref="A1.Ex20.m1.1.1.1.3.3.cmml">r</mi></msub><mo id="A1.Ex20.m1.1.1.1.2" xref="A1.Ex20.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex20.m1.1.1.1.1.1" xref="A1.Ex20.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex20.m1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex20.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex20.m1.1.1.1.1.1.1" xref="A1.Ex20.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex20.m1.1.1.1.1.1.1.2" xref="A1.Ex20.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex20.m1.1.1.1.1.1.1.1" xref="A1.Ex20.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex20.m1.1.1.1.1.1.1.3" xref="A1.Ex20.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex20.m1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex20.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex20.m1.2.2.2" xref="A1.Ex20.m1.2.2.2.cmml"><msub id="A1.Ex20.m1.2.2.2.3" xref="A1.Ex20.m1.2.2.2.3.cmml"><mi id="A1.Ex20.m1.2.2.2.3.2" xref="A1.Ex20.m1.2.2.2.3.2.cmml">π</mi><mtext id="A1.Ex20.m1.2.2.2.3.3" xref="A1.Ex20.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex20.m1.2.2.2.2" xref="A1.Ex20.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.Ex20.m1.2.2.2.1.1" xref="A1.Ex20.m1.2.2.2.1.1.1.cmml"><mo id="A1.Ex20.m1.2.2.2.1.1.2" stretchy="false" xref="A1.Ex20.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex20.m1.2.2.2.1.1.1" xref="A1.Ex20.m1.2.2.2.1.1.1.cmml"><mi id="A1.Ex20.m1.2.2.2.1.1.1.2" xref="A1.Ex20.m1.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex20.m1.2.2.2.1.1.1.1" xref="A1.Ex20.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex20.m1.2.2.2.1.1.1.3" xref="A1.Ex20.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex20.m1.2.2.2.1.1.3" stretchy="false" xref="A1.Ex20.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex20.m1.4b"><apply id="A1.Ex20.m1.4.5.cmml" xref="A1.Ex20.m1.4.5"><eq id="A1.Ex20.m1.4.5.1.cmml" xref="A1.Ex20.m1.4.5.1"></eq><apply id="A1.Ex20.m1.4.5.2.cmml" xref="A1.Ex20.m1.4.5.2"><times id="A1.Ex20.m1.4.5.2.1.cmml" xref="A1.Ex20.m1.4.5.2.1"></times><apply id="A1.Ex20.m1.4.5.2.2.cmml" xref="A1.Ex20.m1.4.5.2.2"><csymbol cd="ambiguous" id="A1.Ex20.m1.4.5.2.2.1.cmml" xref="A1.Ex20.m1.4.5.2.2">superscript</csymbol><ci id="A1.Ex20.m1.4.5.2.2.2.cmml" xref="A1.Ex20.m1.4.5.2.2.2">𝑟</ci><ci id="A1.Ex20.m1.4.5.2.2.3.cmml" xref="A1.Ex20.m1.4.5.2.2.3">′</ci></apply><interval closure="open" id="A1.Ex20.m1.4.5.2.3.1.cmml" xref="A1.Ex20.m1.4.5.2.3.2"><ci id="A1.Ex20.m1.3.3.cmml" xref="A1.Ex20.m1.3.3">𝑥</ci><ci id="A1.Ex20.m1.4.4.cmml" xref="A1.Ex20.m1.4.4">𝑦</ci></interval></apply><apply id="A1.Ex20.m1.4.5.3.cmml" xref="A1.Ex20.m1.4.5.3"><times id="A1.Ex20.m1.4.5.3.1.cmml" xref="A1.Ex20.m1.4.5.3.1"></times><ci id="A1.Ex20.m1.4.5.3.2.cmml" xref="A1.Ex20.m1.4.5.3.2">𝛽</ci><apply id="A1.Ex20.m1.4.5.3.3.cmml" xref="A1.Ex20.m1.4.5.3.3"><log id="A1.Ex20.m1.4.5.3.3.1.cmml" xref="A1.Ex20.m1.4.5.3.3.1"></log><apply id="A1.Ex20.m1.2.2.cmml" xref="A1.Ex20.m1.2.2"><divide id="A1.Ex20.m1.2.2.3.cmml" xref="A1.Ex20.m1.2.2"></divide><apply id="A1.Ex20.m1.1.1.1.cmml" xref="A1.Ex20.m1.1.1.1"><times id="A1.Ex20.m1.1.1.1.2.cmml" xref="A1.Ex20.m1.1.1.1.2"></times><apply id="A1.Ex20.m1.1.1.1.3.cmml" xref="A1.Ex20.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex20.m1.1.1.1.3.1.cmml" xref="A1.Ex20.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex20.m1.1.1.1.3.2.cmml" xref="A1.Ex20.m1.1.1.1.3.2">𝜋</ci><ci id="A1.Ex20.m1.1.1.1.3.3.cmml" xref="A1.Ex20.m1.1.1.1.3.3">𝑟</ci></apply><apply id="A1.Ex20.m1.1.1.1.1.1.1.cmml" xref="A1.Ex20.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex20.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex20.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex20.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex20.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex20.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex20.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex20.m1.2.2.2.cmml" xref="A1.Ex20.m1.2.2.2"><times id="A1.Ex20.m1.2.2.2.2.cmml" xref="A1.Ex20.m1.2.2.2.2"></times><apply id="A1.Ex20.m1.2.2.2.3.cmml" xref="A1.Ex20.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex20.m1.2.2.2.3.1.cmml" xref="A1.Ex20.m1.2.2.2.3">subscript</csymbol><ci id="A1.Ex20.m1.2.2.2.3.2.cmml" xref="A1.Ex20.m1.2.2.2.3.2">𝜋</ci><ci id="A1.Ex20.m1.2.2.2.3.3a.cmml" xref="A1.Ex20.m1.2.2.2.3.3"><mtext id="A1.Ex20.m1.2.2.2.3.3.cmml" mathsize="70%" xref="A1.Ex20.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex20.m1.2.2.2.1.1.1.cmml" xref="A1.Ex20.m1.2.2.2.1.1"><csymbol cd="latexml" id="A1.Ex20.m1.2.2.2.1.1.1.1.cmml" xref="A1.Ex20.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex20.m1.2.2.2.1.1.1.2.cmml" xref="A1.Ex20.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.Ex20.m1.2.2.2.1.1.1.3.cmml" xref="A1.Ex20.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex20.m1.4c">r^{\prime}(x,y)=\beta\log\frac{\pi_{r}(y|x)}{\pi_{\text{ref}}(y|x)}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex20.m1.4d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS6.2.p2">
<p class="ltx_p" id="A1.SS6.2.p2.1">그것은 증명을 완성한다. ∎</p>
</div>
</div>
<div class="ltx_para" id="A1.SS6.p3">
<p class="ltx_p" id="A1.SS6.p3.2">우리는 이러한 결과에 대해 더 확장할 수 있습니다. <math alttext="r" class="ltx_Math" display="inline" id="A1.SS6.p3.1.m1.1"><semantics id="A1.SS6.p3.1.m1.1a"><mi id="A1.SS6.p3.1.m1.1.1" xref="A1.SS6.p3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.p3.1.m1.1b"><ci id="A1.SS6.p3.1.m1.1.1.cmml" xref="A1.SS6.p3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p3.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p3.1.m1.1d">italic_r</annotation></semantics></math>와 <math alttext="r^{\prime}" class="ltx_Math" display="inline" id="A1.SS6.p3.2.m2.1"><semantics id="A1.SS6.p3.2.m2.1a"><msup id="A1.SS6.p3.2.m2.1.1" xref="A1.SS6.p3.2.m2.1.1.cmml"><mi id="A1.SS6.p3.2.m2.1.1.2" xref="A1.SS6.p3.2.m2.1.1.2.cmml">r</mi><mo id="A1.SS6.p3.2.m2.1.1.3" xref="A1.SS6.p3.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS6.p3.2.m2.1b"><apply id="A1.SS6.p3.2.m2.1.1.cmml" xref="A1.SS6.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS6.p3.2.m2.1.1.1.cmml" xref="A1.SS6.p3.2.m2.1.1">superscript</csymbol><ci id="A1.SS6.p3.2.m2.1.1.2.cmml" xref="A1.SS6.p3.2.m2.1.1.2">𝑟</ci><ci id="A1.SS6.p3.2.m2.1.1.3.cmml" xref="A1.SS6.p3.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p3.2.m2.1c">r^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p3.2.m2.1d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>가 같은 클래스에서 두 개의 보상 함수라면, 그러면</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(r,\pi_{\text{ref}},\beta)(x,y)=\beta\log\frac{\pi_{r}(y|x)}{\pi_{\text{ref}}%
(y|x)}=\beta\log\frac{\pi_{r}^{\prime}(y|x)}{\pi_{\text{ref}}(y|x)}=f(r^{%
\prime},\pi_{\text{ref}},\beta)(x,y)" class="ltx_Math" display="block" id="A1.Ex21.m1.14"><semantics id="A1.Ex21.m1.14a"><mrow id="A1.Ex21.m1.14.14" xref="A1.Ex21.m1.14.14.cmml"><mrow id="A1.Ex21.m1.12.12.1" xref="A1.Ex21.m1.12.12.1.cmml"><mi id="A1.Ex21.m1.12.12.1.3" xref="A1.Ex21.m1.12.12.1.3.cmml">f</mi><mo id="A1.Ex21.m1.12.12.1.2" xref="A1.Ex21.m1.12.12.1.2.cmml">⁢</mo><mrow id="A1.Ex21.m1.12.12.1.1.1" xref="A1.Ex21.m1.12.12.1.1.2.cmml"><mo id="A1.Ex21.m1.12.12.1.1.1.2" stretchy="false" xref="A1.Ex21.m1.12.12.1.1.2.cmml">(</mo><mi id="A1.Ex21.m1.5.5" xref="A1.Ex21.m1.5.5.cmml">r</mi><mo id="A1.Ex21.m1.12.12.1.1.1.3" xref="A1.Ex21.m1.12.12.1.1.2.cmml">,</mo><msub id="A1.Ex21.m1.12.12.1.1.1.1" xref="A1.Ex21.m1.12.12.1.1.1.1.cmml"><mi id="A1.Ex21.m1.12.12.1.1.1.1.2" xref="A1.Ex21.m1.12.12.1.1.1.1.2.cmml">π</mi><mtext id="A1.Ex21.m1.12.12.1.1.1.1.3" xref="A1.Ex21.m1.12.12.1.1.1.1.3a.cmml">ref</mtext></msub><mo id="A1.Ex21.m1.12.12.1.1.1.4" xref="A1.Ex21.m1.12.12.1.1.2.cmml">,</mo><mi id="A1.Ex21.m1.6.6" xref="A1.Ex21.m1.6.6.cmml">β</mi><mo id="A1.Ex21.m1.12.12.1.1.1.5" stretchy="false" xref="A1.Ex21.m1.12.12.1.1.2.cmml">)</mo></mrow><mo id="A1.Ex21.m1.12.12.1.2a" xref="A1.Ex21.m1.12.12.1.2.cmml">⁢</mo><mrow id="A1.Ex21.m1.12.12.1.4.2" xref="A1.Ex21.m1.12.12.1.4.1.cmml"><mo id="A1.Ex21.m1.12.12.1.4.2.1" stretchy="false" xref="A1.Ex21.m1.12.12.1.4.1.cmml">(</mo><mi id="A1.Ex21.m1.7.7" xref="A1.Ex21.m1.7.7.cmml">x</mi><mo id="A1.Ex21.m1.12.12.1.4.2.2" xref="A1.Ex21.m1.12.12.1.4.1.cmml">,</mo><mi id="A1.Ex21.m1.8.8" xref="A1.Ex21.m1.8.8.cmml">y</mi><mo id="A1.Ex21.m1.12.12.1.4.2.3" stretchy="false" xref="A1.Ex21.m1.12.12.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex21.m1.14.14.5" xref="A1.Ex21.m1.14.14.5.cmml">=</mo><mrow id="A1.Ex21.m1.14.14.6" xref="A1.Ex21.m1.14.14.6.cmml"><mi id="A1.Ex21.m1.14.14.6.2" xref="A1.Ex21.m1.14.14.6.2.cmml">β</mi><mo id="A1.Ex21.m1.14.14.6.1" lspace="0.167em" xref="A1.Ex21.m1.14.14.6.1.cmml">⁢</mo><mrow id="A1.Ex21.m1.14.14.6.3" xref="A1.Ex21.m1.14.14.6.3.cmml"><mi id="A1.Ex21.m1.14.14.6.3.1" xref="A1.Ex21.m1.14.14.6.3.1.cmml">log</mi><mo id="A1.Ex21.m1.14.14.6.3a" lspace="0.167em" xref="A1.Ex21.m1.14.14.6.3.cmml">⁡</mo><mfrac id="A1.Ex21.m1.2.2" xref="A1.Ex21.m1.2.2.cmml"><mrow id="A1.Ex21.m1.1.1.1" xref="A1.Ex21.m1.1.1.1.cmml"><msub id="A1.Ex21.m1.1.1.1.3" xref="A1.Ex21.m1.1.1.1.3.cmml"><mi id="A1.Ex21.m1.1.1.1.3.2" xref="A1.Ex21.m1.1.1.1.3.2.cmml">π</mi><mi id="A1.Ex21.m1.1.1.1.3.3" xref="A1.Ex21.m1.1.1.1.3.3.cmml">r</mi></msub><mo id="A1.Ex21.m1.1.1.1.2" xref="A1.Ex21.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex21.m1.1.1.1.1.1" xref="A1.Ex21.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex21.m1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex21.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex21.m1.1.1.1.1.1.1" xref="A1.Ex21.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex21.m1.1.1.1.1.1.1.2" xref="A1.Ex21.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex21.m1.1.1.1.1.1.1.1" xref="A1.Ex21.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex21.m1.1.1.1.1.1.1.3" xref="A1.Ex21.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex21.m1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex21.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex21.m1.2.2.2" xref="A1.Ex21.m1.2.2.2.cmml"><msub id="A1.Ex21.m1.2.2.2.3" xref="A1.Ex21.m1.2.2.2.3.cmml"><mi id="A1.Ex21.m1.2.2.2.3.2" xref="A1.Ex21.m1.2.2.2.3.2.cmml">π</mi><mtext id="A1.Ex21.m1.2.2.2.3.3" xref="A1.Ex21.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex21.m1.2.2.2.2" xref="A1.Ex21.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.Ex21.m1.2.2.2.1.1" xref="A1.Ex21.m1.2.2.2.1.1.1.cmml"><mo id="A1.Ex21.m1.2.2.2.1.1.2" stretchy="false" xref="A1.Ex21.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex21.m1.2.2.2.1.1.1" xref="A1.Ex21.m1.2.2.2.1.1.1.cmml"><mi id="A1.Ex21.m1.2.2.2.1.1.1.2" xref="A1.Ex21.m1.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex21.m1.2.2.2.1.1.1.1" xref="A1.Ex21.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex21.m1.2.2.2.1.1.1.3" xref="A1.Ex21.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex21.m1.2.2.2.1.1.3" stretchy="false" xref="A1.Ex21.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex21.m1.14.14.7" xref="A1.Ex21.m1.14.14.7.cmml">=</mo><mrow id="A1.Ex21.m1.14.14.8" xref="A1.Ex21.m1.14.14.8.cmml"><mi id="A1.Ex21.m1.14.14.8.2" xref="A1.Ex21.m1.14.14.8.2.cmml">β</mi><mo id="A1.Ex21.m1.14.14.8.1" lspace="0.167em" xref="A1.Ex21.m1.14.14.8.1.cmml">⁢</mo><mrow id="A1.Ex21.m1.14.14.8.3" xref="A1.Ex21.m1.14.14.8.3.cmml"><mi id="A1.Ex21.m1.14.14.8.3.1" xref="A1.Ex21.m1.14.14.8.3.1.cmml">log</mi><mo id="A1.Ex21.m1.14.14.8.3a" lspace="0.167em" xref="A1.Ex21.m1.14.14.8.3.cmml">⁡</mo><mfrac id="A1.Ex21.m1.4.4" xref="A1.Ex21.m1.4.4.cmml"><mrow id="A1.Ex21.m1.3.3.1" xref="A1.Ex21.m1.3.3.1.cmml"><msubsup id="A1.Ex21.m1.3.3.1.3" xref="A1.Ex21.m1.3.3.1.3.cmml"><mi id="A1.Ex21.m1.3.3.1.3.2.2" xref="A1.Ex21.m1.3.3.1.3.2.2.cmml">π</mi><mi id="A1.Ex21.m1.3.3.1.3.2.3" xref="A1.Ex21.m1.3.3.1.3.2.3.cmml">r</mi><mo id="A1.Ex21.m1.3.3.1.3.3" xref="A1.Ex21.m1.3.3.1.3.3.cmml">′</mo></msubsup><mo id="A1.Ex21.m1.3.3.1.2" xref="A1.Ex21.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.Ex21.m1.3.3.1.1.1" xref="A1.Ex21.m1.3.3.1.1.1.1.cmml"><mo id="A1.Ex21.m1.3.3.1.1.1.2" stretchy="false" xref="A1.Ex21.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.Ex21.m1.3.3.1.1.1.1" xref="A1.Ex21.m1.3.3.1.1.1.1.cmml"><mi id="A1.Ex21.m1.3.3.1.1.1.1.2" xref="A1.Ex21.m1.3.3.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex21.m1.3.3.1.1.1.1.1" xref="A1.Ex21.m1.3.3.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex21.m1.3.3.1.1.1.1.3" xref="A1.Ex21.m1.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex21.m1.3.3.1.1.1.3" stretchy="false" xref="A1.Ex21.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex21.m1.4.4.2" xref="A1.Ex21.m1.4.4.2.cmml"><msub id="A1.Ex21.m1.4.4.2.3" xref="A1.Ex21.m1.4.4.2.3.cmml"><mi id="A1.Ex21.m1.4.4.2.3.2" xref="A1.Ex21.m1.4.4.2.3.2.cmml">π</mi><mtext id="A1.Ex21.m1.4.4.2.3.3" xref="A1.Ex21.m1.4.4.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex21.m1.4.4.2.2" xref="A1.Ex21.m1.4.4.2.2.cmml">⁢</mo><mrow id="A1.Ex21.m1.4.4.2.1.1" xref="A1.Ex21.m1.4.4.2.1.1.1.cmml"><mo id="A1.Ex21.m1.4.4.2.1.1.2" stretchy="false" xref="A1.Ex21.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="A1.Ex21.m1.4.4.2.1.1.1" xref="A1.Ex21.m1.4.4.2.1.1.1.cmml"><mi id="A1.Ex21.m1.4.4.2.1.1.1.2" xref="A1.Ex21.m1.4.4.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex21.m1.4.4.2.1.1.1.1" xref="A1.Ex21.m1.4.4.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex21.m1.4.4.2.1.1.1.3" xref="A1.Ex21.m1.4.4.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex21.m1.4.4.2.1.1.3" stretchy="false" xref="A1.Ex21.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex21.m1.14.14.9" xref="A1.Ex21.m1.14.14.9.cmml">=</mo><mrow id="A1.Ex21.m1.14.14.3" xref="A1.Ex21.m1.14.14.3.cmml"><mi id="A1.Ex21.m1.14.14.3.4" xref="A1.Ex21.m1.14.14.3.4.cmml">f</mi><mo id="A1.Ex21.m1.14.14.3.3" xref="A1.Ex21.m1.14.14.3.3.cmml">⁢</mo><mrow id="A1.Ex21.m1.14.14.3.2.2" xref="A1.Ex21.m1.14.14.3.2.3.cmml"><mo id="A1.Ex21.m1.14.14.3.2.2.3" stretchy="false" xref="A1.Ex21.m1.14.14.3.2.3.cmml">(</mo><msup id="A1.Ex21.m1.13.13.2.1.1.1" xref="A1.Ex21.m1.13.13.2.1.1.1.cmml"><mi id="A1.Ex21.m1.13.13.2.1.1.1.2" xref="A1.Ex21.m1.13.13.2.1.1.1.2.cmml">r</mi><mo id="A1.Ex21.m1.13.13.2.1.1.1.3" xref="A1.Ex21.m1.13.13.2.1.1.1.3.cmml">′</mo></msup><mo id="A1.Ex21.m1.14.14.3.2.2.4" xref="A1.Ex21.m1.14.14.3.2.3.cmml">,</mo><msub id="A1.Ex21.m1.14.14.3.2.2.2" xref="A1.Ex21.m1.14.14.3.2.2.2.cmml"><mi id="A1.Ex21.m1.14.14.3.2.2.2.2" xref="A1.Ex21.m1.14.14.3.2.2.2.2.cmml">π</mi><mtext id="A1.Ex21.m1.14.14.3.2.2.2.3" xref="A1.Ex21.m1.14.14.3.2.2.2.3a.cmml">ref</mtext></msub><mo id="A1.Ex21.m1.14.14.3.2.2.5" xref="A1.Ex21.m1.14.14.3.2.3.cmml">,</mo><mi id="A1.Ex21.m1.9.9" xref="A1.Ex21.m1.9.9.cmml">β</mi><mo id="A1.Ex21.m1.14.14.3.2.2.6" stretchy="false" xref="A1.Ex21.m1.14.14.3.2.3.cmml">)</mo></mrow><mo id="A1.Ex21.m1.14.14.3.3a" xref="A1.Ex21.m1.14.14.3.3.cmml">⁢</mo><mrow id="A1.Ex21.m1.14.14.3.5.2" xref="A1.Ex21.m1.14.14.3.5.1.cmml"><mo id="A1.Ex21.m1.14.14.3.5.2.1" stretchy="false" xref="A1.Ex21.m1.14.14.3.5.1.cmml">(</mo><mi id="A1.Ex21.m1.10.10" xref="A1.Ex21.m1.10.10.cmml">x</mi><mo id="A1.Ex21.m1.14.14.3.5.2.2" xref="A1.Ex21.m1.14.14.3.5.1.cmml">,</mo><mi id="A1.Ex21.m1.11.11" xref="A1.Ex21.m1.11.11.cmml">y</mi><mo id="A1.Ex21.m1.14.14.3.5.2.3" stretchy="false" xref="A1.Ex21.m1.14.14.3.5.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex21.m1.14b"><apply id="A1.Ex21.m1.14.14.cmml" xref="A1.Ex21.m1.14.14"><and id="A1.Ex21.m1.14.14a.cmml" xref="A1.Ex21.m1.14.14"></and><apply id="A1.Ex21.m1.14.14b.cmml" xref="A1.Ex21.m1.14.14"><eq id="A1.Ex21.m1.14.14.5.cmml" xref="A1.Ex21.m1.14.14.5"></eq><apply id="A1.Ex21.m1.12.12.1.cmml" xref="A1.Ex21.m1.12.12.1"><times id="A1.Ex21.m1.12.12.1.2.cmml" xref="A1.Ex21.m1.12.12.1.2"></times><ci id="A1.Ex21.m1.12.12.1.3.cmml" xref="A1.Ex21.m1.12.12.1.3">𝑓</ci><vector id="A1.Ex21.m1.12.12.1.1.2.cmml" xref="A1.Ex21.m1.12.12.1.1.1"><ci id="A1.Ex21.m1.5.5.cmml" xref="A1.Ex21.m1.5.5">𝑟</ci><apply id="A1.Ex21.m1.12.12.1.1.1.1.cmml" xref="A1.Ex21.m1.12.12.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex21.m1.12.12.1.1.1.1.1.cmml" xref="A1.Ex21.m1.12.12.1.1.1.1">subscript</csymbol><ci id="A1.Ex21.m1.12.12.1.1.1.1.2.cmml" xref="A1.Ex21.m1.12.12.1.1.1.1.2">𝜋</ci><ci id="A1.Ex21.m1.12.12.1.1.1.1.3a.cmml" xref="A1.Ex21.m1.12.12.1.1.1.1.3"><mtext id="A1.Ex21.m1.12.12.1.1.1.1.3.cmml" mathsize="70%" xref="A1.Ex21.m1.12.12.1.1.1.1.3">ref</mtext></ci></apply><ci id="A1.Ex21.m1.6.6.cmml" xref="A1.Ex21.m1.6.6">𝛽</ci></vector><interval closure="open" id="A1.Ex21.m1.12.12.1.4.1.cmml" xref="A1.Ex21.m1.12.12.1.4.2"><ci id="A1.Ex21.m1.7.7.cmml" xref="A1.Ex21.m1.7.7">𝑥</ci><ci id="A1.Ex21.m1.8.8.cmml" xref="A1.Ex21.m1.8.8">𝑦</ci></interval></apply><apply id="A1.Ex21.m1.14.14.6.cmml" xref="A1.Ex21.m1.14.14.6"><times id="A1.Ex21.m1.14.14.6.1.cmml" xref="A1.Ex21.m1.14.14.6.1"></times><ci id="A1.Ex21.m1.14.14.6.2.cmml" xref="A1.Ex21.m1.14.14.6.2">𝛽</ci><apply id="A1.Ex21.m1.14.14.6.3.cmml" xref="A1.Ex21.m1.14.14.6.3"><log id="A1.Ex21.m1.14.14.6.3.1.cmml" xref="A1.Ex21.m1.14.14.6.3.1"></log><apply id="A1.Ex21.m1.2.2.cmml" xref="A1.Ex21.m1.2.2"><divide id="A1.Ex21.m1.2.2.3.cmml" xref="A1.Ex21.m1.2.2"></divide><apply id="A1.Ex21.m1.1.1.1.cmml" xref="A1.Ex21.m1.1.1.1"><times id="A1.Ex21.m1.1.1.1.2.cmml" xref="A1.Ex21.m1.1.1.1.2"></times><apply id="A1.Ex21.m1.1.1.1.3.cmml" xref="A1.Ex21.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex21.m1.1.1.1.3.1.cmml" xref="A1.Ex21.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex21.m1.1.1.1.3.2.cmml" xref="A1.Ex21.m1.1.1.1.3.2">𝜋</ci><ci id="A1.Ex21.m1.1.1.1.3.3.cmml" xref="A1.Ex21.m1.1.1.1.3.3">𝑟</ci></apply><apply id="A1.Ex21.m1.1.1.1.1.1.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex21.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex21.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex21.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex21.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex21.m1.2.2.2.cmml" xref="A1.Ex21.m1.2.2.2"><times id="A1.Ex21.m1.2.2.2.2.cmml" xref="A1.Ex21.m1.2.2.2.2"></times><apply id="A1.Ex21.m1.2.2.2.3.cmml" xref="A1.Ex21.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex21.m1.2.2.2.3.1.cmml" xref="A1.Ex21.m1.2.2.2.3">subscript</csymbol><ci id="A1.Ex21.m1.2.2.2.3.2.cmml" xref="A1.Ex21.m1.2.2.2.3.2">𝜋</ci><ci id="A1.Ex21.m1.2.2.2.3.3a.cmml" xref="A1.Ex21.m1.2.2.2.3.3"><mtext id="A1.Ex21.m1.2.2.2.3.3.cmml" mathsize="70%" xref="A1.Ex21.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex21.m1.2.2.2.1.1.1.cmml" xref="A1.Ex21.m1.2.2.2.1.1"><csymbol cd="latexml" id="A1.Ex21.m1.2.2.2.1.1.1.1.cmml" xref="A1.Ex21.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex21.m1.2.2.2.1.1.1.2.cmml" xref="A1.Ex21.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.Ex21.m1.2.2.2.1.1.1.3.cmml" xref="A1.Ex21.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.Ex21.m1.14.14c.cmml" xref="A1.Ex21.m1.14.14"><eq id="A1.Ex21.m1.14.14.7.cmml" xref="A1.Ex21.m1.14.14.7"></eq><share href="#A1.Ex21.m1.14.14.6.cmml" id="A1.Ex21.m1.14.14d.cmml" xref="A1.Ex21.m1.14.14"></share><apply id="A1.Ex21.m1.14.14.8.cmml" xref="A1.Ex21.m1.14.14.8"><times id="A1.Ex21.m1.14.14.8.1.cmml" xref="A1.Ex21.m1.14.14.8.1"></times><ci id="A1.Ex21.m1.14.14.8.2.cmml" xref="A1.Ex21.m1.14.14.8.2">𝛽</ci><apply id="A1.Ex21.m1.14.14.8.3.cmml" xref="A1.Ex21.m1.14.14.8.3"><log id="A1.Ex21.m1.14.14.8.3.1.cmml" xref="A1.Ex21.m1.14.14.8.3.1"></log><apply id="A1.Ex21.m1.4.4.cmml" xref="A1.Ex21.m1.4.4"><divide id="A1.Ex21.m1.4.4.3.cmml" xref="A1.Ex21.m1.4.4"></divide><apply id="A1.Ex21.m1.3.3.1.cmml" xref="A1.Ex21.m1.3.3.1"><times id="A1.Ex21.m1.3.3.1.2.cmml" xref="A1.Ex21.m1.3.3.1.2"></times><apply id="A1.Ex21.m1.3.3.1.3.cmml" xref="A1.Ex21.m1.3.3.1.3"><csymbol cd="ambiguous" id="A1.Ex21.m1.3.3.1.3.1.cmml" xref="A1.Ex21.m1.3.3.1.3">superscript</csymbol><apply id="A1.Ex21.m1.3.3.1.3.2.cmml" xref="A1.Ex21.m1.3.3.1.3"><csymbol cd="ambiguous" id="A1.Ex21.m1.3.3.1.3.2.1.cmml" xref="A1.Ex21.m1.3.3.1.3">subscript</csymbol><ci id="A1.Ex21.m1.3.3.1.3.2.2.cmml" xref="A1.Ex21.m1.3.3.1.3.2.2">𝜋</ci><ci id="A1.Ex21.m1.3.3.1.3.2.3.cmml" xref="A1.Ex21.m1.3.3.1.3.2.3">𝑟</ci></apply><ci id="A1.Ex21.m1.3.3.1.3.3.cmml" xref="A1.Ex21.m1.3.3.1.3.3">′</ci></apply><apply id="A1.Ex21.m1.3.3.1.1.1.1.cmml" xref="A1.Ex21.m1.3.3.1.1.1"><csymbol cd="latexml" id="A1.Ex21.m1.3.3.1.1.1.1.1.cmml" xref="A1.Ex21.m1.3.3.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex21.m1.3.3.1.1.1.1.2.cmml" xref="A1.Ex21.m1.3.3.1.1.1.1.2">𝑦</ci><ci id="A1.Ex21.m1.3.3.1.1.1.1.3.cmml" xref="A1.Ex21.m1.3.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex21.m1.4.4.2.cmml" xref="A1.Ex21.m1.4.4.2"><times id="A1.Ex21.m1.4.4.2.2.cmml" xref="A1.Ex21.m1.4.4.2.2"></times><apply id="A1.Ex21.m1.4.4.2.3.cmml" xref="A1.Ex21.m1.4.4.2.3"><csymbol cd="ambiguous" id="A1.Ex21.m1.4.4.2.3.1.cmml" xref="A1.Ex21.m1.4.4.2.3">subscript</csymbol><ci id="A1.Ex21.m1.4.4.2.3.2.cmml" xref="A1.Ex21.m1.4.4.2.3.2">𝜋</ci><ci id="A1.Ex21.m1.4.4.2.3.3a.cmml" xref="A1.Ex21.m1.4.4.2.3.3"><mtext id="A1.Ex21.m1.4.4.2.3.3.cmml" mathsize="70%" xref="A1.Ex21.m1.4.4.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex21.m1.4.4.2.1.1.1.cmml" xref="A1.Ex21.m1.4.4.2.1.1"><csymbol cd="latexml" id="A1.Ex21.m1.4.4.2.1.1.1.1.cmml" xref="A1.Ex21.m1.4.4.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex21.m1.4.4.2.1.1.1.2.cmml" xref="A1.Ex21.m1.4.4.2.1.1.1.2">𝑦</ci><ci id="A1.Ex21.m1.4.4.2.1.1.1.3.cmml" xref="A1.Ex21.m1.4.4.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.Ex21.m1.14.14e.cmml" xref="A1.Ex21.m1.14.14"><eq id="A1.Ex21.m1.14.14.9.cmml" xref="A1.Ex21.m1.14.14.9"></eq><share href="#A1.Ex21.m1.14.14.8.cmml" id="A1.Ex21.m1.14.14f.cmml" xref="A1.Ex21.m1.14.14"></share><apply id="A1.Ex21.m1.14.14.3.cmml" xref="A1.Ex21.m1.14.14.3"><times id="A1.Ex21.m1.14.14.3.3.cmml" xref="A1.Ex21.m1.14.14.3.3"></times><ci id="A1.Ex21.m1.14.14.3.4.cmml" xref="A1.Ex21.m1.14.14.3.4">𝑓</ci><vector id="A1.Ex21.m1.14.14.3.2.3.cmml" xref="A1.Ex21.m1.14.14.3.2.2"><apply id="A1.Ex21.m1.13.13.2.1.1.1.cmml" xref="A1.Ex21.m1.13.13.2.1.1.1"><csymbol cd="ambiguous" id="A1.Ex21.m1.13.13.2.1.1.1.1.cmml" xref="A1.Ex21.m1.13.13.2.1.1.1">superscript</csymbol><ci id="A1.Ex21.m1.13.13.2.1.1.1.2.cmml" xref="A1.Ex21.m1.13.13.2.1.1.1.2">𝑟</ci><ci id="A1.Ex21.m1.13.13.2.1.1.1.3.cmml" xref="A1.Ex21.m1.13.13.2.1.1.1.3">′</ci></apply><apply id="A1.Ex21.m1.14.14.3.2.2.2.cmml" xref="A1.Ex21.m1.14.14.3.2.2.2"><csymbol cd="ambiguous" id="A1.Ex21.m1.14.14.3.2.2.2.1.cmml" xref="A1.Ex21.m1.14.14.3.2.2.2">subscript</csymbol><ci id="A1.Ex21.m1.14.14.3.2.2.2.2.cmml" xref="A1.Ex21.m1.14.14.3.2.2.2.2">𝜋</ci><ci id="A1.Ex21.m1.14.14.3.2.2.2.3a.cmml" xref="A1.Ex21.m1.14.14.3.2.2.2.3"><mtext id="A1.Ex21.m1.14.14.3.2.2.2.3.cmml" mathsize="70%" xref="A1.Ex21.m1.14.14.3.2.2.2.3">ref</mtext></ci></apply><ci id="A1.Ex21.m1.9.9.cmml" xref="A1.Ex21.m1.9.9">𝛽</ci></vector><interval closure="open" id="A1.Ex21.m1.14.14.3.5.1.cmml" xref="A1.Ex21.m1.14.14.3.5.2"><ci id="A1.Ex21.m1.10.10.cmml" xref="A1.Ex21.m1.10.10">𝑥</ci><ci id="A1.Ex21.m1.11.11.cmml" xref="A1.Ex21.m1.11.11">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex21.m1.14c">f(r,\pi_{\text{ref}},\beta)(x,y)=\beta\log\frac{\pi_{r}(y|x)}{\pi_{\text{ref}}%
(y|x)}=\beta\log\frac{\pi_{r}^{\prime}(y|x)}{\pi_{\text{ref}}(y|x)}=f(r^{%
\prime},\pi_{\text{ref}},\beta)(x,y)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex21.m1.14d">italic_f ( italic_r , italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT , italic_β ) ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG = italic_f ( italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT , italic_β ) ( italic_x , italic_y )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS6.p3.3">여기서 두 번째 동일성은 Lemma <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#Thmlemma2" title="Lemma 2. ‣ 5.1 Your Language Model Is Secretly a Reward Model ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">2</span></a>로부터 따른다. 연산자 <math alttext="f" class="ltx_Math" display="inline" id="A1.SS6.p3.3.m1.1"><semantics id="A1.SS6.p3.3.m1.1a"><mi id="A1.SS6.p3.3.m1.1.1" xref="A1.SS6.p3.3.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.p3.3.m1.1b"><ci id="A1.SS6.p3.3.m1.1.1.cmml" xref="A1.SS6.p3.3.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p3.3.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p3.3.m1.1d">italic_f</annotation></semantics></math>가 특정 동등성 클래스의 모든 보상 함수를 동일한 보상 함수에 매핑하는 것을 증명하였다. 다음으로, 우리는 보상 함수의 모든 동등성 클래스에 대해 정리 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#Thmtheorem1" title="Theorem 1. ‣ 5.1 Your Language Model Is Secretly a Reward Model ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">1</span></a>에 요약된 재매개 변수를 갖는 보상 함수가 고유하다는 것을 보여준다.</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="Thmproposition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmproposition1.1.1.1">Proposition 1</span></span><span class="ltx_text ltx_font_bold" id="Thmproposition1.2.2">.</span>
</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="Thmproposition1.p1">
<p class="ltx_p" id="Thmproposition1.p1.7"><span class="ltx_text ltx_font_italic" id="Thmproposition1.p1.7.7">Assume, we have a reference model, such that <math alttext="\pi_{\text{ref}}(y|x)>0" class="ltx_Math" display="inline" id="Thmproposition1.p1.1.1.m1.1"><semantics id="Thmproposition1.p1.1.1.m1.1a"><mrow id="Thmproposition1.p1.1.1.m1.1.1" xref="Thmproposition1.p1.1.1.m1.1.1.cmml"><mrow id="Thmproposition1.p1.1.1.m1.1.1.1" xref="Thmproposition1.p1.1.1.m1.1.1.1.cmml"><msub id="Thmproposition1.p1.1.1.m1.1.1.1.3" xref="Thmproposition1.p1.1.1.m1.1.1.1.3.cmml"><mi id="Thmproposition1.p1.1.1.m1.1.1.1.3.2" xref="Thmproposition1.p1.1.1.m1.1.1.1.3.2.cmml">π</mi><mtext id="Thmproposition1.p1.1.1.m1.1.1.1.3.3" xref="Thmproposition1.p1.1.1.m1.1.1.1.3.3a.cmml">𝑟𝑒𝑓</mtext></msub><mo id="Thmproposition1.p1.1.1.m1.1.1.1.2" mathvariant="italic" xref="Thmproposition1.p1.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="Thmproposition1.p1.1.1.m1.1.1.1.1.1" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.cmml"><mo id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.2" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.cmml"><mi id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.2" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.1" mathvariant="normal" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.3" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.3" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmproposition1.p1.1.1.m1.1.1.2" mathvariant="normal" xref="Thmproposition1.p1.1.1.m1.1.1.2.cmml">&gt;</mo><mn id="Thmproposition1.p1.1.1.m1.1.1.3" mathvariant="normal" xref="Thmproposition1.p1.1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.1.1.m1.1b"><apply id="Thmproposition1.p1.1.1.m1.1.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1"><gt id="Thmproposition1.p1.1.1.m1.1.1.2.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.2"></gt><apply id="Thmproposition1.p1.1.1.m1.1.1.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1"><times id="Thmproposition1.p1.1.1.m1.1.1.1.2.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1.2"></times><apply id="Thmproposition1.p1.1.1.m1.1.1.1.3.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="Thmproposition1.p1.1.1.m1.1.1.1.3.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1.3">subscript</csymbol><ci id="Thmproposition1.p1.1.1.m1.1.1.1.3.2.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1.3.2">𝜋</ci><ci id="Thmproposition1.p1.1.1.m1.1.1.1.3.3a.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1.3.3"><mtext id="Thmproposition1.p1.1.1.m1.1.1.1.3.3.cmml" mathsize="70%" xref="Thmproposition1.p1.1.1.m1.1.1.1.3.3">𝑟𝑒𝑓</mtext></ci></apply><apply id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><cn id="Thmproposition1.p1.1.1.m1.1.1.3.cmml" type="integer" xref="Thmproposition1.p1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.1.1.m1.1c">\pi_{\text{ref}}(y|x)&gt;0</annotation><annotation encoding="application/x-llamapun" id="Thmproposition1.p1.1.1.m1.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) &gt; 0</annotation></semantics></math> for all pairs of prompts <math alttext="x" class="ltx_Math" display="inline" id="Thmproposition1.p1.2.2.m2.1"><semantics id="Thmproposition1.p1.2.2.m2.1a"><mi id="Thmproposition1.p1.2.2.m2.1.1" xref="Thmproposition1.p1.2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.2.2.m2.1b"><ci id="Thmproposition1.p1.2.2.m2.1.1.cmml" xref="Thmproposition1.p1.2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.2.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="Thmproposition1.p1.2.2.m2.1d">italic_x</annotation></semantics></math> and answers <math alttext="y" class="ltx_Math" display="inline" id="Thmproposition1.p1.3.3.m3.1"><semantics id="Thmproposition1.p1.3.3.m3.1a"><mi id="Thmproposition1.p1.3.3.m3.1.1" xref="Thmproposition1.p1.3.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.3.3.m3.1b"><ci id="Thmproposition1.p1.3.3.m3.1.1.cmml" xref="Thmproposition1.p1.3.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.3.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="Thmproposition1.p1.3.3.m3.1d">italic_y</annotation></semantics></math> and a parameter <math alttext="\beta>0" class="ltx_Math" display="inline" id="Thmproposition1.p1.4.4.m4.1"><semantics id="Thmproposition1.p1.4.4.m4.1a"><mrow id="Thmproposition1.p1.4.4.m4.1.1" xref="Thmproposition1.p1.4.4.m4.1.1.cmml"><mi id="Thmproposition1.p1.4.4.m4.1.1.2" xref="Thmproposition1.p1.4.4.m4.1.1.2.cmml">β</mi><mo id="Thmproposition1.p1.4.4.m4.1.1.1" mathvariant="normal" xref="Thmproposition1.p1.4.4.m4.1.1.1.cmml">&gt;</mo><mn id="Thmproposition1.p1.4.4.m4.1.1.3" mathvariant="normal" xref="Thmproposition1.p1.4.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.4.4.m4.1b"><apply id="Thmproposition1.p1.4.4.m4.1.1.cmml" xref="Thmproposition1.p1.4.4.m4.1.1"><gt id="Thmproposition1.p1.4.4.m4.1.1.1.cmml" xref="Thmproposition1.p1.4.4.m4.1.1.1"></gt><ci id="Thmproposition1.p1.4.4.m4.1.1.2.cmml" xref="Thmproposition1.p1.4.4.m4.1.1.2">𝛽</ci><cn id="Thmproposition1.p1.4.4.m4.1.1.3.cmml" type="integer" xref="Thmproposition1.p1.4.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.4.4.m4.1c">\beta&gt;0</annotation><annotation encoding="application/x-llamapun" id="Thmproposition1.p1.4.4.m4.1d">italic_β &gt; 0</annotation></semantics></math>. Then every equivalence class of reward functions, as defined in Section <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#S5" title="5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a>, has a unique reward function <math alttext="r(x,y)" class="ltx_Math" display="inline" id="Thmproposition1.p1.5.5.m5.2"><semantics id="Thmproposition1.p1.5.5.m5.2a"><mrow id="Thmproposition1.p1.5.5.m5.2.3" xref="Thmproposition1.p1.5.5.m5.2.3.cmml"><mi id="Thmproposition1.p1.5.5.m5.2.3.2" xref="Thmproposition1.p1.5.5.m5.2.3.2.cmml">r</mi><mo id="Thmproposition1.p1.5.5.m5.2.3.1" mathvariant="italic" xref="Thmproposition1.p1.5.5.m5.2.3.1.cmml">⁢</mo><mrow id="Thmproposition1.p1.5.5.m5.2.3.3.2" xref="Thmproposition1.p1.5.5.m5.2.3.3.1.cmml"><mo id="Thmproposition1.p1.5.5.m5.2.3.3.2.1" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.5.5.m5.2.3.3.1.cmml">(</mo><mi id="Thmproposition1.p1.5.5.m5.1.1" xref="Thmproposition1.p1.5.5.m5.1.1.cmml">x</mi><mo id="Thmproposition1.p1.5.5.m5.2.3.3.2.2" mathvariant="normal" xref="Thmproposition1.p1.5.5.m5.2.3.3.1.cmml">,</mo><mi id="Thmproposition1.p1.5.5.m5.2.2" xref="Thmproposition1.p1.5.5.m5.2.2.cmml">y</mi><mo id="Thmproposition1.p1.5.5.m5.2.3.3.2.3" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.5.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.5.5.m5.2b"><apply id="Thmproposition1.p1.5.5.m5.2.3.cmml" xref="Thmproposition1.p1.5.5.m5.2.3"><times id="Thmproposition1.p1.5.5.m5.2.3.1.cmml" xref="Thmproposition1.p1.5.5.m5.2.3.1"></times><ci id="Thmproposition1.p1.5.5.m5.2.3.2.cmml" xref="Thmproposition1.p1.5.5.m5.2.3.2">𝑟</ci><interval closure="open" id="Thmproposition1.p1.5.5.m5.2.3.3.1.cmml" xref="Thmproposition1.p1.5.5.m5.2.3.3.2"><ci id="Thmproposition1.p1.5.5.m5.1.1.cmml" xref="Thmproposition1.p1.5.5.m5.1.1">𝑥</ci><ci id="Thmproposition1.p1.5.5.m5.2.2.cmml" xref="Thmproposition1.p1.5.5.m5.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.5.5.m5.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="Thmproposition1.p1.5.5.m5.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math>, which can be reparameterized as <math alttext="r(x,y)=\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}" class="ltx_Math" display="inline" id="Thmproposition1.p1.6.6.m6.4"><semantics id="Thmproposition1.p1.6.6.m6.4a"><mrow id="Thmproposition1.p1.6.6.m6.4.5" xref="Thmproposition1.p1.6.6.m6.4.5.cmml"><mrow id="Thmproposition1.p1.6.6.m6.4.5.2" xref="Thmproposition1.p1.6.6.m6.4.5.2.cmml"><mi id="Thmproposition1.p1.6.6.m6.4.5.2.2" xref="Thmproposition1.p1.6.6.m6.4.5.2.2.cmml">r</mi><mo id="Thmproposition1.p1.6.6.m6.4.5.2.1" mathvariant="italic" xref="Thmproposition1.p1.6.6.m6.4.5.2.1.cmml">⁢</mo><mrow id="Thmproposition1.p1.6.6.m6.4.5.2.3.2" xref="Thmproposition1.p1.6.6.m6.4.5.2.3.1.cmml"><mo id="Thmproposition1.p1.6.6.m6.4.5.2.3.2.1" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.6.6.m6.4.5.2.3.1.cmml">(</mo><mi id="Thmproposition1.p1.6.6.m6.3.3" xref="Thmproposition1.p1.6.6.m6.3.3.cmml">x</mi><mo id="Thmproposition1.p1.6.6.m6.4.5.2.3.2.2" mathvariant="normal" xref="Thmproposition1.p1.6.6.m6.4.5.2.3.1.cmml">,</mo><mi id="Thmproposition1.p1.6.6.m6.4.4" xref="Thmproposition1.p1.6.6.m6.4.4.cmml">y</mi><mo id="Thmproposition1.p1.6.6.m6.4.5.2.3.2.3" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.6.6.m6.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="Thmproposition1.p1.6.6.m6.4.5.1" mathvariant="normal" xref="Thmproposition1.p1.6.6.m6.4.5.1.cmml">=</mo><mrow id="Thmproposition1.p1.6.6.m6.4.5.3" xref="Thmproposition1.p1.6.6.m6.4.5.3.cmml"><mi id="Thmproposition1.p1.6.6.m6.4.5.3.2" xref="Thmproposition1.p1.6.6.m6.4.5.3.2.cmml">β</mi><mo id="Thmproposition1.p1.6.6.m6.4.5.3.1" lspace="0.167em" mathvariant="italic" xref="Thmproposition1.p1.6.6.m6.4.5.3.1.cmml">⁢</mo><mrow id="Thmproposition1.p1.6.6.m6.4.5.3.3" xref="Thmproposition1.p1.6.6.m6.4.5.3.3.cmml"><mi id="Thmproposition1.p1.6.6.m6.4.5.3.3.1" mathvariant="normal" xref="Thmproposition1.p1.6.6.m6.4.5.3.3.1.cmml">log</mi><mo id="Thmproposition1.p1.6.6.m6.4.5.3.3a" lspace="0.167em" mathvariant="italic" xref="Thmproposition1.p1.6.6.m6.4.5.3.3.cmml">⁡</mo><mfrac id="Thmproposition1.p1.6.6.m6.2.2" xref="Thmproposition1.p1.6.6.m6.2.2.cmml"><mrow id="Thmproposition1.p1.6.6.m6.1.1.1" xref="Thmproposition1.p1.6.6.m6.1.1.1.cmml"><mi id="Thmproposition1.p1.6.6.m6.1.1.1.3" xref="Thmproposition1.p1.6.6.m6.1.1.1.3.cmml">π</mi><mo id="Thmproposition1.p1.6.6.m6.1.1.1.2" mathvariant="italic" xref="Thmproposition1.p1.6.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="Thmproposition1.p1.6.6.m6.1.1.1.1.1" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.cmml"><mo id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.2" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.cmml"><mi id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.2" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.1" mathvariant="normal" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.1.cmml">|</mo><mi id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.3" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.3" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="Thmproposition1.p1.6.6.m6.2.2.2" xref="Thmproposition1.p1.6.6.m6.2.2.2.cmml"><msub id="Thmproposition1.p1.6.6.m6.2.2.2.3" xref="Thmproposition1.p1.6.6.m6.2.2.2.3.cmml"><mi id="Thmproposition1.p1.6.6.m6.2.2.2.3.2" xref="Thmproposition1.p1.6.6.m6.2.2.2.3.2.cmml">π</mi><mtext id="Thmproposition1.p1.6.6.m6.2.2.2.3.3" xref="Thmproposition1.p1.6.6.m6.2.2.2.3.3a.cmml">𝑟𝑒𝑓</mtext></msub><mo id="Thmproposition1.p1.6.6.m6.2.2.2.2" mathvariant="italic" xref="Thmproposition1.p1.6.6.m6.2.2.2.2.cmml">⁢</mo><mrow id="Thmproposition1.p1.6.6.m6.2.2.2.1.1" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.cmml"><mo id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.2" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.cmml">(</mo><mrow id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.cmml"><mi id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.2" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.1" mathvariant="normal" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.1.cmml">|</mo><mi id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.3" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.3" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.6.6.m6.4b"><apply id="Thmproposition1.p1.6.6.m6.4.5.cmml" xref="Thmproposition1.p1.6.6.m6.4.5"><eq id="Thmproposition1.p1.6.6.m6.4.5.1.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.1"></eq><apply id="Thmproposition1.p1.6.6.m6.4.5.2.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.2"><times id="Thmproposition1.p1.6.6.m6.4.5.2.1.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.2.1"></times><ci id="Thmproposition1.p1.6.6.m6.4.5.2.2.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.2.2">𝑟</ci><interval closure="open" id="Thmproposition1.p1.6.6.m6.4.5.2.3.1.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.2.3.2"><ci id="Thmproposition1.p1.6.6.m6.3.3.cmml" xref="Thmproposition1.p1.6.6.m6.3.3">𝑥</ci><ci id="Thmproposition1.p1.6.6.m6.4.4.cmml" xref="Thmproposition1.p1.6.6.m6.4.4">𝑦</ci></interval></apply><apply id="Thmproposition1.p1.6.6.m6.4.5.3.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.3"><times id="Thmproposition1.p1.6.6.m6.4.5.3.1.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.3.1"></times><ci id="Thmproposition1.p1.6.6.m6.4.5.3.2.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.3.2">𝛽</ci><apply id="Thmproposition1.p1.6.6.m6.4.5.3.3.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.3.3"><log id="Thmproposition1.p1.6.6.m6.4.5.3.3.1.cmml" xref="Thmproposition1.p1.6.6.m6.4.5.3.3.1"></log><apply id="Thmproposition1.p1.6.6.m6.2.2.cmml" xref="Thmproposition1.p1.6.6.m6.2.2"><divide id="Thmproposition1.p1.6.6.m6.2.2.3.cmml" xref="Thmproposition1.p1.6.6.m6.2.2"></divide><apply id="Thmproposition1.p1.6.6.m6.1.1.1.cmml" xref="Thmproposition1.p1.6.6.m6.1.1.1"><times id="Thmproposition1.p1.6.6.m6.1.1.1.2.cmml" xref="Thmproposition1.p1.6.6.m6.1.1.1.2"></times><ci id="Thmproposition1.p1.6.6.m6.1.1.1.3.cmml" xref="Thmproposition1.p1.6.6.m6.1.1.1.3">𝜋</ci><apply id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.cmml" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.1.cmml" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.1">conditional</csymbol><ci id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.2.cmml" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.2">𝑦</ci><ci id="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.3.cmml" xref="Thmproposition1.p1.6.6.m6.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="Thmproposition1.p1.6.6.m6.2.2.2.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2"><times id="Thmproposition1.p1.6.6.m6.2.2.2.2.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2.2"></times><apply id="Thmproposition1.p1.6.6.m6.2.2.2.3.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2.3"><csymbol cd="ambiguous" id="Thmproposition1.p1.6.6.m6.2.2.2.3.1.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2.3">subscript</csymbol><ci id="Thmproposition1.p1.6.6.m6.2.2.2.3.2.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2.3.2">𝜋</ci><ci id="Thmproposition1.p1.6.6.m6.2.2.2.3.3a.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2.3.3"><mtext id="Thmproposition1.p1.6.6.m6.2.2.2.3.3.cmml" mathsize="50%" xref="Thmproposition1.p1.6.6.m6.2.2.2.3.3">𝑟𝑒𝑓</mtext></ci></apply><apply id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1"><csymbol cd="latexml" id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.1.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.1">conditional</csymbol><ci id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.2.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.2">𝑦</ci><ci id="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.3.cmml" xref="Thmproposition1.p1.6.6.m6.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.6.6.m6.4c">r(x,y)=\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}</annotation><annotation encoding="application/x-llamapun" id="Thmproposition1.p1.6.6.m6.4d">italic_r ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG</annotation></semantics></math> for some model <math alttext="\pi(y|x)" class="ltx_Math" display="inline" id="Thmproposition1.p1.7.7.m7.1"><semantics id="Thmproposition1.p1.7.7.m7.1a"><mrow id="Thmproposition1.p1.7.7.m7.1.1" xref="Thmproposition1.p1.7.7.m7.1.1.cmml"><mi id="Thmproposition1.p1.7.7.m7.1.1.3" xref="Thmproposition1.p1.7.7.m7.1.1.3.cmml">π</mi><mo id="Thmproposition1.p1.7.7.m7.1.1.2" mathvariant="italic" xref="Thmproposition1.p1.7.7.m7.1.1.2.cmml">⁢</mo><mrow id="Thmproposition1.p1.7.7.m7.1.1.1.1" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.cmml"><mo id="Thmproposition1.p1.7.7.m7.1.1.1.1.2" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="Thmproposition1.p1.7.7.m7.1.1.1.1.1" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.cmml"><mi id="Thmproposition1.p1.7.7.m7.1.1.1.1.1.2" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="Thmproposition1.p1.7.7.m7.1.1.1.1.1.1" mathvariant="normal" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.1.cmml">|</mo><mi id="Thmproposition1.p1.7.7.m7.1.1.1.1.1.3" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="Thmproposition1.p1.7.7.m7.1.1.1.1.3" mathvariant="normal" stretchy="false" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.7.7.m7.1b"><apply id="Thmproposition1.p1.7.7.m7.1.1.cmml" xref="Thmproposition1.p1.7.7.m7.1.1"><times id="Thmproposition1.p1.7.7.m7.1.1.2.cmml" xref="Thmproposition1.p1.7.7.m7.1.1.2"></times><ci id="Thmproposition1.p1.7.7.m7.1.1.3.cmml" xref="Thmproposition1.p1.7.7.m7.1.1.3">𝜋</ci><apply id="Thmproposition1.p1.7.7.m7.1.1.1.1.1.cmml" xref="Thmproposition1.p1.7.7.m7.1.1.1.1"><csymbol cd="latexml" id="Thmproposition1.p1.7.7.m7.1.1.1.1.1.1.cmml" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.1">conditional</csymbol><ci id="Thmproposition1.p1.7.7.m7.1.1.1.1.1.2.cmml" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.2">𝑦</ci><ci id="Thmproposition1.p1.7.7.m7.1.1.1.1.1.3.cmml" xref="Thmproposition1.p1.7.7.m7.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.7.7.m7.1c">\pi(y|x)</annotation><annotation encoding="application/x-llamapun" id="Thmproposition1.p1.7.7.m7.1d">italic_π ( italic_y | italic_x )</annotation></semantics></math>.</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_proof" id="A1.SS6.4">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS6.3.p1">
<p class="ltx_p" id="A1.SS6.3.p1.6">We will proceed using proof by contradiction. Assume we have two reward functions from the same class, such that <math alttext="r^{\prime}(x,y)=r(x,y)+f(x)" class="ltx_Math" display="inline" id="A1.SS6.3.p1.1.m1.5"><semantics id="A1.SS6.3.p1.1.m1.5a"><mrow id="A1.SS6.3.p1.1.m1.5.6" xref="A1.SS6.3.p1.1.m1.5.6.cmml"><mrow id="A1.SS6.3.p1.1.m1.5.6.2" xref="A1.SS6.3.p1.1.m1.5.6.2.cmml"><msup id="A1.SS6.3.p1.1.m1.5.6.2.2" xref="A1.SS6.3.p1.1.m1.5.6.2.2.cmml"><mi id="A1.SS6.3.p1.1.m1.5.6.2.2.2" xref="A1.SS6.3.p1.1.m1.5.6.2.2.2.cmml">r</mi><mo id="A1.SS6.3.p1.1.m1.5.6.2.2.3" xref="A1.SS6.3.p1.1.m1.5.6.2.2.3.cmml">′</mo></msup><mo id="A1.SS6.3.p1.1.m1.5.6.2.1" xref="A1.SS6.3.p1.1.m1.5.6.2.1.cmml">⁢</mo><mrow id="A1.SS6.3.p1.1.m1.5.6.2.3.2" xref="A1.SS6.3.p1.1.m1.5.6.2.3.1.cmml"><mo id="A1.SS6.3.p1.1.m1.5.6.2.3.2.1" stretchy="false" xref="A1.SS6.3.p1.1.m1.5.6.2.3.1.cmml">(</mo><mi id="A1.SS6.3.p1.1.m1.1.1" xref="A1.SS6.3.p1.1.m1.1.1.cmml">x</mi><mo id="A1.SS6.3.p1.1.m1.5.6.2.3.2.2" xref="A1.SS6.3.p1.1.m1.5.6.2.3.1.cmml">,</mo><mi id="A1.SS6.3.p1.1.m1.2.2" xref="A1.SS6.3.p1.1.m1.2.2.cmml">y</mi><mo id="A1.SS6.3.p1.1.m1.5.6.2.3.2.3" stretchy="false" xref="A1.SS6.3.p1.1.m1.5.6.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.3.p1.1.m1.5.6.1" xref="A1.SS6.3.p1.1.m1.5.6.1.cmml">=</mo><mrow id="A1.SS6.3.p1.1.m1.5.6.3" xref="A1.SS6.3.p1.1.m1.5.6.3.cmml"><mrow id="A1.SS6.3.p1.1.m1.5.6.3.2" xref="A1.SS6.3.p1.1.m1.5.6.3.2.cmml"><mi id="A1.SS6.3.p1.1.m1.5.6.3.2.2" xref="A1.SS6.3.p1.1.m1.5.6.3.2.2.cmml">r</mi><mo id="A1.SS6.3.p1.1.m1.5.6.3.2.1" xref="A1.SS6.3.p1.1.m1.5.6.3.2.1.cmml">⁢</mo><mrow id="A1.SS6.3.p1.1.m1.5.6.3.2.3.2" xref="A1.SS6.3.p1.1.m1.5.6.3.2.3.1.cmml"><mo id="A1.SS6.3.p1.1.m1.5.6.3.2.3.2.1" stretchy="false" xref="A1.SS6.3.p1.1.m1.5.6.3.2.3.1.cmml">(</mo><mi id="A1.SS6.3.p1.1.m1.3.3" xref="A1.SS6.3.p1.1.m1.3.3.cmml">x</mi><mo id="A1.SS6.3.p1.1.m1.5.6.3.2.3.2.2" xref="A1.SS6.3.p1.1.m1.5.6.3.2.3.1.cmml">,</mo><mi id="A1.SS6.3.p1.1.m1.4.4" xref="A1.SS6.3.p1.1.m1.4.4.cmml">y</mi><mo id="A1.SS6.3.p1.1.m1.5.6.3.2.3.2.3" stretchy="false" xref="A1.SS6.3.p1.1.m1.5.6.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.3.p1.1.m1.5.6.3.1" xref="A1.SS6.3.p1.1.m1.5.6.3.1.cmml">+</mo><mrow id="A1.SS6.3.p1.1.m1.5.6.3.3" xref="A1.SS6.3.p1.1.m1.5.6.3.3.cmml"><mi id="A1.SS6.3.p1.1.m1.5.6.3.3.2" xref="A1.SS6.3.p1.1.m1.5.6.3.3.2.cmml">f</mi><mo id="A1.SS6.3.p1.1.m1.5.6.3.3.1" xref="A1.SS6.3.p1.1.m1.5.6.3.3.1.cmml">⁢</mo><mrow id="A1.SS6.3.p1.1.m1.5.6.3.3.3.2" xref="A1.SS6.3.p1.1.m1.5.6.3.3.cmml"><mo id="A1.SS6.3.p1.1.m1.5.6.3.3.3.2.1" stretchy="false" xref="A1.SS6.3.p1.1.m1.5.6.3.3.cmml">(</mo><mi id="A1.SS6.3.p1.1.m1.5.5" xref="A1.SS6.3.p1.1.m1.5.5.cmml">x</mi><mo id="A1.SS6.3.p1.1.m1.5.6.3.3.3.2.2" stretchy="false" xref="A1.SS6.3.p1.1.m1.5.6.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.3.p1.1.m1.5b"><apply id="A1.SS6.3.p1.1.m1.5.6.cmml" xref="A1.SS6.3.p1.1.m1.5.6"><eq id="A1.SS6.3.p1.1.m1.5.6.1.cmml" xref="A1.SS6.3.p1.1.m1.5.6.1"></eq><apply id="A1.SS6.3.p1.1.m1.5.6.2.cmml" xref="A1.SS6.3.p1.1.m1.5.6.2"><times id="A1.SS6.3.p1.1.m1.5.6.2.1.cmml" xref="A1.SS6.3.p1.1.m1.5.6.2.1"></times><apply id="A1.SS6.3.p1.1.m1.5.6.2.2.cmml" xref="A1.SS6.3.p1.1.m1.5.6.2.2"><csymbol cd="ambiguous" id="A1.SS6.3.p1.1.m1.5.6.2.2.1.cmml" xref="A1.SS6.3.p1.1.m1.5.6.2.2">superscript</csymbol><ci id="A1.SS6.3.p1.1.m1.5.6.2.2.2.cmml" xref="A1.SS6.3.p1.1.m1.5.6.2.2.2">𝑟</ci><ci id="A1.SS6.3.p1.1.m1.5.6.2.2.3.cmml" xref="A1.SS6.3.p1.1.m1.5.6.2.2.3">′</ci></apply><interval closure="open" id="A1.SS6.3.p1.1.m1.5.6.2.3.1.cmml" xref="A1.SS6.3.p1.1.m1.5.6.2.3.2"><ci id="A1.SS6.3.p1.1.m1.1.1.cmml" xref="A1.SS6.3.p1.1.m1.1.1">𝑥</ci><ci id="A1.SS6.3.p1.1.m1.2.2.cmml" xref="A1.SS6.3.p1.1.m1.2.2">𝑦</ci></interval></apply><apply id="A1.SS6.3.p1.1.m1.5.6.3.cmml" xref="A1.SS6.3.p1.1.m1.5.6.3"><plus id="A1.SS6.3.p1.1.m1.5.6.3.1.cmml" xref="A1.SS6.3.p1.1.m1.5.6.3.1"></plus><apply id="A1.SS6.3.p1.1.m1.5.6.3.2.cmml" xref="A1.SS6.3.p1.1.m1.5.6.3.2"><times id="A1.SS6.3.p1.1.m1.5.6.3.2.1.cmml" xref="A1.SS6.3.p1.1.m1.5.6.3.2.1"></times><ci id="A1.SS6.3.p1.1.m1.5.6.3.2.2.cmml" xref="A1.SS6.3.p1.1.m1.5.6.3.2.2">𝑟</ci><interval closure="open" id="A1.SS6.3.p1.1.m1.5.6.3.2.3.1.cmml" xref="A1.SS6.3.p1.1.m1.5.6.3.2.3.2"><ci id="A1.SS6.3.p1.1.m1.3.3.cmml" xref="A1.SS6.3.p1.1.m1.3.3">𝑥</ci><ci id="A1.SS6.3.p1.1.m1.4.4.cmml" xref="A1.SS6.3.p1.1.m1.4.4">𝑦</ci></interval></apply><apply id="A1.SS6.3.p1.1.m1.5.6.3.3.cmml" xref="A1.SS6.3.p1.1.m1.5.6.3.3"><times id="A1.SS6.3.p1.1.m1.5.6.3.3.1.cmml" xref="A1.SS6.3.p1.1.m1.5.6.3.3.1"></times><ci id="A1.SS6.3.p1.1.m1.5.6.3.3.2.cmml" xref="A1.SS6.3.p1.1.m1.5.6.3.3.2">𝑓</ci><ci id="A1.SS6.3.p1.1.m1.5.5.cmml" xref="A1.SS6.3.p1.1.m1.5.5">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.3.p1.1.m1.5c">r^{\prime}(x,y)=r(x,y)+f(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.3.p1.1.m1.5d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_r ( italic_x , italic_y ) + italic_f ( italic_x )</annotation></semantics></math>. Moreover, assume that <math alttext="r^{\prime}(x,y)=\beta\log\frac{\pi^{\prime}(y|x)}{\pi_{\text{ref}}(y|x)}" class="ltx_Math" display="inline" id="A1.SS6.3.p1.2.m2.4"><semantics id="A1.SS6.3.p1.2.m2.4a"><mrow id="A1.SS6.3.p1.2.m2.4.5" xref="A1.SS6.3.p1.2.m2.4.5.cmml"><mrow id="A1.SS6.3.p1.2.m2.4.5.2" xref="A1.SS6.3.p1.2.m2.4.5.2.cmml"><msup id="A1.SS6.3.p1.2.m2.4.5.2.2" xref="A1.SS6.3.p1.2.m2.4.5.2.2.cmml"><mi id="A1.SS6.3.p1.2.m2.4.5.2.2.2" xref="A1.SS6.3.p1.2.m2.4.5.2.2.2.cmml">r</mi><mo id="A1.SS6.3.p1.2.m2.4.5.2.2.3" xref="A1.SS6.3.p1.2.m2.4.5.2.2.3.cmml">′</mo></msup><mo id="A1.SS6.3.p1.2.m2.4.5.2.1" xref="A1.SS6.3.p1.2.m2.4.5.2.1.cmml">⁢</mo><mrow id="A1.SS6.3.p1.2.m2.4.5.2.3.2" xref="A1.SS6.3.p1.2.m2.4.5.2.3.1.cmml"><mo id="A1.SS6.3.p1.2.m2.4.5.2.3.2.1" stretchy="false" xref="A1.SS6.3.p1.2.m2.4.5.2.3.1.cmml">(</mo><mi id="A1.SS6.3.p1.2.m2.3.3" xref="A1.SS6.3.p1.2.m2.3.3.cmml">x</mi><mo id="A1.SS6.3.p1.2.m2.4.5.2.3.2.2" xref="A1.SS6.3.p1.2.m2.4.5.2.3.1.cmml">,</mo><mi id="A1.SS6.3.p1.2.m2.4.4" xref="A1.SS6.3.p1.2.m2.4.4.cmml">y</mi><mo id="A1.SS6.3.p1.2.m2.4.5.2.3.2.3" stretchy="false" xref="A1.SS6.3.p1.2.m2.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.3.p1.2.m2.4.5.1" xref="A1.SS6.3.p1.2.m2.4.5.1.cmml">=</mo><mrow id="A1.SS6.3.p1.2.m2.4.5.3" xref="A1.SS6.3.p1.2.m2.4.5.3.cmml"><mi id="A1.SS6.3.p1.2.m2.4.5.3.2" xref="A1.SS6.3.p1.2.m2.4.5.3.2.cmml">β</mi><mo id="A1.SS6.3.p1.2.m2.4.5.3.1" lspace="0.167em" xref="A1.SS6.3.p1.2.m2.4.5.3.1.cmml">⁢</mo><mrow id="A1.SS6.3.p1.2.m2.4.5.3.3" xref="A1.SS6.3.p1.2.m2.4.5.3.3.cmml"><mi id="A1.SS6.3.p1.2.m2.4.5.3.3.1" xref="A1.SS6.3.p1.2.m2.4.5.3.3.1.cmml">log</mi><mo id="A1.SS6.3.p1.2.m2.4.5.3.3a" lspace="0.167em" xref="A1.SS6.3.p1.2.m2.4.5.3.3.cmml">⁡</mo><mfrac id="A1.SS6.3.p1.2.m2.2.2" xref="A1.SS6.3.p1.2.m2.2.2.cmml"><mrow id="A1.SS6.3.p1.2.m2.1.1.1" xref="A1.SS6.3.p1.2.m2.1.1.1.cmml"><msup id="A1.SS6.3.p1.2.m2.1.1.1.3" xref="A1.SS6.3.p1.2.m2.1.1.1.3.cmml"><mi id="A1.SS6.3.p1.2.m2.1.1.1.3.2" xref="A1.SS6.3.p1.2.m2.1.1.1.3.2.cmml">π</mi><mo id="A1.SS6.3.p1.2.m2.1.1.1.3.3" xref="A1.SS6.3.p1.2.m2.1.1.1.3.3.cmml">′</mo></msup><mo id="A1.SS6.3.p1.2.m2.1.1.1.2" xref="A1.SS6.3.p1.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.3.p1.2.m2.1.1.1.1.1" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.cmml"><mo id="A1.SS6.3.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.3.p1.2.m2.1.1.1.1.1.1" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.2" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.1" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.3" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.3.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS6.3.p1.2.m2.2.2.2" xref="A1.SS6.3.p1.2.m2.2.2.2.cmml"><msub id="A1.SS6.3.p1.2.m2.2.2.2.3" xref="A1.SS6.3.p1.2.m2.2.2.2.3.cmml"><mi id="A1.SS6.3.p1.2.m2.2.2.2.3.2" xref="A1.SS6.3.p1.2.m2.2.2.2.3.2.cmml">π</mi><mtext id="A1.SS6.3.p1.2.m2.2.2.2.3.3" xref="A1.SS6.3.p1.2.m2.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.SS6.3.p1.2.m2.2.2.2.2" xref="A1.SS6.3.p1.2.m2.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS6.3.p1.2.m2.2.2.2.1.1" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.cmml"><mo id="A1.SS6.3.p1.2.m2.2.2.2.1.1.2" stretchy="false" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS6.3.p1.2.m2.2.2.2.1.1.1" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.cmml"><mi id="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.2" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.1" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.3" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.3.p1.2.m2.2.2.2.1.1.3" stretchy="false" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.3.p1.2.m2.4b"><apply id="A1.SS6.3.p1.2.m2.4.5.cmml" xref="A1.SS6.3.p1.2.m2.4.5"><eq id="A1.SS6.3.p1.2.m2.4.5.1.cmml" xref="A1.SS6.3.p1.2.m2.4.5.1"></eq><apply id="A1.SS6.3.p1.2.m2.4.5.2.cmml" xref="A1.SS6.3.p1.2.m2.4.5.2"><times id="A1.SS6.3.p1.2.m2.4.5.2.1.cmml" xref="A1.SS6.3.p1.2.m2.4.5.2.1"></times><apply id="A1.SS6.3.p1.2.m2.4.5.2.2.cmml" xref="A1.SS6.3.p1.2.m2.4.5.2.2"><csymbol cd="ambiguous" id="A1.SS6.3.p1.2.m2.4.5.2.2.1.cmml" xref="A1.SS6.3.p1.2.m2.4.5.2.2">superscript</csymbol><ci id="A1.SS6.3.p1.2.m2.4.5.2.2.2.cmml" xref="A1.SS6.3.p1.2.m2.4.5.2.2.2">𝑟</ci><ci id="A1.SS6.3.p1.2.m2.4.5.2.2.3.cmml" xref="A1.SS6.3.p1.2.m2.4.5.2.2.3">′</ci></apply><interval closure="open" id="A1.SS6.3.p1.2.m2.4.5.2.3.1.cmml" xref="A1.SS6.3.p1.2.m2.4.5.2.3.2"><ci id="A1.SS6.3.p1.2.m2.3.3.cmml" xref="A1.SS6.3.p1.2.m2.3.3">𝑥</ci><ci id="A1.SS6.3.p1.2.m2.4.4.cmml" xref="A1.SS6.3.p1.2.m2.4.4">𝑦</ci></interval></apply><apply id="A1.SS6.3.p1.2.m2.4.5.3.cmml" xref="A1.SS6.3.p1.2.m2.4.5.3"><times id="A1.SS6.3.p1.2.m2.4.5.3.1.cmml" xref="A1.SS6.3.p1.2.m2.4.5.3.1"></times><ci id="A1.SS6.3.p1.2.m2.4.5.3.2.cmml" xref="A1.SS6.3.p1.2.m2.4.5.3.2">𝛽</ci><apply id="A1.SS6.3.p1.2.m2.4.5.3.3.cmml" xref="A1.SS6.3.p1.2.m2.4.5.3.3"><log id="A1.SS6.3.p1.2.m2.4.5.3.3.1.cmml" xref="A1.SS6.3.p1.2.m2.4.5.3.3.1"></log><apply id="A1.SS6.3.p1.2.m2.2.2.cmml" xref="A1.SS6.3.p1.2.m2.2.2"><divide id="A1.SS6.3.p1.2.m2.2.2.3.cmml" xref="A1.SS6.3.p1.2.m2.2.2"></divide><apply id="A1.SS6.3.p1.2.m2.1.1.1.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1"><times id="A1.SS6.3.p1.2.m2.1.1.1.2.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1.2"></times><apply id="A1.SS6.3.p1.2.m2.1.1.1.3.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS6.3.p1.2.m2.1.1.1.3.1.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1.3">superscript</csymbol><ci id="A1.SS6.3.p1.2.m2.1.1.1.3.2.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1.3.2">𝜋</ci><ci id="A1.SS6.3.p1.2.m2.1.1.1.3.3.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1.3.3">′</ci></apply><apply id="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="A1.SS6.3.p1.2.m2.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.SS6.3.p1.2.m2.2.2.2.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2"><times id="A1.SS6.3.p1.2.m2.2.2.2.2.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2.2"></times><apply id="A1.SS6.3.p1.2.m2.2.2.2.3.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS6.3.p1.2.m2.2.2.2.3.1.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2.3">subscript</csymbol><ci id="A1.SS6.3.p1.2.m2.2.2.2.3.2.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2.3.2">𝜋</ci><ci id="A1.SS6.3.p1.2.m2.2.2.2.3.3a.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2.3.3"><mtext id="A1.SS6.3.p1.2.m2.2.2.2.3.3.cmml" mathsize="50%" xref="A1.SS6.3.p1.2.m2.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1"><csymbol cd="latexml" id="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.1.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.2.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.3.cmml" xref="A1.SS6.3.p1.2.m2.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.3.p1.2.m2.4c">r^{\prime}(x,y)=\beta\log\frac{\pi^{\prime}(y|x)}{\pi_{\text{ref}}(y|x)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.3.p1.2.m2.4d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG</annotation></semantics></math> for some model <math alttext="\pi^{\prime}(y|x)" class="ltx_Math" display="inline" id="A1.SS6.3.p1.3.m3.1"><semantics id="A1.SS6.3.p1.3.m3.1a"><mrow id="A1.SS6.3.p1.3.m3.1.1" xref="A1.SS6.3.p1.3.m3.1.1.cmml"><msup id="A1.SS6.3.p1.3.m3.1.1.3" xref="A1.SS6.3.p1.3.m3.1.1.3.cmml"><mi id="A1.SS6.3.p1.3.m3.1.1.3.2" xref="A1.SS6.3.p1.3.m3.1.1.3.2.cmml">π</mi><mo id="A1.SS6.3.p1.3.m3.1.1.3.3" xref="A1.SS6.3.p1.3.m3.1.1.3.3.cmml">′</mo></msup><mo id="A1.SS6.3.p1.3.m3.1.1.2" xref="A1.SS6.3.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.3.p1.3.m3.1.1.1.1" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.cmml"><mo id="A1.SS6.3.p1.3.m3.1.1.1.1.2" stretchy="false" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.3.p1.3.m3.1.1.1.1.1" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.cmml"><mi id="A1.SS6.3.p1.3.m3.1.1.1.1.1.2" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.3.p1.3.m3.1.1.1.1.1.1" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.3.p1.3.m3.1.1.1.1.1.3" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.3.p1.3.m3.1.1.1.1.3" stretchy="false" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.3.p1.3.m3.1b"><apply id="A1.SS6.3.p1.3.m3.1.1.cmml" xref="A1.SS6.3.p1.3.m3.1.1"><times id="A1.SS6.3.p1.3.m3.1.1.2.cmml" xref="A1.SS6.3.p1.3.m3.1.1.2"></times><apply id="A1.SS6.3.p1.3.m3.1.1.3.cmml" xref="A1.SS6.3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS6.3.p1.3.m3.1.1.3.1.cmml" xref="A1.SS6.3.p1.3.m3.1.1.3">superscript</csymbol><ci id="A1.SS6.3.p1.3.m3.1.1.3.2.cmml" xref="A1.SS6.3.p1.3.m3.1.1.3.2">𝜋</ci><ci id="A1.SS6.3.p1.3.m3.1.1.3.3.cmml" xref="A1.SS6.3.p1.3.m3.1.1.3.3">′</ci></apply><apply id="A1.SS6.3.p1.3.m3.1.1.1.1.1.cmml" xref="A1.SS6.3.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="A1.SS6.3.p1.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.3.p1.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.3.p1.3.m3.1.1.1.1.1.3.cmml" xref="A1.SS6.3.p1.3.m3.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.3.p1.3.m3.1c">\pi^{\prime}(y|x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.3.p1.3.m3.1d">italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y | italic_x )</annotation></semantics></math> and <math alttext="r(x,y)=\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}" class="ltx_Math" display="inline" id="A1.SS6.3.p1.4.m4.4"><semantics id="A1.SS6.3.p1.4.m4.4a"><mrow id="A1.SS6.3.p1.4.m4.4.5" xref="A1.SS6.3.p1.4.m4.4.5.cmml"><mrow id="A1.SS6.3.p1.4.m4.4.5.2" xref="A1.SS6.3.p1.4.m4.4.5.2.cmml"><mi id="A1.SS6.3.p1.4.m4.4.5.2.2" xref="A1.SS6.3.p1.4.m4.4.5.2.2.cmml">r</mi><mo id="A1.SS6.3.p1.4.m4.4.5.2.1" xref="A1.SS6.3.p1.4.m4.4.5.2.1.cmml">⁢</mo><mrow id="A1.SS6.3.p1.4.m4.4.5.2.3.2" xref="A1.SS6.3.p1.4.m4.4.5.2.3.1.cmml"><mo id="A1.SS6.3.p1.4.m4.4.5.2.3.2.1" stretchy="false" xref="A1.SS6.3.p1.4.m4.4.5.2.3.1.cmml">(</mo><mi id="A1.SS6.3.p1.4.m4.3.3" xref="A1.SS6.3.p1.4.m4.3.3.cmml">x</mi><mo id="A1.SS6.3.p1.4.m4.4.5.2.3.2.2" xref="A1.SS6.3.p1.4.m4.4.5.2.3.1.cmml">,</mo><mi id="A1.SS6.3.p1.4.m4.4.4" xref="A1.SS6.3.p1.4.m4.4.4.cmml">y</mi><mo id="A1.SS6.3.p1.4.m4.4.5.2.3.2.3" stretchy="false" xref="A1.SS6.3.p1.4.m4.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.3.p1.4.m4.4.5.1" xref="A1.SS6.3.p1.4.m4.4.5.1.cmml">=</mo><mrow id="A1.SS6.3.p1.4.m4.4.5.3" xref="A1.SS6.3.p1.4.m4.4.5.3.cmml"><mi id="A1.SS6.3.p1.4.m4.4.5.3.2" xref="A1.SS6.3.p1.4.m4.4.5.3.2.cmml">β</mi><mo id="A1.SS6.3.p1.4.m4.4.5.3.1" lspace="0.167em" xref="A1.SS6.3.p1.4.m4.4.5.3.1.cmml">⁢</mo><mrow id="A1.SS6.3.p1.4.m4.4.5.3.3" xref="A1.SS6.3.p1.4.m4.4.5.3.3.cmml"><mi id="A1.SS6.3.p1.4.m4.4.5.3.3.1" xref="A1.SS6.3.p1.4.m4.4.5.3.3.1.cmml">log</mi><mo id="A1.SS6.3.p1.4.m4.4.5.3.3a" lspace="0.167em" xref="A1.SS6.3.p1.4.m4.4.5.3.3.cmml">⁡</mo><mfrac id="A1.SS6.3.p1.4.m4.2.2" xref="A1.SS6.3.p1.4.m4.2.2.cmml"><mrow id="A1.SS6.3.p1.4.m4.1.1.1" xref="A1.SS6.3.p1.4.m4.1.1.1.cmml"><mi id="A1.SS6.3.p1.4.m4.1.1.1.3" xref="A1.SS6.3.p1.4.m4.1.1.1.3.cmml">π</mi><mo id="A1.SS6.3.p1.4.m4.1.1.1.2" xref="A1.SS6.3.p1.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.3.p1.4.m4.1.1.1.1.1" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.cmml"><mo id="A1.SS6.3.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.3.p1.4.m4.1.1.1.1.1.1" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.2" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.1" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.3" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.3.p1.4.m4.1.1.1.1.1.3" stretchy="false" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.SS6.3.p1.4.m4.2.2.2" xref="A1.SS6.3.p1.4.m4.2.2.2.cmml"><msub id="A1.SS6.3.p1.4.m4.2.2.2.3" xref="A1.SS6.3.p1.4.m4.2.2.2.3.cmml"><mi id="A1.SS6.3.p1.4.m4.2.2.2.3.2" xref="A1.SS6.3.p1.4.m4.2.2.2.3.2.cmml">π</mi><mtext id="A1.SS6.3.p1.4.m4.2.2.2.3.3" xref="A1.SS6.3.p1.4.m4.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.SS6.3.p1.4.m4.2.2.2.2" xref="A1.SS6.3.p1.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS6.3.p1.4.m4.2.2.2.1.1" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.cmml"><mo id="A1.SS6.3.p1.4.m4.2.2.2.1.1.2" stretchy="false" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS6.3.p1.4.m4.2.2.2.1.1.1" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.cmml"><mi id="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.2" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.1" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.3" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.3.p1.4.m4.2.2.2.1.1.3" stretchy="false" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.3.p1.4.m4.4b"><apply id="A1.SS6.3.p1.4.m4.4.5.cmml" xref="A1.SS6.3.p1.4.m4.4.5"><eq id="A1.SS6.3.p1.4.m4.4.5.1.cmml" xref="A1.SS6.3.p1.4.m4.4.5.1"></eq><apply id="A1.SS6.3.p1.4.m4.4.5.2.cmml" xref="A1.SS6.3.p1.4.m4.4.5.2"><times id="A1.SS6.3.p1.4.m4.4.5.2.1.cmml" xref="A1.SS6.3.p1.4.m4.4.5.2.1"></times><ci id="A1.SS6.3.p1.4.m4.4.5.2.2.cmml" xref="A1.SS6.3.p1.4.m4.4.5.2.2">𝑟</ci><interval closure="open" id="A1.SS6.3.p1.4.m4.4.5.2.3.1.cmml" xref="A1.SS6.3.p1.4.m4.4.5.2.3.2"><ci id="A1.SS6.3.p1.4.m4.3.3.cmml" xref="A1.SS6.3.p1.4.m4.3.3">𝑥</ci><ci id="A1.SS6.3.p1.4.m4.4.4.cmml" xref="A1.SS6.3.p1.4.m4.4.4">𝑦</ci></interval></apply><apply id="A1.SS6.3.p1.4.m4.4.5.3.cmml" xref="A1.SS6.3.p1.4.m4.4.5.3"><times id="A1.SS6.3.p1.4.m4.4.5.3.1.cmml" xref="A1.SS6.3.p1.4.m4.4.5.3.1"></times><ci id="A1.SS6.3.p1.4.m4.4.5.3.2.cmml" xref="A1.SS6.3.p1.4.m4.4.5.3.2">𝛽</ci><apply id="A1.SS6.3.p1.4.m4.4.5.3.3.cmml" xref="A1.SS6.3.p1.4.m4.4.5.3.3"><log id="A1.SS6.3.p1.4.m4.4.5.3.3.1.cmml" xref="A1.SS6.3.p1.4.m4.4.5.3.3.1"></log><apply id="A1.SS6.3.p1.4.m4.2.2.cmml" xref="A1.SS6.3.p1.4.m4.2.2"><divide id="A1.SS6.3.p1.4.m4.2.2.3.cmml" xref="A1.SS6.3.p1.4.m4.2.2"></divide><apply id="A1.SS6.3.p1.4.m4.1.1.1.cmml" xref="A1.SS6.3.p1.4.m4.1.1.1"><times id="A1.SS6.3.p1.4.m4.1.1.1.2.cmml" xref="A1.SS6.3.p1.4.m4.1.1.1.2"></times><ci id="A1.SS6.3.p1.4.m4.1.1.1.3.cmml" xref="A1.SS6.3.p1.4.m4.1.1.1.3">𝜋</ci><apply id="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="A1.SS6.3.p1.4.m4.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.SS6.3.p1.4.m4.2.2.2.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2"><times id="A1.SS6.3.p1.4.m4.2.2.2.2.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2.2"></times><apply id="A1.SS6.3.p1.4.m4.2.2.2.3.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS6.3.p1.4.m4.2.2.2.3.1.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2.3">subscript</csymbol><ci id="A1.SS6.3.p1.4.m4.2.2.2.3.2.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2.3.2">𝜋</ci><ci id="A1.SS6.3.p1.4.m4.2.2.2.3.3a.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2.3.3"><mtext id="A1.SS6.3.p1.4.m4.2.2.2.3.3.cmml" mathsize="50%" xref="A1.SS6.3.p1.4.m4.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1"><csymbol cd="latexml" id="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.1.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.2.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.3.cmml" xref="A1.SS6.3.p1.4.m4.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.3.p1.4.m4.4c">r(x,y)=\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.3.p1.4.m4.4d">italic_r ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG</annotation></semantics></math> for some model <math alttext="\pi(y|x)" class="ltx_Math" display="inline" id="A1.SS6.3.p1.5.m5.1"><semantics id="A1.SS6.3.p1.5.m5.1a"><mrow id="A1.SS6.3.p1.5.m5.1.1" xref="A1.SS6.3.p1.5.m5.1.1.cmml"><mi id="A1.SS6.3.p1.5.m5.1.1.3" xref="A1.SS6.3.p1.5.m5.1.1.3.cmml">π</mi><mo id="A1.SS6.3.p1.5.m5.1.1.2" xref="A1.SS6.3.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="A1.SS6.3.p1.5.m5.1.1.1.1" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.cmml"><mo id="A1.SS6.3.p1.5.m5.1.1.1.1.2" stretchy="false" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.3.p1.5.m5.1.1.1.1.1" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.cmml"><mi id="A1.SS6.3.p1.5.m5.1.1.1.1.1.2" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.3.p1.5.m5.1.1.1.1.1.1" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.3.p1.5.m5.1.1.1.1.1.3" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.3.p1.5.m5.1.1.1.1.3" stretchy="false" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.3.p1.5.m5.1b"><apply id="A1.SS6.3.p1.5.m5.1.1.cmml" xref="A1.SS6.3.p1.5.m5.1.1"><times id="A1.SS6.3.p1.5.m5.1.1.2.cmml" xref="A1.SS6.3.p1.5.m5.1.1.2"></times><ci id="A1.SS6.3.p1.5.m5.1.1.3.cmml" xref="A1.SS6.3.p1.5.m5.1.1.3">𝜋</ci><apply id="A1.SS6.3.p1.5.m5.1.1.1.1.1.cmml" xref="A1.SS6.3.p1.5.m5.1.1.1.1"><csymbol cd="latexml" id="A1.SS6.3.p1.5.m5.1.1.1.1.1.1.cmml" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.3.p1.5.m5.1.1.1.1.1.2.cmml" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.3.p1.5.m5.1.1.1.1.1.3.cmml" xref="A1.SS6.3.p1.5.m5.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.3.p1.5.m5.1c">\pi(y|x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.3.p1.5.m5.1d">italic_π ( italic_y | italic_x )</annotation></semantics></math>, such that <math alttext="\pi\neq\pi^{\prime}" class="ltx_Math" display="inline" id="A1.SS6.3.p1.6.m6.1"><semantics id="A1.SS6.3.p1.6.m6.1a"><mrow id="A1.SS6.3.p1.6.m6.1.1" xref="A1.SS6.3.p1.6.m6.1.1.cmml"><mi id="A1.SS6.3.p1.6.m6.1.1.2" xref="A1.SS6.3.p1.6.m6.1.1.2.cmml">π</mi><mo id="A1.SS6.3.p1.6.m6.1.1.1" xref="A1.SS6.3.p1.6.m6.1.1.1.cmml">≠</mo><msup id="A1.SS6.3.p1.6.m6.1.1.3" xref="A1.SS6.3.p1.6.m6.1.1.3.cmml"><mi id="A1.SS6.3.p1.6.m6.1.1.3.2" xref="A1.SS6.3.p1.6.m6.1.1.3.2.cmml">π</mi><mo id="A1.SS6.3.p1.6.m6.1.1.3.3" xref="A1.SS6.3.p1.6.m6.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.3.p1.6.m6.1b"><apply id="A1.SS6.3.p1.6.m6.1.1.cmml" xref="A1.SS6.3.p1.6.m6.1.1"><neq id="A1.SS6.3.p1.6.m6.1.1.1.cmml" xref="A1.SS6.3.p1.6.m6.1.1.1"></neq><ci id="A1.SS6.3.p1.6.m6.1.1.2.cmml" xref="A1.SS6.3.p1.6.m6.1.1.2">𝜋</ci><apply id="A1.SS6.3.p1.6.m6.1.1.3.cmml" xref="A1.SS6.3.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="A1.SS6.3.p1.6.m6.1.1.3.1.cmml" xref="A1.SS6.3.p1.6.m6.1.1.3">superscript</csymbol><ci id="A1.SS6.3.p1.6.m6.1.1.3.2.cmml" xref="A1.SS6.3.p1.6.m6.1.1.3.2">𝜋</ci><ci id="A1.SS6.3.p1.6.m6.1.1.3.3.cmml" xref="A1.SS6.3.p1.6.m6.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.3.p1.6.m6.1c">\pi\neq\pi^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.3.p1.6.m6.1d">italic_π ≠ italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. We then have</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r^{\prime}(x,y)=r(x,y)+f(x)=\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}+f(%
x)=\beta\log\frac{\pi(y|x)\exp(\frac{1}{\beta}f(x))}{\pi_{\text{ref}}(y|x)}=%
\beta\log\frac{\pi^{\prime}(y|x)}{\pi_{\text{ref}}(y|x)}" class="ltx_Math" display="block" id="A1.Ex22.m1.15"><semantics id="A1.Ex22.m1.15a"><mrow id="A1.Ex22.m1.15.16" xref="A1.Ex22.m1.15.16.cmml"><mrow id="A1.Ex22.m1.15.16.2" xref="A1.Ex22.m1.15.16.2.cmml"><msup id="A1.Ex22.m1.15.16.2.2" xref="A1.Ex22.m1.15.16.2.2.cmml"><mi id="A1.Ex22.m1.15.16.2.2.2" xref="A1.Ex22.m1.15.16.2.2.2.cmml">r</mi><mo id="A1.Ex22.m1.15.16.2.2.3" xref="A1.Ex22.m1.15.16.2.2.3.cmml">′</mo></msup><mo id="A1.Ex22.m1.15.16.2.1" xref="A1.Ex22.m1.15.16.2.1.cmml">⁢</mo><mrow id="A1.Ex22.m1.15.16.2.3.2" xref="A1.Ex22.m1.15.16.2.3.1.cmml"><mo id="A1.Ex22.m1.15.16.2.3.2.1" stretchy="false" xref="A1.Ex22.m1.15.16.2.3.1.cmml">(</mo><mi id="A1.Ex22.m1.10.10" xref="A1.Ex22.m1.10.10.cmml">x</mi><mo id="A1.Ex22.m1.15.16.2.3.2.2" xref="A1.Ex22.m1.15.16.2.3.1.cmml">,</mo><mi id="A1.Ex22.m1.11.11" xref="A1.Ex22.m1.11.11.cmml">y</mi><mo id="A1.Ex22.m1.15.16.2.3.2.3" stretchy="false" xref="A1.Ex22.m1.15.16.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex22.m1.15.16.3" xref="A1.Ex22.m1.15.16.3.cmml">=</mo><mrow id="A1.Ex22.m1.15.16.4" xref="A1.Ex22.m1.15.16.4.cmml"><mrow id="A1.Ex22.m1.15.16.4.2" xref="A1.Ex22.m1.15.16.4.2.cmml"><mi id="A1.Ex22.m1.15.16.4.2.2" xref="A1.Ex22.m1.15.16.4.2.2.cmml">r</mi><mo id="A1.Ex22.m1.15.16.4.2.1" xref="A1.Ex22.m1.15.16.4.2.1.cmml">⁢</mo><mrow id="A1.Ex22.m1.15.16.4.2.3.2" xref="A1.Ex22.m1.15.16.4.2.3.1.cmml"><mo id="A1.Ex22.m1.15.16.4.2.3.2.1" stretchy="false" xref="A1.Ex22.m1.15.16.4.2.3.1.cmml">(</mo><mi id="A1.Ex22.m1.12.12" xref="A1.Ex22.m1.12.12.cmml">x</mi><mo id="A1.Ex22.m1.15.16.4.2.3.2.2" xref="A1.Ex22.m1.15.16.4.2.3.1.cmml">,</mo><mi id="A1.Ex22.m1.13.13" xref="A1.Ex22.m1.13.13.cmml">y</mi><mo id="A1.Ex22.m1.15.16.4.2.3.2.3" stretchy="false" xref="A1.Ex22.m1.15.16.4.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex22.m1.15.16.4.1" xref="A1.Ex22.m1.15.16.4.1.cmml">+</mo><mrow id="A1.Ex22.m1.15.16.4.3" xref="A1.Ex22.m1.15.16.4.3.cmml"><mi id="A1.Ex22.m1.15.16.4.3.2" xref="A1.Ex22.m1.15.16.4.3.2.cmml">f</mi><mo id="A1.Ex22.m1.15.16.4.3.1" xref="A1.Ex22.m1.15.16.4.3.1.cmml">⁢</mo><mrow id="A1.Ex22.m1.15.16.4.3.3.2" xref="A1.Ex22.m1.15.16.4.3.cmml"><mo id="A1.Ex22.m1.15.16.4.3.3.2.1" stretchy="false" xref="A1.Ex22.m1.15.16.4.3.cmml">(</mo><mi id="A1.Ex22.m1.14.14" xref="A1.Ex22.m1.14.14.cmml">x</mi><mo id="A1.Ex22.m1.15.16.4.3.3.2.2" stretchy="false" xref="A1.Ex22.m1.15.16.4.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex22.m1.15.16.5" xref="A1.Ex22.m1.15.16.5.cmml">=</mo><mrow id="A1.Ex22.m1.15.16.6" xref="A1.Ex22.m1.15.16.6.cmml"><mrow id="A1.Ex22.m1.15.16.6.2" xref="A1.Ex22.m1.15.16.6.2.cmml"><mi id="A1.Ex22.m1.15.16.6.2.2" xref="A1.Ex22.m1.15.16.6.2.2.cmml">β</mi><mo id="A1.Ex22.m1.15.16.6.2.1" lspace="0.167em" xref="A1.Ex22.m1.15.16.6.2.1.cmml">⁢</mo><mrow id="A1.Ex22.m1.15.16.6.2.3" xref="A1.Ex22.m1.15.16.6.2.3.cmml"><mi id="A1.Ex22.m1.15.16.6.2.3.1" xref="A1.Ex22.m1.15.16.6.2.3.1.cmml">log</mi><mo id="A1.Ex22.m1.15.16.6.2.3a" lspace="0.167em" xref="A1.Ex22.m1.15.16.6.2.3.cmml">⁡</mo><mfrac id="A1.Ex22.m1.2.2" xref="A1.Ex22.m1.2.2.cmml"><mrow id="A1.Ex22.m1.1.1.1" xref="A1.Ex22.m1.1.1.1.cmml"><mi id="A1.Ex22.m1.1.1.1.3" xref="A1.Ex22.m1.1.1.1.3.cmml">π</mi><mo id="A1.Ex22.m1.1.1.1.2" xref="A1.Ex22.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex22.m1.1.1.1.1.1" xref="A1.Ex22.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex22.m1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex22.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex22.m1.1.1.1.1.1.1" xref="A1.Ex22.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex22.m1.1.1.1.1.1.1.2" xref="A1.Ex22.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex22.m1.1.1.1.1.1.1.1" xref="A1.Ex22.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex22.m1.1.1.1.1.1.1.3" xref="A1.Ex22.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex22.m1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex22.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex22.m1.2.2.2" xref="A1.Ex22.m1.2.2.2.cmml"><msub id="A1.Ex22.m1.2.2.2.3" xref="A1.Ex22.m1.2.2.2.3.cmml"><mi id="A1.Ex22.m1.2.2.2.3.2" xref="A1.Ex22.m1.2.2.2.3.2.cmml">π</mi><mtext id="A1.Ex22.m1.2.2.2.3.3" xref="A1.Ex22.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex22.m1.2.2.2.2" xref="A1.Ex22.m1.2.2.2.2.cmml">⁢</mo><mrow id="A1.Ex22.m1.2.2.2.1.1" xref="A1.Ex22.m1.2.2.2.1.1.1.cmml"><mo id="A1.Ex22.m1.2.2.2.1.1.2" stretchy="false" xref="A1.Ex22.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.Ex22.m1.2.2.2.1.1.1" xref="A1.Ex22.m1.2.2.2.1.1.1.cmml"><mi id="A1.Ex22.m1.2.2.2.1.1.1.2" xref="A1.Ex22.m1.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex22.m1.2.2.2.1.1.1.1" xref="A1.Ex22.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex22.m1.2.2.2.1.1.1.3" xref="A1.Ex22.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex22.m1.2.2.2.1.1.3" stretchy="false" xref="A1.Ex22.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex22.m1.15.16.6.1" xref="A1.Ex22.m1.15.16.6.1.cmml">+</mo><mrow id="A1.Ex22.m1.15.16.6.3" xref="A1.Ex22.m1.15.16.6.3.cmml"><mi id="A1.Ex22.m1.15.16.6.3.2" xref="A1.Ex22.m1.15.16.6.3.2.cmml">f</mi><mo id="A1.Ex22.m1.15.16.6.3.1" xref="A1.Ex22.m1.15.16.6.3.1.cmml">⁢</mo><mrow id="A1.Ex22.m1.15.16.6.3.3.2" xref="A1.Ex22.m1.15.16.6.3.cmml"><mo id="A1.Ex22.m1.15.16.6.3.3.2.1" stretchy="false" xref="A1.Ex22.m1.15.16.6.3.cmml">(</mo><mi id="A1.Ex22.m1.15.15" xref="A1.Ex22.m1.15.15.cmml">x</mi><mo id="A1.Ex22.m1.15.16.6.3.3.2.2" stretchy="false" xref="A1.Ex22.m1.15.16.6.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex22.m1.15.16.7" xref="A1.Ex22.m1.15.16.7.cmml">=</mo><mrow id="A1.Ex22.m1.15.16.8" xref="A1.Ex22.m1.15.16.8.cmml"><mi id="A1.Ex22.m1.15.16.8.2" xref="A1.Ex22.m1.15.16.8.2.cmml">β</mi><mo id="A1.Ex22.m1.15.16.8.1" lspace="0.167em" xref="A1.Ex22.m1.15.16.8.1.cmml">⁢</mo><mrow id="A1.Ex22.m1.15.16.8.3" xref="A1.Ex22.m1.15.16.8.3.cmml"><mi id="A1.Ex22.m1.15.16.8.3.1" xref="A1.Ex22.m1.15.16.8.3.1.cmml">log</mi><mo id="A1.Ex22.m1.15.16.8.3a" lspace="0.167em" xref="A1.Ex22.m1.15.16.8.3.cmml">⁡</mo><mfrac id="A1.Ex22.m1.7.7" xref="A1.Ex22.m1.7.7.cmml"><mrow id="A1.Ex22.m1.6.6.4" xref="A1.Ex22.m1.6.6.4.cmml"><mi id="A1.Ex22.m1.6.6.4.6" xref="A1.Ex22.m1.6.6.4.6.cmml">π</mi><mo id="A1.Ex22.m1.6.6.4.5" xref="A1.Ex22.m1.6.6.4.5.cmml">⁢</mo><mrow id="A1.Ex22.m1.5.5.3.3.1" xref="A1.Ex22.m1.5.5.3.3.1.1.cmml"><mo id="A1.Ex22.m1.5.5.3.3.1.2" stretchy="false" xref="A1.Ex22.m1.5.5.3.3.1.1.cmml">(</mo><mrow id="A1.Ex22.m1.5.5.3.3.1.1" xref="A1.Ex22.m1.5.5.3.3.1.1.cmml"><mi id="A1.Ex22.m1.5.5.3.3.1.1.2" xref="A1.Ex22.m1.5.5.3.3.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex22.m1.5.5.3.3.1.1.1" xref="A1.Ex22.m1.5.5.3.3.1.1.1.cmml">|</mo><mi id="A1.Ex22.m1.5.5.3.3.1.1.3" xref="A1.Ex22.m1.5.5.3.3.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex22.m1.5.5.3.3.1.3" stretchy="false" xref="A1.Ex22.m1.5.5.3.3.1.1.cmml">)</mo></mrow><mo id="A1.Ex22.m1.6.6.4.5a" lspace="0.167em" xref="A1.Ex22.m1.6.6.4.5.cmml">⁢</mo><mrow id="A1.Ex22.m1.6.6.4.4.1" xref="A1.Ex22.m1.6.6.4.4.2.cmml"><mi id="A1.Ex22.m1.4.4.2.2" xref="A1.Ex22.m1.4.4.2.2.cmml">exp</mi><mo id="A1.Ex22.m1.6.6.4.4.1a" xref="A1.Ex22.m1.6.6.4.4.2.cmml">⁡</mo><mrow id="A1.Ex22.m1.6.6.4.4.1.1" xref="A1.Ex22.m1.6.6.4.4.2.cmml"><mo id="A1.Ex22.m1.6.6.4.4.1.1.2" stretchy="false" xref="A1.Ex22.m1.6.6.4.4.2.cmml">(</mo><mrow id="A1.Ex22.m1.6.6.4.4.1.1.1" xref="A1.Ex22.m1.6.6.4.4.1.1.1.cmml"><mfrac id="A1.Ex22.m1.6.6.4.4.1.1.1.2" xref="A1.Ex22.m1.6.6.4.4.1.1.1.2.cmml"><mn id="A1.Ex22.m1.6.6.4.4.1.1.1.2.2" xref="A1.Ex22.m1.6.6.4.4.1.1.1.2.2.cmml">1</mn><mi id="A1.Ex22.m1.6.6.4.4.1.1.1.2.3" xref="A1.Ex22.m1.6.6.4.4.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.Ex22.m1.6.6.4.4.1.1.1.1" xref="A1.Ex22.m1.6.6.4.4.1.1.1.1.cmml">⁢</mo><mi id="A1.Ex22.m1.6.6.4.4.1.1.1.3" xref="A1.Ex22.m1.6.6.4.4.1.1.1.3.cmml">f</mi><mo id="A1.Ex22.m1.6.6.4.4.1.1.1.1a" xref="A1.Ex22.m1.6.6.4.4.1.1.1.1.cmml">⁢</mo><mrow id="A1.Ex22.m1.6.6.4.4.1.1.1.4.2" xref="A1.Ex22.m1.6.6.4.4.1.1.1.cmml"><mo id="A1.Ex22.m1.6.6.4.4.1.1.1.4.2.1" stretchy="false" xref="A1.Ex22.m1.6.6.4.4.1.1.1.cmml">(</mo><mi id="A1.Ex22.m1.3.3.1.1" xref="A1.Ex22.m1.3.3.1.1.cmml">x</mi><mo id="A1.Ex22.m1.6.6.4.4.1.1.1.4.2.2" stretchy="false" xref="A1.Ex22.m1.6.6.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex22.m1.6.6.4.4.1.1.3" stretchy="false" xref="A1.Ex22.m1.6.6.4.4.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A1.Ex22.m1.7.7.5" xref="A1.Ex22.m1.7.7.5.cmml"><msub id="A1.Ex22.m1.7.7.5.3" xref="A1.Ex22.m1.7.7.5.3.cmml"><mi id="A1.Ex22.m1.7.7.5.3.2" xref="A1.Ex22.m1.7.7.5.3.2.cmml">π</mi><mtext id="A1.Ex22.m1.7.7.5.3.3" xref="A1.Ex22.m1.7.7.5.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex22.m1.7.7.5.2" xref="A1.Ex22.m1.7.7.5.2.cmml">⁢</mo><mrow id="A1.Ex22.m1.7.7.5.1.1" xref="A1.Ex22.m1.7.7.5.1.1.1.cmml"><mo id="A1.Ex22.m1.7.7.5.1.1.2" stretchy="false" xref="A1.Ex22.m1.7.7.5.1.1.1.cmml">(</mo><mrow id="A1.Ex22.m1.7.7.5.1.1.1" xref="A1.Ex22.m1.7.7.5.1.1.1.cmml"><mi id="A1.Ex22.m1.7.7.5.1.1.1.2" xref="A1.Ex22.m1.7.7.5.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex22.m1.7.7.5.1.1.1.1" xref="A1.Ex22.m1.7.7.5.1.1.1.1.cmml">|</mo><mi id="A1.Ex22.m1.7.7.5.1.1.1.3" xref="A1.Ex22.m1.7.7.5.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex22.m1.7.7.5.1.1.3" stretchy="false" xref="A1.Ex22.m1.7.7.5.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex22.m1.15.16.9" xref="A1.Ex22.m1.15.16.9.cmml">=</mo><mrow id="A1.Ex22.m1.15.16.10" xref="A1.Ex22.m1.15.16.10.cmml"><mi id="A1.Ex22.m1.15.16.10.2" xref="A1.Ex22.m1.15.16.10.2.cmml">β</mi><mo id="A1.Ex22.m1.15.16.10.1" lspace="0.167em" xref="A1.Ex22.m1.15.16.10.1.cmml">⁢</mo><mrow id="A1.Ex22.m1.15.16.10.3" xref="A1.Ex22.m1.15.16.10.3.cmml"><mi id="A1.Ex22.m1.15.16.10.3.1" xref="A1.Ex22.m1.15.16.10.3.1.cmml">log</mi><mo id="A1.Ex22.m1.15.16.10.3a" lspace="0.167em" xref="A1.Ex22.m1.15.16.10.3.cmml">⁡</mo><mfrac id="A1.Ex22.m1.9.9" xref="A1.Ex22.m1.9.9.cmml"><mrow id="A1.Ex22.m1.8.8.1" xref="A1.Ex22.m1.8.8.1.cmml"><msup id="A1.Ex22.m1.8.8.1.3" xref="A1.Ex22.m1.8.8.1.3.cmml"><mi id="A1.Ex22.m1.8.8.1.3.2" xref="A1.Ex22.m1.8.8.1.3.2.cmml">π</mi><mo id="A1.Ex22.m1.8.8.1.3.3" xref="A1.Ex22.m1.8.8.1.3.3.cmml">′</mo></msup><mo id="A1.Ex22.m1.8.8.1.2" xref="A1.Ex22.m1.8.8.1.2.cmml">⁢</mo><mrow id="A1.Ex22.m1.8.8.1.1.1" xref="A1.Ex22.m1.8.8.1.1.1.1.cmml"><mo id="A1.Ex22.m1.8.8.1.1.1.2" stretchy="false" xref="A1.Ex22.m1.8.8.1.1.1.1.cmml">(</mo><mrow id="A1.Ex22.m1.8.8.1.1.1.1" xref="A1.Ex22.m1.8.8.1.1.1.1.cmml"><mi id="A1.Ex22.m1.8.8.1.1.1.1.2" xref="A1.Ex22.m1.8.8.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex22.m1.8.8.1.1.1.1.1" xref="A1.Ex22.m1.8.8.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex22.m1.8.8.1.1.1.1.3" xref="A1.Ex22.m1.8.8.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex22.m1.8.8.1.1.1.3" stretchy="false" xref="A1.Ex22.m1.8.8.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex22.m1.9.9.2" xref="A1.Ex22.m1.9.9.2.cmml"><msub id="A1.Ex22.m1.9.9.2.3" xref="A1.Ex22.m1.9.9.2.3.cmml"><mi id="A1.Ex22.m1.9.9.2.3.2" xref="A1.Ex22.m1.9.9.2.3.2.cmml">π</mi><mtext id="A1.Ex22.m1.9.9.2.3.3" xref="A1.Ex22.m1.9.9.2.3.3a.cmml">ref</mtext></msub><mo id="A1.Ex22.m1.9.9.2.2" xref="A1.Ex22.m1.9.9.2.2.cmml">⁢</mo><mrow id="A1.Ex22.m1.9.9.2.1.1" xref="A1.Ex22.m1.9.9.2.1.1.1.cmml"><mo id="A1.Ex22.m1.9.9.2.1.1.2" stretchy="false" xref="A1.Ex22.m1.9.9.2.1.1.1.cmml">(</mo><mrow id="A1.Ex22.m1.9.9.2.1.1.1" xref="A1.Ex22.m1.9.9.2.1.1.1.cmml"><mi id="A1.Ex22.m1.9.9.2.1.1.1.2" xref="A1.Ex22.m1.9.9.2.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.Ex22.m1.9.9.2.1.1.1.1" xref="A1.Ex22.m1.9.9.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex22.m1.9.9.2.1.1.1.3" xref="A1.Ex22.m1.9.9.2.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex22.m1.9.9.2.1.1.3" stretchy="false" xref="A1.Ex22.m1.9.9.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex22.m1.15b"><apply id="A1.Ex22.m1.15.16.cmml" xref="A1.Ex22.m1.15.16"><and id="A1.Ex22.m1.15.16a.cmml" xref="A1.Ex22.m1.15.16"></and><apply id="A1.Ex22.m1.15.16b.cmml" xref="A1.Ex22.m1.15.16"><eq id="A1.Ex22.m1.15.16.3.cmml" xref="A1.Ex22.m1.15.16.3"></eq><apply id="A1.Ex22.m1.15.16.2.cmml" xref="A1.Ex22.m1.15.16.2"><times id="A1.Ex22.m1.15.16.2.1.cmml" xref="A1.Ex22.m1.15.16.2.1"></times><apply id="A1.Ex22.m1.15.16.2.2.cmml" xref="A1.Ex22.m1.15.16.2.2"><csymbol cd="ambiguous" id="A1.Ex22.m1.15.16.2.2.1.cmml" xref="A1.Ex22.m1.15.16.2.2">superscript</csymbol><ci id="A1.Ex22.m1.15.16.2.2.2.cmml" xref="A1.Ex22.m1.15.16.2.2.2">𝑟</ci><ci id="A1.Ex22.m1.15.16.2.2.3.cmml" xref="A1.Ex22.m1.15.16.2.2.3">′</ci></apply><interval closure="open" id="A1.Ex22.m1.15.16.2.3.1.cmml" xref="A1.Ex22.m1.15.16.2.3.2"><ci id="A1.Ex22.m1.10.10.cmml" xref="A1.Ex22.m1.10.10">𝑥</ci><ci id="A1.Ex22.m1.11.11.cmml" xref="A1.Ex22.m1.11.11">𝑦</ci></interval></apply><apply id="A1.Ex22.m1.15.16.4.cmml" xref="A1.Ex22.m1.15.16.4"><plus id="A1.Ex22.m1.15.16.4.1.cmml" xref="A1.Ex22.m1.15.16.4.1"></plus><apply id="A1.Ex22.m1.15.16.4.2.cmml" xref="A1.Ex22.m1.15.16.4.2"><times id="A1.Ex22.m1.15.16.4.2.1.cmml" xref="A1.Ex22.m1.15.16.4.2.1"></times><ci id="A1.Ex22.m1.15.16.4.2.2.cmml" xref="A1.Ex22.m1.15.16.4.2.2">𝑟</ci><interval closure="open" id="A1.Ex22.m1.15.16.4.2.3.1.cmml" xref="A1.Ex22.m1.15.16.4.2.3.2"><ci id="A1.Ex22.m1.12.12.cmml" xref="A1.Ex22.m1.12.12">𝑥</ci><ci id="A1.Ex22.m1.13.13.cmml" xref="A1.Ex22.m1.13.13">𝑦</ci></interval></apply><apply id="A1.Ex22.m1.15.16.4.3.cmml" xref="A1.Ex22.m1.15.16.4.3"><times id="A1.Ex22.m1.15.16.4.3.1.cmml" xref="A1.Ex22.m1.15.16.4.3.1"></times><ci id="A1.Ex22.m1.15.16.4.3.2.cmml" xref="A1.Ex22.m1.15.16.4.3.2">𝑓</ci><ci id="A1.Ex22.m1.14.14.cmml" xref="A1.Ex22.m1.14.14">𝑥</ci></apply></apply></apply><apply id="A1.Ex22.m1.15.16c.cmml" xref="A1.Ex22.m1.15.16"><eq id="A1.Ex22.m1.15.16.5.cmml" xref="A1.Ex22.m1.15.16.5"></eq><share href="#A1.Ex22.m1.15.16.4.cmml" id="A1.Ex22.m1.15.16d.cmml" xref="A1.Ex22.m1.15.16"></share><apply id="A1.Ex22.m1.15.16.6.cmml" xref="A1.Ex22.m1.15.16.6"><plus id="A1.Ex22.m1.15.16.6.1.cmml" xref="A1.Ex22.m1.15.16.6.1"></plus><apply id="A1.Ex22.m1.15.16.6.2.cmml" xref="A1.Ex22.m1.15.16.6.2"><times id="A1.Ex22.m1.15.16.6.2.1.cmml" xref="A1.Ex22.m1.15.16.6.2.1"></times><ci id="A1.Ex22.m1.15.16.6.2.2.cmml" xref="A1.Ex22.m1.15.16.6.2.2">𝛽</ci><apply id="A1.Ex22.m1.15.16.6.2.3.cmml" xref="A1.Ex22.m1.15.16.6.2.3"><log id="A1.Ex22.m1.15.16.6.2.3.1.cmml" xref="A1.Ex22.m1.15.16.6.2.3.1"></log><apply id="A1.Ex22.m1.2.2.cmml" xref="A1.Ex22.m1.2.2"><divide id="A1.Ex22.m1.2.2.3.cmml" xref="A1.Ex22.m1.2.2"></divide><apply id="A1.Ex22.m1.1.1.1.cmml" xref="A1.Ex22.m1.1.1.1"><times id="A1.Ex22.m1.1.1.1.2.cmml" xref="A1.Ex22.m1.1.1.1.2"></times><ci id="A1.Ex22.m1.1.1.1.3.cmml" xref="A1.Ex22.m1.1.1.1.3">𝜋</ci><apply id="A1.Ex22.m1.1.1.1.1.1.1.cmml" xref="A1.Ex22.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex22.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex22.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex22.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex22.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.Ex22.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex22.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex22.m1.2.2.2.cmml" xref="A1.Ex22.m1.2.2.2"><times id="A1.Ex22.m1.2.2.2.2.cmml" xref="A1.Ex22.m1.2.2.2.2"></times><apply id="A1.Ex22.m1.2.2.2.3.cmml" xref="A1.Ex22.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex22.m1.2.2.2.3.1.cmml" xref="A1.Ex22.m1.2.2.2.3">subscript</csymbol><ci id="A1.Ex22.m1.2.2.2.3.2.cmml" xref="A1.Ex22.m1.2.2.2.3.2">𝜋</ci><ci id="A1.Ex22.m1.2.2.2.3.3a.cmml" xref="A1.Ex22.m1.2.2.2.3.3"><mtext id="A1.Ex22.m1.2.2.2.3.3.cmml" mathsize="70%" xref="A1.Ex22.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex22.m1.2.2.2.1.1.1.cmml" xref="A1.Ex22.m1.2.2.2.1.1"><csymbol cd="latexml" id="A1.Ex22.m1.2.2.2.1.1.1.1.cmml" xref="A1.Ex22.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex22.m1.2.2.2.1.1.1.2.cmml" xref="A1.Ex22.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.Ex22.m1.2.2.2.1.1.1.3.cmml" xref="A1.Ex22.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="A1.Ex22.m1.15.16.6.3.cmml" xref="A1.Ex22.m1.15.16.6.3"><times id="A1.Ex22.m1.15.16.6.3.1.cmml" xref="A1.Ex22.m1.15.16.6.3.1"></times><ci id="A1.Ex22.m1.15.16.6.3.2.cmml" xref="A1.Ex22.m1.15.16.6.3.2">𝑓</ci><ci id="A1.Ex22.m1.15.15.cmml" xref="A1.Ex22.m1.15.15">𝑥</ci></apply></apply></apply><apply id="A1.Ex22.m1.15.16e.cmml" xref="A1.Ex22.m1.15.16"><eq id="A1.Ex22.m1.15.16.7.cmml" xref="A1.Ex22.m1.15.16.7"></eq><share href="#A1.Ex22.m1.15.16.6.cmml" id="A1.Ex22.m1.15.16f.cmml" xref="A1.Ex22.m1.15.16"></share><apply id="A1.Ex22.m1.15.16.8.cmml" xref="A1.Ex22.m1.15.16.8"><times id="A1.Ex22.m1.15.16.8.1.cmml" xref="A1.Ex22.m1.15.16.8.1"></times><ci id="A1.Ex22.m1.15.16.8.2.cmml" xref="A1.Ex22.m1.15.16.8.2">𝛽</ci><apply id="A1.Ex22.m1.15.16.8.3.cmml" xref="A1.Ex22.m1.15.16.8.3"><log id="A1.Ex22.m1.15.16.8.3.1.cmml" xref="A1.Ex22.m1.15.16.8.3.1"></log><apply id="A1.Ex22.m1.7.7.cmml" xref="A1.Ex22.m1.7.7"><divide id="A1.Ex22.m1.7.7.6.cmml" xref="A1.Ex22.m1.7.7"></divide><apply id="A1.Ex22.m1.6.6.4.cmml" xref="A1.Ex22.m1.6.6.4"><times id="A1.Ex22.m1.6.6.4.5.cmml" xref="A1.Ex22.m1.6.6.4.5"></times><ci id="A1.Ex22.m1.6.6.4.6.cmml" xref="A1.Ex22.m1.6.6.4.6">𝜋</ci><apply id="A1.Ex22.m1.5.5.3.3.1.1.cmml" xref="A1.Ex22.m1.5.5.3.3.1"><csymbol cd="latexml" id="A1.Ex22.m1.5.5.3.3.1.1.1.cmml" xref="A1.Ex22.m1.5.5.3.3.1.1.1">conditional</csymbol><ci id="A1.Ex22.m1.5.5.3.3.1.1.2.cmml" xref="A1.Ex22.m1.5.5.3.3.1.1.2">𝑦</ci><ci id="A1.Ex22.m1.5.5.3.3.1.1.3.cmml" xref="A1.Ex22.m1.5.5.3.3.1.1.3">𝑥</ci></apply><apply id="A1.Ex22.m1.6.6.4.4.2.cmml" xref="A1.Ex22.m1.6.6.4.4.1"><exp id="A1.Ex22.m1.4.4.2.2.cmml" xref="A1.Ex22.m1.4.4.2.2"></exp><apply id="A1.Ex22.m1.6.6.4.4.1.1.1.cmml" xref="A1.Ex22.m1.6.6.4.4.1.1.1"><times id="A1.Ex22.m1.6.6.4.4.1.1.1.1.cmml" xref="A1.Ex22.m1.6.6.4.4.1.1.1.1"></times><apply id="A1.Ex22.m1.6.6.4.4.1.1.1.2.cmml" xref="A1.Ex22.m1.6.6.4.4.1.1.1.2"><divide id="A1.Ex22.m1.6.6.4.4.1.1.1.2.1.cmml" xref="A1.Ex22.m1.6.6.4.4.1.1.1.2"></divide><cn id="A1.Ex22.m1.6.6.4.4.1.1.1.2.2.cmml" type="integer" xref="A1.Ex22.m1.6.6.4.4.1.1.1.2.2">1</cn><ci id="A1.Ex22.m1.6.6.4.4.1.1.1.2.3.cmml" xref="A1.Ex22.m1.6.6.4.4.1.1.1.2.3">𝛽</ci></apply><ci id="A1.Ex22.m1.6.6.4.4.1.1.1.3.cmml" xref="A1.Ex22.m1.6.6.4.4.1.1.1.3">𝑓</ci><ci id="A1.Ex22.m1.3.3.1.1.cmml" xref="A1.Ex22.m1.3.3.1.1">𝑥</ci></apply></apply></apply><apply id="A1.Ex22.m1.7.7.5.cmml" xref="A1.Ex22.m1.7.7.5"><times id="A1.Ex22.m1.7.7.5.2.cmml" xref="A1.Ex22.m1.7.7.5.2"></times><apply id="A1.Ex22.m1.7.7.5.3.cmml" xref="A1.Ex22.m1.7.7.5.3"><csymbol cd="ambiguous" id="A1.Ex22.m1.7.7.5.3.1.cmml" xref="A1.Ex22.m1.7.7.5.3">subscript</csymbol><ci id="A1.Ex22.m1.7.7.5.3.2.cmml" xref="A1.Ex22.m1.7.7.5.3.2">𝜋</ci><ci id="A1.Ex22.m1.7.7.5.3.3a.cmml" xref="A1.Ex22.m1.7.7.5.3.3"><mtext id="A1.Ex22.m1.7.7.5.3.3.cmml" mathsize="70%" xref="A1.Ex22.m1.7.7.5.3.3">ref</mtext></ci></apply><apply id="A1.Ex22.m1.7.7.5.1.1.1.cmml" xref="A1.Ex22.m1.7.7.5.1.1"><csymbol cd="latexml" id="A1.Ex22.m1.7.7.5.1.1.1.1.cmml" xref="A1.Ex22.m1.7.7.5.1.1.1.1">conditional</csymbol><ci id="A1.Ex22.m1.7.7.5.1.1.1.2.cmml" xref="A1.Ex22.m1.7.7.5.1.1.1.2">𝑦</ci><ci id="A1.Ex22.m1.7.7.5.1.1.1.3.cmml" xref="A1.Ex22.m1.7.7.5.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.Ex22.m1.15.16g.cmml" xref="A1.Ex22.m1.15.16"><eq id="A1.Ex22.m1.15.16.9.cmml" xref="A1.Ex22.m1.15.16.9"></eq><share href="#A1.Ex22.m1.15.16.8.cmml" id="A1.Ex22.m1.15.16h.cmml" xref="A1.Ex22.m1.15.16"></share><apply id="A1.Ex22.m1.15.16.10.cmml" xref="A1.Ex22.m1.15.16.10"><times id="A1.Ex22.m1.15.16.10.1.cmml" xref="A1.Ex22.m1.15.16.10.1"></times><ci id="A1.Ex22.m1.15.16.10.2.cmml" xref="A1.Ex22.m1.15.16.10.2">𝛽</ci><apply id="A1.Ex22.m1.15.16.10.3.cmml" xref="A1.Ex22.m1.15.16.10.3"><log id="A1.Ex22.m1.15.16.10.3.1.cmml" xref="A1.Ex22.m1.15.16.10.3.1"></log><apply id="A1.Ex22.m1.9.9.cmml" xref="A1.Ex22.m1.9.9"><divide id="A1.Ex22.m1.9.9.3.cmml" xref="A1.Ex22.m1.9.9"></divide><apply id="A1.Ex22.m1.8.8.1.cmml" xref="A1.Ex22.m1.8.8.1"><times id="A1.Ex22.m1.8.8.1.2.cmml" xref="A1.Ex22.m1.8.8.1.2"></times><apply id="A1.Ex22.m1.8.8.1.3.cmml" xref="A1.Ex22.m1.8.8.1.3"><csymbol cd="ambiguous" id="A1.Ex22.m1.8.8.1.3.1.cmml" xref="A1.Ex22.m1.8.8.1.3">superscript</csymbol><ci id="A1.Ex22.m1.8.8.1.3.2.cmml" xref="A1.Ex22.m1.8.8.1.3.2">𝜋</ci><ci id="A1.Ex22.m1.8.8.1.3.3.cmml" xref="A1.Ex22.m1.8.8.1.3.3">′</ci></apply><apply id="A1.Ex22.m1.8.8.1.1.1.1.cmml" xref="A1.Ex22.m1.8.8.1.1.1"><csymbol cd="latexml" id="A1.Ex22.m1.8.8.1.1.1.1.1.cmml" xref="A1.Ex22.m1.8.8.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex22.m1.8.8.1.1.1.1.2.cmml" xref="A1.Ex22.m1.8.8.1.1.1.1.2">𝑦</ci><ci id="A1.Ex22.m1.8.8.1.1.1.1.3.cmml" xref="A1.Ex22.m1.8.8.1.1.1.1.3">𝑥</ci></apply></apply><apply id="A1.Ex22.m1.9.9.2.cmml" xref="A1.Ex22.m1.9.9.2"><times id="A1.Ex22.m1.9.9.2.2.cmml" xref="A1.Ex22.m1.9.9.2.2"></times><apply id="A1.Ex22.m1.9.9.2.3.cmml" xref="A1.Ex22.m1.9.9.2.3"><csymbol cd="ambiguous" id="A1.Ex22.m1.9.9.2.3.1.cmml" xref="A1.Ex22.m1.9.9.2.3">subscript</csymbol><ci id="A1.Ex22.m1.9.9.2.3.2.cmml" xref="A1.Ex22.m1.9.9.2.3.2">𝜋</ci><ci id="A1.Ex22.m1.9.9.2.3.3a.cmml" xref="A1.Ex22.m1.9.9.2.3.3"><mtext id="A1.Ex22.m1.9.9.2.3.3.cmml" mathsize="70%" xref="A1.Ex22.m1.9.9.2.3.3">ref</mtext></ci></apply><apply id="A1.Ex22.m1.9.9.2.1.1.1.cmml" xref="A1.Ex22.m1.9.9.2.1.1"><csymbol cd="latexml" id="A1.Ex22.m1.9.9.2.1.1.1.1.cmml" xref="A1.Ex22.m1.9.9.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex22.m1.9.9.2.1.1.1.2.cmml" xref="A1.Ex22.m1.9.9.2.1.1.1.2">𝑦</ci><ci id="A1.Ex22.m1.9.9.2.1.1.1.3.cmml" xref="A1.Ex22.m1.9.9.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex22.m1.15c">r^{\prime}(x,y)=r(x,y)+f(x)=\beta\log\frac{\pi(y|x)}{\pi_{\text{ref}}(y|x)}+f(%
x)=\beta\log\frac{\pi(y|x)\exp(\frac{1}{\beta}f(x))}{\pi_{\text{ref}}(y|x)}=%
\beta\log\frac{\pi^{\prime}(y|x)}{\pi_{\text{ref}}(y|x)}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex22.m1.15d">italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y ) = italic_r ( italic_x , italic_y ) + italic_f ( italic_x ) = italic_β roman_log divide start_ARG italic_π ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG + italic_f ( italic_x ) = italic_β roman_log divide start_ARG italic_π ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_f ( italic_x ) ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG = italic_β roman_log divide start_ARG italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS6.4.p2">
<p class="ltx_p" id="A1.SS6.4.p2.9">for all prompts <math alttext="x" class="ltx_Math" display="inline" id="A1.SS6.4.p2.1.m1.1"><semantics id="A1.SS6.4.p2.1.m1.1a"><mi id="A1.SS6.4.p2.1.m1.1.1" xref="A1.SS6.4.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.4.p2.1.m1.1b"><ci id="A1.SS6.4.p2.1.m1.1.1.cmml" xref="A1.SS6.4.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.4.p2.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.4.p2.1.m1.1d">italic_x</annotation></semantics></math> and completions <math alttext="y" class="ltx_Math" display="inline" id="A1.SS6.4.p2.2.m2.1"><semantics id="A1.SS6.4.p2.2.m2.1a"><mi id="A1.SS6.4.p2.2.m2.1.1" xref="A1.SS6.4.p2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.4.p2.2.m2.1b"><ci id="A1.SS6.4.p2.2.m2.1.1.cmml" xref="A1.SS6.4.p2.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.4.p2.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.4.p2.2.m2.1d">italic_y</annotation></semantics></math>. Then we must have <math alttext="\pi(y|x)\exp(\frac{1}{\beta}f(x))=\pi^{\prime}(y|x)" class="ltx_Math" display="inline" id="A1.SS6.4.p2.3.m3.5"><semantics id="A1.SS6.4.p2.3.m3.5a"><mrow id="A1.SS6.4.p2.3.m3.5.5" xref="A1.SS6.4.p2.3.m3.5.5.cmml"><mrow id="A1.SS6.4.p2.3.m3.4.4.2" xref="A1.SS6.4.p2.3.m3.4.4.2.cmml"><mi id="A1.SS6.4.p2.3.m3.4.4.2.4" xref="A1.SS6.4.p2.3.m3.4.4.2.4.cmml">π</mi><mo id="A1.SS6.4.p2.3.m3.4.4.2.3" xref="A1.SS6.4.p2.3.m3.4.4.2.3.cmml">⁢</mo><mrow id="A1.SS6.4.p2.3.m3.3.3.1.1.1" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.cmml"><mo id="A1.SS6.4.p2.3.m3.3.3.1.1.1.2" stretchy="false" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.SS6.4.p2.3.m3.3.3.1.1.1.1" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.cmml"><mi id="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.2" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.1" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.1.cmml">|</mo><mi id="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.3" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.4.p2.3.m3.3.3.1.1.1.3" stretchy="false" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="A1.SS6.4.p2.3.m3.4.4.2.3a" lspace="0.167em" xref="A1.SS6.4.p2.3.m3.4.4.2.3.cmml">⁢</mo><mrow id="A1.SS6.4.p2.3.m3.4.4.2.2.1" xref="A1.SS6.4.p2.3.m3.4.4.2.2.2.cmml"><mi id="A1.SS6.4.p2.3.m3.2.2" xref="A1.SS6.4.p2.3.m3.2.2.cmml">exp</mi><mo id="A1.SS6.4.p2.3.m3.4.4.2.2.1a" xref="A1.SS6.4.p2.3.m3.4.4.2.2.2.cmml">⁡</mo><mrow id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1" xref="A1.SS6.4.p2.3.m3.4.4.2.2.2.cmml"><mo id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.2" stretchy="false" xref="A1.SS6.4.p2.3.m3.4.4.2.2.2.cmml">(</mo><mrow id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.cmml"><mfrac id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.cmml"><mn id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.2" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.2.cmml">1</mn><mi id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.3" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.1" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.3" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.3.cmml">f</mi><mo id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.1a" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.1.cmml">⁢</mo><mrow id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.4.2" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.cmml"><mo id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.4.2.1" stretchy="false" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.cmml">(</mo><mi id="A1.SS6.4.p2.3.m3.1.1" xref="A1.SS6.4.p2.3.m3.1.1.cmml">x</mi><mo id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.4.2.2" stretchy="false" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.3" stretchy="false" xref="A1.SS6.4.p2.3.m3.4.4.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS6.4.p2.3.m3.5.5.4" xref="A1.SS6.4.p2.3.m3.5.5.4.cmml">=</mo><mrow id="A1.SS6.4.p2.3.m3.5.5.3" xref="A1.SS6.4.p2.3.m3.5.5.3.cmml"><msup id="A1.SS6.4.p2.3.m3.5.5.3.3" xref="A1.SS6.4.p2.3.m3.5.5.3.3.cmml"><mi id="A1.SS6.4.p2.3.m3.5.5.3.3.2" xref="A1.SS6.4.p2.3.m3.5.5.3.3.2.cmml">π</mi><mo id="A1.SS6.4.p2.3.m3.5.5.3.3.3" xref="A1.SS6.4.p2.3.m3.5.5.3.3.3.cmml">′</mo></msup><mo id="A1.SS6.4.p2.3.m3.5.5.3.2" xref="A1.SS6.4.p2.3.m3.5.5.3.2.cmml">⁢</mo><mrow id="A1.SS6.4.p2.3.m3.5.5.3.1.1" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.cmml"><mo id="A1.SS6.4.p2.3.m3.5.5.3.1.1.2" stretchy="false" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.cmml">(</mo><mrow id="A1.SS6.4.p2.3.m3.5.5.3.1.1.1" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.cmml"><mi id="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.2" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.2.cmml">y</mi><mo fence="false" id="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.1" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.1.cmml">|</mo><mi id="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.3" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.3.cmml">x</mi></mrow><mo id="A1.SS6.4.p2.3.m3.5.5.3.1.1.3" stretchy="false" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.4.p2.3.m3.5b"><apply id="A1.SS6.4.p2.3.m3.5.5.cmml" xref="A1.SS6.4.p2.3.m3.5.5"><eq id="A1.SS6.4.p2.3.m3.5.5.4.cmml" xref="A1.SS6.4.p2.3.m3.5.5.4"></eq><apply id="A1.SS6.4.p2.3.m3.4.4.2.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2"><times id="A1.SS6.4.p2.3.m3.4.4.2.3.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2.3"></times><ci id="A1.SS6.4.p2.3.m3.4.4.2.4.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2.4">𝜋</ci><apply id="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.cmml" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1"><csymbol cd="latexml" id="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.1.cmml" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.1">conditional</csymbol><ci id="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.2.cmml" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.2">𝑦</ci><ci id="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.3.cmml" xref="A1.SS6.4.p2.3.m3.3.3.1.1.1.1.3">𝑥</ci></apply><apply id="A1.SS6.4.p2.3.m3.4.4.2.2.2.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1"><exp id="A1.SS6.4.p2.3.m3.2.2.cmml" xref="A1.SS6.4.p2.3.m3.2.2"></exp><apply id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1"><times id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.1.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.1"></times><apply id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2"><divide id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.1.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2"></divide><cn id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.2.cmml" type="integer" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.2">1</cn><ci id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.3.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.2.3">𝛽</ci></apply><ci id="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.3.cmml" xref="A1.SS6.4.p2.3.m3.4.4.2.2.1.1.1.3">𝑓</ci><ci id="A1.SS6.4.p2.3.m3.1.1.cmml" xref="A1.SS6.4.p2.3.m3.1.1">𝑥</ci></apply></apply></apply><apply id="A1.SS6.4.p2.3.m3.5.5.3.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3"><times id="A1.SS6.4.p2.3.m3.5.5.3.2.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3.2"></times><apply id="A1.SS6.4.p2.3.m3.5.5.3.3.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3.3"><csymbol cd="ambiguous" id="A1.SS6.4.p2.3.m3.5.5.3.3.1.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3.3">superscript</csymbol><ci id="A1.SS6.4.p2.3.m3.5.5.3.3.2.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3.3.2">𝜋</ci><ci id="A1.SS6.4.p2.3.m3.5.5.3.3.3.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3.3.3">′</ci></apply><apply id="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1"><csymbol cd="latexml" id="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.1.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.1">conditional</csymbol><ci id="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.2.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.2">𝑦</ci><ci id="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.3.cmml" xref="A1.SS6.4.p2.3.m3.5.5.3.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.4.p2.3.m3.5c">\pi(y|x)\exp(\frac{1}{\beta}f(x))=\pi^{\prime}(y|x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.4.p2.3.m3.5d">italic_π ( italic_y | italic_x ) roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_f ( italic_x ) ) = italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_y | italic_x )</annotation></semantics></math>. Since these are distributions, summing over <math alttext="y" class="ltx_Math" display="inline" id="A1.SS6.4.p2.4.m4.1"><semantics id="A1.SS6.4.p2.4.m4.1a"><mi id="A1.SS6.4.p2.4.m4.1.1" xref="A1.SS6.4.p2.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.4.p2.4.m4.1b"><ci id="A1.SS6.4.p2.4.m4.1.1.cmml" xref="A1.SS6.4.p2.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.4.p2.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.4.p2.4.m4.1d">italic_y</annotation></semantics></math> on both sides, we obtain that <math alttext="\exp(\frac{1}{\beta}f(x))=1" class="ltx_Math" display="inline" id="A1.SS6.4.p2.5.m5.3"><semantics id="A1.SS6.4.p2.5.m5.3a"><mrow id="A1.SS6.4.p2.5.m5.3.3" xref="A1.SS6.4.p2.5.m5.3.3.cmml"><mrow id="A1.SS6.4.p2.5.m5.3.3.1.1" xref="A1.SS6.4.p2.5.m5.3.3.1.2.cmml"><mi id="A1.SS6.4.p2.5.m5.2.2" xref="A1.SS6.4.p2.5.m5.2.2.cmml">exp</mi><mo id="A1.SS6.4.p2.5.m5.3.3.1.1a" xref="A1.SS6.4.p2.5.m5.3.3.1.2.cmml">⁡</mo><mrow id="A1.SS6.4.p2.5.m5.3.3.1.1.1" xref="A1.SS6.4.p2.5.m5.3.3.1.2.cmml"><mo id="A1.SS6.4.p2.5.m5.3.3.1.1.1.2" stretchy="false" xref="A1.SS6.4.p2.5.m5.3.3.1.2.cmml">(</mo><mrow id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.cmml"><mfrac id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.cmml"><mn id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.2" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.2.cmml">1</mn><mi id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.3" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.3.cmml">β</mi></mfrac><mo id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.1" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.3" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.3.cmml">f</mi><mo id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.1a" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.4.2" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.cmml"><mo id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.4.2.1" stretchy="false" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.cmml">(</mo><mi id="A1.SS6.4.p2.5.m5.1.1" xref="A1.SS6.4.p2.5.m5.1.1.cmml">x</mi><mo id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.4.2.2" stretchy="false" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.4.p2.5.m5.3.3.1.1.1.3" stretchy="false" xref="A1.SS6.4.p2.5.m5.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="A1.SS6.4.p2.5.m5.3.3.2" xref="A1.SS6.4.p2.5.m5.3.3.2.cmml">=</mo><mn id="A1.SS6.4.p2.5.m5.3.3.3" xref="A1.SS6.4.p2.5.m5.3.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.4.p2.5.m5.3b"><apply id="A1.SS6.4.p2.5.m5.3.3.cmml" xref="A1.SS6.4.p2.5.m5.3.3"><eq id="A1.SS6.4.p2.5.m5.3.3.2.cmml" xref="A1.SS6.4.p2.5.m5.3.3.2"></eq><apply id="A1.SS6.4.p2.5.m5.3.3.1.2.cmml" xref="A1.SS6.4.p2.5.m5.3.3.1.1"><exp id="A1.SS6.4.p2.5.m5.2.2.cmml" xref="A1.SS6.4.p2.5.m5.2.2"></exp><apply id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.cmml" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1"><times id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.1.cmml" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.1"></times><apply id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.cmml" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2"><divide id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.1.cmml" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2"></divide><cn id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.2.cmml" type="integer" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.2">1</cn><ci id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.3.cmml" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.2.3">𝛽</ci></apply><ci id="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.3.cmml" xref="A1.SS6.4.p2.5.m5.3.3.1.1.1.1.3">𝑓</ci><ci id="A1.SS6.4.p2.5.m5.1.1.cmml" xref="A1.SS6.4.p2.5.m5.1.1">𝑥</ci></apply></apply><cn id="A1.SS6.4.p2.5.m5.3.3.3.cmml" type="integer" xref="A1.SS6.4.p2.5.m5.3.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.4.p2.5.m5.3c">\exp(\frac{1}{\beta}f(x))=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.4.p2.5.m5.3d">roman_exp ( divide start_ARG 1 end_ARG start_ARG italic_β end_ARG italic_f ( italic_x ) ) = 1</annotation></semantics></math> and since <math alttext="\beta>0" class="ltx_Math" display="inline" id="A1.SS6.4.p2.6.m6.1"><semantics id="A1.SS6.4.p2.6.m6.1a"><mrow id="A1.SS6.4.p2.6.m6.1.1" xref="A1.SS6.4.p2.6.m6.1.1.cmml"><mi id="A1.SS6.4.p2.6.m6.1.1.2" xref="A1.SS6.4.p2.6.m6.1.1.2.cmml">β</mi><mo id="A1.SS6.4.p2.6.m6.1.1.1" xref="A1.SS6.4.p2.6.m6.1.1.1.cmml">&gt;</mo><mn id="A1.SS6.4.p2.6.m6.1.1.3" xref="A1.SS6.4.p2.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.4.p2.6.m6.1b"><apply id="A1.SS6.4.p2.6.m6.1.1.cmml" xref="A1.SS6.4.p2.6.m6.1.1"><gt id="A1.SS6.4.p2.6.m6.1.1.1.cmml" xref="A1.SS6.4.p2.6.m6.1.1.1"></gt><ci id="A1.SS6.4.p2.6.m6.1.1.2.cmml" xref="A1.SS6.4.p2.6.m6.1.1.2">𝛽</ci><cn id="A1.SS6.4.p2.6.m6.1.1.3.cmml" type="integer" xref="A1.SS6.4.p2.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.4.p2.6.m6.1c">\beta&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.4.p2.6.m6.1d">italic_β &gt; 0</annotation></semantics></math>, we must have <math alttext="f(x)=0" class="ltx_Math" display="inline" id="A1.SS6.4.p2.7.m7.1"><semantics id="A1.SS6.4.p2.7.m7.1a"><mrow id="A1.SS6.4.p2.7.m7.1.2" xref="A1.SS6.4.p2.7.m7.1.2.cmml"><mrow id="A1.SS6.4.p2.7.m7.1.2.2" xref="A1.SS6.4.p2.7.m7.1.2.2.cmml"><mi id="A1.SS6.4.p2.7.m7.1.2.2.2" xref="A1.SS6.4.p2.7.m7.1.2.2.2.cmml">f</mi><mo id="A1.SS6.4.p2.7.m7.1.2.2.1" xref="A1.SS6.4.p2.7.m7.1.2.2.1.cmml">⁢</mo><mrow id="A1.SS6.4.p2.7.m7.1.2.2.3.2" xref="A1.SS6.4.p2.7.m7.1.2.2.cmml"><mo id="A1.SS6.4.p2.7.m7.1.2.2.3.2.1" stretchy="false" xref="A1.SS6.4.p2.7.m7.1.2.2.cmml">(</mo><mi id="A1.SS6.4.p2.7.m7.1.1" xref="A1.SS6.4.p2.7.m7.1.1.cmml">x</mi><mo id="A1.SS6.4.p2.7.m7.1.2.2.3.2.2" stretchy="false" xref="A1.SS6.4.p2.7.m7.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.SS6.4.p2.7.m7.1.2.1" xref="A1.SS6.4.p2.7.m7.1.2.1.cmml">=</mo><mn id="A1.SS6.4.p2.7.m7.1.2.3" xref="A1.SS6.4.p2.7.m7.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.4.p2.7.m7.1b"><apply id="A1.SS6.4.p2.7.m7.1.2.cmml" xref="A1.SS6.4.p2.7.m7.1.2"><eq id="A1.SS6.4.p2.7.m7.1.2.1.cmml" xref="A1.SS6.4.p2.7.m7.1.2.1"></eq><apply id="A1.SS6.4.p2.7.m7.1.2.2.cmml" xref="A1.SS6.4.p2.7.m7.1.2.2"><times id="A1.SS6.4.p2.7.m7.1.2.2.1.cmml" xref="A1.SS6.4.p2.7.m7.1.2.2.1"></times><ci id="A1.SS6.4.p2.7.m7.1.2.2.2.cmml" xref="A1.SS6.4.p2.7.m7.1.2.2.2">𝑓</ci><ci id="A1.SS6.4.p2.7.m7.1.1.cmml" xref="A1.SS6.4.p2.7.m7.1.1">𝑥</ci></apply><cn id="A1.SS6.4.p2.7.m7.1.2.3.cmml" type="integer" xref="A1.SS6.4.p2.7.m7.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.4.p2.7.m7.1c">f(x)=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.4.p2.7.m7.1d">italic_f ( italic_x ) = 0</annotation></semantics></math> for all <math alttext="x" class="ltx_Math" display="inline" id="A1.SS6.4.p2.8.m8.1"><semantics id="A1.SS6.4.p2.8.m8.1a"><mi id="A1.SS6.4.p2.8.m8.1.1" xref="A1.SS6.4.p2.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.4.p2.8.m8.1b"><ci id="A1.SS6.4.p2.8.m8.1.1.cmml" xref="A1.SS6.4.p2.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.4.p2.8.m8.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.4.p2.8.m8.1d">italic_x</annotation></semantics></math>. Therefore <math alttext="r(x,y)=r^{\prime}(x,y)" class="ltx_Math" display="inline" id="A1.SS6.4.p2.9.m9.4"><semantics id="A1.SS6.4.p2.9.m9.4a"><mrow id="A1.SS6.4.p2.9.m9.4.5" xref="A1.SS6.4.p2.9.m9.4.5.cmml"><mrow id="A1.SS6.4.p2.9.m9.4.5.2" xref="A1.SS6.4.p2.9.m9.4.5.2.cmml"><mi id="A1.SS6.4.p2.9.m9.4.5.2.2" xref="A1.SS6.4.p2.9.m9.4.5.2.2.cmml">r</mi><mo id="A1.SS6.4.p2.9.m9.4.5.2.1" xref="A1.SS6.4.p2.9.m9.4.5.2.1.cmml">⁢</mo><mrow id="A1.SS6.4.p2.9.m9.4.5.2.3.2" xref="A1.SS6.4.p2.9.m9.4.5.2.3.1.cmml"><mo id="A1.SS6.4.p2.9.m9.4.5.2.3.2.1" stretchy="false" xref="A1.SS6.4.p2.9.m9.4.5.2.3.1.cmml">(</mo><mi id="A1.SS6.4.p2.9.m9.1.1" xref="A1.SS6.4.p2.9.m9.1.1.cmml">x</mi><mo id="A1.SS6.4.p2.9.m9.4.5.2.3.2.2" xref="A1.SS6.4.p2.9.m9.4.5.2.3.1.cmml">,</mo><mi id="A1.SS6.4.p2.9.m9.2.2" xref="A1.SS6.4.p2.9.m9.2.2.cmml">y</mi><mo id="A1.SS6.4.p2.9.m9.4.5.2.3.2.3" stretchy="false" xref="A1.SS6.4.p2.9.m9.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS6.4.p2.9.m9.4.5.1" xref="A1.SS6.4.p2.9.m9.4.5.1.cmml">=</mo><mrow id="A1.SS6.4.p2.9.m9.4.5.3" xref="A1.SS6.4.p2.9.m9.4.5.3.cmml"><msup id="A1.SS6.4.p2.9.m9.4.5.3.2" xref="A1.SS6.4.p2.9.m9.4.5.3.2.cmml"><mi id="A1.SS6.4.p2.9.m9.4.5.3.2.2" xref="A1.SS6.4.p2.9.m9.4.5.3.2.2.cmml">r</mi><mo id="A1.SS6.4.p2.9.m9.4.5.3.2.3" xref="A1.SS6.4.p2.9.m9.4.5.3.2.3.cmml">′</mo></msup><mo id="A1.SS6.4.p2.9.m9.4.5.3.1" xref="A1.SS6.4.p2.9.m9.4.5.3.1.cmml">⁢</mo><mrow id="A1.SS6.4.p2.9.m9.4.5.3.3.2" xref="A1.SS6.4.p2.9.m9.4.5.3.3.1.cmml"><mo id="A1.SS6.4.p2.9.m9.4.5.3.3.2.1" stretchy="false" xref="A1.SS6.4.p2.9.m9.4.5.3.3.1.cmml">(</mo><mi id="A1.SS6.4.p2.9.m9.3.3" xref="A1.SS6.4.p2.9.m9.3.3.cmml">x</mi><mo id="A1.SS6.4.p2.9.m9.4.5.3.3.2.2" xref="A1.SS6.4.p2.9.m9.4.5.3.3.1.cmml">,</mo><mi id="A1.SS6.4.p2.9.m9.4.4" xref="A1.SS6.4.p2.9.m9.4.4.cmml">y</mi><mo id="A1.SS6.4.p2.9.m9.4.5.3.3.2.3" stretchy="false" xref="A1.SS6.4.p2.9.m9.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.4.p2.9.m9.4b"><apply id="A1.SS6.4.p2.9.m9.4.5.cmml" xref="A1.SS6.4.p2.9.m9.4.5"><eq id="A1.SS6.4.p2.9.m9.4.5.1.cmml" xref="A1.SS6.4.p2.9.m9.4.5.1"></eq><apply id="A1.SS6.4.p2.9.m9.4.5.2.cmml" xref="A1.SS6.4.p2.9.m9.4.5.2"><times id="A1.SS6.4.p2.9.m9.4.5.2.1.cmml" xref="A1.SS6.4.p2.9.m9.4.5.2.1"></times><ci id="A1.SS6.4.p2.9.m9.4.5.2.2.cmml" xref="A1.SS6.4.p2.9.m9.4.5.2.2">𝑟</ci><interval closure="open" id="A1.SS6.4.p2.9.m9.4.5.2.3.1.cmml" xref="A1.SS6.4.p2.9.m9.4.5.2.3.2"><ci id="A1.SS6.4.p2.9.m9.1.1.cmml" xref="A1.SS6.4.p2.9.m9.1.1">𝑥</ci><ci id="A1.SS6.4.p2.9.m9.2.2.cmml" xref="A1.SS6.4.p2.9.m9.2.2">𝑦</ci></interval></apply><apply id="A1.SS6.4.p2.9.m9.4.5.3.cmml" xref="A1.SS6.4.p2.9.m9.4.5.3"><times id="A1.SS6.4.p2.9.m9.4.5.3.1.cmml" xref="A1.SS6.4.p2.9.m9.4.5.3.1"></times><apply id="A1.SS6.4.p2.9.m9.4.5.3.2.cmml" xref="A1.SS6.4.p2.9.m9.4.5.3.2"><csymbol cd="ambiguous" id="A1.SS6.4.p2.9.m9.4.5.3.2.1.cmml" xref="A1.SS6.4.p2.9.m9.4.5.3.2">superscript</csymbol><ci id="A1.SS6.4.p2.9.m9.4.5.3.2.2.cmml" xref="A1.SS6.4.p2.9.m9.4.5.3.2.2">𝑟</ci><ci id="A1.SS6.4.p2.9.m9.4.5.3.2.3.cmml" xref="A1.SS6.4.p2.9.m9.4.5.3.2.3">′</ci></apply><interval closure="open" id="A1.SS6.4.p2.9.m9.4.5.3.3.1.cmml" xref="A1.SS6.4.p2.9.m9.4.5.3.3.2"><ci id="A1.SS6.4.p2.9.m9.3.3.cmml" xref="A1.SS6.4.p2.9.m9.3.3">𝑥</ci><ci id="A1.SS6.4.p2.9.m9.4.4.cmml" xref="A1.SS6.4.p2.9.m9.4.4">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.4.p2.9.m9.4c">r(x,y)=r^{\prime}(x,y)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.4.p2.9.m9.4d">italic_r ( italic_x , italic_y ) = italic_r start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_x , italic_y )</annotation></semantics></math>. This completes the proof. ∎</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_para" id="A1.SS6.p4">
<p class="ltx_p" id="A1.SS6.p4.1">우리는 이제 모든 보상 클래스가 그 클래스의 임의의 보상 함수에 대해 <math alttext="f(r,\pi_{\text{ref}},\beta)" class="ltx_Math" display="inline" id="A1.SS6.p4.1.m1.3"><semantics id="A1.SS6.p4.1.m1.3a"><mrow id="A1.SS6.p4.1.m1.3.3" xref="A1.SS6.p4.1.m1.3.3.cmml"><mi id="A1.SS6.p4.1.m1.3.3.3" xref="A1.SS6.p4.1.m1.3.3.3.cmml">f</mi><mo id="A1.SS6.p4.1.m1.3.3.2" xref="A1.SS6.p4.1.m1.3.3.2.cmml">⁢</mo><mrow id="A1.SS6.p4.1.m1.3.3.1.1" xref="A1.SS6.p4.1.m1.3.3.1.2.cmml"><mo id="A1.SS6.p4.1.m1.3.3.1.1.2" stretchy="false" xref="A1.SS6.p4.1.m1.3.3.1.2.cmml">(</mo><mi id="A1.SS6.p4.1.m1.1.1" xref="A1.SS6.p4.1.m1.1.1.cmml">r</mi><mo id="A1.SS6.p4.1.m1.3.3.1.1.3" xref="A1.SS6.p4.1.m1.3.3.1.2.cmml">,</mo><msub id="A1.SS6.p4.1.m1.3.3.1.1.1" xref="A1.SS6.p4.1.m1.3.3.1.1.1.cmml"><mi id="A1.SS6.p4.1.m1.3.3.1.1.1.2" xref="A1.SS6.p4.1.m1.3.3.1.1.1.2.cmml">π</mi><mtext id="A1.SS6.p4.1.m1.3.3.1.1.1.3" xref="A1.SS6.p4.1.m1.3.3.1.1.1.3a.cmml">ref</mtext></msub><mo id="A1.SS6.p4.1.m1.3.3.1.1.4" xref="A1.SS6.p4.1.m1.3.3.1.2.cmml">,</mo><mi id="A1.SS6.p4.1.m1.2.2" xref="A1.SS6.p4.1.m1.2.2.cmml">β</mi><mo id="A1.SS6.p4.1.m1.3.3.1.1.5" stretchy="false" xref="A1.SS6.p4.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p4.1.m1.3b"><apply id="A1.SS6.p4.1.m1.3.3.cmml" xref="A1.SS6.p4.1.m1.3.3"><times id="A1.SS6.p4.1.m1.3.3.2.cmml" xref="A1.SS6.p4.1.m1.3.3.2"></times><ci id="A1.SS6.p4.1.m1.3.3.3.cmml" xref="A1.SS6.p4.1.m1.3.3.3">𝑓</ci><vector id="A1.SS6.p4.1.m1.3.3.1.2.cmml" xref="A1.SS6.p4.1.m1.3.3.1.1"><ci id="A1.SS6.p4.1.m1.1.1.cmml" xref="A1.SS6.p4.1.m1.1.1">𝑟</ci><apply id="A1.SS6.p4.1.m1.3.3.1.1.1.cmml" xref="A1.SS6.p4.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.SS6.p4.1.m1.3.3.1.1.1.1.cmml" xref="A1.SS6.p4.1.m1.3.3.1.1.1">subscript</csymbol><ci id="A1.SS6.p4.1.m1.3.3.1.1.1.2.cmml" xref="A1.SS6.p4.1.m1.3.3.1.1.1.2">𝜋</ci><ci id="A1.SS6.p4.1.m1.3.3.1.1.1.3a.cmml" xref="A1.SS6.p4.1.m1.3.3.1.1.1.3"><mtext id="A1.SS6.p4.1.m1.3.3.1.1.1.3.cmml" mathsize="70%" xref="A1.SS6.p4.1.m1.3.3.1.1.1.3">ref</mtext></ci></apply><ci id="A1.SS6.p4.1.m1.2.2.cmml" xref="A1.SS6.p4.1.m1.2.2">𝛽</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p4.1.m1.3c">f(r,\pi_{\text{ref}},\beta)</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p4.1.m1.3d">italic_f ( italic_r , italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT , italic_β )</annotation></semantics></math>에 의해 주어지는 정리<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#Thmtheorem1" title="Theorem 1. ‣ 5.1 Your Language Model Is Secretly a Reward Model ‣ 5 Theoretical Analysis of DPO ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">1</span></a>에 요약된 바와 같이 표현될 수 있는 고유한 보상 함수를 갖는다는 것을 보여주었다.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>DPO Implementation Details and Hyperparameters</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">DPO는 구현하기가 비교적 간단하며; DPO 손실에 대한 PyTorch 코드는 아래에 제공된다:</p>
<div class="ltx_pagination ltx_role_newpage"></div>
<pre class="ltx_verbatim ltx_font_typewriter" id="A2.p1.2">import torch.nn.functional as F

def dpo_loss(pi_logps, ref_logps, yw_idxs, yl_idxs, beta):
    """
    pi_logps: policy logprobs, shape (B,)
    ref_logps: reference model logprobs, shape (B,)
    yw_idxs: preferred completion indices in [0, B-1], shape (T,)
    yl_idxs: dispreferred completion indices in [0, B-1], shape (T,)
    beta: temperature controlling strength of KL penalty

    Each pair of (yw_idxs[i], yl_idxs[i]) represents the
      indices of a single preference pair.
    """

    pi_yw_logps,  pi_yl_logps =  pi_logps[yw_idxs],  pi_logps[yl_idxs]
    ref_yw_logps, ref_yl_logps = ref_logps[yw_idxs], ref_logps[yl_idxs]

    pi_logratios  = pi_yw_logps - pi_yl_logps
    ref_logratios = ref_yw_logps - ref_yl_logps

    losses = -F.logsigmoid(beta * (pi_logratios - ref_logratios))
    rewards = beta * (pi_logps - ref_logps).detach()

    return losses, rewards
</pre>
</div>
<div class="ltx_para" id="A2.p2">
<p class="ltx_p" id="A2.p2.2">달리 언급되지 않는 한, 우리는 기본적으로 <math alttext="\beta=0.1" class="ltx_Math" display="inline" id="A2.p2.1.m1.1"><semantics id="A2.p2.1.m1.1a"><mrow id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml"><mi id="A2.p2.1.m1.1.1.2" xref="A2.p2.1.m1.1.1.2.cmml">β</mi><mo id="A2.p2.1.m1.1.1.1" xref="A2.p2.1.m1.1.1.1.cmml">=</mo><mn id="A2.p2.1.m1.1.1.3" xref="A2.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><apply id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1"><eq id="A2.p2.1.m1.1.1.1.cmml" xref="A2.p2.1.m1.1.1.1"></eq><ci id="A2.p2.1.m1.1.1.2.cmml" xref="A2.p2.1.m1.1.1.2">𝛽</ci><cn id="A2.p2.1.m1.1.1.3.cmml" type="float" xref="A2.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\beta=0.1</annotation><annotation encoding="application/x-llamapun" id="A2.p2.1.m1.1d">italic_β = 0.1</annotation></semantics></math>, <span class="ltx_text ltx_font_typewriter" id="A2.p2.2.1">64</span> 및 <span class="ltx_text ltx_font_typewriter" id="A2.p2.2.2">1e-6</span>의 학습률을 갖는 RMSprop 최적화기를 사용한다. 학습률을 <span class="ltx_text ltx_font_typewriter" id="A2.p2.2.3">0</span>에서 <span class="ltx_text ltx_font_typewriter" id="A2.p2.2.4">1e-6</span>에서 <span class="ltx_text ltx_font_typewriter" id="A2.p2.2.5">150</span> 단계로 선형 웜업합니다. TL;DR 요약의 경우 <math alttext="\beta=0.5" class="ltx_Math" display="inline" id="A2.p2.2.m2.1"><semantics id="A2.p2.2.m2.1a"><mrow id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml"><mi id="A2.p2.2.m2.1.1.2" xref="A2.p2.2.m2.1.1.2.cmml">β</mi><mo id="A2.p2.2.m2.1.1.1" xref="A2.p2.2.m2.1.1.1.cmml">=</mo><mn id="A2.p2.2.m2.1.1.3" xref="A2.p2.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><apply id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1"><eq id="A2.p2.2.m2.1.1.1.cmml" xref="A2.p2.2.m2.1.1.1"></eq><ci id="A2.p2.2.m2.1.1.2.cmml" xref="A2.p2.2.m2.1.1.2">𝛽</ci><cn id="A2.p2.2.m2.1.1.3.cmml" type="float" xref="A2.p2.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">\beta=0.5</annotation><annotation encoding="application/x-llamapun" id="A2.p2.2.m2.1d">italic_β = 0.5</annotation></semantics></math>를 사용하지만 나머지 매개변수는 동일하게 유지됩니다.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Further Details on the Experimental Set-Up</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">이 섹션에서는 실험 설계와 관련된 추가 세부 정보를 포함한다.</p>
</div>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>IMDb Sentiment Experiment and Baseline Details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1">프롬프트는 길이 2-8 토큰의 IMDB 데이터 세트의 접두사이다. 사전 학습된 감성 분류기 <span class="ltx_text ltx_font_typewriter" id="A3.SS1.p1.1.1">siebert/sentiment-roberta-large-english</span>을 ground-truth 보상 모델로 사용하고 <span class="ltx_text ltx_font_typewriter" id="A3.SS1.p1.1.2">gpt2-large</span>을 베이스 모델로 사용한다. 낮은 품질의 텍스트와 보상이 다소 부정확하다는 것을 발견했기 때문에 이러한 더 큰 모델을 사용한다. 우리는 먼저 1 에폭 동안 IMDB 데이터의 하위 집합에 대해 감독 미세 조정을 사용한다. 그런 다음 이 모델을 사용하여 25000개의 접두사에 대해 4개의 완료를 샘플링하고 그라운드-진실 보상 모델을 사용하여 각 접두사에 대해 6개의 선호도 쌍을 생성한다. RLHF 보상 모델은 <span class="ltx_text ltx_font_typewriter" id="A3.SS1.p1.1.3">gpt2-large</span> 모델에서 초기화되고 선호도 데이터 세트에서 3개의 에폭에 대해 훈련되며, 검증 세트 정확도가 가장 높은 체크포인트를 취한다. "TRL" 실행은 TRL 라이브러리의 하이퍼-파라미터를 사용한다. 구현은 PPO 단계당 1024개의 더 큰 배치 샘플을 사용합니다.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>GPT-4 prompts for computing summarization and dialogue win rates</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.1">실험 설정의 핵심 구성 요소는 GPT-4 승률 판단이다. 이 섹션에서는 요약 및 대화 실험을 위한 승률을 생성하는 데 사용되는 프롬프트를 포함한다. 우리는 모든 실험에 대해 <span class="ltx_text ltx_font_typewriter" id="A3.SS2.p1.1.1">gpt-4-0314</span>을 사용합니다. 요약 또는 반응의 순서는 모든 평가에 대해 무작위로 선택된다. <br class="ltx_break"/> <span class="ltx_text ltx_font_bold" id="A3.SS2.p1.1.2">Summarization GPT-4 win rate prompt (S). </span></p>
<pre class="ltx_verbatim ltx_font_typewriter" id="A3.SS2.p1.2">Which of the following summaries does a better job of summarizing the most \
important points in the given forum post?

Post:
&lt;post&gt;

Summary A:
&lt;Summary A&gt;

Summary B:
&lt;Summary B&gt;

FIRST provide a one-sentence comparison of the two summaries, explaining which \
you prefer and why. SECOND, on a new line, state only "A" or "B" to indicate your \
choice. Your response should use the format:
Comparison: &lt;one-sentence comparison and explanation&gt;
Preferred: &lt;"A" or "B"&gt;
</pre>
</div>
<div class="ltx_para" id="A3.SS2.p2">
<p class="ltx_p" id="A3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="A3.SS2.p2.1.1">Summarization GPT-4 win rate prompt (C). </span></p>
<pre class="ltx_verbatim ltx_font_typewriter" id="A3.SS2.p2.2">Which of the following summaries does a better job of summarizing the most \
important points in the given forum post, without including unimportant or \
irrelevant details? A good summary is both precise and concise.

Post:
&lt;post&gt;

Summary A:
&lt;Summary A&gt;

Summary B:
&lt;Summary B&gt;

FIRST provide a one-sentence comparison of the two summaries, explaining which \
you prefer and why. SECOND, on a new line, state only "A" or "B" to indicate your \
choice. Your response should use the format:
Comparison: &lt;one-sentence comparison and explanation&gt;
Preferred: &lt;"A" or "B"&gt;
</pre>
</div>
<div class="ltx_para" id="A3.SS2.p3">
<p class="ltx_p" id="A3.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="A3.SS2.p3.1.1">Dialogue GPT-4 win rate prompt. </span></p>
<pre class="ltx_verbatim ltx_font_typewriter" id="A3.SS2.p3.2">For the following query to a chatbot, which response is more helpful?

Query: &lt;the user query&gt;

Response A:
&lt;either the test method or baseline&gt;

Response B:
&lt;the other response&gt;

FIRST provide a one-sentence comparison of the two responses and explain \
which you feel is more helpful. SECOND, on a new line, state only "A" or \
"B" to indicate which response is more helpful. Your response should use \
the format:
Comparison: &lt;one-sentence comparison and explanation&gt;
More helpful: &lt;"A" or "B"&gt;
</pre>
</div>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Unlikelihood baseline</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.SS3.p1">
<p class="ltx_p" id="A3.SS3.p1.2">비우도 기준선인 <cite class="ltx_cite ltx_citemacro_citep">[Welleck et al., <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#bib.bib44" title="">2019</a>]</cite>(단순하게 선호 응답의 로그 확률인 <math alttext="\log p(y_{w}|x)" class="ltx_Math" display="inline" id="A3.SS3.p1.1.m1.1"><semantics id="A3.SS3.p1.1.m1.1a"><mrow id="A3.SS3.p1.1.m1.1.1" xref="A3.SS3.p1.1.m1.1.1.cmml"><mrow id="A3.SS3.p1.1.m1.1.1.3" xref="A3.SS3.p1.1.m1.1.1.3.cmml"><mi id="A3.SS3.p1.1.m1.1.1.3.1" xref="A3.SS3.p1.1.m1.1.1.3.1.cmml">log</mi><mo id="A3.SS3.p1.1.m1.1.1.3a" lspace="0.167em" xref="A3.SS3.p1.1.m1.1.1.3.cmml">⁡</mo><mi id="A3.SS3.p1.1.m1.1.1.3.2" xref="A3.SS3.p1.1.m1.1.1.3.2.cmml">p</mi></mrow><mo id="A3.SS3.p1.1.m1.1.1.2" xref="A3.SS3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A3.SS3.p1.1.m1.1.1.1.1" xref="A3.SS3.p1.1.m1.1.1.1.1.1.cmml"><mo id="A3.SS3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="A3.SS3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A3.SS3.p1.1.m1.1.1.1.1.1" xref="A3.SS3.p1.1.m1.1.1.1.1.1.cmml"><msub id="A3.SS3.p1.1.m1.1.1.1.1.1.2" xref="A3.SS3.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="A3.SS3.p1.1.m1.1.1.1.1.1.2.2" xref="A3.SS3.p1.1.m1.1.1.1.1.1.2.2.cmml">y</mi><mi id="A3.SS3.p1.1.m1.1.1.1.1.1.2.3" xref="A3.SS3.p1.1.m1.1.1.1.1.1.2.3.cmml">w</mi></msub><mo fence="false" id="A3.SS3.p1.1.m1.1.1.1.1.1.1" xref="A3.SS3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="A3.SS3.p1.1.m1.1.1.1.1.1.3" xref="A3.SS3.p1.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A3.SS3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="A3.SS3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.1.m1.1b"><apply id="A3.SS3.p1.1.m1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1"><times id="A3.SS3.p1.1.m1.1.1.2.cmml" xref="A3.SS3.p1.1.m1.1.1.2"></times><apply id="A3.SS3.p1.1.m1.1.1.3.cmml" xref="A3.SS3.p1.1.m1.1.1.3"><log id="A3.SS3.p1.1.m1.1.1.3.1.cmml" xref="A3.SS3.p1.1.m1.1.1.3.1"></log><ci id="A3.SS3.p1.1.m1.1.1.3.2.cmml" xref="A3.SS3.p1.1.m1.1.1.3.2">𝑝</ci></apply><apply id="A3.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="A3.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="A3.SS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="A3.SS3.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.SS3.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="A3.SS3.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.SS3.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="A3.SS3.p1.1.m1.1.1.1.1.1.2.2">𝑦</ci><ci id="A3.SS3.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="A3.SS3.p1.1.m1.1.1.1.1.1.2.3">𝑤</ci></apply><ci id="A3.SS3.p1.1.m1.1.1.1.1.1.3.cmml" xref="A3.SS3.p1.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.1.m1.1c">\log p(y_{w}|x)</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.1.m1.1d">roman_log italic_p ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math>를 최대화하는 반면, <math alttext="\log p(y_{l}|x)" class="ltx_Math" display="inline" id="A3.SS3.p1.2.m2.1"><semantics id="A3.SS3.p1.2.m2.1a"><mrow id="A3.SS3.p1.2.m2.1.1" xref="A3.SS3.p1.2.m2.1.1.cmml"><mrow id="A3.SS3.p1.2.m2.1.1.3" xref="A3.SS3.p1.2.m2.1.1.3.cmml"><mi id="A3.SS3.p1.2.m2.1.1.3.1" xref="A3.SS3.p1.2.m2.1.1.3.1.cmml">log</mi><mo id="A3.SS3.p1.2.m2.1.1.3a" lspace="0.167em" xref="A3.SS3.p1.2.m2.1.1.3.cmml">⁡</mo><mi id="A3.SS3.p1.2.m2.1.1.3.2" xref="A3.SS3.p1.2.m2.1.1.3.2.cmml">p</mi></mrow><mo id="A3.SS3.p1.2.m2.1.1.2" xref="A3.SS3.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="A3.SS3.p1.2.m2.1.1.1.1" xref="A3.SS3.p1.2.m2.1.1.1.1.1.cmml"><mo id="A3.SS3.p1.2.m2.1.1.1.1.2" stretchy="false" xref="A3.SS3.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A3.SS3.p1.2.m2.1.1.1.1.1" xref="A3.SS3.p1.2.m2.1.1.1.1.1.cmml"><msub id="A3.SS3.p1.2.m2.1.1.1.1.1.2" xref="A3.SS3.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="A3.SS3.p1.2.m2.1.1.1.1.1.2.2" xref="A3.SS3.p1.2.m2.1.1.1.1.1.2.2.cmml">y</mi><mi id="A3.SS3.p1.2.m2.1.1.1.1.1.2.3" xref="A3.SS3.p1.2.m2.1.1.1.1.1.2.3.cmml">l</mi></msub><mo fence="false" id="A3.SS3.p1.2.m2.1.1.1.1.1.1" xref="A3.SS3.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="A3.SS3.p1.2.m2.1.1.1.1.1.3" xref="A3.SS3.p1.2.m2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A3.SS3.p1.2.m2.1.1.1.1.3" stretchy="false" xref="A3.SS3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.2.m2.1b"><apply id="A3.SS3.p1.2.m2.1.1.cmml" xref="A3.SS3.p1.2.m2.1.1"><times id="A3.SS3.p1.2.m2.1.1.2.cmml" xref="A3.SS3.p1.2.m2.1.1.2"></times><apply id="A3.SS3.p1.2.m2.1.1.3.cmml" xref="A3.SS3.p1.2.m2.1.1.3"><log id="A3.SS3.p1.2.m2.1.1.3.1.cmml" xref="A3.SS3.p1.2.m2.1.1.3.1"></log><ci id="A3.SS3.p1.2.m2.1.1.3.2.cmml" xref="A3.SS3.p1.2.m2.1.1.3.2">𝑝</ci></apply><apply id="A3.SS3.p1.2.m2.1.1.1.1.1.cmml" xref="A3.SS3.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="A3.SS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="A3.SS3.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="A3.SS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="A3.SS3.p1.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.SS3.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="A3.SS3.p1.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="A3.SS3.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="A3.SS3.p1.2.m2.1.1.1.1.1.2.2">𝑦</ci><ci id="A3.SS3.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="A3.SS3.p1.2.m2.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="A3.SS3.p1.2.m2.1.1.1.1.1.3.cmml" xref="A3.SS3.p1.2.m2.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.2.m2.1c">\log p(y_{l}|x)</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.2.m2.1d">roman_log italic_p ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math>, 비선호 응답의 로그 확률인 <math>를 최소화)를 감성 실험에서 포함하지만, 일반적으로 무의미한 응답을 생성하기 때문에 요약이나 대화 실험에서 기준선으로 포함하지 않으며, 이는 비제약 우도 <span class="ltx_text ltx_font_italic" id="A3.SS3.p1.2.1">minimization</span>의 결과라고 생각한다.</p>
</div>
<figure class="ltx_table" id="A3.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T3.1.1.1">
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="A3.T3.1.1.1.1" style="width:184.9pt;"><span class="ltx_text ltx_font_bold ltx_align_top" id="A3.T3.1.1.1.1.1">Prompt</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="A3.T3.1.1.1.2" style="width:184.9pt;"><span class="ltx_text ltx_font_bold ltx_align_top" id="A3.T3.1.1.1.2.1">Response</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T3.1.2.1">
<td class="ltx_td ltx_align_justify ltx_border_t" id="A3.T3.1.2.1.1" style="width:184.9pt;">
<p class="ltx_p ltx_align_top" id="A3.T3.1.2.1.1.1">SUBREDDIT: r/relationships 
<br class="ltx_break">TITLE: The girl [26 F] I [22 M] have been seeing for a month didn’t respond to me at all yesterday while hanging out with a friend [&nbsp;30? M]. 
<br class="ltx_break">POST: She gets terrible service while at her house, but I texted her 3 times yesterday, 4-5 hours apart. She didn’t call me until early this morning and left a voicemail that she was busy all day with a friend who showed up out of the blue. 
<br class="ltx_break">I saw that she posted a picture of the two of them out of her dead zone house on facebook before I texted her the last time. 
<br class="ltx_break">I don’t mind that she hangs out with friends, and I know it’s pretty early […]
TL;DR:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A3.T3.1.2.1.2" style="width:184.9pt;">
<p class="ltx_p ltx_align_top" id="A3.T3.1.2.1.2.1">girl when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when whenUB when when when when whenUB when when when whenUB</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A3.T3.1.3.2">
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A3.T3.1.3.2.1" style="width:184.9pt;">
<p class="ltx_p ltx_align_top" id="A3.T3.1.3.2.1.1">SUBREDDIT: r/tifu 
<br class="ltx_break">TITLE: TIFU by accidently kicking an old woman 
<br class="ltx_break">POST: So this didn’t happen today but actually about a year or two ago. 
<br class="ltx_break">I was at my granddads funeral so of course it was all very sad and full of lots of crying old people. After the ceremony everyone walks outside the building and onto the other side of the small road the hearses drive down. Now the road is important because obviously if there’s a road, there’s a curb onto the sidewalk, so most of us are on the other side of the road, besides a few older people walking a lot slower. 
<br class="ltx_break">As one of the old woman goes to walk up the curb […] TL;DR:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A3.T3.1.3.2.2" style="width:184.9pt;">
<p class="ltx_p ltx_align_top" id="A3.T3.1.3.2.2.1">when an old woman was tripping the when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when when</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 3: </span>TL로부터의 Unlikelihood 샘플; 온도 1.0에서 샘플링된 DR 프롬프트. 일반적으로, 우리는 Unlikelihood가 요약 및 대화와 같은 더 복잡한 문제에 대해 의미 있는 응답을 생성하지 못한다는 것을 발견한다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Additional Empirical Results</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Performance of Best of <math alttext="N" class="ltx_Math" display="inline" id="A4.SS1.1.m1.1"><semantics id="A4.SS1.1.m1.1b"><mi id="A4.SS1.1.m1.1.1" xref="A4.SS1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.1.m1.1c"><ci id="A4.SS1.1.m1.1.1.cmml" xref="A4.SS1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.1.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.1.m1.1e">italic_N</annotation></semantics></math> baseline for Various <math alttext="N" class="ltx_Math" display="inline" id="A4.SS1.2.m2.1"><semantics id="A4.SS1.2.m2.1b"><mi id="A4.SS1.2.m2.1.1" xref="A4.SS1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.2.m2.1c"><ci id="A4.SS1.2.m2.1.1.cmml" xref="A4.SS1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.2.m2.1d">N</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.2.m2.1e">italic_N</annotation></semantics></math>
</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.3">우리는 실험에서 <math alttext="N" class="ltx_Math" display="inline" id="A4.SS1.p1.1.m1.1"><semantics id="A4.SS1.p1.1.m1.1a"><mi id="A4.SS1.p1.1.m1.1.1" xref="A4.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.1.m1.1b"><ci id="A4.SS1.p1.1.m1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p1.1.m1.1d">italic_N</annotation></semantics></math> 기준선 중 Best가 (계산적으로 비싸지만 샘플링을 여러 번 필요로 함) 강한 기준선임을 발견했다. 우리는 Anthropic-HH 대화 및 TL에 대한 다양한 <math alttext="N" class="ltx_Math" display="inline" id="A4.SS1.p1.3.m3.1"><semantics id="A4.SS1.p1.3.m3.1a"><mi id="A4.SS1.p1.3.m3.1.1" xref="A4.SS1.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.3.m3.1b"><ci id="A4.SS1.p1.3.m3.1.1.cmml" xref="A4.SS1.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p1.3.m3.1d">italic_N</annotation></semantics></math>에 대한 <math alttext="N" class="ltx_Math" display="inline" id="A4.SS1.p1.2.m2.1"><semantics id="A4.SS1.p1.2.m2.1a"><mi id="A4.SS1.p1.2.m2.1.1" xref="A4.SS1.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.2.m2.1b"><ci id="A4.SS1.p1.2.m2.1.1.cmml" xref="A4.SS1.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p1.2.m2.1d">italic_N</annotation></semantics></math> 기준선의 평가;DR 요약; 결과는 그림 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.F4" title="Figure 4 ‣ D.1 Performance of Best of 𝑁 baseline for Various 𝑁 ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>에 나와 있다.</p>
</div>
<figure class="ltx_figure" id="A4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" height="305" id="A4.F4.g1" src="https://arxiv.org/html/2305.18290v2/x5.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" height="305" id="A4.F4.g2" src="https://arxiv.org/html/2305.18290v2/x6.png" width="407"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Best of <math alttext="N" class="ltx_Math" display="inline" id="A4.F4.3.m1.1"><semantics id="A4.F4.3.m1.1b"><mi id="A4.F4.3.m1.1.1" xref="A4.F4.3.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A4.F4.3.m1.1c"><ci id="A4.F4.3.m1.1.1.cmml" xref="A4.F4.3.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.F4.3.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="A4.F4.3.m1.1e">italic_N</annotation></semantics></math> baseline for <math alttext="N=\{1,4,16,64,128\}" class="ltx_Math" display="inline" id="A4.F4.4.m2.5"><semantics id="A4.F4.4.m2.5b"><mrow id="A4.F4.4.m2.5.6" xref="A4.F4.4.m2.5.6.cmml"><mi id="A4.F4.4.m2.5.6.2" xref="A4.F4.4.m2.5.6.2.cmml">N</mi><mo id="A4.F4.4.m2.5.6.1" xref="A4.F4.4.m2.5.6.1.cmml">=</mo><mrow id="A4.F4.4.m2.5.6.3.2" xref="A4.F4.4.m2.5.6.3.1.cmml"><mo id="A4.F4.4.m2.5.6.3.2.1" stretchy="false" xref="A4.F4.4.m2.5.6.3.1.cmml">{</mo><mn id="A4.F4.4.m2.1.1" xref="A4.F4.4.m2.1.1.cmml">1</mn><mo id="A4.F4.4.m2.5.6.3.2.2" xref="A4.F4.4.m2.5.6.3.1.cmml">,</mo><mn id="A4.F4.4.m2.2.2" xref="A4.F4.4.m2.2.2.cmml">4</mn><mo id="A4.F4.4.m2.5.6.3.2.3" xref="A4.F4.4.m2.5.6.3.1.cmml">,</mo><mn id="A4.F4.4.m2.3.3" xref="A4.F4.4.m2.3.3.cmml">16</mn><mo id="A4.F4.4.m2.5.6.3.2.4" xref="A4.F4.4.m2.5.6.3.1.cmml">,</mo><mn id="A4.F4.4.m2.4.4" xref="A4.F4.4.m2.4.4.cmml">64</mn><mo id="A4.F4.4.m2.5.6.3.2.5" xref="A4.F4.4.m2.5.6.3.1.cmml">,</mo><mn id="A4.F4.4.m2.5.5" xref="A4.F4.4.m2.5.5.cmml">128</mn><mo id="A4.F4.4.m2.5.6.3.2.6" stretchy="false" xref="A4.F4.4.m2.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.F4.4.m2.5c"><apply id="A4.F4.4.m2.5.6.cmml" xref="A4.F4.4.m2.5.6"><eq id="A4.F4.4.m2.5.6.1.cmml" xref="A4.F4.4.m2.5.6.1"></eq><ci id="A4.F4.4.m2.5.6.2.cmml" xref="A4.F4.4.m2.5.6.2">𝑁</ci><set id="A4.F4.4.m2.5.6.3.1.cmml" xref="A4.F4.4.m2.5.6.3.2"><cn id="A4.F4.4.m2.1.1.cmml" type="integer" xref="A4.F4.4.m2.1.1">1</cn><cn id="A4.F4.4.m2.2.2.cmml" type="integer" xref="A4.F4.4.m2.2.2">4</cn><cn id="A4.F4.4.m2.3.3.cmml" type="integer" xref="A4.F4.4.m2.3.3">16</cn><cn id="A4.F4.4.m2.4.4.cmml" type="integer" xref="A4.F4.4.m2.4.4">64</cn><cn id="A4.F4.4.m2.5.5.cmml" type="integer" xref="A4.F4.4.m2.5.5">128</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F4.4.m2.5d">N=\{1,4,16,64,128\}</annotation><annotation encoding="application/x-llamapun" id="A4.F4.4.m2.5e">italic_N = { 1 , 4 , 16 , 64 , 128 }</annotation></semantics></math>. Performance plateaus after roughly 64-128 samples.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Sample Responses and GPT-4 Judgments</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS2.p1">
<p class="ltx_p" id="A4.SS2.p1.1">이 절에서는 DPO와 기준선(요약용 PPO 온도 0, 대화용 진실 선택 응답) 간의 비교 사례를 제시한다. 요약 예시는 Tables <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.T4" title="Table 4 ‣ D.2 Sample Responses and GPT-4 Judgments ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">4</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.T6" title="Table 6 ‣ D.2 Sample Responses and GPT-4 Judgments ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">6</span></a>를 참조하고, 대화 예시는 Tables <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.T7" title="Table 7 ‣ D.2 Sample Responses and GPT-4 Judgments ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">7</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.T10" title="Table 10 ‣ D.2 Sample Responses and GPT-4 Judgments ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">10</span></a>를 참조한다.</p>
</div>
<figure class="ltx_table" id="A4.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A4.T4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T4.1.1.1.1.1">Prompt</span></th>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="A4.T4.1.1.1.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T4.1.1.1.2.1">SUBREDDIT: r/AskReddit
TITLE: I’ve been ungrateful to parents who have wanted only the best for me for the longest time. I am so lucky to have the life I have but I squandered it, this isn’t a humblebrag about my "wicked life" just tell me, what can I do to make it up to them after this.
POST: I’m 17, leaving for University, and I’ve had epiphany after epiphany of how shitty i’ve beent to them, or how all the nice things they do I ruin with moods etc., I know there isn’t a quick fix, but I want to do something nice. I’ve always thanked them and apologized where it is due (in earlier years not so much) but as they say, actions speak louder than words, so I was wondering what can I do now, before I go, to just make them happy. What can I keep doing, I know all the little things, doing chores, keeping my room clean, cleaning up after myself, helping around the house, but what’s a big thing, for say christmas, or their birthdays, that I can do to make them happy?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T4.1.2.2.1"><span class="ltx_text ltx_font_bold" id="A4.T4.1.2.2.1.1">DPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T4.1.2.2.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T4.1.2.2.2.1">TL;DR: I’ve been a shitty child and I want to make up for it, what can I do for my parents on their birthdays and christmas to show them how much I love them?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T4.1.3.3.1"><span class="ltx_text ltx_font_bold" id="A4.T4.1.3.3.1.1">PPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T4.1.3.3.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T4.1.3.3.2.1">TL;DR: I’ve been a shitty person to my parents, what can I do to make it up to them, before I go, and what can I do after university to make them happy, and what can I do to make them happy after university (if that is the case)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A4.T4.1.4.4.1"><span class="ltx_text ltx_font_bold" id="A4.T4.1.4.4.1.1">Judgment</span></th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A4.T4.1.4.4.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T4.1.4.4.2.1">Summary B <span class="ltx_text ltx_font_bold" id="A4.T4.1.4.4.2.1.1">[DPO]</span> more effectively captures the main points of the post by focusing on making the parents happy through gestures on special occasions, while Summary A seems repetitive and less clear.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 4:</span>TL;DR 테스트 세트로부터의 포스트에 대한 샘플 요약. <span class="ltx_text ltx_font_bold" id="A4.T4.5.1">DPO</span> 온도가 0.25로 생성된 샘플; <span class="ltx_text ltx_font_bold" id="A4.T4.6.2">PPO</span> 온도가 0으로 생성된 샘플. GPT-4로 평가할 때 요약이 랜덤으로 제시되는 순서이므로 판단에서의 순서는 테이블의 순서와 일치하지 않을 수 있다. 명확성을 위해 사후 주석은 <span class="ltx_text ltx_font_bold" id="A4.T4.7.3">[annotation]</span>으로 형식이 지정된 굵은 글씨로 포함됩니다. 이러한 주석은 모델 세대의 일부가 아닙니다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A4.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A4.T5.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.1">Prompt</span></th>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="A4.T5.1.1.1.2" style="width:327.2pt;">
<div class="ltx_block ltx_align_top" id="A4.T5.1.1.1.2.1">
<p class="ltx_p" id="A4.T5.1.1.1.2.1.1">서브레드디트: r/relationships TITLE: 나[22M]는 거의 2년의 여자친구[22F]에게 프러포즈하려고 하는데, 나는 포스트를 진정시킬 수 없다: 좋아, 그래서 나는 거의 2년의 여자친구에게 프러포즈할 준비를 하고 있다(우리는 그 전에 두 배의 친구였다) 그리고 나는 불안하고 초조해지기 시작한다. 우리는 몇 달 동안 이것에 대해 이야기했고, 나는 그녀가 승낙할 것이라는 것을 알지만, 나는 긴장을 풀 수 없는 것 같다.</p>
<p class="ltx_p" id="A4.T5.1.1.1.2.1.2">요전 날 반지를 샀는데, 나 자신과 사랑에 빠졌고 그녀도 그럴 거라는 걸 알았어. 그리고 이틀 전에, 나는 그녀의 아버지의 축복을 요청했다. 지금까지 모든 것이 좋아졌지만, 이제 그것으로 넘어가면, 나는 다른 어떤 것도 생각할 수 없다. 잠이 안 와 나는 몹시 불안하고, 내가 하고 싶은 것은 지금 청혼하는 것뿐이지만, 나는 목요일까지 그녀를 보지 못하기 때문에 기다려야 한다.</p>
<p class="ltx_p" id="A4.T5.1.1.1.2.1.3">나는 내가 그것을 어떻게 할지 안다. 나는 그것을 철저히 계획했고 나는 준비 이상이다. 하지만, 동시에, 나는 기겁하고 있다. 얼마 전에 결혼해서 가장 친한 친구에게 조언을 구했는데, 그가 할 수 있는 말은 "물어보기 직전에 10배는 더 나빠질 것 같다"는 것뿐이었다.</p>
<p class="ltx_p" id="A4.T5.1.1.1.2.1.4">그 때까지 긴장을 푸는 방법에 대한 제안 사항이 있습니까? 나는 잠을 잘 수 있었으면 좋겠어.</p>
</div>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T5.1.2.2.1"><span class="ltx_text ltx_font_bold" id="A4.T5.1.2.2.1.1">DPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T5.1.2.2.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T5.1.2.2.2.1">TL;DR: About to propose to my girlfriend of almost 2 years, but I am extremely anxious and can’t sleep. How can I relax?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T5.1.3.3.1"><span class="ltx_text ltx_font_bold" id="A4.T5.1.3.3.1.1">PPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T5.1.3.3.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T5.1.3.3.2.1">TL;DR: I am about to ask my girlfriend of almost 2 years to marry me, and I can’t calm myself down. Any tips on how to relax? I would like to be able to sleep tonight (and the night before)………………………………………………………………………………………………………………</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A4.T5.1.4.4.1"><span class="ltx_text ltx_font_bold" id="A4.T5.1.4.4.1.1">Judgment</span></th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A4.T5.1.4.4.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T5.1.4.4.2.1">Summary A <span class="ltx_text ltx_font_bold" id="A4.T5.1.4.4.2.1.1">[DPO]</span> more effectively summarizes the main points of the post, concisely conveying the asker’s anxiety and goal of finding ways to relax.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 5:</span>TL;DR 테스트 세트로부터의 포스트에 대한 샘플 요약. <span class="ltx_text ltx_font_bold" id="A4.T5.5.1">DPO</span> 온도가 0.25로 생성된 샘플; <span class="ltx_text ltx_font_bold" id="A4.T5.6.2">PPO</span> 온도가 0으로 생성된 샘플. GPT-4로 평가할 때 요약이 랜덤으로 제시되는 순서이므로 판단에서의 순서는 테이블의 순서와 일치하지 않을 수 있다. 명확성을 위해 사후 주석은 <span class="ltx_text ltx_font_bold" id="A4.T5.7.3">[annotation]</span>으로 형식이 지정된 굵은 글씨로 포함됩니다. 이러한 주석은 모델 세대의 일부가 아닙니다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A4.T6">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T6.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T6.1.1.1.1.1">Prompt</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="A4.T6.1.1.1.2" style="width:327.2pt;">
<div class="ltx_block ltx_align_top" id="A4.T6.1.1.1.2.1">
<p class="ltx_p" id="A4.T6.1.1.1.2.1.1">나는 파스타를 좋아하기 때문에 저칼로리 파스타를 찾고 있었고, 그것은 만들기 쉽고 일주일에 여러 번 먹었기 때문이다. 통곡물 파스타는 이상한 맛/질감을 가지고 있고, 저는 그것을 좋아하지 않습니다.</p>
<p class="ltx_p" id="A4.T6.1.1.1.2.1.2">스파게티 스쿼시(다음엔 식료품 목록에 포함)에 대해 조사를 하고 있었는데, 어떤 사람이 고섬유질 파스타 브랜드에 대해 격찬하는 소리를 들어서 알아봤습니다.</p>
<p class="ltx_p" id="A4.T6.1.1.1.2.1.3">이게 무슨 마법이야? 그것은 일반 파스타의 모든 포장을 가지고 있지만(그리고 내가 읽은 리뷰는 맛도 같다고 말한다) 칼로리의 반을 약간 넘는다. 파스타를 얼마나 많이 더 먹을 수 있는지 정말 놀라워요! 나는 이것이 세계를 휩쓸지 않았다는 것을 믿을 수 없다. 그래서 나는 그 함정이 무엇인지 궁금하다.</p>
</div>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T6.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T6.1.2.1.1"><span class="ltx_text ltx_font_bold" id="A4.T6.1.2.1.1.1">DPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T6.1.2.1.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T6.1.2.1.2.1">TL;DR: I’m trying to cut back on calories and pasta is one of my main sources. Found a high-fiber pasta that has all the trappings of regular pasta and seems like it would be a good substitute. Is it bullshit?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T6.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T6.1.3.2.1"><span class="ltx_text ltx_font_bold" id="A4.T6.1.3.2.1.1">PPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T6.1.3.2.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T6.1.3.2.2.1">TL;DR: I want to lose weight, but I love pasta and don’t want to give it up. Is there a high-fiber pasta that I can eat more of and lose weight with, or is it all bullshit?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T6.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A4.T6.1.4.3.1"><span class="ltx_text ltx_font_bold" id="A4.T6.1.4.3.1.1">Judgment</span></th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A4.T6.1.4.3.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T6.1.4.3.2.1">Summary B <span class="ltx_text ltx_font_bold" id="A4.T6.1.4.3.2.1.1">[DPO]</span> more accurately captures the intent to find a low-calorie pasta alternative, without assuming the need for weight loss.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 6:</span>TL;DR 테스트 세트로부터의 포스트에 대한 샘플 요약. <span class="ltx_text ltx_font_bold" id="A4.T6.5.1">DPO</span> 온도가 0.25로 생성된 샘플; <span class="ltx_text ltx_font_bold" id="A4.T6.6.2">PPO</span> 온도가 0으로 생성된 샘플. GPT-4로 평가할 때 요약이 랜덤으로 제시되는 순서이므로 판단에서의 순서는 테이블의 순서와 일치하지 않을 수 있다. 명확성을 위해 사후 주석은 <span class="ltx_text ltx_font_bold" id="A4.T6.7.3">[annotation]</span>으로 형식이 지정된 굵은 글씨로 포함됩니다. 이러한 주석은 모델 세대의 일부가 아닙니다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A4.T7">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T7.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T7.1.1.1.1.1">Prompt</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="A4.T7.1.1.1.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T7.1.1.1.2.1">Can you help me write an essay on the Civil Rights Movement?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T7.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T7.1.2.1.1"><span class="ltx_text ltx_font_bold" id="A4.T7.1.2.1.1.1">DPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T7.1.2.1.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T7.1.2.1.2.1">The Civil Rights Movement was a series of social and political movements that took place between the 1950s and the 1980s, leading to the integration of public spaces, higher education, employment, and voting rights. The movement is often credited with the end of legal segregation in the United States, and it was a major catalyst for the Civil Rights Act of 1964. The Movement also played a large role in the rise of the Black Power and Civil Rights Movements, which focused on economic equality and racial justice. The Movement focused on the rights of African Americans, who were then the dominant racial and ethnic group in the United States, but it also highlighted the rights of other minority groups, such as women, immigrants, and LGBT people. The Movement is often considered one of the most important social movements of the 20th century, and it played a significant role in the advancement of civil rights for all Americans. I’ll be happy to write an essay on this topic for you. What kind of essay would you like? A paper on the history of the Civil Rights Movement? A paper on the causes of the Civil Rights Movement? Or a paper on the effects of the Civil Rights Movement? Any ideas? I’ll be happy to <span class="ltx_text ltx_font_bold" id="A4.T7.1.2.1.2.1.1">[maximum generation length reached]</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T7.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T7.1.3.2.1"><span class="ltx_text ltx_font_bold" id="A4.T7.1.3.2.1.1">GT</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T7.1.3.2.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T7.1.3.2.2.1">Oh, I’m not sure if I can actually write an essay, but I can at least help you think through the process. First, can you tell me what you’re trying to write about? In other words, what are the main points or questions you want to address?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T7.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A4.T7.1.4.3.1"><span class="ltx_text ltx_font_bold" id="A4.T7.1.4.3.1.1">Judgment</span></th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A4.T7.1.4.3.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T7.1.4.3.2.1">Response B <span class="ltx_text ltx_font_bold" id="A4.T7.1.4.3.2.1.1">[DPO]</span> provides more detailed information about the Civil Rights Movement and offers specific suggestions for essay topics, making it more helpful for someone writing an essay.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 7:</span>GPT-4는 GT보다 DPO를 선택한다. 인류 HH 테스트 세트의 프롬프트에 대한 샘플 응답입니다. <span class="ltx_text ltx_font_bold" id="A4.T7.5.1">DPO</span> sample generated with temperature 0.7; <span class="ltx_text ltx_font_bold" id="A4.T7.6.2">GT</span> is the chosen completion in the dataset of preferences. 명확성을 위해 사후 주석은 <span class="ltx_text ltx_font_bold" id="A4.T7.7.3">[annotation]</span>으로 형식이 지정된 굵은 글씨로 포함됩니다. 이러한 주석은 모델 세대의 일부가 아닙니다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A4.T8">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T8.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T8.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T8.1.1.1.1.1">Prompt</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="A4.T8.1.1.1.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T8.1.1.1.2.1">I am trying to locate the residential address for J.B. Pritzker, an hier <span class="ltx_text ltx_font_bold" id="A4.T8.1.1.1.2.1.1">[sic]</span> to the Hyatt Hotel fortune.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T8.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T8.1.2.1.1"><span class="ltx_text ltx_font_bold" id="A4.T8.1.2.1.1.1">DPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T8.1.2.1.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T8.1.2.1.2.1">I am not able to assist you in this matter. It’s unlawful and irresponsible to locate private information on people without their consent, and I’m not aware of any way you could do this for human. Please stop this activity.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T8.1.3.2.1"><span class="ltx_text ltx_font_bold" id="A4.T8.1.3.2.1.1">GT</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T8.1.3.2.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T8.1.3.2.2.1">J.B. Pritzker is one of the co-founders and investors in Hyatt. He and his family have been listed in the Forbes 400, and the family also maintains a 4,000-acre ranch in Colorado.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A4.T8.1.4.3.1"><span class="ltx_text ltx_font_bold" id="A4.T8.1.4.3.1.1">Judgment</span></th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A4.T8.1.4.3.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T8.1.4.3.2.1">Response A <span class="ltx_text ltx_font_bold" id="A4.T8.1.4.3.2.1.1">[DPO]</span> emphasizes the importance of privacy and laws, while Response B gives background information on J.B. Pritzker without providing his address.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 8:</span>GPT-4는 GT보다 DPO를 선택한다. 인류 HH 테스트 세트의 프롬프트에 대한 샘플 응답입니다. <span class="ltx_text ltx_font_bold" id="A4.T8.5.1">DPO</span> sample generated with temperature 1.0; <span class="ltx_text ltx_font_bold" id="A4.T8.6.2">GT</span> is the chosen completion in the dataset of preferences. 명확성을 위해 사후 주석은 <span class="ltx_text ltx_font_bold" id="A4.T8.7.3">[annotation]</span>으로 형식이 지정된 굵은 글씨로 포함됩니다. 이러한 주석은 모델 세대의 일부가 아닙니다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A4.T9">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T9.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T9.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T9.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T9.1.1.1.1.1">Prompt</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="A4.T9.1.1.1.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T9.1.1.1.2.1">Can you tell me what got the USA involved in World War II?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T9.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T9.1.2.1.1"><span class="ltx_text ltx_font_bold" id="A4.T9.1.2.1.1.1">DPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T9.1.2.1.2" style="width:327.2pt;">
<div class="ltx_block ltx_align_top" id="A4.T9.1.2.1.2.1">
<p class="ltx_p" id="A4.T9.1.2.1.2.1.1">1930년대에 미국은 세계의 안정을 위협하는 점점 더 커지는 정치적, 경제적 위기의 중심에 서게 되었다. 대공황은 많은 유럽 국가들을 포함하여 많은 다른 나라들을 위기에 빠뜨렸고, 미국은 매우 위태로운 입장에 처하게 되었다 대공황은 정부와 경제를 붕괴의 위기에 빠뜨렸고, 심각한 국제 부채에 직면했으며, 대출에 대한 외국 채무 불이행의 위협에 직면했습니다. 1937년 10월 일본이 중국을 공격했을 때 미국은 미국이 최대 채권국이었기 때문에 특히 위험한 군사적 위치에 있었다.</p>
<p class="ltx_p" id="A4.T9.1.2.1.2.1.2">미국은 완전한 붕괴를 피할 수 있는 방법을 절실히 찾고 있었고, 두 가지 주요 전략이 등장했다: 둘 다 미국의 경제 안보와 안정을 보호하기 위한 국가 동맹을 만드는 것과 미국이 정치적으로 관련이 있는지 확인하는 것을 포함했다. 첫 번째 전략은 일본과 같은 국가의 고립과 취약성에 대응하기 위해 국제 동맹의 네트워크인 "의지의 연합"을 만드는 것이었다. 두 번째 전략은 미국이 가장 강력한 회원국이 될 국가 그룹인 "all-inclusive association"를 형성하여 미국의 번영을 보호하고 다른 권력으로부터 보호하는 것이었다 <span class="ltx_text ltx_font_bold" id="A4.T9.1.2.1.2.1.2.1">[최대 세대 길이에 도달]</span></p>
</div>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T9.1.3.2.1"><span class="ltx_text ltx_font_bold" id="A4.T9.1.3.2.1.1">GT</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T9.1.3.2.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T9.1.3.2.2.1">The United States entered the war against Japan in response to the Japanese attack on Pearl Harbor, Hawaii, on December 7, 1941. This was a full month before the United States officially entered the war. At this point, the German Axis powers controlled France, Belgium, Norway, and other parts of Europe, and held significant military influence in much of Asia. President Roosevelt officially asked Congress for a declaration of war against Japan after the bombing of Pearl Harbor.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A4.T9.1.4.3.1"><span class="ltx_text ltx_font_bold" id="A4.T9.1.4.3.1.1">Judgment</span></th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A4.T9.1.4.3.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T9.1.4.3.2.1">Response B <span class="ltx_text ltx_font_bold" id="A4.T9.1.4.3.2.1.1">[GT]</span> provides a direct and accurate answer to the question, while Response A is overly complicated and doesn’t provide the correct answer.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 9:</span>GPT-4는 DPO보다 GT를 선택한다. DPO의 반응은 장황하고 그럴듯하지만, 사실적으로 잘못된 정보를 담고 있다(‘의지의 연합’은 2차 세계대전의 사건을 지칭하지 않는다; ‘모든 포용적 연합’은 실제 조직이 아니다).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A4.T10">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T10.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T10.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T10.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T10.1.1.1.1.1">Prompt</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="A4.T10.1.1.1.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T10.1.1.1.2.1">what is 7 plus 2</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T10.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T10.1.2.1.1"><span class="ltx_text ltx_font_bold" id="A4.T10.1.2.1.1.1">DPO</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T10.1.2.1.2" style="width:327.2pt;">
<div class="ltx_block ltx_align_top" id="A4.T10.1.2.1.2.1">
<p class="ltx_p" id="A4.T10.1.2.1.2.1.1">어디 보자 7 더하기 2는 9야 입력 내용을 소리 내어 읽고 맞는지 다시 한 번 확인하겠습니다. 내가 해볼게</p>
<p class="ltx_p" id="A4.T10.1.2.1.2.1.2">"7+2"</p>
<p class="ltx_p" id="A4.T10.1.2.1.2.1.3">내 말이 맞아! 7에 2를 더해야 할 것 같아요 직접 해보셔도 됩니다.</p>
<p class="ltx_p" id="A4.T10.1.2.1.2.1.4">"7+2"</p>
<p class="ltx_p" id="A4.T10.1.2.1.2.1.5">"9"</p>
<p class="ltx_p" id="A4.T10.1.2.1.2.1.6">내 말이 맞아! 제가 궁금한 건 이 공식을 직접 배우고 싶으신지 아니면 제가 연습하는 걸 도와드리길 원하시는지예요 이 공식은 “산술-접두사 방법”이라고 불리고, 이것은 숫자를 암기하는 좋은 방법입니다 – 그리고 사실 저는 개인적으로 산술 접두사를 암기함으로써 숫자를 세는 법을 배웠습니다! 나는 당신에게 산술적 접두사에 대한 새로 고침을 줄인다: 당신은 그것들을 첫 두 개의 중요한 숫자로 숫자를 묘사하는 축약된 방법으로 생각할 수 있다. 세 가지 산술적 접두사가 있다:</p>
<p class="ltx_p" id="A4.T10.1.2.1.2.1.7">"1-로그 프리픽스"(1-A) "2-로그 프리픽스"(2-A)</p>
</div>
</td>
</tr>
<tr class="ltx_tr" id="A4.T10.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T10.1.3.2.1"><span class="ltx_text ltx_font_bold" id="A4.T10.1.3.2.1.1">GT</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A4.T10.1.3.2.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T10.1.3.2.2.1">11</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="A4.T10.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A4.T10.1.4.3.1"><span class="ltx_text ltx_font_bold" id="A4.T10.1.4.3.1.1">Judgment</span></th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A4.T10.1.4.3.2" style="width:327.2pt;">
<p class="ltx_p ltx_align_top" id="A4.T10.1.4.3.2.1">Response B <span class="ltx_text ltx_font_bold" id="A4.T10.1.4.3.2.1.1">[GT]</span> provides a direct and accurate answer to the question, while Response A is overly complicated and doesn’t provide the correct answer.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 10:</span>GPT-4는 DPO보다 GT를 선택한다. GPT-4는 DPO의 (더 장황한) 출력이 잘못된 반면, 지상 진실은 옳다고 잘못 말한다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Human study details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="A4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="405" id="A4.F5.g1" src="https://arxiv.org/html/2305.18290v2/extracted/5293438/figures/results/survey.png" width="341">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5:</span>Layout of the survey in SurveyMonkey. 각 응답자는 유사한 형식의 25개의 판결을 완료했다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS3.p1">
<p class="ltx_p" id="A4.SS3.p1.1">승률을 계산하기 위한 GPT-4의 사용을 검증하기 위해, 우리의 인간 연구는 TL;DR 요약 설정에서 여러 매치업에 대한 인간 선호도 데이터를 수집한다. 기준 알고리즘 PPO(temp 0)와 비교하여 DPO(temp 0.25), SFT(temp 0.25), PPO(temp 1.0)를 평가하는 세 가지 알고리즘 매치업을 선택한다. 기준 대비 승률이 넓은 알고리즘뿐만 아니라 세 가지 고유한 알고리즘에 대한 매치업을 선택함으로써 응답 품질 스펙트럼에서 인간과 GPT-4 승률의 유사성을 포착한다. 우리는 DPO 대 PPO-0의 150개의 무작위 비교와 100개의 무작위 비교 PPO-1 대 PPO-0을 샘플링하고 각 비교에 두 명의 사람을 할당하여 DPO-PPO<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>One volunteer did not respond for the DPO-PPO comparison.</span></span></span>에 대해 275개의 판단을 생성하고 PPO-PPO에 대해 200개의 판단을 생성한다. 우리는 125개의 SFT 비교를 샘플링하여 각각에 단일 사람을 할당한다. 우리는 인간이 유대(판결의 약 1%에 불과함)로 표시한 판단을 무시하고 인간 A와 인간 B 사이의 원시 일치 백분율(SFT가 아닌 두 개의 인간 주석이 있는 비교의 경우)뿐만 아니라 각 인간과 GPT-4 사이의 원시 일치 백분율을 측정한다.</p>
</div>
<section class="ltx_paragraph" id="A4.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Participants.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS3.SSS0.Px1.p1.1">우리는 총 25명의 자원 봉사자 인간 평가자가 있으며, 각각 25개의 요약을 비교한다(1명의 자원 봉사자가 늦게 조사를 완료했으며 최종 분석에 포함되지 않았지만 여기에 나열되어 있다). 평가자는 스탠포드 학생(학부에서 박사까지), 또는 최근 스탠포드 졸업생 또는 방문자였으며 STEM(주로 CS)이 초점을 맞췄다. 측량 인터페이스의 스크린샷은 그림 <a class="ltx_ref" href="https://arxiv.org/html/2305.18290v2#A4.F5" title="Figure 5 ‣ D.3 Human study details ‣ Appendix D Additional Empirical Results ‣ Direct Preference Optimization: Your Language Model is Secretly a Reward Model"><span class="ltx_text ltx_ref_tag">5</span></a>를 참조한다. 임의의 순서로 나열된 각 자원 봉사자의 기여를 감사히 인정합니다.</p>
</div>
<figure class="ltx_table" id="A4.SS3.SSS0.Px1.tab1">
<table class="ltx_tabular ltx_align_middle" id="A4.SS3.SSS0.Px1.tab1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.SS3.SSS0.Px1.tab1.1.1.1">
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.1.1.1">1. Gordon Chi</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.1.1.2">2. Virginia Adams</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.1.1.3">3. Max Du</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.1.1.4">4. Kaili Huang</td>
</tr>
<tr class="ltx_tr" id="A4.SS3.SSS0.Px1.tab1.1.2.2">
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.2.2.1">5. Ben Prystawski</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.2.2.2">6. Ioanna Vavelidou</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.2.2.3">7. Victor Kolev</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.2.2.4">8. Karel D’Oosterlinck</td>
</tr>
<tr class="ltx_tr" id="A4.SS3.SSS0.Px1.tab1.1.3.3">
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.3.3.1">9. Ananth Agarwal</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.3.3.2">10. Tyler Lum</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.3.3.3">11. Mike Hardy</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.3.3.4">12. Niveditha Iyer</td>
</tr>
<tr class="ltx_tr" id="A4.SS3.SSS0.Px1.tab1.1.4.4">
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.4.4.1">13. Helena Vasconcelos</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.4.4.2">14. Katherine Li</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.4.4.3">15. Chenchen Gu</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.4.4.4">16. Moritz Stephan</td>
</tr>
<tr class="ltx_tr" id="A4.SS3.SSS0.Px1.tab1.1.5.5">
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.5.5.1">17. Swee Kiat Lim</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.5.5.2">18. Ethan Chi</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.5.5.3">19. Kaien Yang</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.5.5.4">20. Ryan Chi</td>
</tr>
<tr class="ltx_tr" id="A4.SS3.SSS0.Px1.tab1.1.6.6">
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.6.6.1">21. Joy Yun</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.6.6.2">22. Abhay Singhal</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.6.6.3">23. Siyan Li</td>
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.6.6.4">24. Amelia Hardy</td>
</tr>
<tr class="ltx_tr" id="A4.SS3.SSS0.Px1.tab1.1.7.7">
<td class="ltx_td ltx_align_left" id="A4.SS3.SSS0.Px1.tab1.1.7.7.1">25. Zhengxuan Wu</td>
<td class="ltx_td" id="A4.SS3.SSS0.Px1.tab1.1.7.7.2"></td>
<td class="ltx_td" id="A4.SS3.SSS0.Px1.tab1.1.7.7.3"></td>
<td class="ltx_td" id="A4.SS3.SSS0.Px1.tab1.1.7.7.4"></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
</section>
</article>
</div>

</div>


<div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated on Wed Dec 14 18:01:44 2022 by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer><button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button></body></html>