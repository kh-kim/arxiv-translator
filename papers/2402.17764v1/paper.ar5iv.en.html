<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2402.17764] The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits</title><meta property="og:description" content="Recent research, such as BitNet&nbsp;[23], is paving the way for a new era of 1-bit Large Language Models (LLMs). In this work, we introduce a 1-bit LLM variant, namely BitNet b1.58, in which every single parameter (or weig…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2402.17764">

<!--Generated on Tue Mar  5 13:45:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.7.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.1.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">The Era of 1-bit LLMs: 
<br class="ltx_break">All Large Language Models are in 1.58 Bits</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Shuming Ma&nbsp;&nbsp;&nbsp;&nbsp;Hongyu Wang<span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>&nbsp;&nbsp;&nbsp;&nbsp;Lingxiao Ma&nbsp;&nbsp;&nbsp;&nbsp;Lei Wang&nbsp;&nbsp;&nbsp;&nbsp;Wenhui Wang 
<br class="ltx_break"><span id="id2.2.1" class="ltx_text ltx_font_bold">&nbsp;&nbsp;&nbsp;&nbsp;Shaohan Huang&nbsp;&nbsp;&nbsp;&nbsp;Li Dong&nbsp;&nbsp;&nbsp;&nbsp;Ruiping Wang&nbsp;&nbsp;&nbsp;&nbsp;Jilong Xue&nbsp;&nbsp;&nbsp;&nbsp;Furu Wei<sup id="id2.2.1.1" class="ltx_sup"><span id="id2.2.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">⋄</span></sup> 
<br class="ltx_break"><a target="_blank" href="https://aka.ms/GeneralAI" title="" class="ltx_ref ltx_href">https://aka.ms/GeneralAI</a>


<br class="ltx_break"></span>
</span><span class="ltx_author_notes">&nbsp;Equal contribution. <math id="id1.1.m1.1" class="ltx_Math" alttext="\diamond" display="inline"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">⋄</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><ci id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">⋄</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\diamond</annotation></semantics></math> Corresponding author. S. Ma, L. Ma, L. Wang, W. Wang, S. Huang, L. Dong, J. Xue, F. Wei are with Microsoft Research. H. Wang and R. Wang are with University of Chinese Academy of Sciences.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">Recent research, such as BitNet&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, is paving the way for a new era of 1-bit Large Language Models (LLMs). In this work, we introduce a 1-bit LLM variant, namely <span id="id3.id1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span>, in which every single parameter (or weight) of the LLM is ternary {-1, 0, 1}. It matches the full-precision (i.e., FP16 or BF16) Transformer LLM with the same model size and training tokens in terms of both perplexity and end-task performance, while being significantly more cost-effective in terms of latency, memory, throughput, and energy consumption.
More profoundly, the 1.58-bit LLM defines a new scaling law and recipe for training new generations of LLMs that are both high-performance and cost-effective. Furthermore, it enables a new computation paradigm and opens the door for designing specific hardware optimized for 1-bit LLMs.</p>
</div>
<figure id="S0.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S0.F1.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2402.17764/assets/x1.png" id="S0.F1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="183" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S0.F1.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2402.17764/assets/x2.png" id="S0.F1.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="211" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S0.F1.6.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S0.F1.7.2" class="ltx_text" style="font-size:90%;">1-bit LLMs (e.g., <span id="S0.F1.7.2.1" class="ltx_text">BitNet b1.58</span>) provide a Pareto solution to reduce inference cost (latency, throughput, and energy) of LLMs while maintaining model performance. The new computation paradigm of <span id="S0.F1.7.2.2" class="ltx_text">BitNet b1.58</span> calls for actions to design new hardware optimized for 1-bit LLMs.</span></figcaption>
</figure>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>The Era of 1-bit LLMs</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In recent years, the field of AI has seen a rapid growth in the size and capabilities of Large Language Models (LLMs). These models have demonstrated remarkable performance in a wide range of natural language processing tasks, but their increasing size has posed challenges for deployment and raised concerns about their environmental and economic impact due to high energy consumption.
One approach to address these challenges is to use post-training quantization to create low-bit models for inference&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. This technique reduces the precision of weights and activations, significantly reducing the memory and computational requirements of LLMs. The trend has been to move from 16 bits to lower bits, such as 4-bit variants&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. However, post-training quantization is sub-optimal, even though it is widely used in industry LLMs.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Recent work on 1-bit model architectures, such as BitNet&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, presents a promising direction for reducing the cost of LLMs while maintaining their performance. Vanilla LLMs are in 16-bit floating values (i.e., FP16 or BF16), and the bulk of any LLMs is matrix multiplication. Therefore, the major computation cost comes from the floating-point addition and multiplication operations. In contrast, the matrix multiplication of BitNet only involves integer addition, which saves orders of energy cost for LLMs. As the fundamental limit to compute performance in many chips is power, the energy savings can also be translated into faster computation.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In addition to computation, the process of transferring model parameters from DRAM to the memory of an on-chip accelerator (e.g., SRAM) can be expensive during inference. There have been attempts to enlarge SRAM to improve throughput, but this introduces significantly higher costs than DRAM. Compared to full-precision models, 1-bit LLMs have a much lower memory footprint from both a capacity and bandwidth standpoint. This can significantly reduce the cost and time of loading weights from DRAM, leading to faster and more efficient inference.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this work, we introduce a significant 1-bit LLM variant called <span id="S1.p4.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span>, where every parameter is ternary, taking on values of {-1, 0, 1}. We have added an additional value of 0 to the original 1-bit BitNet, resulting in 1.58 bits in the binary system. <span id="S1.p4.1.2" class="ltx_text">BitNet b1.58</span> retains all the benefits of the original 1-bit BitNet, including its new computation paradigm, which requires almost no multiplication operations for matrix multiplication and can be highly optimized. Additionally, it has the same energy consumption as the original 1-bit BitNet and is much more efficient in terms of memory consumption, throughput and latency compared to FP16 LLM baselines. Furthermore, <span id="S1.p4.1.3" class="ltx_text">BitNet b1.58</span> offers two additional advantages. Firstly, its modeling capability is stronger due to its explicit support for feature filtering, made possible by the inclusion of 0 in the model weights, which can significantly improve the performance of 1-bit LLMs. Secondly, our experiments show that <span id="S1.p4.1.4" class="ltx_text">BitNet b1.58</span> can match full precision (i.e., FP16) baselines in terms of both perplexity and end-task performance, starting from a 3B size, when using the same configuration (e.g., model size, training tokens, etc.).</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>BitNet b1.58</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text">BitNet b1.58</span> is based on the BitNet architecture, which is a Transformer that replaces <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">nn.Linear</em> with <em id="S2.p1.1.3" class="ltx_emph ltx_font_italic">BitLinear</em>. It is trained from scratch, with 1.58-bit weights and 8-bit activations. Compared to the original BitNet, it introduces some modifications that we summarize below.</p>
</div>
<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h3 class="ltx_title ltx_title_paragraph">Quantization Function.</h3>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">To constrain the weights to -1, 0, or +1, we adopt an <em id="S2.SS0.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">absmean</em> quantization function. It first scales the weight matrix by its average absolute value, and then round each value to the nearest integer among {-1, 0, +1}:</p>
</div>
<div id="S2.SS0.SSS0.Px1.p2" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\widetilde{W}=\mathrm{RoundClip}(\frac{W}{\gamma+\epsilon},-1,1)," display="block"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mover accent="true" id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml">W</mi><mo id="S2.E1.m1.3.3.1.1.3.1" xref="S2.E1.m1.3.3.1.1.3.1.cmml">~</mo></mover><mo id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.3.cmml">RoundClip</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml">(</mo><mfrac id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mi id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">W</mi><mrow id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.3.2" xref="S2.E1.m1.1.1.3.2.cmml">γ</mi><mo id="S2.E1.m1.1.1.3.1" xref="S2.E1.m1.1.1.3.1.cmml">+</mo><mi id="S2.E1.m1.1.1.3.3" xref="S2.E1.m1.1.1.3.3.cmml">ϵ</mi></mrow></mfrac><mo id="S2.E1.m1.3.3.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml">,</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.1a" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mn id="S2.E1.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml">1</mn></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.1.4" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml">,</mo><mn id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S2.E1.m1.3.3.1.1.1.1.1.5" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"></eq><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"><ci id="S2.E1.m1.3.3.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1">~</ci><ci id="S2.E1.m1.3.3.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2">𝑊</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.2"></times><ci id="S2.E1.m1.3.3.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.3">RoundClip</ci><vector id="S2.E1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><divide id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1"></divide><ci id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2">𝑊</ci><apply id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3"><plus id="S2.E1.m1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.3.1"></plus><ci id="S2.E1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.3.2">𝛾</ci><ci id="S2.E1.m1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.3.3">italic-ϵ</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1"><minus id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1"></minus><cn type="integer" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2">1</cn></apply><cn type="integer" id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">1</cn></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\widetilde{W}=\mathrm{RoundClip}(\frac{W}{\gamma+\epsilon},-1,1),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.9" class="ltx_Math" alttext="\mathrm{RoundClip}(x,a,b)=\max(a,\min(b,\mathrm{round}(x)))," display="block"><semantics id="S2.E2.m1.9a"><mrow id="S2.E2.m1.9.9.1" xref="S2.E2.m1.9.9.1.1.cmml"><mrow id="S2.E2.m1.9.9.1.1" xref="S2.E2.m1.9.9.1.1.cmml"><mrow id="S2.E2.m1.9.9.1.1.3" xref="S2.E2.m1.9.9.1.1.3.cmml"><mi id="S2.E2.m1.9.9.1.1.3.2" xref="S2.E2.m1.9.9.1.1.3.2.cmml">RoundClip</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.3.1" xref="S2.E2.m1.9.9.1.1.3.1.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.3.3.2" xref="S2.E2.m1.9.9.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.3.3.2.1" xref="S2.E2.m1.9.9.1.1.3.3.1.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">x</mi><mo id="S2.E2.m1.9.9.1.1.3.3.2.2" xref="S2.E2.m1.9.9.1.1.3.3.1.cmml">,</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">a</mi><mo id="S2.E2.m1.9.9.1.1.3.3.2.3" xref="S2.E2.m1.9.9.1.1.3.3.1.cmml">,</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">b</mi><mo stretchy="false" id="S2.E2.m1.9.9.1.1.3.3.2.4" xref="S2.E2.m1.9.9.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.9.9.1.1.2" xref="S2.E2.m1.9.9.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.9.9.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.2.cmml"><mi id="S2.E2.m1.7.7" xref="S2.E2.m1.7.7.cmml">max</mi><mo id="S2.E2.m1.9.9.1.1.1.1a" xref="S2.E2.m1.9.9.1.1.1.2.cmml">⁡</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.8.8" xref="S2.E2.m1.8.8.cmml">a</mi><mo id="S2.E2.m1.9.9.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.2.cmml">,</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml">min</mi><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1a" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.6.6" xref="S2.E2.m1.6.6.cmml">b</mi><mo id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">round</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">x</mi><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2.m1.9.9.1.1.1.1.1.4" xref="S2.E2.m1.9.9.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.9.9.1.2" xref="S2.E2.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.9b"><apply id="S2.E2.m1.9.9.1.1.cmml" xref="S2.E2.m1.9.9.1"><eq id="S2.E2.m1.9.9.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.2"></eq><apply id="S2.E2.m1.9.9.1.1.3.cmml" xref="S2.E2.m1.9.9.1.1.3"><times id="S2.E2.m1.9.9.1.1.3.1.cmml" xref="S2.E2.m1.9.9.1.1.3.1"></times><ci id="S2.E2.m1.9.9.1.1.3.2.cmml" xref="S2.E2.m1.9.9.1.1.3.2">RoundClip</ci><vector id="S2.E2.m1.9.9.1.1.3.3.1.cmml" xref="S2.E2.m1.9.9.1.1.3.3.2"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝑥</ci><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝑎</ci><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝑏</ci></vector></apply><apply id="S2.E2.m1.9.9.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1"><max id="S2.E2.m1.7.7.cmml" xref="S2.E2.m1.7.7"></max><ci id="S2.E2.m1.8.8.cmml" xref="S2.E2.m1.8.8">𝑎</ci><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1"><min id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5"></min><ci id="S2.E2.m1.6.6.cmml" xref="S2.E2.m1.6.6">𝑏</ci><apply id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.9.9.1.1.1.1.1.1.1.1.1.2">round</ci><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.9c">\mathrm{RoundClip}(x,a,b)=\max(a,\min(b,\mathrm{round}(x))),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\gamma=\frac{1}{nm}\sum_{ij}|W_{ij}|." display="block"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml">γ</mi><mo id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mfrac id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml"><mn id="S2.E3.m1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.3.2.cmml">1</mn><mrow id="S2.E3.m1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.3.3.2" xref="S2.E3.m1.1.1.1.1.1.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.3.3.1" xref="S2.E3.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.1.3.3.3.cmml">m</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><munder id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E3.m1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.2.3.2" xref="S2.E3.m1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.1.2.3.1" xref="S2.E3.m1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.1.1.1.1.2.3.3" xref="S2.E3.m1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></munder><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2"></eq><ci id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3">𝛾</ci><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3"><divide id="S2.E3.m1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3"></divide><cn type="integer" id="S2.E3.m1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2">1</cn><apply id="S2.E3.m1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3.3"><times id="S2.E3.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3.3.1"></times><ci id="S2.E3.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.3.2">𝑛</ci><ci id="S2.E3.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3.3.3">𝑚</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1"><apply id="S2.E3.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.2"></sum><apply id="S2.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.3"><times id="S2.E3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.3.1"></times><ci id="S2.E3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1"><abs id="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2"></abs><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\gamma=\frac{1}{nm}\sum_{ij}|W_{ij}|.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS0.SSS0.Px1.p3" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p3.2" class="ltx_p">The quantization function for activations follows the same implementation in BitNet, except that we do not scale the activations before the non-linear functions to the range <math id="S2.SS0.SSS0.Px1.p3.1.m1.2" class="ltx_Math" alttext="[0,Q_{b}]" display="inline"><semantics id="S2.SS0.SSS0.Px1.p3.1.m1.2a"><mrow id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.2.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.2" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.2.cmml">[</mo><mn id="S2.SS0.SSS0.Px1.p3.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.cmml">0</mn><mo id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.3" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.2.cmml">,</mo><msub id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.2" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.2.cmml">Q</mi><mi id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.3" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.4" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.1.m1.2b"><interval closure="closed" id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1"><cn type="integer" id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1">0</cn><apply id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.2">𝑄</ci><ci id="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.2.2.1.1.3">𝑏</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.1.m1.2c">[0,Q_{b}]</annotation></semantics></math>. Instead, the activations are all scaled to <math id="S2.SS0.SSS0.Px1.p3.2.m2.2" class="ltx_Math" alttext="[-Q_{b},Q_{b}]" display="inline"><semantics id="S2.SS0.SSS0.Px1.p3.2.m2.2a"><mrow id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.3.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.3" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.3.cmml">[</mo><mrow id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1a" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.cmml">−</mo><msub id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.2.cmml">Q</mi><mi id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.3.cmml">b</mi></msub></mrow><mo id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.4" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.3.cmml">,</mo><msub id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.2.cmml">Q</mi><mi id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.3.cmml">b</mi></msub><mo stretchy="false" id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.5" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.2.m2.2b"><interval closure="closed" id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2"><apply id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1"><minus id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1"></minus><apply id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.2">𝑄</ci><ci id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.1.1.2.3">𝑏</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.2">𝑄</ci><ci id="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p3.2.m2.2.2.2.2.3">𝑏</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.2.m2.2c">[-Q_{b},Q_{b}]</annotation></semantics></math> per token to get rid of the zero-point quantization. This is more convenient and simple for both implementation and system-level optimization, while introduces negligible effects to the performance in our experiments.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h3 class="ltx_title ltx_title_paragraph">LLaMA-alike Components.</h3>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">The architecture of LLaMA&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> has been the de-facto backbone for open-source LLMs. To embrace the open-source community, our design of <span id="S2.SS0.SSS0.Px2.p1.1.1" class="ltx_text">BitNet b1.58</span> adopts the LLaMA-alike components. Specifically, it uses RMSNorm&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, SwiGLU&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, rotary embedding&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, and removes all biases. In this way, <span id="S2.SS0.SSS0.Px2.p1.1.2" class="ltx_text">BitNet b1.58</span> can be integrated into the popular open-source software (e.g., Huggingface, vLLM&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, and llama.cpp<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://github.com/ggerganov/llama.cpp" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/ggerganov/llama.cpp</a></span></span></span>) with minimal efforts.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<table id="S2.T1.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody><tr id="S2.T1.3.3" class="ltx_tr">
<td id="S2.T1.3.3.4" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.3.4.1" class="ltx_text ltx_font_bold">Models</span></td>
<td id="S2.T1.3.3.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.3.5.1" class="ltx_text ltx_font_bold">Size</span></td>
<td id="S2.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.1.1.1.1" class="ltx_text ltx_font_bold">Memory (GB)<math id="S2.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S2.T1.1.1.1.1.m1.1a"><mo stretchy="false" id="S2.T1.1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.1.m1.1b"><ci id="S2.T1.1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S2.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.2.2.2.1" class="ltx_text ltx_font_bold">Latency (ms)<math id="S2.T1.2.2.2.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S2.T1.2.2.2.1.m1.1a"><mo stretchy="false" id="S2.T1.2.2.2.1.m1.1.1" xref="S2.T1.2.2.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S2.T1.2.2.2.1.m1.1b"><ci id="S2.T1.2.2.2.1.m1.1.1.cmml" xref="S2.T1.2.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.2.2.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S2.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.3.3.1" class="ltx_text ltx_font_bold">PPL<math id="S2.T1.3.3.3.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S2.T1.3.3.3.1.m1.1a"><mo stretchy="false" id="S2.T1.3.3.3.1.m1.1.1" xref="S2.T1.3.3.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S2.T1.3.3.3.1.m1.1b"><ci id="S2.T1.3.3.3.1.m1.1.1.cmml" xref="S2.T1.3.3.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.3.3.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
</tr>
<tr id="S2.T1.3.4" class="ltx_tr">
<td id="S2.T1.3.4.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.4.1.1" class="ltx_text">LLaMA LLM</span></td>
<td id="S2.T1.3.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">700M</td>
<td id="S2.T1.3.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">2.08 (1.00x)</td>
<td id="S2.T1.3.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">1.18 (1.00x)</td>
<td id="S2.T1.3.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">12.33</td>
</tr>
<tr id="S2.T1.3.5" class="ltx_tr">
<td id="S2.T1.3.5.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.5.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span></td>
<td id="S2.T1.3.5.2" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">700M</td>
<td id="S2.T1.3.5.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">0.80 (2.60x)</td>
<td id="S2.T1.3.5.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">0.96 (1.23x)</td>
<td id="S2.T1.3.5.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">12.87</td>
</tr>
<tr id="S2.T1.3.6" class="ltx_tr">
<td id="S2.T1.3.6.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.6.1.1" class="ltx_text">LLaMA LLM</span></td>
<td id="S2.T1.3.6.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">1.3B</td>
<td id="S2.T1.3.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">3.34 (1.00x)</td>
<td id="S2.T1.3.6.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">1.62 (1.00x)</td>
<td id="S2.T1.3.6.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">11.25</td>
</tr>
<tr id="S2.T1.3.7" class="ltx_tr">
<td id="S2.T1.3.7.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.7.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span></td>
<td id="S2.T1.3.7.2" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">1.3B</td>
<td id="S2.T1.3.7.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">1.14 (2.93x)</td>
<td id="S2.T1.3.7.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">0.97 (1.67x)</td>
<td id="S2.T1.3.7.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">11.29</td>
</tr>
<tr id="S2.T1.3.8" class="ltx_tr">
<td id="S2.T1.3.8.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.8.1.1" class="ltx_text">LLaMA LLM</span></td>
<td id="S2.T1.3.8.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">3B</td>
<td id="S2.T1.3.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">7.89 (1.00x)</td>
<td id="S2.T1.3.8.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">5.07 (1.00x)</td>
<td id="S2.T1.3.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">10.04</td>
</tr>
<tr id="S2.T1.3.9" class="ltx_tr">
<td id="S2.T1.3.9.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.9.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span></td>
<td id="S2.T1.3.9.2" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">3B</td>
<td id="S2.T1.3.9.3" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.9.3.1" class="ltx_text ltx_font_bold">2.22 (3.55x)</span></td>
<td id="S2.T1.3.9.4" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.9.4.1" class="ltx_text ltx_font_bold">1.87 (2.71x)</span></td>
<td id="S2.T1.3.9.5" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.9.5.1" class="ltx_text ltx_font_bold">9.91</span></td>
</tr>
<tr id="S2.T1.3.10" class="ltx_tr">
<td id="S2.T1.3.10.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.10.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span></td>
<td id="S2.T1.3.10.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">3.9B</td>
<td id="S2.T1.3.10.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.10.3.1" class="ltx_text ltx_font_bold">2.38 (3.32x)</span></td>
<td id="S2.T1.3.10.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.10.4.1" class="ltx_text ltx_font_bold">2.11 (2.40x)</span></td>
<td id="S2.T1.3.10.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S2.T1.3.10.5.1" class="ltx_text ltx_font_bold">9.62</span></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S2.T1.7.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S2.T1.8.2" class="ltx_text" style="font-size:90%;">Perplexity as well as the cost of <span id="S2.T1.8.2.1" class="ltx_text">BitNet b1.58</span> and <span id="S2.T1.8.2.2" class="ltx_text">LLaMA LLM</span>.</span></figcaption>
</figure>
<figure id="S2.T2" class="ltx_table">
<table id="S2.T2.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody><tr id="S2.T2.2.1" class="ltx_tr">
<td id="S2.T2.2.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S2.T2.2.1.1.1" class="ltx_text ltx_font_bold">Models</span></td>
<td id="S2.T2.2.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T2.2.1.2.1" class="ltx_text ltx_font_bold">Size</span></td>
<td id="S2.T2.2.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T2.2.1.3.1" class="ltx_text ltx_font_bold">ARCe</span></td>
<td id="S2.T2.2.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T2.2.1.4.1" class="ltx_text ltx_font_bold">ARCc</span></td>
<td id="S2.T2.2.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T2.2.1.5.1" class="ltx_text ltx_font_bold">HS</span></td>
<td id="S2.T2.2.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T2.2.1.6.1" class="ltx_text ltx_font_bold">BQ</span></td>
<td id="S2.T2.2.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T2.2.1.7.1" class="ltx_text ltx_font_bold">OQ</span></td>
<td id="S2.T2.2.1.8" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T2.2.1.8.1" class="ltx_text ltx_font_bold">PQ</span></td>
<td id="S2.T2.2.1.9" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T2.2.1.9.1" class="ltx_text ltx_font_bold">WGe</span></td>
<td id="S2.T2.2.1.10" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T2.2.1.10.1" class="ltx_text ltx_font_bold">Avg.</span></td>
</tr>
<tr id="S2.T2.2.2" class="ltx_tr">
<td id="S2.T2.2.2.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S2.T2.2.2.1.1" class="ltx_text">LLaMA LLM</span></td>
<td id="S2.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_t">700M</td>
<td id="S2.T2.2.2.3" class="ltx_td ltx_align_center ltx_border_t">54.7</td>
<td id="S2.T2.2.2.4" class="ltx_td ltx_align_center ltx_border_t">23.0</td>
<td id="S2.T2.2.2.5" class="ltx_td ltx_align_center ltx_border_t">37.0</td>
<td id="S2.T2.2.2.6" class="ltx_td ltx_align_center ltx_border_t">60.0</td>
<td id="S2.T2.2.2.7" class="ltx_td ltx_align_center ltx_border_t">20.2</td>
<td id="S2.T2.2.2.8" class="ltx_td ltx_align_center ltx_border_t">68.9</td>
<td id="S2.T2.2.2.9" class="ltx_td ltx_align_center ltx_border_t">54.8</td>
<td id="S2.T2.2.2.10" class="ltx_td ltx_align_center ltx_border_t">45.5</td>
</tr>
<tr id="S2.T2.2.3" class="ltx_tr">
<td id="S2.T2.2.3.1" class="ltx_td ltx_align_left"><span id="S2.T2.2.3.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span></td>
<td id="S2.T2.2.3.2" class="ltx_td ltx_align_center">700M</td>
<td id="S2.T2.2.3.3" class="ltx_td ltx_align_center">51.8</td>
<td id="S2.T2.2.3.4" class="ltx_td ltx_align_center">21.4</td>
<td id="S2.T2.2.3.5" class="ltx_td ltx_align_center">35.1</td>
<td id="S2.T2.2.3.6" class="ltx_td ltx_align_center">58.2</td>
<td id="S2.T2.2.3.7" class="ltx_td ltx_align_center">20.0</td>
<td id="S2.T2.2.3.8" class="ltx_td ltx_align_center">68.1</td>
<td id="S2.T2.2.3.9" class="ltx_td ltx_align_center">55.2</td>
<td id="S2.T2.2.3.10" class="ltx_td ltx_align_center">44.3</td>
</tr>
<tr id="S2.T2.2.4" class="ltx_tr">
<td id="S2.T2.2.4.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S2.T2.2.4.1.1" class="ltx_text">LLaMA LLM</span></td>
<td id="S2.T2.2.4.2" class="ltx_td ltx_align_center ltx_border_t">1.3B</td>
<td id="S2.T2.2.4.3" class="ltx_td ltx_align_center ltx_border_t">56.9</td>
<td id="S2.T2.2.4.4" class="ltx_td ltx_align_center ltx_border_t">23.5</td>
<td id="S2.T2.2.4.5" class="ltx_td ltx_align_center ltx_border_t">38.5</td>
<td id="S2.T2.2.4.6" class="ltx_td ltx_align_center ltx_border_t">59.1</td>
<td id="S2.T2.2.4.7" class="ltx_td ltx_align_center ltx_border_t">21.6</td>
<td id="S2.T2.2.4.8" class="ltx_td ltx_align_center ltx_border_t">70.0</td>
<td id="S2.T2.2.4.9" class="ltx_td ltx_align_center ltx_border_t">53.9</td>
<td id="S2.T2.2.4.10" class="ltx_td ltx_align_center ltx_border_t">46.2</td>
</tr>
<tr id="S2.T2.2.5" class="ltx_tr">
<td id="S2.T2.2.5.1" class="ltx_td ltx_align_left"><span id="S2.T2.2.5.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span></td>
<td id="S2.T2.2.5.2" class="ltx_td ltx_align_center">1.3B</td>
<td id="S2.T2.2.5.3" class="ltx_td ltx_align_center">54.9</td>
<td id="S2.T2.2.5.4" class="ltx_td ltx_align_center">24.2</td>
<td id="S2.T2.2.5.5" class="ltx_td ltx_align_center">37.7</td>
<td id="S2.T2.2.5.6" class="ltx_td ltx_align_center">56.7</td>
<td id="S2.T2.2.5.7" class="ltx_td ltx_align_center">19.6</td>
<td id="S2.T2.2.5.8" class="ltx_td ltx_align_center">68.8</td>
<td id="S2.T2.2.5.9" class="ltx_td ltx_align_center">55.8</td>
<td id="S2.T2.2.5.10" class="ltx_td ltx_align_center">45.4</td>
</tr>
<tr id="S2.T2.2.6" class="ltx_tr">
<td id="S2.T2.2.6.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S2.T2.2.6.1.1" class="ltx_text">LLaMA LLM</span></td>
<td id="S2.T2.2.6.2" class="ltx_td ltx_align_center ltx_border_t">3B</td>
<td id="S2.T2.2.6.3" class="ltx_td ltx_align_center ltx_border_t">62.1</td>
<td id="S2.T2.2.6.4" class="ltx_td ltx_align_center ltx_border_t">25.6</td>
<td id="S2.T2.2.6.5" class="ltx_td ltx_align_center ltx_border_t">43.3</td>
<td id="S2.T2.2.6.6" class="ltx_td ltx_align_center ltx_border_t">61.8</td>
<td id="S2.T2.2.6.7" class="ltx_td ltx_align_center ltx_border_t">24.6</td>
<td id="S2.T2.2.6.8" class="ltx_td ltx_align_center ltx_border_t">72.1</td>
<td id="S2.T2.2.6.9" class="ltx_td ltx_align_center ltx_border_t">58.2</td>
<td id="S2.T2.2.6.10" class="ltx_td ltx_align_center ltx_border_t">49.7</td>
</tr>
<tr id="S2.T2.2.7" class="ltx_tr">
<td id="S2.T2.2.7.1" class="ltx_td ltx_align_left"><span id="S2.T2.2.7.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span></td>
<td id="S2.T2.2.7.2" class="ltx_td ltx_align_center">3B</td>
<td id="S2.T2.2.7.3" class="ltx_td ltx_align_center"><span id="S2.T2.2.7.3.1" class="ltx_text ltx_font_bold">61.4</span></td>
<td id="S2.T2.2.7.4" class="ltx_td ltx_align_center"><span id="S2.T2.2.7.4.1" class="ltx_text ltx_font_bold">28.3</span></td>
<td id="S2.T2.2.7.5" class="ltx_td ltx_align_center"><span id="S2.T2.2.7.5.1" class="ltx_text ltx_font_bold">42.9</span></td>
<td id="S2.T2.2.7.6" class="ltx_td ltx_align_center"><span id="S2.T2.2.7.6.1" class="ltx_text ltx_font_bold">61.5</span></td>
<td id="S2.T2.2.7.7" class="ltx_td ltx_align_center"><span id="S2.T2.2.7.7.1" class="ltx_text ltx_font_bold">26.6</span></td>
<td id="S2.T2.2.7.8" class="ltx_td ltx_align_center"><span id="S2.T2.2.7.8.1" class="ltx_text ltx_font_bold">71.5</span></td>
<td id="S2.T2.2.7.9" class="ltx_td ltx_align_center"><span id="S2.T2.2.7.9.1" class="ltx_text ltx_font_bold">59.3</span></td>
<td id="S2.T2.2.7.10" class="ltx_td ltx_align_center"><span id="S2.T2.2.7.10.1" class="ltx_text ltx_font_bold">50.2</span></td>
</tr>
<tr id="S2.T2.2.8" class="ltx_tr">
<td id="S2.T2.2.8.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S2.T2.2.8.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span></td>
<td id="S2.T2.2.8.2" class="ltx_td ltx_align_center ltx_border_bb">3.9B</td>
<td id="S2.T2.2.8.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T2.2.8.3.1" class="ltx_text ltx_font_bold">64.2</span></td>
<td id="S2.T2.2.8.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T2.2.8.4.1" class="ltx_text ltx_font_bold">28.7</span></td>
<td id="S2.T2.2.8.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T2.2.8.5.1" class="ltx_text ltx_font_bold">44.2</span></td>
<td id="S2.T2.2.8.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T2.2.8.6.1" class="ltx_text ltx_font_bold">63.5</span></td>
<td id="S2.T2.2.8.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T2.2.8.7.1" class="ltx_text ltx_font_bold">24.2</span></td>
<td id="S2.T2.2.8.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T2.2.8.8.1" class="ltx_text ltx_font_bold">73.2</span></td>
<td id="S2.T2.2.8.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T2.2.8.9.1" class="ltx_text ltx_font_bold">60.5</span></td>
<td id="S2.T2.2.8.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T2.2.8.10.1" class="ltx_text ltx_font_bold">51.2</span></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S2.T2.5.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S2.T2.6.2" class="ltx_text" style="font-size:90%;">Zero-shot accuracy of <span id="S2.T2.6.2.1" class="ltx_text">BitNet b1.58</span> and <span id="S2.T2.6.2.2" class="ltx_text">LLaMA LLM</span> on the end tasks.</span></figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We compared <span id="S3.p1.1.1" class="ltx_text">BitNet b1.58</span> to our reproduced FP16 <span id="S3.p1.1.2" class="ltx_text">LLaMA LLM</span> in various sizes. To ensure a fair comparison, we pre-trained the models on the RedPajama dataset&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> for 100 billion tokens. We evaluated the zero-shot performance on a range of language tasks, including ARC-Easy&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, ARC-Challenge&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, Hellaswag&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, Winogrande&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, PIQA&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, OpenbookQA&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and BoolQ&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. We also reported the validation perplexity on the WikiText2&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and C4&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> datasets.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">We compared the runtime GPU memory and latency of both <span id="S3.p2.1.1" class="ltx_text">LLaMA LLM</span> and <span id="S3.p2.1.2" class="ltx_text">BitNet b1.58</span>. The results were measured using the FasterTransformer<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://github.com/NVIDIA/FasterTransformer" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/NVIDIA/FasterTransformer</a></span></span></span> codebase, which is well-optimized for LLM inference latency on GPU devices. The 2-bit kernel from Ladder&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> is also integrated for <span id="S3.p2.1.3" class="ltx_text">BitNet b1.58</span>. We reported the time per output token, as it is the major cost for inference.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">Table&nbsp;<a href="#S2.T1" title="Table 1 ‣ LLaMA-alike Components. ‣ 2 BitNet b1.58 ‣ The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the perplexity and the cost for <span id="S3.p3.1.1" class="ltx_text">BitNet b1.58</span> and <span id="S3.p3.1.2" class="ltx_text">LLaMA LLM</span>. It shows that <span id="S3.p3.1.3" class="ltx_text">BitNet b1.58</span> starts to match full precision <span id="S3.p3.1.4" class="ltx_text">LLaMA LLM</span> at 3B model size in terms of perplexity, while being 2.71 times faster and using 3.55 times less GPU memory. In particular, <span id="S3.p3.1.5" class="ltx_text">BitNet b1.58</span> with a 3.9B model size is 2.4 times faster, consumes 3.32 times less memory, but performs significantly better than <span id="S3.p3.1.6" class="ltx_text">LLaMA LLM</span> 3B.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">Table&nbsp;<a href="#S2.T2" title="Table 2 ‣ LLaMA-alike Components. ‣ 2 BitNet b1.58 ‣ The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> reports the detailed results of the zero-shot accuracy on the end tasks. We followed the pipeline from <em id="S3.p4.1.1" class="ltx_emph ltx_font_italic">lm-evaluation-harness</em><span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="https://github.com/EleutherAI/lm-evaluation-harness" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/EleutherAI/lm-evaluation-harness</a></span></span></span> to perform the evaluation. The results show that the performance gap between <span id="S3.p4.1.2" class="ltx_text">BitNet b1.58</span> and <span id="S3.p4.1.3" class="ltx_text">LLaMA LLM</span> narrows as the model size increases. More importantly, <span id="S3.p4.1.4" class="ltx_text">BitNet b1.58</span> can match the performance of the full precision baseline starting from a 3B size. Similar to the observation of the perplexity, the end-task results reveal that <span id="S3.p4.1.5" class="ltx_text">BitNet b1.58</span> 3.9B outperforms <span id="S3.p4.1.6" class="ltx_text">LLaMA LLM</span> 3B with lower memory and latency cost. This demonstrates that <span id="S3.p4.1.7" class="ltx_text">BitNet b1.58</span> is a Pareto improvement over the state-of-the-art LLM models.</p>
</div>
<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h3 class="ltx_title ltx_title_paragraph">Memory and Latency</h3>

<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2402.17764/assets/x3.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="169" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2402.17764/assets/x4.png" id="S3.F2.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="169" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">Decoding latency (Left) and memory consumption (Right) of <span id="S3.F2.4.2.1" class="ltx_text">BitNet b1.58</span> varying the model size.</span></figcaption>
</figure>
<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p1.1" class="ltx_p">We further scaled up the model size to 7B, 13B, and 70B and evaluated the cost. Figure&nbsp;<a href="#S3.F2" title="Figure 2 ‣ Memory and Latency ‣ 3 Results ‣ The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the trends of latency and memory, showing that the speed-up increases as the model size scales. In particular, <span id="S3.SS0.SSS0.Px1.p1.1.1" class="ltx_text">BitNet b1.58</span> 70B is 4.1 times faster than the <span id="S3.SS0.SSS0.Px1.p1.1.2" class="ltx_text">LLaMA LLM</span> baseline. This is because the time cost for <em id="S3.SS0.SSS0.Px1.p1.1.3" class="ltx_emph ltx_font_italic">nn.Linear</em> grows with the model size. The memory consumption follows a similar trend, as the embedding remains full precision and its memory proportion is smaller for larger models. Both latency and memory were measured with a 2-bit kernel, so there is still room for optimization to further reduce the cost.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px2" class="ltx_paragraph">
<h3 class="ltx_title ltx_title_paragraph">Energy</h3>

<div id="S3.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p1.1" class="ltx_p">We also estimate the arithmetic operations energy consumption of both <span id="S3.SS0.SSS0.Px2.p1.1.1" class="ltx_text">BitNet b1.58</span> and <span id="S3.SS0.SSS0.Px2.p1.1.2" class="ltx_text">LLaMA LLM</span>.
We focus mainly on the calculation for matrix multiplication, since it
contributes the most to the cost of LLMs. Figure&nbsp;<a href="#S3.F3" title="Figure 3 ‣ Energy ‣ 3 Results ‣ The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the composition of the energy cost. The majority of <span id="S3.SS0.SSS0.Px2.p1.1.3" class="ltx_text">BitNet b1.58</span> is INT8 addition calculation, while <span id="S3.SS0.SSS0.Px2.p1.1.4" class="ltx_text">LLaMA LLM</span> consists of both FP16 addition and FP16 multiplication. According to the energy model in&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, <span id="S3.SS0.SSS0.Px2.p1.1.5" class="ltx_text">BitNet b1.58</span> saves 71.4 times arithmetic operations energy consumption for matrix multiplication on 7nm chips. We further reported the end-to-end energy cost for models with 512 tokens. Our results show that as the model size scales, <span id="S3.SS0.SSS0.Px2.p1.1.6" class="ltx_text">BitNet b1.58</span> becomes increasingly more efficient in terms of energy consumption compared to the FP16 <span id="S3.SS0.SSS0.Px2.p1.1.7" class="ltx_text">LLaMA LLM</span> baseline. This is due to the fact that the percentage of <em id="S3.SS0.SSS0.Px2.p1.1.8" class="ltx_emph ltx_font_italic">nn.Linear</em> grows with the model size, while the cost from other components is smaller for larger models.</p>
</div>
<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2402.17764/assets/x5.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="169" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2402.17764/assets/x6.png" id="S3.F3.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="226" height="169" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.4.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.5.2" class="ltx_text" style="font-size:90%;">Energy consumption of <span id="S3.F3.5.2.1" class="ltx_text">BitNet b1.58</span> compared to <span id="S3.F3.5.2.2" class="ltx_text">LLaMA LLM</span> at 7nm process nodes. On the left is the components of arithmetic operations energy. On the right is the end-to-end energy cost across different model sizes.</span></figcaption>
</figure>
</section>
<section id="S3.SS0.SSS0.Px3" class="ltx_paragraph">
<h3 class="ltx_title ltx_title_paragraph">Throughput</h3>

<figure id="S3.T3" class="ltx_table">
<table id="S3.T3.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody><tr id="S3.T3.2.1" class="ltx_tr">
<td id="S3.T3.2.1.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T3.2.1.1.1" class="ltx_text ltx_font_bold">Models</span></td>
<td id="S3.T3.2.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T3.2.1.2.1" class="ltx_text ltx_font_bold">Size</span></td>
<td id="S3.T3.2.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T3.2.1.3.1" class="ltx_text ltx_font_bold">Max Batch Size</span></td>
<td id="S3.T3.2.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T3.2.1.4.1" class="ltx_text ltx_font_bold">Throughput (tokens/s)</span></td>
</tr>
<tr id="S3.T3.2.2" class="ltx_tr">
<td id="S3.T3.2.2.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T3.2.2.1.1" class="ltx_text">LLaMA LLM</span></td>
<td id="S3.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">70B</td>
<td id="S3.T3.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">16 (1.0x)</td>
<td id="S3.T3.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">&nbsp;&nbsp;333 (1.0x)</td>
</tr>
<tr id="S3.T3.2.3" class="ltx_tr">
<td id="S3.T3.2.3.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T3.2.3.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span></td>
<td id="S3.T3.2.3.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">70B</td>
<td id="S3.T3.2.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T3.2.3.3.1" class="ltx_text ltx_font_bold">176 (11.0x)</span></td>
<td id="S3.T3.2.3.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S3.T3.2.3.4.1" class="ltx_text ltx_font_bold">2977 (8.9x)</span></td>
</tr>
</tbody></table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T3.5.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S3.T3.6.2" class="ltx_text" style="font-size:90%;">Comparison of the throughput between <span id="S3.T3.6.2.1" class="ltx_text">BitNet b1.58</span> 70B and <span id="S3.T3.6.2.2" class="ltx_text">LLaMA LLM</span> 70B.</span></figcaption>
</figure>
<div id="S3.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px3.p1.1" class="ltx_p">We compare the throughput of <span id="S3.SS0.SSS0.Px3.p1.1.1" class="ltx_text">BitNet b1.58</span> and <span id="S3.SS0.SSS0.Px3.p1.1.2" class="ltx_text">LLaMA LLM</span> with 70B parameters on two 80GB A100 cards, using pipeline parallelism&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> so that <span id="S3.SS0.SSS0.Px3.p1.1.3" class="ltx_text">LLaMA LLM</span> 70B could be run on the devices. We increased the batch size until the GPU memory limit was reached, with a sequence length of 512. Table&nbsp;<a href="#S3.T3" title="Table 3 ‣ Throughput ‣ 3 Results ‣ The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows that <span id="S3.SS0.SSS0.Px3.p1.1.4" class="ltx_text">BitNet b1.58</span> 70B can support up to 11 times the batch size of <span id="S3.SS0.SSS0.Px3.p1.1.5" class="ltx_text">LLaMA LLM</span>, resulting an 8.9 times higher throughput.</p>
</div>
<div id="S3.SS0.SSS0.Px3.p2" class="ltx_para">
<p id="S3.SS0.SSS0.Px3.p2.1" class="ltx_p"><span id="S3.SS0.SSS0.Px3.p2.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span><span id="S3.SS0.SSS0.Px3.p2.1.2" class="ltx_text ltx_font_bold"> is enabling a new scaling law with respect to model performance and inference cost</span>. As a reference, we can have the following equivalence between different model sizes in 1.58-bit and 16-bit based on the results in Figure&nbsp;<a href="#S3.F2" title="Figure 2 ‣ Memory and Latency ‣ 3 Results ‣ The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S3.F3" title="Figure 3 ‣ Energy ‣ 3 Results ‣ The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">13B BitNet b1.58 is more efficient, in terms of latency, memory usage and energy consumption, than 3B FP16 LLM.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">30B BitNet b1.58 is more efficient, in terms of latency, memory usage and energy consumption, than 7B FP16 LLM.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p">70B BitNet b1.58 is more efficient, in terms of latency, memory usage and energy consumption, than 13B FP16 LLM.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S3.SS0.SSS0.Px4" class="ltx_paragraph">
<h3 class="ltx_title ltx_title_paragraph">Training with 2T Tokens</h3>

<div id="S3.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px4.p1.1" class="ltx_p">The number of training tokens is a crucial factor for LLMs. To test the scalability of <span id="S3.SS0.SSS0.Px4.p1.1.1" class="ltx_text">BitNet b1.58</span> in terms of tokens, we trained a <span id="S3.SS0.SSS0.Px4.p1.1.2" class="ltx_text">BitNet b1.58</span> model with 2T tokens following the data recipe of StableLM-3B&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, which is the state-of-the-art open-source 3B model. Both models were evaluated on a benchmark that consists of Winogrande&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, PIQA&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, SciQ&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, LAMBADA&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, and ARC-easy&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. We reported the zero-shot accuracy in Table&nbsp;<a href="#S3.T4" title="Table 4 ‣ Training with 2T Tokens ‣ 3 Results ‣ The Era of 1-bit LLMs: All Large Language Models are in 1.58 Bits" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. For tasks measured with accuracy and normalized accuracy, we take the average of the two. The results of StableLM 3b at 2T tokens are taken directly from its technical report. Our findings shows that <span id="S3.SS0.SSS0.Px4.p1.1.3" class="ltx_text">BitNet b1.58</span> achieves a superior performance on all end tasks, indicating that 1.58-bit LLMs also have strong generalization capabilities.</p>
</div>
<figure id="S3.T4" class="ltx_table">
<div id="S3.T4.2" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:54.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(2.6pt,-0.3pt) scale(1.01194702513024,1.01194702513024) ;">
<table id="S3.T4.2.1" class="ltx_tabular ltx_align_middle">
<tbody><tr id="S3.T4.2.1.1" class="ltx_tr">
<td id="S3.T4.2.1.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S3.T4.2.1.1.1.1" class="ltx_text ltx_font_bold">Models</span></td>
<td id="S3.T4.2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T4.2.1.1.2.1" class="ltx_text ltx_font_bold">Tokens</span></td>
<td id="S3.T4.2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T4.2.1.1.3.1" class="ltx_text ltx_font_bold">Winogrande</span></td>
<td id="S3.T4.2.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T4.2.1.1.4.1" class="ltx_text ltx_font_bold">PIQA</span></td>
<td id="S3.T4.2.1.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T4.2.1.1.5.1" class="ltx_text ltx_font_bold">SciQ</span></td>
<td id="S3.T4.2.1.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T4.2.1.1.6.1" class="ltx_text ltx_font_bold">LAMBADA</span></td>
<td id="S3.T4.2.1.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T4.2.1.1.7.1" class="ltx_text ltx_font_bold">ARC-easy</span></td>
<td id="S3.T4.2.1.1.8" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T4.2.1.1.8.1" class="ltx_text ltx_font_bold">Avg.</span></td>
</tr>
<tr id="S3.T4.2.1.2" class="ltx_tr">
<td id="S3.T4.2.1.2.1" class="ltx_td ltx_align_left ltx_border_t">StableLM-3B</td>
<td id="S3.T4.2.1.2.2" class="ltx_td ltx_align_center ltx_border_t">2T</td>
<td id="S3.T4.2.1.2.3" class="ltx_td ltx_align_center ltx_border_t">64.56</td>
<td id="S3.T4.2.1.2.4" class="ltx_td ltx_align_center ltx_border_t">76.93</td>
<td id="S3.T4.2.1.2.5" class="ltx_td ltx_align_center ltx_border_t">90.75</td>
<td id="S3.T4.2.1.2.6" class="ltx_td ltx_align_center ltx_border_t">66.09</td>
<td id="S3.T4.2.1.2.7" class="ltx_td ltx_align_center ltx_border_t">67.78</td>
<td id="S3.T4.2.1.2.8" class="ltx_td ltx_align_center ltx_border_t">73.22</td>
</tr>
<tr id="S3.T4.2.1.3" class="ltx_tr">
<td id="S3.T4.2.1.3.1" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S3.T4.2.1.3.1.1" class="ltx_text ltx_font_bold">BitNet b1.58</span> 3B</td>
<td id="S3.T4.2.1.3.2" class="ltx_td ltx_align_center ltx_border_bb">2T</td>
<td id="S3.T4.2.1.3.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.2.1.3.3.1" class="ltx_text ltx_font_bold">66.37</span></td>
<td id="S3.T4.2.1.3.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.2.1.3.4.1" class="ltx_text ltx_font_bold">78.40</span></td>
<td id="S3.T4.2.1.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.2.1.3.5.1" class="ltx_text ltx_font_bold">91.20</span></td>
<td id="S3.T4.2.1.3.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.2.1.3.6.1" class="ltx_text ltx_font_bold">67.63</span></td>
<td id="S3.T4.2.1.3.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.2.1.3.7.1" class="ltx_text ltx_font_bold">68.12</span></td>
<td id="S3.T4.2.1.3.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.2.1.3.8.1" class="ltx_text ltx_font_bold">74.34</span></td>
</tr>
</tbody></table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S3.T4.4.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S3.T4.5.2" class="ltx_text" style="font-size:90%;">Comparison of <span id="S3.T4.5.2.1" class="ltx_text">BitNet b1.58</span> with StableLM-3B with 2T tokens.</span></figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Discussion and Future Work</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text ltx_font_bold">1-bit Mixture-of-Experts (MoE) LLMs</span></p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Mixture-of-Experts (MoE) have proven to be a cost-effective approach for LLMs. While it significantly reduces the computation FLOPs, the high memory consumption and inter-chip communication overhead limit its deployment and application. These challenges can be addressed by 1.58-bit LLMs. Firstly, the reduced memory footprint reduces the number of devices required to deploy MoE models. Moreover, it significantly reduces the overhead of transferring activations across networks. Ultimately, there would be no overhead if the entire models could be placed on a single chip.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p"><span id="S4.p3.1.1" class="ltx_text ltx_font_bold">Native Support of Long Sequence in LLMs</span></p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">In the era of LLMs, the ability to handle long sequence has become a critical demand. One major challenge for long sequence inference is the memory consumption introduced by the KV caches. <span id="S4.p4.1.1" class="ltx_text">BitNet b1.58</span> represents a significant step towards native support for long sequences, as it reduces the activations from 16 bits to 8 bits, allowing the context length to be doubled given the same resources.
This can be further losslessly compressed to 4 bits or even lower for 1.58-bit LLMs, which we leave as future work.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p"><span id="S4.p5.1.1" class="ltx_text ltx_font_bold">LLMs on Edge and Mobile</span></p>
</div>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.1" class="ltx_p">The use of 1.58-bit LLMs has the potential to greatly improve the performance of language models on edge and mobile devices. These devices are often limited by their memory and computational power, which can restrict the performance and the scale of LLMs. However, the reduced memory and energy consumption of 1.58-bit LLMs allows them to be deployed on these devices, enabling a wide range of applications that were previously not possible. This can greatly enhance the capabilities of edge and mobile devices and enable new and exciting applications of LLMs. Moreover, 1.58-bit LLMs are more friendly to CPU devices, which are the main processors used in edge and mobile devices. This means that <span id="S4.p6.1.1" class="ltx_text">BitNet b1.58</span> can be efficiently executed on these devices, further improving their performance and capabilities.</p>
</div>
<div id="S4.p7" class="ltx_para">
<p id="S4.p7.1" class="ltx_p"><span id="S4.p7.1.1" class="ltx_text ltx_font_bold">New Hardware for 1-bit LLMs</span></p>
</div>
<div id="S4.p8" class="ltx_para">
<p id="S4.p8.1" class="ltx_p">Recent work like&nbsp;Groq<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a target="_blank" href="https://groq.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://groq.com/</a></span></span></span> has demonstrated promising results and great potential for building specific hardware (e.g., LPUs) for LLMs. Going one step further, we envision and call for actions to design new hardware and system specifically optimized for 1-bit LLMs, given the new computation paradigm enabled in BitNet&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">BZB<sup id="bib.bib1.4.4.1" class="ltx_sup"><span id="bib.bib1.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [19]</span>
<span class="ltx_bibblock">
Yonatan Bisk, Rowan Zellers, Ronan&nbsp;Le Bras, Jianfeng Gao, and Yejin Choi.

</span>
<span class="ltx_bibblock">PIQA: reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.5.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1911.11641, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">CCKS [23]</span>
<span class="ltx_bibblock">
Jerry Chee, Yaohui Cai, Volodymyr Kuleshov, and Christopher&nbsp;De Sa.

</span>
<span class="ltx_bibblock">QuIP: 2-bit quantization of large language models with guarantees.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/2307.13304, 2023.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">CLC<sup id="bib.bib3.4.4.1" class="ltx_sup"><span id="bib.bib3.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [19]</span>
<span class="ltx_bibblock">
Christopher Clark, Kenton Lee, Ming-Wei Chang, Tom Kwiatkowski, Michael Collins, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Boolq: Exploring the surprising difficulty of natural yes/no questions.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.5.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1905.10044, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Com [23]</span>
<span class="ltx_bibblock">
Together Computer.

</span>
<span class="ltx_bibblock">Redpajama: an open dataset for training large language models, 2023.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">FAHA [23]</span>
<span class="ltx_bibblock">
Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and Dan Alistarh.

</span>
<span class="ltx_bibblock">OPTQ: accurate quantization for generative pre-trained transformers.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">The Eleventh International Conference on Learning Representations</span>, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">HCB<sup id="bib.bib6.4.4.1" class="ltx_sup"><span id="bib.bib6.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [19]</span>
<span class="ltx_bibblock">
Yanping Huang, Youlong Cheng, Ankur Bapna, Orhan Firat, Dehao Chen, Mia&nbsp;Xu Chen, HyoukJoong Lee, Jiquan Ngiam, Quoc&nbsp;V. Le, Yonghui Wu, and Zhifeng Chen.

</span>
<span class="ltx_bibblock">Gpipe: Efficient training of giant neural networks using pipeline parallelism.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.5.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages 103–112, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hor [14]</span>
<span class="ltx_bibblock">
Mark Horowitz.

</span>
<span class="ltx_bibblock">1.1 computing’s energy problem (and what we can do about it).

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">2014 IEEE International Conference on Solid-State Circuits Conference, ISSCC 2014, Digest of Technical Papers, San Francisco, CA, USA, February 9-13, 2014</span>, pages 10–14, 2014.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">KLZ<sup id="bib.bib8.4.4.1" class="ltx_sup"><span id="bib.bib8.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [23]</span>
<span class="ltx_bibblock">
Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying Sheng, Lianmin Zheng, Cody&nbsp;Hao Yu, Joseph&nbsp;E. Gonzalez, Hao Zhang, and Ion Stoica.

</span>
<span class="ltx_bibblock">Efficient memory management for large language model serving with pagedattention.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.5.1" class="ltx_text ltx_font_italic">Proceedings of the ACM SIGOPS 29th Symposium on Operating Systems Principles</span>, 2023.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LTT<sup id="bib.bib9.4.4.1" class="ltx_sup"><span id="bib.bib9.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [23]</span>
<span class="ltx_bibblock">
Ji&nbsp;Lin, Jiaming Tang, Haotian Tang, Shang Yang, Xingyu Dang, and Song Han.

</span>
<span class="ltx_bibblock">AWQ: activation-aware weight quantization for LLM compression and acceleration.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.5.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/2306.00978, 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">MCKS [18]</span>
<span class="ltx_bibblock">
Todor Mihaylov, Peter Clark, Tushar Khot, and Ashish Sabharwal.

</span>
<span class="ltx_bibblock">Can a suit of armor conduct electricity? A new dataset for open book question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1809.02789, 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">MXBS [16]</span>
<span class="ltx_bibblock">
Stephen Merity, Caiming Xiong, James Bradbury, and Richard Socher.

</span>
<span class="ltx_bibblock">Pointer sentinel mixture models, 2016.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">PKL<sup id="bib.bib12.4.4.1" class="ltx_sup"><span id="bib.bib12.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [16]</span>
<span class="ltx_bibblock">
Denis Paperno, Germán Kruszewski, Angeliki Lazaridou, Quan&nbsp;Ngoc Pham, Raffaella Bernardi, Sandro Pezzelle, Marco Baroni, Gemma Boleda, and Raquel Fernández.

</span>
<span class="ltx_bibblock">The LAMBADA dataset: Word prediction requiring a broad discourse context.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.5.1" class="ltx_text ltx_font_italic">Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics, ACL 2016, August 7-12, 2016, Berlin, Germany, Volume 1: Long Papers</span>. The Association for Computer Linguistics, 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">RSR<sup id="bib.bib13.4.4.1" class="ltx_sup"><span id="bib.bib13.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [19]</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter&nbsp;J. Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text transformer.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.5.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1910.10683, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">SAL<sup id="bib.bib14.4.4.1" class="ltx_sup"><span id="bib.bib14.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [24]</span>
<span class="ltx_bibblock">
Jianlin Su, Murtadha H.&nbsp;M. Ahmed, Yu&nbsp;Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.5.1" class="ltx_text ltx_font_italic">Neurocomputing</span>, 568:127063, 2024.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">SBBC [20]</span>
<span class="ltx_bibblock">
Keisuke Sakaguchi, Ronan&nbsp;Le Bras, Chandra Bhagavatula, and Yejin Choi.

</span>
<span class="ltx_bibblock">WinoGrande: an adversarial winograd schema challenge at scale.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">The Thirty-Fourth AAAI Conference on Artificial Intelligence</span>, pages 8732–8740, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sha [20]</span>
<span class="ltx_bibblock">
Noam Shazeer.

</span>
<span class="ltx_bibblock">GLU variants improve transformer.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/2002.05202, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jonathan Tow, Marco Bellagente, Dakota Mahan, and Carlos Riquelme.

</span>
<span class="ltx_bibblock">Stablelm 3b 4e1t.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">TCS<sup id="bib.bib18.4.4.1" class="ltx_sup"><span id="bib.bib18.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [24]</span>
<span class="ltx_bibblock">
Albert Tseng, Jerry Chee, Qingyao Sun, Volodymyr Kuleshov, and Christopher&nbsp;De Sa.

</span>
<span class="ltx_bibblock">Quip#: Even better LLM quantization with hadamard incoherence and lattice codebooks.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.5.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/2402.04396, 2024.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">TLI<sup id="bib.bib19.4.4.1" class="ltx_sup"><span id="bib.bib19.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [23]</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, Aurelien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume Lample.

</span>
<span class="ltx_bibblock">LLaMA: open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.5.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/2302.13971, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">TMS<sup id="bib.bib20.4.4.1" class="ltx_sup"><span id="bib.bib20.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [23]</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian&nbsp;Canton Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, and et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama 2: open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.5.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/2307.09288, 2023.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">WLG [17]</span>
<span class="ltx_bibblock">
Johannes Welbl, Nelson&nbsp;F. Liu, and Matt Gardner.

</span>
<span class="ltx_bibblock">Crowdsourcing multiple choice science questions.

</span>
<span class="ltx_bibblock">In Leon Derczynski, Wei Xu, Alan Ritter, and Tim Baldwin, editors, <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Proceedings of the 3rd Workshop on Noisy User-generated Text, NUT@EMNLP 2017, Copenhagen, Denmark, September 7, 2017</span>, pages 94–106. Association for Computational Linguistics, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">WMC<sup id="bib.bib22.4.4.1" class="ltx_sup"><span id="bib.bib22.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [23]</span>
<span class="ltx_bibblock">
Lei Wang, Lingxiao Ma, Shijie Cao, Ningxin Zheng, Quanlu Zhang, Jilong Xue, Ziming Miao, Ting Cao, , and Yuqing Yang.

</span>
<span class="ltx_bibblock">Ladder: Efficient tensor compilation on customized data format.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.5.1" class="ltx_text ltx_font_italic">OSDI</span>, 2023.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">WMD<sup id="bib.bib23.4.4.1" class="ltx_sup"><span id="bib.bib23.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [23]</span>
<span class="ltx_bibblock">
Hongyu Wang, Shuming Ma, Li&nbsp;Dong, Shaohan Huang, Huaijie Wang, Lingxiao Ma, Fan Yang, Ruiping Wang, Yi&nbsp;Wu, and Furu Wei.

</span>
<span class="ltx_bibblock">Bitnet: Scaling 1-bit transformers for large language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.5.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/2310.11453, 2023.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">XLS<sup id="bib.bib24.4.4.1" class="ltx_sup"><span id="bib.bib24.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [23]</span>
<span class="ltx_bibblock">
Guangxuan Xiao, Ji&nbsp;Lin, Mickaël Seznec, Hao Wu, Julien Demouth, and Song Han.

</span>
<span class="ltx_bibblock">SmoothQuant: accurate and efficient post-training quantization for large language models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.5.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning, ICML 2023, 23-29 July 2023, Honolulu, Hawaii, USA</span>, 2023.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">YBS [19]</span>
<span class="ltx_bibblock">
Vikas Yadav, Steven Bethard, and Mihai Surdeanu.

</span>
<span class="ltx_bibblock">Quick and (not so) dirty: Unsupervised selection of justification sentences for multi-hop question answering.

</span>
<span class="ltx_bibblock">In Kentaro Inui, Jing Jiang, Vincent Ng, and Xiaojun Wan, editors, <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">EMNLP-IJCNLP</span>, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">ZHB<sup id="bib.bib26.4.4.1" class="ltx_sup"><span id="bib.bib26.4.4.1.1" class="ltx_text ltx_font_italic">+</span></sup> [19]</span>
<span class="ltx_bibblock">
Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi.

</span>
<span class="ltx_bibblock">HellaSwag: can a machine really finish your sentence?

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.5.1" class="ltx_text ltx_font_italic">Proceedings of the 57th Conference of the Association for Computational Linguistics</span>, pages 4791–4800, 2019.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">ZS [19]</span>
<span class="ltx_bibblock">
Biao Zhang and Rico Sennrich.

</span>
<span class="ltx_bibblock">Root mean square layer normalization.

</span>
<span class="ltx_bibblock">In Hanna&nbsp;M. Wallach, Hugo Larochelle, Alina Beygelzimer, Florence d’Alché-Buc, Emily&nbsp;B. Fox, and Roman Garnett, editors, <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages 12360–12371, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">ZZL [22]</span>
<span class="ltx_bibblock">
Yichi Zhang, Zhiru Zhang, and Lukasz Lew.

</span>
<span class="ltx_bibblock">PokeBNN: A binary pursuit of lightweight accuracy.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</span>, pages 12465–12475. IEEE, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2402.17762" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2402.17764" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+2402.17764">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2402.17764" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2402.17765" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar  5 13:45:58 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>