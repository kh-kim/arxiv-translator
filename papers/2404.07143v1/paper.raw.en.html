<html lang="en" data-theme="dark"><head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention</title>
<!--Generated on Wed Apr 10 16:10:49 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2404.07143v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
      <div class="html-header-logo">
        <a href="https://arxiv.org/">
          <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
          <span class="sr-only">Back to arXiv</span>
        </a>
      </div>
  
      <!--TOC, dark mode, links-->
      <div class="html-header-nav">
        <!--back to abstract-->
        
          <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2404.07143v1">
          <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
              <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
          </svg>
          </a>
        <!--dark mode-->
        <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode" aria-label="Dark mode">
          <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3" hidden="">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
          </label>
          <label id="light-tog" class="toggle-icon" title="Switch to dark mode" for="__palette_1" hidden="">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
          </label>
          <label id="dark-tog" class="toggle-icon" title="Switch to system preference" for="__palette_2">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
          </label>
        </a>
        <!--nav-->
        <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
          <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
        </button>
      </div>
      </header><header class="desktop_header">
      <div class="html-header-logo">
        <a href="https://arxiv.org/">
            <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
            <span class="sr-only">Back to arXiv</span>
        </a>
      </div>
      <div class="html-header-message" role="banner">
          <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
          </p>
      </div>
      <nav class="html-header-nav">
        <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
        <a class="ar5iv-footer-button hover-effect" target="_blank" href="#myForm" onclick="event.preventDefault(); var modal = document.getElementById('myForm'); modal.style.display = 'block'; bugReportState.setInitiateWay('Header');">Report Issue</a>
        <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2404.07143v1">Back to Abstract</a>
        <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2404.07143v1" target="_blank">Download PDF</a>
        <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3" hidden="">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        <label id="light-tog" class="toggle-icon" title="Switch to dark mode" for="__palette_1" hidden="">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
        </label>
        <label id="dark-tog" class="toggle-icon" title="Switch to system preference" for="__palette_2">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
        </label>
      </a>
      </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

        <div id="listIcon" type="button" class="hide">
            <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
            <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
            </svg>
        </div>
        <div id="arrowIcon" type="button">
            <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
            <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
            </svg>
        </div><ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S1" title="1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2" title="2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.SS1" title="2.1 Infini-attention ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Infini-attention</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.SS1.SSS1" title="2.1.1 Scaled Dot-product Attention ‣ 2.1 Infini-attention ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.1 </span>Scaled Dot-product Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.SS1.SSS2" title="2.1.2 Compressive Memory ‣ 2.1 Infini-attention ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.2 </span>Compressive Memory</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.SS2" title="2.2 Memory and Effective Context Window ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Memory and Effective Context Window</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3" title="3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.SS1" title="3.1 Long-context Language Modeling ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Long-context Language Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.SS2" title="3.2 LLM Continual Pre-training ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>LLM Continual Pre-training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S4" title="4 Related Work ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S5" title="5 Conclusion ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#A1" title="Appendix A Additional Training Details ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional Training Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#A2" title="Appendix B Passkey Retrieval Task ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Passkey Retrieval Task</span></a></li>
</ol></nav>

<div class="ltx_page_content"><div class="section" id="target-section"><div id="license-tr">License: arXiv.org perpetual non-exclusive license</div><div id="watermark-tr">arXiv:2404.07143v1 [cs.CL] 10 Apr 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Leave No Context Behind: 
<br class="ltx_break">Efficient Infinite Context Transformers with Infini-attention</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tsendsuren Munkhdalai, Manaal Faruqui and Siddharth Gopal
<br class="ltx_break">Google 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">tsendsuren@google.com</span>
</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id2.id1">This work introduces an efficient method to scale Transformer-based Large Language Models (LLMs) to infinitely long inputs with bounded memory and computation. A key component in our proposed approach is a new attention technique dubbed Infini-attention. The Infini-attention incorporates a compressive memory into the vanilla attention mechanism and builds in both masked local attention and long-term linear attention mechanisms in a single Transformer block.
We demonstrate the effectiveness of our approach on long-context language modeling benchmarks, 1M sequence length passkey context block retrieval and 500K length book summarization tasks with 1B and 8B LLMs. Our approach introduces minimal bounded memory parameters and enables fast streaming inference for LLMs.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Memory serves as a cornerstone of intelligence, as it enables efficient computations tailored to specific contexts. However, Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib54" title="">2017</a>)</cite> and Transformer-based LLMs&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Brown et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib6" title="">2020</a>; Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib53" title="">2023</a>; Anil et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib1" title="">2023</a>; Groeneveld et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib20" title="">2024</a>)</cite> have a constrained context-dependent memory, due to the nature of the attention mechanism.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="268" id="S1.F1.g1" src="x1.png" width="304">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Infini-attention has an additional compressive memory with linear attention for processing infinitely long contexts. <math alttext="\{KV\}_{s-1}" class="ltx_Math" display="inline" id="S1.F1.4.m1.1"><semantics id="S1.F1.4.m1.1b"><msub id="S1.F1.4.m1.1.1" xref="S1.F1.4.m1.1.1.cmml"><mrow id="S1.F1.4.m1.1.1.1.1" xref="S1.F1.4.m1.1.1.1.2.cmml"><mo id="S1.F1.4.m1.1.1.1.1.2" stretchy="false" xref="S1.F1.4.m1.1.1.1.2.cmml">{</mo><mrow id="S1.F1.4.m1.1.1.1.1.1" xref="S1.F1.4.m1.1.1.1.1.1.cmml"><mi id="S1.F1.4.m1.1.1.1.1.1.2" xref="S1.F1.4.m1.1.1.1.1.1.2.cmml">K</mi><mo id="S1.F1.4.m1.1.1.1.1.1.1" xref="S1.F1.4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S1.F1.4.m1.1.1.1.1.1.3" xref="S1.F1.4.m1.1.1.1.1.1.3.cmml">V</mi></mrow><mo id="S1.F1.4.m1.1.1.1.1.3" stretchy="false" xref="S1.F1.4.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S1.F1.4.m1.1.1.3" xref="S1.F1.4.m1.1.1.3.cmml"><mi id="S1.F1.4.m1.1.1.3.2" xref="S1.F1.4.m1.1.1.3.2.cmml">s</mi><mo id="S1.F1.4.m1.1.1.3.1" xref="S1.F1.4.m1.1.1.3.1.cmml">−</mo><mn id="S1.F1.4.m1.1.1.3.3" xref="S1.F1.4.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F1.4.m1.1c"><apply id="S1.F1.4.m1.1.1.cmml" xref="S1.F1.4.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.4.m1.1.1.2.cmml" xref="S1.F1.4.m1.1.1">subscript</csymbol><set id="S1.F1.4.m1.1.1.1.2.cmml" xref="S1.F1.4.m1.1.1.1.1"><apply id="S1.F1.4.m1.1.1.1.1.1.cmml" xref="S1.F1.4.m1.1.1.1.1.1"><times id="S1.F1.4.m1.1.1.1.1.1.1.cmml" xref="S1.F1.4.m1.1.1.1.1.1.1"></times><ci id="S1.F1.4.m1.1.1.1.1.1.2.cmml" xref="S1.F1.4.m1.1.1.1.1.1.2">𝐾</ci><ci id="S1.F1.4.m1.1.1.1.1.1.3.cmml" xref="S1.F1.4.m1.1.1.1.1.1.3">𝑉</ci></apply></set><apply id="S1.F1.4.m1.1.1.3.cmml" xref="S1.F1.4.m1.1.1.3"><minus id="S1.F1.4.m1.1.1.3.1.cmml" xref="S1.F1.4.m1.1.1.3.1"></minus><ci id="S1.F1.4.m1.1.1.3.2.cmml" xref="S1.F1.4.m1.1.1.3.2">𝑠</ci><cn id="S1.F1.4.m1.1.1.3.3.cmml" type="integer" xref="S1.F1.4.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.m1.1d">\{KV\}_{s-1}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.4.m1.1e">{ italic_K italic_V } start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\{KV\}_{s}" class="ltx_Math" display="inline" id="S1.F1.5.m2.1"><semantics id="S1.F1.5.m2.1b"><msub id="S1.F1.5.m2.1.1" xref="S1.F1.5.m2.1.1.cmml"><mrow id="S1.F1.5.m2.1.1.1.1" xref="S1.F1.5.m2.1.1.1.2.cmml"><mo id="S1.F1.5.m2.1.1.1.1.2" stretchy="false" xref="S1.F1.5.m2.1.1.1.2.cmml">{</mo><mrow id="S1.F1.5.m2.1.1.1.1.1" xref="S1.F1.5.m2.1.1.1.1.1.cmml"><mi id="S1.F1.5.m2.1.1.1.1.1.2" xref="S1.F1.5.m2.1.1.1.1.1.2.cmml">K</mi><mo id="S1.F1.5.m2.1.1.1.1.1.1" xref="S1.F1.5.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S1.F1.5.m2.1.1.1.1.1.3" xref="S1.F1.5.m2.1.1.1.1.1.3.cmml">V</mi></mrow><mo id="S1.F1.5.m2.1.1.1.1.3" stretchy="false" xref="S1.F1.5.m2.1.1.1.2.cmml">}</mo></mrow><mi id="S1.F1.5.m2.1.1.3" xref="S1.F1.5.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.5.m2.1c"><apply id="S1.F1.5.m2.1.1.cmml" xref="S1.F1.5.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.5.m2.1.1.2.cmml" xref="S1.F1.5.m2.1.1">subscript</csymbol><set id="S1.F1.5.m2.1.1.1.2.cmml" xref="S1.F1.5.m2.1.1.1.1"><apply id="S1.F1.5.m2.1.1.1.1.1.cmml" xref="S1.F1.5.m2.1.1.1.1.1"><times id="S1.F1.5.m2.1.1.1.1.1.1.cmml" xref="S1.F1.5.m2.1.1.1.1.1.1"></times><ci id="S1.F1.5.m2.1.1.1.1.1.2.cmml" xref="S1.F1.5.m2.1.1.1.1.1.2">𝐾</ci><ci id="S1.F1.5.m2.1.1.1.1.1.3.cmml" xref="S1.F1.5.m2.1.1.1.1.1.3">𝑉</ci></apply></set><ci id="S1.F1.5.m2.1.1.3.cmml" xref="S1.F1.5.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m2.1d">\{KV\}_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.5.m2.1e">{ italic_K italic_V } start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> are attention key and values for current and previous input segments, respectively and <math alttext="Q_{s}" class="ltx_Math" display="inline" id="S1.F1.6.m3.1"><semantics id="S1.F1.6.m3.1b"><msub id="S1.F1.6.m3.1.1" xref="S1.F1.6.m3.1.1.cmml"><mi id="S1.F1.6.m3.1.1.2" xref="S1.F1.6.m3.1.1.2.cmml">Q</mi><mi id="S1.F1.6.m3.1.1.3" xref="S1.F1.6.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.6.m3.1c"><apply id="S1.F1.6.m3.1.1.cmml" xref="S1.F1.6.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.6.m3.1.1.1.cmml" xref="S1.F1.6.m3.1.1">subscript</csymbol><ci id="S1.F1.6.m3.1.1.2.cmml" xref="S1.F1.6.m3.1.1.2">𝑄</ci><ci id="S1.F1.6.m3.1.1.3.cmml" xref="S1.F1.6.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m3.1d">Q_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.6.m3.1e">italic_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> the attention queries. PE denotes position embeddings.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The attention mechanism in Transformers exhibits quadratic complexity in both memory footprint and computation time.
For example, the attention Key-Value (KV) states have 3TB memory footprint for a 500B model with batch size 512 and context length 2048&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Pope et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib39" title="">2023</a>)</cite>.
Indeed, scaling LLMs to longer sequences (i.e. 1M tokens) is challenging with the standard Transformer architectures and serving longer and longer context models becomes costly financially.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Compressive memory systems promise to be more scalable and efficient than the attention mechanism for extremely long sequences&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kanerva, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib24" title="">1988</a>; Munkhdalai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>)</cite>. Instead of using an array that grows with the input sequence length, a compressive memory primarily maintains a fixed number of parameters to store and recall information with a bounded storage and computation costs. In the compressive memory, new information is added to the memory by changing its parameters with an objective that this information can be recovered back later on. However, the LLMs in their current state have yet to see an effective, practical compressive memory technique that balances simplicity along with quality.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this work, we introduce a novel approach that enables Transformer LLMs to effectively process infinitely long inputs with bounded memory footprint and computation. A key component in our proposed approach is a new attention technique dubbed Infini-attention (Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">1</span></a>). The Infini-attention incorporates a compressive memory into the vanilla attention mechanism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bahdanau et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib3" title="">2014</a>; Vaswani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib54" title="">2017</a>)</cite> and builds in both masked local attention and long-term linear attention mechanisms in a single Transformer block.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Such a subtle but critical modification to the Transformer attention layer enables a natural extension of existing LLMs to infinitely long contexts via continual pre-training and fine-tuning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our Infini-attention reuses all the key, value and query states of the standard attention computation for long-term memory consolidation and retrieval. We store old KV states of the attention in the compressive memory, instead of discarding them like in the standard attention mechanism. We then retrieve the values from the memory by using the attention query states when processing subsequent sequences. To compute the final contextual output, the Infini-attention aggregates the long-term memory-retrieved values and the local attention contexts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">In our experiments, we show that our approach outperforms baseline models on long-context language modeling benchmarks while having &nbsp;114x comprehension ratio in terms of memory size. The model achieves even better perplexity when trained with 100K sequence length. A 1B LLM naturally scales to 1M sequence length and solves the passkey retrieval task when injected with Infini-attention. Finally, we show that a 8B model with Infini-attention reaches a new SOTA result on a 500K length book summarization task after continual pre-training and task fine-tuning.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">In summary, our work makes the following contributions:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce a practical and yet powerful attention mechanism – Infini-attention with long-term compressive memory and local causal attention for efficiently modeling both long and short-range contextual dependencies.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Infini-attention introduces minimal change to the standard scaled dot-product attention and supports plug-and-play continual pre-training and long-context adaptation by design.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Our approach enables Transformer LLMs to scale to infinitely long context with a bounded memory and compute resource by processing extremely long inputs in a streaming fashion.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Method</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="390" id="S2.F2.g1" src="x2.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Infini-Transformer (top) has an entire context history whereas Transformer-XL (bottom) discards old contexts since it caches the KV states for the last segment only.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.3">Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.F2" title="Figure 2 ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">2</span></a> compares our model, Infini-Transformer, and Transformer-XL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib14" title="">2019</a>)</cite>.
Similar to Transformer-XL, Infini-Transformer operates on a sequence of segments. We compute the standard causal dot-product attention context within each segment. So the dot-product attention computation is local in a sense that it covers a total <math alttext="N" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_N</annotation></semantics></math> number of tokens of the current segment with index <math alttext="S" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_S</annotation></semantics></math> (<math alttext="N" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_N</annotation></semantics></math> is the segment length).
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">The local attention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib14" title="">2019</a>)</cite>, however, discards the attention states of the previous segment when processing the next one. In Infini-Transformers, instead of leaving out the old KV attention states, we propose to reuse them to maintain the entire context history with a compressive memory. So each attention layer of Infini-Transformers has both global compressive and local fine-grained states. We call such an efficient attention mechanism Infini-attention, which is illustrated in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">1</span></a> and described formally in the following sections.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Infini-attention</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.2">As shown Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">1</span></a>, our Infini-attention computes both local and global context states and combine them for its output. Similar to multi-head attention (MHA), it maintains <math alttext="H" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_H</annotation></semantics></math> number of parallel compressive memory per attention layer (<math alttext="H" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_H</annotation></semantics></math> is the number of attention heads) in addition to the dot-product attention.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsubsection" id="S2.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Scaled Dot-product Attention</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS1.p1">
<p class="ltx_p" id="S2.SS1.SSS1.p1.1">The multi-head scaled dot-product attention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib54" title="">2017</a>)</cite>, specially its self-attention variant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib36" title="">2016</a>; Cheng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib10" title="">2016</a>)</cite>, has been the main building block in LLMs. The MHA’s strong capability to model context-dependent dynamic computation and its conveniences of temporal masking have been leveraged extensively in the autoregressive generative models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS1.p2">
<p class="ltx_p" id="S2.SS1.SSS1.p2.2">A single head in the vanilla MHA computes its attention context <math alttext="A_{dot}\in{\rm I\!R}^{N\times d_{value}}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p2.1.m1.1"><semantics id="S2.SS1.SSS1.p2.1.m1.1a"><mrow id="S2.SS1.SSS1.p2.1.m1.1.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.cmml"><msub id="S2.SS1.SSS1.p2.1.m1.1.1.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.2.cmml">A</mi><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.2.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2.cmml">d</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1a" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.SS1.SSS1.p2.1.m1.1.1.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.1.m1.1.1.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p2.1.m1.1b"><apply id="S2.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1"><in id="S2.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.1"></in><apply id="S2.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.2">𝐴</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2">𝑑</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.2">I</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p2.1.m1.1c">A_{dot}\in{\rm I\!R}^{N\times d_{value}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p2.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_d italic_o italic_t end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> from sequence of input segments <math alttext="X\in{\rm I\!R}^{N\times d_{model}}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p2.2.m2.1"><semantics id="S2.SS1.SSS1.p2.2.m2.1a"><mrow id="S2.SS1.SSS1.p2.2.m2.1.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.2.cmml">X</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.2.m2.1.1.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.2.m2.1.1.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2.cmml">m</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4.cmml">d</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5.cmml">e</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p2.2.m2.1b"><apply id="S2.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1"><in id="S2.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.1"></in><ci id="S2.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.2">𝑋</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3"><times id="S2.SS1.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3"><times id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3"><times id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p2.2.m2.1c">X\in{\rm I\!R}^{N\times d_{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p2.2.m2.1d">italic_X ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as follows. First, it computes attention query, key, and value states:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="K=XW_{K},\text{ }V=XW_{V}\text{ and }Q=XW_{Q}." class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1"><mrow id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.3.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">K</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.cmml">X</mi><mo id="S2.E1.m1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.cmml">K</mi></msub></mrow></mrow><mo id="S2.E1.m1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.E1.m1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.2.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.cmml"><mtext id="S2.E1.m1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.2a.cmml">&nbsp;</mtext><mo id="S2.E1.m1.1.1.1.1.2.2.2.1" xref="S2.E1.m1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.2.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.2.3.cmml">V</mi></mrow><mo id="S2.E1.m1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.3.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.2.2.4" xref="S2.E1.m1.1.1.1.1.2.2.4.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.4.2" xref="S2.E1.m1.1.1.1.1.2.2.4.2.cmml">X</mi><mo id="S2.E1.m1.1.1.1.1.2.2.4.1" xref="S2.E1.m1.1.1.1.1.2.2.4.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.2.2.4.3" xref="S2.E1.m1.1.1.1.1.2.2.4.3.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.4.3.2" xref="S2.E1.m1.1.1.1.1.2.2.4.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.1.1.2.2.4.3.3" xref="S2.E1.m1.1.1.1.1.2.2.4.3.3.cmml">V</mi></msub><mo id="S2.E1.m1.1.1.1.1.2.2.4.1a" xref="S2.E1.m1.1.1.1.1.2.2.4.1.cmml">⁢</mo><mtext id="S2.E1.m1.1.1.1.1.2.2.4.4" xref="S2.E1.m1.1.1.1.1.2.2.4.4a.cmml">&nbsp;and&nbsp;</mtext><mo id="S2.E1.m1.1.1.1.1.2.2.4.1b" xref="S2.E1.m1.1.1.1.1.2.2.4.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.2.2.4.5" xref="S2.E1.m1.1.1.1.1.2.2.4.5.cmml">Q</mi></mrow><mo id="S2.E1.m1.1.1.1.1.2.2.5" xref="S2.E1.m1.1.1.1.1.2.2.5.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.2.2.6" xref="S2.E1.m1.1.1.1.1.2.2.6.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.6.2" xref="S2.E1.m1.1.1.1.1.2.2.6.2.cmml">X</mi><mo id="S2.E1.m1.1.1.1.1.2.2.6.1" xref="S2.E1.m1.1.1.1.1.2.2.6.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.2.2.6.3" xref="S2.E1.m1.1.1.1.1.2.2.6.3.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.6.3.2" xref="S2.E1.m1.1.1.1.1.2.2.6.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.1.1.2.2.6.3.3" xref="S2.E1.m1.1.1.1.1.2.2.6.3.3.cmml">Q</mi></msub></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3a.cmml" xref="S2.E1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"></eq><ci id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">𝐾</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3"><times id="S2.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.1"></times><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2">𝑋</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3">𝐾</ci></apply></apply></apply><apply id="S2.E1.m1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><and id="S2.E1.m1.1.1.1.1.2.2a.cmml" xref="S2.E1.m1.1.1.1.1.2.2"></and><apply id="S2.E1.m1.1.1.1.1.2.2b.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><eq id="S2.E1.m1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.3"></eq><apply id="S2.E1.m1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2"><times id="S2.E1.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.2.2a.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2"><mtext id="S2.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2">&nbsp;</mtext></ci><ci id="S2.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.3">𝑉</ci></apply><apply id="S2.E1.m1.1.1.1.1.2.2.4.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4"><times id="S2.E1.m1.1.1.1.1.2.2.4.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.4.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.2">𝑋</ci><apply id="S2.E1.m1.1.1.1.1.2.2.4.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.4.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.4.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.1.1.2.2.4.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3.3">𝑉</ci></apply><ci id="S2.E1.m1.1.1.1.1.2.2.4.4a.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.4"><mtext id="S2.E1.m1.1.1.1.1.2.2.4.4.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.4">&nbsp;and&nbsp;</mtext></ci><ci id="S2.E1.m1.1.1.1.1.2.2.4.5.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.5">𝑄</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.2.2c.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><eq id="S2.E1.m1.1.1.1.1.2.2.5.cmml" xref="S2.E1.m1.1.1.1.1.2.2.5"></eq><share href="#S2.E1.m1.1.1.1.1.2.2.4.cmml" id="S2.E1.m1.1.1.1.1.2.2d.cmml" xref="S2.E1.m1.1.1.1.1.2.2"></share><apply id="S2.E1.m1.1.1.1.1.2.2.6.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6"><times id="S2.E1.m1.1.1.1.1.2.2.6.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.6.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.2">𝑋</ci><apply id="S2.E1.m1.1.1.1.1.2.2.6.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.6.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.6.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.1.1.2.2.6.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3.3">𝑄</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">K=XW_{K},\text{ }V=XW_{V}\text{ and }Q=XW_{Q}.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">italic_K = italic_X italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_V = italic_X italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT and italic_Q = italic_X italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS1.p2.3">Here, <math alttext="W_{K}\in{\rm I\!R}^{d_{model}\times d_{key}},W_{V}\in{\rm I\!R}^{d_{model}%
\times d_{value}}\text{ and }W_{Q}\in{\rm I\!R}^{d_{model}\times d_{key}}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p2.3.m1.2"><semantics id="S2.SS1.SSS1.p2.3.m1.2a"><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.3.cmml"><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2.cmml">W</mi><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2.cmml">m</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1a" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4.cmml">d</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1b" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1c" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2.cmml">k</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4.cmml">y</mi></mrow></msub></mrow></msup></mrow></mrow><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.3a.cmml">,</mo><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2.cmml">W</mi><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3.cmml">V</mi></msub><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2.cmml">m</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4.cmml">d</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1c" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1c" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml">⁢</mo><mtext id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4a.cmml">&nbsp;and&nbsp;</mtext><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2.cmml">W</mi><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3.cmml">Q</mi></msub></mrow><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2.cmml">m</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4.cmml">d</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1c" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2.cmml">k</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4.cmml">y</mi></mrow></msub></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p2.3.m1.2b"><apply id="S2.SS1.SSS1.p2.3.m1.2.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.3a.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1"><in id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1"></in><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2">𝑊</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2">I</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1"></times><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"><and id="S2.SS1.SSS1.p2.3.m1.2.2.2.2a.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"></and><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2b.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"><in id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3"></in><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2">𝑊</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3">𝑉</ci></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2">I</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2">R</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1"></times><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4a.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4"><mtext id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4">&nbsp;and&nbsp;</mtext></ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2">𝑊</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3">𝑄</ci></apply></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2c.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"><in id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5"></in><share href="#S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.cmml" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2d.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"></share><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2">I</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2">R</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1"></times><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p2.3.m1.2c">W_{K}\in{\rm I\!R}^{d_{model}\times d_{key}},W_{V}\in{\rm I\!R}^{d_{model}%
\times d_{value}}\text{ and }W_{Q}\in{\rm I\!R}^{d_{model}\times d_{key}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p2.3.m1.2d">italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT and italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are trainable projection matrices.
Then, the attention context is calculated as a weighted average of all other values as</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A_{dot}=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{model}}}\right)V." class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><msub id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml"><mi id="S2.E2.m1.2.2.1.1.2.2" xref="S2.E2.m1.2.2.1.1.2.2.cmml">A</mi><mrow id="S2.E2.m1.2.2.1.1.2.3" xref="S2.E2.m1.2.2.1.1.2.3.cmml"><mi id="S2.E2.m1.2.2.1.1.2.3.2" xref="S2.E2.m1.2.2.1.1.2.3.2.cmml">d</mi><mo id="S2.E2.m1.2.2.1.1.2.3.1" xref="S2.E2.m1.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.2.3.3" xref="S2.E2.m1.2.2.1.1.2.3.3.cmml">o</mi><mo id="S2.E2.m1.2.2.1.1.2.3.1a" xref="S2.E2.m1.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.2.3.4" xref="S2.E2.m1.2.2.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml"><mtext id="S2.E2.m1.2.2.1.1.3.2" xref="S2.E2.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo id="S2.E2.m1.2.2.1.1.3.1" xref="S2.E2.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.3.3.2" xref="S2.E2.m1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.3.3.2.1" xref="S2.E2.m1.1.1.cmml">(</mo><mfrac id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mrow id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">Q</mi><mo id="S2.E2.m1.1.1.2.1" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><msup id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml"><mi id="S2.E2.m1.1.1.2.3.2" xref="S2.E2.m1.1.1.2.3.2.cmml">K</mi><mi id="S2.E2.m1.1.1.2.3.3" xref="S2.E2.m1.1.1.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><msub id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2.cmml">d</mi><mrow id="S2.E2.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.3.2.3.cmml"><mi id="S2.E2.m1.1.1.3.2.3.2" xref="S2.E2.m1.1.1.3.2.3.2.cmml">m</mi><mo id="S2.E2.m1.1.1.3.2.3.1" xref="S2.E2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.3" xref="S2.E2.m1.1.1.3.2.3.3.cmml">o</mi><mo id="S2.E2.m1.1.1.3.2.3.1a" xref="S2.E2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.4" xref="S2.E2.m1.1.1.3.2.3.4.cmml">d</mi><mo id="S2.E2.m1.1.1.3.2.3.1b" xref="S2.E2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.5" xref="S2.E2.m1.1.1.3.2.3.5.cmml">e</mi><mo id="S2.E2.m1.1.1.3.2.3.1c" xref="S2.E2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.6" xref="S2.E2.m1.1.1.3.2.3.6.cmml">l</mi></mrow></msub></msqrt></mfrac><mo id="S2.E2.m1.2.2.1.1.3.3.2.2" xref="S2.E2.m1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.2.2.1.1.3.1a" xref="S2.E2.m1.2.2.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.3.4" xref="S2.E2.m1.2.2.1.1.3.4.cmml">V</mi></mrow></mrow><mo id="S2.E2.m1.2.2.1.2" lspace="0em" xref="S2.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><eq id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"></eq><apply id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2">𝐴</ci><apply id="S2.E2.m1.2.2.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.3"><times id="S2.E2.m1.2.2.1.1.2.3.1.cmml" xref="S2.E2.m1.2.2.1.1.2.3.1"></times><ci id="S2.E2.m1.2.2.1.1.2.3.2.cmml" xref="S2.E2.m1.2.2.1.1.2.3.2">𝑑</ci><ci id="S2.E2.m1.2.2.1.1.2.3.3.cmml" xref="S2.E2.m1.2.2.1.1.2.3.3">𝑜</ci><ci id="S2.E2.m1.2.2.1.1.2.3.4.cmml" xref="S2.E2.m1.2.2.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"><times id="S2.E2.m1.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.3.1"></times><ci id="S2.E2.m1.2.2.1.1.3.2a.cmml" xref="S2.E2.m1.2.2.1.1.3.2"><mtext id="S2.E2.m1.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.3.3.2"><divide id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.3.3.2"></divide><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"><times id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.2.1"></times><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">𝑄</ci><apply id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.2.3">superscript</csymbol><ci id="S2.E2.m1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.2.3.2">𝐾</ci><ci id="S2.E2.m1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><root id="S2.E2.m1.1.1.3a.cmml" xref="S2.E2.m1.1.1.3"></root><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2">𝑑</ci><apply id="S2.E2.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3"><times id="S2.E2.m1.1.1.3.2.3.1.cmml" xref="S2.E2.m1.1.1.3.2.3.1"></times><ci id="S2.E2.m1.1.1.3.2.3.2.cmml" xref="S2.E2.m1.1.1.3.2.3.2">𝑚</ci><ci id="S2.E2.m1.1.1.3.2.3.3.cmml" xref="S2.E2.m1.1.1.3.2.3.3">𝑜</ci><ci id="S2.E2.m1.1.1.3.2.3.4.cmml" xref="S2.E2.m1.1.1.3.2.3.4">𝑑</ci><ci id="S2.E2.m1.1.1.3.2.3.5.cmml" xref="S2.E2.m1.1.1.3.2.3.5">𝑒</ci><ci id="S2.E2.m1.1.1.3.2.3.6.cmml" xref="S2.E2.m1.1.1.3.2.3.6">𝑙</ci></apply></apply></apply></apply><ci id="S2.E2.m1.2.2.1.1.3.4.cmml" xref="S2.E2.m1.2.2.1.1.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">A_{dot}=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{model}}}\right)V.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">italic_A start_POSTSUBSCRIPT italic_d italic_o italic_t end_POSTSUBSCRIPT = softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS1.p3">
<p class="ltx_p" id="S2.SS1.SSS1.p3.1">For MHA, we compute <math alttext="H" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p3.1.m1.1"><semantics id="S2.SS1.SSS1.p3.1.m1.1a"><mi id="S2.SS1.SSS1.p3.1.m1.1.1" xref="S2.SS1.SSS1.p3.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p3.1.m1.1b"><ci id="S2.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p3.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p3.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p3.1.m1.1d">italic_H</annotation></semantics></math> number of attention context vectors for each sequence element in parallel, concatenate them along the second dimension and then finally project the concatenated vector to the model space to obtain attention the output.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.2 </span>Compressive Memory</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p1">
<p class="ltx_p" id="S2.SS1.SSS2.p1.3">In Infini-attention, instead of computing new memory entries for compressive memory, we reuse the query, key and value states (<math alttext="Q" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.1.m1.1"><semantics id="S2.SS1.SSS2.p1.1.m1.1a"><mi id="S2.SS1.SSS2.p1.1.m1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.1.m1.1b"><ci id="S2.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.1.m1.1d">italic_Q</annotation></semantics></math>, <math alttext="K" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.2.m2.1"><semantics id="S2.SS1.SSS2.p1.2.m2.1a"><mi id="S2.SS1.SSS2.p1.2.m2.1.1" xref="S2.SS1.SSS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.2.m2.1b"><ci id="S2.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.2.m2.1d">italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.3.m3.1"><semantics id="S2.SS1.SSS2.p1.3.m3.1a"><mi id="S2.SS1.SSS2.p1.3.m3.1.1" xref="S2.SS1.SSS2.p1.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.3.m3.1b"><ci id="S2.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.3.m3.1d">italic_V</annotation></semantics></math>) from the dot-product attention computation.
The state sharing and reusing between the dot-product attention and compressive memory not only enables efficient plug-in-play long-context adaptation but also speeds up training and inference. Similar to the prior work&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>)</cite>, our goal is to store bindings of key and value states in the compressive memory and retrieve by using the query vectors.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p2">
<p class="ltx_p" id="S2.SS1.SSS2.p2.1">While there are different forms of compressive memory proposed in the literature&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hopfield, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib23" title="">1982</a>; Kanerva, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib24" title="">1988</a>; Schlag et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib44" title="">2019</a>; Munkhdalai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>)</cite>, for simplicity and computational efficiency, in this work we parameterize the memory with an associative matrix&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Schlag et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib45" title="">2020</a>)</cite>. This approach further allows us to cast the memory update and retrieval process as linear attention mechanism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib49" title="">2018</a>)</cite> and to leverage stable training techniques from the related methods. Specially, we adopt the update rule and retrieval mechanism by <cite class="ltx_cite ltx_citemacro_citet">Katharopoulos et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib25" title="">2020</a>)</cite> mainly due to its simplicity and competitive performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p3">
<p class="ltx_p" id="S2.SS1.SSS2.p3.3"><span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p3.3.1">Memory retrieval.</span> In Infini-attention, we retrieve new content <math alttext="A_{mem}\in{\rm I\!R}^{N\times d_{value}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p3.1.m1.1"><semantics id="S2.SS1.SSS2.p3.1.m1.1a"><mrow id="S2.SS1.SSS2.p3.1.m1.1.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.cmml"><msub id="S2.SS1.SSS2.p3.1.m1.1.1.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.2.cmml">A</mi><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.2.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2.cmml">m</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1a" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S2.SS1.SSS2.p3.1.m1.1.1.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p3.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p3.1.m1.1b"><apply id="S2.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1"><in id="S2.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.1"></in><apply id="S2.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.2">𝐴</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4">𝑚</ci></apply></apply><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p3.1.m1.1c">A_{mem}\in{\rm I\!R}^{N\times d_{value}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p3.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_m italic_e italic_m end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> from the memory <math alttext="M_{s-1}\in{\rm I\!R}^{d_{key}\times d_{value}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p3.2.m2.1"><semantics id="S2.SS1.SSS2.p3.2.m2.1a"><mrow id="S2.SS1.SSS2.p3.2.m2.1.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.cmml"><msub id="S2.SS1.SSS2.p3.2.m2.1.1.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.2.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.2.cmml">M</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.2.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2.cmml">s</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.SSS2.p3.2.m2.1.1.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p3.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.cmml"><msub id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2.cmml">k</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1a" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p3.2.m2.1b"><apply id="S2.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1"><in id="S2.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.1"></in><apply id="S2.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.2.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.2.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.2">𝑀</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3"><minus id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1"></minus><ci id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2">𝑠</ci><cn id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1"></times><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1"></times><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2">𝑘</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4">𝑦</ci></apply></apply><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p3.2.m2.1c">M_{s-1}\in{\rm I\!R}^{d_{key}\times d_{value}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p3.2.m2.1d">italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> by using the query <math alttext="Q\in{\rm I\!R}^{N\times d_{key}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p3.3.m3.1"><semantics id="S2.SS1.SSS2.p3.3.m3.1a"><mrow id="S2.SS1.SSS2.p3.3.m3.1.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.2.cmml">Q</mi><mo id="S2.SS1.SSS2.p3.3.m3.1.1.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p3.3.m3.1.1.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p3.3.m3.1.1.3.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p3.3.m3.1.1.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2.cmml">k</mi><mo id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4.cmml">y</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p3.3.m3.1b"><apply id="S2.SS1.SSS2.p3.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1"><in id="S2.SS1.SSS2.p3.3.m3.1.1.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.1"></in><ci id="S2.SS1.SSS2.p3.3.m3.1.1.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.2">𝑄</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3"><times id="S2.SS1.SSS2.p3.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.1"></times><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3"><times id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p3.3.m3.1c">Q\in{\rm I\!R}^{N\times d_{key}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p3.3.m3.1d">italic_Q ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A_{mem}=\frac{\sigma({Q})M_{s-1}}{{\sigma(Q)}z_{s-1}}." class="ltx_Math" display="block" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><msub id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2" xref="S2.E3.m1.3.3.1.1.2.2.cmml">A</mi><mrow id="S2.E3.m1.3.3.1.1.2.3" xref="S2.E3.m1.3.3.1.1.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.2.3.2" xref="S2.E3.m1.3.3.1.1.2.3.2.cmml">m</mi><mo id="S2.E3.m1.3.3.1.1.2.3.1" xref="S2.E3.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.3.3.1.1.2.3.3" xref="S2.E3.m1.3.3.1.1.2.3.3.cmml">e</mi><mo id="S2.E3.m1.3.3.1.1.2.3.1a" xref="S2.E3.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.3.3.1.1.2.3.4" xref="S2.E3.m1.3.3.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3.cmml">σ</mi><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.4.2" xref="S2.E3.m1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.4.2.1" stretchy="false" xref="S2.E3.m1.1.1.1.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">Q</mi><mo id="S2.E3.m1.1.1.1.4.2.2" stretchy="false" xref="S2.E3.m1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.1.1.1.2a" xref="S2.E3.m1.1.1.1.2.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.5" xref="S2.E3.m1.1.1.1.5.cmml"><mi id="S2.E3.m1.1.1.1.5.2" xref="S2.E3.m1.1.1.1.5.2.cmml">M</mi><mrow id="S2.E3.m1.1.1.1.5.3" xref="S2.E3.m1.1.1.1.5.3.cmml"><mi id="S2.E3.m1.1.1.1.5.3.2" xref="S2.E3.m1.1.1.1.5.3.2.cmml">s</mi><mo id="S2.E3.m1.1.1.1.5.3.1" xref="S2.E3.m1.1.1.1.5.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.5.3.3" xref="S2.E3.m1.1.1.1.5.3.3.cmml">1</mn></mrow></msub></mrow><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mi id="S2.E3.m1.2.2.2.3" xref="S2.E3.m1.2.2.2.3.cmml">σ</mi><mo id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.2.4.2" xref="S2.E3.m1.2.2.2.cmml"><mo id="S2.E3.m1.2.2.2.4.2.1" stretchy="false" xref="S2.E3.m1.2.2.2.cmml">(</mo><mi id="S2.E3.m1.2.2.2.1" xref="S2.E3.m1.2.2.2.1.cmml">Q</mi><mo id="S2.E3.m1.2.2.2.4.2.2" stretchy="false" xref="S2.E3.m1.2.2.2.cmml">)</mo></mrow><mo id="S2.E3.m1.2.2.2.2a" xref="S2.E3.m1.2.2.2.2.cmml">⁢</mo><msub id="S2.E3.m1.2.2.2.5" xref="S2.E3.m1.2.2.2.5.cmml"><mi id="S2.E3.m1.2.2.2.5.2" xref="S2.E3.m1.2.2.2.5.2.cmml">z</mi><mrow id="S2.E3.m1.2.2.2.5.3" xref="S2.E3.m1.2.2.2.5.3.cmml"><mi id="S2.E3.m1.2.2.2.5.3.2" xref="S2.E3.m1.2.2.2.5.3.2.cmml">s</mi><mo id="S2.E3.m1.2.2.2.5.3.1" xref="S2.E3.m1.2.2.2.5.3.1.cmml">−</mo><mn id="S2.E3.m1.2.2.2.5.3.3" xref="S2.E3.m1.2.2.2.5.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mrow><mo id="S2.E3.m1.3.3.1.2" lspace="0em" xref="S2.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><eq id="S2.E3.m1.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1"></eq><apply id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2">𝐴</ci><apply id="S2.E3.m1.3.3.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3"><times id="S2.E3.m1.3.3.1.1.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.3.1"></times><ci id="S2.E3.m1.3.3.1.1.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.3.2">𝑚</ci><ci id="S2.E3.m1.3.3.1.1.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3.3">𝑒</ci><ci id="S2.E3.m1.3.3.1.1.2.3.4.cmml" xref="S2.E3.m1.3.3.1.1.2.3.4">𝑚</ci></apply></apply><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><divide id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2"></divide><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><times id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3">𝜎</ci><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑄</ci><apply id="S2.E3.m1.1.1.1.5.cmml" xref="S2.E3.m1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.5.1.cmml" xref="S2.E3.m1.1.1.1.5">subscript</csymbol><ci id="S2.E3.m1.1.1.1.5.2.cmml" xref="S2.E3.m1.1.1.1.5.2">𝑀</ci><apply id="S2.E3.m1.1.1.1.5.3.cmml" xref="S2.E3.m1.1.1.1.5.3"><minus id="S2.E3.m1.1.1.1.5.3.1.cmml" xref="S2.E3.m1.1.1.1.5.3.1"></minus><ci id="S2.E3.m1.1.1.1.5.3.2.cmml" xref="S2.E3.m1.1.1.1.5.3.2">𝑠</ci><cn id="S2.E3.m1.1.1.1.5.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.5.3.3">1</cn></apply></apply></apply><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><times id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"></times><ci id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.3">𝜎</ci><ci id="S2.E3.m1.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.1">𝑄</ci><apply id="S2.E3.m1.2.2.2.5.cmml" xref="S2.E3.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.5.1.cmml" xref="S2.E3.m1.2.2.2.5">subscript</csymbol><ci id="S2.E3.m1.2.2.2.5.2.cmml" xref="S2.E3.m1.2.2.2.5.2">𝑧</ci><apply id="S2.E3.m1.2.2.2.5.3.cmml" xref="S2.E3.m1.2.2.2.5.3"><minus id="S2.E3.m1.2.2.2.5.3.1.cmml" xref="S2.E3.m1.2.2.2.5.3.1"></minus><ci id="S2.E3.m1.2.2.2.5.3.2.cmml" xref="S2.E3.m1.2.2.2.5.3.2">𝑠</ci><cn id="S2.E3.m1.2.2.2.5.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.2.5.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">A_{mem}=\frac{\sigma({Q})M_{s-1}}{{\sigma(Q)}z_{s-1}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">italic_A start_POSTSUBSCRIPT italic_m italic_e italic_m end_POSTSUBSCRIPT = divide start_ARG italic_σ ( italic_Q ) italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT end_ARG start_ARG italic_σ ( italic_Q ) italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p4">
<p class="ltx_p" id="S2.SS1.SSS2.p4.3">Here, <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p4.1.m1.1"><semantics id="S2.SS1.SSS2.p4.1.m1.1a"><mi id="S2.SS1.SSS2.p4.1.m1.1.1" xref="S2.SS1.SSS2.p4.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p4.1.m1.1b"><ci id="S2.SS1.SSS2.p4.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p4.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p4.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p4.1.m1.1d">italic_σ</annotation></semantics></math> and <math alttext="z_{s-1}\in{\rm I\!R}^{d_{key}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p4.2.m2.1"><semantics id="S2.SS1.SSS2.p4.2.m2.1a"><mrow id="S2.SS1.SSS2.p4.2.m2.1.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.cmml"><msub id="S2.SS1.SSS2.p4.2.m2.1.1.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.2.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.2.cmml">z</mi><mrow id="S2.SS1.SSS2.p4.2.m2.1.1.2.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2.cmml">s</mi><mo id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.SSS2.p4.2.m2.1.1.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p4.2.m2.1.1.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p4.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p4.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2.cmml">R</mi><msub id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2.cmml">k</mi><mo id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1a" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4.cmml">y</mi></mrow></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p4.2.m2.1b"><apply id="S2.SS1.SSS2.p4.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1"><in id="S2.SS1.SSS2.p4.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.1"></in><apply id="S2.SS1.SSS2.p4.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.2.m2.1.1.2.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p4.2.m2.1.1.2.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.2">𝑧</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3"><minus id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1"></minus><ci id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2">𝑠</ci><cn id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3"><times id="S2.SS1.SSS2.p4.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3"><times id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p4.2.m2.1c">z_{s-1}\in{\rm I\!R}^{d_{key}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p4.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are a nonlinear activation function and a normalization term, respectively. As the choice of the non-linearity and the norm method is crucial for training stability, following <cite class="ltx_cite ltx_citemacro_citet">Katharopoulos et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib25" title="">2020</a>)</cite> we record a sum over all keys as the normalization term <math alttext="z_{s-1}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p4.3.m3.1"><semantics id="S2.SS1.SSS2.p4.3.m3.1a"><msub id="S2.SS1.SSS2.p4.3.m3.1.1" xref="S2.SS1.SSS2.p4.3.m3.1.1.cmml"><mi id="S2.SS1.SSS2.p4.3.m3.1.1.2" xref="S2.SS1.SSS2.p4.3.m3.1.1.2.cmml">z</mi><mrow id="S2.SS1.SSS2.p4.3.m3.1.1.3" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.cmml"><mi id="S2.SS1.SSS2.p4.3.m3.1.1.3.2" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.2.cmml">s</mi><mo id="S2.SS1.SSS2.p4.3.m3.1.1.3.1" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.1.cmml">−</mo><mn id="S2.SS1.SSS2.p4.3.m3.1.1.3.3" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p4.3.m3.1b"><apply id="S2.SS1.SSS2.p4.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.3.m3.1.1.1.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p4.3.m3.1.1.2.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.2">𝑧</ci><apply id="S2.SS1.SSS2.p4.3.m3.1.1.3.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3"><minus id="S2.SS1.SSS2.p4.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.1"></minus><ci id="S2.SS1.SSS2.p4.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.2">𝑠</ci><cn id="S2.SS1.SSS2.p4.3.m3.1.1.3.3.cmml" type="integer" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p4.3.m3.1c">z_{s-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p4.3.m3.1d">italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT</annotation></semantics></math> and use element-wise ELU + 1 as the activation function&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clevert et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib13" title="">2015</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p5">
<p class="ltx_p" id="S2.SS1.SSS2.p5.5"><span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p5.5.1">Memory update.</span> Once the retrieval is done, we update the memory and the normalization term with the new KV entries and obtain the next states as</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}V\text{ and }z_{s}\leftarrow z_{s-1}+\sum%
_{t=1}^{N}\sigma(K_{t})." class="ltx_Math" display="block" id="S2.E4.m1.2"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.3" xref="S2.E4.m1.2.2.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.3.2" xref="S2.E4.m1.2.2.1.1.3.2.cmml">M</mi><mi id="S2.E4.m1.2.2.1.1.3.3" xref="S2.E4.m1.2.2.1.1.3.3.cmml">s</mi></msub><mo id="S2.E4.m1.2.2.1.1.4" stretchy="false" xref="S2.E4.m1.2.2.1.1.4.cmml">←</mo><mrow id="S2.E4.m1.2.2.1.1.5" xref="S2.E4.m1.2.2.1.1.5.cmml"><msub id="S2.E4.m1.2.2.1.1.5.2" xref="S2.E4.m1.2.2.1.1.5.2.cmml"><mi id="S2.E4.m1.2.2.1.1.5.2.2" xref="S2.E4.m1.2.2.1.1.5.2.2.cmml">M</mi><mrow id="S2.E4.m1.2.2.1.1.5.2.3" xref="S2.E4.m1.2.2.1.1.5.2.3.cmml"><mi id="S2.E4.m1.2.2.1.1.5.2.3.2" xref="S2.E4.m1.2.2.1.1.5.2.3.2.cmml">s</mi><mo id="S2.E4.m1.2.2.1.1.5.2.3.1" xref="S2.E4.m1.2.2.1.1.5.2.3.1.cmml">−</mo><mn id="S2.E4.m1.2.2.1.1.5.2.3.3" xref="S2.E4.m1.2.2.1.1.5.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E4.m1.2.2.1.1.5.1" xref="S2.E4.m1.2.2.1.1.5.1.cmml">+</mo><mrow id="S2.E4.m1.2.2.1.1.5.3" xref="S2.E4.m1.2.2.1.1.5.3.cmml"><mi id="S2.E4.m1.2.2.1.1.5.3.2" xref="S2.E4.m1.2.2.1.1.5.3.2.cmml">σ</mi><mo id="S2.E4.m1.2.2.1.1.5.3.1" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">⁢</mo><msup id="S2.E4.m1.2.2.1.1.5.3.3" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml"><mrow id="S2.E4.m1.2.2.1.1.5.3.3.2.2" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml"><mo id="S2.E4.m1.2.2.1.1.5.3.3.2.2.1" stretchy="false" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">K</mi><mo id="S2.E4.m1.2.2.1.1.5.3.3.2.2.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml">)</mo></mrow><mi id="S2.E4.m1.2.2.1.1.5.3.3.3" xref="S2.E4.m1.2.2.1.1.5.3.3.3.cmml">T</mi></msup><mo id="S2.E4.m1.2.2.1.1.5.3.1a" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">⁢</mo><mi id="S2.E4.m1.2.2.1.1.5.3.4" xref="S2.E4.m1.2.2.1.1.5.3.4.cmml">V</mi><mo id="S2.E4.m1.2.2.1.1.5.3.1b" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">⁢</mo><mtext id="S2.E4.m1.2.2.1.1.5.3.5" xref="S2.E4.m1.2.2.1.1.5.3.5a.cmml">&nbsp;and&nbsp;</mtext><mo id="S2.E4.m1.2.2.1.1.5.3.1c" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">⁢</mo><msub id="S2.E4.m1.2.2.1.1.5.3.6" xref="S2.E4.m1.2.2.1.1.5.3.6.cmml"><mi id="S2.E4.m1.2.2.1.1.5.3.6.2" xref="S2.E4.m1.2.2.1.1.5.3.6.2.cmml">z</mi><mi id="S2.E4.m1.2.2.1.1.5.3.6.3" xref="S2.E4.m1.2.2.1.1.5.3.6.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.6" stretchy="false" xref="S2.E4.m1.2.2.1.1.6.cmml">←</mo><mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.1.3.2.cmml">z</mi><mrow id="S2.E4.m1.2.2.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.1.3.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.3.3.2" xref="S2.E4.m1.2.2.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E4.m1.2.2.1.1.1.3.3.1" xref="S2.E4.m1.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E4.m1.2.2.1.1.1.3.3.3" xref="S2.E4.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E4.m1.2.2.1.1.1.2" rspace="0.055em" xref="S2.E4.m1.2.2.1.1.1.2.cmml">+</mo><mrow id="S2.E4.m1.2.2.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.cmml"><munderover id="S2.E4.m1.2.2.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E4.m1.2.2.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.2.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.2.2.3.2" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S2.E4.m1.2.2.1.1.1.1.2.2.3.1" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E4.m1.2.2.1.1.1.1.2.2.3.3" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E4.m1.2.2.1.1.1.1.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E4.m1.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.3.cmml">σ</mi><mo id="S2.E4.m1.2.2.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">K</mi><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" lspace="0em" xref="S2.E4.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><and id="S2.E4.m1.2.2.1.1a.cmml" xref="S2.E4.m1.2.2.1"></and><apply id="S2.E4.m1.2.2.1.1b.cmml" xref="S2.E4.m1.2.2.1"><ci id="S2.E4.m1.2.2.1.1.4.cmml" xref="S2.E4.m1.2.2.1.1.4">←</ci><apply id="S2.E4.m1.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2">𝑀</ci><ci id="S2.E4.m1.2.2.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.3.3">𝑠</ci></apply><apply id="S2.E4.m1.2.2.1.1.5.cmml" xref="S2.E4.m1.2.2.1.1.5"><plus id="S2.E4.m1.2.2.1.1.5.1.cmml" xref="S2.E4.m1.2.2.1.1.5.1"></plus><apply id="S2.E4.m1.2.2.1.1.5.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.2.1.cmml" xref="S2.E4.m1.2.2.1.1.5.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.5.2.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2.2">𝑀</ci><apply id="S2.E4.m1.2.2.1.1.5.2.3.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3"><minus id="S2.E4.m1.2.2.1.1.5.2.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3.1"></minus><ci id="S2.E4.m1.2.2.1.1.5.2.3.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3.2">𝑠</ci><cn id="S2.E4.m1.2.2.1.1.5.2.3.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.5.2.3.3">1</cn></apply></apply><apply id="S2.E4.m1.2.2.1.1.5.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3"><times id="S2.E4.m1.2.2.1.1.5.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.3.1"></times><ci id="S2.E4.m1.2.2.1.1.5.3.2.cmml" xref="S2.E4.m1.2.2.1.1.5.3.2">𝜎</ci><apply id="S2.E4.m1.2.2.1.1.5.3.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.3.3">superscript</csymbol><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝐾</ci><ci id="S2.E4.m1.2.2.1.1.5.3.3.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3.3.3">𝑇</ci></apply><ci id="S2.E4.m1.2.2.1.1.5.3.4.cmml" xref="S2.E4.m1.2.2.1.1.5.3.4">𝑉</ci><ci id="S2.E4.m1.2.2.1.1.5.3.5a.cmml" xref="S2.E4.m1.2.2.1.1.5.3.5"><mtext id="S2.E4.m1.2.2.1.1.5.3.5.cmml" xref="S2.E4.m1.2.2.1.1.5.3.5">&nbsp;and&nbsp;</mtext></ci><apply id="S2.E4.m1.2.2.1.1.5.3.6.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.3.6.1.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.5.3.6.2.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6.2">𝑧</ci><ci id="S2.E4.m1.2.2.1.1.5.3.6.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6.3">𝑠</ci></apply></apply></apply></apply><apply id="S2.E4.m1.2.2.1.1c.cmml" xref="S2.E4.m1.2.2.1"><ci id="S2.E4.m1.2.2.1.1.6.cmml" xref="S2.E4.m1.2.2.1.1.6">←</ci><share href="#S2.E4.m1.2.2.1.1.5.cmml" id="S2.E4.m1.2.2.1.1d.cmml" xref="S2.E4.m1.2.2.1"></share><apply id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"><plus id="S2.E4.m1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2"></plus><apply id="S2.E4.m1.2.2.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.3.2">𝑧</ci><apply id="S2.E4.m1.2.2.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3"><minus id="S2.E4.m1.2.2.1.1.1.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3.1"></minus><ci id="S2.E4.m1.2.2.1.1.1.3.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3.2">𝑠</ci><cn id="S2.E4.m1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.E4.m1.2.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1"><apply id="S2.E4.m1.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E4.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S2.E4.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S2.E4.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3"><eq id="S2.E4.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S2.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S2.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.2"></times><ci id="S2.E4.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.3">𝜎</ci><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2">𝐾</ci><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}V\text{ and }z_{s}\leftarrow z_{s-1}+\sum%
_{t=1}^{N}\sigma(K_{t}).</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.2d">italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT + italic_σ ( italic_K ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_V and italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_σ ( italic_K start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS2.p5.4">The new memory states <math alttext="M_{s}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p5.1.m1.1"><semantics id="S2.SS1.SSS2.p5.1.m1.1a"><msub id="S2.SS1.SSS2.p5.1.m1.1.1" xref="S2.SS1.SSS2.p5.1.m1.1.1.cmml"><mi id="S2.SS1.SSS2.p5.1.m1.1.1.2" xref="S2.SS1.SSS2.p5.1.m1.1.1.2.cmml">M</mi><mi id="S2.SS1.SSS2.p5.1.m1.1.1.3" xref="S2.SS1.SSS2.p5.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.1.m1.1b"><apply id="S2.SS1.SSS2.p5.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p5.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p5.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1.2">𝑀</ci><ci id="S2.SS1.SSS2.p5.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.1.m1.1c">M_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p5.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="z_{s}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p5.2.m2.1"><semantics id="S2.SS1.SSS2.p5.2.m2.1a"><msub id="S2.SS1.SSS2.p5.2.m2.1.1" xref="S2.SS1.SSS2.p5.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p5.2.m2.1.1.2" xref="S2.SS1.SSS2.p5.2.m2.1.1.2.cmml">z</mi><mi id="S2.SS1.SSS2.p5.2.m2.1.1.3" xref="S2.SS1.SSS2.p5.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.2.m2.1b"><apply id="S2.SS1.SSS2.p5.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p5.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p5.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1.2">𝑧</ci><ci id="S2.SS1.SSS2.p5.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.2.m2.1c">z_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p5.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> are then passed to the next segment <math alttext="S+1" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p5.3.m3.1"><semantics id="S2.SS1.SSS2.p5.3.m3.1a"><mrow id="S2.SS1.SSS2.p5.3.m3.1.1" xref="S2.SS1.SSS2.p5.3.m3.1.1.cmml"><mi id="S2.SS1.SSS2.p5.3.m3.1.1.2" xref="S2.SS1.SSS2.p5.3.m3.1.1.2.cmml">S</mi><mo id="S2.SS1.SSS2.p5.3.m3.1.1.1" xref="S2.SS1.SSS2.p5.3.m3.1.1.1.cmml">+</mo><mn id="S2.SS1.SSS2.p5.3.m3.1.1.3" xref="S2.SS1.SSS2.p5.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.3.m3.1b"><apply id="S2.SS1.SSS2.p5.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1"><plus id="S2.SS1.SSS2.p5.3.m3.1.1.1.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1.1"></plus><ci id="S2.SS1.SSS2.p5.3.m3.1.1.2.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1.2">𝑆</ci><cn id="S2.SS1.SSS2.p5.3.m3.1.1.3.cmml" type="integer" xref="S2.SS1.SSS2.p5.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.3.m3.1c">S+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p5.3.m3.1d">italic_S + 1</annotation></semantics></math>, building in a recurrence in each attention layer. The right side term <math alttext="\sigma(K)^{T}V" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p5.4.m4.1"><semantics id="S2.SS1.SSS2.p5.4.m4.1a"><mrow id="S2.SS1.SSS2.p5.4.m4.1.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.cmml"><mi id="S2.SS1.SSS2.p5.4.m4.1.2.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.2.cmml">σ</mi><mo id="S2.SS1.SSS2.p5.4.m4.1.2.1" xref="S2.SS1.SSS2.p5.4.m4.1.2.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p5.4.m4.1.2.3" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml"><mrow id="S2.SS1.SSS2.p5.4.m4.1.2.3.2.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml"><mo id="S2.SS1.SSS2.p5.4.m4.1.2.3.2.2.1" stretchy="false" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml">(</mo><mi id="S2.SS1.SSS2.p5.4.m4.1.1" xref="S2.SS1.SSS2.p5.4.m4.1.1.cmml">K</mi><mo id="S2.SS1.SSS2.p5.4.m4.1.2.3.2.2.2" stretchy="false" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml">)</mo></mrow><mi id="S2.SS1.SSS2.p5.4.m4.1.2.3.3" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.3.cmml">T</mi></msup><mo id="S2.SS1.SSS2.p5.4.m4.1.2.1a" xref="S2.SS1.SSS2.p5.4.m4.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p5.4.m4.1.2.4" xref="S2.SS1.SSS2.p5.4.m4.1.2.4.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.4.m4.1b"><apply id="S2.SS1.SSS2.p5.4.m4.1.2.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2"><times id="S2.SS1.SSS2.p5.4.m4.1.2.1.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.1"></times><ci id="S2.SS1.SSS2.p5.4.m4.1.2.2.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.2">𝜎</ci><apply id="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p5.4.m4.1.2.3.1.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.3">superscript</csymbol><ci id="S2.SS1.SSS2.p5.4.m4.1.1.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.1">𝐾</ci><ci id="S2.SS1.SSS2.p5.4.m4.1.2.3.3.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.3">𝑇</ci></apply><ci id="S2.SS1.SSS2.p5.4.m4.1.2.4.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.4">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.4.m4.1c">\sigma(K)^{T}V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p5.4.m4.1d">italic_σ ( italic_K ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_V</annotation></semantics></math> in Eq.&nbsp;(<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.E4" title="4 ‣ 2.1.2 Compressive Memory ‣ 2.1 Infini-attention ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">4</span></a>) is known as an associative binding operator&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Smolensky, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib50" title="">1990</a>; Hebb, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib21" title="">2005</a>; Schlag et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib45" title="">2020</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p6">
<p class="ltx_p" id="S2.SS1.SSS2.p6.1">Inspired by the success of delta rule&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>; Schlag et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib45" title="">2020</a>; <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib46" title="">2021</a>)</cite>, we have also incorporated it into our Infini-attention. The delta rule attempts a slightly improved memory update by first retrieving existing value entries and subtracting them from the new values before applying the associative bindings as new update.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}(V-\frac{\sigma({K})M_{s-1}}{{\sigma(K)}z%
_{s-1}})." class="ltx_Math" display="block" id="S2.E5.m1.4"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4.4.1" xref="S2.E5.m1.4.4.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1" xref="S2.E5.m1.4.4.1.1.cmml"><msub id="S2.E5.m1.4.4.1.1.3" xref="S2.E5.m1.4.4.1.1.3.cmml"><mi id="S2.E5.m1.4.4.1.1.3.2" xref="S2.E5.m1.4.4.1.1.3.2.cmml">M</mi><mi id="S2.E5.m1.4.4.1.1.3.3" xref="S2.E5.m1.4.4.1.1.3.3.cmml">s</mi></msub><mo id="S2.E5.m1.4.4.1.1.2" stretchy="false" xref="S2.E5.m1.4.4.1.1.2.cmml">←</mo><mrow id="S2.E5.m1.4.4.1.1.1" xref="S2.E5.m1.4.4.1.1.1.cmml"><msub id="S2.E5.m1.4.4.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.3.cmml"><mi id="S2.E5.m1.4.4.1.1.1.3.2" xref="S2.E5.m1.4.4.1.1.1.3.2.cmml">M</mi><mrow id="S2.E5.m1.4.4.1.1.1.3.3" xref="S2.E5.m1.4.4.1.1.1.3.3.cmml"><mi id="S2.E5.m1.4.4.1.1.1.3.3.2" xref="S2.E5.m1.4.4.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E5.m1.4.4.1.1.1.3.3.1" xref="S2.E5.m1.4.4.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E5.m1.4.4.1.1.1.3.3.3" xref="S2.E5.m1.4.4.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E5.m1.4.4.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="S2.E5.m1.4.4.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.1.3.cmml">σ</mi><mo id="S2.E5.m1.4.4.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.2.cmml">⁢</mo><msup id="S2.E5.m1.4.4.1.1.1.1.4" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml"><mrow id="S2.E5.m1.4.4.1.1.1.1.4.2.2" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml"><mo id="S2.E5.m1.4.4.1.1.1.1.4.2.2.1" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml">(</mo><mi id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml">K</mi><mo id="S2.E5.m1.4.4.1.1.1.1.4.2.2.2" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml">)</mo></mrow><mi id="S2.E5.m1.4.4.1.1.1.1.4.3" xref="S2.E5.m1.4.4.1.1.1.1.4.3.cmml">T</mi></msup><mo id="S2.E5.m1.4.4.1.1.1.1.2a" xref="S2.E5.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml">V</mi><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.3" xref="S2.E5.m1.1.1.1.3.cmml">σ</mi><mo id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.1.1.1.4.2" xref="S2.E5.m1.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.4.2.1" stretchy="false" xref="S2.E5.m1.1.1.1.cmml">(</mo><mi id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">K</mi><mo id="S2.E5.m1.1.1.1.4.2.2" stretchy="false" xref="S2.E5.m1.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.1.1.1.2a" xref="S2.E5.m1.1.1.1.2.cmml">⁢</mo><msub id="S2.E5.m1.1.1.1.5" xref="S2.E5.m1.1.1.1.5.cmml"><mi id="S2.E5.m1.1.1.1.5.2" xref="S2.E5.m1.1.1.1.5.2.cmml">M</mi><mrow id="S2.E5.m1.1.1.1.5.3" xref="S2.E5.m1.1.1.1.5.3.cmml"><mi id="S2.E5.m1.1.1.1.5.3.2" xref="S2.E5.m1.1.1.1.5.3.2.cmml">s</mi><mo id="S2.E5.m1.1.1.1.5.3.1" xref="S2.E5.m1.1.1.1.5.3.1.cmml">−</mo><mn id="S2.E5.m1.1.1.1.5.3.3" xref="S2.E5.m1.1.1.1.5.3.3.cmml">1</mn></mrow></msub></mrow><mrow id="S2.E5.m1.2.2.2" xref="S2.E5.m1.2.2.2.cmml"><mi id="S2.E5.m1.2.2.2.3" xref="S2.E5.m1.2.2.2.3.cmml">σ</mi><mo id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.2.4.2" xref="S2.E5.m1.2.2.2.cmml"><mo id="S2.E5.m1.2.2.2.4.2.1" stretchy="false" xref="S2.E5.m1.2.2.2.cmml">(</mo><mi id="S2.E5.m1.2.2.2.1" xref="S2.E5.m1.2.2.2.1.cmml">K</mi><mo id="S2.E5.m1.2.2.2.4.2.2" stretchy="false" xref="S2.E5.m1.2.2.2.cmml">)</mo></mrow><mo id="S2.E5.m1.2.2.2.2a" xref="S2.E5.m1.2.2.2.2.cmml">⁢</mo><msub id="S2.E5.m1.2.2.2.5" xref="S2.E5.m1.2.2.2.5.cmml"><mi id="S2.E5.m1.2.2.2.5.2" xref="S2.E5.m1.2.2.2.5.2.cmml">z</mi><mrow id="S2.E5.m1.2.2.2.5.3" xref="S2.E5.m1.2.2.2.5.3.cmml"><mi id="S2.E5.m1.2.2.2.5.3.2" xref="S2.E5.m1.2.2.2.5.3.2.cmml">s</mi><mo id="S2.E5.m1.2.2.2.5.3.1" xref="S2.E5.m1.2.2.2.5.3.1.cmml">−</mo><mn id="S2.E5.m1.2.2.2.5.3.3" xref="S2.E5.m1.2.2.2.5.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mrow><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.4.4.1.2" lspace="0em" xref="S2.E5.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.4b"><apply id="S2.E5.m1.4.4.1.1.cmml" xref="S2.E5.m1.4.4.1"><ci id="S2.E5.m1.4.4.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.2">←</ci><apply id="S2.E5.m1.4.4.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.3">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2">𝑀</ci><ci id="S2.E5.m1.4.4.1.1.3.3.cmml" xref="S2.E5.m1.4.4.1.1.3.3">𝑠</ci></apply><apply id="S2.E5.m1.4.4.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1"><plus id="S2.E5.m1.4.4.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.2"></plus><apply id="S2.E5.m1.4.4.1.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.1.3.2">𝑀</ci><apply id="S2.E5.m1.4.4.1.1.1.3.3.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3"><minus id="S2.E5.m1.4.4.1.1.1.3.3.1.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3.1"></minus><ci id="S2.E5.m1.4.4.1.1.1.3.3.2.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3.2">𝑠</ci><cn id="S2.E5.m1.4.4.1.1.1.3.3.3.cmml" type="integer" xref="S2.E5.m1.4.4.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.E5.m1.4.4.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1"><times id="S2.E5.m1.4.4.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.2"></times><ci id="S2.E5.m1.4.4.1.1.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.1.1.3">𝜎</ci><apply id="S2.E5.m1.4.4.1.1.1.1.4.cmml" xref="S2.E5.m1.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.1.1.4.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.4">superscript</csymbol><ci id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3">𝐾</ci><ci id="S2.E5.m1.4.4.1.1.1.1.4.3.cmml" xref="S2.E5.m1.4.4.1.1.1.1.4.3">𝑇</ci></apply><apply id="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1"><minus id="S2.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.1"></minus><ci id="S2.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.2">𝑉</ci><apply id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2"><divide id="S2.E5.m1.2.2.3.cmml" xref="S2.E5.m1.2.2"></divide><apply id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><times id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.2"></times><ci id="S2.E5.m1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.3">𝜎</ci><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">𝐾</ci><apply id="S2.E5.m1.1.1.1.5.cmml" xref="S2.E5.m1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.5.1.cmml" xref="S2.E5.m1.1.1.1.5">subscript</csymbol><ci id="S2.E5.m1.1.1.1.5.2.cmml" xref="S2.E5.m1.1.1.1.5.2">𝑀</ci><apply id="S2.E5.m1.1.1.1.5.3.cmml" xref="S2.E5.m1.1.1.1.5.3"><minus id="S2.E5.m1.1.1.1.5.3.1.cmml" xref="S2.E5.m1.1.1.1.5.3.1"></minus><ci id="S2.E5.m1.1.1.1.5.3.2.cmml" xref="S2.E5.m1.1.1.1.5.3.2">𝑠</ci><cn id="S2.E5.m1.1.1.1.5.3.3.cmml" type="integer" xref="S2.E5.m1.1.1.1.5.3.3">1</cn></apply></apply></apply><apply id="S2.E5.m1.2.2.2.cmml" xref="S2.E5.m1.2.2.2"><times id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2"></times><ci id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.3">𝜎</ci><ci id="S2.E5.m1.2.2.2.1.cmml" xref="S2.E5.m1.2.2.2.1">𝐾</ci><apply id="S2.E5.m1.2.2.2.5.cmml" xref="S2.E5.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.5.1.cmml" xref="S2.E5.m1.2.2.2.5">subscript</csymbol><ci id="S2.E5.m1.2.2.2.5.2.cmml" xref="S2.E5.m1.2.2.2.5.2">𝑧</ci><apply id="S2.E5.m1.2.2.2.5.3.cmml" xref="S2.E5.m1.2.2.2.5.3"><minus id="S2.E5.m1.2.2.2.5.3.1.cmml" xref="S2.E5.m1.2.2.2.5.3.1"></minus><ci id="S2.E5.m1.2.2.2.5.3.2.cmml" xref="S2.E5.m1.2.2.2.5.3.2">𝑠</ci><cn id="S2.E5.m1.2.2.2.5.3.3.cmml" type="integer" xref="S2.E5.m1.2.2.2.5.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.4c">M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}(V-\frac{\sigma({K})M_{s-1}}{{\sigma(K)}z%
_{s-1}}).</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.4d">italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT + italic_σ ( italic_K ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_V - divide start_ARG italic_σ ( italic_K ) italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT end_ARG start_ARG italic_σ ( italic_K ) italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p7">
<p class="ltx_p" id="S2.SS1.SSS2.p7.2">This update rule (<math alttext="Linear+Delta" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p7.1.m1.1"><semantics id="S2.SS1.SSS2.p7.1.m1.1a"><mrow id="S2.SS1.SSS2.p7.1.m1.1.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.cmml"><mrow id="S2.SS1.SSS2.p7.1.m1.1.1.2" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.cmml"><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.2" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.2.cmml">L</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.3" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.3.cmml">i</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1a" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.4" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.4.cmml">n</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1b" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.5" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.5.cmml">e</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1c" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.6" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.6.cmml">a</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1d" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.7" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.7.cmml">r</mi></mrow><mo id="S2.SS1.SSS2.p7.1.m1.1.1.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.1.cmml">+</mo><mrow id="S2.SS1.SSS2.p7.1.m1.1.1.3" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.2" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.2.cmml">D</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.3.1a" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.4" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.4.cmml">l</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.3.1b" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.5" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.5.cmml">t</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.3.1c" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.6" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.6.cmml">a</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p7.1.m1.1b"><apply id="S2.SS1.SSS2.p7.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1"><plus id="S2.SS1.SSS2.p7.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.1"></plus><apply id="S2.SS1.SSS2.p7.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2"><times id="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1"></times><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.2">𝐿</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.3">𝑖</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.4.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.4">𝑛</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.5.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.5">𝑒</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.6.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.6">𝑎</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.7.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.7">𝑟</ci></apply><apply id="S2.SS1.SSS2.p7.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3"><times id="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.2">𝐷</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.4.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.5.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.5">𝑡</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.6.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.6">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p7.1.m1.1c">Linear+Delta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p7.1.m1.1d">italic_L italic_i italic_n italic_e italic_a italic_r + italic_D italic_e italic_l italic_t italic_a</annotation></semantics></math>) leaves the associative matrix unmodified if the KV binding already exists in the memory while still tracking the same normalization term as the former one (<math alttext="Linear" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p7.2.m2.1"><semantics id="S2.SS1.SSS2.p7.2.m2.1a"><mrow id="S2.SS1.SSS2.p7.2.m2.1.1" xref="S2.SS1.SSS2.p7.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p7.2.m2.1.1.2" xref="S2.SS1.SSS2.p7.2.m2.1.1.2.cmml">L</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.3" xref="S2.SS1.SSS2.p7.2.m2.1.1.3.cmml">i</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1a" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.4" xref="S2.SS1.SSS2.p7.2.m2.1.1.4.cmml">n</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1b" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.5" xref="S2.SS1.SSS2.p7.2.m2.1.1.5.cmml">e</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1c" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.6" xref="S2.SS1.SSS2.p7.2.m2.1.1.6.cmml">a</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1d" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.7" xref="S2.SS1.SSS2.p7.2.m2.1.1.7.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p7.2.m2.1b"><apply id="S2.SS1.SSS2.p7.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1"><times id="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.1"></times><ci id="S2.SS1.SSS2.p7.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.2">𝐿</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.3">𝑖</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.4.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.4">𝑛</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.5.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.5">𝑒</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.6.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.6">𝑎</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.7.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.7">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p7.2.m2.1c">Linear</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p7.2.m2.1d">italic_L italic_i italic_n italic_e italic_a italic_r</annotation></semantics></math>) for numerical stability.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p8">
<p class="ltx_p" id="S2.SS1.SSS2.p8.3"><span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p8.3.1">Long-term context injection.</span> We aggregate the local attention state <math alttext="A_{dot}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p8.1.m1.1"><semantics id="S2.SS1.SSS2.p8.1.m1.1a"><msub id="S2.SS1.SSS2.p8.1.m1.1.1" xref="S2.SS1.SSS2.p8.1.m1.1.1.cmml"><mi id="S2.SS1.SSS2.p8.1.m1.1.1.2" xref="S2.SS1.SSS2.p8.1.m1.1.1.2.cmml">A</mi><mrow id="S2.SS1.SSS2.p8.1.m1.1.1.3" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p8.1.m1.1.1.3.2" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.2.cmml">d</mi><mo id="S2.SS1.SSS2.p8.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p8.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.3.cmml">o</mi><mo id="S2.SS1.SSS2.p8.1.m1.1.1.3.1a" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p8.1.m1.1.1.3.4" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p8.1.m1.1b"><apply id="S2.SS1.SSS2.p8.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p8.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p8.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.2">𝐴</ci><apply id="S2.SS1.SSS2.p8.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3"><times id="S2.SS1.SSS2.p8.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p8.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.2">𝑑</ci><ci id="S2.SS1.SSS2.p8.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.3">𝑜</ci><ci id="S2.SS1.SSS2.p8.1.m1.1.1.3.4.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p8.1.m1.1c">A_{dot}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p8.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_d italic_o italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and memory retrieved content <math alttext="A_{mem}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p8.2.m2.1"><semantics id="S2.SS1.SSS2.p8.2.m2.1a"><msub id="S2.SS1.SSS2.p8.2.m2.1.1" xref="S2.SS1.SSS2.p8.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p8.2.m2.1.1.2" xref="S2.SS1.SSS2.p8.2.m2.1.1.2.cmml">A</mi><mrow id="S2.SS1.SSS2.p8.2.m2.1.1.3" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.cmml"><mi id="S2.SS1.SSS2.p8.2.m2.1.1.3.2" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.2.cmml">m</mi><mo id="S2.SS1.SSS2.p8.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p8.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p8.2.m2.1.1.3.1a" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p8.2.m2.1.1.3.4" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p8.2.m2.1b"><apply id="S2.SS1.SSS2.p8.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p8.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p8.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.2">𝐴</ci><apply id="S2.SS1.SSS2.p8.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3"><times id="S2.SS1.SSS2.p8.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p8.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p8.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p8.2.m2.1.1.3.4.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p8.2.m2.1c">A_{mem}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p8.2.m2.1d">italic_A start_POSTSUBSCRIPT italic_m italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math> via a learned gating scalar <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p8.3.m3.1"><semantics id="S2.SS1.SSS2.p8.3.m3.1a"><mi id="S2.SS1.SSS2.p8.3.m3.1.1" xref="S2.SS1.SSS2.p8.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p8.3.m3.1b"><ci id="S2.SS1.SSS2.p8.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p8.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p8.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p8.3.m3.1d">italic_β</annotation></semantics></math>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A=\textit{sigmoid}(\beta)\odot A_{mem}+(1-\textit{sigmoid}(\beta))\odot A_{dot}." class="ltx_Math" display="block" id="S2.E6.m1.3"><semantics id="S2.E6.m1.3a"><mrow id="S2.E6.m1.3.3.1" xref="S2.E6.m1.3.3.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1" xref="S2.E6.m1.3.3.1.1.cmml"><mi id="S2.E6.m1.3.3.1.1.3" xref="S2.E6.m1.3.3.1.1.3.cmml">A</mi><mo id="S2.E6.m1.3.3.1.1.2" xref="S2.E6.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E6.m1.3.3.1.1.1" xref="S2.E6.m1.3.3.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.3.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml"><mtext id="S2.E6.m1.3.3.1.1.1.3.2.2" xref="S2.E6.m1.3.3.1.1.1.3.2.2a.cmml">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext><mo id="S2.E6.m1.3.3.1.1.1.3.2.1" xref="S2.E6.m1.3.3.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S2.E6.m1.3.3.1.1.1.3.2.3.2" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml"><mo id="S2.E6.m1.3.3.1.1.1.3.2.3.2.1" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml">(</mo><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">β</mi><mo id="S2.E6.m1.3.3.1.1.1.3.2.3.2.2" rspace="0.055em" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.3.3.1.1.1.3.1" rspace="0.222em" xref="S2.E6.m1.3.3.1.1.1.3.1.cmml">⊙</mo><msub id="S2.E6.m1.3.3.1.1.1.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.3.3.2" xref="S2.E6.m1.3.3.1.1.1.3.3.2.cmml">A</mi><mrow id="S2.E6.m1.3.3.1.1.1.3.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.3.3.3.2" xref="S2.E6.m1.3.3.1.1.1.3.3.3.2.cmml">m</mi><mo id="S2.E6.m1.3.3.1.1.1.3.3.3.1" xref="S2.E6.m1.3.3.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E6.m1.3.3.1.1.1.3.3.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.3.3.cmml">e</mi><mo id="S2.E6.m1.3.3.1.1.1.3.3.3.1a" xref="S2.E6.m1.3.3.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E6.m1.3.3.1.1.1.3.3.3.4" xref="S2.E6.m1.3.3.1.1.1.3.3.3.4.cmml">m</mi></mrow></msub></mrow><mo id="S2.E6.m1.3.3.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.2.cmml">+</mo><mrow id="S2.E6.m1.3.3.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mn id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mtext id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E6.m1.2.2" xref="S2.E6.m1.2.2.cmml">β</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E6.m1.3.3.1.1.1.1.2" rspace="0.222em" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml">⊙</mo><msub id="S2.E6.m1.3.3.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.1.3.2.cmml">A</mi><mrow id="S2.E6.m1.3.3.1.1.1.1.3.3" xref="S2.E6.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.3.3.2" xref="S2.E6.m1.3.3.1.1.1.1.3.3.2.cmml">d</mi><mo id="S2.E6.m1.3.3.1.1.1.1.3.3.1" xref="S2.E6.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E6.m1.3.3.1.1.1.1.3.3.3" xref="S2.E6.m1.3.3.1.1.1.1.3.3.3.cmml">o</mi><mo id="S2.E6.m1.3.3.1.1.1.1.3.3.1a" xref="S2.E6.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E6.m1.3.3.1.1.1.1.3.3.4" xref="S2.E6.m1.3.3.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow></mrow></mrow><mo id="S2.E6.m1.3.3.1.2" lspace="0em" xref="S2.E6.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.3b"><apply id="S2.E6.m1.3.3.1.1.cmml" xref="S2.E6.m1.3.3.1"><eq id="S2.E6.m1.3.3.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2"></eq><ci id="S2.E6.m1.3.3.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.3">𝐴</ci><apply id="S2.E6.m1.3.3.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1"><plus id="S2.E6.m1.3.3.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.2"></plus><apply id="S2.E6.m1.3.3.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.1">direct-product</csymbol><apply id="S2.E6.m1.3.3.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2"><times id="S2.E6.m1.3.3.1.1.1.3.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.1"></times><ci id="S2.E6.m1.3.3.1.1.1.3.2.2a.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.2"><mtext id="S2.E6.m1.3.3.1.1.1.3.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.2">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext></ci><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝛽</ci></apply><apply id="S2.E6.m1.3.3.1.1.1.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.3.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.3.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.2">𝐴</ci><apply id="S2.E6.m1.3.3.1.1.1.3.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3"><times id="S2.E6.m1.3.3.1.1.1.3.3.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.1"></times><ci id="S2.E6.m1.3.3.1.1.1.3.3.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.2">𝑚</ci><ci id="S2.E6.m1.3.3.1.1.1.3.3.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.3">𝑒</ci><ci id="S2.E6.m1.3.3.1.1.1.3.3.3.4.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.4">𝑚</ci></apply></apply></apply><apply id="S2.E6.m1.3.3.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.2">direct-product</csymbol><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1"><minus id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1"></minus><cn id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2">1</cn><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3"><times id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1"></times><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2"><mtext id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext></ci><ci id="S2.E6.m1.2.2.cmml" xref="S2.E6.m1.2.2">𝛽</ci></apply></apply><apply id="S2.E6.m1.3.3.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.2">𝐴</ci><apply id="S2.E6.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3"><times id="S2.E6.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.1"></times><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.2">𝑑</ci><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.3">𝑜</ci><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.4.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.3c">A=\textit{sigmoid}(\beta)\odot A_{mem}+(1-\textit{sigmoid}(\beta))\odot A_{dot}.</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.3d">italic_A = sigmoid ( italic_β ) ⊙ italic_A start_POSTSUBSCRIPT italic_m italic_e italic_m end_POSTSUBSCRIPT + ( 1 - sigmoid ( italic_β ) ) ⊙ italic_A start_POSTSUBSCRIPT italic_d italic_o italic_t end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS2.p8.4">This adds only a single scalar value as training parameter per head while allowing a learnable trade-off between the long-term and local information flows in the model&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p9">
<p class="ltx_p" id="S2.SS1.SSS2.p9.2">Similar to the standard MHA, for the multi-head Infini-attention we compute <math alttext="H" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p9.1.m1.1"><semantics id="S2.SS1.SSS2.p9.1.m1.1a"><mi id="S2.SS1.SSS2.p9.1.m1.1.1" xref="S2.SS1.SSS2.p9.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p9.1.m1.1b"><ci id="S2.SS1.SSS2.p9.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p9.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p9.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p9.1.m1.1d">italic_H</annotation></semantics></math> number of context states in parallel, and concatenate and project them for the final attention output <math alttext="O\in{\rm I\!R}^{N\times d_{model}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p9.2.m2.1"><semantics id="S2.SS1.SSS2.p9.2.m2.1a"><mrow id="S2.SS1.SSS2.p9.2.m2.1.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.2.cmml">O</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p9.2.m2.1.1.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p9.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2.cmml">m</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3.cmml">o</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4.cmml">d</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5.cmml">e</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p9.2.m2.1b"><apply id="S2.SS1.SSS2.p9.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1"><in id="S2.SS1.SSS2.p9.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.1"></in><ci id="S2.SS1.SSS2.p9.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.2">𝑂</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3"><times id="S2.SS1.SSS2.p9.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3"><times id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3">𝑜</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4">𝑑</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5">𝑒</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p9.2.m2.1c">O\in{\rm I\!R}^{N\times d_{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p9.2.m2.1d">italic_O ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="O=[A^{1};\dotso A^{H}]W_{O}" class="ltx_Math" display="block" id="S2.E7.m1.2"><semantics id="S2.E7.m1.2a"><mrow id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml"><mi id="S2.E7.m1.2.2.4" xref="S2.E7.m1.2.2.4.cmml">O</mi><mo id="S2.E7.m1.2.2.3" xref="S2.E7.m1.2.2.3.cmml">=</mo><mrow id="S2.E7.m1.2.2.2" xref="S2.E7.m1.2.2.2.cmml"><mrow id="S2.E7.m1.2.2.2.2.2" xref="S2.E7.m1.2.2.2.2.3.cmml"><mo id="S2.E7.m1.2.2.2.2.2.3" stretchy="false" xref="S2.E7.m1.2.2.2.2.3.cmml">[</mo><msup id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">A</mi><mn id="S2.E7.m1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.E7.m1.2.2.2.2.2.4" xref="S2.E7.m1.2.2.2.2.3.cmml">;</mo><mrow id="S2.E7.m1.2.2.2.2.2.2" xref="S2.E7.m1.2.2.2.2.2.2.cmml"><mi id="S2.E7.m1.2.2.2.2.2.2.2" mathvariant="normal" xref="S2.E7.m1.2.2.2.2.2.2.2.cmml">…</mi><mo id="S2.E7.m1.2.2.2.2.2.2.1" xref="S2.E7.m1.2.2.2.2.2.2.1.cmml">⁢</mo><msup id="S2.E7.m1.2.2.2.2.2.2.3" xref="S2.E7.m1.2.2.2.2.2.2.3.cmml"><mi id="S2.E7.m1.2.2.2.2.2.2.3.2" xref="S2.E7.m1.2.2.2.2.2.2.3.2.cmml">A</mi><mi id="S2.E7.m1.2.2.2.2.2.2.3.3" xref="S2.E7.m1.2.2.2.2.2.2.3.3.cmml">H</mi></msup></mrow><mo id="S2.E7.m1.2.2.2.2.2.5" stretchy="false" xref="S2.E7.m1.2.2.2.2.3.cmml">]</mo></mrow><mo id="S2.E7.m1.2.2.2.3" xref="S2.E7.m1.2.2.2.3.cmml">⁢</mo><msub id="S2.E7.m1.2.2.2.4" xref="S2.E7.m1.2.2.2.4.cmml"><mi id="S2.E7.m1.2.2.2.4.2" xref="S2.E7.m1.2.2.2.4.2.cmml">W</mi><mi id="S2.E7.m1.2.2.2.4.3" xref="S2.E7.m1.2.2.2.4.3.cmml">O</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.2b"><apply id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2"><eq id="S2.E7.m1.2.2.3.cmml" xref="S2.E7.m1.2.2.3"></eq><ci id="S2.E7.m1.2.2.4.cmml" xref="S2.E7.m1.2.2.4">𝑂</ci><apply id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2.2"><times id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.3"></times><list id="S2.E7.m1.2.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.2.2"><apply id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2">𝐴</ci><cn id="S2.E7.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E7.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E7.m1.2.2.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2.2.2"><times id="S2.E7.m1.2.2.2.2.2.2.1.cmml" xref="S2.E7.m1.2.2.2.2.2.2.1"></times><ci id="S2.E7.m1.2.2.2.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2.2.2.2">…</ci><apply id="S2.E7.m1.2.2.2.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3">superscript</csymbol><ci id="S2.E7.m1.2.2.2.2.2.2.3.2.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3.2">𝐴</ci><ci id="S2.E7.m1.2.2.2.2.2.2.3.3.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3.3">𝐻</ci></apply></apply></list><apply id="S2.E7.m1.2.2.2.4.cmml" xref="S2.E7.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.4.1.cmml" xref="S2.E7.m1.2.2.2.4">subscript</csymbol><ci id="S2.E7.m1.2.2.2.4.2.cmml" xref="S2.E7.m1.2.2.2.4.2">𝑊</ci><ci id="S2.E7.m1.2.2.2.4.3.cmml" xref="S2.E7.m1.2.2.2.4.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.2c">O=[A^{1};\dotso A^{H}]W_{O}</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.2d">italic_O = [ italic_A start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ; … italic_A start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ] italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS2.p9.3">where <math alttext="W_{O}\in{\rm I\!R}^{H\times d_{value}\times d_{model}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p9.3.m1.1"><semantics id="S2.SS1.SSS2.p9.3.m1.1a"><mrow id="S2.SS1.SSS2.p9.3.m1.1.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.cmml"><msub id="S2.SS1.SSS2.p9.3.m1.1.1.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.2.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.2.cmml">W</mi><mi id="S2.SS1.SSS2.p9.3.m1.1.1.2.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.3.cmml">O</mi></msub><mo id="S2.SS1.SSS2.p9.3.m1.1.1.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p9.3.m1.1.1.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2.cmml">H</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2.cmml">m</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3.cmml">o</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1a" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4.cmml">d</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1b" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5.cmml">e</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1c" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p9.3.m1.1b"><apply id="S2.SS1.SSS2.p9.3.m1.1.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1"><in id="S2.SS1.SSS2.p9.3.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.1"></in><apply id="S2.SS1.SSS2.p9.3.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.2">𝑊</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.3">𝑂</ci></apply><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2">𝐻</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4">subscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2">𝑑</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3">𝑜</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4">𝑑</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5">𝑒</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p9.3.m1.1c">W_{O}\in{\rm I\!R}^{H\times d_{value}\times d_{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p9.3.m1.1d">italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_H × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is trainable weights.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Memory and Effective Context Window</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S2.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S2.T1.12">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S2.T1.12.13.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.1">Model</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.2">Memory (cache) footprint</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.3">Context length</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.4">Memory update</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.5">Memory retrieval</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.2.2.3">Transformer-XL</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.1.1.1"><math alttext="(d_{key}+d_{value})\times H\times N\times l" class="ltx_Math" display="inline" id="S2.T1.1.1.1.m1.1"><semantics id="S2.T1.1.1.1.m1.1a"><mrow id="S2.T1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.m1.1.1.cmml"><mrow id="S2.T1.1.1.1.m1.1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.1.1.1.m1.1.1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml"><msub id="S2.T1.1.1.1.m1.1.1.1.1.1.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3.cmml">e</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1a" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.T1.1.1.1.m1.1.1.1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2.cmml">v</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3.cmml">a</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1a" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4.cmml">l</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1b" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5.cmml">u</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1c" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S2.T1.1.1.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.1.1.1.m1.1.1.2" rspace="0.222em" xref="S2.T1.1.1.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.1.1.1.m1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.3.cmml">H</mi><mo id="S2.T1.1.1.1.m1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.T1.1.1.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.1.1.1.m1.1.1.4" xref="S2.T1.1.1.1.m1.1.1.4.cmml">N</mi><mo id="S2.T1.1.1.1.m1.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S2.T1.1.1.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.1.1.1.m1.1.1.5" xref="S2.T1.1.1.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.m1.1b"><apply id="S2.T1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1"><times id="S2.T1.1.1.1.m1.1.1.2.cmml" xref="S2.T1.1.1.1.m1.1.1.2"></times><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1"><plus id="S2.T1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.1.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3"><times id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2">𝑘</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4">𝑦</ci></apply></apply><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.1.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3"><times id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1"></times><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5">𝑢</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6">𝑒</ci></apply></apply></apply><ci id="S2.T1.1.1.1.m1.1.1.3.cmml" xref="S2.T1.1.1.1.m1.1.1.3">𝐻</ci><ci id="S2.T1.1.1.1.m1.1.1.4.cmml" xref="S2.T1.1.1.1.m1.1.1.4">𝑁</ci><ci id="S2.T1.1.1.1.m1.1.1.5.cmml" xref="S2.T1.1.1.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.m1.1c">(d_{key}+d_{value})\times H\times N\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.1.1.1.m1.1d">( italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT ) × italic_H × italic_N × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.2.2.2"><math alttext="N\times l" class="ltx_Math" display="inline" id="S2.T1.2.2.2.m1.1"><semantics id="S2.T1.2.2.2.m1.1a"><mrow id="S2.T1.2.2.2.m1.1.1" xref="S2.T1.2.2.2.m1.1.1.cmml"><mi id="S2.T1.2.2.2.m1.1.1.2" xref="S2.T1.2.2.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.2.2.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.2.2.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.2.2.2.m1.1.1.3" xref="S2.T1.2.2.2.m1.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.2.2.2.m1.1b"><apply id="S2.T1.2.2.2.m1.1.1.cmml" xref="S2.T1.2.2.2.m1.1.1"><times id="S2.T1.2.2.2.m1.1.1.1.cmml" xref="S2.T1.2.2.2.m1.1.1.1"></times><ci id="S2.T1.2.2.2.m1.1.1.2.cmml" xref="S2.T1.2.2.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.2.2.2.m1.1.1.3.cmml" xref="S2.T1.2.2.2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.2.2.m1.1c">N\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.2.2.2.m1.1d">italic_N × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.2.2.4">Discarded</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.2.2.5">Dot-product attention</td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.4">
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.3">Compressive Transformer</td>
<td class="ltx_td ltx_align_left" id="S2.T1.3.3.1"><math alttext="d_{model}\times(c+N)\times l" class="ltx_Math" display="inline" id="S2.T1.3.3.1.m1.1"><semantics id="S2.T1.3.3.1.m1.1a"><mrow id="S2.T1.3.3.1.m1.1.1" xref="S2.T1.3.3.1.m1.1.1.cmml"><msub id="S2.T1.3.3.1.m1.1.1.3" xref="S2.T1.3.3.1.m1.1.1.3.cmml"><mi id="S2.T1.3.3.1.m1.1.1.3.2" xref="S2.T1.3.3.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.3.3.1.m1.1.1.3.3" xref="S2.T1.3.3.1.m1.1.1.3.3.cmml"><mi id="S2.T1.3.3.1.m1.1.1.3.3.2" xref="S2.T1.3.3.1.m1.1.1.3.3.2.cmml">m</mi><mo id="S2.T1.3.3.1.m1.1.1.3.3.1" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.3" xref="S2.T1.3.3.1.m1.1.1.3.3.3.cmml">o</mi><mo id="S2.T1.3.3.1.m1.1.1.3.3.1a" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.4" xref="S2.T1.3.3.1.m1.1.1.3.3.4.cmml">d</mi><mo id="S2.T1.3.3.1.m1.1.1.3.3.1b" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.5" xref="S2.T1.3.3.1.m1.1.1.3.3.5.cmml">e</mi><mo id="S2.T1.3.3.1.m1.1.1.3.3.1c" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.6" xref="S2.T1.3.3.1.m1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo id="S2.T1.3.3.1.m1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.T1.3.3.1.m1.1.1.2.cmml">×</mo><mrow id="S2.T1.3.3.1.m1.1.1.1.1" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.3.3.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.3.3.1.m1.1.1.1.1.1" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml"><mi id="S2.T1.3.3.1.m1.1.1.1.1.1.2" xref="S2.T1.3.3.1.m1.1.1.1.1.1.2.cmml">c</mi><mo id="S2.T1.3.3.1.m1.1.1.1.1.1.1" xref="S2.T1.3.3.1.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.T1.3.3.1.m1.1.1.1.1.1.3" xref="S2.T1.3.3.1.m1.1.1.1.1.1.3.cmml">N</mi></mrow><mo id="S2.T1.3.3.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.3.3.1.m1.1.1.2a" rspace="0.222em" xref="S2.T1.3.3.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.3.3.1.m1.1.1.4" xref="S2.T1.3.3.1.m1.1.1.4.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.3.3.1.m1.1b"><apply id="S2.T1.3.3.1.m1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1"><times id="S2.T1.3.3.1.m1.1.1.2.cmml" xref="S2.T1.3.3.1.m1.1.1.2"></times><apply id="S2.T1.3.3.1.m1.1.1.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.3.3.1.m1.1.1.3.1.cmml" xref="S2.T1.3.3.1.m1.1.1.3">subscript</csymbol><ci id="S2.T1.3.3.1.m1.1.1.3.2.cmml" xref="S2.T1.3.3.1.m1.1.1.3.2">𝑑</ci><apply id="S2.T1.3.3.1.m1.1.1.3.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3"><times id="S2.T1.3.3.1.m1.1.1.3.3.1.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.1"></times><ci id="S2.T1.3.3.1.m1.1.1.3.3.2.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.2">𝑚</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.3">𝑜</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.4.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.4">𝑑</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.5.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.5">𝑒</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.6.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.6">𝑙</ci></apply></apply><apply id="S2.T1.3.3.1.m1.1.1.1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1"><plus id="S2.T1.3.3.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1.1.1"></plus><ci id="S2.T1.3.3.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1.1.2">𝑐</ci><ci id="S2.T1.3.3.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1.1.3">𝑁</ci></apply><ci id="S2.T1.3.3.1.m1.1.1.4.cmml" xref="S2.T1.3.3.1.m1.1.1.4">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.3.1.m1.1c">d_{model}\times(c+N)\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.3.3.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × ( italic_c + italic_N ) × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.2"><math alttext="(c\times r+N)\times l" class="ltx_Math" display="inline" id="S2.T1.4.4.2.m1.1"><semantics id="S2.T1.4.4.2.m1.1a"><mrow id="S2.T1.4.4.2.m1.1.1" xref="S2.T1.4.4.2.m1.1.1.cmml"><mrow id="S2.T1.4.4.2.m1.1.1.1.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml"><mo id="S2.T1.4.4.2.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.4.4.2.m1.1.1.1.1.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml"><mrow id="S2.T1.4.4.2.m1.1.1.1.1.1.2" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.4.4.2.m1.1.1.1.1.1.2.2" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.2.cmml">c</mi><mo id="S2.T1.4.4.2.m1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.1.cmml">×</mo><mi id="S2.T1.4.4.2.m1.1.1.1.1.1.2.3" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.3.cmml">r</mi></mrow><mo id="S2.T1.4.4.2.m1.1.1.1.1.1.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.T1.4.4.2.m1.1.1.1.1.1.3" xref="S2.T1.4.4.2.m1.1.1.1.1.1.3.cmml">N</mi></mrow><mo id="S2.T1.4.4.2.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.4.4.2.m1.1.1.2" rspace="0.222em" xref="S2.T1.4.4.2.m1.1.1.2.cmml">×</mo><mi id="S2.T1.4.4.2.m1.1.1.3" xref="S2.T1.4.4.2.m1.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.4.4.2.m1.1b"><apply id="S2.T1.4.4.2.m1.1.1.cmml" xref="S2.T1.4.4.2.m1.1.1"><times id="S2.T1.4.4.2.m1.1.1.2.cmml" xref="S2.T1.4.4.2.m1.1.1.2"></times><apply id="S2.T1.4.4.2.m1.1.1.1.1.1.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1"><plus id="S2.T1.4.4.2.m1.1.1.1.1.1.1.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.4.4.2.m1.1.1.1.1.1.2.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2"><times id="S2.T1.4.4.2.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.1"></times><ci id="S2.T1.4.4.2.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.2">𝑐</ci><ci id="S2.T1.4.4.2.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.3">𝑟</ci></apply><ci id="S2.T1.4.4.2.m1.1.1.1.1.1.3.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.3">𝑁</ci></apply><ci id="S2.T1.4.4.2.m1.1.1.3.cmml" xref="S2.T1.4.4.2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.4.2.m1.1c">(c\times r+N)\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.4.4.2.m1.1d">( italic_c × italic_r + italic_N ) × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.4">Discarded</td>
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.5">Dot-product attention</td>
</tr>
<tr class="ltx_tr" id="S2.T1.6.6">
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.3">Memorizing Transformers</td>
<td class="ltx_td ltx_align_left" id="S2.T1.5.5.1"><math alttext="(d_{key}+d_{value})\times H\times N\times S" class="ltx_Math" display="inline" id="S2.T1.5.5.1.m1.1"><semantics id="S2.T1.5.5.1.m1.1a"><mrow id="S2.T1.5.5.1.m1.1.1" xref="S2.T1.5.5.1.m1.1.1.cmml"><mrow id="S2.T1.5.5.1.m1.1.1.1.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.5.5.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.5.5.1.m1.1.1.1.1.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml"><msub id="S2.T1.5.5.1.m1.1.1.1.1.1.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3.cmml">e</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1a" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.T1.5.5.1.m1.1.1.1.1.1.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2.cmml">v</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3.cmml">a</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1a" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4.cmml">l</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1b" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5.cmml">u</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1c" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S2.T1.5.5.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.5.5.1.m1.1.1.2" rspace="0.222em" xref="S2.T1.5.5.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.5.5.1.m1.1.1.3" xref="S2.T1.5.5.1.m1.1.1.3.cmml">H</mi><mo id="S2.T1.5.5.1.m1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.T1.5.5.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.5.5.1.m1.1.1.4" xref="S2.T1.5.5.1.m1.1.1.4.cmml">N</mi><mo id="S2.T1.5.5.1.m1.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S2.T1.5.5.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.5.5.1.m1.1.1.5" xref="S2.T1.5.5.1.m1.1.1.5.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.5.5.1.m1.1b"><apply id="S2.T1.5.5.1.m1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1"><times id="S2.T1.5.5.1.m1.1.1.2.cmml" xref="S2.T1.5.5.1.m1.1.1.2"></times><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1"><plus id="S2.T1.5.5.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.5.5.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3"><times id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2">𝑘</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4">𝑦</ci></apply></apply><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.5.5.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3"><times id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1"></times><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5">𝑢</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6">𝑒</ci></apply></apply></apply><ci id="S2.T1.5.5.1.m1.1.1.3.cmml" xref="S2.T1.5.5.1.m1.1.1.3">𝐻</ci><ci id="S2.T1.5.5.1.m1.1.1.4.cmml" xref="S2.T1.5.5.1.m1.1.1.4">𝑁</ci><ci id="S2.T1.5.5.1.m1.1.1.5.cmml" xref="S2.T1.5.5.1.m1.1.1.5">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.5.1.m1.1c">(d_{key}+d_{value})\times H\times N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.5.5.1.m1.1d">( italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT ) × italic_H × italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.2"><math alttext="N\times S" class="ltx_Math" display="inline" id="S2.T1.6.6.2.m1.1"><semantics id="S2.T1.6.6.2.m1.1a"><mrow id="S2.T1.6.6.2.m1.1.1" xref="S2.T1.6.6.2.m1.1.1.cmml"><mi id="S2.T1.6.6.2.m1.1.1.2" xref="S2.T1.6.6.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.6.6.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.6.6.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.6.6.2.m1.1.1.3" xref="S2.T1.6.6.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.6.6.2.m1.1b"><apply id="S2.T1.6.6.2.m1.1.1.cmml" xref="S2.T1.6.6.2.m1.1.1"><times id="S2.T1.6.6.2.m1.1.1.1.cmml" xref="S2.T1.6.6.2.m1.1.1.1"></times><ci id="S2.T1.6.6.2.m1.1.1.2.cmml" xref="S2.T1.6.6.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.6.6.2.m1.1.1.3.cmml" xref="S2.T1.6.6.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.6.2.m1.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.6.6.2.m1.1d">italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.4">None</td>
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.5">kNN + dot-product attention</td>
</tr>
<tr class="ltx_tr" id="S2.T1.8.8">
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.3">RMT</td>
<td class="ltx_td ltx_align_left" id="S2.T1.7.7.1"><math alttext="d_{model}\times p\times l\times 2" class="ltx_Math" display="inline" id="S2.T1.7.7.1.m1.1"><semantics id="S2.T1.7.7.1.m1.1a"><mrow id="S2.T1.7.7.1.m1.1.1" xref="S2.T1.7.7.1.m1.1.1.cmml"><msub id="S2.T1.7.7.1.m1.1.1.2" xref="S2.T1.7.7.1.m1.1.1.2.cmml"><mi id="S2.T1.7.7.1.m1.1.1.2.2" xref="S2.T1.7.7.1.m1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.7.7.1.m1.1.1.2.3" xref="S2.T1.7.7.1.m1.1.1.2.3.cmml"><mi id="S2.T1.7.7.1.m1.1.1.2.3.2" xref="S2.T1.7.7.1.m1.1.1.2.3.2.cmml">m</mi><mo id="S2.T1.7.7.1.m1.1.1.2.3.1" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.3" xref="S2.T1.7.7.1.m1.1.1.2.3.3.cmml">o</mi><mo id="S2.T1.7.7.1.m1.1.1.2.3.1a" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.4" xref="S2.T1.7.7.1.m1.1.1.2.3.4.cmml">d</mi><mo id="S2.T1.7.7.1.m1.1.1.2.3.1b" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.5" xref="S2.T1.7.7.1.m1.1.1.2.3.5.cmml">e</mi><mo id="S2.T1.7.7.1.m1.1.1.2.3.1c" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.6" xref="S2.T1.7.7.1.m1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.T1.7.7.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.7.7.1.m1.1.1.1.cmml">×</mo><mi id="S2.T1.7.7.1.m1.1.1.3" xref="S2.T1.7.7.1.m1.1.1.3.cmml">p</mi><mo id="S2.T1.7.7.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S2.T1.7.7.1.m1.1.1.1.cmml">×</mo><mi id="S2.T1.7.7.1.m1.1.1.4" xref="S2.T1.7.7.1.m1.1.1.4.cmml">l</mi><mo id="S2.T1.7.7.1.m1.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S2.T1.7.7.1.m1.1.1.1.cmml">×</mo><mn id="S2.T1.7.7.1.m1.1.1.5" xref="S2.T1.7.7.1.m1.1.1.5.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.7.7.1.m1.1b"><apply id="S2.T1.7.7.1.m1.1.1.cmml" xref="S2.T1.7.7.1.m1.1.1"><times id="S2.T1.7.7.1.m1.1.1.1.cmml" xref="S2.T1.7.7.1.m1.1.1.1"></times><apply id="S2.T1.7.7.1.m1.1.1.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.7.7.1.m1.1.1.2.1.cmml" xref="S2.T1.7.7.1.m1.1.1.2">subscript</csymbol><ci id="S2.T1.7.7.1.m1.1.1.2.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2.2">𝑑</ci><apply id="S2.T1.7.7.1.m1.1.1.2.3.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3"><times id="S2.T1.7.7.1.m1.1.1.2.3.1.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.1"></times><ci id="S2.T1.7.7.1.m1.1.1.2.3.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.2">𝑚</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.3.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.3">𝑜</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.4.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.4">𝑑</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.5.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.5">𝑒</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.6.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.6">𝑙</ci></apply></apply><ci id="S2.T1.7.7.1.m1.1.1.3.cmml" xref="S2.T1.7.7.1.m1.1.1.3">𝑝</ci><ci id="S2.T1.7.7.1.m1.1.1.4.cmml" xref="S2.T1.7.7.1.m1.1.1.4">𝑙</ci><cn id="S2.T1.7.7.1.m1.1.1.5.cmml" type="integer" xref="S2.T1.7.7.1.m1.1.1.5">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.7.7.1.m1.1c">d_{model}\times p\times l\times 2</annotation><annotation encoding="application/x-llamapun" id="S2.T1.7.7.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_p × italic_l × 2</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.2"><math alttext="N\times S" class="ltx_Math" display="inline" id="S2.T1.8.8.2.m1.1"><semantics id="S2.T1.8.8.2.m1.1a"><mrow id="S2.T1.8.8.2.m1.1.1" xref="S2.T1.8.8.2.m1.1.1.cmml"><mi id="S2.T1.8.8.2.m1.1.1.2" xref="S2.T1.8.8.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.8.8.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.8.8.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.8.8.2.m1.1.1.3" xref="S2.T1.8.8.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.8.8.2.m1.1b"><apply id="S2.T1.8.8.2.m1.1.1.cmml" xref="S2.T1.8.8.2.m1.1.1"><times id="S2.T1.8.8.2.m1.1.1.1.cmml" xref="S2.T1.8.8.2.m1.1.1.1"></times><ci id="S2.T1.8.8.2.m1.1.1.2.cmml" xref="S2.T1.8.8.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.8.8.2.m1.1.1.3.cmml" xref="S2.T1.8.8.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.8.8.2.m1.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.8.8.2.m1.1d">italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.4">Discarded</td>
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.5">Soft-prompt input</td>
</tr>
<tr class="ltx_tr" id="S2.T1.10.10">
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.3">AutoCompressors</td>
<td class="ltx_td ltx_align_left" id="S2.T1.9.9.1"><math alttext="d_{model}\times p\times(m+1)\times l" class="ltx_Math" display="inline" id="S2.T1.9.9.1.m1.1"><semantics id="S2.T1.9.9.1.m1.1a"><mrow id="S2.T1.9.9.1.m1.1.1" xref="S2.T1.9.9.1.m1.1.1.cmml"><msub id="S2.T1.9.9.1.m1.1.1.3" xref="S2.T1.9.9.1.m1.1.1.3.cmml"><mi id="S2.T1.9.9.1.m1.1.1.3.2" xref="S2.T1.9.9.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.9.9.1.m1.1.1.3.3" xref="S2.T1.9.9.1.m1.1.1.3.3.cmml"><mi id="S2.T1.9.9.1.m1.1.1.3.3.2" xref="S2.T1.9.9.1.m1.1.1.3.3.2.cmml">m</mi><mo id="S2.T1.9.9.1.m1.1.1.3.3.1" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.3" xref="S2.T1.9.9.1.m1.1.1.3.3.3.cmml">o</mi><mo id="S2.T1.9.9.1.m1.1.1.3.3.1a" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.4" xref="S2.T1.9.9.1.m1.1.1.3.3.4.cmml">d</mi><mo id="S2.T1.9.9.1.m1.1.1.3.3.1b" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.5" xref="S2.T1.9.9.1.m1.1.1.3.3.5.cmml">e</mi><mo id="S2.T1.9.9.1.m1.1.1.3.3.1c" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.6" xref="S2.T1.9.9.1.m1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo id="S2.T1.9.9.1.m1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.T1.9.9.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.9.9.1.m1.1.1.4" xref="S2.T1.9.9.1.m1.1.1.4.cmml">p</mi><mo id="S2.T1.9.9.1.m1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.T1.9.9.1.m1.1.1.2.cmml">×</mo><mrow id="S2.T1.9.9.1.m1.1.1.1.1" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.9.9.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.9.9.1.m1.1.1.1.1.1" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml"><mi id="S2.T1.9.9.1.m1.1.1.1.1.1.2" xref="S2.T1.9.9.1.m1.1.1.1.1.1.2.cmml">m</mi><mo id="S2.T1.9.9.1.m1.1.1.1.1.1.1" xref="S2.T1.9.9.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.T1.9.9.1.m1.1.1.1.1.1.3" xref="S2.T1.9.9.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.T1.9.9.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.9.9.1.m1.1.1.2b" rspace="0.222em" xref="S2.T1.9.9.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.9.9.1.m1.1.1.5" xref="S2.T1.9.9.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.9.9.1.m1.1b"><apply id="S2.T1.9.9.1.m1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1"><times id="S2.T1.9.9.1.m1.1.1.2.cmml" xref="S2.T1.9.9.1.m1.1.1.2"></times><apply id="S2.T1.9.9.1.m1.1.1.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.9.9.1.m1.1.1.3.1.cmml" xref="S2.T1.9.9.1.m1.1.1.3">subscript</csymbol><ci id="S2.T1.9.9.1.m1.1.1.3.2.cmml" xref="S2.T1.9.9.1.m1.1.1.3.2">𝑑</ci><apply id="S2.T1.9.9.1.m1.1.1.3.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3"><times id="S2.T1.9.9.1.m1.1.1.3.3.1.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.1"></times><ci id="S2.T1.9.9.1.m1.1.1.3.3.2.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.2">𝑚</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.3">𝑜</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.4.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.4">𝑑</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.5.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.5">𝑒</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.6.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.6">𝑙</ci></apply></apply><ci id="S2.T1.9.9.1.m1.1.1.4.cmml" xref="S2.T1.9.9.1.m1.1.1.4">𝑝</ci><apply id="S2.T1.9.9.1.m1.1.1.1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1"><plus id="S2.T1.9.9.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1.1.1"></plus><ci id="S2.T1.9.9.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1.1.2">𝑚</ci><cn id="S2.T1.9.9.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.T1.9.9.1.m1.1.1.1.1.1.3">1</cn></apply><ci id="S2.T1.9.9.1.m1.1.1.5.cmml" xref="S2.T1.9.9.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.9.9.1.m1.1c">d_{model}\times p\times(m+1)\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.9.9.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_p × ( italic_m + 1 ) × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.2"><math alttext="N\times S" class="ltx_Math" display="inline" id="S2.T1.10.10.2.m1.1"><semantics id="S2.T1.10.10.2.m1.1a"><mrow id="S2.T1.10.10.2.m1.1.1" xref="S2.T1.10.10.2.m1.1.1.cmml"><mi id="S2.T1.10.10.2.m1.1.1.2" xref="S2.T1.10.10.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.10.10.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.10.10.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.10.10.2.m1.1.1.3" xref="S2.T1.10.10.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.10.10.2.m1.1b"><apply id="S2.T1.10.10.2.m1.1.1.cmml" xref="S2.T1.10.10.2.m1.1.1"><times id="S2.T1.10.10.2.m1.1.1.1.cmml" xref="S2.T1.10.10.2.m1.1.1.1"></times><ci id="S2.T1.10.10.2.m1.1.1.2.cmml" xref="S2.T1.10.10.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.10.10.2.m1.1.1.3.cmml" xref="S2.T1.10.10.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.10.10.2.m1.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.10.10.2.m1.1d">italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.4">Discarded</td>
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.5">Soft-prompt input</td>
</tr>
<tr class="ltx_tr" id="S2.T1.12.12">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.12.12.3">Infini-Transformers</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.11.11.1"><math alttext="d_{key}\times(d_{value}+1)\times H\times l" class="ltx_Math" display="inline" id="S2.T1.11.11.1.m1.1"><semantics id="S2.T1.11.11.1.m1.1a"><mrow id="S2.T1.11.11.1.m1.1.1" xref="S2.T1.11.11.1.m1.1.1.cmml"><msub id="S2.T1.11.11.1.m1.1.1.3" xref="S2.T1.11.11.1.m1.1.1.3.cmml"><mi id="S2.T1.11.11.1.m1.1.1.3.2" xref="S2.T1.11.11.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.11.11.1.m1.1.1.3.3" xref="S2.T1.11.11.1.m1.1.1.3.3.cmml"><mi id="S2.T1.11.11.1.m1.1.1.3.3.2" xref="S2.T1.11.11.1.m1.1.1.3.3.2.cmml">k</mi><mo id="S2.T1.11.11.1.m1.1.1.3.3.1" xref="S2.T1.11.11.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.3.3.3" xref="S2.T1.11.11.1.m1.1.1.3.3.3.cmml">e</mi><mo id="S2.T1.11.11.1.m1.1.1.3.3.1a" xref="S2.T1.11.11.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.3.3.4" xref="S2.T1.11.11.1.m1.1.1.3.3.4.cmml">y</mi></mrow></msub><mo id="S2.T1.11.11.1.m1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.T1.11.11.1.m1.1.1.2.cmml">×</mo><mrow id="S2.T1.11.11.1.m1.1.1.1.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.11.11.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.11.11.1.m1.1.1.1.1.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml"><msub id="S2.T1.11.11.1.m1.1.1.1.1.1.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2.cmml">v</mi><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3.cmml">a</mi><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1a" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4.cmml">l</mi><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1b" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5.cmml">u</mi><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1c" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6.cmml">e</mi></mrow></msub><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.T1.11.11.1.m1.1.1.1.1.1.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.T1.11.11.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.11.11.1.m1.1.1.2a" rspace="0.222em" xref="S2.T1.11.11.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.11.11.1.m1.1.1.4" xref="S2.T1.11.11.1.m1.1.1.4.cmml">H</mi><mo id="S2.T1.11.11.1.m1.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S2.T1.11.11.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.11.11.1.m1.1.1.5" xref="S2.T1.11.11.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.11.11.1.m1.1b"><apply id="S2.T1.11.11.1.m1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1"><times id="S2.T1.11.11.1.m1.1.1.2.cmml" xref="S2.T1.11.11.1.m1.1.1.2"></times><apply id="S2.T1.11.11.1.m1.1.1.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.11.11.1.m1.1.1.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.3">subscript</csymbol><ci id="S2.T1.11.11.1.m1.1.1.3.2.cmml" xref="S2.T1.11.11.1.m1.1.1.3.2">𝑑</ci><apply id="S2.T1.11.11.1.m1.1.1.3.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3"><times id="S2.T1.11.11.1.m1.1.1.3.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.1"></times><ci id="S2.T1.11.11.1.m1.1.1.3.3.2.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.2">𝑘</ci><ci id="S2.T1.11.11.1.m1.1.1.3.3.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.3">𝑒</ci><ci id="S2.T1.11.11.1.m1.1.1.3.3.4.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.4">𝑦</ci></apply></apply><apply id="S2.T1.11.11.1.m1.1.1.1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1"><plus id="S2.T1.11.11.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.11.11.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.11.11.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3"><times id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2">𝑣</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3">𝑎</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4">𝑙</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5">𝑢</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6">𝑒</ci></apply></apply><cn id="S2.T1.11.11.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.T1.11.11.1.m1.1.1.1.1.1.3">1</cn></apply><ci id="S2.T1.11.11.1.m1.1.1.4.cmml" xref="S2.T1.11.11.1.m1.1.1.4">𝐻</ci><ci id="S2.T1.11.11.1.m1.1.1.5.cmml" xref="S2.T1.11.11.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.11.11.1.m1.1c">d_{key}\times(d_{value}+1)\times H\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.11.11.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT × ( italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT + 1 ) × italic_H × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.12.12.2"><math alttext="N\times S" class="ltx_Math" display="inline" id="S2.T1.12.12.2.m1.1"><semantics id="S2.T1.12.12.2.m1.1a"><mrow id="S2.T1.12.12.2.m1.1.1" xref="S2.T1.12.12.2.m1.1.1.cmml"><mi id="S2.T1.12.12.2.m1.1.1.2" xref="S2.T1.12.12.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.12.12.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.12.12.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.12.12.2.m1.1.1.3" xref="S2.T1.12.12.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.12.12.2.m1.1b"><apply id="S2.T1.12.12.2.m1.1.1.cmml" xref="S2.T1.12.12.2.m1.1.1"><times id="S2.T1.12.12.2.m1.1.1.1.cmml" xref="S2.T1.12.12.2.m1.1.1.1"></times><ci id="S2.T1.12.12.2.m1.1.1.2.cmml" xref="S2.T1.12.12.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.12.12.2.m1.1.1.3.cmml" xref="S2.T1.12.12.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.12.12.2.m1.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.12.12.2.m1.1d">italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.12.12.4">Incremental</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.12.12.5">Linear attention</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Transformer models with segment-level memory are compared. For each model, the memory size and effective context length are defined in terms of their model parameters (<math alttext="N" class="ltx_Math" display="inline" id="S2.T1.21.m1.1"><semantics id="S2.T1.21.m1.1b"><mi id="S2.T1.21.m1.1.1" xref="S2.T1.21.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.T1.21.m1.1c"><ci id="S2.T1.21.m1.1.1.cmml" xref="S2.T1.21.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.21.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="S2.T1.21.m1.1e">italic_N</annotation></semantics></math>: input segment length, <math alttext="S" class="ltx_Math" display="inline" id="S2.T1.22.m2.1"><semantics id="S2.T1.22.m2.1b"><mi id="S2.T1.22.m2.1.1" xref="S2.T1.22.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.T1.22.m2.1c"><ci id="S2.T1.22.m2.1.1.cmml" xref="S2.T1.22.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.22.m2.1d">S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.22.m2.1e">italic_S</annotation></semantics></math>: the number of segments, <math alttext="l" class="ltx_Math" display="inline" id="S2.T1.23.m3.1"><semantics id="S2.T1.23.m3.1b"><mi id="S2.T1.23.m3.1.1" xref="S2.T1.23.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.T1.23.m3.1c"><ci id="S2.T1.23.m3.1.1.cmml" xref="S2.T1.23.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.23.m3.1d">l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.23.m3.1e">italic_l</annotation></semantics></math>: the number of layers, <math alttext="H" class="ltx_Math" display="inline" id="S2.T1.24.m4.1"><semantics id="S2.T1.24.m4.1b"><mi id="S2.T1.24.m4.1.1" xref="S2.T1.24.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.T1.24.m4.1c"><ci id="S2.T1.24.m4.1.1.cmml" xref="S2.T1.24.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.24.m4.1d">H</annotation><annotation encoding="application/x-llamapun" id="S2.T1.24.m4.1e">italic_H</annotation></semantics></math>: the number of attention heads, <math alttext="c" class="ltx_Math" display="inline" id="S2.T1.25.m5.1"><semantics id="S2.T1.25.m5.1b"><mi id="S2.T1.25.m5.1.1" xref="S2.T1.25.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.T1.25.m5.1c"><ci id="S2.T1.25.m5.1.1.cmml" xref="S2.T1.25.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.25.m5.1d">c</annotation><annotation encoding="application/x-llamapun" id="S2.T1.25.m5.1e">italic_c</annotation></semantics></math>: Compressive Transformer memory size, <math alttext="r" class="ltx_Math" display="inline" id="S2.T1.26.m6.1"><semantics id="S2.T1.26.m6.1b"><mi id="S2.T1.26.m6.1.1" xref="S2.T1.26.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.T1.26.m6.1c"><ci id="S2.T1.26.m6.1.1.cmml" xref="S2.T1.26.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.26.m6.1d">r</annotation><annotation encoding="application/x-llamapun" id="S2.T1.26.m6.1e">italic_r</annotation></semantics></math>: compression ratio, <math alttext="p" class="ltx_Math" display="inline" id="S2.T1.27.m7.1"><semantics id="S2.T1.27.m7.1b"><mi id="S2.T1.27.m7.1.1" xref="S2.T1.27.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.T1.27.m7.1c"><ci id="S2.T1.27.m7.1.1.cmml" xref="S2.T1.27.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.27.m7.1d">p</annotation><annotation encoding="application/x-llamapun" id="S2.T1.27.m7.1e">italic_p</annotation></semantics></math>: the number of soft-prompt summary vectors and <math alttext="m" class="ltx_Math" display="inline" id="S2.T1.28.m8.1"><semantics id="S2.T1.28.m8.1b"><mi id="S2.T1.28.m8.1.1" xref="S2.T1.28.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.T1.28.m8.1c"><ci id="S2.T1.28.m8.1.1.cmml" xref="S2.T1.28.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.28.m8.1d">m</annotation><annotation encoding="application/x-llamapun" id="S2.T1.28.m8.1e">italic_m</annotation></semantics></math>: summary vector accumulation steps).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.3">Our Infini-Transformer enables an unbounded context window with a bounded memory footprint. To illustrate this, Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.T1" title="Table 1 ‣ 2.2 Memory and Effective Context Window ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">1</span></a> lists the previous segment-level memory models with their context-memory footprint and effective context length defined in terms of model parameters and input segment length. Infini-Transformer has a constant memory complexity of <math alttext="d_{key}\times d_{value}+d_{key}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mrow id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml"><msub id="S2.SS2.p1.1.m1.1.1.2.2" xref="S2.SS2.p1.1.m1.1.1.2.2.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.2.2" xref="S2.SS2.p1.1.m1.1.1.2.2.2.cmml">d</mi><mrow id="S2.SS2.p1.1.m1.1.1.2.2.3" xref="S2.SS2.p1.1.m1.1.1.2.2.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.2.3.2" xref="S2.SS2.p1.1.m1.1.1.2.2.3.2.cmml">k</mi><mo id="S2.SS2.p1.1.m1.1.1.2.2.3.1" xref="S2.SS2.p1.1.m1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.2.3.3" xref="S2.SS2.p1.1.m1.1.1.2.2.3.3.cmml">e</mi><mo id="S2.SS2.p1.1.m1.1.1.2.2.3.1a" xref="S2.SS2.p1.1.m1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.2.3.4" xref="S2.SS2.p1.1.m1.1.1.2.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.SS2.p1.1.m1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.1.m1.1.1.2.1.cmml">×</mo><msub id="S2.SS2.p1.1.m1.1.1.2.3" xref="S2.SS2.p1.1.m1.1.1.2.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.3.2" xref="S2.SS2.p1.1.m1.1.1.2.3.2.cmml">d</mi><mrow id="S2.SS2.p1.1.m1.1.1.2.3.3" xref="S2.SS2.p1.1.m1.1.1.2.3.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.2" xref="S2.SS2.p1.1.m1.1.1.2.3.3.2.cmml">v</mi><mo id="S2.SS2.p1.1.m1.1.1.2.3.3.1" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.3" xref="S2.SS2.p1.1.m1.1.1.2.3.3.3.cmml">a</mi><mo id="S2.SS2.p1.1.m1.1.1.2.3.3.1a" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.4" xref="S2.SS2.p1.1.m1.1.1.2.3.3.4.cmml">l</mi><mo id="S2.SS2.p1.1.m1.1.1.2.3.3.1b" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.5" xref="S2.SS2.p1.1.m1.1.1.2.3.3.5.cmml">u</mi><mo id="S2.SS2.p1.1.m1.1.1.2.3.3.1c" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.6" xref="S2.SS2.p1.1.m1.1.1.2.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">+</mo><msub id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.SS2.p1.1.m1.1.1.3.3" xref="S2.SS2.p1.1.m1.1.1.3.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.3.2" xref="S2.SS2.p1.1.m1.1.1.3.3.2.cmml">k</mi><mo id="S2.SS2.p1.1.m1.1.1.3.3.1" xref="S2.SS2.p1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.3.3.3" xref="S2.SS2.p1.1.m1.1.1.3.3.3.cmml">e</mi><mo id="S2.SS2.p1.1.m1.1.1.3.3.1a" xref="S2.SS2.p1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.3.3.4" xref="S2.SS2.p1.1.m1.1.1.3.3.4.cmml">y</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><plus id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></plus><apply id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"><times id="S2.SS2.p1.1.m1.1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.1"></times><apply id="S2.SS2.p1.1.m1.1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.2.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.2">𝑑</ci><apply id="S2.SS2.p1.1.m1.1.1.2.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3"><times id="S2.SS2.p1.1.m1.1.1.2.2.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.2">𝑘</ci><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.3">𝑒</ci><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.4.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.4">𝑦</ci></apply></apply><apply id="S2.SS2.p1.1.m1.1.1.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.2.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.2">𝑑</ci><apply id="S2.SS2.p1.1.m1.1.1.2.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3"><times id="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.2">𝑣</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.3">𝑎</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.4.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.4">𝑙</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.5.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.5">𝑢</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.6.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.6">𝑒</ci></apply></apply></apply><apply id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.2">𝑑</ci><apply id="S2.SS2.p1.1.m1.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3"><times id="S2.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.2">𝑘</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.3">𝑒</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3.4.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.4">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">d_{key}\times d_{value}+d_{key}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT</annotation></semantics></math> for storing compressed context in <math alttext="M_{s}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">M</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝑀</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">M_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="z_{s}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><msub id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">z</mi><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝑧</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">z_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> for each head in single layer while for the other models, the complexity grows along with the sequence dimension - the memory complexity depends either on the cache size for Transformer-XL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib14" title="">2019</a>)</cite>, Compressive Transformer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib41" title="">2019</a>)</cite> and Memorizing Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite> or on the soft-prompt size for RTM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bulatov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib7" title="">2022</a>)</cite> and AutoCompressors&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ge et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib18" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="288" id="S2.F3.g1" src="x3.png" width="304">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>There are two types of heads emerged in Infini-attention after training: specialized heads with gating score near 0 or 1 and mixer heads with score close to 0.5. The specialized heads either process contextual information via the local attention mechanism or retrieve from the compressive memory whereas the mixer heads aggregate both current contextual information and long-term memory content together into single output.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.5">Transformer-XL computes attention over KV states cached from the last segment in addition to the current states. Since this is done for each layer, Transformer-XL extends the context window from <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_N</annotation></semantics></math> to <math alttext="N\times l" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">N</mi><mo id="S2.SS2.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.2.m2.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><times id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"></times><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑁</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">N\times l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_N × italic_l</annotation></semantics></math> tokens with an additional memory footprint of <math alttext="(d_{key}+d_{value})\times H\times N\times l" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mrow id="S2.SS2.p2.3.m3.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml"><msub id="S2.SS2.p2.3.m3.1.1.1.1.1.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3.cmml">e</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1a" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml">+</mo><msub id="S2.SS2.p2.3.m3.1.1.1.1.1.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2.cmml">v</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3.cmml">a</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1a" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4.cmml">l</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1b" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5.cmml">u</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1c" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S2.SS2.p2.3.m3.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS2.p2.3.m3.1.1.2" rspace="0.222em" xref="S2.SS2.p2.3.m3.1.1.2.cmml">×</mo><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">H</mi><mo id="S2.SS2.p2.3.m3.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.3.m3.1.1.2.cmml">×</mo><mi id="S2.SS2.p2.3.m3.1.1.4" xref="S2.SS2.p2.3.m3.1.1.4.cmml">N</mi><mo id="S2.SS2.p2.3.m3.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.3.m3.1.1.2.cmml">×</mo><mi id="S2.SS2.p2.3.m3.1.1.5" xref="S2.SS2.p2.3.m3.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><times id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"></times><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1"><plus id="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1"></plus><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3"><times id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1"></times><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2">𝑘</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4">𝑦</ci></apply></apply><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3"><times id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1"></times><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5">𝑢</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6">𝑒</ci></apply></apply></apply><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝐻</ci><ci id="S2.SS2.p2.3.m3.1.1.4.cmml" xref="S2.SS2.p2.3.m3.1.1.4">𝑁</ci><ci id="S2.SS2.p2.3.m3.1.1.5.cmml" xref="S2.SS2.p2.3.m3.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">(d_{key}+d_{value})\times H\times N\times l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">( italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT ) × italic_H × italic_N × italic_l</annotation></semantics></math>. Compressive Transformer adds a second cache to Transformer-XL and stores compressed representations of past segment activations. So it extends the Transformer-XL’s context window by <math alttext="c\times r\times l" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">c</mi><mo id="S2.SS2.p2.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.4.m4.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">r</mi><mo id="S2.SS2.p2.4.m4.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.4.m4.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.4.m4.1.1.4" xref="S2.SS2.p2.4.m4.1.1.4.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><times id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"></times><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝑐</ci><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝑟</ci><ci id="S2.SS2.p2.4.m4.1.1.4.cmml" xref="S2.SS2.p2.4.m4.1.1.4">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">c\times r\times l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_c × italic_r × italic_l</annotation></semantics></math> but still has a large context-memory complexity. Taking the idea further, Memorizing Transformers opt to store the entire KV states as context for input sequences. Since the storage becomes prohibitively expensive in this case, they restrict the contextual computation to a single layer only. By utilizing a fast kNN retriever, Memorizing Transformers then build a context window covering the entire sequence history of length <math alttext="N\times S" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.1"><semantics id="S2.SS2.p2.5.m5.1a"><mrow id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">N</mi><mo id="S2.SS2.p2.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.5.m5.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><times id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1"></times><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝑁</ci><ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">italic_N × italic_S</annotation></semantics></math> at an increased cost of storage. Our experiments show that Infini-Transformer LM can achieve more than 100x compression rate on top of Memorizing Transformers while further improving the perplexity score.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">RMT and AutoCompressors allow for a potentially infinite context length since they compress the input into summary vectors and then pass them as extra soft-prompt inputs for the subsequent segments. However, in practice the success of those techniques highly depends on the size of soft-prompt vectors. Namely, it is necessary to increase the number of soft-prompt (summary) vectors to achieve a better performance with AutoCompressors&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chevalier et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib11" title="">2023</a>)</cite> and with that, the memory and compute complexity grow quickly resulting in diminished efficiency. It was also observed in AutoCompressors&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chevalier et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib11" title="">2023</a>)</cite> that an efficient compression objective is needed for training such prompt compression techniques&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ge et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib18" title="">2023</a>)</cite>.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We evaluated our Infini-Transformer models on benchmarks involving extremely long input sequences: long-context language modeling, 1M length passkey context block retrieval and 500K length book summarization tasks. For the language modeling benchmark, we train our models from scratch while for the passkey and book summarization tasks, we continually pre-train existing LLMs in order to highlight a plug-and-play long-context adaptation capability of our approach.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Long-context Language Modeling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We trained and evaluated small Infini-Transformer models on PG19&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib41" title="">2019</a>)</cite> and Arxiv-math&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite> benchmarks.
Our setup closely resembles that of Memorizing Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite>. Namely, all our models have 12 layers and 8 attention heads of dimension 128 each and FFNs with hidden layer 4096.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.1.1">Model</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.2">Memory size (comp.)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.3">XL cache</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.4">Segment length</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.5">PG19</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.6">Arxiv-math</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.1">Transformer-XL</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.2">50M (3.7x)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.3">2048</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.4">2048</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.5">11.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.6">2.42</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.3">
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.3.1">Memorizing Transformers</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.2">183M (1x)</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.3">2048</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.4">2048</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.5">11.37</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.6">2.26</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.4">
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.1">RMT</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.2">2.5M (73x)</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.3">None</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.4">2048</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.5">13.27</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.6">2.55</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.1">Infini-Transformer (Linear)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.2">1.6M (114x)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.3">None</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.4">2048</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.5"><span class="ltx_text ltx_font_bold" id="S3.T2.1.5.5.5.1">9.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.6">2.24</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.6.6.1">Infini-Transformer (Linear + Delta)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.2">1.6M (114x)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.3">None</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.4">2048</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.5">9.67</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.6"><span class="ltx_text ltx_font_bold" id="S3.T2.1.6.6.6.1">2.23</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Long-context language modeling results are compared in terms of average token-level perplexity. Comp. denotes compression ratio. Infini-Transformer outperforms memorizing transformers with memory length of 65K and achieves 114x compression ratio.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">We set the Infini-attention segment length <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_N</annotation></semantics></math> to 2048 for all attention layers and the input sequence length to 32768 for training. This allows the Infini-attention to unroll over 16 steps w.r.t its compressive memory states. For the RMT baseline, we performed several runs with summary prompt lengths 50, 100 and 150 and sequence lengths 4096, 8196 and 32768. RMT with 100 summary vectors gave the best result when trained on 8196 length sequences.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">The main results from the language modeling experiments are summarized in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.T2" title="Table 2 ‣ 3.1 Long-context Language Modeling ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">2</span></a>. Our Infini-Transformer outperforms both Transformer-XL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib14" title="">2019</a>)</cite> and Memorizing Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite> baselines while maintaining 114x less memory parameters than the Memorizing Transformer model with a vector retrieval-based KV memory with length of 65K at its <math alttext="9^{th}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msup id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mn id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">9</mn><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">superscript</csymbol><cn id="S3.SS1.p3.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.2">9</cn><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><times id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">𝑡</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">9^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">9 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layer.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S3.T3.1.1.1.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S3.T3.1.1.1.2">Zero-shot</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T3.1.2.2.1"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.2">32K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.3">128K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.4">256K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.5">512K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.6">1M</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T3.1.3.3.1">Infini-Transformer (Linear)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.2">14/13/98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.3">11/14/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.4">6/3/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.5">6/7/99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.6">8/6/98</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.1.4.4.1">Infini-Transformer (Linear + Delta)</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.2">13/11/99</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.3">6/9/99</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.4">7/5/99</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.5">6/8/97</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.6">7/6/97</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.5.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S3.T3.1.5.5.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S3.T3.1.5.5.2">FT (400 steps)</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.1.6.6.1">Infini-Transformer (Linear)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.2">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.3">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.4">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.5">97/99/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.6">96/94/100</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T3.1.7.7.1">Infini-Transformer (Linear + Delta)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.2">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.3">100/100/99</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.4">100/100/99</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.5">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.6">100/100/100</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Infini-Transformers solved the passkey task with up to 1M context length when fine-tuned on 5K length inputs. We report token-level retrieval accuracy for passkeys hidden in a different part (<span class="ltx_text ltx_font_italic" id="S3.T3.3.1">start/middle/end</span>) of long inputs with lengths 32K to 1M.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.1">100K length training.</span>
We further increased the training sequence length to 100K from 32K and trained the models on Arxiv-math dataset. 100K training further decreased the perplexity score to <span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.2">2.21</span> and <span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.3">2.20</span> for <math alttext="Linear" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">L</mi><mo id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">i</mi><mo id="S3.SS1.p4.1.m1.1.1.1a" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.4" xref="S3.SS1.p4.1.m1.1.1.4.cmml">n</mi><mo id="S3.SS1.p4.1.m1.1.1.1b" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.5" xref="S3.SS1.p4.1.m1.1.1.5.cmml">e</mi><mo id="S3.SS1.p4.1.m1.1.1.1c" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.6" xref="S3.SS1.p4.1.m1.1.1.6.cmml">a</mi><mo id="S3.SS1.p4.1.m1.1.1.1d" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.7" xref="S3.SS1.p4.1.m1.1.1.7.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><times id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"></times><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝐿</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝑖</ci><ci id="S3.SS1.p4.1.m1.1.1.4.cmml" xref="S3.SS1.p4.1.m1.1.1.4">𝑛</ci><ci id="S3.SS1.p4.1.m1.1.1.5.cmml" xref="S3.SS1.p4.1.m1.1.1.5">𝑒</ci><ci id="S3.SS1.p4.1.m1.1.1.6.cmml" xref="S3.SS1.p4.1.m1.1.1.6">𝑎</ci><ci id="S3.SS1.p4.1.m1.1.1.7.cmml" xref="S3.SS1.p4.1.m1.1.1.7">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">Linear</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_L italic_i italic_n italic_e italic_a italic_r</annotation></semantics></math> and <math alttext="Linear+Delta" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mrow id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2.2" xref="S3.SS1.p4.2.m2.1.1.2.2.cmml">L</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.3" xref="S3.SS1.p4.2.m2.1.1.2.3.cmml">i</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1a" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.4" xref="S3.SS1.p4.2.m2.1.1.2.4.cmml">n</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1b" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.5" xref="S3.SS1.p4.2.m2.1.1.2.5.cmml">e</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1c" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.6" xref="S3.SS1.p4.2.m2.1.1.2.6.cmml">a</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1d" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.7" xref="S3.SS1.p4.2.m2.1.1.2.7.cmml">r</mi></mrow><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">+</mo><mrow id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml"><mi id="S3.SS1.p4.2.m2.1.1.3.2" xref="S3.SS1.p4.2.m2.1.1.3.2.cmml">D</mi><mo id="S3.SS1.p4.2.m2.1.1.3.1" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.3.3" xref="S3.SS1.p4.2.m2.1.1.3.3.cmml">e</mi><mo id="S3.SS1.p4.2.m2.1.1.3.1a" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.3.4" xref="S3.SS1.p4.2.m2.1.1.3.4.cmml">l</mi><mo id="S3.SS1.p4.2.m2.1.1.3.1b" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.3.5" xref="S3.SS1.p4.2.m2.1.1.3.5.cmml">t</mi><mo id="S3.SS1.p4.2.m2.1.1.3.1c" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.3.6" xref="S3.SS1.p4.2.m2.1.1.3.6.cmml">a</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><plus id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></plus><apply id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2"><times id="S3.SS1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.2.1"></times><ci id="S3.SS1.p4.2.m2.1.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2.2">𝐿</ci><ci id="S3.SS1.p4.2.m2.1.1.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3">𝑖</ci><ci id="S3.SS1.p4.2.m2.1.1.2.4.cmml" xref="S3.SS1.p4.2.m2.1.1.2.4">𝑛</ci><ci id="S3.SS1.p4.2.m2.1.1.2.5.cmml" xref="S3.SS1.p4.2.m2.1.1.2.5">𝑒</ci><ci id="S3.SS1.p4.2.m2.1.1.2.6.cmml" xref="S3.SS1.p4.2.m2.1.1.2.6">𝑎</ci><ci id="S3.SS1.p4.2.m2.1.1.2.7.cmml" xref="S3.SS1.p4.2.m2.1.1.2.7">𝑟</ci></apply><apply id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3"><times id="S3.SS1.p4.2.m2.1.1.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.1"></times><ci id="S3.SS1.p4.2.m2.1.1.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2">𝐷</ci><ci id="S3.SS1.p4.2.m2.1.1.3.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3">𝑒</ci><ci id="S3.SS1.p4.2.m2.1.1.3.4.cmml" xref="S3.SS1.p4.2.m2.1.1.3.4">𝑙</ci><ci id="S3.SS1.p4.2.m2.1.1.3.5.cmml" xref="S3.SS1.p4.2.m2.1.1.3.5">𝑡</ci><ci id="S3.SS1.p4.2.m2.1.1.3.6.cmml" xref="S3.SS1.p4.2.m2.1.1.3.6">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">Linear+Delta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_L italic_i italic_n italic_e italic_a italic_r + italic_D italic_e italic_l italic_t italic_a</annotation></semantics></math> models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p5.1.1">Gating score visualization.</span> Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.F3" title="Figure 3 ‣ 2.2 Memory and Effective Context Window ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">3</span></a> visualizes the gating score, <math alttext="\textit{sigmoid}(\beta)" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><mrow id="S3.SS1.p5.1.m1.1.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mtext id="S3.SS1.p5.1.m1.1.2.2" xref="S3.SS1.p5.1.m1.1.2.2a.cmml">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext><mo id="S3.SS1.p5.1.m1.1.2.1" xref="S3.SS1.p5.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p5.1.m1.1.2.3.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mo id="S3.SS1.p5.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p5.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">β</mi><mo id="S3.SS1.p5.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.2"><times id="S3.SS1.p5.1.m1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.2.1"></times><ci id="S3.SS1.p5.1.m1.1.2.2a.cmml" xref="S3.SS1.p5.1.m1.1.2.2"><mtext id="S3.SS1.p5.1.m1.1.2.2.cmml" xref="S3.SS1.p5.1.m1.1.2.2">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext></ci><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\textit{sigmoid}(\beta)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">sigmoid ( italic_β )</annotation></semantics></math> for the compressive memory for all attention heads in each layer. There are two types of heads emerged in Infini-attention after training: specialized heads with a gating score near 0 or 1 and mixer heads with a score close to 0.5. The specialized heads either process contextual information via the local attention computation or retrieve from the compressive memory whereas the mixer heads aggregate both current contextual information and long-term memory content together into a single output. Interestingly, each layer has at least a single short-range head, allowing a forward-propagation of input signal up until the output layer. We also observed an interleaving of long and short-term content retrievals throughout the forward computation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>LLM Continual Pre-training</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S3.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T4.1.1.1.1">Model</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.1.1.1.2">Rouge-1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.1.1.1.3">Rouge-2</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.1.1.1.4">Rouge-L</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.1.1.1.5">Overall</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T4.1.2.2.1">BART</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.2.2">36.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.2.3">7.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.2.4">15.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.2.5">16.2</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T4.1.3.3.1">BART + Unlimiformer</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.3.2">36.8</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.3.3">8.3</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.3.4">15.7</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.3.5">16.9</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T4.1.4.4.1">PRIMERA</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.2">38.6</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.3">7.2</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.4">15.6</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.5">16.3</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T4.1.5.5.1">PRIMERA + Unlimiformer</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.2">37.9</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.3">8.2</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.4">16.3</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.5">17.2</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T4.1.6.6.1">Infini-Transformers (Linear)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.6.6.2">37.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.6.6.3">8.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.6.6.4">17.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.6.6.5">18.0</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T4.1.7.7.1">Infini-Transformers (Linear + Delta)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.7.7.2"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.2.1">40.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.3.1">8.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.7.7.4"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.4.1">17.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.7.7.5"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.5.1">18.5</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>500K length book summarization (BookSum) results. The BART, PRIMERA and Unlimiformer results are from <cite class="ltx_cite ltx_citemacro_citet">Bertsch et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib5" title="">2024</a>)</cite>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We performed a lightweight continual pre-training for long-context adaptation of existing LLMs. The pre-training data includes the PG19 and Arxiv-math corpus as well as C4 text&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Raffel et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib42" title="">2020</a>)</cite> with length more than 4K tokens. The segment length <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_N</annotation></semantics></math> was set to 2K throughout our experiments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">1M passkey retrieval benchmark.</span> We replaced the vanilla MHA in a 1B LLM with Infini-attention and continued to pre-train on inputs with length of 4K. The model was trained for 30K steps with batch size of 64 before fine-tuning on the passkey retrieval task&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mohtashami &amp; Jaggi, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib32" title="">2024</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">The passkey task hides a random number into a long text and asks it back at the model output. The length of the distraction text is varied by repeating a text chunk multiple times. The previous work&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib8" title="">2023a</a>)</cite> showed that a 8B LLaMA model can solve the task up to 32K length when fine-tuned with the same 32K length inputs with Position Interpolation. We take this challenge further and fine-tune on only 5K length inputs to test on 1M length regime.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="222" id="S3.F4.g1" src="x4.png" width="342">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Infini-Transformers obtain better Rouge overall scores with more book text provided as input.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.T3" title="Table 3 ‣ 3.1 Long-context Language Modeling ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">3</span></a> reports the token-level accuracy for test subsets with input lengths ranging from 32K to 1M. For each test subset, we controlled the position of the passkey so that it is either located around the beginning, middle or the end of the input sequence.
We reported both zero-shot accuracy and fine-tuning accuracy. Infini-Transformers solved the task with up to 1M context length after fine-tuning on 5K length inputs for 400 steps.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p5.1.1">500K length book summarization (BookSum).</span> We further scaled our approach by continuously pre-training a 8B LLM model with 8K input length for 30K steps. We then fine-tuned on a book summarization task, BookSum&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kryściński et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib27" title="">2021</a>)</cite> where the goal is to generate a summary of an entire book text.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.1">We set the input length to 32K for fine-tuning and increase to 500K for evaluating. We use a generation temperature of 0.5 and <math alttext="top_{p}=0.95" class="ltx_Math" display="inline" id="S3.SS2.p6.1.m1.1"><semantics id="S3.SS2.p6.1.m1.1a"><mrow id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mrow id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2.2" xref="S3.SS2.p6.1.m1.1.1.2.2.cmml">t</mi><mo id="S3.SS2.p6.1.m1.1.1.2.1" xref="S3.SS2.p6.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p6.1.m1.1.1.2.3" xref="S3.SS2.p6.1.m1.1.1.2.3.cmml">o</mi><mo id="S3.SS2.p6.1.m1.1.1.2.1a" xref="S3.SS2.p6.1.m1.1.1.2.1.cmml">⁢</mo><msub id="S3.SS2.p6.1.m1.1.1.2.4" xref="S3.SS2.p6.1.m1.1.1.2.4.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2.4.2" xref="S3.SS2.p6.1.m1.1.1.2.4.2.cmml">p</mi><mi id="S3.SS2.p6.1.m1.1.1.2.4.3" xref="S3.SS2.p6.1.m1.1.1.2.4.3.cmml">p</mi></msub></mrow><mo id="S3.SS2.p6.1.m1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><eq id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1"></eq><apply id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2"><times id="S3.SS2.p6.1.m1.1.1.2.1.cmml" xref="S3.SS2.p6.1.m1.1.1.2.1"></times><ci id="S3.SS2.p6.1.m1.1.1.2.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2.2">𝑡</ci><ci id="S3.SS2.p6.1.m1.1.1.2.3.cmml" xref="S3.SS2.p6.1.m1.1.1.2.3">𝑜</ci><apply id="S3.SS2.p6.1.m1.1.1.2.4.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.1.1.2.4.1.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4">subscript</csymbol><ci id="S3.SS2.p6.1.m1.1.1.2.4.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4.2">𝑝</ci><ci id="S3.SS2.p6.1.m1.1.1.2.4.3.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4.3">𝑝</ci></apply></apply><cn id="S3.SS2.p6.1.m1.1.1.3.cmml" type="float" xref="S3.SS2.p6.1.m1.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">top_{p}=0.95</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.1.m1.1d">italic_t italic_o italic_p start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = 0.95</annotation></semantics></math> and set the number of decoding steps to 1024 to generate a summary of each book.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p7">
<p class="ltx_p" id="S3.SS2.p7.1">Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.T4" title="Table 4 ‣ 3.2 LLM Continual Pre-training ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">4</span></a> compares our model against the encoder-decoder models that were built particularly for the summarization task&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lewis et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib28" title="">2019</a>; Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib57" title="">2021</a>)</cite> and their retrieval-based long-context extension&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bertsch et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib5" title="">2024</a>)</cite>. Our model outperforms the previous best results and achieves a new SOTA on BookSum by processing the entire text from book. We have also plotted the overall Rouge score on validation split of BookSum data in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.F4" title="Figure 4 ‣ 3.2 LLM Continual Pre-training ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">4</span></a>. There is a clear trend showing that with more text provided as input from books, Our Infini-Transformers improves its summarization performance metric.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Compressive memory.</span> Inspired by the plasticity in biological neurons&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai &amp; Yu, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib34" title="">2017a</a>; Miconi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib31" title="">2018</a>)</cite>, compressive memory approaches cast parameterized functions as memory to store and retrieve information&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hinton &amp; Plaut, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib22" title="">1987</a>; Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib47" title="">1992</a>; Ba et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib2" title="">2016</a>; Munkhdalai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>)</cite>. Unlike the Transformer KV memory array&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib54" title="">2017</a>; Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite>, which grows with input sequence length, compressive memory systems maintain a constant number of memory parameters for computational efficiency. The parameters are modified with an update rule to store information, which is then retrieved via a memory reading mechanism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Graves et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib19" title="">2014</a>; Sukhbaatar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib51" title="">2015</a>; Munkhdalai &amp; Yu, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib35" title="">2017b</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">Compressed input representations can be viewed as a summary of past sequence segments&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib41" title="">2019</a>; Chevalier et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib11" title="">2023</a>)</cite>. Along this direction, more recent works have been utilizing a Transformer LLM itself to compress input sequence for efficient long-context modeling&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bulatov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib7" title="">2022</a>; Chevalier et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib11" title="">2023</a>; Ge et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib18" title="">2023</a>; Mu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib33" title="">2024</a>)</cite>. However, the previous segment-level compression methods, including Compressive Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib41" title="">2019</a>)</cite> still discard the memory entries of old segments in order to free up space for the new ones, limiting their context window to the most recent segments. This is in contrast to our Infini-attention that computes incremental memory updates to a fixed amount of memory parameters in a recurrent fashion.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Long-context continual pre-training.</span> There is a line of work that extends the do-product attention layers and continues to train LLMs for long-context&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib58" title="">2023</a>; Fu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib17" title="">2024</a>)</cite>. The attention extensions include incorporating sparsity into the attention layer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib9" title="">2023b</a>; Ratner et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib43" title="">2022</a>; Mohtashami &amp; Jaggi, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib32" title="">2024</a>)</cite> as well as manipulating the position encodings&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib8" title="">2023a</a>; Peng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib38" title="">2023</a>)</cite> Although the position encoding-based methods such as position interpolation techniques&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib8" title="">2023a</a>)</cite> can be data efficient as they only adjust the positional bias in the attention layer, they are still costly for inference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p4">
<p class="ltx_p" id="S4.p4.1">The attention mechanism is also prone to the issues of attention sink&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib56" title="">2023</a>)</cite> and lost-in-the-middle&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib30" title="">2024</a>)</cite>. Consequently, they struggle in a regime where context length is longer than what was observed during training&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Press et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib40" title="">2021</a>; Kazemnejad et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib26" title="">2024</a>)</cite>. The proposed Infini-attention addresses those issues by enabling a segment-level streaming computation over long sequences with a fixed local attention window. Our Infini-Transformers successfully extrapolate to 1M input length regimes when trained on 32K and even 5K length sequences.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p5">
<p class="ltx_p" id="S4.p5.1"><span class="ltx_text ltx_font_bold" id="S4.p5.1.1">Efficient attention.</span> The efficient attention techniques attempt to improve the efficiency of the dot-product attention with an approximation or a system-level optimization. Multiple directions have been explored for different forms of efficient attention approximation, including sparsity-based&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Child et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib12" title="">2019</a>; Beltagy et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib4" title="">2020</a>; Sukhbaatar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib52" title="">2021</a>; Ding et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib16" title="">2023</a>)</cite> and linear attention approximation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib49" title="">2018</a>; Katharopoulos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib25" title="">2020</a>; Schlag et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib46" title="">2021</a>)</cite>.
Among those, the linear attention variants are closely related to the associative memory matrix&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Schlag et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib45" title="">2020</a>; <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib46" title="">2021</a>)</cite> and the metalearned neural memory&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>)</cite>, where KV bindings&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Smolensky, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib50" title="">1990</a>)</cite> are stored in Fast-Weights&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hinton &amp; Plaut, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib22" title="">1987</a>; Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib47" title="">1992</a>; Ba et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib2" title="">2016</a>)</cite> that are modified in with respect to new contextual information.
More recently, system-level optimization techniques have been proposed by leveraging specific hardware architecture to make the exact attention computation more efficient&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib15" title="">2022</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib29" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">An effective memory system is crucial not just for comprehending long contexts with LLMs, but also for reasoning, planning, continual adaptation for fresh knowledge, and even for learning how to learn. This work introduces a close integration of compressive memory module into the vanilla dot-product attention layer. This subtle but critical modification to the attention layer enables LLMs to process infinitely long contexts with bounded memory and computation resources. We show that our approach can naturally scale to a million length regime of input sequences, while outperforming the baselines on long-context language modeling benchmark and book summarization tasks. We also demonstrate a promising length generalization capability of our approach. 1B model that was fine-tuned on up to 5K sequence length passkey instances solved the 1M length problem.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anil et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rohan Anil, Andrew&nbsp;M Dai, Orhan Firat, Melvin Johnson, Dmitry Lepikhin,
Alexandre Passos, Siamak Shakeri, Emanuel Taropa, Paige Bailey, Zhifeng Chen,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Palm 2 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2305.10403</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ba et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jimmy Ba, Geoffrey&nbsp;E Hinton, Volodymyr Mnih, Joel&nbsp;Z Leibo, and Catalin Ionescu.

</span>
<span class="ltx_bibblock">Using fast weights to attend to the recent past.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Advances in neural information processing systems</em>, 29, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahdanau et&nbsp;al. (2014)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and
translate.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:1409.0473</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beltagy et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Iz&nbsp;Beltagy, Matthew&nbsp;E Peters, and Arman Cohan.

</span>
<span class="ltx_bibblock">Longformer: The long-document transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2004.05150</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertsch et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Amanda Bertsch, Uri Alon, Graham Neubig, and Matthew Gormley.

</span>
<span class="ltx_bibblock">Unlimiformer: Long-range transformers with unlimited length input.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared&nbsp;D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in neural information processing systems</em>,
33:1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bulatov et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aydar Bulatov, Yury Kuratov, and Mikhail Burtsev.

</span>
<span class="ltx_bibblock">Recurrent memory transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Advances in Neural Information Processing Systems</em>,
35:11079–11091, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shouyuan Chen, Sherman Wong, Liangjian Chen, and Yuandong Tian.

</span>
<span class="ltx_bibblock">Extending context window of large language models via positional
interpolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2306.15595</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yukang Chen, Shengju Qian, Haotian Tang, Xin Lai, Zhijian Liu, Song Han, and
Jiaya Jia.

</span>
<span class="ltx_bibblock">Longlora: Efficient fine-tuning of long-context large language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2309.12307</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jianpeng Cheng, Li&nbsp;Dong, and Mirella Lapata.

</span>
<span class="ltx_bibblock">Long short-term memory-networks for machine reading.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:1601.06733</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chevalier et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexis Chevalier, Alexander Wettig, Anirudh Ajith, and Danqi Chen.

</span>
<span class="ltx_bibblock">Adapting language models to compress contexts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2305.14788</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Child et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rewon Child, Scott Gray, Alec Radford, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Generating long sequences with sparse transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:1904.10509</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clevert et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Djork-Arné Clevert, Thomas Unterthiner, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Fast and accurate deep network learning by exponential linear units
(elus).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:1511.07289</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zihang Dai, Zhilin Yang, Yiming Yang, Jaime Carbonell, Quoc&nbsp;V Le, and Ruslan
Salakhutdinov.

</span>
<span class="ltx_bibblock">Transformer-xl: Attentive language models beyond a fixed-length
context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1901.02860</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with
io-awareness.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>,
35:16344–16359, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jiayu Ding, Shuming Ma, Li&nbsp;Dong, Xingxing Zhang, Shaohan Huang, Wenhui Wang,
Nanning Zheng, and Furu Wei.

</span>
<span class="ltx_bibblock">Longnet: Scaling transformers to 1,000,000,000 tokens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2307.02486</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yao Fu, Rameswar Panda, Xinyao Niu, Xiang Yue, Hannaneh Hajishirzi, Yoon Kim,
and Hao Peng.

</span>
<span class="ltx_bibblock">Data engineering for scaling language models to 128k context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2402.10171</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tao Ge, Jing Hu, Xun Wang, Si-Qing Chen, and Furu Wei.

</span>
<span class="ltx_bibblock">In-context autoencoder for context compression in a large language
model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2307.06945</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graves et&nbsp;al. (2014)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alex Graves, Greg Wayne, and Ivo Danihelka.

</span>
<span class="ltx_bibblock">Neural turing machines.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:1410.5401</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Groeneveld et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dirk Groeneveld, Iz&nbsp;Beltagy, Pete Walsh, Akshita Bhagia, Rodney Kinney, Oyvind
Tafjord, Ananya&nbsp;Harsh Jha, Hamish Ivison, Ian Magnusson, Yizhong Wang, et&nbsp;al.

</span>
<span class="ltx_bibblock">Olmo: Accelerating the science of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2402.00838</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hebb (2005)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Donald&nbsp;Olding Hebb.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">The organization of behavior: A neuropsychological theory</em>.

</span>
<span class="ltx_bibblock">Psychology press, 2005.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton &amp; Plaut (1987)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Geoffrey&nbsp;E Hinton and David&nbsp;C Plaut.

</span>
<span class="ltx_bibblock">Using fast weights to deblur old memories.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the ninth annual conference of the Cognitive
Science Society</em>, pp.&nbsp; 177–186, 1987.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hopfield (1982)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
John&nbsp;J Hopfield.

</span>
<span class="ltx_bibblock">Neural networks and physical systems with emergent collective
computational abilities.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the national academy of sciences</em>, 79(8):2554–2558, 1982.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kanerva (1988)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pentti Kanerva.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Sparse distributed memory</em>.

</span>
<span class="ltx_bibblock">MIT press, 1988.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katharopoulos et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and François
Fleuret.

</span>
<span class="ltx_bibblock">Transformers are rnns: Fast autoregressive transformers with linear
attention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">International conference on machine learning</em>, pp.&nbsp;5156–5165. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kazemnejad et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Amirhossein Kazemnejad, Inkit Padhi, Karthikeyan Natesan&nbsp;Ramamurthy, Payel Das,
and Siva Reddy.

</span>
<span class="ltx_bibblock">The impact of positional encoding on length generalization in
transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kryściński et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wojciech Kryściński, Nazneen Rajani, Divyansh Agarwal, Caiming Xiong,
and Dragomir Radev.

</span>
<span class="ltx_bibblock">Booksum: A collection of datasets for long-form narrative
summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2105.08209</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mike Lewis, Yinhan Liu, Naman Goyal, Marjan Ghazvininejad, Abdelrahman Mohamed,
Omer Levy, Ves Stoyanov, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Bart: Denoising sequence-to-sequence pre-training for natural
language generation, translation, and comprehension.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:1910.13461</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hao Liu, Matei Zaharia, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Ring attention with blockwise transformers for near-infinite context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2310.01889</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nelson&nbsp;F Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua,
Fabio Petroni, and Percy Liang.

</span>
<span class="ltx_bibblock">Lost in the middle: How language models use long contexts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Transactions of the Association for Computational Linguistics</em>,
12:157–173, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miconi et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Thomas Miconi, Kenneth Stanley, and Jeff Clune.

</span>
<span class="ltx_bibblock">Differentiable plasticity: training plastic neural networks with
backpropagation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">International Conference on Machine Learning</em>, pp.&nbsp;3559–3568. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohtashami &amp; Jaggi (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Amirkeivan Mohtashami and Martin Jaggi.

</span>
<span class="ltx_bibblock">Random-access infinite context length for transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jesse Mu, Xiang Li, and Noah Goodman.

</span>
<span class="ltx_bibblock">Learning to compress prompts with gist tokens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai &amp; Yu (2017a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai and Hong Yu.

</span>
<span class="ltx_bibblock">Meta networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">International conference on machine learning</em>, pp.&nbsp;2554–2563. PMLR, 2017a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai &amp; Yu (2017b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai and Hong Yu.

</span>
<span class="ltx_bibblock">Neural semantic encoders.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the conference. Association for Computational
Linguistics. Meeting</em>, volume&nbsp;1, pp.&nbsp; 397. NIH Public Access,
2017b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai, John&nbsp;P Lalor, and Hong Yu.

</span>
<span class="ltx_bibblock">Citation analysis with neural attention models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the Seventh International Workshop on Health
Text Mining and Information Analysis</em>, pp.&nbsp; 69–77, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai, Alessandro Sordoni, Tong Wang, and Adam Trischler.

</span>
<span class="ltx_bibblock">Metalearned neural memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Advances in Neural Information Processing Systems</em>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bowen Peng, Jeffrey Quesnelle, Honglu Fan, and Enrico Shippole.

</span>
<span class="ltx_bibblock">Yarn: Efficient context window extension of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2309.00071</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pope et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Reiner Pope, Sholto Douglas, Aakanksha Chowdhery, Jacob Devlin, James Bradbury,
Jonathan Heek, Kefan Xiao, Shivani Agrawal, and Jeff Dean.

</span>
<span class="ltx_bibblock">Efficiently scaling transformer inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of Machine Learning and Systems</em>, 5, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ofir Press, Noah&nbsp;A Smith, and Mike Lewis.

</span>
<span class="ltx_bibblock">Train short, test long: Attention with linear biases enables input
length extrapolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2108.12409</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rae et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jack&nbsp;W Rae, Anna Potapenko, Siddhant&nbsp;M Jayakumar, and Timothy&nbsp;P Lillicrap.

</span>
<span class="ltx_bibblock">Compressive transformers for long-range sequence modelling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:1911.05507</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael
Matena, Yanqi Zhou, Wei Li, and Peter&nbsp;J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">The Journal of Machine Learning Research</em>, 21(1):5485–5551, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ratner et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nir Ratner, Yoav Levine, Yonatan Belinkov, Ori Ram, Omri Abend, Ehud Karpas,
Amnon Shashua, Kevin Leyton-Brown, and Yoav Shoham.

</span>
<span class="ltx_bibblock">Parallel context windows improve in-context learning of large
language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2212.10947</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Imanol Schlag, Paul Smolensky, Roland Fernandez, Nebojsa Jojic, Jürgen
Schmidhuber, and Jianfeng Gao.

</span>
<span class="ltx_bibblock">Enhancing the transformer with explicit relational encoding for math
problem solving.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:1910.06611</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Imanol Schlag, Tsendsuren Munkhdalai, and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Learning associative inference using fast weight memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2011.07831</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Imanol Schlag, Kazuki Irie, and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Linear transformers are secretly fast weight programmers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">International Conference on Machine Learning</em>, pp.&nbsp;9355–9366. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schmidhuber (1992)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Learning to control fast-weight memories: An alternative to dynamic
recurrent networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Neural Computation</em>, 4(1):131–139, 1992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer &amp; Stern (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Noam Shazeer and Mitchell Stern.

</span>
<span class="ltx_bibblock">Adafactor: Adaptive learning rates with sublinear memory cost.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">International Conference on Machine Learning</em>, pp.&nbsp;4596–4604. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhuoran Shen, Mingyuan Zhang, Haiyu Zhao, Shuai Yi, and Hongsheng Li.

</span>
<span class="ltx_bibblock">Efficient attention: Attention with linear complexities.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">arXiv preprint arXiv:1812.01243</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smolensky (1990)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Paul Smolensky.

</span>
<span class="ltx_bibblock">Tensor product variable binding and the representation of symbolic
structures in connectionist systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Artificial intelligence</em>, 46(1-2):159–216,
1990.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sukhbaatar et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sainbayar Sukhbaatar, Jason Weston, Rob Fergus, et&nbsp;al.

</span>
<span class="ltx_bibblock">End-to-end memory networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Advances in neural information processing systems</em>, 28, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sukhbaatar et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sainbayar Sukhbaatar, Da&nbsp;Ju, Spencer Poff, Stephen Roller, Arthur Szlam, Jason
Weston, and Angela Fan.

</span>
<span class="ltx_bibblock">Not all memories are created equal: Learning to forget by expiring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">International Conference on Machine Learning</em>, pp.&nbsp;9902–9912. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">arXiv preprint arXiv:2307.09288</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan&nbsp;N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuhuai Wu, Markus&nbsp;N Rabe, DeLesley Hutchins, and Christian Szegedy.

</span>
<span class="ltx_bibblock">Memorizing transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:2203.08913</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guangxuan Xiao, Yuandong Tian, Beidi Chen, Song Han, and Mike Lewis.

</span>
<span class="ltx_bibblock">Efficient streaming language models with attention sinks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:2309.17453</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wen Xiao, Iz&nbsp;Beltagy, Giuseppe Carenini, and Arman Cohan.

</span>
<span class="ltx_bibblock">Primera: Pyramid-based masked sentence pre-training for
multi-document summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">arXiv preprint arXiv:2110.08499</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wenhan Xiong, Jingyu Liu, Igor Molybog, Hejia Zhang, Prajjwal Bhargava, Rui
Hou, Louis Martin, Rashi Rungta, Karthik&nbsp;Abinav Sankararaman, Barlas Oguz,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Effective long-context scaling of foundation models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">arXiv preprint arXiv:2309.16039</em>, 2023.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional Training Details</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">For the long-context language modeling task, we set the learning rate to 0.01 by performing small search over values of 0.003, 0.005, 0.01 and 0.03. We used the Adafactor optimizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shazeer &amp; Stern, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib48" title="">2018</a>)</cite> with linear warmup with 1000 steps, followed by cosine decay. We applied gradient checkpointing after each segment to save to save memory. The batch size was set to 64. For the LLM experiments, we set the learning rate to 0.0001 during continual pre-training and task fine-tuning.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Passkey Retrieval Task</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">Below we showed the input format of the passkey task.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1"><span class="ltx_text ltx_font_sansserif" id="A2.p2.1.1">There is an important info hidden inside a lot of irrelevant text. Find it and
memorize them. I will quiz you about the important information there.
The grass is green. The sky is blue. The sun is yellow. Here we go. There and
back again. <span class="ltx_text ltx_framed_underline" id="A2.p2.1.1.1">(repeat x times)</span> The pass key is <span class="ltx_text ltx_font_bold" id="A2.p2.1.1.2">9054</span>. Remember it. <span class="ltx_text ltx_font_bold" id="A2.p2.1.1.3">9054</span> is the pass key. The grass is green. The sky is blue. The sun is yellow. Here we go. There and ack again. <span class="ltx_text ltx_framed_underline" id="A2.p2.1.1.4">(repeat y times)</span>
What is the pass key? The pass key is</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</article>
</div>

</div>


<div class="ltx_page_footer">
          <div class="ltx_page_logo">
              Generated by
              <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                  <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                      L
                      <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                      T
                      <span style="position: relative; bottom: -0.4ex;">E</span>
                  </span>
                  <span class="ltx_font_smallcaps">xml</span>
                  <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
              </a>
          </div></div><footer id="footer" class="ltx_document">
          <div class="keyboard-glossary">
              <h2>Instructions for reporting errors</h2>
              <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
              <ul>
                  <li>Click the "Report Issue" button.</li>
                  <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                  <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                  <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
              </ul>
              <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
              <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
          </div>
      </footer><button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header" data-bs-theme="dark"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button></body></html>