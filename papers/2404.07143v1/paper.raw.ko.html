<html lang="en" data-theme="dark"><head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention</title>
<!--Generated on Wed Apr 10 16:10:49 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="https://arxiv.org/static/browse/0.3.4/js/addons.js"></script>
<script src="https://arxiv.org/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="https://arxiv.org/html/2404.07143v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
      <div class="html-header-logo">
        <a href="https://arxiv.org/">
          <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
          <span class="sr-only">Back to arXiv</span>
        </a>
      </div>
  
      <!--TOC, dark mode, links-->
      <div class="html-header-nav">
        <!--back to abstract-->
        
          <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2404.07143v1">
          <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
              <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
          </svg>
          </a>
        <!--dark mode-->
        <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode" aria-label="Dark mode">
          <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3" hidden="">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
          </label>
          <label id="light-tog" class="toggle-icon" title="Switch to dark mode" for="__palette_1" hidden="">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
          </label>
          <label id="dark-tog" class="toggle-icon" title="Switch to system preference" for="__palette_2">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
          </label>
        </a>
        <!--nav-->
        <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
          <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
        </button>
      </div>
      </header><header class="desktop_header">
      <div class="html-header-logo">
        <a href="https://arxiv.org/">
            <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
            <span class="sr-only">Back to arXiv</span>
        </a>
      </div>
      <div class="html-header-message" role="banner">
          <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
          </p>
      </div>
      <nav class="html-header-nav">
        <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
        <a class="ar5iv-footer-button hover-effect" target="_blank" href="#myForm" onclick="event.preventDefault(); var modal = document.getElementById('myForm'); modal.style.display = 'block'; bugReportState.setInitiateWay('Header');">Report Issue</a>
        <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2404.07143v1">Back to Abstract</a>
        <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2404.07143v1" target="_blank">Download PDF</a>
        <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3" hidden="">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        <label id="light-tog" class="toggle-icon" title="Switch to dark mode" for="__palette_1" hidden="">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
        </label>
        <label id="dark-tog" class="toggle-icon" title="Switch to system preference" for="__palette_2">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
        </label>
      </a>
      </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC mobile collapse" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

        <div id="listIcon" type="button" class="hide">
            <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
            <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
            </svg>
        </div>
        <div id="arrowIcon" type="button">
            <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
            <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
            </svg>
        </div><ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S1" title="1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2" title="2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.SS1" title="2.1 Infini-attention ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Infini-attention</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.SS1.SSS1" title="2.1.1 Scaled Dot-product Attention ‣ 2.1 Infini-attention ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.1 </span>Scaled Dot-product Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.SS1.SSS2" title="2.1.2 Compressive Memory ‣ 2.1 Infini-attention ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.2 </span>Compressive Memory</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.SS2" title="2.2 Memory and Effective Context Window ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Memory and Effective Context Window</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3" title="3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.SS1" title="3.1 Long-context Language Modeling ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Long-context Language Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.SS2" title="3.2 LLM Continual Pre-training ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>LLM Continual Pre-training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S4" title="4 Related Work ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S5" title="5 Conclusion ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#A1" title="Appendix A Additional Training Details ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional Training Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#A2" title="Appendix B Passkey Retrieval Task ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Passkey Retrieval Task</span></a></li>
</ol></nav>

<div class="ltx_page_content"><div class="section" id="target-section"><div id="license-tr">License: arXiv.org perpetual non-exclusive license</div><div id="watermark-tr">arXiv:2404.07143v1 [cs.CL] 10 Apr 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Leave No Context Behind: 
<br class="ltx_break">Efficient Infinite Context Transformers with Infini-attention</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tsendsuren Munkhdalai, Manaal Faruqui and Siddharth Gopal
<br class="ltx_break">Google 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">tsendsuren@google.com</span>
</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id2.id1">본 논문에서는 Transformer 기반 대용량 언어 모델(Large Language Models, LLM)을 무한히 긴 입력으로 확장하기 위한 효율적인 방법을 제안한다. 제안된 방법의 핵심 요소는 Infini-attention이라고 불리는 새로운 주의 기법이다. 인피니 어텐션은 압축 메모리를 바닐라 어텐션 메커니즘에 통합하고 단일 트랜스포머 블록에서 마스킹된 로컬 어텐션 메커니즘과 장기 선형 어텐션 메커니즘 모두에 구축한다. 본 논문에서는 1B LLM과 8B LLM을 사용하여 긴 컨텍스트 언어 모델링 벤치마크, 1M 시퀀스 길이 패스키 컨텍스트 블록 검색 및 500K 길이의 책 요약 태스크에 대한 제안 방법의 효율성을 보인다. 제안하는 방법은 최소 경계 메모리 파라미터를 도입하여 LLMs에 대한 빠른 스트리밍 추론을 가능하게 한다.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">메모리는 특정 컨텍스트에 맞춘 효율적인 계산을 가능하게 하기 때문에 지능의 초석 역할을 한다. 그러나 Transformers<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib54" title="">2017</a>)</cite>와 Transformer 기반 LLMs<cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib6" title="">2020</a>; Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib53" title="">2023</a>; Anil et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib1" title="">2023</a>; Groeneveld et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib20" title="">2024</a>)</cite>는 어텐션 메커니즘의 특성상 제한된 컨텍스트 의존 메모리를 가지고 있다.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="268" id="S1.F1.g1" src="https://arxiv.org/html/2404.07143v1/x1.png" width="304">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 1:</span>Infini-attention은 무한히 긴 컨텍스트를 처리하기 위한 선형 어텐션을 갖는 추가적인 압축 메모리를 갖는다. <math alttext="\{KV\}_{s-1}" class="ltx_Math" display="inline" id="S1.F1.4.m1.1"><semantics id="S1.F1.4.m1.1b"><msub id="S1.F1.4.m1.1.1" xref="S1.F1.4.m1.1.1.cmml"><mrow id="S1.F1.4.m1.1.1.1.1" xref="S1.F1.4.m1.1.1.1.2.cmml"><mo id="S1.F1.4.m1.1.1.1.1.2" stretchy="false" xref="S1.F1.4.m1.1.1.1.2.cmml">{</mo><mrow id="S1.F1.4.m1.1.1.1.1.1" xref="S1.F1.4.m1.1.1.1.1.1.cmml"><mi id="S1.F1.4.m1.1.1.1.1.1.2" xref="S1.F1.4.m1.1.1.1.1.1.2.cmml">K</mi><mo id="S1.F1.4.m1.1.1.1.1.1.1" xref="S1.F1.4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S1.F1.4.m1.1.1.1.1.1.3" xref="S1.F1.4.m1.1.1.1.1.1.3.cmml">V</mi></mrow><mo id="S1.F1.4.m1.1.1.1.1.3" stretchy="false" xref="S1.F1.4.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S1.F1.4.m1.1.1.3" xref="S1.F1.4.m1.1.1.3.cmml"><mi id="S1.F1.4.m1.1.1.3.2" xref="S1.F1.4.m1.1.1.3.2.cmml">s</mi><mo id="S1.F1.4.m1.1.1.3.1" xref="S1.F1.4.m1.1.1.3.1.cmml">−</mo><mn id="S1.F1.4.m1.1.1.3.3" xref="S1.F1.4.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F1.4.m1.1c"><apply id="S1.F1.4.m1.1.1.cmml" xref="S1.F1.4.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.4.m1.1.1.2.cmml" xref="S1.F1.4.m1.1.1">subscript</csymbol><set id="S1.F1.4.m1.1.1.1.2.cmml" xref="S1.F1.4.m1.1.1.1.1"><apply id="S1.F1.4.m1.1.1.1.1.1.cmml" xref="S1.F1.4.m1.1.1.1.1.1"><times id="S1.F1.4.m1.1.1.1.1.1.1.cmml" xref="S1.F1.4.m1.1.1.1.1.1.1"></times><ci id="S1.F1.4.m1.1.1.1.1.1.2.cmml" xref="S1.F1.4.m1.1.1.1.1.1.2">𝐾</ci><ci id="S1.F1.4.m1.1.1.1.1.1.3.cmml" xref="S1.F1.4.m1.1.1.1.1.1.3">𝑉</ci></apply></set><apply id="S1.F1.4.m1.1.1.3.cmml" xref="S1.F1.4.m1.1.1.3"><minus id="S1.F1.4.m1.1.1.3.1.cmml" xref="S1.F1.4.m1.1.1.3.1"></minus><ci id="S1.F1.4.m1.1.1.3.2.cmml" xref="S1.F1.4.m1.1.1.3.2">𝑠</ci><cn id="S1.F1.4.m1.1.1.3.3.cmml" type="integer" xref="S1.F1.4.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.m1.1d">\{KV\}_{s-1}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.4.m1.1e">{ italic_K italic_V } start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT</annotation></semantics></math> 및 <math alttext="\{KV\}_{s}" class="ltx_Math" display="inline" id="S1.F1.5.m2.1"><semantics id="S1.F1.5.m2.1b"><msub id="S1.F1.5.m2.1.1" xref="S1.F1.5.m2.1.1.cmml"><mrow id="S1.F1.5.m2.1.1.1.1" xref="S1.F1.5.m2.1.1.1.2.cmml"><mo id="S1.F1.5.m2.1.1.1.1.2" stretchy="false" xref="S1.F1.5.m2.1.1.1.2.cmml">{</mo><mrow id="S1.F1.5.m2.1.1.1.1.1" xref="S1.F1.5.m2.1.1.1.1.1.cmml"><mi id="S1.F1.5.m2.1.1.1.1.1.2" xref="S1.F1.5.m2.1.1.1.1.1.2.cmml">K</mi><mo id="S1.F1.5.m2.1.1.1.1.1.1" xref="S1.F1.5.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S1.F1.5.m2.1.1.1.1.1.3" xref="S1.F1.5.m2.1.1.1.1.1.3.cmml">V</mi></mrow><mo id="S1.F1.5.m2.1.1.1.1.3" stretchy="false" xref="S1.F1.5.m2.1.1.1.2.cmml">}</mo></mrow><mi id="S1.F1.5.m2.1.1.3" xref="S1.F1.5.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.5.m2.1c"><apply id="S1.F1.5.m2.1.1.cmml" xref="S1.F1.5.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.5.m2.1.1.2.cmml" xref="S1.F1.5.m2.1.1">subscript</csymbol><set id="S1.F1.5.m2.1.1.1.2.cmml" xref="S1.F1.5.m2.1.1.1.1"><apply id="S1.F1.5.m2.1.1.1.1.1.cmml" xref="S1.F1.5.m2.1.1.1.1.1"><times id="S1.F1.5.m2.1.1.1.1.1.1.cmml" xref="S1.F1.5.m2.1.1.1.1.1.1"></times><ci id="S1.F1.5.m2.1.1.1.1.1.2.cmml" xref="S1.F1.5.m2.1.1.1.1.1.2">𝐾</ci><ci id="S1.F1.5.m2.1.1.1.1.1.3.cmml" xref="S1.F1.5.m2.1.1.1.1.1.3">𝑉</ci></apply></set><ci id="S1.F1.5.m2.1.1.3.cmml" xref="S1.F1.5.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m2.1d">\{KV\}_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.5.m2.1e">{ italic_K italic_V } start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>는 각각 현재 및 이전 입력 세그먼트에 대한 어텐션 키 및 값이고, <math alttext="Q_{s}" class="ltx_Math" display="inline" id="S1.F1.6.m3.1"><semantics id="S1.F1.6.m3.1b"><msub id="S1.F1.6.m3.1.1" xref="S1.F1.6.m3.1.1.cmml"><mi id="S1.F1.6.m3.1.1.2" xref="S1.F1.6.m3.1.1.2.cmml">Q</mi><mi id="S1.F1.6.m3.1.1.3" xref="S1.F1.6.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.6.m3.1c"><apply id="S1.F1.6.m3.1.1.cmml" xref="S1.F1.6.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.6.m3.1.1.1.cmml" xref="S1.F1.6.m3.1.1">subscript</csymbol><ci id="S1.F1.6.m3.1.1.2.cmml" xref="S1.F1.6.m3.1.1.2">𝑄</ci><ci id="S1.F1.6.m3.1.1.3.cmml" xref="S1.F1.6.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m3.1d">Q_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.6.m3.1e">italic_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> 어텐션 쿼리이다. PE는 위치 임베딩을 나타낸다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">트랜스포머의 주의 메커니즘은 메모리 공간과 계산 시간 모두에서 2차 복잡성을 나타낸다. 예를 들어, 주의 Key-Value (KV) 상태는 배치 크기 512 및 컨텍스트 길이 2048 <cite class="ltx_cite ltx_citemacro_citep">(Pope et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib39" title="">2023</a>)</cite>를 갖는 500B 모델에 대해 3TB 메모리 풋프린트를 갖는다. 실제로 LLM을 더 긴 시퀀스(즉, 1M 토큰)로 스케일링하는 것은 표준 트랜스포머 아키텍처로 어렵고 더 길고 긴 컨텍스트 모델을 제공하는 것은 재정적으로 비용이 많이 든다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">압축 메모리 시스템은 매우 긴 시퀀스 <cite class="ltx_cite ltx_citemacro_citep">(Kanerva, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib24" title="">1988</a>; Munkhdalai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>)</cite>에 대해 어텐션 메커니즘보다 확장성이 높고 효율적일 것을 약속한다. 입력 시퀀스 길이에 따라 성장하는 어레이를 사용하는 대신에, 압축 메모리는 주로 제한된 저장 및 계산 비용으로 정보를 저장하고 리콜하기 위해 고정된 수의 파라미터를 유지한다. 압축 메모리에서, 새로운 정보는 이 정보가 나중에 다시 복구될 수 있는 목적으로 그것의 파라미터들을 변경함으로써 메모리에 추가된다. 그러나, 현재 상태에 있는 LLM들은 품질과 함께 단순성의 균형을 맞추는 효과적이고 실용적인 압축 메모리 기술을 아직 보지 못했다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">본 논문에서는 트랜스포머 LLM이 무한히 긴 입력을 효과적으로 처리할 수 있는 새로운 접근 방법을 제안한다. 제안된 접근법의 핵심 구성 요소는 Infini-attention(그림<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">1</span></a>)로 명명된 새로운 주의 기법이다. 인피니 어텐션은 압축 메모리를 바닐라 어텐션 메커니즘 <cite class="ltx_cite ltx_citemacro_citep">(Bahdanau et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib3" title="">2014</a>; Vaswani et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib54" title="">2017</a>)</cite>에 통합하고 단일 트랜스포머 블록에서 마스킹된 로컬 어텐션과 장기 선형 어텐션 메커니즘 모두에 구축한다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">트랜스포머 어텐션 레이어에 대한 이러한 미묘하지만 중요한 수정은 지속적인 사전 훈련 및 미세 조정을 통해 기존 LLM의 자연스러운 확장을 무한히 긴 컨텍스트로 가능하게 한다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">인피니 어텐션은 장기 기억 통합 및 검색을 위해 표준 어텐션 계산의 모든 키, 값 및 쿼리 상태를 재사용한다. 우리는 주의력의 오래된 KV 상태를 표준 주의 메커니즘과 같이 버리는 대신 압축 메모리에 저장한다. 그런 다음 후속 시퀀스를 처리할 때 주의 쿼리 상태를 사용하여 메모리에서 값을 검색한다. 최종 컨텍스트 출력을 계산하기 위해, Infini-attention은 장기 메모리-검색된 값들과 로컬 어텐션 컨텍스트들을 집계한다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">실험을 통해 제안한 방법이 메모리 크기 측면에서 114x의 이해율을 가지면서 긴 문맥 언어 모델링 벤치마크에서 기준 모델보다 우수함을 보인다. 모델은 100K 시퀀스 길이로 훈련될 때 훨씬 더 나은 복잡성을 달성한다. 1B LLM은 자연스럽게 1M 시퀀스 길이로 스케일링되며, Infini-attention을 주입할 때 패스키 검색 작업을 해결한다. 마지막으로, Infini-attention을 갖는 8B 모델이 500K 길이의 책 요약 작업에서 지속적인 사전 훈련과 작업 미세 조정 후에 새로운 SOTA 결과에 도달한다는 것을 보여준다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">요약하면, 우리의 작업은 다음과 같은 기여를 한다.</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">우리는 장기 압축 메모리와 로컬 인과 주의를 사용하여 실질적이면서도 강력한 주의 메커니즘인 인피니 주의(Infini-attention)를 도입하여 장거리 및 단거리 문맥 종속성을 효율적으로 모델링한다.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">인피니 주의력은 표준 스케일 도트 제품 주의력에 최소한의 변화를 도입하고 플러그 앤 플레이 연속 사전 훈련 및 설계에 의한 긴 컨텍스트 적응을 지원한다.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">제안된 방법은 트랜스포머 LLM이 제한된 메모리를 사용하여 무한히 긴 컨텍스트로 확장하고 스트리밍 방식으로 매우 긴 입력을 처리함으로써 리소스를 계산할 수 있도록 한다.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Method</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="390" id="S2.F2.g1" src="https://arxiv.org/html/2404.07143v1/x2.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 2:</span>Infini-Transformer (상단)는 전체 컨텍스트 히스토리를 갖는 반면 Transformer-XL (하단)은 마지막 세그먼트에 대해서만 KV 상태들을 캐싱하기 때문에 오래된 컨텍스트들을 폐기한다.</figcaption><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Infini-Transformer (top) has an entire context history whereas Transformer-XL (bottom) discards old contexts since it caches the KV states for the last segment only.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.3"><a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.F2" title="Figure 2 ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">2</span></a>는 우리 모델인 Infini-Transformer와 Transformer-XL<cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib14" title="">2019</a>)</cite>를 비교한 것이다. Transformer-XL과 유사하게, Infini-Transformer는 세그먼트들의 시퀀스에서 동작한다. 우리는 각 세그먼트 내에서 표준 인과 점-제품 주의 컨텍스트를 계산한다. 그래서 도트-곱 어텐션 계산은 인덱스 <math alttext="S" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_S</annotation></semantics></math>로 현재 세그먼트의 총 <math alttext="N" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_N</annotation></semantics></math> 토큰 수를 포괄한다는 의미에서 로컬이다(<math alttext="N" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_N</annotation></semantics></math>는 세그먼트 길이).</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">그러나 로컬 어텐션 <cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib14" title="">2019</a>)</cite>는 다음 세그먼트를 처리할 때 이전 세그먼트의 어텐션 상태를 버린다. 인피니-트랜스포머에서는 이전 KV 주의 상태를 생략하는 대신 압축 메모리로 전체 컨텍스트 히스토리를 유지하기 위해 재사용할 것을 제안한다. 따라서 인피니-트랜스포머의 각 주의층은 전역 압축 상태와 국부 세립 상태를 모두 가지고 있다. 우리는 이러한 효율적인 주의 메커니즘인 Infini-attention이라고 부르며, 이는 그림 <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">1</span></a>에 예시되고 다음 섹션에서 형식적으로 설명된다.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Infini-attention</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.2">그림 <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">1</span></a>와 같이, Infini-attention은 로컬 및 글로벌 컨텍스트 상태를 모두 계산하고 출력에 대해 결합합니다. 멀티 헤드 어텐션(MHA)과 유사하게, 도트-제품 어텐션 외에 어텐션 레이어당 병렬 압축 메모리의 수(<math alttext="H" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_H</annotation></semantics></math>는 어텐션 헤드의 수)를 유지한다.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Scaled Dot-product Attention</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS1.p1">
<p class="ltx_p" id="S2.SS1.SSS1.p1.1">멀티헤드 스케일링된 도트-제품 어텐션 <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib54" title="">2017</a>)</cite>, 특히 자체 어텐션 변형 <cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib36" title="">2016</a>; Cheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib10" title="">2016</a>)</cite>는 LLM의 주요 구성 요소였다. 맥락 의존적 동적 계산을 모델링하는 MHA의 강력한 능력과 시간적 마스킹의 편리성은 자기회귀 생성 모델에서 광범위하게 활용되었다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS1.p2">
<p class="ltx_p" id="S2.SS1.SSS1.p2.2">A single head in the vanilla MHA computes its attention context <math alttext="A_{dot}\in{\rm I\!R}^{N\times d_{value}}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p2.1.m1.1"><semantics id="S2.SS1.SSS1.p2.1.m1.1a"><mrow id="S2.SS1.SSS1.p2.1.m1.1.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.cmml"><msub id="S2.SS1.SSS1.p2.1.m1.1.1.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.2.cmml">A</mi><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.2.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2.cmml">d</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1a" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.SS1.SSS1.p2.1.m1.1.1.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.1.m1.1.1.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p2.1.m1.1b"><apply id="S2.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1"><in id="S2.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.1"></in><apply id="S2.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.2">𝐴</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2">𝑑</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.2">I</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p2.1.m1.1c">A_{dot}\in{\rm I\!R}^{N\times d_{value}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p2.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_d italic_o italic_t end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> from sequence of input segments <math alttext="X\in{\rm I\!R}^{N\times d_{model}}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p2.2.m2.1"><semantics id="S2.SS1.SSS1.p2.2.m2.1a"><mrow id="S2.SS1.SSS1.p2.2.m2.1.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.2.cmml">X</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.2.m2.1.1.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.2.m2.1.1.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2.cmml">m</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4.cmml">d</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5.cmml">e</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p2.2.m2.1b"><apply id="S2.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1"><in id="S2.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.1"></in><ci id="S2.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.2">𝑋</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3"><times id="S2.SS1.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3"><times id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3"><times id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p2.2.m2.1c">X\in{\rm I\!R}^{N\times d_{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p2.2.m2.1d">italic_X ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as follows. First, it computes attention query, key, and value states:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="K=XW_{K},\text{ }V=XW_{V}\text{ and }Q=XW_{Q}." class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1"><mrow id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.3.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">K</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.cmml">X</mi><mo id="S2.E1.m1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.cmml">K</mi></msub></mrow></mrow><mo id="S2.E1.m1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.E1.m1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.2.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.cmml"><mtext id="S2.E1.m1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.2a.cmml">&nbsp;</mtext><mo id="S2.E1.m1.1.1.1.1.2.2.2.1" xref="S2.E1.m1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.2.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.2.3.cmml">V</mi></mrow><mo id="S2.E1.m1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.3.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.2.2.4" xref="S2.E1.m1.1.1.1.1.2.2.4.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.4.2" xref="S2.E1.m1.1.1.1.1.2.2.4.2.cmml">X</mi><mo id="S2.E1.m1.1.1.1.1.2.2.4.1" xref="S2.E1.m1.1.1.1.1.2.2.4.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.2.2.4.3" xref="S2.E1.m1.1.1.1.1.2.2.4.3.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.4.3.2" xref="S2.E1.m1.1.1.1.1.2.2.4.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.1.1.2.2.4.3.3" xref="S2.E1.m1.1.1.1.1.2.2.4.3.3.cmml">V</mi></msub><mo id="S2.E1.m1.1.1.1.1.2.2.4.1a" xref="S2.E1.m1.1.1.1.1.2.2.4.1.cmml">⁢</mo><mtext id="S2.E1.m1.1.1.1.1.2.2.4.4" xref="S2.E1.m1.1.1.1.1.2.2.4.4a.cmml">&nbsp;and&nbsp;</mtext><mo id="S2.E1.m1.1.1.1.1.2.2.4.1b" xref="S2.E1.m1.1.1.1.1.2.2.4.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.2.2.4.5" xref="S2.E1.m1.1.1.1.1.2.2.4.5.cmml">Q</mi></mrow><mo id="S2.E1.m1.1.1.1.1.2.2.5" xref="S2.E1.m1.1.1.1.1.2.2.5.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.2.2.6" xref="S2.E1.m1.1.1.1.1.2.2.6.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.6.2" xref="S2.E1.m1.1.1.1.1.2.2.6.2.cmml">X</mi><mo id="S2.E1.m1.1.1.1.1.2.2.6.1" xref="S2.E1.m1.1.1.1.1.2.2.6.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.2.2.6.3" xref="S2.E1.m1.1.1.1.1.2.2.6.3.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.6.3.2" xref="S2.E1.m1.1.1.1.1.2.2.6.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.1.1.2.2.6.3.3" xref="S2.E1.m1.1.1.1.1.2.2.6.3.3.cmml">Q</mi></msub></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3a.cmml" xref="S2.E1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"></eq><ci id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">𝐾</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3"><times id="S2.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.1"></times><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2">𝑋</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3">𝐾</ci></apply></apply></apply><apply id="S2.E1.m1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><and id="S2.E1.m1.1.1.1.1.2.2a.cmml" xref="S2.E1.m1.1.1.1.1.2.2"></and><apply id="S2.E1.m1.1.1.1.1.2.2b.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><eq id="S2.E1.m1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.3"></eq><apply id="S2.E1.m1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2"><times id="S2.E1.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.2.2a.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2"><mtext id="S2.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2">&nbsp;</mtext></ci><ci id="S2.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.3">𝑉</ci></apply><apply id="S2.E1.m1.1.1.1.1.2.2.4.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4"><times id="S2.E1.m1.1.1.1.1.2.2.4.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.4.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.2">𝑋</ci><apply id="S2.E1.m1.1.1.1.1.2.2.4.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.4.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.4.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.1.1.2.2.4.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3.3">𝑉</ci></apply><ci id="S2.E1.m1.1.1.1.1.2.2.4.4a.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.4"><mtext id="S2.E1.m1.1.1.1.1.2.2.4.4.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.4">&nbsp;and&nbsp;</mtext></ci><ci id="S2.E1.m1.1.1.1.1.2.2.4.5.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.5">𝑄</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.2.2c.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><eq id="S2.E1.m1.1.1.1.1.2.2.5.cmml" xref="S2.E1.m1.1.1.1.1.2.2.5"></eq><share href="#S2.E1.m1.1.1.1.1.2.2.4.cmml" id="S2.E1.m1.1.1.1.1.2.2d.cmml" xref="S2.E1.m1.1.1.1.1.2.2"></share><apply id="S2.E1.m1.1.1.1.1.2.2.6.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6"><times id="S2.E1.m1.1.1.1.1.2.2.6.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.6.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.2">𝑋</ci><apply id="S2.E1.m1.1.1.1.1.2.2.6.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.6.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.6.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.1.1.2.2.6.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3.3">𝑄</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">K=XW_{K},\text{ }V=XW_{V}\text{ and }Q=XW_{Q}.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">italic_K = italic_X italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_V = italic_X italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT and italic_Q = italic_X italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS1.p2.3">Here, <math alttext="W_{K}\in{\rm I\!R}^{d_{model}\times d_{key}},W_{V}\in{\rm I\!R}^{d_{model}% \times d_{value}}\text{ and }W_{Q}\in{\rm I\!R}^{d_{model}\times d_{key}}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p2.3.m1.2"><semantics id="S2.SS1.SSS1.p2.3.m1.2a"><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.3.cmml"><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2.cmml">W</mi><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2.cmml">m</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1a" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4.cmml">d</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1b" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1c" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2.cmml">k</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4.cmml">y</mi></mrow></msub></mrow></msup></mrow></mrow><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.3a.cmml">,</mo><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2.cmml">W</mi><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3.cmml">V</mi></msub><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2.cmml">m</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4.cmml">d</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1c" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1c" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml">⁢</mo><mtext id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4a.cmml">&nbsp;and&nbsp;</mtext><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2.cmml">W</mi><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3.cmml">Q</mi></msub></mrow><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1.cmml">⁢</mo><msup id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2" mathvariant="normal" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2.cmml">m</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3.cmml">o</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4.cmml">d</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1c" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2.cmml">k</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3.cmml">e</mi><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4.cmml">y</mi></mrow></msub></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p2.3.m1.2b"><apply id="S2.SS1.SSS1.p2.3.m1.2.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.3a.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1"><in id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1"></in><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2">𝑊</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2">I</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1"></times><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"><and id="S2.SS1.SSS1.p2.3.m1.2.2.2.2a.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"></and><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2b.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"><in id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3"></in><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2">𝑊</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3">𝑉</ci></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2">I</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2">R</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1"></times><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4a.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4"><mtext id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4">&nbsp;and&nbsp;</mtext></ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2">𝑊</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3">𝑄</ci></apply></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2c.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"><in id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5"></in><share href="#S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.cmml" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2d.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"></share><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2">I</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2">R</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1"></times><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p2.3.m1.2c">W_{K}\in{\rm I\!R}^{d_{model}\times d_{key}},W_{V}\in{\rm I\!R}^{d_{model}% \times d_{value}}\text{ and }W_{Q}\in{\rm I\!R}^{d_{model}\times d_{key}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p2.3.m1.2d">italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT and italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are trainable projection matrices. Then, the attention context is calculated as a weighted average of all other values as</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A_{dot}=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{model}}}\right)V." class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><msub id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml"><mi id="S2.E2.m1.2.2.1.1.2.2" xref="S2.E2.m1.2.2.1.1.2.2.cmml">A</mi><mrow id="S2.E2.m1.2.2.1.1.2.3" xref="S2.E2.m1.2.2.1.1.2.3.cmml"><mi id="S2.E2.m1.2.2.1.1.2.3.2" xref="S2.E2.m1.2.2.1.1.2.3.2.cmml">d</mi><mo id="S2.E2.m1.2.2.1.1.2.3.1" xref="S2.E2.m1.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.2.3.3" xref="S2.E2.m1.2.2.1.1.2.3.3.cmml">o</mi><mo id="S2.E2.m1.2.2.1.1.2.3.1a" xref="S2.E2.m1.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.2.3.4" xref="S2.E2.m1.2.2.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml"><mtext id="S2.E2.m1.2.2.1.1.3.2" xref="S2.E2.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo id="S2.E2.m1.2.2.1.1.3.1" xref="S2.E2.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.3.3.2" xref="S2.E2.m1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.3.3.2.1" xref="S2.E2.m1.1.1.cmml">(</mo><mfrac id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mrow id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">Q</mi><mo id="S2.E2.m1.1.1.2.1" xref="S2.E2.m1.1.1.2.1.cmml">⁢</mo><msup id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml"><mi id="S2.E2.m1.1.1.2.3.2" xref="S2.E2.m1.1.1.2.3.2.cmml">K</mi><mi id="S2.E2.m1.1.1.2.3.3" xref="S2.E2.m1.1.1.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><msub id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2.cmml">d</mi><mrow id="S2.E2.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.3.2.3.cmml"><mi id="S2.E2.m1.1.1.3.2.3.2" xref="S2.E2.m1.1.1.3.2.3.2.cmml">m</mi><mo id="S2.E2.m1.1.1.3.2.3.1" xref="S2.E2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.3" xref="S2.E2.m1.1.1.3.2.3.3.cmml">o</mi><mo id="S2.E2.m1.1.1.3.2.3.1a" xref="S2.E2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.4" xref="S2.E2.m1.1.1.3.2.3.4.cmml">d</mi><mo id="S2.E2.m1.1.1.3.2.3.1b" xref="S2.E2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.5" xref="S2.E2.m1.1.1.3.2.3.5.cmml">e</mi><mo id="S2.E2.m1.1.1.3.2.3.1c" xref="S2.E2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.3.2.3.6" xref="S2.E2.m1.1.1.3.2.3.6.cmml">l</mi></mrow></msub></msqrt></mfrac><mo id="S2.E2.m1.2.2.1.1.3.3.2.2" xref="S2.E2.m1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.2.2.1.1.3.1a" xref="S2.E2.m1.2.2.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.3.4" xref="S2.E2.m1.2.2.1.1.3.4.cmml">V</mi></mrow></mrow><mo id="S2.E2.m1.2.2.1.2" lspace="0em" xref="S2.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><eq id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"></eq><apply id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2">𝐴</ci><apply id="S2.E2.m1.2.2.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.3"><times id="S2.E2.m1.2.2.1.1.2.3.1.cmml" xref="S2.E2.m1.2.2.1.1.2.3.1"></times><ci id="S2.E2.m1.2.2.1.1.2.3.2.cmml" xref="S2.E2.m1.2.2.1.1.2.3.2">𝑑</ci><ci id="S2.E2.m1.2.2.1.1.2.3.3.cmml" xref="S2.E2.m1.2.2.1.1.2.3.3">𝑜</ci><ci id="S2.E2.m1.2.2.1.1.2.3.4.cmml" xref="S2.E2.m1.2.2.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"><times id="S2.E2.m1.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.3.1"></times><ci id="S2.E2.m1.2.2.1.1.3.2a.cmml" xref="S2.E2.m1.2.2.1.1.3.2"><mtext id="S2.E2.m1.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.3.3.2"><divide id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.3.3.2"></divide><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"><times id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.2.1"></times><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">𝑄</ci><apply id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.2.3">superscript</csymbol><ci id="S2.E2.m1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.2.3.2">𝐾</ci><ci id="S2.E2.m1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><root id="S2.E2.m1.1.1.3a.cmml" xref="S2.E2.m1.1.1.3"></root><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2">𝑑</ci><apply id="S2.E2.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3"><times id="S2.E2.m1.1.1.3.2.3.1.cmml" xref="S2.E2.m1.1.1.3.2.3.1"></times><ci id="S2.E2.m1.1.1.3.2.3.2.cmml" xref="S2.E2.m1.1.1.3.2.3.2">𝑚</ci><ci id="S2.E2.m1.1.1.3.2.3.3.cmml" xref="S2.E2.m1.1.1.3.2.3.3">𝑜</ci><ci id="S2.E2.m1.1.1.3.2.3.4.cmml" xref="S2.E2.m1.1.1.3.2.3.4">𝑑</ci><ci id="S2.E2.m1.1.1.3.2.3.5.cmml" xref="S2.E2.m1.1.1.3.2.3.5">𝑒</ci><ci id="S2.E2.m1.1.1.3.2.3.6.cmml" xref="S2.E2.m1.1.1.3.2.3.6">𝑙</ci></apply></apply></apply></apply><ci id="S2.E2.m1.2.2.1.1.3.4.cmml" xref="S2.E2.m1.2.2.1.1.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">A_{dot}=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{model}}}\right)V.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">italic_A start_POSTSUBSCRIPT italic_d italic_o italic_t end_POSTSUBSCRIPT = softmax ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS1.p3">
<p class="ltx_p" id="S2.SS1.SSS1.p3.1">MHA의 경우 각 시퀀스 요소에 대한 <math alttext="H" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p3.1.m1.1"><semantics id="S2.SS1.SSS1.p3.1.m1.1a"><mi id="S2.SS1.SSS1.p3.1.m1.1.1" xref="S2.SS1.SSS1.p3.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p3.1.m1.1b"><ci id="S2.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p3.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p3.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p3.1.m1.1d">italic_H</annotation></semantics></math> 어텐션 컨텍스트 벡터의 수를 병렬로 계산하고 두 번째 차원을 따라 연결한 다음 마지막으로 연결된 벡터를 모델 공간에 투영하여 어텐션 출력을 얻는다.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.2 </span>Compressive Memory</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p1">
<p class="ltx_p" id="S2.SS1.SSS2.p1.3">Infini-attention에서는 압축 메모리를 위한 새로운 메모리 엔트리를 계산하는 대신 dot-product 어텐션 계산에서 질의, 키 및 값 상태(<math alttext="Q" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.1.m1.1"><semantics id="S2.SS1.SSS2.p1.1.m1.1a"><mi id="S2.SS1.SSS2.p1.1.m1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.1.m1.1b"><ci id="S2.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.1.m1.1d">italic_Q</annotation></semantics></math>, <math alttext="K" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.2.m2.1"><semantics id="S2.SS1.SSS2.p1.2.m2.1a"><mi id="S2.SS1.SSS2.p1.2.m2.1.1" xref="S2.SS1.SSS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.2.m2.1b"><ci id="S2.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.2.m2.1d">italic_K</annotation></semantics></math> 및 <math alttext="V" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.3.m3.1"><semantics id="S2.SS1.SSS2.p1.3.m3.1a"><mi id="S2.SS1.SSS2.p1.3.m3.1.1" xref="S2.SS1.SSS2.p1.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.3.m3.1b"><ci id="S2.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.3.m3.1d">italic_V</annotation></semantics></math>)를 재사용한다. 도트-프로덕트 어텐션과 압축 메모리 사이의 상태 공유 및 재사용은 효율적인 플러그인-플레이 롱-컨텍스트 적응을 가능하게 할 뿐만 아니라 트레이닝 및 추론 속도를 빠르게 한다. <cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>)</cite> 이전 작업과 유사하게, 우리의 목표는 키 및 값 상태의 바인딩을 압축 메모리에 저장하고 쿼리 벡터를 사용하여 검색하는 것이다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p2">
<p class="ltx_p" id="S2.SS1.SSS2.p2.1">문헌 <cite class="ltx_cite ltx_citemacro_citep">(Hopfield, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib23" title="">1982</a>; Kanerva, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib24" title="">1988</a>; Schlag et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib44" title="">2019</a>; Munkhdalai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>)</cite>에 제안된 압축 메모리는 단순성과 계산 효율성을 위해 다양한 형태가 있지만, 본 연구에서는 메모리를 연관 행렬 <cite class="ltx_cite ltx_citemacro_citep">(Schlag et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib45" title="">2020</a>)</cite>로 매개화한다. 이 방법은 메모리 갱신 및 검색 과정을 선형 주의 메커니즘<cite class="ltx_cite ltx_citemacro_citep">(Shen et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib49" title="">2018</a>)</cite>로 캐스팅하고 관련 방법들로부터 안정적인 훈련 기법을 활용할 수 있게 한다. 특히, <cite class="ltx_cite ltx_citemacro_citet">Katharopoulos et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib25" title="">2020</a>)</cite>에 의한 갱신 규칙과 검색 메커니즘은 주로 단순성과 경쟁적인 성능 때문에 채택되었다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p3">
<p class="ltx_p" id="S2.SS1.SSS2.p3.3"><span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p3.3.1">Memory retrieval.</span> In Infini-attention, we retrieve new content <math alttext="A_{mem}\in{\rm I\!R}^{N\times d_{value}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p3.1.m1.1"><semantics id="S2.SS1.SSS2.p3.1.m1.1a"><mrow id="S2.SS1.SSS2.p3.1.m1.1.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.cmml"><msub id="S2.SS1.SSS2.p3.1.m1.1.1.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.2.cmml">A</mi><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.2.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2.cmml">m</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1a" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S2.SS1.SSS2.p3.1.m1.1.1.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p3.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p3.1.m1.1b"><apply id="S2.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1"><in id="S2.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.1"></in><apply id="S2.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.2">𝐴</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4">𝑚</ci></apply></apply><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p3.1.m1.1c">A_{mem}\in{\rm I\!R}^{N\times d_{value}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p3.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_m italic_e italic_m end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> from the memory <math alttext="M_{s-1}\in{\rm I\!R}^{d_{key}\times d_{value}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p3.2.m2.1"><semantics id="S2.SS1.SSS2.p3.2.m2.1a"><mrow id="S2.SS1.SSS2.p3.2.m2.1.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.cmml"><msub id="S2.SS1.SSS2.p3.2.m2.1.1.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.2.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.2.cmml">M</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.2.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2.cmml">s</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.SSS2.p3.2.m2.1.1.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p3.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.cmml"><msub id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2.cmml">k</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1a" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p3.2.m2.1b"><apply id="S2.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1"><in id="S2.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.1"></in><apply id="S2.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.2.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.2.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.2">𝑀</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3"><minus id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1"></minus><ci id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2">𝑠</ci><cn id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1"></times><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1"></times><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2">𝑘</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4">𝑦</ci></apply></apply><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p3.2.m2.1c">M_{s-1}\in{\rm I\!R}^{d_{key}\times d_{value}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p3.2.m2.1d">italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> by using the query <math alttext="Q\in{\rm I\!R}^{N\times d_{key}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p3.3.m3.1"><semantics id="S2.SS1.SSS2.p3.3.m3.1a"><mrow id="S2.SS1.SSS2.p3.3.m3.1.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.2.cmml">Q</mi><mo id="S2.SS1.SSS2.p3.3.m3.1.1.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p3.3.m3.1.1.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p3.3.m3.1.1.3.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p3.3.m3.1.1.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2.cmml">k</mi><mo id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4.cmml">y</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p3.3.m3.1b"><apply id="S2.SS1.SSS2.p3.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1"><in id="S2.SS1.SSS2.p3.3.m3.1.1.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.1"></in><ci id="S2.SS1.SSS2.p3.3.m3.1.1.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.2">𝑄</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3"><times id="S2.SS1.SSS2.p3.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.1"></times><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3"><times id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p3.3.m3.1c">Q\in{\rm I\!R}^{N\times d_{key}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p3.3.m3.1d">italic_Q ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A_{mem}=\frac{\sigma({Q})M_{s-1}}{{\sigma(Q)}z_{s-1}}." class="ltx_Math" display="block" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><msub id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2" xref="S2.E3.m1.3.3.1.1.2.2.cmml">A</mi><mrow id="S2.E3.m1.3.3.1.1.2.3" xref="S2.E3.m1.3.3.1.1.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.2.3.2" xref="S2.E3.m1.3.3.1.1.2.3.2.cmml">m</mi><mo id="S2.E3.m1.3.3.1.1.2.3.1" xref="S2.E3.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.3.3.1.1.2.3.3" xref="S2.E3.m1.3.3.1.1.2.3.3.cmml">e</mi><mo id="S2.E3.m1.3.3.1.1.2.3.1a" xref="S2.E3.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.3.3.1.1.2.3.4" xref="S2.E3.m1.3.3.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3.cmml">σ</mi><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.4.2" xref="S2.E3.m1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.4.2.1" stretchy="false" xref="S2.E3.m1.1.1.1.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">Q</mi><mo id="S2.E3.m1.1.1.1.4.2.2" stretchy="false" xref="S2.E3.m1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.1.1.1.2a" xref="S2.E3.m1.1.1.1.2.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.5" xref="S2.E3.m1.1.1.1.5.cmml"><mi id="S2.E3.m1.1.1.1.5.2" xref="S2.E3.m1.1.1.1.5.2.cmml">M</mi><mrow id="S2.E3.m1.1.1.1.5.3" xref="S2.E3.m1.1.1.1.5.3.cmml"><mi id="S2.E3.m1.1.1.1.5.3.2" xref="S2.E3.m1.1.1.1.5.3.2.cmml">s</mi><mo id="S2.E3.m1.1.1.1.5.3.1" xref="S2.E3.m1.1.1.1.5.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.5.3.3" xref="S2.E3.m1.1.1.1.5.3.3.cmml">1</mn></mrow></msub></mrow><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mi id="S2.E3.m1.2.2.2.3" xref="S2.E3.m1.2.2.2.3.cmml">σ</mi><mo id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.2.4.2" xref="S2.E3.m1.2.2.2.cmml"><mo id="S2.E3.m1.2.2.2.4.2.1" stretchy="false" xref="S2.E3.m1.2.2.2.cmml">(</mo><mi id="S2.E3.m1.2.2.2.1" xref="S2.E3.m1.2.2.2.1.cmml">Q</mi><mo id="S2.E3.m1.2.2.2.4.2.2" stretchy="false" xref="S2.E3.m1.2.2.2.cmml">)</mo></mrow><mo id="S2.E3.m1.2.2.2.2a" xref="S2.E3.m1.2.2.2.2.cmml">⁢</mo><msub id="S2.E3.m1.2.2.2.5" xref="S2.E3.m1.2.2.2.5.cmml"><mi id="S2.E3.m1.2.2.2.5.2" xref="S2.E3.m1.2.2.2.5.2.cmml">z</mi><mrow id="S2.E3.m1.2.2.2.5.3" xref="S2.E3.m1.2.2.2.5.3.cmml"><mi id="S2.E3.m1.2.2.2.5.3.2" xref="S2.E3.m1.2.2.2.5.3.2.cmml">s</mi><mo id="S2.E3.m1.2.2.2.5.3.1" xref="S2.E3.m1.2.2.2.5.3.1.cmml">−</mo><mn id="S2.E3.m1.2.2.2.5.3.3" xref="S2.E3.m1.2.2.2.5.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mrow><mo id="S2.E3.m1.3.3.1.2" lspace="0em" xref="S2.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><eq id="S2.E3.m1.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1"></eq><apply id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2">𝐴</ci><apply id="S2.E3.m1.3.3.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3"><times id="S2.E3.m1.3.3.1.1.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.3.1"></times><ci id="S2.E3.m1.3.3.1.1.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.3.2">𝑚</ci><ci id="S2.E3.m1.3.3.1.1.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3.3">𝑒</ci><ci id="S2.E3.m1.3.3.1.1.2.3.4.cmml" xref="S2.E3.m1.3.3.1.1.2.3.4">𝑚</ci></apply></apply><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><divide id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2"></divide><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><times id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3">𝜎</ci><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑄</ci><apply id="S2.E3.m1.1.1.1.5.cmml" xref="S2.E3.m1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.5.1.cmml" xref="S2.E3.m1.1.1.1.5">subscript</csymbol><ci id="S2.E3.m1.1.1.1.5.2.cmml" xref="S2.E3.m1.1.1.1.5.2">𝑀</ci><apply id="S2.E3.m1.1.1.1.5.3.cmml" xref="S2.E3.m1.1.1.1.5.3"><minus id="S2.E3.m1.1.1.1.5.3.1.cmml" xref="S2.E3.m1.1.1.1.5.3.1"></minus><ci id="S2.E3.m1.1.1.1.5.3.2.cmml" xref="S2.E3.m1.1.1.1.5.3.2">𝑠</ci><cn id="S2.E3.m1.1.1.1.5.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.5.3.3">1</cn></apply></apply></apply><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><times id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"></times><ci id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.3">𝜎</ci><ci id="S2.E3.m1.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.1">𝑄</ci><apply id="S2.E3.m1.2.2.2.5.cmml" xref="S2.E3.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.5.1.cmml" xref="S2.E3.m1.2.2.2.5">subscript</csymbol><ci id="S2.E3.m1.2.2.2.5.2.cmml" xref="S2.E3.m1.2.2.2.5.2">𝑧</ci><apply id="S2.E3.m1.2.2.2.5.3.cmml" xref="S2.E3.m1.2.2.2.5.3"><minus id="S2.E3.m1.2.2.2.5.3.1.cmml" xref="S2.E3.m1.2.2.2.5.3.1"></minus><ci id="S2.E3.m1.2.2.2.5.3.2.cmml" xref="S2.E3.m1.2.2.2.5.3.2">𝑠</ci><cn id="S2.E3.m1.2.2.2.5.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.2.5.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">A_{mem}=\frac{\sigma({Q})M_{s-1}}{{\sigma(Q)}z_{s-1}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">italic_A start_POSTSUBSCRIPT italic_m italic_e italic_m end_POSTSUBSCRIPT = divide start_ARG italic_σ ( italic_Q ) italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT end_ARG start_ARG italic_σ ( italic_Q ) italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p4">
<p class="ltx_p" id="S2.SS1.SSS2.p4.3">여기서, <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p4.1.m1.1"><semantics id="S2.SS1.SSS2.p4.1.m1.1a"><mi id="S2.SS1.SSS2.p4.1.m1.1.1" xref="S2.SS1.SSS2.p4.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p4.1.m1.1b"><ci id="S2.SS1.SSS2.p4.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p4.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p4.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p4.1.m1.1d">italic_σ</annotation></semantics></math> 및 <math alttext="z_{s-1}\in{\rm I\!R}^{d_{key}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p4.2.m2.1"><semantics id="S2.SS1.SSS2.p4.2.m2.1a"><mrow id="S2.SS1.SSS2.p4.2.m2.1.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.cmml"><msub id="S2.SS1.SSS2.p4.2.m2.1.1.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.2.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.2.cmml">z</mi><mrow id="S2.SS1.SSS2.p4.2.m2.1.1.2.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2.cmml">s</mi><mo id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.SSS2.p4.2.m2.1.1.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p4.2.m2.1.1.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p4.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p4.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2.cmml">R</mi><msub id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2.cmml">k</mi><mo id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1a" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4.cmml">y</mi></mrow></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p4.2.m2.1b"><apply id="S2.SS1.SSS2.p4.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1"><in id="S2.SS1.SSS2.p4.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.1"></in><apply id="S2.SS1.SSS2.p4.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.2.m2.1.1.2.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p4.2.m2.1.1.2.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.2">𝑧</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3"><minus id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1"></minus><ci id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2">𝑠</ci><cn id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3"><times id="S2.SS1.SSS2.p4.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3"><times id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p4.2.m2.1c">z_{s-1}\in{\rm I\!R}^{d_{key}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p4.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>는 각각 비선형 활성화 함수 및 정규화 용어이다. 비선형성과 규범 방법의 선택이 훈련 안정성에 결정적이기 때문에 <cite class="ltx_cite ltx_citemacro_citet">Katharopoulos et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib25" title="">2020</a>)</cite>에 이어 정규화 용어 <math alttext="z_{s-1}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p4.3.m3.1"><semantics id="S2.SS1.SSS2.p4.3.m3.1a"><msub id="S2.SS1.SSS2.p4.3.m3.1.1" xref="S2.SS1.SSS2.p4.3.m3.1.1.cmml"><mi id="S2.SS1.SSS2.p4.3.m3.1.1.2" xref="S2.SS1.SSS2.p4.3.m3.1.1.2.cmml">z</mi><mrow id="S2.SS1.SSS2.p4.3.m3.1.1.3" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.cmml"><mi id="S2.SS1.SSS2.p4.3.m3.1.1.3.2" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.2.cmml">s</mi><mo id="S2.SS1.SSS2.p4.3.m3.1.1.3.1" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.1.cmml">−</mo><mn id="S2.SS1.SSS2.p4.3.m3.1.1.3.3" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p4.3.m3.1b"><apply id="S2.SS1.SSS2.p4.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.3.m3.1.1.1.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p4.3.m3.1.1.2.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.2">𝑧</ci><apply id="S2.SS1.SSS2.p4.3.m3.1.1.3.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3"><minus id="S2.SS1.SSS2.p4.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.1"></minus><ci id="S2.SS1.SSS2.p4.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.2">𝑠</ci><cn id="S2.SS1.SSS2.p4.3.m3.1.1.3.3.cmml" type="integer" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p4.3.m3.1c">z_{s-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p4.3.m3.1d">italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT</annotation></semantics></math>로 모든 키에 대한 합을 기록하고 활성화 함수 <cite class="ltx_cite ltx_citemacro_citep">(Clevert et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib13" title="">2015</a>)</cite>로 요소별 ELU + 1을 사용한다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p5">
<p class="ltx_p" id="S2.SS1.SSS2.p5.5"><span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p5.5.1">Memory update. </span> 일단 검색이 완료되면, 우리는 새로운 KV 엔트리로 메모리 및 정규화 용어를 업데이트하고 다음 상태를 다음과 같이 얻는다.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}V\text{ and }z_{s}\leftarrow z_{s-1}+\sum%
_{t=1}^{N}\sigma(K_{t})." class="ltx_Math" display="block" id="S2.E4.m1.2"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.3" xref="S2.E4.m1.2.2.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.3.2" xref="S2.E4.m1.2.2.1.1.3.2.cmml">M</mi><mi id="S2.E4.m1.2.2.1.1.3.3" xref="S2.E4.m1.2.2.1.1.3.3.cmml">s</mi></msub><mo id="S2.E4.m1.2.2.1.1.4" stretchy="false" xref="S2.E4.m1.2.2.1.1.4.cmml">←</mo><mrow id="S2.E4.m1.2.2.1.1.5" xref="S2.E4.m1.2.2.1.1.5.cmml"><msub id="S2.E4.m1.2.2.1.1.5.2" xref="S2.E4.m1.2.2.1.1.5.2.cmml"><mi id="S2.E4.m1.2.2.1.1.5.2.2" xref="S2.E4.m1.2.2.1.1.5.2.2.cmml">M</mi><mrow id="S2.E4.m1.2.2.1.1.5.2.3" xref="S2.E4.m1.2.2.1.1.5.2.3.cmml"><mi id="S2.E4.m1.2.2.1.1.5.2.3.2" xref="S2.E4.m1.2.2.1.1.5.2.3.2.cmml">s</mi><mo id="S2.E4.m1.2.2.1.1.5.2.3.1" xref="S2.E4.m1.2.2.1.1.5.2.3.1.cmml">−</mo><mn id="S2.E4.m1.2.2.1.1.5.2.3.3" xref="S2.E4.m1.2.2.1.1.5.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E4.m1.2.2.1.1.5.1" xref="S2.E4.m1.2.2.1.1.5.1.cmml">+</mo><mrow id="S2.E4.m1.2.2.1.1.5.3" xref="S2.E4.m1.2.2.1.1.5.3.cmml"><mi id="S2.E4.m1.2.2.1.1.5.3.2" xref="S2.E4.m1.2.2.1.1.5.3.2.cmml">σ</mi><mo id="S2.E4.m1.2.2.1.1.5.3.1" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">⁢</mo><msup id="S2.E4.m1.2.2.1.1.5.3.3" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml"><mrow id="S2.E4.m1.2.2.1.1.5.3.3.2.2" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml"><mo id="S2.E4.m1.2.2.1.1.5.3.3.2.2.1" stretchy="false" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">K</mi><mo id="S2.E4.m1.2.2.1.1.5.3.3.2.2.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml">)</mo></mrow><mi id="S2.E4.m1.2.2.1.1.5.3.3.3" xref="S2.E4.m1.2.2.1.1.5.3.3.3.cmml">T</mi></msup><mo id="S2.E4.m1.2.2.1.1.5.3.1a" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">⁢</mo><mi id="S2.E4.m1.2.2.1.1.5.3.4" xref="S2.E4.m1.2.2.1.1.5.3.4.cmml">V</mi><mo id="S2.E4.m1.2.2.1.1.5.3.1b" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">⁢</mo><mtext id="S2.E4.m1.2.2.1.1.5.3.5" xref="S2.E4.m1.2.2.1.1.5.3.5a.cmml">&nbsp;and&nbsp;</mtext><mo id="S2.E4.m1.2.2.1.1.5.3.1c" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">⁢</mo><msub id="S2.E4.m1.2.2.1.1.5.3.6" xref="S2.E4.m1.2.2.1.1.5.3.6.cmml"><mi id="S2.E4.m1.2.2.1.1.5.3.6.2" xref="S2.E4.m1.2.2.1.1.5.3.6.2.cmml">z</mi><mi id="S2.E4.m1.2.2.1.1.5.3.6.3" xref="S2.E4.m1.2.2.1.1.5.3.6.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.6" stretchy="false" xref="S2.E4.m1.2.2.1.1.6.cmml">←</mo><mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.1.3.2.cmml">z</mi><mrow id="S2.E4.m1.2.2.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.1.3.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.3.3.2" xref="S2.E4.m1.2.2.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E4.m1.2.2.1.1.1.3.3.1" xref="S2.E4.m1.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E4.m1.2.2.1.1.1.3.3.3" xref="S2.E4.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E4.m1.2.2.1.1.1.2" rspace="0.055em" xref="S2.E4.m1.2.2.1.1.1.2.cmml">+</mo><mrow id="S2.E4.m1.2.2.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.cmml"><munderover id="S2.E4.m1.2.2.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E4.m1.2.2.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.2.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.2.2.3.2" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S2.E4.m1.2.2.1.1.1.1.2.2.3.1" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E4.m1.2.2.1.1.1.1.2.2.3.3" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E4.m1.2.2.1.1.1.1.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E4.m1.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.3.cmml">σ</mi><mo id="S2.E4.m1.2.2.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">K</mi><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" lspace="0em" xref="S2.E4.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><and id="S2.E4.m1.2.2.1.1a.cmml" xref="S2.E4.m1.2.2.1"></and><apply id="S2.E4.m1.2.2.1.1b.cmml" xref="S2.E4.m1.2.2.1"><ci id="S2.E4.m1.2.2.1.1.4.cmml" xref="S2.E4.m1.2.2.1.1.4">←</ci><apply id="S2.E4.m1.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2">𝑀</ci><ci id="S2.E4.m1.2.2.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.3.3">𝑠</ci></apply><apply id="S2.E4.m1.2.2.1.1.5.cmml" xref="S2.E4.m1.2.2.1.1.5"><plus id="S2.E4.m1.2.2.1.1.5.1.cmml" xref="S2.E4.m1.2.2.1.1.5.1"></plus><apply id="S2.E4.m1.2.2.1.1.5.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.2.1.cmml" xref="S2.E4.m1.2.2.1.1.5.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.5.2.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2.2">𝑀</ci><apply id="S2.E4.m1.2.2.1.1.5.2.3.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3"><minus id="S2.E4.m1.2.2.1.1.5.2.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3.1"></minus><ci id="S2.E4.m1.2.2.1.1.5.2.3.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3.2">𝑠</ci><cn id="S2.E4.m1.2.2.1.1.5.2.3.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.5.2.3.3">1</cn></apply></apply><apply id="S2.E4.m1.2.2.1.1.5.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3"><times id="S2.E4.m1.2.2.1.1.5.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.3.1"></times><ci id="S2.E4.m1.2.2.1.1.5.3.2.cmml" xref="S2.E4.m1.2.2.1.1.5.3.2">𝜎</ci><apply id="S2.E4.m1.2.2.1.1.5.3.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.3.3">superscript</csymbol><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝐾</ci><ci id="S2.E4.m1.2.2.1.1.5.3.3.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3.3.3">𝑇</ci></apply><ci id="S2.E4.m1.2.2.1.1.5.3.4.cmml" xref="S2.E4.m1.2.2.1.1.5.3.4">𝑉</ci><ci id="S2.E4.m1.2.2.1.1.5.3.5a.cmml" xref="S2.E4.m1.2.2.1.1.5.3.5"><mtext id="S2.E4.m1.2.2.1.1.5.3.5.cmml" xref="S2.E4.m1.2.2.1.1.5.3.5">&nbsp;and&nbsp;</mtext></ci><apply id="S2.E4.m1.2.2.1.1.5.3.6.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.3.6.1.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.5.3.6.2.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6.2">𝑧</ci><ci id="S2.E4.m1.2.2.1.1.5.3.6.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6.3">𝑠</ci></apply></apply></apply></apply><apply id="S2.E4.m1.2.2.1.1c.cmml" xref="S2.E4.m1.2.2.1"><ci id="S2.E4.m1.2.2.1.1.6.cmml" xref="S2.E4.m1.2.2.1.1.6">←</ci><share href="#S2.E4.m1.2.2.1.1.5.cmml" id="S2.E4.m1.2.2.1.1d.cmml" xref="S2.E4.m1.2.2.1"></share><apply id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"><plus id="S2.E4.m1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2"></plus><apply id="S2.E4.m1.2.2.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.3.2">𝑧</ci><apply id="S2.E4.m1.2.2.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3"><minus id="S2.E4.m1.2.2.1.1.1.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3.1"></minus><ci id="S2.E4.m1.2.2.1.1.1.3.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3.2">𝑠</ci><cn id="S2.E4.m1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.E4.m1.2.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1"><apply id="S2.E4.m1.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E4.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S2.E4.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S2.E4.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3"><eq id="S2.E4.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S2.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S2.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.2"></times><ci id="S2.E4.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.3">𝜎</ci><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2">𝐾</ci><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}V\text{ and }z_{s}\leftarrow z_{s-1}+\sum%
_{t=1}^{N}\sigma(K_{t}).</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.2d">italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT + italic_σ ( italic_K ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_V and italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_σ ( italic_K start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS2.p5.4">새로운 메모리 상태들 <math alttext="M_{s}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p5.1.m1.1"><semantics id="S2.SS1.SSS2.p5.1.m1.1a"><msub id="S2.SS1.SSS2.p5.1.m1.1.1" xref="S2.SS1.SSS2.p5.1.m1.1.1.cmml"><mi id="S2.SS1.SSS2.p5.1.m1.1.1.2" xref="S2.SS1.SSS2.p5.1.m1.1.1.2.cmml">M</mi><mi id="S2.SS1.SSS2.p5.1.m1.1.1.3" xref="S2.SS1.SSS2.p5.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.1.m1.1b"><apply id="S2.SS1.SSS2.p5.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p5.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p5.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1.2">𝑀</ci><ci id="S2.SS1.SSS2.p5.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.1.m1.1c">M_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p5.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> 및 <math alttext="z_{s}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p5.2.m2.1"><semantics id="S2.SS1.SSS2.p5.2.m2.1a"><msub id="S2.SS1.SSS2.p5.2.m2.1.1" xref="S2.SS1.SSS2.p5.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p5.2.m2.1.1.2" xref="S2.SS1.SSS2.p5.2.m2.1.1.2.cmml">z</mi><mi id="S2.SS1.SSS2.p5.2.m2.1.1.3" xref="S2.SS1.SSS2.p5.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.2.m2.1b"><apply id="S2.SS1.SSS2.p5.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p5.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p5.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1.2">𝑧</ci><ci id="S2.SS1.SSS2.p5.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.2.m2.1c">z_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p5.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>는 그 다음 세그먼트 <math alttext="S+1" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p5.3.m3.1"><semantics id="S2.SS1.SSS2.p5.3.m3.1a"><mrow id="S2.SS1.SSS2.p5.3.m3.1.1" xref="S2.SS1.SSS2.p5.3.m3.1.1.cmml"><mi id="S2.SS1.SSS2.p5.3.m3.1.1.2" xref="S2.SS1.SSS2.p5.3.m3.1.1.2.cmml">S</mi><mo id="S2.SS1.SSS2.p5.3.m3.1.1.1" xref="S2.SS1.SSS2.p5.3.m3.1.1.1.cmml">+</mo><mn id="S2.SS1.SSS2.p5.3.m3.1.1.3" xref="S2.SS1.SSS2.p5.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.3.m3.1b"><apply id="S2.SS1.SSS2.p5.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1"><plus id="S2.SS1.SSS2.p5.3.m3.1.1.1.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1.1"></plus><ci id="S2.SS1.SSS2.p5.3.m3.1.1.2.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1.2">𝑆</ci><cn id="S2.SS1.SSS2.p5.3.m3.1.1.3.cmml" type="integer" xref="S2.SS1.SSS2.p5.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.3.m3.1c">S+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p5.3.m3.1d">italic_S + 1</annotation></semantics></math>로 전달되어 각 어텐션 레이어에서 재발로 구축된다. 식 중 우측 용어 <math alttext="\sigma(K)^{T}V" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p5.4.m4.1"><semantics id="S2.SS1.SSS2.p5.4.m4.1a"><mrow id="S2.SS1.SSS2.p5.4.m4.1.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.cmml"><mi id="S2.SS1.SSS2.p5.4.m4.1.2.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.2.cmml">σ</mi><mo id="S2.SS1.SSS2.p5.4.m4.1.2.1" xref="S2.SS1.SSS2.p5.4.m4.1.2.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p5.4.m4.1.2.3" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml"><mrow id="S2.SS1.SSS2.p5.4.m4.1.2.3.2.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml"><mo id="S2.SS1.SSS2.p5.4.m4.1.2.3.2.2.1" stretchy="false" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml">(</mo><mi id="S2.SS1.SSS2.p5.4.m4.1.1" xref="S2.SS1.SSS2.p5.4.m4.1.1.cmml">K</mi><mo id="S2.SS1.SSS2.p5.4.m4.1.2.3.2.2.2" stretchy="false" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml">)</mo></mrow><mi id="S2.SS1.SSS2.p5.4.m4.1.2.3.3" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.3.cmml">T</mi></msup><mo id="S2.SS1.SSS2.p5.4.m4.1.2.1a" xref="S2.SS1.SSS2.p5.4.m4.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p5.4.m4.1.2.4" xref="S2.SS1.SSS2.p5.4.m4.1.2.4.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.4.m4.1b"><apply id="S2.SS1.SSS2.p5.4.m4.1.2.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2"><times id="S2.SS1.SSS2.p5.4.m4.1.2.1.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.1"></times><ci id="S2.SS1.SSS2.p5.4.m4.1.2.2.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.2">𝜎</ci><apply id="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p5.4.m4.1.2.3.1.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.3">superscript</csymbol><ci id="S2.SS1.SSS2.p5.4.m4.1.1.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.1">𝐾</ci><ci id="S2.SS1.SSS2.p5.4.m4.1.2.3.3.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.3">𝑇</ci></apply><ci id="S2.SS1.SSS2.p5.4.m4.1.2.4.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.4">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.4.m4.1c">\sigma(K)^{T}V</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p5.4.m4.1d">italic_σ ( italic_K ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_V</annotation></semantics></math> (<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.E4" title="4 ‣ 2.1.2 Compressive Memory ‣ 2.1 Infini-attention ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">4</span></a>)는 associative binding operator로 알려진 <cite class="ltx_cite ltx_citemacro_citep">(Smolensky, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib50" title="">1990</a>; Hebb, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib21" title="">2005</a>; Schlag et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib45" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p6">
<p class="ltx_p" id="S2.SS1.SSS2.p6.1">델타 규칙 <cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>; Schlag et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib45" title="">2020</a>; <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib46" title="">2021</a>)</cite>의 성공에 영감을 받아 인피니 주의에도 통합했습니다. 델타 규칙은 연관 바인딩들을 새로운 업데이트로서 적용하기 전에 먼저 기존의 값 엔트리들을 검색하고 새로운 값들로부터 그것들을 빼냄으로써 약간 개선된 메모리 업데이트를 시도한다.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}(V-\frac{\sigma({K})M_{s-1}}{{\sigma(K)}z%
_{s-1}})." class="ltx_Math" display="block" id="S2.E5.m1.4"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4.4.1" xref="S2.E5.m1.4.4.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1" xref="S2.E5.m1.4.4.1.1.cmml"><msub id="S2.E5.m1.4.4.1.1.3" xref="S2.E5.m1.4.4.1.1.3.cmml"><mi id="S2.E5.m1.4.4.1.1.3.2" xref="S2.E5.m1.4.4.1.1.3.2.cmml">M</mi><mi id="S2.E5.m1.4.4.1.1.3.3" xref="S2.E5.m1.4.4.1.1.3.3.cmml">s</mi></msub><mo id="S2.E5.m1.4.4.1.1.2" stretchy="false" xref="S2.E5.m1.4.4.1.1.2.cmml">←</mo><mrow id="S2.E5.m1.4.4.1.1.1" xref="S2.E5.m1.4.4.1.1.1.cmml"><msub id="S2.E5.m1.4.4.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.3.cmml"><mi id="S2.E5.m1.4.4.1.1.1.3.2" xref="S2.E5.m1.4.4.1.1.1.3.2.cmml">M</mi><mrow id="S2.E5.m1.4.4.1.1.1.3.3" xref="S2.E5.m1.4.4.1.1.1.3.3.cmml"><mi id="S2.E5.m1.4.4.1.1.1.3.3.2" xref="S2.E5.m1.4.4.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E5.m1.4.4.1.1.1.3.3.1" xref="S2.E5.m1.4.4.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E5.m1.4.4.1.1.1.3.3.3" xref="S2.E5.m1.4.4.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E5.m1.4.4.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="S2.E5.m1.4.4.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.1.3.cmml">σ</mi><mo id="S2.E5.m1.4.4.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.2.cmml">⁢</mo><msup id="S2.E5.m1.4.4.1.1.1.1.4" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml"><mrow id="S2.E5.m1.4.4.1.1.1.1.4.2.2" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml"><mo id="S2.E5.m1.4.4.1.1.1.1.4.2.2.1" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml">(</mo><mi id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml">K</mi><mo id="S2.E5.m1.4.4.1.1.1.1.4.2.2.2" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml">)</mo></mrow><mi id="S2.E5.m1.4.4.1.1.1.1.4.3" xref="S2.E5.m1.4.4.1.1.1.1.4.3.cmml">T</mi></msup><mo id="S2.E5.m1.4.4.1.1.1.1.2a" xref="S2.E5.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml">V</mi><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.3" xref="S2.E5.m1.1.1.1.3.cmml">σ</mi><mo id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.1.1.1.4.2" xref="S2.E5.m1.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.4.2.1" stretchy="false" xref="S2.E5.m1.1.1.1.cmml">(</mo><mi id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">K</mi><mo id="S2.E5.m1.1.1.1.4.2.2" stretchy="false" xref="S2.E5.m1.1.1.1.cmml">)</mo></mrow><mo id="S2.E5.m1.1.1.1.2a" xref="S2.E5.m1.1.1.1.2.cmml">⁢</mo><msub id="S2.E5.m1.1.1.1.5" xref="S2.E5.m1.1.1.1.5.cmml"><mi id="S2.E5.m1.1.1.1.5.2" xref="S2.E5.m1.1.1.1.5.2.cmml">M</mi><mrow id="S2.E5.m1.1.1.1.5.3" xref="S2.E5.m1.1.1.1.5.3.cmml"><mi id="S2.E5.m1.1.1.1.5.3.2" xref="S2.E5.m1.1.1.1.5.3.2.cmml">s</mi><mo id="S2.E5.m1.1.1.1.5.3.1" xref="S2.E5.m1.1.1.1.5.3.1.cmml">−</mo><mn id="S2.E5.m1.1.1.1.5.3.3" xref="S2.E5.m1.1.1.1.5.3.3.cmml">1</mn></mrow></msub></mrow><mrow id="S2.E5.m1.2.2.2" xref="S2.E5.m1.2.2.2.cmml"><mi id="S2.E5.m1.2.2.2.3" xref="S2.E5.m1.2.2.2.3.cmml">σ</mi><mo id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.2.4.2" xref="S2.E5.m1.2.2.2.cmml"><mo id="S2.E5.m1.2.2.2.4.2.1" stretchy="false" xref="S2.E5.m1.2.2.2.cmml">(</mo><mi id="S2.E5.m1.2.2.2.1" xref="S2.E5.m1.2.2.2.1.cmml">K</mi><mo id="S2.E5.m1.2.2.2.4.2.2" stretchy="false" xref="S2.E5.m1.2.2.2.cmml">)</mo></mrow><mo id="S2.E5.m1.2.2.2.2a" xref="S2.E5.m1.2.2.2.2.cmml">⁢</mo><msub id="S2.E5.m1.2.2.2.5" xref="S2.E5.m1.2.2.2.5.cmml"><mi id="S2.E5.m1.2.2.2.5.2" xref="S2.E5.m1.2.2.2.5.2.cmml">z</mi><mrow id="S2.E5.m1.2.2.2.5.3" xref="S2.E5.m1.2.2.2.5.3.cmml"><mi id="S2.E5.m1.2.2.2.5.3.2" xref="S2.E5.m1.2.2.2.5.3.2.cmml">s</mi><mo id="S2.E5.m1.2.2.2.5.3.1" xref="S2.E5.m1.2.2.2.5.3.1.cmml">−</mo><mn id="S2.E5.m1.2.2.2.5.3.3" xref="S2.E5.m1.2.2.2.5.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mrow><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.4.4.1.2" lspace="0em" xref="S2.E5.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.4b"><apply id="S2.E5.m1.4.4.1.1.cmml" xref="S2.E5.m1.4.4.1"><ci id="S2.E5.m1.4.4.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.2">←</ci><apply id="S2.E5.m1.4.4.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.3">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2">𝑀</ci><ci id="S2.E5.m1.4.4.1.1.3.3.cmml" xref="S2.E5.m1.4.4.1.1.3.3">𝑠</ci></apply><apply id="S2.E5.m1.4.4.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1"><plus id="S2.E5.m1.4.4.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.2"></plus><apply id="S2.E5.m1.4.4.1.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.1.3.2">𝑀</ci><apply id="S2.E5.m1.4.4.1.1.1.3.3.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3"><minus id="S2.E5.m1.4.4.1.1.1.3.3.1.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3.1"></minus><ci id="S2.E5.m1.4.4.1.1.1.3.3.2.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3.2">𝑠</ci><cn id="S2.E5.m1.4.4.1.1.1.3.3.3.cmml" type="integer" xref="S2.E5.m1.4.4.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.E5.m1.4.4.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1"><times id="S2.E5.m1.4.4.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.2"></times><ci id="S2.E5.m1.4.4.1.1.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.1.1.3">𝜎</ci><apply id="S2.E5.m1.4.4.1.1.1.1.4.cmml" xref="S2.E5.m1.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.1.1.4.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.4">superscript</csymbol><ci id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3">𝐾</ci><ci id="S2.E5.m1.4.4.1.1.1.1.4.3.cmml" xref="S2.E5.m1.4.4.1.1.1.1.4.3">𝑇</ci></apply><apply id="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1"><minus id="S2.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.1"></minus><ci id="S2.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.2">𝑉</ci><apply id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2"><divide id="S2.E5.m1.2.2.3.cmml" xref="S2.E5.m1.2.2"></divide><apply id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><times id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.2"></times><ci id="S2.E5.m1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.3">𝜎</ci><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">𝐾</ci><apply id="S2.E5.m1.1.1.1.5.cmml" xref="S2.E5.m1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.5.1.cmml" xref="S2.E5.m1.1.1.1.5">subscript</csymbol><ci id="S2.E5.m1.1.1.1.5.2.cmml" xref="S2.E5.m1.1.1.1.5.2">𝑀</ci><apply id="S2.E5.m1.1.1.1.5.3.cmml" xref="S2.E5.m1.1.1.1.5.3"><minus id="S2.E5.m1.1.1.1.5.3.1.cmml" xref="S2.E5.m1.1.1.1.5.3.1"></minus><ci id="S2.E5.m1.1.1.1.5.3.2.cmml" xref="S2.E5.m1.1.1.1.5.3.2">𝑠</ci><cn id="S2.E5.m1.1.1.1.5.3.3.cmml" type="integer" xref="S2.E5.m1.1.1.1.5.3.3">1</cn></apply></apply></apply><apply id="S2.E5.m1.2.2.2.cmml" xref="S2.E5.m1.2.2.2"><times id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2"></times><ci id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.3">𝜎</ci><ci id="S2.E5.m1.2.2.2.1.cmml" xref="S2.E5.m1.2.2.2.1">𝐾</ci><apply id="S2.E5.m1.2.2.2.5.cmml" xref="S2.E5.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.5.1.cmml" xref="S2.E5.m1.2.2.2.5">subscript</csymbol><ci id="S2.E5.m1.2.2.2.5.2.cmml" xref="S2.E5.m1.2.2.2.5.2">𝑧</ci><apply id="S2.E5.m1.2.2.2.5.3.cmml" xref="S2.E5.m1.2.2.2.5.3"><minus id="S2.E5.m1.2.2.2.5.3.1.cmml" xref="S2.E5.m1.2.2.2.5.3.1"></minus><ci id="S2.E5.m1.2.2.2.5.3.2.cmml" xref="S2.E5.m1.2.2.2.5.3.2">𝑠</ci><cn id="S2.E5.m1.2.2.2.5.3.3.cmml" type="integer" xref="S2.E5.m1.2.2.2.5.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.4c">M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}(V-\frac{\sigma({K})M_{s-1}}{{\sigma(K)}z%
_{s-1}}).</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.4d">italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT + italic_σ ( italic_K ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_V - divide start_ARG italic_σ ( italic_K ) italic_M start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT end_ARG start_ARG italic_σ ( italic_K ) italic_z start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p7">
<p class="ltx_p" id="S2.SS1.SSS2.p7.2">This update rule (<math alttext="Linear+Delta" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p7.1.m1.1"><semantics id="S2.SS1.SSS2.p7.1.m1.1a"><mrow id="S2.SS1.SSS2.p7.1.m1.1.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.cmml"><mrow id="S2.SS1.SSS2.p7.1.m1.1.1.2" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.cmml"><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.2" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.2.cmml">L</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.3" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.3.cmml">i</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1a" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.4" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.4.cmml">n</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1b" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.5" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.5.cmml">e</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1c" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.6" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.6.cmml">a</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.2.1d" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.7" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.7.cmml">r</mi></mrow><mo id="S2.SS1.SSS2.p7.1.m1.1.1.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.1.cmml">+</mo><mrow id="S2.SS1.SSS2.p7.1.m1.1.1.3" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.2" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.2.cmml">D</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.3.1a" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.4" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.4.cmml">l</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.3.1b" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.5" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.5.cmml">t</mi><mo id="S2.SS1.SSS2.p7.1.m1.1.1.3.1c" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.6" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.6.cmml">a</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p7.1.m1.1b"><apply id="S2.SS1.SSS2.p7.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1"><plus id="S2.SS1.SSS2.p7.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.1"></plus><apply id="S2.SS1.SSS2.p7.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2"><times id="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1"></times><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.2">𝐿</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.3">𝑖</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.4.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.4">𝑛</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.5.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.5">𝑒</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.6.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.6">𝑎</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.7.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.7">𝑟</ci></apply><apply id="S2.SS1.SSS2.p7.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3"><times id="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.2">𝐷</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.4.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.5.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.5">𝑡</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.6.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.6">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p7.1.m1.1c">Linear+Delta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p7.1.m1.1d">italic_L italic_i italic_n italic_e italic_a italic_r + italic_D italic_e italic_l italic_t italic_a</annotation></semantics></math>) leaves the associative matrix unmodified if the KV binding already exists in the memory while still tracking the same normalization term as the former one (<math alttext="Linear" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p7.2.m2.1"><semantics id="S2.SS1.SSS2.p7.2.m2.1a"><mrow id="S2.SS1.SSS2.p7.2.m2.1.1" xref="S2.SS1.SSS2.p7.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p7.2.m2.1.1.2" xref="S2.SS1.SSS2.p7.2.m2.1.1.2.cmml">L</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.3" xref="S2.SS1.SSS2.p7.2.m2.1.1.3.cmml">i</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1a" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.4" xref="S2.SS1.SSS2.p7.2.m2.1.1.4.cmml">n</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1b" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.5" xref="S2.SS1.SSS2.p7.2.m2.1.1.5.cmml">e</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1c" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.6" xref="S2.SS1.SSS2.p7.2.m2.1.1.6.cmml">a</mi><mo id="S2.SS1.SSS2.p7.2.m2.1.1.1d" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.7" xref="S2.SS1.SSS2.p7.2.m2.1.1.7.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p7.2.m2.1b"><apply id="S2.SS1.SSS2.p7.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1"><times id="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.1"></times><ci id="S2.SS1.SSS2.p7.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.2">𝐿</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.3">𝑖</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.4.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.4">𝑛</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.5.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.5">𝑒</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.6.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.6">𝑎</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.7.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.7">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p7.2.m2.1c">Linear</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p7.2.m2.1d">italic_L italic_i italic_n italic_e italic_a italic_r</annotation></semantics></math>) for numerical stability.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p8">
<p class="ltx_p" id="S2.SS1.SSS2.p8.3"><span class="ltx_text ltx_font_bold" id="S2.SS1.SSS2.p8.3.1">Long-term context injection. </span> 로컬 주의 상태 <math alttext="A_{dot}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p8.1.m1.1"><semantics id="S2.SS1.SSS2.p8.1.m1.1a"><msub id="S2.SS1.SSS2.p8.1.m1.1.1" xref="S2.SS1.SSS2.p8.1.m1.1.1.cmml"><mi id="S2.SS1.SSS2.p8.1.m1.1.1.2" xref="S2.SS1.SSS2.p8.1.m1.1.1.2.cmml">A</mi><mrow id="S2.SS1.SSS2.p8.1.m1.1.1.3" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p8.1.m1.1.1.3.2" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.2.cmml">d</mi><mo id="S2.SS1.SSS2.p8.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p8.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.3.cmml">o</mi><mo id="S2.SS1.SSS2.p8.1.m1.1.1.3.1a" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p8.1.m1.1.1.3.4" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p8.1.m1.1b"><apply id="S2.SS1.SSS2.p8.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p8.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p8.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.2">𝐴</ci><apply id="S2.SS1.SSS2.p8.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3"><times id="S2.SS1.SSS2.p8.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p8.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.2">𝑑</ci><ci id="S2.SS1.SSS2.p8.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.3">𝑜</ci><ci id="S2.SS1.SSS2.p8.1.m1.1.1.3.4.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p8.1.m1.1c">A_{dot}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p8.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_d italic_o italic_t end_POSTSUBSCRIPT</annotation></semantics></math> 및 메모리 검색된 콘텐츠 <math alttext="A_{mem}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p8.2.m2.1"><semantics id="S2.SS1.SSS2.p8.2.m2.1a"><msub id="S2.SS1.SSS2.p8.2.m2.1.1" xref="S2.SS1.SSS2.p8.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p8.2.m2.1.1.2" xref="S2.SS1.SSS2.p8.2.m2.1.1.2.cmml">A</mi><mrow id="S2.SS1.SSS2.p8.2.m2.1.1.3" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.cmml"><mi id="S2.SS1.SSS2.p8.2.m2.1.1.3.2" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.2.cmml">m</mi><mo id="S2.SS1.SSS2.p8.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p8.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.3.cmml">e</mi><mo id="S2.SS1.SSS2.p8.2.m2.1.1.3.1a" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p8.2.m2.1.1.3.4" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p8.2.m2.1b"><apply id="S2.SS1.SSS2.p8.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p8.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p8.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.2">𝐴</ci><apply id="S2.SS1.SSS2.p8.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3"><times id="S2.SS1.SSS2.p8.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p8.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p8.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p8.2.m2.1.1.3.4.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p8.2.m2.1c">A_{mem}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p8.2.m2.1d">italic_A start_POSTSUBSCRIPT italic_m italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math>를 학습된 게이팅 스칼라 <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p8.3.m3.1"><semantics id="S2.SS1.SSS2.p8.3.m3.1a"><mi id="S2.SS1.SSS2.p8.3.m3.1.1" xref="S2.SS1.SSS2.p8.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p8.3.m3.1b"><ci id="S2.SS1.SSS2.p8.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p8.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p8.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p8.3.m3.1d">italic_β</annotation></semantics></math>를 통해 집계한다:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A=\textit{sigmoid}(\beta)\odot A_{mem}+(1-\textit{sigmoid}(\beta))\odot A_{dot}." class="ltx_Math" display="block" id="S2.E6.m1.3"><semantics id="S2.E6.m1.3a"><mrow id="S2.E6.m1.3.3.1" xref="S2.E6.m1.3.3.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1" xref="S2.E6.m1.3.3.1.1.cmml"><mi id="S2.E6.m1.3.3.1.1.3" xref="S2.E6.m1.3.3.1.1.3.cmml">A</mi><mo id="S2.E6.m1.3.3.1.1.2" xref="S2.E6.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E6.m1.3.3.1.1.1" xref="S2.E6.m1.3.3.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.3.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml"><mtext id="S2.E6.m1.3.3.1.1.1.3.2.2" xref="S2.E6.m1.3.3.1.1.1.3.2.2a.cmml">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext><mo id="S2.E6.m1.3.3.1.1.1.3.2.1" xref="S2.E6.m1.3.3.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S2.E6.m1.3.3.1.1.1.3.2.3.2" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml"><mo id="S2.E6.m1.3.3.1.1.1.3.2.3.2.1" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml">(</mo><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">β</mi><mo id="S2.E6.m1.3.3.1.1.1.3.2.3.2.2" rspace="0.055em" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.3.3.1.1.1.3.1" rspace="0.222em" xref="S2.E6.m1.3.3.1.1.1.3.1.cmml">⊙</mo><msub id="S2.E6.m1.3.3.1.1.1.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.3.3.2" xref="S2.E6.m1.3.3.1.1.1.3.3.2.cmml">A</mi><mrow id="S2.E6.m1.3.3.1.1.1.3.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.3.3.3.2" xref="S2.E6.m1.3.3.1.1.1.3.3.3.2.cmml">m</mi><mo id="S2.E6.m1.3.3.1.1.1.3.3.3.1" xref="S2.E6.m1.3.3.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E6.m1.3.3.1.1.1.3.3.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.3.3.cmml">e</mi><mo id="S2.E6.m1.3.3.1.1.1.3.3.3.1a" xref="S2.E6.m1.3.3.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E6.m1.3.3.1.1.1.3.3.3.4" xref="S2.E6.m1.3.3.1.1.1.3.3.3.4.cmml">m</mi></mrow></msub></mrow><mo id="S2.E6.m1.3.3.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.2.cmml">+</mo><mrow id="S2.E6.m1.3.3.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mn id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mtext id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E6.m1.2.2" xref="S2.E6.m1.2.2.cmml">β</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E6.m1.3.3.1.1.1.1.2" rspace="0.222em" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml">⊙</mo><msub id="S2.E6.m1.3.3.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.1.3.2.cmml">A</mi><mrow id="S2.E6.m1.3.3.1.1.1.1.3.3" xref="S2.E6.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.3.3.2" xref="S2.E6.m1.3.3.1.1.1.1.3.3.2.cmml">d</mi><mo id="S2.E6.m1.3.3.1.1.1.1.3.3.1" xref="S2.E6.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E6.m1.3.3.1.1.1.1.3.3.3" xref="S2.E6.m1.3.3.1.1.1.1.3.3.3.cmml">o</mi><mo id="S2.E6.m1.3.3.1.1.1.1.3.3.1a" xref="S2.E6.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E6.m1.3.3.1.1.1.1.3.3.4" xref="S2.E6.m1.3.3.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow></mrow></mrow><mo id="S2.E6.m1.3.3.1.2" lspace="0em" xref="S2.E6.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.3b"><apply id="S2.E6.m1.3.3.1.1.cmml" xref="S2.E6.m1.3.3.1"><eq id="S2.E6.m1.3.3.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2"></eq><ci id="S2.E6.m1.3.3.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.3">𝐴</ci><apply id="S2.E6.m1.3.3.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1"><plus id="S2.E6.m1.3.3.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.2"></plus><apply id="S2.E6.m1.3.3.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.1">direct-product</csymbol><apply id="S2.E6.m1.3.3.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2"><times id="S2.E6.m1.3.3.1.1.1.3.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.1"></times><ci id="S2.E6.m1.3.3.1.1.1.3.2.2a.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.2"><mtext id="S2.E6.m1.3.3.1.1.1.3.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.2">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext></ci><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝛽</ci></apply><apply id="S2.E6.m1.3.3.1.1.1.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.3.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.3.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.2">𝐴</ci><apply id="S2.E6.m1.3.3.1.1.1.3.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3"><times id="S2.E6.m1.3.3.1.1.1.3.3.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.1"></times><ci id="S2.E6.m1.3.3.1.1.1.3.3.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.2">𝑚</ci><ci id="S2.E6.m1.3.3.1.1.1.3.3.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.3">𝑒</ci><ci id="S2.E6.m1.3.3.1.1.1.3.3.3.4.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.4">𝑚</ci></apply></apply></apply><apply id="S2.E6.m1.3.3.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.2">direct-product</csymbol><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1"><minus id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1"></minus><cn id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2">1</cn><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3"><times id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1"></times><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2"><mtext id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext></ci><ci id="S2.E6.m1.2.2.cmml" xref="S2.E6.m1.2.2">𝛽</ci></apply></apply><apply id="S2.E6.m1.3.3.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.2">𝐴</ci><apply id="S2.E6.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3"><times id="S2.E6.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.1"></times><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.2">𝑑</ci><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.3">𝑜</ci><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.4.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.3c">A=\textit{sigmoid}(\beta)\odot A_{mem}+(1-\textit{sigmoid}(\beta))\odot A_{dot}.</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.3d">italic_A = sigmoid ( italic_β ) ⊙ italic_A start_POSTSUBSCRIPT italic_m italic_e italic_m end_POSTSUBSCRIPT + ( 1 - sigmoid ( italic_β ) ) ⊙ italic_A start_POSTSUBSCRIPT italic_d italic_o italic_t end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS2.p8.4">이는 모델 <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite>에서 장기 및 지역 정보 흐름 간의 학습 가능한 트레이드오프를 허용하면서 헤드당 단일 스칼라 값만 학습 매개 변수로 추가한다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p9">
<p class="ltx_p" id="S2.SS1.SSS2.p9.2">표준 MHA와 유사하게, 다중 헤드 Infini-attention에 대해 우리는 병렬적으로 <math alttext="H" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p9.1.m1.1"><semantics id="S2.SS1.SSS2.p9.1.m1.1a"><mi id="S2.SS1.SSS2.p9.1.m1.1.1" xref="S2.SS1.SSS2.p9.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p9.1.m1.1b"><ci id="S2.SS1.SSS2.p9.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p9.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p9.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p9.1.m1.1d">italic_H</annotation></semantics></math> 컨텍스트 상태의 수를 계산하고, 최종 주의 출력 <math alttext="O\in{\rm I\!R}^{N\times d_{model}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p9.2.m2.1"><semantics id="S2.SS1.SSS2.p9.2.m2.1a"><mrow id="S2.SS1.SSS2.p9.2.m2.1.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.2.cmml">O</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p9.2.m2.1.1.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p9.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2.cmml">N</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2.cmml">m</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3.cmml">o</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4.cmml">d</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5.cmml">e</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p9.2.m2.1b"><apply id="S2.SS1.SSS2.p9.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1"><in id="S2.SS1.SSS2.p9.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.1"></in><ci id="S2.SS1.SSS2.p9.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.2">𝑂</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3"><times id="S2.SS1.SSS2.p9.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3"><times id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3">𝑜</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4">𝑑</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5">𝑒</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p9.2.m2.1c">O\in{\rm I\!R}^{N\times d_{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p9.2.m2.1d">italic_O ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>에 대해 이들을 연결 및 투영한다:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="O=[A^{1};\dotso A^{H}]W_{O}" class="ltx_Math" display="block" id="S2.E7.m1.2"><semantics id="S2.E7.m1.2a"><mrow id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml"><mi id="S2.E7.m1.2.2.4" xref="S2.E7.m1.2.2.4.cmml">O</mi><mo id="S2.E7.m1.2.2.3" xref="S2.E7.m1.2.2.3.cmml">=</mo><mrow id="S2.E7.m1.2.2.2" xref="S2.E7.m1.2.2.2.cmml"><mrow id="S2.E7.m1.2.2.2.2.2" xref="S2.E7.m1.2.2.2.2.3.cmml"><mo id="S2.E7.m1.2.2.2.2.2.3" stretchy="false" xref="S2.E7.m1.2.2.2.2.3.cmml">[</mo><msup id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">A</mi><mn id="S2.E7.m1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.E7.m1.2.2.2.2.2.4" xref="S2.E7.m1.2.2.2.2.3.cmml">;</mo><mrow id="S2.E7.m1.2.2.2.2.2.2" xref="S2.E7.m1.2.2.2.2.2.2.cmml"><mi id="S2.E7.m1.2.2.2.2.2.2.2" mathvariant="normal" xref="S2.E7.m1.2.2.2.2.2.2.2.cmml">…</mi><mo id="S2.E7.m1.2.2.2.2.2.2.1" xref="S2.E7.m1.2.2.2.2.2.2.1.cmml">⁢</mo><msup id="S2.E7.m1.2.2.2.2.2.2.3" xref="S2.E7.m1.2.2.2.2.2.2.3.cmml"><mi id="S2.E7.m1.2.2.2.2.2.2.3.2" xref="S2.E7.m1.2.2.2.2.2.2.3.2.cmml">A</mi><mi id="S2.E7.m1.2.2.2.2.2.2.3.3" xref="S2.E7.m1.2.2.2.2.2.2.3.3.cmml">H</mi></msup></mrow><mo id="S2.E7.m1.2.2.2.2.2.5" stretchy="false" xref="S2.E7.m1.2.2.2.2.3.cmml">]</mo></mrow><mo id="S2.E7.m1.2.2.2.3" xref="S2.E7.m1.2.2.2.3.cmml">⁢</mo><msub id="S2.E7.m1.2.2.2.4" xref="S2.E7.m1.2.2.2.4.cmml"><mi id="S2.E7.m1.2.2.2.4.2" xref="S2.E7.m1.2.2.2.4.2.cmml">W</mi><mi id="S2.E7.m1.2.2.2.4.3" xref="S2.E7.m1.2.2.2.4.3.cmml">O</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.2b"><apply id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2"><eq id="S2.E7.m1.2.2.3.cmml" xref="S2.E7.m1.2.2.3"></eq><ci id="S2.E7.m1.2.2.4.cmml" xref="S2.E7.m1.2.2.4">𝑂</ci><apply id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2.2"><times id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.3"></times><list id="S2.E7.m1.2.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.2.2"><apply id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2">𝐴</ci><cn id="S2.E7.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E7.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E7.m1.2.2.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2.2.2"><times id="S2.E7.m1.2.2.2.2.2.2.1.cmml" xref="S2.E7.m1.2.2.2.2.2.2.1"></times><ci id="S2.E7.m1.2.2.2.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2.2.2.2">…</ci><apply id="S2.E7.m1.2.2.2.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3">superscript</csymbol><ci id="S2.E7.m1.2.2.2.2.2.2.3.2.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3.2">𝐴</ci><ci id="S2.E7.m1.2.2.2.2.2.2.3.3.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3.3">𝐻</ci></apply></apply></list><apply id="S2.E7.m1.2.2.2.4.cmml" xref="S2.E7.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.4.1.cmml" xref="S2.E7.m1.2.2.2.4">subscript</csymbol><ci id="S2.E7.m1.2.2.2.4.2.cmml" xref="S2.E7.m1.2.2.2.4.2">𝑊</ci><ci id="S2.E7.m1.2.2.2.4.3.cmml" xref="S2.E7.m1.2.2.2.4.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.2c">O=[A^{1};\dotso A^{H}]W_{O}</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.2d">italic_O = [ italic_A start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ; … italic_A start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ] italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS2.p9.3">where <math alttext="W_{O}\in{\rm I\!R}^{H\times d_{value}\times d_{model}}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p9.3.m1.1"><semantics id="S2.SS1.SSS2.p9.3.m1.1a"><mrow id="S2.SS1.SSS2.p9.3.m1.1.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.cmml"><msub id="S2.SS1.SSS2.p9.3.m1.1.1.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.2.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.2.cmml">W</mi><mi id="S2.SS1.SSS2.p9.3.m1.1.1.2.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.3.cmml">O</mi></msub><mo id="S2.SS1.SSS2.p9.3.m1.1.1.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.cmml"><mpadded width="0.348em"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.2.cmml">I</mi></mpadded><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.1.cmml">⁢</mo><msup id="S2.SS1.SSS2.p9.3.m1.1.1.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2" mathvariant="normal" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2.cmml">H</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2.cmml">v</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3.cmml">a</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4.cmml">l</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5.cmml">u</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2.cmml">m</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3.cmml">o</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1a" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4.cmml">d</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1b" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5.cmml">e</mi><mo id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1c" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p9.3.m1.1b"><apply id="S2.SS1.SSS2.p9.3.m1.1.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1"><in id="S2.SS1.SSS2.p9.3.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.1"></in><apply id="S2.SS1.SSS2.p9.3.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.2">𝑊</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.3">𝑂</ci></apply><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2">𝐻</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4">subscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2">𝑑</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3">𝑜</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4">𝑑</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5">𝑒</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p9.3.m1.1c">W_{O}\in{\rm I\!R}^{H\times d_{value}\times d_{model}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p9.3.m1.1d">italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ∈ roman_I roman_R start_POSTSUPERSCRIPT italic_H × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is trainable weights.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Memory and Effective Context Window</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S2.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S2.T1.12">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S2.T1.12.13.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.1">Model</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.2">Memory (cache) footprint</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.3">Context length</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.4">Memory update</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S2.T1.12.13.1.5">Memory retrieval</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.2.2.3">Transformer-XL</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.1.1.1"><math alttext="(d_{key}+d_{value})\times H\times N\times l" class="ltx_Math" display="inline" id="S2.T1.1.1.1.m1.1"><semantics id="S2.T1.1.1.1.m1.1a"><mrow id="S2.T1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.m1.1.1.cmml"><mrow id="S2.T1.1.1.1.m1.1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.1.1.1.m1.1.1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml"><msub id="S2.T1.1.1.1.m1.1.1.1.1.1.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3.cmml">e</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1a" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.T1.1.1.1.m1.1.1.1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2.cmml">v</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3.cmml">a</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1a" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4.cmml">l</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1b" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5.cmml">u</mi><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1c" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S2.T1.1.1.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.1.1.1.m1.1.1.2" rspace="0.222em" xref="S2.T1.1.1.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.1.1.1.m1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.3.cmml">H</mi><mo id="S2.T1.1.1.1.m1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.T1.1.1.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.1.1.1.m1.1.1.4" xref="S2.T1.1.1.1.m1.1.1.4.cmml">N</mi><mo id="S2.T1.1.1.1.m1.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S2.T1.1.1.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.1.1.1.m1.1.1.5" xref="S2.T1.1.1.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.m1.1b"><apply id="S2.T1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1"><times id="S2.T1.1.1.1.m1.1.1.2.cmml" xref="S2.T1.1.1.1.m1.1.1.2"></times><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1"><plus id="S2.T1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.1.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3"><times id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2">𝑘</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4">𝑦</ci></apply></apply><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.1.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3"><times id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1"></times><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5">𝑢</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6">𝑒</ci></apply></apply></apply><ci id="S2.T1.1.1.1.m1.1.1.3.cmml" xref="S2.T1.1.1.1.m1.1.1.3">𝐻</ci><ci id="S2.T1.1.1.1.m1.1.1.4.cmml" xref="S2.T1.1.1.1.m1.1.1.4">𝑁</ci><ci id="S2.T1.1.1.1.m1.1.1.5.cmml" xref="S2.T1.1.1.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.m1.1c">(d_{key}+d_{value})\times H\times N\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.1.1.1.m1.1d">( italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT ) × italic_H × italic_N × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.2.2.2"><math alttext="N\times l" class="ltx_Math" display="inline" id="S2.T1.2.2.2.m1.1"><semantics id="S2.T1.2.2.2.m1.1a"><mrow id="S2.T1.2.2.2.m1.1.1" xref="S2.T1.2.2.2.m1.1.1.cmml"><mi id="S2.T1.2.2.2.m1.1.1.2" xref="S2.T1.2.2.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.2.2.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.2.2.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.2.2.2.m1.1.1.3" xref="S2.T1.2.2.2.m1.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.2.2.2.m1.1b"><apply id="S2.T1.2.2.2.m1.1.1.cmml" xref="S2.T1.2.2.2.m1.1.1"><times id="S2.T1.2.2.2.m1.1.1.1.cmml" xref="S2.T1.2.2.2.m1.1.1.1"></times><ci id="S2.T1.2.2.2.m1.1.1.2.cmml" xref="S2.T1.2.2.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.2.2.2.m1.1.1.3.cmml" xref="S2.T1.2.2.2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.2.2.m1.1c">N\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.2.2.2.m1.1d">italic_N × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.2.2.4">Discarded</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.2.2.5">Dot-product attention</td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.4">
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.3">Compressive Transformer</td>
<td class="ltx_td ltx_align_left" id="S2.T1.3.3.1"><math alttext="d_{model}\times(c+N)\times l" class="ltx_Math" display="inline" id="S2.T1.3.3.1.m1.1"><semantics id="S2.T1.3.3.1.m1.1a"><mrow id="S2.T1.3.3.1.m1.1.1" xref="S2.T1.3.3.1.m1.1.1.cmml"><msub id="S2.T1.3.3.1.m1.1.1.3" xref="S2.T1.3.3.1.m1.1.1.3.cmml"><mi id="S2.T1.3.3.1.m1.1.1.3.2" xref="S2.T1.3.3.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.3.3.1.m1.1.1.3.3" xref="S2.T1.3.3.1.m1.1.1.3.3.cmml"><mi id="S2.T1.3.3.1.m1.1.1.3.3.2" xref="S2.T1.3.3.1.m1.1.1.3.3.2.cmml">m</mi><mo id="S2.T1.3.3.1.m1.1.1.3.3.1" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.3" xref="S2.T1.3.3.1.m1.1.1.3.3.3.cmml">o</mi><mo id="S2.T1.3.3.1.m1.1.1.3.3.1a" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.4" xref="S2.T1.3.3.1.m1.1.1.3.3.4.cmml">d</mi><mo id="S2.T1.3.3.1.m1.1.1.3.3.1b" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.5" xref="S2.T1.3.3.1.m1.1.1.3.3.5.cmml">e</mi><mo id="S2.T1.3.3.1.m1.1.1.3.3.1c" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.6" xref="S2.T1.3.3.1.m1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo id="S2.T1.3.3.1.m1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.T1.3.3.1.m1.1.1.2.cmml">×</mo><mrow id="S2.T1.3.3.1.m1.1.1.1.1" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.3.3.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.3.3.1.m1.1.1.1.1.1" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml"><mi id="S2.T1.3.3.1.m1.1.1.1.1.1.2" xref="S2.T1.3.3.1.m1.1.1.1.1.1.2.cmml">c</mi><mo id="S2.T1.3.3.1.m1.1.1.1.1.1.1" xref="S2.T1.3.3.1.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.T1.3.3.1.m1.1.1.1.1.1.3" xref="S2.T1.3.3.1.m1.1.1.1.1.1.3.cmml">N</mi></mrow><mo id="S2.T1.3.3.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.3.3.1.m1.1.1.2a" rspace="0.222em" xref="S2.T1.3.3.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.3.3.1.m1.1.1.4" xref="S2.T1.3.3.1.m1.1.1.4.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.3.3.1.m1.1b"><apply id="S2.T1.3.3.1.m1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1"><times id="S2.T1.3.3.1.m1.1.1.2.cmml" xref="S2.T1.3.3.1.m1.1.1.2"></times><apply id="S2.T1.3.3.1.m1.1.1.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.3.3.1.m1.1.1.3.1.cmml" xref="S2.T1.3.3.1.m1.1.1.3">subscript</csymbol><ci id="S2.T1.3.3.1.m1.1.1.3.2.cmml" xref="S2.T1.3.3.1.m1.1.1.3.2">𝑑</ci><apply id="S2.T1.3.3.1.m1.1.1.3.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3"><times id="S2.T1.3.3.1.m1.1.1.3.3.1.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.1"></times><ci id="S2.T1.3.3.1.m1.1.1.3.3.2.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.2">𝑚</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.3">𝑜</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.4.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.4">𝑑</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.5.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.5">𝑒</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.6.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.6">𝑙</ci></apply></apply><apply id="S2.T1.3.3.1.m1.1.1.1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1"><plus id="S2.T1.3.3.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1.1.1"></plus><ci id="S2.T1.3.3.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1.1.2">𝑐</ci><ci id="S2.T1.3.3.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1.1.3">𝑁</ci></apply><ci id="S2.T1.3.3.1.m1.1.1.4.cmml" xref="S2.T1.3.3.1.m1.1.1.4">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.3.1.m1.1c">d_{model}\times(c+N)\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.3.3.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × ( italic_c + italic_N ) × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.2"><math alttext="(c\times r+N)\times l" class="ltx_Math" display="inline" id="S2.T1.4.4.2.m1.1"><semantics id="S2.T1.4.4.2.m1.1a"><mrow id="S2.T1.4.4.2.m1.1.1" xref="S2.T1.4.4.2.m1.1.1.cmml"><mrow id="S2.T1.4.4.2.m1.1.1.1.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml"><mo id="S2.T1.4.4.2.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.4.4.2.m1.1.1.1.1.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml"><mrow id="S2.T1.4.4.2.m1.1.1.1.1.1.2" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.4.4.2.m1.1.1.1.1.1.2.2" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.2.cmml">c</mi><mo id="S2.T1.4.4.2.m1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.1.cmml">×</mo><mi id="S2.T1.4.4.2.m1.1.1.1.1.1.2.3" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.3.cmml">r</mi></mrow><mo id="S2.T1.4.4.2.m1.1.1.1.1.1.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.T1.4.4.2.m1.1.1.1.1.1.3" xref="S2.T1.4.4.2.m1.1.1.1.1.1.3.cmml">N</mi></mrow><mo id="S2.T1.4.4.2.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.4.4.2.m1.1.1.2" rspace="0.222em" xref="S2.T1.4.4.2.m1.1.1.2.cmml">×</mo><mi id="S2.T1.4.4.2.m1.1.1.3" xref="S2.T1.4.4.2.m1.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.4.4.2.m1.1b"><apply id="S2.T1.4.4.2.m1.1.1.cmml" xref="S2.T1.4.4.2.m1.1.1"><times id="S2.T1.4.4.2.m1.1.1.2.cmml" xref="S2.T1.4.4.2.m1.1.1.2"></times><apply id="S2.T1.4.4.2.m1.1.1.1.1.1.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1"><plus id="S2.T1.4.4.2.m1.1.1.1.1.1.1.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.4.4.2.m1.1.1.1.1.1.2.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2"><times id="S2.T1.4.4.2.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.1"></times><ci id="S2.T1.4.4.2.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.2">𝑐</ci><ci id="S2.T1.4.4.2.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.3">𝑟</ci></apply><ci id="S2.T1.4.4.2.m1.1.1.1.1.1.3.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.3">𝑁</ci></apply><ci id="S2.T1.4.4.2.m1.1.1.3.cmml" xref="S2.T1.4.4.2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.4.2.m1.1c">(c\times r+N)\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.4.4.2.m1.1d">( italic_c × italic_r + italic_N ) × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.4">Discarded</td>
<td class="ltx_td ltx_align_left" id="S2.T1.4.4.5">Dot-product attention</td>
</tr>
<tr class="ltx_tr" id="S2.T1.6.6">
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.3">Memorizing Transformers</td>
<td class="ltx_td ltx_align_left" id="S2.T1.5.5.1"><math alttext="(d_{key}+d_{value})\times H\times N\times S" class="ltx_Math" display="inline" id="S2.T1.5.5.1.m1.1"><semantics id="S2.T1.5.5.1.m1.1a"><mrow id="S2.T1.5.5.1.m1.1.1" xref="S2.T1.5.5.1.m1.1.1.cmml"><mrow id="S2.T1.5.5.1.m1.1.1.1.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.5.5.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.5.5.1.m1.1.1.1.1.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml"><msub id="S2.T1.5.5.1.m1.1.1.1.1.1.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3.cmml">e</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1a" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.T1.5.5.1.m1.1.1.1.1.1.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2.cmml">v</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3.cmml">a</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1a" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4.cmml">l</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1b" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5.cmml">u</mi><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1c" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S2.T1.5.5.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.5.5.1.m1.1.1.2" rspace="0.222em" xref="S2.T1.5.5.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.5.5.1.m1.1.1.3" xref="S2.T1.5.5.1.m1.1.1.3.cmml">H</mi><mo id="S2.T1.5.5.1.m1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.T1.5.5.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.5.5.1.m1.1.1.4" xref="S2.T1.5.5.1.m1.1.1.4.cmml">N</mi><mo id="S2.T1.5.5.1.m1.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S2.T1.5.5.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.5.5.1.m1.1.1.5" xref="S2.T1.5.5.1.m1.1.1.5.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.5.5.1.m1.1b"><apply id="S2.T1.5.5.1.m1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1"><times id="S2.T1.5.5.1.m1.1.1.2.cmml" xref="S2.T1.5.5.1.m1.1.1.2"></times><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1"><plus id="S2.T1.5.5.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.5.5.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3"><times id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2">𝑘</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4">𝑦</ci></apply></apply><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.5.5.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3"><times id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1"></times><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5">𝑢</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6">𝑒</ci></apply></apply></apply><ci id="S2.T1.5.5.1.m1.1.1.3.cmml" xref="S2.T1.5.5.1.m1.1.1.3">𝐻</ci><ci id="S2.T1.5.5.1.m1.1.1.4.cmml" xref="S2.T1.5.5.1.m1.1.1.4">𝑁</ci><ci id="S2.T1.5.5.1.m1.1.1.5.cmml" xref="S2.T1.5.5.1.m1.1.1.5">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.5.1.m1.1c">(d_{key}+d_{value})\times H\times N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.5.5.1.m1.1d">( italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT ) × italic_H × italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.2"><math alttext="N\times S" class="ltx_Math" display="inline" id="S2.T1.6.6.2.m1.1"><semantics id="S2.T1.6.6.2.m1.1a"><mrow id="S2.T1.6.6.2.m1.1.1" xref="S2.T1.6.6.2.m1.1.1.cmml"><mi id="S2.T1.6.6.2.m1.1.1.2" xref="S2.T1.6.6.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.6.6.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.6.6.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.6.6.2.m1.1.1.3" xref="S2.T1.6.6.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.6.6.2.m1.1b"><apply id="S2.T1.6.6.2.m1.1.1.cmml" xref="S2.T1.6.6.2.m1.1.1"><times id="S2.T1.6.6.2.m1.1.1.1.cmml" xref="S2.T1.6.6.2.m1.1.1.1"></times><ci id="S2.T1.6.6.2.m1.1.1.2.cmml" xref="S2.T1.6.6.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.6.6.2.m1.1.1.3.cmml" xref="S2.T1.6.6.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.6.2.m1.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.6.6.2.m1.1d">italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.4">None</td>
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.5">kNN + dot-product attention</td>
</tr>
<tr class="ltx_tr" id="S2.T1.8.8">
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.3">RMT</td>
<td class="ltx_td ltx_align_left" id="S2.T1.7.7.1"><math alttext="d_{model}\times p\times l\times 2" class="ltx_Math" display="inline" id="S2.T1.7.7.1.m1.1"><semantics id="S2.T1.7.7.1.m1.1a"><mrow id="S2.T1.7.7.1.m1.1.1" xref="S2.T1.7.7.1.m1.1.1.cmml"><msub id="S2.T1.7.7.1.m1.1.1.2" xref="S2.T1.7.7.1.m1.1.1.2.cmml"><mi id="S2.T1.7.7.1.m1.1.1.2.2" xref="S2.T1.7.7.1.m1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.7.7.1.m1.1.1.2.3" xref="S2.T1.7.7.1.m1.1.1.2.3.cmml"><mi id="S2.T1.7.7.1.m1.1.1.2.3.2" xref="S2.T1.7.7.1.m1.1.1.2.3.2.cmml">m</mi><mo id="S2.T1.7.7.1.m1.1.1.2.3.1" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.3" xref="S2.T1.7.7.1.m1.1.1.2.3.3.cmml">o</mi><mo id="S2.T1.7.7.1.m1.1.1.2.3.1a" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.4" xref="S2.T1.7.7.1.m1.1.1.2.3.4.cmml">d</mi><mo id="S2.T1.7.7.1.m1.1.1.2.3.1b" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.5" xref="S2.T1.7.7.1.m1.1.1.2.3.5.cmml">e</mi><mo id="S2.T1.7.7.1.m1.1.1.2.3.1c" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.6" xref="S2.T1.7.7.1.m1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S2.T1.7.7.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.7.7.1.m1.1.1.1.cmml">×</mo><mi id="S2.T1.7.7.1.m1.1.1.3" xref="S2.T1.7.7.1.m1.1.1.3.cmml">p</mi><mo id="S2.T1.7.7.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S2.T1.7.7.1.m1.1.1.1.cmml">×</mo><mi id="S2.T1.7.7.1.m1.1.1.4" xref="S2.T1.7.7.1.m1.1.1.4.cmml">l</mi><mo id="S2.T1.7.7.1.m1.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S2.T1.7.7.1.m1.1.1.1.cmml">×</mo><mn id="S2.T1.7.7.1.m1.1.1.5" xref="S2.T1.7.7.1.m1.1.1.5.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.7.7.1.m1.1b"><apply id="S2.T1.7.7.1.m1.1.1.cmml" xref="S2.T1.7.7.1.m1.1.1"><times id="S2.T1.7.7.1.m1.1.1.1.cmml" xref="S2.T1.7.7.1.m1.1.1.1"></times><apply id="S2.T1.7.7.1.m1.1.1.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.7.7.1.m1.1.1.2.1.cmml" xref="S2.T1.7.7.1.m1.1.1.2">subscript</csymbol><ci id="S2.T1.7.7.1.m1.1.1.2.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2.2">𝑑</ci><apply id="S2.T1.7.7.1.m1.1.1.2.3.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3"><times id="S2.T1.7.7.1.m1.1.1.2.3.1.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.1"></times><ci id="S2.T1.7.7.1.m1.1.1.2.3.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.2">𝑚</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.3.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.3">𝑜</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.4.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.4">𝑑</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.5.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.5">𝑒</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.6.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.6">𝑙</ci></apply></apply><ci id="S2.T1.7.7.1.m1.1.1.3.cmml" xref="S2.T1.7.7.1.m1.1.1.3">𝑝</ci><ci id="S2.T1.7.7.1.m1.1.1.4.cmml" xref="S2.T1.7.7.1.m1.1.1.4">𝑙</ci><cn id="S2.T1.7.7.1.m1.1.1.5.cmml" type="integer" xref="S2.T1.7.7.1.m1.1.1.5">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.7.7.1.m1.1c">d_{model}\times p\times l\times 2</annotation><annotation encoding="application/x-llamapun" id="S2.T1.7.7.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_p × italic_l × 2</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.2"><math alttext="N\times S" class="ltx_Math" display="inline" id="S2.T1.8.8.2.m1.1"><semantics id="S2.T1.8.8.2.m1.1a"><mrow id="S2.T1.8.8.2.m1.1.1" xref="S2.T1.8.8.2.m1.1.1.cmml"><mi id="S2.T1.8.8.2.m1.1.1.2" xref="S2.T1.8.8.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.8.8.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.8.8.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.8.8.2.m1.1.1.3" xref="S2.T1.8.8.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.8.8.2.m1.1b"><apply id="S2.T1.8.8.2.m1.1.1.cmml" xref="S2.T1.8.8.2.m1.1.1"><times id="S2.T1.8.8.2.m1.1.1.1.cmml" xref="S2.T1.8.8.2.m1.1.1.1"></times><ci id="S2.T1.8.8.2.m1.1.1.2.cmml" xref="S2.T1.8.8.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.8.8.2.m1.1.1.3.cmml" xref="S2.T1.8.8.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.8.8.2.m1.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.8.8.2.m1.1d">italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.4">Discarded</td>
<td class="ltx_td ltx_align_left" id="S2.T1.8.8.5">Soft-prompt input</td>
</tr>
<tr class="ltx_tr" id="S2.T1.10.10">
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.3">AutoCompressors</td>
<td class="ltx_td ltx_align_left" id="S2.T1.9.9.1"><math alttext="d_{model}\times p\times(m+1)\times l" class="ltx_Math" display="inline" id="S2.T1.9.9.1.m1.1"><semantics id="S2.T1.9.9.1.m1.1a"><mrow id="S2.T1.9.9.1.m1.1.1" xref="S2.T1.9.9.1.m1.1.1.cmml"><msub id="S2.T1.9.9.1.m1.1.1.3" xref="S2.T1.9.9.1.m1.1.1.3.cmml"><mi id="S2.T1.9.9.1.m1.1.1.3.2" xref="S2.T1.9.9.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.9.9.1.m1.1.1.3.3" xref="S2.T1.9.9.1.m1.1.1.3.3.cmml"><mi id="S2.T1.9.9.1.m1.1.1.3.3.2" xref="S2.T1.9.9.1.m1.1.1.3.3.2.cmml">m</mi><mo id="S2.T1.9.9.1.m1.1.1.3.3.1" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.3" xref="S2.T1.9.9.1.m1.1.1.3.3.3.cmml">o</mi><mo id="S2.T1.9.9.1.m1.1.1.3.3.1a" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.4" xref="S2.T1.9.9.1.m1.1.1.3.3.4.cmml">d</mi><mo id="S2.T1.9.9.1.m1.1.1.3.3.1b" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.5" xref="S2.T1.9.9.1.m1.1.1.3.3.5.cmml">e</mi><mo id="S2.T1.9.9.1.m1.1.1.3.3.1c" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.6" xref="S2.T1.9.9.1.m1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo id="S2.T1.9.9.1.m1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.T1.9.9.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.9.9.1.m1.1.1.4" xref="S2.T1.9.9.1.m1.1.1.4.cmml">p</mi><mo id="S2.T1.9.9.1.m1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.T1.9.9.1.m1.1.1.2.cmml">×</mo><mrow id="S2.T1.9.9.1.m1.1.1.1.1" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.9.9.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.9.9.1.m1.1.1.1.1.1" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml"><mi id="S2.T1.9.9.1.m1.1.1.1.1.1.2" xref="S2.T1.9.9.1.m1.1.1.1.1.1.2.cmml">m</mi><mo id="S2.T1.9.9.1.m1.1.1.1.1.1.1" xref="S2.T1.9.9.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.T1.9.9.1.m1.1.1.1.1.1.3" xref="S2.T1.9.9.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.T1.9.9.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.9.9.1.m1.1.1.2b" rspace="0.222em" xref="S2.T1.9.9.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.9.9.1.m1.1.1.5" xref="S2.T1.9.9.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.9.9.1.m1.1b"><apply id="S2.T1.9.9.1.m1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1"><times id="S2.T1.9.9.1.m1.1.1.2.cmml" xref="S2.T1.9.9.1.m1.1.1.2"></times><apply id="S2.T1.9.9.1.m1.1.1.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.9.9.1.m1.1.1.3.1.cmml" xref="S2.T1.9.9.1.m1.1.1.3">subscript</csymbol><ci id="S2.T1.9.9.1.m1.1.1.3.2.cmml" xref="S2.T1.9.9.1.m1.1.1.3.2">𝑑</ci><apply id="S2.T1.9.9.1.m1.1.1.3.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3"><times id="S2.T1.9.9.1.m1.1.1.3.3.1.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.1"></times><ci id="S2.T1.9.9.1.m1.1.1.3.3.2.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.2">𝑚</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.3">𝑜</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.4.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.4">𝑑</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.5.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.5">𝑒</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.6.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.6">𝑙</ci></apply></apply><ci id="S2.T1.9.9.1.m1.1.1.4.cmml" xref="S2.T1.9.9.1.m1.1.1.4">𝑝</ci><apply id="S2.T1.9.9.1.m1.1.1.1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1"><plus id="S2.T1.9.9.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1.1.1"></plus><ci id="S2.T1.9.9.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1.1.2">𝑚</ci><cn id="S2.T1.9.9.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.T1.9.9.1.m1.1.1.1.1.1.3">1</cn></apply><ci id="S2.T1.9.9.1.m1.1.1.5.cmml" xref="S2.T1.9.9.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.9.9.1.m1.1c">d_{model}\times p\times(m+1)\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.9.9.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT × italic_p × ( italic_m + 1 ) × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.2"><math alttext="N\times S" class="ltx_Math" display="inline" id="S2.T1.10.10.2.m1.1"><semantics id="S2.T1.10.10.2.m1.1a"><mrow id="S2.T1.10.10.2.m1.1.1" xref="S2.T1.10.10.2.m1.1.1.cmml"><mi id="S2.T1.10.10.2.m1.1.1.2" xref="S2.T1.10.10.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.10.10.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.10.10.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.10.10.2.m1.1.1.3" xref="S2.T1.10.10.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.10.10.2.m1.1b"><apply id="S2.T1.10.10.2.m1.1.1.cmml" xref="S2.T1.10.10.2.m1.1.1"><times id="S2.T1.10.10.2.m1.1.1.1.cmml" xref="S2.T1.10.10.2.m1.1.1.1"></times><ci id="S2.T1.10.10.2.m1.1.1.2.cmml" xref="S2.T1.10.10.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.10.10.2.m1.1.1.3.cmml" xref="S2.T1.10.10.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.10.10.2.m1.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.10.10.2.m1.1d">italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.4">Discarded</td>
<td class="ltx_td ltx_align_left" id="S2.T1.10.10.5">Soft-prompt input</td>
</tr>
<tr class="ltx_tr" id="S2.T1.12.12">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.12.12.3">Infini-Transformers</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.11.11.1"><math alttext="d_{key}\times(d_{value}+1)\times H\times l" class="ltx_Math" display="inline" id="S2.T1.11.11.1.m1.1"><semantics id="S2.T1.11.11.1.m1.1a"><mrow id="S2.T1.11.11.1.m1.1.1" xref="S2.T1.11.11.1.m1.1.1.cmml"><msub id="S2.T1.11.11.1.m1.1.1.3" xref="S2.T1.11.11.1.m1.1.1.3.cmml"><mi id="S2.T1.11.11.1.m1.1.1.3.2" xref="S2.T1.11.11.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.11.11.1.m1.1.1.3.3" xref="S2.T1.11.11.1.m1.1.1.3.3.cmml"><mi id="S2.T1.11.11.1.m1.1.1.3.3.2" xref="S2.T1.11.11.1.m1.1.1.3.3.2.cmml">k</mi><mo id="S2.T1.11.11.1.m1.1.1.3.3.1" xref="S2.T1.11.11.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.3.3.3" xref="S2.T1.11.11.1.m1.1.1.3.3.3.cmml">e</mi><mo id="S2.T1.11.11.1.m1.1.1.3.3.1a" xref="S2.T1.11.11.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.3.3.4" xref="S2.T1.11.11.1.m1.1.1.3.3.4.cmml">y</mi></mrow></msub><mo id="S2.T1.11.11.1.m1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.T1.11.11.1.m1.1.1.2.cmml">×</mo><mrow id="S2.T1.11.11.1.m1.1.1.1.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml"><mo id="S2.T1.11.11.1.m1.1.1.1.1.2" stretchy="false" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.11.11.1.m1.1.1.1.1.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml"><msub id="S2.T1.11.11.1.m1.1.1.1.1.1.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2.cmml">v</mi><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3.cmml">a</mi><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1a" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4.cmml">l</mi><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1b" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5.cmml">u</mi><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1c" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6.cmml">e</mi></mrow></msub><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.T1.11.11.1.m1.1.1.1.1.1.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.T1.11.11.1.m1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.T1.11.11.1.m1.1.1.2a" rspace="0.222em" xref="S2.T1.11.11.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.11.11.1.m1.1.1.4" xref="S2.T1.11.11.1.m1.1.1.4.cmml">H</mi><mo id="S2.T1.11.11.1.m1.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S2.T1.11.11.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.11.11.1.m1.1.1.5" xref="S2.T1.11.11.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.11.11.1.m1.1b"><apply id="S2.T1.11.11.1.m1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1"><times id="S2.T1.11.11.1.m1.1.1.2.cmml" xref="S2.T1.11.11.1.m1.1.1.2"></times><apply id="S2.T1.11.11.1.m1.1.1.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.11.11.1.m1.1.1.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.3">subscript</csymbol><ci id="S2.T1.11.11.1.m1.1.1.3.2.cmml" xref="S2.T1.11.11.1.m1.1.1.3.2">𝑑</ci><apply id="S2.T1.11.11.1.m1.1.1.3.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3"><times id="S2.T1.11.11.1.m1.1.1.3.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.1"></times><ci id="S2.T1.11.11.1.m1.1.1.3.3.2.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.2">𝑘</ci><ci id="S2.T1.11.11.1.m1.1.1.3.3.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.3">𝑒</ci><ci id="S2.T1.11.11.1.m1.1.1.3.3.4.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.4">𝑦</ci></apply></apply><apply id="S2.T1.11.11.1.m1.1.1.1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1"><plus id="S2.T1.11.11.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.11.11.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.11.11.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3"><times id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2">𝑣</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3">𝑎</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4">𝑙</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5">𝑢</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6">𝑒</ci></apply></apply><cn id="S2.T1.11.11.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.T1.11.11.1.m1.1.1.1.1.1.3">1</cn></apply><ci id="S2.T1.11.11.1.m1.1.1.4.cmml" xref="S2.T1.11.11.1.m1.1.1.4">𝐻</ci><ci id="S2.T1.11.11.1.m1.1.1.5.cmml" xref="S2.T1.11.11.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.11.11.1.m1.1c">d_{key}\times(d_{value}+1)\times H\times l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.11.11.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT × ( italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT + 1 ) × italic_H × italic_l</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.12.12.2"><math alttext="N\times S" class="ltx_Math" display="inline" id="S2.T1.12.12.2.m1.1"><semantics id="S2.T1.12.12.2.m1.1a"><mrow id="S2.T1.12.12.2.m1.1.1" xref="S2.T1.12.12.2.m1.1.1.cmml"><mi id="S2.T1.12.12.2.m1.1.1.2" xref="S2.T1.12.12.2.m1.1.1.2.cmml">N</mi><mo id="S2.T1.12.12.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.12.12.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.12.12.2.m1.1.1.3" xref="S2.T1.12.12.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.12.12.2.m1.1b"><apply id="S2.T1.12.12.2.m1.1.1.cmml" xref="S2.T1.12.12.2.m1.1.1"><times id="S2.T1.12.12.2.m1.1.1.1.cmml" xref="S2.T1.12.12.2.m1.1.1.1"></times><ci id="S2.T1.12.12.2.m1.1.1.2.cmml" xref="S2.T1.12.12.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.12.12.2.m1.1.1.3.cmml" xref="S2.T1.12.12.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.12.12.2.m1.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.12.12.2.m1.1d">italic_N × italic_S</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.12.12.4">Incremental</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S2.T1.12.12.5">Linear attention</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 1:</span>세그먼트-레벨 메모리를 갖는 트랜스포머 모델들이 비교된다. 각 모델에 대해, 메모리 크기 및 유효 컨텍스트 길이는 그들의 모델 파라미터(<math alttext="N" class="ltx_Math" display="inline" id="S2.T1.21.m1.1"><semantics id="S2.T1.21.m1.1b"><mi id="S2.T1.21.m1.1.1" xref="S2.T1.21.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.T1.21.m1.1c"><ci id="S2.T1.21.m1.1.1.cmml" xref="S2.T1.21.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.21.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="S2.T1.21.m1.1e">italic_N</annotation></semantics></math>: 입력 세그먼트 길이, <math alttext="S" class="ltx_Math" display="inline" id="S2.T1.22.m2.1"><semantics id="S2.T1.22.m2.1b"><mi id="S2.T1.22.m2.1.1" xref="S2.T1.22.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.T1.22.m2.1c"><ci id="S2.T1.22.m2.1.1.cmml" xref="S2.T1.22.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.22.m2.1d">S</annotation><annotation encoding="application/x-llamapun" id="S2.T1.22.m2.1e">italic_S</annotation></semantics></math>: 세그먼트 수, <math alttext="l" class="ltx_Math" display="inline" id="S2.T1.23.m3.1"><semantics id="S2.T1.23.m3.1b"><mi id="S2.T1.23.m3.1.1" xref="S2.T1.23.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.T1.23.m3.1c"><ci id="S2.T1.23.m3.1.1.cmml" xref="S2.T1.23.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.23.m3.1d">l</annotation><annotation encoding="application/x-llamapun" id="S2.T1.23.m3.1e">italic_l</annotation></semantics></math>: 레이어 수, <math alttext="H" class="ltx_Math" display="inline" id="S2.T1.24.m4.1"><semantics id="S2.T1.24.m4.1b"><mi id="S2.T1.24.m4.1.1" xref="S2.T1.24.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.T1.24.m4.1c"><ci id="S2.T1.24.m4.1.1.cmml" xref="S2.T1.24.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.24.m4.1d">H</annotation><annotation encoding="application/x-llamapun" id="S2.T1.24.m4.1e">italic_H</annotation></semantics></math>: 어텐션 헤드 수, <math alttext="c" class="ltx_Math" display="inline" id="S2.T1.25.m5.1"><semantics id="S2.T1.25.m5.1b"><mi id="S2.T1.25.m5.1.1" xref="S2.T1.25.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.T1.25.m5.1c"><ci id="S2.T1.25.m5.1.1.cmml" xref="S2.T1.25.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.25.m5.1d">c</annotation><annotation encoding="application/x-llamapun" id="S2.T1.25.m5.1e">italic_c</annotation></semantics></math>: 압축 트랜스포머 메모리 크기, <math alttext="r" class="ltx_Math" display="inline" id="S2.T1.26.m6.1"><semantics id="S2.T1.26.m6.1b"><mi id="S2.T1.26.m6.1.1" xref="S2.T1.26.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.T1.26.m6.1c"><ci id="S2.T1.26.m6.1.1.cmml" xref="S2.T1.26.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.26.m6.1d">r</annotation><annotation encoding="application/x-llamapun" id="S2.T1.26.m6.1e">italic_r</annotation></semantics></math>: 압축 비율, <math alttext="p" class="ltx_Math" display="inline" id="S2.T1.27.m7.1"><semantics id="S2.T1.27.m7.1b"><mi id="S2.T1.27.m7.1.1" xref="S2.T1.27.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.T1.27.m7.1c"><ci id="S2.T1.27.m7.1.1.cmml" xref="S2.T1.27.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.27.m7.1d">p</annotation><annotation encoding="application/x-llamapun" id="S2.T1.27.m7.1e">italic_p</annotation></semantics></math>: 소프트 프롬프트 요약 벡터의 수 및 <math alttext="m" class="ltx_Math" display="inline" id="S2.T1.28.m8.1"><semantics id="S2.T1.28.m8.1b"><mi id="S2.T1.28.m8.1.1" xref="S2.T1.28.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.T1.28.m8.1c"><ci id="S2.T1.28.m8.1.1.cmml" xref="S2.T1.28.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.28.m8.1d">m</annotation><annotation encoding="application/x-llamapun" id="S2.T1.28.m8.1e">italic_m</annotation></semantics></math>: 요약 벡터 축적 단계)의 관점에서 정의된다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.3">인피니-트랜스포머는 메모리 풋프린트가 제한된 무한 컨텍스트 창을 사용할 수 있습니다. 이를 설명하기 위해 표 <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.T1" title="Table 1 ‣ 2.2 Memory and Effective Context Window ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">1</span></a>는 모델 파라미터 및 입력 세그먼트 길이의 관점에서 정의된 컨텍스트-메모리 풋프린트 및 유효 컨텍스트 길이를 갖는 이전 세그먼트 레벨 메모리 모델들을 나열한다. Infini-Transformer는 단일 레이어에서 각 헤드에 대해 <math alttext="M_{s}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">M</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝑀</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">M_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> 및 <math alttext="z_{s}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><msub id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">z</mi><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝑧</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">z_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>의 압축된 컨텍스트를 저장하기 위한 <math alttext="d_{key}\times d_{value}+d_{key}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mrow id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml"><msub id="S2.SS2.p1.1.m1.1.1.2.2" xref="S2.SS2.p1.1.m1.1.1.2.2.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.2.2" xref="S2.SS2.p1.1.m1.1.1.2.2.2.cmml">d</mi><mrow id="S2.SS2.p1.1.m1.1.1.2.2.3" xref="S2.SS2.p1.1.m1.1.1.2.2.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.2.3.2" xref="S2.SS2.p1.1.m1.1.1.2.2.3.2.cmml">k</mi><mo id="S2.SS2.p1.1.m1.1.1.2.2.3.1" xref="S2.SS2.p1.1.m1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.2.3.3" xref="S2.SS2.p1.1.m1.1.1.2.2.3.3.cmml">e</mi><mo id="S2.SS2.p1.1.m1.1.1.2.2.3.1a" xref="S2.SS2.p1.1.m1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.2.3.4" xref="S2.SS2.p1.1.m1.1.1.2.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.SS2.p1.1.m1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.1.m1.1.1.2.1.cmml">×</mo><msub id="S2.SS2.p1.1.m1.1.1.2.3" xref="S2.SS2.p1.1.m1.1.1.2.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.3.2" xref="S2.SS2.p1.1.m1.1.1.2.3.2.cmml">d</mi><mrow id="S2.SS2.p1.1.m1.1.1.2.3.3" xref="S2.SS2.p1.1.m1.1.1.2.3.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.2" xref="S2.SS2.p1.1.m1.1.1.2.3.3.2.cmml">v</mi><mo id="S2.SS2.p1.1.m1.1.1.2.3.3.1" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.3" xref="S2.SS2.p1.1.m1.1.1.2.3.3.3.cmml">a</mi><mo id="S2.SS2.p1.1.m1.1.1.2.3.3.1a" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.4" xref="S2.SS2.p1.1.m1.1.1.2.3.3.4.cmml">l</mi><mo id="S2.SS2.p1.1.m1.1.1.2.3.3.1b" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.5" xref="S2.SS2.p1.1.m1.1.1.2.3.3.5.cmml">u</mi><mo id="S2.SS2.p1.1.m1.1.1.2.3.3.1c" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.6" xref="S2.SS2.p1.1.m1.1.1.2.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">+</mo><msub id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.SS2.p1.1.m1.1.1.3.3" xref="S2.SS2.p1.1.m1.1.1.3.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.3.2" xref="S2.SS2.p1.1.m1.1.1.3.3.2.cmml">k</mi><mo id="S2.SS2.p1.1.m1.1.1.3.3.1" xref="S2.SS2.p1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.3.3.3" xref="S2.SS2.p1.1.m1.1.1.3.3.3.cmml">e</mi><mo id="S2.SS2.p1.1.m1.1.1.3.3.1a" xref="S2.SS2.p1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.3.3.4" xref="S2.SS2.p1.1.m1.1.1.3.3.4.cmml">y</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><plus id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></plus><apply id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"><times id="S2.SS2.p1.1.m1.1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.1"></times><apply id="S2.SS2.p1.1.m1.1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.2.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.2">𝑑</ci><apply id="S2.SS2.p1.1.m1.1.1.2.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3"><times id="S2.SS2.p1.1.m1.1.1.2.2.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.2">𝑘</ci><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.3">𝑒</ci><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.4.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.4">𝑦</ci></apply></apply><apply id="S2.SS2.p1.1.m1.1.1.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.2.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.2">𝑑</ci><apply id="S2.SS2.p1.1.m1.1.1.2.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3"><times id="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.2">𝑣</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.3">𝑎</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.4.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.4">𝑙</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.5.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.5">𝑢</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.6.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.6">𝑒</ci></apply></apply></apply><apply id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.2">𝑑</ci><apply id="S2.SS2.p1.1.m1.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3"><times id="S2.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.2">𝑘</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.3">𝑒</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3.4.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.4">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">d_{key}\times d_{value}+d_{key}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT</annotation></semantics></math>의 일정한 메모리 복잡도를 갖는 반면, 다른 모델의 경우 시퀀스 차원과 함께 복잡도가 증가한다 - 메모리 복잡도는 Transformer-XL<cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib14" title="">2019</a>)</cite>, Compressive Transformer<cite class="ltx_cite ltx_citemacro_citep">(Rae et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib41" title="">2019</a>)</cite> 및 Memorizing Transformers<cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite>에 대한 캐시 크기 또는 RTM<cite class="ltx_cite ltx_citemacro_citep">(Bulatov et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib7" title="">2022</a>)</cite> 및 AutoCompressors<cite class="ltx_cite ltx_citemacro_citep">(Ge et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib18" title="">2023</a>)</cite>에 대한 소프트-프롬프트 크기에 따라 달라진다.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="288" id="S2.F3.g1" src="https://arxiv.org/html/2404.07143v1/x3.png" width="304">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 3:</span> 훈련 후 Infini-attention에서 나타난 두 가지 유형의 헤드가 있습니다: 0 또는 1에 가까운 게이팅 점수를 가진 특수 헤드와 0.5에 가까운 점수를 가진 믹서 헤드입니다. 특수 헤드는 로컬 어텐션 메커니즘을 통해 컨텍스트 정보를 처리하거나 압축 메모리에서 검색하는 반면 믹서 헤드는 현재 컨텍스트 정보와 장기 메모리 콘텐츠를 함께 단일 출력으로 통합합니다.</figcaption><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>There are two types of heads emerged in Infini-attention after training: specialized heads with gating score near 0 or 1 and mixer heads with score close to 0.5. The specialized heads either process contextual information via the local attention mechanism or retrieve from the compressive memory whereas the mixer heads aggregate both current contextual information and long-term memory content together into single output.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.5">트랜스포머-XL은 현재 상태들 외에 마지막 세그먼트로부터 캐시된 KV 상태들에 대한 주의를 계산한다. 이는 각 계층에 대해 수행되기 때문에, Transformer-XL은 컨텍스트 윈도우를 <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_N</annotation></semantics></math>에서 <math alttext="N\times l" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">N</mi><mo id="S2.SS2.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.2.m2.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><times id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"></times><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑁</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">N\times l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_N × italic_l</annotation></semantics></math> 토큰으로 확장하고, 추가 메모리 풋프린트는 <math alttext="(d_{key}+d_{value})\times H\times N\times l" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mrow id="S2.SS2.p2.3.m3.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml"><msub id="S2.SS2.p2.3.m3.1.1.1.1.1.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3.cmml">e</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1a" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml">+</mo><msub id="S2.SS2.p2.3.m3.1.1.1.1.1.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2.cmml">v</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3.cmml">a</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1a" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4.cmml">l</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1b" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5.cmml">u</mi><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1c" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S2.SS2.p2.3.m3.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS2.p2.3.m3.1.1.2" rspace="0.222em" xref="S2.SS2.p2.3.m3.1.1.2.cmml">×</mo><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">H</mi><mo id="S2.SS2.p2.3.m3.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.3.m3.1.1.2.cmml">×</mo><mi id="S2.SS2.p2.3.m3.1.1.4" xref="S2.SS2.p2.3.m3.1.1.4.cmml">N</mi><mo id="S2.SS2.p2.3.m3.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.3.m3.1.1.2.cmml">×</mo><mi id="S2.SS2.p2.3.m3.1.1.5" xref="S2.SS2.p2.3.m3.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><times id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"></times><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1"><plus id="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1"></plus><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3"><times id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1"></times><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2">𝑘</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4">𝑦</ci></apply></apply><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3"><times id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1"></times><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5">𝑢</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6">𝑒</ci></apply></apply></apply><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝐻</ci><ci id="S2.SS2.p2.3.m3.1.1.4.cmml" xref="S2.SS2.p2.3.m3.1.1.4">𝑁</ci><ci id="S2.SS2.p2.3.m3.1.1.5.cmml" xref="S2.SS2.p2.3.m3.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">(d_{key}+d_{value})\times H\times N\times l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">( italic_d start_POSTSUBSCRIPT italic_k italic_e italic_y end_POSTSUBSCRIPT + italic_d start_POSTSUBSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUBSCRIPT ) × italic_H × italic_N × italic_l</annotation></semantics></math>이다. 압축 트랜스포머는 트랜스포머-XL에 두 번째 캐시를 추가하고 과거 세그먼트 활성화의 압축된 표현을 저장한다. 따라서 Transformer-XL의 컨텍스트 창을 <math alttext="c\times r\times l" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">c</mi><mo id="S2.SS2.p2.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.4.m4.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">r</mi><mo id="S2.SS2.p2.4.m4.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.4.m4.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.4.m4.1.1.4" xref="S2.SS2.p2.4.m4.1.1.4.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><times id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"></times><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝑐</ci><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝑟</ci><ci id="S2.SS2.p2.4.m4.1.1.4.cmml" xref="S2.SS2.p2.4.m4.1.1.4">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">c\times r\times l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_c × italic_r × italic_l</annotation></semantics></math>로 확장하지만 여전히 컨텍스트-메모리 복잡도가 크다. 더 나아가, 기억 트랜스포머는 입력 시퀀스에 대한 컨텍스트로서 전체 KV 상태를 저장하도록 선택한다. 이 경우 스토리지가 엄청나게 비싸지기 때문에 컨텍스트 계산을 단일 계층으로만 제한합니다. 고속 kNN 리트리버를 이용함으로써, 메모리라이징 트랜스포머는 증가된 스토리지 비용으로 길이 <math alttext="N\times S" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.1"><semantics id="S2.SS2.p2.5.m5.1a"><mrow id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">N</mi><mo id="S2.SS2.p2.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.5.m5.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><times id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1"></times><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝑁</ci><ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">N\times S</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">italic_N × italic_S</annotation></semantics></math>의 전체 시퀀스 히스토리를 커버하는 컨텍스트 윈도우를 구축한다. 실험 결과, Infini-Transformer LM은 Memorizing Transformer 위에 100배 이상의 압축률을 얻을 수 있었으며, 복잡도 점수를 더욱 향상시킬 수 있었다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">RMT 및 오토컴프레서는 입력을 요약 벡터로 압축한 다음 후속 세그먼트에 대한 추가 소프트 프롬프트 입력으로 전달하기 때문에 잠재적으로 무한한 컨텍스트 길이를 허용한다. 그러나 실제로 이러한 기술의 성공은 소프트 프롬프트 벡터의 크기에 크게 의존한다. 즉, AutoCompressors<cite class="ltx_cite ltx_citemacro_citep">(Chevalier et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib11" title="">2023</a>)</cite>를 사용하여 더 나은 성능을 얻기 위해서는 소프트 프롬프트(summary) 벡터의 수를 증가시켜야 하며, 이를 통해 메모리와 컴퓨팅 복잡도가 빠르게 증가하여 효율성이 감소한다. AutoCompressors <cite class="ltx_cite ltx_citemacro_citep">(Chevalier et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib11" title="">2023</a>)</cite>에서도 이러한 신속한 압축 기법들을 훈련하기 위해서는 효율적인 압축 목적이 필요하다는 것이 관찰되었다.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">본 논문에서 제안하는 Infini-Transformer 모델은 매우 긴 입력 시퀀스(long-context language modeling, 1M length passkey context block retrieval, 500K length book summary)를 포함하는 벤치마크에 대해 평가하였다. 언어 모델링 벤치마크의 경우 모델을 처음부터 훈련하는 반면 패스키 및 책 요약 작업의 경우 기존 LLM을 지속적으로 사전 훈련하여 접근 방식의 플러그 앤 플레이 긴 컨텍스트 적응 능력을 강조한다.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Long-context Language Modeling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">우리는 PG19<cite class="ltx_cite ltx_citemacro_citep">(Rae et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib41" title="">2019</a>)</cite> 및 Arxiv-math<cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite> 벤치마크에서 작은 Infini-Transformer 모델을 훈련하고 평가했다. 우리의 설정은 Memorizing Transformers <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite>의 설정과 매우 유사하다. 즉, 모든 모델에는 12개의 레이어와 128차원의 8개의 어텐션 헤드가 있으며 은닉 레이어 4096이 있는 FFN이 있다.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.1.1">Model</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.2">Memory size (comp.)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.3">XL cache</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.4">Segment length</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.5">PG19</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.6">Arxiv-math</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.1">Transformer-XL</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.2">50M (3.7x)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.3">2048</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.4">2048</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.5">11.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.6">2.42</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.3">
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.3.1">Memorizing Transformers</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.2">183M (1x)</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.3">2048</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.4">2048</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.5">11.37</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.6">2.26</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.4">
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.1">RMT</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.2">2.5M (73x)</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.3">None</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.4">2048</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.5">13.27</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.6">2.55</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.1">Infini-Transformer (Linear)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.2">1.6M (114x)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.3">None</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.4">2048</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.5"><span class="ltx_text ltx_font_bold" id="S3.T2.1.5.5.5.1">9.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.6">2.24</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.6.6.1">Infini-Transformer (Linear + Delta)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.2">1.6M (114x)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.3">None</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.4">2048</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.5">9.67</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.6.6.6"><span class="ltx_text ltx_font_bold" id="S3.T2.1.6.6.6.1">2.23</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 2: </span>Long-context 언어 모델링 결과를 평균 토큰 수준의 perplexity 측면에서 비교한다. Comp.는 압축비를 나타낸다. 인피니-트랜스포머는 메모리 길이가 65K인 암기 트랜스포머를 능가하며, 114배 압축률을 달성한다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">모든 어텐션 레이어에 대해 인피니-어텐션 세그먼트 길이 <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_N</annotation></semantics></math>를 2048로, 트레이닝을 위해 입력 시퀀스 길이를 32768로 설정하였다. 이를 통해 인피니 어텐션은 압축 메모리 상태에서 16단계에 걸쳐 롤을 풀 수 있다. RMT 기준선의 경우 요약 프롬프트 길이 50, 100 및 150과 시퀀스 길이 4096, 8196 및 32768을 사용하여 여러 번의 실행을 수행했다. 요약 벡터 100개를 사용한 RMT는 8196개의 길이 시퀀스에 대해 훈련되었을 때 가장 좋은 결과를 제공했다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">언어 모델링 실험의 주요 결과는 표 <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.T2" title="Table 2 ‣ 3.1 Long-context Language Modeling ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">2</span></a>에 요약되어 있다. 우리의 Infini-Transformer는 그 <math alttext="9^{th}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msup id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mn id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">9</mn><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">superscript</csymbol><cn id="S3.SS1.p3.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.2">9</cn><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><times id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">𝑡</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">9^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">9 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> 계층에서 길이가 65K인 벡터 검색 기반 KV 메모리를 가진 Memorizing Transformer 모델보다 114x 적은 메모리 파라미터를 유지하면서 Transformer-XL<cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib14" title="">2019</a>)</cite>와 Memorizing Transformers<cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite> 베이스라인을 모두 능가한다.</p>
</div>
<figure class="ltx_table" id="S3.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S3.T3.1.1.1.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S3.T3.1.1.1.2">Zero-shot</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T3.1.2.2.1"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.2">32K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.3">128K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.4">256K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.5">512K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.2.6">1M</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T3.1.3.3.1">Infini-Transformer (Linear)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.2">14/13/98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.3">11/14/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.4">6/3/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.5">6/7/99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.3.6">8/6/98</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.1.4.4.1">Infini-Transformer (Linear + Delta)</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.2">13/11/99</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.3">6/9/99</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.4">7/5/99</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.5">6/8/97</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.4.6">7/6/97</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.5.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S3.T3.1.5.5.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S3.T3.1.5.5.2">FT (400 steps)</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.1.6.6.1">Infini-Transformer (Linear)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.2">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.3">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.4">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.5">97/99/100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.6.6.6">96/94/100</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T3.1.7.7.1">Infini-Transformer (Linear + Delta)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.2">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.3">100/100/99</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.4">100/100/99</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.5">100/100/100</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.7.7.6">100/100/100</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 3:</span>Infini-Transformers는 5K 길이 입력에서 미세 조정될 때 최대 1M 컨텍스트 길이로 패스키 작업을 해결했습니다. 길이가 32K에서 1M인 긴 입력의 다른 부분(<span class="ltx_text ltx_font_italic" id="S3.T3.3.1">start/middle/end</span>)에 숨겨진 패스키에 대한 토큰 수준 검색 정확도를 보고한다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.1">100K length training. </span> 훈련 시퀀스 길이를 32K에서 100K로 더 늘리고 Arxiv-math 데이터셋에서 모델을 훈련시켰다. 100K 훈련은 퍼플렉시티 점수를 <span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.2">2.21</span> 및 <span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.3">2.20</span> <math alttext="Linear" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">L</mi><mo id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">i</mi><mo id="S3.SS1.p4.1.m1.1.1.1a" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.4" xref="S3.SS1.p4.1.m1.1.1.4.cmml">n</mi><mo id="S3.SS1.p4.1.m1.1.1.1b" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.5" xref="S3.SS1.p4.1.m1.1.1.5.cmml">e</mi><mo id="S3.SS1.p4.1.m1.1.1.1c" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.6" xref="S3.SS1.p4.1.m1.1.1.6.cmml">a</mi><mo id="S3.SS1.p4.1.m1.1.1.1d" xref="S3.SS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.7" xref="S3.SS1.p4.1.m1.1.1.7.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><times id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"></times><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝐿</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝑖</ci><ci id="S3.SS1.p4.1.m1.1.1.4.cmml" xref="S3.SS1.p4.1.m1.1.1.4">𝑛</ci><ci id="S3.SS1.p4.1.m1.1.1.5.cmml" xref="S3.SS1.p4.1.m1.1.1.5">𝑒</ci><ci id="S3.SS1.p4.1.m1.1.1.6.cmml" xref="S3.SS1.p4.1.m1.1.1.6">𝑎</ci><ci id="S3.SS1.p4.1.m1.1.1.7.cmml" xref="S3.SS1.p4.1.m1.1.1.7">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">Linear</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_L italic_i italic_n italic_e italic_a italic_r</annotation></semantics></math> 및 <math alttext="Linear+Delta" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mrow id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2.2" xref="S3.SS1.p4.2.m2.1.1.2.2.cmml">L</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.3" xref="S3.SS1.p4.2.m2.1.1.2.3.cmml">i</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1a" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.4" xref="S3.SS1.p4.2.m2.1.1.2.4.cmml">n</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1b" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.5" xref="S3.SS1.p4.2.m2.1.1.2.5.cmml">e</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1c" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.6" xref="S3.SS1.p4.2.m2.1.1.2.6.cmml">a</mi><mo id="S3.SS1.p4.2.m2.1.1.2.1d" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.2.7" xref="S3.SS1.p4.2.m2.1.1.2.7.cmml">r</mi></mrow><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">+</mo><mrow id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml"><mi id="S3.SS1.p4.2.m2.1.1.3.2" xref="S3.SS1.p4.2.m2.1.1.3.2.cmml">D</mi><mo id="S3.SS1.p4.2.m2.1.1.3.1" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.3.3" xref="S3.SS1.p4.2.m2.1.1.3.3.cmml">e</mi><mo id="S3.SS1.p4.2.m2.1.1.3.1a" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.3.4" xref="S3.SS1.p4.2.m2.1.1.3.4.cmml">l</mi><mo id="S3.SS1.p4.2.m2.1.1.3.1b" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.3.5" xref="S3.SS1.p4.2.m2.1.1.3.5.cmml">t</mi><mo id="S3.SS1.p4.2.m2.1.1.3.1c" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.2.m2.1.1.3.6" xref="S3.SS1.p4.2.m2.1.1.3.6.cmml">a</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><plus id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></plus><apply id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2"><times id="S3.SS1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.2.1"></times><ci id="S3.SS1.p4.2.m2.1.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2.2">𝐿</ci><ci id="S3.SS1.p4.2.m2.1.1.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3">𝑖</ci><ci id="S3.SS1.p4.2.m2.1.1.2.4.cmml" xref="S3.SS1.p4.2.m2.1.1.2.4">𝑛</ci><ci id="S3.SS1.p4.2.m2.1.1.2.5.cmml" xref="S3.SS1.p4.2.m2.1.1.2.5">𝑒</ci><ci id="S3.SS1.p4.2.m2.1.1.2.6.cmml" xref="S3.SS1.p4.2.m2.1.1.2.6">𝑎</ci><ci id="S3.SS1.p4.2.m2.1.1.2.7.cmml" xref="S3.SS1.p4.2.m2.1.1.2.7">𝑟</ci></apply><apply id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3"><times id="S3.SS1.p4.2.m2.1.1.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.1"></times><ci id="S3.SS1.p4.2.m2.1.1.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2">𝐷</ci><ci id="S3.SS1.p4.2.m2.1.1.3.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3">𝑒</ci><ci id="S3.SS1.p4.2.m2.1.1.3.4.cmml" xref="S3.SS1.p4.2.m2.1.1.3.4">𝑙</ci><ci id="S3.SS1.p4.2.m2.1.1.3.5.cmml" xref="S3.SS1.p4.2.m2.1.1.3.5">𝑡</ci><ci id="S3.SS1.p4.2.m2.1.1.3.6.cmml" xref="S3.SS1.p4.2.m2.1.1.3.6">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">Linear+Delta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_L italic_i italic_n italic_e italic_a italic_r + italic_D italic_e italic_l italic_t italic_a</annotation></semantics></math> 모델에 대해 더 감소시켰다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p5.1.1">Gating score visualization. </span> Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S2.F3" title="Figure 3 ‣ 2.2 Memory and Effective Context Window ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">3</span></a>는 각 레이어에서 모든 어텐션 헤드에 대한 압축 메모리에 대해 게이팅 스코어, <math alttext="\textit{sigmoid}(\beta)" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><mrow id="S3.SS1.p5.1.m1.1.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mtext id="S3.SS1.p5.1.m1.1.2.2" xref="S3.SS1.p5.1.m1.1.2.2a.cmml">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext><mo id="S3.SS1.p5.1.m1.1.2.1" xref="S3.SS1.p5.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p5.1.m1.1.2.3.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mo id="S3.SS1.p5.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p5.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">β</mi><mo id="S3.SS1.p5.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.2"><times id="S3.SS1.p5.1.m1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.2.1"></times><ci id="S3.SS1.p5.1.m1.1.2.2a.cmml" xref="S3.SS1.p5.1.m1.1.2.2"><mtext id="S3.SS1.p5.1.m1.1.2.2.cmml" xref="S3.SS1.p5.1.m1.1.2.2">𝑠𝑖𝑔𝑚𝑜𝑖𝑑</mtext></ci><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\textit{sigmoid}(\beta)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">sigmoid ( italic_β )</annotation></semantics></math>를 시각화하고 있다. 훈련 후 인피니-어텐션에는 게이팅 점수가 0 또는 1에 가까운 특수 헤드와 점수가 0.5에 가까운 믹서 헤드가 있다. 특수 헤드는 로컬 어텐션 계산을 통해 컨텍스트 정보를 처리하거나 압축 메모리에서 검색하는 반면 믹서 헤드는 현재 컨텍스트 정보와 장기 메모리 콘텐츠를 단일 출력으로 통합한다. 흥미롭게도, 각 층은 적어도 하나의 단거리 헤드를 가지며, 출력 층까지 입력 신호의 순방향 전파를 허용한다. 우리는 또한 순방향 계산 동안 장단기 콘텐츠 검색의 인터리빙을 관찰했다.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>LLM Continual Pre-training</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S3.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T4.1.1.1.1">Model</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.1.1.1.2">Rouge-1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.1.1.1.3">Rouge-2</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.1.1.1.4">Rouge-L</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.1.1.1.5">Overall</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T4.1.2.2.1">BART</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.2.2">36.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.2.3">7.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.2.4">15.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.2.5">16.2</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T4.1.3.3.1">BART + Unlimiformer</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.3.2">36.8</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.3.3">8.3</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.3.4">15.7</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.3.5">16.9</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T4.1.4.4.1">PRIMERA</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.2">38.6</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.3">7.2</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.4">15.6</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.4.5">16.3</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T4.1.5.5.1">PRIMERA + Unlimiformer</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.2">37.9</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.3">8.2</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.4">16.3</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.5.5.5">17.2</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T4.1.6.6.1">Infini-Transformers (Linear)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.6.6.2">37.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.6.6.3">8.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.6.6.4">17.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.6.6.5">18.0</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T4.1.7.7.1">Infini-Transformers (Linear + Delta)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.7.7.2"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.2.1">40.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.3.1">8.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.7.7.4"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.4.1">17.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.7.7.5"><span class="ltx_text ltx_font_bold" id="S3.T4.1.7.7.5.1">18.5</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">표 4: </span>500K 길이 책 요약(BookSum) 결과. BART, PRIMERA 및 Unlimiformer 결과는 <cite class="ltx_cite ltx_citemacro_citet">Bertsch et al. (<a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib5" title="">2024</a>)</cite>에서 나왔다.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">기존 LLM의 긴 컨텍스트 적응을 위해 가벼운 연속 사전 훈련을 수행했다. 사전 학습 데이터는 PG19 및 Arxiv-math 말뭉치뿐만 아니라 길이가 4K 토큰 이상인 C4 텍스트 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib42" title="">2020</a>)</cite>를 포함한다. 세그먼트 길이 <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_N</annotation></semantics></math>는 실험 전반에 걸쳐 2K로 설정되었다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">1M 패스키 검색 벤치마크. </span> 1B LLM에서 바닐라 MHA를 Infini-attention으로 교체하고 길이가 4K인 입력에 대해 사전 훈련을 계속했다. 모델은 패스키 검색 태스크 <cite class="ltx_cite ltx_citemacro_citep">(Mohtashami &amp; Jaggi, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib32" title="">2024</a>)</cite>에서 미세 조정하기 전에 배치 크기가 64인 30K 단계에 대해 훈련되었다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">패스키 태스크는 난수를 긴 텍스트로 숨기고 모델 출력에서 다시 묻는다. 분산 텍스트의 길이는 텍스트 청크를 여러 번 반복함으로써 가변된다. 이전 작업 <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib8" title="">2023a</a>)</cite>는 8B LLaMA 모델이 Position Interpolation을 사용하여 동일한 32K 길이의 입력으로 미세 조정될 때 최대 32K 길이의 작업을 해결할 수 있음을 보여주었다. 우리는 이 도전을 더 취하고 1M 길이 체제에 대해 테스트하기 위해 5K 길이 입력에서만 미세 조정한다.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="222" id="S3.F4.g1" src="https://arxiv.org/html/2404.07143v1/x4.png" width="342">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4:</span>Infini-Transformers obtain better Rouge overall scores with more book text provided as input.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">표 <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.T3" title="Table 3 ‣ 3.1 Long-context Language Modeling ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">3</span></a>는 입력 길이 범위가 32K에서 1M인 테스트 하위 집합에 대한 토큰 수준 정확도를 보고합니다. 각 테스트 서브세트에 대해 입력 시퀀스의 시작, 중간 또는 끝 주위에 위치하도록 패스키의 위치를 제어했다. 우리는 제로 샷 정확도와 미세 조정 정확도를 모두 보고했다. 인피니-트랜스포머는 400단계 동안 5K 길이 입력에서 미세 조정 후 최대 1M 컨텍스트 길이로 작업을 해결했다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p5.1.1">500K length book summaryization (BookSum). </span> 30K 단계 동안 8K 입력 길이를 가진 8B LLM 모델을 지속적으로 사전 훈련하여 접근 방식을 확장했다. 그런 다음 책 요약 작업인 BookSum<cite class="ltx_cite ltx_citemacro_citep">(Kryściński et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib27" title="">2021</a>)</cite>에 대해 미세 조정했으며 여기서 목표는 전체 책 텍스트의 요약을 생성하는 것이다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.1">미세 조정을 위해 입력 길이를 32K로 설정하고 평가를 위해 500K로 증가시킨다. 생성 온도 0.5와 <math alttext="top_{p}=0.95" class="ltx_Math" display="inline" id="S3.SS2.p6.1.m1.1"><semantics id="S3.SS2.p6.1.m1.1a"><mrow id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mrow id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2.2" xref="S3.SS2.p6.1.m1.1.1.2.2.cmml">t</mi><mo id="S3.SS2.p6.1.m1.1.1.2.1" xref="S3.SS2.p6.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p6.1.m1.1.1.2.3" xref="S3.SS2.p6.1.m1.1.1.2.3.cmml">o</mi><mo id="S3.SS2.p6.1.m1.1.1.2.1a" xref="S3.SS2.p6.1.m1.1.1.2.1.cmml">⁢</mo><msub id="S3.SS2.p6.1.m1.1.1.2.4" xref="S3.SS2.p6.1.m1.1.1.2.4.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2.4.2" xref="S3.SS2.p6.1.m1.1.1.2.4.2.cmml">p</mi><mi id="S3.SS2.p6.1.m1.1.1.2.4.3" xref="S3.SS2.p6.1.m1.1.1.2.4.3.cmml">p</mi></msub></mrow><mo id="S3.SS2.p6.1.m1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><eq id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1"></eq><apply id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2"><times id="S3.SS2.p6.1.m1.1.1.2.1.cmml" xref="S3.SS2.p6.1.m1.1.1.2.1"></times><ci id="S3.SS2.p6.1.m1.1.1.2.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2.2">𝑡</ci><ci id="S3.SS2.p6.1.m1.1.1.2.3.cmml" xref="S3.SS2.p6.1.m1.1.1.2.3">𝑜</ci><apply id="S3.SS2.p6.1.m1.1.1.2.4.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.1.1.2.4.1.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4">subscript</csymbol><ci id="S3.SS2.p6.1.m1.1.1.2.4.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4.2">𝑝</ci><ci id="S3.SS2.p6.1.m1.1.1.2.4.3.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4.3">𝑝</ci></apply></apply><cn id="S3.SS2.p6.1.m1.1.1.3.cmml" type="float" xref="S3.SS2.p6.1.m1.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">top_{p}=0.95</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.1.m1.1d">italic_t italic_o italic_p start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = 0.95</annotation></semantics></math>를 사용하고 디코딩 단계 수를 1024로 설정하여 각 책의 요약을 생성한다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p7">
<p class="ltx_p" id="S3.SS2.p7.1">표 <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.T4" title="Table 4 ‣ 3.2 LLM Continual Pre-training ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">4</span></a>는 요약 태스크 <cite class="ltx_cite ltx_citemacro_citep">(Lewis et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib28" title="">2019</a>; Xiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib57" title="">2021</a>)</cite> 및 검색 기반 긴 컨텍스트 확장 <cite class="ltx_cite ltx_citemacro_citep">(Bertsch et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib5" title="">2024</a>)</cite>에 대해 특별히 구축된 인코더-디코더 모델과 우리의 모델을 비교한다. 본 논문에서 제안하는 모델은 기존의 베스트 결과보다 우수한 성능을 보이며, 책의 전체 텍스트를 처리함으로써 북섬에 대한 새로운 SOTA를 달성한다. 또한 그림 <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#S3.F4" title="Figure 4 ‣ 3.2 LLM Continual Pre-training ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention"><span class="ltx_text ltx_ref_tag">4</span></a>에서 북섬 데이터의 유효성 검사에 대한 전체 Rouge 점수를 표시했다. 책의 입력으로 제공되는 텍스트가 많을수록 인피니 변환기가 요약 성능 메트릭을 개선한다는 분명한 경향이 있습니다.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Compressive memory. </span> 생물학적 뉴런에서 가소성에 영감을 받은 <cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai &amp; Yu, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib34" title="">2017a</a>; Miconi et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib31" title="">2018</a>)</cite> 압축 메모리는 정보를 저장하고 검색하기 위해 캐스트 매개변수화된 함수를 메모리로 접근한다. 입력 시퀀스 길이에 따라 증가하는 트랜스포머 KV 메모리 어레이 <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib54" title="">2017</a>; Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib55" title="">2022</a>)</cite>와 달리 압축 메모리 시스템은 계산 효율을 위해 일정한 수의 메모리 파라미터를 유지한다. 매개 변수는 정보를 저장하기 위해 업데이트 규칙으로 수정되며, 이 수정은 메모리 읽기 메커니즘 <cite class="ltx_cite ltx_citemacro_citep">(Graves et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib19" title="">2014</a>; Sukhbaatar et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib51" title="">2015</a>; Munkhdalai &amp; Yu, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib35" title="">2017b</a>)</cite>를 통해 검색된다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">압축된 입력 표현은 과거 시퀀스 세그먼트 <cite class="ltx_cite ltx_citemacro_citep">(Rae et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib41" title="">2019</a>; Chevalier et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib11" title="">2023</a>)</cite>의 요약으로 볼 수 있다. 이러한 방향으로, 보다 최근의 연구들은 효율적인 긴 컨텍스트 모델링 <cite class="ltx_cite ltx_citemacro_citep">(Bulatov et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib7" title="">2022</a>; Chevalier et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib11" title="">2023</a>; Ge et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib18" title="">2023</a>; Mu et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib33" title="">2024</a>)</cite>를 위해 입력 시퀀스를 압축하기 위해 Transformer LLM 자체를 활용하고 있다. 그러나, 압축 트랜스포머 <cite class="ltx_cite ltx_citemacro_citep">(Rae et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib41" title="">2019</a>)</cite>를 포함한 이전의 세그먼트 레벨 압축 방법들은 여전히 새로운 세그먼트들에 대한 공간을 확보하기 위해 오래된 세그먼트들의 메모리 엔트리들을 폐기하고, 그들의 컨텍스트 윈도우를 가장 최근의 세그먼트들로 제한한다. 이것은 반복되는 방식으로 고정된 양의 메모리 매개변수에 대한 증분 메모리 업데이트를 계산하는 인피니 주의와 대조적이다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Long-context continual pre-training. </span> do-product attention layer를 확장하고 long-context <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib58" title="">2023</a>; Fu et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib17" title="">2024</a>)</cite>에 대해 LLMs을 계속 훈련하는 작업 라인이 있다. 어텐션 확장에는 어텐션 레이어에 희소성을 통합하는 것뿐만 아니라 위치 인코딩을 조작하는 것, <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib9" title="">2023b</a>; Ratner et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib43" title="">2022</a>; Mohtashami &amp; Jaggi, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib32" title="">2024</a>)</cite>가 포함된다. 위치 보간 기술 <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib8" title="">2023a</a>; Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib38" title="">2023</a>)</cite>와 같은 위치 인코딩 기반 방법은 어텐션 레이어에서 위치 편향만 조정하기 때문에 데이터 효율적일 수 있지만 여전히 추론에 많은 비용이 든다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p4">
<p class="ltx_p" id="S4.p4.1">어텐션 메커니즘은 또한 어텐션 싱크 <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib56" title="">2023</a>)</cite>와 lost-in-the-middle<cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib30" title="">2024</a>)</cite>의 문제를 일으키기 쉽다. 결과적으로, 그들은 <cite class="ltx_cite ltx_citemacro_citep">(Press et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib40" title="">2021</a>; Kazemnejad et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib26" title="">2024</a>)</cite>를 훈련하는 동안 관찰된 것보다 문맥 길이가 더 긴 체제에서 어려움을 겪는다. 제안된 Infini-attention은 고정된 로컬 어텐션 윈도우를 갖는 긴 시퀀스들에 대해 세그먼트 레벨 스트리밍 계산을 가능하게 함으로써 이러한 문제들을 해결한다. 인피니-트랜스포머는 32K 및 심지어 5K 길이 시퀀스에서 훈련될 때 1M 입력 길이 영역으로 성공적으로 외삽된다.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p5">
<p class="ltx_p" id="S4.p5.1"><span class="ltx_text ltx_font_bold" id="S4.p5.1.1">Efficient attention. </span> The efficient attention techniques attempt to improve the efficiency of the dot-product attention with a approximation or system-level optimization. 희소성 기반 <cite class="ltx_cite ltx_citemacro_citep">(Child et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib12" title="">2019</a>; Beltagy et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib4" title="">2020</a>; Sukhbaatar et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib52" title="">2021</a>; Ding et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib16" title="">2023</a>)</cite> 및 선형 주의 근사화 <cite class="ltx_cite ltx_citemacro_citep">(Shen et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib49" title="">2018</a>; Katharopoulos et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib25" title="">2020</a>; Schlag et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib46" title="">2021</a>)</cite>를 포함하여 다양한 형태의 효율적인 주의 근사화에 대해 여러 방향이 탐색되었다. 이 중 선형 어텐션 변형은 연관 메모리 행렬 <cite class="ltx_cite ltx_citemacro_citep">(Schlag et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib45" title="">2020</a>; <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib46" title="">2021</a>)</cite>와 금속 학습 신경 메모리 <cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib37" title="">2019</a>)</cite>와 밀접한 관련이 있으며, 여기서 KV 바인딩 <cite class="ltx_cite ltx_citemacro_citep">(Smolensky, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib50" title="">1990</a>)</cite>는 새로운 문맥 정보와 관련하여 수정된 Fast-Weights <cite class="ltx_cite ltx_citemacro_citep">(Hinton &amp; Plaut, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib22" title="">1987</a>; Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib47" title="">1992</a>; Ba et al., <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib2" title="">2016</a>)</cite>에 저장된다. 보다 최근에는 정확한 주의력 계산을 보다 효율적으로 하기 위해 특정 하드웨어 아키텍처를 활용하여 시스템 수준 최적화 기술이 제안되었다.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">효과적인 기억 시스템은 LLM으로 긴 맥락을 이해하는 것뿐만 아니라 추론, 계획, 새로운 지식을 위한 지속적인 적응, 심지어 학습 방법을 배우는 데에도 중요하다. 본 연구에서는 바닐라 도트-제품 어텐션 레이어에 압축 메모리 모듈을 밀접하게 통합한다. 어텐션 레이어에 대한 이러한 미묘하지만 중요한 수정은 LLM들이 제한된 메모리 및 계산 자원들로 무한히 긴 컨텍스트들을 프로세싱할 수 있게 한다. 본 논문에서 제안한 방법이 긴 문맥 언어 모델링 벤치마크와 책 요약 작업에서 기준선을 능가하는 동시에 입력 시퀀스의 백만 길이 체제로 자연스럽게 확장될 수 있음을 보인다. 또한, 본 논문에서 제안한 방법의 우수한 길이 일반화 성능을 보인다. 최대 5K 시퀀스 길이 패스키 인스턴스에서 미세 조정된 1B 모델은 1M 길이 문제를 해결했다.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anil et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rohan Anil, Andrew&nbsp;M Dai, Orhan Firat, Melvin Johnson, Dmitry Lepikhin,
Alexandre Passos, Siamak Shakeri, Emanuel Taropa, Paige Bailey, Zhifeng Chen,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Palm 2 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2305.10403</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ba et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jimmy Ba, Geoffrey&nbsp;E Hinton, Volodymyr Mnih, Joel&nbsp;Z Leibo, and Catalin Ionescu.

</span>
<span class="ltx_bibblock">Using fast weights to attend to the recent past.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Advances in neural information processing systems</em>, 29, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahdanau et&nbsp;al. (2014)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and
translate.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:1409.0473</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beltagy et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Iz&nbsp;Beltagy, Matthew&nbsp;E Peters, and Arman Cohan.

</span>
<span class="ltx_bibblock">Longformer: The long-document transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2004.05150</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertsch et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Amanda Bertsch, Uri Alon, Graham Neubig, and Matthew Gormley.

</span>
<span class="ltx_bibblock">Unlimiformer: Long-range transformers with unlimited length input.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared&nbsp;D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in neural information processing systems</em>,
33:1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bulatov et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aydar Bulatov, Yury Kuratov, and Mikhail Burtsev.

</span>
<span class="ltx_bibblock">Recurrent memory transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Advances in Neural Information Processing Systems</em>,
35:11079–11091, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shouyuan Chen, Sherman Wong, Liangjian Chen, and Yuandong Tian.

</span>
<span class="ltx_bibblock">Extending context window of large language models via positional
interpolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2306.15595</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yukang Chen, Shengju Qian, Haotian Tang, Xin Lai, Zhijian Liu, Song Han, and
Jiaya Jia.

</span>
<span class="ltx_bibblock">Longlora: Efficient fine-tuning of long-context large language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2309.12307</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jianpeng Cheng, Li&nbsp;Dong, and Mirella Lapata.

</span>
<span class="ltx_bibblock">Long short-term memory-networks for machine reading.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:1601.06733</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chevalier et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexis Chevalier, Alexander Wettig, Anirudh Ajith, and Danqi Chen.

</span>
<span class="ltx_bibblock">Adapting language models to compress contexts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2305.14788</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Child et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rewon Child, Scott Gray, Alec Radford, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Generating long sequences with sparse transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:1904.10509</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clevert et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Djork-Arné Clevert, Thomas Unterthiner, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Fast and accurate deep network learning by exponential linear units
(elus).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:1511.07289</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zihang Dai, Zhilin Yang, Yiming Yang, Jaime Carbonell, Quoc&nbsp;V Le, and Ruslan
Salakhutdinov.

</span>
<span class="ltx_bibblock">Transformer-xl: Attentive language models beyond a fixed-length
context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1901.02860</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with
io-awareness.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>,
35:16344–16359, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jiayu Ding, Shuming Ma, Li&nbsp;Dong, Xingxing Zhang, Shaohan Huang, Wenhui Wang,
Nanning Zheng, and Furu Wei.

</span>
<span class="ltx_bibblock">Longnet: Scaling transformers to 1,000,000,000 tokens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2307.02486</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yao Fu, Rameswar Panda, Xinyao Niu, Xiang Yue, Hannaneh Hajishirzi, Yoon Kim,
and Hao Peng.

</span>
<span class="ltx_bibblock">Data engineering for scaling language models to 128k context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2402.10171</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tao Ge, Jing Hu, Xun Wang, Si-Qing Chen, and Furu Wei.

</span>
<span class="ltx_bibblock">In-context autoencoder for context compression in a large language
model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2307.06945</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graves et&nbsp;al. (2014)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alex Graves, Greg Wayne, and Ivo Danihelka.

</span>
<span class="ltx_bibblock">Neural turing machines.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:1410.5401</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Groeneveld et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dirk Groeneveld, Iz&nbsp;Beltagy, Pete Walsh, Akshita Bhagia, Rodney Kinney, Oyvind
Tafjord, Ananya&nbsp;Harsh Jha, Hamish Ivison, Ian Magnusson, Yizhong Wang, et&nbsp;al.

</span>
<span class="ltx_bibblock">Olmo: Accelerating the science of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2402.00838</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hebb (2005)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Donald&nbsp;Olding Hebb.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">The organization of behavior: A neuropsychological theory</em>.

</span>
<span class="ltx_bibblock">Psychology press, 2005.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton &amp; Plaut (1987)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Geoffrey&nbsp;E Hinton and David&nbsp;C Plaut.

</span>
<span class="ltx_bibblock">Using fast weights to deblur old memories.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the ninth annual conference of the Cognitive
Science Society</em>, pp.&nbsp; 177–186, 1987.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hopfield (1982)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
John&nbsp;J Hopfield.

</span>
<span class="ltx_bibblock">Neural networks and physical systems with emergent collective
computational abilities.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the national academy of sciences</em>, 79(8):2554–2558, 1982.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kanerva (1988)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pentti Kanerva.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Sparse distributed memory</em>.

</span>
<span class="ltx_bibblock">MIT press, 1988.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katharopoulos et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and François
Fleuret.

</span>
<span class="ltx_bibblock">Transformers are rnns: Fast autoregressive transformers with linear
attention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">International conference on machine learning</em>, pp.&nbsp;5156–5165. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kazemnejad et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Amirhossein Kazemnejad, Inkit Padhi, Karthikeyan Natesan&nbsp;Ramamurthy, Payel Das,
and Siva Reddy.

</span>
<span class="ltx_bibblock">The impact of positional encoding on length generalization in
transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kryściński et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wojciech Kryściński, Nazneen Rajani, Divyansh Agarwal, Caiming Xiong,
and Dragomir Radev.

</span>
<span class="ltx_bibblock">Booksum: A collection of datasets for long-form narrative
summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2105.08209</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mike Lewis, Yinhan Liu, Naman Goyal, Marjan Ghazvininejad, Abdelrahman Mohamed,
Omer Levy, Ves Stoyanov, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Bart: Denoising sequence-to-sequence pre-training for natural
language generation, translation, and comprehension.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:1910.13461</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hao Liu, Matei Zaharia, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Ring attention with blockwise transformers for near-infinite context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2310.01889</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nelson&nbsp;F Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua,
Fabio Petroni, and Percy Liang.

</span>
<span class="ltx_bibblock">Lost in the middle: How language models use long contexts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Transactions of the Association for Computational Linguistics</em>,
12:157–173, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miconi et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Thomas Miconi, Kenneth Stanley, and Jeff Clune.

</span>
<span class="ltx_bibblock">Differentiable plasticity: training plastic neural networks with
backpropagation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">International Conference on Machine Learning</em>, pp.&nbsp;3559–3568. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohtashami &amp; Jaggi (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Amirkeivan Mohtashami and Martin Jaggi.

</span>
<span class="ltx_bibblock">Random-access infinite context length for transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jesse Mu, Xiang Li, and Noah Goodman.

</span>
<span class="ltx_bibblock">Learning to compress prompts with gist tokens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai &amp; Yu (2017a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai and Hong Yu.

</span>
<span class="ltx_bibblock">Meta networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">International conference on machine learning</em>, pp.&nbsp;2554–2563. PMLR, 2017a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai &amp; Yu (2017b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai and Hong Yu.

</span>
<span class="ltx_bibblock">Neural semantic encoders.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the conference. Association for Computational
Linguistics. Meeting</em>, volume&nbsp;1, pp.&nbsp; 397. NIH Public Access,
2017b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai, John&nbsp;P Lalor, and Hong Yu.

</span>
<span class="ltx_bibblock">Citation analysis with neural attention models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the Seventh International Workshop on Health
Text Mining and Information Analysis</em>, pp.&nbsp; 69–77, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai, Alessandro Sordoni, Tong Wang, and Adam Trischler.

</span>
<span class="ltx_bibblock">Metalearned neural memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Advances in Neural Information Processing Systems</em>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bowen Peng, Jeffrey Quesnelle, Honglu Fan, and Enrico Shippole.

</span>
<span class="ltx_bibblock">Yarn: Efficient context window extension of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2309.00071</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pope et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Reiner Pope, Sholto Douglas, Aakanksha Chowdhery, Jacob Devlin, James Bradbury,
Jonathan Heek, Kefan Xiao, Shivani Agrawal, and Jeff Dean.

</span>
<span class="ltx_bibblock">Efficiently scaling transformer inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of Machine Learning and Systems</em>, 5, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ofir Press, Noah&nbsp;A Smith, and Mike Lewis.

</span>
<span class="ltx_bibblock">Train short, test long: Attention with linear biases enables input
length extrapolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2108.12409</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rae et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jack&nbsp;W Rae, Anna Potapenko, Siddhant&nbsp;M Jayakumar, and Timothy&nbsp;P Lillicrap.

</span>
<span class="ltx_bibblock">Compressive transformers for long-range sequence modelling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:1911.05507</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael
Matena, Yanqi Zhou, Wei Li, and Peter&nbsp;J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">The Journal of Machine Learning Research</em>, 21(1):5485–5551, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ratner et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nir Ratner, Yoav Levine, Yonatan Belinkov, Ori Ram, Omri Abend, Ehud Karpas,
Amnon Shashua, Kevin Leyton-Brown, and Yoav Shoham.

</span>
<span class="ltx_bibblock">Parallel context windows improve in-context learning of large
language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2212.10947</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Imanol Schlag, Paul Smolensky, Roland Fernandez, Nebojsa Jojic, Jürgen
Schmidhuber, and Jianfeng Gao.

</span>
<span class="ltx_bibblock">Enhancing the transformer with explicit relational encoding for math
problem solving.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:1910.06611</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Imanol Schlag, Tsendsuren Munkhdalai, and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Learning associative inference using fast weight memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2011.07831</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Imanol Schlag, Kazuki Irie, and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Linear transformers are secretly fast weight programmers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">International Conference on Machine Learning</em>, pp.&nbsp;9355–9366. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schmidhuber (1992)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Learning to control fast-weight memories: An alternative to dynamic
recurrent networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Neural Computation</em>, 4(1):131–139, 1992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer &amp; Stern (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Noam Shazeer and Mitchell Stern.

</span>
<span class="ltx_bibblock">Adafactor: Adaptive learning rates with sublinear memory cost.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">International Conference on Machine Learning</em>, pp.&nbsp;4596–4604. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhuoran Shen, Mingyuan Zhang, Haiyu Zhao, Shuai Yi, and Hongsheng Li.

</span>
<span class="ltx_bibblock">Efficient attention: Attention with linear complexities.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">arXiv preprint arXiv:1812.01243</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smolensky (1990)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Paul Smolensky.

</span>
<span class="ltx_bibblock">Tensor product variable binding and the representation of symbolic
structures in connectionist systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Artificial intelligence</em>, 46(1-2):159–216,
1990.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sukhbaatar et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sainbayar Sukhbaatar, Jason Weston, Rob Fergus, et&nbsp;al.

</span>
<span class="ltx_bibblock">End-to-end memory networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Advances in neural information processing systems</em>, 28, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sukhbaatar et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sainbayar Sukhbaatar, Da&nbsp;Ju, Spencer Poff, Stephen Roller, Arthur Szlam, Jason
Weston, and Angela Fan.

</span>
<span class="ltx_bibblock">Not all memories are created equal: Learning to forget by expiring.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">International Conference on Machine Learning</em>, pp.&nbsp;9902–9912. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">arXiv preprint arXiv:2307.09288</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan&nbsp;N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuhuai Wu, Markus&nbsp;N Rabe, DeLesley Hutchins, and Christian Szegedy.

</span>
<span class="ltx_bibblock">Memorizing transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:2203.08913</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guangxuan Xiao, Yuandong Tian, Beidi Chen, Song Han, and Mike Lewis.

</span>
<span class="ltx_bibblock">Efficient streaming language models with attention sinks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:2309.17453</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wen Xiao, Iz&nbsp;Beltagy, Giuseppe Carenini, and Arman Cohan.

</span>
<span class="ltx_bibblock">Primera: Pyramid-based masked sentence pre-training for
multi-document summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">arXiv preprint arXiv:2110.08499</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wenhan Xiong, Jingyu Liu, Igor Molybog, Hejia Zhang, Prajjwal Bhargava, Rui
Hou, Louis Martin, Rashi Rungta, Karthik&nbsp;Abinav Sankararaman, Barlas Oguz,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Effective long-context scaling of foundation models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">arXiv preprint arXiv:2309.16039</em>, 2023.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional Training Details</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">장문 언어 모델링 작업을 위해 0.003, 0.005, 0.01, 0.03의 값에 대해 작은 탐색을 수행하여 학습률을 0.01로 설정하였다. 1000단계의 선형 웜업과 함께 Adafactor optimizer <cite class="ltx_cite ltx_citemacro_citep">(Shazeer &amp; Stern, <a class="ltx_ref" href="https://arxiv.org/html/2404.07143v1#bib.bib48" title="">2018</a>)</cite>를 사용한 후 코사인 붕괴를 수행하였다. 우리는 메모리를 저장하기 위해 저장하기 위해 각 세그먼트 후에 기울기 체크포인팅을 적용했다. 배치 크기는 64로 설정하였으며, LLM 실험은 연속 사전 훈련과 과제 미세 조정 시 학습률을 0.0001로 설정하였다.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Passkey Retrieval Task</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">아래에서는 패스키 태스크의 입력 형식을 보여 주었다.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1"><span class="ltx_text ltx_font_sansserif" id="A2.p2.1.1">많은 관련 없는 텍스트 내부에 숨겨진 중요한 정보가 있습니다. 찾아서 외워. 나는 거기에서 중요한 정보에 대해 당신에게 퀴즈를 낼 것이다. 잔디가 푸르다. 하늘은 푸르다. 태양은 노랗다. 시작합니다 다시 왔다 갔다 해 <span class="ltx_text ltx_framed_underline" id="A2.p2.1.1.1">(repeat x times)</span> 패스 키는 <span class="ltx_text ltx_font_bold" id="A2.p2.1.1.2">9054</span>입니다. 명심해 <span class="ltx_text ltx_font_bold" id="A2.p2.1.1.3">9054</span>은 패스 키입니다. 잔디가 푸르다. 하늘은 푸르다. 태양은 노랗다. 시작합니다 또 시작이네 <span class="ltx_text ltx_framed_underline" id="A2.p2.1.1.4">(repeat y times)</span> Pass key는 무엇인가요? 패스 키는</span></p>
</div>
</section>
</article>
</div>

</div>


<div class="ltx_page_footer">
          <div class="ltx_page_logo">
              Generated by
              <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                  <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                      L
                      <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                      T
                      <span style="position: relative; bottom: -0.4ex;">E</span>
                  </span>
                  <span class="ltx_font_smallcaps">xml</span>
                  <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
              </a>
          </div></div><footer id="footer" class="ltx_document">
          <div class="keyboard-glossary">
              <h2>Instructions for reporting errors</h2>
              <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
              <ul>
                  <li>Click the "Report Issue" button.</li>
                  <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                  <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                  <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
              </ul>
              <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
              <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
          </div>
      </footer><button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header" data-bs-theme="dark"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button></body></html>