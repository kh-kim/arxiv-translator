<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.07143] Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention</title><meta property="og:description" content="This work introduces an efficient method to scale Transformer-based Large Language Models (LLMs) to infinitely long inputs with bounded memory and computation. A key component in our proposed approach is a new attentio…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.07143">

<!--Generated on Sun May  5 21:27:20 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.7.9.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.9.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Leave No Context Behind: 
<br class="ltx_break">Efficient Infinite Context Transformers with Infini-attention</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tsendsuren Munkhdalai, Manaal Faruqui and Siddharth Gopal
<br class="ltx_break">Google 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">tsendsuren@google.com</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">This work introduces an efficient method to scale Transformer-based Large Language Models (LLMs) to infinitely long inputs with bounded memory and computation. A key component in our proposed approach is a new attention technique dubbed Infini-attention. The Infini-attention incorporates a compressive memory into the vanilla attention mechanism and builds in both masked local attention and long-term linear attention mechanisms in a single Transformer block.
We demonstrate the effectiveness of our approach on long-context language modeling benchmarks, 1M sequence length passkey context block retrieval and 500K length book summarization tasks with 1B and 8B LLMs. Our approach introduces minimal bounded memory parameters and enables fast streaming inference for LLMs.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Memory serves as a cornerstone of intelligence, as it enables efficient computations tailored to specific contexts. However, Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a href="#bib.bib54" title="" class="ltx_ref">2017</a>)</cite> and Transformer-based LLMs&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Brown et&nbsp;al., <a href="#bib.bib6" title="" class="ltx_ref">2020</a>; Touvron et&nbsp;al., <a href="#bib.bib53" title="" class="ltx_ref">2023</a>; Anil et&nbsp;al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>; Groeneveld et&nbsp;al., <a href="#bib.bib20" title="" class="ltx_ref">2024</a>)</cite> have a constrained context-dependent memory, due to the nature of the attention mechanism.</p>
</div>
<figure id="S1.F1" class="ltx_figure ltx_align_floatright"><img src="/html/2404.07143/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="169" height="148" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Infini-attention has an additional compressive memory with linear attention for processing infinitely long contexts. <math id="S1.F1.5.4.m1.1" class="ltx_Math" alttext="\{KV\}_{s-1}" display="inline"><semantics id="S1.F1.5.4.m1.1b"><msub id="S1.F1.5.4.m1.1.1" xref="S1.F1.5.4.m1.1.1.cmml"><mrow id="S1.F1.5.4.m1.1.1.1.1" xref="S1.F1.5.4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S1.F1.5.4.m1.1.1.1.1.2" xref="S1.F1.5.4.m1.1.1.1.2.cmml">{</mo><mrow id="S1.F1.5.4.m1.1.1.1.1.1" xref="S1.F1.5.4.m1.1.1.1.1.1.cmml"><mi id="S1.F1.5.4.m1.1.1.1.1.1.2" xref="S1.F1.5.4.m1.1.1.1.1.1.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S1.F1.5.4.m1.1.1.1.1.1.1" xref="S1.F1.5.4.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S1.F1.5.4.m1.1.1.1.1.1.3" xref="S1.F1.5.4.m1.1.1.1.1.1.3.cmml">V</mi></mrow><mo stretchy="false" id="S1.F1.5.4.m1.1.1.1.1.3" xref="S1.F1.5.4.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S1.F1.5.4.m1.1.1.3" xref="S1.F1.5.4.m1.1.1.3.cmml"><mi id="S1.F1.5.4.m1.1.1.3.2" xref="S1.F1.5.4.m1.1.1.3.2.cmml">s</mi><mo id="S1.F1.5.4.m1.1.1.3.1" xref="S1.F1.5.4.m1.1.1.3.1.cmml">−</mo><mn id="S1.F1.5.4.m1.1.1.3.3" xref="S1.F1.5.4.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F1.5.4.m1.1c"><apply id="S1.F1.5.4.m1.1.1.cmml" xref="S1.F1.5.4.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.5.4.m1.1.1.2.cmml" xref="S1.F1.5.4.m1.1.1">subscript</csymbol><set id="S1.F1.5.4.m1.1.1.1.2.cmml" xref="S1.F1.5.4.m1.1.1.1.1"><apply id="S1.F1.5.4.m1.1.1.1.1.1.cmml" xref="S1.F1.5.4.m1.1.1.1.1.1"><times id="S1.F1.5.4.m1.1.1.1.1.1.1.cmml" xref="S1.F1.5.4.m1.1.1.1.1.1.1"></times><ci id="S1.F1.5.4.m1.1.1.1.1.1.2.cmml" xref="S1.F1.5.4.m1.1.1.1.1.1.2">𝐾</ci><ci id="S1.F1.5.4.m1.1.1.1.1.1.3.cmml" xref="S1.F1.5.4.m1.1.1.1.1.1.3">𝑉</ci></apply></set><apply id="S1.F1.5.4.m1.1.1.3.cmml" xref="S1.F1.5.4.m1.1.1.3"><minus id="S1.F1.5.4.m1.1.1.3.1.cmml" xref="S1.F1.5.4.m1.1.1.3.1"></minus><ci id="S1.F1.5.4.m1.1.1.3.2.cmml" xref="S1.F1.5.4.m1.1.1.3.2">𝑠</ci><cn type="integer" id="S1.F1.5.4.m1.1.1.3.3.cmml" xref="S1.F1.5.4.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.4.m1.1d">\{KV\}_{s-1}</annotation></semantics></math> and <math id="S1.F1.6.5.m2.1" class="ltx_Math" alttext="\{KV\}_{s}" display="inline"><semantics id="S1.F1.6.5.m2.1b"><msub id="S1.F1.6.5.m2.1.1" xref="S1.F1.6.5.m2.1.1.cmml"><mrow id="S1.F1.6.5.m2.1.1.1.1" xref="S1.F1.6.5.m2.1.1.1.2.cmml"><mo stretchy="false" id="S1.F1.6.5.m2.1.1.1.1.2" xref="S1.F1.6.5.m2.1.1.1.2.cmml">{</mo><mrow id="S1.F1.6.5.m2.1.1.1.1.1" xref="S1.F1.6.5.m2.1.1.1.1.1.cmml"><mi id="S1.F1.6.5.m2.1.1.1.1.1.2" xref="S1.F1.6.5.m2.1.1.1.1.1.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S1.F1.6.5.m2.1.1.1.1.1.1" xref="S1.F1.6.5.m2.1.1.1.1.1.1.cmml">​</mo><mi id="S1.F1.6.5.m2.1.1.1.1.1.3" xref="S1.F1.6.5.m2.1.1.1.1.1.3.cmml">V</mi></mrow><mo stretchy="false" id="S1.F1.6.5.m2.1.1.1.1.3" xref="S1.F1.6.5.m2.1.1.1.2.cmml">}</mo></mrow><mi id="S1.F1.6.5.m2.1.1.3" xref="S1.F1.6.5.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.6.5.m2.1c"><apply id="S1.F1.6.5.m2.1.1.cmml" xref="S1.F1.6.5.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.6.5.m2.1.1.2.cmml" xref="S1.F1.6.5.m2.1.1">subscript</csymbol><set id="S1.F1.6.5.m2.1.1.1.2.cmml" xref="S1.F1.6.5.m2.1.1.1.1"><apply id="S1.F1.6.5.m2.1.1.1.1.1.cmml" xref="S1.F1.6.5.m2.1.1.1.1.1"><times id="S1.F1.6.5.m2.1.1.1.1.1.1.cmml" xref="S1.F1.6.5.m2.1.1.1.1.1.1"></times><ci id="S1.F1.6.5.m2.1.1.1.1.1.2.cmml" xref="S1.F1.6.5.m2.1.1.1.1.1.2">𝐾</ci><ci id="S1.F1.6.5.m2.1.1.1.1.1.3.cmml" xref="S1.F1.6.5.m2.1.1.1.1.1.3">𝑉</ci></apply></set><ci id="S1.F1.6.5.m2.1.1.3.cmml" xref="S1.F1.6.5.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.5.m2.1d">\{KV\}_{s}</annotation></semantics></math> are attention key and values for current and previous input segments, respectively and <math id="S1.F1.7.6.m3.1" class="ltx_Math" alttext="Q_{s}" display="inline"><semantics id="S1.F1.7.6.m3.1b"><msub id="S1.F1.7.6.m3.1.1" xref="S1.F1.7.6.m3.1.1.cmml"><mi id="S1.F1.7.6.m3.1.1.2" xref="S1.F1.7.6.m3.1.1.2.cmml">Q</mi><mi id="S1.F1.7.6.m3.1.1.3" xref="S1.F1.7.6.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.7.6.m3.1c"><apply id="S1.F1.7.6.m3.1.1.cmml" xref="S1.F1.7.6.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.7.6.m3.1.1.1.cmml" xref="S1.F1.7.6.m3.1.1">subscript</csymbol><ci id="S1.F1.7.6.m3.1.1.2.cmml" xref="S1.F1.7.6.m3.1.1.2">𝑄</ci><ci id="S1.F1.7.6.m3.1.1.3.cmml" xref="S1.F1.7.6.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.6.m3.1d">Q_{s}</annotation></semantics></math> the attention queries. PE denotes position embeddings.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">The attention mechanism in Transformers exhibits quadratic complexity in both memory footprint and computation time.
For example, the attention Key-Value (KV) states have 3TB memory footprint for a 500B model with batch size 512 and context length 2048&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Pope et&nbsp;al., <a href="#bib.bib39" title="" class="ltx_ref">2023</a>)</cite>.
Indeed, scaling LLMs to longer sequences (i.e. 1M tokens) is challenging with the standard Transformer architectures and serving longer and longer context models becomes costly financially.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Compressive memory systems promise to be more scalable and efficient than the attention mechanism for extremely long sequences&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kanerva, <a href="#bib.bib24" title="" class="ltx_ref">1988</a>; Munkhdalai et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite>. Instead of using an array that grows with the input sequence length, a compressive memory primarily maintains a fixed number of parameters to store and recall information with a bounded storage and computation costs. In the compressive memory, new information is added to the memory by changing its parameters with an objective that this information can be recovered back later on. However, the LLMs in their current state have yet to see an effective, practical compressive memory technique that balances simplicity along with quality.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">In this work, we introduce a novel approach that enables Transformer LLMs to effectively process infinitely long inputs with bounded memory footprint and computation. A key component in our proposed approach is a new attention technique dubbed Infini-attention (Figure&nbsp;<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The Infini-attention incorporates a compressive memory into the vanilla attention mechanism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bahdanau et&nbsp;al., <a href="#bib.bib3" title="" class="ltx_ref">2014</a>; Vaswani et&nbsp;al., <a href="#bib.bib54" title="" class="ltx_ref">2017</a>)</cite> and builds in both masked local attention and long-term linear attention mechanisms in a single Transformer block.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">Such a subtle but critical modification to the Transformer attention layer enables a natural extension of existing LLMs to infinitely long contexts via continual pre-training and fine-tuning.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">Our Infini-attention reuses all the key, value and query states of the standard attention computation for long-term memory consolidation and retrieval. We store old KV states of the attention in the compressive memory, instead of discarding them like in the standard attention mechanism. We then retrieve the values from the memory by using the attention query states when processing subsequent sequences. To compute the final contextual output, the Infini-attention aggregates the long-term memory-retrieved values and the local attention contexts.</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p">In our experiments, we show that our approach outperforms baseline models on long-context language modeling benchmarks while having &nbsp;114x comprehension ratio in terms of memory size. The model achieves even better perplexity when trained with 100K sequence length. A 1B LLM naturally scales to 1M sequence length and solves the passkey retrieval task when injected with Infini-attention. Finally, we show that a 8B model with Infini-attention reaches a new SOTA result on a 500K length book summarization task after continual pre-training and task fine-tuning.</p>
</div>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p">In summary, our work makes the following contributions:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce a practical and yet powerful attention mechanism – Infini-attention with long-term compressive memory and local causal attention for efficiently modeling both long and short-range contextual dependencies.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Infini-attention introduces minimal change to the standard scaled dot-product attention and supports plug-and-play continual pre-training and long-context adaptation by design.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i3.p1.1" class="ltx_p">Our approach enables Transformer LLMs to scale to infinitely long context with a bounded memory and compute resource by processing extremely long inputs in a streaming fashion.
</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Method</h2>

<figure id="S2.F2" class="ltx_figure"><img src="/html/2404.07143/assets/x2.png" id="S2.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="216" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Infini-Transformer (top) has an entire context history whereas Transformer-XL (bottom) discards old contexts since it caches the KV states for the last segment only.
</figcaption>
</figure>
<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.3" class="ltx_p">Figure&nbsp;<a href="#S2.F2" title="Figure 2 ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> compares our model, Infini-Transformer, and Transformer-XL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>.
Similar to Transformer-XL, Infini-Transformer operates on a sequence of segments. We compute the standard causal dot-product attention context within each segment. So the dot-product attention computation is local in a sense that it covers a total <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">N</annotation></semantics></math> number of tokens of the current segment with index <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">S</annotation></semantics></math> (<math id="S2.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">N</annotation></semantics></math> is the segment length).</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p">The local attention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>, however, discards the attention states of the previous segment when processing the next one. In Infini-Transformers, instead of leaving out the old KV attention states, we propose to reuse them to maintain the entire context history with a compressive memory. So each attention layer of Infini-Transformers has both global compressive and local fine-grained states. We call such an efficient attention mechanism Infini-attention, which is illustrated in Figure&nbsp;<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and described formally in the following sections.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Infini-attention</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.2" class="ltx_p">As shown Figure&nbsp;<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, our Infini-attention computes both local and global context states and combine them for its output. Similar to multi-head attention (MHA), it maintains <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">H</annotation></semantics></math> number of parallel compressive memory per attention layer (<math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">H</annotation></semantics></math> is the number of attention heads) in addition to the dot-product attention.</p>
</div>
<section id="S2.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Scaled Dot-product Attention</h4>

<div id="S2.SS1.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS1.p1.1" class="ltx_p">The multi-head scaled dot-product attention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a href="#bib.bib54" title="" class="ltx_ref">2017</a>)</cite>, specially its self-attention variant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et&nbsp;al., <a href="#bib.bib36" title="" class="ltx_ref">2016</a>; Cheng et&nbsp;al., <a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>, has been the main building block in LLMs. The MHA’s strong capability to model context-dependent dynamic computation and its conveniences of temporal masking have been leveraged extensively in the autoregressive generative models.</p>
</div>
<div id="S2.SS1.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS1.p2.2" class="ltx_p">A single head in the vanilla MHA computes its attention context <math id="S2.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="A_{dot}\in{\rm I\!R}^{N\times d_{value}}" display="inline"><semantics id="S2.SS1.SSS1.p2.1.m1.1a"><mrow id="S2.SS1.SSS1.p2.1.m1.1.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.cmml"><msub id="S2.SS1.SSS1.p2.1.m1.1.1.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.2.cmml">A</mi><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.2.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1a" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.SS1.SSS1.p2.1.m1.1.1.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.1.m1.1.1.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.1.m1.1.1.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.1.cmml">​</mo><msup id="S2.SS1.SSS1.p2.1.m1.1.1.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p2.1.m1.1b"><apply id="S2.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1"><in id="S2.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.1"></in><apply id="S2.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.2">𝐴</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.2">𝑑</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.2">I</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS1.p2.1.m1.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p2.1.m1.1c">A_{dot}\in{\rm I\!R}^{N\times d_{value}}</annotation></semantics></math> from sequence of input segments <math id="S2.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="X\in{\rm I\!R}^{N\times d_{model}}" display="inline"><semantics id="S2.SS1.SSS1.p2.2.m2.1a"><mrow id="S2.SS1.SSS1.p2.2.m2.1.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.2.cmml">X</mi><mo id="S2.SS1.SSS1.p2.2.m2.1.1.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.2.m2.1.1.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.2.m2.1.1.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.2.m2.1.1.3.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.1.cmml">​</mo><msup id="S2.SS1.SSS1.p2.2.m2.1.1.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p2.2.m2.1b"><apply id="S2.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1"><in id="S2.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.1"></in><ci id="S2.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.2">𝑋</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3"><times id="S2.SS1.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3"><times id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3"><times id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS1.p2.2.m2.1.1.3.3.3.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p2.2.m2.1c">X\in{\rm I\!R}^{N\times d_{model}}</annotation></semantics></math> as follows. First, it computes attention query, key, and value states:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.1" class="ltx_Math" alttext="K=XW_{K},\text{ }V=XW_{V}\text{ and }Q=XW_{Q}." display="block"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1"><mrow id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.3.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">K</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.cmml">X</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S2.E1.m1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.cmml">K</mi></msub></mrow></mrow><mo id="S2.E1.m1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.E1.m1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.2.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.cmml"><mtext id="S2.E1.m1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.2a.cmml">&nbsp;</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.2.2.2.1" xref="S2.E1.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="S2.E1.m1.1.1.1.1.2.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.2.3.cmml">V</mi></mrow><mo id="S2.E1.m1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.3.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.2.2.4" xref="S2.E1.m1.1.1.1.1.2.2.4.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.4.2" xref="S2.E1.m1.1.1.1.1.2.2.4.2.cmml">X</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.2.2.4.1" xref="S2.E1.m1.1.1.1.1.2.2.4.1.cmml">​</mo><msub id="S2.E1.m1.1.1.1.1.2.2.4.3" xref="S2.E1.m1.1.1.1.1.2.2.4.3.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.4.3.2" xref="S2.E1.m1.1.1.1.1.2.2.4.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.1.1.2.2.4.3.3" xref="S2.E1.m1.1.1.1.1.2.2.4.3.3.cmml">V</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.2.2.4.1a" xref="S2.E1.m1.1.1.1.1.2.2.4.1.cmml">​</mo><mtext id="S2.E1.m1.1.1.1.1.2.2.4.4" xref="S2.E1.m1.1.1.1.1.2.2.4.4a.cmml">&nbsp;and&nbsp;</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.2.2.4.1b" xref="S2.E1.m1.1.1.1.1.2.2.4.1.cmml">​</mo><mi id="S2.E1.m1.1.1.1.1.2.2.4.5" xref="S2.E1.m1.1.1.1.1.2.2.4.5.cmml">Q</mi></mrow><mo id="S2.E1.m1.1.1.1.1.2.2.5" xref="S2.E1.m1.1.1.1.1.2.2.5.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.2.2.6" xref="S2.E1.m1.1.1.1.1.2.2.6.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.6.2" xref="S2.E1.m1.1.1.1.1.2.2.6.2.cmml">X</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.2.2.6.1" xref="S2.E1.m1.1.1.1.1.2.2.6.1.cmml">​</mo><msub id="S2.E1.m1.1.1.1.1.2.2.6.3" xref="S2.E1.m1.1.1.1.1.2.2.6.3.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.6.3.2" xref="S2.E1.m1.1.1.1.1.2.2.6.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.1.1.2.2.6.3.3" xref="S2.E1.m1.1.1.1.1.2.2.6.3.3.cmml">Q</mi></msub></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3a.cmml" xref="S2.E1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"></eq><ci id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">𝐾</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3"><times id="S2.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.1"></times><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2">𝑋</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3">𝐾</ci></apply></apply></apply><apply id="S2.E1.m1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><and id="S2.E1.m1.1.1.1.1.2.2a.cmml" xref="S2.E1.m1.1.1.1.1.2.2"></and><apply id="S2.E1.m1.1.1.1.1.2.2b.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><eq id="S2.E1.m1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.3"></eq><apply id="S2.E1.m1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2"><times id="S2.E1.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.2.2a.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2"><mtext id="S2.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.2">&nbsp;</mtext></ci><ci id="S2.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2.3">𝑉</ci></apply><apply id="S2.E1.m1.1.1.1.1.2.2.4.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4"><times id="S2.E1.m1.1.1.1.1.2.2.4.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.4.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.2">𝑋</ci><apply id="S2.E1.m1.1.1.1.1.2.2.4.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.4.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.4.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.1.1.2.2.4.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.3.3">𝑉</ci></apply><ci id="S2.E1.m1.1.1.1.1.2.2.4.4a.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.4"><mtext id="S2.E1.m1.1.1.1.1.2.2.4.4.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.4">&nbsp;and&nbsp;</mtext></ci><ci id="S2.E1.m1.1.1.1.1.2.2.4.5.cmml" xref="S2.E1.m1.1.1.1.1.2.2.4.5">𝑄</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.2.2c.cmml" xref="S2.E1.m1.1.1.1.1.2.2"><eq id="S2.E1.m1.1.1.1.1.2.2.5.cmml" xref="S2.E1.m1.1.1.1.1.2.2.5"></eq><share href="#S2.E1.m1.1.1.1.1.2.2.4.cmml" id="S2.E1.m1.1.1.1.1.2.2d.cmml" xref="S2.E1.m1.1.1.1.1.2.2"></share><apply id="S2.E1.m1.1.1.1.1.2.2.6.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6"><times id="S2.E1.m1.1.1.1.1.2.2.6.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.1"></times><ci id="S2.E1.m1.1.1.1.1.2.2.6.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.2">𝑋</ci><apply id="S2.E1.m1.1.1.1.1.2.2.6.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.6.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.6.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.1.1.2.2.6.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.6.3.3">𝑄</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">K=XW_{K},\text{ }V=XW_{V}\text{ and }Q=XW_{Q}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.SSS1.p2.3" class="ltx_p">Here, <math id="S2.SS1.SSS1.p2.3.m1.2" class="ltx_Math" alttext="W_{K}\in{\rm I\!R}^{d_{model}\times d_{key}},W_{V}\in{\rm I\!R}^{d_{model}\times d_{value}}\text{ and }W_{Q}\in{\rm I\!R}^{d_{model}\times d_{key}}" display="inline"><semantics id="S2.SS1.SSS1.p2.3.m1.2a"><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.3.cmml"><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2.cmml">W</mi><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3.cmml">K</mi></msub><mo id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1.cmml">​</mo><msup id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1a" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1b" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1c" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6.cmml">l</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4.cmml">y</mi></mrow></msub></mrow></msup></mrow></mrow><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.3a.cmml">,</mo><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2.cmml">W</mi><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3.cmml">V</mi></msub><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml">​</mo><msup id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1c" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6.cmml">l</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1c" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml">​</mo><mtext id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4a.cmml">&nbsp;and&nbsp;</mtext><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml">​</mo><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2.cmml">W</mi><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3.cmml">Q</mi></msub></mrow><mo id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5.cmml">∈</mo><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1.cmml">​</mo><msup id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2.cmml">R</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.cmml"><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1b" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1c" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6.cmml">l</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.cmml"><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1a" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4.cmml">y</mi></mrow></msub></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p2.3.m1.2b"><apply id="S2.SS1.SSS1.p2.3.m1.2.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.3a.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1"><in id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.1"></in><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.2">𝑊</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.2">I</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.1"></times><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.1.1.1.1.3.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"><and id="S2.SS1.SSS1.p2.3.m1.2.2.2.2a.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"></and><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2b.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"><in id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.3"></in><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.2">𝑊</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.2.3">𝑉</ci></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.2">I</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.2">R</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.1"></times><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4a.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4"><mtext id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.4">&nbsp;and&nbsp;</mtext></ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.2">𝑊</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.5.3">𝑄</ci></apply></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2c.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"><in id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.5"></in><share href="#S2.SS1.SSS1.p2.3.m1.2.2.2.2.4.cmml" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2d.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2"></share><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.2">I</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3">superscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.2">R</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.1"></times><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.2">𝑚</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.3">𝑜</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.4">𝑑</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.5">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.2.3.6">𝑙</ci></apply></apply><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3"><times id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.1"></times><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4.cmml" xref="S2.SS1.SSS1.p2.3.m1.2.2.2.2.6.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p2.3.m1.2c">W_{K}\in{\rm I\!R}^{d_{model}\times d_{key}},W_{V}\in{\rm I\!R}^{d_{model}\times d_{value}}\text{ and }W_{Q}\in{\rm I\!R}^{d_{model}\times d_{key}}</annotation></semantics></math> are trainable projection matrices.
Then, the attention context is calculated as a weighted average of all other values as</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.2" class="ltx_Math" alttext="A_{dot}=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{model}}}\right)V." display="block"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><msub id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml"><mi id="S2.E2.m1.2.2.1.1.2.2" xref="S2.E2.m1.2.2.1.1.2.2.cmml">A</mi><mrow id="S2.E2.m1.2.2.1.1.2.3" xref="S2.E2.m1.2.2.1.1.2.3.cmml"><mi id="S2.E2.m1.2.2.1.1.2.3.2" xref="S2.E2.m1.2.2.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.1.1.2.3.1" xref="S2.E2.m1.2.2.1.1.2.3.1.cmml">​</mo><mi id="S2.E2.m1.2.2.1.1.2.3.3" xref="S2.E2.m1.2.2.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.1.1.2.3.1a" xref="S2.E2.m1.2.2.1.1.2.3.1.cmml">​</mo><mi id="S2.E2.m1.2.2.1.1.2.3.4" xref="S2.E2.m1.2.2.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml"><mtext id="S2.E2.m1.2.2.1.1.3.2" xref="S2.E2.m1.2.2.1.1.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.1.1.3.1" xref="S2.E2.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S2.E2.m1.2.2.1.1.3.3.2" xref="S2.E2.m1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.3.3.2.1" xref="S2.E2.m1.1.1.cmml">(</mo><mfrac id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mrow id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.2.1" xref="S2.E2.m1.1.1.2.1.cmml">​</mo><msup id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml"><mi id="S2.E2.m1.1.1.2.3.2" xref="S2.E2.m1.1.1.2.3.2.cmml">K</mi><mi id="S2.E2.m1.1.1.2.3.3" xref="S2.E2.m1.1.1.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><msub id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2.cmml">d</mi><mrow id="S2.E2.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.3.2.3.cmml"><mi id="S2.E2.m1.1.1.3.2.3.2" xref="S2.E2.m1.1.1.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.3.2.3.1" xref="S2.E2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E2.m1.1.1.3.2.3.3" xref="S2.E2.m1.1.1.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.3.2.3.1a" xref="S2.E2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E2.m1.1.1.3.2.3.4" xref="S2.E2.m1.1.1.3.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.3.2.3.1b" xref="S2.E2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E2.m1.1.1.3.2.3.5" xref="S2.E2.m1.1.1.3.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.3.2.3.1c" xref="S2.E2.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E2.m1.1.1.3.2.3.6" xref="S2.E2.m1.1.1.3.2.3.6.cmml">l</mi></mrow></msub></msqrt></mfrac><mo id="S2.E2.m1.2.2.1.1.3.3.2.2" xref="S2.E2.m1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.1.1.3.1a" xref="S2.E2.m1.2.2.1.1.3.1.cmml">​</mo><mi id="S2.E2.m1.2.2.1.1.3.4" xref="S2.E2.m1.2.2.1.1.3.4.cmml">V</mi></mrow></mrow><mo lspace="0em" id="S2.E2.m1.2.2.1.2" xref="S2.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1"><eq id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"></eq><apply id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2">𝐴</ci><apply id="S2.E2.m1.2.2.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.3"><times id="S2.E2.m1.2.2.1.1.2.3.1.cmml" xref="S2.E2.m1.2.2.1.1.2.3.1"></times><ci id="S2.E2.m1.2.2.1.1.2.3.2.cmml" xref="S2.E2.m1.2.2.1.1.2.3.2">𝑑</ci><ci id="S2.E2.m1.2.2.1.1.2.3.3.cmml" xref="S2.E2.m1.2.2.1.1.2.3.3">𝑜</ci><ci id="S2.E2.m1.2.2.1.1.2.3.4.cmml" xref="S2.E2.m1.2.2.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"><times id="S2.E2.m1.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.3.1"></times><ci id="S2.E2.m1.2.2.1.1.3.2a.cmml" xref="S2.E2.m1.2.2.1.1.3.2"><mtext id="S2.E2.m1.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2">softmax</mtext></ci><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.3.3.2"><divide id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.3.3.2"></divide><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"><times id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.2.1"></times><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">𝑄</ci><apply id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.2.3">superscript</csymbol><ci id="S2.E2.m1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.2.3.2">𝐾</ci><ci id="S2.E2.m1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><root id="S2.E2.m1.1.1.3a.cmml" xref="S2.E2.m1.1.1.3"></root><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2">𝑑</ci><apply id="S2.E2.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3"><times id="S2.E2.m1.1.1.3.2.3.1.cmml" xref="S2.E2.m1.1.1.3.2.3.1"></times><ci id="S2.E2.m1.1.1.3.2.3.2.cmml" xref="S2.E2.m1.1.1.3.2.3.2">𝑚</ci><ci id="S2.E2.m1.1.1.3.2.3.3.cmml" xref="S2.E2.m1.1.1.3.2.3.3">𝑜</ci><ci id="S2.E2.m1.1.1.3.2.3.4.cmml" xref="S2.E2.m1.1.1.3.2.3.4">𝑑</ci><ci id="S2.E2.m1.1.1.3.2.3.5.cmml" xref="S2.E2.m1.1.1.3.2.3.5">𝑒</ci><ci id="S2.E2.m1.1.1.3.2.3.6.cmml" xref="S2.E2.m1.1.1.3.2.3.6">𝑙</ci></apply></apply></apply></apply><ci id="S2.E2.m1.2.2.1.1.3.4.cmml" xref="S2.E2.m1.2.2.1.1.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">A_{dot}=\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{model}}}\right)V.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS1.p3.1" class="ltx_p">For MHA, we compute <math id="S2.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S2.SS1.SSS1.p3.1.m1.1a"><mi id="S2.SS1.SSS1.p3.1.m1.1.1" xref="S2.SS1.SSS1.p3.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p3.1.m1.1b"><ci id="S2.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p3.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p3.1.m1.1c">H</annotation></semantics></math> number of attention context vectors for each sequence element in parallel, concatenate them along the second dimension and then finally project the concatenated vector to the model space to obtain attention the output.</p>
</div>
</section>
<section id="S2.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.2 </span>Compressive Memory</h4>

<div id="S2.SS1.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS2.p1.3" class="ltx_p">In Infini-attention, instead of computing new memory entries for compressive memory, we reuse the query, key and value states (<math id="S2.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S2.SS1.SSS2.p1.1.m1.1a"><mi id="S2.SS1.SSS2.p1.1.m1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.1.m1.1b"><ci id="S2.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.1.m1.1c">Q</annotation></semantics></math>, <math id="S2.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.SSS2.p1.2.m2.1a"><mi id="S2.SS1.SSS2.p1.2.m2.1.1" xref="S2.SS1.SSS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.2.m2.1b"><ci id="S2.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.2.m2.1c">K</annotation></semantics></math> and <math id="S2.SS1.SSS2.p1.3.m3.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S2.SS1.SSS2.p1.3.m3.1a"><mi id="S2.SS1.SSS2.p1.3.m3.1.1" xref="S2.SS1.SSS2.p1.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.3.m3.1b"><ci id="S2.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.3.m3.1c">V</annotation></semantics></math>) from the dot-product attention computation.
The state sharing and reusing between the dot-product attention and compressive memory not only enables efficient plug-in-play long-context adaptation but also speeds up training and inference. Similar to the prior work&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite>, our goal is to store bindings of key and value states in the compressive memory and retrieve by using the query vectors.</p>
</div>
<div id="S2.SS1.SSS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS2.p2.1" class="ltx_p">While there are different forms of compressive memory proposed in the literature&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hopfield, <a href="#bib.bib23" title="" class="ltx_ref">1982</a>; Kanerva, <a href="#bib.bib24" title="" class="ltx_ref">1988</a>; Schlag et&nbsp;al., <a href="#bib.bib44" title="" class="ltx_ref">2019</a>; Munkhdalai et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite>, for simplicity and computational efficiency, in this work we parameterize the memory with an associative matrix&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Schlag et&nbsp;al., <a href="#bib.bib45" title="" class="ltx_ref">2020</a>)</cite>. This approach further allows us to cast the memory update and retrieval process as linear attention mechanism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shen et&nbsp;al., <a href="#bib.bib49" title="" class="ltx_ref">2018</a>)</cite> and to leverage stable training techniques from the related methods. Specially, we adopt the update rule and retrieval mechanism by <cite class="ltx_cite ltx_citemacro_citet">Katharopoulos et&nbsp;al. (<a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite> mainly due to its simplicity and competitive performance.</p>
</div>
<div id="S2.SS1.SSS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS2.p3.3" class="ltx_p"><span id="S2.SS1.SSS2.p3.3.1" class="ltx_text ltx_font_bold">Memory retrieval.</span> In Infini-attention, we retrieve new content <math id="S2.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="A_{mem}\in{\rm I\!R}^{N\times d_{value}}" display="inline"><semantics id="S2.SS1.SSS2.p3.1.m1.1a"><mrow id="S2.SS1.SSS2.p3.1.m1.1.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.cmml"><msub id="S2.SS1.SSS2.p3.1.m1.1.1.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.2.cmml">A</mi><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.2.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1a" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S2.SS1.SSS2.p3.1.m1.1.1.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS2.p3.1.m1.1.1.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.1.cmml">​</mo><msup id="S2.SS1.SSS2.p3.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p3.1.m1.1b"><apply id="S2.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1"><in id="S2.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.1"></in><apply id="S2.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.2">𝐴</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.2.3.4">𝑚</ci></apply></apply><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p3.1.m1.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p3.1.m1.1c">A_{mem}\in{\rm I\!R}^{N\times d_{value}}</annotation></semantics></math> from the memory <math id="S2.SS1.SSS2.p3.2.m2.1" class="ltx_Math" alttext="M_{s-1}\in{\rm I\!R}^{d_{key}\times d_{value}}" display="inline"><semantics id="S2.SS1.SSS2.p3.2.m2.1a"><mrow id="S2.SS1.SSS2.p3.2.m2.1.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.cmml"><msub id="S2.SS1.SSS2.p3.2.m2.1.1.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.2.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.2.cmml">M</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.2.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2.cmml">s</mi><mo id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.SSS2.p3.2.m2.1.1.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS2.p3.2.m2.1.1.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.1.cmml">​</mo><msup id="S2.SS1.SSS2.p3.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.cmml"><msub id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1a" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4.cmml">y</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p3.2.m2.1b"><apply id="S2.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1"><in id="S2.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.1"></in><apply id="S2.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.2.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.2.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.2">𝑀</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3"><minus id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.1"></minus><ci id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.2">𝑠</ci><cn type="integer" id="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.1"></times><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2">subscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.1"></times><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.2">𝑘</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.2.3.4">𝑦</ci></apply></apply><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p3.2.m2.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p3.2.m2.1c">M_{s-1}\in{\rm I\!R}^{d_{key}\times d_{value}}</annotation></semantics></math> by using the query <math id="S2.SS1.SSS2.p3.3.m3.1" class="ltx_Math" alttext="Q\in{\rm I\!R}^{N\times d_{key}}" display="inline"><semantics id="S2.SS1.SSS2.p3.3.m3.1a"><mrow id="S2.SS1.SSS2.p3.3.m3.1.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.2.cmml">Q</mi><mo id="S2.SS1.SSS2.p3.3.m3.1.1.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p3.3.m3.1.1.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS2.p3.3.m3.1.1.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.3.m3.1.1.3.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.1.cmml">​</mo><msup id="S2.SS1.SSS2.p3.3.m3.1.1.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4.cmml">y</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p3.3.m3.1b"><apply id="S2.SS1.SSS2.p3.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1"><in id="S2.SS1.SSS2.p3.3.m3.1.1.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.1"></in><ci id="S2.SS1.SSS2.p3.3.m3.1.1.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.2">𝑄</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3"><times id="S2.SS1.SSS2.p3.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.1"></times><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3"><times id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p3.3.m3.1.1.3.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p3.3.m3.1c">Q\in{\rm I\!R}^{N\times d_{key}}</annotation></semantics></math> as:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.3" class="ltx_Math" alttext="A_{mem}=\frac{\sigma({Q})M_{s-1}}{{\sigma(Q)}z_{s-1}}." display="block"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><msub id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2" xref="S2.E3.m1.3.3.1.1.2.2.cmml">A</mi><mrow id="S2.E3.m1.3.3.1.1.2.3" xref="S2.E3.m1.3.3.1.1.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.2.3.2" xref="S2.E3.m1.3.3.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.2.3.1" xref="S2.E3.m1.3.3.1.1.2.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.2.3.3" xref="S2.E3.m1.3.3.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.2.3.1a" xref="S2.E3.m1.3.3.1.1.2.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.2.3.4" xref="S2.E3.m1.3.3.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.1.1.1.4.2" xref="S2.E3.m1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.4.2.1" xref="S2.E3.m1.1.1.1.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">Q</mi><mo stretchy="false" id="S2.E3.m1.1.1.1.4.2.2" xref="S2.E3.m1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.2a" xref="S2.E3.m1.1.1.1.2.cmml">​</mo><msub id="S2.E3.m1.1.1.1.5" xref="S2.E3.m1.1.1.1.5.cmml"><mi id="S2.E3.m1.1.1.1.5.2" xref="S2.E3.m1.1.1.1.5.2.cmml">M</mi><mrow id="S2.E3.m1.1.1.1.5.3" xref="S2.E3.m1.1.1.1.5.3.cmml"><mi id="S2.E3.m1.1.1.1.5.3.2" xref="S2.E3.m1.1.1.1.5.3.2.cmml">s</mi><mo id="S2.E3.m1.1.1.1.5.3.1" xref="S2.E3.m1.1.1.1.5.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.5.3.3" xref="S2.E3.m1.1.1.1.5.3.3.cmml">1</mn></mrow></msub></mrow><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mi id="S2.E3.m1.2.2.2.3" xref="S2.E3.m1.2.2.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.2.4.2" xref="S2.E3.m1.2.2.2.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.2.4.2.1" xref="S2.E3.m1.2.2.2.cmml">(</mo><mi id="S2.E3.m1.2.2.2.1" xref="S2.E3.m1.2.2.2.1.cmml">Q</mi><mo stretchy="false" id="S2.E3.m1.2.2.2.4.2.2" xref="S2.E3.m1.2.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2a" xref="S2.E3.m1.2.2.2.2.cmml">​</mo><msub id="S2.E3.m1.2.2.2.5" xref="S2.E3.m1.2.2.2.5.cmml"><mi id="S2.E3.m1.2.2.2.5.2" xref="S2.E3.m1.2.2.2.5.2.cmml">z</mi><mrow id="S2.E3.m1.2.2.2.5.3" xref="S2.E3.m1.2.2.2.5.3.cmml"><mi id="S2.E3.m1.2.2.2.5.3.2" xref="S2.E3.m1.2.2.2.5.3.2.cmml">s</mi><mo id="S2.E3.m1.2.2.2.5.3.1" xref="S2.E3.m1.2.2.2.5.3.1.cmml">−</mo><mn id="S2.E3.m1.2.2.2.5.3.3" xref="S2.E3.m1.2.2.2.5.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mrow><mo lspace="0em" id="S2.E3.m1.3.3.1.2" xref="S2.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><eq id="S2.E3.m1.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1"></eq><apply id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2">𝐴</ci><apply id="S2.E3.m1.3.3.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3"><times id="S2.E3.m1.3.3.1.1.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.2.3.1"></times><ci id="S2.E3.m1.3.3.1.1.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.2.3.2">𝑚</ci><ci id="S2.E3.m1.3.3.1.1.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3.3">𝑒</ci><ci id="S2.E3.m1.3.3.1.1.2.3.4.cmml" xref="S2.E3.m1.3.3.1.1.2.3.4">𝑚</ci></apply></apply><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><divide id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2"></divide><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><times id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3">𝜎</ci><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑄</ci><apply id="S2.E3.m1.1.1.1.5.cmml" xref="S2.E3.m1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.5.1.cmml" xref="S2.E3.m1.1.1.1.5">subscript</csymbol><ci id="S2.E3.m1.1.1.1.5.2.cmml" xref="S2.E3.m1.1.1.1.5.2">𝑀</ci><apply id="S2.E3.m1.1.1.1.5.3.cmml" xref="S2.E3.m1.1.1.1.5.3"><minus id="S2.E3.m1.1.1.1.5.3.1.cmml" xref="S2.E3.m1.1.1.1.5.3.1"></minus><ci id="S2.E3.m1.1.1.1.5.3.2.cmml" xref="S2.E3.m1.1.1.1.5.3.2">𝑠</ci><cn type="integer" id="S2.E3.m1.1.1.1.5.3.3.cmml" xref="S2.E3.m1.1.1.1.5.3.3">1</cn></apply></apply></apply><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><times id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"></times><ci id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.3">𝜎</ci><ci id="S2.E3.m1.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.1">𝑄</ci><apply id="S2.E3.m1.2.2.2.5.cmml" xref="S2.E3.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.5.1.cmml" xref="S2.E3.m1.2.2.2.5">subscript</csymbol><ci id="S2.E3.m1.2.2.2.5.2.cmml" xref="S2.E3.m1.2.2.2.5.2">𝑧</ci><apply id="S2.E3.m1.2.2.2.5.3.cmml" xref="S2.E3.m1.2.2.2.5.3"><minus id="S2.E3.m1.2.2.2.5.3.1.cmml" xref="S2.E3.m1.2.2.2.5.3.1"></minus><ci id="S2.E3.m1.2.2.2.5.3.2.cmml" xref="S2.E3.m1.2.2.2.5.3.2">𝑠</ci><cn type="integer" id="S2.E3.m1.2.2.2.5.3.3.cmml" xref="S2.E3.m1.2.2.2.5.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">A_{mem}=\frac{\sigma({Q})M_{s-1}}{{\sigma(Q)}z_{s-1}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.SSS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS2.p4.3" class="ltx_p">Here, <math id="S2.SS1.SSS2.p4.1.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S2.SS1.SSS2.p4.1.m1.1a"><mi id="S2.SS1.SSS2.p4.1.m1.1.1" xref="S2.SS1.SSS2.p4.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p4.1.m1.1b"><ci id="S2.SS1.SSS2.p4.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p4.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p4.1.m1.1c">\sigma</annotation></semantics></math> and <math id="S2.SS1.SSS2.p4.2.m2.1" class="ltx_Math" alttext="z_{s-1}\in{\rm I\!R}^{d_{key}}" display="inline"><semantics id="S2.SS1.SSS2.p4.2.m2.1a"><mrow id="S2.SS1.SSS2.p4.2.m2.1.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.cmml"><msub id="S2.SS1.SSS2.p4.2.m2.1.1.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.2.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.2.cmml">z</mi><mrow id="S2.SS1.SSS2.p4.2.m2.1.1.2.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2.cmml">s</mi><mo id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.SSS2.p4.2.m2.1.1.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p4.2.m2.1.1.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS2.p4.2.m2.1.1.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p4.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.1.cmml">​</mo><msup id="S2.SS1.SSS2.p4.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2.cmml">R</mi><msub id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1a" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4.cmml">y</mi></mrow></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p4.2.m2.1b"><apply id="S2.SS1.SSS2.p4.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1"><in id="S2.SS1.SSS2.p4.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.1"></in><apply id="S2.SS1.SSS2.p4.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.2.m2.1.1.2.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p4.2.m2.1.1.2.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.2">𝑧</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3"><minus id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.1"></minus><ci id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.2">𝑠</ci><cn type="integer" id="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3"><times id="S2.SS1.SSS2.p4.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3"><times id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.2">𝑘</ci><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p4.2.m2.1.1.3.3.3.3.4">𝑦</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p4.2.m2.1c">z_{s-1}\in{\rm I\!R}^{d_{key}}</annotation></semantics></math> are a nonlinear activation function and a normalization term, respectively. As the choice of the non-linearity and the norm method is crucial for training stability, following <cite class="ltx_cite ltx_citemacro_citet">Katharopoulos et&nbsp;al. (<a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite> we record a sum over all keys as the normalization term <math id="S2.SS1.SSS2.p4.3.m3.1" class="ltx_Math" alttext="z_{s-1}" display="inline"><semantics id="S2.SS1.SSS2.p4.3.m3.1a"><msub id="S2.SS1.SSS2.p4.3.m3.1.1" xref="S2.SS1.SSS2.p4.3.m3.1.1.cmml"><mi id="S2.SS1.SSS2.p4.3.m3.1.1.2" xref="S2.SS1.SSS2.p4.3.m3.1.1.2.cmml">z</mi><mrow id="S2.SS1.SSS2.p4.3.m3.1.1.3" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.cmml"><mi id="S2.SS1.SSS2.p4.3.m3.1.1.3.2" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.2.cmml">s</mi><mo id="S2.SS1.SSS2.p4.3.m3.1.1.3.1" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.1.cmml">−</mo><mn id="S2.SS1.SSS2.p4.3.m3.1.1.3.3" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p4.3.m3.1b"><apply id="S2.SS1.SSS2.p4.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p4.3.m3.1.1.1.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p4.3.m3.1.1.2.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.2">𝑧</ci><apply id="S2.SS1.SSS2.p4.3.m3.1.1.3.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3"><minus id="S2.SS1.SSS2.p4.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.1"></minus><ci id="S2.SS1.SSS2.p4.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.2">𝑠</ci><cn type="integer" id="S2.SS1.SSS2.p4.3.m3.1.1.3.3.cmml" xref="S2.SS1.SSS2.p4.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p4.3.m3.1c">z_{s-1}</annotation></semantics></math> and use element-wise ELU + 1 as the activation function&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clevert et&nbsp;al., <a href="#bib.bib13" title="" class="ltx_ref">2015</a>)</cite>.</p>
</div>
<div id="S2.SS1.SSS2.p5" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS2.p5.5" class="ltx_p"><span id="S2.SS1.SSS2.p5.5.1" class="ltx_text ltx_font_bold">Memory update.</span> Once the retrieval is done, we update the memory and the normalization term with the new KV entries and obtain the next states as</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.2" class="ltx_Math" alttext="M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}V\text{ and }z_{s}\leftarrow z_{s-1}+\sum_{t=1}^{N}\sigma(K_{t})." display="block"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.3" xref="S2.E4.m1.2.2.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.3.2" xref="S2.E4.m1.2.2.1.1.3.2.cmml">M</mi><mi id="S2.E4.m1.2.2.1.1.3.3" xref="S2.E4.m1.2.2.1.1.3.3.cmml">s</mi></msub><mo stretchy="false" id="S2.E4.m1.2.2.1.1.4" xref="S2.E4.m1.2.2.1.1.4.cmml">←</mo><mrow id="S2.E4.m1.2.2.1.1.5" xref="S2.E4.m1.2.2.1.1.5.cmml"><msub id="S2.E4.m1.2.2.1.1.5.2" xref="S2.E4.m1.2.2.1.1.5.2.cmml"><mi id="S2.E4.m1.2.2.1.1.5.2.2" xref="S2.E4.m1.2.2.1.1.5.2.2.cmml">M</mi><mrow id="S2.E4.m1.2.2.1.1.5.2.3" xref="S2.E4.m1.2.2.1.1.5.2.3.cmml"><mi id="S2.E4.m1.2.2.1.1.5.2.3.2" xref="S2.E4.m1.2.2.1.1.5.2.3.2.cmml">s</mi><mo id="S2.E4.m1.2.2.1.1.5.2.3.1" xref="S2.E4.m1.2.2.1.1.5.2.3.1.cmml">−</mo><mn id="S2.E4.m1.2.2.1.1.5.2.3.3" xref="S2.E4.m1.2.2.1.1.5.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E4.m1.2.2.1.1.5.1" xref="S2.E4.m1.2.2.1.1.5.1.cmml">+</mo><mrow id="S2.E4.m1.2.2.1.1.5.3" xref="S2.E4.m1.2.2.1.1.5.3.cmml"><mi id="S2.E4.m1.2.2.1.1.5.3.2" xref="S2.E4.m1.2.2.1.1.5.3.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.5.3.1" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">​</mo><msup id="S2.E4.m1.2.2.1.1.5.3.3" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml"><mrow id="S2.E4.m1.2.2.1.1.5.3.3.2.2" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.5.3.3.2.2.1" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">K</mi><mo stretchy="false" id="S2.E4.m1.2.2.1.1.5.3.3.2.2.2" xref="S2.E4.m1.2.2.1.1.5.3.3.cmml">)</mo></mrow><mi id="S2.E4.m1.2.2.1.1.5.3.3.3" xref="S2.E4.m1.2.2.1.1.5.3.3.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.5.3.1a" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">​</mo><mi id="S2.E4.m1.2.2.1.1.5.3.4" xref="S2.E4.m1.2.2.1.1.5.3.4.cmml">V</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.5.3.1b" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">​</mo><mtext id="S2.E4.m1.2.2.1.1.5.3.5" xref="S2.E4.m1.2.2.1.1.5.3.5a.cmml">&nbsp;and&nbsp;</mtext><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.5.3.1c" xref="S2.E4.m1.2.2.1.1.5.3.1.cmml">​</mo><msub id="S2.E4.m1.2.2.1.1.5.3.6" xref="S2.E4.m1.2.2.1.1.5.3.6.cmml"><mi id="S2.E4.m1.2.2.1.1.5.3.6.2" xref="S2.E4.m1.2.2.1.1.5.3.6.2.cmml">z</mi><mi id="S2.E4.m1.2.2.1.1.5.3.6.3" xref="S2.E4.m1.2.2.1.1.5.3.6.3.cmml">s</mi></msub></mrow></mrow><mo stretchy="false" id="S2.E4.m1.2.2.1.1.6" xref="S2.E4.m1.2.2.1.1.6.cmml">←</mo><mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.1.3.2.cmml">z</mi><mrow id="S2.E4.m1.2.2.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.1.3.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.3.3.2" xref="S2.E4.m1.2.2.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E4.m1.2.2.1.1.1.3.3.1" xref="S2.E4.m1.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E4.m1.2.2.1.1.1.3.3.3" xref="S2.E4.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo rspace="0.055em" id="S2.E4.m1.2.2.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.2.cmml">+</mo><mrow id="S2.E4.m1.2.2.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.cmml"><munderover id="S2.E4.m1.2.2.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E4.m1.2.2.1.1.1.1.2.2.2" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.2.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.2.2.3.2" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S2.E4.m1.2.2.1.1.1.1.2.2.3.1" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E4.m1.2.2.1.1.1.1.2.2.3.3" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E4.m1.2.2.1.1.1.1.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E4.m1.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">K</mi><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><and id="S2.E4.m1.2.2.1.1a.cmml" xref="S2.E4.m1.2.2.1"></and><apply id="S2.E4.m1.2.2.1.1b.cmml" xref="S2.E4.m1.2.2.1"><ci id="S2.E4.m1.2.2.1.1.4.cmml" xref="S2.E4.m1.2.2.1.1.4">←</ci><apply id="S2.E4.m1.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2">𝑀</ci><ci id="S2.E4.m1.2.2.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.3.3">𝑠</ci></apply><apply id="S2.E4.m1.2.2.1.1.5.cmml" xref="S2.E4.m1.2.2.1.1.5"><plus id="S2.E4.m1.2.2.1.1.5.1.cmml" xref="S2.E4.m1.2.2.1.1.5.1"></plus><apply id="S2.E4.m1.2.2.1.1.5.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.2.1.cmml" xref="S2.E4.m1.2.2.1.1.5.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.5.2.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2.2">𝑀</ci><apply id="S2.E4.m1.2.2.1.1.5.2.3.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3"><minus id="S2.E4.m1.2.2.1.1.5.2.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3.1"></minus><ci id="S2.E4.m1.2.2.1.1.5.2.3.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3.2">𝑠</ci><cn type="integer" id="S2.E4.m1.2.2.1.1.5.2.3.3.cmml" xref="S2.E4.m1.2.2.1.1.5.2.3.3">1</cn></apply></apply><apply id="S2.E4.m1.2.2.1.1.5.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3"><times id="S2.E4.m1.2.2.1.1.5.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.3.1"></times><ci id="S2.E4.m1.2.2.1.1.5.3.2.cmml" xref="S2.E4.m1.2.2.1.1.5.3.2">𝜎</ci><apply id="S2.E4.m1.2.2.1.1.5.3.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.3.3">superscript</csymbol><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝐾</ci><ci id="S2.E4.m1.2.2.1.1.5.3.3.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3.3.3">𝑇</ci></apply><ci id="S2.E4.m1.2.2.1.1.5.3.4.cmml" xref="S2.E4.m1.2.2.1.1.5.3.4">𝑉</ci><ci id="S2.E4.m1.2.2.1.1.5.3.5a.cmml" xref="S2.E4.m1.2.2.1.1.5.3.5"><mtext id="S2.E4.m1.2.2.1.1.5.3.5.cmml" xref="S2.E4.m1.2.2.1.1.5.3.5">&nbsp;and&nbsp;</mtext></ci><apply id="S2.E4.m1.2.2.1.1.5.3.6.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.3.6.1.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.5.3.6.2.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6.2">𝑧</ci><ci id="S2.E4.m1.2.2.1.1.5.3.6.3.cmml" xref="S2.E4.m1.2.2.1.1.5.3.6.3">𝑠</ci></apply></apply></apply></apply><apply id="S2.E4.m1.2.2.1.1c.cmml" xref="S2.E4.m1.2.2.1"><ci id="S2.E4.m1.2.2.1.1.6.cmml" xref="S2.E4.m1.2.2.1.1.6">←</ci><share href="#S2.E4.m1.2.2.1.1.5.cmml" id="S2.E4.m1.2.2.1.1d.cmml" xref="S2.E4.m1.2.2.1"></share><apply id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"><plus id="S2.E4.m1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2"></plus><apply id="S2.E4.m1.2.2.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.3.2">𝑧</ci><apply id="S2.E4.m1.2.2.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3"><minus id="S2.E4.m1.2.2.1.1.1.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3.1"></minus><ci id="S2.E4.m1.2.2.1.1.1.3.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.E4.m1.2.2.1.1.1.3.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.E4.m1.2.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1"><apply id="S2.E4.m1.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E4.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S2.E4.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S2.E4.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3"><eq id="S2.E4.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S2.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S2.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.2"></times><ci id="S2.E4.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.3">𝜎</ci><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2">𝐾</ci><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}V\text{ and }z_{s}\leftarrow z_{s-1}+\sum_{t=1}^{N}\sigma(K_{t}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.SSS2.p5.4" class="ltx_p">The new memory states <math id="S2.SS1.SSS2.p5.1.m1.1" class="ltx_Math" alttext="M_{s}" display="inline"><semantics id="S2.SS1.SSS2.p5.1.m1.1a"><msub id="S2.SS1.SSS2.p5.1.m1.1.1" xref="S2.SS1.SSS2.p5.1.m1.1.1.cmml"><mi id="S2.SS1.SSS2.p5.1.m1.1.1.2" xref="S2.SS1.SSS2.p5.1.m1.1.1.2.cmml">M</mi><mi id="S2.SS1.SSS2.p5.1.m1.1.1.3" xref="S2.SS1.SSS2.p5.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.1.m1.1b"><apply id="S2.SS1.SSS2.p5.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p5.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p5.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1.2">𝑀</ci><ci id="S2.SS1.SSS2.p5.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p5.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.1.m1.1c">M_{s}</annotation></semantics></math> and <math id="S2.SS1.SSS2.p5.2.m2.1" class="ltx_Math" alttext="z_{s}" display="inline"><semantics id="S2.SS1.SSS2.p5.2.m2.1a"><msub id="S2.SS1.SSS2.p5.2.m2.1.1" xref="S2.SS1.SSS2.p5.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p5.2.m2.1.1.2" xref="S2.SS1.SSS2.p5.2.m2.1.1.2.cmml">z</mi><mi id="S2.SS1.SSS2.p5.2.m2.1.1.3" xref="S2.SS1.SSS2.p5.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.2.m2.1b"><apply id="S2.SS1.SSS2.p5.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p5.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p5.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1.2">𝑧</ci><ci id="S2.SS1.SSS2.p5.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p5.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.2.m2.1c">z_{s}</annotation></semantics></math> are then passed to the next segment <math id="S2.SS1.SSS2.p5.3.m3.1" class="ltx_Math" alttext="S+1" display="inline"><semantics id="S2.SS1.SSS2.p5.3.m3.1a"><mrow id="S2.SS1.SSS2.p5.3.m3.1.1" xref="S2.SS1.SSS2.p5.3.m3.1.1.cmml"><mi id="S2.SS1.SSS2.p5.3.m3.1.1.2" xref="S2.SS1.SSS2.p5.3.m3.1.1.2.cmml">S</mi><mo id="S2.SS1.SSS2.p5.3.m3.1.1.1" xref="S2.SS1.SSS2.p5.3.m3.1.1.1.cmml">+</mo><mn id="S2.SS1.SSS2.p5.3.m3.1.1.3" xref="S2.SS1.SSS2.p5.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.3.m3.1b"><apply id="S2.SS1.SSS2.p5.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1"><plus id="S2.SS1.SSS2.p5.3.m3.1.1.1.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1.1"></plus><ci id="S2.SS1.SSS2.p5.3.m3.1.1.2.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1.2">𝑆</ci><cn type="integer" id="S2.SS1.SSS2.p5.3.m3.1.1.3.cmml" xref="S2.SS1.SSS2.p5.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.3.m3.1c">S+1</annotation></semantics></math>, building in a recurrence in each attention layer. The right side term <math id="S2.SS1.SSS2.p5.4.m4.1" class="ltx_Math" alttext="\sigma(K)^{T}V" display="inline"><semantics id="S2.SS1.SSS2.p5.4.m4.1a"><mrow id="S2.SS1.SSS2.p5.4.m4.1.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.cmml"><mi id="S2.SS1.SSS2.p5.4.m4.1.2.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p5.4.m4.1.2.1" xref="S2.SS1.SSS2.p5.4.m4.1.2.1.cmml">​</mo><msup id="S2.SS1.SSS2.p5.4.m4.1.2.3" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml"><mrow id="S2.SS1.SSS2.p5.4.m4.1.2.3.2.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml"><mo stretchy="false" id="S2.SS1.SSS2.p5.4.m4.1.2.3.2.2.1" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml">(</mo><mi id="S2.SS1.SSS2.p5.4.m4.1.1" xref="S2.SS1.SSS2.p5.4.m4.1.1.cmml">K</mi><mo stretchy="false" id="S2.SS1.SSS2.p5.4.m4.1.2.3.2.2.2" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml">)</mo></mrow><mi id="S2.SS1.SSS2.p5.4.m4.1.2.3.3" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p5.4.m4.1.2.1a" xref="S2.SS1.SSS2.p5.4.m4.1.2.1.cmml">​</mo><mi id="S2.SS1.SSS2.p5.4.m4.1.2.4" xref="S2.SS1.SSS2.p5.4.m4.1.2.4.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p5.4.m4.1b"><apply id="S2.SS1.SSS2.p5.4.m4.1.2.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2"><times id="S2.SS1.SSS2.p5.4.m4.1.2.1.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.1"></times><ci id="S2.SS1.SSS2.p5.4.m4.1.2.2.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.2">𝜎</ci><apply id="S2.SS1.SSS2.p5.4.m4.1.2.3.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p5.4.m4.1.2.3.1.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.3">superscript</csymbol><ci id="S2.SS1.SSS2.p5.4.m4.1.1.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.1">𝐾</ci><ci id="S2.SS1.SSS2.p5.4.m4.1.2.3.3.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.3.3">𝑇</ci></apply><ci id="S2.SS1.SSS2.p5.4.m4.1.2.4.cmml" xref="S2.SS1.SSS2.p5.4.m4.1.2.4">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p5.4.m4.1c">\sigma(K)^{T}V</annotation></semantics></math> in Eq.&nbsp;(<a href="#S2.E4" title="In 2.1.2 Compressive Memory ‣ 2.1 Infini-attention ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) is known as an associative binding operator&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Smolensky, <a href="#bib.bib50" title="" class="ltx_ref">1990</a>; Hebb, <a href="#bib.bib21" title="" class="ltx_ref">2005</a>; Schlag et&nbsp;al., <a href="#bib.bib45" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S2.SS1.SSS2.p6" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS2.p6.1" class="ltx_p">Inspired by the success of delta rule&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>; Schlag et&nbsp;al., <a href="#bib.bib45" title="" class="ltx_ref">2020</a>; <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>, we have also incorporated it into our Infini-attention. The delta rule attempts a slightly improved memory update by first retrieving existing value entries and subtracting them from the new values before applying the associative bindings as new update.</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.4" class="ltx_Math" alttext="M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}(V-\frac{\sigma({K})M_{s-1}}{{\sigma(K)}z_{s-1}})." display="block"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4.4.1" xref="S2.E5.m1.4.4.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1" xref="S2.E5.m1.4.4.1.1.cmml"><msub id="S2.E5.m1.4.4.1.1.3" xref="S2.E5.m1.4.4.1.1.3.cmml"><mi id="S2.E5.m1.4.4.1.1.3.2" xref="S2.E5.m1.4.4.1.1.3.2.cmml">M</mi><mi id="S2.E5.m1.4.4.1.1.3.3" xref="S2.E5.m1.4.4.1.1.3.3.cmml">s</mi></msub><mo stretchy="false" id="S2.E5.m1.4.4.1.1.2" xref="S2.E5.m1.4.4.1.1.2.cmml">←</mo><mrow id="S2.E5.m1.4.4.1.1.1" xref="S2.E5.m1.4.4.1.1.1.cmml"><msub id="S2.E5.m1.4.4.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.3.cmml"><mi id="S2.E5.m1.4.4.1.1.1.3.2" xref="S2.E5.m1.4.4.1.1.1.3.2.cmml">M</mi><mrow id="S2.E5.m1.4.4.1.1.1.3.3" xref="S2.E5.m1.4.4.1.1.1.3.3.cmml"><mi id="S2.E5.m1.4.4.1.1.1.3.3.2" xref="S2.E5.m1.4.4.1.1.1.3.3.2.cmml">s</mi><mo id="S2.E5.m1.4.4.1.1.1.3.3.1" xref="S2.E5.m1.4.4.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E5.m1.4.4.1.1.1.3.3.3" xref="S2.E5.m1.4.4.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E5.m1.4.4.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="S2.E5.m1.4.4.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.4.4.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.2.cmml">​</mo><msup id="S2.E5.m1.4.4.1.1.1.1.4" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml"><mrow id="S2.E5.m1.4.4.1.1.1.1.4.2.2" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml"><mo stretchy="false" id="S2.E5.m1.4.4.1.1.1.1.4.2.2.1" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml">(</mo><mi id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml">K</mi><mo stretchy="false" id="S2.E5.m1.4.4.1.1.1.1.4.2.2.2" xref="S2.E5.m1.4.4.1.1.1.1.4.cmml">)</mo></mrow><mi id="S2.E5.m1.4.4.1.1.1.1.4.3" xref="S2.E5.m1.4.4.1.1.1.1.4.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E5.m1.4.4.1.1.1.1.2a" xref="S2.E5.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.4.4.1.1.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml">V</mi><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.3" xref="S2.E5.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.1.1.1.4.2" xref="S2.E5.m1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.1.1.1.4.2.1" xref="S2.E5.m1.1.1.1.cmml">(</mo><mi id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">K</mi><mo stretchy="false" id="S2.E5.m1.1.1.1.4.2.2" xref="S2.E5.m1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.2a" xref="S2.E5.m1.1.1.1.2.cmml">​</mo><msub id="S2.E5.m1.1.1.1.5" xref="S2.E5.m1.1.1.1.5.cmml"><mi id="S2.E5.m1.1.1.1.5.2" xref="S2.E5.m1.1.1.1.5.2.cmml">M</mi><mrow id="S2.E5.m1.1.1.1.5.3" xref="S2.E5.m1.1.1.1.5.3.cmml"><mi id="S2.E5.m1.1.1.1.5.3.2" xref="S2.E5.m1.1.1.1.5.3.2.cmml">s</mi><mo id="S2.E5.m1.1.1.1.5.3.1" xref="S2.E5.m1.1.1.1.5.3.1.cmml">−</mo><mn id="S2.E5.m1.1.1.1.5.3.3" xref="S2.E5.m1.1.1.1.5.3.3.cmml">1</mn></mrow></msub></mrow><mrow id="S2.E5.m1.2.2.2" xref="S2.E5.m1.2.2.2.cmml"><mi id="S2.E5.m1.2.2.2.3" xref="S2.E5.m1.2.2.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">​</mo><mrow id="S2.E5.m1.2.2.2.4.2" xref="S2.E5.m1.2.2.2.cmml"><mo stretchy="false" id="S2.E5.m1.2.2.2.4.2.1" xref="S2.E5.m1.2.2.2.cmml">(</mo><mi id="S2.E5.m1.2.2.2.1" xref="S2.E5.m1.2.2.2.1.cmml">K</mi><mo stretchy="false" id="S2.E5.m1.2.2.2.4.2.2" xref="S2.E5.m1.2.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.2.2a" xref="S2.E5.m1.2.2.2.2.cmml">​</mo><msub id="S2.E5.m1.2.2.2.5" xref="S2.E5.m1.2.2.2.5.cmml"><mi id="S2.E5.m1.2.2.2.5.2" xref="S2.E5.m1.2.2.2.5.2.cmml">z</mi><mrow id="S2.E5.m1.2.2.2.5.3" xref="S2.E5.m1.2.2.2.5.3.cmml"><mi id="S2.E5.m1.2.2.2.5.3.2" xref="S2.E5.m1.2.2.2.5.3.2.cmml">s</mi><mo id="S2.E5.m1.2.2.2.5.3.1" xref="S2.E5.m1.2.2.2.5.3.1.cmml">−</mo><mn id="S2.E5.m1.2.2.2.5.3.3" xref="S2.E5.m1.2.2.2.5.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mrow><mo stretchy="false" id="S2.E5.m1.4.4.1.1.1.1.1.1.3" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E5.m1.4.4.1.2" xref="S2.E5.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.4b"><apply id="S2.E5.m1.4.4.1.1.cmml" xref="S2.E5.m1.4.4.1"><ci id="S2.E5.m1.4.4.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.2">←</ci><apply id="S2.E5.m1.4.4.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.3">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2">𝑀</ci><ci id="S2.E5.m1.4.4.1.1.3.3.cmml" xref="S2.E5.m1.4.4.1.1.3.3">𝑠</ci></apply><apply id="S2.E5.m1.4.4.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1"><plus id="S2.E5.m1.4.4.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.2"></plus><apply id="S2.E5.m1.4.4.1.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.1.3.2">𝑀</ci><apply id="S2.E5.m1.4.4.1.1.1.3.3.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3"><minus id="S2.E5.m1.4.4.1.1.1.3.3.1.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3.1"></minus><ci id="S2.E5.m1.4.4.1.1.1.3.3.2.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3.2">𝑠</ci><cn type="integer" id="S2.E5.m1.4.4.1.1.1.3.3.3.cmml" xref="S2.E5.m1.4.4.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.E5.m1.4.4.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1"><times id="S2.E5.m1.4.4.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.2"></times><ci id="S2.E5.m1.4.4.1.1.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.1.1.3">𝜎</ci><apply id="S2.E5.m1.4.4.1.1.1.1.4.cmml" xref="S2.E5.m1.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.1.1.4.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.4">superscript</csymbol><ci id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3">𝐾</ci><ci id="S2.E5.m1.4.4.1.1.1.1.4.3.cmml" xref="S2.E5.m1.4.4.1.1.1.1.4.3">𝑇</ci></apply><apply id="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1"><minus id="S2.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.1"></minus><ci id="S2.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.2">𝑉</ci><apply id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2"><divide id="S2.E5.m1.2.2.3.cmml" xref="S2.E5.m1.2.2"></divide><apply id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><times id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.2"></times><ci id="S2.E5.m1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.3">𝜎</ci><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">𝐾</ci><apply id="S2.E5.m1.1.1.1.5.cmml" xref="S2.E5.m1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.5.1.cmml" xref="S2.E5.m1.1.1.1.5">subscript</csymbol><ci id="S2.E5.m1.1.1.1.5.2.cmml" xref="S2.E5.m1.1.1.1.5.2">𝑀</ci><apply id="S2.E5.m1.1.1.1.5.3.cmml" xref="S2.E5.m1.1.1.1.5.3"><minus id="S2.E5.m1.1.1.1.5.3.1.cmml" xref="S2.E5.m1.1.1.1.5.3.1"></minus><ci id="S2.E5.m1.1.1.1.5.3.2.cmml" xref="S2.E5.m1.1.1.1.5.3.2">𝑠</ci><cn type="integer" id="S2.E5.m1.1.1.1.5.3.3.cmml" xref="S2.E5.m1.1.1.1.5.3.3">1</cn></apply></apply></apply><apply id="S2.E5.m1.2.2.2.cmml" xref="S2.E5.m1.2.2.2"><times id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2"></times><ci id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.3">𝜎</ci><ci id="S2.E5.m1.2.2.2.1.cmml" xref="S2.E5.m1.2.2.2.1">𝐾</ci><apply id="S2.E5.m1.2.2.2.5.cmml" xref="S2.E5.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.5.1.cmml" xref="S2.E5.m1.2.2.2.5">subscript</csymbol><ci id="S2.E5.m1.2.2.2.5.2.cmml" xref="S2.E5.m1.2.2.2.5.2">𝑧</ci><apply id="S2.E5.m1.2.2.2.5.3.cmml" xref="S2.E5.m1.2.2.2.5.3"><minus id="S2.E5.m1.2.2.2.5.3.1.cmml" xref="S2.E5.m1.2.2.2.5.3.1"></minus><ci id="S2.E5.m1.2.2.2.5.3.2.cmml" xref="S2.E5.m1.2.2.2.5.3.2">𝑠</ci><cn type="integer" id="S2.E5.m1.2.2.2.5.3.3.cmml" xref="S2.E5.m1.2.2.2.5.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.4c">M_{s}\leftarrow M_{s-1}+\sigma(K)^{T}(V-\frac{\sigma({K})M_{s-1}}{{\sigma(K)}z_{s-1}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.SSS2.p7" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS2.p7.2" class="ltx_p">This update rule (<math id="S2.SS1.SSS2.p7.1.m1.1" class="ltx_Math" alttext="Linear+Delta" display="inline"><semantics id="S2.SS1.SSS2.p7.1.m1.1a"><mrow id="S2.SS1.SSS2.p7.1.m1.1.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.cmml"><mrow id="S2.SS1.SSS2.p7.1.m1.1.1.2" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.cmml"><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.2" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.1.m1.1.1.2.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.3" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.1.m1.1.1.2.1a" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.4" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.1.m1.1.1.2.1b" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.5" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.1.m1.1.1.2.1c" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.6" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.1.m1.1.1.2.1d" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.2.7" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.7.cmml">r</mi></mrow><mo id="S2.SS1.SSS2.p7.1.m1.1.1.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.1.cmml">+</mo><mrow id="S2.SS1.SSS2.p7.1.m1.1.1.3" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.2" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.1.m1.1.1.3.1a" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.4" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.1.m1.1.1.3.1b" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.5" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.1.m1.1.1.3.1c" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.1.m1.1.1.3.6" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.6.cmml">a</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p7.1.m1.1b"><apply id="S2.SS1.SSS2.p7.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1"><plus id="S2.SS1.SSS2.p7.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.1"></plus><apply id="S2.SS1.SSS2.p7.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2"><times id="S2.SS1.SSS2.p7.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.1"></times><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.2">𝐿</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.3">𝑖</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.4.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.4">𝑛</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.5.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.5">𝑒</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.6.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.6">𝑎</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.2.7.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.2.7">𝑟</ci></apply><apply id="S2.SS1.SSS2.p7.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3"><times id="S2.SS1.SSS2.p7.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.2">𝐷</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.4.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.5.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.5">𝑡</ci><ci id="S2.SS1.SSS2.p7.1.m1.1.1.3.6.cmml" xref="S2.SS1.SSS2.p7.1.m1.1.1.3.6">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p7.1.m1.1c">Linear+Delta</annotation></semantics></math>) leaves the associative matrix unmodified if the KV binding already exists in the memory while still tracking the same normalization term as the former one (<math id="S2.SS1.SSS2.p7.2.m2.1" class="ltx_Math" alttext="Linear" display="inline"><semantics id="S2.SS1.SSS2.p7.2.m2.1a"><mrow id="S2.SS1.SSS2.p7.2.m2.1.1" xref="S2.SS1.SSS2.p7.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p7.2.m2.1.1.2" xref="S2.SS1.SSS2.p7.2.m2.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.2.m2.1.1.1" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.3" xref="S2.SS1.SSS2.p7.2.m2.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.2.m2.1.1.1a" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.4" xref="S2.SS1.SSS2.p7.2.m2.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.2.m2.1.1.1b" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.5" xref="S2.SS1.SSS2.p7.2.m2.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.2.m2.1.1.1c" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.6" xref="S2.SS1.SSS2.p7.2.m2.1.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p7.2.m2.1.1.1d" xref="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p7.2.m2.1.1.7" xref="S2.SS1.SSS2.p7.2.m2.1.1.7.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p7.2.m2.1b"><apply id="S2.SS1.SSS2.p7.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1"><times id="S2.SS1.SSS2.p7.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.1"></times><ci id="S2.SS1.SSS2.p7.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.2">𝐿</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.3">𝑖</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.4.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.4">𝑛</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.5.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.5">𝑒</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.6.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.6">𝑎</ci><ci id="S2.SS1.SSS2.p7.2.m2.1.1.7.cmml" xref="S2.SS1.SSS2.p7.2.m2.1.1.7">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p7.2.m2.1c">Linear</annotation></semantics></math>) for numerical stability.</p>
</div>
<div id="S2.SS1.SSS2.p8" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS2.p8.3" class="ltx_p"><span id="S2.SS1.SSS2.p8.3.1" class="ltx_text ltx_font_bold">Long-term context injection.</span> We aggregate the local attention state <math id="S2.SS1.SSS2.p8.1.m1.1" class="ltx_Math" alttext="A_{dot}" display="inline"><semantics id="S2.SS1.SSS2.p8.1.m1.1a"><msub id="S2.SS1.SSS2.p8.1.m1.1.1" xref="S2.SS1.SSS2.p8.1.m1.1.1.cmml"><mi id="S2.SS1.SSS2.p8.1.m1.1.1.2" xref="S2.SS1.SSS2.p8.1.m1.1.1.2.cmml">A</mi><mrow id="S2.SS1.SSS2.p8.1.m1.1.1.3" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p8.1.m1.1.1.3.2" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p8.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p8.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p8.1.m1.1.1.3.1a" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p8.1.m1.1.1.3.4" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p8.1.m1.1b"><apply id="S2.SS1.SSS2.p8.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p8.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p8.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.2">𝐴</ci><apply id="S2.SS1.SSS2.p8.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3"><times id="S2.SS1.SSS2.p8.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p8.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.2">𝑑</ci><ci id="S2.SS1.SSS2.p8.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.3">𝑜</ci><ci id="S2.SS1.SSS2.p8.1.m1.1.1.3.4.cmml" xref="S2.SS1.SSS2.p8.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p8.1.m1.1c">A_{dot}</annotation></semantics></math> and memory retrieved content <math id="S2.SS1.SSS2.p8.2.m2.1" class="ltx_Math" alttext="A_{mem}" display="inline"><semantics id="S2.SS1.SSS2.p8.2.m2.1a"><msub id="S2.SS1.SSS2.p8.2.m2.1.1" xref="S2.SS1.SSS2.p8.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p8.2.m2.1.1.2" xref="S2.SS1.SSS2.p8.2.m2.1.1.2.cmml">A</mi><mrow id="S2.SS1.SSS2.p8.2.m2.1.1.3" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.cmml"><mi id="S2.SS1.SSS2.p8.2.m2.1.1.3.2" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p8.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p8.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p8.2.m2.1.1.3.1a" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p8.2.m2.1.1.3.4" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p8.2.m2.1b"><apply id="S2.SS1.SSS2.p8.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p8.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p8.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.2">𝐴</ci><apply id="S2.SS1.SSS2.p8.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3"><times id="S2.SS1.SSS2.p8.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p8.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p8.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.3">𝑒</ci><ci id="S2.SS1.SSS2.p8.2.m2.1.1.3.4.cmml" xref="S2.SS1.SSS2.p8.2.m2.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p8.2.m2.1c">A_{mem}</annotation></semantics></math> via a learned gating scalar <math id="S2.SS1.SSS2.p8.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S2.SS1.SSS2.p8.3.m3.1a"><mi id="S2.SS1.SSS2.p8.3.m3.1.1" xref="S2.SS1.SSS2.p8.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p8.3.m3.1b"><ci id="S2.SS1.SSS2.p8.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p8.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p8.3.m3.1c">\beta</annotation></semantics></math>:</p>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1.3" class="ltx_Math" alttext="A=\textit{sigmoid}(\beta)\odot A_{mem}+(1-\textit{sigmoid}(\beta))\odot A_{dot}." display="block"><semantics id="S2.E6.m1.3a"><mrow id="S2.E6.m1.3.3.1" xref="S2.E6.m1.3.3.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1" xref="S2.E6.m1.3.3.1.1.cmml"><mi id="S2.E6.m1.3.3.1.1.3" xref="S2.E6.m1.3.3.1.1.3.cmml">A</mi><mo id="S2.E6.m1.3.3.1.1.2" xref="S2.E6.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E6.m1.3.3.1.1.1" xref="S2.E6.m1.3.3.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.3.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E6.m1.3.3.1.1.1.3.2.2" xref="S2.E6.m1.3.3.1.1.1.3.2.2a.cmml">sigmoid</mtext><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.3.2.1" xref="S2.E6.m1.3.3.1.1.1.3.2.1.cmml">​</mo><mrow id="S2.E6.m1.3.3.1.1.1.3.2.3.2" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml"><mo stretchy="false" id="S2.E6.m1.3.3.1.1.1.3.2.3.2.1" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml">(</mo><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">β</mi><mo rspace="0.055em" stretchy="false" id="S2.E6.m1.3.3.1.1.1.3.2.3.2.2" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S2.E6.m1.3.3.1.1.1.3.1" xref="S2.E6.m1.3.3.1.1.1.3.1.cmml">⊙</mo><msub id="S2.E6.m1.3.3.1.1.1.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.3.3.2" xref="S2.E6.m1.3.3.1.1.1.3.3.2.cmml">A</mi><mrow id="S2.E6.m1.3.3.1.1.1.3.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.3.3.3.2" xref="S2.E6.m1.3.3.1.1.1.3.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.3.3.3.1" xref="S2.E6.m1.3.3.1.1.1.3.3.3.1.cmml">​</mo><mi id="S2.E6.m1.3.3.1.1.1.3.3.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.3.3.3.1a" xref="S2.E6.m1.3.3.1.1.1.3.3.3.1.cmml">​</mo><mi id="S2.E6.m1.3.3.1.1.1.3.3.3.4" xref="S2.E6.m1.3.3.1.1.1.3.3.3.4.cmml">m</mi></mrow></msub></mrow><mo id="S2.E6.m1.3.3.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.2.cmml">+</mo><mrow id="S2.E6.m1.3.3.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m1.3.3.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mn id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_italic" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml">sigmoid</mtext><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.3.2.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E6.m1.2.2" xref="S2.E6.m1.2.2.cmml">β</mi><mo stretchy="false" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.3.2.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S2.E6.m1.3.3.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.E6.m1.3.3.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml">⊙</mo><msub id="S2.E6.m1.3.3.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.1.3.2.cmml">A</mi><mrow id="S2.E6.m1.3.3.1.1.1.1.3.3" xref="S2.E6.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.3.3.2" xref="S2.E6.m1.3.3.1.1.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.1.3.3.1" xref="S2.E6.m1.3.3.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E6.m1.3.3.1.1.1.1.3.3.3" xref="S2.E6.m1.3.3.1.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.1.3.3.1a" xref="S2.E6.m1.3.3.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E6.m1.3.3.1.1.1.1.3.3.4" xref="S2.E6.m1.3.3.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow></mrow></mrow><mo lspace="0em" id="S2.E6.m1.3.3.1.2" xref="S2.E6.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.3b"><apply id="S2.E6.m1.3.3.1.1.cmml" xref="S2.E6.m1.3.3.1"><eq id="S2.E6.m1.3.3.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2"></eq><ci id="S2.E6.m1.3.3.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.3">𝐴</ci><apply id="S2.E6.m1.3.3.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1"><plus id="S2.E6.m1.3.3.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.2"></plus><apply id="S2.E6.m1.3.3.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.1">direct-product</csymbol><apply id="S2.E6.m1.3.3.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2"><times id="S2.E6.m1.3.3.1.1.1.3.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.1"></times><ci id="S2.E6.m1.3.3.1.1.1.3.2.2a.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.2"><mtext class="ltx_mathvariant_italic" id="S2.E6.m1.3.3.1.1.1.3.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.2">sigmoid</mtext></ci><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝛽</ci></apply><apply id="S2.E6.m1.3.3.1.1.1.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.3.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.3.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.2">𝐴</ci><apply id="S2.E6.m1.3.3.1.1.1.3.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3"><times id="S2.E6.m1.3.3.1.1.1.3.3.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.1"></times><ci id="S2.E6.m1.3.3.1.1.1.3.3.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.2">𝑚</ci><ci id="S2.E6.m1.3.3.1.1.1.3.3.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.3">𝑒</ci><ci id="S2.E6.m1.3.3.1.1.1.3.3.3.4.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3.3.4">𝑚</ci></apply></apply></apply><apply id="S2.E6.m1.3.3.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.2">direct-product</csymbol><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1"><minus id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2">1</cn><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3"><times id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.1"></times><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_italic" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.3.2">sigmoid</mtext></ci><ci id="S2.E6.m1.2.2.cmml" xref="S2.E6.m1.2.2">𝛽</ci></apply></apply><apply id="S2.E6.m1.3.3.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.2">𝐴</ci><apply id="S2.E6.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3"><times id="S2.E6.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.1"></times><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.2">𝑑</ci><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.3">𝑜</ci><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.4.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.3c">A=\textit{sigmoid}(\beta)\odot A_{mem}+(1-\textit{sigmoid}(\beta))\odot A_{dot}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.SSS2.p8.4" class="ltx_p">This adds only a single scalar value as training parameter per head while allowing a learnable trade-off between the long-term and local information flows in the model&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S2.SS1.SSS2.p9" class="ltx_para ltx_noindent">
<p id="S2.SS1.SSS2.p9.2" class="ltx_p">Similar to the standard MHA, for the multi-head Infini-attention we compute <math id="S2.SS1.SSS2.p9.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S2.SS1.SSS2.p9.1.m1.1a"><mi id="S2.SS1.SSS2.p9.1.m1.1.1" xref="S2.SS1.SSS2.p9.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p9.1.m1.1b"><ci id="S2.SS1.SSS2.p9.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p9.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p9.1.m1.1c">H</annotation></semantics></math> number of context states in parallel, and concatenate and project them for the final attention output <math id="S2.SS1.SSS2.p9.2.m2.1" class="ltx_Math" alttext="O\in{\rm I\!R}^{N\times d_{model}}" display="inline"><semantics id="S2.SS1.SSS2.p9.2.m2.1a"><mrow id="S2.SS1.SSS2.p9.2.m2.1.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.2.cmml">O</mi><mo id="S2.SS1.SSS2.p9.2.m2.1.1.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p9.2.m2.1.1.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS2.p9.2.m2.1.1.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.2.m2.1.1.3.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.1.cmml">​</mo><msup id="S2.SS1.SSS2.p9.2.m2.1.1.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p9.2.m2.1b"><apply id="S2.SS1.SSS2.p9.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1"><in id="S2.SS1.SSS2.p9.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.1"></in><ci id="S2.SS1.SSS2.p9.2.m2.1.1.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.2">𝑂</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3"><times id="S2.SS1.SSS2.p9.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.1"></times><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3"><times id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.2">𝑁</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.3">𝑜</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.4">𝑑</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.5">𝑒</ci><ci id="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p9.2.m2.1.1.3.3.3.3.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p9.2.m2.1c">O\in{\rm I\!R}^{N\times d_{model}}</annotation></semantics></math>:</p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1.2" class="ltx_Math" alttext="O=[A^{1};\dotso A^{H}]W_{O}" display="block"><semantics id="S2.E7.m1.2a"><mrow id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml"><mi id="S2.E7.m1.2.2.4" xref="S2.E7.m1.2.2.4.cmml">O</mi><mo id="S2.E7.m1.2.2.3" xref="S2.E7.m1.2.2.3.cmml">=</mo><mrow id="S2.E7.m1.2.2.2" xref="S2.E7.m1.2.2.2.cmml"><mrow id="S2.E7.m1.2.2.2.2.2" xref="S2.E7.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.E7.m1.2.2.2.2.2.3" xref="S2.E7.m1.2.2.2.2.3.cmml">[</mo><msup id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">A</mi><mn id="S2.E7.m1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.E7.m1.2.2.2.2.2.4" xref="S2.E7.m1.2.2.2.2.3.cmml">;</mo><mrow id="S2.E7.m1.2.2.2.2.2.2" xref="S2.E7.m1.2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S2.E7.m1.2.2.2.2.2.2.2" xref="S2.E7.m1.2.2.2.2.2.2.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.2.2.2.2.2.2.1" xref="S2.E7.m1.2.2.2.2.2.2.1.cmml">​</mo><msup id="S2.E7.m1.2.2.2.2.2.2.3" xref="S2.E7.m1.2.2.2.2.2.2.3.cmml"><mi id="S2.E7.m1.2.2.2.2.2.2.3.2" xref="S2.E7.m1.2.2.2.2.2.2.3.2.cmml">A</mi><mi id="S2.E7.m1.2.2.2.2.2.2.3.3" xref="S2.E7.m1.2.2.2.2.2.2.3.3.cmml">H</mi></msup></mrow><mo stretchy="false" id="S2.E7.m1.2.2.2.2.2.5" xref="S2.E7.m1.2.2.2.2.3.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E7.m1.2.2.2.3" xref="S2.E7.m1.2.2.2.3.cmml">​</mo><msub id="S2.E7.m1.2.2.2.4" xref="S2.E7.m1.2.2.2.4.cmml"><mi id="S2.E7.m1.2.2.2.4.2" xref="S2.E7.m1.2.2.2.4.2.cmml">W</mi><mi id="S2.E7.m1.2.2.2.4.3" xref="S2.E7.m1.2.2.2.4.3.cmml">O</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.2b"><apply id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2"><eq id="S2.E7.m1.2.2.3.cmml" xref="S2.E7.m1.2.2.3"></eq><ci id="S2.E7.m1.2.2.4.cmml" xref="S2.E7.m1.2.2.4">𝑂</ci><apply id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2.2"><times id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.3"></times><list id="S2.E7.m1.2.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.2.2"><apply id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2">𝐴</ci><cn type="integer" id="S2.E7.m1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E7.m1.2.2.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2.2.2"><times id="S2.E7.m1.2.2.2.2.2.2.1.cmml" xref="S2.E7.m1.2.2.2.2.2.2.1"></times><ci id="S2.E7.m1.2.2.2.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2.2.2.2">…</ci><apply id="S2.E7.m1.2.2.2.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3">superscript</csymbol><ci id="S2.E7.m1.2.2.2.2.2.2.3.2.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3.2">𝐴</ci><ci id="S2.E7.m1.2.2.2.2.2.2.3.3.cmml" xref="S2.E7.m1.2.2.2.2.2.2.3.3">𝐻</ci></apply></apply></list><apply id="S2.E7.m1.2.2.2.4.cmml" xref="S2.E7.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.4.1.cmml" xref="S2.E7.m1.2.2.2.4">subscript</csymbol><ci id="S2.E7.m1.2.2.2.4.2.cmml" xref="S2.E7.m1.2.2.2.4.2">𝑊</ci><ci id="S2.E7.m1.2.2.2.4.3.cmml" xref="S2.E7.m1.2.2.2.4.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.2c">O=[A^{1};\dotso A^{H}]W_{O}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.SSS2.p9.3" class="ltx_p">where <math id="S2.SS1.SSS2.p9.3.m1.1" class="ltx_Math" alttext="W_{O}\in{\rm I\!R}^{H\times d_{value}\times d_{model}}" display="inline"><semantics id="S2.SS1.SSS2.p9.3.m1.1a"><mrow id="S2.SS1.SSS2.p9.3.m1.1.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.cmml"><msub id="S2.SS1.SSS2.p9.3.m1.1.1.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.2.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.2.cmml">W</mi><mi id="S2.SS1.SSS2.p9.3.m1.1.1.2.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.3.cmml">O</mi></msub><mo id="S2.SS1.SSS2.p9.3.m1.1.1.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.1.cmml">∈</mo><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S2.SS1.SSS2.p9.3.m1.1.1.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.1.cmml">​</mo><msup id="S2.SS1.SSS2.p9.3.m1.1.1.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2.cmml">R</mi><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1a" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1b" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1c" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6.cmml">e</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1a" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1.cmml">×</mo><msub id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2.cmml">d</mi><mrow id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.cmml"><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1a" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1b" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1c" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6.cmml">l</mi></mrow></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p9.3.m1.1b"><apply id="S2.SS1.SSS2.p9.3.m1.1.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1"><in id="S2.SS1.SSS2.p9.3.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.1"></in><apply id="S2.SS1.SSS2.p9.3.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.2">𝑊</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.2.3">𝑂</ci></apply><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.2">I</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.2">R</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.2">𝐻</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.2">𝑑</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.2">𝑣</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.4">𝑙</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.5">𝑢</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.3.3.6">𝑒</ci></apply></apply><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4">subscript</csymbol><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.2">𝑑</ci><apply id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3"><times id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.1"></times><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.2">𝑚</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.3">𝑜</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.4">𝑑</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.5">𝑒</ci><ci id="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6.cmml" xref="S2.SS1.SSS2.p9.3.m1.1.1.3.3.3.4.3.6">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p9.3.m1.1c">W_{O}\in{\rm I\!R}^{H\times d_{value}\times d_{model}}</annotation></semantics></math> is trainable weights.</p>
</div>
</section>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Memory and Effective Context Window</h3>

<figure id="S2.T1" class="ltx_table">
<table id="S2.T1.12" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.T1.12.13.1" class="ltx_tr">
<th id="S2.T1.12.13.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Model</th>
<th id="S2.T1.12.13.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Memory (cache) footprint</th>
<th id="S2.T1.12.13.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Context length</th>
<th id="S2.T1.12.13.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Memory update</th>
<th id="S2.T1.12.13.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Memory retrieval</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.T1.2.2" class="ltx_tr">
<td id="S2.T1.2.2.3" class="ltx_td ltx_align_left ltx_border_t">Transformer-XL</td>
<td id="S2.T1.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><math id="S2.T1.1.1.1.m1.1" class="ltx_Math" alttext="(d_{key}+d_{value})\times H\times N\times l" display="inline"><semantics id="S2.T1.1.1.1.m1.1a"><mrow id="S2.T1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.m1.1.1.cmml"><mrow id="S2.T1.1.1.1.m1.1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.T1.1.1.1.m1.1.1.1.1.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.1.1.1.m1.1.1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml"><msub id="S2.T1.1.1.1.m1.1.1.1.1.1.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1a" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.T1.1.1.1.m1.1.1.1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.T1.1.1.1.m1.1.1.1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1a" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1b" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1c" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6.cmml">e</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S2.T1.1.1.1.m1.1.1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.T1.1.1.1.m1.1.1.2" xref="S2.T1.1.1.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.1.1.1.m1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.3.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.1.1.1.m1.1.1.2a" xref="S2.T1.1.1.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.1.1.1.m1.1.1.4" xref="S2.T1.1.1.1.m1.1.1.4.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.1.1.1.m1.1.1.2b" xref="S2.T1.1.1.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.1.1.1.m1.1.1.5" xref="S2.T1.1.1.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.m1.1b"><apply id="S2.T1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1"><times id="S2.T1.1.1.1.m1.1.1.2.cmml" xref="S2.T1.1.1.1.m1.1.1.2"></times><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1"><plus id="S2.T1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.1.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3"><times id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.2">𝑘</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.2.3.4">𝑦</ci></apply></apply><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.1.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3"><times id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.1"></times><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.5">𝑢</ci><ci id="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6.cmml" xref="S2.T1.1.1.1.m1.1.1.1.1.1.3.3.6">𝑒</ci></apply></apply></apply><ci id="S2.T1.1.1.1.m1.1.1.3.cmml" xref="S2.T1.1.1.1.m1.1.1.3">𝐻</ci><ci id="S2.T1.1.1.1.m1.1.1.4.cmml" xref="S2.T1.1.1.1.m1.1.1.4">𝑁</ci><ci id="S2.T1.1.1.1.m1.1.1.5.cmml" xref="S2.T1.1.1.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.m1.1c">(d_{key}+d_{value})\times H\times N\times l</annotation></semantics></math></td>
<td id="S2.T1.2.2.2" class="ltx_td ltx_align_left ltx_border_t"><math id="S2.T1.2.2.2.m1.1" class="ltx_Math" alttext="N\times l" display="inline"><semantics id="S2.T1.2.2.2.m1.1a"><mrow id="S2.T1.2.2.2.m1.1.1" xref="S2.T1.2.2.2.m1.1.1.cmml"><mi id="S2.T1.2.2.2.m1.1.1.2" xref="S2.T1.2.2.2.m1.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.2.2.2.m1.1.1.1" xref="S2.T1.2.2.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.2.2.2.m1.1.1.3" xref="S2.T1.2.2.2.m1.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.2.2.2.m1.1b"><apply id="S2.T1.2.2.2.m1.1.1.cmml" xref="S2.T1.2.2.2.m1.1.1"><times id="S2.T1.2.2.2.m1.1.1.1.cmml" xref="S2.T1.2.2.2.m1.1.1.1"></times><ci id="S2.T1.2.2.2.m1.1.1.2.cmml" xref="S2.T1.2.2.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.2.2.2.m1.1.1.3.cmml" xref="S2.T1.2.2.2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.2.2.m1.1c">N\times l</annotation></semantics></math></td>
<td id="S2.T1.2.2.4" class="ltx_td ltx_align_left ltx_border_t">Discarded</td>
<td id="S2.T1.2.2.5" class="ltx_td ltx_align_left ltx_border_t">Dot-product attention</td>
</tr>
<tr id="S2.T1.4.4" class="ltx_tr">
<td id="S2.T1.4.4.3" class="ltx_td ltx_align_left">Compressive Transformer</td>
<td id="S2.T1.3.3.1" class="ltx_td ltx_align_left"><math id="S2.T1.3.3.1.m1.1" class="ltx_Math" alttext="d_{model}\times(c+N)\times l" display="inline"><semantics id="S2.T1.3.3.1.m1.1a"><mrow id="S2.T1.3.3.1.m1.1.1" xref="S2.T1.3.3.1.m1.1.1.cmml"><msub id="S2.T1.3.3.1.m1.1.1.3" xref="S2.T1.3.3.1.m1.1.1.3.cmml"><mi id="S2.T1.3.3.1.m1.1.1.3.2" xref="S2.T1.3.3.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.3.3.1.m1.1.1.3.3" xref="S2.T1.3.3.1.m1.1.1.3.3.cmml"><mi id="S2.T1.3.3.1.m1.1.1.3.3.2" xref="S2.T1.3.3.1.m1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.T1.3.3.1.m1.1.1.3.3.1" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.3" xref="S2.T1.3.3.1.m1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.T1.3.3.1.m1.1.1.3.3.1a" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.4" xref="S2.T1.3.3.1.m1.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.T1.3.3.1.m1.1.1.3.3.1b" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.5" xref="S2.T1.3.3.1.m1.1.1.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.T1.3.3.1.m1.1.1.3.3.1c" xref="S2.T1.3.3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.3.3.1.m1.1.1.3.3.6" xref="S2.T1.3.3.1.m1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.T1.3.3.1.m1.1.1.2" xref="S2.T1.3.3.1.m1.1.1.2.cmml">×</mo><mrow id="S2.T1.3.3.1.m1.1.1.1.1" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.T1.3.3.1.m1.1.1.1.1.2" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.3.3.1.m1.1.1.1.1.1" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml"><mi id="S2.T1.3.3.1.m1.1.1.1.1.1.2" xref="S2.T1.3.3.1.m1.1.1.1.1.1.2.cmml">c</mi><mo id="S2.T1.3.3.1.m1.1.1.1.1.1.1" xref="S2.T1.3.3.1.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.T1.3.3.1.m1.1.1.1.1.1.3" xref="S2.T1.3.3.1.m1.1.1.1.1.1.3.cmml">N</mi></mrow><mo rspace="0.055em" stretchy="false" id="S2.T1.3.3.1.m1.1.1.1.1.3" xref="S2.T1.3.3.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.T1.3.3.1.m1.1.1.2a" xref="S2.T1.3.3.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.3.3.1.m1.1.1.4" xref="S2.T1.3.3.1.m1.1.1.4.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.3.3.1.m1.1b"><apply id="S2.T1.3.3.1.m1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1"><times id="S2.T1.3.3.1.m1.1.1.2.cmml" xref="S2.T1.3.3.1.m1.1.1.2"></times><apply id="S2.T1.3.3.1.m1.1.1.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.3.3.1.m1.1.1.3.1.cmml" xref="S2.T1.3.3.1.m1.1.1.3">subscript</csymbol><ci id="S2.T1.3.3.1.m1.1.1.3.2.cmml" xref="S2.T1.3.3.1.m1.1.1.3.2">𝑑</ci><apply id="S2.T1.3.3.1.m1.1.1.3.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3"><times id="S2.T1.3.3.1.m1.1.1.3.3.1.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.1"></times><ci id="S2.T1.3.3.1.m1.1.1.3.3.2.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.2">𝑚</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.3.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.3">𝑜</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.4.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.4">𝑑</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.5.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.5">𝑒</ci><ci id="S2.T1.3.3.1.m1.1.1.3.3.6.cmml" xref="S2.T1.3.3.1.m1.1.1.3.3.6">𝑙</ci></apply></apply><apply id="S2.T1.3.3.1.m1.1.1.1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1"><plus id="S2.T1.3.3.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1.1.1"></plus><ci id="S2.T1.3.3.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1.1.2">𝑐</ci><ci id="S2.T1.3.3.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.3.3.1.m1.1.1.1.1.1.3">𝑁</ci></apply><ci id="S2.T1.3.3.1.m1.1.1.4.cmml" xref="S2.T1.3.3.1.m1.1.1.4">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.3.1.m1.1c">d_{model}\times(c+N)\times l</annotation></semantics></math></td>
<td id="S2.T1.4.4.2" class="ltx_td ltx_align_left"><math id="S2.T1.4.4.2.m1.1" class="ltx_Math" alttext="(c\times r+N)\times l" display="inline"><semantics id="S2.T1.4.4.2.m1.1a"><mrow id="S2.T1.4.4.2.m1.1.1" xref="S2.T1.4.4.2.m1.1.1.cmml"><mrow id="S2.T1.4.4.2.m1.1.1.1.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.T1.4.4.2.m1.1.1.1.1.2" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.4.4.2.m1.1.1.1.1.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml"><mrow id="S2.T1.4.4.2.m1.1.1.1.1.1.2" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.4.4.2.m1.1.1.1.1.1.2.2" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.2.cmml">c</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.4.4.2.m1.1.1.1.1.1.2.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.1.cmml">×</mo><mi id="S2.T1.4.4.2.m1.1.1.1.1.1.2.3" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.3.cmml">r</mi></mrow><mo id="S2.T1.4.4.2.m1.1.1.1.1.1.1" xref="S2.T1.4.4.2.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.T1.4.4.2.m1.1.1.1.1.1.3" xref="S2.T1.4.4.2.m1.1.1.1.1.1.3.cmml">N</mi></mrow><mo rspace="0.055em" stretchy="false" id="S2.T1.4.4.2.m1.1.1.1.1.3" xref="S2.T1.4.4.2.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.T1.4.4.2.m1.1.1.2" xref="S2.T1.4.4.2.m1.1.1.2.cmml">×</mo><mi id="S2.T1.4.4.2.m1.1.1.3" xref="S2.T1.4.4.2.m1.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.4.4.2.m1.1b"><apply id="S2.T1.4.4.2.m1.1.1.cmml" xref="S2.T1.4.4.2.m1.1.1"><times id="S2.T1.4.4.2.m1.1.1.2.cmml" xref="S2.T1.4.4.2.m1.1.1.2"></times><apply id="S2.T1.4.4.2.m1.1.1.1.1.1.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1"><plus id="S2.T1.4.4.2.m1.1.1.1.1.1.1.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.4.4.2.m1.1.1.1.1.1.2.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2"><times id="S2.T1.4.4.2.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.1"></times><ci id="S2.T1.4.4.2.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.2">𝑐</ci><ci id="S2.T1.4.4.2.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.2.3">𝑟</ci></apply><ci id="S2.T1.4.4.2.m1.1.1.1.1.1.3.cmml" xref="S2.T1.4.4.2.m1.1.1.1.1.1.3">𝑁</ci></apply><ci id="S2.T1.4.4.2.m1.1.1.3.cmml" xref="S2.T1.4.4.2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.4.2.m1.1c">(c\times r+N)\times l</annotation></semantics></math></td>
<td id="S2.T1.4.4.4" class="ltx_td ltx_align_left">Discarded</td>
<td id="S2.T1.4.4.5" class="ltx_td ltx_align_left">Dot-product attention</td>
</tr>
<tr id="S2.T1.6.6" class="ltx_tr">
<td id="S2.T1.6.6.3" class="ltx_td ltx_align_left">Memorizing Transformers</td>
<td id="S2.T1.5.5.1" class="ltx_td ltx_align_left"><math id="S2.T1.5.5.1.m1.1" class="ltx_Math" alttext="(d_{key}+d_{value})\times H\times N\times S" display="inline"><semantics id="S2.T1.5.5.1.m1.1a"><mrow id="S2.T1.5.5.1.m1.1.1" xref="S2.T1.5.5.1.m1.1.1.cmml"><mrow id="S2.T1.5.5.1.m1.1.1.1.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.T1.5.5.1.m1.1.1.1.1.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.5.5.1.m1.1.1.1.1.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml"><msub id="S2.T1.5.5.1.m1.1.1.1.1.1.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1a" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.T1.5.5.1.m1.1.1.1.1.1.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.T1.5.5.1.m1.1.1.1.1.1.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1a" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1b" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1c" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6.cmml">e</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S2.T1.5.5.1.m1.1.1.1.1.3" xref="S2.T1.5.5.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.T1.5.5.1.m1.1.1.2" xref="S2.T1.5.5.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.5.5.1.m1.1.1.3" xref="S2.T1.5.5.1.m1.1.1.3.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.5.5.1.m1.1.1.2a" xref="S2.T1.5.5.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.5.5.1.m1.1.1.4" xref="S2.T1.5.5.1.m1.1.1.4.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.5.5.1.m1.1.1.2b" xref="S2.T1.5.5.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.5.5.1.m1.1.1.5" xref="S2.T1.5.5.1.m1.1.1.5.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.5.5.1.m1.1b"><apply id="S2.T1.5.5.1.m1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1"><times id="S2.T1.5.5.1.m1.1.1.2.cmml" xref="S2.T1.5.5.1.m1.1.1.2"></times><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1"><plus id="S2.T1.5.5.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.5.5.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3"><times id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.2">𝑘</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.2.3.4">𝑦</ci></apply></apply><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.5.5.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3"><times id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.1"></times><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.5">𝑢</ci><ci id="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6.cmml" xref="S2.T1.5.5.1.m1.1.1.1.1.1.3.3.6">𝑒</ci></apply></apply></apply><ci id="S2.T1.5.5.1.m1.1.1.3.cmml" xref="S2.T1.5.5.1.m1.1.1.3">𝐻</ci><ci id="S2.T1.5.5.1.m1.1.1.4.cmml" xref="S2.T1.5.5.1.m1.1.1.4">𝑁</ci><ci id="S2.T1.5.5.1.m1.1.1.5.cmml" xref="S2.T1.5.5.1.m1.1.1.5">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.5.1.m1.1c">(d_{key}+d_{value})\times H\times N\times S</annotation></semantics></math></td>
<td id="S2.T1.6.6.2" class="ltx_td ltx_align_left"><math id="S2.T1.6.6.2.m1.1" class="ltx_Math" alttext="N\times S" display="inline"><semantics id="S2.T1.6.6.2.m1.1a"><mrow id="S2.T1.6.6.2.m1.1.1" xref="S2.T1.6.6.2.m1.1.1.cmml"><mi id="S2.T1.6.6.2.m1.1.1.2" xref="S2.T1.6.6.2.m1.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.6.6.2.m1.1.1.1" xref="S2.T1.6.6.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.6.6.2.m1.1.1.3" xref="S2.T1.6.6.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.6.6.2.m1.1b"><apply id="S2.T1.6.6.2.m1.1.1.cmml" xref="S2.T1.6.6.2.m1.1.1"><times id="S2.T1.6.6.2.m1.1.1.1.cmml" xref="S2.T1.6.6.2.m1.1.1.1"></times><ci id="S2.T1.6.6.2.m1.1.1.2.cmml" xref="S2.T1.6.6.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.6.6.2.m1.1.1.3.cmml" xref="S2.T1.6.6.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.6.2.m1.1c">N\times S</annotation></semantics></math></td>
<td id="S2.T1.6.6.4" class="ltx_td ltx_align_left">None</td>
<td id="S2.T1.6.6.5" class="ltx_td ltx_align_left">kNN + dot-product attention</td>
</tr>
<tr id="S2.T1.8.8" class="ltx_tr">
<td id="S2.T1.8.8.3" class="ltx_td ltx_align_left">RMT</td>
<td id="S2.T1.7.7.1" class="ltx_td ltx_align_left"><math id="S2.T1.7.7.1.m1.1" class="ltx_Math" alttext="d_{model}\times p\times l\times 2" display="inline"><semantics id="S2.T1.7.7.1.m1.1a"><mrow id="S2.T1.7.7.1.m1.1.1" xref="S2.T1.7.7.1.m1.1.1.cmml"><msub id="S2.T1.7.7.1.m1.1.1.2" xref="S2.T1.7.7.1.m1.1.1.2.cmml"><mi id="S2.T1.7.7.1.m1.1.1.2.2" xref="S2.T1.7.7.1.m1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.7.7.1.m1.1.1.2.3" xref="S2.T1.7.7.1.m1.1.1.2.3.cmml"><mi id="S2.T1.7.7.1.m1.1.1.2.3.2" xref="S2.T1.7.7.1.m1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.T1.7.7.1.m1.1.1.2.3.1" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.3" xref="S2.T1.7.7.1.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.T1.7.7.1.m1.1.1.2.3.1a" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.4" xref="S2.T1.7.7.1.m1.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.T1.7.7.1.m1.1.1.2.3.1b" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.5" xref="S2.T1.7.7.1.m1.1.1.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.T1.7.7.1.m1.1.1.2.3.1c" xref="S2.T1.7.7.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.7.7.1.m1.1.1.2.3.6" xref="S2.T1.7.7.1.m1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.T1.7.7.1.m1.1.1.1" xref="S2.T1.7.7.1.m1.1.1.1.cmml">×</mo><mi id="S2.T1.7.7.1.m1.1.1.3" xref="S2.T1.7.7.1.m1.1.1.3.cmml">p</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.7.7.1.m1.1.1.1a" xref="S2.T1.7.7.1.m1.1.1.1.cmml">×</mo><mi id="S2.T1.7.7.1.m1.1.1.4" xref="S2.T1.7.7.1.m1.1.1.4.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.7.7.1.m1.1.1.1b" xref="S2.T1.7.7.1.m1.1.1.1.cmml">×</mo><mn id="S2.T1.7.7.1.m1.1.1.5" xref="S2.T1.7.7.1.m1.1.1.5.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.7.7.1.m1.1b"><apply id="S2.T1.7.7.1.m1.1.1.cmml" xref="S2.T1.7.7.1.m1.1.1"><times id="S2.T1.7.7.1.m1.1.1.1.cmml" xref="S2.T1.7.7.1.m1.1.1.1"></times><apply id="S2.T1.7.7.1.m1.1.1.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.7.7.1.m1.1.1.2.1.cmml" xref="S2.T1.7.7.1.m1.1.1.2">subscript</csymbol><ci id="S2.T1.7.7.1.m1.1.1.2.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2.2">𝑑</ci><apply id="S2.T1.7.7.1.m1.1.1.2.3.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3"><times id="S2.T1.7.7.1.m1.1.1.2.3.1.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.1"></times><ci id="S2.T1.7.7.1.m1.1.1.2.3.2.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.2">𝑚</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.3.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.3">𝑜</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.4.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.4">𝑑</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.5.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.5">𝑒</ci><ci id="S2.T1.7.7.1.m1.1.1.2.3.6.cmml" xref="S2.T1.7.7.1.m1.1.1.2.3.6">𝑙</ci></apply></apply><ci id="S2.T1.7.7.1.m1.1.1.3.cmml" xref="S2.T1.7.7.1.m1.1.1.3">𝑝</ci><ci id="S2.T1.7.7.1.m1.1.1.4.cmml" xref="S2.T1.7.7.1.m1.1.1.4">𝑙</ci><cn type="integer" id="S2.T1.7.7.1.m1.1.1.5.cmml" xref="S2.T1.7.7.1.m1.1.1.5">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.7.7.1.m1.1c">d_{model}\times p\times l\times 2</annotation></semantics></math></td>
<td id="S2.T1.8.8.2" class="ltx_td ltx_align_left"><math id="S2.T1.8.8.2.m1.1" class="ltx_Math" alttext="N\times S" display="inline"><semantics id="S2.T1.8.8.2.m1.1a"><mrow id="S2.T1.8.8.2.m1.1.1" xref="S2.T1.8.8.2.m1.1.1.cmml"><mi id="S2.T1.8.8.2.m1.1.1.2" xref="S2.T1.8.8.2.m1.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.8.8.2.m1.1.1.1" xref="S2.T1.8.8.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.8.8.2.m1.1.1.3" xref="S2.T1.8.8.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.8.8.2.m1.1b"><apply id="S2.T1.8.8.2.m1.1.1.cmml" xref="S2.T1.8.8.2.m1.1.1"><times id="S2.T1.8.8.2.m1.1.1.1.cmml" xref="S2.T1.8.8.2.m1.1.1.1"></times><ci id="S2.T1.8.8.2.m1.1.1.2.cmml" xref="S2.T1.8.8.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.8.8.2.m1.1.1.3.cmml" xref="S2.T1.8.8.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.8.8.2.m1.1c">N\times S</annotation></semantics></math></td>
<td id="S2.T1.8.8.4" class="ltx_td ltx_align_left">Discarded</td>
<td id="S2.T1.8.8.5" class="ltx_td ltx_align_left">Soft-prompt input</td>
</tr>
<tr id="S2.T1.10.10" class="ltx_tr">
<td id="S2.T1.10.10.3" class="ltx_td ltx_align_left">AutoCompressors</td>
<td id="S2.T1.9.9.1" class="ltx_td ltx_align_left"><math id="S2.T1.9.9.1.m1.1" class="ltx_Math" alttext="d_{model}\times p\times(m+1)\times l" display="inline"><semantics id="S2.T1.9.9.1.m1.1a"><mrow id="S2.T1.9.9.1.m1.1.1" xref="S2.T1.9.9.1.m1.1.1.cmml"><msub id="S2.T1.9.9.1.m1.1.1.3" xref="S2.T1.9.9.1.m1.1.1.3.cmml"><mi id="S2.T1.9.9.1.m1.1.1.3.2" xref="S2.T1.9.9.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.9.9.1.m1.1.1.3.3" xref="S2.T1.9.9.1.m1.1.1.3.3.cmml"><mi id="S2.T1.9.9.1.m1.1.1.3.3.2" xref="S2.T1.9.9.1.m1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.T1.9.9.1.m1.1.1.3.3.1" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.3" xref="S2.T1.9.9.1.m1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.T1.9.9.1.m1.1.1.3.3.1a" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.4" xref="S2.T1.9.9.1.m1.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.T1.9.9.1.m1.1.1.3.3.1b" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.5" xref="S2.T1.9.9.1.m1.1.1.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.T1.9.9.1.m1.1.1.3.3.1c" xref="S2.T1.9.9.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.9.9.1.m1.1.1.3.3.6" xref="S2.T1.9.9.1.m1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.T1.9.9.1.m1.1.1.2" xref="S2.T1.9.9.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.9.9.1.m1.1.1.4" xref="S2.T1.9.9.1.m1.1.1.4.cmml">p</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.9.9.1.m1.1.1.2a" xref="S2.T1.9.9.1.m1.1.1.2.cmml">×</mo><mrow id="S2.T1.9.9.1.m1.1.1.1.1" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.T1.9.9.1.m1.1.1.1.1.2" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.9.9.1.m1.1.1.1.1.1" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml"><mi id="S2.T1.9.9.1.m1.1.1.1.1.1.2" xref="S2.T1.9.9.1.m1.1.1.1.1.1.2.cmml">m</mi><mo id="S2.T1.9.9.1.m1.1.1.1.1.1.1" xref="S2.T1.9.9.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.T1.9.9.1.m1.1.1.1.1.1.3" xref="S2.T1.9.9.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S2.T1.9.9.1.m1.1.1.1.1.3" xref="S2.T1.9.9.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.T1.9.9.1.m1.1.1.2b" xref="S2.T1.9.9.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.9.9.1.m1.1.1.5" xref="S2.T1.9.9.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.9.9.1.m1.1b"><apply id="S2.T1.9.9.1.m1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1"><times id="S2.T1.9.9.1.m1.1.1.2.cmml" xref="S2.T1.9.9.1.m1.1.1.2"></times><apply id="S2.T1.9.9.1.m1.1.1.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.9.9.1.m1.1.1.3.1.cmml" xref="S2.T1.9.9.1.m1.1.1.3">subscript</csymbol><ci id="S2.T1.9.9.1.m1.1.1.3.2.cmml" xref="S2.T1.9.9.1.m1.1.1.3.2">𝑑</ci><apply id="S2.T1.9.9.1.m1.1.1.3.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3"><times id="S2.T1.9.9.1.m1.1.1.3.3.1.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.1"></times><ci id="S2.T1.9.9.1.m1.1.1.3.3.2.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.2">𝑚</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.3.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.3">𝑜</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.4.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.4">𝑑</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.5.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.5">𝑒</ci><ci id="S2.T1.9.9.1.m1.1.1.3.3.6.cmml" xref="S2.T1.9.9.1.m1.1.1.3.3.6">𝑙</ci></apply></apply><ci id="S2.T1.9.9.1.m1.1.1.4.cmml" xref="S2.T1.9.9.1.m1.1.1.4">𝑝</ci><apply id="S2.T1.9.9.1.m1.1.1.1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1"><plus id="S2.T1.9.9.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1.1.1"></plus><ci id="S2.T1.9.9.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1.1.2">𝑚</ci><cn type="integer" id="S2.T1.9.9.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.9.9.1.m1.1.1.1.1.1.3">1</cn></apply><ci id="S2.T1.9.9.1.m1.1.1.5.cmml" xref="S2.T1.9.9.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.9.9.1.m1.1c">d_{model}\times p\times(m+1)\times l</annotation></semantics></math></td>
<td id="S2.T1.10.10.2" class="ltx_td ltx_align_left"><math id="S2.T1.10.10.2.m1.1" class="ltx_Math" alttext="N\times S" display="inline"><semantics id="S2.T1.10.10.2.m1.1a"><mrow id="S2.T1.10.10.2.m1.1.1" xref="S2.T1.10.10.2.m1.1.1.cmml"><mi id="S2.T1.10.10.2.m1.1.1.2" xref="S2.T1.10.10.2.m1.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.10.10.2.m1.1.1.1" xref="S2.T1.10.10.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.10.10.2.m1.1.1.3" xref="S2.T1.10.10.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.10.10.2.m1.1b"><apply id="S2.T1.10.10.2.m1.1.1.cmml" xref="S2.T1.10.10.2.m1.1.1"><times id="S2.T1.10.10.2.m1.1.1.1.cmml" xref="S2.T1.10.10.2.m1.1.1.1"></times><ci id="S2.T1.10.10.2.m1.1.1.2.cmml" xref="S2.T1.10.10.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.10.10.2.m1.1.1.3.cmml" xref="S2.T1.10.10.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.10.10.2.m1.1c">N\times S</annotation></semantics></math></td>
<td id="S2.T1.10.10.4" class="ltx_td ltx_align_left">Discarded</td>
<td id="S2.T1.10.10.5" class="ltx_td ltx_align_left">Soft-prompt input</td>
</tr>
<tr id="S2.T1.12.12" class="ltx_tr">
<td id="S2.T1.12.12.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">Infini-Transformers</td>
<td id="S2.T1.11.11.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><math id="S2.T1.11.11.1.m1.1" class="ltx_Math" alttext="d_{key}\times(d_{value}+1)\times H\times l" display="inline"><semantics id="S2.T1.11.11.1.m1.1a"><mrow id="S2.T1.11.11.1.m1.1.1" xref="S2.T1.11.11.1.m1.1.1.cmml"><msub id="S2.T1.11.11.1.m1.1.1.3" xref="S2.T1.11.11.1.m1.1.1.3.cmml"><mi id="S2.T1.11.11.1.m1.1.1.3.2" xref="S2.T1.11.11.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.T1.11.11.1.m1.1.1.3.3" xref="S2.T1.11.11.1.m1.1.1.3.3.cmml"><mi id="S2.T1.11.11.1.m1.1.1.3.3.2" xref="S2.T1.11.11.1.m1.1.1.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.T1.11.11.1.m1.1.1.3.3.1" xref="S2.T1.11.11.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.11.11.1.m1.1.1.3.3.3" xref="S2.T1.11.11.1.m1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.T1.11.11.1.m1.1.1.3.3.1a" xref="S2.T1.11.11.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.T1.11.11.1.m1.1.1.3.3.4" xref="S2.T1.11.11.1.m1.1.1.3.3.4.cmml">y</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.T1.11.11.1.m1.1.1.2" xref="S2.T1.11.11.1.m1.1.1.2.cmml">×</mo><mrow id="S2.T1.11.11.1.m1.1.1.1.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.T1.11.11.1.m1.1.1.1.1.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.T1.11.11.1.m1.1.1.1.1.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml"><msub id="S2.T1.11.11.1.m1.1.1.1.1.1.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1a" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1b" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1c" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6.cmml">e</mi></mrow></msub><mo id="S2.T1.11.11.1.m1.1.1.1.1.1.1" xref="S2.T1.11.11.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.T1.11.11.1.m1.1.1.1.1.1.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S2.T1.11.11.1.m1.1.1.1.1.3" xref="S2.T1.11.11.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.T1.11.11.1.m1.1.1.2a" xref="S2.T1.11.11.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.11.11.1.m1.1.1.4" xref="S2.T1.11.11.1.m1.1.1.4.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.11.11.1.m1.1.1.2b" xref="S2.T1.11.11.1.m1.1.1.2.cmml">×</mo><mi id="S2.T1.11.11.1.m1.1.1.5" xref="S2.T1.11.11.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.11.11.1.m1.1b"><apply id="S2.T1.11.11.1.m1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1"><times id="S2.T1.11.11.1.m1.1.1.2.cmml" xref="S2.T1.11.11.1.m1.1.1.2"></times><apply id="S2.T1.11.11.1.m1.1.1.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.11.11.1.m1.1.1.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.3">subscript</csymbol><ci id="S2.T1.11.11.1.m1.1.1.3.2.cmml" xref="S2.T1.11.11.1.m1.1.1.3.2">𝑑</ci><apply id="S2.T1.11.11.1.m1.1.1.3.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3"><times id="S2.T1.11.11.1.m1.1.1.3.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.1"></times><ci id="S2.T1.11.11.1.m1.1.1.3.3.2.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.2">𝑘</ci><ci id="S2.T1.11.11.1.m1.1.1.3.3.3.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.3">𝑒</ci><ci id="S2.T1.11.11.1.m1.1.1.3.3.4.cmml" xref="S2.T1.11.11.1.m1.1.1.3.3.4">𝑦</ci></apply></apply><apply id="S2.T1.11.11.1.m1.1.1.1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1"><plus id="S2.T1.11.11.1.m1.1.1.1.1.1.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.1"></plus><apply id="S2.T1.11.11.1.m1.1.1.1.1.1.2.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.11.11.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3"><times id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.1"></times><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.2">𝑣</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.3">𝑎</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.4">𝑙</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.5">𝑢</ci><ci id="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.2.3.6">𝑒</ci></apply></apply><cn type="integer" id="S2.T1.11.11.1.m1.1.1.1.1.1.3.cmml" xref="S2.T1.11.11.1.m1.1.1.1.1.1.3">1</cn></apply><ci id="S2.T1.11.11.1.m1.1.1.4.cmml" xref="S2.T1.11.11.1.m1.1.1.4">𝐻</ci><ci id="S2.T1.11.11.1.m1.1.1.5.cmml" xref="S2.T1.11.11.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.11.11.1.m1.1c">d_{key}\times(d_{value}+1)\times H\times l</annotation></semantics></math></td>
<td id="S2.T1.12.12.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><math id="S2.T1.12.12.2.m1.1" class="ltx_Math" alttext="N\times S" display="inline"><semantics id="S2.T1.12.12.2.m1.1a"><mrow id="S2.T1.12.12.2.m1.1.1" xref="S2.T1.12.12.2.m1.1.1.cmml"><mi id="S2.T1.12.12.2.m1.1.1.2" xref="S2.T1.12.12.2.m1.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.T1.12.12.2.m1.1.1.1" xref="S2.T1.12.12.2.m1.1.1.1.cmml">×</mo><mi id="S2.T1.12.12.2.m1.1.1.3" xref="S2.T1.12.12.2.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.12.12.2.m1.1b"><apply id="S2.T1.12.12.2.m1.1.1.cmml" xref="S2.T1.12.12.2.m1.1.1"><times id="S2.T1.12.12.2.m1.1.1.1.cmml" xref="S2.T1.12.12.2.m1.1.1.1"></times><ci id="S2.T1.12.12.2.m1.1.1.2.cmml" xref="S2.T1.12.12.2.m1.1.1.2">𝑁</ci><ci id="S2.T1.12.12.2.m1.1.1.3.cmml" xref="S2.T1.12.12.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.12.12.2.m1.1c">N\times S</annotation></semantics></math></td>
<td id="S2.T1.12.12.4" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">Incremental</td>
<td id="S2.T1.12.12.5" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">Linear attention</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Transformer models with segment-level memory are compared. For each model, the memory size and effective context length are defined in terms of their model parameters (<math id="S2.T1.21.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.T1.21.m1.1b"><mi id="S2.T1.21.m1.1.1" xref="S2.T1.21.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.T1.21.m1.1c"><ci id="S2.T1.21.m1.1.1.cmml" xref="S2.T1.21.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.21.m1.1d">N</annotation></semantics></math>: input segment length, <math id="S2.T1.22.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.T1.22.m2.1b"><mi id="S2.T1.22.m2.1.1" xref="S2.T1.22.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.T1.22.m2.1c"><ci id="S2.T1.22.m2.1.1.cmml" xref="S2.T1.22.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.22.m2.1d">S</annotation></semantics></math>: the number of segments, <math id="S2.T1.23.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.T1.23.m3.1b"><mi id="S2.T1.23.m3.1.1" xref="S2.T1.23.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.T1.23.m3.1c"><ci id="S2.T1.23.m3.1.1.cmml" xref="S2.T1.23.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.23.m3.1d">l</annotation></semantics></math>: the number of layers, <math id="S2.T1.24.m4.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S2.T1.24.m4.1b"><mi id="S2.T1.24.m4.1.1" xref="S2.T1.24.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.T1.24.m4.1c"><ci id="S2.T1.24.m4.1.1.cmml" xref="S2.T1.24.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.24.m4.1d">H</annotation></semantics></math>: the number of attention heads, <math id="S2.T1.25.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.T1.25.m5.1b"><mi id="S2.T1.25.m5.1.1" xref="S2.T1.25.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.T1.25.m5.1c"><ci id="S2.T1.25.m5.1.1.cmml" xref="S2.T1.25.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.25.m5.1d">c</annotation></semantics></math>: Compressive Transformer memory size, <math id="S2.T1.26.m6.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.T1.26.m6.1b"><mi id="S2.T1.26.m6.1.1" xref="S2.T1.26.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.T1.26.m6.1c"><ci id="S2.T1.26.m6.1.1.cmml" xref="S2.T1.26.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.26.m6.1d">r</annotation></semantics></math>: compression ratio, <math id="S2.T1.27.m7.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.T1.27.m7.1b"><mi id="S2.T1.27.m7.1.1" xref="S2.T1.27.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.T1.27.m7.1c"><ci id="S2.T1.27.m7.1.1.cmml" xref="S2.T1.27.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.27.m7.1d">p</annotation></semantics></math>: the number of soft-prompt summary vectors and <math id="S2.T1.28.m8.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.T1.28.m8.1b"><mi id="S2.T1.28.m8.1.1" xref="S2.T1.28.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.T1.28.m8.1c"><ci id="S2.T1.28.m8.1.1.cmml" xref="S2.T1.28.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.28.m8.1d">m</annotation></semantics></math>: summary vector accumulation steps).</figcaption>
</figure>
<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.3" class="ltx_p">Our Infini-Transformer enables an unbounded context window with a bounded memory footprint. To illustrate this, Table&nbsp;<a href="#S2.T1" title="Table 1 ‣ 2.2 Memory and Effective Context Window ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> lists the previous segment-level memory models with their context-memory footprint and effective context length defined in terms of model parameters and input segment length. Infini-Transformer has a constant memory complexity of <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="d_{key}\times d_{value}+d_{key}" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mrow id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml"><msub id="S2.SS2.p1.1.m1.1.1.2.2" xref="S2.SS2.p1.1.m1.1.1.2.2.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.2.2" xref="S2.SS2.p1.1.m1.1.1.2.2.2.cmml">d</mi><mrow id="S2.SS2.p1.1.m1.1.1.2.2.3" xref="S2.SS2.p1.1.m1.1.1.2.2.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.2.3.2" xref="S2.SS2.p1.1.m1.1.1.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.2.2.3.1" xref="S2.SS2.p1.1.m1.1.1.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p1.1.m1.1.1.2.2.3.3" xref="S2.SS2.p1.1.m1.1.1.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.2.2.3.1a" xref="S2.SS2.p1.1.m1.1.1.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p1.1.m1.1.1.2.2.3.4" xref="S2.SS2.p1.1.m1.1.1.2.2.3.4.cmml">y</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p1.1.m1.1.1.2.1" xref="S2.SS2.p1.1.m1.1.1.2.1.cmml">×</mo><msub id="S2.SS2.p1.1.m1.1.1.2.3" xref="S2.SS2.p1.1.m1.1.1.2.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.3.2" xref="S2.SS2.p1.1.m1.1.1.2.3.2.cmml">d</mi><mrow id="S2.SS2.p1.1.m1.1.1.2.3.3" xref="S2.SS2.p1.1.m1.1.1.2.3.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.2" xref="S2.SS2.p1.1.m1.1.1.2.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.2.3.3.1" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">​</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.3" xref="S2.SS2.p1.1.m1.1.1.2.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.2.3.3.1a" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">​</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.4" xref="S2.SS2.p1.1.m1.1.1.2.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.2.3.3.1b" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">​</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.5" xref="S2.SS2.p1.1.m1.1.1.2.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.2.3.3.1c" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml">​</mo><mi id="S2.SS2.p1.1.m1.1.1.2.3.3.6" xref="S2.SS2.p1.1.m1.1.1.2.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">+</mo><msub id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.3.2.cmml">d</mi><mrow id="S2.SS2.p1.1.m1.1.1.3.3" xref="S2.SS2.p1.1.m1.1.1.3.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.3.2" xref="S2.SS2.p1.1.m1.1.1.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.3.3.1" xref="S2.SS2.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p1.1.m1.1.1.3.3.3" xref="S2.SS2.p1.1.m1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.3.3.1a" xref="S2.SS2.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p1.1.m1.1.1.3.3.4" xref="S2.SS2.p1.1.m1.1.1.3.3.4.cmml">y</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><plus id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></plus><apply id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"><times id="S2.SS2.p1.1.m1.1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.1"></times><apply id="S2.SS2.p1.1.m1.1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.2.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.2">𝑑</ci><apply id="S2.SS2.p1.1.m1.1.1.2.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3"><times id="S2.SS2.p1.1.m1.1.1.2.2.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.2">𝑘</ci><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.3">𝑒</ci><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.4.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3.4">𝑦</ci></apply></apply><apply id="S2.SS2.p1.1.m1.1.1.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.2.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.2">𝑑</ci><apply id="S2.SS2.p1.1.m1.1.1.2.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3"><times id="S2.SS2.p1.1.m1.1.1.2.3.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.2">𝑣</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.3">𝑎</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.4.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.4">𝑙</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.5.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.5">𝑢</ci><ci id="S2.SS2.p1.1.m1.1.1.2.3.3.6.cmml" xref="S2.SS2.p1.1.m1.1.1.2.3.3.6">𝑒</ci></apply></apply></apply><apply id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.2">𝑑</ci><apply id="S2.SS2.p1.1.m1.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3"><times id="S2.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.2">𝑘</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.3">𝑒</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3.4.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3.4">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">d_{key}\times d_{value}+d_{key}</annotation></semantics></math> for storing compressed context in <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="M_{s}" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">M</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝑀</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">M_{s}</annotation></semantics></math> and <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="z_{s}" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><msub id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">z</mi><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝑧</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">z_{s}</annotation></semantics></math> for each head in single layer while for the other models, the complexity grows along with the sequence dimension - the memory complexity depends either on the cache size for Transformer-XL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>, Compressive Transformer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a href="#bib.bib41" title="" class="ltx_ref">2019</a>)</cite> and Memorizing Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite> or on the soft-prompt size for RTM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bulatov et&nbsp;al., <a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite> and AutoCompressors&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ge et&nbsp;al., <a href="#bib.bib18" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<figure id="S2.F3" class="ltx_figure ltx_align_floatright"><img src="/html/2404.07143/assets/x3.png" id="S2.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="169" height="160" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>There are two types of heads emerged in Infini-attention after training: specialized heads with gating score near 0 or 1 and mixer heads with score close to 0.5. The specialized heads either process contextual information via the local attention mechanism or retrieve from the compressive memory whereas the mixer heads aggregate both current contextual information and long-term memory content together into single output.
</figcaption>
</figure>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.5" class="ltx_p">Transformer-XL computes attention over KV states cached from the last segment in addition to the current states. Since this is done for each layer, Transformer-XL extends the context window from <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">N</annotation></semantics></math> to <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="N\times l" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.2.m2.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><times id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"></times><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑁</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">N\times l</annotation></semantics></math> tokens with an additional memory footprint of <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="(d_{key}+d_{value})\times H\times N\times l" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mrow id="S2.SS2.p2.3.m3.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.3.m3.1.1.1.1.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml"><msub id="S2.SS2.p2.3.m3.1.1.1.1.1.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.2.cmml">d</mi><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1a" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4.cmml">y</mi></mrow></msub><mo id="S2.SS2.p2.3.m3.1.1.1.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml">+</mo><msub id="S2.SS2.p2.3.m3.1.1.1.1.1.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.2.cmml">d</mi><mrow id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1a" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1b" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1c" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6.cmml">e</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S2.SS2.p2.3.m3.1.1.1.1.3" xref="S2.SS2.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">×</mo><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.3.m3.1.1.2a" xref="S2.SS2.p2.3.m3.1.1.2.cmml">×</mo><mi id="S2.SS2.p2.3.m3.1.1.4" xref="S2.SS2.p2.3.m3.1.1.4.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.3.m3.1.1.2b" xref="S2.SS2.p2.3.m3.1.1.2.cmml">×</mo><mi id="S2.SS2.p2.3.m3.1.1.5" xref="S2.SS2.p2.3.m3.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><times id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"></times><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1"><plus id="S2.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.1"></plus><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.2">𝑑</ci><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3"><times id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.1"></times><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.2">𝑘</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.2.3.4">𝑦</ci></apply></apply><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.2">𝑑</ci><apply id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3"><times id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.1"></times><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.4">𝑙</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.5">𝑢</ci><ci id="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6.cmml" xref="S2.SS2.p2.3.m3.1.1.1.1.1.3.3.6">𝑒</ci></apply></apply></apply><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝐻</ci><ci id="S2.SS2.p2.3.m3.1.1.4.cmml" xref="S2.SS2.p2.3.m3.1.1.4">𝑁</ci><ci id="S2.SS2.p2.3.m3.1.1.5.cmml" xref="S2.SS2.p2.3.m3.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">(d_{key}+d_{value})\times H\times N\times l</annotation></semantics></math>. Compressive Transformer adds a second cache to Transformer-XL and stores compressed representations of past segment activations. So it extends the Transformer-XL’s context window by <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="c\times r\times l" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">c</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.4.m4.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.4.m4.1.1.1a" xref="S2.SS2.p2.4.m4.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.4.m4.1.1.4" xref="S2.SS2.p2.4.m4.1.1.4.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><times id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"></times><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝑐</ci><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝑟</ci><ci id="S2.SS2.p2.4.m4.1.1.4.cmml" xref="S2.SS2.p2.4.m4.1.1.4">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">c\times r\times l</annotation></semantics></math> but still has a large context-memory complexity. Taking the idea further, Memorizing Transformers opt to store the entire KV states as context for input sequences. Since the storage becomes prohibitively expensive in this case, they restrict the contextual computation to a single layer only. By utilizing a fast kNN retriever, Memorizing Transformers then build a context window covering the entire sequence history of length <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="N\times S" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mrow id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.5.m5.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.cmml">×</mo><mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><times id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1"></times><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝑁</ci><ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">N\times S</annotation></semantics></math> at an increased cost of storage. Our experiments show that Infini-Transformer LM can achieve more than 100x compression rate on top of Memorizing Transformers while further improving the perplexity score.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.1" class="ltx_p">RMT and AutoCompressors allow for a potentially infinite context length since they compress the input into summary vectors and then pass them as extra soft-prompt inputs for the subsequent segments. However, in practice the success of those techniques highly depends on the size of soft-prompt vectors. Namely, it is necessary to increase the number of soft-prompt (summary) vectors to achieve a better performance with AutoCompressors&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chevalier et&nbsp;al., <a href="#bib.bib11" title="" class="ltx_ref">2023</a>)</cite> and with that, the memory and compute complexity grow quickly resulting in diminished efficiency. It was also observed in AutoCompressors&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chevalier et&nbsp;al., <a href="#bib.bib11" title="" class="ltx_ref">2023</a>)</cite> that an efficient compression objective is needed for training such prompt compression techniques&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ge et&nbsp;al., <a href="#bib.bib18" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">We evaluated our Infini-Transformer models on benchmarks involving extremely long input sequences: long-context language modeling, 1M length passkey context block retrieval and 500K length book summarization tasks. For the language modeling benchmark, we train our models from scratch while for the passkey and book summarization tasks, we continually pre-train existing LLMs in order to highlight a plug-and-play long-context adaptation capability of our approach.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Long-context Language Modeling</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">We trained and evaluated small Infini-Transformer models on PG19&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a href="#bib.bib41" title="" class="ltx_ref">2019</a>)</cite> and Arxiv-math&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite> benchmarks.
Our setup closely resembles that of Memorizing Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite>. Namely, all our models have 12 layers and 8 attention heads of dimension 128 each and FFNs with hidden layer 4096.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<table id="S3.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T2.1.1.1" class="ltx_tr">
<td id="S3.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_border_tt">Model</td>
<td id="S3.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Memory size (comp.)</td>
<td id="S3.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">XL cache</td>
<td id="S3.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">Segment length</td>
<td id="S3.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">PG19</td>
<td id="S3.T2.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">Arxiv-math</td>
</tr>
<tr id="S3.T2.1.2.2" class="ltx_tr">
<td id="S3.T2.1.2.2.1" class="ltx_td ltx_align_left ltx_border_t">Transformer-XL</td>
<td id="S3.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">50M (3.7x)</td>
<td id="S3.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">2048</td>
<td id="S3.T2.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">2048</td>
<td id="S3.T2.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">11.88</td>
<td id="S3.T2.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">2.42</td>
</tr>
<tr id="S3.T2.1.3.3" class="ltx_tr">
<td id="S3.T2.1.3.3.1" class="ltx_td ltx_align_left">Memorizing Transformers</td>
<td id="S3.T2.1.3.3.2" class="ltx_td ltx_align_center">183M (1x)</td>
<td id="S3.T2.1.3.3.3" class="ltx_td ltx_align_center">2048</td>
<td id="S3.T2.1.3.3.4" class="ltx_td ltx_align_center">2048</td>
<td id="S3.T2.1.3.3.5" class="ltx_td ltx_align_center">11.37</td>
<td id="S3.T2.1.3.3.6" class="ltx_td ltx_align_center">2.26</td>
</tr>
<tr id="S3.T2.1.4.4" class="ltx_tr">
<td id="S3.T2.1.4.4.1" class="ltx_td ltx_align_left">RMT</td>
<td id="S3.T2.1.4.4.2" class="ltx_td ltx_align_center">2.5M (73x)</td>
<td id="S3.T2.1.4.4.3" class="ltx_td ltx_align_center">None</td>
<td id="S3.T2.1.4.4.4" class="ltx_td ltx_align_center">2048</td>
<td id="S3.T2.1.4.4.5" class="ltx_td ltx_align_center">13.27</td>
<td id="S3.T2.1.4.4.6" class="ltx_td ltx_align_center">2.55</td>
</tr>
<tr id="S3.T2.1.5.5" class="ltx_tr">
<td id="S3.T2.1.5.5.1" class="ltx_td ltx_align_left ltx_border_t">Infini-Transformer (Linear)</td>
<td id="S3.T2.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">1.6M (114x)</td>
<td id="S3.T2.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t">None</td>
<td id="S3.T2.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t">2048</td>
<td id="S3.T2.1.5.5.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.1.5.5.5.1" class="ltx_text ltx_font_bold">9.65</span></td>
<td id="S3.T2.1.5.5.6" class="ltx_td ltx_align_center ltx_border_t">2.24</td>
</tr>
<tr id="S3.T2.1.6.6" class="ltx_tr">
<td id="S3.T2.1.6.6.1" class="ltx_td ltx_align_left ltx_border_bb">Infini-Transformer (Linear + Delta)</td>
<td id="S3.T2.1.6.6.2" class="ltx_td ltx_align_center ltx_border_bb">1.6M (114x)</td>
<td id="S3.T2.1.6.6.3" class="ltx_td ltx_align_center ltx_border_bb">None</td>
<td id="S3.T2.1.6.6.4" class="ltx_td ltx_align_center ltx_border_bb">2048</td>
<td id="S3.T2.1.6.6.5" class="ltx_td ltx_align_center ltx_border_bb">9.67</td>
<td id="S3.T2.1.6.6.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.1.6.6.6.1" class="ltx_text ltx_font_bold">2.23</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Long-context language modeling results are compared in terms of average token-level perplexity. Comp. denotes compression ratio. Infini-Transformer outperforms memorizing transformers with memory length of 65K and achieves 114x compression ratio.</figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.1" class="ltx_p">We set the Infini-attention segment length <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">N</annotation></semantics></math> to 2048 for all attention layers and the input sequence length to 32768 for training. This allows the Infini-attention to unroll over 16 steps w.r.t its compressive memory states. For the RMT baseline, we performed several runs with summary prompt lengths 50, 100 and 150 and sequence lengths 4096, 8196 and 32768. RMT with 100 summary vectors gave the best result when trained on 8196 length sequences.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.1" class="ltx_p">The main results from the language modeling experiments are summarized in Table&nbsp;<a href="#S3.T2" title="Table 2 ‣ 3.1 Long-context Language Modeling ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Our Infini-Transformer outperforms both Transformer-XL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite> and Memorizing Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite> baselines while maintaining 114x less memory parameters than the Memorizing Transformer model with a vector retrieval-based KV memory with length of 65K at its <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="9^{th}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msup id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mn id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">9</mn><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">superscript</csymbol><cn type="integer" id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">9</cn><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><times id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">𝑡</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">9^{th}</annotation></semantics></math> layer.</p>
</div>
<figure id="S3.T3" class="ltx_table">
<table id="S3.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T3.1.1.1" class="ltx_tr">
<th id="S3.T3.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S3.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">Zero-shot</td>
</tr>
<tr id="S3.T3.1.2.2" class="ltx_tr">
<th id="S3.T3.1.2.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S3.T3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">32K</td>
<td id="S3.T3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">128K</td>
<td id="S3.T3.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">256K</td>
<td id="S3.T3.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">512K</td>
<td id="S3.T3.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">1M</td>
</tr>
<tr id="S3.T3.1.3.3" class="ltx_tr">
<th id="S3.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Infini-Transformer (Linear)</th>
<td id="S3.T3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">14/13/98</td>
<td id="S3.T3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">11/14/100</td>
<td id="S3.T3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">6/3/100</td>
<td id="S3.T3.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">6/7/99</td>
<td id="S3.T3.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">8/6/98</td>
</tr>
<tr id="S3.T3.1.4.4" class="ltx_tr">
<th id="S3.T3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Infini-Transformer (Linear + Delta)</th>
<td id="S3.T3.1.4.4.2" class="ltx_td ltx_align_center">13/11/99</td>
<td id="S3.T3.1.4.4.3" class="ltx_td ltx_align_center">6/9/99</td>
<td id="S3.T3.1.4.4.4" class="ltx_td ltx_align_center">7/5/99</td>
<td id="S3.T3.1.4.4.5" class="ltx_td ltx_align_center">6/8/97</td>
<td id="S3.T3.1.4.4.6" class="ltx_td ltx_align_center">7/6/97</td>
</tr>
<tr id="S3.T3.1.5.5" class="ltx_tr">
<th id="S3.T3.1.5.5.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S3.T3.1.5.5.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="5">FT (400 steps)</td>
</tr>
<tr id="S3.T3.1.6.6" class="ltx_tr">
<th id="S3.T3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Infini-Transformer (Linear)</th>
<td id="S3.T3.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">100/100/100</td>
<td id="S3.T3.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t">100/100/100</td>
<td id="S3.T3.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t">100/100/100</td>
<td id="S3.T3.1.6.6.5" class="ltx_td ltx_align_center ltx_border_t">97/99/100</td>
<td id="S3.T3.1.6.6.6" class="ltx_td ltx_align_center ltx_border_t">96/94/100</td>
</tr>
<tr id="S3.T3.1.7.7" class="ltx_tr">
<th id="S3.T3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Infini-Transformer (Linear + Delta)</th>
<td id="S3.T3.1.7.7.2" class="ltx_td ltx_align_center ltx_border_bb">100/100/100</td>
<td id="S3.T3.1.7.7.3" class="ltx_td ltx_align_center ltx_border_bb">100/100/99</td>
<td id="S3.T3.1.7.7.4" class="ltx_td ltx_align_center ltx_border_bb">100/100/99</td>
<td id="S3.T3.1.7.7.5" class="ltx_td ltx_align_center ltx_border_bb">100/100/100</td>
<td id="S3.T3.1.7.7.6" class="ltx_td ltx_align_center ltx_border_bb">100/100/100</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Infini-Transformers solved the passkey task with up to 1M context length when fine-tuned on 5K length inputs. We report token-level retrieval accuracy for passkeys hidden in a different part (<span id="S3.T3.3.1" class="ltx_text ltx_font_italic">start/middle/end</span>) of long inputs with lengths 32K to 1M.</figcaption>
</figure>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.2" class="ltx_p"><span id="S3.SS1.p4.2.1" class="ltx_text ltx_font_bold">100K length training.</span>
We further increased the training sequence length to 100K from 32K and trained the models on Arxiv-math dataset. 100K training further decreased the perplexity score to <span id="S3.SS1.p4.2.2" class="ltx_text ltx_font_bold">2.21</span> and <span id="S3.SS1.p4.2.3" class="ltx_text ltx_font_bold">2.20</span> for <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="Linear" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.1a" xref="S3.SS1.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS1.p4.1.m1.1.1.4" xref="S3.SS1.p4.1.m1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.1b" xref="S3.SS1.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS1.p4.1.m1.1.1.5" xref="S3.SS1.p4.1.m1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.1c" xref="S3.SS1.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS1.p4.1.m1.1.1.6" xref="S3.SS1.p4.1.m1.1.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.1d" xref="S3.SS1.p4.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS1.p4.1.m1.1.1.7" xref="S3.SS1.p4.1.m1.1.1.7.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><times id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"></times><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝐿</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝑖</ci><ci id="S3.SS1.p4.1.m1.1.1.4.cmml" xref="S3.SS1.p4.1.m1.1.1.4">𝑛</ci><ci id="S3.SS1.p4.1.m1.1.1.5.cmml" xref="S3.SS1.p4.1.m1.1.1.5">𝑒</ci><ci id="S3.SS1.p4.1.m1.1.1.6.cmml" xref="S3.SS1.p4.1.m1.1.1.6">𝑎</ci><ci id="S3.SS1.p4.1.m1.1.1.7.cmml" xref="S3.SS1.p4.1.m1.1.1.7">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">Linear</annotation></semantics></math> and <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="Linear+Delta" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mrow id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2.2" xref="S3.SS1.p4.2.m2.1.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.2.m2.1.1.2.1" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p4.2.m2.1.1.2.3" xref="S3.SS1.p4.2.m2.1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.2.m2.1.1.2.1a" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p4.2.m2.1.1.2.4" xref="S3.SS1.p4.2.m2.1.1.2.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.2.m2.1.1.2.1b" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p4.2.m2.1.1.2.5" xref="S3.SS1.p4.2.m2.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.2.m2.1.1.2.1c" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p4.2.m2.1.1.2.6" xref="S3.SS1.p4.2.m2.1.1.2.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.2.m2.1.1.2.1d" xref="S3.SS1.p4.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p4.2.m2.1.1.2.7" xref="S3.SS1.p4.2.m2.1.1.2.7.cmml">r</mi></mrow><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">+</mo><mrow id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml"><mi id="S3.SS1.p4.2.m2.1.1.3.2" xref="S3.SS1.p4.2.m2.1.1.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.2.m2.1.1.3.1" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.2.m2.1.1.3.3" xref="S3.SS1.p4.2.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.2.m2.1.1.3.1a" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.2.m2.1.1.3.4" xref="S3.SS1.p4.2.m2.1.1.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.2.m2.1.1.3.1b" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.2.m2.1.1.3.5" xref="S3.SS1.p4.2.m2.1.1.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.2.m2.1.1.3.1c" xref="S3.SS1.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.2.m2.1.1.3.6" xref="S3.SS1.p4.2.m2.1.1.3.6.cmml">a</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><plus id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></plus><apply id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2"><times id="S3.SS1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.2.1"></times><ci id="S3.SS1.p4.2.m2.1.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2.2">𝐿</ci><ci id="S3.SS1.p4.2.m2.1.1.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3">𝑖</ci><ci id="S3.SS1.p4.2.m2.1.1.2.4.cmml" xref="S3.SS1.p4.2.m2.1.1.2.4">𝑛</ci><ci id="S3.SS1.p4.2.m2.1.1.2.5.cmml" xref="S3.SS1.p4.2.m2.1.1.2.5">𝑒</ci><ci id="S3.SS1.p4.2.m2.1.1.2.6.cmml" xref="S3.SS1.p4.2.m2.1.1.2.6">𝑎</ci><ci id="S3.SS1.p4.2.m2.1.1.2.7.cmml" xref="S3.SS1.p4.2.m2.1.1.2.7">𝑟</ci></apply><apply id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3"><times id="S3.SS1.p4.2.m2.1.1.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3.1"></times><ci id="S3.SS1.p4.2.m2.1.1.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2">𝐷</ci><ci id="S3.SS1.p4.2.m2.1.1.3.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3">𝑒</ci><ci id="S3.SS1.p4.2.m2.1.1.3.4.cmml" xref="S3.SS1.p4.2.m2.1.1.3.4">𝑙</ci><ci id="S3.SS1.p4.2.m2.1.1.3.5.cmml" xref="S3.SS1.p4.2.m2.1.1.3.5">𝑡</ci><ci id="S3.SS1.p4.2.m2.1.1.3.6.cmml" xref="S3.SS1.p4.2.m2.1.1.3.6">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">Linear+Delta</annotation></semantics></math> models.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.p5.1" class="ltx_p"><span id="S3.SS1.p5.1.1" class="ltx_text ltx_font_bold">Gating score visualization.</span> Figure&nbsp;<a href="#S2.F3" title="Figure 3 ‣ 2.2 Memory and Effective Context Window ‣ 2 Method ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> visualizes the gating score, <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="\textit{sigmoid}(\beta)" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><mrow id="S3.SS1.p5.1.m1.1.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mtext class="ltx_mathvariant_italic" id="S3.SS1.p5.1.m1.1.2.2" xref="S3.SS1.p5.1.m1.1.2.2a.cmml">sigmoid</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.p5.1.m1.1.2.1" xref="S3.SS1.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS1.p5.1.m1.1.2.3.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.1.m1.1.2.3.2.1" xref="S3.SS1.p5.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">β</mi><mo stretchy="false" id="S3.SS1.p5.1.m1.1.2.3.2.2" xref="S3.SS1.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.2"><times id="S3.SS1.p5.1.m1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.2.1"></times><ci id="S3.SS1.p5.1.m1.1.2.2a.cmml" xref="S3.SS1.p5.1.m1.1.2.2"><mtext class="ltx_mathvariant_italic" id="S3.SS1.p5.1.m1.1.2.2.cmml" xref="S3.SS1.p5.1.m1.1.2.2">sigmoid</mtext></ci><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\textit{sigmoid}(\beta)</annotation></semantics></math> for the compressive memory for all attention heads in each layer. There are two types of heads emerged in Infini-attention after training: specialized heads with a gating score near 0 or 1 and mixer heads with a score close to 0.5. The specialized heads either process contextual information via the local attention computation or retrieve from the compressive memory whereas the mixer heads aggregate both current contextual information and long-term memory content together into a single output. Interestingly, each layer has at least a single short-range head, allowing a forward-propagation of input signal up until the output layer. We also observed an interleaving of long and short-term content retrievals throughout the forward computation.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>LLM Continual Pre-training</h3>

<figure id="S3.T4" class="ltx_table">
<table id="S3.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T4.1.1.1" class="ltx_tr">
<th id="S3.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">Model</th>
<td id="S3.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Rouge-1</td>
<td id="S3.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">Rouge-2</td>
<td id="S3.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">Rouge-L</td>
<td id="S3.T4.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">Overall</td>
</tr>
<tr id="S3.T4.1.2.2" class="ltx_tr">
<th id="S3.T4.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">BART</th>
<td id="S3.T4.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">36.4</td>
<td id="S3.T4.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">7.6</td>
<td id="S3.T4.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">15.3</td>
<td id="S3.T4.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">16.2</td>
</tr>
<tr id="S3.T4.1.3.3" class="ltx_tr">
<th id="S3.T4.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">BART + Unlimiformer</th>
<td id="S3.T4.1.3.3.2" class="ltx_td ltx_align_center">36.8</td>
<td id="S3.T4.1.3.3.3" class="ltx_td ltx_align_center">8.3</td>
<td id="S3.T4.1.3.3.4" class="ltx_td ltx_align_center">15.7</td>
<td id="S3.T4.1.3.3.5" class="ltx_td ltx_align_center">16.9</td>
</tr>
<tr id="S3.T4.1.4.4" class="ltx_tr">
<th id="S3.T4.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PRIMERA</th>
<td id="S3.T4.1.4.4.2" class="ltx_td ltx_align_center">38.6</td>
<td id="S3.T4.1.4.4.3" class="ltx_td ltx_align_center">7.2</td>
<td id="S3.T4.1.4.4.4" class="ltx_td ltx_align_center">15.6</td>
<td id="S3.T4.1.4.4.5" class="ltx_td ltx_align_center">16.3</td>
</tr>
<tr id="S3.T4.1.5.5" class="ltx_tr">
<th id="S3.T4.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PRIMERA + Unlimiformer</th>
<td id="S3.T4.1.5.5.2" class="ltx_td ltx_align_center">37.9</td>
<td id="S3.T4.1.5.5.3" class="ltx_td ltx_align_center">8.2</td>
<td id="S3.T4.1.5.5.4" class="ltx_td ltx_align_center">16.3</td>
<td id="S3.T4.1.5.5.5" class="ltx_td ltx_align_center">17.2</td>
</tr>
<tr id="S3.T4.1.6.6" class="ltx_tr">
<th id="S3.T4.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Infini-Transformers (Linear)</th>
<td id="S3.T4.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">37.9</td>
<td id="S3.T4.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t">8.7</td>
<td id="S3.T4.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t">17.6</td>
<td id="S3.T4.1.6.6.5" class="ltx_td ltx_align_center ltx_border_t">18.0</td>
</tr>
<tr id="S3.T4.1.7.7" class="ltx_tr">
<th id="S3.T4.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Infini-Transformers (Linear + Delta)</th>
<td id="S3.T4.1.7.7.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.1.7.7.2.1" class="ltx_text ltx_font_bold">40.0</span></td>
<td id="S3.T4.1.7.7.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.1.7.7.3.1" class="ltx_text ltx_font_bold">8.8</span></td>
<td id="S3.T4.1.7.7.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.1.7.7.4.1" class="ltx_text ltx_font_bold">17.9</span></td>
<td id="S3.T4.1.7.7.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T4.1.7.7.5.1" class="ltx_text ltx_font_bold">18.5</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>500K length book summarization (BookSum) results. The BART, PRIMERA and Unlimiformer results are from <cite class="ltx_cite ltx_citemacro_citet">Bertsch et&nbsp;al. (<a href="#bib.bib5" title="" class="ltx_ref">2024</a>)</cite>.</figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">We performed a lightweight continual pre-training for long-context adaptation of existing LLMs. The pre-training data includes the PG19 and Arxiv-math corpus as well as C4 text&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Raffel et&nbsp;al., <a href="#bib.bib42" title="" class="ltx_ref">2020</a>)</cite> with length more than 4K tokens. The segment length <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">N</annotation></semantics></math> was set to 2K throughout our experiments.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">1M passkey retrieval benchmark.</span> We replaced the vanilla MHA in a 1B LLM with Infini-attention and continued to pre-train on inputs with length of 4K. The model was trained for 30K steps with batch size of 64 before fine-tuning on the passkey retrieval task&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mohtashami &amp; Jaggi, <a href="#bib.bib32" title="" class="ltx_ref">2024</a>)</cite>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p">The passkey task hides a random number into a long text and asks it back at the model output. The length of the distraction text is varied by repeating a text chunk multiple times. The previous work&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a href="#bib.bib8" title="" class="ltx_ref">2023a</a>)</cite> showed that a 8B LLaMA model can solve the task up to 32K length when fine-tuned with the same 32K length inputs with Position Interpolation. We take this challenge further and fine-tune on only 5K length inputs to test on 1M length regime.</p>
</div>
<figure id="S3.F4" class="ltx_figure ltx_align_floatright"><img src="/html/2404.07143/assets/x4.png" id="S3.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="190" height="123" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Infini-Transformers obtain better Rouge overall scores with more book text provided as input.</figcaption>
</figure>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.1" class="ltx_p">Table&nbsp;<a href="#S3.T3" title="Table 3 ‣ 3.1 Long-context Language Modeling ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> reports the token-level accuracy for test subsets with input lengths ranging from 32K to 1M. For each test subset, we controlled the position of the passkey so that it is either located around the beginning, middle or the end of the input sequence.
We reported both zero-shot accuracy and fine-tuning accuracy. Infini-Transformers solved the task with up to 1M context length after fine-tuning on 5K length inputs for 400 steps.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para ltx_noindent">
<p id="S3.SS2.p5.1" class="ltx_p"><span id="S3.SS2.p5.1.1" class="ltx_text ltx_font_bold">500K length book summarization (BookSum).</span> We further scaled our approach by continuously pre-training a 8B LLM model with 8K input length for 30K steps. We then fine-tuned on a book summarization task, BookSum&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kryściński et&nbsp;al., <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite> where the goal is to generate a summary of an entire book text.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para ltx_noindent">
<p id="S3.SS2.p6.1" class="ltx_p">We set the input length to 32K for fine-tuning and increase to 500K for evaluating. We use a generation temperature of 0.5 and <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="top_{p}=0.95" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mrow id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mrow id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2.2" xref="S3.SS2.p6.1.m1.1.1.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p6.1.m1.1.1.2.1" xref="S3.SS2.p6.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p6.1.m1.1.1.2.3" xref="S3.SS2.p6.1.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p6.1.m1.1.1.2.1a" xref="S3.SS2.p6.1.m1.1.1.2.1.cmml">​</mo><msub id="S3.SS2.p6.1.m1.1.1.2.4" xref="S3.SS2.p6.1.m1.1.1.2.4.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2.4.2" xref="S3.SS2.p6.1.m1.1.1.2.4.2.cmml">p</mi><mi id="S3.SS2.p6.1.m1.1.1.2.4.3" xref="S3.SS2.p6.1.m1.1.1.2.4.3.cmml">p</mi></msub></mrow><mo id="S3.SS2.p6.1.m1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><eq id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1"></eq><apply id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2"><times id="S3.SS2.p6.1.m1.1.1.2.1.cmml" xref="S3.SS2.p6.1.m1.1.1.2.1"></times><ci id="S3.SS2.p6.1.m1.1.1.2.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2.2">𝑡</ci><ci id="S3.SS2.p6.1.m1.1.1.2.3.cmml" xref="S3.SS2.p6.1.m1.1.1.2.3">𝑜</ci><apply id="S3.SS2.p6.1.m1.1.1.2.4.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.1.1.2.4.1.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4">subscript</csymbol><ci id="S3.SS2.p6.1.m1.1.1.2.4.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4.2">𝑝</ci><ci id="S3.SS2.p6.1.m1.1.1.2.4.3.cmml" xref="S3.SS2.p6.1.m1.1.1.2.4.3">𝑝</ci></apply></apply><cn type="float" id="S3.SS2.p6.1.m1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">top_{p}=0.95</annotation></semantics></math> and set the number of decoding steps to 1024 to generate a summary of each book.</p>
</div>
<div id="S3.SS2.p7" class="ltx_para ltx_noindent">
<p id="S3.SS2.p7.1" class="ltx_p">Table&nbsp;<a href="#S3.T4" title="Table 4 ‣ 3.2 LLM Continual Pre-training ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> compares our model against the encoder-decoder models that were built particularly for the summarization task&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lewis et&nbsp;al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>; Xiao et&nbsp;al., <a href="#bib.bib57" title="" class="ltx_ref">2021</a>)</cite> and their retrieval-based long-context extension&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bertsch et&nbsp;al., <a href="#bib.bib5" title="" class="ltx_ref">2024</a>)</cite>. Our model outperforms the previous best results and achieves a new SOTA on BookSum by processing the entire text from book. We have also plotted the overall Rouge score on validation split of BookSum data in Figure&nbsp;<a href="#S3.F4" title="Figure 4 ‣ 3.2 LLM Continual Pre-training ‣ 3 Experiments ‣ Leave No Context Behind: Efficient Infinite Context Transformers with Infini-attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. There is a clear trend showing that with more text provided as input from books, Our Infini-Transformers improves its summarization performance metric.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text ltx_font_bold">Compressive memory.</span> Inspired by the plasticity in biological neurons&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai &amp; Yu, <a href="#bib.bib34" title="" class="ltx_ref">2017a</a>; Miconi et&nbsp;al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite>, compressive memory approaches cast parameterized functions as memory to store and retrieve information&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hinton &amp; Plaut, <a href="#bib.bib22" title="" class="ltx_ref">1987</a>; Schmidhuber, <a href="#bib.bib47" title="" class="ltx_ref">1992</a>; Ba et&nbsp;al., <a href="#bib.bib2" title="" class="ltx_ref">2016</a>; Munkhdalai et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite>. Unlike the Transformer KV memory array&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a href="#bib.bib54" title="" class="ltx_ref">2017</a>; Wu et&nbsp;al., <a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite>, which grows with input sequence length, compressive memory systems maintain a constant number of memory parameters for computational efficiency. The parameters are modified with an update rule to store information, which is then retrieved via a memory reading mechanism&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Graves et&nbsp;al., <a href="#bib.bib19" title="" class="ltx_ref">2014</a>; Sukhbaatar et&nbsp;al., <a href="#bib.bib51" title="" class="ltx_ref">2015</a>; Munkhdalai &amp; Yu, <a href="#bib.bib35" title="" class="ltx_ref">2017b</a>)</cite>.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.1" class="ltx_p">Compressed input representations can be viewed as a summary of past sequence segments&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a href="#bib.bib41" title="" class="ltx_ref">2019</a>; Chevalier et&nbsp;al., <a href="#bib.bib11" title="" class="ltx_ref">2023</a>)</cite>. Along this direction, more recent works have been utilizing a Transformer LLM itself to compress input sequence for efficient long-context modeling&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bulatov et&nbsp;al., <a href="#bib.bib7" title="" class="ltx_ref">2022</a>; Chevalier et&nbsp;al., <a href="#bib.bib11" title="" class="ltx_ref">2023</a>; Ge et&nbsp;al., <a href="#bib.bib18" title="" class="ltx_ref">2023</a>; Mu et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2024</a>)</cite>. However, the previous segment-level compression methods, including Compressive Transformers&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a href="#bib.bib41" title="" class="ltx_ref">2019</a>)</cite> still discard the memory entries of old segments in order to free up space for the new ones, limiting their context window to the most recent segments. This is in contrast to our Infini-attention that computes incremental memory updates to a fixed amount of memory parameters in a recurrent fashion.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.1" class="ltx_p"><span id="S4.p3.1.1" class="ltx_text ltx_font_bold">Long-context continual pre-training.</span> There is a line of work that extends the do-product attention layers and continues to train LLMs for long-context&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiong et&nbsp;al., <a href="#bib.bib58" title="" class="ltx_ref">2023</a>; Fu et&nbsp;al., <a href="#bib.bib17" title="" class="ltx_ref">2024</a>)</cite>. The attention extensions include incorporating sparsity into the attention layer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a href="#bib.bib9" title="" class="ltx_ref">2023b</a>; Ratner et&nbsp;al., <a href="#bib.bib43" title="" class="ltx_ref">2022</a>; Mohtashami &amp; Jaggi, <a href="#bib.bib32" title="" class="ltx_ref">2024</a>)</cite> as well as manipulating the position encodings&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a href="#bib.bib8" title="" class="ltx_ref">2023a</a>; Peng et&nbsp;al., <a href="#bib.bib38" title="" class="ltx_ref">2023</a>)</cite> Although the position encoding-based methods such as position interpolation techniques&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a href="#bib.bib8" title="" class="ltx_ref">2023a</a>)</cite> can be data efficient as they only adjust the positional bias in the attention layer, they are still costly for inference.</p>
</div>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.1" class="ltx_p">The attention mechanism is also prone to the issues of attention sink&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a href="#bib.bib56" title="" class="ltx_ref">2023</a>)</cite> and lost-in-the-middle&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a href="#bib.bib30" title="" class="ltx_ref">2024</a>)</cite>. Consequently, they struggle in a regime where context length is longer than what was observed during training&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Press et&nbsp;al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>; Kazemnejad et&nbsp;al., <a href="#bib.bib26" title="" class="ltx_ref">2024</a>)</cite>. The proposed Infini-attention addresses those issues by enabling a segment-level streaming computation over long sequences with a fixed local attention window. Our Infini-Transformers successfully extrapolate to 1M input length regimes when trained on 32K and even 5K length sequences.</p>
</div>
<div id="S4.p5" class="ltx_para ltx_noindent">
<p id="S4.p5.1" class="ltx_p"><span id="S4.p5.1.1" class="ltx_text ltx_font_bold">Efficient attention.</span> The efficient attention techniques attempt to improve the efficiency of the dot-product attention with an approximation or a system-level optimization. Multiple directions have been explored for different forms of efficient attention approximation, including sparsity-based&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Child et&nbsp;al., <a href="#bib.bib12" title="" class="ltx_ref">2019</a>; Beltagy et&nbsp;al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>; Sukhbaatar et&nbsp;al., <a href="#bib.bib52" title="" class="ltx_ref">2021</a>; Ding et&nbsp;al., <a href="#bib.bib16" title="" class="ltx_ref">2023</a>)</cite> and linear attention approximation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shen et&nbsp;al., <a href="#bib.bib49" title="" class="ltx_ref">2018</a>; Katharopoulos et&nbsp;al., <a href="#bib.bib25" title="" class="ltx_ref">2020</a>; Schlag et&nbsp;al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>.
Among those, the linear attention variants are closely related to the associative memory matrix&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Schlag et&nbsp;al., <a href="#bib.bib45" title="" class="ltx_ref">2020</a>; <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite> and the metalearned neural memory&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Munkhdalai et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite>, where KV bindings&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Smolensky, <a href="#bib.bib50" title="" class="ltx_ref">1990</a>)</cite> are stored in Fast-Weights&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hinton &amp; Plaut, <a href="#bib.bib22" title="" class="ltx_ref">1987</a>; Schmidhuber, <a href="#bib.bib47" title="" class="ltx_ref">1992</a>; Ba et&nbsp;al., <a href="#bib.bib2" title="" class="ltx_ref">2016</a>)</cite> that are modified in with respect to new contextual information.
More recently, system-level optimization techniques have been proposed by leveraging specific hardware architecture to make the exact attention computation more efficient&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dao et&nbsp;al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>; Liu et&nbsp;al., <a href="#bib.bib29" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">An effective memory system is crucial not just for comprehending long contexts with LLMs, but also for reasoning, planning, continual adaptation for fresh knowledge, and even for learning how to learn. This work introduces a close integration of compressive memory module into the vanilla dot-product attention layer. This subtle but critical modification to the attention layer enables LLMs to process infinitely long contexts with bounded memory and computation resources. We show that our approach can naturally scale to a million length regime of input sequences, while outperforming the baselines on long-context language modeling benchmark and book summarization tasks. We also demonstrate a promising length generalization capability of our approach. 1B model that was fine-tuned on up to 5K sequence length passkey instances solved the 1M length problem.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anil et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Rohan Anil, Andrew&nbsp;M Dai, Orhan Firat, Melvin Johnson, Dmitry Lepikhin,
Alexandre Passos, Siamak Shakeri, Emanuel Taropa, Paige Bailey, Zhifeng Chen,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Palm 2 technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.10403</em>, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ba et&nbsp;al. (2016)</span>
<span class="ltx_bibblock">
Jimmy Ba, Geoffrey&nbsp;E Hinton, Volodymyr Mnih, Joel&nbsp;Z Leibo, and Catalin Ionescu.

</span>
<span class="ltx_bibblock">Using fast weights to attend to the recent past.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 29, 2016.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahdanau et&nbsp;al. (2014)</span>
<span class="ltx_bibblock">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and
translate.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1409.0473</em>, 2014.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beltagy et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Iz&nbsp;Beltagy, Matthew&nbsp;E Peters, and Arman Cohan.

</span>
<span class="ltx_bibblock">Longformer: The long-document transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2004.05150</em>, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertsch et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Amanda Bertsch, Uri Alon, Graham Neubig, and Matthew Gormley.

</span>
<span class="ltx_bibblock">Unlimiformer: Long-range transformers with unlimited length input.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared&nbsp;D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
33:1877–1901, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bulatov et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Aydar Bulatov, Yury Kuratov, and Mikhail Burtsev.

</span>
<span class="ltx_bibblock">Recurrent memory transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
35:11079–11091, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
Shouyuan Chen, Sherman Wong, Liangjian Chen, and Yuandong Tian.

</span>
<span class="ltx_bibblock">Extending context window of large language models via positional
interpolation.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.15595</em>, 2023a.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
Yukang Chen, Shengju Qian, Haotian Tang, Xin Lai, Zhijian Liu, Song Han, and
Jiaya Jia.

</span>
<span class="ltx_bibblock">Longlora: Efficient fine-tuning of long-context large language
models.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.12307</em>, 2023b.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et&nbsp;al. (2016)</span>
<span class="ltx_bibblock">
Jianpeng Cheng, Li&nbsp;Dong, and Mirella Lapata.

</span>
<span class="ltx_bibblock">Long short-term memory-networks for machine reading.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1601.06733</em>, 2016.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chevalier et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Alexis Chevalier, Alexander Wettig, Anirudh Ajith, and Danqi Chen.

</span>
<span class="ltx_bibblock">Adapting language models to compress contexts.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.14788</em>, 2023.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Child et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Rewon Child, Scott Gray, Alec Radford, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Generating long sequences with sparse transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1904.10509</em>, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clevert et&nbsp;al. (2015)</span>
<span class="ltx_bibblock">
Djork-Arné Clevert, Thomas Unterthiner, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Fast and accurate deep network learning by exponential linear units
(elus).

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1511.07289</em>, 2015.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Zihang Dai, Zhilin Yang, Yiming Yang, Jaime Carbonell, Quoc&nbsp;V Le, and Ruslan
Salakhutdinov.

</span>
<span class="ltx_bibblock">Transformer-xl: Attentive language models beyond a fixed-length
context.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1901.02860</em>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with
io-awareness.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
35:16344–16359, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Jiayu Ding, Shuming Ma, Li&nbsp;Dong, Xingxing Zhang, Shaohan Huang, Wenhui Wang,
Nanning Zheng, and Furu Wei.

</span>
<span class="ltx_bibblock">Longnet: Scaling transformers to 1,000,000,000 tokens.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.02486</em>, 2023.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Yao Fu, Rameswar Panda, Xinyao Niu, Xiang Yue, Hannaneh Hajishirzi, Yoon Kim,
and Hao Peng.

</span>
<span class="ltx_bibblock">Data engineering for scaling language models to 128k context.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.10171</em>, 2024.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Tao Ge, Jing Hu, Xun Wang, Si-Qing Chen, and Furu Wei.

</span>
<span class="ltx_bibblock">In-context autoencoder for context compression in a large language
model.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.06945</em>, 2023.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graves et&nbsp;al. (2014)</span>
<span class="ltx_bibblock">
Alex Graves, Greg Wayne, and Ivo Danihelka.

</span>
<span class="ltx_bibblock">Neural turing machines.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1410.5401</em>, 2014.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Groeneveld et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Dirk Groeneveld, Iz&nbsp;Beltagy, Pete Walsh, Akshita Bhagia, Rodney Kinney, Oyvind
Tafjord, Ananya&nbsp;Harsh Jha, Hamish Ivison, Ian Magnusson, Yizhong Wang, et&nbsp;al.

</span>
<span class="ltx_bibblock">Olmo: Accelerating the science of language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.00838</em>, 2024.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hebb (2005)</span>
<span class="ltx_bibblock">
Donald&nbsp;Olding Hebb.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">The organization of behavior: A neuropsychological theory</em>.

</span>
<span class="ltx_bibblock">Psychology press, 2005.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton &amp; Plaut (1987)</span>
<span class="ltx_bibblock">
Geoffrey&nbsp;E Hinton and David&nbsp;C Plaut.

</span>
<span class="ltx_bibblock">Using fast weights to deblur old memories.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the ninth annual conference of the Cognitive
Science Society</em>, pp.&nbsp; 177–186, 1987.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hopfield (1982)</span>
<span class="ltx_bibblock">
John&nbsp;J Hopfield.

</span>
<span class="ltx_bibblock">Neural networks and physical systems with emergent collective
computational abilities.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the national academy of sciences</em>, 79(8):2554–2558, 1982.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kanerva (1988)</span>
<span class="ltx_bibblock">
Pentti Kanerva.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Sparse distributed memory</em>.

</span>
<span class="ltx_bibblock">MIT press, 1988.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katharopoulos et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and François
Fleuret.

</span>
<span class="ltx_bibblock">Transformers are rnns: Fast autoregressive transformers with linear
attention.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp.&nbsp;5156–5165. PMLR, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kazemnejad et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Amirhossein Kazemnejad, Inkit Padhi, Karthikeyan Natesan&nbsp;Ramamurthy, Payel Das,
and Siva Reddy.

</span>
<span class="ltx_bibblock">The impact of positional encoding on length generalization in
transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kryściński et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Wojciech Kryściński, Nazneen Rajani, Divyansh Agarwal, Caiming Xiong,
and Dragomir Radev.

</span>
<span class="ltx_bibblock">Booksum: A collection of datasets for long-form narrative
summarization.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2105.08209</em>, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Mike Lewis, Yinhan Liu, Naman Goyal, Marjan Ghazvininejad, Abdelrahman Mohamed,
Omer Levy, Ves Stoyanov, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Bart: Denoising sequence-to-sequence pre-training for natural
language generation, translation, and comprehension.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.13461</em>, 2019.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Hao Liu, Matei Zaharia, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Ring attention with blockwise transformers for near-infinite context.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.01889</em>, 2023.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Nelson&nbsp;F Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua,
Fabio Petroni, and Percy Liang.

</span>
<span class="ltx_bibblock">Lost in the middle: How language models use long contexts.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association for Computational Linguistics</em>,
12:157–173, 2024.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miconi et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
Thomas Miconi, Kenneth Stanley, and Jeff Clune.

</span>
<span class="ltx_bibblock">Differentiable plasticity: training plastic neural networks with
backpropagation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp;3559–3568. PMLR, 2018.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohtashami &amp; Jaggi (2024)</span>
<span class="ltx_bibblock">
Amirkeivan Mohtashami and Martin Jaggi.

</span>
<span class="ltx_bibblock">Random-access infinite context length for transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mu et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Jesse Mu, Xiang Li, and Noah Goodman.

</span>
<span class="ltx_bibblock">Learning to compress prompts with gist tokens.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai &amp; Yu (2017a)</span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai and Hong Yu.

</span>
<span class="ltx_bibblock">Meta networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp.&nbsp;2554–2563. PMLR, 2017a.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai &amp; Yu (2017b)</span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai and Hong Yu.

</span>
<span class="ltx_bibblock">Neural semantic encoders.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the conference. Association for Computational
Linguistics. Meeting</em>, volume&nbsp;1, pp.&nbsp; 397. NIH Public Access,
2017b.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai et&nbsp;al. (2016)</span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai, John&nbsp;P Lalor, and Hong Yu.

</span>
<span class="ltx_bibblock">Citation analysis with neural attention models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Seventh International Workshop on Health
Text Mining and Information Analysis</em>, pp.&nbsp; 69–77, 2016.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai, Alessandro Sordoni, Tong Wang, and Adam Trischler.

</span>
<span class="ltx_bibblock">Metalearned neural memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Bowen Peng, Jeffrey Quesnelle, Honglu Fan, and Enrico Shippole.

</span>
<span class="ltx_bibblock">Yarn: Efficient context window extension of large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.00071</em>, 2023.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pope et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Reiner Pope, Sholto Douglas, Aakanksha Chowdhery, Jacob Devlin, James Bradbury,
Jonathan Heek, Kefan Xiao, Shivani Agrawal, and Jeff Dean.

</span>
<span class="ltx_bibblock">Efficiently scaling transformer inference.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 5, 2023.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Ofir Press, Noah&nbsp;A Smith, and Mike Lewis.

</span>
<span class="ltx_bibblock">Train short, test long: Attention with linear biases enables input
length extrapolation.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.12409</em>, 2021.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rae et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Jack&nbsp;W Rae, Anna Potapenko, Siddhant&nbsp;M Jayakumar, and Timothy&nbsp;P Lillicrap.

</span>
<span class="ltx_bibblock">Compressive transformers for long-range sequence modelling.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.05507</em>, 2019.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael
Matena, Yanqi Zhou, Wei Li, and Peter&nbsp;J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">The Journal of Machine Learning Research</em>, 21(1):5485–5551, 2020.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ratner et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Nir Ratner, Yoav Levine, Yonatan Belinkov, Ori Ram, Omri Abend, Ehud Karpas,
Amnon Shashua, Kevin Leyton-Brown, and Yoav Shoham.

</span>
<span class="ltx_bibblock">Parallel context windows improve in-context learning of large
language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2212.10947</em>, 2022.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Imanol Schlag, Paul Smolensky, Roland Fernandez, Nebojsa Jojic, Jürgen
Schmidhuber, and Jianfeng Gao.

</span>
<span class="ltx_bibblock">Enhancing the transformer with explicit relational encoding for math
problem solving.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.06611</em>, 2019.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Imanol Schlag, Tsendsuren Munkhdalai, and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Learning associative inference using fast weight memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2011.07831</em>, 2020.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Imanol Schlag, Kazuki Irie, and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Linear transformers are secretly fast weight programmers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp;9355–9366. PMLR, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schmidhuber (1992)</span>
<span class="ltx_bibblock">
Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Learning to control fast-weight memories: An alternative to dynamic
recurrent networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Neural Computation</em>, 4(1):131–139, 1992.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer &amp; Stern (2018)</span>
<span class="ltx_bibblock">
Noam Shazeer and Mitchell Stern.

</span>
<span class="ltx_bibblock">Adafactor: Adaptive learning rates with sublinear memory cost.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp;4596–4604. PMLR, 2018.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
Zhuoran Shen, Mingyuan Zhang, Haiyu Zhao, Shuai Yi, and Hongsheng Li.

</span>
<span class="ltx_bibblock">Efficient attention: Attention with linear complexities.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.01243</em>, 2018.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smolensky (1990)</span>
<span class="ltx_bibblock">
Paul Smolensky.

</span>
<span class="ltx_bibblock">Tensor product variable binding and the representation of symbolic
structures in connectionist systems.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence</em>, 46(1-2):159–216,
1990.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sukhbaatar et&nbsp;al. (2015)</span>
<span class="ltx_bibblock">
Sainbayar Sukhbaatar, Jason Weston, Rob Fergus, et&nbsp;al.

</span>
<span class="ltx_bibblock">End-to-end memory networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 28, 2015.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sukhbaatar et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Sainbayar Sukhbaatar, Da&nbsp;Ju, Spencer Poff, Stephen Roller, Arthur Szlam, Jason
Weston, and Angela Fan.

</span>
<span class="ltx_bibblock">Not all memories are created equal: Learning to forget by expiring.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp;9902–9912. PMLR, 2021.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em>, 2023.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan&nbsp;N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Yuhuai Wu, Markus&nbsp;N Rabe, DeLesley Hutchins, and Christian Szegedy.

</span>
<span class="ltx_bibblock">Memorizing transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.08913</em>, 2022.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Guangxuan Xiao, Yuandong Tian, Beidi Chen, Song Han, and Mike Lewis.

</span>
<span class="ltx_bibblock">Efficient streaming language models with attention sinks.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.17453</em>, 2023.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Wen Xiao, Iz&nbsp;Beltagy, Giuseppe Carenini, and Arman Cohan.

</span>
<span class="ltx_bibblock">Primera: Pyramid-based masked sentence pre-training for
multi-document summarization.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.08499</em>, 2021.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Wenhan Xiong, Jingyu Liu, Igor Molybog, Hejia Zhang, Prajjwal Bhargava, Rui
Hou, Louis Martin, Rashi Rungta, Karthik&nbsp;Abinav Sankararaman, Barlas Oguz,
et&nbsp;al.

</span>
<span class="ltx_bibblock">Effective long-context scaling of foundation models.

</span>
<span class="ltx_bibblock"><em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.16039</em>, 2023.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional Training Details</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.1" class="ltx_p">For the long-context language modeling task, we set the learning rate to 0.01 by performing small search over values of 0.003, 0.005, 0.01 and 0.03. We used the Adafactor optimizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shazeer &amp; Stern, <a href="#bib.bib48" title="" class="ltx_ref">2018</a>)</cite> with linear warmup with 1000 steps, followed by cosine decay. We applied gradient checkpointing after each segment to save to save memory. The batch size was set to 64. For the LLM experiments, we set the learning rate to 0.0001 during continual pre-training and task fine-tuning.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Passkey Retrieval Task</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.1" class="ltx_p">Below we showed the input format of the passkey task.</p>
</div>
<div id="A2.p2" class="ltx_para ltx_noindent">
<p id="A2.p2.1" class="ltx_p"><span id="A2.p2.1.1" class="ltx_text ltx_font_sansserif">There is an important info hidden inside a lot of irrelevant text. Find it and
memorize them. I will quiz you about the important information there.
The grass is green. The sky is blue. The sun is yellow. Here we go. There and
back again. <span id="A2.p2.1.1.1" class="ltx_text ltx_framed ltx_framed_underline">(repeat x times)</span> The pass key is <span id="A2.p2.1.1.2" class="ltx_text ltx_font_bold">9054</span>. Remember it. <span id="A2.p2.1.1.3" class="ltx_text ltx_font_bold">9054</span> is the pass key. The grass is green. The sky is blue. The sun is yellow. Here we go. There and ack again. <span id="A2.p2.1.1.4" class="ltx_text ltx_framed ltx_framed_underline">(repeat y times)</span>
What is the pass key? The pass key is</span></p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.07142" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.07143" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+2404.07143">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.07143" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.07144" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 21:27:20 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>