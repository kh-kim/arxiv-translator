<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.13799] Reverse Training to Nurse the Reversal Curse</title><meta property="og:description" content="Large language models (LLMs) have a surprising failure: when trained on â€œA has a feature Bâ€, they do not generalize to â€œB is a feature of Aâ€, which is termed the Reversal Curse. Even when training with trillions of tokâ€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Reverse Training to Nurse the Reversal Curse">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Reverse Training to Nurse the Reversal Curse">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.13799">

<!--Generated on Fri Apr  5 14:57:39 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.7.9.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.9.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\NewOverArrowCommand</span>
<p id="p1.2" class="ltx_p">reversestart= <span id="p1.2.1" class="ltx_ERROR undefined">\smallermathstyle</span>â†,
middle=<span id="p1.2.2" class="ltx_ERROR undefined">\smallermathstyle</span>-,
end=-,
trim=4,</p>
</div>
<h1 class="ltx_title ltx_title_document">Reverse Training to Nurse the Reversal Curse</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Olga Golovneva 
<br class="ltx_break">FAIR at Meta
&amp;Zeyuan Allen-Zhu
<br class="ltx_break">FAIR at Meta
&amp;Jason Weston
<br class="ltx_break">FAIR at Meta
&amp;Sainbayar Sukhbaatar 
<br class="ltx_break">FAIR at Meta 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Large language models (LLMs) have a surprising failure: when trained on â€œA has a feature Bâ€, they do not generalize to â€œB is a feature of Aâ€, which is termed the Reversal Curse. Even when training with trillions of tokens this issue still appears due to Zipfâ€™s law â€“ hence even if we train on the entire internet.
This work proposes an alternative training scheme, called <span id="id1.id1.1" class="ltx_text ltx_font_italic">reverse training</span>, whereby all words are used twice, doubling the amount of available tokens. The LLM is trained in both forward and reverse directions by reversing training strings while preserving (i.e., not reversing) chosen substrings, such as entities.
We show that data-matched reverse-trained models provide superior performance to standard models on standard tasks, and compute-matched reverse-trained models provide far superior performance on reversal tasks, helping resolve the reversal curse issue.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Large Language Models (LLMs) trained on internet-scale data perform extremely well on tasks relating to reasoning, common-sense, and world-knowledge. In particular, the range of knowledge captured by LLMs like <span id="S1.p1.1.1" class="ltx_text ltx_font_smallcaps">GPT-4</span> <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a href="#bib.bib22" title="" class="ltx_ref">2023</a>)</cite> and Llama-2 <cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2023b</a>)</cite> is significantly wider than that of an average person.
However, recent research <cite class="ltx_cite ltx_citemacro_citep">(Berglund et&nbsp;al., <a href="#bib.bib5" title="" class="ltx_ref">2023b</a>; Allen-Zhu &amp; Li, <a href="#bib.bib1" title="" class="ltx_ref">2023a</a>; <a href="#bib.bib2" title="" class="ltx_ref">b</a>)</cite> uncovered a curious flaw in the knowledge capabilities of LLMs, coined the <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">reversal curse</em>.
They experimentally showed that even the currently most powerful LLMs are incapable of â€œreversingâ€ facts they had learned.
For example, standard LLMs cannot correctly answer â€œWhatâ€™s the capital of France?â€ even if the training data contains â€œParis is the capital of Franceâ€, unless it also contains text where â€œFranceâ€ is followed by â€œParisâ€, such as â€œAs the capital of France, Paris has â€¦â€.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">This is a serious problem because it means LLMs cannot learn the equivalence of relations like â€œA is the capital of Bâ€ equals â€œBâ€™s capital is Aâ€ despite being trained on many pairs of such facts.
In contrast, a human child can learn such general rules from just a few observations of both directions, which makes it an elementary function of human intelligence.
The reversal curse may have been hard to notice at first because
most LLMs are trained on internet-scale data, which is likely to contain the most common facts in both directions. However,
due to Zipfâ€™s law <cite class="ltx_cite ltx_citemacro_citep">(Newman, <a href="#bib.bib21" title="" class="ltx_ref">2005</a>)</cite>, many facts are mentioned rarely, or only once (and hence in one direction). Further, a more common concept can still be attached to more rare concepts, for example the names or details of a celebrityâ€™s parents.
Hence, this can still be measured using real-world facts about celebrities as demonstrated by <cite class="ltx_cite ltx_citemacro_citet">Berglund et&nbsp;al. (<a href="#bib.bib5" title="" class="ltx_ref">2023b</a>)</cite>.
It can also be revealed using text that often appears in only one direction, such as song lyrics, as demonstrated in <a href="#S1.T1" title="Table 1 â€£ 1 Introduction â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;1</span></a>.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">In this paper, we propose a simple training method to reduce the effect of the reversal curse.
We first observe that LLMs are trained in an autoregressive way from left-to-right, which may contribute to the reversal curse.
While predicting the next word might be more natural, it is also possible to train a LLM in the right-to-left direction, by predicting the previous word from its subsequent words.
Such reverse training has the potential to solve the reversal curse because it allows the model to see a fact in its reverse direction. However, this knowledge has to be transferred to test time left-to-right generations. Viewing the reversed text as a second language, it is known that training on multiple varying sources can be leveraged to help each other via multitasking (e.g., from code to math <cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a href="#bib.bib29" title="" class="ltx_ref">2024</a>)</cite>, or in cross-lingual pre-training <cite class="ltx_cite ltx_citemacro_citep">(Lample &amp; Conneau, <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>). We investigate four reversal types that require minimal processing
and can be seen as this additional â€œlanguageâ€: token reversal, word reversal, entity-preserving reversal and random segment reversal.
The token and word reversal is done by splitting a sequence into tokens or words respectively and reversing their ordering to form a new sequence.
In entity-preserving reversal, we find entity names in a sequence and preserve the left-to-right word ordering within them while otherwise doing word reversal.
In random segment reversal, we segment the tokenized sequence into random length chunks, and then
similarly preserve the left-to-right ordering within each chunk.
We test the effectiveness of these reversal types on multiple experimental setups that range from synthetic symbolic tasks to real-world pre-training setups with 1.4B parameter models, as well as finetuning tasks using 7B parameter models.
Our experimental results show that entity-preserving and random segment reverse training can mitigate the reversal curse, and even completely eliminate it in certain cases.
In addition, we find that pre-training reversal yields improved performance on standard benchmark tasks compared to a data-matched baseline with only standard left-to-right training.
Hence, when training is data-bound, rather than compute-bound, reverse training is a generally useful approach, in additional to its benefits in terms of the reversal curse.</p>
</div>
<figure id="S1.T1" class="ltx_table">
<table id="S1.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S1.T1.1.1.1" class="ltx_tr">
<th id="S1.T1.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt">
<span id="S1.T1.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.1.1.1.1.1" class="ltx_p" style="width:203.8pt;"><span id="S1.T1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Query:</span> What is the line that comes after â€œGave proof through the night that our
flag was still thereâ€ in the US anthem?</span>
</span>
</th>
<th id="S1.T1.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S1.T1.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.1.1.2.1.1" class="ltx_p" style="width:203.8pt;"><span id="S1.T1.1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Query:</span> What is the line that comes before â€œO say does that star-spangled banner yet waveâ€ in the US anthem?</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S1.T1.1.2.1" class="ltx_tr">
<td id="S1.T1.1.2.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S1.T1.1.2.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.2.1.1.1.1" class="ltx_p" style="width:203.8pt;"><span id="S1.T1.1.2.1.1.1.1.1" class="ltx_text ltx_font_bold">GPT4<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnote1.1.1.1" class="ltx_text ltx_font_medium">1</span></span>This example used the GPT4 model accessed at <a target="_blank" href="https://chat.openai.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium">https://chat.openai.com/</a> on Mar 4th, 2024.</span></span></span>:</span> The line that comes after â€œGave proof through the night that our flag was still thereâ€ in the U.S. national anthem, â€œThe Star-Spangled Banner,â€ is:
â€œ<span id="S1.T1.1.2.1.1.1.1.2" class="ltx_text" style="background-color:#D8D3EA;">O say does that star-spangled banner yet wave</span>â€</span>
</span>
</td>
<td id="S1.T1.1.2.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S1.T1.1.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.2.1.2.1.1" class="ltx_p" style="width:203.8pt;"><span id="S1.T1.1.2.1.2.1.1.1" class="ltx_text ltx_font_bold">GPT4:</span> The line that comes before â€œO say does that star-spangled banner yet waveâ€ in the US National Anthem, â€œThe Star-Spangled Banner,â€ is â€œ<span id="S1.T1.1.2.1.2.1.1.2" class="ltx_text" style="background-color:#EAD9D3;">And the rocketâ€™s red glare, the bombs bursting in air.</span>â€</span>
</span>
</td>
</tr>
<tr id="S1.T1.1.3.2" class="ltx_tr">
<td id="S1.T1.1.3.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t">
<span id="S1.T1.1.3.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.3.2.1.1.1" class="ltx_p" style="width:203.8pt;"><span id="S1.T1.1.3.2.1.1.1.1" class="ltx_text ltx_font_bold">Llama-2 Chat:</span> The line that comes after â€œGave proof through the night that our flag was still thereâ€ in the US anthem is:
â€œ<span id="S1.T1.1.3.2.1.1.1.2" class="ltx_text" style="background-color:#D8D3EA;">O say does that star-spangled banner yet wave</span> â€¦</span>
</span>
</td>
<td id="S1.T1.1.3.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t">
<span id="S1.T1.1.3.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T1.1.3.2.2.1.1" class="ltx_p" style="width:203.8pt;"><span id="S1.T1.1.3.2.2.1.1.1" class="ltx_text ltx_font_bold">Llama-2 Chat:</span> The line that comes before â€œO say does that star-spangled banner yet waveâ€ in the US anthem is:
â€œ<span id="S1.T1.1.3.2.2.1.1.2" class="ltx_text" style="background-color:#EAD9D3;">O long may it wave oâ€™er the land of the free and the home of the brave.</span>â€</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="S1.T1.3.1" class="ltx_text ltx_font_bold">An example of the reversal curse:</span> even the most capable LLMs fail to recall a fact in reverse if it is mostly seen only in one direction, such as lines of song lyrics. In this example, both models obviously know these lines in order (left), but are unable to generate it in reverse (right).</figcaption>
</figure>
<figure id="S1.T2" class="ltx_table">
<table id="S1.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S1.T2.1.1.1" class="ltx_tr">
<th id="S1.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S1.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Transformation</span></th>
<th id="S1.T2.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S1.T2.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T2.1.1.1.2.1.1" class="ltx_p" style="width:261.8pt;"><span id="S1.T2.1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Training example</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S1.T2.1.2.1" class="ltx_tr">
<th id="S1.T2.1.2.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S1.T2.1.2.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T2.1.2.1.1.1.1" class="ltx_p" style="width:108.1pt;">None</span>
</span>
</th>
<td id="S1.T2.1.2.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S1.T2.1.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T2.1.2.1.2.1.1" class="ltx_p" style="width:261.8pt;">Cruise was born on July 3, 1962, in Syracuse, New York, to Mary Lee Pfeiffer.</span>
</span>
</td>
</tr>
<tr id="S1.T2.1.3.2" class="ltx_tr">
<th id="S1.T2.1.3.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S1.T2.1.3.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T2.1.3.2.1.1.1" class="ltx_p" style="width:108.1pt;">Word reversal</span>
</span>
</th>
<td id="S1.T2.1.3.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S1.T2.1.3.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T2.1.3.2.2.1.1" class="ltx_p" style="width:261.8pt;">. Pfeiffer Lee Mary to, York New , Syracuse in , 1962 , 3 July on born was Cruise</span>
</span>
</td>
</tr>
<tr id="S1.T2.1.4.3" class="ltx_tr">
<th id="S1.T2.1.4.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S1.T2.1.4.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T2.1.4.3.1.1.1" class="ltx_p" style="width:108.1pt;">Entity-preserving reversal</span>
</span>
</th>
<td id="S1.T2.1.4.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S1.T2.1.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T2.1.4.3.2.1.1" class="ltx_p" style="width:261.8pt;">. <span id="S1.T2.1.4.3.2.1.1.1" class="ltx_text ltx_framed ltx_framed_underline">Mary Lee Pfeiffer</span> to, <span id="S1.T2.1.4.3.2.1.1.2" class="ltx_text ltx_framed ltx_framed_underline">Syracuse, New York</span> in ,
1962 , 3 July
on born was <span id="S1.T2.1.4.3.2.1.1.3" class="ltx_text ltx_framed ltx_framed_underline">Cruise</span></span>
</span>
</td>
</tr>
<tr id="S1.T2.1.5.4" class="ltx_tr">
<th id="S1.T2.1.5.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t">
<span id="S1.T2.1.5.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T2.1.5.4.1.1.1" class="ltx_p" style="width:108.1pt;">Random segment reversal</span>
</span>
</th>
<td id="S1.T2.1.5.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t">
<span id="S1.T2.1.5.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S1.T2.1.5.4.2.1.1" class="ltx_p" style="width:261.8pt;">[REV] York, to Mary Lee Pfeiffer . [REV] in Syracuse, New [REV]</span>
<span id="S1.T2.1.5.4.2.1.2" class="ltx_p">on July 3, 1962,  [REV]
born [REV] Cruise was</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span><span id="S1.T2.4.1" class="ltx_text ltx_font_bold">Reversal transformations:</span> examples of different reversal types on a given string. In practice, training examples can be much longer (e.g., entire documents during pre-training). The language model is still trained left-to-right on such transformations, and in the word reversal case is essentially predicting the sentence backwards (right-to-left) starting from the last word. The entities which have their word ordering preserved are highlighted by underlines.
In random segment reversal, the segments are separated by â€œ[REV]â€.
<span id="S1.T2.5.2" class="ltx_text ltx_font_italic">Reverse training</span> involves training on both the standard (â€Noneâ€ transformation) and reversed examples, hence doubling the amount of training tokens. The reverse transformation can be seen as a second â€œlanguageâ€ the model has to learn, note this is not the same as reversing the relation between facts, which remains intact, as the model can tell from the syntax whether it is in forward or reverse language prediction mode.

</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Reverse Training</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.2" class="ltx_p">Reverse training consists of taking a training dataset with <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">N</annotation></semantics></math> samples <math id="S2.p1.2.m2.3" class="ltx_Math" alttext="\{x_{1},\ldots,x_{N}\}" display="inline"><semantics id="S2.p1.2.m2.3a"><mrow id="S2.p1.2.m2.3.3.2" xref="S2.p1.2.m2.3.3.3.cmml"><mo stretchy="false" id="S2.p1.2.m2.3.3.2.3" xref="S2.p1.2.m2.3.3.3.cmml">{</mo><msub id="S2.p1.2.m2.2.2.1.1" xref="S2.p1.2.m2.2.2.1.1.cmml"><mi id="S2.p1.2.m2.2.2.1.1.2" xref="S2.p1.2.m2.2.2.1.1.2.cmml">x</mi><mn id="S2.p1.2.m2.2.2.1.1.3" xref="S2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p1.2.m2.3.3.2.4" xref="S2.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">â€¦</mi><mo id="S2.p1.2.m2.3.3.2.5" xref="S2.p1.2.m2.3.3.3.cmml">,</mo><msub id="S2.p1.2.m2.3.3.2.2" xref="S2.p1.2.m2.3.3.2.2.cmml"><mi id="S2.p1.2.m2.3.3.2.2.2" xref="S2.p1.2.m2.3.3.2.2.2.cmml">x</mi><mi id="S2.p1.2.m2.3.3.2.2.3" xref="S2.p1.2.m2.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S2.p1.2.m2.3.3.2.6" xref="S2.p1.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.3b"><set id="S2.p1.2.m2.3.3.3.cmml" xref="S2.p1.2.m2.3.3.2"><apply id="S2.p1.2.m2.2.2.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.p1.2.m2.2.2.1.1.2.cmml" xref="S2.p1.2.m2.2.2.1.1.2">ğ‘¥</ci><cn type="integer" id="S2.p1.2.m2.2.2.1.1.3.cmml" xref="S2.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">â€¦</ci><apply id="S2.p1.2.m2.3.3.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.3.3.2.2.1.cmml" xref="S2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.p1.2.m2.3.3.2.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2.2">ğ‘¥</ci><ci id="S2.p1.2.m2.3.3.2.2.3.cmml" xref="S2.p1.2.m2.3.3.2.2.3">ğ‘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.3c">\{x_{1},\ldots,x_{N}\}</annotation></semantics></math> and constructing the set of reversed samples</p>
<table id="S2.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex1.m1.2" class="ltx_Math" alttext="\reverse{x_{i}}={\mbox{REVERSE}}(x_{i}),~{}~{}~{}~{}~{}~{}i=1,\dots N." display="block"><semantics id="S2.Ex1.m1.2a"><mrow id="S2.Ex1.m1.2.2.1"><mrow id="S2.Ex1.m1.2.2.1.1.2" xref="S2.Ex1.m1.2.2.1.1.3.cmml"><mrow id="S2.Ex1.m1.2.2.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.cmml"><mrow id="S2.Ex1.m1.2.2.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.Ex1.m1.2.2.1.1.1.1.3.2" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2b.cmml"><mtext id="S2.Ex1.m1.2.2.1.1.1.1.3.2a" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2b.cmml">\reverse</mtext></merror><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.2.2.1.1.1.1.3.1" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1.cmml">â€‹</mo><msub id="S2.Ex1.m1.2.2.1.1.1.1.3.3" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.3.3.2" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.2.cmml">x</mi><mi id="S2.Ex1.m1.2.2.1.1.1.1.3.3.3" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow><mo id="S2.Ex1.m1.2.2.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.2.cmml">=</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.cmml"><mtext id="S2.Ex1.m1.2.2.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.3a.cmml">REVERSE</mtext><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.2.2.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="2.147em" id="S2.Ex1.m1.2.2.1.1.2.3" xref="S2.Ex1.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.2" xref="S2.Ex1.m1.2.2.1.1.2.2.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.2.3" xref="S2.Ex1.m1.2.2.1.1.2.2.3.cmml">i</mi><mo id="S2.Ex1.m1.2.2.1.1.2.2.2" xref="S2.Ex1.m1.2.2.1.1.2.2.2.cmml">=</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.2.1.1" xref="S2.Ex1.m1.2.2.1.1.2.2.1.2.cmml"><mn id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">1</mn><mo id="S2.Ex1.m1.2.2.1.1.2.2.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.2.1.2.cmml">,</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.2.cmml">â€¦</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.1.cmml">â€‹</mo><mi id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.3.cmml">N</mi></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.Ex1.m1.2.2.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b"><apply id="S2.Ex1.m1.2.2.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.3a.cmml" xref="S2.Ex1.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S2.Ex1.m1.2.2.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1"><eq id="S2.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.2"></eq><apply id="S2.Ex1.m1.2.2.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3"><times id="S2.Ex1.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1"></times><ci id="S2.Ex1.m1.2.2.1.1.1.1.3.2b.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2"><merror class="ltx_ERROR undefined undefined" id="S2.Ex1.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2"><mtext id="S2.Ex1.m1.2.2.1.1.1.1.3.2a.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2">\reverse</mtext></merror></ci><apply id="S2.Ex1.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.2">ğ‘¥</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.3">ğ‘–</ci></apply></apply><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1"><times id="S2.Ex1.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.2"></times><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.3a.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.3"><mtext id="S2.Ex1.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.3">REVERSE</mtext></ci><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2">ğ‘¥</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply><apply id="S2.Ex1.m1.2.2.1.1.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2"><eq id="S2.Ex1.m1.2.2.1.1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2"></eq><ci id="S2.Ex1.m1.2.2.1.1.2.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.3">ğ‘–</ci><list id="S2.Ex1.m1.2.2.1.1.2.2.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1"><cn type="integer" id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">1</cn><apply id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1"><times id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.1"></times><ci id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.2">â€¦</ci><ci id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.3">ğ‘</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">\reverse{x_{i}}={\mbox{REVERSE}}(x_{i}),~{}~{}~{}~{}~{}~{}i=1,\dots N.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p1.5" class="ltx_p">Training is then conducted using the combined set <math id="S2.p1.3.m1.2" class="ltx_Math" alttext="\{x_{i}\}\cup\{\reverse{x_{i}}\}" display="inline"><semantics id="S2.p1.3.m1.2a"><mrow id="S2.p1.3.m1.2.2" xref="S2.p1.3.m1.2.2.cmml"><mrow id="S2.p1.3.m1.1.1.1.1" xref="S2.p1.3.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.p1.3.m1.1.1.1.1.2" xref="S2.p1.3.m1.1.1.1.2.cmml">{</mo><msub id="S2.p1.3.m1.1.1.1.1.1" xref="S2.p1.3.m1.1.1.1.1.1.cmml"><mi id="S2.p1.3.m1.1.1.1.1.1.2" xref="S2.p1.3.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p1.3.m1.1.1.1.1.1.3" xref="S2.p1.3.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.p1.3.m1.1.1.1.1.3" xref="S2.p1.3.m1.1.1.1.2.cmml">}</mo></mrow><mo id="S2.p1.3.m1.2.2.3" xref="S2.p1.3.m1.2.2.3.cmml">âˆª</mo><mrow id="S2.p1.3.m1.2.2.2.1" xref="S2.p1.3.m1.2.2.2.2.cmml"><mo stretchy="false" id="S2.p1.3.m1.2.2.2.1.2" xref="S2.p1.3.m1.2.2.2.2.cmml">{</mo><mrow id="S2.p1.3.m1.2.2.2.1.1" xref="S2.p1.3.m1.2.2.2.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.p1.3.m1.2.2.2.1.1.2" xref="S2.p1.3.m1.2.2.2.1.1.2b.cmml"><mtext id="S2.p1.3.m1.2.2.2.1.1.2a" xref="S2.p1.3.m1.2.2.2.1.1.2b.cmml">\reverse</mtext></merror><mo lspace="0em" rspace="0em" id="S2.p1.3.m1.2.2.2.1.1.1" xref="S2.p1.3.m1.2.2.2.1.1.1.cmml">â€‹</mo><msub id="S2.p1.3.m1.2.2.2.1.1.3" xref="S2.p1.3.m1.2.2.2.1.1.3.cmml"><mi id="S2.p1.3.m1.2.2.2.1.1.3.2" xref="S2.p1.3.m1.2.2.2.1.1.3.2.cmml">x</mi><mi id="S2.p1.3.m1.2.2.2.1.1.3.3" xref="S2.p1.3.m1.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S2.p1.3.m1.2.2.2.1.3" xref="S2.p1.3.m1.2.2.2.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m1.2b"><apply id="S2.p1.3.m1.2.2.cmml" xref="S2.p1.3.m1.2.2"><union id="S2.p1.3.m1.2.2.3.cmml" xref="S2.p1.3.m1.2.2.3"></union><set id="S2.p1.3.m1.1.1.1.2.cmml" xref="S2.p1.3.m1.1.1.1.1"><apply id="S2.p1.3.m1.1.1.1.1.1.cmml" xref="S2.p1.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m1.1.1.1.1.1.1.cmml" xref="S2.p1.3.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.3.m1.1.1.1.1.1.2.cmml" xref="S2.p1.3.m1.1.1.1.1.1.2">ğ‘¥</ci><ci id="S2.p1.3.m1.1.1.1.1.1.3.cmml" xref="S2.p1.3.m1.1.1.1.1.1.3">ğ‘–</ci></apply></set><set id="S2.p1.3.m1.2.2.2.2.cmml" xref="S2.p1.3.m1.2.2.2.1"><apply id="S2.p1.3.m1.2.2.2.1.1.cmml" xref="S2.p1.3.m1.2.2.2.1.1"><times id="S2.p1.3.m1.2.2.2.1.1.1.cmml" xref="S2.p1.3.m1.2.2.2.1.1.1"></times><ci id="S2.p1.3.m1.2.2.2.1.1.2b.cmml" xref="S2.p1.3.m1.2.2.2.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.p1.3.m1.2.2.2.1.1.2.cmml" xref="S2.p1.3.m1.2.2.2.1.1.2"><mtext id="S2.p1.3.m1.2.2.2.1.1.2a.cmml" xref="S2.p1.3.m1.2.2.2.1.1.2">\reverse</mtext></merror></ci><apply id="S2.p1.3.m1.2.2.2.1.1.3.cmml" xref="S2.p1.3.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.p1.3.m1.2.2.2.1.1.3.1.cmml" xref="S2.p1.3.m1.2.2.2.1.1.3">subscript</csymbol><ci id="S2.p1.3.m1.2.2.2.1.1.3.2.cmml" xref="S2.p1.3.m1.2.2.2.1.1.3.2">ğ‘¥</ci><ci id="S2.p1.3.m1.2.2.2.1.1.3.3.cmml" xref="S2.p1.3.m1.2.2.2.1.1.3.3">ğ‘–</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m1.2c">\{x_{i}\}\cup\{\reverse{x_{i}}\}</annotation></semantics></math> of <math id="S2.p1.4.m2.1" class="ltx_Math" alttext="2N" display="inline"><semantics id="S2.p1.4.m2.1a"><mrow id="S2.p1.4.m2.1.1" xref="S2.p1.4.m2.1.1.cmml"><mn id="S2.p1.4.m2.1.1.2" xref="S2.p1.4.m2.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.p1.4.m2.1.1.1" xref="S2.p1.4.m2.1.1.1.cmml">â€‹</mo><mi id="S2.p1.4.m2.1.1.3" xref="S2.p1.4.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m2.1b"><apply id="S2.p1.4.m2.1.1.cmml" xref="S2.p1.4.m2.1.1"><times id="S2.p1.4.m2.1.1.1.cmml" xref="S2.p1.4.m2.1.1.1"></times><cn type="integer" id="S2.p1.4.m2.1.1.2.cmml" xref="S2.p1.4.m2.1.1.2">2</cn><ci id="S2.p1.4.m2.1.1.3.cmml" xref="S2.p1.4.m2.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m2.1c">2N</annotation></semantics></math> training samples, using the typical language modeling objective.
The function <math id="S2.p1.5.m3.1" class="ltx_Math" alttext="\mbox{REVERSE}(\cdot)" display="inline"><semantics id="S2.p1.5.m3.1a"><mrow id="S2.p1.5.m3.1.2" xref="S2.p1.5.m3.1.2.cmml"><mtext id="S2.p1.5.m3.1.2.2" xref="S2.p1.5.m3.1.2.2a.cmml">REVERSE</mtext><mo lspace="0em" rspace="0em" id="S2.p1.5.m3.1.2.1" xref="S2.p1.5.m3.1.2.1.cmml">â€‹</mo><mrow id="S2.p1.5.m3.1.2.3.2" xref="S2.p1.5.m3.1.2.cmml"><mo stretchy="false" id="S2.p1.5.m3.1.2.3.2.1" xref="S2.p1.5.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p1.5.m3.1.1" xref="S2.p1.5.m3.1.1.cmml">â‹…</mo><mo stretchy="false" id="S2.p1.5.m3.1.2.3.2.2" xref="S2.p1.5.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m3.1b"><apply id="S2.p1.5.m3.1.2.cmml" xref="S2.p1.5.m3.1.2"><times id="S2.p1.5.m3.1.2.1.cmml" xref="S2.p1.5.m3.1.2.1"></times><ci id="S2.p1.5.m3.1.2.2a.cmml" xref="S2.p1.5.m3.1.2.2"><mtext id="S2.p1.5.m3.1.2.2.cmml" xref="S2.p1.5.m3.1.2.2">REVERSE</mtext></ci><ci id="S2.p1.5.m3.1.1.cmml" xref="S2.p1.5.m3.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m3.1c">\mbox{REVERSE}(\cdot)</annotation></semantics></math> reverses the given string, where we consider various choices of reversal type:</p>
<ul id="S2.I1" class="ltx_itemize">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.4" class="ltx_p"><span id="S2.I1.i1.p1.4.1" class="ltx_text ltx_font_bold">Token reversal</span> (<math id="S2.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\mbox{REVERSE}_{token}" display="inline"><semantics id="S2.I1.i1.p1.1.m1.1a"><msub id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml"><mtext id="S2.I1.i1.p1.1.m1.1.1.2" xref="S2.I1.i1.p1.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S2.I1.i1.p1.1.m1.1.1.3" xref="S2.I1.i1.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.3.2" xref="S2.I1.i1.p1.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.1" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.3" xref="S2.I1.i1.p1.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.1a" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.4" xref="S2.I1.i1.p1.1.m1.1.1.3.4.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.1b" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.5" xref="S2.I1.i1.p1.1.m1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.1.m1.1.1.3.1c" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.6" xref="S2.I1.i1.p1.1.m1.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><apply id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.2a.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2"><mtext id="S2.I1.i1.p1.1.m1.1.1.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S2.I1.i1.p1.1.m1.1.1.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3"><times id="S2.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.1"></times><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2">ğ‘¡</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3">ğ‘œ</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.4.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.4">ğ‘˜</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.5.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.5">ğ‘’</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.6.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.6">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\mbox{REVERSE}_{token}</annotation></semantics></math>): A given input <math id="S2.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S2.I1.i1.p1.2.m2.1a"><msub id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.2.cmml">x</mi><mi id="S2.I1.i1.p1.2.m2.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><apply id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2">ğ‘¥</ci><ci id="S2.I1.i1.p1.2.m2.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">x_{i}</annotation></semantics></math>, when tokenized, e.g. using BPE <cite class="ltx_cite ltx_citemacro_citep">(Sennrich et&nbsp;al., <a href="#bib.bib27" title="" class="ltx_ref">2015</a>)</cite>, consists of tokens <math id="S2.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="x_{i}^{t}" display="inline"><semantics id="S2.I1.i1.p1.3.m3.1a"><msubsup id="S2.I1.i1.p1.3.m3.1.1" xref="S2.I1.i1.p1.3.m3.1.1.cmml"><mi id="S2.I1.i1.p1.3.m3.1.1.2.2" xref="S2.I1.i1.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="S2.I1.i1.p1.3.m3.1.1.2.3" xref="S2.I1.i1.p1.3.m3.1.1.2.3.cmml">i</mi><mi id="S2.I1.i1.p1.3.m3.1.1.3" xref="S2.I1.i1.p1.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.3.m3.1b"><apply id="S2.I1.i1.p1.3.m3.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.3.m3.1.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1">superscript</csymbol><apply id="S2.I1.i1.p1.3.m3.1.1.2.cmml" xref="S2.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.3.m3.1.1.2.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.3.m3.1.1.2.2.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2.2">ğ‘¥</ci><ci id="S2.I1.i1.p1.3.m3.1.1.2.3.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2.3">ğ‘–</ci></apply><ci id="S2.I1.i1.p1.3.m3.1.1.3.cmml" xref="S2.I1.i1.p1.3.m3.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.3.m3.1c">x_{i}^{t}</annotation></semantics></math>, and the reversed version has the form <math id="S2.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="\reverse{x_{i}}^{t}=x_{i}^{|x_{i}|-t+1}" display="inline"><semantics id="S2.I1.i1.p1.4.m4.1a"><mrow id="S2.I1.i1.p1.4.m4.1.2" xref="S2.I1.i1.p1.4.m4.1.2.cmml"><mrow id="S2.I1.i1.p1.4.m4.1.2.2" xref="S2.I1.i1.p1.4.m4.1.2.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.I1.i1.p1.4.m4.1.2.2.2" xref="S2.I1.i1.p1.4.m4.1.2.2.2b.cmml"><mtext id="S2.I1.i1.p1.4.m4.1.2.2.2a" xref="S2.I1.i1.p1.4.m4.1.2.2.2b.cmml">\reverse</mtext></merror><mo lspace="0em" rspace="0em" id="S2.I1.i1.p1.4.m4.1.2.2.1" xref="S2.I1.i1.p1.4.m4.1.2.2.1.cmml">â€‹</mo><mmultiscripts id="S2.I1.i1.p1.4.m4.1.2.2.3" xref="S2.I1.i1.p1.4.m4.1.2.2.3.cmml"><mi id="S2.I1.i1.p1.4.m4.1.2.2.3.2.2" xref="S2.I1.i1.p1.4.m4.1.2.2.3.2.2.cmml">x</mi><mi id="S2.I1.i1.p1.4.m4.1.2.2.3.2.3" xref="S2.I1.i1.p1.4.m4.1.2.2.3.2.3.cmml">i</mi><mrow id="S2.I1.i1.p1.4.m4.1.2.2.3a" xref="S2.I1.i1.p1.4.m4.1.2.2.3.cmml"></mrow><mrow id="S2.I1.i1.p1.4.m4.1.2.2.3b" xref="S2.I1.i1.p1.4.m4.1.2.2.3.cmml"></mrow><mi id="S2.I1.i1.p1.4.m4.1.2.2.3.3" xref="S2.I1.i1.p1.4.m4.1.2.2.3.3.cmml">t</mi></mmultiscripts></mrow><mo id="S2.I1.i1.p1.4.m4.1.2.1" xref="S2.I1.i1.p1.4.m4.1.2.1.cmml">=</mo><msubsup id="S2.I1.i1.p1.4.m4.1.2.3" xref="S2.I1.i1.p1.4.m4.1.2.3.cmml"><mi id="S2.I1.i1.p1.4.m4.1.2.3.2.2" xref="S2.I1.i1.p1.4.m4.1.2.3.2.2.cmml">x</mi><mi id="S2.I1.i1.p1.4.m4.1.2.3.2.3" xref="S2.I1.i1.p1.4.m4.1.2.3.2.3.cmml">i</mi><mrow id="S2.I1.i1.p1.4.m4.1.1.1" xref="S2.I1.i1.p1.4.m4.1.1.1.cmml"><mrow id="S2.I1.i1.p1.4.m4.1.1.1.1" xref="S2.I1.i1.p1.4.m4.1.1.1.1.cmml"><mrow id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.2" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.1.cmml">|</mo><msub id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.3" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.I1.i1.p1.4.m4.1.1.1.1.2" xref="S2.I1.i1.p1.4.m4.1.1.1.1.2.cmml">âˆ’</mo><mi id="S2.I1.i1.p1.4.m4.1.1.1.1.3" xref="S2.I1.i1.p1.4.m4.1.1.1.1.3.cmml">t</mi></mrow><mo id="S2.I1.i1.p1.4.m4.1.1.1.2" xref="S2.I1.i1.p1.4.m4.1.1.1.2.cmml">+</mo><mn id="S2.I1.i1.p1.4.m4.1.1.1.3" xref="S2.I1.i1.p1.4.m4.1.1.1.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.4.m4.1b"><apply id="S2.I1.i1.p1.4.m4.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2"><eq id="S2.I1.i1.p1.4.m4.1.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.1"></eq><apply id="S2.I1.i1.p1.4.m4.1.2.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2"><times id="S2.I1.i1.p1.4.m4.1.2.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.1"></times><ci id="S2.I1.i1.p1.4.m4.1.2.2.2b.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.2"><merror class="ltx_ERROR undefined undefined" id="S2.I1.i1.p1.4.m4.1.2.2.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.2"><mtext id="S2.I1.i1.p1.4.m4.1.2.2.2a.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.2">\reverse</mtext></merror></ci><apply id="S2.I1.i1.p1.4.m4.1.2.2.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.2.2.3.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3">superscript</csymbol><apply id="S2.I1.i1.p1.4.m4.1.2.2.3.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.2.2.3.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.4.m4.1.2.2.3.2.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3.2.2">ğ‘¥</ci><ci id="S2.I1.i1.p1.4.m4.1.2.2.3.2.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3.2.3">ğ‘–</ci></apply><ci id="S2.I1.i1.p1.4.m4.1.2.2.3.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3.3">ğ‘¡</ci></apply></apply><apply id="S2.I1.i1.p1.4.m4.1.2.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.2.3.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3">superscript</csymbol><apply id="S2.I1.i1.p1.4.m4.1.2.3.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.2.3.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.4.m4.1.2.3.2.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3.2.2">ğ‘¥</ci><ci id="S2.I1.i1.p1.4.m4.1.2.3.2.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3.2.3">ğ‘–</ci></apply><apply id="S2.I1.i1.p1.4.m4.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1"><plus id="S2.I1.i1.p1.4.m4.1.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.2"></plus><apply id="S2.I1.i1.p1.4.m4.1.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1"><minus id="S2.I1.i1.p1.4.m4.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.2"></minus><apply id="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1"><abs id="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.2"></abs><apply id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2">ğ‘¥</ci><ci id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply><ci id="S2.I1.i1.p1.4.m4.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.3">ğ‘¡</ci></apply><cn type="integer" id="S2.I1.i1.p1.4.m4.1.1.1.3.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.4.m4.1c">\reverse{x_{i}}^{t}=x_{i}^{|x_{i}|-t+1}</annotation></semantics></math>.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.1" class="ltx_p"><span id="S2.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Word reversal</span> (<math id="S2.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\mbox{REVERSE}_{word}" display="inline"><semantics id="S2.I1.i2.p1.1.m1.1a"><msub id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mtext id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.I1.i2.p1.1.m1.1.1.3.1" xref="S2.I1.i2.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.I1.i2.p1.1.m1.1.1.3.1a" xref="S2.I1.i2.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.4" xref="S2.I1.i2.p1.1.m1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.I1.i2.p1.1.m1.1.1.3.1b" xref="S2.I1.i2.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.5" xref="S2.I1.i2.p1.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.2a.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2"><mtext id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3"><times id="S2.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.1"></times><ci id="S2.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2">ğ‘¤</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3">ğ‘œ</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.4.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.4">ğ‘Ÿ</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.5.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.5">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\mbox{REVERSE}_{word}</annotation></semantics></math>): Each example is first split into words.<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>We use the word splitter in NLTK <cite class="ltx_cite ltx_citemacro_citep">(Loper &amp; Bird, <a href="#bib.bib17" title="" class="ltx_ref">2002</a>)</cite>.</span></span></span> We then reverse the string at the word level, joining it back together with spaces. Note that this input would then typically be tokenized for input into the LLM, e.g. using BPE.</p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S2.I1.i3.p1" class="ltx_para">
<p id="S2.I1.i3.p1.1" class="ltx_p"><span id="S2.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Entity-preserving reversal</span> (<math id="S2.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\mbox{REVERSE}_{entity}" display="inline"><semantics id="S2.I1.i3.p1.1.m1.1a"><msub id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml"><mtext id="S2.I1.i3.p1.1.m1.1.1.2" xref="S2.I1.i3.p1.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S2.I1.i3.p1.1.m1.1.1.3" xref="S2.I1.i3.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i3.p1.1.m1.1.1.3.2" xref="S2.I1.i3.p1.1.m1.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.I1.i3.p1.1.m1.1.1.3.1" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.3" xref="S2.I1.i3.p1.1.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.I1.i3.p1.1.m1.1.1.3.1a" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.4" xref="S2.I1.i3.p1.1.m1.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.I1.i3.p1.1.m1.1.1.3.1b" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.5" xref="S2.I1.i3.p1.1.m1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.I1.i3.p1.1.m1.1.1.3.1c" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.6" xref="S2.I1.i3.p1.1.m1.1.1.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.I1.i3.p1.1.m1.1.1.3.1d" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.7" xref="S2.I1.i3.p1.1.m1.1.1.3.7.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b"><apply id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.1.m1.1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.1.m1.1.1.2a.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2"><mtext id="S2.I1.i3.p1.1.m1.1.1.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S2.I1.i3.p1.1.m1.1.1.3.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3"><times id="S2.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.1"></times><ci id="S2.I1.i3.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.2">ğ‘’</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.3">ğ‘›</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.4.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.4">ğ‘¡</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.5.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.5">ğ‘–</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.6.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.6">ğ‘¡</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.7.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.7">ğ‘¦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">\mbox{REVERSE}_{entity}</annotation></semantics></math>): We run an entity detector over a given training sample<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We use the
flair/ner-english-large model for entity detection <cite class="ltx_cite ltx_citemacro_citep">(Schweter &amp; Akbik, <a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite>.</span></span></span>, which also splits the non-entities into words. We then reverse the words, but keep the word-order of entities in their original left-to-right order.
The string is then joined as before with spaces.
See
<a href="#S1.T2" title="Table 2 â€£ 1 Introduction â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;2</span></a> for an example.</p>
</div>
</li>
<li id="S2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S2.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S2.I1.i4.p1.2" class="ltx_p"><span id="S2.I1.i4.p1.2.1" class="ltx_text ltx_font_bold">Random segment reversal</span> (<math id="S2.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="\mbox{REVERSE}_{rand}" display="inline"><semantics id="S2.I1.i4.p1.1.m1.1a"><msub id="S2.I1.i4.p1.1.m1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.cmml"><mtext id="S2.I1.i4.p1.1.m1.1.1.2" xref="S2.I1.i4.p1.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S2.I1.i4.p1.1.m1.1.1.3" xref="S2.I1.i4.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i4.p1.1.m1.1.1.3.2" xref="S2.I1.i4.p1.1.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.I1.i4.p1.1.m1.1.1.3.1" xref="S2.I1.i4.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i4.p1.1.m1.1.1.3.3" xref="S2.I1.i4.p1.1.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.I1.i4.p1.1.m1.1.1.3.1a" xref="S2.I1.i4.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i4.p1.1.m1.1.1.3.4" xref="S2.I1.i4.p1.1.m1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.I1.i4.p1.1.m1.1.1.3.1b" xref="S2.I1.i4.p1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.I1.i4.p1.1.m1.1.1.3.5" xref="S2.I1.i4.p1.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.1.m1.1b"><apply id="S2.I1.i4.p1.1.m1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i4.p1.1.m1.1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i4.p1.1.m1.1.1.2a.cmml" xref="S2.I1.i4.p1.1.m1.1.1.2"><mtext id="S2.I1.i4.p1.1.m1.1.1.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S2.I1.i4.p1.1.m1.1.1.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3"><times id="S2.I1.i4.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.1"></times><ci id="S2.I1.i4.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.2">ğ‘Ÿ</ci><ci id="S2.I1.i4.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.3">ğ‘</ci><ci id="S2.I1.i4.p1.1.m1.1.1.3.4.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.4">ğ‘›</ci><ci id="S2.I1.i4.p1.1.m1.1.1.3.5.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.5">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.1.m1.1c">\mbox{REVERSE}_{rand}</annotation></semantics></math>): Instead of running a relatively costly segmentation such as an entity detector, we experiment with randomly segmenting the sequence into chunks of size between 1 and <math id="S2.I1.i4.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.I1.i4.p1.2.m2.1a"><mi id="S2.I1.i4.p1.2.m2.1.1" xref="S2.I1.i4.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.2.m2.1b"><ci id="S2.I1.i4.p1.2.m2.1.1.cmml" xref="S2.I1.i4.p1.2.m2.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.2.m2.1c">k</annotation></semantics></math> tokens using uniform sampling.
We then reverse the segments, but keep the word order within each segment in their original left-to-right order.
The segments are then joined with a special token â€œ[REV]â€, which indicates the end of left-to-right prediction for the given segment. During training epochs, each time the example is seen we perform a different random segmentation to increase diversity.
See <a href="#S1.T2" title="Table 2 â€£ 1 Introduction â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;2</span></a> (last row) for an example.</p>
</div>
</li>
</ul>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p">Both forward and reversed training samples are shuffled together so that training batches can contain random (unpaired) examples of both types.
In our experiments, we perform reverse training at both the pre-training and finetuning stages, but also ablate these variants to analyze their impact.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p">One can view the extra data <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="\{\reverse{x_{i}}\}" display="inline"><semantics id="S2.p3.1.m1.1a"><mrow id="S2.p3.1.m1.1.1.1" xref="S2.p3.1.m1.1.1.2.cmml"><mo stretchy="false" id="S2.p3.1.m1.1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">{</mo><mrow id="S2.p3.1.m1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.p3.1.m1.1.1.1.1.2" xref="S2.p3.1.m1.1.1.1.1.2b.cmml"><mtext id="S2.p3.1.m1.1.1.1.1.2a" xref="S2.p3.1.m1.1.1.1.1.2b.cmml">\reverse</mtext></merror><mo lspace="0em" rspace="0em" id="S2.p3.1.m1.1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.cmml">â€‹</mo><msub id="S2.p3.1.m1.1.1.1.1.3" xref="S2.p3.1.m1.1.1.1.1.3.cmml"><mi id="S2.p3.1.m1.1.1.1.1.3.2" xref="S2.p3.1.m1.1.1.1.1.3.2.cmml">x</mi><mi id="S2.p3.1.m1.1.1.1.1.3.3" xref="S2.p3.1.m1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S2.p3.1.m1.1.1.1.3" xref="S2.p3.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><set id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.1"><apply id="S2.p3.1.m1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1"><times id="S2.p3.1.m1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1.1"></times><ci id="S2.p3.1.m1.1.1.1.1.2b.cmml" xref="S2.p3.1.m1.1.1.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.p3.1.m1.1.1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.1.1.2"><mtext id="S2.p3.1.m1.1.1.1.1.2a.cmml" xref="S2.p3.1.m1.1.1.1.1.2">\reverse</mtext></merror></ci><apply id="S2.p3.1.m1.1.1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.1.3.1.cmml" xref="S2.p3.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.p3.1.m1.1.1.1.1.3.2.cmml" xref="S2.p3.1.m1.1.1.1.1.3.2">ğ‘¥</ci><ci id="S2.p3.1.m1.1.1.1.1.3.3.cmml" xref="S2.p3.1.m1.1.1.1.1.3.3">ğ‘–</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\{\reverse{x_{i}}\}</annotation></semantics></math>
as another language that the language model has to learn left-to-right â€“ in this case a reversed natural language, which has a similar difficulty in terms of perplexity. As it is easy for the language model to identify which of these languages it is trying to generate from when predicting the next token, this does not tend to interfere with its language modeling abilities in the standard forward direction.
Further, as it has been shown that LLMs can leverage knowledge across different sources (e.g., code to math <cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a href="#bib.bib29" title="" class="ltx_ref">2024</a>)</cite>, or different natural languages <cite class="ltx_cite ltx_citemacro_citep">(Lample &amp; Conneau, <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>) we hypothesize that the knowledge it learns from the reverse direction can help in the forward direction as well.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p">Another perspective of reverse training is from an information theory viewpoint.
The language modeling objective is to learn the probability distribution of natural language, which can be conveniently decomposed into next token predictions for each sample <math id="S2.p4.1.m1.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S2.p4.1.m1.1a"><msub id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mi id="S2.p4.1.m1.1.1.2" xref="S2.p4.1.m1.1.1.2.cmml">x</mi><mi id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.1.cmml" xref="S2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.2">ğ‘¥</ci><ci id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">x_{i}</annotation></semantics></math></p>
<table id="S2.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex2.m1.5" class="ltx_Math" alttext="p(x_{i}^{1},\ldots,x_{i}^{|x_{i}|})=\prod_{t=1}^{|x_{i}|}p(x_{i}^{t}|x_{i}^{1},\ldots,x_{i}^{t-1})." display="block"><semantics id="S2.Ex2.m1.5a"><mrow id="S2.Ex2.m1.5.5.1" xref="S2.Ex2.m1.5.5.1.1.cmml"><mrow id="S2.Ex2.m1.5.5.1.1" xref="S2.Ex2.m1.5.5.1.1.cmml"><mrow id="S2.Ex2.m1.5.5.1.1.2" xref="S2.Ex2.m1.5.5.1.1.2.cmml"><mi id="S2.Ex2.m1.5.5.1.1.2.4" xref="S2.Ex2.m1.5.5.1.1.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.5.5.1.1.2.3" xref="S2.Ex2.m1.5.5.1.1.2.3.cmml">â€‹</mo><mrow id="S2.Ex2.m1.5.5.1.1.2.2.2" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.Ex2.m1.5.5.1.1.2.2.2.3" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml">(</mo><msubsup id="S2.Ex2.m1.5.5.1.1.1.1.1.1" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.3" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml">i</mi><mn id="S2.Ex2.m1.5.5.1.1.1.1.1.1.3" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.Ex2.m1.5.5.1.1.2.2.2.4" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.Ex2.m1.3.3" xref="S2.Ex2.m1.3.3.cmml">â€¦</mi><mo id="S2.Ex2.m1.5.5.1.1.2.2.2.5" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml">,</mo><msubsup id="S2.Ex2.m1.5.5.1.1.2.2.2.2" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.2" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.3" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.3.cmml">i</mi><mrow id="S2.Ex2.m1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.Ex2.m1.1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.2.1.cmml">|</mo><msub id="S2.Ex2.m1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.1.1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex2.m1.1.1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.Ex2.m1.1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup><mo stretchy="false" id="S2.Ex2.m1.5.5.1.1.2.2.2.6" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.Ex2.m1.5.5.1.1.4" xref="S2.Ex2.m1.5.5.1.1.4.cmml">=</mo><mrow id="S2.Ex2.m1.5.5.1.1.3" xref="S2.Ex2.m1.5.5.1.1.3.cmml"><munderover id="S2.Ex2.m1.5.5.1.1.3.2" xref="S2.Ex2.m1.5.5.1.1.3.2.cmml"><mo movablelimits="false" id="S2.Ex2.m1.5.5.1.1.3.2.2.2" xref="S2.Ex2.m1.5.5.1.1.3.2.2.2.cmml">âˆ</mo><mrow id="S2.Ex2.m1.5.5.1.1.3.2.2.3" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.2.2.3.2" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.2.cmml">t</mi><mo id="S2.Ex2.m1.5.5.1.1.3.2.2.3.1" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.1.cmml">=</mo><mn id="S2.Ex2.m1.5.5.1.1.3.2.2.3.3" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.Ex2.m1.2.2.1.1" xref="S2.Ex2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.Ex2.m1.2.2.1.1.2" xref="S2.Ex2.m1.2.2.1.2.1.cmml">|</mo><msub id="S2.Ex2.m1.2.2.1.1.1" xref="S2.Ex2.m1.2.2.1.1.1.cmml"><mi id="S2.Ex2.m1.2.2.1.1.1.2" xref="S2.Ex2.m1.2.2.1.1.1.2.cmml">x</mi><mi id="S2.Ex2.m1.2.2.1.1.1.3" xref="S2.Ex2.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.Ex2.m1.2.2.1.1.3" xref="S2.Ex2.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S2.Ex2.m1.5.5.1.1.3.1" xref="S2.Ex2.m1.5.5.1.1.3.1.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.3" xref="S2.Ex2.m1.5.5.1.1.3.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.5.5.1.1.3.1.2" xref="S2.Ex2.m1.5.5.1.1.3.1.2.cmml">â€‹</mo><mrow id="S2.Ex2.m1.5.5.1.1.3.1.1.1" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml"><msubsup id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.3.cmml">i</mi><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.3.cmml">t</mi></msubsup><mo fence="false" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.3.cmml">|</mo><mrow id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.3.cmml"><msubsup id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3.cmml">i</mi><mn id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.Ex2.m1.4.4" xref="S2.Ex2.m1.4.4.cmml">â€¦</mi><mo id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.4" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.3.cmml">,</mo><msubsup id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.3.cmml">i</mi><mrow id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.1" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.1.cmml">âˆ’</mo><mn id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.Ex2.m1.5.5.1.2" xref="S2.Ex2.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.5b"><apply id="S2.Ex2.m1.5.5.1.1.cmml" xref="S2.Ex2.m1.5.5.1"><eq id="S2.Ex2.m1.5.5.1.1.4.cmml" xref="S2.Ex2.m1.5.5.1.1.4"></eq><apply id="S2.Ex2.m1.5.5.1.1.2.cmml" xref="S2.Ex2.m1.5.5.1.1.2"><times id="S2.Ex2.m1.5.5.1.1.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.2.3"></times><ci id="S2.Ex2.m1.5.5.1.1.2.4.cmml" xref="S2.Ex2.m1.5.5.1.1.2.4">ğ‘</ci><vector id="S2.Ex2.m1.5.5.1.1.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2"><apply id="S2.Ex2.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.2">ğ‘¥</ci><ci id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.3">ğ‘–</ci></apply><cn type="integer" id="S2.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3">â€¦</ci><apply id="S2.Ex2.m1.5.5.1.1.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.2">ğ‘¥</ci><ci id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.3">ğ‘–</ci></apply><apply id="S2.Ex2.m1.1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.1"><abs id="S2.Ex2.m1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.1.1.1.1.2"></abs><apply id="S2.Ex2.m1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.2">ğ‘¥</ci><ci id="S2.Ex2.m1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></vector></apply><apply id="S2.Ex2.m1.5.5.1.1.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3"><apply id="S2.Ex2.m1.5.5.1.1.3.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2">subscript</csymbol><csymbol cd="latexml" id="S2.Ex2.m1.5.5.1.1.3.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2.2.2">product</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3"><eq id="S2.Ex2.m1.5.5.1.1.3.2.2.3.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.1"></eq><ci id="S2.Ex2.m1.5.5.1.1.3.2.2.3.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.2">ğ‘¡</ci><cn type="integer" id="S2.Ex2.m1.5.5.1.1.3.2.2.3.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.3">1</cn></apply></apply><apply id="S2.Ex2.m1.2.2.1.2.cmml" xref="S2.Ex2.m1.2.2.1.1"><abs id="S2.Ex2.m1.2.2.1.2.1.cmml" xref="S2.Ex2.m1.2.2.1.1.2"></abs><apply id="S2.Ex2.m1.2.2.1.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.1.1.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.2.2.1.1.1.2.cmml" xref="S2.Ex2.m1.2.2.1.1.1.2">ğ‘¥</ci><ci id="S2.Ex2.m1.2.2.1.1.1.3.cmml" xref="S2.Ex2.m1.2.2.1.1.1.3">ğ‘–</ci></apply></apply></apply><apply id="S2.Ex2.m1.5.5.1.1.3.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1"><times id="S2.Ex2.m1.5.5.1.1.3.1.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.2"></times><ci id="S2.Ex2.m1.5.5.1.1.3.1.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.3">ğ‘</ci><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1"><csymbol cd="latexml" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.3">conditional</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.2">ğ‘¥</ci><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.3">ğ‘–</ci></apply><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.3">ğ‘¡</ci></apply><list id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2"><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2">ğ‘¥</ci><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3">ğ‘–</ci></apply><cn type="integer" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.Ex2.m1.4.4.cmml" xref="S2.Ex2.m1.4.4">â€¦</ci><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.2">ğ‘¥</ci><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.3">ğ‘–</ci></apply><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3"><minus id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.1"></minus><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.2">ğ‘¡</ci><cn type="integer" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.5c">p(x_{i}^{1},\ldots,x_{i}^{|x_{i}|})=\prod_{t=1}^{|x_{i}|}p(x_{i}^{t}|x_{i}^{1},\ldots,x_{i}^{t-1}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p4.2" class="ltx_p">While this left-to-right direction is more natural, the same probability can be decomposed in the reverse direction as well</p>
<table id="S2.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex3.m1.6" class="ltx_Math" alttext="p(x_{i}^{1},\ldots,x_{i}^{|x_{i}|})=\prod_{t={|x_{i}|}}^{1}p(x_{i}^{t}|x_{i}^{t+1},\ldots,x_{i}^{|x_{i}|})." display="block"><semantics id="S2.Ex3.m1.6a"><mrow id="S2.Ex3.m1.6.6.1" xref="S2.Ex3.m1.6.6.1.1.cmml"><mrow id="S2.Ex3.m1.6.6.1.1" xref="S2.Ex3.m1.6.6.1.1.cmml"><mrow id="S2.Ex3.m1.6.6.1.1.2" xref="S2.Ex3.m1.6.6.1.1.2.cmml"><mi id="S2.Ex3.m1.6.6.1.1.2.4" xref="S2.Ex3.m1.6.6.1.1.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.6.6.1.1.2.3" xref="S2.Ex3.m1.6.6.1.1.2.3.cmml">â€‹</mo><mrow id="S2.Ex3.m1.6.6.1.1.2.2.2" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.Ex3.m1.6.6.1.1.2.2.2.3" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml">(</mo><msubsup id="S2.Ex3.m1.6.6.1.1.1.1.1.1" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.2" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.3" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.3.cmml">i</mi><mn id="S2.Ex3.m1.6.6.1.1.1.1.1.1.3" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.Ex3.m1.6.6.1.1.2.2.2.4" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.Ex3.m1.4.4" xref="S2.Ex3.m1.4.4.cmml">â€¦</mi><mo id="S2.Ex3.m1.6.6.1.1.2.2.2.5" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml">,</mo><msubsup id="S2.Ex3.m1.6.6.1.1.2.2.2.2" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.2" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.3" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.3.cmml">i</mi><mrow id="S2.Ex3.m1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.Ex3.m1.1.1.1.1.2" xref="S2.Ex3.m1.1.1.1.2.1.cmml">|</mo><msub id="S2.Ex3.m1.1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.1.1.1.1.1.2" xref="S2.Ex3.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex3.m1.1.1.1.1.1.3" xref="S2.Ex3.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.Ex3.m1.1.1.1.1.3" xref="S2.Ex3.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup><mo stretchy="false" id="S2.Ex3.m1.6.6.1.1.2.2.2.6" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.Ex3.m1.6.6.1.1.4" xref="S2.Ex3.m1.6.6.1.1.4.cmml">=</mo><mrow id="S2.Ex3.m1.6.6.1.1.3" xref="S2.Ex3.m1.6.6.1.1.3.cmml"><munderover id="S2.Ex3.m1.6.6.1.1.3.2" xref="S2.Ex3.m1.6.6.1.1.3.2.cmml"><mo movablelimits="false" id="S2.Ex3.m1.6.6.1.1.3.2.2.2" xref="S2.Ex3.m1.6.6.1.1.3.2.2.2.cmml">âˆ</mo><mrow id="S2.Ex3.m1.2.2.1" xref="S2.Ex3.m1.2.2.1.cmml"><mi id="S2.Ex3.m1.2.2.1.3" xref="S2.Ex3.m1.2.2.1.3.cmml">t</mi><mo id="S2.Ex3.m1.2.2.1.2" xref="S2.Ex3.m1.2.2.1.2.cmml">=</mo><mrow id="S2.Ex3.m1.2.2.1.1.1" xref="S2.Ex3.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S2.Ex3.m1.2.2.1.1.1.2" xref="S2.Ex3.m1.2.2.1.1.2.1.cmml">|</mo><msub id="S2.Ex3.m1.2.2.1.1.1.1" xref="S2.Ex3.m1.2.2.1.1.1.1.cmml"><mi id="S2.Ex3.m1.2.2.1.1.1.1.2" xref="S2.Ex3.m1.2.2.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex3.m1.2.2.1.1.1.1.3" xref="S2.Ex3.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.Ex3.m1.2.2.1.1.1.3" xref="S2.Ex3.m1.2.2.1.1.2.1.cmml">|</mo></mrow></mrow><mn id="S2.Ex3.m1.6.6.1.1.3.2.3" xref="S2.Ex3.m1.6.6.1.1.3.2.3.cmml">1</mn></munderover><mrow id="S2.Ex3.m1.6.6.1.1.3.1" xref="S2.Ex3.m1.6.6.1.1.3.1.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.3" xref="S2.Ex3.m1.6.6.1.1.3.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.6.6.1.1.3.1.2" xref="S2.Ex3.m1.6.6.1.1.3.1.2.cmml">â€‹</mo><mrow id="S2.Ex3.m1.6.6.1.1.3.1.1.1" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml"><msubsup id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.3.cmml">i</mi><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.3.cmml">t</mi></msubsup><mo fence="false" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.3.cmml">|</mo><mrow id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.3.cmml"><msubsup id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.1" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.Ex3.m1.5.5" xref="S2.Ex3.m1.5.5.cmml">â€¦</mi><mo id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.4" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.3.cmml">,</mo><msubsup id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.3.cmml">i</mi><mrow id="S2.Ex3.m1.3.3.1.1" xref="S2.Ex3.m1.3.3.1.2.cmml"><mo stretchy="false" id="S2.Ex3.m1.3.3.1.1.2" xref="S2.Ex3.m1.3.3.1.2.1.cmml">|</mo><msub id="S2.Ex3.m1.3.3.1.1.1" xref="S2.Ex3.m1.3.3.1.1.1.cmml"><mi id="S2.Ex3.m1.3.3.1.1.1.2" xref="S2.Ex3.m1.3.3.1.1.1.2.cmml">x</mi><mi id="S2.Ex3.m1.3.3.1.1.1.3" xref="S2.Ex3.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.Ex3.m1.3.3.1.1.3" xref="S2.Ex3.m1.3.3.1.2.1.cmml">|</mo></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.Ex3.m1.6.6.1.2" xref="S2.Ex3.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.6b"><apply id="S2.Ex3.m1.6.6.1.1.cmml" xref="S2.Ex3.m1.6.6.1"><eq id="S2.Ex3.m1.6.6.1.1.4.cmml" xref="S2.Ex3.m1.6.6.1.1.4"></eq><apply id="S2.Ex3.m1.6.6.1.1.2.cmml" xref="S2.Ex3.m1.6.6.1.1.2"><times id="S2.Ex3.m1.6.6.1.1.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.2.3"></times><ci id="S2.Ex3.m1.6.6.1.1.2.4.cmml" xref="S2.Ex3.m1.6.6.1.1.2.4">ğ‘</ci><vector id="S2.Ex3.m1.6.6.1.1.2.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2"><apply id="S2.Ex3.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.2">ğ‘¥</ci><ci id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.3">ğ‘–</ci></apply><cn type="integer" id="S2.Ex3.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.Ex3.m1.4.4.cmml" xref="S2.Ex3.m1.4.4">â€¦</ci><apply id="S2.Ex3.m1.6.6.1.1.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.2">ğ‘¥</ci><ci id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.3">ğ‘–</ci></apply><apply id="S2.Ex3.m1.1.1.1.2.cmml" xref="S2.Ex3.m1.1.1.1.1"><abs id="S2.Ex3.m1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.1.1.1.1.2"></abs><apply id="S2.Ex3.m1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.1.1.1.1.1.2">ğ‘¥</ci><ci id="S2.Ex3.m1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></vector></apply><apply id="S2.Ex3.m1.6.6.1.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3"><apply id="S2.Ex3.m1.6.6.1.1.3.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2">subscript</csymbol><csymbol cd="latexml" id="S2.Ex3.m1.6.6.1.1.3.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2.2.2">product</csymbol><apply id="S2.Ex3.m1.2.2.1.cmml" xref="S2.Ex3.m1.2.2.1"><eq id="S2.Ex3.m1.2.2.1.2.cmml" xref="S2.Ex3.m1.2.2.1.2"></eq><ci id="S2.Ex3.m1.2.2.1.3.cmml" xref="S2.Ex3.m1.2.2.1.3">ğ‘¡</ci><apply id="S2.Ex3.m1.2.2.1.1.2.cmml" xref="S2.Ex3.m1.2.2.1.1.1"><abs id="S2.Ex3.m1.2.2.1.1.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.1.2"></abs><apply id="S2.Ex3.m1.2.2.1.1.1.1.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.1.1.1.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.2.2.1.1.1.1.2.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1.2">ğ‘¥</ci><ci id="S2.Ex3.m1.2.2.1.1.1.1.3.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply><cn type="integer" id="S2.Ex3.m1.6.6.1.1.3.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2.3">1</cn></apply><apply id="S2.Ex3.m1.6.6.1.1.3.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1"><times id="S2.Ex3.m1.6.6.1.1.3.1.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.2"></times><ci id="S2.Ex3.m1.6.6.1.1.3.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.3">ğ‘</ci><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1"><csymbol cd="latexml" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.3">conditional</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.2">ğ‘¥</ci><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.3">ğ‘–</ci></apply><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.3">ğ‘¡</ci></apply><list id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2"><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.2">ğ‘¥</ci><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.3">ğ‘–</ci></apply><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3"><plus id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.1"></plus><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.2">ğ‘¡</ci><cn type="integer" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.Ex3.m1.5.5.cmml" xref="S2.Ex3.m1.5.5">â€¦</ci><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.2">ğ‘¥</ci><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.3">ğ‘–</ci></apply><apply id="S2.Ex3.m1.3.3.1.2.cmml" xref="S2.Ex3.m1.3.3.1.1"><abs id="S2.Ex3.m1.3.3.1.2.1.cmml" xref="S2.Ex3.m1.3.3.1.1.2"></abs><apply id="S2.Ex3.m1.3.3.1.1.1.cmml" xref="S2.Ex3.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.3.3.1.1.1.1.cmml" xref="S2.Ex3.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.3.3.1.1.1.2.cmml" xref="S2.Ex3.m1.3.3.1.1.1.2">ğ‘¥</ci><ci id="S2.Ex3.m1.3.3.1.1.1.3.cmml" xref="S2.Ex3.m1.3.3.1.1.1.3">ğ‘–</ci></apply></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.6c">p(x_{i}^{1},\ldots,x_{i}^{|x_{i}|})=\prod_{t={|x_{i}|}}^{1}p(x_{i}^{t}|x_{i}^{t+1},\ldots,x_{i}^{|x_{i}|}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p4.3" class="ltx_p">If we make an assumption that LLMâ€™s language capabilities are partially due to learning to compress natural language <cite class="ltx_cite ltx_citemacro_citep">(Delâ€™etang et&nbsp;al., <a href="#bib.bib10" title="" class="ltx_ref">2023</a>)</cite> according to the source coding theorem <cite class="ltx_cite ltx_citemacro_citep">(Shannon, <a href="#bib.bib28" title="" class="ltx_ref">1948</a>)</cite>, then training in the reverse direction towards the same perplexity should also acquire some of those capabilities.
For example, filling the blank in â€œ<span id="S2.p4.3.1" class="ltx_text ltx_framed ltx_framed_underline">&nbsp;&nbsp;&nbsp;&nbsp;</span> is the capital of France.â€ requires a similar level of language understanding and world knowledge as predicting the next word of â€œParis is the capital of <span id="S2.p4.3.2" class="ltx_text ltx_framed ltx_framed_underline">&nbsp;&nbsp;&nbsp;&nbsp;</span>â€.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Symbolic reverse task</h3>

<figure id="S3.T3" class="ltx_table">
<table id="S3.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.3.1.1" class="ltx_tr">
<th id="S3.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S3.T3.3.1.1.1.1" class="ltx_text ltx_font_bold">Training method</span></th>
<th id="S3.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S3.T3.3.1.1.2.1" class="ltx_text ltx_font_bold">Entity name length</span></th>
</tr>
<tr id="S3.T3.3.2.2" class="ltx_tr">
<th id="S3.T3.3.2.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.3.2.2.1.1" class="ltx_text ltx_font_bold">2 words</span></th>
<th id="S3.T3.3.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.3.2.2.2.1" class="ltx_text ltx_font_bold">3 words</span></th>
<th id="S3.T3.3.2.2.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.3.2.2.3.1" class="ltx_text ltx_font_bold">5 words</span></th>
</tr>
<tr id="S3.T3.3.3.3" class="ltx_tr">
<th id="S3.T3.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">standard</th>
<th id="S3.T3.3.3.3.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">
<span id="S3.T3.3.3.3.2.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>0.0</th>
<th id="S3.T3.3.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">
<span id="S3.T3.3.3.3.3.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">00</span></span>0.0</th>
<th id="S3.T3.3.3.3.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">
<span id="S3.T3.3.3.3.4.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">00</span></span>0</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.3.4.1" class="ltx_tr">
<th id="S3.T3.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse training (<span id="S3.T3.3.4.1.1.1" class="ltx_text ltx_font_italic">word</span>)</th>
<td id="S3.T3.3.4.1.2" class="ltx_td ltx_align_right">95.8</td>
<td id="S3.T3.3.4.1.3" class="ltx_td ltx_align_right">16.9</td>
<td id="S3.T3.3.4.1.4" class="ltx_td ltx_align_right">
<span id="S3.T3.3.4.1.4.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">00</span></span>2.0</td>
</tr>
<tr id="S3.T3.3.5.2" class="ltx_tr">
<th id="S3.T3.3.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse training (<span id="S3.T3.3.5.2.1.1" class="ltx_text ltx_font_italic">entity</span>)</th>
<td id="S3.T3.3.5.2.2" class="ltx_td ltx_align_right">100.0</td>
<td id="S3.T3.3.5.2.3" class="ltx_td ltx_align_right">100.0</td>
<td id="S3.T3.3.5.2.4" class="ltx_td ltx_align_right">100.0</td>
</tr>
<tr id="S3.T3.3.6.3" class="ltx_tr">
<th id="S3.T3.3.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse training (<span id="S3.T3.3.6.3.1.1" class="ltx_text ltx_font_italic">rand k=2</span>)</th>
<td id="S3.T3.3.6.3.2" class="ltx_td ltx_align_right">100.0</td>
<td id="S3.T3.3.6.3.3" class="ltx_td ltx_align_right">98.4</td>
<td id="S3.T3.3.6.3.4" class="ltx_td ltx_align_right">22.7</td>
</tr>
<tr id="S3.T3.3.7.4" class="ltx_tr">
<th id="S3.T3.3.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse training (<span id="S3.T3.3.7.4.1.1" class="ltx_text ltx_font_italic">rand k=3</span>)</th>
<td id="S3.T3.3.7.4.2" class="ltx_td ltx_align_right">100.0</td>
<td id="S3.T3.3.7.4.3" class="ltx_td ltx_align_right">100.0</td>
<td id="S3.T3.3.7.4.4" class="ltx_td ltx_align_right">79.2</td>
</tr>
<tr id="S3.T3.3.8.5" class="ltx_tr">
<th id="S3.T3.3.8.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">reverse training (<span id="S3.T3.3.8.5.1.1" class="ltx_text ltx_font_italic">rand k=5</span>)</th>
<td id="S3.T3.3.8.5.2" class="ltx_td ltx_align_right ltx_border_bb">100.0</td>
<td id="S3.T3.3.8.5.3" class="ltx_td ltx_align_right ltx_border_bb">100.0</td>
<td id="S3.T3.3.8.5.4" class="ltx_td ltx_align_right ltx_border_bb">100.0</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Test accuracy (%) on the <span id="S3.T3.5.1" class="ltx_text ltx_font_italic">symbolic reverse</span> task. Standard training completely fails. Word reversal works well for shorter entities, but entity preserving reversal is necessary for entities with more words.
Random segment reversal performs well when the maximum segment length <math id="S3.T3.2.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.T3.2.m1.1b"><mi id="S3.T3.2.m1.1.1" xref="S3.T3.2.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.T3.2.m1.1c"><ci id="S3.T3.2.m1.1.1.cmml" xref="S3.T3.2.m1.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.m1.1d">k</annotation></semantics></math> is at least as long as the entities.</figcaption>
</figure>
<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.5" class="ltx_p">We first create a simple symbol-based (rather than natural language-based) toy dataset to investigate the reversal curse
in a controlled setting.
We start by randomly pairing entities <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">a</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">ğ‘</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">a_{i}</annotation></semantics></math> and <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="b_{j}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">b</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">ğ‘</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">b_{j}</annotation></semantics></math> in a one-to-one manner.
The training data contains all the forward <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="a_{i}\rightarrow b_{j}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><msub id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p1.3.m3.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">â†’</mo><msub id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">b</mi><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><ci id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1">â†’</ci><apply id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.2">ğ‘</ci><ci id="S3.SS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3">ğ‘–</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">ğ‘</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">ğ‘—</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">a_{i}\rightarrow b_{j}</annotation></semantics></math> mappings, but only half of the backward <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="b_{j}\rightarrow a_{i}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><msub id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.cmml">b</mi><mi id="S3.SS1.p1.4.m4.1.1.2.3" xref="S3.SS1.p1.4.m4.1.1.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">â†’</mo><msub id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">a</mi><mi id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><ci id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1">â†’</ci><apply id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2">ğ‘</ci><ci id="S3.SS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.2.3">ğ‘—</ci></apply><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">ğ‘</ci><ci id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">b_{j}\rightarrow a_{i}</annotation></semantics></math> mappings.
The remaining backward mappings form the test data.
To succeed in this task, a model must infer the rule <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="a_{i}\rightarrow b_{j}\Leftrightarrow b_{j}\rightarrow a_{i}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mrow id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml"><msub id="S3.SS1.p1.5.m5.1.1.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.2.cmml">a</mi><mi id="S3.SS1.p1.5.m5.1.1.2.2.3" xref="S3.SS1.p1.5.m5.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.5.m5.1.1.2.1" xref="S3.SS1.p1.5.m5.1.1.2.1.cmml">â†’</mo><msub id="S3.SS1.p1.5.m5.1.1.2.3" xref="S3.SS1.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.3.2" xref="S3.SS1.p1.5.m5.1.1.2.3.2.cmml">b</mi><mi id="S3.SS1.p1.5.m5.1.1.2.3.3" xref="S3.SS1.p1.5.m5.1.1.2.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">â‡”</mo><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><msub id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2.2" xref="S3.SS1.p1.5.m5.1.1.3.2.2.cmml">b</mi><mi id="S3.SS1.p1.5.m5.1.1.3.2.3" xref="S3.SS1.p1.5.m5.1.1.3.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">â†’</mo><msub id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.3.2" xref="S3.SS1.p1.5.m5.1.1.3.3.2.cmml">a</mi><mi id="S3.SS1.p1.5.m5.1.1.3.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><ci id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1">â‡”</ci><apply id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2"><ci id="S3.SS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.1">â†’</ci><apply id="S3.SS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.2">ğ‘</ci><ci id="S3.SS1.p1.5.m5.1.1.2.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.3">ğ‘–</ci></apply><apply id="S3.SS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.2">ğ‘</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3">ğ‘—</ci></apply></apply><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><ci id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1">â†’</ci><apply id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2.2">ğ‘</ci><ci id="S3.SS1.p1.5.m5.1.1.3.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2.3">ğ‘—</ci></apply><apply id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3.2">ğ‘</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3.3">ğ‘–</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">a_{i}\rightarrow b_{j}\Leftrightarrow b_{j}\rightarrow a_{i}</annotation></semantics></math> from the training data, then generalize it to the pairs in the test data.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.4" class="ltx_p">The entity names are created by combining multiple random code words, e.g. two-word entities <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">a</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">ğ‘</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">a_{i}</annotation></semantics></math> = â€œ<span id="S3.SS1.p2.4.1" class="ltx_text ltx_font_typewriter">a12 a64</span>â€ and <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="b_{j}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">b</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">ğ‘</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">b_{j}</annotation></semantics></math> = â€œ<span id="S3.SS1.p2.4.2" class="ltx_text ltx_font_typewriter">b54 b42</span>â€.
Each sample contains a mapping written like â€œ<span id="S3.SS1.p2.4.3" class="ltx_text ltx_font_typewriter">a12 a64 has a feature b54 b42</span>â€ or its reverse â€œ<span id="S3.SS1.p2.4.4" class="ltx_text ltx_font_typewriter">b54 b42 is a feature of a12 a64</span>â€.
We use the simple word tokenization, which makes <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mbox{REVERSE}_{token}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mtext id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.1.1.3.1" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.1.1.3.1a" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p2.3.m3.1.1.3.4" xref="S3.SS1.p2.3.m3.1.1.3.4.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.1.1.3.1b" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p2.3.m3.1.1.3.5" xref="S3.SS1.p2.3.m3.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.1.1.3.1c" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p2.3.m3.1.1.3.6" xref="S3.SS1.p2.3.m3.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2a.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><mtext id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><times id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.1"></times><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">ğ‘¡</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">ğ‘œ</ci><ci id="S3.SS1.p2.3.m3.1.1.3.4.cmml" xref="S3.SS1.p2.3.m3.1.1.3.4">ğ‘˜</ci><ci id="S3.SS1.p2.3.m3.1.1.3.5.cmml" xref="S3.SS1.p2.3.m3.1.1.3.5">ğ‘’</ci><ci id="S3.SS1.p2.3.m3.1.1.3.6.cmml" xref="S3.SS1.p2.3.m3.1.1.3.6">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mbox{REVERSE}_{token}</annotation></semantics></math> equivalent to <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mbox{REVERSE}_{word}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mtext id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.1.1.3.1" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.1.1.3.1a" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p2.4.m4.1.1.3.4" xref="S3.SS1.p2.4.m4.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.1.1.3.1b" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p2.4.m4.1.1.3.5" xref="S3.SS1.p2.4.m4.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2a.cmml" xref="S3.SS1.p2.4.m4.1.1.2"><mtext id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><times id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.1"></times><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">ğ‘¤</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">ğ‘œ</ci><ci id="S3.SS1.p2.4.m4.1.1.3.4.cmml" xref="S3.SS1.p2.4.m4.1.1.3.4">ğ‘Ÿ</ci><ci id="S3.SS1.p2.4.m4.1.1.3.5.cmml" xref="S3.SS1.p2.4.m4.1.1.3.5">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mbox{REVERSE}_{word}</annotation></semantics></math>.
For evaluations, we report the exact match accuracy of the target entity (2nd entity), averaged over three random seeds. More training details are given in <a href="#A1" title="Appendix A Symbolic reverse task details â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix&nbsp;A</span></a>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.8" class="ltx_p"><a href="#S3.T3" title="Table 3 â€£ 3.1 Symbolic reverse task â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;3</span></a> shows the performance of reverse training on this task for different entity name lengths.
The standard language model training completely fails despite the simplicity of this task, suggesting that it is unlikely to be solved by scaling alone.
In contrast, <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mbox{REVERSE}_{word}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mtext id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1a" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.1.m1.1.1.3.4" xref="S3.SS1.p3.1.m1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1b" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.1.m1.1.1.3.5" xref="S3.SS1.p3.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2a.cmml" xref="S3.SS1.p3.1.m1.1.1.2"><mtext id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><times id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">ğ‘¤</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">ğ‘œ</ci><ci id="S3.SS1.p3.1.m1.1.1.3.4.cmml" xref="S3.SS1.p3.1.m1.1.1.3.4">ğ‘Ÿ</ci><ci id="S3.SS1.p3.1.m1.1.1.3.5.cmml" xref="S3.SS1.p3.1.m1.1.1.3.5">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mbox{REVERSE}_{word}</annotation></semantics></math> training nearly solves it for two-word entities, but its performance degrades quickly as the entities become longer.
A possible explanation is that while <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\mbox{REVERSE}_{word}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mtext id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.2.m2.1.1.3.1" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.2.m2.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.2.m2.1.1.3.1a" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.2.m2.1.1.3.4" xref="S3.SS1.p3.2.m2.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.2.m2.1.1.3.1b" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.2.m2.1.1.3.5" xref="S3.SS1.p3.2.m2.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2a.cmml" xref="S3.SS1.p3.2.m2.1.1.2"><mtext id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><times id="S3.SS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3.1"></times><ci id="S3.SS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2">ğ‘¤</ci><ci id="S3.SS1.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3">ğ‘œ</ci><ci id="S3.SS1.p3.2.m2.1.1.3.4.cmml" xref="S3.SS1.p3.2.m2.1.1.3.4">ğ‘Ÿ</ci><ci id="S3.SS1.p3.2.m2.1.1.3.5.cmml" xref="S3.SS1.p3.2.m2.1.1.3.5">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mbox{REVERSE}_{word}</annotation></semantics></math> does see both mapping <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="a_{i}\rightarrow b_{j}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mrow id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><msub id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2.2" xref="S3.SS1.p3.3.m3.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p3.3.m3.1.1.2.3" xref="S3.SS1.p3.3.m3.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p3.3.m3.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.cmml">â†’</mo><msub id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.2" xref="S3.SS1.p3.3.m3.1.1.3.2.cmml">b</mi><mi id="S3.SS1.p3.3.m3.1.1.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><ci id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1">â†’</ci><apply id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2.2">ğ‘</ci><ci id="S3.SS1.p3.3.m3.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.1.1.2.3">ğ‘–</ci></apply><apply id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.2">ğ‘</ci><ci id="S3.SS1.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3">ğ‘—</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">a_{i}\rightarrow b_{j}</annotation></semantics></math> and its reverse <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="\reverse{b}_{j}\rightarrow\reverse{a}_{i}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mrow id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.4.m4.1.1.2.2" xref="S3.SS1.p3.4.m4.1.1.2.2b.cmml"><mtext id="S3.SS1.p3.4.m4.1.1.2.2a" xref="S3.SS1.p3.4.m4.1.1.2.2b.cmml">\reverse</mtext></merror><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.1.1.2.1" xref="S3.SS1.p3.4.m4.1.1.2.1.cmml">â€‹</mo><msub id="S3.SS1.p3.4.m4.1.1.2.3" xref="S3.SS1.p3.4.m4.1.1.2.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2.3.2" xref="S3.SS1.p3.4.m4.1.1.2.3.2.cmml">b</mi><mi id="S3.SS1.p3.4.m4.1.1.2.3.3" xref="S3.SS1.p3.4.m4.1.1.2.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.SS1.p3.4.m4.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.cmml">â†’</mo><mrow id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.4.m4.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.3.2b.cmml"><mtext id="S3.SS1.p3.4.m4.1.1.3.2a" xref="S3.SS1.p3.4.m4.1.1.3.2b.cmml">\reverse</mtext></merror><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.1.1.3.1" xref="S3.SS1.p3.4.m4.1.1.3.1.cmml">â€‹</mo><msub id="S3.SS1.p3.4.m4.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.3.2" xref="S3.SS1.p3.4.m4.1.1.3.3.2.cmml">a</mi><mi id="S3.SS1.p3.4.m4.1.1.3.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><ci id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1">â†’</ci><apply id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2"><times id="S3.SS1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2.1"></times><ci id="S3.SS1.p3.4.m4.1.1.2.2b.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2"><mtext id="S3.SS1.p3.4.m4.1.1.2.2a.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2">\reverse</mtext></merror></ci><apply id="S3.SS1.p3.4.m4.1.1.2.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.2.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3.2">ğ‘</ci><ci id="S3.SS1.p3.4.m4.1.1.2.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3.3">ğ‘—</ci></apply></apply><apply id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3"><times id="S3.SS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.1"></times><ci id="S3.SS1.p3.4.m4.1.1.3.2b.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2"><mtext id="S3.SS1.p3.4.m4.1.1.3.2a.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2">\reverse</mtext></merror></ci><apply id="S3.SS1.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.2">ğ‘</ci><ci id="S3.SS1.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.3">ğ‘–</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\reverse{b}_{j}\rightarrow\reverse{a}_{i}</annotation></semantics></math>, it struggles with converting between entity <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><msub id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml">a</mi><mi id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2">ğ‘</ci><ci id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">a_{i}</annotation></semantics></math>=â€œ<span id="S3.SS1.p3.8.1" class="ltx_text ltx_font_typewriter">a12 a64 a22</span>â€ and its reverse <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="\reverse{a_{i}}" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mrow id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.6.m6.1.1.2" xref="S3.SS1.p3.6.m6.1.1.2b.cmml"><mtext id="S3.SS1.p3.6.m6.1.1.2a" xref="S3.SS1.p3.6.m6.1.1.2b.cmml">\reverse</mtext></merror><mo lspace="0em" rspace="0em" id="S3.SS1.p3.6.m6.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.cmml">â€‹</mo><msub id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml"><mi id="S3.SS1.p3.6.m6.1.1.3.2" xref="S3.SS1.p3.6.m6.1.1.3.2.cmml">a</mi><mi id="S3.SS1.p3.6.m6.1.1.3.3" xref="S3.SS1.p3.6.m6.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><times id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1"></times><ci id="S3.SS1.p3.6.m6.1.1.2b.cmml" xref="S3.SS1.p3.6.m6.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2"><mtext id="S3.SS1.p3.6.m6.1.1.2a.cmml" xref="S3.SS1.p3.6.m6.1.1.2">\reverse</mtext></merror></ci><apply id="S3.SS1.p3.6.m6.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.3.1.cmml" xref="S3.SS1.p3.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.3.2.cmml" xref="S3.SS1.p3.6.m6.1.1.3.2">ğ‘</ci><ci id="S3.SS1.p3.6.m6.1.1.3.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\reverse{a_{i}}</annotation></semantics></math>=â€œ<span id="S3.SS1.p3.8.2" class="ltx_text ltx_font_typewriter">a22 a64 a12</span>â€ when they have more words.
Matching this reversed entity itself looks similar to the problem in the original reversal curse, which we know is hard to learn.
<math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="\mbox{REVERSE}_{entity}" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><msub id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mtext id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml"><mi id="S3.SS1.p3.7.m7.1.1.3.2" xref="S3.SS1.p3.7.m7.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.7.m7.1.1.3.1" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.7.m7.1.1.3.3" xref="S3.SS1.p3.7.m7.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.7.m7.1.1.3.1a" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.7.m7.1.1.3.4" xref="S3.SS1.p3.7.m7.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.7.m7.1.1.3.1b" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.7.m7.1.1.3.5" xref="S3.SS1.p3.7.m7.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.7.m7.1.1.3.1c" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.7.m7.1.1.3.6" xref="S3.SS1.p3.7.m7.1.1.3.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.7.m7.1.1.3.1d" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p3.7.m7.1.1.3.7" xref="S3.SS1.p3.7.m7.1.1.3.7.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2a.cmml" xref="S3.SS1.p3.7.m7.1.1.2"><mtext id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3"><times id="S3.SS1.p3.7.m7.1.1.3.1.cmml" xref="S3.SS1.p3.7.m7.1.1.3.1"></times><ci id="S3.SS1.p3.7.m7.1.1.3.2.cmml" xref="S3.SS1.p3.7.m7.1.1.3.2">ğ‘’</ci><ci id="S3.SS1.p3.7.m7.1.1.3.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3.3">ğ‘›</ci><ci id="S3.SS1.p3.7.m7.1.1.3.4.cmml" xref="S3.SS1.p3.7.m7.1.1.3.4">ğ‘¡</ci><ci id="S3.SS1.p3.7.m7.1.1.3.5.cmml" xref="S3.SS1.p3.7.m7.1.1.3.5">ğ‘–</ci><ci id="S3.SS1.p3.7.m7.1.1.3.6.cmml" xref="S3.SS1.p3.7.m7.1.1.3.6">ğ‘¡</ci><ci id="S3.SS1.p3.7.m7.1.1.3.7.cmml" xref="S3.SS1.p3.7.m7.1.1.3.7">ğ‘¦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">\mbox{REVERSE}_{entity}</annotation></semantics></math> training eliminates this issue because the word ordering within entity <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><msub id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mi id="S3.SS1.p3.8.m8.1.1.2" xref="S3.SS1.p3.8.m8.1.1.2.cmml">a</mi><mi id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2">ğ‘</ci><ci id="S3.SS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">a_{i}</annotation></semantics></math> remains the same, which explains its perfect accuracy even for 5-word entities.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.3" class="ltx_p"><math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mbox{REVERSE}_{rand}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mtext id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.3.2" xref="S3.SS1.p4.1.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.3.1" xref="S3.SS1.p4.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p4.1.m1.1.1.3.3" xref="S3.SS1.p4.1.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.3.1a" xref="S3.SS1.p4.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p4.1.m1.1.1.3.4" xref="S3.SS1.p4.1.m1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.3.1b" xref="S3.SS1.p4.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS1.p4.1.m1.1.1.3.5" xref="S3.SS1.p4.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2a.cmml" xref="S3.SS1.p4.1.m1.1.1.2"><mtext id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3"><times id="S3.SS1.p4.1.m1.1.1.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.3.1"></times><ci id="S3.SS1.p4.1.m1.1.1.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.3.2">ğ‘Ÿ</ci><ci id="S3.SS1.p4.1.m1.1.1.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3">ğ‘</ci><ci id="S3.SS1.p4.1.m1.1.1.3.4.cmml" xref="S3.SS1.p4.1.m1.1.1.3.4">ğ‘›</ci><ci id="S3.SS1.p4.1.m1.1.1.3.5.cmml" xref="S3.SS1.p4.1.m1.1.1.3.5">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mbox{REVERSE}_{rand}</annotation></semantics></math> can also solve this task, but only when the maximum segment length <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">k</annotation></semantics></math> is long enough.
When <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">k</annotation></semantics></math> is smaller than the entity name length, the entity names will always split across multiple segments, thus the same issue as with word reversal could arise.</p>
</div>
<figure id="S3.T4" class="ltx_table">
<table id="S3.T4.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T4.3.1.1" class="ltx_tr">
<th id="S3.T4.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="S3.T4.3.1.1.1.1" class="ltx_text"><span id="S3.T4.3.1.1.1.1.1" class="ltx_text ltx_font_bold">Pre-training</span><span id="S3.T4.3.1.1.1.1.2" class="ltx_text ltx_font_bold"> method</span></span></th>
<th id="S3.T4.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S3.T4.3.1.1.2.1" class="ltx_text ltx_font_bold">full name recall (%)</span></th>
<th id="S3.T4.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S3.T4.3.1.1.3.1" class="ltx_text ltx_font_bold">last name recall (%)</span></th>
</tr>
<tr id="S3.T4.3.2.2" class="ltx_tr">
<th id="S3.T4.3.2.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T4.3.2.2.1.1" class="ltx_text ltx_font_bold">all</span></th>
<th id="S3.T4.3.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T4.3.2.2.2.1" class="ltx_text ltx_font_bold">f=4</span></th>
<th id="S3.T4.3.2.2.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T4.3.2.2.3.1" class="ltx_text ltx_font_bold">f=3</span></th>
<th id="S3.T4.3.2.2.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T4.3.2.2.4.1" class="ltx_text ltx_font_bold">bdate</span></th>
<th id="S3.T4.3.2.2.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T4.3.2.2.5.1" class="ltx_text ltx_font_bold">all</span></th>
<th id="S3.T4.3.2.2.6" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T4.3.2.2.6.1" class="ltx_text ltx_font_bold">f=4</span></th>
<th id="S3.T4.3.2.2.7" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T4.3.2.2.7.1" class="ltx_text ltx_font_bold">f=3</span></th>
<th id="S3.T4.3.2.2.8" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"><span id="S3.T4.3.2.2.8.1" class="ltx_text ltx_font_bold">bdate</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T4.3.3.1" class="ltx_tr">
<td id="S3.T4.3.3.1.1" class="ltx_td ltx_align_left ltx_border_t"><em id="S3.T4.3.3.1.1.1" class="ltx_emph ltx_font_italic">bioS</em></td>
<td id="S3.T4.3.3.1.2" class="ltx_td ltx_border_t"></td>
<td id="S3.T4.3.3.1.3" class="ltx_td ltx_border_t"></td>
<td id="S3.T4.3.3.1.4" class="ltx_td ltx_border_t"></td>
<td id="S3.T4.3.3.1.5" class="ltx_td ltx_border_t"></td>
<td id="S3.T4.3.3.1.6" class="ltx_td ltx_border_t"></td>
<td id="S3.T4.3.3.1.7" class="ltx_td ltx_border_t"></td>
<td id="S3.T4.3.3.1.8" class="ltx_td ltx_border_t"></td>
<td id="S3.T4.3.3.1.9" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S3.T4.3.4.2" class="ltx_tr">
<td id="S3.T4.3.4.2.1" class="ltx_td ltx_align_left">standard</td>
<td id="S3.T4.3.4.2.2" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.4.2.3" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.4.2.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.4.2.5" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.4.2.6" class="ltx_td ltx_align_right">0.2</td>
<td id="S3.T4.3.4.2.7" class="ltx_td ltx_align_right">0.1</td>
<td id="S3.T4.3.4.2.8" class="ltx_td ltx_align_right">0.2</td>
<td id="S3.T4.3.4.2.9" class="ltx_td ltx_align_right">0.1</td>
</tr>
<tr id="S3.T4.3.5.3" class="ltx_tr">
<td id="S3.T4.3.5.3.1" class="ltx_td ltx_align_left">reverse training (<span id="S3.T4.3.5.3.1.1" class="ltx_text ltx_font_italic">token</span>)</td>
<td id="S3.T4.3.5.3.2" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.5.3.3" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.5.3.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.5.3.5" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.5.3.6" class="ltx_td ltx_align_right">63.7</td>
<td id="S3.T4.3.5.3.7" class="ltx_td ltx_align_right">62.8</td>
<td id="S3.T4.3.5.3.8" class="ltx_td ltx_align_right">48.1</td>
<td id="S3.T4.3.5.3.9" class="ltx_td ltx_align_right"><span id="S3.T4.3.5.3.9.1" class="ltx_text ltx_font_bold">0.2</span></td>
</tr>
<tr id="S3.T4.3.6.4" class="ltx_tr">
<td id="S3.T4.3.6.4.1" class="ltx_td ltx_align_left">reverse training (<span id="S3.T4.3.6.4.1.1" class="ltx_text ltx_font_italic">word</span>)</td>
<td id="S3.T4.3.6.4.2" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.6.4.3" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.6.4.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.6.4.5" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.6.4.6" class="ltx_td ltx_align_right"><span id="S3.T4.3.6.4.6.1" class="ltx_text ltx_font_bold">99.3</span></td>
<td id="S3.T4.3.6.4.7" class="ltx_td ltx_align_right"><span id="S3.T4.3.6.4.7.1" class="ltx_text ltx_font_bold">99.0</span></td>
<td id="S3.T4.3.6.4.8" class="ltx_td ltx_align_right"><span id="S3.T4.3.6.4.8.1" class="ltx_text ltx_font_bold">91.1</span></td>
<td id="S3.T4.3.6.4.9" class="ltx_td ltx_align_right">0.1</td>
</tr>
<tr id="S3.T4.3.7.5" class="ltx_tr">
<td id="S3.T4.3.7.5.1" class="ltx_td ltx_align_left">reverse training (<span id="S3.T4.3.7.5.1.1" class="ltx_text ltx_font_italic">entity</span>)</td>
<td id="S3.T4.3.7.5.2" class="ltx_td ltx_align_right"><span id="S3.T4.3.7.5.2.1" class="ltx_text ltx_font_bold">99.0</span></td>
<td id="S3.T4.3.7.5.3" class="ltx_td ltx_align_right"><span id="S3.T4.3.7.5.3.1" class="ltx_text ltx_font_bold">98.8</span></td>
<td id="S3.T4.3.7.5.4" class="ltx_td ltx_align_right"><span id="S3.T4.3.7.5.4.1" class="ltx_text ltx_font_bold">87.8</span></td>
<td id="S3.T4.3.7.5.5" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.7.5.6" class="ltx_td ltx_align_right">0.3</td>
<td id="S3.T4.3.7.5.7" class="ltx_td ltx_align_right">0.3</td>
<td id="S3.T4.3.7.5.8" class="ltx_td ltx_align_right">0.3</td>
<td id="S3.T4.3.7.5.9" class="ltx_td ltx_align_right"><span id="S3.T4.3.7.5.9.1" class="ltx_text ltx_font_bold">0.2</span></td>
</tr>
<tr id="S3.T4.3.8.6" class="ltx_tr">
<td id="S3.T4.3.8.6.1" class="ltx_td ltx_align_left"><em id="S3.T4.3.8.6.1.1" class="ltx_emph ltx_font_italic">bioR</em></td>
<td id="S3.T4.3.8.6.2" class="ltx_td"></td>
<td id="S3.T4.3.8.6.3" class="ltx_td"></td>
<td id="S3.T4.3.8.6.4" class="ltx_td"></td>
<td id="S3.T4.3.8.6.5" class="ltx_td"></td>
<td id="S3.T4.3.8.6.6" class="ltx_td"></td>
<td id="S3.T4.3.8.6.7" class="ltx_td"></td>
<td id="S3.T4.3.8.6.8" class="ltx_td"></td>
<td id="S3.T4.3.8.6.9" class="ltx_td"></td>
</tr>
<tr id="S3.T4.3.9.7" class="ltx_tr">
<td id="S3.T4.3.9.7.1" class="ltx_td ltx_align_left">standard</td>
<td id="S3.T4.3.9.7.2" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.9.7.3" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.9.7.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.9.7.5" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.9.7.6" class="ltx_td ltx_align_right">0.2</td>
<td id="S3.T4.3.9.7.7" class="ltx_td ltx_align_right">0.2</td>
<td id="S3.T4.3.9.7.8" class="ltx_td ltx_align_right">0.2</td>
<td id="S3.T4.3.9.7.9" class="ltx_td ltx_align_right"><span id="S3.T4.3.9.7.9.1" class="ltx_text ltx_font_bold">0.2</span></td>
</tr>
<tr id="S3.T4.3.10.8" class="ltx_tr">
<td id="S3.T4.3.10.8.1" class="ltx_td ltx_align_left">reverse training (<span id="S3.T4.3.10.8.1.1" class="ltx_text ltx_font_italic">token</span>)</td>
<td id="S3.T4.3.10.8.2" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.10.8.3" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.10.8.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.10.8.5" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T4.3.10.8.6" class="ltx_td ltx_align_right">61.5</td>
<td id="S3.T4.3.10.8.7" class="ltx_td ltx_align_right">58.2</td>
<td id="S3.T4.3.10.8.8" class="ltx_td ltx_align_right">53.3</td>
<td id="S3.T4.3.10.8.9" class="ltx_td ltx_align_right"><span id="S3.T4.3.10.8.9.1" class="ltx_text ltx_font_bold">0.2</span></td>
</tr>
<tr id="S3.T4.3.11.9" class="ltx_tr">
<td id="S3.T4.3.11.9.1" class="ltx_td ltx_align_left">reverse training (<span id="S3.T4.3.11.9.1.1" class="ltx_text ltx_font_italic">word</span>)</td>
<td id="S3.T4.3.11.9.2" class="ltx_td ltx_align_right">0.2</td>
<td id="S3.T4.3.11.9.3" class="ltx_td ltx_align_right">0.1</td>
<td id="S3.T4.3.11.9.4" class="ltx_td ltx_align_right">0.1</td>
<td id="S3.T4.3.11.9.5" class="ltx_td ltx_align_right">0.1</td>
<td id="S3.T4.3.11.9.6" class="ltx_td ltx_align_right"><span id="S3.T4.3.11.9.6.1" class="ltx_text ltx_font_bold">99.2</span></td>
<td id="S3.T4.3.11.9.7" class="ltx_td ltx_align_right"><span id="S3.T4.3.11.9.7.1" class="ltx_text ltx_font_bold">98.5</span></td>
<td id="S3.T4.3.11.9.8" class="ltx_td ltx_align_right"><span id="S3.T4.3.11.9.8.1" class="ltx_text ltx_font_bold">94.9</span></td>
<td id="S3.T4.3.11.9.9" class="ltx_td ltx_align_right"><span id="S3.T4.3.11.9.9.1" class="ltx_text ltx_font_bold">0.2</span></td>
</tr>
<tr id="S3.T4.3.12.10" class="ltx_tr">
<td id="S3.T4.3.12.10.1" class="ltx_td ltx_align_left ltx_border_bb">reverse training (<span id="S3.T4.3.12.10.1.1" class="ltx_text ltx_font_italic">entity</span>)</td>
<td id="S3.T4.3.12.10.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T4.3.12.10.2.1" class="ltx_text ltx_font_bold">98.2</span></td>
<td id="S3.T4.3.12.10.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T4.3.12.10.3.1" class="ltx_text ltx_font_bold">94.6</span></td>
<td id="S3.T4.3.12.10.4" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T4.3.12.10.4.1" class="ltx_text ltx_font_bold">86.7</span></td>
<td id="S3.T4.3.12.10.5" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T4.3.12.10.5.1" class="ltx_text ltx_font_bold">0.1</span></td>
<td id="S3.T4.3.12.10.6" class="ltx_td ltx_align_right ltx_border_bb">0.4</td>
<td id="S3.T4.3.12.10.7" class="ltx_td ltx_align_right ltx_border_bb">0.4</td>
<td id="S3.T4.3.12.10.8" class="ltx_td ltx_align_right ltx_border_bb">0.4</td>
<td id="S3.T4.3.12.10.9" class="ltx_td ltx_align_right ltx_border_bb">0.1</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Evaluation results on the <span id="S3.T4.7.1" class="ltx_text ltx_font_italic">reversing biography</span> tasks in the mixed-training setup (see Footnote&nbsp;<a href="#footnote4" title="Footnote 4 â€£ 3.2 Reversing Biography Task â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, pre-train+FT is deferred to Appendix&nbsp;<a href="#A3" title="Appendix C Biography Data Experiment Details â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>). We report accuracy on the reversal tasks of recovering the personâ€™s full (or last) name given bio fields, using biographies that were either generated using a pool of sentence templates (the <em id="S3.T4.8.2" class="ltx_emph ltx_font_italic">bioS</em> dataset) or generated using the Llama model (the <em id="S3.T4.9.3" class="ltx_emph ltx_font_italic">bioR</em> dataset). We consider when all 6 or f<math id="S3.T4.2.m1.2" class="ltx_Math" alttext="={3,4}" display="inline"><semantics id="S3.T4.2.m1.2b"><mrow id="S3.T4.2.m1.2.3" xref="S3.T4.2.m1.2.3.cmml"><mi id="S3.T4.2.m1.2.3.2" xref="S3.T4.2.m1.2.3.2.cmml"></mi><mo id="S3.T4.2.m1.2.3.1" xref="S3.T4.2.m1.2.3.1.cmml">=</mo><mrow id="S3.T4.2.m1.2.3.3.2" xref="S3.T4.2.m1.2.3.3.1.cmml"><mn id="S3.T4.2.m1.1.1" xref="S3.T4.2.m1.1.1.cmml">3</mn><mo id="S3.T4.2.m1.2.3.3.2.1" xref="S3.T4.2.m1.2.3.3.1.cmml">,</mo><mn id="S3.T4.2.m1.2.2" xref="S3.T4.2.m1.2.2.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T4.2.m1.2c"><apply id="S3.T4.2.m1.2.3.cmml" xref="S3.T4.2.m1.2.3"><eq id="S3.T4.2.m1.2.3.1.cmml" xref="S3.T4.2.m1.2.3.1"></eq><csymbol cd="latexml" id="S3.T4.2.m1.2.3.2.cmml" xref="S3.T4.2.m1.2.3.2">absent</csymbol><list id="S3.T4.2.m1.2.3.3.1.cmml" xref="S3.T4.2.m1.2.3.3.2"><cn type="integer" id="S3.T4.2.m1.1.1.cmml" xref="S3.T4.2.m1.1.1">3</cn><cn type="integer" id="S3.T4.2.m1.2.2.cmml" xref="S3.T4.2.m1.2.2">4</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.2.m1.2d">={3,4}</annotation></semantics></math> selected bio fields are given, as well as when only birthdates are given.
</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Reversing Biography Task</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.2" class="ltx_p">When the reversal curse was discovered in <cite class="ltx_cite ltx_citemacro_cite">Allen-Zhu &amp; Li (<a href="#bib.bib2" title="" class="ltx_ref">2023b</a>)</cite>, the authors utilized a biography dataset of 100K randomly generated individuals with unique English names. The biographies were either generated using a pool of sentence templates (the <span id="S3.SS2.p1.2.1" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioS</span> dataset) or generated using the Llama model (the <span id="S3.SS2.p1.2.2" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioR</span> dataset)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a href="#bib.bib32" title="" class="ltx_ref">2023a</a>)</cite>.
The biography entries always start with the personâ€™s full name.<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>They consider two types of training, pre-train + finetune (FT) in which they pre-train the model with biography entries and then finetune with QA tasks; mixed-training in which they train the model once with both the biography entries and the QA tasks (not in the same context). They always use half of the individualsâ€™ QA tasks for training and evaluate the QA accuracies on the remaining half. </span></span></span>
The reversal QA task is, therefore, very natural: given a personâ€™s partial or full biography details, ask for the personâ€™s name.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.1" class="ltx_p">We conducted the same experiment in their setting, with respect to token, word, and entity-preserving reversals. Our main findings can be summarized as follows (see <a href="#S3.T4" title="Table 4 â€£ 3.1 Symbolic reverse task â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;4</span></a>, and <a href="#A3" title="Appendix C Biography Data Experiment Details â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix&nbsp;C</span></a> <a href="#A3.T10" title="Table 10 â€£ Forward QA tasks. â€£ Appendix C Biography Data Experiment Details â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;10</span></a>):</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S3.I1.i1.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i1.p1.1" class="ltx_p">For the reversal tasks of determining the personâ€™s full name, only in the entity-preserving reversal case do accuracies become non-trivial. Both token/word reversals completely fail in such tasks.</p>
<ul id="S3.I1.i1.I1" class="ltx_itemize">
<li id="S3.I1.i1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S3.I1.i1.I1.i1.1.1.1" class="ltx_text ltx_font_bold">â€“</span></span> 
<div id="S3.I1.i1.I1.i1.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i1.I1.i1.p1.1" class="ltx_p">When determining a personâ€™s full name given only the birth date, the reversal task accuracy remains near zero; this is because dates are treated as three entities in our adopted entity detection method, so their ordering is <em id="S3.I1.i1.I1.i1.p1.1.1" class="ltx_emph ltx_font_italic">not preserved</em> in the reversal.</p>
</div>
</li>
</ul>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S3.I1.i2.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i2.p1.1" class="ltx_p">If the reversal tasks are simplified to determining the personâ€™s <em id="S3.I1.i2.p1.1.1" class="ltx_emph ltx_font_italic">last name only</em>, then word-level reversal suffices, and token-level reversal also yields non-trivial accuracies.</p>
</div>
<div id="S3.I1.i2.p2" class="ltx_para">
<ul id="S3.I1.i2.I1" class="ltx_itemize">
<li id="S3.I1.i2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span id="S3.I1.i2.I1.i1.1.1.1" class="ltx_text ltx_font_bold">â€“</span></span> 
<div id="S3.I1.i2.I1.i1.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i2.I1.i1.p1.1" class="ltx_p">Some readers may find it surprising that an entity-preserving method can determine the personâ€™s full name but not the personâ€™s last name. This is a known phenomenon&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu &amp; Li, <a href="#bib.bib2" title="" class="ltx_ref">2023b</a>)</cite>: a language model may completely fail at retrieving <em id="S3.I1.i2.I1.i1.p1.1.1" class="ltx_emph ltx_font_italic">later</em> tokens of a knowledge piece (such as the last name) without the help of spelling out earlier tokens â€” they can be viewed as a Chain of Thought (CoT).</p>
</div>
</li>
</ul>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S3.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i3.p1.1" class="ltx_p">Entity-preserving reversals do not impair the modelâ€™s performance in forward tasks (such as determining the personâ€™s birth dates from names) as shown in <a href="#A3.T10" title="Table 10 â€£ Forward QA tasks. â€£ Appendix C Biography Data Experiment Details â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;10</span></a>.</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="S3.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i4.p1.1" class="ltx_p">Mixed-training (i.e., adding instruction tuning data to the pre-training level) generally performs better compared to first pre-training the model with knowledge and then fine-tuning it to answer (reversal) tasks. This was also observed in <cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu &amp; Li, <a href="#bib.bib1" title="" class="ltx_ref">2023a</a>)</cite> but for forward knowledge tasks.</p>
</div>
</li>
</ul>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p">More details of this experiment are included in <a href="#A3" title="Appendix C Biography Data Experiment Details â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix&nbsp;C</span></a>.</p>
</div>
<figure id="S3.T5" class="ltx_table">
<table id="S3.T5.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T5.2.2" class="ltx_tr">
<th id="S3.T5.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="S3.T5.2.2.3.1" class="ltx_text"><span id="S3.T5.2.2.3.1.1" class="ltx_text ltx_font_bold">Pre-training</span><span id="S3.T5.2.2.3.1.2" class="ltx_text ltx_font_bold"> method</span></span></th>
<th id="S3.T5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S3.T5.1.1.1.1" class="ltx_text ltx_font_bold">celebrity <math id="S3.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S3.T5.1.1.1.1.m1.1a"><mo stretchy="false" id="S3.T5.1.1.1.1.m1.1.1" xref="S3.T5.1.1.1.1.m1.1.1.cmml">â†’</mo><annotation-xml encoding="MathML-Content" id="S3.T5.1.1.1.1.m1.1b"><ci id="S3.T5.1.1.1.1.m1.1.1.cmml" xref="S3.T5.1.1.1.1.m1.1.1">â†’</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.1.1.1.1.m1.1c">\rightarrow</annotation></semantics></math> parent</span></th>
<th id="S3.T5.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S3.T5.2.2.2.1" class="ltx_text ltx_font_bold">parent <math id="S3.T5.2.2.2.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S3.T5.2.2.2.1.m1.1a"><mo stretchy="false" id="S3.T5.2.2.2.1.m1.1.1" xref="S3.T5.2.2.2.1.m1.1.1.cmml">â†’</mo><annotation-xml encoding="MathML-Content" id="S3.T5.2.2.2.1.m1.1b"><ci id="S3.T5.2.2.2.1.m1.1.1.cmml" xref="S3.T5.2.2.2.1.m1.1.1">â†’</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.2.2.2.1.m1.1c">\rightarrow</annotation></semantics></math> celebrity</span></th>
</tr>
<tr id="S3.T5.3.4.1" class="ltx_tr">
<th id="S3.T5.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">best@1</th>
<th id="S3.T5.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">@5</th>
<th id="S3.T5.3.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">@10</th>
<th id="S3.T5.3.4.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">best@1</th>
<th id="S3.T5.3.4.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">@5</th>
<th id="S3.T5.3.4.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T5.3.5.1" class="ltx_tr">
<td id="S3.T5.3.5.1.1" class="ltx_td ltx_align_left ltx_border_t"><em id="S3.T5.3.5.1.1.1" class="ltx_emph ltx_font_italic">Model size: 1.4B</em></td>
<td id="S3.T5.3.5.1.2" class="ltx_td ltx_border_t"></td>
<td id="S3.T5.3.5.1.3" class="ltx_td ltx_border_t"></td>
<td id="S3.T5.3.5.1.4" class="ltx_td ltx_border_t"></td>
<td id="S3.T5.3.5.1.5" class="ltx_td ltx_border_t"></td>
<td id="S3.T5.3.5.1.6" class="ltx_td ltx_border_t"></td>
<td id="S3.T5.3.5.1.7" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S3.T5.3.6.2" class="ltx_tr">
<td id="S3.T5.3.6.2.1" class="ltx_td ltx_align_left">standard (compute-matched)</td>
<td id="S3.T5.3.6.2.2" class="ltx_td ltx_align_center"><span id="S3.T5.3.6.2.2.1" class="ltx_text ltx_font_bold">1.6</span></td>
<td id="S3.T5.3.6.2.3" class="ltx_td ltx_align_center"><span id="S3.T5.3.6.2.3.1" class="ltx_text ltx_font_bold">2.9</span></td>
<td id="S3.T5.3.6.2.4" class="ltx_td ltx_align_center"><span id="S3.T5.3.6.2.4.1" class="ltx_text ltx_font_bold">3.9</span></td>
<td id="S3.T5.3.6.2.5" class="ltx_td ltx_align_center">0.9</td>
<td id="S3.T5.3.6.2.6" class="ltx_td ltx_align_center">2.9</td>
<td id="S3.T5.3.6.2.7" class="ltx_td ltx_align_center">3.9</td>
</tr>
<tr id="S3.T5.3.7.3" class="ltx_tr">
<td id="S3.T5.3.7.3.1" class="ltx_td ltx_align_left">standard (data-matched)</td>
<td id="S3.T5.3.7.3.2" class="ltx_td ltx_align_center">0.4</td>
<td id="S3.T5.3.7.3.3" class="ltx_td ltx_align_center">1.7</td>
<td id="S3.T5.3.7.3.4" class="ltx_td ltx_align_center">2.7</td>
<td id="S3.T5.3.7.3.5" class="ltx_td ltx_align_center">0.8</td>
<td id="S3.T5.3.7.3.6" class="ltx_td ltx_align_center">1.8</td>
<td id="S3.T5.3.7.3.7" class="ltx_td ltx_align_center">3.2</td>
</tr>
<tr id="S3.T5.3.8.4" class="ltx_tr">
<td id="S3.T5.3.8.4.1" class="ltx_td ltx_align_left">reverse training (<span id="S3.T5.3.8.4.1.1" class="ltx_text ltx_font_italic">token</span>)</td>
<td id="S3.T5.3.8.4.2" class="ltx_td ltx_align_center">0.8</td>
<td id="S3.T5.3.8.4.3" class="ltx_td ltx_align_center">2.5</td>
<td id="S3.T5.3.8.4.4" class="ltx_td ltx_align_center">3.8</td>
<td id="S3.T5.3.8.4.5" class="ltx_td ltx_align_center">0.6</td>
<td id="S3.T5.3.8.4.6" class="ltx_td ltx_align_center">2.5</td>
<td id="S3.T5.3.8.4.7" class="ltx_td ltx_align_center">3.9</td>
</tr>
<tr id="S3.T5.3.3" class="ltx_tr">
<td id="S3.T5.3.3.1" class="ltx_td ltx_align_left ltx_border_bb">reverse training (<span id="S3.T5.3.3.1.1" class="ltx_text ltx_font_italic">entity<sup id="S3.T5.3.3.1.1.1" class="ltx_sup"><span id="S3.T5.3.3.1.1.1.1" class="ltx_text ltx_font_upright">âˆ—</span></sup></span>)</td>
<td id="S3.T5.3.3.2" class="ltx_td ltx_align_center ltx_border_bb">0.8</td>
<td id="S3.T5.3.3.3" class="ltx_td ltx_align_center ltx_border_bb">2.6</td>
<td id="S3.T5.3.3.4" class="ltx_td ltx_align_center ltx_border_bb">3.8</td>
<td id="S3.T5.3.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T5.3.3.5.1" class="ltx_text ltx_font_bold">3.6</span></td>
<td id="S3.T5.3.3.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T5.3.3.6.1" class="ltx_text ltx_font_bold">8.1</span></td>
<td id="S3.T5.3.3.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T5.3.3.7.1" class="ltx_text ltx_font_bold">10.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Evaluation results on the <span id="S3.T5.7.2" class="ltx_text ltx_font_italic">real-world celebrity</span> task when using different pre-training methods to train LLMs, with no finetuning.
Results are reported as best accuracy when sampling multiple times.
Reverse (<span id="S3.T5.5.1" class="ltx_text ltx_font_italic">entity<sup id="S3.T5.5.1.1" class="ltx_sup"><span id="S3.T5.5.1.1.1" class="ltx_text ltx_font_upright">âˆ—</span></sup></span>) pre-training (5% of the reversed data being entity-preserving reversal, and the rest word-reversal) significantly improves the more challenging parent to celebrity direction. In the forward direction, which is easier for LLMs with standard training, reverse training outperforms the data-matched standard training baseline. </figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Reversing real-world knowledge via pre-training</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.1" class="ltx_p">Next we test our method on a realistic setup where we
pre-train language models, and evaluate their ability on â€œforwardâ€ and â€œreverseâ€ facts about real-world knowledge.
As LLMs acquire the majority of their world knowledge during their pre-training stage, it makes sense to evaluate our reverse training in this pre-training setup. To make the experiments tractable,
we train a Llama-2 1.4 billion parameter model&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2023b</a>)</cite>.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.1" class="ltx_p">We train the baseline model on 2 trillion tokens in the left-to-right direction.
Reverse training uses only half of these tokens (1 trillion), but trains in both the standard left-to-right direction, and in the right-to-left (reverse) direction with this same subset of the data.
Hence it does model updates over 2 trillion tokens in total, i.e. 1 trillion tokens in each direction is passed through the model.
We call this setup <em id="S3.SS3.p2.1.1" class="ltx_emph ltx_font_italic">compute-matched</em> because both models processed the same amount of tokens in total and used the same compute resources.
We also compare against a <em id="S3.SS3.p2.1.2" class="ltx_emph ltx_font_italic">data-matched</em> baseline that is trained on 1 trillion tokens in the standard left-to-right direction. This model has been trained with half as many updates, but has seen the same data examples as the reverse trained model, but only in one direction.
For reverse training, we employ entity-preserving reversal for 5% of the pre-train data, and the remainder uses word-reversal, mainly due to the extra computational cost of the entity reversal procedure, which we refer to as â€œentity<sup id="S3.SS3.p2.1.3" class="ltx_sup"><span id="S3.SS3.p2.1.3.1" class="ltx_text ltx_font_italic">âˆ—</span></sup>â€ in our results. We also test other reversal mechanisms in our ablation experiments.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.1" class="ltx_p">To test the reversal capability on real-world facts we use a celebrity task, which contains questions like
â€œThe mother of [celebrity_name] is <span id="S3.SS3.p3.1.1" class="ltx_text ltx_framed ltx_framed_underline">&nbsp;&nbsp;&nbsp;&nbsp;</span>â€ that are known to be challenging to large scale LLMs.
It also contains even more challenging reverse questions such as â€œThe child of [parent_of_celebrity] is <span id="S3.SS3.p3.1.2" class="ltx_text ltx_framed ltx_framed_underline">&nbsp;&nbsp;&nbsp;&nbsp;</span>â€.
We perform two-shot evaluation using our pre-trained models without any finetuning on this dataset.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.1" class="ltx_p">The results are shown in <a href="#S3.T5" title="Table 5 â€£ 3.2 Reversing Biography Task â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;5</span></a>.
We sample multiple times from the models for each question and if any one of them contains the correct answer, then it is counted as success.
The accuracy is relatively low in general due to the small model size in terms of number of parameters, limited pre-training and lack of any finetuning for both baselines and our method. Nevertheless,
in the forward direction questions, the reverse training outperforms the data-matched baseline, showing that in the data-bound case, reverse training even helps on standard tasks. In the compute-matched case, where the baseline has effectively access to more data, reversal training lags slightly behind for 5, 10 samples.
Importantly, in both the data-matched and compute-matched case
we see significant improvement in the reverse direction questions for reverse training compared to either baseline.
This demonstrates that reverse training can be employed during the pre-training stage to make the model robust against the reversal curse.</p>
</div>
<figure id="S3.T6" class="ltx_table">
<div id="S3.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:263pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.3pt,-5.0pt) scale(1.03985458139165,1.03985458139165) ;">
<table id="S3.T6.1.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T6.1.1.2.1" class="ltx_tr">
<td id="S3.T6.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_tt" rowspan="2"><span id="S3.T6.1.1.2.1.1.1" class="ltx_text"><span id="S3.T6.1.1.2.1.1.1.1" class="ltx_text ltx_font_bold">Pre-training</span><span id="S3.T6.1.1.2.1.1.1.2" class="ltx_text ltx_font_bold"> method</span></span></td>
<td id="S3.T6.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_tt" rowspan="2"><span id="S3.T6.1.1.2.1.2.1" class="ltx_text ltx_font_bold">Finetuning method</span></td>
<td id="S3.T6.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S3.T6.1.1.2.1.3.1" class="ltx_text ltx_font_bold">NameToDescription</span></td>
<td id="S3.T6.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S3.T6.1.1.2.1.4.1" class="ltx_text ltx_font_bold">DescriptionToName</span></td>
</tr>
<tr id="S3.T6.1.1.3.2" class="ltx_tr">
<td id="S3.T6.1.1.3.2.1" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T6.1.1.3.2.1.1" class="ltx_text ltx_font_bold">forward</span></td>
<td id="S3.T6.1.1.3.2.2" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T6.1.1.3.2.2.1" class="ltx_text ltx_font_bold">reverse</span></td>
<td id="S3.T6.1.1.3.2.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T6.1.1.3.2.3.1" class="ltx_text ltx_font_bold">forward</span></td>
<td id="S3.T6.1.1.3.2.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T6.1.1.3.2.4.1" class="ltx_text ltx_font_bold">reverse</span></td>
</tr>
<tr id="S3.T6.1.1.4.3" class="ltx_tr">
<td id="S3.T6.1.1.4.3.1" class="ltx_td ltx_align_left ltx_border_t"><em id="S3.T6.1.1.4.3.1.1" class="ltx_emph ltx_font_italic">Model size: 1.4B</em></td>
<td id="S3.T6.1.1.4.3.2" class="ltx_td ltx_border_t"></td>
<td id="S3.T6.1.1.4.3.3" class="ltx_td ltx_border_t"></td>
<td id="S3.T6.1.1.4.3.4" class="ltx_td ltx_border_t"></td>
<td id="S3.T6.1.1.4.3.5" class="ltx_td ltx_border_t"></td>
<td id="S3.T6.1.1.4.3.6" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S3.T6.1.1.5.4" class="ltx_tr">
<td id="S3.T6.1.1.5.4.1" class="ltx_td ltx_align_left">standard (compute-matched)</td>
<td id="S3.T6.1.1.5.4.2" class="ltx_td ltx_align_left">standard</td>
<td id="S3.T6.1.1.5.4.3" class="ltx_td ltx_align_right">77.3</td>
<td id="S3.T6.1.1.5.4.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T6.1.1.5.4.5" class="ltx_td ltx_align_right">98.3</td>
<td id="S3.T6.1.1.5.4.6" class="ltx_td ltx_align_right">2.3</td>
</tr>
<tr id="S3.T6.1.1.6.5" class="ltx_tr">
<td id="S3.T6.1.1.6.5.1" class="ltx_td ltx_align_left">standard (compute-matched)</td>
<td id="S3.T6.1.1.6.5.2" class="ltx_td ltx_align_left">reverse (<span id="S3.T6.1.1.6.5.2.1" class="ltx_text ltx_font_italic">entity</span>)</td>
<td id="S3.T6.1.1.6.5.3" class="ltx_td ltx_align_right"><span id="S3.T6.1.1.6.5.3.1" class="ltx_text ltx_font_bold">78.3</span></td>
<td id="S3.T6.1.1.6.5.4" class="ltx_td ltx_align_right">85.0</td>
<td id="S3.T6.1.1.6.5.5" class="ltx_td ltx_align_right">99.0</td>
<td id="S3.T6.1.1.6.5.6" class="ltx_td ltx_align_right">5.7</td>
</tr>
<tr id="S3.T6.1.1.7.6" class="ltx_tr">
<td id="S3.T6.1.1.7.6.1" class="ltx_td ltx_align_left">
standard (compute-matched)</td>
<td id="S3.T6.1.1.7.6.2" class="ltx_td ltx_align_left">reverse (<span id="S3.T6.1.1.7.6.2.1" class="ltx_text ltx_font_italic">rand k=25</span>)</td>
<td id="S3.T6.1.1.7.6.3" class="ltx_td ltx_align_right">77.3</td>
<td id="S3.T6.1.1.7.6.4" class="ltx_td ltx_align_right"><span id="S3.T6.1.1.7.6.4.1" class="ltx_text ltx_font_bold">96.3</span></td>
<td id="S3.T6.1.1.7.6.5" class="ltx_td ltx_align_right">97.7</td>
<td id="S3.T6.1.1.7.6.6" class="ltx_td ltx_align_right"><span id="S3.T6.1.1.7.6.6.1" class="ltx_text ltx_font_bold">70.7</span></td>
</tr>
<tr id="S3.T6.1.1.8.7" class="ltx_tr">
<td id="S3.T6.1.1.8.7.1" class="ltx_td ltx_align_left">standard (data-matched)</td>
<td id="S3.T6.1.1.8.7.2" class="ltx_td ltx_align_left">standard</td>
<td id="S3.T6.1.1.8.7.3" class="ltx_td ltx_align_right">75.0</td>
<td id="S3.T6.1.1.8.7.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T6.1.1.8.7.5" class="ltx_td ltx_align_right"><span id="S3.T6.1.1.8.7.5.1" class="ltx_text ltx_font_bold">99.3</span></td>
<td id="S3.T6.1.1.8.7.6" class="ltx_td ltx_align_right">0.0</td>
</tr>
<tr id="S3.T6.1.1.9.8" class="ltx_tr">
<td id="S3.T6.1.1.9.8.1" class="ltx_td ltx_align_left">standard (data-matched)</td>
<td id="S3.T6.1.1.9.8.2" class="ltx_td ltx_align_left">reverse (<span id="S3.T6.1.1.9.8.2.1" class="ltx_text ltx_font_italic">entity</span>)</td>
<td id="S3.T6.1.1.9.8.3" class="ltx_td ltx_align_right">75.0</td>
<td id="S3.T6.1.1.9.8.4" class="ltx_td ltx_align_right">66.7</td>
<td id="S3.T6.1.1.9.8.5" class="ltx_td ltx_align_right"><span id="S3.T6.1.1.9.8.5.1" class="ltx_text ltx_font_bold">99.3</span></td>
<td id="S3.T6.1.1.9.8.6" class="ltx_td ltx_align_right">3.3</td>
</tr>
<tr id="S3.T6.1.1.10.9" class="ltx_tr">
<td id="S3.T6.1.1.10.9.1" class="ltx_td ltx_align_left">standard (data-matched)</td>
<td id="S3.T6.1.1.10.9.2" class="ltx_td ltx_align_left">reverse (<span id="S3.T6.1.1.10.9.2.1" class="ltx_text ltx_font_italic">rand k=25</span>)</td>
<td id="S3.T6.1.1.10.9.3" class="ltx_td ltx_align_right">76.3</td>
<td id="S3.T6.1.1.10.9.4" class="ltx_td ltx_align_right">94.3</td>
<td id="S3.T6.1.1.10.9.5" class="ltx_td ltx_align_right">95.7</td>
<td id="S3.T6.1.1.10.9.6" class="ltx_td ltx_align_right">67.0</td>
</tr>
<tr id="S3.T6.1.1.1" class="ltx_tr">
<td id="S3.T6.1.1.1.1" class="ltx_td ltx_align_left">reverse training (<span id="S3.T6.1.1.1.1.1" class="ltx_text ltx_font_italic">entity<sup id="S3.T6.1.1.1.1.1.1" class="ltx_sup">âˆ—</sup></span>)</td>
<td id="S3.T6.1.1.1.2" class="ltx_td ltx_align_left">reverse (<span id="S3.T6.1.1.1.2.1" class="ltx_text ltx_font_italic">entity</span>)</td>
<td id="S3.T6.1.1.1.3" class="ltx_td ltx_align_right">77.0</td>
<td id="S3.T6.1.1.1.4" class="ltx_td ltx_align_right">78.3</td>
<td id="S3.T6.1.1.1.5" class="ltx_td ltx_align_right">95.3</td>
<td id="S3.T6.1.1.1.6" class="ltx_td ltx_align_right">2.3</td>
</tr>
<tr id="S3.T6.1.1.11.10" class="ltx_tr">
<td id="S3.T6.1.1.11.10.1" class="ltx_td ltx_align_left ltx_border_t"><em id="S3.T6.1.1.11.10.1.1" class="ltx_emph ltx_font_italic">Model size: 7B</em></td>
<td id="S3.T6.1.1.11.10.2" class="ltx_td ltx_border_t"></td>
<td id="S3.T6.1.1.11.10.3" class="ltx_td ltx_border_t"></td>
<td id="S3.T6.1.1.11.10.4" class="ltx_td ltx_border_t"></td>
<td id="S3.T6.1.1.11.10.5" class="ltx_td ltx_border_t"></td>
<td id="S3.T6.1.1.11.10.6" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S3.T6.1.1.12.11" class="ltx_tr">
<td id="S3.T6.1.1.12.11.1" class="ltx_td ltx_align_left">standard</td>
<td id="S3.T6.1.1.12.11.2" class="ltx_td ltx_align_left">standard</td>
<td id="S3.T6.1.1.12.11.3" class="ltx_td ltx_align_right"><span id="S3.T6.1.1.12.11.3.1" class="ltx_text ltx_font_bold">80.3</span></td>
<td id="S3.T6.1.1.12.11.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T6.1.1.12.11.5" class="ltx_td ltx_align_right">96.0</td>
<td id="S3.T6.1.1.12.11.6" class="ltx_td ltx_align_right">4.0</td>
</tr>
<tr id="S3.T6.1.1.13.12" class="ltx_tr">
<td id="S3.T6.1.1.13.12.1" class="ltx_td ltx_align_left">standard</td>
<td id="S3.T6.1.1.13.12.2" class="ltx_td ltx_align_left">reverse (<span id="S3.T6.1.1.13.12.2.1" class="ltx_text ltx_font_italic">entity</span>)</td>
<td id="S3.T6.1.1.13.12.3" class="ltx_td ltx_align_right">79.0</td>
<td id="S3.T6.1.1.13.12.4" class="ltx_td ltx_align_right">89.7</td>
<td id="S3.T6.1.1.13.12.5" class="ltx_td ltx_align_right"><span id="S3.T6.1.1.13.12.5.1" class="ltx_text ltx_font_bold">99.7</span></td>
<td id="S3.T6.1.1.13.12.6" class="ltx_td ltx_align_right">6.0</td>
</tr>
<tr id="S3.T6.1.1.14.13" class="ltx_tr">
<td id="S3.T6.1.1.14.13.1" class="ltx_td ltx_align_left ltx_border_bb">standard</td>
<td id="S3.T6.1.1.14.13.2" class="ltx_td ltx_align_left ltx_border_bb">reverse (<span id="S3.T6.1.1.14.13.2.1" class="ltx_text ltx_font_italic">rand k=25</span>)</td>
<td id="S3.T6.1.1.14.13.3" class="ltx_td ltx_align_right ltx_border_bb">78.3</td>
<td id="S3.T6.1.1.14.13.4" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T6.1.1.14.13.4.1" class="ltx_text ltx_font_bold">99.0</span></td>
<td id="S3.T6.1.1.14.13.5" class="ltx_td ltx_align_right ltx_border_bb">99.0</td>
<td id="S3.T6.1.1.14.13.6" class="ltx_td ltx_align_right ltx_border_bb"><span id="S3.T6.1.1.14.13.6.1" class="ltx_text ltx_font_bold">70.0</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Test accuracy (%) on the <span id="S3.T6.3.1" class="ltx_text ltx_font_italic">fictitious celebrities</span> task, with either standard (data or compute-matched ) pre-training, or reverse pre-training, and either standard or reverse finetuning, for 1.4B and 7B parameter models.
In all cases, reverse finetuning brings a significant improvement on the reverse NameToDescription task, which is otherwise impossible to solve, and to reverse DescriptionToName using random segment reversal.
</figcaption>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Reversing fictitious facts via finetuning</h3>

<div id="S3.SS4.p1" class="ltx_para ltx_noindent">
<p id="S3.SS4.p1.1" class="ltx_p">We next explore if our reverse training can be applied to the finetuning stage when the model is learning new, previously unseen knowledge from a small training dataset. We use the same pre-trained models described in <a href="#S3.SS3" title="3.3 Reversing real-world knowledge via pre-training â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Section&nbsp;3.3</span></a> and an additional Llama-2 7B model, and further finetune them on a dataset made up of fictitious facts.
These data
are made up of statements of the form â€[name] is [description]â€ (or the reverse) where the names and descriptions are randomly generated.
The fictitious nature of this dataset guarantees that those facts are not seen during pre-training, and are only seen in the specified direction during finetuning. The model is then tested to see if it is able to learn these facts in the same or reverse direction that it has seen during training.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para ltx_noindent">
<p id="S3.SS4.p2.1" class="ltx_p"><a href="#S3.T6" title="Table 6 â€£ 3.3 Reversing real-world knowledge via pre-training â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;6</span></a> provides evaluation results for different pre-training and finetuning setups. We employ a soft matching score as the test accuracy, which we evaluate as exact presence of the target sequence in the first 64 tokens of a modelâ€™s prediction.
Across all the pre-trained models, finetuning with reverse training was critical in solving the reversal of NameToDescription, reaching close to 100% for the larger 7B model, while standard finetuning always results in 0% accuracy.
For reversing DescriptionToName,
only finetuning with the random segment reversal succeeded, achieving an accuracy around 70%.
This is likely because generating descriptions is more challenging as they have many words and some variety even for the same person.
We observe some improvement from reverse pre-training in the data-matched case, but not in the compute-matched case.
We note that this is perhaps to be expected as the evaluation statements are fictitious and never appeared in the pre-training data.</p>
</div>
<figure id="S3.T7" class="ltx_table">
<table id="S3.T7.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T7.1.2.1" class="ltx_tr">
<td id="S3.T7.1.2.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S3.T7.1.2.1.1.1" class="ltx_text ltx_font_bold">Pre-training method</span></td>
<td id="S3.T7.1.2.1.2" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.2.1.1" class="ltx_p"><span id="S3.T7.1.2.1.2.1.1.1" class="ltx_text ltx_font_bold">BoolQ</span></span>
</span>
</td>
<td id="S3.T7.1.2.1.3" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.3.1.1" class="ltx_p"><span id="S3.T7.1.2.1.3.1.1.1" class="ltx_text ltx_font_bold">PIQA</span></span>
</span>
</td>
<td id="S3.T7.1.2.1.4" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.4.1.1" class="ltx_p"><span id="S3.T7.1.2.1.4.1.1.1" class="ltx_text ltx_font_bold">SIQA</span></span>
</span>
</td>
<td id="S3.T7.1.2.1.5" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.5.1.1" class="ltx_p"><span id="S3.T7.1.2.1.5.1.1.1" class="ltx_text ltx_font_bold">HellaS</span></span>
</span>
</td>
<td id="S3.T7.1.2.1.6" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.6.1.1" class="ltx_p"><span id="S3.T7.1.2.1.6.1.1.1" class="ltx_text ltx_font_bold">WinoG</span></span>
</span>
</td>
<td id="S3.T7.1.2.1.7" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.7.1.1" class="ltx_p"><span id="S3.T7.1.2.1.7.1.1.1" class="ltx_text ltx_font_bold">ARCe</span></span>
</span>
</td>
<td id="S3.T7.1.2.1.8" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.8.1.1" class="ltx_p"><span id="S3.T7.1.2.1.8.1.1.1" class="ltx_text ltx_font_bold">ARCc</span></span>
</span>
</td>
<td id="S3.T7.1.2.1.9" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.9.1.1" class="ltx_p"><span id="S3.T7.1.2.1.9.1.1.1" class="ltx_text ltx_font_bold">OBQA</span></span>
</span>
</td>
<td id="S3.T7.1.2.1.10" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.10.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.10.1.1" class="ltx_p"><span id="S3.T7.1.2.1.10.1.1.1" class="ltx_text ltx_font_bold">MMLU</span></span>
</span>
</td>
<td id="S3.T7.1.2.1.11" class="ltx_td ltx_align_justify ltx_border_tt">
<span id="S3.T7.1.2.1.11.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.2.1.11.1.1" class="ltx_p"><span id="S3.T7.1.2.1.11.1.1.1" class="ltx_text ltx_font_bold">Avg</span></span>
</span>
</td>
</tr>
<tr id="S3.T7.1.3.2" class="ltx_tr">
<td id="S3.T7.1.3.2.1" class="ltx_td ltx_align_left ltx_border_t"><em id="S3.T7.1.3.2.1.1" class="ltx_emph ltx_font_italic">Model size: 1.4B</em></td>
<td id="S3.T7.1.3.2.2" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.3.2.3" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.3.2.4" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.3.2.5" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.3.2.6" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.3.2.7" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.3.2.8" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.3.2.9" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.3.2.10" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.3.2.11" class="ltx_td ltx_align_justify ltx_border_t"></td>
</tr>
<tr id="S3.T7.1.4.3" class="ltx_tr">
<td id="S3.T7.1.4.3.1" class="ltx_td ltx_align_left">std. (compute-matched)</td>
<td id="S3.T7.1.4.3.2" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.2.1.1" class="ltx_p">65.1</span>
</span>
</td>
<td id="S3.T7.1.4.3.3" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.3.1.1" class="ltx_p">74.4</span>
</span>
</td>
<td id="S3.T7.1.4.3.4" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.4.1.1" class="ltx_p">41.2</span>
</span>
</td>
<td id="S3.T7.1.4.3.5" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.5.1.1" class="ltx_p">47.7</span>
</span>
</td>
<td id="S3.T7.1.4.3.6" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.6.1.1" class="ltx_p">62.7</span>
</span>
</td>
<td id="S3.T7.1.4.3.7" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.7.1.1" class="ltx_p">67.6</span>
</span>
</td>
<td id="S3.T7.1.4.3.8" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.8.1.1" class="ltx_p">32.1</span>
</span>
</td>
<td id="S3.T7.1.4.3.9" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.9.1.1" class="ltx_p">27.0</span>
</span>
</td>
<td id="S3.T7.1.4.3.10" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.10.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.10.1.1" class="ltx_p">27.1</span>
</span>
</td>
<td id="S3.T7.1.4.3.11" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.4.3.11.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.4.3.11.1.1" class="ltx_p">49.4</span>
</span>
</td>
</tr>
<tr id="S3.T7.1.5.4" class="ltx_tr">
<td id="S3.T7.1.5.4.1" class="ltx_td ltx_align_left">
std. (data-matched)</td>
<td id="S3.T7.1.5.4.2" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.2.1.1" class="ltx_p">60.5</span>
</span>
</td>
<td id="S3.T7.1.5.4.3" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.3.1.1" class="ltx_p">71.6</span>
</span>
</td>
<td id="S3.T7.1.5.4.4" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.4.1.1" class="ltx_p">41.5</span>
</span>
</td>
<td id="S3.T7.1.5.4.5" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.5.1.1" class="ltx_p">44.5</span>
</span>
</td>
<td id="S3.T7.1.5.4.6" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.6.1.1" class="ltx_p">59.9</span>
</span>
</td>
<td id="S3.T7.1.5.4.7" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.7.1.1" class="ltx_p">64.2</span>
</span>
</td>
<td id="S3.T7.1.5.4.8" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.8.1.1" class="ltx_p">30.0</span>
</span>
</td>
<td id="S3.T7.1.5.4.9" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.9.1.1" class="ltx_p">27.2</span>
</span>
</td>
<td id="S3.T7.1.5.4.10" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.10.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.10.1.1" class="ltx_p">27.9</span>
</span>
</td>
<td id="S3.T7.1.5.4.11" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.5.4.11.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.5.4.11.1.1" class="ltx_p">47.5</span>
</span>
</td>
</tr>
<tr id="S3.T7.1.6.5" class="ltx_tr">
<td id="S3.T7.1.6.5.1" class="ltx_td ltx_align_left">reverse (<span id="S3.T7.1.6.5.1.1" class="ltx_text ltx_font_italic">token</span>)</td>
<td id="S3.T7.1.6.5.2" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.2.1.1" class="ltx_p">63.7</span>
</span>
</td>
<td id="S3.T7.1.6.5.3" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.3.1.1" class="ltx_p">72.9</span>
</span>
</td>
<td id="S3.T7.1.6.5.4" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.4.1.1" class="ltx_p">41.6</span>
</span>
</td>
<td id="S3.T7.1.6.5.5" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.5.1.1" class="ltx_p">45.1</span>
</span>
</td>
<td id="S3.T7.1.6.5.6" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.6.1.1" class="ltx_p">60.0</span>
</span>
</td>
<td id="S3.T7.1.6.5.7" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.7.1.1" class="ltx_p">65.7</span>
</span>
</td>
<td id="S3.T7.1.6.5.8" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.8.1.1" class="ltx_p">30.5</span>
</span>
</td>
<td id="S3.T7.1.6.5.9" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.9.1.1" class="ltx_p">28.0</span>
</span>
</td>
<td id="S3.T7.1.6.5.10" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.10.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.10.1.1" class="ltx_p">25.8</span>
</span>
</td>
<td id="S3.T7.1.6.5.11" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.6.5.11.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.6.5.11.1.1" class="ltx_p">48.1</span>
</span>
</td>
</tr>
<tr id="S3.T7.1.1" class="ltx_tr">
<td id="S3.T7.1.1.1" class="ltx_td ltx_align_left">reverse (<span id="S3.T7.1.1.1.1" class="ltx_text ltx_font_italic">entity<sup id="S3.T7.1.1.1.1.1" class="ltx_sup">âˆ—</sup></span>)</td>
<td id="S3.T7.1.1.2" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.2.1.1" class="ltx_p">62.7</span>
</span>
</td>
<td id="S3.T7.1.1.3" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.3.1.1" class="ltx_p">72.3</span>
</span>
</td>
<td id="S3.T7.1.1.4" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.4.1.1" class="ltx_p">40.9</span>
</span>
</td>
<td id="S3.T7.1.1.5" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.5.1.1" class="ltx_p">45.5</span>
</span>
</td>
<td id="S3.T7.1.1.6" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.6.1.1" class="ltx_p">59.4</span>
</span>
</td>
<td id="S3.T7.1.1.7" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.7.1.1" class="ltx_p">65.1</span>
</span>
</td>
<td id="S3.T7.1.1.8" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.8.1.1" class="ltx_p">29.4</span>
</span>
</td>
<td id="S3.T7.1.1.9" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.9.1.1" class="ltx_p">25.4</span>
</span>
</td>
<td id="S3.T7.1.1.10" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.10.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.10.1.1" class="ltx_p">27.7</span>
</span>
</td>
<td id="S3.T7.1.1.11" class="ltx_td ltx_align_justify">
<span id="S3.T7.1.1.11.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.1.11.1.1" class="ltx_p">47.6</span>
</span>
</td>
</tr>
<tr id="S3.T7.1.7.6" class="ltx_tr">
<td id="S3.T7.1.7.6.1" class="ltx_td ltx_align_left ltx_border_t"><em id="S3.T7.1.7.6.1.1" class="ltx_emph ltx_font_italic">Model size: 7B</em></td>
<td id="S3.T7.1.7.6.2" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.7.6.3" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.7.6.4" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.7.6.5" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.7.6.6" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.7.6.7" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.7.6.8" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.7.6.9" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.7.6.10" class="ltx_td ltx_align_justify ltx_border_t"></td>
<td id="S3.T7.1.7.6.11" class="ltx_td ltx_align_justify ltx_border_t"></td>
</tr>
<tr id="S3.T7.1.8.7" class="ltx_tr">
<td id="S3.T7.1.8.7.1" class="ltx_td ltx_align_left ltx_border_bb">standard</td>
<td id="S3.T7.1.8.7.2" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.2.1.1" class="ltx_p">77.4</span>
</span>
</td>
<td id="S3.T7.1.8.7.3" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.3.1.1" class="ltx_p">78.8</span>
</span>
</td>
<td id="S3.T7.1.8.7.4" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.4.1.1" class="ltx_p">48.3</span>
</span>
</td>
<td id="S3.T7.1.8.7.5" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.5.1.1" class="ltx_p">77.2</span>
</span>
</td>
<td id="S3.T7.1.8.7.6" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.6.1.1" class="ltx_p">69.2</span>
</span>
</td>
<td id="S3.T7.1.8.7.7" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.7.1.1" class="ltx_p">75.2</span>
</span>
</td>
<td id="S3.T7.1.8.7.8" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.8.1.1" class="ltx_p">45.9</span>
</span>
</td>
<td id="S3.T7.1.8.7.9" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.9.1.1" class="ltx_p">58.6</span>
</span>
</td>
<td id="S3.T7.1.8.7.10" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.10.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.10.1.1" class="ltx_p">45.3</span>
</span>
</td>
<td id="S3.T7.1.8.7.11" class="ltx_td ltx_align_justify ltx_border_bb">
<span id="S3.T7.1.8.7.11.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T7.1.8.7.11.1.1" class="ltx_p">64.0</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Performance on standard benchmarks.
Reverse training can outperform standard training in the data-matched case, but is behind compute-matched training which uses more data.
Llama-2 7B accuracy is provided for reference and is taken from&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Touvron et&nbsp;al. (<a href="#bib.bib33" title="" class="ltx_ref">2023b</a>)</cite>.</figcaption>
</figure>
<figure id="S3.T9" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S3.T9.8" class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T9.2.2" class="ltx_tr">
<th id="S3.T9.2.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt">
<span id="S3.T9.2.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.2.2.3.1.1" class="ltx_p" style="width:65.4pt;"><span id="S3.T9.2.2.3.1.1.1" class="ltx_text ltx_font_bold">Query</span></span>
</span>
</th>
<th id="S3.T9.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt">
<span id="S3.T9.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.1.1.1.1.1" class="ltx_p" style="width:156.5pt;">â€The Star-Spangled Bannerâ€ is the <math id="S3.T9.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S3.T9.1.1.1.1.1.m1.1a"><mo stretchy="false" id="S3.T9.1.1.1.1.1.m1.1.1" xref="S3.T9.1.1.1.1.1.m1.1.1.cmml">â†’</mo><annotation-xml encoding="MathML-Content" id="S3.T9.1.1.1.1.1.m1.1b"><ci id="S3.T9.1.1.1.1.1.m1.1.1.cmml" xref="S3.T9.1.1.1.1.1.m1.1.1">â†’</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.1.1.1.1.1.m1.1c">\rightarrow</annotation></semantics></math></span>
</span>
</th>
<th id="S3.T9.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S3.T9.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.2.2.2.1.1" class="ltx_p" style="width:145.1pt;"><math id="S3.T9.2.2.2.1.1.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="S3.T9.2.2.2.1.1.m1.1a"><mo stretchy="false" id="S3.T9.2.2.2.1.1.m1.1.1" xref="S3.T9.2.2.2.1.1.m1.1.1.cmml">â†</mo><annotation-xml encoding="MathML-Content" id="S3.T9.2.2.2.1.1.m1.1b"><ci id="S3.T9.2.2.2.1.1.m1.1.1.cmml" xref="S3.T9.2.2.2.1.1.m1.1.1">â†</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.2.2.2.1.1.m1.1c">\leftarrow</annotation></semantics></math> national anthem of the United States written by Francis Scott Key.</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T9.3.3" class="ltx_tr">
<td id="S3.T9.3.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T9.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.3.3.2.1.1" class="ltx_p" style="width:65.4pt;"><span id="S3.T9.3.3.2.1.1.1" class="ltx_text ltx_font_bold">standard</span></span>
</span>
</td>
<td id="S3.T9.3.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T9.3.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.3.3.1.1.1" class="ltx_p" style="width:156.5pt;"><math id="S3.T9.3.3.1.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S3.T9.3.3.1.1.1.m1.1a"><mo stretchy="false" id="S3.T9.3.3.1.1.1.m1.1.1" xref="S3.T9.3.3.1.1.1.m1.1.1.cmml">â†’</mo><annotation-xml encoding="MathML-Content" id="S3.T9.3.3.1.1.1.m1.1b"><ci id="S3.T9.3.3.1.1.1.m1.1.1.cmml" xref="S3.T9.3.3.1.1.1.m1.1.1">â†’</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.3.3.1.1.1.m1.1c">\rightarrow</annotation></semantics></math> national anthem of the United States.</span>
</span>
</td>
<td id="S3.T9.3.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T9.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.3.3.3.1.1" class="ltx_p" style="width:145.1pt;"><span id="S3.T9.3.3.3.1.1.1" class="ltx_text ltx_font_typewriter">N/A</span></span>
</span>
</td>
</tr>
<tr id="S3.T9.5.5" class="ltx_tr">
<td id="S3.T9.5.5.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T9.5.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.5.5.3.1.1" class="ltx_p" style="width:65.4pt;"><span id="S3.T9.5.5.3.1.1.1" class="ltx_text ltx_font_bold">reverse (<span id="S3.T9.5.5.3.1.1.1.1" class="ltx_text ltx_font_italic">token</span>)</span></span>
</span>
</td>
<td id="S3.T9.4.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t">
<span id="S3.T9.4.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.4.4.1.1.1" class="ltx_p" style="width:156.5pt;"><math id="S3.T9.4.4.1.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S3.T9.4.4.1.1.1.m1.1a"><mo stretchy="false" id="S3.T9.4.4.1.1.1.m1.1.1" xref="S3.T9.4.4.1.1.1.m1.1.1.cmml">â†’</mo><annotation-xml encoding="MathML-Content" id="S3.T9.4.4.1.1.1.m1.1b"><ci id="S3.T9.4.4.1.1.1.m1.1.1.cmml" xref="S3.T9.4.4.1.1.1.m1.1.1">â†’</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.4.4.1.1.1.m1.1c">\rightarrow</annotation></semantics></math> national anthem of the United States.</span>
</span>
</td>
<td id="S3.T9.5.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T9.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.5.5.2.1.1" class="ltx_p" style="width:145.1pt;">The Star Spangled Banner is the <math id="S3.T9.5.5.2.1.1.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="S3.T9.5.5.2.1.1.m1.1a"><mo stretchy="false" id="S3.T9.5.5.2.1.1.m1.1.1" xref="S3.T9.5.5.2.1.1.m1.1.1.cmml">â†</mo><annotation-xml encoding="MathML-Content" id="S3.T9.5.5.2.1.1.m1.1b"><ci id="S3.T9.5.5.2.1.1.m1.1.1.cmml" xref="S3.T9.5.5.2.1.1.m1.1.1">â†</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.5.5.2.1.1.m1.1c">\leftarrow</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.T9.8.8" class="ltx_tr">
<td id="S3.T9.6.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t">
<span id="S3.T9.6.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.6.6.1.1.1" class="ltx_p" style="width:65.4pt;"><span id="S3.T9.6.6.1.1.1.1" class="ltx_text ltx_font_bold">reverse (<span id="S3.T9.6.6.1.1.1.1.1" class="ltx_text ltx_font_italic">entity<sup id="S3.T9.6.6.1.1.1.1.1.1" class="ltx_sup"><span id="S3.T9.6.6.1.1.1.1.1.1.1" class="ltx_text ltx_font_medium">âˆ—</span></sup></span>)</span></span>
</span>
</td>
<td id="S3.T9.7.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t">
<span id="S3.T9.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.7.7.2.1.1" class="ltx_p" style="width:156.5pt;"><math id="S3.T9.7.7.2.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S3.T9.7.7.2.1.1.m1.1a"><mo stretchy="false" id="S3.T9.7.7.2.1.1.m1.1.1" xref="S3.T9.7.7.2.1.1.m1.1.1.cmml">â†’</mo><annotation-xml encoding="MathML-Content" id="S3.T9.7.7.2.1.1.m1.1b"><ci id="S3.T9.7.7.2.1.1.m1.1.1.cmml" xref="S3.T9.7.7.2.1.1.m1.1.1">â†’</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.7.7.2.1.1.m1.1c">\rightarrow</annotation></semantics></math> national anthem of the United States.</span>
</span>
</td>
<td id="S3.T9.8.8.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t">
<span id="S3.T9.8.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T9.8.8.3.1.1" class="ltx_p" style="width:145.1pt;">The Star-Spangled Banner is the <math id="S3.T9.8.8.3.1.1.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="S3.T9.8.8.3.1.1.m1.1a"><mo stretchy="false" id="S3.T9.8.8.3.1.1.m1.1.1" xref="S3.T9.8.8.3.1.1.m1.1.1.cmml">â†</mo><annotation-xml encoding="MathML-Content" id="S3.T9.8.8.3.1.1.m1.1b"><ci id="S3.T9.8.8.3.1.1.m1.1.1.cmml" xref="S3.T9.8.8.3.1.1.m1.1.1">â†</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.8.8.3.1.1.m1.1c">\leftarrow</annotation></semantics></math></span>
</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span><span id="S3.T9.15.1" class="ltx_text ltx_font_bold">An example of reversed generations produced by 1.4B pre-trained models:</span> the model is asked to generate a text completion in both normal (<span id="S3.T9.16.2" class="ltx_text ltx_font_italic">left</span>) and reversed (<span id="S3.T9.17.3" class="ltx_text ltx_font_italic">right</span>) directions.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S3.T9.11" class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:217.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(19.4pt,-9.7pt) scale(1.09846584347531,1.09846584347531) ;">
<table id="S3.T9.11.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T9.11.3.4.1" class="ltx_tr">
<th id="S3.T9.11.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" rowspan="2"><span id="S3.T9.11.3.4.1.1.1" class="ltx_text"><span id="S3.T9.11.3.4.1.1.1.1" class="ltx_text ltx_font_bold">Pre-training</span><span id="S3.T9.11.3.4.1.1.1.2" class="ltx_text ltx_font_bold"> method</span></span></th>
<th id="S3.T9.11.3.4.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" rowspan="2"><span id="S3.T9.11.3.4.1.2.1" class="ltx_text ltx_font_bold">Finetuning method</span></th>
<td id="S3.T9.11.3.4.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S3.T9.11.3.4.1.3.1" class="ltx_text ltx_font_bold">NameToDescription</span></td>
<td id="S3.T9.11.3.4.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S3.T9.11.3.4.1.4.1" class="ltx_text ltx_font_bold">DescriptionToName</span></td>
</tr>
<tr id="S3.T9.11.3.5.2" class="ltx_tr">
<td id="S3.T9.11.3.5.2.1" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T9.11.3.5.2.1.1" class="ltx_text ltx_font_bold">forward</span></td>
<td id="S3.T9.11.3.5.2.2" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T9.11.3.5.2.2.1" class="ltx_text ltx_font_bold">reverse</span></td>
<td id="S3.T9.11.3.5.2.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T9.11.3.5.2.3.1" class="ltx_text ltx_font_bold">forward</span></td>
<td id="S3.T9.11.3.5.2.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S3.T9.11.3.5.2.4.1" class="ltx_text ltx_font_bold">reverse</span></td>
</tr>
<tr id="S3.T9.11.3.6.3" class="ltx_tr">
<th id="S3.T9.11.3.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><em id="S3.T9.11.3.6.3.1.1" class="ltx_emph ltx_font_italic">Model size: 1.4B</em></th>
<th id="S3.T9.11.3.6.3.2" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<td id="S3.T9.11.3.6.3.3" class="ltx_td ltx_border_t"></td>
<td id="S3.T9.11.3.6.3.4" class="ltx_td ltx_border_t"></td>
<td id="S3.T9.11.3.6.3.5" class="ltx_td ltx_border_t"></td>
<td id="S3.T9.11.3.6.3.6" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S3.T9.11.3.7.4" class="ltx_tr">
<th id="S3.T9.11.3.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.11.3.7.4.1.1" class="ltx_text ltx_font_italic">token)</span>
</th>
<th id="S3.T9.11.3.7.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.11.3.7.4.2.1" class="ltx_text ltx_font_italic">token)</span>
</th>
<td id="S3.T9.11.3.7.4.3" class="ltx_td ltx_align_right">78.3</td>
<td id="S3.T9.11.3.7.4.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T9.11.3.7.4.5" class="ltx_td ltx_align_right">100</td>
<td id="S3.T9.11.3.7.4.6" class="ltx_td ltx_align_right">2.7</td>
</tr>
<tr id="S3.T9.9.1.1" class="ltx_tr">
<th id="S3.T9.9.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.9.1.1.1.1" class="ltx_text ltx_font_italic">entity<sup id="S3.T9.9.1.1.1.1.1" class="ltx_sup">âˆ—</sup></span>)</th>
<th id="S3.T9.9.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">standard</th>
<td id="S3.T9.9.1.1.3" class="ltx_td ltx_align_right">78.0</td>
<td id="S3.T9.9.1.1.4" class="ltx_td ltx_align_right">0.0</td>
<td id="S3.T9.9.1.1.5" class="ltx_td ltx_align_right">96.3</td>
<td id="S3.T9.9.1.1.6" class="ltx_td ltx_align_right">0.3</td>
</tr>
<tr id="S3.T9.10.2.2" class="ltx_tr">
<th id="S3.T9.10.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.10.2.2.1.1" class="ltx_text ltx_font_italic">entity<sup id="S3.T9.10.2.2.1.1.1" class="ltx_sup">âˆ—</sup></span>)</th>
<th id="S3.T9.10.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.10.2.2.2.1" class="ltx_text ltx_font_italic">word)</span>
</th>
<td id="S3.T9.10.2.2.3" class="ltx_td ltx_align_right">71.0</td>
<td id="S3.T9.10.2.2.4" class="ltx_td ltx_align_right">2.7</td>
<td id="S3.T9.10.2.2.5" class="ltx_td ltx_align_right">94.7</td>
<td id="S3.T9.10.2.2.6" class="ltx_td ltx_align_right">2.0</td>
</tr>
<tr id="S3.T9.11.3.3" class="ltx_tr">
<th id="S3.T9.11.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.11.3.3.1.1" class="ltx_text ltx_font_italic">entity<sup id="S3.T9.11.3.3.1.1.1" class="ltx_sup">âˆ—</sup></span>)</th>
<th id="S3.T9.11.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.11.3.3.2.1" class="ltx_text ltx_font_italic">entity</span>)</th>
<td id="S3.T9.11.3.3.3" class="ltx_td ltx_align_right">77.0</td>
<td id="S3.T9.11.3.3.4" class="ltx_td ltx_align_right">78.3</td>
<td id="S3.T9.11.3.3.5" class="ltx_td ltx_align_right">95.3</td>
<td id="S3.T9.11.3.3.6" class="ltx_td ltx_align_right">2.3</td>
</tr>
<tr id="S3.T9.11.3.8.5" class="ltx_tr">
<th id="S3.T9.11.3.8.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">std. (compute-matched)</th>
<th id="S3.T9.11.3.8.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.11.3.8.5.2.1" class="ltx_text ltx_font_italic">rand k=5</span>)</th>
<td id="S3.T9.11.3.8.5.3" class="ltx_td ltx_align_right">77.0</td>
<td id="S3.T9.11.3.8.5.4" class="ltx_td ltx_align_right">52.3</td>
<td id="S3.T9.11.3.8.5.5" class="ltx_td ltx_align_right">96.0</td>
<td id="S3.T9.11.3.8.5.6" class="ltx_td ltx_align_right">10.7</td>
</tr>
<tr id="S3.T9.11.3.9.6" class="ltx_tr">
<th id="S3.T9.11.3.9.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">std. (compute-matched)</th>
<th id="S3.T9.11.3.9.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.11.3.9.6.2.1" class="ltx_text ltx_font_italic">rand k=10</span>)</th>
<td id="S3.T9.11.3.9.6.3" class="ltx_td ltx_align_right">74.7</td>
<td id="S3.T9.11.3.9.6.4" class="ltx_td ltx_align_right">85.3</td>
<td id="S3.T9.11.3.9.6.5" class="ltx_td ltx_align_right">93.7</td>
<td id="S3.T9.11.3.9.6.6" class="ltx_td ltx_align_right">33.7</td>
</tr>
<tr id="S3.T9.11.3.10.7" class="ltx_tr">
<th id="S3.T9.11.3.10.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">std. (compute-matched)</th>
<th id="S3.T9.11.3.10.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">reverse (<span id="S3.T9.11.3.10.7.2.1" class="ltx_text ltx_font_italic">rand k=25</span>)</th>
<td id="S3.T9.11.3.10.7.3" class="ltx_td ltx_align_right">77.3</td>
<td id="S3.T9.11.3.10.7.4" class="ltx_td ltx_align_right">96.3</td>
<td id="S3.T9.11.3.10.7.5" class="ltx_td ltx_align_right">97.7</td>
<td id="S3.T9.11.3.10.7.6" class="ltx_td ltx_align_right">70.7</td>
</tr>
<tr id="S3.T9.11.3.11.8" class="ltx_tr">
<th id="S3.T9.11.3.11.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">std. (compute-matched)</th>
<th id="S3.T9.11.3.11.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">reverse (<span id="S3.T9.11.3.11.8.2.1" class="ltx_text ltx_font_italic">rand k=50</span>)</th>
<td id="S3.T9.11.3.11.8.3" class="ltx_td ltx_align_right ltx_border_bb">77.3</td>
<td id="S3.T9.11.3.11.8.4" class="ltx_td ltx_align_right ltx_border_bb">89.3</td>
<td id="S3.T9.11.3.11.8.5" class="ltx_td ltx_align_right ltx_border_bb">93.0</td>
<td id="S3.T9.11.3.11.8.6" class="ltx_td ltx_align_right ltx_border_bb">67.3</td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Test accuracy (%) on the <span id="S3.T9.19.1" class="ltx_text ltx_font_italic">fictitious celebrities</span> task for various different pre-training and finetuning ablation methods.</figcaption>
</figure>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Analysis &amp; ablation experiments</h3>

<section id="S3.SS5.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Does reversal training hurt performance on standard tasks?</h4>

<div id="S3.SS5.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS5.SSS0.Px1.p1.1" class="ltx_p">In <a href="#S3.SS1" title="3.1 Symbolic reverse task â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sections</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span></a>, <a href="#S3.SS2" title="3.2 Reversing Biography Task â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, <a href="#S3.SS3" title="3.3 Reversing real-world knowledge via pre-training â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> and&nbsp;<a href="#S3.SS4" title="3.4 Reversing fictitious facts via finetuning â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a> we showed that reverse training helps to mitigate the reversal curse. Here, we explore if our method disrupts zero-shot performance on common evaluation tasks: BoolQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clark et&nbsp;al., <a href="#bib.bib7" title="" class="ltx_ref">2019</a>)</cite>, PIQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bisk et&nbsp;al., <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>, SIQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sap et&nbsp;al., <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite>, HellaSwag&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zellers et&nbsp;al., <a href="#bib.bib35" title="" class="ltx_ref">2019</a>)</cite>, WinoGrande&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi et&nbsp;al., <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>, ARC easy and challenge&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clark et&nbsp;al., <a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite>, OpenBookQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mihaylov et&nbsp;al., <a href="#bib.bib20" title="" class="ltx_ref">2018</a>)</cite>. We also report 5-shot performance on the aggregated MMLU benchmark&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et&nbsp;al., <a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>. Evaluation results are summarized in <a href="#S3.T7" title="Table 7 â€£ 3.4 Reversing fictitious facts via finetuning â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;7</span></a>. We observe that
our entity reversal trained model is slightly better than the standard data-matched 1.4B model trained in the standard forward direction, and is only 1.8 points behind the compute-matched model in accuracy on average, despite being trained on half of the tokens.
We note that token reversal works slightly better than entity reversal on these standard benchmarks, and hence superior to the data-matched standard training as well.</p>
</div>
<div id="S3.SS5.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS5.SSS0.Px1.p2.1" class="ltx_p">We also find that reversed models can not only generate text continuations in the normal left-to-right direction, but can generate the beginning of the text given a continuation â€” a capability that standard models lack. We give an example in <a href="#S3.T9" title="Table 9 â€£ 3.4 Reversing fictitious facts via finetuning â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;9</span></a>.
This reverse generation function can be useful in itself, for example for instruction backtranslation <cite class="ltx_cite ltx_citemacro_citep">(Li et&nbsp;al., <a href="#bib.bib16" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
</section>
<section id="S3.SS5.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Does the unit of reversal matter?</h4>

<div id="S3.SS5.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS5.SSS0.Px2.p1.1" class="ltx_p">To understand the effect of segment granularity when reversing sequences,
we evaluate the performance of the following training methods on the fictitious celebrities task:
standard finetuning, token and word reversal finetuning, entity-preserving reversal finetuning, and random segment reversal finetuning with varying <math id="S3.SS5.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS5.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS5.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS5.SSS0.Px2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS5.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS5.SSS0.Px2.p1.1.m1.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS0.Px2.p1.1.m1.1c">k</annotation></semantics></math> as described in <a href="#S2" title="2 Reverse Training â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Section&nbsp;2</span></a>.
The results are summarized in <a href="#S3.T9" title="Table 9 â€£ 3.4 Reversing fictitious facts via finetuning â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table&nbsp;9</span></a>.
In general, we find that reversing at a fine-grained level such as token or word level does not significantly help to resolve the reversal curse, and only improves performance on the reverse tasks by 2-3%.
Preserving entities during reversal makes it possible to predict names, but not descriptions.
This indicates a close relation between the unit of reversal training and the target â€œconceptsâ€ (e.g. names, descriptions) of the reversal task.
Similarly, the random segment reversal performs poorly at predicting descriptions when the segment length limit is set lower than the typical length of a description.
The results from <a href="#S3.SS1" title="3.1 Symbolic reverse task â€£ 3 Experiments â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Section&nbsp;3.1</span></a> also support this hypothesis.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2>

<section id="S4.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Reversal Curse &amp; Mitgiations</h4>

<div id="S4.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSS0.Px1.p1.1" class="ltx_p">The reversal curse was identified by the concurrent works <cite class="ltx_cite ltx_citemacro_citet">Berglund et&nbsp;al. (<a href="#bib.bib5" title="" class="ltx_ref">2023b</a>); Allen-Zhu &amp; Li (<a href="#bib.bib2" title="" class="ltx_ref">2023b</a>)</cite>; its name was derived from the former. They demonstrated that the reversal curse occurs across model sizes and families, including very large models such as GPT-3.5 and GPT-4. They found that including auxiliary examples with both orders present in the finetuning or pre-training datasets (to promote meta-learning) does not aid generalization to examples where only one order is given, even if such data is rewritten in a question-answer format. Furthermore, including multiple paraphrases of each fact in a single direction does not facilitate learning in the reverse direction, despite aiding the given direction, as shown by <cite class="ltx_cite ltx_citemacro_citet">Berglund et&nbsp;al. (<a href="#bib.bib4" title="" class="ltx_ref">2023a</a>); Allen-Zhu &amp; Li (<a href="#bib.bib1" title="" class="ltx_ref">2023a</a>)</cite>.</p>
</div>
<div id="S4.SS0.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSS0.Px1.p2.1" class="ltx_p">The concurrent work by <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a href="#bib.bib1" title="" class="ltx_ref">2023a</a>)</cite> investigates a related set of failures and potential solutions. Exploring the capability to answer questions based on synthetic biographies, they examine several data augmentation strategies, including incorporating instruction tuning data into pre-training, generating multiple unique biography entries, permuting biography sentences, and substituting pronouns or partial names with full names. They discover that augmentation during the pre-training phase is essential for enhancing downstream question answering performance across various tasks. However, in real pre-training data, some augmentations may not be feasible â€” for instance, permuting sentences could degrade language model quality, and it remains uncertain how to best rewrite data during augmentation. Reverse training addresses this issue by presenting a distinct language task (the reversed language) to the language model, thereby avoiding interference with the primary task of left-to-right natural language modeling.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Right-to-left, masked &amp; other training variants</h4>

<div id="S4.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSS0.Px2.p1.1" class="ltx_p">Multiple works have proposed pre-training language models with
rephrased or paraphrased text <cite class="ltx_cite ltx_citemacro_citep">(Lewis et&nbsp;al., <a href="#bib.bib15" title="" class="ltx_ref">2020</a>; Maini et&nbsp;al., <a href="#bib.bib19" title="" class="ltx_ref">2024</a>)</cite>,
but were not targeting the reversal curse.
Training right-to-left has been explored before <cite class="ltx_cite ltx_citemacro_citep">(Pfau et&nbsp;al., <a href="#bib.bib23" title="" class="ltx_ref">2023</a>)</cite>,
but not by multitasking with left-to-right models. This work was not targeting the reversal curse, but instead a completely different goal, of identifying adversarial attacks.
Rather than training left-to-right, or right-to-left, masked language models aim to learn how to â€œfill in the middleâ€, going back to
early language modeling work such as <cite class="ltx_cite ltx_citemacro_citet">Collobert et&nbsp;al. (<a href="#bib.bib9" title="" class="ltx_ref">2011</a>)</cite>, and models such as BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et&nbsp;al., <a href="#bib.bib11" title="" class="ltx_ref">2018</a>)</cite>.
Other methods have also been proposed to explicitly fill in middle text sections by rearranging data <cite class="ltx_cite ltx_citemacro_citep">(Bavarian et&nbsp;al., <a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite>, to train on scrambled data <cite class="ltx_cite ltx_citemacro_citep">(Sinha et&nbsp;al., <a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>, or to train on all permutations of the factorization order <cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a href="#bib.bib34" title="" class="ltx_ref">2019</a>)</cite>.
Relatedly, transforming training data with repeating segments has also been shown to improve language model embeddings <cite class="ltx_cite ltx_citemacro_citep">(Springer et&nbsp;al., <a href="#bib.bib31" title="" class="ltx_ref">2024</a>)</cite>.
Encoder-only models akin to BERT have been shown to <span id="S4.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">not</span> mitigate the reversal curse <cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu &amp; Li, <a href="#bib.bib1" title="" class="ltx_ref">2023a</a>)</cite>.
However, modifying the architecture and training procedure <span id="S4.SS0.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_italic">has</span> been shown to help, e.g. by introducing BIdirectional Casual language modeling Optimization (BICO) <cite class="ltx_cite ltx_citemacro_citep">(Lv et&nbsp;al., <a href="#bib.bib18" title="" class="ltx_ref">2023</a>)</cite>. In contrast, our work seeks to rectify the issue while keeping standard language model training as similar as possible to the current regime.</p>
</div>
<div id="S4.SS0.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSS0.Px2.p2.1" class="ltx_p">The most similar work to ours is the concurrent work of <cite class="ltx_cite ltx_citemacro_citet">Guo et&nbsp;al. (<a href="#bib.bib12" title="" class="ltx_ref">2024</a>)</cite>. They employ various augmentations at the finetuning, rather than pre-training stage, including shuffling and reversing chunks of the input sentences.
Unlike our method, their method first segments sentences in the training into semantically meaningful chunks via an LLM.
While a chunk can be an entity name, it is more generally applied to all words, e.g. â€œof developing the first emotionalâ€ as a chunk.
The actual segmentation is done via prompting another LLM with a specific instruction.
Therefore, the unit of reversal will depend on the LLM and its prompt, making it presumably a difficult language modeling problem, whilst also requiring extra compute to reverse the sequence.
This is applied only to finetuning on short sentences, which means the reversal curse mitigation is limited to the facts included in the finetuning data, and it is unclear if it can be applied to large pre-training documents.
In contrast, our method is applied in the pre-training stage so it can learn to reverse a wide-range of general knowledge facts.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In this paper, we introduced a simple yet effective training method to help remedy the reversal curse in LLMs.
Our reverse training works by first segmenting the input sequence into chunks and then reversing the ordering of chunks, but leaves the word-ordering in each chunk intact.
A chunk can be a token, a word, an entity name, or a random number of tokens.
The model is then trained on both the original sequences, and this reversed data.
We evaluated on a symbolic reverse task and a reversing biography task that both demonstrated the necessity of preserving word-ordering within chunks.
Next, we applied our reverse training to the realistic setting of LLM pre-training, which minimized the reversal curse on real-world knowledge.
Evaluations on common benchmark tasks reveal that reverse training (particularly at the word level) during pre-training does not interfere with the forward prediction ability of LLMs, and actually improves metrics in the data-bound (rather than compute-bound) setting compared to standard training.
When our method is applied to finetuning on fictitious facts, prediction accuracy rose from 0% to 70-100%.
The reversal curse is a serious flaw in how LLMs acquire knowledge and reverse training opens a new promising direction in resolving it.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allen-Zhu &amp; Li (2023a)</span>
<span class="ltx_bibblock">
Zeyuan Allen-Zhu and Yuanzhi Li.

</span>
<span class="ltx_bibblock">Physics of language models: Part 3.1, knowledge storage and extraction.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">ArXiv e-prints</em>, abs/2309.14316, September 2023a.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allen-Zhu &amp; Li (2023b)</span>
<span class="ltx_bibblock">
Zeyuan Allen-Zhu and Yuanzhi Li.

</span>
<span class="ltx_bibblock">Physics of Language Models: Part 3.2, Knowledge Manipulation.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ArXiv e-prints</em>, abs/2309.14402, September 2023b.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bavarian et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Mohammad Bavarian, Heewoo Jun, Nikolas Tezak, John Schulman, Christine McLeavey, Jerry Tworek, and Mark Chen.

</span>
<span class="ltx_bibblock">Efficient training of language models to fill in the middle.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2207.14255</em>, 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berglund et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
Lukas Berglund, Asa&nbsp;Cooper Stickland, Mikita Balesni, Max Kaufmann, Meg Tong, Tomasz Korbak, Daniel Kokotajlo, and Owain Evans.

</span>
<span class="ltx_bibblock">Taken out of context: On measuring situational awareness in llms.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.00667</em>, 2023a.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berglund et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
Lukas Berglund, Meg Tong, Max Kaufmann, Mikita Balesni, Asa&nbsp;Cooper Stickland, Tomasz Korbak, and Owain Evans.

</span>
<span class="ltx_bibblock">The reversal curse: Llms trained onâ€ a is bâ€ fail to learnâ€ b is aâ€.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.12288</em>, 2023b.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Yonatan Bisk, Rowan Zellers, Jianfeng Gao, Yejin Choi, et&nbsp;al.

</span>
<span class="ltx_bibblock">Piqa: Reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI conference on artificial intelligence</em>, volume&nbsp;34, pp.&nbsp; 7432â€“7439, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Christopher Clark, Kenton Lee, Ming-Wei Chang, Tom Kwiatkowski, Michael Collins, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Boolq: Exploring the surprising difficulty of natural yes/no questions.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1905.10044</em>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
Peter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa Schoenick, and Oyvind Tafjord.

</span>
<span class="ltx_bibblock">Think you have solved question answering? try arc, the ai2 reasoning challenge.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1803.05457</em>, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collobert et&nbsp;al. (2011)</span>
<span class="ltx_bibblock">
Ronan Collobert, Jason Weston, LÃ©on Bottou, Michael Karlen, Koray Kavukcuoglu, and Pavel Kuksa.

</span>
<span class="ltx_bibblock">Natural language processing (almost) from scratch.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Journal of machine learning research</em>, 12(ARTICLE):2493â€“2537, 2011.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Delâ€™etang et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Grâ€™egoire Delâ€™etang, Anian Ruoss, Paul-Ambroise Duquenne, Elliot Catt, Tim Genewein, Christopher Mattern, Jordi Grau-Moya, Wenliang&nbsp;Kevin Li, Matthew Aitchison, Laurent Orseau, Marcus Hutter, and Joel Veness.

</span>
<span class="ltx_bibblock">Language modeling is compression.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2309.10668, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://api.semanticscholar.org/CorpusID:262054258" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:262054258</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1810.04805</em>, 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Qingyan Guo, Rui Wang, Junliang Guo, Xu&nbsp;Tan, Jiang Bian, and Yujiu Yang.

</span>
<span class="ltx_bibblock">Mitigating reversal curse via semantic-aware permutation training, 2024.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2009.03300</em>, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lample &amp; Conneau (2019)</span>
<span class="ltx_bibblock">
Guillaume Lample and Alexis Conneau.

</span>
<span class="ltx_bibblock">Cross-lingual language model pretraining.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1901.07291</em>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Mike Lewis, Marjan Ghazvininejad, Gargi Ghosh, Armen Aghajanyan, Sida Wang, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Pre-training via paraphrasing.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:18470â€“18481, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Xian Li, Ping Yu, Chunting Zhou, Timo Schick, Luke Zettlemoyer, Omer Levy, Jason Weston, and Mike Lewis.

</span>
<span class="ltx_bibblock">Self-alignment with instruction backtranslation.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2308.06259, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://api.semanticscholar.org/CorpusID:260866107" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:260866107</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loper &amp; Bird (2002)</span>
<span class="ltx_bibblock">
Edward Loper and Steven Bird.

</span>
<span class="ltx_bibblock">Nltk: The natural language toolkit.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint cs/0205028</em>, 2002.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lv et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Ang Lv, Kaiyi Zhang, Shufang Xie, Quan Tu, Yuhan Chen, Ji-Rong Wen, and Rui Yan.

</span>
<span class="ltx_bibblock">Are we falling in a middle-intelligence trap? an analysis and mitigation of the reversal curse.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2311.07468</em>, 2023.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maini et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Pratyush Maini, Skyler Seto, He&nbsp;Bai, David Grangier, Yizhe Zhang, and Navdeep Jaitly.

</span>
<span class="ltx_bibblock">Rephrasing the web: A recipe for compute and data-efficient language modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.16380</em>, 2024.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mihaylov et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
Todor Mihaylov, Peter Clark, Tushar Khot, and Ashish Sabharwal.

</span>
<span class="ltx_bibblock">Can a suit of armor conduct electricity? a new dataset for open book question answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1809.02789</em>, 2018.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Newman (2005)</span>
<span class="ltx_bibblock">
Mark&nbsp;EJ Newman.

</span>
<span class="ltx_bibblock">Power laws, pareto distributions and zipfâ€™s law.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Contemporary physics</em>, 46(5):323â€“351, 2005.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report, 2023.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pfau et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Jacob Pfau, Alex Infanger, Abhay Sheshadri, Ayush Panda, Julian Michael, and Curtis Huebner.

</span>
<span class="ltx_bibblock">Eliciting language model behaviors using reverse language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Socially Responsible Language Modelling Research</em>, 2023.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakaguchi et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Keisuke Sakaguchi, Ronan&nbsp;Le Bras, Chandra Bhagavatula, and Yejin Choi.

</span>
<span class="ltx_bibblock">Winogrande: An adversarial winograd schema challenge at scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Communications of the ACM</em>, 64(9):99â€“106, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sap et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Maarten Sap, Hannah Rashkin, Derek Chen, Ronan LeBras, and Yejin Choi.

</span>
<span class="ltx_bibblock">Socialiqa: Commonsense reasoning about social interactions.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1904.09728</em>, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schweter &amp; Akbik (2020)</span>
<span class="ltx_bibblock">
Stefan Schweter and Alan Akbik.

</span>
<span class="ltx_bibblock">Flert: Document-level features for named entity recognition, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et&nbsp;al. (2015)</span>
<span class="ltx_bibblock">
Rico Sennrich, Barry Haddow, and Alexandra Birch.

</span>
<span class="ltx_bibblock">Neural machine translation of rare words with subword units.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1508.07909</em>, 2015.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shannon (1948)</span>
<span class="ltx_bibblock">
C.&nbsp;E. Shannon.

</span>
<span class="ltx_bibblock">A mathematical theory of communication.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">The Bell System Technical Journal</em>, 27(3):379â€“423, 1948.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1002/j.1538-7305.1948.tb01338.x</span>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Zhihong Shao, Peiyi Wang, Qihao Zhu, R.&nbsp;X. Xu, Jun-Mei Song, Mingchuan Zhang, Y.&nbsp;K. Li, Yu&nbsp;Wu, and Daya Guo.

</span>
<span class="ltx_bibblock">Deepseekmath: Pushing the limits of mathematical reasoning in open language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2402.03300, 2024.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://api.semanticscholar.org/CorpusID:267412607" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:267412607</a>.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sinha et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Koustuv Sinha, Robin Jia, Dieuwke Hupkes, Joelle Pineau, Adina Williams, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Masked language modeling and the distributional hypothesis: Order word matters pre-training for little.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.06644</em>, 2021.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Springer et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Jacob&nbsp;Mitchell Springer, Suhas Kotha, Daniel Fried, Graham Neubig, and Aditi Raghunathan.

</span>
<span class="ltx_bibblock">Repetition improves language model embeddings.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.15449</em>, 2024.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, TimothÃ©e Lacroix, Baptiste RoziÃ¨re, Naman Goyal, Eric Hambro, Faisal Azhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.13971</em>, 2023a.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian&nbsp;Canton Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa, Isabel Kloumann, Artem Korenev, Punit&nbsp;Singh Koura, Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan Silva, Eric&nbsp;Michael Smith, Ranjan Subramanian, Xiaoqing&nbsp;Ellen Tan, Binh Tang, Ross Taylor, Adina Williams, Jian&nbsp;Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurelien Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas
Scialom.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models, 2023b.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Zhilin Yang, Zihang Dai, Yiming Yang, Jaime Carbonell, Russ&nbsp;R Salakhutdinov, and Quoc&nbsp;V Le.

</span>
<span class="ltx_bibblock">Xlnet: Generalized autoregressive pretraining for language understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi.

</span>
<span class="ltx_bibblock">Hellaswag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1905.07830</em>, 2019.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Symbolic reverse task details</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.8" class="ltx_p">The vocabulary is built by generating 100 different words per position, e.g. <span id="A1.p1.8.1" class="ltx_text ltx_font_typewriter">a200</span> to <span id="A1.p1.8.2" class="ltx_text ltx_font_typewriter">a299</span> for the second word of entities <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="A1.p1.1.m1.1a"><msub id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">a</mi><mi id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2">ğ‘</ci><ci id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">a_{i}</annotation></semantics></math>.
Then we create 10,000 entities <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="A1.p1.2.m2.1a"><msub id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><mi id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml">a</mi><mi id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2">ğ‘</ci><ci id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">a_{i}</annotation></semantics></math> and 10,000 entities <math id="A1.p1.3.m3.1" class="ltx_Math" alttext="b_{j}" display="inline"><semantics id="A1.p1.3.m3.1a"><msub id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mi id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">b</mi><mi id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">ğ‘</ci><ci id="A1.p1.3.m3.1.1.3.cmml" xref="A1.p1.3.m3.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">b_{j}</annotation></semantics></math> by concatenating random words specific to each position.
Finally, <math id="A1.p1.4.m4.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="A1.p1.4.m4.1a"><msub id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml"><mi id="A1.p1.4.m4.1.1.2" xref="A1.p1.4.m4.1.1.2.cmml">a</mi><mi id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p1.4.m4.1.1.1.cmml" xref="A1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">ğ‘</ci><ci id="A1.p1.4.m4.1.1.3.cmml" xref="A1.p1.4.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">a_{i}</annotation></semantics></math> entities are randomly mapped to <math id="A1.p1.5.m5.1" class="ltx_Math" alttext="b_{j}" display="inline"><semantics id="A1.p1.5.m5.1a"><msub id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml"><mi id="A1.p1.5.m5.1.1.2" xref="A1.p1.5.m5.1.1.2.cmml">b</mi><mi id="A1.p1.5.m5.1.1.3" xref="A1.p1.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b"><apply id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.p1.5.m5.1.1.1.cmml" xref="A1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.p1.5.m5.1.1.2.cmml" xref="A1.p1.5.m5.1.1.2">ğ‘</ci><ci id="A1.p1.5.m5.1.1.3.cmml" xref="A1.p1.5.m5.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">b_{j}</annotation></semantics></math>, resulting in 10,000 pairs.
The model is an 8-layer Transformer with a hidden size of 512.
The training is continued for 500 epochs with batch size <math id="A1.p1.6.m6.1" class="ltx_Math" alttext="=1024" display="inline"><semantics id="A1.p1.6.m6.1a"><mrow id="A1.p1.6.m6.1.1" xref="A1.p1.6.m6.1.1.cmml"><mi id="A1.p1.6.m6.1.1.2" xref="A1.p1.6.m6.1.1.2.cmml"></mi><mo id="A1.p1.6.m6.1.1.1" xref="A1.p1.6.m6.1.1.1.cmml">=</mo><mn id="A1.p1.6.m6.1.1.3" xref="A1.p1.6.m6.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.6.m6.1b"><apply id="A1.p1.6.m6.1.1.cmml" xref="A1.p1.6.m6.1.1"><eq id="A1.p1.6.m6.1.1.1.cmml" xref="A1.p1.6.m6.1.1.1"></eq><csymbol cd="latexml" id="A1.p1.6.m6.1.1.2.cmml" xref="A1.p1.6.m6.1.1.2">absent</csymbol><cn type="integer" id="A1.p1.6.m6.1.1.3.cmml" xref="A1.p1.6.m6.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m6.1c">=1024</annotation></semantics></math>, learning rate <math id="A1.p1.7.m7.1" class="ltx_Math" alttext="=0.0003" display="inline"><semantics id="A1.p1.7.m7.1a"><mrow id="A1.p1.7.m7.1.1" xref="A1.p1.7.m7.1.1.cmml"><mi id="A1.p1.7.m7.1.1.2" xref="A1.p1.7.m7.1.1.2.cmml"></mi><mo id="A1.p1.7.m7.1.1.1" xref="A1.p1.7.m7.1.1.1.cmml">=</mo><mn id="A1.p1.7.m7.1.1.3" xref="A1.p1.7.m7.1.1.3.cmml">0.0003</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.7.m7.1b"><apply id="A1.p1.7.m7.1.1.cmml" xref="A1.p1.7.m7.1.1"><eq id="A1.p1.7.m7.1.1.1.cmml" xref="A1.p1.7.m7.1.1.1"></eq><csymbol cd="latexml" id="A1.p1.7.m7.1.1.2.cmml" xref="A1.p1.7.m7.1.1.2">absent</csymbol><cn type="float" id="A1.p1.7.m7.1.1.3.cmml" xref="A1.p1.7.m7.1.1.3">0.0003</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m7.1c">=0.0003</annotation></semantics></math>, and dropout rate <math id="A1.p1.8.m8.1" class="ltx_Math" alttext="=0.1" display="inline"><semantics id="A1.p1.8.m8.1a"><mrow id="A1.p1.8.m8.1.1" xref="A1.p1.8.m8.1.1.cmml"><mi id="A1.p1.8.m8.1.1.2" xref="A1.p1.8.m8.1.1.2.cmml"></mi><mo id="A1.p1.8.m8.1.1.1" xref="A1.p1.8.m8.1.1.1.cmml">=</mo><mn id="A1.p1.8.m8.1.1.3" xref="A1.p1.8.m8.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.8.m8.1b"><apply id="A1.p1.8.m8.1.1.cmml" xref="A1.p1.8.m8.1.1"><eq id="A1.p1.8.m8.1.1.1.cmml" xref="A1.p1.8.m8.1.1.1"></eq><csymbol cd="latexml" id="A1.p1.8.m8.1.1.2.cmml" xref="A1.p1.8.m8.1.1.2">absent</csymbol><cn type="float" id="A1.p1.8.m8.1.1.3.cmml" xref="A1.p1.8.m8.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.8.m8.1c">=0.1</annotation></semantics></math>.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Transformer model pre-training</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.4" class="ltx_p">We train a transformer model with <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="dim=2048" display="inline"><semantics id="A2.p1.1.m1.1a"><mrow id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mrow id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml"><mi id="A2.p1.1.m1.1.1.2.2" xref="A2.p1.1.m1.1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A2.p1.1.m1.1.1.2.1" xref="A2.p1.1.m1.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.1.m1.1.1.2.3" xref="A2.p1.1.m1.1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="A2.p1.1.m1.1.1.2.1a" xref="A2.p1.1.m1.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.1.m1.1.1.2.4" xref="A2.p1.1.m1.1.1.2.4.cmml">m</mi></mrow><mo id="A2.p1.1.m1.1.1.1" xref="A2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><eq id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1.1"></eq><apply id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2"><times id="A2.p1.1.m1.1.1.2.1.cmml" xref="A2.p1.1.m1.1.1.2.1"></times><ci id="A2.p1.1.m1.1.1.2.2.cmml" xref="A2.p1.1.m1.1.1.2.2">ğ‘‘</ci><ci id="A2.p1.1.m1.1.1.2.3.cmml" xref="A2.p1.1.m1.1.1.2.3">ğ‘–</ci><ci id="A2.p1.1.m1.1.1.2.4.cmml" xref="A2.p1.1.m1.1.1.2.4">ğ‘š</ci></apply><cn type="integer" id="A2.p1.1.m1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">dim=2048</annotation></semantics></math>, <math id="A2.p1.2.m2.1" class="ltx_Math" alttext="n\_layers=24" display="inline"><semantics id="A2.p1.2.m2.1a"><mrow id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mrow id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml"><mi id="A2.p1.2.m2.1.1.2.2" xref="A2.p1.2.m2.1.1.2.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1.2.1" xref="A2.p1.2.m2.1.1.2.1.cmml">â€‹</mo><mi mathvariant="normal" id="A2.p1.2.m2.1.1.2.3" xref="A2.p1.2.m2.1.1.2.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1.2.1a" xref="A2.p1.2.m2.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.2.m2.1.1.2.4" xref="A2.p1.2.m2.1.1.2.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1.2.1b" xref="A2.p1.2.m2.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.2.m2.1.1.2.5" xref="A2.p1.2.m2.1.1.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1.2.1c" xref="A2.p1.2.m2.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.2.m2.1.1.2.6" xref="A2.p1.2.m2.1.1.2.6.cmml">y</mi><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1.2.1d" xref="A2.p1.2.m2.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.2.m2.1.1.2.7" xref="A2.p1.2.m2.1.1.2.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1.2.1e" xref="A2.p1.2.m2.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.2.m2.1.1.2.8" xref="A2.p1.2.m2.1.1.2.8.cmml">r</mi><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1.2.1f" xref="A2.p1.2.m2.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.2.m2.1.1.2.9" xref="A2.p1.2.m2.1.1.2.9.cmml">s</mi></mrow><mo id="A2.p1.2.m2.1.1.1" xref="A2.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3.cmml">24</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><eq id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1"></eq><apply id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2"><times id="A2.p1.2.m2.1.1.2.1.cmml" xref="A2.p1.2.m2.1.1.2.1"></times><ci id="A2.p1.2.m2.1.1.2.2.cmml" xref="A2.p1.2.m2.1.1.2.2">ğ‘›</ci><ci id="A2.p1.2.m2.1.1.2.3.cmml" xref="A2.p1.2.m2.1.1.2.3">_</ci><ci id="A2.p1.2.m2.1.1.2.4.cmml" xref="A2.p1.2.m2.1.1.2.4">ğ‘™</ci><ci id="A2.p1.2.m2.1.1.2.5.cmml" xref="A2.p1.2.m2.1.1.2.5">ğ‘</ci><ci id="A2.p1.2.m2.1.1.2.6.cmml" xref="A2.p1.2.m2.1.1.2.6">ğ‘¦</ci><ci id="A2.p1.2.m2.1.1.2.7.cmml" xref="A2.p1.2.m2.1.1.2.7">ğ‘’</ci><ci id="A2.p1.2.m2.1.1.2.8.cmml" xref="A2.p1.2.m2.1.1.2.8">ğ‘Ÿ</ci><ci id="A2.p1.2.m2.1.1.2.9.cmml" xref="A2.p1.2.m2.1.1.2.9">ğ‘ </ci></apply><cn type="integer" id="A2.p1.2.m2.1.1.3.cmml" xref="A2.p1.2.m2.1.1.3">24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">n\_layers=24</annotation></semantics></math>, and <math id="A2.p1.3.m3.1" class="ltx_Math" alttext="n\_heads=16" display="inline"><semantics id="A2.p1.3.m3.1a"><mrow id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml"><mrow id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml"><mi id="A2.p1.3.m3.1.1.2.2" xref="A2.p1.3.m3.1.1.2.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="A2.p1.3.m3.1.1.2.1" xref="A2.p1.3.m3.1.1.2.1.cmml">â€‹</mo><mi mathvariant="normal" id="A2.p1.3.m3.1.1.2.3" xref="A2.p1.3.m3.1.1.2.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="A2.p1.3.m3.1.1.2.1a" xref="A2.p1.3.m3.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.3.m3.1.1.2.4" xref="A2.p1.3.m3.1.1.2.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="A2.p1.3.m3.1.1.2.1b" xref="A2.p1.3.m3.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.3.m3.1.1.2.5" xref="A2.p1.3.m3.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.p1.3.m3.1.1.2.1c" xref="A2.p1.3.m3.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.3.m3.1.1.2.6" xref="A2.p1.3.m3.1.1.2.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="A2.p1.3.m3.1.1.2.1d" xref="A2.p1.3.m3.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.3.m3.1.1.2.7" xref="A2.p1.3.m3.1.1.2.7.cmml">d</mi><mo lspace="0em" rspace="0em" id="A2.p1.3.m3.1.1.2.1e" xref="A2.p1.3.m3.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.3.m3.1.1.2.8" xref="A2.p1.3.m3.1.1.2.8.cmml">s</mi></mrow><mo id="A2.p1.3.m3.1.1.1" xref="A2.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1"><eq id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1.1"></eq><apply id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2"><times id="A2.p1.3.m3.1.1.2.1.cmml" xref="A2.p1.3.m3.1.1.2.1"></times><ci id="A2.p1.3.m3.1.1.2.2.cmml" xref="A2.p1.3.m3.1.1.2.2">ğ‘›</ci><ci id="A2.p1.3.m3.1.1.2.3.cmml" xref="A2.p1.3.m3.1.1.2.3">_</ci><ci id="A2.p1.3.m3.1.1.2.4.cmml" xref="A2.p1.3.m3.1.1.2.4">â„</ci><ci id="A2.p1.3.m3.1.1.2.5.cmml" xref="A2.p1.3.m3.1.1.2.5">ğ‘’</ci><ci id="A2.p1.3.m3.1.1.2.6.cmml" xref="A2.p1.3.m3.1.1.2.6">ğ‘</ci><ci id="A2.p1.3.m3.1.1.2.7.cmml" xref="A2.p1.3.m3.1.1.2.7">ğ‘‘</ci><ci id="A2.p1.3.m3.1.1.2.8.cmml" xref="A2.p1.3.m3.1.1.2.8">ğ‘ </ci></apply><cn type="integer" id="A2.p1.3.m3.1.1.3.cmml" xref="A2.p1.3.m3.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">n\_heads=16</annotation></semantics></math>, resulting in 1.4B parameters. Training data and hyperparameter setup mostly repeats the one from&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Touvron et&nbsp;al. (<a href="#bib.bib33" title="" class="ltx_ref">2023b</a>)</cite>. To adapt for the relatively smaller model size, we increase the learning rate to <math id="A2.p1.4.m4.1" class="ltx_Math" alttext="4.0e{-4}" display="inline"><semantics id="A2.p1.4.m4.1a"><mrow id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml"><mrow id="A2.p1.4.m4.1.1.2" xref="A2.p1.4.m4.1.1.2.cmml"><mn id="A2.p1.4.m4.1.1.2.2" xref="A2.p1.4.m4.1.1.2.2.cmml">4.0</mn><mo lspace="0em" rspace="0em" id="A2.p1.4.m4.1.1.2.1" xref="A2.p1.4.m4.1.1.2.1.cmml">â€‹</mo><mi id="A2.p1.4.m4.1.1.2.3" xref="A2.p1.4.m4.1.1.2.3.cmml">e</mi></mrow><mo id="A2.p1.4.m4.1.1.1" xref="A2.p1.4.m4.1.1.1.cmml">âˆ’</mo><mn id="A2.p1.4.m4.1.1.3" xref="A2.p1.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><apply id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1"><minus id="A2.p1.4.m4.1.1.1.cmml" xref="A2.p1.4.m4.1.1.1"></minus><apply id="A2.p1.4.m4.1.1.2.cmml" xref="A2.p1.4.m4.1.1.2"><times id="A2.p1.4.m4.1.1.2.1.cmml" xref="A2.p1.4.m4.1.1.2.1"></times><cn type="float" id="A2.p1.4.m4.1.1.2.2.cmml" xref="A2.p1.4.m4.1.1.2.2">4.0</cn><ci id="A2.p1.4.m4.1.1.2.3.cmml" xref="A2.p1.4.m4.1.1.2.3">ğ‘’</ci></apply><cn type="integer" id="A2.p1.4.m4.1.1.3.cmml" xref="A2.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">4.0e{-4}</annotation></semantics></math>, and the global batch-size was capped at 2M due to the limited number of GPUs.
During training, we observe a fixed gap in training perplexity between baseline models and reverse training (Figure&nbsp;<a href="#A2.F1" title="Figure 1 â€£ Appendix B Transformer model pre-training â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The loss of the baseline model is measured on data in the standard direction, while the reverse training loss covers data in both directions. We posit that the reverse training doesnâ€™t interfere with forward learning â€” thus, the modelâ€™s performance does not degrade on standard benchmarks in data-match conditions, and because we observe a match in the convergence rate of the reverse trained models with the baseline model when itâ€™s trained on about 50% of the data.</p>
</div>
<figure id="A2.F1" class="ltx_figure"><img src="/html/2403.13799/assets/assets/training_loss.png" id="A2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="202" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Training loss for 1.4B models in the pre-training stage. On the <math id="A2.F1.2.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A2.F1.2.m1.1b"><mi id="A2.F1.2.m1.1.1" xref="A2.F1.2.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.F1.2.m1.1c"><ci id="A2.F1.2.m1.1.1.cmml" xref="A2.F1.2.m1.1.1">ğ‘¥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F1.2.m1.1d">x</annotation></semantics></math>-axis we display the total number of tokens model has been trained on, including both in standard and reverse direction.</figcaption>
</figure>
<div id="A2.p2" class="ltx_para ltx_noindent">
<p id="A2.p2.1" class="ltx_p">In <a href="#A2.F2" title="Figure 2 â€£ Appendix B Transformer model pre-training â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure&nbsp;2</span></a>, we evaluate performance on the real-world knowledge task for multiple checkpoints during pre-training, where accuracy is reported using best@1 sampling. We notice an upward trend in performance on the reverse task with no saturation at the last checkpoint. Hence, we assume that if we continue pre-training we would see further improvement.</p>
</div>
<figure id="A2.F2" class="ltx_figure"><img src="/html/2403.13799/assets/assets/celeb_pics.png" id="A2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="282" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Evaluation results during training on the real-world celebrity task when using different pre-training methods for LLMs.</figcaption>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Biography Data Experiment Details</h2>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.6" class="ltx_p">In our biography data experiments, we utilize the <span id="A3.p1.6.1" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioS</span> <span id="A3.p1.6.2" class="ltx_text ltx_markedasmath ltx_font_sansserif">multi5+permute</span> dataset from <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a href="#bib.bib1" title="" class="ltx_ref">2023a</a>; <a href="#bib.bib2" title="" class="ltx_ref">b</a>)</cite> as our <span id="A3.p1.6.3" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioS</span> dataset, which generates 5 biography entries per person using randomly chosen sentence templates and permutations. We use the <span id="A3.p1.6.4" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioR</span> <span id="A3.p1.6.5" class="ltx_text ltx_markedasmath ltx_font_sansserif">multi5</span> dataset from them as our <span id="A3.p1.6.6" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioR</span> dataset, which generates 5 biography entries per person by invoking Llama five times.</p>
</div>
<div id="A3.p2" class="ltx_para ltx_noindent">
<p id="A3.p2.3" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a href="#bib.bib2" title="" class="ltx_ref">2023b</a>)</cite>, we employ GPT2-small (12 layers, 12 heads, and 768 dimensions) for the <span id="A3.p2.3.1" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioS</span> dataset and GPT2 with 12 layers, 20 heads, and 1280 dimensions for the <span id="A3.p2.3.2" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioR</span> dataset. We also utilize the same AdamW optimizer with cosine learning rate decay (<math id="A3.p2.3.m3.2" class="ltx_Math" alttext="\beta_{1}=0.9,\beta_{2}=0.98,\varepsilon=10^{-6}" display="inline"><semantics id="A3.p2.3.m3.2a"><mrow id="A3.p2.3.m3.2.2.2" xref="A3.p2.3.m3.2.2.3.cmml"><mrow id="A3.p2.3.m3.1.1.1.1" xref="A3.p2.3.m3.1.1.1.1.cmml"><msub id="A3.p2.3.m3.1.1.1.1.2" xref="A3.p2.3.m3.1.1.1.1.2.cmml"><mi id="A3.p2.3.m3.1.1.1.1.2.2" xref="A3.p2.3.m3.1.1.1.1.2.2.cmml">Î²</mi><mn id="A3.p2.3.m3.1.1.1.1.2.3" xref="A3.p2.3.m3.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A3.p2.3.m3.1.1.1.1.1" xref="A3.p2.3.m3.1.1.1.1.1.cmml">=</mo><mn id="A3.p2.3.m3.1.1.1.1.3" xref="A3.p2.3.m3.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="A3.p2.3.m3.2.2.2.3" xref="A3.p2.3.m3.2.2.3a.cmml">,</mo><mrow id="A3.p2.3.m3.2.2.2.2.2" xref="A3.p2.3.m3.2.2.2.2.3.cmml"><mrow id="A3.p2.3.m3.2.2.2.2.1.1" xref="A3.p2.3.m3.2.2.2.2.1.1.cmml"><msub id="A3.p2.3.m3.2.2.2.2.1.1.2" xref="A3.p2.3.m3.2.2.2.2.1.1.2.cmml"><mi id="A3.p2.3.m3.2.2.2.2.1.1.2.2" xref="A3.p2.3.m3.2.2.2.2.1.1.2.2.cmml">Î²</mi><mn id="A3.p2.3.m3.2.2.2.2.1.1.2.3" xref="A3.p2.3.m3.2.2.2.2.1.1.2.3.cmml">2</mn></msub><mo id="A3.p2.3.m3.2.2.2.2.1.1.1" xref="A3.p2.3.m3.2.2.2.2.1.1.1.cmml">=</mo><mn id="A3.p2.3.m3.2.2.2.2.1.1.3" xref="A3.p2.3.m3.2.2.2.2.1.1.3.cmml">0.98</mn></mrow><mo id="A3.p2.3.m3.2.2.2.2.2.3" xref="A3.p2.3.m3.2.2.2.2.3a.cmml">,</mo><mrow id="A3.p2.3.m3.2.2.2.2.2.2" xref="A3.p2.3.m3.2.2.2.2.2.2.cmml"><mi id="A3.p2.3.m3.2.2.2.2.2.2.2" xref="A3.p2.3.m3.2.2.2.2.2.2.2.cmml">Îµ</mi><mo id="A3.p2.3.m3.2.2.2.2.2.2.1" xref="A3.p2.3.m3.2.2.2.2.2.2.1.cmml">=</mo><msup id="A3.p2.3.m3.2.2.2.2.2.2.3" xref="A3.p2.3.m3.2.2.2.2.2.2.3.cmml"><mn id="A3.p2.3.m3.2.2.2.2.2.2.3.2" xref="A3.p2.3.m3.2.2.2.2.2.2.3.2.cmml">10</mn><mrow id="A3.p2.3.m3.2.2.2.2.2.2.3.3" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3.cmml"><mo id="A3.p2.3.m3.2.2.2.2.2.2.3.3a" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3.cmml">âˆ’</mo><mn id="A3.p2.3.m3.2.2.2.2.2.2.3.3.2" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3.2.cmml">6</mn></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.2b"><apply id="A3.p2.3.m3.2.2.3.cmml" xref="A3.p2.3.m3.2.2.2"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.3a.cmml" xref="A3.p2.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="A3.p2.3.m3.1.1.1.1.cmml" xref="A3.p2.3.m3.1.1.1.1"><eq id="A3.p2.3.m3.1.1.1.1.1.cmml" xref="A3.p2.3.m3.1.1.1.1.1"></eq><apply id="A3.p2.3.m3.1.1.1.1.2.cmml" xref="A3.p2.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.p2.3.m3.1.1.1.1.2.1.cmml" xref="A3.p2.3.m3.1.1.1.1.2">subscript</csymbol><ci id="A3.p2.3.m3.1.1.1.1.2.2.cmml" xref="A3.p2.3.m3.1.1.1.1.2.2">ğ›½</ci><cn type="integer" id="A3.p2.3.m3.1.1.1.1.2.3.cmml" xref="A3.p2.3.m3.1.1.1.1.2.3">1</cn></apply><cn type="float" id="A3.p2.3.m3.1.1.1.1.3.cmml" xref="A3.p2.3.m3.1.1.1.1.3">0.9</cn></apply><apply id="A3.p2.3.m3.2.2.2.2.3.cmml" xref="A3.p2.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.2.2.3a.cmml" xref="A3.p2.3.m3.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A3.p2.3.m3.2.2.2.2.1.1.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1"><eq id="A3.p2.3.m3.2.2.2.2.1.1.1.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.1"></eq><apply id="A3.p2.3.m3.2.2.2.2.1.1.2.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.2.2.1.1.2.1.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.2">subscript</csymbol><ci id="A3.p2.3.m3.2.2.2.2.1.1.2.2.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.2.2">ğ›½</ci><cn type="integer" id="A3.p2.3.m3.2.2.2.2.1.1.2.3.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.2.3">2</cn></apply><cn type="float" id="A3.p2.3.m3.2.2.2.2.1.1.3.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.3">0.98</cn></apply><apply id="A3.p2.3.m3.2.2.2.2.2.2.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2"><eq id="A3.p2.3.m3.2.2.2.2.2.2.1.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.1"></eq><ci id="A3.p2.3.m3.2.2.2.2.2.2.2.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.2">ğœ€</ci><apply id="A3.p2.3.m3.2.2.2.2.2.2.3.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.2.2.2.2.3.1.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3">superscript</csymbol><cn type="integer" id="A3.p2.3.m3.2.2.2.2.2.2.3.2.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3.2">10</cn><apply id="A3.p2.3.m3.2.2.2.2.2.2.3.3.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3"><minus id="A3.p2.3.m3.2.2.2.2.2.2.3.3.1.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3"></minus><cn type="integer" id="A3.p2.3.m3.2.2.2.2.2.2.3.3.2.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3.2">6</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.2c">\beta_{1}=0.9,\beta_{2}=0.98,\varepsilon=10^{-6}</annotation></semantics></math>).</p>
<ul id="A3.I1" class="ltx_itemize">
<li id="A3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I1.i1.p1" class="ltx_para ltx_noindent">
<p id="A3.I1.i1.p1.1" class="ltx_p">For the <span id="A3.I1.i1.p1.1.1" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioS</span> dataset, we train for 80,000 steps with a batch size of 192, which is twice their batch size.</p>
</div>
</li>
<li id="A3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I1.i2.p1" class="ltx_para ltx_noindent">
<p id="A3.I1.i2.p1.1" class="ltx_p">For the <span id="A3.I1.i2.p1.1.1" class="ltx_text ltx_markedasmath ltx_font_sansserif">bioR</span> dataset, we train for 150,000 steps with a batch size of 192, which is twice their batch size.</p>
</div>
</li>
</ul>
</div>
<div id="A3.p3" class="ltx_para ltx_noindent">
<p id="A3.p3.1" class="ltx_p">During pre-training (or mixed-training), we use a weight decay of 0.03 and select the best among three learning rates: 0.0005, 0.001, 0.002; we also employ 1000 steps of learning rate warmup. During finetuning (FT), we use a weight decay of 0.01, and select the best among two learning rates: 0.0003 or 0.0005; we do not use learning rate warmup.
During mixed-training, we use <math id="A3.p3.1.m1.1" class="ltx_Math" alttext="{\mathsf{QA}_{r}}=0.3" display="inline"><semantics id="A3.p3.1.m1.1a"><mrow id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml"><msub id="A3.p3.1.m1.1.1.2" xref="A3.p3.1.m1.1.1.2.cmml"><mi id="A3.p3.1.m1.1.1.2.2" xref="A3.p3.1.m1.1.1.2.2.cmml">ğ–°ğ– </mi><mi id="A3.p3.1.m1.1.1.2.3" xref="A3.p3.1.m1.1.1.2.3.cmml">r</mi></msub><mo id="A3.p3.1.m1.1.1.1" xref="A3.p3.1.m1.1.1.1.cmml">=</mo><mn id="A3.p3.1.m1.1.1.3" xref="A3.p3.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><apply id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1"><eq id="A3.p3.1.m1.1.1.1.cmml" xref="A3.p3.1.m1.1.1.1"></eq><apply id="A3.p3.1.m1.1.1.2.cmml" xref="A3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A3.p3.1.m1.1.1.2.1.cmml" xref="A3.p3.1.m1.1.1.2">subscript</csymbol><ci id="A3.p3.1.m1.1.1.2.2.cmml" xref="A3.p3.1.m1.1.1.2.2">ğ–°ğ– </ci><ci id="A3.p3.1.m1.1.1.2.3.cmml" xref="A3.p3.1.m1.1.1.2.3">ğ‘Ÿ</ci></apply><cn type="float" id="A3.p3.1.m1.1.1.3.cmml" xref="A3.p3.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">{\mathsf{QA}_{r}}=0.3</annotation></semantics></math> which means 30% of the training tokens come from instruction finetune data.</p>
</div>
<section id="A3.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Reversal QA tasks.</h4>

<div id="A3.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A3.SS0.SSS0.Px1.p1.1" class="ltx_p">We consider four reversal tasks from <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a href="#bib.bib2" title="" class="ltx_ref">2023b</a>)</cite>:</p>
<ul id="A3.I2" class="ltx_itemize ltx_centering">
<li id="A3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I2.i1.p1" class="ltx_para">
<p id="A3.I2.i1.p1.1" class="ltx_p">Give me the [last/full] name of the person born on October 2, 1996?
 (<span id="A3.I2.i1.p1.1.1" class="ltx_text ltx_font_typewriter">bdate_to_last</span>, <span id="A3.I2.i1.p1.1.2" class="ltx_text ltx_font_typewriter">bdate_to_full</span>)</p>
</div>
</li>
<li id="A3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I2.i2.p1" class="ltx_para">
<p id="A3.I2.i2.p1.1" class="ltx_p">Give me the [last/full] name of the person who studied Communications at Massachusetts Institute of Technology and worked for Meta Platforms?
 (<span id="A3.I2.i2.p1.1.1" class="ltx_text ltx_font_typewriter">three_to_last</span>, <span id="A3.I2.i2.p1.1.2" class="ltx_text ltx_font_typewriter">three_to_full</span>)</p>
</div>
</li>
<li id="A3.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I2.i3.p1" class="ltx_para">
<p id="A3.I2.i3.p1.1" class="ltx_p">Give me the [last/full] name of the person who studied Communications at Massachusetts Institute of Technology, was born in Princeton, NJ, and worked for Meta Platforms?
 (<span id="A3.I2.i3.p1.1.1" class="ltx_text ltx_font_typewriter">four_to_last</span>, <span id="A3.I2.i3.p1.1.2" class="ltx_text ltx_font_typewriter">four_to_full</span>)</p>
</div>
</li>
<li id="A3.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I2.i4.p1" class="ltx_para ltx_noindent">
<p id="A3.I2.i4.p1.1" class="ltx_p">Give me the [last/full] name of the person who studied Communications at Massachusetts Institute of Technology, was born on October 2, 1996 in Princeton, NJ, and worked for Meta Platforms at Menlo Park, CA?
 (<span id="A3.I2.i4.p1.1.1" class="ltx_text ltx_font_typewriter">all_to_last</span>, <span id="A3.I2.i4.p1.1.2" class="ltx_text ltx_font_typewriter">all_to_full</span>)</p>
</div>
</li>
</ul>
</div>
</section>
<section id="A3.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Forward QA tasks.</h4>

<div id="A3.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="A3.SS0.SSS0.Px2.p1.1" class="ltx_p">We consider the same six forward tasks from <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a href="#bib.bib1" title="" class="ltx_ref">2023a</a>)</cite>:</p>
<div class="ltx_pagination ltx_centering ltx_role_start_2_columns"></div>
<ul id="A3.I3" class="ltx_itemize ltx_centering">
<li id="A3.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I3.i1.p1" class="ltx_para">
<p id="A3.I3.i1.p1.1" class="ltx_p">What is the birth date of Anya Briar Forger? 
<br class="ltx_break">Answer: October 2, 1996.</p>
</div>
</li>
<li id="A3.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I3.i2.p1" class="ltx_para">
<p id="A3.I3.i2.p1.1" class="ltx_p">What is the birth city of Anya Briar Forger? 
<br class="ltx_break">Answer: Princeton, NJ.</p>
</div>
</li>
<li id="A3.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I3.i3.p1" class="ltx_para">
<p id="A3.I3.i3.p1.1" class="ltx_p">Which university did Anya Briar Forger study? 
<br class="ltx_break">Answer: Massachusetts Institute of Technology.</p>
</div>
</li>
<li id="A3.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I3.i4.p1" class="ltx_para">
<p id="A3.I3.i4.p1.1" class="ltx_p">What major did Anya Briar Forger study? 
<br class="ltx_break">Answer: Communications.</p>
</div>
</li>
<li id="A3.I3.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I3.i5.p1" class="ltx_para">
<p id="A3.I3.i5.p1.1" class="ltx_p">Which company did Anya Briar Forger work for? 
<br class="ltx_break">Answer: Meta Platforms.</p>
</div>
</li>
<li id="A3.I3.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span> 
<div id="A3.I3.i6.p1" class="ltx_para ltx_noindent">
<p id="A3.I3.i6.p1.1" class="ltx_p">Where did Anya Briar Forger work? 
<br class="ltx_break">Answer: Menlo Park, CA.</p>
</div>
</li>
</ul>
<div class="ltx_pagination ltx_centering ltx_role_end_2_columns"></div>
<p id="A3.SS0.SSS0.Px2.p1.2" class="ltx_p">Full results are summarised in Table&nbsp;<a href="#A3.T10" title="Table 10 â€£ Forward QA tasks. â€£ Appendix C Biography Data Experiment Details â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>. One may notice that our reported forward task accuracies are slightly higher than those reported in <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a href="#bib.bib1" title="" class="ltx_ref">2023a</a>)</cite>. This improvement is attributed to our use of a larger batch size, smaller weight decay, and the best result among three runs.</p>
</div>
<figure id="A3.T10" class="ltx_table"><img src="/html/2403.13799/assets/x1.png" id="A3.T10.g1" class="ltx_graphics ltx_img_landscape" width="422" height="106" alt="[Uncaptioned image]">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span>Forward vs. reversal task accuracy for the data <math id="A3.T10.3.m1.2" class="ltx_Math" alttext="\textsf{bioS},\textsf{bioR}" display="inline"><semantics id="A3.T10.3.m1.2b"><mrow id="A3.T10.3.m1.2.3.2" xref="A3.T10.3.m1.2.3.1.cmml"><mtext class="ltx_mathvariant_sans-serif" id="A3.T10.3.m1.1.1" xref="A3.T10.3.m1.1.1a.cmml">bioS</mtext><mo id="A3.T10.3.m1.2.3.2.1" xref="A3.T10.3.m1.2.3.1.cmml">,</mo><mtext class="ltx_mathvariant_sans-serif" id="A3.T10.3.m1.2.2" xref="A3.T10.3.m1.2.2a.cmml">bioR</mtext></mrow><annotation-xml encoding="MathML-Content" id="A3.T10.3.m1.2c"><list id="A3.T10.3.m1.2.3.1.cmml" xref="A3.T10.3.m1.2.3.2"><ci id="A3.T10.3.m1.1.1a.cmml" xref="A3.T10.3.m1.1.1"><mtext class="ltx_mathvariant_sans-serif" id="A3.T10.3.m1.1.1.cmml" xref="A3.T10.3.m1.1.1">bioS</mtext></ci><ci id="A3.T10.3.m1.2.2a.cmml" xref="A3.T10.3.m1.2.2"><mtext class="ltx_mathvariant_sans-serif" id="A3.T10.3.m1.2.2.cmml" xref="A3.T10.3.m1.2.2">bioR</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.3.m1.2d">\textsf{bioS},\textsf{bioR}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu &amp; Li, <a href="#bib.bib2" title="" class="ltx_ref">2023b</a>)</cite>.

<br class="ltx_break"><svg version="1.1" width="19.41" height="9.46" overflow="visible"><g transform="translate(0,9.46) scale(1,-1)"><path d="M 0,0 502.28,0" stroke="#000000" stroke-width="0.4"></path><g transform="translate(0,9.46) scale(1, -1)"><foreignObject width="19.41" height="9.46" overflow="visible">
<br class="ltx_break"></foreignObject></g><text x="0" y="0" transform="scale(1, -1)" fill="black" font-weight="bold">Left block</text><text x="0" y="0" transform="scale(1, -1)" fill="black" font-weight="bold">= forward QA accuracy (ask for fields given person names).
<g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject width="1.383700013837" height="1.383700013837" overflow="visible">
<br class="ltx_break"></foreignObject></g><text x="0" y="0" transform="scale(1, -1)" fill="black" font-weight="bold">Middle block</text> = reversal QA accuracy (ask for personâ€™s full name given selected bio fields): â€œbdateâ€ = given birthdates only, â€œallâ€™ = given all fields, etc, see <g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject width="1.383700013837" height="1.383700013837" overflow="visible"><a href="#A3" title="Appendix C Biography Data Experiment Details â€£ Reverse Training to Nurse the Reversal Curse" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix&nbsp;C</span></a></foreignObject></g>).
<g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject width="1.383700013837" height="1.383700013837" overflow="visible">
<br class="ltx_break"></foreignObject></g><text x="0" y="0" transform="scale(1, -1)" fill="black" font-weight="bold">Right block</text> = reversal QA accuracy (ask for last name given selected biography fields).
<g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject width="1.383700013837" height="1.383700013837" overflow="visible">
<br class="ltx_break"></foreignObject></g><text x="0" y="0" transform="scale(1, -1)" fill="black" font-weight="bold">FT</text> = pre-train followed by instruction finetune; <text x="0" y="0" transform="scale(1, -1)" fill="black" font-weight="bold">MIX</text> = add instruction FT data to pre-train.
</text></g></svg></figcaption>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.13798" class="ar5iv-nav-button ar5iv-nav-button-prev">â—„</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.13799" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+2403.13799">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.13799" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.13800" class="ar5iv-nav-button ar5iv-nav-button-next">â–º</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 14:57:39 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Ã—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>