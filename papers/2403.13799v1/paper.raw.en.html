<html lang="en" data-theme="light"><head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Reverse Training to Nurse the Reversal Curse</title>
<!--Generated on Wed Mar 20 17:55:35 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2403.13799v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2403.13799v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
        <span class="color-scheme-icon" aria-label="Light mode"></span>
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="#myForm" onclick="event.preventDefault(); var modal = document.getElementById('myForm'); modal.style.display = 'block'; bugReportState.setInitiateWay('Header');">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2403.13799v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2403.13799v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
          <span class="color-scheme-icon"></span>
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S1" title="1 Introduction ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S2" title="2 Reverse Training ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Reverse Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3" title="3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS1" title="3.1 Symbolic reverse task ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Symbolic reverse task</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS2" title="3.2 Reversing Biography Task ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Reversing Biography Task</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS3" title="3.3 Reversing real-world knowledge via pre-training ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Reversing real-world knowledge via pre-training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS4" title="3.4 Reversing fictitious facts via finetuning ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Reversing fictitious facts via finetuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS5" title="3.5 Analysis &amp; ablation experiments ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Analysis &amp; ablation experiments</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS5.SSS0.Px1" title="Does reversal training hurt performance on standard tasks? ‣ 3.5 Analysis &amp; ablation experiments ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title">Does reversal training hurt performance on standard tasks?</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS5.SSS0.Px2" title="Does the unit of reversal matter? ‣ 3.5 Analysis &amp; ablation experiments ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title">Does the unit of reversal matter?</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S4" title="4 Related Work ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S4.SS0.SSS0.Px1" title="Reversal Curse &amp; Mitgiations ‣ 4 Related Work ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title">Reversal Curse &amp; Mitgiations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S4.SS0.SSS0.Px2" title="Right-to-left, masked &amp; other training variants ‣ 4 Related Work ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title">Right-to-left, masked &amp; other training variants</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S5" title="5 Conclusion ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#A1" title="Appendix A Symbolic reverse task details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Symbolic reverse task details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#A2" title="Appendix B Transformer model pre-training ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Transformer model pre-training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#A3" title="Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Biography Data Experiment Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#A3.SS0.SSS0.Px1" title="Reversal QA tasks. ‣ Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title">Reversal QA tasks.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#A3.SS0.SSS0.Px2" title="Forward QA tasks. ‣ Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_title">Forward QA tasks.</span></a></li>
</ol>
</li>
</ol></nav>

<div class="ltx_page_content">
<div aria-label="Conversion errors have been found" class="package-alerts ltx_document" role="status">
<button aria-label="Dismiss alert" onclick="closePopup()">
<span aria-hidden="true"><svg aria-hidden="true" focusable="false" height="20" role="presentation" viewBox="0 0 44 44" width="20">
<path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
<path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
</svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button></span>
</button>
<p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul arial-label="Unsupported packages used in this paper">
<li>failed: overarrows</li>
</ul>
<p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div><div class="section" id="target-section"><div id="license-tr">License: arXiv.org perpetual non-exclusive license</div><div id="watermark-tr">arXiv:2403.13799v1 [cs.CL] 20 Mar 2024</div></div>
<script>
            function closePopup() {
                document.querySelector('.package-alerts').style.display = 'none';
            }
        </script>
<article class="ltx_document ltx_authors_1line"><span class="ltx_ERROR undefined" id="id1">\NewOverArrowCommand</span>
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">reversestart= <span class="ltx_ERROR undefined" id="p1.1.1">\smallermathstyle</span>←,
middle=<span class="ltx_ERROR undefined" id="p1.1.2">\smallermathstyle</span>-,
end=-,
trim=4,





</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<h1 class="ltx_title ltx_title_document">Reverse Training to Nurse the Reversal Curse</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Olga Golovneva 
<br class="ltx_break">FAIR at Meta
&amp;Zeyuan Allen-Zhu
<br class="ltx_break">FAIR at Meta
&amp;Jason Weston
<br class="ltx_break">FAIR at Meta
&amp;Sainbayar Sukhbaatar 
<br class="ltx_break">FAIR at Meta 
<br class="ltx_break">
</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id1.id1">Large language models (LLMs) have a surprising failure: when trained on “A has a feature B”, they do not generalize to “B is a feature of A”, which is termed the Reversal Curse. Even when training with trillions of tokens this issue still appears due to Zipf’s law – hence even if we train on the entire internet.
This work proposes an alternative training scheme, called <span class="ltx_text ltx_font_italic" id="id1.id1.1">reverse training</span>, whereby all words are used twice, doubling the amount of available tokens. The LLM is trained in both forward and reverse directions by reversing training strings while preserving (i.e., not reversing) chosen substrings, such as entities.
We show that data-matched reverse-trained models provide superior performance to standard models on standard tasks, and compute-matched reverse-trained models provide far superior performance on reversal tasks, helping resolve the reversal curse issue.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Language Models (LLMs) trained on internet-scale data perform extremely well on tasks relating to reasoning, common-sense, and world-knowledge. In particular, the range of knowledge captured by LLMs like <span class="ltx_text ltx_font_smallcaps" id="S1.p1.1.1">GPT-4</span> <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib22" title="">2023</a>)</cite> and Llama-2 <cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib33" title="">2023b</a>)</cite> is significantly wider than that of an average person.
However, recent research <cite class="ltx_cite ltx_citemacro_citep">(Berglund et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib5" title="">2023b</a>; Allen-Zhu &amp; Li, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib1" title="">2023a</a>; <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib2" title="">b</a>)</cite> uncovered a curious flaw in the knowledge capabilities of LLMs, coined the <em class="ltx_emph ltx_font_italic" id="S1.p1.1.2">reversal curse</em>.
They experimentally showed that even the currently most powerful LLMs are incapable of “reversing” facts they had learned.
For example, standard LLMs cannot correctly answer “What’s the capital of France?” even if the training data contains “Paris is the capital of France”, unless it also contains text where “France” is followed by “Paris”, such as “As the capital of France, Paris has …”.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">This is a serious problem because it means LLMs cannot learn the equivalence of relations like “A is the capital of B” equals “B’s capital is A” despite being trained on many pairs of such facts.
In contrast, a human child can learn such general rules from just a few observations of both directions, which makes it an elementary function of human intelligence.
The reversal curse may have been hard to notice at first because
most LLMs are trained on internet-scale data, which is likely to contain the most common facts in both directions. However,
due to Zipf’s law <cite class="ltx_cite ltx_citemacro_citep">(Newman, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib21" title="">2005</a>)</cite>, many facts are mentioned rarely, or only once (and hence in one direction). Further, a more common concept can still be attached to more rare concepts, for example the names or details of a celebrity’s parents.
Hence, this can still be measured using real-world facts about celebrities as demonstrated by <cite class="ltx_cite ltx_citemacro_citet">Berglund et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib5" title="">2023b</a>)</cite>.
It can also be revealed using text that often appears in only one direction, such as song lyrics, as demonstrated in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S1.T1" title="Table 1 ‣ 1 Introduction ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this paper, we propose a simple training method to reduce the effect of the reversal curse.
We first observe that LLMs are trained in an autoregressive way from left-to-right, which may contribute to the reversal curse.
While predicting the next word might be more natural, it is also possible to train a LLM in the right-to-left direction, by predicting the previous word from its subsequent words.
Such reverse training has the potential to solve the reversal curse because it allows the model to see a fact in its reverse direction. However, this knowledge has to be transferred to test time left-to-right generations. Viewing the reversed text as a second language, it is known that training on multiple varying sources can be leveraged to help each other via multitasking (e.g., from code to math <cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib29" title="">2024</a>)</cite>, or in cross-lingual pre-training <cite class="ltx_cite ltx_citemacro_citep">(Lample &amp; Conneau, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib14" title="">2019</a>)</cite>). We investigate four reversal types that require minimal processing
and can be seen as this additional “language”: token reversal, word reversal, entity-preserving reversal and random segment reversal.
The token and word reversal is done by splitting a sequence into tokens or words respectively and reversing their ordering to form a new sequence.
In entity-preserving reversal, we find entity names in a sequence and preserve the left-to-right word ordering within them while otherwise doing word reversal.
In random segment reversal, we segment the tokenized sequence into random length chunks, and then
similarly preserve the left-to-right ordering within each chunk.
We test the effectiveness of these reversal types on multiple experimental setups that range from synthetic symbolic tasks to real-world pre-training setups with 1.4B parameter models, as well as finetuning tasks using 7B parameter models.
Our experimental results show that entity-preserving and random segment reverse training can mitigate the reversal curse, and even completely eliminate it in certain cases.
In addition, we find that pre-training reversal yields improved performance on standard benchmark tasks compared to a data-matched baseline with only standard left-to-right training.
Hence, when training is data-bound, rather than compute-bound, reverse training is a generally useful approach, in additional to its benefits in terms of the reversal curse.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S1.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S1.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S1.T1.1.1.1">
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S1.T1.1.1.1.1" style="width:203.8pt;">
<p class="ltx_p ltx_align_top" id="S1.T1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S1.T1.1.1.1.1.1.1">Query:</span> What is the line that comes after “Gave proof through the night that our
flag was still there” in the US anthem?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="S1.T1.1.1.1.2" style="width:203.8pt;">
<p class="ltx_p ltx_align_top" id="S1.T1.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S1.T1.1.1.1.2.1.1">Query:</span> What is the line that comes before “O say does that star-spangled banner yet wave” in the US anthem?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S1.T1.1.2.1">
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="S1.T1.1.2.1.1" style="width:203.8pt;">
<p class="ltx_p ltx_align_top" id="S1.T1.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S1.T1.1.2.1.1.1.1">GPT4<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote1.1.1.1">1</span></span>This example used the GPT4 model accessed at <a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://chat.openai.com/" title="">https://chat.openai.com/</a> on Mar 4th, 2024.</span></span></span>:</span> The line that comes after “Gave proof through the night that our flag was still there” in the U.S. national anthem, “The Star-Spangled Banner,” is:
“<span class="ltx_text" id="S1.T1.1.2.1.1.1.2" style="background-color:#D8D3EA;">O say does that star-spangled banner yet wave</span>”</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S1.T1.1.2.1.2" style="width:203.8pt;">
<p class="ltx_p ltx_align_top" id="S1.T1.1.2.1.2.1"><span class="ltx_text ltx_font_bold" id="S1.T1.1.2.1.2.1.1">GPT4:</span> The line that comes before “O say does that star-spangled banner yet wave” in the US National Anthem, “The Star-Spangled Banner,” is “<span class="ltx_text" id="S1.T1.1.2.1.2.1.2" style="background-color:#EAD9D3;">And the rocket’s red glare, the bombs bursting in air.</span>”</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="S1.T1.1.3.2">
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r ltx_border_t" id="S1.T1.1.3.2.1" style="width:203.8pt;">
<p class="ltx_p ltx_align_top" id="S1.T1.1.3.2.1.1"><span class="ltx_text ltx_font_bold" id="S1.T1.1.3.2.1.1.1">Llama-2 Chat:</span> The line that comes after “Gave proof through the night that our flag was still there” in the US anthem is:
“<span class="ltx_text" id="S1.T1.1.3.2.1.1.2" style="background-color:#D8D3EA;">O say does that star-spangled banner yet wave</span> …</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="S1.T1.1.3.2.2" style="width:203.8pt;">
<p class="ltx_p ltx_align_top" id="S1.T1.1.3.2.2.1"><span class="ltx_text ltx_font_bold" id="S1.T1.1.3.2.2.1.1">Llama-2 Chat:</span> The line that comes before “O say does that star-spangled banner yet wave” in the US anthem is:
“<span class="ltx_text" id="S1.T1.1.3.2.2.1.2" style="background-color:#EAD9D3;">O long may it wave o’er the land of the free and the home of the brave.</span>”</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_bold" id="S1.T1.3.1">An example of the reversal curse:</span> even the most capable LLMs fail to recall a fact in reverse if it is mostly seen only in one direction, such as lines of song lyrics. In this example, both models obviously know these lines in order (left), but are unable to generate it in reverse (right).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S1.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S1.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S1.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S1.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S1.T2.1.1.1.1.1">Transformation</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="S1.T2.1.1.1.2" style="width:261.8pt;"><span class="ltx_text ltx_font_bold ltx_align_top" id="S1.T2.1.1.1.2.1">Training example</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S1.T2.1.2.1">
<th class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S1.T2.1.2.1.1" style="width:108.1pt;">
<p class="ltx_p ltx_align_top" id="S1.T2.1.2.1.1.1">None</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S1.T2.1.2.1.2" style="width:261.8pt;">
<p class="ltx_p ltx_align_top" id="S1.T2.1.2.1.2.1">Cruise was born on July 3, 1962, in Syracuse, New York, to Mary Lee Pfeiffer.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="S1.T2.1.3.2">
<th class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S1.T2.1.3.2.1" style="width:108.1pt;">
<p class="ltx_p ltx_align_top" id="S1.T2.1.3.2.1.1">Word reversal</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S1.T2.1.3.2.2" style="width:261.8pt;">
<p class="ltx_p ltx_align_top" id="S1.T2.1.3.2.2.1">. Pfeiffer Lee Mary to, York New , Syracuse in , 1962 , 3 July on born was Cruise</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="S1.T2.1.4.3">
<th class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S1.T2.1.4.3.1" style="width:108.1pt;">
<p class="ltx_p ltx_align_top" id="S1.T2.1.4.3.1.1">Entity-preserving reversal</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S1.T2.1.4.3.2" style="width:261.8pt;">
<p class="ltx_p ltx_align_top" id="S1.T2.1.4.3.2.1">. <span class="ltx_text ltx_framed_underline" id="S1.T2.1.4.3.2.1.1">Mary Lee Pfeiffer</span> to, <span class="ltx_text ltx_framed_underline" id="S1.T2.1.4.3.2.1.2">Syracuse, New York</span> in ,
1962 , 3 July
on born was <span class="ltx_text ltx_framed_underline" id="S1.T2.1.4.3.2.1.3">Cruise</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="S1.T2.1.5.4">
<th class="ltx_td ltx_align_justify ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S1.T2.1.5.4.1" style="width:108.1pt;">
<p class="ltx_p ltx_align_top" id="S1.T2.1.5.4.1.1">Random segment reversal</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="S1.T2.1.5.4.2" style="width:261.8pt;">
<div class="ltx_block ltx_align_top" id="S1.T2.1.5.4.2.1">
<p class="ltx_p" id="S1.T2.1.5.4.2.1.1">[REV] York, to Mary Lee Pfeiffer . [REV] in Syracuse, New [REV]</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="S1.T2.1.5.4.2.1.2">on July 3, 1962,  [REV]
born [REV] Cruise was</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span><span class="ltx_text ltx_font_bold" id="S1.T2.4.1">Reversal transformations:</span> examples of different reversal types on a given string. In practice, training examples can be much longer (e.g., entire documents during pre-training). The language model is still trained left-to-right on such transformations, and in the word reversal case is essentially predicting the sentence backwards (right-to-left) starting from the last word. The entities which have their word ordering preserved are highlighted by underlines.
In random segment reversal, the segments are separated by “[REV]”.
<span class="ltx_text ltx_font_italic" id="S1.T2.5.2">Reverse training</span> involves training on both the standard (”None” transformation) and reversed examples, hence doubling the amount of training tokens. The reverse transformation can be seen as a second “language” the model has to learn, note this is not the same as reversing the relation between facts, which remains intact, as the model can tell from the syntax whether it is in forward or reverse language prediction mode.

</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Reverse Training</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.2">Reverse training consists of taking a training dataset with <math alttext="N" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_N</annotation></semantics></math> samples <math alttext="\{x_{1},\ldots,x_{N}\}" class="ltx_Math" display="inline" id="S2.p1.2.m2.3"><semantics id="S2.p1.2.m2.3a"><mrow id="S2.p1.2.m2.3.3.2" xref="S2.p1.2.m2.3.3.3.cmml"><mo id="S2.p1.2.m2.3.3.2.3" stretchy="false" xref="S2.p1.2.m2.3.3.3.cmml">{</mo><msub id="S2.p1.2.m2.2.2.1.1" xref="S2.p1.2.m2.2.2.1.1.cmml"><mi id="S2.p1.2.m2.2.2.1.1.2" xref="S2.p1.2.m2.2.2.1.1.2.cmml">x</mi><mn id="S2.p1.2.m2.2.2.1.1.3" xref="S2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p1.2.m2.3.3.2.4" xref="S2.p1.2.m2.3.3.3.cmml">,</mo><mi id="S2.p1.2.m2.1.1" mathvariant="normal" xref="S2.p1.2.m2.1.1.cmml">…</mi><mo id="S2.p1.2.m2.3.3.2.5" xref="S2.p1.2.m2.3.3.3.cmml">,</mo><msub id="S2.p1.2.m2.3.3.2.2" xref="S2.p1.2.m2.3.3.2.2.cmml"><mi id="S2.p1.2.m2.3.3.2.2.2" xref="S2.p1.2.m2.3.3.2.2.2.cmml">x</mi><mi id="S2.p1.2.m2.3.3.2.2.3" xref="S2.p1.2.m2.3.3.2.2.3.cmml">N</mi></msub><mo id="S2.p1.2.m2.3.3.2.6" stretchy="false" xref="S2.p1.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.3b"><set id="S2.p1.2.m2.3.3.3.cmml" xref="S2.p1.2.m2.3.3.2"><apply id="S2.p1.2.m2.2.2.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.p1.2.m2.2.2.1.1.2.cmml" xref="S2.p1.2.m2.2.2.1.1.2">𝑥</ci><cn id="S2.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S2.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">…</ci><apply id="S2.p1.2.m2.3.3.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.3.3.2.2.1.cmml" xref="S2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.p1.2.m2.3.3.2.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2.2">𝑥</ci><ci id="S2.p1.2.m2.3.3.2.2.3.cmml" xref="S2.p1.2.m2.3.3.2.2.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.3c">\{x_{1},\ldots,x_{N}\}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.3d">{ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }</annotation></semantics></math> and constructing the set of reversed samples</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\reverse{x_{i}}={\mbox{REVERSE}}(x_{i}),~{}~{}~{}~{}~{}~{}i=1,\dots N." class="ltx_Math" display="block" id="S2.Ex1.m1.2"><semantics id="S2.Ex1.m1.2a"><mrow id="S2.Ex1.m1.2.2.1"><mrow id="S2.Ex1.m1.2.2.1.1.2" xref="S2.Ex1.m1.2.2.1.1.3.cmml"><mrow id="S2.Ex1.m1.2.2.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.cmml"><mrow id="S2.Ex1.m1.2.2.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.Ex1.m1.2.2.1.1.1.1.3.2" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2b.cmml"><mtext id="S2.Ex1.m1.2.2.1.1.1.1.3.2a" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2b.cmml">\reverse</mtext></merror><mo id="S2.Ex1.m1.2.2.1.1.1.1.3.1" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex1.m1.2.2.1.1.1.1.3.3" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.3.3.2" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.2.cmml">x</mi><mi id="S2.Ex1.m1.2.2.1.1.1.1.3.3.3" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow><mo id="S2.Ex1.m1.2.2.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.2.cmml">=</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.cmml"><mtext id="S2.Ex1.m1.2.2.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.3a.cmml">REVERSE</mtext><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1.m1.2.2.1.1.2.3" rspace="2.147em" xref="S2.Ex1.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.2" xref="S2.Ex1.m1.2.2.1.1.2.2.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.2.3" xref="S2.Ex1.m1.2.2.1.1.2.2.3.cmml">i</mi><mo id="S2.Ex1.m1.2.2.1.1.2.2.2" xref="S2.Ex1.m1.2.2.1.1.2.2.2.cmml">=</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.2.1.1" xref="S2.Ex1.m1.2.2.1.1.2.2.1.2.cmml"><mn id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">1</mn><mo id="S2.Ex1.m1.2.2.1.1.2.2.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.2.1.2.cmml">,</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.2" mathvariant="normal" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.2.cmml">…</mi><mo id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.1.cmml">⁢</mo><mi id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.3.cmml">N</mi></mrow></mrow></mrow></mrow><mo id="S2.Ex1.m1.2.2.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b"><apply id="S2.Ex1.m1.2.2.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.3a.cmml" xref="S2.Ex1.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S2.Ex1.m1.2.2.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1"><eq id="S2.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.2"></eq><apply id="S2.Ex1.m1.2.2.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3"><times id="S2.Ex1.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1"></times><ci id="S2.Ex1.m1.2.2.1.1.1.1.3.2b.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2"><merror class="ltx_ERROR undefined undefined" id="S2.Ex1.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2"><mtext id="S2.Ex1.m1.2.2.1.1.1.1.3.2a.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2">\reverse</mtext></merror></ci><apply id="S2.Ex1.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.2">𝑥</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1"><times id="S2.Ex1.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.2"></times><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.3a.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.3"><mtext id="S2.Ex1.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.3">REVERSE</mtext></ci><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S2.Ex1.m1.2.2.1.1.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2"><eq id="S2.Ex1.m1.2.2.1.1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2"></eq><ci id="S2.Ex1.m1.2.2.1.1.2.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.3">𝑖</ci><list id="S2.Ex1.m1.2.2.1.1.2.2.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1"><cn id="S2.Ex1.m1.1.1.cmml" type="integer" xref="S2.Ex1.m1.1.1">1</cn><apply id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1"><times id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.1"></times><ci id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.2">…</ci><ci id="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.1.1.1.3">𝑁</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">\reverse{x_{i}}={\mbox{REVERSE}}(x_{i}),~{}~{}~{}~{}~{}~{}i=1,\dots N.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.2d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = REVERSE ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_i = 1 , … italic_N .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.5">Training is then conducted using the combined set <math alttext="\{x_{i}\}\cup\{\reverse{x_{i}}\}" class="ltx_Math" display="inline" id="S2.p1.3.m1.2"><semantics id="S2.p1.3.m1.2a"><mrow id="S2.p1.3.m1.2.2" xref="S2.p1.3.m1.2.2.cmml"><mrow id="S2.p1.3.m1.1.1.1.1" xref="S2.p1.3.m1.1.1.1.2.cmml"><mo id="S2.p1.3.m1.1.1.1.1.2" stretchy="false" xref="S2.p1.3.m1.1.1.1.2.cmml">{</mo><msub id="S2.p1.3.m1.1.1.1.1.1" xref="S2.p1.3.m1.1.1.1.1.1.cmml"><mi id="S2.p1.3.m1.1.1.1.1.1.2" xref="S2.p1.3.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p1.3.m1.1.1.1.1.1.3" xref="S2.p1.3.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p1.3.m1.1.1.1.1.3" stretchy="false" xref="S2.p1.3.m1.1.1.1.2.cmml">}</mo></mrow><mo id="S2.p1.3.m1.2.2.3" xref="S2.p1.3.m1.2.2.3.cmml">∪</mo><mrow id="S2.p1.3.m1.2.2.2.1" xref="S2.p1.3.m1.2.2.2.2.cmml"><mo id="S2.p1.3.m1.2.2.2.1.2" stretchy="false" xref="S2.p1.3.m1.2.2.2.2.cmml">{</mo><mrow id="S2.p1.3.m1.2.2.2.1.1" xref="S2.p1.3.m1.2.2.2.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.p1.3.m1.2.2.2.1.1.2" xref="S2.p1.3.m1.2.2.2.1.1.2b.cmml"><mtext id="S2.p1.3.m1.2.2.2.1.1.2a" xref="S2.p1.3.m1.2.2.2.1.1.2b.cmml">\reverse</mtext></merror><mo id="S2.p1.3.m1.2.2.2.1.1.1" xref="S2.p1.3.m1.2.2.2.1.1.1.cmml">⁢</mo><msub id="S2.p1.3.m1.2.2.2.1.1.3" xref="S2.p1.3.m1.2.2.2.1.1.3.cmml"><mi id="S2.p1.3.m1.2.2.2.1.1.3.2" xref="S2.p1.3.m1.2.2.2.1.1.3.2.cmml">x</mi><mi id="S2.p1.3.m1.2.2.2.1.1.3.3" xref="S2.p1.3.m1.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.p1.3.m1.2.2.2.1.3" stretchy="false" xref="S2.p1.3.m1.2.2.2.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m1.2b"><apply id="S2.p1.3.m1.2.2.cmml" xref="S2.p1.3.m1.2.2"><union id="S2.p1.3.m1.2.2.3.cmml" xref="S2.p1.3.m1.2.2.3"></union><set id="S2.p1.3.m1.1.1.1.2.cmml" xref="S2.p1.3.m1.1.1.1.1"><apply id="S2.p1.3.m1.1.1.1.1.1.cmml" xref="S2.p1.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m1.1.1.1.1.1.1.cmml" xref="S2.p1.3.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.3.m1.1.1.1.1.1.2.cmml" xref="S2.p1.3.m1.1.1.1.1.1.2">𝑥</ci><ci id="S2.p1.3.m1.1.1.1.1.1.3.cmml" xref="S2.p1.3.m1.1.1.1.1.1.3">𝑖</ci></apply></set><set id="S2.p1.3.m1.2.2.2.2.cmml" xref="S2.p1.3.m1.2.2.2.1"><apply id="S2.p1.3.m1.2.2.2.1.1.cmml" xref="S2.p1.3.m1.2.2.2.1.1"><times id="S2.p1.3.m1.2.2.2.1.1.1.cmml" xref="S2.p1.3.m1.2.2.2.1.1.1"></times><ci id="S2.p1.3.m1.2.2.2.1.1.2b.cmml" xref="S2.p1.3.m1.2.2.2.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.p1.3.m1.2.2.2.1.1.2.cmml" xref="S2.p1.3.m1.2.2.2.1.1.2"><mtext id="S2.p1.3.m1.2.2.2.1.1.2a.cmml" xref="S2.p1.3.m1.2.2.2.1.1.2">\reverse</mtext></merror></ci><apply id="S2.p1.3.m1.2.2.2.1.1.3.cmml" xref="S2.p1.3.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.p1.3.m1.2.2.2.1.1.3.1.cmml" xref="S2.p1.3.m1.2.2.2.1.1.3">subscript</csymbol><ci id="S2.p1.3.m1.2.2.2.1.1.3.2.cmml" xref="S2.p1.3.m1.2.2.2.1.1.3.2">𝑥</ci><ci id="S2.p1.3.m1.2.2.2.1.1.3.3.cmml" xref="S2.p1.3.m1.2.2.2.1.1.3.3">𝑖</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m1.2c">\{x_{i}\}\cup\{\reverse{x_{i}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m1.2d">{ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } ∪ { italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> of <math alttext="2N" class="ltx_Math" display="inline" id="S2.p1.4.m2.1"><semantics id="S2.p1.4.m2.1a"><mrow id="S2.p1.4.m2.1.1" xref="S2.p1.4.m2.1.1.cmml"><mn id="S2.p1.4.m2.1.1.2" xref="S2.p1.4.m2.1.1.2.cmml">2</mn><mo id="S2.p1.4.m2.1.1.1" xref="S2.p1.4.m2.1.1.1.cmml">⁢</mo><mi id="S2.p1.4.m2.1.1.3" xref="S2.p1.4.m2.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m2.1b"><apply id="S2.p1.4.m2.1.1.cmml" xref="S2.p1.4.m2.1.1"><times id="S2.p1.4.m2.1.1.1.cmml" xref="S2.p1.4.m2.1.1.1"></times><cn id="S2.p1.4.m2.1.1.2.cmml" type="integer" xref="S2.p1.4.m2.1.1.2">2</cn><ci id="S2.p1.4.m2.1.1.3.cmml" xref="S2.p1.4.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m2.1c">2N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m2.1d">2 italic_N</annotation></semantics></math> training samples, using the typical language modeling objective.
The function <math alttext="\mbox{REVERSE}(\cdot)" class="ltx_Math" display="inline" id="S2.p1.5.m3.1"><semantics id="S2.p1.5.m3.1a"><mrow id="S2.p1.5.m3.1.2" xref="S2.p1.5.m3.1.2.cmml"><mtext id="S2.p1.5.m3.1.2.2" xref="S2.p1.5.m3.1.2.2a.cmml">REVERSE</mtext><mo id="S2.p1.5.m3.1.2.1" xref="S2.p1.5.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p1.5.m3.1.2.3.2" xref="S2.p1.5.m3.1.2.cmml"><mo id="S2.p1.5.m3.1.2.3.2.1" stretchy="false" xref="S2.p1.5.m3.1.2.cmml">(</mo><mo id="S2.p1.5.m3.1.1" lspace="0em" rspace="0em" xref="S2.p1.5.m3.1.1.cmml">⋅</mo><mo id="S2.p1.5.m3.1.2.3.2.2" stretchy="false" xref="S2.p1.5.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m3.1b"><apply id="S2.p1.5.m3.1.2.cmml" xref="S2.p1.5.m3.1.2"><times id="S2.p1.5.m3.1.2.1.cmml" xref="S2.p1.5.m3.1.2.1"></times><ci id="S2.p1.5.m3.1.2.2a.cmml" xref="S2.p1.5.m3.1.2.2"><mtext id="S2.p1.5.m3.1.2.2.cmml" xref="S2.p1.5.m3.1.2.2">REVERSE</mtext></ci><ci id="S2.p1.5.m3.1.1.cmml" xref="S2.p1.5.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m3.1c">\mbox{REVERSE}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m3.1d">REVERSE ( ⋅ )</annotation></semantics></math> reverses the given string, where we consider various choices of reversal type:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.4"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.4.1">Token reversal</span> (<math alttext="\mbox{REVERSE}_{token}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><msub id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml"><mtext id="S2.I1.i1.p1.1.m1.1.1.2" xref="S2.I1.i1.p1.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S2.I1.i1.p1.1.m1.1.1.3" xref="S2.I1.i1.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.3.2" xref="S2.I1.i1.p1.1.m1.1.1.3.2.cmml">t</mi><mo id="S2.I1.i1.p1.1.m1.1.1.3.1" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.3" xref="S2.I1.i1.p1.1.m1.1.1.3.3.cmml">o</mi><mo id="S2.I1.i1.p1.1.m1.1.1.3.1a" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.4" xref="S2.I1.i1.p1.1.m1.1.1.3.4.cmml">k</mi><mo id="S2.I1.i1.p1.1.m1.1.1.3.1b" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.5" xref="S2.I1.i1.p1.1.m1.1.1.3.5.cmml">e</mi><mo id="S2.I1.i1.p1.1.m1.1.1.3.1c" xref="S2.I1.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p1.1.m1.1.1.3.6" xref="S2.I1.i1.p1.1.m1.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><apply id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.2a.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2"><mtext id="S2.I1.i1.p1.1.m1.1.1.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S2.I1.i1.p1.1.m1.1.1.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3"><times id="S2.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.1"></times><ci id="S2.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.2">𝑡</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.3">𝑜</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.4.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.4">𝑘</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.5.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.5">𝑒</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3.6.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\mbox{REVERSE}_{token}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">REVERSE start_POSTSUBSCRIPT italic_t italic_o italic_k italic_e italic_n end_POSTSUBSCRIPT</annotation></semantics></math>): A given input <math alttext="x_{i}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.2.m2.1"><semantics id="S2.I1.i1.p1.2.m2.1a"><msub id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.2.cmml">x</mi><mi id="S2.I1.i1.p1.2.m2.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><apply id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2">𝑥</ci><ci id="S2.I1.i1.p1.2.m2.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, when tokenized, e.g. using BPE <cite class="ltx_cite ltx_citemacro_citep">(Sennrich et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib27" title="">2015</a>)</cite>, consists of tokens <math alttext="x_{i}^{t}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.3.m3.1"><semantics id="S2.I1.i1.p1.3.m3.1a"><msubsup id="S2.I1.i1.p1.3.m3.1.1" xref="S2.I1.i1.p1.3.m3.1.1.cmml"><mi id="S2.I1.i1.p1.3.m3.1.1.2.2" xref="S2.I1.i1.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="S2.I1.i1.p1.3.m3.1.1.2.3" xref="S2.I1.i1.p1.3.m3.1.1.2.3.cmml">i</mi><mi id="S2.I1.i1.p1.3.m3.1.1.3" xref="S2.I1.i1.p1.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.3.m3.1b"><apply id="S2.I1.i1.p1.3.m3.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.3.m3.1.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1">superscript</csymbol><apply id="S2.I1.i1.p1.3.m3.1.1.2.cmml" xref="S2.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.3.m3.1.1.2.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.3.m3.1.1.2.2.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2.2">𝑥</ci><ci id="S2.I1.i1.p1.3.m3.1.1.2.3.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S2.I1.i1.p1.3.m3.1.1.3.cmml" xref="S2.I1.i1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.3.m3.1c">x_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, and the reversed version has the form <math alttext="\reverse{x_{i}}^{t}=x_{i}^{|x_{i}|-t+1}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.4.m4.1"><semantics id="S2.I1.i1.p1.4.m4.1a"><mrow id="S2.I1.i1.p1.4.m4.1.2" xref="S2.I1.i1.p1.4.m4.1.2.cmml"><mrow id="S2.I1.i1.p1.4.m4.1.2.2" xref="S2.I1.i1.p1.4.m4.1.2.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.I1.i1.p1.4.m4.1.2.2.2" xref="S2.I1.i1.p1.4.m4.1.2.2.2b.cmml"><mtext id="S2.I1.i1.p1.4.m4.1.2.2.2a" xref="S2.I1.i1.p1.4.m4.1.2.2.2b.cmml">\reverse</mtext></merror><mo id="S2.I1.i1.p1.4.m4.1.2.2.1" xref="S2.I1.i1.p1.4.m4.1.2.2.1.cmml">⁢</mo><mmultiscripts id="S2.I1.i1.p1.4.m4.1.2.2.3" xref="S2.I1.i1.p1.4.m4.1.2.2.3.cmml"><mi id="S2.I1.i1.p1.4.m4.1.2.2.3.2.2" xref="S2.I1.i1.p1.4.m4.1.2.2.3.2.2.cmml">x</mi><mi id="S2.I1.i1.p1.4.m4.1.2.2.3.2.3" xref="S2.I1.i1.p1.4.m4.1.2.2.3.2.3.cmml">i</mi><mrow id="S2.I1.i1.p1.4.m4.1.2.2.3a" xref="S2.I1.i1.p1.4.m4.1.2.2.3.cmml"></mrow><mrow id="S2.I1.i1.p1.4.m4.1.2.2.3b" xref="S2.I1.i1.p1.4.m4.1.2.2.3.cmml"></mrow><mi id="S2.I1.i1.p1.4.m4.1.2.2.3.3" xref="S2.I1.i1.p1.4.m4.1.2.2.3.3.cmml">t</mi></mmultiscripts></mrow><mo id="S2.I1.i1.p1.4.m4.1.2.1" xref="S2.I1.i1.p1.4.m4.1.2.1.cmml">=</mo><msubsup id="S2.I1.i1.p1.4.m4.1.2.3" xref="S2.I1.i1.p1.4.m4.1.2.3.cmml"><mi id="S2.I1.i1.p1.4.m4.1.2.3.2.2" xref="S2.I1.i1.p1.4.m4.1.2.3.2.2.cmml">x</mi><mi id="S2.I1.i1.p1.4.m4.1.2.3.2.3" xref="S2.I1.i1.p1.4.m4.1.2.3.2.3.cmml">i</mi><mrow id="S2.I1.i1.p1.4.m4.1.1.1" xref="S2.I1.i1.p1.4.m4.1.1.1.cmml"><mrow id="S2.I1.i1.p1.4.m4.1.1.1.1" xref="S2.I1.i1.p1.4.m4.1.1.1.1.cmml"><mrow id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.cmml"><mo id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.1.cmml">|</mo><msub id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.I1.i1.p1.4.m4.1.1.1.1.2" xref="S2.I1.i1.p1.4.m4.1.1.1.1.2.cmml">−</mo><mi id="S2.I1.i1.p1.4.m4.1.1.1.1.3" xref="S2.I1.i1.p1.4.m4.1.1.1.1.3.cmml">t</mi></mrow><mo id="S2.I1.i1.p1.4.m4.1.1.1.2" xref="S2.I1.i1.p1.4.m4.1.1.1.2.cmml">+</mo><mn id="S2.I1.i1.p1.4.m4.1.1.1.3" xref="S2.I1.i1.p1.4.m4.1.1.1.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.4.m4.1b"><apply id="S2.I1.i1.p1.4.m4.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2"><eq id="S2.I1.i1.p1.4.m4.1.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.1"></eq><apply id="S2.I1.i1.p1.4.m4.1.2.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2"><times id="S2.I1.i1.p1.4.m4.1.2.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.1"></times><ci id="S2.I1.i1.p1.4.m4.1.2.2.2b.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.2"><merror class="ltx_ERROR undefined undefined" id="S2.I1.i1.p1.4.m4.1.2.2.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.2"><mtext id="S2.I1.i1.p1.4.m4.1.2.2.2a.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.2">\reverse</mtext></merror></ci><apply id="S2.I1.i1.p1.4.m4.1.2.2.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.2.2.3.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3">superscript</csymbol><apply id="S2.I1.i1.p1.4.m4.1.2.2.3.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.2.2.3.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.4.m4.1.2.2.3.2.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3.2.2">𝑥</ci><ci id="S2.I1.i1.p1.4.m4.1.2.2.3.2.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3.2.3">𝑖</ci></apply><ci id="S2.I1.i1.p1.4.m4.1.2.2.3.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.2.3.3">𝑡</ci></apply></apply><apply id="S2.I1.i1.p1.4.m4.1.2.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.2.3.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3">superscript</csymbol><apply id="S2.I1.i1.p1.4.m4.1.2.3.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.2.3.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.4.m4.1.2.3.2.2.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3.2.2">𝑥</ci><ci id="S2.I1.i1.p1.4.m4.1.2.3.2.3.cmml" xref="S2.I1.i1.p1.4.m4.1.2.3.2.3">𝑖</ci></apply><apply id="S2.I1.i1.p1.4.m4.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1"><plus id="S2.I1.i1.p1.4.m4.1.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.2"></plus><apply id="S2.I1.i1.p1.4.m4.1.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1"><minus id="S2.I1.i1.p1.4.m4.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.2"></minus><apply id="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1"><abs id="S2.I1.i1.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.2"></abs><apply id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S2.I1.i1.p1.4.m4.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.4.m4.1.1.1.1.3">𝑡</ci></apply><cn id="S2.I1.i1.p1.4.m4.1.1.1.3.cmml" type="integer" xref="S2.I1.i1.p1.4.m4.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.4.m4.1c">\reverse{x_{i}}^{t}=x_{i}^{|x_{i}|-t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | - italic_t + 1 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.1.1">Word reversal</span> (<math alttext="\mbox{REVERSE}_{word}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><msub id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mtext id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.3.2" xref="S2.I1.i2.p1.1.m1.1.1.3.2.cmml">w</mi><mo id="S2.I1.i2.p1.1.m1.1.1.3.1" xref="S2.I1.i2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.3" xref="S2.I1.i2.p1.1.m1.1.1.3.3.cmml">o</mi><mo id="S2.I1.i2.p1.1.m1.1.1.3.1a" xref="S2.I1.i2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.4" xref="S2.I1.i2.p1.1.m1.1.1.3.4.cmml">r</mi><mo id="S2.I1.i2.p1.1.m1.1.1.3.1b" xref="S2.I1.i2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i2.p1.1.m1.1.1.3.5" xref="S2.I1.i2.p1.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.2a.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2"><mtext id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3"><times id="S2.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.1"></times><ci id="S2.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.2">𝑤</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.3">𝑜</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.4.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.4">𝑟</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.5.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\mbox{REVERSE}_{word}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">REVERSE start_POSTSUBSCRIPT italic_w italic_o italic_r italic_d end_POSTSUBSCRIPT</annotation></semantics></math>): Each example is first split into words.<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>We use the word splitter in NLTK <cite class="ltx_cite ltx_citemacro_citep">(Loper &amp; Bird, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib17" title="">2002</a>)</cite>.</span></span></span> We then reverse the string at the word level, joining it back together with spaces. Note that this input would then typically be tokenized for input into the LLM, e.g. using BPE.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i3.p1.1.1">Entity-preserving reversal</span> (<math alttext="\mbox{REVERSE}_{entity}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.1.m1.1"><semantics id="S2.I1.i3.p1.1.m1.1a"><msub id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml"><mtext id="S2.I1.i3.p1.1.m1.1.1.2" xref="S2.I1.i3.p1.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S2.I1.i3.p1.1.m1.1.1.3" xref="S2.I1.i3.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i3.p1.1.m1.1.1.3.2" xref="S2.I1.i3.p1.1.m1.1.1.3.2.cmml">e</mi><mo id="S2.I1.i3.p1.1.m1.1.1.3.1" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.3" xref="S2.I1.i3.p1.1.m1.1.1.3.3.cmml">n</mi><mo id="S2.I1.i3.p1.1.m1.1.1.3.1a" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.4" xref="S2.I1.i3.p1.1.m1.1.1.3.4.cmml">t</mi><mo id="S2.I1.i3.p1.1.m1.1.1.3.1b" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.5" xref="S2.I1.i3.p1.1.m1.1.1.3.5.cmml">i</mi><mo id="S2.I1.i3.p1.1.m1.1.1.3.1c" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.6" xref="S2.I1.i3.p1.1.m1.1.1.3.6.cmml">t</mi><mo id="S2.I1.i3.p1.1.m1.1.1.3.1d" xref="S2.I1.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i3.p1.1.m1.1.1.3.7" xref="S2.I1.i3.p1.1.m1.1.1.3.7.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b"><apply id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.1.m1.1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.1.m1.1.1.2a.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2"><mtext id="S2.I1.i3.p1.1.m1.1.1.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S2.I1.i3.p1.1.m1.1.1.3.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3"><times id="S2.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.1"></times><ci id="S2.I1.i3.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.2">𝑒</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.3">𝑛</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.4.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.4">𝑡</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.5.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.5">𝑖</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.6.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.6">𝑡</ci><ci id="S2.I1.i3.p1.1.m1.1.1.3.7.cmml" xref="S2.I1.i3.p1.1.m1.1.1.3.7">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">\mbox{REVERSE}_{entity}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.1.m1.1d">REVERSE start_POSTSUBSCRIPT italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT</annotation></semantics></math>): We run an entity detector over a given training sample<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We use the
flair/ner-english-large model for entity detection <cite class="ltx_cite ltx_citemacro_citep">(Schweter &amp; Akbik, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib26" title="">2020</a>)</cite>.</span></span></span>, which also splits the non-entities into words. We then reverse the words, but keep the word-order of entities in their original left-to-right order.
The string is then joined as before with spaces.
See
<a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S1.T2" title="Table 2 ‣ 1 Introduction ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;2</span></a> for an example.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S2.I1.i4.p1">
<p class="ltx_p" id="S2.I1.i4.p1.2"><span class="ltx_text ltx_font_bold" id="S2.I1.i4.p1.2.1">Random segment reversal</span> (<math alttext="\mbox{REVERSE}_{rand}" class="ltx_Math" display="inline" id="S2.I1.i4.p1.1.m1.1"><semantics id="S2.I1.i4.p1.1.m1.1a"><msub id="S2.I1.i4.p1.1.m1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.cmml"><mtext id="S2.I1.i4.p1.1.m1.1.1.2" xref="S2.I1.i4.p1.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S2.I1.i4.p1.1.m1.1.1.3" xref="S2.I1.i4.p1.1.m1.1.1.3.cmml"><mi id="S2.I1.i4.p1.1.m1.1.1.3.2" xref="S2.I1.i4.p1.1.m1.1.1.3.2.cmml">r</mi><mo id="S2.I1.i4.p1.1.m1.1.1.3.1" xref="S2.I1.i4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i4.p1.1.m1.1.1.3.3" xref="S2.I1.i4.p1.1.m1.1.1.3.3.cmml">a</mi><mo id="S2.I1.i4.p1.1.m1.1.1.3.1a" xref="S2.I1.i4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i4.p1.1.m1.1.1.3.4" xref="S2.I1.i4.p1.1.m1.1.1.3.4.cmml">n</mi><mo id="S2.I1.i4.p1.1.m1.1.1.3.1b" xref="S2.I1.i4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.I1.i4.p1.1.m1.1.1.3.5" xref="S2.I1.i4.p1.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.1.m1.1b"><apply id="S2.I1.i4.p1.1.m1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i4.p1.1.m1.1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i4.p1.1.m1.1.1.2a.cmml" xref="S2.I1.i4.p1.1.m1.1.1.2"><mtext id="S2.I1.i4.p1.1.m1.1.1.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S2.I1.i4.p1.1.m1.1.1.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3"><times id="S2.I1.i4.p1.1.m1.1.1.3.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.1"></times><ci id="S2.I1.i4.p1.1.m1.1.1.3.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.2">𝑟</ci><ci id="S2.I1.i4.p1.1.m1.1.1.3.3.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.3">𝑎</ci><ci id="S2.I1.i4.p1.1.m1.1.1.3.4.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.4">𝑛</ci><ci id="S2.I1.i4.p1.1.m1.1.1.3.5.cmml" xref="S2.I1.i4.p1.1.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.1.m1.1c">\mbox{REVERSE}_{rand}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.1.m1.1d">REVERSE start_POSTSUBSCRIPT italic_r italic_a italic_n italic_d end_POSTSUBSCRIPT</annotation></semantics></math>): Instead of running a relatively costly segmentation such as an entity detector, we experiment with randomly segmenting the sequence into chunks of size between 1 and <math alttext="k" class="ltx_Math" display="inline" id="S2.I1.i4.p1.2.m2.1"><semantics id="S2.I1.i4.p1.2.m2.1a"><mi id="S2.I1.i4.p1.2.m2.1.1" xref="S2.I1.i4.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.2.m2.1b"><ci id="S2.I1.i4.p1.2.m2.1.1.cmml" xref="S2.I1.i4.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.2.m2.1d">italic_k</annotation></semantics></math> tokens using uniform sampling.
We then reverse the segments, but keep the word order within each segment in their original left-to-right order.
The segments are then joined with a special token “[REV]”, which indicates the end of left-to-right prediction for the given segment. During training epochs, each time the example is seen we perform a different random segmentation to increase diversity.
See <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S1.T2" title="Table 2 ‣ 1 Introduction ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;2</span></a> (last row) for an example.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Both forward and reversed training samples are shuffled together so that training batches can contain random (unpaired) examples of both types.
In our experiments, we perform reverse training at both the pre-training and finetuning stages, but also ablate these variants to analyze their impact.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">One can view the extra data <math alttext="\{\reverse{x_{i}}\}" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mrow id="S2.p3.1.m1.1.1.1" xref="S2.p3.1.m1.1.1.2.cmml"><mo id="S2.p3.1.m1.1.1.1.2" stretchy="false" xref="S2.p3.1.m1.1.1.2.cmml">{</mo><mrow id="S2.p3.1.m1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.p3.1.m1.1.1.1.1.2" xref="S2.p3.1.m1.1.1.1.1.2b.cmml"><mtext id="S2.p3.1.m1.1.1.1.1.2a" xref="S2.p3.1.m1.1.1.1.1.2b.cmml">\reverse</mtext></merror><mo id="S2.p3.1.m1.1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.p3.1.m1.1.1.1.1.3" xref="S2.p3.1.m1.1.1.1.1.3.cmml"><mi id="S2.p3.1.m1.1.1.1.1.3.2" xref="S2.p3.1.m1.1.1.1.1.3.2.cmml">x</mi><mi id="S2.p3.1.m1.1.1.1.1.3.3" xref="S2.p3.1.m1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.p3.1.m1.1.1.1.3" stretchy="false" xref="S2.p3.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><set id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.1"><apply id="S2.p3.1.m1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1"><times id="S2.p3.1.m1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1.1"></times><ci id="S2.p3.1.m1.1.1.1.1.2b.cmml" xref="S2.p3.1.m1.1.1.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.p3.1.m1.1.1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.1.1.2"><mtext id="S2.p3.1.m1.1.1.1.1.2a.cmml" xref="S2.p3.1.m1.1.1.1.1.2">\reverse</mtext></merror></ci><apply id="S2.p3.1.m1.1.1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.1.3.1.cmml" xref="S2.p3.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.p3.1.m1.1.1.1.1.3.2.cmml" xref="S2.p3.1.m1.1.1.1.1.3.2">𝑥</ci><ci id="S2.p3.1.m1.1.1.1.1.3.3.cmml" xref="S2.p3.1.m1.1.1.1.1.3.3">𝑖</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\{\reverse{x_{i}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">{ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>
as another language that the language model has to learn left-to-right – in this case a reversed natural language, which has a similar difficulty in terms of perplexity. As it is easy for the language model to identify which of these languages it is trying to generate from when predicting the next token, this does not tend to interfere with its language modeling abilities in the standard forward direction.
Further, as it has been shown that LLMs can leverage knowledge across different sources (e.g., code to math <cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib29" title="">2024</a>)</cite>, or different natural languages <cite class="ltx_cite ltx_citemacro_citep">(Lample &amp; Conneau, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib14" title="">2019</a>)</cite>) we hypothesize that the knowledge it learns from the reverse direction can help in the forward direction as well.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Another perspective of reverse training is from an information theory viewpoint.
The language modeling objective is to learn the probability distribution of natural language, which can be conveniently decomposed into next token predictions for each sample <math alttext="x_{i}" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><msub id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mi id="S2.p4.1.m1.1.1.2" xref="S2.p4.1.m1.1.1.2.cmml">x</mi><mi id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.1.cmml" xref="S2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.2">𝑥</ci><ci id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(x_{i}^{1},\ldots,x_{i}^{|x_{i}|})=\prod_{t=1}^{|x_{i}|}p(x_{i}^{t}|x_{i}^{1}%
,\ldots,x_{i}^{t-1})." class="ltx_Math" display="block" id="S2.Ex2.m1.5"><semantics id="S2.Ex2.m1.5a"><mrow id="S2.Ex2.m1.5.5.1" xref="S2.Ex2.m1.5.5.1.1.cmml"><mrow id="S2.Ex2.m1.5.5.1.1" xref="S2.Ex2.m1.5.5.1.1.cmml"><mrow id="S2.Ex2.m1.5.5.1.1.2" xref="S2.Ex2.m1.5.5.1.1.2.cmml"><mi id="S2.Ex2.m1.5.5.1.1.2.4" xref="S2.Ex2.m1.5.5.1.1.2.4.cmml">p</mi><mo id="S2.Ex2.m1.5.5.1.1.2.3" xref="S2.Ex2.m1.5.5.1.1.2.3.cmml">⁢</mo><mrow id="S2.Ex2.m1.5.5.1.1.2.2.2" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml"><mo id="S2.Ex2.m1.5.5.1.1.2.2.2.3" stretchy="false" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml">(</mo><msubsup id="S2.Ex2.m1.5.5.1.1.1.1.1.1" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.3" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml">i</mi><mn id="S2.Ex2.m1.5.5.1.1.1.1.1.1.3" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.Ex2.m1.5.5.1.1.2.2.2.4" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml">,</mo><mi id="S2.Ex2.m1.3.3" mathvariant="normal" xref="S2.Ex2.m1.3.3.cmml">…</mi><mo id="S2.Ex2.m1.5.5.1.1.2.2.2.5" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml">,</mo><msubsup id="S2.Ex2.m1.5.5.1.1.2.2.2.2" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.2" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.3" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.3.cmml">i</mi><mrow id="S2.Ex2.m1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.2.cmml"><mo id="S2.Ex2.m1.1.1.1.1.2" stretchy="false" xref="S2.Ex2.m1.1.1.1.2.1.cmml">|</mo><msub id="S2.Ex2.m1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.1.1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex2.m1.1.1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex2.m1.1.1.1.1.3" stretchy="false" xref="S2.Ex2.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup><mo id="S2.Ex2.m1.5.5.1.1.2.2.2.6" stretchy="false" xref="S2.Ex2.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex2.m1.5.5.1.1.4" rspace="0.111em" xref="S2.Ex2.m1.5.5.1.1.4.cmml">=</mo><mrow id="S2.Ex2.m1.5.5.1.1.3" xref="S2.Ex2.m1.5.5.1.1.3.cmml"><munderover id="S2.Ex2.m1.5.5.1.1.3.2" xref="S2.Ex2.m1.5.5.1.1.3.2.cmml"><mo id="S2.Ex2.m1.5.5.1.1.3.2.2.2" movablelimits="false" xref="S2.Ex2.m1.5.5.1.1.3.2.2.2.cmml">∏</mo><mrow id="S2.Ex2.m1.5.5.1.1.3.2.2.3" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.2.2.3.2" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.2.cmml">t</mi><mo id="S2.Ex2.m1.5.5.1.1.3.2.2.3.1" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.1.cmml">=</mo><mn id="S2.Ex2.m1.5.5.1.1.3.2.2.3.3" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.Ex2.m1.2.2.1.1" xref="S2.Ex2.m1.2.2.1.2.cmml"><mo id="S2.Ex2.m1.2.2.1.1.2" stretchy="false" xref="S2.Ex2.m1.2.2.1.2.1.cmml">|</mo><msub id="S2.Ex2.m1.2.2.1.1.1" xref="S2.Ex2.m1.2.2.1.1.1.cmml"><mi id="S2.Ex2.m1.2.2.1.1.1.2" xref="S2.Ex2.m1.2.2.1.1.1.2.cmml">x</mi><mi id="S2.Ex2.m1.2.2.1.1.1.3" xref="S2.Ex2.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex2.m1.2.2.1.1.3" stretchy="false" xref="S2.Ex2.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S2.Ex2.m1.5.5.1.1.3.1" xref="S2.Ex2.m1.5.5.1.1.3.1.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.3" xref="S2.Ex2.m1.5.5.1.1.3.1.3.cmml">p</mi><mo id="S2.Ex2.m1.5.5.1.1.3.1.2" xref="S2.Ex2.m1.5.5.1.1.3.1.2.cmml">⁢</mo><mrow id="S2.Ex2.m1.5.5.1.1.3.1.1.1" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml"><mo id="S2.Ex2.m1.5.5.1.1.3.1.1.1.2" stretchy="false" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml"><msubsup id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.3.cmml">i</mi><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.3.cmml">t</mi></msubsup><mo fence="false" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.3.cmml">|</mo><mrow id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.3.cmml"><msubsup id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3.cmml">i</mi><mn id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.3.cmml">,</mo><mi id="S2.Ex2.m1.4.4" mathvariant="normal" xref="S2.Ex2.m1.4.4.cmml">…</mi><mo id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.4" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.3.cmml">,</mo><msubsup id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.3.cmml">i</mi><mrow id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.cmml"><mi id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.2" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.1" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.3" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo id="S2.Ex2.m1.5.5.1.1.3.1.1.1.3" stretchy="false" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex2.m1.5.5.1.2" lspace="0em" xref="S2.Ex2.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.5b"><apply id="S2.Ex2.m1.5.5.1.1.cmml" xref="S2.Ex2.m1.5.5.1"><eq id="S2.Ex2.m1.5.5.1.1.4.cmml" xref="S2.Ex2.m1.5.5.1.1.4"></eq><apply id="S2.Ex2.m1.5.5.1.1.2.cmml" xref="S2.Ex2.m1.5.5.1.1.2"><times id="S2.Ex2.m1.5.5.1.1.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.2.3"></times><ci id="S2.Ex2.m1.5.5.1.1.2.4.cmml" xref="S2.Ex2.m1.5.5.1.1.2.4">𝑝</ci><vector id="S2.Ex2.m1.5.5.1.1.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2"><apply id="S2.Ex2.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="S2.Ex2.m1.5.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.Ex2.m1.5.5.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3">…</ci><apply id="S2.Ex2.m1.5.5.1.1.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.2">𝑥</ci><ci id="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.2.2.2.2.2.3">𝑖</ci></apply><apply id="S2.Ex2.m1.1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.1"><abs id="S2.Ex2.m1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.1.1.1.1.2"></abs><apply id="S2.Ex2.m1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.2">𝑥</ci><ci id="S2.Ex2.m1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></vector></apply><apply id="S2.Ex2.m1.5.5.1.1.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3"><apply id="S2.Ex2.m1.5.5.1.1.3.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2">subscript</csymbol><csymbol cd="latexml" id="S2.Ex2.m1.5.5.1.1.3.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2.2.2">product</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3"><eq id="S2.Ex2.m1.5.5.1.1.3.2.2.3.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.1"></eq><ci id="S2.Ex2.m1.5.5.1.1.3.2.2.3.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.2">𝑡</ci><cn id="S2.Ex2.m1.5.5.1.1.3.2.2.3.3.cmml" type="integer" xref="S2.Ex2.m1.5.5.1.1.3.2.2.3.3">1</cn></apply></apply><apply id="S2.Ex2.m1.2.2.1.2.cmml" xref="S2.Ex2.m1.2.2.1.1"><abs id="S2.Ex2.m1.2.2.1.2.1.cmml" xref="S2.Ex2.m1.2.2.1.1.2"></abs><apply id="S2.Ex2.m1.2.2.1.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.1.1.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.2.2.1.1.1.2.cmml" xref="S2.Ex2.m1.2.2.1.1.1.2">𝑥</ci><ci id="S2.Ex2.m1.2.2.1.1.1.3.cmml" xref="S2.Ex2.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S2.Ex2.m1.5.5.1.1.3.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1"><times id="S2.Ex2.m1.5.5.1.1.3.1.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.2"></times><ci id="S2.Ex2.m1.5.5.1.1.3.1.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.3">𝑝</ci><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1"><csymbol cd="latexml" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.3">conditional</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.2">𝑥</ci><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.4.3">𝑡</ci></apply><list id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2"><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.Ex2.m1.4.4.cmml" xref="S2.Ex2.m1.4.4">…</ci><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3"><minus id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.1.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.1"></minus><ci id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.2.cmml" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.2">𝑡</ci><cn id="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S2.Ex2.m1.5.5.1.1.3.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.5c">p(x_{i}^{1},\ldots,x_{i}^{|x_{i}|})=\prod_{t=1}^{|x_{i}|}p(x_{i}^{t}|x_{i}^{1}%
,\ldots,x_{i}^{t-1}).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.5d">italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p4.2">While this left-to-right direction is more natural, the same probability can be decomposed in the reverse direction as well</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(x_{i}^{1},\ldots,x_{i}^{|x_{i}|})=\prod_{t={|x_{i}|}}^{1}p(x_{i}^{t}|x_{i}^{%
t+1},\ldots,x_{i}^{|x_{i}|})." class="ltx_Math" display="block" id="S2.Ex3.m1.6"><semantics id="S2.Ex3.m1.6a"><mrow id="S2.Ex3.m1.6.6.1" xref="S2.Ex3.m1.6.6.1.1.cmml"><mrow id="S2.Ex3.m1.6.6.1.1" xref="S2.Ex3.m1.6.6.1.1.cmml"><mrow id="S2.Ex3.m1.6.6.1.1.2" xref="S2.Ex3.m1.6.6.1.1.2.cmml"><mi id="S2.Ex3.m1.6.6.1.1.2.4" xref="S2.Ex3.m1.6.6.1.1.2.4.cmml">p</mi><mo id="S2.Ex3.m1.6.6.1.1.2.3" xref="S2.Ex3.m1.6.6.1.1.2.3.cmml">⁢</mo><mrow id="S2.Ex3.m1.6.6.1.1.2.2.2" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml"><mo id="S2.Ex3.m1.6.6.1.1.2.2.2.3" stretchy="false" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml">(</mo><msubsup id="S2.Ex3.m1.6.6.1.1.1.1.1.1" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.2" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.3" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.3.cmml">i</mi><mn id="S2.Ex3.m1.6.6.1.1.1.1.1.1.3" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.Ex3.m1.6.6.1.1.2.2.2.4" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml">,</mo><mi id="S2.Ex3.m1.4.4" mathvariant="normal" xref="S2.Ex3.m1.4.4.cmml">…</mi><mo id="S2.Ex3.m1.6.6.1.1.2.2.2.5" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml">,</mo><msubsup id="S2.Ex3.m1.6.6.1.1.2.2.2.2" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.2" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.3" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.3.cmml">i</mi><mrow id="S2.Ex3.m1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.2.cmml"><mo id="S2.Ex3.m1.1.1.1.1.2" stretchy="false" xref="S2.Ex3.m1.1.1.1.2.1.cmml">|</mo><msub id="S2.Ex3.m1.1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.1.1.1.1.1.2" xref="S2.Ex3.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex3.m1.1.1.1.1.1.3" xref="S2.Ex3.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex3.m1.1.1.1.1.3" stretchy="false" xref="S2.Ex3.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup><mo id="S2.Ex3.m1.6.6.1.1.2.2.2.6" stretchy="false" xref="S2.Ex3.m1.6.6.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex3.m1.6.6.1.1.4" rspace="0.111em" xref="S2.Ex3.m1.6.6.1.1.4.cmml">=</mo><mrow id="S2.Ex3.m1.6.6.1.1.3" xref="S2.Ex3.m1.6.6.1.1.3.cmml"><munderover id="S2.Ex3.m1.6.6.1.1.3.2" xref="S2.Ex3.m1.6.6.1.1.3.2.cmml"><mo id="S2.Ex3.m1.6.6.1.1.3.2.2.2" movablelimits="false" xref="S2.Ex3.m1.6.6.1.1.3.2.2.2.cmml">∏</mo><mrow id="S2.Ex3.m1.2.2.1" xref="S2.Ex3.m1.2.2.1.cmml"><mi id="S2.Ex3.m1.2.2.1.3" xref="S2.Ex3.m1.2.2.1.3.cmml">t</mi><mo id="S2.Ex3.m1.2.2.1.2" xref="S2.Ex3.m1.2.2.1.2.cmml">=</mo><mrow id="S2.Ex3.m1.2.2.1.1.1" xref="S2.Ex3.m1.2.2.1.1.2.cmml"><mo id="S2.Ex3.m1.2.2.1.1.1.2" stretchy="false" xref="S2.Ex3.m1.2.2.1.1.2.1.cmml">|</mo><msub id="S2.Ex3.m1.2.2.1.1.1.1" xref="S2.Ex3.m1.2.2.1.1.1.1.cmml"><mi id="S2.Ex3.m1.2.2.1.1.1.1.2" xref="S2.Ex3.m1.2.2.1.1.1.1.2.cmml">x</mi><mi id="S2.Ex3.m1.2.2.1.1.1.1.3" xref="S2.Ex3.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex3.m1.2.2.1.1.1.3" stretchy="false" xref="S2.Ex3.m1.2.2.1.1.2.1.cmml">|</mo></mrow></mrow><mn id="S2.Ex3.m1.6.6.1.1.3.2.3" xref="S2.Ex3.m1.6.6.1.1.3.2.3.cmml">1</mn></munderover><mrow id="S2.Ex3.m1.6.6.1.1.3.1" xref="S2.Ex3.m1.6.6.1.1.3.1.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.3" xref="S2.Ex3.m1.6.6.1.1.3.1.3.cmml">p</mi><mo id="S2.Ex3.m1.6.6.1.1.3.1.2" xref="S2.Ex3.m1.6.6.1.1.3.1.2.cmml">⁢</mo><mrow id="S2.Ex3.m1.6.6.1.1.3.1.1.1" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml"><mo id="S2.Ex3.m1.6.6.1.1.3.1.1.1.2" stretchy="false" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml"><msubsup id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.3.cmml">i</mi><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.3.cmml">t</mi></msubsup><mo fence="false" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.3.cmml">|</mo><mrow id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.3.cmml"><msubsup id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.1" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.3.cmml">,</mo><mi id="S2.Ex3.m1.5.5" mathvariant="normal" xref="S2.Ex3.m1.5.5.cmml">…</mi><mo id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.4" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.3.cmml">,</mo><msubsup id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.cmml"><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.2" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.3" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.3.cmml">i</mi><mrow id="S2.Ex3.m1.3.3.1.1" xref="S2.Ex3.m1.3.3.1.2.cmml"><mo id="S2.Ex3.m1.3.3.1.1.2" stretchy="false" xref="S2.Ex3.m1.3.3.1.2.1.cmml">|</mo><msub id="S2.Ex3.m1.3.3.1.1.1" xref="S2.Ex3.m1.3.3.1.1.1.cmml"><mi id="S2.Ex3.m1.3.3.1.1.1.2" xref="S2.Ex3.m1.3.3.1.1.1.2.cmml">x</mi><mi id="S2.Ex3.m1.3.3.1.1.1.3" xref="S2.Ex3.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S2.Ex3.m1.3.3.1.1.3" stretchy="false" xref="S2.Ex3.m1.3.3.1.2.1.cmml">|</mo></mrow></msubsup></mrow></mrow><mo id="S2.Ex3.m1.6.6.1.1.3.1.1.1.3" stretchy="false" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex3.m1.6.6.1.2" lspace="0em" xref="S2.Ex3.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.6b"><apply id="S2.Ex3.m1.6.6.1.1.cmml" xref="S2.Ex3.m1.6.6.1"><eq id="S2.Ex3.m1.6.6.1.1.4.cmml" xref="S2.Ex3.m1.6.6.1.1.4"></eq><apply id="S2.Ex3.m1.6.6.1.1.2.cmml" xref="S2.Ex3.m1.6.6.1.1.2"><times id="S2.Ex3.m1.6.6.1.1.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.2.3"></times><ci id="S2.Ex3.m1.6.6.1.1.2.4.cmml" xref="S2.Ex3.m1.6.6.1.1.2.4">𝑝</ci><vector id="S2.Ex3.m1.6.6.1.1.2.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2"><apply id="S2.Ex3.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="S2.Ex3.m1.6.6.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.Ex3.m1.6.6.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.Ex3.m1.4.4.cmml" xref="S2.Ex3.m1.4.4">…</ci><apply id="S2.Ex3.m1.6.6.1.1.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.2">𝑥</ci><ci id="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.2.2.2.2.2.3">𝑖</ci></apply><apply id="S2.Ex3.m1.1.1.1.2.cmml" xref="S2.Ex3.m1.1.1.1.1"><abs id="S2.Ex3.m1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.1.1.1.1.2"></abs><apply id="S2.Ex3.m1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.1.1.1.1.1.2">𝑥</ci><ci id="S2.Ex3.m1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></vector></apply><apply id="S2.Ex3.m1.6.6.1.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3"><apply id="S2.Ex3.m1.6.6.1.1.3.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2">subscript</csymbol><csymbol cd="latexml" id="S2.Ex3.m1.6.6.1.1.3.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.2.2.2">product</csymbol><apply id="S2.Ex3.m1.2.2.1.cmml" xref="S2.Ex3.m1.2.2.1"><eq id="S2.Ex3.m1.2.2.1.2.cmml" xref="S2.Ex3.m1.2.2.1.2"></eq><ci id="S2.Ex3.m1.2.2.1.3.cmml" xref="S2.Ex3.m1.2.2.1.3">𝑡</ci><apply id="S2.Ex3.m1.2.2.1.1.2.cmml" xref="S2.Ex3.m1.2.2.1.1.1"><abs id="S2.Ex3.m1.2.2.1.1.2.1.cmml" xref="S2.Ex3.m1.2.2.1.1.1.2"></abs><apply id="S2.Ex3.m1.2.2.1.1.1.1.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.2.2.1.1.1.1.1.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.2.2.1.1.1.1.2.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1.2">𝑥</ci><ci id="S2.Ex3.m1.2.2.1.1.1.1.3.cmml" xref="S2.Ex3.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><cn id="S2.Ex3.m1.6.6.1.1.3.2.3.cmml" type="integer" xref="S2.Ex3.m1.6.6.1.1.3.2.3">1</cn></apply><apply id="S2.Ex3.m1.6.6.1.1.3.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1"><times id="S2.Ex3.m1.6.6.1.1.3.1.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.2"></times><ci id="S2.Ex3.m1.6.6.1.1.3.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.3">𝑝</ci><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1"><csymbol cd="latexml" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.3">conditional</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.2">𝑥</ci><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.4.3">𝑡</ci></apply><list id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2"><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3"><plus id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.1"></plus><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.Ex3.m1.5.5.cmml" xref="S2.Ex3.m1.5.5">…</ci><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.1.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.3.cmml" xref="S2.Ex3.m1.6.6.1.1.3.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S2.Ex3.m1.3.3.1.2.cmml" xref="S2.Ex3.m1.3.3.1.1"><abs id="S2.Ex3.m1.3.3.1.2.1.cmml" xref="S2.Ex3.m1.3.3.1.1.2"></abs><apply id="S2.Ex3.m1.3.3.1.1.1.cmml" xref="S2.Ex3.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.3.3.1.1.1.1.cmml" xref="S2.Ex3.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.3.3.1.1.1.2.cmml" xref="S2.Ex3.m1.3.3.1.1.1.2">𝑥</ci><ci id="S2.Ex3.m1.3.3.1.1.1.3.cmml" xref="S2.Ex3.m1.3.3.1.1.1.3">𝑖</ci></apply></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.6c">p(x_{i}^{1},\ldots,x_{i}^{|x_{i}|})=\prod_{t={|x_{i}|}}^{1}p(x_{i}^{t}|x_{i}^{%
t+1},\ldots,x_{i}^{|x_{i}|}).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m1.6d">italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_t = | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t + 1 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p4.3">If we make an assumption that LLM’s language capabilities are partially due to learning to compress natural language <cite class="ltx_cite ltx_citemacro_citep">(Del’etang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib10" title="">2023</a>)</cite> according to the source coding theorem <cite class="ltx_cite ltx_citemacro_citep">(Shannon, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib28" title="">1948</a>)</cite>, then training in the reverse direction towards the same perplexity should also acquire some of those capabilities.
For example, filling the blank in “<span class="ltx_text ltx_framed_underline" id="S2.p4.3.1">&nbsp;&nbsp;&nbsp;&nbsp;</span> is the capital of France.” requires a similar level of language understanding and world knowledge as predicting the next word of “Paris is the capital of <span class="ltx_text ltx_framed_underline" id="S2.p4.3.2">&nbsp;&nbsp;&nbsp;&nbsp;</span>”.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Symbolic reverse task</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S3.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T3.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T3.3.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.1.1">Training method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S3.T3.3.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T3.3.1.1.2.1">Entity name length</span></th>
</tr>
<tr class="ltx_tr" id="S3.T3.3.2.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.1.1">2 words</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.2.1">3 words</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T3.3.2.2.3.1">5 words</span></th>
</tr>
<tr class="ltx_tr" id="S3.T3.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T3.3.3.3.1">standard</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.2">
<span class="ltx_text ltx_phantom" id="S3.T3.3.3.3.2.1"><span style="visibility:hidden">0</span></span>0.0</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.3">
<span class="ltx_text ltx_phantom" id="S3.T3.3.3.3.3.1"><span style="visibility:hidden">00</span></span>0.0</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T3.3.3.3.4">
<span class="ltx_text ltx_phantom" id="S3.T3.3.3.3.4.1"><span style="visibility:hidden">00</span></span>0</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.4.1.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T3.3.4.1.1.1">word</span>)</th>
<td class="ltx_td ltx_align_right" id="S3.T3.3.4.1.2">95.8</td>
<td class="ltx_td ltx_align_right" id="S3.T3.3.4.1.3">16.9</td>
<td class="ltx_td ltx_align_right" id="S3.T3.3.4.1.4">
<span class="ltx_text ltx_phantom" id="S3.T3.3.4.1.4.1"><span style="visibility:hidden">00</span></span>2.0</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.5.2.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T3.3.5.2.1.1">entity</span>)</th>
<td class="ltx_td ltx_align_right" id="S3.T3.3.5.2.2">100.0</td>
<td class="ltx_td ltx_align_right" id="S3.T3.3.5.2.3">100.0</td>
<td class="ltx_td ltx_align_right" id="S3.T3.3.5.2.4">100.0</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.6.3.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T3.3.6.3.1.1">rand k=2</span>)</th>
<td class="ltx_td ltx_align_right" id="S3.T3.3.6.3.2">100.0</td>
<td class="ltx_td ltx_align_right" id="S3.T3.3.6.3.3">98.4</td>
<td class="ltx_td ltx_align_right" id="S3.T3.3.6.3.4">22.7</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.7.4.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T3.3.7.4.1.1">rand k=3</span>)</th>
<td class="ltx_td ltx_align_right" id="S3.T3.3.7.4.2">100.0</td>
<td class="ltx_td ltx_align_right" id="S3.T3.3.7.4.3">100.0</td>
<td class="ltx_td ltx_align_right" id="S3.T3.3.7.4.4">79.2</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T3.3.8.5.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T3.3.8.5.1.1">rand k=5</span>)</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T3.3.8.5.2">100.0</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T3.3.8.5.3">100.0</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T3.3.8.5.4">100.0</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Test accuracy (%) on the <span class="ltx_text ltx_font_italic" id="S3.T3.5.1">symbolic reverse</span> task. Standard training completely fails. Word reversal works well for shorter entities, but entity preserving reversal is necessary for entities with more words.
Random segment reversal performs well when the maximum segment length <math alttext="k" class="ltx_Math" display="inline" id="S3.T3.2.m1.1"><semantics id="S3.T3.2.m1.1b"><mi id="S3.T3.2.m1.1.1" xref="S3.T3.2.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.T3.2.m1.1c"><ci id="S3.T3.2.m1.1.1.cmml" xref="S3.T3.2.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="S3.T3.2.m1.1e">italic_k</annotation></semantics></math> is at least as long as the entities.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.5">We first create a simple symbol-based (rather than natural language-based) toy dataset to investigate the reversal curse
in a controlled setting.
We start by randomly pairing entities <math alttext="a_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">a</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑎</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="b_{j}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">b</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑏</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">b_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in a one-to-one manner.
The training data contains all the forward <math alttext="a_{i}\rightarrow b_{j}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><msub id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p1.3.m3.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.3.m3.1.1.1" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.cmml">→</mo><msub id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">b</mi><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><ci id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1">→</ci><apply id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.2">𝑎</ci><ci id="S3.SS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">𝑏</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">a_{i}\rightarrow b_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT → italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> mappings, but only half of the backward <math alttext="b_{j}\rightarrow a_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><msub id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.cmml">b</mi><mi id="S3.SS1.p1.4.m4.1.1.2.3" xref="S3.SS1.p1.4.m4.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS1.p1.4.m4.1.1.1" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.cmml">→</mo><msub id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">a</mi><mi id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><ci id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1">→</ci><apply id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2">𝑏</ci><ci id="S3.SS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">𝑎</ci><ci id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">b_{j}\rightarrow a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT → italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> mappings.
The remaining backward mappings form the test data.
To succeed in this task, a model must infer the rule <math alttext="a_{i}\rightarrow b_{j}\Leftrightarrow b_{j}\rightarrow a_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mrow id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml"><msub id="S3.SS1.p1.5.m5.1.1.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.2.cmml">a</mi><mi id="S3.SS1.p1.5.m5.1.1.2.2.3" xref="S3.SS1.p1.5.m5.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.5.m5.1.1.2.1" stretchy="false" xref="S3.SS1.p1.5.m5.1.1.2.1.cmml">→</mo><msub id="S3.SS1.p1.5.m5.1.1.2.3" xref="S3.SS1.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.3.2" xref="S3.SS1.p1.5.m5.1.1.2.3.2.cmml">b</mi><mi id="S3.SS1.p1.5.m5.1.1.2.3.3" xref="S3.SS1.p1.5.m5.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.SS1.p1.5.m5.1.1.1" stretchy="false" xref="S3.SS1.p1.5.m5.1.1.1.cmml">⇔</mo><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><msub id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2.2" xref="S3.SS1.p1.5.m5.1.1.3.2.2.cmml">b</mi><mi id="S3.SS1.p1.5.m5.1.1.3.2.3" xref="S3.SS1.p1.5.m5.1.1.3.2.3.cmml">j</mi></msub><mo id="S3.SS1.p1.5.m5.1.1.3.1" stretchy="false" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">→</mo><msub id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.3.2" xref="S3.SS1.p1.5.m5.1.1.3.3.2.cmml">a</mi><mi id="S3.SS1.p1.5.m5.1.1.3.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><ci id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1">⇔</ci><apply id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2"><ci id="S3.SS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.1">→</ci><apply id="S3.SS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.2">𝑎</ci><ci id="S3.SS1.p1.5.m5.1.1.2.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.2">𝑏</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><ci id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1">→</ci><apply id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2.2">𝑏</ci><ci id="S3.SS1.p1.5.m5.1.1.3.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2.3">𝑗</ci></apply><apply id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3.2">𝑎</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">a_{i}\rightarrow b_{j}\Leftrightarrow b_{j}\rightarrow a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT → italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⇔ italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT → italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from the training data, then generalize it to the pairs in the test data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.4">The entity names are created by combining multiple random code words, e.g. two-word entities <math alttext="a_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">a</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝑎</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> = “<span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.4.1">a12 a64</span>” and <math alttext="b_{j}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">b</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑏</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">b_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> = “<span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.4.2">b54 b42</span>”.
Each sample contains a mapping written like “<span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.4.3">a12 a64 has a feature b54 b42</span>” or its reverse “<span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.4.4">b54 b42 is a feature of a12 a64</span>”.
We use the simple word tokenization, which makes <math alttext="\mbox{REVERSE}_{token}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mtext id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p2.3.m3.1.1.3.1" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">o</mi><mo id="S3.SS1.p2.3.m3.1.1.3.1a" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.3.m3.1.1.3.4" xref="S3.SS1.p2.3.m3.1.1.3.4.cmml">k</mi><mo id="S3.SS1.p2.3.m3.1.1.3.1b" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.3.m3.1.1.3.5" xref="S3.SS1.p2.3.m3.1.1.3.5.cmml">e</mi><mo id="S3.SS1.p2.3.m3.1.1.3.1c" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.3.m3.1.1.3.6" xref="S3.SS1.p2.3.m3.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2a.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><mtext id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><times id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.1"></times><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">𝑜</ci><ci id="S3.SS1.p2.3.m3.1.1.3.4.cmml" xref="S3.SS1.p2.3.m3.1.1.3.4">𝑘</ci><ci id="S3.SS1.p2.3.m3.1.1.3.5.cmml" xref="S3.SS1.p2.3.m3.1.1.3.5">𝑒</ci><ci id="S3.SS1.p2.3.m3.1.1.3.6.cmml" xref="S3.SS1.p2.3.m3.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mbox{REVERSE}_{token}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">REVERSE start_POSTSUBSCRIPT italic_t italic_o italic_k italic_e italic_n end_POSTSUBSCRIPT</annotation></semantics></math> equivalent to <math alttext="\mbox{REVERSE}_{word}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mtext id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">w</mi><mo id="S3.SS1.p2.4.m4.1.1.3.1" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml">o</mi><mo id="S3.SS1.p2.4.m4.1.1.3.1a" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3.4" xref="S3.SS1.p2.4.m4.1.1.3.4.cmml">r</mi><mo id="S3.SS1.p2.4.m4.1.1.3.1b" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3.5" xref="S3.SS1.p2.4.m4.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2a.cmml" xref="S3.SS1.p2.4.m4.1.1.2"><mtext id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><times id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.1"></times><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">𝑤</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">𝑜</ci><ci id="S3.SS1.p2.4.m4.1.1.3.4.cmml" xref="S3.SS1.p2.4.m4.1.1.3.4">𝑟</ci><ci id="S3.SS1.p2.4.m4.1.1.3.5.cmml" xref="S3.SS1.p2.4.m4.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mbox{REVERSE}_{word}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">REVERSE start_POSTSUBSCRIPT italic_w italic_o italic_r italic_d end_POSTSUBSCRIPT</annotation></semantics></math>.
For evaluations, we report the exact match accuracy of the target entity (2nd entity), averaged over three random seeds. More training details are given in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#A1" title="Appendix A Symbolic reverse task details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Appendix&nbsp;A</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.8"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S3.T3" title="Table 3 ‣ 3.1 Symbolic reverse task ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;3</span></a> shows the performance of reverse training on this task for different entity name lengths.
The standard language model training completely fails despite the simplicity of this task, suggesting that it is unlikely to be solved by scaling alone.
In contrast, <math alttext="\mbox{REVERSE}_{word}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mtext id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">w</mi><mo id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">o</mi><mo id="S3.SS1.p3.1.m1.1.1.3.1a" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.1.1.3.4" xref="S3.SS1.p3.1.m1.1.1.3.4.cmml">r</mi><mo id="S3.SS1.p3.1.m1.1.1.3.1b" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.1.1.3.5" xref="S3.SS1.p3.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2a.cmml" xref="S3.SS1.p3.1.m1.1.1.2"><mtext id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><times id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">𝑤</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">𝑜</ci><ci id="S3.SS1.p3.1.m1.1.1.3.4.cmml" xref="S3.SS1.p3.1.m1.1.1.3.4">𝑟</ci><ci id="S3.SS1.p3.1.m1.1.1.3.5.cmml" xref="S3.SS1.p3.1.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mbox{REVERSE}_{word}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">REVERSE start_POSTSUBSCRIPT italic_w italic_o italic_r italic_d end_POSTSUBSCRIPT</annotation></semantics></math> training nearly solves it for two-word entities, but its performance degrades quickly as the entities become longer.
A possible explanation is that while <math alttext="\mbox{REVERSE}_{word}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mtext id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.3.2.cmml">w</mi><mo id="S3.SS1.p3.2.m2.1.1.3.1" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.cmml">o</mi><mo id="S3.SS1.p3.2.m2.1.1.3.1a" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.1.1.3.4" xref="S3.SS1.p3.2.m2.1.1.3.4.cmml">r</mi><mo id="S3.SS1.p3.2.m2.1.1.3.1b" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.1.1.3.5" xref="S3.SS1.p3.2.m2.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2a.cmml" xref="S3.SS1.p3.2.m2.1.1.2"><mtext id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><times id="S3.SS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3.1"></times><ci id="S3.SS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2">𝑤</ci><ci id="S3.SS1.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3">𝑜</ci><ci id="S3.SS1.p3.2.m2.1.1.3.4.cmml" xref="S3.SS1.p3.2.m2.1.1.3.4">𝑟</ci><ci id="S3.SS1.p3.2.m2.1.1.3.5.cmml" xref="S3.SS1.p3.2.m2.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mbox{REVERSE}_{word}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">REVERSE start_POSTSUBSCRIPT italic_w italic_o italic_r italic_d end_POSTSUBSCRIPT</annotation></semantics></math> does see both mapping <math alttext="a_{i}\rightarrow b_{j}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mrow id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><msub id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2.2" xref="S3.SS1.p3.3.m3.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p3.3.m3.1.1.2.3" xref="S3.SS1.p3.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p3.3.m3.1.1.1" stretchy="false" xref="S3.SS1.p3.3.m3.1.1.1.cmml">→</mo><msub id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.2" xref="S3.SS1.p3.3.m3.1.1.3.2.cmml">b</mi><mi id="S3.SS1.p3.3.m3.1.1.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><ci id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1">→</ci><apply id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2.2">𝑎</ci><ci id="S3.SS1.p3.3.m3.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.2">𝑏</ci><ci id="S3.SS1.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">a_{i}\rightarrow b_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT → italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and its reverse <math alttext="\reverse{b}_{j}\rightarrow\reverse{a}_{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mrow id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.4.m4.1.1.2.2" xref="S3.SS1.p3.4.m4.1.1.2.2b.cmml"><mtext id="S3.SS1.p3.4.m4.1.1.2.2a" xref="S3.SS1.p3.4.m4.1.1.2.2b.cmml">\reverse</mtext></merror><mo id="S3.SS1.p3.4.m4.1.1.2.1" xref="S3.SS1.p3.4.m4.1.1.2.1.cmml">⁢</mo><msub id="S3.SS1.p3.4.m4.1.1.2.3" xref="S3.SS1.p3.4.m4.1.1.2.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2.3.2" xref="S3.SS1.p3.4.m4.1.1.2.3.2.cmml">b</mi><mi id="S3.SS1.p3.4.m4.1.1.2.3.3" xref="S3.SS1.p3.4.m4.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.SS1.p3.4.m4.1.1.1" stretchy="false" xref="S3.SS1.p3.4.m4.1.1.1.cmml">→</mo><mrow id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.4.m4.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.3.2b.cmml"><mtext id="S3.SS1.p3.4.m4.1.1.3.2a" xref="S3.SS1.p3.4.m4.1.1.3.2b.cmml">\reverse</mtext></merror><mo id="S3.SS1.p3.4.m4.1.1.3.1" xref="S3.SS1.p3.4.m4.1.1.3.1.cmml">⁢</mo><msub id="S3.SS1.p3.4.m4.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.3.2" xref="S3.SS1.p3.4.m4.1.1.3.3.2.cmml">a</mi><mi id="S3.SS1.p3.4.m4.1.1.3.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><ci id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1">→</ci><apply id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2"><times id="S3.SS1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2.1"></times><ci id="S3.SS1.p3.4.m4.1.1.2.2b.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2"><mtext id="S3.SS1.p3.4.m4.1.1.2.2a.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2">\reverse</mtext></merror></ci><apply id="S3.SS1.p3.4.m4.1.1.2.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.2.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3.2">𝑏</ci><ci id="S3.SS1.p3.4.m4.1.1.2.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3"><times id="S3.SS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.1"></times><ci id="S3.SS1.p3.4.m4.1.1.3.2b.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2"><mtext id="S3.SS1.p3.4.m4.1.1.3.2a.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2">\reverse</mtext></merror></ci><apply id="S3.SS1.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.2">𝑎</ci><ci id="S3.SS1.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\reverse{b}_{j}\rightarrow\reverse{a}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT → italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, it struggles with converting between entity <math alttext="a_{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.1"><semantics id="S3.SS1.p3.5.m5.1a"><msub id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml">a</mi><mi id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2">𝑎</ci><ci id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>=“<span class="ltx_text ltx_font_typewriter" id="S3.SS1.p3.8.1">a12 a64 a22</span>” and its reverse <math alttext="\reverse{a_{i}}" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m6.1"><semantics id="S3.SS1.p3.6.m6.1a"><mrow id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.6.m6.1.1.2" xref="S3.SS1.p3.6.m6.1.1.2b.cmml"><mtext id="S3.SS1.p3.6.m6.1.1.2a" xref="S3.SS1.p3.6.m6.1.1.2b.cmml">\reverse</mtext></merror><mo id="S3.SS1.p3.6.m6.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.cmml">⁢</mo><msub id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml"><mi id="S3.SS1.p3.6.m6.1.1.3.2" xref="S3.SS1.p3.6.m6.1.1.3.2.cmml">a</mi><mi id="S3.SS1.p3.6.m6.1.1.3.3" xref="S3.SS1.p3.6.m6.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><times id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1"></times><ci id="S3.SS1.p3.6.m6.1.1.2b.cmml" xref="S3.SS1.p3.6.m6.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2"><mtext id="S3.SS1.p3.6.m6.1.1.2a.cmml" xref="S3.SS1.p3.6.m6.1.1.2">\reverse</mtext></merror></ci><apply id="S3.SS1.p3.6.m6.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.3.1.cmml" xref="S3.SS1.p3.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.3.2.cmml" xref="S3.SS1.p3.6.m6.1.1.3.2">𝑎</ci><ci id="S3.SS1.p3.6.m6.1.1.3.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\reverse{a_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>=“<span class="ltx_text ltx_font_typewriter" id="S3.SS1.p3.8.2">a22 a64 a12</span>” when they have more words.
Matching this reversed entity itself looks similar to the problem in the original reversal curse, which we know is hard to learn.
<math alttext="\mbox{REVERSE}_{entity}" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m7.1"><semantics id="S3.SS1.p3.7.m7.1a"><msub id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mtext id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml"><mi id="S3.SS1.p3.7.m7.1.1.3.2" xref="S3.SS1.p3.7.m7.1.1.3.2.cmml">e</mi><mo id="S3.SS1.p3.7.m7.1.1.3.1" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.7.m7.1.1.3.3" xref="S3.SS1.p3.7.m7.1.1.3.3.cmml">n</mi><mo id="S3.SS1.p3.7.m7.1.1.3.1a" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.7.m7.1.1.3.4" xref="S3.SS1.p3.7.m7.1.1.3.4.cmml">t</mi><mo id="S3.SS1.p3.7.m7.1.1.3.1b" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.7.m7.1.1.3.5" xref="S3.SS1.p3.7.m7.1.1.3.5.cmml">i</mi><mo id="S3.SS1.p3.7.m7.1.1.3.1c" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.7.m7.1.1.3.6" xref="S3.SS1.p3.7.m7.1.1.3.6.cmml">t</mi><mo id="S3.SS1.p3.7.m7.1.1.3.1d" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.7.m7.1.1.3.7" xref="S3.SS1.p3.7.m7.1.1.3.7.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2a.cmml" xref="S3.SS1.p3.7.m7.1.1.2"><mtext id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3"><times id="S3.SS1.p3.7.m7.1.1.3.1.cmml" xref="S3.SS1.p3.7.m7.1.1.3.1"></times><ci id="S3.SS1.p3.7.m7.1.1.3.2.cmml" xref="S3.SS1.p3.7.m7.1.1.3.2">𝑒</ci><ci id="S3.SS1.p3.7.m7.1.1.3.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3.3">𝑛</ci><ci id="S3.SS1.p3.7.m7.1.1.3.4.cmml" xref="S3.SS1.p3.7.m7.1.1.3.4">𝑡</ci><ci id="S3.SS1.p3.7.m7.1.1.3.5.cmml" xref="S3.SS1.p3.7.m7.1.1.3.5">𝑖</ci><ci id="S3.SS1.p3.7.m7.1.1.3.6.cmml" xref="S3.SS1.p3.7.m7.1.1.3.6">𝑡</ci><ci id="S3.SS1.p3.7.m7.1.1.3.7.cmml" xref="S3.SS1.p3.7.m7.1.1.3.7">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">\mbox{REVERSE}_{entity}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m7.1d">REVERSE start_POSTSUBSCRIPT italic_e italic_n italic_t italic_i italic_t italic_y end_POSTSUBSCRIPT</annotation></semantics></math> training eliminates this issue because the word ordering within entity <math alttext="a_{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m8.1"><semantics id="S3.SS1.p3.8.m8.1a"><msub id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mi id="S3.SS1.p3.8.m8.1.1.2" xref="S3.SS1.p3.8.m8.1.1.2.cmml">a</mi><mi id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2">𝑎</ci><ci id="S3.SS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m8.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> remains the same, which explains its perfect accuracy even for 5-word entities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.3"><math alttext="\mbox{REVERSE}_{rand}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mtext id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2a.cmml">REVERSE</mtext><mrow id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.3.2" xref="S3.SS1.p4.1.m1.1.1.3.2.cmml">r</mi><mo id="S3.SS1.p4.1.m1.1.1.3.1" xref="S3.SS1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.3.3" xref="S3.SS1.p4.1.m1.1.1.3.3.cmml">a</mi><mo id="S3.SS1.p4.1.m1.1.1.3.1a" xref="S3.SS1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.3.4" xref="S3.SS1.p4.1.m1.1.1.3.4.cmml">n</mi><mo id="S3.SS1.p4.1.m1.1.1.3.1b" xref="S3.SS1.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.1.3.5" xref="S3.SS1.p4.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2a.cmml" xref="S3.SS1.p4.1.m1.1.1.2"><mtext id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">REVERSE</mtext></ci><apply id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3"><times id="S3.SS1.p4.1.m1.1.1.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.3.1"></times><ci id="S3.SS1.p4.1.m1.1.1.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.3.2">𝑟</ci><ci id="S3.SS1.p4.1.m1.1.1.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3">𝑎</ci><ci id="S3.SS1.p4.1.m1.1.1.3.4.cmml" xref="S3.SS1.p4.1.m1.1.1.3.4">𝑛</ci><ci id="S3.SS1.p4.1.m1.1.1.3.5.cmml" xref="S3.SS1.p4.1.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mbox{REVERSE}_{rand}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">REVERSE start_POSTSUBSCRIPT italic_r italic_a italic_n italic_d end_POSTSUBSCRIPT</annotation></semantics></math> can also solve this task, but only when the maximum segment length <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_k</annotation></semantics></math> is long enough.
When <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.1d">italic_k</annotation></semantics></math> is smaller than the entity name length, the entity names will always split across multiple segments, thus the same issue as with word reversal could arise.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T4.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T4.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S3.T4.3.1.1.1" rowspan="2"><span class="ltx_text" id="S3.T4.3.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.1.1.1">Pre-training</span><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.1.1.2"> method</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S3.T4.3.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.2.1">full name recall (%)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S3.T4.3.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T4.3.1.1.3.1">last name recall (%)</span></th>
</tr>
<tr class="ltx_tr" id="S3.T4.3.2.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T4.3.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.1.1">all</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T4.3.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.2.1">f=4</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T4.3.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.3.1">f=3</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T4.3.2.2.4"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.4.1">bdate</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T4.3.2.2.5"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.5.1">all</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T4.3.2.2.6"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.6.1">f=4</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T4.3.2.2.7"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.7.1">f=3</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T4.3.2.2.8"><span class="ltx_text ltx_font_bold" id="S3.T4.3.2.2.8.1">bdate</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.3.3.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T4.3.3.1.1"><em class="ltx_emph ltx_font_italic" id="S3.T4.3.3.1.1.1">bioS</em></td>
<td class="ltx_td ltx_border_t" id="S3.T4.3.3.1.2"></td>
<td class="ltx_td ltx_border_t" id="S3.T4.3.3.1.3"></td>
<td class="ltx_td ltx_border_t" id="S3.T4.3.3.1.4"></td>
<td class="ltx_td ltx_border_t" id="S3.T4.3.3.1.5"></td>
<td class="ltx_td ltx_border_t" id="S3.T4.3.3.1.6"></td>
<td class="ltx_td ltx_border_t" id="S3.T4.3.3.1.7"></td>
<td class="ltx_td ltx_border_t" id="S3.T4.3.3.1.8"></td>
<td class="ltx_td ltx_border_t" id="S3.T4.3.3.1.9"></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.4.2">
<td class="ltx_td ltx_align_left" id="S3.T4.3.4.2.1">standard</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.4.2.2">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.4.2.3">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.4.2.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.4.2.5">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.4.2.6">0.2</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.4.2.7">0.1</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.4.2.8">0.2</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.4.2.9">0.1</td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.5.3">
<td class="ltx_td ltx_align_left" id="S3.T4.3.5.3.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T4.3.5.3.1.1">token</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.5.3.2">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.5.3.3">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.5.3.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.5.3.5">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.5.3.6">63.7</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.5.3.7">62.8</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.5.3.8">48.1</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.5.3.9"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.3.9.1">0.2</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.6.4">
<td class="ltx_td ltx_align_left" id="S3.T4.3.6.4.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T4.3.6.4.1.1">word</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.6.4.2">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.6.4.3">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.6.4.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.6.4.5">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.6.4.6"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.6.1">99.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.6.4.7"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.7.1">99.0</span></td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.6.4.8"><span class="ltx_text ltx_font_bold" id="S3.T4.3.6.4.8.1">91.1</span></td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.6.4.9">0.1</td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.7.5">
<td class="ltx_td ltx_align_left" id="S3.T4.3.7.5.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T4.3.7.5.1.1">entity</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.7.5.2"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.5.2.1">99.0</span></td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.7.5.3"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.5.3.1">98.8</span></td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.7.5.4"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.5.4.1">87.8</span></td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.7.5.5">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.7.5.6">0.3</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.7.5.7">0.3</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.7.5.8">0.3</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.7.5.9"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.5.9.1">0.2</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.8.6">
<td class="ltx_td ltx_align_left" id="S3.T4.3.8.6.1"><em class="ltx_emph ltx_font_italic" id="S3.T4.3.8.6.1.1">bioR</em></td>
<td class="ltx_td" id="S3.T4.3.8.6.2"></td>
<td class="ltx_td" id="S3.T4.3.8.6.3"></td>
<td class="ltx_td" id="S3.T4.3.8.6.4"></td>
<td class="ltx_td" id="S3.T4.3.8.6.5"></td>
<td class="ltx_td" id="S3.T4.3.8.6.6"></td>
<td class="ltx_td" id="S3.T4.3.8.6.7"></td>
<td class="ltx_td" id="S3.T4.3.8.6.8"></td>
<td class="ltx_td" id="S3.T4.3.8.6.9"></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.9.7">
<td class="ltx_td ltx_align_left" id="S3.T4.3.9.7.1">standard</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.9.7.2">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.9.7.3">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.9.7.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.9.7.5">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.9.7.6">0.2</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.9.7.7">0.2</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.9.7.8">0.2</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.9.7.9"><span class="ltx_text ltx_font_bold" id="S3.T4.3.9.7.9.1">0.2</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.10.8">
<td class="ltx_td ltx_align_left" id="S3.T4.3.10.8.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T4.3.10.8.1.1">token</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.10.8.2">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.10.8.3">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.10.8.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.10.8.5">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.10.8.6">61.5</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.10.8.7">58.2</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.10.8.8">53.3</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.10.8.9"><span class="ltx_text ltx_font_bold" id="S3.T4.3.10.8.9.1">0.2</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.11.9">
<td class="ltx_td ltx_align_left" id="S3.T4.3.11.9.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T4.3.11.9.1.1">word</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.11.9.2">0.2</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.11.9.3">0.1</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.11.9.4">0.1</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.11.9.5">0.1</td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.11.9.6"><span class="ltx_text ltx_font_bold" id="S3.T4.3.11.9.6.1">99.2</span></td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.11.9.7"><span class="ltx_text ltx_font_bold" id="S3.T4.3.11.9.7.1">98.5</span></td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.11.9.8"><span class="ltx_text ltx_font_bold" id="S3.T4.3.11.9.8.1">94.9</span></td>
<td class="ltx_td ltx_align_right" id="S3.T4.3.11.9.9"><span class="ltx_text ltx_font_bold" id="S3.T4.3.11.9.9.1">0.2</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.12.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T4.3.12.10.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T4.3.12.10.1.1">entity</span>)</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T4.3.12.10.2"><span class="ltx_text ltx_font_bold" id="S3.T4.3.12.10.2.1">98.2</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T4.3.12.10.3"><span class="ltx_text ltx_font_bold" id="S3.T4.3.12.10.3.1">94.6</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T4.3.12.10.4"><span class="ltx_text ltx_font_bold" id="S3.T4.3.12.10.4.1">86.7</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T4.3.12.10.5"><span class="ltx_text ltx_font_bold" id="S3.T4.3.12.10.5.1">0.1</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T4.3.12.10.6">0.4</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T4.3.12.10.7">0.4</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T4.3.12.10.8">0.4</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T4.3.12.10.9">0.1</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Evaluation results on the <span class="ltx_text ltx_font_italic" id="S3.T4.7.1">reversing biography</span> tasks in the mixed-training setup (see Footnote&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#footnote4" title="footnote 4 ‣ 3.2 Reversing Biography Task ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">4</span></a>, pre-train+FT is deferred to Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#A3" title="Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">C</span></a>). We report accuracy on the reversal tasks of recovering the person’s full (or last) name given bio fields, using biographies that were either generated using a pool of sentence templates (the <em class="ltx_emph ltx_font_italic" id="S3.T4.8.2">bioS</em> dataset) or generated using the Llama model (the <em class="ltx_emph ltx_font_italic" id="S3.T4.9.3">bioR</em> dataset). We consider when all 6 or f<math alttext="={3,4}" class="ltx_Math" display="inline" id="S3.T4.2.m1.2"><semantics id="S3.T4.2.m1.2b"><mrow id="S3.T4.2.m1.2.3" xref="S3.T4.2.m1.2.3.cmml"><mi id="S3.T4.2.m1.2.3.2" xref="S3.T4.2.m1.2.3.2.cmml"></mi><mo id="S3.T4.2.m1.2.3.1" xref="S3.T4.2.m1.2.3.1.cmml">=</mo><mrow id="S3.T4.2.m1.2.3.3.2" xref="S3.T4.2.m1.2.3.3.1.cmml"><mn id="S3.T4.2.m1.1.1" xref="S3.T4.2.m1.1.1.cmml">3</mn><mo id="S3.T4.2.m1.2.3.3.2.1" xref="S3.T4.2.m1.2.3.3.1.cmml">,</mo><mn id="S3.T4.2.m1.2.2" xref="S3.T4.2.m1.2.2.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T4.2.m1.2c"><apply id="S3.T4.2.m1.2.3.cmml" xref="S3.T4.2.m1.2.3"><eq id="S3.T4.2.m1.2.3.1.cmml" xref="S3.T4.2.m1.2.3.1"></eq><csymbol cd="latexml" id="S3.T4.2.m1.2.3.2.cmml" xref="S3.T4.2.m1.2.3.2">absent</csymbol><list id="S3.T4.2.m1.2.3.3.1.cmml" xref="S3.T4.2.m1.2.3.3.2"><cn id="S3.T4.2.m1.1.1.cmml" type="integer" xref="S3.T4.2.m1.1.1">3</cn><cn id="S3.T4.2.m1.2.2.cmml" type="integer" xref="S3.T4.2.m1.2.2">4</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.2.m1.2d">={3,4}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.2.m1.2e">= 3 , 4</annotation></semantics></math> selected bio fields are given, as well as when only birthdates are given.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Reversing Biography Task</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2">When the reversal curse was discovered in <cite class="ltx_cite ltx_citemacro_cite">Allen-Zhu &amp; Li (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib2" title="">2023b</a>)</cite>, the authors utilized a biography dataset of 100K randomly generated individuals with unique English names. The biographies were either generated using a pool of sentence templates (the <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="S3.SS2.p1.2.1">bioS</span> dataset) or generated using the Llama model (the <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="S3.SS2.p1.2.2">bioR</span> dataset)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib32" title="">2023a</a>)</cite>.
The biography entries always start with the person’s full name.<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>They consider two types of training, pre-train + finetune (FT) in which they pre-train the model with biography entries and then finetune with QA tasks; mixed-training in which they train the model once with both the biography entries and the QA tasks (not in the same context). They always use half of the individuals’ QA tasks for training and evaluate the QA accuracies on the remaining half. </span></span></span>
The reversal QA task is, therefore, very natural: given a person’s partial or full biography details, ask for the person’s name.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">We conducted the same experiment in their setting, with respect to token, word, and entity-preserving reversals. Our main findings can be summarized as follows (see <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S3.T4" title="Table 4 ‣ 3.1 Symbolic reverse task ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;4</span></a>, and <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#A3" title="Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Appendix&nbsp;C</span></a> <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#A3.T10" title="Table 10 ‣ Forward QA tasks. ‣ Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;10</span></a>):</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">For the reversal tasks of determining the person’s full name, only in the entity-preserving reversal case do accuracies become non-trivial. Both token/word reversals completely fail in such tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S3.I1.i1.I1">
<li class="ltx_item" id="S3.I1.i1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.I1.i1.1.1.1">–</span></span>
<div class="ltx_para ltx_noindent" id="S3.I1.i1.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.I1.i1.p1.1">When determining a person’s full name given only the birth date, the reversal task accuracy remains near zero; this is because dates are treated as three entities in our adopted entity detection method, so their ordering is <em class="ltx_emph ltx_font_italic" id="S3.I1.i1.I1.i1.p1.1.1">not preserved</em> in the reversal.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1">If the reversal tasks are simplified to determining the person’s <em class="ltx_emph ltx_font_italic" id="S3.I1.i2.p1.1.1">last name only</em>, then word-level reversal suffices, and token-level reversal also yields non-trivial accuracies.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.I1.i2.p2">
<ul class="ltx_itemize" id="S3.I1.i2.I1">
<li class="ltx_item" id="S3.I1.i2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.I1.i1.1.1.1">–</span></span>
<div class="ltx_para ltx_noindent" id="S3.I1.i2.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i2.I1.i1.p1.1">Some readers may find it surprising that an entity-preserving method can determine the person’s full name but not the person’s last name. This is a known phenomenon&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu &amp; Li, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib2" title="">2023b</a>)</cite>: a language model may completely fail at retrieving <em class="ltx_emph ltx_font_italic" id="S3.I1.i2.I1.i1.p1.1.1">later</em> tokens of a knowledge piece (such as the last name) without the help of spelling out earlier tokens — they can be viewed as a Chain of Thought (CoT).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">Entity-preserving reversals do not impair the model’s performance in forward tasks (such as determining the person’s birth dates from names) as shown in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#A3.T10" title="Table 10 ‣ Forward QA tasks. ‣ Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;10</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1">Mixed-training (i.e., adding instruction tuning data to the pre-training level) generally performs better compared to first pre-training the model with knowledge and then fine-tuning it to answer (reversal) tasks. This was also observed in <cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu &amp; Li, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib1" title="">2023a</a>)</cite> but for forward knowledge tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">More details of this experiment are included in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#A3" title="Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Appendix&nbsp;C</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T5.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S3.T5.2.2.3" rowspan="2"><span class="ltx_text" id="S3.T5.2.2.3.1"><span class="ltx_text ltx_font_bold" id="S3.T5.2.2.3.1.1">Pre-training</span><span class="ltx_text ltx_font_bold" id="S3.T5.2.2.3.1.2"> method</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S3.T5.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1">celebrity <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T5.1.1.1.1.m1.1"><semantics id="S3.T5.1.1.1.1.m1.1a"><mo id="S3.T5.1.1.1.1.m1.1.1" mathvariant="normal" stretchy="false" xref="S3.T5.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T5.1.1.1.1.m1.1b"><ci id="S3.T5.1.1.1.1.m1.1.1.cmml" xref="S3.T5.1.1.1.1.m1.1.1">normal-→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.1.1.1.1.m1.1d">→</annotation></semantics></math> parent</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S3.T5.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T5.2.2.2.1">parent <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T5.2.2.2.1.m1.1"><semantics id="S3.T5.2.2.2.1.m1.1a"><mo id="S3.T5.2.2.2.1.m1.1.1" mathvariant="normal" stretchy="false" xref="S3.T5.2.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T5.2.2.2.1.m1.1b"><ci id="S3.T5.2.2.2.1.m1.1.1.cmml" xref="S3.T5.2.2.2.1.m1.1.1">normal-→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.2.2.2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.2.2.2.1.m1.1d">→</annotation></semantics></math> celebrity</span></th>
</tr>
<tr class="ltx_tr" id="S3.T5.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.3.4.1.1">best@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.3.4.1.2">@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.3.4.1.3">@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.3.4.1.4">best@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.3.4.1.5">@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.3.4.1.6">@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.3.5.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T5.3.5.1.1"><em class="ltx_emph ltx_font_italic" id="S3.T5.3.5.1.1.1">Model size: 1.4B</em></td>
<td class="ltx_td ltx_border_t" id="S3.T5.3.5.1.2"></td>
<td class="ltx_td ltx_border_t" id="S3.T5.3.5.1.3"></td>
<td class="ltx_td ltx_border_t" id="S3.T5.3.5.1.4"></td>
<td class="ltx_td ltx_border_t" id="S3.T5.3.5.1.5"></td>
<td class="ltx_td ltx_border_t" id="S3.T5.3.5.1.6"></td>
<td class="ltx_td ltx_border_t" id="S3.T5.3.5.1.7"></td>
</tr>
<tr class="ltx_tr" id="S3.T5.3.6.2">
<td class="ltx_td ltx_align_left" id="S3.T5.3.6.2.1">standard (compute-matched)</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.6.2.2"><span class="ltx_text ltx_font_bold" id="S3.T5.3.6.2.2.1">1.6</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.6.2.3"><span class="ltx_text ltx_font_bold" id="S3.T5.3.6.2.3.1">2.9</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.6.2.4"><span class="ltx_text ltx_font_bold" id="S3.T5.3.6.2.4.1">3.9</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.6.2.5">0.9</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.6.2.6">2.9</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.6.2.7">3.9</td>
</tr>
<tr class="ltx_tr" id="S3.T5.3.7.3">
<td class="ltx_td ltx_align_left" id="S3.T5.3.7.3.1">standard (data-matched)</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.7.3.2">0.4</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.7.3.3">1.7</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.7.3.4">2.7</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.7.3.5">0.8</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.7.3.6">1.8</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.7.3.7">3.2</td>
</tr>
<tr class="ltx_tr" id="S3.T5.3.8.4">
<td class="ltx_td ltx_align_left" id="S3.T5.3.8.4.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T5.3.8.4.1.1">token</span>)</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.8.4.2">0.8</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.8.4.3">2.5</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.8.4.4">3.8</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.8.4.5">0.6</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.8.4.6">2.5</td>
<td class="ltx_td ltx_align_center" id="S3.T5.3.8.4.7">3.9</td>
</tr>
<tr class="ltx_tr" id="S3.T5.3.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T5.3.3.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T5.3.3.1.1">entity<math alttext="{}^{*}" class="ltx_Math" display="inline" id="S3.T5.3.3.1.1.m1.1"><semantics id="S3.T5.3.3.1.1.m1.1a"><msup id="S3.T5.3.3.1.1.m1.1.1" xref="S3.T5.3.3.1.1.m1.1.1.cmml"><mi id="S3.T5.3.3.1.1.m1.1.1a" xref="S3.T5.3.3.1.1.m1.1.1.cmml"></mi><mo id="S3.T5.3.3.1.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.3.3.1.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T5.3.3.1.1.m1.1b"><apply id="S3.T5.3.3.1.1.m1.1.1.cmml" xref="S3.T5.3.3.1.1.m1.1.1"><times id="S3.T5.3.3.1.1.m1.1.1.1.cmml" xref="S3.T5.3.3.1.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.3.3.1.1.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.3.3.1.1.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math></span>)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.3.3.2">0.8</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.3.3.3">2.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.3.3.4">3.8</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.3.3.5"><span class="ltx_text ltx_font_bold" id="S3.T5.3.3.5.1">3.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.3.3.6"><span class="ltx_text ltx_font_bold" id="S3.T5.3.3.6.1">8.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.3.3.7"><span class="ltx_text ltx_font_bold" id="S3.T5.3.3.7.1">10.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Evaluation results on the <span class="ltx_text ltx_font_italic" id="S3.T5.7.2">real-world celebrity</span> task when using different pre-training methods to train LLMs, with no finetuning.
Results are reported as best accuracy when sampling multiple times.
Reverse (<span class="ltx_text ltx_font_italic" id="S3.T5.5.1">entity<math alttext="{}^{*}" class="ltx_Math" display="inline" id="S3.T5.5.1.m1.1"><semantics id="S3.T5.5.1.m1.1b"><msup id="S3.T5.5.1.m1.1.1" xref="S3.T5.5.1.m1.1.1.cmml"><mi id="S3.T5.5.1.m1.1.1b" xref="S3.T5.5.1.m1.1.1.cmml"></mi><mo id="S3.T5.5.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.5.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T5.5.1.m1.1c"><apply id="S3.T5.5.1.m1.1.1.cmml" xref="S3.T5.5.1.m1.1.1"><times id="S3.T5.5.1.m1.1.1.1.cmml" xref="S3.T5.5.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.5.1.m1.1d">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.5.1.m1.1e">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math></span>) pre-training (5% of the reversed data being entity-preserving reversal, and the rest word-reversal) significantly improves the more challenging parent to celebrity direction. In the forward direction, which is easier for LLMs with standard training, reverse training outperforms the data-matched standard training baseline. </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Reversing real-world knowledge via pre-training</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Next we test our method on a realistic setup where we
pre-train language models, and evaluate their ability on “forward” and “reverse” facts about real-world knowledge.
As LLMs acquire the majority of their world knowledge during their pre-training stage, it makes sense to evaluate our reverse training in this pre-training setup. To make the experiments tractable,
we train a Llama-2 1.4 billion parameter model&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib33" title="">2023b</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">We train the baseline model on 2 trillion tokens in the left-to-right direction.
Reverse training uses only half of these tokens (1 trillion), but trains in both the standard left-to-right direction, and in the right-to-left (reverse) direction with this same subset of the data.
Hence it does model updates over 2 trillion tokens in total, i.e. 1 trillion tokens in each direction is passed through the model.
We call this setup <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.1.1">compute-matched</em> because both models processed the same amount of tokens in total and used the same compute resources.
We also compare against a <em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.1.2">data-matched</em> baseline that is trained on 1 trillion tokens in the standard left-to-right direction. This model has been trained with half as many updates, but has seen the same data examples as the reverse trained model, but only in one direction.
For reverse training, we employ entity-preserving reversal for 5% of the pre-train data, and the remainder uses word-reversal, mainly due to the extra computational cost of the entity reversal procedure, which we refer to as “entity<math alttext="{}^{*}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msup id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1a" xref="S3.SS3.p2.1.m1.1.1.cmml"></mi><mo id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><times id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math>” in our results. We also test other reversal mechanisms in our ablation experiments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">To test the reversal capability on real-world facts we use a celebrity task, which contains questions like
“The mother of [celebrity_name] is <span class="ltx_text ltx_framed_underline" id="S3.SS3.p3.1.1">&nbsp;&nbsp;&nbsp;&nbsp;</span>” that are known to be challenging to large scale LLMs.
It also contains even more challenging reverse questions such as “The child of [parent_of_celebrity] is <span class="ltx_text ltx_framed_underline" id="S3.SS3.p3.1.2">&nbsp;&nbsp;&nbsp;&nbsp;</span>”.
We perform two-shot evaluation using our pre-trained models without any finetuning on this dataset.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">The results are shown in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S3.T5" title="Table 5 ‣ 3.2 Reversing Biography Task ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;5</span></a>.
We sample multiple times from the models for each question and if any one of them contains the correct answer, then it is counted as success.
The accuracy is relatively low in general due to the small model size in terms of number of parameters, limited pre-training and lack of any finetuning for both baselines and our method. Nevertheless,
in the forward direction questions, the reverse training outperforms the data-matched baseline, showing that in the data-bound case, reverse training even helps on standard tasks. In the compute-matched case, where the baseline has effectively access to more data, reversal training lags slightly behind for 5, 10 samples.
Importantly, in both the data-matched and compute-matched case
we see significant improvement in the reverse direction questions for reverse training compared to either baseline.
This demonstrates that reverse training can be employed during the pre-training stage to make the model robust against the reversal curse.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T6.1" style="width:433.6pt;height:313.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(42.6pt,-30.8pt) scale(1.24483992820701,1.24483992820701) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T6.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T6.1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T6.1.1.2.1.1" rowspan="2"><span class="ltx_text" id="S3.T6.1.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.2.1.1.1.1">Pre-training</span><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.2.1.1.1.2"> method</span></span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T6.1.1.2.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.2.1.2.1">Finetuning method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T6.1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.2.1.3.1">NameToDescription</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T6.1.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.2.1.4.1">DescriptionToName</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.3.2">
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T6.1.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.3.2.1.1">forward</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T6.1.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.3.2.2.1">reverse</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T6.1.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.3.2.3.1">forward</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T6.1.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.3.2.4.1">reverse</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T6.1.1.4.3.1"><em class="ltx_emph ltx_font_italic" id="S3.T6.1.1.4.3.1.1">Model size: 1.4B</em></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.4.3.2"></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.4.3.3"></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.4.3.4"></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.4.3.5"></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.4.3.6"></td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.5.4">
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.5.4.1">standard (compute-matched)</td>
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.5.4.2">standard</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.5.4.3">77.3</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.5.4.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.5.4.5">98.3</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.5.4.6">2.3</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.6.5">
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.6.5.1">standard (compute-matched)</td>
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.6.5.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T6.1.1.6.5.2.1">entity</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.6.5.3.1">78.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.6.5.4">85.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.6.5.5">99.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.6.5.6">5.7</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.7.6">
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.7.6.1">
standard (compute-matched)</td>
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.7.6.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T6.1.1.7.6.2.1">rand k=25</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.7.6.3">77.3</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.7.6.4"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.7.6.4.1">96.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.7.6.5">97.7</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.7.6.6"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.7.6.6.1">70.7</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.8.7">
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.8.7.1">standard (data-matched)</td>
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.8.7.2">standard</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.8.7.3">75.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.8.7.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.8.7.5"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.8.7.5.1">99.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.8.7.6">0.0</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.9.8">
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.9.8.1">standard (data-matched)</td>
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.9.8.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T6.1.1.9.8.2.1">entity</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.9.8.3">75.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.9.8.4">66.7</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.9.8.5"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.9.8.5.1">99.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.9.8.6">3.3</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.10.9">
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.10.9.1">standard (data-matched)</td>
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.10.9.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T6.1.1.10.9.2.1">rand k=25</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.10.9.3">76.3</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.10.9.4">94.3</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.10.9.5">95.7</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.10.9.6">67.0</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.1">
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.1.1">reverse training (<span class="ltx_text ltx_font_italic" id="S3.T6.1.1.1.1.1">entity<math alttext="{}^{*}" class="ltx_Math" display="inline" id="S3.T6.1.1.1.1.1.m1.1"><semantics id="S3.T6.1.1.1.1.1.m1.1a"><msup id="S3.T6.1.1.1.1.1.m1.1.1" xref="S3.T6.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.T6.1.1.1.1.1.m1.1.1a" xref="S3.T6.1.1.1.1.1.m1.1.1.cmml"></mi><mo id="S3.T6.1.1.1.1.1.m1.1.1.1" mathvariant="normal" xref="S3.T6.1.1.1.1.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T6.1.1.1.1.1.m1.1b"><apply id="S3.T6.1.1.1.1.1.m1.1.1.cmml" xref="S3.T6.1.1.1.1.1.m1.1.1"><times id="S3.T6.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.T6.1.1.1.1.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.1.1.1.1.1.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T6.1.1.1.1.1.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math></span>)</td>
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.1.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T6.1.1.1.2.1">entity</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.1.3">77.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.1.4">78.3</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.1.5">95.3</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.1.6">2.3</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.11.10">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T6.1.1.11.10.1"><em class="ltx_emph ltx_font_italic" id="S3.T6.1.1.11.10.1.1">Model size: 7B</em></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.11.10.2"></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.11.10.3"></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.11.10.4"></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.11.10.5"></td>
<td class="ltx_td ltx_border_t" id="S3.T6.1.1.11.10.6"></td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.12.11">
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.12.11.1">standard</td>
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.12.11.2">standard</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.12.11.3"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.12.11.3.1">80.3</span></td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.12.11.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.12.11.5">96.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.12.11.6">4.0</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.13.12">
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.13.12.1">standard</td>
<td class="ltx_td ltx_align_left" id="S3.T6.1.1.13.12.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T6.1.1.13.12.2.1">entity</span>)</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.13.12.3">79.0</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.13.12.4">89.7</td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.13.12.5"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.13.12.5.1">99.7</span></td>
<td class="ltx_td ltx_align_right" id="S3.T6.1.1.13.12.6">6.0</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.1.14.13">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T6.1.1.14.13.1">standard</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T6.1.1.14.13.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T6.1.1.14.13.2.1">rand k=25</span>)</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T6.1.1.14.13.3">78.3</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T6.1.1.14.13.4"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.14.13.4.1">99.0</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T6.1.1.14.13.5">99.0</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T6.1.1.14.13.6"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.14.13.6.1">70.0</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Test accuracy (%) on the <span class="ltx_text ltx_font_italic" id="S3.T6.3.1">fictitious celebrities</span> task, with either standard (data or compute-matched ) pre-training, or reverse pre-training, and either standard or reverse finetuning, for 1.4B and 7B parameter models.
In all cases, reverse finetuning brings a significant improvement on the reverse NameToDescription task, which is otherwise impossible to solve, and to reverse DescriptionToName using random segment reversal.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Reversing fictitious facts via finetuning</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">We next explore if our reverse training can be applied to the finetuning stage when the model is learning new, previously unseen knowledge from a small training dataset. We use the same pre-trained models described in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S3.SS3" title="3.3 Reversing real-world knowledge via pre-training ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Section&nbsp;3.3</span></a> and an additional Llama-2 7B model, and further finetune them on a dataset made up of fictitious facts.
These data
are made up of statements of the form ”[name] is [description]” (or the reverse) where the names and descriptions are randomly generated.
The fictitious nature of this dataset guarantees that those facts are not seen during pre-training, and are only seen in the specified direction during finetuning. The model is then tested to see if it is able to learn these facts in the same or reverse direction that it has seen during training.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S3.T6" title="Table 6 ‣ 3.3 Reversing real-world knowledge via pre-training ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;6</span></a> provides evaluation results for different pre-training and finetuning setups. We employ a soft matching score as the test accuracy, which we evaluate as exact presence of the target sequence in the first 64 tokens of a model’s prediction.
Across all the pre-trained models, finetuning with reverse training was critical in solving the reversal of NameToDescription, reaching close to 100% for the larger 7B model, while standard finetuning always results in 0% accuracy.
For reversing DescriptionToName,
only finetuning with the random segment reversal succeeded, achieving an accuracy around 70%.
This is likely because generating descriptions is more challenging as they have many words and some variety even for the same person.
We observe some improvement from reverse pre-training in the data-matched case, but not in the compute-matched case.
We note that this is perhaps to be expected as the evaluation statements are fictitious and never appeared in the pre-training data.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T7">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T7.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T7.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T7.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S3.T7.1.2.1.1.1">Pre-training method</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.2"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.2.1">BoolQ</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.3"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.3.1">PIQA</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.4"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.4.1">SIQA</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.5"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.5.1">HellaS</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.6"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.6.1">WinoG</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.7"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.7.1">ARCe</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.8"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.8.1">ARCc</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.9"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.9.1">OBQA</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.10"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.10.1">MMLU</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S3.T7.1.2.1.11"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T7.1.2.1.11.1">Avg</span></td>
</tr>
<tr class="ltx_tr" id="S3.T7.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T7.1.3.2.1"><em class="ltx_emph ltx_font_italic" id="S3.T7.1.3.2.1.1">Model size: 1.4B</em></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.2"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.3"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.4"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.5"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.6"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.7"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.8"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.9"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.10"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.3.2.11"></td>
</tr>
<tr class="ltx_tr" id="S3.T7.1.4.3">
<td class="ltx_td ltx_align_left" id="S3.T7.1.4.3.1">std. (compute-matched)</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.2">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.2.1">65.1</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.3">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.3.1">74.4</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.4">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.4.1">41.2</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.5">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.5.1">47.7</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.6">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.6.1">62.7</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.7">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.7.1">67.6</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.8">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.8.1">32.1</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.9">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.9.1">27.0</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.10">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.10.1">27.1</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.4.3.11">
<p class="ltx_p ltx_align_top" id="S3.T7.1.4.3.11.1">49.4</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="S3.T7.1.5.4">
<td class="ltx_td ltx_align_left" id="S3.T7.1.5.4.1">
std. (data-matched)</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.2">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.2.1">60.5</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.3">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.3.1">71.6</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.4">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.4.1">41.5</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.5">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.5.1">44.5</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.6">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.6.1">59.9</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.7">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.7.1">64.2</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.8">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.8.1">30.0</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.9">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.9.1">27.2</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.10">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.10.1">27.9</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.5.4.11">
<p class="ltx_p ltx_align_top" id="S3.T7.1.5.4.11.1">47.5</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="S3.T7.1.6.5">
<td class="ltx_td ltx_align_left" id="S3.T7.1.6.5.1">reverse (<span class="ltx_text ltx_font_italic" id="S3.T7.1.6.5.1.1">token</span>)</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.2">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.2.1">63.7</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.3">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.3.1">72.9</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.4">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.4.1">41.6</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.5">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.5.1">45.1</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.6">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.6.1">60.0</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.7">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.7.1">65.7</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.8">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.8.1">30.5</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.9">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.9.1">28.0</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.10">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.10.1">25.8</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.6.5.11">
<p class="ltx_p ltx_align_top" id="S3.T7.1.6.5.11.1">48.1</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="S3.T7.1.1">
<td class="ltx_td ltx_align_left" id="S3.T7.1.1.1">reverse (<span class="ltx_text ltx_font_italic" id="S3.T7.1.1.1.1">entity<math alttext="{}^{*}" class="ltx_Math" display="inline" id="S3.T7.1.1.1.1.m1.1"><semantics id="S3.T7.1.1.1.1.m1.1a"><msup id="S3.T7.1.1.1.1.m1.1.1" xref="S3.T7.1.1.1.1.m1.1.1.cmml"><mi id="S3.T7.1.1.1.1.m1.1.1a" xref="S3.T7.1.1.1.1.m1.1.1.cmml"></mi><mo id="S3.T7.1.1.1.1.m1.1.1.1" mathvariant="normal" xref="S3.T7.1.1.1.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T7.1.1.1.1.m1.1b"><apply id="S3.T7.1.1.1.1.m1.1.1.cmml" xref="S3.T7.1.1.1.1.m1.1.1"><times id="S3.T7.1.1.1.1.m1.1.1.1.cmml" xref="S3.T7.1.1.1.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T7.1.1.1.1.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T7.1.1.1.1.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math></span>)</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.2">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.2.1">62.7</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.3">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.3.1">72.3</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.4">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.4.1">40.9</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.5">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.5.1">45.5</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.6">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.6.1">59.4</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.7">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.7.1">65.1</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.8">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.8.1">29.4</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.9">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.9.1">25.4</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.10">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.10.1">27.7</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify" id="S3.T7.1.1.11">
<p class="ltx_p ltx_align_top" id="S3.T7.1.1.11.1">47.6</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="S3.T7.1.7.6">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T7.1.7.6.1"><em class="ltx_emph ltx_font_italic" id="S3.T7.1.7.6.1.1">Model size: 7B</em></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.2"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.3"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.4"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.5"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.6"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.7"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.8"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.9"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.10"></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T7.1.7.6.11"></td>
</tr>
<tr class="ltx_tr" id="S3.T7.1.8.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T7.1.8.7.1">standard</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.2">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.2.1">77.4</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.3">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.3.1">78.8</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.4">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.4.1">48.3</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.5">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.5.1">77.2</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.6">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.6.1">69.2</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.7">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.7.1">75.2</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.8">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.8.1">45.9</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.9">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.9.1">58.6</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.10">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.10.1">45.3</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S3.T7.1.8.7.11">
<p class="ltx_p ltx_align_top" id="S3.T7.1.8.7.11.1">64.0</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Performance on standard benchmarks.
Reverse training can outperform standard training in the data-matched case, but is behind compute-matched training which uses more data.
Llama-2 7B accuracy is provided for reference and is taken from&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Touvron et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib33" title="">2023b</a>)</cite>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S3.T9">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span><span class="ltx_text ltx_font_bold" id="S3.T9.15.1">An example of reversed generations produced by 1.4B pre-trained models:</span> the model is asked to generate a text completion in both normal (<span class="ltx_text ltx_font_italic" id="S3.T9.16.2">left</span>) and reversed (<span class="ltx_text ltx_font_italic" id="S3.T9.17.3">right</span>) directions.</figcaption><div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_flex_size_1 ltx_align_middle" id="S3.T9.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T9.2.2">
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T9.2.2.3" style="width:65.4pt;"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T9.2.2.3.1">Query</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T9.1.1.1" style="width:156.5pt;">
<p class="ltx_p ltx_align_top" id="S3.T9.1.1.1.1.1">”The Star-Spangled Banner” is the <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T9.1.1.1.1.1.m1.1"><semantics id="S3.T9.1.1.1.1.1.m1.1a"><mo id="S3.T9.1.1.1.1.1.m1.1.1" stretchy="false" xref="S3.T9.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T9.1.1.1.1.1.m1.1b"><ci id="S3.T9.1.1.1.1.1.m1.1.1.cmml" xref="S3.T9.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T9.1.1.1.1.1.m1.1d">→</annotation></semantics></math></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="S3.T9.2.2.2" style="width:145.1pt;">
<p class="ltx_p ltx_align_top" id="S3.T9.2.2.2.1.1"><math alttext="\leftarrow" class="ltx_Math" display="inline" id="S3.T9.2.2.2.1.1.m1.1"><semantics id="S3.T9.2.2.2.1.1.m1.1a"><mo id="S3.T9.2.2.2.1.1.m1.1.1" stretchy="false" xref="S3.T9.2.2.2.1.1.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="S3.T9.2.2.2.1.1.m1.1b"><ci id="S3.T9.2.2.2.1.1.m1.1.1.cmml" xref="S3.T9.2.2.2.1.1.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.2.2.2.1.1.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T9.2.2.2.1.1.m1.1d">←</annotation></semantics></math> national anthem of the United States written by Francis Scott Key.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T9.3.3">
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="S3.T9.3.3.2" style="width:65.4pt;"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T9.3.3.2.1">standard</span></td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="S3.T9.3.3.1" style="width:156.5pt;">
<p class="ltx_p ltx_align_top" id="S3.T9.3.3.1.1.1"><math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T9.3.3.1.1.1.m1.1"><semantics id="S3.T9.3.3.1.1.1.m1.1a"><mo id="S3.T9.3.3.1.1.1.m1.1.1" stretchy="false" xref="S3.T9.3.3.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T9.3.3.1.1.1.m1.1b"><ci id="S3.T9.3.3.1.1.1.m1.1.1.cmml" xref="S3.T9.3.3.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.3.3.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T9.3.3.1.1.1.m1.1d">→</annotation></semantics></math> national anthem of the United States.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T9.3.3.3" style="width:145.1pt;"><span class="ltx_text ltx_font_typewriter ltx_align_top" id="S3.T9.3.3.3.1">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S3.T9.5.5">
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="S3.T9.5.5.3" style="width:65.4pt;"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T9.5.5.3.1">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.5.5.3.1.1">token</span>)</span></td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="S3.T9.4.4.1" style="width:156.5pt;">
<p class="ltx_p ltx_align_top" id="S3.T9.4.4.1.1.1"><math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T9.4.4.1.1.1.m1.1"><semantics id="S3.T9.4.4.1.1.1.m1.1a"><mo id="S3.T9.4.4.1.1.1.m1.1.1" stretchy="false" xref="S3.T9.4.4.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T9.4.4.1.1.1.m1.1b"><ci id="S3.T9.4.4.1.1.1.m1.1.1.cmml" xref="S3.T9.4.4.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.4.4.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T9.4.4.1.1.1.m1.1d">→</annotation></semantics></math> national anthem of the United States.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T9.5.5.2" style="width:145.1pt;">
<p class="ltx_p ltx_align_top" id="S3.T9.5.5.2.1.1">The Star Spangled Banner is the <math alttext="\leftarrow" class="ltx_Math" display="inline" id="S3.T9.5.5.2.1.1.m1.1"><semantics id="S3.T9.5.5.2.1.1.m1.1a"><mo id="S3.T9.5.5.2.1.1.m1.1.1" stretchy="false" xref="S3.T9.5.5.2.1.1.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="S3.T9.5.5.2.1.1.m1.1b"><ci id="S3.T9.5.5.2.1.1.m1.1.1.cmml" xref="S3.T9.5.5.2.1.1.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.5.5.2.1.1.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T9.5.5.2.1.1.m1.1d">←</annotation></semantics></math></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
<tr class="ltx_tr" id="S3.T9.8.8">
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r ltx_border_t" id="S3.T9.6.6.1" style="width:65.4pt;"><span class="ltx_text ltx_font_bold ltx_align_top" id="S3.T9.6.6.1.1.1.1">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.6.6.1.1.1.1.1">entity<math alttext="{}^{*}" class="ltx_Math" display="inline" id="S3.T9.6.6.1.1.1.1.1.m1.1"><semantics id="S3.T9.6.6.1.1.1.1.1.m1.1a"><msup id="S3.T9.6.6.1.1.1.1.1.m1.1.1" xref="S3.T9.6.6.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.T9.6.6.1.1.1.1.1.m1.1.1a" xref="S3.T9.6.6.1.1.1.1.1.m1.1.1.cmml"></mi><mo id="S3.T9.6.6.1.1.1.1.1.m1.1.1.1" mathvariant="normal" xref="S3.T9.6.6.1.1.1.1.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T9.6.6.1.1.1.1.1.m1.1b"><apply id="S3.T9.6.6.1.1.1.1.1.m1.1.1.cmml" xref="S3.T9.6.6.1.1.1.1.1.m1.1.1"><times id="S3.T9.6.6.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.T9.6.6.1.1.1.1.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.6.6.1.1.1.1.1.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T9.6.6.1.1.1.1.1.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math></span>)</span></td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r ltx_border_t" id="S3.T9.7.7.2" style="width:156.5pt;">
<p class="ltx_p ltx_align_top" id="S3.T9.7.7.2.1.1"><math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.T9.7.7.2.1.1.m1.1"><semantics id="S3.T9.7.7.2.1.1.m1.1a"><mo id="S3.T9.7.7.2.1.1.m1.1.1" stretchy="false" xref="S3.T9.7.7.2.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.T9.7.7.2.1.1.m1.1b"><ci id="S3.T9.7.7.2.1.1.m1.1.1.cmml" xref="S3.T9.7.7.2.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.7.7.2.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T9.7.7.2.1.1.m1.1d">→</annotation></semantics></math> national anthem of the United States.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="S3.T9.8.8.3" style="width:145.1pt;">
<p class="ltx_p ltx_align_top" id="S3.T9.8.8.3.1.1">The Star-Spangled Banner is the <math alttext="\leftarrow" class="ltx_Math" display="inline" id="S3.T9.8.8.3.1.1.m1.1"><semantics id="S3.T9.8.8.3.1.1.m1.1a"><mo id="S3.T9.8.8.3.1.1.m1.1.1" stretchy="false" xref="S3.T9.8.8.3.1.1.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="S3.T9.8.8.3.1.1.m1.1b"><ci id="S3.T9.8.8.3.1.1.m1.1.1.cmml" xref="S3.T9.8.8.3.1.1.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.8.8.3.1.1.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T9.8.8.3.1.1.m1.1d">←</annotation></semantics></math></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_flex_size_1 ltx_align_center ltx_transformed_outer" id="S3.T9.11" style="width:433.6pt;height:266pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(55.4pt,-34.0pt) scale(1.34351435198362,1.34351435198362) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T9.11.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T9.11.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T9.11.3.4.1.1" rowspan="2"><span class="ltx_text" id="S3.T9.11.3.4.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T9.11.3.4.1.1.1.1">Pre-training</span><span class="ltx_text ltx_font_bold" id="S3.T9.11.3.4.1.1.1.2"> method</span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T9.11.3.4.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T9.11.3.4.1.2.1">Finetuning method</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T9.11.3.4.1.3"><span class="ltx_text ltx_font_bold" id="S3.T9.11.3.4.1.3.1">NameToDescription</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T9.11.3.4.1.4"><span class="ltx_text ltx_font_bold" id="S3.T9.11.3.4.1.4.1">DescriptionToName</span></td>
</tr>
<tr class="ltx_tr" id="S3.T9.11.3.5.2">
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T9.11.3.5.2.1"><span class="ltx_text ltx_font_bold" id="S3.T9.11.3.5.2.1.1">forward</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T9.11.3.5.2.2"><span class="ltx_text ltx_font_bold" id="S3.T9.11.3.5.2.2.1">reverse</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T9.11.3.5.2.3"><span class="ltx_text ltx_font_bold" id="S3.T9.11.3.5.2.3.1">forward</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T9.11.3.5.2.4"><span class="ltx_text ltx_font_bold" id="S3.T9.11.3.5.2.4.1">reverse</span></td>
</tr>
<tr class="ltx_tr" id="S3.T9.11.3.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T9.11.3.6.3.1"><em class="ltx_emph ltx_font_italic" id="S3.T9.11.3.6.3.1.1">Model size: 1.4B</em></th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S3.T9.11.3.6.3.2"></th>
<td class="ltx_td ltx_border_t" id="S3.T9.11.3.6.3.3"></td>
<td class="ltx_td ltx_border_t" id="S3.T9.11.3.6.3.4"></td>
<td class="ltx_td ltx_border_t" id="S3.T9.11.3.6.3.5"></td>
<td class="ltx_td ltx_border_t" id="S3.T9.11.3.6.3.6"></td>
</tr>
<tr class="ltx_tr" id="S3.T9.11.3.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.7.4.1">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.11.3.7.4.1.1">token)</span>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.7.4.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.11.3.7.4.2.1">token)</span>
</th>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.7.4.3">78.3</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.7.4.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.7.4.5">100</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.7.4.6">2.7</td>
</tr>
<tr class="ltx_tr" id="S3.T9.9.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.9.1.1.1">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.9.1.1.1.1">entity<math alttext="{}^{*}" class="ltx_Math" display="inline" id="S3.T9.9.1.1.1.1.m1.1"><semantics id="S3.T9.9.1.1.1.1.m1.1a"><msup id="S3.T9.9.1.1.1.1.m1.1.1" xref="S3.T9.9.1.1.1.1.m1.1.1.cmml"><mi id="S3.T9.9.1.1.1.1.m1.1.1a" xref="S3.T9.9.1.1.1.1.m1.1.1.cmml"></mi><mo id="S3.T9.9.1.1.1.1.m1.1.1.1" mathvariant="normal" xref="S3.T9.9.1.1.1.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T9.9.1.1.1.1.m1.1b"><apply id="S3.T9.9.1.1.1.1.m1.1.1.cmml" xref="S3.T9.9.1.1.1.1.m1.1.1"><times id="S3.T9.9.1.1.1.1.m1.1.1.1.cmml" xref="S3.T9.9.1.1.1.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.9.1.1.1.1.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T9.9.1.1.1.1.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math></span>)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.9.1.1.2">standard</th>
<td class="ltx_td ltx_align_right" id="S3.T9.9.1.1.3">78.0</td>
<td class="ltx_td ltx_align_right" id="S3.T9.9.1.1.4">0.0</td>
<td class="ltx_td ltx_align_right" id="S3.T9.9.1.1.5">96.3</td>
<td class="ltx_td ltx_align_right" id="S3.T9.9.1.1.6">0.3</td>
</tr>
<tr class="ltx_tr" id="S3.T9.10.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.10.2.2.1">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.10.2.2.1.1">entity<math alttext="{}^{*}" class="ltx_Math" display="inline" id="S3.T9.10.2.2.1.1.m1.1"><semantics id="S3.T9.10.2.2.1.1.m1.1a"><msup id="S3.T9.10.2.2.1.1.m1.1.1" xref="S3.T9.10.2.2.1.1.m1.1.1.cmml"><mi id="S3.T9.10.2.2.1.1.m1.1.1a" xref="S3.T9.10.2.2.1.1.m1.1.1.cmml"></mi><mo id="S3.T9.10.2.2.1.1.m1.1.1.1" mathvariant="normal" xref="S3.T9.10.2.2.1.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T9.10.2.2.1.1.m1.1b"><apply id="S3.T9.10.2.2.1.1.m1.1.1.cmml" xref="S3.T9.10.2.2.1.1.m1.1.1"><times id="S3.T9.10.2.2.1.1.m1.1.1.1.cmml" xref="S3.T9.10.2.2.1.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.10.2.2.1.1.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T9.10.2.2.1.1.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math></span>)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.10.2.2.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.10.2.2.2.1">word)</span>
</th>
<td class="ltx_td ltx_align_right" id="S3.T9.10.2.2.3">71.0</td>
<td class="ltx_td ltx_align_right" id="S3.T9.10.2.2.4">2.7</td>
<td class="ltx_td ltx_align_right" id="S3.T9.10.2.2.5">94.7</td>
<td class="ltx_td ltx_align_right" id="S3.T9.10.2.2.6">2.0</td>
</tr>
<tr class="ltx_tr" id="S3.T9.11.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.3.1">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.11.3.3.1.1">entity<math alttext="{}^{*}" class="ltx_Math" display="inline" id="S3.T9.11.3.3.1.1.m1.1"><semantics id="S3.T9.11.3.3.1.1.m1.1a"><msup id="S3.T9.11.3.3.1.1.m1.1.1" xref="S3.T9.11.3.3.1.1.m1.1.1.cmml"><mi id="S3.T9.11.3.3.1.1.m1.1.1a" xref="S3.T9.11.3.3.1.1.m1.1.1.cmml"></mi><mo id="S3.T9.11.3.3.1.1.m1.1.1.1" mathvariant="normal" xref="S3.T9.11.3.3.1.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T9.11.3.3.1.1.m1.1b"><apply id="S3.T9.11.3.3.1.1.m1.1.1.cmml" xref="S3.T9.11.3.3.1.1.m1.1.1"><times id="S3.T9.11.3.3.1.1.m1.1.1.1.cmml" xref="S3.T9.11.3.3.1.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T9.11.3.3.1.1.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.T9.11.3.3.1.1.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math></span>)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.3.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.11.3.3.2.1">entity</span>)</th>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.3.3">77.0</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.3.4">78.3</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.3.5">95.3</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.3.6">2.3</td>
</tr>
<tr class="ltx_tr" id="S3.T9.11.3.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.8.5.1">std. (compute-matched)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.8.5.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.11.3.8.5.2.1">rand k=5</span>)</th>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.8.5.3">77.0</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.8.5.4">52.3</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.8.5.5">96.0</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.8.5.6">10.7</td>
</tr>
<tr class="ltx_tr" id="S3.T9.11.3.9.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.9.6.1">std. (compute-matched)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.9.6.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.11.3.9.6.2.1">rand k=10</span>)</th>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.9.6.3">74.7</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.9.6.4">85.3</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.9.6.5">93.7</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.9.6.6">33.7</td>
</tr>
<tr class="ltx_tr" id="S3.T9.11.3.10.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.10.7.1">std. (compute-matched)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T9.11.3.10.7.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.11.3.10.7.2.1">rand k=25</span>)</th>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.10.7.3">77.3</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.10.7.4">96.3</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.10.7.5">97.7</td>
<td class="ltx_td ltx_align_right" id="S3.T9.11.3.10.7.6">70.7</td>
</tr>
<tr class="ltx_tr" id="S3.T9.11.3.11.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T9.11.3.11.8.1">std. (compute-matched)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T9.11.3.11.8.2">reverse (<span class="ltx_text ltx_font_italic" id="S3.T9.11.3.11.8.2.1">rand k=50</span>)</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T9.11.3.11.8.3">77.3</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T9.11.3.11.8.4">89.3</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T9.11.3.11.8.5">93.0</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T9.11.3.11.8.6">67.3</td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span><span class="ltx_text ltx_font_bold" id="S3.T9.15.1">An example of reversed generations produced by 1.4B pre-trained models:</span> the model is asked to generate a text completion in both normal (<span class="ltx_text ltx_font_italic" id="S3.T9.16.2">left</span>) and reversed (<span class="ltx_text ltx_font_italic" id="S3.T9.17.3">right</span>) directions.</figcaption>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Test accuracy (%) on the <span class="ltx_text ltx_font_italic" id="S3.T9.19.1">fictitious celebrities</span> task for various different pre-training and finetuning ablation methods.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Analysis &amp; ablation experiments</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S3.SS5.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Does reversal training hurt performance on standard tasks?</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS5.SSS0.Px1.p1.1">In <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS1" title="3.1 Symbolic reverse task ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Sections</span>&nbsp;<span class="ltx_text ltx_ref_tag">3.1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS2" title="3.2 Reversing Biography Task ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">3.2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS3" title="3.3 Reversing real-world knowledge via pre-training ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">3.3</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#S3.SS4" title="3.4 Reversing fictitious facts via finetuning ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">3.4</span></a> we showed that reverse training helps to mitigate the reversal curse. Here, we explore if our method disrupts zero-shot performance on common evaluation tasks: BoolQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clark et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib7" title="">2019</a>)</cite>, PIQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bisk et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib6" title="">2020</a>)</cite>, SIQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sap et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib25" title="">2019</a>)</cite>, HellaSwag&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zellers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib35" title="">2019</a>)</cite>, WinoGrande&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib24" title="">2021</a>)</cite>, ARC easy and challenge&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clark et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib8" title="">2018</a>)</cite>, OpenBookQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mihaylov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib20" title="">2018</a>)</cite>. We also report 5-shot performance on the aggregated MMLU benchmark&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib13" title="">2020</a>)</cite>. Evaluation results are summarized in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S3.T7" title="Table 7 ‣ 3.4 Reversing fictitious facts via finetuning ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;7</span></a>. We observe that
our entity reversal trained model is slightly better than the standard data-matched 1.4B model trained in the standard forward direction, and is only 1.8 points behind the compute-matched model in accuracy on average, despite being trained on half of the tokens.
We note that token reversal works slightly better than entity reversal on these standard benchmarks, and hence superior to the data-matched standard training as well.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS5.SSS0.Px1.p2.1">We also find that reversed models can not only generate text continuations in the normal left-to-right direction, but can generate the beginning of the text given a continuation — a capability that standard models lack. We give an example in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S3.T9" title="Table 9 ‣ 3.4 Reversing fictitious facts via finetuning ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;9</span></a>.
This reverse generation function can be useful in itself, for example for instruction backtranslation <cite class="ltx_cite ltx_citemacro_citep">(Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib16" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS5.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Does the unit of reversal matter?</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS5.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS5.SSS0.Px2.p1.1">To understand the effect of segment granularity when reversing sequences,
we evaluate the performance of the following training methods on the fictitious celebrities task:
standard finetuning, token and word reversal finetuning, entity-preserving reversal finetuning, and random segment reversal finetuning with varying <math alttext="k" class="ltx_Math" display="inline" id="S3.SS5.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS5.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS5.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS5.SSS0.Px2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS5.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS5.SSS0.Px2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS0.Px2.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS0.Px2.p1.1.m1.1d">italic_k</annotation></semantics></math> as described in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S2" title="2 Reverse Training ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Section&nbsp;2</span></a>.
The results are summarized in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S3.T9" title="Table 9 ‣ 3.4 Reversing fictitious facts via finetuning ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Table&nbsp;9</span></a>.
In general, we find that reversing at a fine-grained level such as token or word level does not significantly help to resolve the reversal curse, and only improves performance on the reverse tasks by 2-3%.
Preserving entities during reversal makes it possible to predict names, but not descriptions.
This indicates a close relation between the unit of reversal training and the target “concepts” (e.g. names, descriptions) of the reversal task.
Similarly, the random segment reversal performs poorly at predicting descriptions when the segment length limit is set lower than the typical length of a description.
The results from <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#S3.SS1" title="3.1 Symbolic reverse task ‣ 3 Experiments ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Section&nbsp;3.1</span></a> also support this hypothesis.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Reversal Curse &amp; Mitgiations</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.1">The reversal curse was identified by the concurrent works <cite class="ltx_cite ltx_citemacro_citet">Berglund et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib5" title="">2023b</a>); Allen-Zhu &amp; Li (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib2" title="">2023b</a>)</cite>; its name was derived from the former. They demonstrated that the reversal curse occurs across model sizes and families, including very large models such as GPT-3.5 and GPT-4. They found that including auxiliary examples with both orders present in the finetuning or pre-training datasets (to promote meta-learning) does not aid generalization to examples where only one order is given, even if such data is rewritten in a question-answer format. Furthermore, including multiple paraphrases of each fact in a single direction does not facilitate learning in the reverse direction, despite aiding the given direction, as shown by <cite class="ltx_cite ltx_citemacro_citet">Berglund et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib4" title="">2023a</a>); Allen-Zhu &amp; Li (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib1" title="">2023a</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p2.1">The concurrent work by <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib1" title="">2023a</a>)</cite> investigates a related set of failures and potential solutions. Exploring the capability to answer questions based on synthetic biographies, they examine several data augmentation strategies, including incorporating instruction tuning data into pre-training, generating multiple unique biography entries, permuting biography sentences, and substituting pronouns or partial names with full names. They discover that augmentation during the pre-training phase is essential for enhancing downstream question answering performance across various tasks. However, in real pre-training data, some augmentations may not be feasible — for instance, permuting sentences could degrade language model quality, and it remains uncertain how to best rewrite data during augmentation. Reverse training addresses this issue by presenting a distinct language task (the reversed language) to the language model, thereby avoiding interference with the primary task of left-to-right natural language modeling.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Right-to-left, masked &amp; other training variants</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p1.1">Multiple works have proposed pre-training language models with
rephrased or paraphrased text <cite class="ltx_cite ltx_citemacro_citep">(Lewis et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib15" title="">2020</a>; Maini et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib19" title="">2024</a>)</cite>,
but were not targeting the reversal curse.
Training right-to-left has been explored before <cite class="ltx_cite ltx_citemacro_citep">(Pfau et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib23" title="">2023</a>)</cite>,
but not by multitasking with left-to-right models. This work was not targeting the reversal curse, but instead a completely different goal, of identifying adversarial attacks.
Rather than training left-to-right, or right-to-left, masked language models aim to learn how to “fill in the middle”, going back to
early language modeling work such as <cite class="ltx_cite ltx_citemacro_citet">Collobert et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib9" title="">2011</a>)</cite>, and models such as BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib11" title="">2018</a>)</cite>.
Other methods have also been proposed to explicitly fill in middle text sections by rearranging data <cite class="ltx_cite ltx_citemacro_citep">(Bavarian et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib3" title="">2022</a>)</cite>, to train on scrambled data <cite class="ltx_cite ltx_citemacro_citep">(Sinha et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib30" title="">2021</a>)</cite>, or to train on all permutations of the factorization order <cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib34" title="">2019</a>)</cite>.
Relatedly, transforming training data with repeating segments has also been shown to improve language model embeddings <cite class="ltx_cite ltx_citemacro_citep">(Springer et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib31" title="">2024</a>)</cite>.
Encoder-only models akin to BERT have been shown to <span class="ltx_text ltx_font_italic" id="S4.SS0.SSS0.Px2.p1.1.1">not</span> mitigate the reversal curse <cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu &amp; Li, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib1" title="">2023a</a>)</cite>.
However, modifying the architecture and training procedure <span class="ltx_text ltx_font_italic" id="S4.SS0.SSS0.Px2.p1.1.2">has</span> been shown to help, e.g. by introducing BIdirectional Casual language modeling Optimization (BICO) <cite class="ltx_cite ltx_citemacro_citep">(Lv et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib18" title="">2023</a>)</cite>. In contrast, our work seeks to rectify the issue while keeping standard language model training as similar as possible to the current regime.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS0.SSS0.Px2.p2.1">The most similar work to ours is the concurrent work of <cite class="ltx_cite ltx_citemacro_citet">Guo et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib12" title="">2024</a>)</cite>. They employ various augmentations at the finetuning, rather than pre-training stage, including shuffling and reversing chunks of the input sentences.
Unlike our method, their method first segments sentences in the training into semantically meaningful chunks via an LLM.
While a chunk can be an entity name, it is more generally applied to all words, e.g. “of developing the first emotional” as a chunk.
The actual segmentation is done via prompting another LLM with a specific instruction.
Therefore, the unit of reversal will depend on the LLM and its prompt, making it presumably a difficult language modeling problem, whilst also requiring extra compute to reverse the sequence.
This is applied only to finetuning on short sentences, which means the reversal curse mitigation is limited to the facts included in the finetuning data, and it is unclear if it can be applied to large pre-training documents.
In contrast, our method is applied in the pre-training stage so it can learn to reverse a wide-range of general knowledge facts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we introduced a simple yet effective training method to help remedy the reversal curse in LLMs.
Our reverse training works by first segmenting the input sequence into chunks and then reversing the ordering of chunks, but leaves the word-ordering in each chunk intact.
A chunk can be a token, a word, an entity name, or a random number of tokens.
The model is then trained on both the original sequences, and this reversed data.
We evaluated on a symbolic reverse task and a reversing biography task that both demonstrated the necessity of preserving word-ordering within chunks.
Next, we applied our reverse training to the realistic setting of LLM pre-training, which minimized the reversal curse on real-world knowledge.
Evaluations on common benchmark tasks reveal that reverse training (particularly at the word level) during pre-training does not interfere with the forward prediction ability of LLMs, and actually improves metrics in the data-bound (rather than compute-bound) setting compared to standard training.
When our method is applied to finetuning on fictitious facts, prediction accuracy rose from 0% to 70-100%.
The reversal curse is a serious flaw in how LLMs acquire knowledge and reverse training opens a new promising direction in resolving it.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allen-Zhu &amp; Li (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zeyuan Allen-Zhu and Yuanzhi Li.

</span>
<span class="ltx_bibblock">Physics of language models: Part 3.1, knowledge storage and extraction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">ArXiv e-prints</em>, abs/2309.14316, September 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allen-Zhu &amp; Li (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zeyuan Allen-Zhu and Yuanzhi Li.

</span>
<span class="ltx_bibblock">Physics of Language Models: Part 3.2, Knowledge Manipulation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">ArXiv e-prints</em>, abs/2309.14402, September 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bavarian et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mohammad Bavarian, Heewoo Jun, Nikolas Tezak, John Schulman, Christine McLeavey, Jerry Tworek, and Mark Chen.

</span>
<span class="ltx_bibblock">Efficient training of language models to fill in the middle.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2207.14255</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berglund et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Lukas Berglund, Asa&nbsp;Cooper Stickland, Mikita Balesni, Max Kaufmann, Meg Tong, Tomasz Korbak, Daniel Kokotajlo, and Owain Evans.

</span>
<span class="ltx_bibblock">Taken out of context: On measuring situational awareness in llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2309.00667</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berglund et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Lukas Berglund, Meg Tong, Max Kaufmann, Mikita Balesni, Asa&nbsp;Cooper Stickland, Tomasz Korbak, and Owain Evans.

</span>
<span class="ltx_bibblock">The reversal curse: Llms trained on” a is b” fail to learn” b is a”.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2309.12288</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yonatan Bisk, Rowan Zellers, Jianfeng Gao, Yejin Choi, et&nbsp;al.

</span>
<span class="ltx_bibblock">Piqa: Reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume&nbsp;34, pp.&nbsp; 7432–7439, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Christopher Clark, Kenton Lee, Ming-Wei Chang, Tom Kwiatkowski, Michael Collins, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Boolq: Exploring the surprising difficulty of natural yes/no questions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:1905.10044</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Peter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa Schoenick, and Oyvind Tafjord.

</span>
<span class="ltx_bibblock">Think you have solved question answering? try arc, the ai2 reasoning challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:1803.05457</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collobert et&nbsp;al. (2011)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ronan Collobert, Jason Weston, Léon Bottou, Michael Karlen, Koray Kavukcuoglu, and Pavel Kuksa.

</span>
<span class="ltx_bibblock">Natural language processing (almost) from scratch.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Journal of machine learning research</em>, 12(ARTICLE):2493–2537, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Del’etang et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Gr’egoire Del’etang, Anian Ruoss, Paul-Ambroise Duquenne, Elliot Catt, Tim Genewein, Christopher Mattern, Jordi Grau-Moya, Wenliang&nbsp;Kevin Li, Matthew Aitchison, Laurent Orseau, Marcus Hutter, and Joel Veness.

</span>
<span class="ltx_bibblock">Language modeling is compression.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ArXiv</em>, abs/2309.10668, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:262054258" title="">https://api.semanticscholar.org/CorpusID:262054258</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:1810.04805</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qingyan Guo, Rui Wang, Junliang Guo, Xu&nbsp;Tan, Jiang Bian, and Yujiu Yang.

</span>
<span class="ltx_bibblock">Mitigating reversal curse via semantic-aware permutation training, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2009.03300</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lample &amp; Conneau (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guillaume Lample and Alexis Conneau.

</span>
<span class="ltx_bibblock">Cross-lingual language model pretraining.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1901.07291</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mike Lewis, Marjan Ghazvininejad, Gargi Ghosh, Armen Aghajanyan, Sida Wang, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Pre-training via paraphrasing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>, 33:18470–18481, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xian Li, Ping Yu, Chunting Zhou, Timo Schick, Luke Zettlemoyer, Omer Levy, Jason Weston, and Mike Lewis.

</span>
<span class="ltx_bibblock">Self-alignment with instruction backtranslation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">ArXiv</em>, abs/2308.06259, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:260866107" title="">https://api.semanticscholar.org/CorpusID:260866107</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loper &amp; Bird (2002)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Edward Loper and Steven Bird.

</span>
<span class="ltx_bibblock">Nltk: The natural language toolkit.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint cs/0205028</em>, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lv et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ang Lv, Kaiyi Zhang, Shufang Xie, Quan Tu, Yuhan Chen, Ji-Rong Wen, and Rui Yan.

</span>
<span class="ltx_bibblock">Are we falling in a middle-intelligence trap? an analysis and mitigation of the reversal curse.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2311.07468</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maini et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pratyush Maini, Skyler Seto, He&nbsp;Bai, David Grangier, Yizhe Zhang, and Navdeep Jaitly.

</span>
<span class="ltx_bibblock">Rephrasing the web: A recipe for compute and data-efficient language modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2401.16380</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mihaylov et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Todor Mihaylov, Peter Clark, Tushar Khot, and Ashish Sabharwal.

</span>
<span class="ltx_bibblock">Can a suit of armor conduct electricity? a new dataset for open book question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:1809.02789</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Newman (2005)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mark&nbsp;EJ Newman.

</span>
<span class="ltx_bibblock">Power laws, pareto distributions and zipf’s law.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Contemporary physics</em>, 46(5):323–351, 2005.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pfau et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jacob Pfau, Alex Infanger, Abhay Sheshadri, Ayush Panda, Julian Michael, and Curtis Huebner.

</span>
<span class="ltx_bibblock">Eliciting language model behaviors using reverse language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Socially Responsible Language Modelling Research</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakaguchi et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Keisuke Sakaguchi, Ronan&nbsp;Le Bras, Chandra Bhagavatula, and Yejin Choi.

</span>
<span class="ltx_bibblock">Winogrande: An adversarial winograd schema challenge at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Communications of the ACM</em>, 64(9):99–106, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sap et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Maarten Sap, Hannah Rashkin, Derek Chen, Ronan LeBras, and Yejin Choi.

</span>
<span class="ltx_bibblock">Socialiqa: Commonsense reasoning about social interactions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:1904.09728</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schweter &amp; Akbik (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stefan Schweter and Alan Akbik.

</span>
<span class="ltx_bibblock">Flert: Document-level features for named entity recognition, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rico Sennrich, Barry Haddow, and Alexandra Birch.

</span>
<span class="ltx_bibblock">Neural machine translation of rare words with subword units.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:1508.07909</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shannon (1948)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
C.&nbsp;E. Shannon.

</span>
<span class="ltx_bibblock">A mathematical theory of communication.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">The Bell System Technical Journal</em>, 27(3):379–423, 1948.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.1002/j.1538-7305.1948.tb01338.x" title="">10.1002/j.1538-7305.1948.tb01338.x</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhihong Shao, Peiyi Wang, Qihao Zhu, R.&nbsp;X. Xu, Jun-Mei Song, Mingchuan Zhang, Y.&nbsp;K. Li, Yu&nbsp;Wu, and Daya Guo.

</span>
<span class="ltx_bibblock">Deepseekmath: Pushing the limits of mathematical reasoning in open language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">ArXiv</em>, abs/2402.03300, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:267412607" title="">https://api.semanticscholar.org/CorpusID:267412607</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sinha et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Koustuv Sinha, Robin Jia, Dieuwke Hupkes, Joelle Pineau, Adina Williams, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Masked language modeling and the distributional hypothesis: Order word matters pre-training for little.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2104.06644</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Springer et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jacob&nbsp;Mitchell Springer, Suhas Kotha, Daniel Fried, Graham Neubig, and Aditi Raghunathan.

</span>
<span class="ltx_bibblock">Repetition improves language model embeddings.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2402.15449</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2302.13971</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian&nbsp;Canton Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa, Isabel Kloumann, Artem Korenev, Punit&nbsp;Singh Koura, Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan Silva, Eric&nbsp;Michael Smith, Ranjan Subramanian, Xiaoqing&nbsp;Ellen Tan, Binh Tang, Ross Taylor, Adina Williams, Jian&nbsp;Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurelien Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas
Scialom.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhilin Yang, Zihang Dai, Yiming Yang, Jaime Carbonell, Russ&nbsp;R Salakhutdinov, and Quoc&nbsp;V Le.

</span>
<span class="ltx_bibblock">Xlnet: Generalized autoregressive pretraining for language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi.

</span>
<span class="ltx_bibblock">Hellaswag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:1905.07830</em>, 2019.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Symbolic reverse task details</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.8">The vocabulary is built by generating 100 different words per position, e.g. <span class="ltx_text ltx_font_typewriter" id="A1.p1.8.1">a200</span> to <span class="ltx_text ltx_font_typewriter" id="A1.p1.8.2">a299</span> for the second word of entities <math alttext="a_{i}" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><msub id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">a</mi><mi id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2">𝑎</ci><ci id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
Then we create 10,000 entities <math alttext="a_{i}" class="ltx_Math" display="inline" id="A1.p1.2.m2.1"><semantics id="A1.p1.2.m2.1a"><msub id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><mi id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml">a</mi><mi id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2">𝑎</ci><ci id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and 10,000 entities <math alttext="b_{j}" class="ltx_Math" display="inline" id="A1.p1.3.m3.1"><semantics id="A1.p1.3.m3.1a"><msub id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mi id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">b</mi><mi id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">𝑏</ci><ci id="A1.p1.3.m3.1.1.3.cmml" xref="A1.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">b_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.3.m3.1d">italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> by concatenating random words specific to each position.
Finally, <math alttext="a_{i}" class="ltx_Math" display="inline" id="A1.p1.4.m4.1"><semantics id="A1.p1.4.m4.1a"><msub id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml"><mi id="A1.p1.4.m4.1.1.2" xref="A1.p1.4.m4.1.1.2.cmml">a</mi><mi id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p1.4.m4.1.1.1.cmml" xref="A1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">𝑎</ci><ci id="A1.p1.4.m4.1.1.3.cmml" xref="A1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> entities are randomly mapped to <math alttext="b_{j}" class="ltx_Math" display="inline" id="A1.p1.5.m5.1"><semantics id="A1.p1.5.m5.1a"><msub id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml"><mi id="A1.p1.5.m5.1.1.2" xref="A1.p1.5.m5.1.1.2.cmml">b</mi><mi id="A1.p1.5.m5.1.1.3" xref="A1.p1.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b"><apply id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.p1.5.m5.1.1.1.cmml" xref="A1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.p1.5.m5.1.1.2.cmml" xref="A1.p1.5.m5.1.1.2">𝑏</ci><ci id="A1.p1.5.m5.1.1.3.cmml" xref="A1.p1.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">b_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.5.m5.1d">italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, resulting in 10,000 pairs.
The model is an 8-layer Transformer with a hidden size of 512.
The training is continued for 500 epochs with batch size <math alttext="=1024" class="ltx_Math" display="inline" id="A1.p1.6.m6.1"><semantics id="A1.p1.6.m6.1a"><mrow id="A1.p1.6.m6.1.1" xref="A1.p1.6.m6.1.1.cmml"><mi id="A1.p1.6.m6.1.1.2" xref="A1.p1.6.m6.1.1.2.cmml"></mi><mo id="A1.p1.6.m6.1.1.1" xref="A1.p1.6.m6.1.1.1.cmml">=</mo><mn id="A1.p1.6.m6.1.1.3" xref="A1.p1.6.m6.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.6.m6.1b"><apply id="A1.p1.6.m6.1.1.cmml" xref="A1.p1.6.m6.1.1"><eq id="A1.p1.6.m6.1.1.1.cmml" xref="A1.p1.6.m6.1.1.1"></eq><csymbol cd="latexml" id="A1.p1.6.m6.1.1.2.cmml" xref="A1.p1.6.m6.1.1.2">absent</csymbol><cn id="A1.p1.6.m6.1.1.3.cmml" type="integer" xref="A1.p1.6.m6.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m6.1c">=1024</annotation><annotation encoding="application/x-llamapun" id="A1.p1.6.m6.1d">= 1024</annotation></semantics></math>, learning rate <math alttext="=0.0003" class="ltx_Math" display="inline" id="A1.p1.7.m7.1"><semantics id="A1.p1.7.m7.1a"><mrow id="A1.p1.7.m7.1.1" xref="A1.p1.7.m7.1.1.cmml"><mi id="A1.p1.7.m7.1.1.2" xref="A1.p1.7.m7.1.1.2.cmml"></mi><mo id="A1.p1.7.m7.1.1.1" xref="A1.p1.7.m7.1.1.1.cmml">=</mo><mn id="A1.p1.7.m7.1.1.3" xref="A1.p1.7.m7.1.1.3.cmml">0.0003</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.7.m7.1b"><apply id="A1.p1.7.m7.1.1.cmml" xref="A1.p1.7.m7.1.1"><eq id="A1.p1.7.m7.1.1.1.cmml" xref="A1.p1.7.m7.1.1.1"></eq><csymbol cd="latexml" id="A1.p1.7.m7.1.1.2.cmml" xref="A1.p1.7.m7.1.1.2">absent</csymbol><cn id="A1.p1.7.m7.1.1.3.cmml" type="float" xref="A1.p1.7.m7.1.1.3">0.0003</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m7.1c">=0.0003</annotation><annotation encoding="application/x-llamapun" id="A1.p1.7.m7.1d">= 0.0003</annotation></semantics></math>, and dropout rate <math alttext="=0.1" class="ltx_Math" display="inline" id="A1.p1.8.m8.1"><semantics id="A1.p1.8.m8.1a"><mrow id="A1.p1.8.m8.1.1" xref="A1.p1.8.m8.1.1.cmml"><mi id="A1.p1.8.m8.1.1.2" xref="A1.p1.8.m8.1.1.2.cmml"></mi><mo id="A1.p1.8.m8.1.1.1" xref="A1.p1.8.m8.1.1.1.cmml">=</mo><mn id="A1.p1.8.m8.1.1.3" xref="A1.p1.8.m8.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.8.m8.1b"><apply id="A1.p1.8.m8.1.1.cmml" xref="A1.p1.8.m8.1.1"><eq id="A1.p1.8.m8.1.1.1.cmml" xref="A1.p1.8.m8.1.1.1"></eq><csymbol cd="latexml" id="A1.p1.8.m8.1.1.2.cmml" xref="A1.p1.8.m8.1.1.2">absent</csymbol><cn id="A1.p1.8.m8.1.1.3.cmml" type="float" xref="A1.p1.8.m8.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.8.m8.1c">=0.1</annotation><annotation encoding="application/x-llamapun" id="A1.p1.8.m8.1d">= 0.1</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Transformer model pre-training</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.4">We train a transformer model with <math alttext="dim=2048" class="ltx_Math" display="inline" id="A2.p1.1.m1.1"><semantics id="A2.p1.1.m1.1a"><mrow id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mrow id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml"><mi id="A2.p1.1.m1.1.1.2.2" xref="A2.p1.1.m1.1.1.2.2.cmml">d</mi><mo id="A2.p1.1.m1.1.1.2.1" xref="A2.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.2.3" xref="A2.p1.1.m1.1.1.2.3.cmml">i</mi><mo id="A2.p1.1.m1.1.1.2.1a" xref="A2.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.2.4" xref="A2.p1.1.m1.1.1.2.4.cmml">m</mi></mrow><mo id="A2.p1.1.m1.1.1.1" xref="A2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><eq id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1.1"></eq><apply id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2"><times id="A2.p1.1.m1.1.1.2.1.cmml" xref="A2.p1.1.m1.1.1.2.1"></times><ci id="A2.p1.1.m1.1.1.2.2.cmml" xref="A2.p1.1.m1.1.1.2.2">𝑑</ci><ci id="A2.p1.1.m1.1.1.2.3.cmml" xref="A2.p1.1.m1.1.1.2.3">𝑖</ci><ci id="A2.p1.1.m1.1.1.2.4.cmml" xref="A2.p1.1.m1.1.1.2.4">𝑚</ci></apply><cn id="A2.p1.1.m1.1.1.3.cmml" type="integer" xref="A2.p1.1.m1.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">dim=2048</annotation><annotation encoding="application/x-llamapun" id="A2.p1.1.m1.1d">italic_d italic_i italic_m = 2048</annotation></semantics></math>, <math alttext="n\_layers=24" class="ltx_Math" display="inline" id="A2.p1.2.m2.1"><semantics id="A2.p1.2.m2.1a"><mrow id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mrow id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml"><mi id="A2.p1.2.m2.1.1.2.2" xref="A2.p1.2.m2.1.1.2.2.cmml">n</mi><mo id="A2.p1.2.m2.1.1.2.1" xref="A2.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.2.m2.1.1.2.3" mathvariant="normal" xref="A2.p1.2.m2.1.1.2.3.cmml">_</mi><mo id="A2.p1.2.m2.1.1.2.1a" xref="A2.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.2.m2.1.1.2.4" xref="A2.p1.2.m2.1.1.2.4.cmml">l</mi><mo id="A2.p1.2.m2.1.1.2.1b" xref="A2.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.2.m2.1.1.2.5" xref="A2.p1.2.m2.1.1.2.5.cmml">a</mi><mo id="A2.p1.2.m2.1.1.2.1c" xref="A2.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.2.m2.1.1.2.6" xref="A2.p1.2.m2.1.1.2.6.cmml">y</mi><mo id="A2.p1.2.m2.1.1.2.1d" xref="A2.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.2.m2.1.1.2.7" xref="A2.p1.2.m2.1.1.2.7.cmml">e</mi><mo id="A2.p1.2.m2.1.1.2.1e" xref="A2.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.2.m2.1.1.2.8" xref="A2.p1.2.m2.1.1.2.8.cmml">r</mi><mo id="A2.p1.2.m2.1.1.2.1f" xref="A2.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.2.m2.1.1.2.9" xref="A2.p1.2.m2.1.1.2.9.cmml">s</mi></mrow><mo id="A2.p1.2.m2.1.1.1" xref="A2.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3.cmml">24</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><eq id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1"></eq><apply id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2"><times id="A2.p1.2.m2.1.1.2.1.cmml" xref="A2.p1.2.m2.1.1.2.1"></times><ci id="A2.p1.2.m2.1.1.2.2.cmml" xref="A2.p1.2.m2.1.1.2.2">𝑛</ci><ci id="A2.p1.2.m2.1.1.2.3.cmml" xref="A2.p1.2.m2.1.1.2.3">_</ci><ci id="A2.p1.2.m2.1.1.2.4.cmml" xref="A2.p1.2.m2.1.1.2.4">𝑙</ci><ci id="A2.p1.2.m2.1.1.2.5.cmml" xref="A2.p1.2.m2.1.1.2.5">𝑎</ci><ci id="A2.p1.2.m2.1.1.2.6.cmml" xref="A2.p1.2.m2.1.1.2.6">𝑦</ci><ci id="A2.p1.2.m2.1.1.2.7.cmml" xref="A2.p1.2.m2.1.1.2.7">𝑒</ci><ci id="A2.p1.2.m2.1.1.2.8.cmml" xref="A2.p1.2.m2.1.1.2.8">𝑟</ci><ci id="A2.p1.2.m2.1.1.2.9.cmml" xref="A2.p1.2.m2.1.1.2.9">𝑠</ci></apply><cn id="A2.p1.2.m2.1.1.3.cmml" type="integer" xref="A2.p1.2.m2.1.1.3">24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">n\_layers=24</annotation><annotation encoding="application/x-llamapun" id="A2.p1.2.m2.1d">italic_n _ italic_l italic_a italic_y italic_e italic_r italic_s = 24</annotation></semantics></math>, and <math alttext="n\_heads=16" class="ltx_Math" display="inline" id="A2.p1.3.m3.1"><semantics id="A2.p1.3.m3.1a"><mrow id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml"><mrow id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml"><mi id="A2.p1.3.m3.1.1.2.2" xref="A2.p1.3.m3.1.1.2.2.cmml">n</mi><mo id="A2.p1.3.m3.1.1.2.1" xref="A2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.3.m3.1.1.2.3" mathvariant="normal" xref="A2.p1.3.m3.1.1.2.3.cmml">_</mi><mo id="A2.p1.3.m3.1.1.2.1a" xref="A2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.3.m3.1.1.2.4" xref="A2.p1.3.m3.1.1.2.4.cmml">h</mi><mo id="A2.p1.3.m3.1.1.2.1b" xref="A2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.3.m3.1.1.2.5" xref="A2.p1.3.m3.1.1.2.5.cmml">e</mi><mo id="A2.p1.3.m3.1.1.2.1c" xref="A2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.3.m3.1.1.2.6" xref="A2.p1.3.m3.1.1.2.6.cmml">a</mi><mo id="A2.p1.3.m3.1.1.2.1d" xref="A2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.3.m3.1.1.2.7" xref="A2.p1.3.m3.1.1.2.7.cmml">d</mi><mo id="A2.p1.3.m3.1.1.2.1e" xref="A2.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.3.m3.1.1.2.8" xref="A2.p1.3.m3.1.1.2.8.cmml">s</mi></mrow><mo id="A2.p1.3.m3.1.1.1" xref="A2.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1"><eq id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1.1"></eq><apply id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2"><times id="A2.p1.3.m3.1.1.2.1.cmml" xref="A2.p1.3.m3.1.1.2.1"></times><ci id="A2.p1.3.m3.1.1.2.2.cmml" xref="A2.p1.3.m3.1.1.2.2">𝑛</ci><ci id="A2.p1.3.m3.1.1.2.3.cmml" xref="A2.p1.3.m3.1.1.2.3">_</ci><ci id="A2.p1.3.m3.1.1.2.4.cmml" xref="A2.p1.3.m3.1.1.2.4">ℎ</ci><ci id="A2.p1.3.m3.1.1.2.5.cmml" xref="A2.p1.3.m3.1.1.2.5">𝑒</ci><ci id="A2.p1.3.m3.1.1.2.6.cmml" xref="A2.p1.3.m3.1.1.2.6">𝑎</ci><ci id="A2.p1.3.m3.1.1.2.7.cmml" xref="A2.p1.3.m3.1.1.2.7">𝑑</ci><ci id="A2.p1.3.m3.1.1.2.8.cmml" xref="A2.p1.3.m3.1.1.2.8">𝑠</ci></apply><cn id="A2.p1.3.m3.1.1.3.cmml" type="integer" xref="A2.p1.3.m3.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">n\_heads=16</annotation><annotation encoding="application/x-llamapun" id="A2.p1.3.m3.1d">italic_n _ italic_h italic_e italic_a italic_d italic_s = 16</annotation></semantics></math>, resulting in 1.4B parameters. Training data and hyperparameter setup mostly repeats the one from&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Touvron et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib33" title="">2023b</a>)</cite>. To adapt for the relatively smaller model size, we increase the learning rate to <math alttext="4.0e{-4}" class="ltx_Math" display="inline" id="A2.p1.4.m4.1"><semantics id="A2.p1.4.m4.1a"><mrow id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml"><mrow id="A2.p1.4.m4.1.1.2" xref="A2.p1.4.m4.1.1.2.cmml"><mn id="A2.p1.4.m4.1.1.2.2" xref="A2.p1.4.m4.1.1.2.2.cmml">4.0</mn><mo id="A2.p1.4.m4.1.1.2.1" xref="A2.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="A2.p1.4.m4.1.1.2.3" xref="A2.p1.4.m4.1.1.2.3.cmml">e</mi></mrow><mo id="A2.p1.4.m4.1.1.1" xref="A2.p1.4.m4.1.1.1.cmml">−</mo><mn id="A2.p1.4.m4.1.1.3" xref="A2.p1.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><apply id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1"><minus id="A2.p1.4.m4.1.1.1.cmml" xref="A2.p1.4.m4.1.1.1"></minus><apply id="A2.p1.4.m4.1.1.2.cmml" xref="A2.p1.4.m4.1.1.2"><times id="A2.p1.4.m4.1.1.2.1.cmml" xref="A2.p1.4.m4.1.1.2.1"></times><cn id="A2.p1.4.m4.1.1.2.2.cmml" type="float" xref="A2.p1.4.m4.1.1.2.2">4.0</cn><ci id="A2.p1.4.m4.1.1.2.3.cmml" xref="A2.p1.4.m4.1.1.2.3">𝑒</ci></apply><cn id="A2.p1.4.m4.1.1.3.cmml" type="integer" xref="A2.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">4.0e{-4}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.4.m4.1d">4.0 italic_e - 4</annotation></semantics></math>, and the global batch-size was capped at 2M due to the limited number of GPUs.
During training, we observe a fixed gap in training perplexity between baseline models and reverse training (Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#A2.F1" title="Figure 1 ‣ Appendix B Transformer model pre-training ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">1</span></a>). The loss of the baseline model is measured on data in the standard direction, while the reverse training loss covers data in both directions. We posit that the reverse training doesn’t interfere with forward learning — thus, the model’s performance does not degrade on standard benchmarks in data-match conditions, and because we observe a match in the convergence rate of the reverse trained models with the baseline model when it’s trained on about 50% of the data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="202" id="A2.F1.g1" src="extracted/5470828/assets/training_loss.png" width="449">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Training loss for 1.4B models in the pre-training stage. On the <math alttext="x" class="ltx_Math" display="inline" id="A2.F1.2.m1.1"><semantics id="A2.F1.2.m1.1b"><mi id="A2.F1.2.m1.1.1" xref="A2.F1.2.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A2.F1.2.m1.1c"><ci id="A2.F1.2.m1.1.1.cmml" xref="A2.F1.2.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F1.2.m1.1d">x</annotation><annotation encoding="application/x-llamapun" id="A2.F1.2.m1.1e">italic_x</annotation></semantics></math>-axis we display the total number of tokens model has been trained on, including both in standard and reverse direction.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">In <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#A2.F2" title="Figure 2 ‣ Appendix B Transformer model pre-training ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Figure&nbsp;2</span></a>, we evaluate performance on the real-world knowledge task for multiple checkpoints during pre-training, where accuracy is reported using best@1 sampling. We notice an upward trend in performance on the reverse task with no saturation at the last checkpoint. Hence, we assume that if we continue pre-training we would see further improvement.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="282" id="A2.F2.g1" src="extracted/5470828/assets/celeb_pics.png" width="598">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Evaluation results during training on the real-world celebrity task when using different pre-training methods for LLMs.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Biography Data Experiment Details</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.6">In our biography data experiments, we utilize the <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.p1.6.1">bioS</span> <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.p1.6.2">multi5+permute</span> dataset from <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib1" title="">2023a</a>; <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib2" title="">b</a>)</cite> as our <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.p1.6.3">bioS</span> dataset, which generates 5 biography entries per person using randomly chosen sentence templates and permutations. We use the <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.p1.6.4">bioR</span> <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.p1.6.5">multi5</span> dataset from them as our <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.p1.6.6">bioR</span> dataset, which generates 5 biography entries per person by invoking Llama five times.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.3">Following <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib2" title="">2023b</a>)</cite>, we employ GPT2-small (12 layers, 12 heads, and 768 dimensions) for the <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.p2.3.1">bioS</span> dataset and GPT2 with 12 layers, 20 heads, and 1280 dimensions for the <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.p2.3.2">bioR</span> dataset. We also utilize the same AdamW optimizer with cosine learning rate decay (<math alttext="\beta_{1}=0.9,\beta_{2}=0.98,\varepsilon=10^{-6}" class="ltx_Math" display="inline" id="A3.p2.3.m3.2"><semantics id="A3.p2.3.m3.2a"><mrow id="A3.p2.3.m3.2.2.2" xref="A3.p2.3.m3.2.2.3.cmml"><mrow id="A3.p2.3.m3.1.1.1.1" xref="A3.p2.3.m3.1.1.1.1.cmml"><msub id="A3.p2.3.m3.1.1.1.1.2" xref="A3.p2.3.m3.1.1.1.1.2.cmml"><mi id="A3.p2.3.m3.1.1.1.1.2.2" xref="A3.p2.3.m3.1.1.1.1.2.2.cmml">β</mi><mn id="A3.p2.3.m3.1.1.1.1.2.3" xref="A3.p2.3.m3.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A3.p2.3.m3.1.1.1.1.1" xref="A3.p2.3.m3.1.1.1.1.1.cmml">=</mo><mn id="A3.p2.3.m3.1.1.1.1.3" xref="A3.p2.3.m3.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="A3.p2.3.m3.2.2.2.3" xref="A3.p2.3.m3.2.2.3a.cmml">,</mo><mrow id="A3.p2.3.m3.2.2.2.2.2" xref="A3.p2.3.m3.2.2.2.2.3.cmml"><mrow id="A3.p2.3.m3.2.2.2.2.1.1" xref="A3.p2.3.m3.2.2.2.2.1.1.cmml"><msub id="A3.p2.3.m3.2.2.2.2.1.1.2" xref="A3.p2.3.m3.2.2.2.2.1.1.2.cmml"><mi id="A3.p2.3.m3.2.2.2.2.1.1.2.2" xref="A3.p2.3.m3.2.2.2.2.1.1.2.2.cmml">β</mi><mn id="A3.p2.3.m3.2.2.2.2.1.1.2.3" xref="A3.p2.3.m3.2.2.2.2.1.1.2.3.cmml">2</mn></msub><mo id="A3.p2.3.m3.2.2.2.2.1.1.1" xref="A3.p2.3.m3.2.2.2.2.1.1.1.cmml">=</mo><mn id="A3.p2.3.m3.2.2.2.2.1.1.3" xref="A3.p2.3.m3.2.2.2.2.1.1.3.cmml">0.98</mn></mrow><mo id="A3.p2.3.m3.2.2.2.2.2.3" xref="A3.p2.3.m3.2.2.2.2.3a.cmml">,</mo><mrow id="A3.p2.3.m3.2.2.2.2.2.2" xref="A3.p2.3.m3.2.2.2.2.2.2.cmml"><mi id="A3.p2.3.m3.2.2.2.2.2.2.2" xref="A3.p2.3.m3.2.2.2.2.2.2.2.cmml">ε</mi><mo id="A3.p2.3.m3.2.2.2.2.2.2.1" xref="A3.p2.3.m3.2.2.2.2.2.2.1.cmml">=</mo><msup id="A3.p2.3.m3.2.2.2.2.2.2.3" xref="A3.p2.3.m3.2.2.2.2.2.2.3.cmml"><mn id="A3.p2.3.m3.2.2.2.2.2.2.3.2" xref="A3.p2.3.m3.2.2.2.2.2.2.3.2.cmml">10</mn><mrow id="A3.p2.3.m3.2.2.2.2.2.2.3.3" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3.cmml"><mo id="A3.p2.3.m3.2.2.2.2.2.2.3.3a" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3.cmml">−</mo><mn id="A3.p2.3.m3.2.2.2.2.2.2.3.3.2" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3.2.cmml">6</mn></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.2b"><apply id="A3.p2.3.m3.2.2.3.cmml" xref="A3.p2.3.m3.2.2.2"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.3a.cmml" xref="A3.p2.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="A3.p2.3.m3.1.1.1.1.cmml" xref="A3.p2.3.m3.1.1.1.1"><eq id="A3.p2.3.m3.1.1.1.1.1.cmml" xref="A3.p2.3.m3.1.1.1.1.1"></eq><apply id="A3.p2.3.m3.1.1.1.1.2.cmml" xref="A3.p2.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.p2.3.m3.1.1.1.1.2.1.cmml" xref="A3.p2.3.m3.1.1.1.1.2">subscript</csymbol><ci id="A3.p2.3.m3.1.1.1.1.2.2.cmml" xref="A3.p2.3.m3.1.1.1.1.2.2">𝛽</ci><cn id="A3.p2.3.m3.1.1.1.1.2.3.cmml" type="integer" xref="A3.p2.3.m3.1.1.1.1.2.3">1</cn></apply><cn id="A3.p2.3.m3.1.1.1.1.3.cmml" type="float" xref="A3.p2.3.m3.1.1.1.1.3">0.9</cn></apply><apply id="A3.p2.3.m3.2.2.2.2.3.cmml" xref="A3.p2.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.2.2.3a.cmml" xref="A3.p2.3.m3.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A3.p2.3.m3.2.2.2.2.1.1.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1"><eq id="A3.p2.3.m3.2.2.2.2.1.1.1.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.1"></eq><apply id="A3.p2.3.m3.2.2.2.2.1.1.2.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.2.2.1.1.2.1.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.2">subscript</csymbol><ci id="A3.p2.3.m3.2.2.2.2.1.1.2.2.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.2.2">𝛽</ci><cn id="A3.p2.3.m3.2.2.2.2.1.1.2.3.cmml" type="integer" xref="A3.p2.3.m3.2.2.2.2.1.1.2.3">2</cn></apply><cn id="A3.p2.3.m3.2.2.2.2.1.1.3.cmml" type="float" xref="A3.p2.3.m3.2.2.2.2.1.1.3">0.98</cn></apply><apply id="A3.p2.3.m3.2.2.2.2.2.2.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2"><eq id="A3.p2.3.m3.2.2.2.2.2.2.1.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.1"></eq><ci id="A3.p2.3.m3.2.2.2.2.2.2.2.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.2">𝜀</ci><apply id="A3.p2.3.m3.2.2.2.2.2.2.3.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.2.2.2.2.3.1.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3">superscript</csymbol><cn id="A3.p2.3.m3.2.2.2.2.2.2.3.2.cmml" type="integer" xref="A3.p2.3.m3.2.2.2.2.2.2.3.2">10</cn><apply id="A3.p2.3.m3.2.2.2.2.2.2.3.3.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3"><minus id="A3.p2.3.m3.2.2.2.2.2.2.3.3.1.cmml" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3"></minus><cn id="A3.p2.3.m3.2.2.2.2.2.2.3.3.2.cmml" type="integer" xref="A3.p2.3.m3.2.2.2.2.2.2.3.3.2">6</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.2c">\beta_{1}=0.9,\beta_{2}=0.98,\varepsilon=10^{-6}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.3.m3.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9 , italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.98 , italic_ε = 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A3.I1">
<li class="ltx_item" id="A3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A3.I1.i1.p1">
<p class="ltx_p" id="A3.I1.i1.p1.1">For the <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.I1.i1.p1.1.1">bioS</span> dataset, we train for 80,000 steps with a batch size of 192, which is twice their batch size.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A3.I1.i2.p1">
<p class="ltx_p" id="A3.I1.i2.p1.1">For the <span class="ltx_text ltx_markedasmath ltx_font_sansserif" id="A3.I1.i2.p1.1.1">bioR</span> dataset, we train for 150,000 steps with a batch size of 192, which is twice their batch size.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A3.p3">
<p class="ltx_p" id="A3.p3.1">During pre-training (or mixed-training), we use a weight decay of 0.03 and select the best among three learning rates: 0.0005, 0.001, 0.002; we also employ 1000 steps of learning rate warmup. During finetuning (FT), we use a weight decay of 0.01, and select the best among two learning rates: 0.0003 or 0.0005; we do not use learning rate warmup.
During mixed-training, we use <math alttext="{\mathsf{QA}_{r}}=0.3" class="ltx_Math" display="inline" id="A3.p3.1.m1.1"><semantics id="A3.p3.1.m1.1a"><mrow id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml"><msub id="A3.p3.1.m1.1.1.2" xref="A3.p3.1.m1.1.1.2.cmml"><mi id="A3.p3.1.m1.1.1.2.2" xref="A3.p3.1.m1.1.1.2.2.cmml">𝖰𝖠</mi><mi id="A3.p3.1.m1.1.1.2.3" xref="A3.p3.1.m1.1.1.2.3.cmml">r</mi></msub><mo id="A3.p3.1.m1.1.1.1" xref="A3.p3.1.m1.1.1.1.cmml">=</mo><mn id="A3.p3.1.m1.1.1.3" xref="A3.p3.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><apply id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1"><eq id="A3.p3.1.m1.1.1.1.cmml" xref="A3.p3.1.m1.1.1.1"></eq><apply id="A3.p3.1.m1.1.1.2.cmml" xref="A3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A3.p3.1.m1.1.1.2.1.cmml" xref="A3.p3.1.m1.1.1.2">subscript</csymbol><ci id="A3.p3.1.m1.1.1.2.2.cmml" xref="A3.p3.1.m1.1.1.2.2">𝖰𝖠</ci><ci id="A3.p3.1.m1.1.1.2.3.cmml" xref="A3.p3.1.m1.1.1.2.3">𝑟</ci></apply><cn id="A3.p3.1.m1.1.1.3.cmml" type="float" xref="A3.p3.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">{\mathsf{QA}_{r}}=0.3</annotation><annotation encoding="application/x-llamapun" id="A3.p3.1.m1.1d">sansserif_QA start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = 0.3</annotation></semantics></math> which means 30% of the training tokens come from instruction finetune data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="A3.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Reversal QA tasks.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A3.SS0.SSS0.Px1.p1.1">We consider four reversal tasks from <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib2" title="">2023b</a>)</cite>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize ltx_centering" id="A3.I2">
<li class="ltx_item" id="A3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A3.I2.i1.p1">
<p class="ltx_p" id="A3.I2.i1.p1.1">Give me the [last/full] name of the person born on October 2, 1996?
 (<span class="ltx_text ltx_font_typewriter" id="A3.I2.i1.p1.1.1">bdate_to_last</span>, <span class="ltx_text ltx_font_typewriter" id="A3.I2.i1.p1.1.2">bdate_to_full</span>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A3.I2.i2.p1">
<p class="ltx_p" id="A3.I2.i2.p1.1">Give me the [last/full] name of the person who studied Communications at Massachusetts Institute of Technology and worked for Meta Platforms?
 (<span class="ltx_text ltx_font_typewriter" id="A3.I2.i2.p1.1.1">three_to_last</span>, <span class="ltx_text ltx_font_typewriter" id="A3.I2.i2.p1.1.2">three_to_full</span>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A3.I2.i3.p1">
<p class="ltx_p" id="A3.I2.i3.p1.1">Give me the [last/full] name of the person who studied Communications at Massachusetts Institute of Technology, was born in Princeton, NJ, and worked for Meta Platforms?
 (<span class="ltx_text ltx_font_typewriter" id="A3.I2.i3.p1.1.1">four_to_last</span>, <span class="ltx_text ltx_font_typewriter" id="A3.I2.i3.p1.1.2">four_to_full</span>)
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A3.I2.i4.p1">
<p class="ltx_p" id="A3.I2.i4.p1.1">Give me the [last/full] name of the person who studied Communications at Massachusetts Institute of Technology, was born on October 2, 1996 in Princeton, NJ, and worked for Meta Platforms at Menlo Park, CA?
 (<span class="ltx_text ltx_font_typewriter" id="A3.I2.i4.p1.1.1">all_to_last</span>, <span class="ltx_text ltx_font_typewriter" id="A3.I2.i4.p1.1.2">all_to_full</span>)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_paragraph" id="A3.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Forward QA tasks.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A3.SS0.SSS0.Px2.p1.1">We consider the same six forward tasks from <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib1" title="">2023a</a>)</cite>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_centering ltx_role_start_2_columns"></div>
<ul class="ltx_itemize ltx_centering" id="A3.I3">
<li class="ltx_item" id="A3.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A3.I3.i1.p1">
<p class="ltx_p" id="A3.I3.i1.p1.1">What is the birth date of Anya Briar Forger?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="A3.I3.i1.p1.2">Answer: October 2, 1996.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A3.I3.i2.p1">
<p class="ltx_p" id="A3.I3.i2.p1.1">What is the birth city of Anya Briar Forger?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="A3.I3.i2.p1.2">Answer: Princeton, NJ.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A3.I3.i3.p1">
<p class="ltx_p" id="A3.I3.i3.p1.1">Which university did Anya Briar Forger study?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="A3.I3.i3.p1.2">Answer: Massachusetts Institute of Technology.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A3.I3.i4.p1">
<p class="ltx_p" id="A3.I3.i4.p1.1">What major did Anya Briar Forger study?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="A3.I3.i4.p1.2">Answer: Communications.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A3.I3.i5.p1">
<p class="ltx_p" id="A3.I3.i5.p1.1">Which company did Anya Briar Forger work for?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="A3.I3.i5.p1.2">Answer: Meta Platforms.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A3.I3.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A3.I3.i6.p1">
<p class="ltx_p" id="A3.I3.i6.p1.1">Where did Anya Briar Forger work?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="A3.I3.i6.p1.2">Answer: Menlo Park, CA.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
<div class="ltx_pagination ltx_centering ltx_role_end_2_columns"></div>
<p class="ltx_p" id="A3.SS0.SSS0.Px2.p1.2">Full results are summarised in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#A3.T10" title="Table 10 ‣ Forward QA tasks. ‣ Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">10</span></a>. One may notice that our reported forward task accuracies are slightly higher than those reported in <cite class="ltx_cite ltx_citemacro_citet">Allen-Zhu &amp; Li (<a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib1" title="">2023a</a>)</cite>. This improvement is attributed to our use of a larger batch size, smaller weight decay, and the best result among three runs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A3.T10"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_landscape" height="190" id="A3.T10.g1" src="x1.png" width="761">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span>Forward vs. reversal task accuracy for the data <math alttext="\textsf{bioS},\textsf{bioR}" class="ltx_Math" display="inline" id="A3.T10.3.m1.2"><semantics id="A3.T10.3.m1.2b"><mrow id="A3.T10.3.m1.2.3.2" xref="A3.T10.3.m1.2.3.1.cmml"><mtext id="A3.T10.3.m1.1.1" xref="A3.T10.3.m1.1.1a.cmml">𝖻𝗂𝗈𝖲</mtext><mo id="A3.T10.3.m1.2.3.2.1" xref="A3.T10.3.m1.2.3.1.cmml">,</mo><mtext id="A3.T10.3.m1.2.2" xref="A3.T10.3.m1.2.2a.cmml">𝖻𝗂𝗈𝖱</mtext></mrow><annotation-xml encoding="MathML-Content" id="A3.T10.3.m1.2c"><list id="A3.T10.3.m1.2.3.1.cmml" xref="A3.T10.3.m1.2.3.2"><ci id="A3.T10.3.m1.1.1a.cmml" xref="A3.T10.3.m1.1.1"><mtext id="A3.T10.3.m1.1.1.cmml" xref="A3.T10.3.m1.1.1">𝖻𝗂𝗈𝖲</mtext></ci><ci id="A3.T10.3.m1.2.2a.cmml" xref="A3.T10.3.m1.2.2"><mtext id="A3.T10.3.m1.2.2.cmml" xref="A3.T10.3.m1.2.2">𝖻𝗂𝗈𝖱</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.3.m1.2d">\textsf{bioS},\textsf{bioR}</annotation><annotation encoding="application/x-llamapun" id="A3.T10.3.m1.2e">bioS , bioR</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Allen-Zhu &amp; Li, <a class="ltx_ref" href="https://arxiv.org/html/2403.13799v1#bib.bib2" title="">2023b</a>)</cite>.

<br class="ltx_break"><svg height="9.46" overflow="visible" version="1.1" width="19.41"><g transform="translate(0,9.46) scale(1,-1)"><path d="M 0,0 502.28,0" stroke="black" stroke-width="0.4"></path><g transform="translate(0,9.46) scale(1, -1)"><foreignObject height="9.46" overflow="visible" width="19.41">
<br class="ltx_break"></foreignObject></g><text fill="black" font-weight="bold" transform="scale(1, -1)" x="0" y="0">Left block</text><text fill="black" font-weight="bold" transform="scale(1, -1)" x="0" y="0">= forward QA accuracy (ask for fields given person names).
<g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject height="1.383700013837" overflow="visible" width="1.383700013837">
<br class="ltx_break"></foreignObject></g><text fill="black" font-weight="bold" transform="scale(1, -1)" x="0" y="0">Middle block</text> = reversal QA accuracy (ask for person’s full name given selected bio fields): “bdate” = given birthdates only, “all’ = given all fields, etc, see <g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject height="1.383700013837" overflow="visible" width="1.383700013837"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2403.13799v1#A3" title="Appendix C Biography Data Experiment Details ‣ Reverse Training to Nurse the Reversal Curse"><span class="ltx_text ltx_ref_tag">Appendix&nbsp;C</span></a></foreignObject></g>).
<g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject height="1.383700013837" overflow="visible" width="1.383700013837">
<br class="ltx_break"></foreignObject></g><text fill="black" font-weight="bold" transform="scale(1, -1)" x="0" y="0">Right block</text> = reversal QA accuracy (ask for last name given selected biography fields).
<g transform="translate(0,1.383700013837) scale(1, -1)"><foreignObject height="1.383700013837" overflow="visible" width="1.383700013837">
<br class="ltx_break"></foreignObject></g><text fill="black" font-weight="bold" transform="scale(1, -1)" x="0" y="0">FT</text> = pre-train followed by instruction finetune; <text fill="black" font-weight="bold" transform="scale(1, -1)" x="0" y="0">MIX</text> = add instruction FT data to pre-train.
</text></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
</article>
</div>

</div>


<div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated on Wed Dec 14 18:01:44 2022 by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer><button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button></body></html>