<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.16952] Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance</title><meta property="og:description" content="Pretraining data of large language models composes multiple domains (e.g., web texts, academic papers, codes), whose mixture proportions crucially impact the competence of outcome models.
While existing endeavors rely …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.16952">

<!--Generated on Fri Apr  5 16:51:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.7.9.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.9.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jiasheng Ye<sup id="id9.9.id1" class="ltx_sup"><span id="id9.9.id1.1" class="ltx_text ltx_font_italic">1,</span></sup>  
Peiju Liu<sup id="id10.10.id2" class="ltx_sup"><span id="id10.10.id2.1" class="ltx_text ltx_font_italic">1,</span></sup><span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotemark: </span></span></span></span>  
Tianxiang Sun<sup id="id11.11.id3" class="ltx_sup"><span id="id11.11.id3.1" class="ltx_text ltx_font_italic">1</span></sup>  
Yunhua Zhou<sup id="id12.12.id4" class="ltx_sup">2</sup>  
Jun Zhan<sup id="id13.13.id5" class="ltx_sup"><span id="id13.13.id5.1" class="ltx_text ltx_font_italic">1</span></sup> 
Xipeng Qiu<sup id="id14.14.id6" class="ltx_sup"><span id="id14.14.id6.1" class="ltx_text ltx_font_italic">1,</span></sup>
<br class="ltx_break">
<br class="ltx_break"><span id="id15.15.id7" class="ltx_text ltx_font_typewriter">{jsye23,pjliu23}@m.fudan.edu.cn</span>&nbsp;&nbsp;&nbsp;<span id="id16.16.id8" class="ltx_text ltx_font_typewriter">zhouyunhua@pjlab.org.cn</span>&nbsp;&nbsp;
<span id="id17.17.id9" class="ltx_text ltx_font_typewriter">xpqiu@fudan.edu.cn
<br class="ltx_break"></span>
<sup id="id18.18.id10" class="ltx_sup"><span id="id18.18.id10.1" class="ltx_text ltx_font_italic">1</span></sup>Fudan University&nbsp;&nbsp;<sup id="id19.19.id11" class="ltx_sup"><span id="id19.19.id11.1" class="ltx_text ltx_font_italic">2</span></sup>Shanghai AI Laboratory
</span><span class="ltx_author_notes">Equal contribution.Corresponding author.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id20.id1" class="ltx_p">Pretraining data of large language models composes multiple domains (e.g., web texts, academic papers, codes), whose mixture proportions crucially impact the competence of outcome models.
While existing endeavors rely on heuristics or qualitative strategies to tune the proportions,
we discover the quantitative predictability of model performance regarding the mixture proportions in function forms, which we refer to as the <span id="id20.id1.1" class="ltx_text ltx_font_italic">data mixing laws</span>.
Fitting such functions on sample mixtures unveils model performance on unseen mixtures before actual runs, thus guiding the selection of an ideal data mixture. Furthermore, we propose nested use of the scaling laws of training steps, model sizes, and our data mixing law to enable predicting the performance of large models trained on massive data under various mixtures with only small-scale training.
Moreover, experimental results verify that our method effectively optimizes the training mixture of a 1B model trained for 100B tokens in RedPajama, reaching a performance comparable to the one trained for 48% more steps on the default mixture.
Extending the application of data mixing laws to continual training accurately predicts the critical mixture proportion that avoids catastrophic forgetting and outlooks the potential for dynamic data schedules.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Codes and data are available at: <a target="_blank" href="https://github.com/yegcjs/mixinglaws" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/yegcjs/mixinglaws</a>.</span></span></span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Pretraining data for large language models (LLMs) are typically a mixture of multiple domains, varying from English to minority languages&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Doddapaneni et&nbsp;al., <a href="#bib.bib14" title="" class="ltx_ref">2021</a>; Li et&nbsp;al., <a href="#bib.bib40" title="" class="ltx_ref">2023</a>)</cite>, from casual dialogs to formal academic writings&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Taylor et&nbsp;al., <a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite>, and from texts to modalities like images and speeches&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhan et&nbsp;al., <a href="#bib.bib66" title="" class="ltx_ref">2024</a>)</cite>, among others.
These data interplay with each other, showing complex interchangeable, unrelated, or contradictory relationships&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a href="#bib.bib24" title="" class="ltx_ref">2024</a>)</cite>.
This necessitates adjusting the mixture proportions of training data to balance the model capabilities while harnessing synergies across domains, thus enhancing the competence of the outcome models, as highlighted by extensive practical experience&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a href="#bib.bib22" title="" class="ltx_ref">2020</a>; Gururangan et&nbsp;al., <a href="#bib.bib25" title="" class="ltx_ref">2020</a>; Zhou et&nbsp;al., <a href="#bib.bib68" title="" class="ltx_ref">2023</a>; Xie et&nbsp;al., <a href="#bib.bib63" title="" class="ltx_ref">2024a</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Nonetheless, it remains elusive to figure out an ideal training data mixture.
Most existing practices tune the mixture through heuristics to upsample a proportion of high-quality or underrepresented data without disclosing the concrete criteria in detail&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a href="#bib.bib22" title="" class="ltx_ref">2020</a>; Touvron et&nbsp;al., <a href="#bib.bib56" title="" class="ltx_ref">2023a</a>; Bai et&nbsp;al., <a href="#bib.bib6" title="" class="ltx_ref">2023</a>; Bi et&nbsp;al., <a href="#bib.bib7" title="" class="ltx_ref">2024</a>)</cite> and it is hard to predate whether these data strategies are effective before finishing the training run. Encouraged by advances in scaling laws that show model losses on a given set of evaluation data are quantitatively predictable for a wide range of variables&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2020</a>; Hoffmann et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite>, we wonder whether this also holds for mixture proportions,
so that <span id="S1.p2.1.1" class="ltx_text ltx_font_bold ltx_font_italic">we can estimate the outcome model performance given any mixture before actually training on them, including the desired one that reaches minimum loss.</span></p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">In this paper, we answer this proposition affirmatively.
We find that, given a mixture of <math id="S1.p3.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">M</annotation></semantics></math> domains, an exponential function over the linear combination of the proportions, i.e.,</p>
<table id="S1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E1.m1.2" class="ltx_Math" alttext="L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)}," display="block"><semantics id="S1.E1.m1.2a"><mrow id="S1.E1.m1.2.2.1" xref="S1.E1.m1.2.2.1.1.cmml"><mrow id="S1.E1.m1.2.2.1.1" xref="S1.E1.m1.2.2.1.1.cmml"><mrow id="S1.E1.m1.2.2.1.1.1" xref="S1.E1.m1.2.2.1.1.1.cmml"><msub id="S1.E1.m1.2.2.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.3.cmml"><mi id="S1.E1.m1.2.2.1.1.1.3.2" xref="S1.E1.m1.2.2.1.1.1.3.2.cmml">L</mi><mi id="S1.E1.m1.2.2.1.1.1.3.3" xref="S1.E1.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S1.E1.m1.2.2.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.E1.m1.2.2.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S1.E1.m1.2.2.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mrow id="S1.E1.m1.2.2.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="S1.E1.m1.2.2.1.1.1.1.1.1.3.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.1.1.1.1.3.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S1.E1.m1.2.2.1.1.1.1.1.1.3.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.1.1.1.1.3.1a" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.3.4" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S1.E1.m1.2.2.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.E1.m1.2.2.1.1.3" xref="S1.E1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S1.E1.m1.2.2.1.1.2" xref="S1.E1.m1.2.2.1.1.2.cmml"><msub id="S1.E1.m1.2.2.1.1.2.3" xref="S1.E1.m1.2.2.1.1.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.3.2" xref="S1.E1.m1.2.2.1.1.2.3.2.cmml">c</mi><mi id="S1.E1.m1.2.2.1.1.2.3.3" xref="S1.E1.m1.2.2.1.1.2.3.3.cmml">i</mi></msub><mo id="S1.E1.m1.2.2.1.1.2.2" xref="S1.E1.m1.2.2.1.1.2.2.cmml">+</mo><mrow id="S1.E1.m1.2.2.1.1.2.1" xref="S1.E1.m1.2.2.1.1.2.1.cmml"><msub id="S1.E1.m1.2.2.1.1.2.1.3" xref="S1.E1.m1.2.2.1.1.2.1.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.3.2" xref="S1.E1.m1.2.2.1.1.2.1.3.2.cmml">k</mi><mi id="S1.E1.m1.2.2.1.1.2.1.3.3" xref="S1.E1.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S1.E1.m1.2.2.1.1.2.1.2" xref="S1.E1.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml"><mi id="S1.E1.m1.1.1" xref="S1.E1.m1.1.1.cmml">exp</mi><mo id="S1.E1.m1.2.2.1.1.2.1.1.1a" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml">⁡</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml"><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml">(</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.cmml"><munderover id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><msub id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml">​</mo><msub id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S1.E1.m1.2.2.1.2" xref="S1.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.2b"><apply id="S1.E1.m1.2.2.1.1.cmml" xref="S1.E1.m1.2.2.1"><eq id="S1.E1.m1.2.2.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.3"></eq><apply id="S1.E1.m1.2.2.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1"><times id="S1.E1.m1.2.2.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.2"></times><apply id="S1.E1.m1.2.2.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.1.3.2">𝐿</ci><ci id="S1.E1.m1.2.2.1.1.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3"><times id="S1.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.1"></times><cn type="integer" id="S1.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.3">…</ci><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="S1.E1.m1.2.2.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2"><plus id="S1.E1.m1.2.2.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.2"></plus><apply id="S1.E1.m1.2.2.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.3.2">𝑐</ci><ci id="S1.E1.m1.2.2.1.1.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.3.3">𝑖</ci></apply><apply id="S1.E1.m1.2.2.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1"><times id="S1.E1.m1.2.2.1.1.2.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.2"></times><apply id="S1.E1.m1.2.2.1.1.2.1.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3.2">𝑘</ci><ci id="S1.E1.m1.2.2.1.1.2.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S1.E1.m1.2.2.1.1.2.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1"><exp id="S1.E1.m1.1.1.cmml" xref="S1.E1.m1.1.1"></exp><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1"><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1">subscript</csymbol><sum id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2"></sum><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3"><eq id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1"></eq><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2"><times id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1"></times><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3"><times id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1"></times><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.2c">L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S1.p3.6" class="ltx_p">can predict the validation loss <math id="S1.p3.2.m1.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S1.p3.2.m1.1a"><msub id="S1.p3.2.m1.1.1" xref="S1.p3.2.m1.1.1.cmml"><mi id="S1.p3.2.m1.1.1.2" xref="S1.p3.2.m1.1.1.2.cmml">L</mi><mi id="S1.p3.2.m1.1.1.3" xref="S1.p3.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.2.m1.1b"><apply id="S1.p3.2.m1.1.1.cmml" xref="S1.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m1.1.1.1.cmml" xref="S1.p3.2.m1.1.1">subscript</csymbol><ci id="S1.p3.2.m1.1.1.2.cmml" xref="S1.p3.2.m1.1.1.2">𝐿</ci><ci id="S1.p3.2.m1.1.1.3.cmml" xref="S1.p3.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m1.1c">L_{i}</annotation></semantics></math> on any of the training domains <math id="S1.p3.3.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S1.p3.3.m2.1a"><mi id="S1.p3.3.m2.1.1" xref="S1.p3.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.p3.3.m2.1b"><ci id="S1.p3.3.m2.1.1.cmml" xref="S1.p3.3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m2.1c">i</annotation></semantics></math> accurately under a fixed model size and amount of training data, where <math id="S1.p3.4.m3.1" class="ltx_Math" alttext="r_{1\dots M}" display="inline"><semantics id="S1.p3.4.m3.1a"><msub id="S1.p3.4.m3.1.1" xref="S1.p3.4.m3.1.1.cmml"><mi id="S1.p3.4.m3.1.1.2" xref="S1.p3.4.m3.1.1.2.cmml">r</mi><mrow id="S1.p3.4.m3.1.1.3" xref="S1.p3.4.m3.1.1.3.cmml"><mn id="S1.p3.4.m3.1.1.3.2" xref="S1.p3.4.m3.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S1.p3.4.m3.1.1.3.1" xref="S1.p3.4.m3.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S1.p3.4.m3.1.1.3.3" xref="S1.p3.4.m3.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S1.p3.4.m3.1.1.3.1a" xref="S1.p3.4.m3.1.1.3.1.cmml">​</mo><mi id="S1.p3.4.m3.1.1.3.4" xref="S1.p3.4.m3.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p3.4.m3.1b"><apply id="S1.p3.4.m3.1.1.cmml" xref="S1.p3.4.m3.1.1"><csymbol cd="ambiguous" id="S1.p3.4.m3.1.1.1.cmml" xref="S1.p3.4.m3.1.1">subscript</csymbol><ci id="S1.p3.4.m3.1.1.2.cmml" xref="S1.p3.4.m3.1.1.2">𝑟</ci><apply id="S1.p3.4.m3.1.1.3.cmml" xref="S1.p3.4.m3.1.1.3"><times id="S1.p3.4.m3.1.1.3.1.cmml" xref="S1.p3.4.m3.1.1.3.1"></times><cn type="integer" id="S1.p3.4.m3.1.1.3.2.cmml" xref="S1.p3.4.m3.1.1.3.2">1</cn><ci id="S1.p3.4.m3.1.1.3.3.cmml" xref="S1.p3.4.m3.1.1.3.3">…</ci><ci id="S1.p3.4.m3.1.1.3.4.cmml" xref="S1.p3.4.m3.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m3.1c">r_{1\dots M}</annotation></semantics></math> are the proportions of the <math id="S1.p3.5.m4.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S1.p3.5.m4.1a"><mi id="S1.p3.5.m4.1.1" xref="S1.p3.5.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p3.5.m4.1b"><ci id="S1.p3.5.m4.1.1.cmml" xref="S1.p3.5.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m4.1c">M</annotation></semantics></math> domains and <math id="S1.p3.6.m5.3" class="ltx_Math" alttext="c_{i},k_{i},t_{ij}" display="inline"><semantics id="S1.p3.6.m5.3a"><mrow id="S1.p3.6.m5.3.3.3" xref="S1.p3.6.m5.3.3.4.cmml"><msub id="S1.p3.6.m5.1.1.1.1" xref="S1.p3.6.m5.1.1.1.1.cmml"><mi id="S1.p3.6.m5.1.1.1.1.2" xref="S1.p3.6.m5.1.1.1.1.2.cmml">c</mi><mi id="S1.p3.6.m5.1.1.1.1.3" xref="S1.p3.6.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="S1.p3.6.m5.3.3.3.4" xref="S1.p3.6.m5.3.3.4.cmml">,</mo><msub id="S1.p3.6.m5.2.2.2.2" xref="S1.p3.6.m5.2.2.2.2.cmml"><mi id="S1.p3.6.m5.2.2.2.2.2" xref="S1.p3.6.m5.2.2.2.2.2.cmml">k</mi><mi id="S1.p3.6.m5.2.2.2.2.3" xref="S1.p3.6.m5.2.2.2.2.3.cmml">i</mi></msub><mo id="S1.p3.6.m5.3.3.3.5" xref="S1.p3.6.m5.3.3.4.cmml">,</mo><msub id="S1.p3.6.m5.3.3.3.3" xref="S1.p3.6.m5.3.3.3.3.cmml"><mi id="S1.p3.6.m5.3.3.3.3.2" xref="S1.p3.6.m5.3.3.3.3.2.cmml">t</mi><mrow id="S1.p3.6.m5.3.3.3.3.3" xref="S1.p3.6.m5.3.3.3.3.3.cmml"><mi id="S1.p3.6.m5.3.3.3.3.3.2" xref="S1.p3.6.m5.3.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S1.p3.6.m5.3.3.3.3.3.1" xref="S1.p3.6.m5.3.3.3.3.3.1.cmml">​</mo><mi id="S1.p3.6.m5.3.3.3.3.3.3" xref="S1.p3.6.m5.3.3.3.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.6.m5.3b"><list id="S1.p3.6.m5.3.3.4.cmml" xref="S1.p3.6.m5.3.3.3"><apply id="S1.p3.6.m5.1.1.1.1.cmml" xref="S1.p3.6.m5.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.6.m5.1.1.1.1.1.cmml" xref="S1.p3.6.m5.1.1.1.1">subscript</csymbol><ci id="S1.p3.6.m5.1.1.1.1.2.cmml" xref="S1.p3.6.m5.1.1.1.1.2">𝑐</ci><ci id="S1.p3.6.m5.1.1.1.1.3.cmml" xref="S1.p3.6.m5.1.1.1.1.3">𝑖</ci></apply><apply id="S1.p3.6.m5.2.2.2.2.cmml" xref="S1.p3.6.m5.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.6.m5.2.2.2.2.1.cmml" xref="S1.p3.6.m5.2.2.2.2">subscript</csymbol><ci id="S1.p3.6.m5.2.2.2.2.2.cmml" xref="S1.p3.6.m5.2.2.2.2.2">𝑘</ci><ci id="S1.p3.6.m5.2.2.2.2.3.cmml" xref="S1.p3.6.m5.2.2.2.2.3">𝑖</ci></apply><apply id="S1.p3.6.m5.3.3.3.3.cmml" xref="S1.p3.6.m5.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.6.m5.3.3.3.3.1.cmml" xref="S1.p3.6.m5.3.3.3.3">subscript</csymbol><ci id="S1.p3.6.m5.3.3.3.3.2.cmml" xref="S1.p3.6.m5.3.3.3.3.2">𝑡</ci><apply id="S1.p3.6.m5.3.3.3.3.3.cmml" xref="S1.p3.6.m5.3.3.3.3.3"><times id="S1.p3.6.m5.3.3.3.3.3.1.cmml" xref="S1.p3.6.m5.3.3.3.3.3.1"></times><ci id="S1.p3.6.m5.3.3.3.3.3.2.cmml" xref="S1.p3.6.m5.3.3.3.3.3.2">𝑖</ci><ci id="S1.p3.6.m5.3.3.3.3.3.3.cmml" xref="S1.p3.6.m5.3.3.3.3.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m5.3c">c_{i},k_{i},t_{ij}</annotation></semantics></math> are parameters to fit.
Fitting such functions on all the evaluated domains and calculating the weighted sum according to their proportions in the validation data leads to the prediction of final validation loss.
Further, treating the validation proportions as learnable parameters allows fitting the estimated losses on a validation set end-to-end without explicitly decomposing it into known domains.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Despite the predictability, fitting the function between mixture proportions and validation loss, or the <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">data mixing laws</span> for simplicity, requires samples of numerous runs with different mixtures.
Running these experiments with the same model size and the amount of training data as the target model is unreasonably expensive.
Fortunately, fruitful research on scaling laws demonstrates impressive results that
fitting power laws with small models and small data effectively predicts the losses on larger models and data over orders of magnitudes&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2020</a>; Henighan et&nbsp;al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>; Hoffmann et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>; Alabdulmohsin et&nbsp;al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>; OpenAI, <a href="#bib.bib48" title="" class="ltx_ref">2023</a>; Muennighoff et&nbsp;al., <a href="#bib.bib47" title="" class="ltx_ref">2024</a>; Bi et&nbsp;al., <a href="#bib.bib7" title="" class="ltx_ref">2024</a>)</cite>.
On this basis, we propose a pipeline to nested utilize the scaling laws of training steps, model sizes, and our data mixing law, so that we can study the impact of mixture proportions for the target model sizes and data amount with only experiments at the affordable scales, illustrated in Fig.&nbsp;<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2403.16952/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="132" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration on our pipeline to optimize data mixture. <span id="S1.F1.3.1" class="ltx_text ltx_font_bold">Left:</span> Our pipeline takes three steps. Starting from small-scale training results, the three steps use the scaling laws of training steps, model sizes, and data mixing laws to predict model performance on large steps, large models, and unseen mixtures, respectively.
<span id="S1.F1.4.2" class="ltx_text ltx_font_bold">Right:</span> Visualization of the three-step pipeline to predict model performance on the target model size, training step, and mixtures.
</figcaption>
</figure>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">Experimental results verify the reliability of our data mixing law and prediction pipeline.
By predicting the overall validation loss, we optimize the training mixture of RedPajama for a 1B model trained on 100B tokens and achieve performance comparable to a model trained on default mixture for 48% more steps.
The prediction on domain-specific validation sets also offers plausible references to the balance of model capabilities.
Further applying our data mixing law to continual pretraining can accurately find the proportion that avoids catastrophic forgetting&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(French, <a href="#bib.bib20" title="" class="ltx_ref">1999</a>; Kirkpatrick et&nbsp;al., <a href="#bib.bib38" title="" class="ltx_ref">2017</a>; Luo et&nbsp;al., <a href="#bib.bib43" title="" class="ltx_ref">2023</a>)</cite>, revealing the prospect of applying data mixing laws to guide a multi-stage pertaining, and thus a dynamic data schedule.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">Overall, our contributions and findings are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We discover the quantitative predictability of model performance regarding data mixture, and summarize this into a functional relationship, namely the data mixing laws.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a pipeline to predict model performance of large-scale training on different mixture proportions but only experiments on small models with few training data through nested use of scaling laws of training steps, model sizes, and data mixing laws.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i3.p1.1" class="ltx_p">We experiment to verify the reliability of our data mixing laws and prediction pipeline, showing its effectiveness in optimizing model performance, balancing model capabilities, and the prospects of guiding the design of the data schedule.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">We briefly review the pretraining process of large language models and summarize key findings from neural scaling laws, then we formalize the problem we study.
For more related work, please refer to Sec.&nbsp;<a href="#S6" title="6 Related Work ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Pretraining large language models.</h4>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px1.p1.5" class="ltx_p">We consider the task of pretraining an autoregressive language model <math id="S2.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="p_{\theta}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">p</mi><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑝</ci><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">p_{\theta}</annotation></semantics></math> via next-token predictions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a href="#bib.bib50" title="" class="ltx_ref">2018</a>)</cite>.
The training dataset <math id="S2.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mbox{train}}=\{\mathcal{D}_{i}\}_{i=1}^{M}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">𝒟</mi><mtext id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3a.cmml">train</mtext></msub><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">=</mo><msubsup id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1"><eq id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2"></eq><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2">𝒟</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3a.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3"><mtext mathsize="70%" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3">train</mtext></ci></apply><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1">subscript</csymbol><set id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1"><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3"><eq id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">\mathcal{D}_{\mbox{train}}=\{\mathcal{D}_{i}\}_{i=1}^{M}</annotation></semantics></math> composes <math id="S2.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">M</annotation></semantics></math> domains with mixture proportions <math id="S2.SS0.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="\bm{r}\in\Delta^{M-1}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.4.m4.1a"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml">𝒓</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">Δ</mi><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml">M</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml">−</mo><mn id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m4.1b"><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1"><in id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1"></in><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2">𝒓</ci><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2">Δ</ci><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3"><minus id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1"></minus><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2">𝑀</ci><cn type="integer" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m4.1c">\bm{r}\in\Delta^{M-1}</annotation></semantics></math>.
In each training step, the task first samples a batch of domain indices according to the mixture proportions and then sample sequences of <math id="S2.SS0.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.5.m5.1a"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.5.m5.1b"><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.5.m5.1c">L</annotation></semantics></math> tokens from the sampled domains.
Using the sampled data, it learns to optimize the negative log-likelihood of sampled data, i.e.,</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.3" class="ltx_Math" alttext="\mathcal{L}_{\theta}=\mathbb{E}_{i\sim\bm{r},x_{0\dots L}\sim D_{i}}\left[-\sum_{j=1}^{L}\log P_{\theta}(x_{j}|x_{0\dots j-1})\right]." display="block"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.3.3.1.1.3.2" xref="S2.E2.m1.3.3.1.1.3.2.cmml">ℒ</mi><mi id="S2.E2.m1.3.3.1.1.3.3" xref="S2.E2.m1.3.3.1.1.3.3.cmml">θ</mi></msub><mo id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.3.cmml"><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">∼</mo><mi id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3.cmml">𝒓</mi></mrow><mo id="S2.E2.m1.2.2.2.2.3" xref="S2.E2.m1.2.2.2.3a.cmml">,</mo><mrow id="S2.E2.m1.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.cmml"><msub id="S2.E2.m1.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.2.cmml">x</mi><mrow id="S2.E2.m1.2.2.2.2.2.2.3" xref="S2.E2.m1.2.2.2.2.2.2.3.cmml"><mn id="S2.E2.m1.2.2.2.2.2.2.3.2" xref="S2.E2.m1.2.2.2.2.2.2.3.2.cmml">0</mn><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.2.2.2.3.1" xref="S2.E2.m1.2.2.2.2.2.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S2.E2.m1.2.2.2.2.2.2.3.3" xref="S2.E2.m1.2.2.2.2.2.2.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.2.2.2.3.1a" xref="S2.E2.m1.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.E2.m1.2.2.2.2.2.2.3.4" xref="S2.E2.m1.2.2.2.2.2.2.3.4.cmml">L</mi></mrow></msub><mo id="S2.E2.m1.2.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.2.1.cmml">∼</mo><msub id="S2.E2.m1.2.2.2.2.2.3" xref="S2.E2.m1.2.2.2.2.2.3.cmml"><mi id="S2.E2.m1.2.2.2.2.2.3.2" xref="S2.E2.m1.2.2.2.2.2.3.2.cmml">D</mi><mi id="S2.E2.m1.2.2.2.2.2.3.3" xref="S2.E2.m1.2.2.2.2.2.3.3.cmml">i</mi></msub></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.1a" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><munderover id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">L</mi></munderover><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3a" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">0</mn><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1a" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml">​</mo><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4.cmml">j</mi></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E2.m1.3.3.1.2" xref="S2.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2"></eq><apply id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2">ℒ</ci><ci id="S2.E2.m1.3.3.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.3.3">𝜃</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.2"></times><apply id="S2.E2.m1.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.3a.cmml" xref="S2.E2.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">similar-to</csymbol><ci id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2">𝑖</ci><ci id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">𝒓</ci></apply><apply id="S2.E2.m1.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2"><csymbol cd="latexml" id="S2.E2.m1.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.1">similar-to</csymbol><apply id="S2.E2.m1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2.2">𝑥</ci><apply id="S2.E2.m1.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3"><times id="S2.E2.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.1"></times><cn type="integer" id="S2.E2.m1.2.2.2.2.2.2.3.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.2">0</cn><ci id="S2.E2.m1.2.2.2.2.2.2.3.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.3">…</ci><ci id="S2.E2.m1.2.2.2.2.2.2.3.4.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.4">𝐿</ci></apply></apply><apply id="S2.E2.m1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.2.3.1.cmml" xref="S2.E2.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.2.3.2.cmml" xref="S2.E2.m1.2.2.2.2.2.3.2">𝐷</ci><ci id="S2.E2.m1.2.2.2.2.2.3.3.cmml" xref="S2.E2.m1.2.2.2.2.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.E2.m1.3.3.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"><minus id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"></minus><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1"><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3"><eq id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3"><log id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1"></log><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2">𝑃</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2"><times id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1"></times><cn type="integer" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">0</cn><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">…</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4">𝑗</ci></apply><cn type="integer" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\mathcal{L}_{\theta}=\mathbb{E}_{i\sim\bm{r},x_{0\dots L}\sim D_{i}}\left[-\sum_{j=1}^{L}\log P_{\theta}(x_{j}|x_{0\dots j-1})\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS0.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px1.p2.1" class="ltx_p">To evaluate the learned model, we compute the loss on validation data <math id="S2.SS0.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mbox{val}}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p2.1.m1.1a"><msub id="S2.SS0.SSS0.Px1.p2.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3a.cmml">val</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2">𝒟</ci><ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3a.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3"><mtext mathsize="70%" id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3">val</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.1.m1.1c">\mathcal{D}_{\mbox{val}}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Scaling laws.</h4>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p1.2" class="ltx_p">For a wide range of factors <math id="S2.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.1.m1.1c">x</annotation></semantics></math>, scaling laws&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2020</a>; Henighan et&nbsp;al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>; Hoffmann et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite> show that their effect on the loss <math id="S2.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.2.m2.1c">L</annotation></semantics></math> of a pretrained model follows power laws</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.1" class="ltx_Math" alttext="L=c+kx^{\alpha}," display="block"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml">L</mi><mo id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml">c</mi><mo id="S2.E3.m1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.3.2" xref="S2.E3.m1.1.1.1.1.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.3.3.1" xref="S2.E3.m1.1.1.1.1.3.3.1.cmml">​</mo><msup id="S2.E3.m1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.3.3.2" xref="S2.E3.m1.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.E3.m1.1.1.1.1.3.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.3.cmml">α</mi></msup></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"></eq><ci id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2">𝐿</ci><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><plus id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.1"></plus><ci id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2">𝑐</ci><apply id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3"><times id="S2.E3.m1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.1"></times><ci id="S2.E3.m1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2">𝑘</ci><apply id="S2.E3.m1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.E3.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3.3">𝛼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">L=c+kx^{\alpha},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS0.SSS0.Px2.p1.6" class="ltx_p">where <math id="S2.SS0.SSS0.Px2.p1.3.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS0.SSS0.Px2.p1.3.m1.1a"><mi id="S2.SS0.SSS0.Px2.p1.3.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.3.m1.1b"><ci id="S2.SS0.SSS0.Px2.p1.3.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.3.m1.1c">c</annotation></semantics></math>, <math id="S2.SS0.SSS0.Px2.p1.4.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS0.SSS0.Px2.p1.4.m2.1a"><mi id="S2.SS0.SSS0.Px2.p1.4.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.4.m2.1b"><ci id="S2.SS0.SSS0.Px2.p1.4.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.4.m2.1c">k</annotation></semantics></math>, and <math id="S2.SS0.SSS0.Px2.p1.5.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.SS0.SSS0.Px2.p1.5.m3.1a"><mi id="S2.SS0.SSS0.Px2.p1.5.m3.1.1" xref="S2.SS0.SSS0.Px2.p1.5.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.5.m3.1b"><ci id="S2.SS0.SSS0.Px2.p1.5.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.5.m3.1c">\alpha</annotation></semantics></math> are parameters to fit and <math id="S2.SS0.SSS0.Px2.p1.6.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS0.SSS0.Px2.p1.6.m4.1a"><mi id="S2.SS0.SSS0.Px2.p1.6.m4.1.1" xref="S2.SS0.SSS0.Px2.p1.6.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.6.m4.1b"><ci id="S2.SS0.SSS0.Px2.p1.6.m4.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.6.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.6.m4.1c">x</annotation></semantics></math> can be model sizes, numbers of training data, training steps<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>
The training step law&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite> refers to the function between the intermediate training step and its corresponding loss <span id="footnote2.1" class="ltx_text ltx_font_italic">in one single training run</span>.
For clarity, we highlight its difference from the data scaling law that predicts the early exit loss&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite> or the loss obtained with optimal hyperparameters for each data budget&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hoffmann et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite>.
</span></span></span>, and the amount of computation.
Previous experience&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Alabdulmohsin et&nbsp;al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>; OpenAI, <a href="#bib.bib48" title="" class="ltx_ref">2023</a>; Bi et&nbsp;al., <a href="#bib.bib7" title="" class="ltx_ref">2024</a>; Su et&nbsp;al., <a href="#bib.bib54" title="" class="ltx_ref">2024</a>)</cite> highlights the impressive predictability of scaling laws.
Specifically, Eqn.&nbsp;<a href="#S2.E3" title="In Scaling laws. ‣ 2 Background ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> fitted on a collection of small models, training data, or computation can extrapolate to precisely predict the test loss of larger cases over orders of magnitudes.
This enables practitioners to estimate the performance of a pretrained large language model without actually finishing the expensive runs.
Recent development further shows various functional relationships between the performance of language models and a broader range of factors, including transfer learning&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hernandez et&nbsp;al., <a href="#bib.bib31" title="" class="ltx_ref">2021</a>)</cite>, sparse architectures&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Frantar et&nbsp;al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>)</cite>, and repeated data <cite class="ltx_cite ltx_citemacro_citep">(Muennighoff et&nbsp;al., <a href="#bib.bib47" title="" class="ltx_ref">2024</a>)</cite>, consolidating the predictability of language model performance.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Problem formalization.</h4>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">We study optimizing the mixture proportions of pretraining data for large language models.
Motivated by the impressive predictability of existing scaling laws, we try to tackle mixture optimization by establishing a quantitative framework that predicts the loss given any mixture proportion.
Formally, for a training dataset comprising <math id="S2.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS0.SSS0.Px3.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.1.m1.1c">M</annotation></semantics></math> domains, we parameterize the function</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.2" class="ltx_Math" alttext="L=f_{\theta}(\bm{r})," display="block"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.2" xref="S2.E4.m1.2.2.1.1.2.cmml">L</mi><mo id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E4.m1.2.2.1.1.3" xref="S2.E4.m1.2.2.1.1.3.cmml"><msub id="S2.E4.m1.2.2.1.1.3.2" xref="S2.E4.m1.2.2.1.1.3.2.cmml"><mi id="S2.E4.m1.2.2.1.1.3.2.2" xref="S2.E4.m1.2.2.1.1.3.2.2.cmml">f</mi><mi id="S2.E4.m1.2.2.1.1.3.2.3" xref="S2.E4.m1.2.2.1.1.3.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.3.1" xref="S2.E4.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.3.3.2" xref="S2.E4.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.3.3.2.1" xref="S2.E4.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S2.E4.m1.2.2.1.1.3.3.2.2" xref="S2.E4.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><eq id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"></eq><ci id="S2.E4.m1.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2">𝐿</ci><apply id="S2.E4.m1.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.3"><times id="S2.E4.m1.2.2.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.3.1"></times><apply id="S2.E4.m1.2.2.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.2.1.cmml" xref="S2.E4.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.2.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2.2">𝑓</ci><ci id="S2.E4.m1.2.2.1.1.3.2.3.cmml" xref="S2.E4.m1.2.2.1.1.3.2.3">𝜃</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝒓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">L=f_{\theta}(\bm{r}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS0.SSS0.Px3.p1.3" class="ltx_p">under the fixed model sizes and number of training steps, where <math id="S2.SS0.SSS0.Px3.p1.2.m1.1" class="ltx_Math" alttext="\bm{r}=r_{1\dots M}" display="inline"><semantics id="S2.SS0.SSS0.Px3.p1.2.m1.1a"><mrow id="S2.SS0.SSS0.Px3.p1.2.m1.1.1" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2.cmml">𝒓</mi><mo id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1.cmml">=</mo><msub id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2.cmml">r</mi><mrow id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.cmml"><mn id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1a" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4.cmml">M</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.2.m1.1b"><apply id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1"><eq id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1"></eq><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2">𝒓</ci><apply id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2">𝑟</ci><apply id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3"><times id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1"></times><cn type="integer" id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2">1</cn><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3">…</ci><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.2.m1.1c">\bm{r}=r_{1\dots M}</annotation></semantics></math> is the proportion of the <math id="S2.SS0.SSS0.Px3.p1.3.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS0.SSS0.Px3.p1.3.m2.1a"><mi id="S2.SS0.SSS0.Px3.p1.3.m2.1.1" xref="S2.SS0.SSS0.Px3.p1.3.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.3.m2.1b"><ci id="S2.SS0.SSS0.Px3.p1.3.m2.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.3.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.3.m2.1c">M</annotation></semantics></math> domains.
Harnessing this function, we seek a mixture that achieves the desired performance.
Without loss of generality, we search for the mixture that reaches minimum validation loss, i.e.,</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.2" class="ltx_Math" alttext="\bm{r}^{*}={\arg\min}_{\bm{r}}f_{\theta}(\bm{r})." display="block"><semantics id="S2.E5.m1.2a"><mrow id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.1.cmml"><mrow id="S2.E5.m1.2.2.1.1" xref="S2.E5.m1.2.2.1.1.cmml"><msup id="S2.E5.m1.2.2.1.1.2" xref="S2.E5.m1.2.2.1.1.2.cmml"><mi id="S2.E5.m1.2.2.1.1.2.2" xref="S2.E5.m1.2.2.1.1.2.2.cmml">𝒓</mi><mo id="S2.E5.m1.2.2.1.1.2.3" xref="S2.E5.m1.2.2.1.1.2.3.cmml">∗</mo></msup><mo id="S2.E5.m1.2.2.1.1.1" xref="S2.E5.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E5.m1.2.2.1.1.3" xref="S2.E5.m1.2.2.1.1.3.cmml"><mrow id="S2.E5.m1.2.2.1.1.3.2" xref="S2.E5.m1.2.2.1.1.3.2.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.1" xref="S2.E5.m1.2.2.1.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E5.m1.2.2.1.1.3.2a" xref="S2.E5.m1.2.2.1.1.3.2.cmml">⁡</mo><mrow id="S2.E5.m1.2.2.1.1.3.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.cmml"><munder id="S2.E5.m1.2.2.1.1.3.2.2.1" xref="S2.E5.m1.2.2.1.1.3.2.2.1.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.2.1.2" xref="S2.E5.m1.2.2.1.1.3.2.2.1.2.cmml">min</mi><mi id="S2.E5.m1.2.2.1.1.3.2.2.1.3" xref="S2.E5.m1.2.2.1.1.3.2.2.1.3.cmml">𝒓</mi></munder><mo lspace="0.167em" id="S2.E5.m1.2.2.1.1.3.2.2a" xref="S2.E5.m1.2.2.1.1.3.2.2.cmml">⁡</mo><msub id="S2.E5.m1.2.2.1.1.3.2.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.2.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.2.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.2.2.cmml">f</mi><mi id="S2.E5.m1.2.2.1.1.3.2.2.2.3" xref="S2.E5.m1.2.2.1.1.3.2.2.2.3.cmml">θ</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.3.1" xref="S2.E5.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S2.E5.m1.2.2.1.1.3.3.2" xref="S2.E5.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S2.E5.m1.2.2.1.1.3.3.2.1" xref="S2.E5.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S2.E5.m1.2.2.1.1.3.3.2.2" xref="S2.E5.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E5.m1.2.2.1.2" xref="S2.E5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1"><eq id="S2.E5.m1.2.2.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1"></eq><apply id="S2.E5.m1.2.2.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.2.1.cmml" xref="S2.E5.m1.2.2.1.1.2">superscript</csymbol><ci id="S2.E5.m1.2.2.1.1.2.2.cmml" xref="S2.E5.m1.2.2.1.1.2.2">𝒓</ci><times id="S2.E5.m1.2.2.1.1.2.3.cmml" xref="S2.E5.m1.2.2.1.1.2.3"></times></apply><apply id="S2.E5.m1.2.2.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.3"><times id="S2.E5.m1.2.2.1.1.3.1.cmml" xref="S2.E5.m1.2.2.1.1.3.1"></times><apply id="S2.E5.m1.2.2.1.1.3.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2"><arg id="S2.E5.m1.2.2.1.1.3.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.1"></arg><apply id="S2.E5.m1.2.2.1.1.3.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2"><apply id="S2.E5.m1.2.2.1.1.3.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1">subscript</csymbol><min id="S2.E5.m1.2.2.1.1.3.2.2.1.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1.2"></min><ci id="S2.E5.m1.2.2.1.1.3.2.2.1.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1.3">𝒓</ci></apply><apply id="S2.E5.m1.2.2.1.1.3.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2.2">𝑓</ci><ci id="S2.E5.m1.2.2.1.1.3.2.2.2.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2.3">𝜃</ci></apply></apply></apply><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝒓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">\bm{r}^{*}={\arg\min}_{\bm{r}}f_{\theta}(\bm{r}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The proportions of data mixtures influence model losses in a quantitatively predictable way</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">In this section, we present our findings on the predictability of model losses regarding data mixtures, which boils down to functional relationships we refer to as the data mixing laws.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p">To discover the data mixing laws, we encounter two challenges posed by their characteristics.</p>
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(i)</span> 
<div id="S3.I1.ix1.p1" class="ltx_para">
<p id="S3.I1.ix1.p1.3" class="ltx_p"><span id="S3.I1.ix1.p1.3.1" class="ltx_text ltx_font_bold ltx_font_italic">Multi-variables.</span>
For a data mixing law for <math id="S3.I1.ix1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.I1.ix1.p1.1.m1.1a"><mi id="S3.I1.ix1.p1.1.m1.1.1" xref="S3.I1.ix1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.1.m1.1b"><ci id="S3.I1.ix1.p1.1.m1.1.1.cmml" xref="S3.I1.ix1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.1.m1.1c">K</annotation></semantics></math> domains, we should consider <math id="S3.I1.ix1.p1.2.m2.1" class="ltx_Math" alttext="K-1" display="inline"><semantics id="S3.I1.ix1.p1.2.m2.1a"><mrow id="S3.I1.ix1.p1.2.m2.1.1" xref="S3.I1.ix1.p1.2.m2.1.1.cmml"><mi id="S3.I1.ix1.p1.2.m2.1.1.2" xref="S3.I1.ix1.p1.2.m2.1.1.2.cmml">K</mi><mo id="S3.I1.ix1.p1.2.m2.1.1.1" xref="S3.I1.ix1.p1.2.m2.1.1.1.cmml">−</mo><mn id="S3.I1.ix1.p1.2.m2.1.1.3" xref="S3.I1.ix1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.2.m2.1b"><apply id="S3.I1.ix1.p1.2.m2.1.1.cmml" xref="S3.I1.ix1.p1.2.m2.1.1"><minus id="S3.I1.ix1.p1.2.m2.1.1.1.cmml" xref="S3.I1.ix1.p1.2.m2.1.1.1"></minus><ci id="S3.I1.ix1.p1.2.m2.1.1.2.cmml" xref="S3.I1.ix1.p1.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S3.I1.ix1.p1.2.m2.1.1.3.cmml" xref="S3.I1.ix1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.2.m2.1c">K-1</annotation></semantics></math> degrees of freedom in the mixture proportions and, correspondingly, <math id="S3.I1.ix1.p1.3.m3.1" class="ltx_Math" alttext="K-1" display="inline"><semantics id="S3.I1.ix1.p1.3.m3.1a"><mrow id="S3.I1.ix1.p1.3.m3.1.1" xref="S3.I1.ix1.p1.3.m3.1.1.cmml"><mi id="S3.I1.ix1.p1.3.m3.1.1.2" xref="S3.I1.ix1.p1.3.m3.1.1.2.cmml">K</mi><mo id="S3.I1.ix1.p1.3.m3.1.1.1" xref="S3.I1.ix1.p1.3.m3.1.1.1.cmml">−</mo><mn id="S3.I1.ix1.p1.3.m3.1.1.3" xref="S3.I1.ix1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.3.m3.1b"><apply id="S3.I1.ix1.p1.3.m3.1.1.cmml" xref="S3.I1.ix1.p1.3.m3.1.1"><minus id="S3.I1.ix1.p1.3.m3.1.1.1.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.1"></minus><ci id="S3.I1.ix1.p1.3.m3.1.1.2.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.2">𝐾</ci><cn type="integer" id="S3.I1.ix1.p1.3.m3.1.1.3.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.3.m3.1c">K-1</annotation></semantics></math> variables in the target function.
The increase of variables considerably enlarges the scope of potential functions thereby complicating the identification of the function form.</p>
</div>
</li>
<li id="S3.I1.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(ii)</span> 
<div id="S3.I1.ix2.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.ix2.p1.1" class="ltx_p"><span id="S3.I1.ix2.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Nonmonotonicity.</span> A monotonic relationship between losses and the proportion of any domain indicates that a lopsided mixture can achieve minimum loss without endeavors to balance domain proportions, which contradicts the practice.
Therefore, differing from existing scaling laws that loss monotonically decreases with the scale of concerning factors, the data mixing law we study should accommodate non-monotonic functions.
This nonmonotonic nature adds another layer of complexity to our analysis.</p>
</div>
</li>
</ol>
<p id="S3.p2.2" class="ltx_p">To navigate these challenges, we initially simplify the problem by studying a scenario where the relationship between loss and mixture proportions fits into a univariate monotonic function then retracts the simplifications progressively.
In specific, we begin our study on the case where we only train on two domains thus avoiding multi-variables, and only consider the validation data coming from one of the training domains to circumvent the non-monotonicity (Sec.&nbsp;<a href="#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>).
Subsequently, we broaden our framework to encompass training on multiple domains&nbsp;(Sec.&nbsp;<a href="#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>) and explore the predictability of losses on general validation data that also comprises various domains (Sec.&nbsp;<a href="#S3.SS3" title="3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>).</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Pilot Study on Domain Losses under Two-domain Mixtures</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">We begin our exploration with the simplest case where we only learn on mixtures of two domains and evaluate our model on the two domains respectively.</p>
</div>
<figure id="S3.F2" class="ltx_figure ltx_align_floatright"><img src="/html/2403.16952/assets/figs/2mix.png" id="S3.F2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Quantitative predictability of domain losses on two domains, which are Github and Pile-CC.
We train on the mixtures of these two domains and validate the outcome models on them separately.
We train 70M and 160M models on five different mixtures of Github and Pile-CC and obtain the reducible losses by subtracting the original losses with a constant shared across models of the same sizes and trained for the same number of steps.
The reducible losses in log scale show linear correlations to the domain proportions.
</figcaption>
</figure>
<section id="S3.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Setups</h4>

<div id="S3.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS0.Px1.p1.1" class="ltx_p">We train 70M and 160M language models on the mixture of Github and Pile-CC subset from the Pile dataset&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite> with five different mixture proportions, which are {0.25, 0.375, 0.5, 0.625, 0.75} for Github.
We train all models with a batch size of 1M tokens for 30k steps, which is 30B tokens in total, and evaluate checkpoints at different steps on the validation set of GitHub and Pile-CC.</p>
</div>
</section>
<section id="S3.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Findings</h4>

<div id="S3.SS1.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS0.Px2.p1.7" class="ltx_p">Results in Fig.&nbsp;<a href="#S3.F2" title="Figure 2 ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> reveal the quantitative predictability of domain losses given the domain proportions.
We encouragingly find that, for checkpoints with the same size and trained with the same number of steps, after subtracting a shared constant<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>The loss function of language models is lower bounded by the entropy of the evaluation data theoretically&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bishop, <a href="#bib.bib9" title="" class="ltx_ref">2006</a>; Henighan et&nbsp;al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>)</cite>. Thus, it is common to have constant terms in scaling laws, known as irreducible loss. </span></span></span>, their domain losses in the log scale demonstrate a linear relationship to the domain proportion.
This holds for both domains in our experiments.
The result indicates that with other factors fixed, the domain losses of a pretrained language model regarding the domain proportion precisely fit into an exponential law</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.2" class="ltx_Math" alttext="L_{i}(r_{i})=c_{i}+k_{i}\exp{\left(t_{ii}r_{i}\right)}," display="block"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.3.2.cmml">L</mi><mi id="S3.E6.m1.2.2.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.2.cmml"><msub id="S3.E6.m1.2.2.1.1.2.3" xref="S3.E6.m1.2.2.1.1.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.3.2" xref="S3.E6.m1.2.2.1.1.2.3.2.cmml">c</mi><mi id="S3.E6.m1.2.2.1.1.2.3.3" xref="S3.E6.m1.2.2.1.1.2.3.3.cmml">i</mi></msub><mo id="S3.E6.m1.2.2.1.1.2.2" xref="S3.E6.m1.2.2.1.1.2.2.cmml">+</mo><mrow id="S3.E6.m1.2.2.1.1.2.1" xref="S3.E6.m1.2.2.1.1.2.1.cmml"><msub id="S3.E6.m1.2.2.1.1.2.1.3" xref="S3.E6.m1.2.2.1.1.2.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.3.2" xref="S3.E6.m1.2.2.1.1.2.1.3.2.cmml">k</mi><mi id="S3.E6.m1.2.2.1.1.2.1.3.3" xref="S3.E6.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.1.2" xref="S3.E6.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">exp</mi><mo id="S3.E6.m1.2.2.1.1.2.1.1.1a" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml">⁡</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml"><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml">t</mi><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1"><eq id="S3.E6.m1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3"></eq><apply id="S3.E6.m1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1"><times id="S3.E6.m1.2.2.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.2"></times><apply id="S3.E6.m1.2.2.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.3.2">𝐿</ci><ci id="S3.E6.m1.2.2.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2"><plus id="S3.E6.m1.2.2.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2"></plus><apply id="S3.E6.m1.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.3.2">𝑐</ci><ci id="S3.E6.m1.2.2.1.1.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1"><times id="S3.E6.m1.2.2.1.1.2.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.2"></times><apply id="S3.E6.m1.2.2.1.1.2.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3.2">𝑘</ci><ci id="S3.E6.m1.2.2.1.1.2.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1"><exp id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"></exp><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1"><times id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1"></times><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2">𝑡</ci><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3"><times id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1"></times><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">L_{i}(r_{i})=c_{i}+k_{i}\exp{\left(t_{ii}r_{i}\right)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS0.Px2.p1.6" class="ltx_p">where <math id="S3.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">L</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝐿</ci><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.1.m1.1c">L_{i}</annotation></semantics></math> and <math id="S3.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="r_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2">𝑟</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.2.m2.1c">r_{i}</annotation></semantics></math> are validation loss and training mixture proportion of domain <math id="S3.SS1.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.3.m3.1c">i</annotation></semantics></math>, respectively, while <math id="S3.SS1.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.4.m4.1a"><msub id="S3.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.cmml">c</mi><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2">𝑐</ci><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.4.m4.1c">c_{i}</annotation></semantics></math>, <math id="S3.SS1.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="k_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.5.m5.1a"><msub id="S3.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml">k</mi><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2">𝑘</ci><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.5.m5.1c">k_{i}</annotation></semantics></math>, and <math id="S3.SS1.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="t_{ii}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.6.m6.1a"><msub id="S3.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml">t</mi><mrow id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2">𝑡</ci><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3"><times id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.6.m6.1c">t_{ii}</annotation></semantics></math> are learnable parameters&nbsp;<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>
Despite a simple case, our findings on two domains have practical applications to continue pretraining&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gururangan et&nbsp;al., <a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite>, where we aim to enhance a pretrained model on a given domain by training it on a mixture of the original pretraining data and upcoming domain data. Please see Sec.&nbsp;<a href="#S5" title="5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> for details.
</span></span></span>.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Extension to Domain Losses Trained on Multi-domain Mixtures</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">To accommodate real-world pretraining data that mostly contains more than two domains, we extend our investigation into multiple domains.
For simplicity and the ease of visual aids, we start with the case of three domains.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Mean absolute errors (MAE) of different candidate functions for predicting the target domain losses.
We also include random guesses that randomly predict between the maximum and minimum loss of the training samples for reference. In specific, we report the MAE of the expectation of this random guess which predicts the median of the maximum and minimum loss.
The training data contain <math id="S3.T1.2.m1.1" class="ltx_Math" alttext="M=3" display="inline"><semantics id="S3.T1.2.m1.1b"><mrow id="S3.T1.2.m1.1.1" xref="S3.T1.2.m1.1.1.cmml"><mi id="S3.T1.2.m1.1.1.2" xref="S3.T1.2.m1.1.1.2.cmml">M</mi><mo id="S3.T1.2.m1.1.1.1" xref="S3.T1.2.m1.1.1.1.cmml">=</mo><mn id="S3.T1.2.m1.1.1.3" xref="S3.T1.2.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.m1.1c"><apply id="S3.T1.2.m1.1.1.cmml" xref="S3.T1.2.m1.1.1"><eq id="S3.T1.2.m1.1.1.1.cmml" xref="S3.T1.2.m1.1.1.1"></eq><ci id="S3.T1.2.m1.1.1.2.cmml" xref="S3.T1.2.m1.1.1.2">𝑀</ci><cn type="integer" id="S3.T1.2.m1.1.1.3.cmml" xref="S3.T1.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.m1.1d">M=3</annotation></semantics></math> domains and we fit each function with the same 24 mixtures and validate on 8 other mixtures. The split is random.
The lowest error for each target domain are in <span id="S3.T1.5.1" class="ltx_text ltx_font_bold">bold</span> while the second lowest are <span id="S3.T1.6.2" class="ltx_text ltx_framed ltx_framed_underline">underlined</span>.
</figcaption>
<div id="S3.T1.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:424.9pt;height:137.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(17.8pt,-5.8pt) scale(1.09154587119699,1.09154587119699) ;">
<table id="S3.T1.7.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.7.1.1.1" class="ltx_tr">
<td id="S3.T1.7.1.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S3.T1.7.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S3.T1.7.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S3.T1.7.1.1.1.3.1" class="ltx_text ltx_font_bold">GitHub</span></th>
<th id="S3.T1.7.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S3.T1.7.1.1.1.4.1" class="ltx_text ltx_font_bold">Books3</span></th>
<th id="S3.T1.7.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S3.T1.7.1.1.1.5.1" class="ltx_text ltx_font_bold">Pile-CC</span></th>
</tr>
<tr id="S3.T1.7.1.2.2" class="ltx_tr">
<th id="S3.T1.7.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.7.1.2.2.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S3.T1.7.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.7.1.2.2.2.1" class="ltx_text ltx_font_bold"># Coeff.</span></th>
<th id="S3.T1.7.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Train</th>
<th id="S3.T1.7.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Validation</th>
<th id="S3.T1.7.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Train</th>
<th id="S3.T1.7.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Validation</th>
<th id="S3.T1.7.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Train</th>
<th id="S3.T1.7.1.2.2.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t">Validation</th>
</tr>
<tr id="S3.T1.7.1.3.3" class="ltx_tr">
<td id="S3.T1.7.1.3.3.1" class="ltx_td ltx_align_center ltx_border_t">Random</td>
<td id="S3.T1.7.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S3.T1.7.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">0.8895</td>
<td id="S3.T1.7.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">0.8758</td>
<td id="S3.T1.7.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">0.1291</td>
<td id="S3.T1.7.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">0.1331</td>
<td id="S3.T1.7.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">0.0768</td>
<td id="S3.T1.7.1.3.3.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">0.1045</td>
</tr>
<tr id="S3.T1.7.1.4.4" class="ltx_tr">
<td id="S3.T1.7.1.4.4.1" class="ltx_td ltx_align_center">M1</td>
<td id="S3.T1.7.1.4.4.2" class="ltx_td ltx_align_center">2M+1</td>
<td id="S3.T1.7.1.4.4.3" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.3.1" class="ltx_text ltx_font_bold">0.0292</span></td>
<td id="S3.T1.7.1.4.4.4" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.4.1" class="ltx_text ltx_font_bold">0.0312</span></td>
<td id="S3.T1.7.1.4.4.5" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.0082</span></td>
<td id="S3.T1.7.1.4.4.6" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.6.1" class="ltx_text ltx_framed ltx_framed_underline">0.0121</span></td>
<td id="S3.T1.7.1.4.4.7" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.7.1" class="ltx_text ltx_framed ltx_framed_underline">0.0045</span></td>
<td id="S3.T1.7.1.4.4.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T1.7.1.4.4.8.1" class="ltx_text ltx_font_bold">0.0050</span></td>
</tr>
<tr id="S3.T1.7.1.5.5" class="ltx_tr">
<td id="S3.T1.7.1.5.5.1" class="ltx_td ltx_align_center">M2</td>
<td id="S3.T1.7.1.5.5.2" class="ltx_td ltx_align_center">M+2</td>
<td id="S3.T1.7.1.5.5.3" class="ltx_td ltx_align_center">0.1558</td>
<td id="S3.T1.7.1.5.5.4" class="ltx_td ltx_align_center">0.3327</td>
<td id="S3.T1.7.1.5.5.5" class="ltx_td ltx_align_center">0.0114</td>
<td id="S3.T1.7.1.5.5.6" class="ltx_td ltx_align_center">0.0119</td>
<td id="S3.T1.7.1.5.5.7" class="ltx_td ltx_align_center">0.0072</td>
<td id="S3.T1.7.1.5.5.8" class="ltx_td ltx_nopad_r ltx_align_center">0.0083</td>
</tr>
<tr id="S3.T1.7.1.6.6" class="ltx_tr">
<td id="S3.T1.7.1.6.6.1" class="ltx_td ltx_align_center">M3</td>
<td id="S3.T1.7.1.6.6.2" class="ltx_td ltx_align_center">M+2</td>
<td id="S3.T1.7.1.6.6.3" class="ltx_td ltx_align_center">0.3389</td>
<td id="S3.T1.7.1.6.6.4" class="ltx_td ltx_align_center">0.2177</td>
<td id="S3.T1.7.1.6.6.5" class="ltx_td ltx_align_center">0.0914</td>
<td id="S3.T1.7.1.6.6.6" class="ltx_td ltx_align_center">0.0465</td>
<td id="S3.T1.7.1.6.6.7" class="ltx_td ltx_align_center">0.0746</td>
<td id="S3.T1.7.1.6.6.8" class="ltx_td ltx_nopad_r ltx_align_center">0.0947</td>
</tr>
<tr id="S3.T1.7.1.7.7" class="ltx_tr" style="background-color:#FFEFEF;">
<td id="S3.T1.7.1.7.7.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.1.1" class="ltx_text" style="background-color:#FFEFEF;">M4</span></td>
<td id="S3.T1.7.1.7.7.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.2.1" class="ltx_text" style="background-color:#FFEFEF;">M+2</span></td>
<td id="S3.T1.7.1.7.7.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.3.1" class="ltx_text ltx_framed ltx_framed_underline" style="background-color:#FFEFEF;">0.0298</span></td>
<td id="S3.T1.7.1.7.7.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.4.1" class="ltx_text ltx_framed ltx_framed_underline" style="background-color:#FFEFEF;">0.0365</span></td>
<td id="S3.T1.7.1.7.7.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.5.1" class="ltx_text ltx_font_bold" style="background-color:#FFEFEF;">0.0062</span></td>
<td id="S3.T1.7.1.7.7.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.6.1" class="ltx_text ltx_font_bold" style="background-color:#FFEFEF;">0.0074</span></td>
<td id="S3.T1.7.1.7.7.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.7.1" class="ltx_text ltx_font_bold" style="background-color:#FFEFEF;">0.0036</span></td>
<td id="S3.T1.7.1.7.7.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.8.1" class="ltx_text ltx_framed ltx_framed_underline" style="background-color:#FFEFEF;">0.0078</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section id="S3.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Setups</h4>

<div id="S3.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS0.Px1.p1.1" class="ltx_p">We train on the mixtures of GitHub, Pile-CC, and Books3 subset from the Pile for a total of 30B tokens and evaluate the model on the three domains, respectively.
For specific mixtures, we grid search from <math id="S3.SS2.SSS0.Px1.p1.1.m1.6" class="ltx_Math" alttext="\{0,0.125,0.25,\dots,0.875,1\}^{3}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.6a"><msup id="S3.SS2.SSS0.Px1.p1.1.m1.6.7" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">{</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">0</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.cmml">0.125</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.3.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.3.3.cmml">0.25</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.4" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS0.Px1.p1.1.m1.4.4" xref="S3.SS2.SSS0.Px1.p1.1.m1.4.4.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.5" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.5.5" xref="S3.SS2.SSS0.Px1.p1.1.m1.5.5.cmml">0.875</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.6" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.6.6" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.6.cmml">1</mn><mo stretchy="false" id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.7" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">}</mo></mrow><mn id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.6b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7">superscript</csymbol><set id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2"><cn type="integer" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">0</cn><cn type="float" id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2">0.125</cn><cn type="float" id="S3.SS2.SSS0.Px1.p1.1.m1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.3.3">0.25</cn><ci id="S3.SS2.SSS0.Px1.p1.1.m1.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.4.4">…</ci><cn type="float" id="S3.SS2.SSS0.Px1.p1.1.m1.5.5.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.5.5">0.875</cn><cn type="integer" id="S3.SS2.SSS0.Px1.p1.1.m1.6.6.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.6">1</cn></set><cn type="integer" id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.6c">\{0,0.125,0.25,\dots,0.875,1\}^{3}</annotation></semantics></math> and retain valid ones in which three proportions sum up to 1 and do not use up all tokens in any of the domains<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>The GitHub and Books3 subset in the Pile do not contain as many as 30B tokens after deduplication.</span></span></span>, which results in 32 mixtures in total.</p>
</div>
<div id="S3.SS2.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS0.Px1.p2.1" class="ltx_p">We utilize the losses on these experimented mixtures to identify the function forms between losses and mixture proportions through conjecture and then verification.
In specific, we base our conjecture of possible forms on the following two principles.</p>
<ul id="S3.I2" class="ltx_itemize">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i1.p1" class="ltx_para">
<p id="S3.I2.i1.p1.1" class="ltx_p"><span id="S3.I2.i1.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Compatibility.</span> The form can reduce to Eqn.&nbsp;<a href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> if the number of domains <math id="S3.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="M=2" display="inline"><semantics id="S3.I2.i1.p1.1.m1.1a"><mrow id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml"><mi id="S3.I2.i1.p1.1.m1.1.1.2" xref="S3.I2.i1.p1.1.m1.1.1.2.cmml">M</mi><mo id="S3.I2.i1.p1.1.m1.1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.I2.i1.p1.1.m1.1.1.3" xref="S3.I2.i1.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.1b"><apply id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><eq id="S3.I2.i1.p1.1.m1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1.1"></eq><ci id="S3.I2.i1.p1.1.m1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2">𝑀</ci><cn type="integer" id="S3.I2.i1.p1.1.m1.1.1.3.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.1c">M=2</annotation></semantics></math>.</p>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i2.p1" class="ltx_para ltx_noindent">
<p id="S3.I2.i2.p1.1" class="ltx_p"><span id="S3.I2.i2.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Symmetry.</span> Any exchanging of variables should not change the functional form.</p>
</div>
</li>
</ul>
<p id="S3.SS2.SSS0.Px1.p2.2" class="ltx_p">The second principle stems from the intuition to avoid introducing any domain-specific bias.
Together, the two principles lead to candidate functions that replicate the exponential term in Eqn.&nbsp;<a href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> for each training domain and combine them through operations that adhere to commutative law.</p>
</div>
<div id="S3.SS2.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS0.Px1.p3.1" class="ltx_p">According to the two principles, we experiment with the following candidate functions:</p>
<table id="S3.Ex1" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S3.Ex1X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex1X.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">M1:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1X.4.1.1.m1.1" class="ltx_Math" alttext="\displaystyle L_{i}(\bm{r})=" display="inline"><semantics id="S3.Ex1X.4.1.1.m1.1a"><mrow id="S3.Ex1X.4.1.1.m1.1.2" xref="S3.Ex1X.4.1.1.m1.1.2.cmml"><mrow id="S3.Ex1X.4.1.1.m1.1.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1X.4.1.1.m1.1.2.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1X.4.1.1.m1.1.2.2.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1X.4.1.1.m1.1.2.2.2.3" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.4.1.1.m1.1.2.2.1" xref="S3.Ex1X.4.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.Ex1X.4.1.1.m1.1.2.2.3.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.Ex1X.4.1.1.m1.1.2.2.3.2.1" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1X.4.1.1.m1.1.1" xref="S3.Ex1X.4.1.1.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S3.Ex1X.4.1.1.m1.1.2.2.3.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1X.4.1.1.m1.1.2.1" xref="S3.Ex1X.4.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1X.4.1.1.m1.1.2.3" xref="S3.Ex1X.4.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.4.1.1.m1.1b"><apply id="S3.Ex1X.4.1.1.m1.1.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2"><eq id="S3.Ex1X.4.1.1.m1.1.2.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.1"></eq><apply id="S3.Ex1X.4.1.1.m1.1.2.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2"><times id="S3.Ex1X.4.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1X.4.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1X.4.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1X.4.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1X.4.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1X.4.1.1.m1.1.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1X.4.1.1.m1.1.2.3.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.4.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1X.5.2.2.m1.2" class="ltx_Math" alttext="\displaystyle c_{i}+\sum_{j=1}^{M}\left[k_{ij}\exp\left(t_{ij}r_{j}\right)\right]," display="inline"><semantics id="S3.Ex1X.5.2.2.m1.2a"><mrow id="S3.Ex1X.5.2.2.m1.2.2.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.cmml"><munderover id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2a" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml">k</mi><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.5.2.2.m1.1.1" xref="S3.Ex1X.5.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.Ex1X.5.2.2.m1.2.2.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.5.2.2.m1.2b"><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1"><plus id="S3.Ex1X.5.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1"><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2"></sum><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3"><eq id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3">𝑀</ci></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2">𝑘</ci><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1"></times><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1"><exp id="S3.Ex1X.5.2.2.m1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.1.1"></exp><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝑡</ci><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.5.2.2.m1.2c">\displaystyle c_{i}+\sum_{j=1}^{M}\left[k_{ij}\exp\left(t_{ij}r_{j}\right)\right],</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex1X.7.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">M2:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1X.9.1.1.m1.1" class="ltx_Math" alttext="\displaystyle L_{i}(\bm{r})=" display="inline"><semantics id="S3.Ex1X.9.1.1.m1.1a"><mrow id="S3.Ex1X.9.1.1.m1.1.2" xref="S3.Ex1X.9.1.1.m1.1.2.cmml"><mrow id="S3.Ex1X.9.1.1.m1.1.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1X.9.1.1.m1.1.2.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1X.9.1.1.m1.1.2.2.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1X.9.1.1.m1.1.2.2.2.3" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.9.1.1.m1.1.2.2.1" xref="S3.Ex1X.9.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.Ex1X.9.1.1.m1.1.2.2.3.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.Ex1X.9.1.1.m1.1.2.2.3.2.1" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1X.9.1.1.m1.1.1" xref="S3.Ex1X.9.1.1.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S3.Ex1X.9.1.1.m1.1.2.2.3.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1X.9.1.1.m1.1.2.1" xref="S3.Ex1X.9.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1X.9.1.1.m1.1.2.3" xref="S3.Ex1X.9.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.9.1.1.m1.1b"><apply id="S3.Ex1X.9.1.1.m1.1.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2"><eq id="S3.Ex1X.9.1.1.m1.1.2.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.1"></eq><apply id="S3.Ex1X.9.1.1.m1.1.2.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2"><times id="S3.Ex1X.9.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1X.9.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1X.9.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1X.9.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1X.9.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1X.9.1.1.m1.1.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1X.9.1.1.m1.1.2.3.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.9.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1X.10.2.2.m1.2" class="ltx_Math" alttext="\displaystyle c_{i}+k_{i}\sum_{j=1}^{M}\exp\left(t_{ij}r_{j}\right)," display="inline"><semantics id="S3.Ex1X.10.2.2.m1.2a"><mrow id="S3.Ex1X.10.2.2.m1.2.2.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2.cmml">k</mi><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.cmml"><munderover id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2a" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.10.2.2.m1.1.1" xref="S3.Ex1X.10.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1a" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex1X.10.2.2.m1.2.2.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.10.2.2.m1.2b"><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1"><plus id="S3.Ex1X.10.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1"><times id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2">𝑘</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1"><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3"><eq id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1"><exp id="S3.Ex1X.10.2.2.m1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.1.1"></exp><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑡</ci><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><times id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.10.2.2.m1.2c">\displaystyle c_{i}+k_{i}\sum_{j=1}^{M}\exp\left(t_{ij}r_{j}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex1Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex1Xa.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">M3:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1Xa.4.1.1.m1.1" class="ltx_Math" alttext="\displaystyle L_{i}(\bm{r})=" display="inline"><semantics id="S3.Ex1Xa.4.1.1.m1.1a"><mrow id="S3.Ex1Xa.4.1.1.m1.1.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.cmml"><mrow id="S3.Ex1Xa.4.1.1.m1.1.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1Xa.4.1.1.m1.1.2.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.4.1.1.m1.1.2.2.1" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.Ex1Xa.4.1.1.m1.1.2.2.3.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.Ex1Xa.4.1.1.m1.1.2.2.3.2.1" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1Xa.4.1.1.m1.1.1" xref="S3.Ex1Xa.4.1.1.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S3.Ex1Xa.4.1.1.m1.1.2.2.3.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1Xa.4.1.1.m1.1.2.1" xref="S3.Ex1Xa.4.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1Xa.4.1.1.m1.1.2.3" xref="S3.Ex1Xa.4.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.4.1.1.m1.1b"><apply id="S3.Ex1Xa.4.1.1.m1.1.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2"><eq id="S3.Ex1Xa.4.1.1.m1.1.2.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.1"></eq><apply id="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2"><times id="S3.Ex1Xa.4.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1Xa.4.1.1.m1.1.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1Xa.4.1.1.m1.1.2.3.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.4.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1Xa.5.2.2.m1.2" class="ltx_Math" alttext="\displaystyle c_{i}+k_{i}\exp\left(\prod_{j=1}^{M}t_{ij}r_{j}\right)," display="inline"><semantics id="S3.Ex1Xa.5.2.2.m1.2a"><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2.cmml">k</mi><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.1.1" xref="S3.Ex1Xa.5.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1a" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">∏</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.5.2.2.m1.2b"><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1"><plus id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1"><times id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2">𝑘</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1"><exp id="S3.Ex1Xa.5.2.2.m1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.1.1"></exp><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1"><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><csymbol cd="latexml" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">product</csymbol><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><eq id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3"><times id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.5.2.2.m1.2c">\displaystyle c_{i}+k_{i}\exp\left(\prod_{j=1}^{M}t_{ij}r_{j}\right),</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex1Xa.7.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">M4:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1Xa.9.1.1.m1.1" class="ltx_Math" alttext="\displaystyle L_{i}(\bm{r})=" display="inline"><semantics id="S3.Ex1Xa.9.1.1.m1.1a"><mrow id="S3.Ex1Xa.9.1.1.m1.1.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.cmml"><mrow id="S3.Ex1Xa.9.1.1.m1.1.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1Xa.9.1.1.m1.1.2.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.9.1.1.m1.1.2.2.1" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.Ex1Xa.9.1.1.m1.1.2.2.3.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.Ex1Xa.9.1.1.m1.1.2.2.3.2.1" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1Xa.9.1.1.m1.1.1" xref="S3.Ex1Xa.9.1.1.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S3.Ex1Xa.9.1.1.m1.1.2.2.3.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1Xa.9.1.1.m1.1.2.1" xref="S3.Ex1Xa.9.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1Xa.9.1.1.m1.1.2.3" xref="S3.Ex1Xa.9.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.9.1.1.m1.1b"><apply id="S3.Ex1Xa.9.1.1.m1.1.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2"><eq id="S3.Ex1Xa.9.1.1.m1.1.2.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.1"></eq><apply id="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2"><times id="S3.Ex1Xa.9.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1Xa.9.1.1.m1.1.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1Xa.9.1.1.m1.1.2.3.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.9.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1Xa.10.2.2.m1.2" class="ltx_Math" alttext="\displaystyle c_{i}+k_{i}\exp\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)." display="inline"><semantics id="S3.Ex1Xa.10.2.2.m1.2a"><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2.cmml">k</mi><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.1.1" xref="S3.Ex1Xa.10.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1a" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex1Xa.10.2.2.m1.2.2.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.10.2.2.m1.2b"><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1"><plus id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1"><times id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2">𝑘</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1"><exp id="S3.Ex1Xa.10.2.2.m1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.1.1"></exp><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1"><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><eq id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3"><times id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.10.2.2.m1.2c">\displaystyle c_{i}+k_{i}\exp\left(\sum_{j=1}^{M}t_{ij}r_{j}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px1.p3.2" class="ltx_p">We summarize their fitting errors on three target domains in Tab.&nbsp;<a href="#S3.T1" title="Table 1 ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2403.16952/assets/x2.png" id="S3.F3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="130" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Quantitative predictability of domain losses on three domain mixtures, Github, Books3, and Pile-CC.
We train on the mixture of these three domains and validate the outcome models on them as well.
The surfaces show the predicted losses on (A) Github; (B) Books3; (C) Pile-CC; and (D) the overall validation set mixed with the three domains.
<math id="S3.F3.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.F3.3.m1.1b"><mo id="S3.F3.3.m1.1.1" xref="S3.F3.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F3.3.m1.1c"><times id="S3.F3.3.m1.1.1.cmml" xref="S3.F3.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.m1.1d">\times</annotation></semantics></math>: validation samples. <math id="S3.F3.4.m2.1" class="ltx_Math" alttext="{\star}" display="inline"><semantics id="S3.F3.4.m2.1b"><mo mathcolor="#FF0000" id="S3.F3.4.m2.1.1" xref="S3.F3.4.m2.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S3.F3.4.m2.1c"><ci id="S3.F3.4.m2.1.1.cmml" xref="S3.F3.4.m2.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m2.1d">{\star}</annotation></semantics></math>: the predicted minimum loss on the overall validation set.
</figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure ltx_align_floatright"><img src="/html/2403.16952/assets/x3.png" id="S3.F4.g1" class="ltx_graphics ltx_img_square" width="461" height="461" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
Prediction results on the domain losses and overall losses in the three-domain experiment. The domain losses are fitted with Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> and we obtain the total losses through explicit domain aggregation of Eqn.&nbsp;<a href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.
</figcaption>
</figure>
</section>
<section id="S3.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Findings</h4>

<div id="S3.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS0.Px2.p1.6" class="ltx_p">The results in Tab.&nbsp;<a href="#S3.T1" title="Table 1 ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> suggests both M1 and M4 gives reliable predictions while M4 has fewer coefficients.
Therefore we adopt M4</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.3" class="ltx_Math" alttext="L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)}" display="block"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml"><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.cmml"><msub id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.2.2.1.3.cmml"><mi id="S3.E7.m1.2.2.1.3.2" xref="S3.E7.m1.2.2.1.3.2.cmml">L</mi><mi id="S3.E7.m1.2.2.1.3.3" xref="S3.E7.m1.2.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.2.cmml">r</mi><mrow id="S3.E7.m1.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.3.cmml"><mn id="S3.E7.m1.2.2.1.1.1.1.3.2" xref="S3.E7.m1.2.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.1.1.3.1" xref="S3.E7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E7.m1.2.2.1.1.1.1.3.3" xref="S3.E7.m1.2.2.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.1.1.3.1a" xref="S3.E7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E7.m1.2.2.1.1.1.1.3.4" xref="S3.E7.m1.2.2.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.3" xref="S3.E7.m1.3.3.3.cmml">=</mo><mrow id="S3.E7.m1.3.3.2" xref="S3.E7.m1.3.3.2.cmml"><msub id="S3.E7.m1.3.3.2.3" xref="S3.E7.m1.3.3.2.3.cmml"><mi id="S3.E7.m1.3.3.2.3.2" xref="S3.E7.m1.3.3.2.3.2.cmml">c</mi><mi id="S3.E7.m1.3.3.2.3.3" xref="S3.E7.m1.3.3.2.3.3.cmml">i</mi></msub><mo id="S3.E7.m1.3.3.2.2" xref="S3.E7.m1.3.3.2.2.cmml">+</mo><mrow id="S3.E7.m1.3.3.2.1" xref="S3.E7.m1.3.3.2.1.cmml"><msub id="S3.E7.m1.3.3.2.1.3" xref="S3.E7.m1.3.3.2.1.3.cmml"><mi id="S3.E7.m1.3.3.2.1.3.2" xref="S3.E7.m1.3.3.2.1.3.2.cmml">k</mi><mi id="S3.E7.m1.3.3.2.1.3.3" xref="S3.E7.m1.3.3.2.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E7.m1.3.3.2.1.2" xref="S3.E7.m1.3.3.2.1.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.2.1.1.1" xref="S3.E7.m1.3.3.2.1.1.2.cmml"><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">exp</mi><mo id="S3.E7.m1.3.3.2.1.1.1a" xref="S3.E7.m1.3.3.2.1.1.2.cmml">⁡</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.2.cmml"><mo id="S3.E7.m1.3.3.2.1.1.1.1.2" xref="S3.E7.m1.3.3.2.1.1.2.cmml">(</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.cmml"><munderover id="S3.E7.m1.3.3.2.1.1.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E7.m1.3.3.2.1.1.1.1.3" xref="S3.E7.m1.3.3.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"><eq id="S3.E7.m1.3.3.3.cmml" xref="S3.E7.m1.3.3.3"></eq><apply id="S3.E7.m1.2.2.1.cmml" xref="S3.E7.m1.2.2.1"><times id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.2"></times><apply id="S3.E7.m1.2.2.1.3.cmml" xref="S3.E7.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.3.1.cmml" xref="S3.E7.m1.2.2.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.3.2.cmml" xref="S3.E7.m1.2.2.1.3.2">𝐿</ci><ci id="S3.E7.m1.2.2.1.3.3.cmml" xref="S3.E7.m1.2.2.1.3.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2">𝑟</ci><apply id="S3.E7.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3"><times id="S3.E7.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.1"></times><cn type="integer" id="S3.E7.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.2">1</cn><ci id="S3.E7.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3">…</ci><ci id="S3.E7.m1.2.2.1.1.1.1.3.4.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="S3.E7.m1.3.3.2.cmml" xref="S3.E7.m1.3.3.2"><plus id="S3.E7.m1.3.3.2.2.cmml" xref="S3.E7.m1.3.3.2.2"></plus><apply id="S3.E7.m1.3.3.2.3.cmml" xref="S3.E7.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.3.1.cmml" xref="S3.E7.m1.3.3.2.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.3.2.cmml" xref="S3.E7.m1.3.3.2.3.2">𝑐</ci><ci id="S3.E7.m1.3.3.2.3.3.cmml" xref="S3.E7.m1.3.3.2.3.3">𝑖</ci></apply><apply id="S3.E7.m1.3.3.2.1.cmml" xref="S3.E7.m1.3.3.2.1"><times id="S3.E7.m1.3.3.2.1.2.cmml" xref="S3.E7.m1.3.3.2.1.2"></times><apply id="S3.E7.m1.3.3.2.1.3.cmml" xref="S3.E7.m1.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.3.1.cmml" xref="S3.E7.m1.3.3.2.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.3.2.cmml" xref="S3.E7.m1.3.3.2.1.3.2">𝑘</ci><ci id="S3.E7.m1.3.3.2.1.3.3.cmml" xref="S3.E7.m1.3.3.2.1.3.3">𝑖</ci></apply><apply id="S3.E7.m1.3.3.2.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1"><exp id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"></exp><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1"><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2"></sum><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3"><eq id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2"><times id="S3.E7.m1.3.3.2.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.1"></times><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3"><times id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px2.p1.5" class="ltx_p">as the function forms of our data mixing law, where <math id="S3.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">L</mi><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝐿</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">L_{i}</annotation></semantics></math> is the validation loss on <math id="S3.SS2.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">i</annotation></semantics></math>-th validation domain, <math id="S3.SS2.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="r_{j}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml">r</mi><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2">𝑟</ci><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">r_{j}</annotation></semantics></math> is the proportion of the <math id="S3.SS2.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.1c">j</annotation></semantics></math>-th training domain, and <math id="S3.SS2.SSS0.Px2.p1.5.m5.3" class="ltx_Math" alttext="c_{i},k_{i},t_{ij}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.5.m5.3a"><mrow id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml"><msub id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.4" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.5" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m5.3b"><list id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3"><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2">𝑡</ci><apply id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3"><times id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1"></times><ci id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m5.3c">c_{i},k_{i},t_{ij}</annotation></semantics></math> are learnable parameters.
The fitting results are in Fig.&nbsp;<a href="#S3.F3" title="Figure 3 ‣ Setups ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and Fig.&nbsp;<a href="#S3.F4" title="Figure 4 ‣ Setups ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrates the prediction accuracy.
The results indicate that Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> fits the given samples well and estimates the unseen ones accurately.</p>
</div>
<div id="S3.SS2.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS0.Px2.p2.11" class="ltx_p">To provide more intuition, we discuss the meanings of the coefficients in Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. In general, <math id="S3.SS2.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="k_{i}>0" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1"><gt id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1"></gt><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">k_{i}&gt;0</annotation></semantics></math>, thus the exponential term is always positive and the prediction loss is strictly greater than the constant <math id="S3.SS2.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">c</annotation></semantics></math>.
Hereby, <math id="S3.SS2.SSS0.Px2.p2.3.m3.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.1a"><msub id="S3.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.1c">c_{i}</annotation></semantics></math> represents losses that are not reducible by adjusting the data mixture.
<math id="S3.SS2.SSS0.Px2.p2.4.m4.1" class="ltx_Math" alttext="t_{ij}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.4.m4.1a"><msub id="S3.SS2.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2">𝑡</ci><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3"><times id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.4.m4.1c">t_{ij}</annotation></semantics></math>, depending on both training domain <math id="S3.SS2.SSS0.Px2.p2.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.5.m5.1a"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.5.m5.1b"><ci id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.5.m5.1c">i</annotation></semantics></math> and validation domain <math id="S3.SS2.SSS0.Px2.p2.6.m6.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.6.m6.1a"><mi id="S3.SS2.SSS0.Px2.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.6.m6.1b"><ci id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.6.m6.1c">j</annotation></semantics></math>, shows the interaction between them.
A negative <math id="S3.SS2.SSS0.Px2.p2.7.m7.1" class="ltx_Math" alttext="t_{ij}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.7.m7.1a"><msub id="S3.SS2.SSS0.Px2.p2.7.m7.1.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.7.m7.1b"><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2">𝑡</ci><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3"><times id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.7.m7.1c">t_{ij}</annotation></semantics></math> indicates that training data of domain <math id="S3.SS2.SSS0.Px2.p2.8.m8.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.8.m8.1a"><mi id="S3.SS2.SSS0.Px2.p2.8.m8.1.1" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.8.m8.1b"><ci id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.8.m8.1c">j</annotation></semantics></math> helps reduce validation loss on domain <math id="S3.SS2.SSS0.Px2.p2.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.9.m9.1a"><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.9.m9.1b"><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.9.m9.1c">i</annotation></semantics></math> and vice versa.
Besides, rewriting the coefficient <math id="S3.SS2.SSS0.Px2.p2.10.m10.1" class="ltx_Math" alttext="k_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.10.m10.1a"><msub id="S3.SS2.SSS0.Px2.p2.10.m10.1.1" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.10.m10.1b"><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.10.m10.1c">k_{i}</annotation></semantics></math> into <math id="S3.SS2.SSS0.Px2.p2.11.m11.2" class="ltx_Math" alttext="\exp(\log k_{i})" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.11.m11.2a"><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.cmml">exp</mi><mo id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1a" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml">⁡</mo><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1a" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.cmml">⁡</mo><msub id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.3" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.11.m11.2b"><apply id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1"><exp id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1"></exp><apply id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1"><log id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1"></log><apply id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.11.m11.2c">\exp(\log k_{i})</annotation></semantics></math> makes it a bias term on the exponent which adjusts the aggregate effect of all training domains.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Predicting Losses of Any Validation Mixture</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.1" class="ltx_p">We further loosen constraints in Sec.&nbsp;<a href="#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> and Sec.&nbsp;<a href="#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> that the validation data are from one of the training domains.
We first consider the validation set to be a known composition of the training domains and then free this requirement for more general cases of arbitrary validation sets.
These correspond to the two strategies we fit the data mixing laws, which we elaborate on as follows.</p>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Explicit domain aggregation.</h4>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px1.p1.2" class="ltx_p">Considering a validation set made up of <math id="S3.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">K</annotation></semantics></math> domains with the proportions as <math id="S3.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="s_{1\dots K}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1a" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2">𝑠</ci><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3"><times id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1"></times><cn type="integer" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2">1</cn><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3">…</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">s_{1\dots K}</annotation></semantics></math>, the validation loss can be written into the weighted sum of domain losses.
Thanks to the discovery of Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we can apply the equation to predict domain losses herein given a training mixture.
Therefore, the functional relationship of the overall validation loss to the training mixture proportions expands into</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.2" class="ltx_Math" alttext="L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right]." display="block"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1a" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.3.4" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E8.m1.2.2.1.1.5" xref="S3.E8.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.1.2.cmml"><munderover id="S3.E8.m1.2.2.1.1.2.2" xref="S3.E8.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="S3.E8.m1.2.2.1.1.2.2.2.2" xref="S3.E8.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.2.2.2.3" xref="S3.E8.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.2.2.2.3.2" xref="S3.E8.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.1.1.2.2.2.3.1" xref="S3.E8.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.2.2.2.3.3" xref="S3.E8.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.2.2.3" xref="S3.E8.m1.2.2.1.1.2.2.3.cmml">K</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.2.1" xref="S3.E8.m1.2.2.1.1.2.1.cmml"><msub id="S3.E8.m1.2.2.1.1.2.1.3" xref="S3.E8.m1.2.2.1.1.2.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.3.2" xref="S3.E8.m1.2.2.1.1.2.1.3.2.cmml">s</mi><mi id="S3.E8.m1.2.2.1.1.2.1.3.3" xref="S3.E8.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.2" xref="S3.E8.m1.2.2.1.1.2.1.2.cmml">​</mo><msub id="S3.E8.m1.2.2.1.1.2.1.4" xref="S3.E8.m1.2.2.1.1.2.1.4.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.4.2" xref="S3.E8.m1.2.2.1.1.2.1.4.2.cmml">L</mi><mi id="S3.E8.m1.2.2.1.1.2.1.4.3" xref="S3.E8.m1.2.2.1.1.2.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.2a" xref="S3.E8.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.2.1.1.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.2.cmml">r</mi><mrow id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mn id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1a" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S3.E8.m1.2.2.1.1.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="S3.E8.m1.2.2.1.1.6" xref="S3.E8.m1.2.2.1.1.6.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.3.cmml"><munderover id="S3.E8.m1.2.2.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.2.cmml"><mo movablelimits="false" id="S3.E8.m1.2.2.1.1.3.2.2.2" xref="S3.E8.m1.2.2.1.1.3.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.3.2.2.3" xref="S3.E8.m1.2.2.1.1.3.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.2.2.3.2" xref="S3.E8.m1.2.2.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.1.1.3.2.2.3.1" xref="S3.E8.m1.2.2.1.1.3.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.3.2.2.3.3" xref="S3.E8.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.3.2.3" xref="S3.E8.m1.2.2.1.1.3.2.3.cmml">K</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.3.1" xref="S3.E8.m1.2.2.1.1.3.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.3" xref="S3.E8.m1.2.2.1.1.3.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.3.2" xref="S3.E8.m1.2.2.1.1.3.1.3.2.cmml">s</mi><mi id="S3.E8.m1.2.2.1.1.3.1.3.3" xref="S3.E8.m1.2.2.1.1.3.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.3.1.2" xref="S3.E8.m1.2.2.1.1.3.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.2.1.cmml">[</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2.cmml">c</mi><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.2.cmml">+</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml">k</mi><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">exp</mi><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1a" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E8.m1.2.2.1.2" xref="S3.E8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1"><and id="S3.E8.m1.2.2.1.1a.cmml" xref="S3.E8.m1.2.2.1"></and><apply id="S3.E8.m1.2.2.1.1b.cmml" xref="S3.E8.m1.2.2.1"><eq id="S3.E8.m1.2.2.1.1.5.cmml" xref="S3.E8.m1.2.2.1.1.5"></eq><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><times id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2"></times><ci id="S3.E8.m1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3">𝐿</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1"></times><cn type="integer" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.3">…</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="S3.E8.m1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2"><apply id="S3.E8.m1.2.2.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3"><eq id="S3.E8.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E8.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.2.3">𝐾</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1"><times id="S3.E8.m1.2.2.1.1.2.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.2"></times><apply id="S3.E8.m1.2.2.1.1.2.1.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3.2">𝑠</ci><ci id="S3.E8.m1.2.2.1.1.2.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.4.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.4.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.4.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4.2">𝐿</ci><ci id="S3.E8.m1.2.2.1.1.2.1.4.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.2">𝑟</ci><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3"><times id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1"></times><cn type="integer" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2">1</cn><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3">…</ci><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4">𝑀</ci></apply></apply></apply></apply></apply><apply id="S3.E8.m1.2.2.1.1c.cmml" xref="S3.E8.m1.2.2.1"><eq id="S3.E8.m1.2.2.1.1.6.cmml" xref="S3.E8.m1.2.2.1.1.6"></eq><share href="#S3.E8.m1.2.2.1.1.2.cmml" id="S3.E8.m1.2.2.1.1d.cmml" xref="S3.E8.m1.2.2.1"></share><apply id="S3.E8.m1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3"><apply id="S3.E8.m1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.3.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3"><eq id="S3.E8.m1.2.2.1.1.3.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.3.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E8.m1.2.2.1.1.3.2.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.3.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.2.3">𝐾</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1"><times id="S3.E8.m1.2.2.1.1.3.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.2"></times><apply id="S3.E8.m1.2.2.1.1.3.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3.2">𝑠</ci><ci id="S3.E8.m1.2.2.1.1.3.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.3.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.2">delimited-[]</csymbol><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1"><plus id="S3.E8.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.2"></plus><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2">𝑐</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1"><times id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2"></times><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1"><exp id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"></exp><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1"><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3"><eq id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2"><times id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3"><times id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px1.p1.3" class="ltx_p">Using Eqn.&nbsp;<a href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we can fit the loss on each validation domain <math id="S3.SS3.SSS0.Px1.p1.3.m1.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.3.m1.1a"><msub id="S3.SS3.SSS0.Px1.p1.3.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2.cmml">L</mi><mi id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2">𝐿</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m1.1c">L_{i}</annotation></semantics></math> and sum them up to obtain the prediction of overall loss.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Implicit domain aggregation.</h4>

<div id="S3.SS3.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px2.p1.3" class="ltx_p">A remaining limitation is that we still need to acquire the components of validation data <math id="S3.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="s_{1\dots K}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2">𝑠</ci><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1"></times><cn type="integer" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2">1</cn><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3">…</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">s_{1\dots K}</annotation></semantics></math> in advance.
This can be inconvenient if the validation set is collected separately from the training ones.
For instance, the validation data may come from real-world user queries that cover unknown compositions of various domains.
To remove the constraint on validation components, we assume that we can decompose the validation data into <math id="S3.SS3.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.1c">K</annotation></semantics></math> implicit domains whose losses are predictable with Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, and we treat their proportions in the validation data <math id="S3.SS3.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="s_{1\dots K}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2">𝑠</ci><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1"></times><cn type="integer" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2">1</cn><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3">…</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m3.1c">s_{1\dots K}</annotation></semantics></math> as learnable parameters.
This leads to the final form of our data mixing laws<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>We note that the final forms of our data mixing law resemble a multilayer perception (see the computation graph Fig.&nbsp;<a href="#A3.F10" title="Figure 10 ‣ Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>). We include further discussion and implementation details in Appendix&nbsp;<a href="#A3" title="Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</span></span></span>.
With this perspective, we fit a data mixing law with the overall losses end to end.</p>
</div>
<figure id="S3.F5" class="ltx_figure ltx_align_floatright"><img src="/html/2403.16952/assets/figs/5mix_end2end.png" id="S3.F5.g1" class="ltx_graphics ltx_img_landscape" width="598" height="299" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Prediction errors of the five-domain data mixing laws fitted with explicit and implicit domain aggregation.
<span id="S3.F5.5.1" class="ltx_text ltx_font_italic">Explicit domain aggregation</span>: we fit Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> for five domains respectively and sum them up according to their weight in the overall validation sets.
<span id="S3.F5.6.2" class="ltx_text ltx_font_italic">Implicit domain aggregation</span>: we fit the losses on overall validation with Eqn.&nbsp;<a href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, assuming different numbers of implicit domains <math id="S3.F5.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.F5.2.m1.1b"><mi id="S3.F5.2.m1.1.1" xref="S3.F5.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F5.2.m1.1c"><ci id="S3.F5.2.m1.1.1.cmml" xref="S3.F5.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.2.m1.1d">K</annotation></semantics></math> and treating the proportion of different implicit domains as learnable parameters.
</figcaption>
</figure>
<div id="S3.SS3.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px2.p2.1" class="ltx_p">Fig.&nbsp;<a href="#S3.F5" title="Figure 5 ‣ Implicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows our experiments where we train language models on the 5 coarse-grained domains of Pile<span id="footnote7" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>The Pile contains 22 fine-grained domains which are collected into five coarse-grained domains, i.e., academic, internet, prose, dialogues, and misc, where misc include Github and the DeepMind Mathematics Dataset which are symbolic content. We do not experiment on fine-grained domains for their limited number of tokens available.</span></span></span> and evaluate a validation set mixed with these 5 domains.
We compare the errors obtained by implicit domain aggregation with different numbers of implicit domains to those obtained by explicit domain aggregation.
We find that applying implicit domain aggregation and setting the number of implicit domains no smaller than the actual one (5 in the experimented case) results in lower errors than explicit domain aggregation.
Moreover, the error remains low as we set the number of implicit domains much larger.
This verifies the prediction accuracy of our implicit domain aggregation strategy for data mixing law and the number of implicit domains <math id="S3.SS3.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.1.m1.1c">K</annotation></semantics></math> can be a large number without careful tuning<span id="footnote8" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span>We set <math id="footnote8.m1.1" class="ltx_Math" alttext="K=30" display="inline"><semantics id="footnote8.m1.1b"><mrow id="footnote8.m1.1.1" xref="footnote8.m1.1.1.cmml"><mi id="footnote8.m1.1.1.2" xref="footnote8.m1.1.1.2.cmml">K</mi><mo id="footnote8.m1.1.1.1" xref="footnote8.m1.1.1.1.cmml">=</mo><mn id="footnote8.m1.1.1.3" xref="footnote8.m1.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote8.m1.1c"><apply id="footnote8.m1.1.1.cmml" xref="footnote8.m1.1.1"><eq id="footnote8.m1.1.1.1.cmml" xref="footnote8.m1.1.1.1"></eq><ci id="footnote8.m1.1.1.2.cmml" xref="footnote8.m1.1.1.2">𝐾</ci><cn type="integer" id="footnote8.m1.1.1.3.cmml" xref="footnote8.m1.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m1.1d">K=30</annotation></semantics></math> if not stated in the rest of this paper.</span></span></span>.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Nested scaling laws predict losses trained on various mixtures using only small-scale experiments</h2>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> A pipeline to predict losses of different mixture proportions on large models trained on massive data through small-scale training</figcaption>
<div id="alg1.3" class="ltx_listing ltx_align_center ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> Validation data <math id="alg1.l1.m1.1" class="ltx_Math" alttext="D_{val}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">D</mi><mrow id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.3.1" xref="alg1.l1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.3.1a" xref="alg1.l1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.3.4" xref="alg1.l1.m1.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝐷</ci><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><times id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.1"></times><ci id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2">𝑣</ci><ci id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">𝑎</ci><ci id="alg1.l1.m1.1.1.3.4.cmml" xref="alg1.l1.m1.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">D_{val}</annotation></semantics></math>, training data of <math id="alg1.l1.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">M</annotation></semantics></math> domains <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\{D_{m}\}_{m=1}^{M}" display="inline"><semantics id="alg1.l1.m3.1a"><msubsup id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mrow id="alg1.l1.m3.1.1.1.1.1" xref="alg1.l1.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m3.1.1.1.1.1.2" xref="alg1.l1.m3.1.1.1.1.2.cmml">{</mo><msub id="alg1.l1.m3.1.1.1.1.1.1" xref="alg1.l1.m3.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m3.1.1.1.1.1.1.2" xref="alg1.l1.m3.1.1.1.1.1.1.2.cmml">D</mi><mi id="alg1.l1.m3.1.1.1.1.1.1.3" xref="alg1.l1.m3.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="alg1.l1.m3.1.1.1.1.1.3" xref="alg1.l1.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m3.1.1.1.3" xref="alg1.l1.m3.1.1.1.3.cmml"><mi id="alg1.l1.m3.1.1.1.3.2" xref="alg1.l1.m3.1.1.1.3.2.cmml">m</mi><mo id="alg1.l1.m3.1.1.1.3.1" xref="alg1.l1.m3.1.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m3.1.1.1.3.3" xref="alg1.l1.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1">superscript</csymbol><apply id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.2.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><set id="alg1.l1.m3.1.1.1.1.2.cmml" xref="alg1.l1.m3.1.1.1.1.1"><apply id="alg1.l1.m3.1.1.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m3.1.1.1.1.1.1.2">𝐷</ci><ci id="alg1.l1.m3.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m3.1.1.1.1.1.1.3">𝑚</ci></apply></set><apply id="alg1.l1.m3.1.1.1.3.cmml" xref="alg1.l1.m3.1.1.1.3"><eq id="alg1.l1.m3.1.1.1.3.1.cmml" xref="alg1.l1.m3.1.1.1.3.1"></eq><ci id="alg1.l1.m3.1.1.1.3.2.cmml" xref="alg1.l1.m3.1.1.1.3.2">𝑚</ci><cn type="integer" id="alg1.l1.m3.1.1.1.3.3.cmml" xref="alg1.l1.m3.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\{D_{m}\}_{m=1}^{M}</annotation></semantics></math>, target training steps <math id="alg1.l1.m4.1" class="ltx_Math" alttext="S_{target}" display="inline"><semantics id="alg1.l1.m4.1a"><msub id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">S</mi><mrow id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml"><mi id="alg1.l1.m4.1.1.3.2" xref="alg1.l1.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.3" xref="alg1.l1.m4.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1a" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.4" xref="alg1.l1.m4.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1b" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.5" xref="alg1.l1.m4.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1c" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.6" xref="alg1.l1.m4.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1d" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.7" xref="alg1.l1.m4.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝑆</ci><apply id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3"><times id="alg1.l1.m4.1.1.3.1.cmml" xref="alg1.l1.m4.1.1.3.1"></times><ci id="alg1.l1.m4.1.1.3.2.cmml" xref="alg1.l1.m4.1.1.3.2">𝑡</ci><ci id="alg1.l1.m4.1.1.3.3.cmml" xref="alg1.l1.m4.1.1.3.3">𝑎</ci><ci id="alg1.l1.m4.1.1.3.4.cmml" xref="alg1.l1.m4.1.1.3.4">𝑟</ci><ci id="alg1.l1.m4.1.1.3.5.cmml" xref="alg1.l1.m4.1.1.3.5">𝑔</ci><ci id="alg1.l1.m4.1.1.3.6.cmml" xref="alg1.l1.m4.1.1.3.6">𝑒</ci><ci id="alg1.l1.m4.1.1.3.7.cmml" xref="alg1.l1.m4.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">S_{target}</annotation></semantics></math>, target model size <math id="alg1.l1.m5.1" class="ltx_Math" alttext="N_{target}" display="inline"><semantics id="alg1.l1.m5.1a"><msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">N</mi><mrow id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml"><mi id="alg1.l1.m5.1.1.3.2" xref="alg1.l1.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.3" xref="alg1.l1.m5.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1a" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.4" xref="alg1.l1.m5.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1b" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.5" xref="alg1.l1.m5.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1c" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.6" xref="alg1.l1.m5.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1d" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.7" xref="alg1.l1.m5.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">subscript</csymbol><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">𝑁</ci><apply id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3"><times id="alg1.l1.m5.1.1.3.1.cmml" xref="alg1.l1.m5.1.1.3.1"></times><ci id="alg1.l1.m5.1.1.3.2.cmml" xref="alg1.l1.m5.1.1.3.2">𝑡</ci><ci id="alg1.l1.m5.1.1.3.3.cmml" xref="alg1.l1.m5.1.1.3.3">𝑎</ci><ci id="alg1.l1.m5.1.1.3.4.cmml" xref="alg1.l1.m5.1.1.3.4">𝑟</ci><ci id="alg1.l1.m5.1.1.3.5.cmml" xref="alg1.l1.m5.1.1.3.5">𝑔</ci><ci id="alg1.l1.m5.1.1.3.6.cmml" xref="alg1.l1.m5.1.1.3.6">𝑒</ci><ci id="alg1.l1.m5.1.1.3.7.cmml" xref="alg1.l1.m5.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">N_{target}</annotation></semantics></math>, target mixture to predict <math id="alg1.l1.m6.1" class="ltx_Math" alttext="\bm{r}_{target}" display="inline"><semantics id="alg1.l1.m6.1a"><msub id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml"><mi id="alg1.l1.m6.1.1.2" xref="alg1.l1.m6.1.1.2.cmml">𝒓</mi><mrow id="alg1.l1.m6.1.1.3" xref="alg1.l1.m6.1.1.3.cmml"><mi id="alg1.l1.m6.1.1.3.2" xref="alg1.l1.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.3" xref="alg1.l1.m6.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1a" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.4" xref="alg1.l1.m6.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1b" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.5" xref="alg1.l1.m6.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1c" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.6" xref="alg1.l1.m6.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1d" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.7" xref="alg1.l1.m6.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><apply id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1"><csymbol cd="ambiguous" id="alg1.l1.m6.1.1.1.cmml" xref="alg1.l1.m6.1.1">subscript</csymbol><ci id="alg1.l1.m6.1.1.2.cmml" xref="alg1.l1.m6.1.1.2">𝒓</ci><apply id="alg1.l1.m6.1.1.3.cmml" xref="alg1.l1.m6.1.1.3"><times id="alg1.l1.m6.1.1.3.1.cmml" xref="alg1.l1.m6.1.1.3.1"></times><ci id="alg1.l1.m6.1.1.3.2.cmml" xref="alg1.l1.m6.1.1.3.2">𝑡</ci><ci id="alg1.l1.m6.1.1.3.3.cmml" xref="alg1.l1.m6.1.1.3.3">𝑎</ci><ci id="alg1.l1.m6.1.1.3.4.cmml" xref="alg1.l1.m6.1.1.3.4">𝑟</ci><ci id="alg1.l1.m6.1.1.3.5.cmml" xref="alg1.l1.m6.1.1.3.5">𝑔</ci><ci id="alg1.l1.m6.1.1.3.6.cmml" xref="alg1.l1.m6.1.1.3.6">𝑒</ci><ci id="alg1.l1.m6.1.1.3.7.cmml" xref="alg1.l1.m6.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">\bm{r}_{target}</annotation></semantics></math>, training steps to fit the step laws <math id="alg1.l1.m7.1" class="ltx_Math" alttext="S_{0}" display="inline"><semantics id="alg1.l1.m7.1a"><msub id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml"><mi id="alg1.l1.m7.1.1.2" xref="alg1.l1.m7.1.1.2.cmml">S</mi><mn id="alg1.l1.m7.1.1.3" xref="alg1.l1.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><apply id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1"><csymbol cd="ambiguous" id="alg1.l1.m7.1.1.1.cmml" xref="alg1.l1.m7.1.1">subscript</csymbol><ci id="alg1.l1.m7.1.1.2.cmml" xref="alg1.l1.m7.1.1.2">𝑆</ci><cn type="integer" id="alg1.l1.m7.1.1.3.cmml" xref="alg1.l1.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">S_{0}</annotation></semantics></math>, model sizes to fit the size laws <math id="alg1.l1.m8.1" class="ltx_Math" alttext="\{N_{i}\}" display="inline"><semantics id="alg1.l1.m8.1a"><mrow id="alg1.l1.m8.1.1.1" xref="alg1.l1.m8.1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m8.1.1.1.2" xref="alg1.l1.m8.1.1.2.cmml">{</mo><msub id="alg1.l1.m8.1.1.1.1" xref="alg1.l1.m8.1.1.1.1.cmml"><mi id="alg1.l1.m8.1.1.1.1.2" xref="alg1.l1.m8.1.1.1.1.2.cmml">N</mi><mi id="alg1.l1.m8.1.1.1.1.3" xref="alg1.l1.m8.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l1.m8.1.1.1.3" xref="alg1.l1.m8.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m8.1b"><set id="alg1.l1.m8.1.1.2.cmml" xref="alg1.l1.m8.1.1.1"><apply id="alg1.l1.m8.1.1.1.1.cmml" xref="alg1.l1.m8.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m8.1.1.1.1.1.cmml" xref="alg1.l1.m8.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m8.1.1.1.1.2.cmml" xref="alg1.l1.m8.1.1.1.1.2">𝑁</ci><ci id="alg1.l1.m8.1.1.1.1.3.cmml" xref="alg1.l1.m8.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m8.1c">\{N_{i}\}</annotation></semantics></math>, and <math id="alg1.l1.m9.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l1.m9.1a"><mi id="alg1.l1.m9.1.1" xref="alg1.l1.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m9.1b"><ci id="alg1.l1.m9.1.1.cmml" xref="alg1.l1.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m9.1c">N</annotation></semantics></math> data mixtures <math id="alg1.l1.m10.1" class="ltx_Math" alttext="\{\bm{r}_{i}\}_{i=1}^{N}" display="inline"><semantics id="alg1.l1.m10.1a"><msubsup id="alg1.l1.m10.1.1" xref="alg1.l1.m10.1.1.cmml"><mrow id="alg1.l1.m10.1.1.1.1.1" xref="alg1.l1.m10.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m10.1.1.1.1.1.2" xref="alg1.l1.m10.1.1.1.1.2.cmml">{</mo><msub id="alg1.l1.m10.1.1.1.1.1.1" xref="alg1.l1.m10.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m10.1.1.1.1.1.1.2" xref="alg1.l1.m10.1.1.1.1.1.1.2.cmml">𝒓</mi><mi id="alg1.l1.m10.1.1.1.1.1.1.3" xref="alg1.l1.m10.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l1.m10.1.1.1.1.1.3" xref="alg1.l1.m10.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m10.1.1.1.3" xref="alg1.l1.m10.1.1.1.3.cmml"><mi id="alg1.l1.m10.1.1.1.3.2" xref="alg1.l1.m10.1.1.1.3.2.cmml">i</mi><mo id="alg1.l1.m10.1.1.1.3.1" xref="alg1.l1.m10.1.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m10.1.1.1.3.3" xref="alg1.l1.m10.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m10.1.1.3" xref="alg1.l1.m10.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m10.1b"><apply id="alg1.l1.m10.1.1.cmml" xref="alg1.l1.m10.1.1"><csymbol cd="ambiguous" id="alg1.l1.m10.1.1.2.cmml" xref="alg1.l1.m10.1.1">superscript</csymbol><apply id="alg1.l1.m10.1.1.1.cmml" xref="alg1.l1.m10.1.1"><csymbol cd="ambiguous" id="alg1.l1.m10.1.1.1.2.cmml" xref="alg1.l1.m10.1.1">subscript</csymbol><set id="alg1.l1.m10.1.1.1.1.2.cmml" xref="alg1.l1.m10.1.1.1.1.1"><apply id="alg1.l1.m10.1.1.1.1.1.1.cmml" xref="alg1.l1.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m10.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m10.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m10.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m10.1.1.1.1.1.1.2">𝒓</ci><ci id="alg1.l1.m10.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m10.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="alg1.l1.m10.1.1.1.3.cmml" xref="alg1.l1.m10.1.1.1.3"><eq id="alg1.l1.m10.1.1.1.3.1.cmml" xref="alg1.l1.m10.1.1.1.3.1"></eq><ci id="alg1.l1.m10.1.1.1.3.2.cmml" xref="alg1.l1.m10.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l1.m10.1.1.1.3.3.cmml" xref="alg1.l1.m10.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m10.1.1.3.cmml" xref="alg1.l1.m10.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m10.1c">\{\bm{r}_{i}\}_{i=1}^{N}</annotation></semantics></math> to fit.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><span id="alg1.l2.1" class="ltx_text ltx_font_bold">Output:</span> The validation loss of a <math id="alg1.l2.m1.1" class="ltx_Math" alttext="N_{target}" display="inline"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">N</mi><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1a" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.4" xref="alg1.l2.m1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1b" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.5" xref="alg1.l2.m1.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1c" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.6" xref="alg1.l2.m1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1d" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.7" xref="alg1.l2.m1.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑁</ci><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><times id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"></times><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">𝑡</ci><ci id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">𝑎</ci><ci id="alg1.l2.m1.1.1.3.4.cmml" xref="alg1.l2.m1.1.1.3.4">𝑟</ci><ci id="alg1.l2.m1.1.1.3.5.cmml" xref="alg1.l2.m1.1.1.3.5">𝑔</ci><ci id="alg1.l2.m1.1.1.3.6.cmml" xref="alg1.l2.m1.1.1.3.6">𝑒</ci><ci id="alg1.l2.m1.1.1.3.7.cmml" xref="alg1.l2.m1.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">N_{target}</annotation></semantics></math> model trained for <math id="alg1.l2.m2.1" class="ltx_Math" alttext="S_{target}" display="inline"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">S</mi><mrow id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml"><mi id="alg1.l2.m2.1.1.3.2" xref="alg1.l2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.3" xref="alg1.l2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1a" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.4" xref="alg1.l2.m2.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1b" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.5" xref="alg1.l2.m2.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1c" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.6" xref="alg1.l2.m2.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1d" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.7" xref="alg1.l2.m2.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑆</ci><apply id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3"><times id="alg1.l2.m2.1.1.3.1.cmml" xref="alg1.l2.m2.1.1.3.1"></times><ci id="alg1.l2.m2.1.1.3.2.cmml" xref="alg1.l2.m2.1.1.3.2">𝑡</ci><ci id="alg1.l2.m2.1.1.3.3.cmml" xref="alg1.l2.m2.1.1.3.3">𝑎</ci><ci id="alg1.l2.m2.1.1.3.4.cmml" xref="alg1.l2.m2.1.1.3.4">𝑟</ci><ci id="alg1.l2.m2.1.1.3.5.cmml" xref="alg1.l2.m2.1.1.3.5">𝑔</ci><ci id="alg1.l2.m2.1.1.3.6.cmml" xref="alg1.l2.m2.1.1.3.6">𝑒</ci><ci id="alg1.l2.m2.1.1.3.7.cmml" xref="alg1.l2.m2.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">S_{target}</annotation></semantics></math> steps on mixture <math id="alg1.l2.m3.1" class="ltx_Math" alttext="\bm{r}_{target}" display="inline"><semantics id="alg1.l2.m3.1a"><msub id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">𝒓</mi><mrow id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml"><mi id="alg1.l2.m3.1.1.3.2" xref="alg1.l2.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.3" xref="alg1.l2.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1a" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.4" xref="alg1.l2.m3.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1b" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.5" xref="alg1.l2.m3.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1c" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.6" xref="alg1.l2.m3.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1d" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.7" xref="alg1.l2.m3.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">𝒓</ci><apply id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3"><times id="alg1.l2.m3.1.1.3.1.cmml" xref="alg1.l2.m3.1.1.3.1"></times><ci id="alg1.l2.m3.1.1.3.2.cmml" xref="alg1.l2.m3.1.1.3.2">𝑡</ci><ci id="alg1.l2.m3.1.1.3.3.cmml" xref="alg1.l2.m3.1.1.3.3">𝑎</ci><ci id="alg1.l2.m3.1.1.3.4.cmml" xref="alg1.l2.m3.1.1.3.4">𝑟</ci><ci id="alg1.l2.m3.1.1.3.5.cmml" xref="alg1.l2.m3.1.1.3.5">𝑔</ci><ci id="alg1.l2.m3.1.1.3.6.cmml" xref="alg1.l2.m3.1.1.3.6">𝑒</ci><ci id="alg1.l2.m3.1.1.3.7.cmml" xref="alg1.l2.m3.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\bm{r}_{target}</annotation></semantics></math>, i.e., <math id="alg1.l2.m4.3" class="ltx_Math" alttext="L(N_{target},S_{target},\bm{r}_{target})" display="inline"><semantics id="alg1.l2.m4.3a"><mrow id="alg1.l2.m4.3.3" xref="alg1.l2.m4.3.3.cmml"><mi id="alg1.l2.m4.3.3.5" xref="alg1.l2.m4.3.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.4" xref="alg1.l2.m4.3.3.4.cmml">​</mo><mrow id="alg1.l2.m4.3.3.3.3" xref="alg1.l2.m4.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l2.m4.3.3.3.3.4" xref="alg1.l2.m4.3.3.3.4.cmml">(</mo><msub id="alg1.l2.m4.1.1.1.1.1" xref="alg1.l2.m4.1.1.1.1.1.cmml"><mi id="alg1.l2.m4.1.1.1.1.1.2" xref="alg1.l2.m4.1.1.1.1.1.2.cmml">N</mi><mrow id="alg1.l2.m4.1.1.1.1.1.3" xref="alg1.l2.m4.1.1.1.1.1.3.cmml"><mi id="alg1.l2.m4.1.1.1.1.1.3.2" xref="alg1.l2.m4.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.3" xref="alg1.l2.m4.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1a" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.4" xref="alg1.l2.m4.1.1.1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1b" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.5" xref="alg1.l2.m4.1.1.1.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1c" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.6" xref="alg1.l2.m4.1.1.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1d" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.7" xref="alg1.l2.m4.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l2.m4.3.3.3.3.5" xref="alg1.l2.m4.3.3.3.4.cmml">,</mo><msub id="alg1.l2.m4.2.2.2.2.2" xref="alg1.l2.m4.2.2.2.2.2.cmml"><mi id="alg1.l2.m4.2.2.2.2.2.2" xref="alg1.l2.m4.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l2.m4.2.2.2.2.2.3" xref="alg1.l2.m4.2.2.2.2.2.3.cmml"><mi id="alg1.l2.m4.2.2.2.2.2.3.2" xref="alg1.l2.m4.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.3" xref="alg1.l2.m4.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1a" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.4" xref="alg1.l2.m4.2.2.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1b" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.5" xref="alg1.l2.m4.2.2.2.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1c" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.6" xref="alg1.l2.m4.2.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1d" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.7" xref="alg1.l2.m4.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l2.m4.3.3.3.3.6" xref="alg1.l2.m4.3.3.3.4.cmml">,</mo><msub id="alg1.l2.m4.3.3.3.3.3" xref="alg1.l2.m4.3.3.3.3.3.cmml"><mi id="alg1.l2.m4.3.3.3.3.3.2" xref="alg1.l2.m4.3.3.3.3.3.2.cmml">𝒓</mi><mrow id="alg1.l2.m4.3.3.3.3.3.3" xref="alg1.l2.m4.3.3.3.3.3.3.cmml"><mi id="alg1.l2.m4.3.3.3.3.3.3.2" xref="alg1.l2.m4.3.3.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.3" xref="alg1.l2.m4.3.3.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1a" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.4" xref="alg1.l2.m4.3.3.3.3.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1b" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.5" xref="alg1.l2.m4.3.3.3.3.3.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1c" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.6" xref="alg1.l2.m4.3.3.3.3.3.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1d" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.7" xref="alg1.l2.m4.3.3.3.3.3.3.7.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg1.l2.m4.3.3.3.3.7" xref="alg1.l2.m4.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m4.3b"><apply id="alg1.l2.m4.3.3.cmml" xref="alg1.l2.m4.3.3"><times id="alg1.l2.m4.3.3.4.cmml" xref="alg1.l2.m4.3.3.4"></times><ci id="alg1.l2.m4.3.3.5.cmml" xref="alg1.l2.m4.3.3.5">𝐿</ci><vector id="alg1.l2.m4.3.3.3.4.cmml" xref="alg1.l2.m4.3.3.3.3"><apply id="alg1.l2.m4.1.1.1.1.1.cmml" xref="alg1.l2.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m4.1.1.1.1.1.1.cmml" xref="alg1.l2.m4.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m4.1.1.1.1.1.2.cmml" xref="alg1.l2.m4.1.1.1.1.1.2">𝑁</ci><apply id="alg1.l2.m4.1.1.1.1.1.3.cmml" xref="alg1.l2.m4.1.1.1.1.1.3"><times id="alg1.l2.m4.1.1.1.1.1.3.1.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.1"></times><ci id="alg1.l2.m4.1.1.1.1.1.3.2.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.3.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.4.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.5.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.5">𝑔</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.6.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.7.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l2.m4.2.2.2.2.2.cmml" xref="alg1.l2.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m4.2.2.2.2.2.1.cmml" xref="alg1.l2.m4.2.2.2.2.2">subscript</csymbol><ci id="alg1.l2.m4.2.2.2.2.2.2.cmml" xref="alg1.l2.m4.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l2.m4.2.2.2.2.2.3.cmml" xref="alg1.l2.m4.2.2.2.2.2.3"><times id="alg1.l2.m4.2.2.2.2.2.3.1.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.1"></times><ci id="alg1.l2.m4.2.2.2.2.2.3.2.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.3.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.4.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.5.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.6.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.7.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l2.m4.3.3.3.3.3.cmml" xref="alg1.l2.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l2.m4.3.3.3.3.3.1.cmml" xref="alg1.l2.m4.3.3.3.3.3">subscript</csymbol><ci id="alg1.l2.m4.3.3.3.3.3.2.cmml" xref="alg1.l2.m4.3.3.3.3.3.2">𝒓</ci><apply id="alg1.l2.m4.3.3.3.3.3.3.cmml" xref="alg1.l2.m4.3.3.3.3.3.3"><times id="alg1.l2.m4.3.3.3.3.3.3.1.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.1"></times><ci id="alg1.l2.m4.3.3.3.3.3.3.2.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.2">𝑡</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.3.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.3">𝑎</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.4.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.4">𝑟</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.5.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.5">𝑔</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.6.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.6">𝑒</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.7.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.7">𝑡</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m4.3c">L(N_{target},S_{target},\bm{r}_{target})</annotation></semantics></math>.

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span>&nbsp;Each mixture <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\bm{r}_{i}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝒓</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝒓</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\bm{r}_{i}</annotation></semantics></math>&nbsp;<span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span>&nbsp;Each model size <math id="alg1.l4.m1.1" class="ltx_Math" alttext="N_{j}" display="inline"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">N</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑁</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">N_{j}</annotation></semantics></math>&nbsp;<span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Train model of size <math id="alg1.l5.m1.1" class="ltx_Math" alttext="N_{j}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">N</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑁</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">N_{j}</annotation></semantics></math> on mixture <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\bm{r}_{i}" display="inline"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">𝒓</mi><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝒓</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\bm{r}_{i}</annotation></semantics></math> for <math id="alg1.l5.m3.1" class="ltx_Math" alttext="S_{0}" display="inline"><semantics id="alg1.l5.m3.1a"><msub id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><mi id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">S</mi><mn id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1">subscript</csymbol><ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">𝑆</ci><cn type="integer" id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">S_{0}</annotation></semantics></math> steps to obtain <math id="alg1.l5.m4.1" class="ltx_math_unparsed" alttext="L(N_{j},S<S_{0},\bm{r}_{i})" display="inline"><semantics id="alg1.l5.m4.1a"><mrow id="alg1.l5.m4.1b"><mi id="alg1.l5.m4.1.2">L</mi><mrow id="alg1.l5.m4.1.3"><mo stretchy="false" id="alg1.l5.m4.1.3.1">(</mo><msub id="alg1.l5.m4.1.3.2"><mi id="alg1.l5.m4.1.3.2.2">N</mi><mi id="alg1.l5.m4.1.3.2.3">j</mi></msub><mo id="alg1.l5.m4.1.3.3">,</mo><mi id="alg1.l5.m4.1.1">S</mi><mo id="alg1.l5.m4.1.3.4">&lt;</mo><msub id="alg1.l5.m4.1.3.5"><mi id="alg1.l5.m4.1.3.5.2">S</mi><mn id="alg1.l5.m4.1.3.5.3">0</mn></msub><mo id="alg1.l5.m4.1.3.6">,</mo><msub id="alg1.l5.m4.1.3.7"><mi id="alg1.l5.m4.1.3.7.2">𝒓</mi><mi id="alg1.l5.m4.1.3.7.3">i</mi></msub><mo stretchy="false" id="alg1.l5.m4.1.3.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l5.m4.1c">L(N_{j},S&lt;S_{0},\bm{r}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fit training step law to predict <math id="alg1.l6.m1.3" class="ltx_Math" alttext="L(N_{j},S_{target},\bm{r}_{i})" display="inline"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml"><mi id="alg1.l6.m1.3.3.5" xref="alg1.l6.m1.3.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.3.3.4" xref="alg1.l6.m1.3.3.4.cmml">​</mo><mrow id="alg1.l6.m1.3.3.3.3" xref="alg1.l6.m1.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l6.m1.3.3.3.3.4" xref="alg1.l6.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.2.cmml">N</mi><mi id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l6.m1.3.3.3.3.5" xref="alg1.l6.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l6.m1.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.3.2" xref="alg1.l6.m1.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.3" xref="alg1.l6.m1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1a" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.4" xref="alg1.l6.m1.2.2.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1b" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.5" xref="alg1.l6.m1.2.2.2.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1c" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.6" xref="alg1.l6.m1.2.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1d" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.7" xref="alg1.l6.m1.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l6.m1.3.3.3.3.6" xref="alg1.l6.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l6.m1.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.cmml"><mi id="alg1.l6.m1.3.3.3.3.3.2" xref="alg1.l6.m1.3.3.3.3.3.2.cmml">𝒓</mi><mi id="alg1.l6.m1.3.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l6.m1.3.3.3.3.7" xref="alg1.l6.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3"><times id="alg1.l6.m1.3.3.4.cmml" xref="alg1.l6.m1.3.3.4"></times><ci id="alg1.l6.m1.3.3.5.cmml" xref="alg1.l6.m1.3.3.5">𝐿</ci><vector id="alg1.l6.m1.3.3.3.4.cmml" xref="alg1.l6.m1.3.3.3.3"><apply id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2">𝑁</ci><ci id="alg1.l6.m1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l6.m1.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3"><times id="alg1.l6.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l6.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.7.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l6.m1.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.3.3.1.cmml" xref="alg1.l6.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l6.m1.3.3.3.3.3.2.cmml" xref="alg1.l6.m1.3.3.3.3.3.2">𝒓</ci><ci id="alg1.l6.m1.3.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">L(N_{j},S_{target},\bm{r}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg1.l7.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg1.l7.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fit model size scaling law to predict the loss <math id="alg1.l8.m1.3" class="ltx_Math" alttext="L(N_{target},S_{target},\bm{r}_{i})" display="inline"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml"><mi id="alg1.l8.m1.3.3.5" xref="alg1.l8.m1.3.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.3.3.4" xref="alg1.l8.m1.3.3.4.cmml">​</mo><mrow id="alg1.l8.m1.3.3.3.3" xref="alg1.l8.m1.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l8.m1.3.3.3.3.4" xref="alg1.l8.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.2.cmml">N</mi><mrow id="alg1.l8.m1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1a" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.4" xref="alg1.l8.m1.1.1.1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1b" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.5" xref="alg1.l8.m1.1.1.1.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1c" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.6" xref="alg1.l8.m1.1.1.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1d" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.7" xref="alg1.l8.m1.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l8.m1.3.3.3.3.5" xref="alg1.l8.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.3.2" xref="alg1.l8.m1.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.3" xref="alg1.l8.m1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1a" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.4" xref="alg1.l8.m1.2.2.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1b" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.5" xref="alg1.l8.m1.2.2.2.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1c" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.6" xref="alg1.l8.m1.2.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1d" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.7" xref="alg1.l8.m1.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l8.m1.3.3.3.3.6" xref="alg1.l8.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l8.m1.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.cmml"><mi id="alg1.l8.m1.3.3.3.3.3.2" xref="alg1.l8.m1.3.3.3.3.3.2.cmml">𝒓</mi><mi id="alg1.l8.m1.3.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l8.m1.3.3.3.3.7" xref="alg1.l8.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.3b"><apply id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3"><times id="alg1.l8.m1.3.3.4.cmml" xref="alg1.l8.m1.3.3.4"></times><ci id="alg1.l8.m1.3.3.5.cmml" xref="alg1.l8.m1.3.3.5">𝐿</ci><vector id="alg1.l8.m1.3.3.3.4.cmml" xref="alg1.l8.m1.3.3.3.3"><apply id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.2">𝑁</ci><apply id="alg1.l8.m1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3"><times id="alg1.l8.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.1"></times><ci id="alg1.l8.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.4.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.5.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.5">𝑔</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.6.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.7.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l8.m1.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l8.m1.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3"><times id="alg1.l8.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l8.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.7.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l8.m1.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.3.3.1.cmml" xref="alg1.l8.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l8.m1.3.3.3.3.3.2.cmml" xref="alg1.l8.m1.3.3.3.3.3.2">𝒓</ci><ci id="alg1.l8.m1.3.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">L(N_{target},S_{target},\bm{r}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span><span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>Fit the data mixing law to predict <math id="alg1.l10.m1.3" class="ltx_Math" alttext="L(N_{target},S_{target},\bm{r}_{target})" display="inline"><semantics id="alg1.l10.m1.3a"><mrow id="alg1.l10.m1.3.3" xref="alg1.l10.m1.3.3.cmml"><mi id="alg1.l10.m1.3.3.5" xref="alg1.l10.m1.3.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.4" xref="alg1.l10.m1.3.3.4.cmml">​</mo><mrow id="alg1.l10.m1.3.3.3.3" xref="alg1.l10.m1.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l10.m1.3.3.3.3.4" xref="alg1.l10.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.2.cmml">N</mi><mrow id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.3.2" xref="alg1.l10.m1.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.3" xref="alg1.l10.m1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1a" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.4" xref="alg1.l10.m1.1.1.1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1b" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.5" xref="alg1.l10.m1.1.1.1.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1c" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.6" xref="alg1.l10.m1.1.1.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1d" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.7" xref="alg1.l10.m1.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l10.m1.3.3.3.3.5" xref="alg1.l10.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l10.m1.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.3.2" xref="alg1.l10.m1.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.3" xref="alg1.l10.m1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1a" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.4" xref="alg1.l10.m1.2.2.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1b" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.5" xref="alg1.l10.m1.2.2.2.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1c" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.6" xref="alg1.l10.m1.2.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1d" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.7" xref="alg1.l10.m1.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l10.m1.3.3.3.3.6" xref="alg1.l10.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l10.m1.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.cmml"><mi id="alg1.l10.m1.3.3.3.3.3.2" xref="alg1.l10.m1.3.3.3.3.3.2.cmml">𝒓</mi><mrow id="alg1.l10.m1.3.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l10.m1.3.3.3.3.3.3.2" xref="alg1.l10.m1.3.3.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1a" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.4" xref="alg1.l10.m1.3.3.3.3.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1b" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.5" xref="alg1.l10.m1.3.3.3.3.3.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1c" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.6" xref="alg1.l10.m1.3.3.3.3.3.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1d" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.7" xref="alg1.l10.m1.3.3.3.3.3.3.7.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg1.l10.m1.3.3.3.3.7" xref="alg1.l10.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.3b"><apply id="alg1.l10.m1.3.3.cmml" xref="alg1.l10.m1.3.3"><times id="alg1.l10.m1.3.3.4.cmml" xref="alg1.l10.m1.3.3.4"></times><ci id="alg1.l10.m1.3.3.5.cmml" xref="alg1.l10.m1.3.3.5">𝐿</ci><vector id="alg1.l10.m1.3.3.3.4.cmml" xref="alg1.l10.m1.3.3.3.3"><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2">𝑁</ci><apply id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3"><times id="alg1.l10.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.1"></times><ci id="alg1.l10.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.4.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.5.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.5">𝑔</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.6.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.7.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l10.m1.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l10.m1.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3"><times id="alg1.l10.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l10.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.7.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l10.m1.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.3.3.3.1.cmml" xref="alg1.l10.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l10.m1.3.3.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.3.3.2">𝒓</ci><apply id="alg1.l10.m1.3.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3.3"><times id="alg1.l10.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.1"></times><ci id="alg1.l10.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.2">𝑡</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.3">𝑎</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.4.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.4">𝑟</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.5.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.5">𝑔</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.6.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.6">𝑒</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.7.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.7">𝑡</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.3c">L(N_{target},S_{target},\bm{r}_{target})</annotation></semantics></math>

</div>
</div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>A Pipeline for Loss Predictions</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">While data mixing laws enable us to predict the performance of models trained on unseen mixtures, the requirement to fit the laws involves training multiple models across diverse mixtures with model sizes and token counts identical to the target ones.
Furthermore, we must repeat this process for each target model size and training dataset<span id="footnote9" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>An idea is to transfer the optimized training mixture on small models trained with few tokens to the training of large models and large volumes of training data.
Nevertheless, in Appendix&nbsp;<a href="#A1" title="Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>, we show that the partial order of data mixture concerning model performance varies as the model size and number of trained tokens change.
Therefore, the optimal mixture at experimented scales can be suboptimal at the target scale.
</span></span></span>.
This results in expensive costs thus hindering the practical value of our data mixing laws.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.2" class="ltx_p">We thus wonder whether we can obtain the losses of different mixture proportions without training at large scales.
Fortunately, this idea gains endorsement from existing experiences that verify the impressive extrapolation of scaling laws of training steps and model sizes.
In particular, <cite class="ltx_cite ltx_citemacro_citet">OpenAI (<a href="#bib.bib48" title="" class="ltx_ref">2023</a>)</cite> predicts the loss of the target model with merely <math id="S4.SS1.p2.1.m1.2" class="ltx_math_unparsed" alttext="1,000\times" display="inline"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2b"><mn id="S4.SS1.p2.1.m1.1.1">1</mn><mo id="S4.SS1.p2.1.m1.2.3">,</mo><mn id="S4.SS1.p2.1.m1.2.2">000</mn><mo lspace="0.222em" id="S4.SS1.p2.1.m1.2.4">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">1,000\times</annotation></semantics></math>–<math id="S4.SS1.p2.2.m2.2" class="ltx_math_unparsed" alttext="10,000\times" display="inline"><semantics id="S4.SS1.p2.2.m2.2a"><mrow id="S4.SS1.p2.2.m2.2b"><mn id="S4.SS1.p2.2.m2.1.1">10</mn><mo id="S4.SS1.p2.2.m2.2.3">,</mo><mn id="S4.SS1.p2.2.m2.2.2">000</mn><mo lspace="0.222em" id="S4.SS1.p2.2.m2.2.4">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.2c">10,000\times</annotation></semantics></math> less compute.
As a consequence, we can train small models with few training steps on different mixtures, and fitting scaling laws on them to estimate the losses of the target model size and the target number of training steps.
We can then use the predicted losses to fit a data mixing law and search for the optimal mixture.
The proposed pipeline is illustrated in Fig.&nbsp;<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> with details depicted in Alg.&nbsp;<a href="#alg1" title="Algorithm 1 ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p">We note that the nested use of scaling laws is still not a widely adopted strategy in existing literature to the best of our knowledge.
Most studies try connecting newly found scaling laws to existing ones by incorporating variables into the latter&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hashimoto, <a href="#bib.bib28" title="" class="ltx_ref">2021</a>; Frantar et&nbsp;al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>; Aghajanyan et&nbsp;al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite>.
Although unifying of different scaling laws is attractive, the added complexity to the interaction among multiple variables makes identifying the function form extremely challenging and hard to verify.
Pioneering efforts that derive scaling laws with multiple concerning factors (model sizes and the numbers of training data)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2020</a>; Hoffmann et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite> make assumptions upon the theory of error decomposition&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Harville, <a href="#bib.bib27" title="" class="ltx_ref">1985</a>; Domingos, <a href="#bib.bib15" title="" class="ltx_ref">2000</a>)</cite> but their outcomes are still not widely verified in large-scale practice.
From this perspective, we consider that our nested use of scaling laws offers a new technical routine of using scaling laws, which circumvents the huge challenge of complicating existing laws, making the discovery and application of scaling laws more accessible.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiment</h3>

<figure id="S4.F6" class="ltx_figure"><img src="/html/2403.16952/assets/figs/optimize_loss_2.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="176" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The validation perplexity on the Pile validation set for 1B models trained on the default mixture and the optimized mixture of RedPajama for 100B tokens.
Our optimized mixture achieves the performance of the default mixture only using 0.73 of the original number of training steps and eventually achieves a performance comparable to a default mixture trained with 1.48 times more tokens (estimated by the scaling law of training steps, shown as the dashed line).
The specific mixture proportions are in the right table.
</figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">We verify the effect of our pipeline with an experiment to minimize the validation loss of a 1B model trained on 100B tokens.</p>
</div>
<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Setups.</h4>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS0.Px1.p1.1" class="ltx_p">We train our models on the mixture of RedPajama and validate the validation set of the Pile to mimic the scenario where validation data are collected separately from the training data.
To fit the scaling laws of training steps and model sizes, we train a series of 70M, 160M, 305M, and 410M models for 30B tokens.
For all the models, we set the batch size as 1M tokens thus translating into 100k steps for the 1B models and 30k steps for small models.
We apply a cosine learning rate decay with a warmup of 2k steps which decays to 0.1 of the maximum learning rate at the 100k-th steps.</p>
</div>
<div id="S4.SS2.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS0.Px1.p2.1" class="ltx_p">To reach low prediction errors with a limited number of experiment runs, we select the mixtures for experimentation by leveraging the fact that mixture proportion terms are represented as exponential functions within our data mixing law.
Specifically, we enumerate candidate mixtures by double-diminishing the proportion for each training domain, starting from the maximum available one that does not use up all the domain tokens.
In this way, the losses of each (implicit) validation domain are distributed evenly.
We then sample 40 mixtures from all the candidates and train the smallest 70M models.
We resample groups of 20 mixtures from them to fit the data mixing law and select the group that reaches minimum prediction errors on all 40 samples as our final set of mixtures to run our pipeline.
For more details, please refer to Appendix&nbsp;<a href="#A2.SS2" title="B.2 Fitting Mixture Laws ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.2</span></a>.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4>

<figure id="S4.F7" class="ltx_figure ltx_align_floatright"><img src="/html/2403.16952/assets/figs/predictions.png" id="S4.F7.g1" class="ltx_graphics ltx_img_landscape" width="598" height="449" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>
Results of our loss prediction pipelines for the overall validation loss and domain losses.
Fitting data are from 70M to 410M models trained for 30B tokens, while the extrapolated points are from the default and optimized mixture for 1B models and 100B tokens.
</figcaption>
</figure>
<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS0.Px2.p1.1" class="ltx_p">Fig.&nbsp;<a href="#S4.F6" title="Figure 6 ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the default mixture of RedPajama used in <cite class="ltx_cite ltx_citemacro_citet">Touvron et&nbsp;al. (<a href="#bib.bib56" title="" class="ltx_ref">2023a</a>)</cite> and the optimized mixture obtained from Alg.&nbsp;<a href="#alg1" title="Algorithm 1 ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> with their performance on the validation data.
The loss predictions are in Fig.&nbsp;<a href="#S4.F7" title="Figure 7 ‣ Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.
We find that:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">The pipeline optimizes performance effectively.</span> The model trained on the optimized mixture can achieve a performance comparable to the one trained on the default mixture with only 73% steps. It eventually attains a performance that requires 48% more steps if trained using the default mixture. This indicates the effectiveness of our pipeline in mixture optimization.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para ltx_noindent">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Predictions provide references for the balance of model capabilities.</span> Prediction results in Fig.&nbsp;<a href="#S4.F7" title="Figure 7 ‣ Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> demonstrate plausible reference on the relative scale of losses on both the overall validation data and different validation domains. While the overall loss helps optimize the overall performance, losses on different domains show model capabilities in various aspects. We suppose that this facilitates further mixture curating for the nuanced balance of model capabilities.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We are also interested in applying our data mixing laws to continual pretraining, which shares the same paradigm as pertaining but begins the model with pretrained parameters instead of random initialization.
Generally, continual pretraining is a common technique to enhance existing pretrained models.
It injects up-to-date knowledge into the model, avoiding performance degradation due to distribution shifts&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gururangan et&nbsp;al., <a href="#bib.bib25" title="" class="ltx_ref">2020</a>; Xiong et&nbsp;al., <a href="#bib.bib65" title="" class="ltx_ref">2023</a>)</cite>.
In addition, researchers also apply continual pretraining to reuse existing model parameters to build models of a different architecture&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Komatsuzaki et&nbsp;al., <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<figure id="S5.F8" class="ltx_figure"><img src="/html/2403.16952/assets/figs/continue_all.png" id="S5.F8.g1" class="ltx_graphics ltx_img_landscape" width="598" height="249" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Loss predictions and the training curve of continual pretraining Pythia-70M on a mixture of the Pile and python code. (A) Loss prediction on the Pile; (B) Loss prediction on python; (C) training curves with losses on the Pile; (D) training curves with losses on python. We predict final losses with Eqn.&nbsp;<a href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. The law accurately finds the critical mixture proportion that maintains model performance on the original domain (i.e., the Pile).
</figcaption>
</figure>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p">We experiment on a typical scenario of continual pretraining, where we train the model on the mixture of original pretraining data and upcoming data of a target domain to enhance.
For instance, we continually pretrain Pythia-70M models with a mixture of the Pile and Python codes, where the former is the original pretraining data of the base model.
To verify whether our data mixing laws apply to continual pretraining, we train the models for 10B tokens on 4 mixtures and fit the Eqn.&nbsp;<a href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> on losses of the Pile and python codes.
Results in Fig.&nbsp;<a href="#S5.F8" title="Figure 8 ‣ 5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> confirm that Eqn.&nbsp;<a href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> fits into the losses of continual pretraining.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p">During continual pretraining, a too-large proportion of the target data can hurt the performance of the original data.
A representative mixture optimization target is to maintain the general-purpose ability (looses on the Pile) unchanged.
To this end, using the fitted data mixing laws, we predict the <span id="S5.p3.1.1" class="ltx_text ltx_font_italic">critical proportion</span> leading to the same loss as before continual pretraining.
Fig.&nbsp;<a href="#S5.F8" title="Figure 8 ‣ 5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> demonstrates the success of our prediction where the proportion we find results in similar performance compared to the model before continual pretraining while gaining improvement in the target domain.</p>
</div>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.1" class="ltx_p"><span id="S5.p4.1.1" class="ltx_text ltx_font_bold">Remarks.</span> We suggest continual pretraining is significant for its connection to the design of data schedules&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Albalak et&nbsp;al., <a href="#bib.bib3" title="" class="ltx_ref">2023</a>; Chen et&nbsp;al., <a href="#bib.bib13" title="" class="ltx_ref">2024b</a>)</cite>.
Usually, continual pretraining applies to a pretrained model, while it is natural to further continually pretrain the continual pretrained models, i.e., multi-stage pretraining&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a href="#bib.bib13" title="" class="ltx_ref">2024b</a>)</cite>.
In each stage, the mixture proportions or even the domain components of training data can be different.
This becomes a dynamic data schedule as the number of training stages approaches the infinite limit.
Therefore, the successful application of our data mixing laws on continual training signifies a promising prospect for using it to design dynamic data schedules, a more comprehensive data curating paradigm.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2>

<section id="S6.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Curating pretraining data for LLMs.</h4>

<div id="S6.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S6.SS0.SSS0.Px1.p1.1" class="ltx_p">Training massive transformer architecture on trillions of tokens, a.k.a. pretraining, is the primary step to building modern large language models that exhibit impressive human-like generalist abilities&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Brown et&nbsp;al., <a href="#bib.bib10" title="" class="ltx_ref">2020</a>; OpenAI, <a href="#bib.bib48" title="" class="ltx_ref">2023</a>; Jiang et&nbsp;al., <a href="#bib.bib36" title="" class="ltx_ref">2023</a>; Touvron et&nbsp;al., <a href="#bib.bib57" title="" class="ltx_ref">2023b</a>)</cite>).
It takes up most of the computation resources for model training and researchers believe it endows almost all the knowledge in LLMs&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhou et&nbsp;al., <a href="#bib.bib67" title="" class="ltx_ref">2024</a>)</cite>.
Such critical impact motivates the development of data curating strategies to reduce computation costs and enhance knowledge&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Longpre et&nbsp;al., <a href="#bib.bib42" title="" class="ltx_ref">2023</a>)</cite>.
The efforts can be categorized into two steps.
The first step focuses on obtaining a high-quality training dataset.
A typical procedure includes selecting data sources to constitute different domains, deduplication, and the most intricate filtering&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wenzek et&nbsp;al., <a href="#bib.bib62" title="" class="ltx_ref">2019</a>; Penedo et&nbsp;al., <a href="#bib.bib49" title="" class="ltx_ref">2023</a>)</cite>.
A mass of endeavors in existing practice has involved multifarious filters, scoring the documents with from superficial features on characters&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a href="#bib.bib51" title="" class="ltx_ref">2021</a>; Xie et&nbsp;al., <a href="#bib.bib64" title="" class="ltx_ref">2024b</a>; Raffel et&nbsp;al., <a href="#bib.bib52" title="" class="ltx_ref">2020</a>)</cite> to semantics including similarity to the high-quality reference corpus&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wenzek et&nbsp;al., <a href="#bib.bib62" title="" class="ltx_ref">2019</a>)</cite> and toxicity&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Longpre et&nbsp;al., <a href="#bib.bib42" title="" class="ltx_ref">2023</a>; Friedl, <a href="#bib.bib21" title="" class="ltx_ref">2023</a>)</cite>.
With a dataset on hold, the second step aims to make the best use of it.
This includes tuning the data mixture&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Du et&nbsp;al., <a href="#bib.bib17" title="" class="ltx_ref">2022</a>; Touvron et&nbsp;al., <a href="#bib.bib56" title="" class="ltx_ref">2023a</a>; Xie et&nbsp;al., <a href="#bib.bib63" title="" class="ltx_ref">2024a</a>)</cite> and devising data schedules&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mindermann et&nbsp;al., <a href="#bib.bib46" title="" class="ltx_ref">2022</a>; Albalak et&nbsp;al., <a href="#bib.bib3" title="" class="ltx_ref">2023</a>; Chen et&nbsp;al., <a href="#bib.bib13" title="" class="ltx_ref">2024b</a>; Fan et&nbsp;al., <a href="#bib.bib18" title="" class="ltx_ref">2024</a>)</cite>.
Our work is among those tune data mixtures and our extension to continue pretraining signifies our prospect of guiding the schedule design.
Different from existing attempts that rely on intuition or qualitative targets, our study seeks a quantitative solution.</p>
</div>
</section>
<section id="S6.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Scaling laws</h4>

<div id="S6.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS0.SSS0.Px2.p1.1" class="ltx_p">are functional relationships between the properties of interests (e.g., test loss or other performance metrics) and the scales of controllable factors regarding the optimization process or architecture (e.g., model sizes and numbers of training samples)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Villalobos, <a href="#bib.bib61" title="" class="ltx_ref">2023</a>)</cite>.
Along with the development of machine learning, characterizing scaling behaviors has garnered great research interest under the context of learning theories, bounding the generalization error given the number of training samples in the form of power laws&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vapnik &amp; Chervonenkis, <a href="#bib.bib59" title="" class="ltx_ref">1971</a>; Valiant, <a href="#bib.bib58" title="" class="ltx_ref">1984</a>; Haussler, <a href="#bib.bib29" title="" class="ltx_ref">1988</a>; Amari et&nbsp;al., <a href="#bib.bib4" title="" class="ltx_ref">1992</a>)</cite>.
Nevertheless, overly strict assumptions hinder their practical applications.
In recent years, statistical estimation on scaling gained fast progress for deep neural networks and spawns the introduction of scaling laws.
<cite class="ltx_cite ltx_citemacro_citet">Hestness et&nbsp;al. (<a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite> pioneers the trend and demonstrates power-law generalization error scaling across a breadth of factors but the power-law exponents differ from previous theoretical analysis.
<cite class="ltx_cite ltx_citemacro_citet">Kaplan et&nbsp;al. (<a href="#bib.bib37" title="" class="ltx_ref">2020</a>); Hoffmann et&nbsp;al. (<a href="#bib.bib33" title="" class="ltx_ref">2022</a>); Henighan et&nbsp;al. (<a href="#bib.bib30" title="" class="ltx_ref">2020</a>)</cite> conduct more comprehensive investigations on Transformer architecture&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a href="#bib.bib60" title="" class="ltx_ref">2017</a>)</cite>, further highlighting the power-law relationship on test loss regarding model sizes, the amount of training data and computation across orders of magnitudes.
These findings foretell the performance gain with scaling quantitatively and guide the trade-off between larger models and more training data, directing to the later development of large language models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Brown et&nbsp;al., <a href="#bib.bib10" title="" class="ltx_ref">2020</a>; Hoffmann et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>; OpenAI, <a href="#bib.bib48" title="" class="ltx_ref">2023</a>)</cite>.
Lately, progressive investigations propose amendments to existing scaling laws&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Caballero et&nbsp;al., <a href="#bib.bib11" title="" class="ltx_ref">2022</a>; Alabdulmohsin et&nbsp;al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>)</cite>, seeking theoretical explanations on the empirical formulas&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Bahri et&nbsp;al. (<a href="#bib.bib5" title="" class="ltx_ref">2021</a>); Hutter (<a href="#bib.bib35" title="" class="ltx_ref">2021</a>); Michaud et&nbsp;al. (<a href="#bib.bib45" title="" class="ltx_ref">2024</a>)</cite>, and exploring the functional relationships in broader scenarios&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hernandez et&nbsp;al., <a href="#bib.bib31" title="" class="ltx_ref">2021</a>; Frantar et&nbsp;al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>; Liu et&nbsp;al., <a href="#bib.bib41" title="" class="ltx_ref">2023</a>)</cite>.
The most relevant study to ours is <cite class="ltx_cite ltx_citemacro_citet">Hashimoto (<a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite> which explores performance prediction under multiple data sources but is limited to small-scaled supervised learning tasks.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussions</h2>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p id="S7.p1.1" class="ltx_p">In this work, we discover the quantitative predictability of model losses regarding the mixture proportions of training data, which boils down to the data mixing laws.
Our findings cover training data from two domains to multiple domains, and validation data from a single domain to unknown compositions.
Using data mixing laws allows practitioners to quantitatively estimate the model performance on unseen mixture proportions before the actual training, facilitating the tuning of ideal mixture proportions.
We further propose the nested use of scaling laws of training steps, model sizes, and data mixture to make predictions with only experiments at small scales, which enables the reuse of existing experiments and reduces the computation costs.
Experimental results suggest that our method effectively optimizes the data mixture, which leads to better performance in pretraining and maintaining the original abilities of pretrained models in continual pretraining.</p>
</div>
<div id="S7.p2" class="ltx_para ltx_noindent">
<p id="S7.p2.1" class="ltx_p">Admittedly, how data mixtures affect model training is far from fully understood.
Our study makes preliminary attempts at a quantitative framework while leaving several limitations.</p>
</div>
<section id="S7.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On the clarification of domains.</h4>

<div id="S7.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S7.SS0.SSS0.Px1.p1.1" class="ltx_p">The concept of domains is not well-defined.
In this paper, similar to related studies&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xie et&nbsp;al., <a href="#bib.bib63" title="" class="ltx_ref">2024a</a>; Chen et&nbsp;al., <a href="#bib.bib13" title="" class="ltx_ref">2024b</a>; Albalak et&nbsp;al., <a href="#bib.bib3" title="" class="ltx_ref">2023</a>; Fan et&nbsp;al., <a href="#bib.bib18" title="" class="ltx_ref">2024</a>)</cite>, we directly adopt the predefined domains in the open-source training data.
Nevertheless, we suppose that more operationally defined training domains, e.g., clustering&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gururangan et&nbsp;al., <a href="#bib.bib26" title="" class="ltx_ref">2023</a>; Shao et&nbsp;al., <a href="#bib.bib53" title="" class="ltx_ref">2024</a>)</cite>, could further benefit the prediction accuracy of data mixing laws and the performance of outcome models.
For the validation domains, our implicit domain aggregation method obviates the necessity of explicitly aligning validation data with training domains.
This requirement is often encountered, given that validation data typically comprises trustworthy datasets rather than mere compilations from training domains.
However, we acknowledge that implicit domain aggregation may be less interpretable compared to the explicit approach and may raise concerns regarding its accuracy, as elaborated subsequently.</p>
</div>
</section>
<section id="S7.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On the error analyses.</h4>

<div id="S7.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S7.SS0.SSS0.Px2.p1.1" class="ltx_p">Leveraging scaling laws requires experiments to provide samples to fit the functions.
Consequently, it requires careful design of experiments&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mead, <a href="#bib.bib44" title="" class="ltx_ref">1990</a>)</cite> to decide the number of fitting samples to experiment with and how to distribute these samples to reduce prediction errors to the greatest extent.
In this study, we decide the number according to our affordable budget and leverage the simple rule that evenly distributes the losses of the data samples but considering more theoretically justified rules should be necessary.
Additionally, our nested use of scaling laws can introduce errors in each step.
Therefore, further analyses to mitigate the error accumulation are also demanding.
In Fig.&nbsp;<a href="#S4.F7" title="Figure 7 ‣ Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we notice our predictions are smaller than the actual loss, which we attribute to the underestimation from the step laws and model size laws we fit.
Further practical experience demystifies the technical details of scaling laws&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Su et&nbsp;al., <a href="#bib.bib54" title="" class="ltx_ref">2024</a>)</cite> can help eliminate the errors.</p>
</div>
</section>
<section id="S7.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On joint laws of multiple factors.</h4>

<div id="S7.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S7.SS0.SSS0.Px3.p1.1" class="ltx_p">We propose the nested use of scaling laws for circumventing the difficulties in finding a joint law of training steps, model sizes, and mixture proportions.
Although we can predict the losses with our pipeline, a joint law unveils clear synergies of different factors.
For instance, previous studies indicate the power-law exponent in the scaling laws of model sizes and training data are insensitive to training and validation data&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hestness et&nbsp;al., <a href="#bib.bib32" title="" class="ltx_ref">2017</a>; Kaplan et&nbsp;al., <a href="#bib.bib37" title="" class="ltx_ref">2020</a>; Hashimoto, <a href="#bib.bib28" title="" class="ltx_ref">2021</a>; Hoffmann et&nbsp;al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>; Frantar et&nbsp;al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>)</cite>.
Figuring out their joint laws with data mixture can further confirm this surmise.
Moreover, a joint law also implements coefficient-sharing of separate laws, reducing the number of required fitting samples.</p>
</div>
</section>
<section id="S7.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On dynamic data curating.</h4>

<div id="S7.SS0.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="S7.SS0.SSS0.Px4.p1.1" class="ltx_p">Our study presents a pipeline to decide on a group of fixed mixture proportions for pretraining.
More sophisticated data curating can include dynamic proportions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Albalak et&nbsp;al., <a href="#bib.bib3" title="" class="ltx_ref">2023</a>)</cite> and even a curriculum that changes data domains&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a href="#bib.bib13" title="" class="ltx_ref">2024b</a>)</cite>.
The application of our data mixing laws in continual pretraining (Sec.&nbsp;<a href="#S5" title="5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) implies the prospect of extending our findings to these settings.
On top of this, we believe that it is promising to incorporate further analysis to pursue a dynamic data mixing law.</p>
</div>
</section>
<section id="S7.SS0.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On theoretical understandings.</h4>

<div id="S7.SS0.SSS0.Px5.p1" class="ltx_para ltx_noindent">
<p id="S7.SS0.SSS0.Px5.p1.1" class="ltx_p">Our data mixing laws, similar to most scaling laws, are empirical findings.
We believe a theoretical understanding of the training dynamics that form the laws provides a more solid justification.
A potential perspective is understanding the target of tuning mixture proportion through gradient estimation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a href="#bib.bib24" title="" class="ltx_ref">2024</a>; Gu et&nbsp;al., <a href="#bib.bib23" title="" class="ltx_ref">2024</a>)</cite>.
Specifically, the mixture proportions weight data from different domains, whose effect boils down to the weight for the linear combination of gradients from different domains during training.
This perspective turns the target of tuning mixture proportions into finding an ideal gradient direction&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gu et&nbsp;al., <a href="#bib.bib23" title="" class="ltx_ref">2024</a>)</cite> and the relationship between data samples is formalized with their gradient directions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a href="#bib.bib24" title="" class="ltx_ref">2024</a>)</cite>.</p>
</div>
<div id="S7.SS0.SSS0.Px5.p2" class="ltx_para ltx_noindent">
<p id="S7.SS0.SSS0.Px5.p2.1" class="ltx_p">To sum up, we initiate an investigation into quantitative prediction methods for pretraining data curation.
With its increasing focus on data engineering, we hope our exploration facilitates further quantitative studies and theoretical analyses in this research area.</p>
</div>
</section>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<p id="Sx1.p1.1" class="ltx_p">The computations in this research were performed using the CFFF platform of Fudan University.
We thank Botian Jiang and Shiduo Zhang for their insightful discussions.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aghajanyan et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Armen Aghajanyan, Lili Yu, Alexis Conneau, Wei-Ning Hsu, Karen Hambardzumyan, Susan Zhang, Stephen Roller, Naman Goyal, Omer Levy, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Scaling laws for generative mixed-modal language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2301.03728</em>, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alabdulmohsin et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Ibrahim&nbsp;M Alabdulmohsin, Behnam Neyshabur, and Xiaohua Zhai.

</span>
<span class="ltx_bibblock">Revisiting neural scaling laws in language and vision.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:22300–22312, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Albalak et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Alon Albalak, Liangming Pan, Colin Raffel, and William&nbsp;Yang Wang.

</span>
<span class="ltx_bibblock">Efficient online data mixing for language model pre-training.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2312.02406</em>, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amari et&nbsp;al. (1992)</span>
<span class="ltx_bibblock">
Shun-ichi Amari, Naotake Fujita, and Shigeru Shinomoto.

</span>
<span class="ltx_bibblock">Four types of learning curves.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Neural Computation</em>, 4(4):605–618, 1992.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahri et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Yasaman Bahri, Ethan Dyer, Jared Kaplan, Jaehoon Lee, and Utkarsh Sharma.

</span>
<span class="ltx_bibblock">Explaining neural scaling laws.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.06701</em>, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu&nbsp;Han, Fei Huang, et&nbsp;al.

</span>
<span class="ltx_bibblock">Qwen technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.16609</em>, 2023.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bi et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Xiao Bi, Deli Chen, Guanting Chen, Shanhuang Chen, Damai Dai, Chengqi Deng, Honghui Ding, Kai Dong, Qiushi Du, Zhe Fu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Deepseek llm: Scaling open-source language models with longtermism.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.02954</em>, 2024.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Stella Biderman, Hailey Schoelkopf, Quentin&nbsp;Gregory Anthony, Herbie Bradley, Kyle O’Brien, Eric Hallahan, Mohammad&nbsp;Aflah Khan, Shivanshu Purohit, USVSN&nbsp;Sai Prashanth, Edward Raff, et&nbsp;al.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp; 2397–2430. PMLR, 2023.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bishop (2006)</span>
<span class="ltx_bibblock">
Christopher Bishop.

</span>
<span class="ltx_bibblock">Pattern recognition and machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Springer google schola</em>, 2:5–43, 2006.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared&nbsp;D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et&nbsp;al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:1877–1901, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caballero et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Ethan Caballero, Kshitij Gupta, Irina Rish, and David Krueger.

</span>
<span class="ltx_bibblock">Broken neural scaling laws.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.14891</em>, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024a)</span>
<span class="ltx_bibblock">
Daoyuan Chen, Yilun Huang, Zhijian Ma, Hesen Chen, Xuchen Pan, Ce&nbsp;Ge, Dawei Gao, Yuexiang Xie, Zhaoyang Liu, Jinyang Gao, Yaliang Li, Bolin Ding, and Jingren Zhou.

</span>
<span class="ltx_bibblock">Data-juicer: A one-stop data processing system for large language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">International Conference on Management of Data</em>, 2024a.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024b)</span>
<span class="ltx_bibblock">
Mayee Chen, Nicholas Roberts, Kush Bhatia, Jue Wang, Ce&nbsp;Zhang, Frederic Sala, and Christopher Ré.

</span>
<span class="ltx_bibblock">Skill-it! a data-driven skills framework for understanding and training language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024b.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Doddapaneni et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Sumanth Doddapaneni, Gowtham Ramesh, Mitesh&nbsp;M Khapra, Anoop Kunchukuttan, and Pratyush Kumar.

</span>
<span class="ltx_bibblock">A primer on pretrained multilingual language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.00676</em>, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Domingos (2000)</span>
<span class="ltx_bibblock">
Pedro Domingos.

</span>
<span class="ltx_bibblock">A unified bias-variance decomposition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of 17th international conference on machine learning</em>, pp.&nbsp; 231–238. Morgan Kaufmann Stanford, 2000.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Drucker (1997)</span>
<span class="ltx_bibblock">
Harris Drucker.

</span>
<span class="ltx_bibblock">Improving regressors using boosting techniques.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Icml</em>, volume&nbsp;97, pp.&nbsp; e115. Citeseer, 1997.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Nan Du, Yanping Huang, Andrew&nbsp;M Dai, Simon Tong, Dmitry Lepikhin, Yuanzhong Xu, Maxim Krikun, Yanqi Zhou, Adams&nbsp;Wei Yu, Orhan Firat, et&nbsp;al.

</span>
<span class="ltx_bibblock">Glam: Efficient scaling of language models with mixture-of-experts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp; 5547–5569. PMLR, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Simin Fan, Matteo Pagliardini, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Doge: Domain reweighting with generalization estimation, 2024.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Elias Frantar, Carlos Riquelme, Neil Houlsby, Dan Alistarh, and Utku Evci.

</span>
<span class="ltx_bibblock">Scaling laws for sparsely-connected foundation models.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.08520</em>, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">French (1999)</span>
<span class="ltx_bibblock">
Robert&nbsp;M French.

</span>
<span class="ltx_bibblock">Catastrophic forgetting in connectionist networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Trends in cognitive sciences</em>, 3(4):128–135, 1999.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Friedl (2023)</span>
<span class="ltx_bibblock">
Paul Friedl.

</span>
<span class="ltx_bibblock">Dis/similarities in the design and development of legal and algorithmic normative systems: the case of perspective api.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Law, Innovation and Technology</em>, 15(1):25–59, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Leo Gao, Stella Biderman, Sid Black, Laurence Golding, Travis Hoppe, Charles Foster, Jason Phang, Horace He, Anish Thite, Noa Nabeshima, et&nbsp;al.

</span>
<span class="ltx_bibblock">The pile: An 800gb dataset of diverse text for language modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2101.00027</em>, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Yuxian Gu, Li&nbsp;Dong, Yaru Hao, Qingxiu Dong, Minlie Huang, and Furu Wei.

</span>
<span class="ltx_bibblock">Towards optimal learning of language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.17759</em>, 2024.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Shangmin Guo, Yi&nbsp;Ren, Stefano&nbsp;V Albrecht, and Kenny Smith.

</span>
<span class="ltx_bibblock">Sample relationship from learning dynamics matters for generalisation.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.08808</em>, 2024.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gururangan et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Suchin Gururangan, Ana Marasović, Swabha Swayamdipta, Kyle Lo, Iz&nbsp;Beltagy, Doug Downey, and Noah&nbsp;A Smith.

</span>
<span class="ltx_bibblock">Don’t stop pretraining: Adapt language models to domains and tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2004.10964</em>, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gururangan et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Suchin Gururangan, Margaret Li, Mike Lewis, Weijia Shi, Tim Althoff, Noah&nbsp;A Smith, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Scaling expert language models with unsupervised domain discovery.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.14177</em>, 2023.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harville (1985)</span>
<span class="ltx_bibblock">
David&nbsp;A Harville.

</span>
<span class="ltx_bibblock">Decomposition of prediction error.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Journal of the American Statistical Association</em>, 80(389):132–138, 1985.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hashimoto (2021)</span>
<span class="ltx_bibblock">
Tatsunori Hashimoto.

</span>
<span class="ltx_bibblock">Model performance scaling with multiple data sources.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp; 4107–4116. PMLR, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haussler (1988)</span>
<span class="ltx_bibblock">
David Haussler.

</span>
<span class="ltx_bibblock">Quantifying inductive bias: Ai learning algorithms and valiant’s learning framework.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence</em>, 36(2):177–221, 1988.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Henighan et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Tom Henighan, Jared Kaplan, Mor Katz, Mark Chen, Christopher Hesse, Jacob Jackson, Heewoo Jun, Tom&nbsp;B Brown, Prafulla Dhariwal, Scott Gray, et&nbsp;al.

</span>
<span class="ltx_bibblock">Scaling laws for autoregressive generative modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.14701</em>, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hernandez et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Danny Hernandez, Jared Kaplan, Tom Henighan, and Sam McCandlish.

</span>
<span class="ltx_bibblock">Scaling laws for transfer.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.01293</em>, 2021.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hestness et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
Joel Hestness, Sharan Narang, Newsha Ardalani, Gregory Diamos, Heewoo Jun, Hassan Kianinejad, Md&nbsp;Mostofa&nbsp;Ali Patwary, Yang Yang, and Yanqi Zhou.

</span>
<span class="ltx_bibblock">Deep learning scaling is predictable, empirically.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1712.00409</em>, 2017.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Jordan Hoffmann, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza Rutherford, Diego de&nbsp;Las Casas, Lisa&nbsp;Anne Hendricks, Johannes Welbl, Aidan Clark, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training compute-optimal large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.15556</em>, 2022.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hornik et&nbsp;al. (1989)</span>
<span class="ltx_bibblock">
Kurt Hornik, Maxwell Stinchcombe, and Halbert White.

</span>
<span class="ltx_bibblock">Multilayer feedforward networks are universal approximators.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Neural networks</em>, 2(5):359–366, 1989.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hutter (2021)</span>
<span class="ltx_bibblock">
Marcus Hutter.

</span>
<span class="ltx_bibblock">Learning curve theory.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.04074</em>, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Albert&nbsp;Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra&nbsp;Singh Chaplot, Diego de&nbsp;las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, et&nbsp;al.

</span>
<span class="ltx_bibblock">Mistral 7b.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.06825</em>, 2023.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaplan et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Jared Kaplan, Sam McCandlish, Tom Henighan, Tom&nbsp;B Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei.

</span>
<span class="ltx_bibblock">Scaling laws for neural language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2001.08361</em>, 2020.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel Veness, Guillaume Desjardins, Andrei&nbsp;A Rusu, Kieran Milan, John Quan, Tiago Ramalho, Agnieszka Grabska-Barwinska, et&nbsp;al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the national academy of sciences</em>, 114(13):3521–3526, 2017.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Komatsuzaki et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Aran Komatsuzaki, Joan Puigcerver, James Lee-Thorp, Carlos&nbsp;Riquelme Ruiz, Basil Mustafa, Joshua Ainslie, Yi&nbsp;Tay, Mostafa Dehghani, and Neil Houlsby.

</span>
<span class="ltx_bibblock">Sparse upcycling: Training mixture-of-experts from dense checkpoints.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2212.05055</em>, 2022.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Raymond Li, Loubna&nbsp;Ben Allal, Yangtian Zi, Niklas Muennighoff, Denis Kocetkov, Chenghao Mou, Marc Marone, Christopher Akiki, Jia Li, Jenny Chim, et&nbsp;al.

</span>
<span class="ltx_bibblock">Starcoder: may the source be with you!

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.06161</em>, 2023.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Xiaoran Liu, Hang Yan, Chenxin An, Xipeng Qiu, and Dahua Lin.

</span>
<span class="ltx_bibblock">Scaling laws of rope-based extrapolation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">The Twelfth International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Longpre et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Shayne Longpre, Gregory Yauney, Emily Reif, Katherine Lee, Adam Roberts, Barret Zoph, Denny Zhou, Jason Wei, Kevin Robinson, David Mimno, et&nbsp;al.

</span>
<span class="ltx_bibblock">A pretrainer’s guide to training data: Measuring the effects of data age, domain coverage, quality, &amp; toxicity.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.13169</em>, 2023.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Yun Luo, Zhen Yang, Fandong Meng, Yafu Li, Jie Zhou, and Yue Zhang.

</span>
<span class="ltx_bibblock">An empirical study of catastrophic forgetting in large language models during continual fine-tuning.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.08747</em>, 2023.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mead (1990)</span>
<span class="ltx_bibblock">
Roger Mead.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">The design of experiments: statistical principles for practical applications</em>.

</span>
<span class="ltx_bibblock">Cambridge university press, 1990.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Michaud et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Eric Michaud, Ziming Liu, Uzay Girit, and Max Tegmark.

</span>
<span class="ltx_bibblock">The quantization model of neural scaling.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mindermann et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Sören Mindermann, Jan&nbsp;M Brauner, Muhammed&nbsp;T Razzak, Mrinank Sharma, Andreas Kirsch, Winnie Xu, Benedikt Höltgen, Aidan&nbsp;N Gomez, Adrien Morisot, Sebastian Farquhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Prioritized training on points that are learnable, worth learning, and not yet learnt.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp; 15630–15649. PMLR, 2022.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Muennighoff et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Niklas Muennighoff, Alexander Rush, Boaz Barak, Teven Le&nbsp;Scao, Nouamane Tazi, Aleksandra Piktus, Sampo Pyysalo, Thomas Wolf, and Colin&nbsp;A Raffel.

</span>
<span class="ltx_bibblock">Scaling data-constrained language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Penedo et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Guilherme Penedo, Quentin Malartic, Daniel Hesslow, Ruxandra Cojocaru, Alessandro Cappelli, Hamza Alobeidli, Baptiste Pannier, Ebtesam Almazrouei, and Julien Launay.

</span>
<span class="ltx_bibblock">The refinedweb dataset for falcon llm: outperforming curated corpora with web data, and web data only.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.01116</em>, 2023.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Improving language understanding with unsupervised learning.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rae et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Jack&nbsp;W Rae, Sebastian Borgeaud, Trevor Cai, Katie Millican, Jordan Hoffmann, Francis Song, John Aslanides, Sarah Henderson, Roman Ring, Susannah Young, et&nbsp;al.

</span>
<span class="ltx_bibblock">Scaling language models: Methods, analysis &amp; insights from training gopher.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2112.11446</em>, 2021.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter&nbsp;J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">The Journal of Machine Learning Research</em>, 21(1):5485–5551, 2020.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Yunfan Shao, Linyang Li, Zhaoye Fei, Hang Yan, Dahua Lin, and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Balanced data sampling for language model training with clustering.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.14526</em>, 2024.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Hui Su, Zhi Tian, Xiaoyu Shen, and Xunliang Cai.

</span>
<span class="ltx_bibblock">Unraveling the mystery of scaling laws: Part i.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.06563</em>, 2024.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taylor et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Ross Taylor, Marcin Kardas, Guillem Cucurull, Thomas Scialom, Anthony Hartshorn, Elvis Saravia, Andrew Poulton, Viktor Kerkez, and Robert Stojnic.

</span>
<span class="ltx_bibblock">Galactica: A large language model for science.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.09085</em>, 2022.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.13971</em>, 2023a.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em>, 2023b.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Valiant (1984)</span>
<span class="ltx_bibblock">
Leslie&nbsp;G Valiant.

</span>
<span class="ltx_bibblock">A theory of the learnable.

</span>
<span class="ltx_bibblock"><em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Communications of the ACM</em>, 27(11):1134–1142, 1984.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vapnik &amp; Chervonenkis (1971)</span>
<span class="ltx_bibblock">
VN&nbsp;Vapnik and A&nbsp;Ya Chervonenkis.

</span>
<span class="ltx_bibblock">On the uniform convergence of relative frequencies of events to their probabilities.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Theory of Probability and its Applications</em>, 16(2):264, 1971.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan&nbsp;N Gomez, Ł&nbsp;ukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume&nbsp;30. Curran Associates, Inc., 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Villalobos (2023)</span>
<span class="ltx_bibblock">
Pablo Villalobos.

</span>
<span class="ltx_bibblock">Scaling laws literature review, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://epochai.org/blog/scaling-laws-literature-review" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://epochai.org/blog/scaling-laws-literature-review</a>.

</span>
<span class="ltx_bibblock">Accessed: 2024-02-27.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wenzek et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Guillaume Wenzek, Marie-Anne Lachaux, Alexis Conneau, Vishrav Chaudhary, Francisco Guzmán, Armand Joulin, and Edouard Grave.

</span>
<span class="ltx_bibblock">Ccnet: Extracting high quality monolingual datasets from web crawl data.

</span>
<span class="ltx_bibblock"><em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.00359</em>, 2019.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et&nbsp;al. (2024a)</span>
<span class="ltx_bibblock">
Sang&nbsp;Michael Xie, Hieu Pham, Xuanyi Dong, Nan Du, Hanxiao Liu, Yifeng Lu, Percy&nbsp;S Liang, Quoc&nbsp;V Le, Tengyu Ma, and Adams&nbsp;Wei Yu.

</span>
<span class="ltx_bibblock">Doremi: Optimizing data mixtures speeds up language model pretraining.

</span>
<span class="ltx_bibblock"><em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024a.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et&nbsp;al. (2024b)</span>
<span class="ltx_bibblock">
Sang&nbsp;Michael Xie, Shibani Santurkar, Tengyu Ma, and Percy&nbsp;S Liang.

</span>
<span class="ltx_bibblock">Data selection for language models via importance resampling.

</span>
<span class="ltx_bibblock"><em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024b.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Wenhan Xiong, Jingyu Liu, Igor Molybog, Hejia Zhang, Prajjwal Bhargava, Rui Hou, Louis Martin, Rashi Rungta, Karthik&nbsp;Abinav Sankararaman, Barlas Oguz, et&nbsp;al.

</span>
<span class="ltx_bibblock">Effective long-context scaling of foundation models.

</span>
<span class="ltx_bibblock"><em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.16039</em>, 2023.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhan et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Jun Zhan, Junqi Dai, Jiasheng Ye, Yunhua Zhou, Dong Zhang, Zhigeng Liu, Xin Zhang, Ruibin Yuan, Ge&nbsp;Zhang, Linyang Li, Hang Yan, Jie Fu, Tao Gui, Tianxiang Sun, Yugang Jiang, and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Anygpt: Unified multimodal llm with discrete sequence modeling, 2024.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Chunting Zhou, Pengfei Liu, Puxin Xu, Srinivasan Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, Lili Yu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Lima: Less is more for alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Kun Zhou, Yutao Zhu, Zhipeng Chen, Wentong Chen, Wayne&nbsp;Xin Zhao, Xu&nbsp;Chen, Yankai Lin, Ji-Rong Wen, and Jiawei Han.

</span>
<span class="ltx_bibblock">Don’t make your llm an evaluation benchmark cheater.

</span>
<span class="ltx_bibblock"><em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2311.01964</em>, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>The relative qualities of data mixtures relate to model sizes and training steps.</h2>

<figure id="A1.F9" class="ltx_figure ltx_align_floatright"><img src="/html/2403.16952/assets/figs/rankings.png" id="A1.F9.g1" class="ltx_graphics ltx_img_landscape" width="598" height="465" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>The rankings of the relative performance of 20 sample mixtures trained on RedPajama and validate on the Pile. <span id="A1.F9.3.1" class="ltx_text ltx_font_bold">(A)</span> The rankings of models of different sizes all trained for 30k steps. <span id="A1.F9.4.2" class="ltx_text ltx_font_bold">(B)</span> The rankings for 70M models trained for different steps. </figcaption>
</figure>
<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.1" class="ltx_p">One may wonder whether we can find the optimal data mixtures on small models and few numbers of steps, and then transfer the found mixture proportions to large-scale training.
To answer this question, we compare the relative performance of models in different sizes and trained with different numbers of steps in Fig.&nbsp;<a href="#A1.F9" title="Figure 9 ‣ Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p id="A1.p2.1" class="ltx_p">Results show that the relative performance fluctuates despite a relatively consistent trend across sizes and training steps.
This indicates that a mixture is better at small scales probably but does not always perform better at large scales.
The longest common sequence of the partial orders among the 20 mixtures in Fig.&nbsp;<a href="#A1.F9" title="Figure 9 ‣ Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>(A) and Fig.&nbsp;<a href="#A1.F9" title="Figure 9 ‣ Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>(B) only reaches lengths of 10 and 11, respectively.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Implementation Details</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Model Training</h3>

<div id="A2.SS1.p1" class="ltx_para ltx_noindent">
<p id="A2.SS1.p1.1" class="ltx_p">Throughout this study, we employ the Pythia Suit&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Biderman et&nbsp;al., <a href="#bib.bib8" title="" class="ltx_ref">2023</a>)</cite> as our model architectures, the specific configurations are in Tab.&nbsp;<a href="#A2.T2" title="Table 2 ‣ B.1 Model Training ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
The maximum sequence length is 4096 for pretraining from scratch and 2048 for continual pretraining, where the latter aligns with the setting of the original pretrained models.
In all our experiments, we train the model with a batch size of 1M tokens and a maximum learning rate of 1e-4.
We warm up the learning rates for 2000 steps and decay it to 0.1 of the maximum at the last training step with a cosine decay schedule.
For continual pretraining, we initialize the models with the 20k-step checkpoint of the Pythia 70M model and do not apply a learning rate warmup.</p>
</div>
<figure id="A2.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Model architectures for experiments in this paper.</figcaption>
<div id="A2.T2.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:113.4pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.4pt,-2.2pt) scale(1.04040816268251,1.04040816268251) ;">
<table id="A2.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T2.1.1.1.1" class="ltx_tr">
<th id="A2.T2.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="A2.T2.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.2.1" class="ltx_text ltx_font_bold">70M</span></th>
<th id="A2.T2.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.3.1" class="ltx_text ltx_font_bold">160M</span></th>
<th id="A2.T2.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.4.1" class="ltx_text ltx_font_bold">305M</span></th>
<th id="A2.T2.1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.5.1" class="ltx_text ltx_font_bold">410M</span></th>
<th id="A2.T2.1.1.1.1.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.6.1" class="ltx_text ltx_font_bold">1B</span></th>
</tr>
<tr id="A2.T2.1.1.2.2" class="ltx_tr">
<th id="A2.T2.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Vocabulary Size</th>
<th id="A2.T2.1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
<th id="A2.T2.1.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
<th id="A2.T2.1.1.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
<th id="A2.T2.1.1.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
<th id="A2.T2.1.1.2.2.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
</tr>
<tr id="A2.T2.1.1.3.3" class="ltx_tr">
<th id="A2.T2.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row">Non-embedding Params</th>
<th id="A2.T2.1.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_column">18,915,328</th>
<th id="A2.T2.1.1.3.3.3" class="ltx_td ltx_align_left ltx_th ltx_th_column">85,056,000</th>
<th id="A2.T2.1.1.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_column">201,541,632</th>
<th id="A2.T2.1.1.3.3.5" class="ltx_td ltx_align_left ltx_th ltx_th_column">302,311,424</th>
<th id="A2.T2.1.1.3.3.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column">805,736,448</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T2.1.1.4.1" class="ltx_tr">
<th id="A2.T2.1.1.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Layers</th>
<td id="A2.T2.1.1.4.1.2" class="ltx_td ltx_align_left">6</td>
<td id="A2.T2.1.1.4.1.3" class="ltx_td ltx_align_left">12</td>
<td id="A2.T2.1.1.4.1.4" class="ltx_td ltx_align_left">16</td>
<td id="A2.T2.1.1.4.1.5" class="ltx_td ltx_align_left">24</td>
<td id="A2.T2.1.1.4.1.6" class="ltx_td ltx_nopad_r ltx_align_left">16</td>
</tr>
<tr id="A2.T2.1.1.5.2" class="ltx_tr">
<th id="A2.T2.1.1.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Model Dimension</th>
<td id="A2.T2.1.1.5.2.2" class="ltx_td ltx_align_left">512</td>
<td id="A2.T2.1.1.5.2.3" class="ltx_td ltx_align_left">768</td>
<td id="A2.T2.1.1.5.2.4" class="ltx_td ltx_align_left">1024</td>
<td id="A2.T2.1.1.5.2.5" class="ltx_td ltx_align_left">1024</td>
<td id="A2.T2.1.1.5.2.6" class="ltx_td ltx_nopad_r ltx_align_left">2048</td>
</tr>
<tr id="A2.T2.1.1.6.3" class="ltx_tr">
<th id="A2.T2.1.1.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Heads</th>
<td id="A2.T2.1.1.6.3.2" class="ltx_td ltx_align_left ltx_border_bb">8</td>
<td id="A2.T2.1.1.6.3.3" class="ltx_td ltx_align_left ltx_border_bb">12</td>
<td id="A2.T2.1.1.6.3.4" class="ltx_td ltx_align_left ltx_border_bb">16</td>
<td id="A2.T2.1.1.6.3.5" class="ltx_td ltx_align_left ltx_border_bb">16</td>
<td id="A2.T2.1.1.6.3.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb">8</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A2.SS1.p2" class="ltx_para ltx_noindent">
<p id="A2.SS1.p2.1" class="ltx_p">For datasets, we mainly experiment with the Pile and RedPajama.
For the Pile, we find duplicates in the raw data, so deduplication is performed before training with it.
The Pile contains 5 coarse-grained domains, which are further decomposed into 22 fine-grained domains.
Our experiment in Sec.&nbsp;<a href="#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> is on Github and Pile-CC domains while the experiment in Sec.&nbsp;<a href="#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> is on Github, Pile-CC, and the Books.
All these are fine-grained domains.
For our experiments with 5 domains in Sec.&nbsp;<a href="#S3.SS3" title="3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> we adopt the five coarse-grained domains, i.e., academic, internet, prose, dialogues, and misc, where misc include Github and the DeepMind Mathematics Dataset which are symbolic content.
We use the coarse-grained domains because it is hard to find five fine-grained domains with sufficient tokens.
For the RedPajama, we download the version produced and shared by <cite class="ltx_cite ltx_citemacro_citet">Chen et&nbsp;al. (<a href="#bib.bib12" title="" class="ltx_ref">2024a</a>)</cite>.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Fitting Mixture Laws</h3>

<div id="A2.SS2.p1" class="ltx_para ltx_noindent">
<p id="A2.SS2.p1.1" class="ltx_p">Fitting the mixture law requires us to first experiment on a few mixtures and obtain their losses.
The sample mixture chosen for fitting could largely affect the prediction accuracy.
Consider an extreme case where all sample mixtures have proportions around a small region, it is hardly possible to fit a law that reliably predicts the whole proportion space.</p>
</div>
<div id="A2.SS2.p2" class="ltx_para">
<p id="A2.SS2.p2.1" class="ltx_p">In this paper, we intuitively try evenly allocating the mixture proportions regarding their losses.
Specifically, we enumerate candidate mixtures by double-diminishing the proportion of each domain so that the losses are distributed evenly among these mixtures.
Then, according to the available computation budget, we sample a certain number of mixtures from the candidates to run experiments.
During sampling, we find candidate mixtures with a 0 domain proportion in any of the training domains take up a majority of the candidates.
To avoid these candidates making up all our samples, we specifically down-sample them.
The concrete algorithms are in Alg.&nbsp;<a href="#alg2" title="Algorithm 2 ‣ B.2 Fitting Mixture Laws ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
Additionally, we employ AdaBoost Regressor&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Drucker, <a href="#bib.bib16" title="" class="ltx_ref">1997</a>)</cite> for fitting the mixture laws to stabilize the predictions and improve their accuracy.
We encourage future studies to dive into a more careful design of candidate mixture selection with theoretical support.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Sampling mixture proportions for fitting mixture laws.</figcaption>
<div id="alg2.3" class="ltx_listing ltx_align_center ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><span id="alg2.l1.1" class="ltx_text ltx_font_bold">Input:</span> Maximum proportions of <math id="alg2.l1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">M</annotation></semantics></math> domains <math id="alg2.l1.m2.7" class="ltx_Math" alttext="\bm{r}_{max}=[r_{max,1},\dots,r_{max,M}]" display="inline"><semantics id="alg2.l1.m2.7a"><mrow id="alg2.l1.m2.7.7" xref="alg2.l1.m2.7.7.cmml"><msub id="alg2.l1.m2.7.7.4" xref="alg2.l1.m2.7.7.4.cmml"><mi id="alg2.l1.m2.7.7.4.2" xref="alg2.l1.m2.7.7.4.2.cmml">𝒓</mi><mrow id="alg2.l1.m2.7.7.4.3" xref="alg2.l1.m2.7.7.4.3.cmml"><mi id="alg2.l1.m2.7.7.4.3.2" xref="alg2.l1.m2.7.7.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.7.7.4.3.1" xref="alg2.l1.m2.7.7.4.3.1.cmml">​</mo><mi id="alg2.l1.m2.7.7.4.3.3" xref="alg2.l1.m2.7.7.4.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.7.7.4.3.1a" xref="alg2.l1.m2.7.7.4.3.1.cmml">​</mo><mi id="alg2.l1.m2.7.7.4.3.4" xref="alg2.l1.m2.7.7.4.3.4.cmml">x</mi></mrow></msub><mo id="alg2.l1.m2.7.7.3" xref="alg2.l1.m2.7.7.3.cmml">=</mo><mrow id="alg2.l1.m2.7.7.2.2" xref="alg2.l1.m2.7.7.2.3.cmml"><mo stretchy="false" id="alg2.l1.m2.7.7.2.2.3" xref="alg2.l1.m2.7.7.2.3.cmml">[</mo><msub id="alg2.l1.m2.6.6.1.1.1" xref="alg2.l1.m2.6.6.1.1.1.cmml"><mi id="alg2.l1.m2.6.6.1.1.1.2" xref="alg2.l1.m2.6.6.1.1.1.2.cmml">r</mi><mrow id="alg2.l1.m2.2.2.2.2" xref="alg2.l1.m2.2.2.2.3.cmml"><mrow id="alg2.l1.m2.2.2.2.2.1" xref="alg2.l1.m2.2.2.2.2.1.cmml"><mi id="alg2.l1.m2.2.2.2.2.1.2" xref="alg2.l1.m2.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.2.2.2.2.1.1" xref="alg2.l1.m2.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m2.2.2.2.2.1.3" xref="alg2.l1.m2.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.2.2.2.2.1.1a" xref="alg2.l1.m2.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m2.2.2.2.2.1.4" xref="alg2.l1.m2.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m2.2.2.2.2.2" xref="alg2.l1.m2.2.2.2.3.cmml">,</mo><mn id="alg2.l1.m2.1.1.1.1" xref="alg2.l1.m2.1.1.1.1.cmml">1</mn></mrow></msub><mo id="alg2.l1.m2.7.7.2.2.4" xref="alg2.l1.m2.7.7.2.3.cmml">,</mo><mi mathvariant="normal" id="alg2.l1.m2.5.5" xref="alg2.l1.m2.5.5.cmml">…</mi><mo id="alg2.l1.m2.7.7.2.2.5" xref="alg2.l1.m2.7.7.2.3.cmml">,</mo><msub id="alg2.l1.m2.7.7.2.2.2" xref="alg2.l1.m2.7.7.2.2.2.cmml"><mi id="alg2.l1.m2.7.7.2.2.2.2" xref="alg2.l1.m2.7.7.2.2.2.2.cmml">r</mi><mrow id="alg2.l1.m2.4.4.2.2" xref="alg2.l1.m2.4.4.2.3.cmml"><mrow id="alg2.l1.m2.4.4.2.2.1" xref="alg2.l1.m2.4.4.2.2.1.cmml"><mi id="alg2.l1.m2.4.4.2.2.1.2" xref="alg2.l1.m2.4.4.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.4.4.2.2.1.1" xref="alg2.l1.m2.4.4.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m2.4.4.2.2.1.3" xref="alg2.l1.m2.4.4.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.4.4.2.2.1.1a" xref="alg2.l1.m2.4.4.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m2.4.4.2.2.1.4" xref="alg2.l1.m2.4.4.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m2.4.4.2.2.2" xref="alg2.l1.m2.4.4.2.3.cmml">,</mo><mi id="alg2.l1.m2.3.3.1.1" xref="alg2.l1.m2.3.3.1.1.cmml">M</mi></mrow></msub><mo stretchy="false" id="alg2.l1.m2.7.7.2.2.6" xref="alg2.l1.m2.7.7.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.7b"><apply id="alg2.l1.m2.7.7.cmml" xref="alg2.l1.m2.7.7"><eq id="alg2.l1.m2.7.7.3.cmml" xref="alg2.l1.m2.7.7.3"></eq><apply id="alg2.l1.m2.7.7.4.cmml" xref="alg2.l1.m2.7.7.4"><csymbol cd="ambiguous" id="alg2.l1.m2.7.7.4.1.cmml" xref="alg2.l1.m2.7.7.4">subscript</csymbol><ci id="alg2.l1.m2.7.7.4.2.cmml" xref="alg2.l1.m2.7.7.4.2">𝒓</ci><apply id="alg2.l1.m2.7.7.4.3.cmml" xref="alg2.l1.m2.7.7.4.3"><times id="alg2.l1.m2.7.7.4.3.1.cmml" xref="alg2.l1.m2.7.7.4.3.1"></times><ci id="alg2.l1.m2.7.7.4.3.2.cmml" xref="alg2.l1.m2.7.7.4.3.2">𝑚</ci><ci id="alg2.l1.m2.7.7.4.3.3.cmml" xref="alg2.l1.m2.7.7.4.3.3">𝑎</ci><ci id="alg2.l1.m2.7.7.4.3.4.cmml" xref="alg2.l1.m2.7.7.4.3.4">𝑥</ci></apply></apply><list id="alg2.l1.m2.7.7.2.3.cmml" xref="alg2.l1.m2.7.7.2.2"><apply id="alg2.l1.m2.6.6.1.1.1.cmml" xref="alg2.l1.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.6.6.1.1.1.1.cmml" xref="alg2.l1.m2.6.6.1.1.1">subscript</csymbol><ci id="alg2.l1.m2.6.6.1.1.1.2.cmml" xref="alg2.l1.m2.6.6.1.1.1.2">𝑟</ci><list id="alg2.l1.m2.2.2.2.3.cmml" xref="alg2.l1.m2.2.2.2.2"><apply id="alg2.l1.m2.2.2.2.2.1.cmml" xref="alg2.l1.m2.2.2.2.2.1"><times id="alg2.l1.m2.2.2.2.2.1.1.cmml" xref="alg2.l1.m2.2.2.2.2.1.1"></times><ci id="alg2.l1.m2.2.2.2.2.1.2.cmml" xref="alg2.l1.m2.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l1.m2.2.2.2.2.1.3.cmml" xref="alg2.l1.m2.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l1.m2.2.2.2.2.1.4.cmml" xref="alg2.l1.m2.2.2.2.2.1.4">𝑥</ci></apply><cn type="integer" id="alg2.l1.m2.1.1.1.1.cmml" xref="alg2.l1.m2.1.1.1.1">1</cn></list></apply><ci id="alg2.l1.m2.5.5.cmml" xref="alg2.l1.m2.5.5">…</ci><apply id="alg2.l1.m2.7.7.2.2.2.cmml" xref="alg2.l1.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m2.7.7.2.2.2.1.cmml" xref="alg2.l1.m2.7.7.2.2.2">subscript</csymbol><ci id="alg2.l1.m2.7.7.2.2.2.2.cmml" xref="alg2.l1.m2.7.7.2.2.2.2">𝑟</ci><list id="alg2.l1.m2.4.4.2.3.cmml" xref="alg2.l1.m2.4.4.2.2"><apply id="alg2.l1.m2.4.4.2.2.1.cmml" xref="alg2.l1.m2.4.4.2.2.1"><times id="alg2.l1.m2.4.4.2.2.1.1.cmml" xref="alg2.l1.m2.4.4.2.2.1.1"></times><ci id="alg2.l1.m2.4.4.2.2.1.2.cmml" xref="alg2.l1.m2.4.4.2.2.1.2">𝑚</ci><ci id="alg2.l1.m2.4.4.2.2.1.3.cmml" xref="alg2.l1.m2.4.4.2.2.1.3">𝑎</ci><ci id="alg2.l1.m2.4.4.2.2.1.4.cmml" xref="alg2.l1.m2.4.4.2.2.1.4">𝑥</ci></apply><ci id="alg2.l1.m2.3.3.1.1.cmml" xref="alg2.l1.m2.3.3.1.1">𝑀</ci></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.7c">\bm{r}_{max}=[r_{max,1},\dots,r_{max,M}]</annotation></semantics></math>, where <math id="alg2.l1.m3.2" class="ltx_Math" alttext="r_{max,i}=\frac{D_{i}}{D_{target}}" display="inline"><semantics id="alg2.l1.m3.2a"><mrow id="alg2.l1.m3.2.3" xref="alg2.l1.m3.2.3.cmml"><msub id="alg2.l1.m3.2.3.2" xref="alg2.l1.m3.2.3.2.cmml"><mi id="alg2.l1.m3.2.3.2.2" xref="alg2.l1.m3.2.3.2.2.cmml">r</mi><mrow id="alg2.l1.m3.2.2.2.2" xref="alg2.l1.m3.2.2.2.3.cmml"><mrow id="alg2.l1.m3.2.2.2.2.1" xref="alg2.l1.m3.2.2.2.2.1.cmml"><mi id="alg2.l1.m3.2.2.2.2.1.2" xref="alg2.l1.m3.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.2.2.2.1.1" xref="alg2.l1.m3.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m3.2.2.2.2.1.3" xref="alg2.l1.m3.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.2.2.2.1.1a" xref="alg2.l1.m3.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m3.2.2.2.2.1.4" xref="alg2.l1.m3.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m3.2.2.2.2.2" xref="alg2.l1.m3.2.2.2.3.cmml">,</mo><mi id="alg2.l1.m3.1.1.1.1" xref="alg2.l1.m3.1.1.1.1.cmml">i</mi></mrow></msub><mo id="alg2.l1.m3.2.3.1" xref="alg2.l1.m3.2.3.1.cmml">=</mo><mfrac id="alg2.l1.m3.2.3.3" xref="alg2.l1.m3.2.3.3.cmml"><msub id="alg2.l1.m3.2.3.3.2" xref="alg2.l1.m3.2.3.3.2.cmml"><mi id="alg2.l1.m3.2.3.3.2.2" xref="alg2.l1.m3.2.3.3.2.2.cmml">D</mi><mi id="alg2.l1.m3.2.3.3.2.3" xref="alg2.l1.m3.2.3.3.2.3.cmml">i</mi></msub><msub id="alg2.l1.m3.2.3.3.3" xref="alg2.l1.m3.2.3.3.3.cmml"><mi id="alg2.l1.m3.2.3.3.3.2" xref="alg2.l1.m3.2.3.3.3.2.cmml">D</mi><mrow id="alg2.l1.m3.2.3.3.3.3" xref="alg2.l1.m3.2.3.3.3.3.cmml"><mi id="alg2.l1.m3.2.3.3.3.3.2" xref="alg2.l1.m3.2.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.3" xref="alg2.l1.m3.2.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1a" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.4" xref="alg2.l1.m3.2.3.3.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1b" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.5" xref="alg2.l1.m3.2.3.3.3.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1c" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.6" xref="alg2.l1.m3.2.3.3.3.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1d" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.7" xref="alg2.l1.m3.2.3.3.3.3.7.cmml">t</mi></mrow></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.2b"><apply id="alg2.l1.m3.2.3.cmml" xref="alg2.l1.m3.2.3"><eq id="alg2.l1.m3.2.3.1.cmml" xref="alg2.l1.m3.2.3.1"></eq><apply id="alg2.l1.m3.2.3.2.cmml" xref="alg2.l1.m3.2.3.2"><csymbol cd="ambiguous" id="alg2.l1.m3.2.3.2.1.cmml" xref="alg2.l1.m3.2.3.2">subscript</csymbol><ci id="alg2.l1.m3.2.3.2.2.cmml" xref="alg2.l1.m3.2.3.2.2">𝑟</ci><list id="alg2.l1.m3.2.2.2.3.cmml" xref="alg2.l1.m3.2.2.2.2"><apply id="alg2.l1.m3.2.2.2.2.1.cmml" xref="alg2.l1.m3.2.2.2.2.1"><times id="alg2.l1.m3.2.2.2.2.1.1.cmml" xref="alg2.l1.m3.2.2.2.2.1.1"></times><ci id="alg2.l1.m3.2.2.2.2.1.2.cmml" xref="alg2.l1.m3.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l1.m3.2.2.2.2.1.3.cmml" xref="alg2.l1.m3.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l1.m3.2.2.2.2.1.4.cmml" xref="alg2.l1.m3.2.2.2.2.1.4">𝑥</ci></apply><ci id="alg2.l1.m3.1.1.1.1.cmml" xref="alg2.l1.m3.1.1.1.1">𝑖</ci></list></apply><apply id="alg2.l1.m3.2.3.3.cmml" xref="alg2.l1.m3.2.3.3"><divide id="alg2.l1.m3.2.3.3.1.cmml" xref="alg2.l1.m3.2.3.3"></divide><apply id="alg2.l1.m3.2.3.3.2.cmml" xref="alg2.l1.m3.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l1.m3.2.3.3.2.1.cmml" xref="alg2.l1.m3.2.3.3.2">subscript</csymbol><ci id="alg2.l1.m3.2.3.3.2.2.cmml" xref="alg2.l1.m3.2.3.3.2.2">𝐷</ci><ci id="alg2.l1.m3.2.3.3.2.3.cmml" xref="alg2.l1.m3.2.3.3.2.3">𝑖</ci></apply><apply id="alg2.l1.m3.2.3.3.3.cmml" xref="alg2.l1.m3.2.3.3.3"><csymbol cd="ambiguous" id="alg2.l1.m3.2.3.3.3.1.cmml" xref="alg2.l1.m3.2.3.3.3">subscript</csymbol><ci id="alg2.l1.m3.2.3.3.3.2.cmml" xref="alg2.l1.m3.2.3.3.3.2">𝐷</ci><apply id="alg2.l1.m3.2.3.3.3.3.cmml" xref="alg2.l1.m3.2.3.3.3.3"><times id="alg2.l1.m3.2.3.3.3.3.1.cmml" xref="alg2.l1.m3.2.3.3.3.3.1"></times><ci id="alg2.l1.m3.2.3.3.3.3.2.cmml" xref="alg2.l1.m3.2.3.3.3.3.2">𝑡</ci><ci id="alg2.l1.m3.2.3.3.3.3.3.cmml" xref="alg2.l1.m3.2.3.3.3.3.3">𝑎</ci><ci id="alg2.l1.m3.2.3.3.3.3.4.cmml" xref="alg2.l1.m3.2.3.3.3.3.4">𝑟</ci><ci id="alg2.l1.m3.2.3.3.3.3.5.cmml" xref="alg2.l1.m3.2.3.3.3.3.5">𝑔</ci><ci id="alg2.l1.m3.2.3.3.3.3.6.cmml" xref="alg2.l1.m3.2.3.3.3.3.6">𝑒</ci><ci id="alg2.l1.m3.2.3.3.3.3.7.cmml" xref="alg2.l1.m3.2.3.3.3.3.7">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.2c">r_{max,i}=\frac{D_{i}}{D_{target}}</annotation></semantics></math> with <math id="alg2.l1.m4.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg2.l1.m4.1a"><msub id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml"><mi id="alg2.l1.m4.1.1.2" xref="alg2.l1.m4.1.1.2.cmml">D</mi><mi id="alg2.l1.m4.1.1.3" xref="alg2.l1.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><apply id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1"><csymbol cd="ambiguous" id="alg2.l1.m4.1.1.1.cmml" xref="alg2.l1.m4.1.1">subscript</csymbol><ci id="alg2.l1.m4.1.1.2.cmml" xref="alg2.l1.m4.1.1.2">𝐷</ci><ci id="alg2.l1.m4.1.1.3.cmml" xref="alg2.l1.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">D_{i}</annotation></semantics></math> and <math id="alg2.l1.m5.1" class="ltx_Math" alttext="D_{target}" display="inline"><semantics id="alg2.l1.m5.1a"><msub id="alg2.l1.m5.1.1" xref="alg2.l1.m5.1.1.cmml"><mi id="alg2.l1.m5.1.1.2" xref="alg2.l1.m5.1.1.2.cmml">D</mi><mrow id="alg2.l1.m5.1.1.3" xref="alg2.l1.m5.1.1.3.cmml"><mi id="alg2.l1.m5.1.1.3.2" xref="alg2.l1.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.3" xref="alg2.l1.m5.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1a" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.4" xref="alg2.l1.m5.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1b" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.5" xref="alg2.l1.m5.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1c" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.6" xref="alg2.l1.m5.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1d" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.7" xref="alg2.l1.m5.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><apply id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1"><csymbol cd="ambiguous" id="alg2.l1.m5.1.1.1.cmml" xref="alg2.l1.m5.1.1">subscript</csymbol><ci id="alg2.l1.m5.1.1.2.cmml" xref="alg2.l1.m5.1.1.2">𝐷</ci><apply id="alg2.l1.m5.1.1.3.cmml" xref="alg2.l1.m5.1.1.3"><times id="alg2.l1.m5.1.1.3.1.cmml" xref="alg2.l1.m5.1.1.3.1"></times><ci id="alg2.l1.m5.1.1.3.2.cmml" xref="alg2.l1.m5.1.1.3.2">𝑡</ci><ci id="alg2.l1.m5.1.1.3.3.cmml" xref="alg2.l1.m5.1.1.3.3">𝑎</ci><ci id="alg2.l1.m5.1.1.3.4.cmml" xref="alg2.l1.m5.1.1.3.4">𝑟</ci><ci id="alg2.l1.m5.1.1.3.5.cmml" xref="alg2.l1.m5.1.1.3.5">𝑔</ci><ci id="alg2.l1.m5.1.1.3.6.cmml" xref="alg2.l1.m5.1.1.3.6">𝑒</ci><ci id="alg2.l1.m5.1.1.3.7.cmml" xref="alg2.l1.m5.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">D_{target}</annotation></semantics></math> being numbers of available tokens in <math id="alg2.l1.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l1.m6.1a"><mi id="alg2.l1.m6.1.1" xref="alg2.l1.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m6.1b"><ci id="alg2.l1.m6.1.1.cmml" xref="alg2.l1.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m6.1c">i</annotation></semantics></math>-th domain and target number of training tokens, respectively, sorted in descending orders (i.e., <math id="alg2.l1.m7.6" class="ltx_Math" alttext="r_{max,1}\geq r_{max,2}\geq\cdots\geq r_{max,M}" display="inline"><semantics id="alg2.l1.m7.6a"><mrow id="alg2.l1.m7.6.7" xref="alg2.l1.m7.6.7.cmml"><msub id="alg2.l1.m7.6.7.2" xref="alg2.l1.m7.6.7.2.cmml"><mi id="alg2.l1.m7.6.7.2.2" xref="alg2.l1.m7.6.7.2.2.cmml">r</mi><mrow id="alg2.l1.m7.2.2.2.2" xref="alg2.l1.m7.2.2.2.3.cmml"><mrow id="alg2.l1.m7.2.2.2.2.1" xref="alg2.l1.m7.2.2.2.2.1.cmml"><mi id="alg2.l1.m7.2.2.2.2.1.2" xref="alg2.l1.m7.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.2.2.2.2.1.1" xref="alg2.l1.m7.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.2.2.2.2.1.3" xref="alg2.l1.m7.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.2.2.2.2.1.1a" xref="alg2.l1.m7.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.2.2.2.2.1.4" xref="alg2.l1.m7.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m7.2.2.2.2.2" xref="alg2.l1.m7.2.2.2.3.cmml">,</mo><mn id="alg2.l1.m7.1.1.1.1" xref="alg2.l1.m7.1.1.1.1.cmml">1</mn></mrow></msub><mo id="alg2.l1.m7.6.7.3" xref="alg2.l1.m7.6.7.3.cmml">≥</mo><msub id="alg2.l1.m7.6.7.4" xref="alg2.l1.m7.6.7.4.cmml"><mi id="alg2.l1.m7.6.7.4.2" xref="alg2.l1.m7.6.7.4.2.cmml">r</mi><mrow id="alg2.l1.m7.4.4.2.2" xref="alg2.l1.m7.4.4.2.3.cmml"><mrow id="alg2.l1.m7.4.4.2.2.1" xref="alg2.l1.m7.4.4.2.2.1.cmml"><mi id="alg2.l1.m7.4.4.2.2.1.2" xref="alg2.l1.m7.4.4.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.4.4.2.2.1.1" xref="alg2.l1.m7.4.4.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.4.4.2.2.1.3" xref="alg2.l1.m7.4.4.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.4.4.2.2.1.1a" xref="alg2.l1.m7.4.4.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.4.4.2.2.1.4" xref="alg2.l1.m7.4.4.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m7.4.4.2.2.2" xref="alg2.l1.m7.4.4.2.3.cmml">,</mo><mn id="alg2.l1.m7.3.3.1.1" xref="alg2.l1.m7.3.3.1.1.cmml">2</mn></mrow></msub><mo id="alg2.l1.m7.6.7.5" xref="alg2.l1.m7.6.7.5.cmml">≥</mo><mi mathvariant="normal" id="alg2.l1.m7.6.7.6" xref="alg2.l1.m7.6.7.6.cmml">⋯</mi><mo id="alg2.l1.m7.6.7.7" xref="alg2.l1.m7.6.7.7.cmml">≥</mo><msub id="alg2.l1.m7.6.7.8" xref="alg2.l1.m7.6.7.8.cmml"><mi id="alg2.l1.m7.6.7.8.2" xref="alg2.l1.m7.6.7.8.2.cmml">r</mi><mrow id="alg2.l1.m7.6.6.2.2" xref="alg2.l1.m7.6.6.2.3.cmml"><mrow id="alg2.l1.m7.6.6.2.2.1" xref="alg2.l1.m7.6.6.2.2.1.cmml"><mi id="alg2.l1.m7.6.6.2.2.1.2" xref="alg2.l1.m7.6.6.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.6.6.2.2.1.1" xref="alg2.l1.m7.6.6.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.6.6.2.2.1.3" xref="alg2.l1.m7.6.6.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.6.6.2.2.1.1a" xref="alg2.l1.m7.6.6.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.6.6.2.2.1.4" xref="alg2.l1.m7.6.6.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m7.6.6.2.2.2" xref="alg2.l1.m7.6.6.2.3.cmml">,</mo><mi id="alg2.l1.m7.5.5.1.1" xref="alg2.l1.m7.5.5.1.1.cmml">M</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m7.6b"><apply id="alg2.l1.m7.6.7.cmml" xref="alg2.l1.m7.6.7"><and id="alg2.l1.m7.6.7a.cmml" xref="alg2.l1.m7.6.7"></and><apply id="alg2.l1.m7.6.7b.cmml" xref="alg2.l1.m7.6.7"><geq id="alg2.l1.m7.6.7.3.cmml" xref="alg2.l1.m7.6.7.3"></geq><apply id="alg2.l1.m7.6.7.2.cmml" xref="alg2.l1.m7.6.7.2"><csymbol cd="ambiguous" id="alg2.l1.m7.6.7.2.1.cmml" xref="alg2.l1.m7.6.7.2">subscript</csymbol><ci id="alg2.l1.m7.6.7.2.2.cmml" xref="alg2.l1.m7.6.7.2.2">𝑟</ci><list id="alg2.l1.m7.2.2.2.3.cmml" xref="alg2.l1.m7.2.2.2.2"><apply id="alg2.l1.m7.2.2.2.2.1.cmml" xref="alg2.l1.m7.2.2.2.2.1"><times id="alg2.l1.m7.2.2.2.2.1.1.cmml" xref="alg2.l1.m7.2.2.2.2.1.1"></times><ci id="alg2.l1.m7.2.2.2.2.1.2.cmml" xref="alg2.l1.m7.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l1.m7.2.2.2.2.1.3.cmml" xref="alg2.l1.m7.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l1.m7.2.2.2.2.1.4.cmml" xref="alg2.l1.m7.2.2.2.2.1.4">𝑥</ci></apply><cn type="integer" id="alg2.l1.m7.1.1.1.1.cmml" xref="alg2.l1.m7.1.1.1.1">1</cn></list></apply><apply id="alg2.l1.m7.6.7.4.cmml" xref="alg2.l1.m7.6.7.4"><csymbol cd="ambiguous" id="alg2.l1.m7.6.7.4.1.cmml" xref="alg2.l1.m7.6.7.4">subscript</csymbol><ci id="alg2.l1.m7.6.7.4.2.cmml" xref="alg2.l1.m7.6.7.4.2">𝑟</ci><list id="alg2.l1.m7.4.4.2.3.cmml" xref="alg2.l1.m7.4.4.2.2"><apply id="alg2.l1.m7.4.4.2.2.1.cmml" xref="alg2.l1.m7.4.4.2.2.1"><times id="alg2.l1.m7.4.4.2.2.1.1.cmml" xref="alg2.l1.m7.4.4.2.2.1.1"></times><ci id="alg2.l1.m7.4.4.2.2.1.2.cmml" xref="alg2.l1.m7.4.4.2.2.1.2">𝑚</ci><ci id="alg2.l1.m7.4.4.2.2.1.3.cmml" xref="alg2.l1.m7.4.4.2.2.1.3">𝑎</ci><ci id="alg2.l1.m7.4.4.2.2.1.4.cmml" xref="alg2.l1.m7.4.4.2.2.1.4">𝑥</ci></apply><cn type="integer" id="alg2.l1.m7.3.3.1.1.cmml" xref="alg2.l1.m7.3.3.1.1">2</cn></list></apply></apply><apply id="alg2.l1.m7.6.7c.cmml" xref="alg2.l1.m7.6.7"><geq id="alg2.l1.m7.6.7.5.cmml" xref="alg2.l1.m7.6.7.5"></geq><share href="#alg2.l1.m7.6.7.4.cmml" id="alg2.l1.m7.6.7d.cmml" xref="alg2.l1.m7.6.7"></share><ci id="alg2.l1.m7.6.7.6.cmml" xref="alg2.l1.m7.6.7.6">⋯</ci></apply><apply id="alg2.l1.m7.6.7e.cmml" xref="alg2.l1.m7.6.7"><geq id="alg2.l1.m7.6.7.7.cmml" xref="alg2.l1.m7.6.7.7"></geq><share href="#alg2.l1.m7.6.7.6.cmml" id="alg2.l1.m7.6.7f.cmml" xref="alg2.l1.m7.6.7"></share><apply id="alg2.l1.m7.6.7.8.cmml" xref="alg2.l1.m7.6.7.8"><csymbol cd="ambiguous" id="alg2.l1.m7.6.7.8.1.cmml" xref="alg2.l1.m7.6.7.8">subscript</csymbol><ci id="alg2.l1.m7.6.7.8.2.cmml" xref="alg2.l1.m7.6.7.8.2">𝑟</ci><list id="alg2.l1.m7.6.6.2.3.cmml" xref="alg2.l1.m7.6.6.2.2"><apply id="alg2.l1.m7.6.6.2.2.1.cmml" xref="alg2.l1.m7.6.6.2.2.1"><times id="alg2.l1.m7.6.6.2.2.1.1.cmml" xref="alg2.l1.m7.6.6.2.2.1.1"></times><ci id="alg2.l1.m7.6.6.2.2.1.2.cmml" xref="alg2.l1.m7.6.6.2.2.1.2">𝑚</ci><ci id="alg2.l1.m7.6.6.2.2.1.3.cmml" xref="alg2.l1.m7.6.6.2.2.1.3">𝑎</ci><ci id="alg2.l1.m7.6.6.2.2.1.4.cmml" xref="alg2.l1.m7.6.6.2.2.1.4">𝑥</ci></apply><ci id="alg2.l1.m7.5.5.1.1.cmml" xref="alg2.l1.m7.5.5.1.1">𝑀</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m7.6c">r_{max,1}\geq r_{max,2}\geq\cdots\geq r_{max,M}</annotation></semantics></math>), minimum proportion grid size <math id="alg2.l1.m8.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="alg2.l1.m8.1a"><mi id="alg2.l1.m8.1.1" xref="alg2.l1.m8.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m8.1b"><ci id="alg2.l1.m8.1.1.cmml" xref="alg2.l1.m8.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m8.1c">\delta</annotation></semantics></math>, number of mixture to run experiment <math id="alg2.l1.m9.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg2.l1.m9.1a"><mi id="alg2.l1.m9.1.1" xref="alg2.l1.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m9.1b"><ci id="alg2.l1.m9.1.1.cmml" xref="alg2.l1.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m9.1c">N</annotation></semantics></math>.

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><span id="alg2.l2.1" class="ltx_text ltx_font_bold">Output:</span> A set of <math id="alg2.l2.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg2.l2.m1.1a"><mi id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">N</annotation></semantics></math> mixtures to experiment <math id="alg2.l2.m2.1" class="ltx_Math" alttext="\{\bm{r}_{n}\}_{n=1}^{N}" display="inline"><semantics id="alg2.l2.m2.1a"><msubsup id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml"><mrow id="alg2.l2.m2.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l2.m2.1.1.1.1.1.2" xref="alg2.l2.m2.1.1.1.1.2.cmml">{</mo><msub id="alg2.l2.m2.1.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.1.1.cmml"><mi id="alg2.l2.m2.1.1.1.1.1.1.2" xref="alg2.l2.m2.1.1.1.1.1.1.2.cmml">𝒓</mi><mi id="alg2.l2.m2.1.1.1.1.1.1.3" xref="alg2.l2.m2.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="alg2.l2.m2.1.1.1.1.1.3" xref="alg2.l2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l2.m2.1.1.1.3" xref="alg2.l2.m2.1.1.1.3.cmml"><mi id="alg2.l2.m2.1.1.1.3.2" xref="alg2.l2.m2.1.1.1.3.2.cmml">n</mi><mo id="alg2.l2.m2.1.1.1.3.1" xref="alg2.l2.m2.1.1.1.3.1.cmml">=</mo><mn id="alg2.l2.m2.1.1.1.3.3" xref="alg2.l2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg2.l2.m2.1.1.3" xref="alg2.l2.m2.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><apply id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.2.cmml" xref="alg2.l2.m2.1.1">superscript</csymbol><apply id="alg2.l2.m2.1.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.2.cmml" xref="alg2.l2.m2.1.1">subscript</csymbol><set id="alg2.l2.m2.1.1.1.1.2.cmml" xref="alg2.l2.m2.1.1.1.1.1"><apply id="alg2.l2.m2.1.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l2.m2.1.1.1.1.1.1.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.2">𝒓</ci><ci id="alg2.l2.m2.1.1.1.1.1.1.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.3">𝑛</ci></apply></set><apply id="alg2.l2.m2.1.1.1.3.cmml" xref="alg2.l2.m2.1.1.1.3"><eq id="alg2.l2.m2.1.1.1.3.1.cmml" xref="alg2.l2.m2.1.1.1.3.1"></eq><ci id="alg2.l2.m2.1.1.1.3.2.cmml" xref="alg2.l2.m2.1.1.1.3.2">𝑛</ci><cn type="integer" id="alg2.l2.m2.1.1.1.3.3.cmml" xref="alg2.l2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="alg2.l2.m2.1.1.3.cmml" xref="alg2.l2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">\{\bm{r}_{n}\}_{n=1}^{N}</annotation></semantics></math>.

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>Candidate mixtures <math id="alg2.l3.m1.2" class="ltx_Math" alttext="\mathcal{C}\leftarrow\textsc{GetAllCandidates}(1,[])" display="inline"><semantics id="alg2.l3.m1.2a"><mrow id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.2.2.3" xref="alg2.l3.m1.2.2.3.cmml">𝒞</mi><mo stretchy="false" id="alg2.l3.m1.2.2.2" xref="alg2.l3.m1.2.2.2.cmml">←</mo><mrow id="alg2.l3.m1.2.2.1" xref="alg2.l3.m1.2.2.1.cmml"><mtext class="ltx_font_smallcaps" id="alg2.l3.m1.2.2.1.3" xref="alg2.l3.m1.2.2.1.3a.cmml">GetAllCandidates</mtext><mo lspace="0em" rspace="0em" id="alg2.l3.m1.2.2.1.2" xref="alg2.l3.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l3.m1.2.2.1.1.1" xref="alg2.l3.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.2.cmml">(</mo><mn id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">1</mn><mo id="alg2.l3.m1.2.2.1.1.1.3" xref="alg2.l3.m1.2.2.1.1.2.cmml">,</mo><mrow id="alg2.l3.m1.2.2.1.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.1.2.1" xref="alg2.l3.m1.2.2.1.1.1.1.1.cmml">[</mo><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.1.2.2" xref="alg2.l3.m1.2.2.1.1.1.1.1.cmml">]</mo></mrow><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.4" xref="alg2.l3.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.2b"><apply id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2"><ci id="alg2.l3.m1.2.2.2.cmml" xref="alg2.l3.m1.2.2.2">←</ci><ci id="alg2.l3.m1.2.2.3.cmml" xref="alg2.l3.m1.2.2.3">𝒞</ci><apply id="alg2.l3.m1.2.2.1.cmml" xref="alg2.l3.m1.2.2.1"><times id="alg2.l3.m1.2.2.1.2.cmml" xref="alg2.l3.m1.2.2.1.2"></times><ci id="alg2.l3.m1.2.2.1.3a.cmml" xref="alg2.l3.m1.2.2.1.3"><mtext class="ltx_font_smallcaps" id="alg2.l3.m1.2.2.1.3.cmml" xref="alg2.l3.m1.2.2.1.3">GetAllCandidates</mtext></ci><interval closure="open" id="alg2.l3.m1.2.2.1.1.2.cmml" xref="alg2.l3.m1.2.2.1.1.1"><cn type="integer" id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">1</cn><list id="alg2.l3.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.2.1"></list></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.2c">\mathcal{C}\leftarrow\textsc{GetAllCandidates}(1,[])</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>Split mixtures with 0 proportion in <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg2.l4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\mathcal{C}</annotation></semantics></math> into <math id="alg2.l4.m2.1" class="ltx_Math" alttext="\mathcal{C}_{0}" display="inline"><semantics id="alg2.l4.m2.1a"><msub id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m2.1.1.2" xref="alg2.l4.m2.1.1.2.cmml">𝒞</mi><mn id="alg2.l4.m2.1.1.3" xref="alg2.l4.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1">subscript</csymbol><ci id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1.2">𝒞</ci><cn type="integer" id="alg2.l4.m2.1.1.3.cmml" xref="alg2.l4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">\mathcal{C}_{0}</annotation></semantics></math> and the others into <math id="alg2.l4.m3.1" class="ltx_Math" alttext="\mathcal{C}_{1}" display="inline"><semantics id="alg2.l4.m3.1a"><msub id="alg2.l4.m3.1.1" xref="alg2.l4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m3.1.1.2" xref="alg2.l4.m3.1.1.2.cmml">𝒞</mi><mn id="alg2.l4.m3.1.1.3" xref="alg2.l4.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m3.1b"><apply id="alg2.l4.m3.1.1.cmml" xref="alg2.l4.m3.1.1"><csymbol cd="ambiguous" id="alg2.l4.m3.1.1.1.cmml" xref="alg2.l4.m3.1.1">subscript</csymbol><ci id="alg2.l4.m3.1.1.2.cmml" xref="alg2.l4.m3.1.1.2">𝒞</ci><cn type="integer" id="alg2.l4.m3.1.1.3.cmml" xref="alg2.l4.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m3.1c">\mathcal{C}_{1}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>Samples <math id="alg2.l5.m1.2" class="ltx_Math" alttext="\{\bm{r}_{n}\}_{n=1}^{\lfloor N/4\rfloor}" display="inline"><semantics id="alg2.l5.m1.2a"><msubsup id="alg2.l5.m1.2.2" xref="alg2.l5.m1.2.2.cmml"><mrow id="alg2.l5.m1.2.2.1.1.1" xref="alg2.l5.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l5.m1.2.2.1.1.1.2" xref="alg2.l5.m1.2.2.1.1.2.cmml">{</mo><msub id="alg2.l5.m1.2.2.1.1.1.1" xref="alg2.l5.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l5.m1.2.2.1.1.1.1.2" xref="alg2.l5.m1.2.2.1.1.1.1.2.cmml">𝒓</mi><mi id="alg2.l5.m1.2.2.1.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="alg2.l5.m1.2.2.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l5.m1.2.2.1.3" xref="alg2.l5.m1.2.2.1.3.cmml"><mi id="alg2.l5.m1.2.2.1.3.2" xref="alg2.l5.m1.2.2.1.3.2.cmml">n</mi><mo id="alg2.l5.m1.2.2.1.3.1" xref="alg2.l5.m1.2.2.1.3.1.cmml">=</mo><mn id="alg2.l5.m1.2.2.1.3.3" xref="alg2.l5.m1.2.2.1.3.3.cmml">1</mn></mrow><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.2.1.cmml">⌊</mo><mrow id="alg2.l5.m1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.cmml"><mi id="alg2.l5.m1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.2.cmml">N</mi><mo id="alg2.l5.m1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.cmml">/</mo><mn id="alg2.l5.m1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.3.cmml">4</mn></mrow><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.2.1.cmml">⌋</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.cmml" xref="alg2.l5.m1.2.2">superscript</csymbol><apply id="alg2.l5.m1.2.2.1.cmml" xref="alg2.l5.m1.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.2.cmml" xref="alg2.l5.m1.2.2">subscript</csymbol><set id="alg2.l5.m1.2.2.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1"><apply id="alg2.l5.m1.2.2.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.2">𝒓</ci><ci id="alg2.l5.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.3">𝑛</ci></apply></set><apply id="alg2.l5.m1.2.2.1.3.cmml" xref="alg2.l5.m1.2.2.1.3"><eq id="alg2.l5.m1.2.2.1.3.1.cmml" xref="alg2.l5.m1.2.2.1.3.1"></eq><ci id="alg2.l5.m1.2.2.1.3.2.cmml" xref="alg2.l5.m1.2.2.1.3.2">𝑛</ci><cn type="integer" id="alg2.l5.m1.2.2.1.3.3.cmml" xref="alg2.l5.m1.2.2.1.3.3">1</cn></apply></apply><apply id="alg2.l5.m1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1"><floor id="alg2.l5.m1.1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.2"></floor><apply id="alg2.l5.m1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1"><divide id="alg2.l5.m1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1"></divide><ci id="alg2.l5.m1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="alg2.l5.m1.1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">\{\bm{r}_{n}\}_{n=1}^{\lfloor N/4\rfloor}</annotation></semantics></math> from <math id="alg2.l5.m2.1" class="ltx_Math" alttext="\mathcal{C}_{0}" display="inline"><semantics id="alg2.l5.m2.1a"><msub id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">𝒞</mi><mn id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1">subscript</csymbol><ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">𝒞</ci><cn type="integer" id="alg2.l5.m2.1.1.3.cmml" xref="alg2.l5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">\mathcal{C}_{0}</annotation></semantics></math> and <math id="alg2.l5.m3.2" class="ltx_Math" alttext="\{\bm{r}_{n}\}_{n=\lceil N/4\rceil}^{N}" display="inline"><semantics id="alg2.l5.m3.2a"><msubsup id="alg2.l5.m3.2.2" xref="alg2.l5.m3.2.2.cmml"><mrow id="alg2.l5.m3.2.2.1.1.1" xref="alg2.l5.m3.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l5.m3.2.2.1.1.1.2" xref="alg2.l5.m3.2.2.1.1.2.cmml">{</mo><msub id="alg2.l5.m3.2.2.1.1.1.1" xref="alg2.l5.m3.2.2.1.1.1.1.cmml"><mi id="alg2.l5.m3.2.2.1.1.1.1.2" xref="alg2.l5.m3.2.2.1.1.1.1.2.cmml">𝒓</mi><mi id="alg2.l5.m3.2.2.1.1.1.1.3" xref="alg2.l5.m3.2.2.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="alg2.l5.m3.2.2.1.1.1.3" xref="alg2.l5.m3.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l5.m3.1.1.1" xref="alg2.l5.m3.1.1.1.cmml"><mi id="alg2.l5.m3.1.1.1.3" xref="alg2.l5.m3.1.1.1.3.cmml">n</mi><mo id="alg2.l5.m3.1.1.1.2" xref="alg2.l5.m3.1.1.1.2.cmml">=</mo><mrow id="alg2.l5.m3.1.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l5.m3.1.1.1.1.1.2" xref="alg2.l5.m3.1.1.1.1.2.1.cmml">⌈</mo><mrow id="alg2.l5.m3.1.1.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.1.1.cmml"><mi id="alg2.l5.m3.1.1.1.1.1.1.2" xref="alg2.l5.m3.1.1.1.1.1.1.2.cmml">N</mi><mo id="alg2.l5.m3.1.1.1.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.1.1.1.cmml">/</mo><mn id="alg2.l5.m3.1.1.1.1.1.1.3" xref="alg2.l5.m3.1.1.1.1.1.1.3.cmml">4</mn></mrow><mo stretchy="false" id="alg2.l5.m3.1.1.1.1.1.3" xref="alg2.l5.m3.1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow><mi id="alg2.l5.m3.2.2.3" xref="alg2.l5.m3.2.2.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l5.m3.2b"><apply id="alg2.l5.m3.2.2.cmml" xref="alg2.l5.m3.2.2"><csymbol cd="ambiguous" id="alg2.l5.m3.2.2.2.cmml" xref="alg2.l5.m3.2.2">superscript</csymbol><apply id="alg2.l5.m3.2.2.1.cmml" xref="alg2.l5.m3.2.2"><csymbol cd="ambiguous" id="alg2.l5.m3.2.2.1.2.cmml" xref="alg2.l5.m3.2.2">subscript</csymbol><set id="alg2.l5.m3.2.2.1.1.2.cmml" xref="alg2.l5.m3.2.2.1.1.1"><apply id="alg2.l5.m3.2.2.1.1.1.1.cmml" xref="alg2.l5.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m3.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m3.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m3.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m3.2.2.1.1.1.1.2">𝒓</ci><ci id="alg2.l5.m3.2.2.1.1.1.1.3.cmml" xref="alg2.l5.m3.2.2.1.1.1.1.3">𝑛</ci></apply></set><apply id="alg2.l5.m3.1.1.1.cmml" xref="alg2.l5.m3.1.1.1"><eq id="alg2.l5.m3.1.1.1.2.cmml" xref="alg2.l5.m3.1.1.1.2"></eq><ci id="alg2.l5.m3.1.1.1.3.cmml" xref="alg2.l5.m3.1.1.1.3">𝑛</ci><apply id="alg2.l5.m3.1.1.1.1.2.cmml" xref="alg2.l5.m3.1.1.1.1.1"><ceiling id="alg2.l5.m3.1.1.1.1.2.1.cmml" xref="alg2.l5.m3.1.1.1.1.1.2"></ceiling><apply id="alg2.l5.m3.1.1.1.1.1.1.cmml" xref="alg2.l5.m3.1.1.1.1.1.1"><divide id="alg2.l5.m3.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m3.1.1.1.1.1.1.1"></divide><ci id="alg2.l5.m3.1.1.1.1.1.1.2.cmml" xref="alg2.l5.m3.1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="alg2.l5.m3.1.1.1.1.1.1.3.cmml" xref="alg2.l5.m3.1.1.1.1.1.1.3">4</cn></apply></apply></apply></apply><ci id="alg2.l5.m3.2.2.3.cmml" xref="alg2.l5.m3.2.2.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m3.2c">\{\bm{r}_{n}\}_{n=\lceil N/4\rceil}^{N}</annotation></semantics></math> from <math id="alg2.l5.m4.1" class="ltx_Math" alttext="\mathcal{C}_{1}" display="inline"><semantics id="alg2.l5.m4.1a"><msub id="alg2.l5.m4.1.1" xref="alg2.l5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m4.1.1.2" xref="alg2.l5.m4.1.1.2.cmml">𝒞</mi><mn id="alg2.l5.m4.1.1.3" xref="alg2.l5.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m4.1b"><apply id="alg2.l5.m4.1.1.cmml" xref="alg2.l5.m4.1.1"><csymbol cd="ambiguous" id="alg2.l5.m4.1.1.1.cmml" xref="alg2.l5.m4.1.1">subscript</csymbol><ci id="alg2.l5.m4.1.1.2.cmml" xref="alg2.l5.m4.1.1.2">𝒞</ci><cn type="integer" id="alg2.l5.m4.1.1.3.cmml" xref="alg2.l5.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m4.1c">\mathcal{C}_{1}</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>
</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span><span id="alg2.l7.1" class="ltx_text ltx_font_bold">procedure</span>&nbsp;<span id="alg2.l7.2" class="ltx_text ltx_font_smallcaps">GetAllCandidates</span>(domain index <math id="alg2.l7.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l7.m1.1a"><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">i</annotation></semantics></math>, proportions of first <math id="alg2.l7.m2.1" class="ltx_Math" alttext="i-1" display="inline"><semantics id="alg2.l7.m2.1a"><mrow id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml"><mi id="alg2.l7.m2.1.1.2" xref="alg2.l7.m2.1.1.2.cmml">i</mi><mo id="alg2.l7.m2.1.1.1" xref="alg2.l7.m2.1.1.1.cmml">−</mo><mn id="alg2.l7.m2.1.1.3" xref="alg2.l7.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><apply id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1"><minus id="alg2.l7.m2.1.1.1.cmml" xref="alg2.l7.m2.1.1.1"></minus><ci id="alg2.l7.m2.1.1.2.cmml" xref="alg2.l7.m2.1.1.2">𝑖</ci><cn type="integer" id="alg2.l7.m2.1.1.3.cmml" xref="alg2.l7.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">i-1</annotation></semantics></math> domains <math id="alg2.l7.m3.1" class="ltx_Math" alttext="r_{1\dots i-1}" display="inline"><semantics id="alg2.l7.m3.1a"><msub id="alg2.l7.m3.1.1" xref="alg2.l7.m3.1.1.cmml"><mi id="alg2.l7.m3.1.1.2" xref="alg2.l7.m3.1.1.2.cmml">r</mi><mrow id="alg2.l7.m3.1.1.3" xref="alg2.l7.m3.1.1.3.cmml"><mrow id="alg2.l7.m3.1.1.3.2" xref="alg2.l7.m3.1.1.3.2.cmml"><mn id="alg2.l7.m3.1.1.3.2.2" xref="alg2.l7.m3.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l7.m3.1.1.3.2.1" xref="alg2.l7.m3.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l7.m3.1.1.3.2.3" xref="alg2.l7.m3.1.1.3.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m3.1.1.3.2.1a" xref="alg2.l7.m3.1.1.3.2.1.cmml">​</mo><mi id="alg2.l7.m3.1.1.3.2.4" xref="alg2.l7.m3.1.1.3.2.4.cmml">i</mi></mrow><mo id="alg2.l7.m3.1.1.3.1" xref="alg2.l7.m3.1.1.3.1.cmml">−</mo><mn id="alg2.l7.m3.1.1.3.3" xref="alg2.l7.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l7.m3.1b"><apply id="alg2.l7.m3.1.1.cmml" xref="alg2.l7.m3.1.1"><csymbol cd="ambiguous" id="alg2.l7.m3.1.1.1.cmml" xref="alg2.l7.m3.1.1">subscript</csymbol><ci id="alg2.l7.m3.1.1.2.cmml" xref="alg2.l7.m3.1.1.2">𝑟</ci><apply id="alg2.l7.m3.1.1.3.cmml" xref="alg2.l7.m3.1.1.3"><minus id="alg2.l7.m3.1.1.3.1.cmml" xref="alg2.l7.m3.1.1.3.1"></minus><apply id="alg2.l7.m3.1.1.3.2.cmml" xref="alg2.l7.m3.1.1.3.2"><times id="alg2.l7.m3.1.1.3.2.1.cmml" xref="alg2.l7.m3.1.1.3.2.1"></times><cn type="integer" id="alg2.l7.m3.1.1.3.2.2.cmml" xref="alg2.l7.m3.1.1.3.2.2">1</cn><ci id="alg2.l7.m3.1.1.3.2.3.cmml" xref="alg2.l7.m3.1.1.3.2.3">…</ci><ci id="alg2.l7.m3.1.1.3.2.4.cmml" xref="alg2.l7.m3.1.1.3.2.4">𝑖</ci></apply><cn type="integer" id="alg2.l7.m3.1.1.3.3.cmml" xref="alg2.l7.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m3.1c">r_{1\dots i-1}</annotation></semantics></math>)

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Candidate mixtures <math id="alg2.l8.m1.1" class="ltx_Math" alttext="\mathcal{C}=\emptyset" display="inline"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">𝒞</mi><mo id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">=</mo><mi mathvariant="normal" id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><eq id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1"></eq><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝒞</ci><emptyset id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\mathcal{C}=\emptyset</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l9.1" class="ltx_text ltx_font_bold">if</span>&nbsp;<math id="alg2.l9.m1.1" class="ltx_Math" alttext="i=M" display="inline"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml">i</mi><mo id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">=</mo><mi id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><eq id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1"></eq><ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">𝑖</ci><ci id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">i=M</annotation></semantics></math>&nbsp;<span id="alg2.l9.2" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l10.1" class="ltx_text ltx_font_bold">if</span>&nbsp;<math id="alg2.l10.m1.2" class="ltx_Math" alttext="0\leq 1-\sum_{j=1}^{i-1}r_{j}\leq r_{max,i}" display="inline"><semantics id="alg2.l10.m1.2a"><mrow id="alg2.l10.m1.2.3" xref="alg2.l10.m1.2.3.cmml"><mn id="alg2.l10.m1.2.3.2" xref="alg2.l10.m1.2.3.2.cmml">0</mn><mo id="alg2.l10.m1.2.3.3" xref="alg2.l10.m1.2.3.3.cmml">≤</mo><mrow id="alg2.l10.m1.2.3.4" xref="alg2.l10.m1.2.3.4.cmml"><mn id="alg2.l10.m1.2.3.4.2" xref="alg2.l10.m1.2.3.4.2.cmml">1</mn><mo rspace="0.055em" id="alg2.l10.m1.2.3.4.1" xref="alg2.l10.m1.2.3.4.1.cmml">−</mo><mrow id="alg2.l10.m1.2.3.4.3" xref="alg2.l10.m1.2.3.4.3.cmml"><msubsup id="alg2.l10.m1.2.3.4.3.1" xref="alg2.l10.m1.2.3.4.3.1.cmml"><mo id="alg2.l10.m1.2.3.4.3.1.2.2" xref="alg2.l10.m1.2.3.4.3.1.2.2.cmml">∑</mo><mrow id="alg2.l10.m1.2.3.4.3.1.2.3" xref="alg2.l10.m1.2.3.4.3.1.2.3.cmml"><mi id="alg2.l10.m1.2.3.4.3.1.2.3.2" xref="alg2.l10.m1.2.3.4.3.1.2.3.2.cmml">j</mi><mo id="alg2.l10.m1.2.3.4.3.1.2.3.1" xref="alg2.l10.m1.2.3.4.3.1.2.3.1.cmml">=</mo><mn id="alg2.l10.m1.2.3.4.3.1.2.3.3" xref="alg2.l10.m1.2.3.4.3.1.2.3.3.cmml">1</mn></mrow><mrow id="alg2.l10.m1.2.3.4.3.1.3" xref="alg2.l10.m1.2.3.4.3.1.3.cmml"><mi id="alg2.l10.m1.2.3.4.3.1.3.2" xref="alg2.l10.m1.2.3.4.3.1.3.2.cmml">i</mi><mo id="alg2.l10.m1.2.3.4.3.1.3.1" xref="alg2.l10.m1.2.3.4.3.1.3.1.cmml">−</mo><mn id="alg2.l10.m1.2.3.4.3.1.3.3" xref="alg2.l10.m1.2.3.4.3.1.3.3.cmml">1</mn></mrow></msubsup><msub id="alg2.l10.m1.2.3.4.3.2" xref="alg2.l10.m1.2.3.4.3.2.cmml"><mi id="alg2.l10.m1.2.3.4.3.2.2" xref="alg2.l10.m1.2.3.4.3.2.2.cmml">r</mi><mi id="alg2.l10.m1.2.3.4.3.2.3" xref="alg2.l10.m1.2.3.4.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="alg2.l10.m1.2.3.5" xref="alg2.l10.m1.2.3.5.cmml">≤</mo><msub id="alg2.l10.m1.2.3.6" xref="alg2.l10.m1.2.3.6.cmml"><mi id="alg2.l10.m1.2.3.6.2" xref="alg2.l10.m1.2.3.6.2.cmml">r</mi><mrow id="alg2.l10.m1.2.2.2.2" xref="alg2.l10.m1.2.2.2.3.cmml"><mrow id="alg2.l10.m1.2.2.2.2.1" xref="alg2.l10.m1.2.2.2.2.1.cmml"><mi id="alg2.l10.m1.2.2.2.2.1.2" xref="alg2.l10.m1.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.2.2.2.2.1.1" xref="alg2.l10.m1.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l10.m1.2.2.2.2.1.3" xref="alg2.l10.m1.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.2.2.2.2.1.1a" xref="alg2.l10.m1.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l10.m1.2.2.2.2.1.4" xref="alg2.l10.m1.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l10.m1.2.2.2.2.2" xref="alg2.l10.m1.2.2.2.3.cmml">,</mo><mi id="alg2.l10.m1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.cmml">i</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.2b"><apply id="alg2.l10.m1.2.3.cmml" xref="alg2.l10.m1.2.3"><and id="alg2.l10.m1.2.3a.cmml" xref="alg2.l10.m1.2.3"></and><apply id="alg2.l10.m1.2.3b.cmml" xref="alg2.l10.m1.2.3"><leq id="alg2.l10.m1.2.3.3.cmml" xref="alg2.l10.m1.2.3.3"></leq><cn type="integer" id="alg2.l10.m1.2.3.2.cmml" xref="alg2.l10.m1.2.3.2">0</cn><apply id="alg2.l10.m1.2.3.4.cmml" xref="alg2.l10.m1.2.3.4"><minus id="alg2.l10.m1.2.3.4.1.cmml" xref="alg2.l10.m1.2.3.4.1"></minus><cn type="integer" id="alg2.l10.m1.2.3.4.2.cmml" xref="alg2.l10.m1.2.3.4.2">1</cn><apply id="alg2.l10.m1.2.3.4.3.cmml" xref="alg2.l10.m1.2.3.4.3"><apply id="alg2.l10.m1.2.3.4.3.1.cmml" xref="alg2.l10.m1.2.3.4.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.4.3.1.1.cmml" xref="alg2.l10.m1.2.3.4.3.1">superscript</csymbol><apply id="alg2.l10.m1.2.3.4.3.1.2.cmml" xref="alg2.l10.m1.2.3.4.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.4.3.1.2.1.cmml" xref="alg2.l10.m1.2.3.4.3.1">subscript</csymbol><sum id="alg2.l10.m1.2.3.4.3.1.2.2.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.2"></sum><apply id="alg2.l10.m1.2.3.4.3.1.2.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3"><eq id="alg2.l10.m1.2.3.4.3.1.2.3.1.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3.1"></eq><ci id="alg2.l10.m1.2.3.4.3.1.2.3.2.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3.2">𝑗</ci><cn type="integer" id="alg2.l10.m1.2.3.4.3.1.2.3.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3.3">1</cn></apply></apply><apply id="alg2.l10.m1.2.3.4.3.1.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.3"><minus id="alg2.l10.m1.2.3.4.3.1.3.1.cmml" xref="alg2.l10.m1.2.3.4.3.1.3.1"></minus><ci id="alg2.l10.m1.2.3.4.3.1.3.2.cmml" xref="alg2.l10.m1.2.3.4.3.1.3.2">𝑖</ci><cn type="integer" id="alg2.l10.m1.2.3.4.3.1.3.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.3.3">1</cn></apply></apply><apply id="alg2.l10.m1.2.3.4.3.2.cmml" xref="alg2.l10.m1.2.3.4.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.4.3.2.1.cmml" xref="alg2.l10.m1.2.3.4.3.2">subscript</csymbol><ci id="alg2.l10.m1.2.3.4.3.2.2.cmml" xref="alg2.l10.m1.2.3.4.3.2.2">𝑟</ci><ci id="alg2.l10.m1.2.3.4.3.2.3.cmml" xref="alg2.l10.m1.2.3.4.3.2.3">𝑗</ci></apply></apply></apply></apply><apply id="alg2.l10.m1.2.3c.cmml" xref="alg2.l10.m1.2.3"><leq id="alg2.l10.m1.2.3.5.cmml" xref="alg2.l10.m1.2.3.5"></leq><share href="#alg2.l10.m1.2.3.4.cmml" id="alg2.l10.m1.2.3d.cmml" xref="alg2.l10.m1.2.3"></share><apply id="alg2.l10.m1.2.3.6.cmml" xref="alg2.l10.m1.2.3.6"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.6.1.cmml" xref="alg2.l10.m1.2.3.6">subscript</csymbol><ci id="alg2.l10.m1.2.3.6.2.cmml" xref="alg2.l10.m1.2.3.6.2">𝑟</ci><list id="alg2.l10.m1.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.2"><apply id="alg2.l10.m1.2.2.2.2.1.cmml" xref="alg2.l10.m1.2.2.2.2.1"><times id="alg2.l10.m1.2.2.2.2.1.1.cmml" xref="alg2.l10.m1.2.2.2.2.1.1"></times><ci id="alg2.l10.m1.2.2.2.2.1.2.cmml" xref="alg2.l10.m1.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l10.m1.2.2.2.2.1.3.cmml" xref="alg2.l10.m1.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l10.m1.2.2.2.2.1.4.cmml" xref="alg2.l10.m1.2.2.2.2.1.4">𝑥</ci></apply><ci id="alg2.l10.m1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1">𝑖</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.2c">0\leq 1-\sum_{j=1}^{i-1}r_{j}\leq r_{max,i}</annotation></semantics></math>&nbsp;<span id="alg2.l10.2" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l11.m1.2" class="ltx_Math" alttext="r_{1\dots i}\leftarrow[r_{1\dots i-1},1-\sum_{j=1}^{i-1}r_{j}]" display="inline"><semantics id="alg2.l11.m1.2a"><mrow id="alg2.l11.m1.2.2" xref="alg2.l11.m1.2.2.cmml"><msub id="alg2.l11.m1.2.2.4" xref="alg2.l11.m1.2.2.4.cmml"><mi id="alg2.l11.m1.2.2.4.2" xref="alg2.l11.m1.2.2.4.2.cmml">r</mi><mrow id="alg2.l11.m1.2.2.4.3" xref="alg2.l11.m1.2.2.4.3.cmml"><mn id="alg2.l11.m1.2.2.4.3.2" xref="alg2.l11.m1.2.2.4.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l11.m1.2.2.4.3.1" xref="alg2.l11.m1.2.2.4.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l11.m1.2.2.4.3.3" xref="alg2.l11.m1.2.2.4.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m1.2.2.4.3.1a" xref="alg2.l11.m1.2.2.4.3.1.cmml">​</mo><mi id="alg2.l11.m1.2.2.4.3.4" xref="alg2.l11.m1.2.2.4.3.4.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg2.l11.m1.2.2.3" xref="alg2.l11.m1.2.2.3.cmml">←</mo><mrow id="alg2.l11.m1.2.2.2.2" xref="alg2.l11.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l11.m1.2.2.2.2.3" xref="alg2.l11.m1.2.2.2.3.cmml">[</mo><msub id="alg2.l11.m1.1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.1.cmml"><mi id="alg2.l11.m1.1.1.1.1.1.2" xref="alg2.l11.m1.1.1.1.1.1.2.cmml">r</mi><mrow id="alg2.l11.m1.1.1.1.1.1.3" xref="alg2.l11.m1.1.1.1.1.1.3.cmml"><mrow id="alg2.l11.m1.1.1.1.1.1.3.2" xref="alg2.l11.m1.1.1.1.1.1.3.2.cmml"><mn id="alg2.l11.m1.1.1.1.1.1.3.2.2" xref="alg2.l11.m1.1.1.1.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l11.m1.1.1.1.1.1.3.2.1" xref="alg2.l11.m1.1.1.1.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l11.m1.1.1.1.1.1.3.2.3" xref="alg2.l11.m1.1.1.1.1.1.3.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m1.1.1.1.1.1.3.2.1a" xref="alg2.l11.m1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg2.l11.m1.1.1.1.1.1.3.2.4" xref="alg2.l11.m1.1.1.1.1.1.3.2.4.cmml">i</mi></mrow><mo id="alg2.l11.m1.1.1.1.1.1.3.1" xref="alg2.l11.m1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg2.l11.m1.1.1.1.1.1.3.3" xref="alg2.l11.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg2.l11.m1.2.2.2.2.4" xref="alg2.l11.m1.2.2.2.3.cmml">,</mo><mrow id="alg2.l11.m1.2.2.2.2.2" xref="alg2.l11.m1.2.2.2.2.2.cmml"><mn id="alg2.l11.m1.2.2.2.2.2.2" xref="alg2.l11.m1.2.2.2.2.2.2.cmml">1</mn><mo rspace="0.055em" id="alg2.l11.m1.2.2.2.2.2.1" xref="alg2.l11.m1.2.2.2.2.2.1.cmml">−</mo><mrow id="alg2.l11.m1.2.2.2.2.2.3" xref="alg2.l11.m1.2.2.2.2.2.3.cmml"><msubsup id="alg2.l11.m1.2.2.2.2.2.3.1" xref="alg2.l11.m1.2.2.2.2.2.3.1.cmml"><mo id="alg2.l11.m1.2.2.2.2.2.3.1.2.2" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="alg2.l11.m1.2.2.2.2.2.3.1.2.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.cmml"><mi id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2.cmml">j</mi><mo id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3.cmml">1</mn></mrow><mrow id="alg2.l11.m1.2.2.2.2.2.3.1.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.cmml"><mi id="alg2.l11.m1.2.2.2.2.2.3.1.3.2" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.2.cmml">i</mi><mo id="alg2.l11.m1.2.2.2.2.2.3.1.3.1" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.1.cmml">−</mo><mn id="alg2.l11.m1.2.2.2.2.2.3.1.3.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.3.cmml">1</mn></mrow></msubsup><msub id="alg2.l11.m1.2.2.2.2.2.3.2" xref="alg2.l11.m1.2.2.2.2.2.3.2.cmml"><mi id="alg2.l11.m1.2.2.2.2.2.3.2.2" xref="alg2.l11.m1.2.2.2.2.2.3.2.2.cmml">r</mi><mi id="alg2.l11.m1.2.2.2.2.2.3.2.3" xref="alg2.l11.m1.2.2.2.2.2.3.2.3.cmml">j</mi></msub></mrow></mrow><mo stretchy="false" id="alg2.l11.m1.2.2.2.2.5" xref="alg2.l11.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.2b"><apply id="alg2.l11.m1.2.2.cmml" xref="alg2.l11.m1.2.2"><ci id="alg2.l11.m1.2.2.3.cmml" xref="alg2.l11.m1.2.2.3">←</ci><apply id="alg2.l11.m1.2.2.4.cmml" xref="alg2.l11.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.4.1.cmml" xref="alg2.l11.m1.2.2.4">subscript</csymbol><ci id="alg2.l11.m1.2.2.4.2.cmml" xref="alg2.l11.m1.2.2.4.2">𝑟</ci><apply id="alg2.l11.m1.2.2.4.3.cmml" xref="alg2.l11.m1.2.2.4.3"><times id="alg2.l11.m1.2.2.4.3.1.cmml" xref="alg2.l11.m1.2.2.4.3.1"></times><cn type="integer" id="alg2.l11.m1.2.2.4.3.2.cmml" xref="alg2.l11.m1.2.2.4.3.2">1</cn><ci id="alg2.l11.m1.2.2.4.3.3.cmml" xref="alg2.l11.m1.2.2.4.3.3">…</ci><ci id="alg2.l11.m1.2.2.4.3.4.cmml" xref="alg2.l11.m1.2.2.4.3.4">𝑖</ci></apply></apply><interval closure="closed" id="alg2.l11.m1.2.2.2.3.cmml" xref="alg2.l11.m1.2.2.2.2"><apply id="alg2.l11.m1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l11.m1.1.1.1.1.1.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.2">𝑟</ci><apply id="alg2.l11.m1.1.1.1.1.1.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.3"><minus id="alg2.l11.m1.1.1.1.1.1.3.1.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.1"></minus><apply id="alg2.l11.m1.1.1.1.1.1.3.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2"><times id="alg2.l11.m1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.1"></times><cn type="integer" id="alg2.l11.m1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.2">1</cn><ci id="alg2.l11.m1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.3">…</ci><ci id="alg2.l11.m1.1.1.1.1.1.3.2.4.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.4">𝑖</ci></apply><cn type="integer" id="alg2.l11.m1.1.1.1.1.1.3.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.l11.m1.2.2.2.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2"><minus id="alg2.l11.m1.2.2.2.2.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.1"></minus><cn type="integer" id="alg2.l11.m1.2.2.2.2.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.2">1</cn><apply id="alg2.l11.m1.2.2.2.2.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3"><apply id="alg2.l11.m1.2.2.2.2.2.3.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.2.2.2.3.1.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1">superscript</csymbol><apply id="alg2.l11.m1.2.2.2.2.2.3.1.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.2.2.2.3.1.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1">subscript</csymbol><sum id="alg2.l11.m1.2.2.2.2.2.3.1.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.2"></sum><apply id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3"><eq id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1"></eq><ci id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3">1</cn></apply></apply><apply id="alg2.l11.m1.2.2.2.2.2.3.1.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3"><minus id="alg2.l11.m1.2.2.2.2.2.3.1.3.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.1"></minus><ci id="alg2.l11.m1.2.2.2.2.2.3.1.3.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.2">𝑖</ci><cn type="integer" id="alg2.l11.m1.2.2.2.2.2.3.1.3.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.3">1</cn></apply></apply><apply id="alg2.l11.m1.2.2.2.2.2.3.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.2.2.2.3.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2">subscript</csymbol><ci id="alg2.l11.m1.2.2.2.2.2.3.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2.2">𝑟</ci><ci id="alg2.l11.m1.2.2.2.2.2.3.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2.3">𝑗</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.2c">r_{1\dots i}\leftarrow[r_{1\dots i-1},1-\sum_{j=1}^{i-1}r_{j}]</annotation></semantics></math>

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l12.m1.1" class="ltx_Math" alttext="\mathcal{C}\leftarrow\mathcal{C}\bigcup\left\{r_{1\dots i}\right\}" display="inline"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">𝒞</mi><mo stretchy="false" id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">←</mo><mrow id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l12.m1.1.1.1.3" xref="alg2.l12.m1.1.1.1.3.cmml">𝒞</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1.2" xref="alg2.l12.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l12.m1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.cmml"><mo rspace="0em" id="alg2.l12.m1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.2.cmml">⋃</mo><mrow id="alg2.l12.m1.1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.2.cmml"><mo id="alg2.l12.m1.1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.2.cmml">{</mo><msub id="alg2.l12.m1.1.1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l12.m1.1.1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.1.1.2.cmml">r</mi><mrow id="alg2.l12.m1.1.1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.cmml"><mn id="alg2.l12.m1.1.1.1.1.1.1.1.3.2" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1.1.1.1.1.3.1" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l12.m1.1.1.1.1.1.1.1.3.3" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1.1.1.1.1.3.1a" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l12.m1.1.1.1.1.1.1.1.3.4" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.4.cmml">i</mi></mrow></msub><mo id="alg2.l12.m1.1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><ci id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">←</ci><ci id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">𝒞</ci><apply id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1"><times id="alg2.l12.m1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.2"></times><ci id="alg2.l12.m1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.3">𝒞</ci><apply id="alg2.l12.m1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1"><union id="alg2.l12.m1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.2"></union><set id="alg2.l12.m1.1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1"><apply id="alg2.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l12.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.2">𝑟</ci><apply id="alg2.l12.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3"><times id="alg2.l12.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.1"></times><cn type="integer" id="alg2.l12.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.2">1</cn><ci id="alg2.l12.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.3">…</ci><ci id="alg2.l12.m1.1.1.1.1.1.1.1.3.4.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.4">𝑖</ci></apply></apply></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">\mathcal{C}\leftarrow\mathcal{C}\bigcup\left\{r_{1\dots i}\right\}</annotation></semantics></math>

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l13.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg2.l13.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l14.1" class="ltx_text ltx_font_bold">else</span>
</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l15.m1.2" class="ltx_Math" alttext="\Gamma\leftarrow\delta*\lfloor\frac{r_{max,i}}{\delta}\rfloor" display="inline"><semantics id="alg2.l15.m1.2a"><mrow id="alg2.l15.m1.2.3" xref="alg2.l15.m1.2.3.cmml"><mi mathvariant="normal" id="alg2.l15.m1.2.3.2" xref="alg2.l15.m1.2.3.2.cmml">Γ</mi><mo stretchy="false" id="alg2.l15.m1.2.3.1" xref="alg2.l15.m1.2.3.1.cmml">←</mo><mrow id="alg2.l15.m1.2.3.3" xref="alg2.l15.m1.2.3.3.cmml"><mi id="alg2.l15.m1.2.3.3.2" xref="alg2.l15.m1.2.3.3.2.cmml">δ</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l15.m1.2.3.3.1" xref="alg2.l15.m1.2.3.3.1.cmml">∗</mo><mrow id="alg2.l15.m1.2.3.3.3.2" xref="alg2.l15.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="alg2.l15.m1.2.3.3.3.2.1" xref="alg2.l15.m1.2.3.3.3.1.1.cmml">⌊</mo><mfrac id="alg2.l15.m1.2.2" xref="alg2.l15.m1.2.2.cmml"><msub id="alg2.l15.m1.2.2.2" xref="alg2.l15.m1.2.2.2.cmml"><mi id="alg2.l15.m1.2.2.2.4" xref="alg2.l15.m1.2.2.2.4.cmml">r</mi><mrow id="alg2.l15.m1.2.2.2.2.2.2" xref="alg2.l15.m1.2.2.2.2.2.3.cmml"><mrow id="alg2.l15.m1.2.2.2.2.2.2.1" xref="alg2.l15.m1.2.2.2.2.2.2.1.cmml"><mi id="alg2.l15.m1.2.2.2.2.2.2.1.2" xref="alg2.l15.m1.2.2.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.2.2.2.2.2.2.1.1" xref="alg2.l15.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l15.m1.2.2.2.2.2.2.1.3" xref="alg2.l15.m1.2.2.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.2.2.2.2.2.2.1.1a" xref="alg2.l15.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l15.m1.2.2.2.2.2.2.1.4" xref="alg2.l15.m1.2.2.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l15.m1.2.2.2.2.2.2.2" xref="alg2.l15.m1.2.2.2.2.2.3.cmml">,</mo><mi id="alg2.l15.m1.1.1.1.1.1.1" xref="alg2.l15.m1.1.1.1.1.1.1.cmml">i</mi></mrow></msub><mi id="alg2.l15.m1.2.2.4" xref="alg2.l15.m1.2.2.4.cmml">δ</mi></mfrac><mo stretchy="false" id="alg2.l15.m1.2.3.3.3.2.2" xref="alg2.l15.m1.2.3.3.3.1.1.cmml">⌋</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.2b"><apply id="alg2.l15.m1.2.3.cmml" xref="alg2.l15.m1.2.3"><ci id="alg2.l15.m1.2.3.1.cmml" xref="alg2.l15.m1.2.3.1">←</ci><ci id="alg2.l15.m1.2.3.2.cmml" xref="alg2.l15.m1.2.3.2">Γ</ci><apply id="alg2.l15.m1.2.3.3.cmml" xref="alg2.l15.m1.2.3.3"><times id="alg2.l15.m1.2.3.3.1.cmml" xref="alg2.l15.m1.2.3.3.1"></times><ci id="alg2.l15.m1.2.3.3.2.cmml" xref="alg2.l15.m1.2.3.3.2">𝛿</ci><apply id="alg2.l15.m1.2.3.3.3.1.cmml" xref="alg2.l15.m1.2.3.3.3.2"><floor id="alg2.l15.m1.2.3.3.3.1.1.cmml" xref="alg2.l15.m1.2.3.3.3.2.1"></floor><apply id="alg2.l15.m1.2.2.cmml" xref="alg2.l15.m1.2.2"><divide id="alg2.l15.m1.2.2.3.cmml" xref="alg2.l15.m1.2.2"></divide><apply id="alg2.l15.m1.2.2.2.cmml" xref="alg2.l15.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2">subscript</csymbol><ci id="alg2.l15.m1.2.2.2.4.cmml" xref="alg2.l15.m1.2.2.2.4">𝑟</ci><list id="alg2.l15.m1.2.2.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2.2.2.2"><apply id="alg2.l15.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1"><times id="alg2.l15.m1.2.2.2.2.2.2.1.1.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.1"></times><ci id="alg2.l15.m1.2.2.2.2.2.2.1.2.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l15.m1.2.2.2.2.2.2.1.3.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l15.m1.2.2.2.2.2.2.1.4.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.4">𝑥</ci></apply><ci id="alg2.l15.m1.1.1.1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1.1.1.1">𝑖</ci></list></apply><ci id="alg2.l15.m1.2.2.4.cmml" xref="alg2.l15.m1.2.2.4">𝛿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.2c">\Gamma\leftarrow\delta*\lfloor\frac{r_{max,i}}{\delta}\rfloor</annotation></semantics></math>

</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l16.1" class="ltx_text ltx_font_bold">for</span>&nbsp;<math id="alg2.l16.m1.1" class="ltx_Math" alttext="s=0\mbox{~{}~{}{To}~{}~{}}\lceil{\log_{2}{\frac{\Gamma}{\delta}}}\rceil" display="inline"><semantics id="alg2.l16.m1.1a"><mrow id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><mi id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml">s</mi><mo id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml">=</mo><mrow id="alg2.l16.m1.1.1.1" xref="alg2.l16.m1.1.1.1.cmml"><mn id="alg2.l16.m1.1.1.1.3" xref="alg2.l16.m1.1.1.1.3.cmml">0</mn><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.1.2" xref="alg2.l16.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l16.m1.1.1.1.4" xref="alg2.l16.m1.1.1.1.4d.cmml"><mtext id="alg2.l16.m1.1.1.1.4a" xref="alg2.l16.m1.1.1.1.4d.cmml">&nbsp;</mtext><mtext class="ltx_mathvariant_bold" id="alg2.l16.m1.1.1.1.4b" xref="alg2.l16.m1.1.1.1.4d.cmml">To</mtext><mtext id="alg2.l16.m1.1.1.1.4c" xref="alg2.l16.m1.1.1.1.4d.cmml">&nbsp;</mtext></mrow><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.1.2a" xref="alg2.l16.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l16.m1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l16.m1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.2.1.cmml">⌈</mo><mrow id="alg2.l16.m1.1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.1.cmml"><msub id="alg2.l16.m1.1.1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l16.m1.1.1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.1.1.2.cmml">log</mi><mn id="alg2.l16.m1.1.1.1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo lspace="0.167em" id="alg2.l16.m1.1.1.1.1.1.1a" xref="alg2.l16.m1.1.1.1.1.1.1.cmml">⁡</mo><mfrac id="alg2.l16.m1.1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="alg2.l16.m1.1.1.1.1.1.1.2.2" xref="alg2.l16.m1.1.1.1.1.1.1.2.2.cmml">Γ</mi><mi id="alg2.l16.m1.1.1.1.1.1.1.2.3" xref="alg2.l16.m1.1.1.1.1.1.1.2.3.cmml">δ</mi></mfrac></mrow><mo stretchy="false" id="alg2.l16.m1.1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><eq id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2"></eq><ci id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3">𝑠</ci><apply id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1"><times id="alg2.l16.m1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.2"></times><cn type="integer" id="alg2.l16.m1.1.1.1.3.cmml" xref="alg2.l16.m1.1.1.1.3">0</cn><ci id="alg2.l16.m1.1.1.1.4d.cmml" xref="alg2.l16.m1.1.1.1.4"><mrow id="alg2.l16.m1.1.1.1.4.cmml" xref="alg2.l16.m1.1.1.1.4"><mtext id="alg2.l16.m1.1.1.1.4a.cmml" xref="alg2.l16.m1.1.1.1.4">&nbsp;</mtext><mtext class="ltx_mathvariant_bold" id="alg2.l16.m1.1.1.1.4b.cmml" xref="alg2.l16.m1.1.1.1.4">To</mtext><mtext id="alg2.l16.m1.1.1.1.4c.cmml" xref="alg2.l16.m1.1.1.1.4">&nbsp;</mtext></mrow></ci><apply id="alg2.l16.m1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1"><ceiling id="alg2.l16.m1.1.1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.2"></ceiling><apply id="alg2.l16.m1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1"><apply id="alg2.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1">subscript</csymbol><log id="alg2.l16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1.2"></log><cn type="integer" id="alg2.l16.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="alg2.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2"><divide id="alg2.l16.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2"></divide><ci id="alg2.l16.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2.2">Γ</ci><ci id="alg2.l16.m1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2.3">𝛿</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">s=0\mbox{~{}~{}{To}~{}~{}}\lceil{\log_{2}{\frac{\Gamma}{\delta}}}\rceil</annotation></semantics></math>&nbsp;<span id="alg2.l16.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l17.m1.3" class="ltx_Math" alttext="r_{i}\leftarrow\max(0,\frac{\Gamma}{2^{s}})" display="inline"><semantics id="alg2.l17.m1.3a"><mrow id="alg2.l17.m1.3.4" xref="alg2.l17.m1.3.4.cmml"><msub id="alg2.l17.m1.3.4.2" xref="alg2.l17.m1.3.4.2.cmml"><mi id="alg2.l17.m1.3.4.2.2" xref="alg2.l17.m1.3.4.2.2.cmml">r</mi><mi id="alg2.l17.m1.3.4.2.3" xref="alg2.l17.m1.3.4.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.l17.m1.3.4.1" xref="alg2.l17.m1.3.4.1.cmml">←</mo><mrow id="alg2.l17.m1.3.4.3.2" xref="alg2.l17.m1.3.4.3.1.cmml"><mi id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml">max</mi><mo id="alg2.l17.m1.3.4.3.2a" xref="alg2.l17.m1.3.4.3.1.cmml">⁡</mo><mrow id="alg2.l17.m1.3.4.3.2.1" xref="alg2.l17.m1.3.4.3.1.cmml"><mo stretchy="false" id="alg2.l17.m1.3.4.3.2.1.1" xref="alg2.l17.m1.3.4.3.1.cmml">(</mo><mn id="alg2.l17.m1.2.2" xref="alg2.l17.m1.2.2.cmml">0</mn><mo id="alg2.l17.m1.3.4.3.2.1.2" xref="alg2.l17.m1.3.4.3.1.cmml">,</mo><mfrac id="alg2.l17.m1.3.3" xref="alg2.l17.m1.3.3.cmml"><mi mathvariant="normal" id="alg2.l17.m1.3.3.2" xref="alg2.l17.m1.3.3.2.cmml">Γ</mi><msup id="alg2.l17.m1.3.3.3" xref="alg2.l17.m1.3.3.3.cmml"><mn id="alg2.l17.m1.3.3.3.2" xref="alg2.l17.m1.3.3.3.2.cmml">2</mn><mi id="alg2.l17.m1.3.3.3.3" xref="alg2.l17.m1.3.3.3.3.cmml">s</mi></msup></mfrac><mo stretchy="false" id="alg2.l17.m1.3.4.3.2.1.3" xref="alg2.l17.m1.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.3b"><apply id="alg2.l17.m1.3.4.cmml" xref="alg2.l17.m1.3.4"><ci id="alg2.l17.m1.3.4.1.cmml" xref="alg2.l17.m1.3.4.1">←</ci><apply id="alg2.l17.m1.3.4.2.cmml" xref="alg2.l17.m1.3.4.2"><csymbol cd="ambiguous" id="alg2.l17.m1.3.4.2.1.cmml" xref="alg2.l17.m1.3.4.2">subscript</csymbol><ci id="alg2.l17.m1.3.4.2.2.cmml" xref="alg2.l17.m1.3.4.2.2">𝑟</ci><ci id="alg2.l17.m1.3.4.2.3.cmml" xref="alg2.l17.m1.3.4.2.3">𝑖</ci></apply><apply id="alg2.l17.m1.3.4.3.1.cmml" xref="alg2.l17.m1.3.4.3.2"><max id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"></max><cn type="integer" id="alg2.l17.m1.2.2.cmml" xref="alg2.l17.m1.2.2">0</cn><apply id="alg2.l17.m1.3.3.cmml" xref="alg2.l17.m1.3.3"><divide id="alg2.l17.m1.3.3.1.cmml" xref="alg2.l17.m1.3.3"></divide><ci id="alg2.l17.m1.3.3.2.cmml" xref="alg2.l17.m1.3.3.2">Γ</ci><apply id="alg2.l17.m1.3.3.3.cmml" xref="alg2.l17.m1.3.3.3"><csymbol cd="ambiguous" id="alg2.l17.m1.3.3.3.1.cmml" xref="alg2.l17.m1.3.3.3">superscript</csymbol><cn type="integer" id="alg2.l17.m1.3.3.3.2.cmml" xref="alg2.l17.m1.3.3.3.2">2</cn><ci id="alg2.l17.m1.3.3.3.3.cmml" xref="alg2.l17.m1.3.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.3c">r_{i}\leftarrow\max(0,\frac{\Gamma}{2^{s}})</annotation></semantics></math>

</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l18.m1.2" class="ltx_Math" alttext="\mathcal{C}\leftarrow\mathcal{C}\bigcup\textsc{GetAllCandidates}(i+1,[r_{1\dots i}])" display="inline"><semantics id="alg2.l18.m1.2a"><mrow id="alg2.l18.m1.2.2" xref="alg2.l18.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l18.m1.2.2.4" xref="alg2.l18.m1.2.2.4.cmml">𝒞</mi><mo stretchy="false" id="alg2.l18.m1.2.2.3" xref="alg2.l18.m1.2.2.3.cmml">←</mo><mrow id="alg2.l18.m1.2.2.2" xref="alg2.l18.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l18.m1.2.2.2.4" xref="alg2.l18.m1.2.2.2.4.cmml">𝒞</mi><mo lspace="0em" rspace="0em" id="alg2.l18.m1.2.2.2.3" xref="alg2.l18.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l18.m1.2.2.2.2" xref="alg2.l18.m1.2.2.2.2.cmml"><mo id="alg2.l18.m1.2.2.2.2.3" xref="alg2.l18.m1.2.2.2.2.3.cmml">⋃</mo><mrow id="alg2.l18.m1.2.2.2.2.2" xref="alg2.l18.m1.2.2.2.2.2.cmml"><mtext class="ltx_font_smallcaps" id="alg2.l18.m1.2.2.2.2.2.4" xref="alg2.l18.m1.2.2.2.2.2.4a.cmml">GetAllCandidates</mtext><mo lspace="0em" rspace="0em" id="alg2.l18.m1.2.2.2.2.2.3" xref="alg2.l18.m1.2.2.2.2.2.3.cmml">​</mo><mrow id="alg2.l18.m1.2.2.2.2.2.2.2" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l18.m1.2.2.2.2.2.2.2.3" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml">(</mo><mrow id="alg2.l18.m1.1.1.1.1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l18.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg2.l18.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="alg2.l18.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg2.l18.m1.2.2.2.2.2.2.2.4" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml">,</mo><mrow id="alg2.l18.m1.2.2.2.2.2.2.2.2.1" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.2" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.2.1.cmml">[</mo><msub id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.cmml"><mi id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2.cmml">r</mi><mrow id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.cmml"><mn id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1a" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.3" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.2.1.cmml">]</mo></mrow><mo stretchy="false" id="alg2.l18.m1.2.2.2.2.2.2.2.5" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.2b"><apply id="alg2.l18.m1.2.2.cmml" xref="alg2.l18.m1.2.2"><ci id="alg2.l18.m1.2.2.3.cmml" xref="alg2.l18.m1.2.2.3">←</ci><ci id="alg2.l18.m1.2.2.4.cmml" xref="alg2.l18.m1.2.2.4">𝒞</ci><apply id="alg2.l18.m1.2.2.2.cmml" xref="alg2.l18.m1.2.2.2"><times id="alg2.l18.m1.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.3"></times><ci id="alg2.l18.m1.2.2.2.4.cmml" xref="alg2.l18.m1.2.2.2.4">𝒞</ci><apply id="alg2.l18.m1.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.2"><union id="alg2.l18.m1.2.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.2.3"></union><apply id="alg2.l18.m1.2.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.2.2"><times id="alg2.l18.m1.2.2.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.3"></times><ci id="alg2.l18.m1.2.2.2.2.2.4a.cmml" xref="alg2.l18.m1.2.2.2.2.2.4"><mtext class="ltx_font_smallcaps" id="alg2.l18.m1.2.2.2.2.2.4.cmml" xref="alg2.l18.m1.2.2.2.2.2.4">GetAllCandidates</mtext></ci><interval closure="open" id="alg2.l18.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2"><apply id="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1"><plus id="alg2.l18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="alg2.l18.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="alg2.l18.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1"><csymbol cd="latexml" id="alg2.l18.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2">𝑟</ci><apply id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3"><times id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1"></times><cn type="integer" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2">1</cn><ci id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3">…</ci><ci id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4">𝑖</ci></apply></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.2c">\mathcal{C}\leftarrow\mathcal{C}\bigcup\textsc{GetAllCandidates}(i+1,[r_{1\dots i}])</annotation></semantics></math>

</div>
<div id="alg2.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l19.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg2.l19.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l20.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg2.l20.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l21.1" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l21.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg2.l21.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l21.m1.1.1" xref="alg2.l21.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.1b"><ci id="alg2.l21.m1.1.1.cmml" xref="alg2.l21.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.1c">\mathcal{C}</annotation></semantics></math>

</div>
<div id="alg2.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span><span id="alg2.l22.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg2.l22.2" class="ltx_text ltx_font_bold">procedure</span>
</div>
</div>
</figure>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Connections between Implicit Domain Aggregation and MLP</h2>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.7" class="ltx_p">We first repeat our final mixture law (Eqn.&nbsp;<a href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) here for convenience:</p>
<table id="A3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.Ex2.m1.2" class="ltx_Math" alttext="L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right]," display="block"><semantics id="A3.Ex2.m1.2a"><mrow id="A3.Ex2.m1.2.2.1" xref="A3.Ex2.m1.2.2.1.1.cmml"><mrow id="A3.Ex2.m1.2.2.1.1" xref="A3.Ex2.m1.2.2.1.1.cmml"><mrow id="A3.Ex2.m1.2.2.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.Ex2.m1.2.2.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex2.m1.2.2.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1a" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="A3.Ex2.m1.2.2.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A3.Ex2.m1.2.2.1.1.5" xref="A3.Ex2.m1.2.2.1.1.5.cmml">=</mo><mrow id="A3.Ex2.m1.2.2.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="A3.Ex2.m1.2.2.1.1.2.2.2.2" xref="A3.Ex2.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="A3.Ex2.m1.2.2.1.1.2.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.2.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.3.cmml">K</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.2.1" xref="A3.Ex2.m1.2.2.1.1.2.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.2.1.3" xref="A3.Ex2.m1.2.2.1.1.2.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.1.3.2" xref="A3.Ex2.m1.2.2.1.1.2.1.3.2.cmml">s</mi><mi id="A3.Ex2.m1.2.2.1.1.2.1.3.3" xref="A3.Ex2.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.2.1.2" xref="A3.Ex2.m1.2.2.1.1.2.1.2.cmml">​</mo><msub id="A3.Ex2.m1.2.2.1.1.2.1.4" xref="A3.Ex2.m1.2.2.1.1.2.1.4.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.1.4.2" xref="A3.Ex2.m1.2.2.1.1.2.1.4.2.cmml">L</mi><mi id="A3.Ex2.m1.2.2.1.1.2.1.4.3" xref="A3.Ex2.m1.2.2.1.1.2.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.2.1.2a" xref="A3.Ex2.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2.cmml">r</mi><mrow id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mn id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1a" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">​</mo><mi id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="A3.Ex2.m1.2.2.1.1.6" xref="A3.Ex2.m1.2.2.1.1.6.cmml">=</mo><mrow id="A3.Ex2.m1.2.2.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.2.cmml"><mo movablelimits="false" id="A3.Ex2.m1.2.2.1.1.3.2.2.2" xref="A3.Ex2.m1.2.2.1.1.3.2.2.2.cmml">∑</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.2.2.3" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.2.cmml">i</mi><mo id="A3.Ex2.m1.2.2.1.1.3.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.3.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.3.2.3" xref="A3.Ex2.m1.2.2.1.1.3.2.3.cmml">K</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.3.1" xref="A3.Ex2.m1.2.2.1.1.3.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.3.2.cmml">s</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.3.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.2.cmml">​</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.2.1.cmml">[</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2.cmml">c</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2.cmml">+</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml">k</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mi id="A3.Ex2.m1.1.1" xref="A3.Ex2.m1.1.1.cmml">exp</mi><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1a" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.2" xref="A3.Ex2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex2.m1.2b"><apply id="A3.Ex2.m1.2.2.1.1.cmml" xref="A3.Ex2.m1.2.2.1"><and id="A3.Ex2.m1.2.2.1.1a.cmml" xref="A3.Ex2.m1.2.2.1"></and><apply id="A3.Ex2.m1.2.2.1.1b.cmml" xref="A3.Ex2.m1.2.2.1"><eq id="A3.Ex2.m1.2.2.1.1.5.cmml" xref="A3.Ex2.m1.2.2.1.1.5"></eq><apply id="A3.Ex2.m1.2.2.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1"><times id="A3.Ex2.m1.2.2.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.2"></times><ci id="A3.Ex2.m1.2.2.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.3">𝐿</ci><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3"><times id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1"></times><cn type="integer" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3">…</ci><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="A3.Ex2.m1.2.2.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2"><apply id="A3.Ex2.m1.2.2.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2">subscript</csymbol><sum id="A3.Ex2.m1.2.2.1.1.2.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.2"></sum><apply id="A3.Ex2.m1.2.2.1.1.2.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3"><eq id="A3.Ex2.m1.2.2.1.1.2.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.2.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.2">𝑖</ci><cn type="integer" id="A3.Ex2.m1.2.2.1.1.2.2.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.3">𝐾</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1"><times id="A3.Ex2.m1.2.2.1.1.2.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.2.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3.2">𝑠</ci><ci id="A3.Ex2.m1.2.2.1.1.2.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.1.4.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.1.4.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.1.4.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4.2">𝐿</ci><ci id="A3.Ex2.m1.2.2.1.1.2.1.4.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2">𝑟</ci><apply id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3"><times id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1"></times><cn type="integer" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2">1</cn><ci id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3">…</ci><ci id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4">𝑀</ci></apply></apply></apply></apply></apply><apply id="A3.Ex2.m1.2.2.1.1c.cmml" xref="A3.Ex2.m1.2.2.1"><eq id="A3.Ex2.m1.2.2.1.1.6.cmml" xref="A3.Ex2.m1.2.2.1.1.6"></eq><share href="#A3.Ex2.m1.2.2.1.1.2.cmml" id="A3.Ex2.m1.2.2.1.1d.cmml" xref="A3.Ex2.m1.2.2.1"></share><apply id="A3.Ex2.m1.2.2.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3"><apply id="A3.Ex2.m1.2.2.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.3.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2">subscript</csymbol><sum id="A3.Ex2.m1.2.2.1.1.3.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.2"></sum><apply id="A3.Ex2.m1.2.2.1.1.3.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3"><eq id="A3.Ex2.m1.2.2.1.1.3.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.3.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.2">𝑖</ci><cn type="integer" id="A3.Ex2.m1.2.2.1.1.3.2.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.3.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.3">𝐾</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1"><times id="A3.Ex2.m1.2.2.1.1.3.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.3.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3.2">𝑠</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1"><csymbol cd="latexml" id="A3.Ex2.m1.2.2.1.1.3.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.2">delimited-[]</csymbol><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1"><plus id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2"></plus><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2">𝑐</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1"><times id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2">𝑘</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1"><exp id="A3.Ex2.m1.1.1.cmml" xref="A3.Ex2.m1.1.1"></exp><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1"><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3"><eq id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2"><times id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3"><times id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex2.m1.2c">L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A3.p1.6" class="ltx_p">where <math id="A3.p1.1.m1.1" class="ltx_Math" alttext="r_{1\dots M}" display="inline"><semantics id="A3.p1.1.m1.1a"><msub id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml"><mi id="A3.p1.1.m1.1.1.2" xref="A3.p1.1.m1.1.1.2.cmml">r</mi><mrow id="A3.p1.1.m1.1.1.3" xref="A3.p1.1.m1.1.1.3.cmml"><mn id="A3.p1.1.m1.1.1.3.2" xref="A3.p1.1.m1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.p1.1.m1.1.1.3.1" xref="A3.p1.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="A3.p1.1.m1.1.1.3.3" xref="A3.p1.1.m1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="A3.p1.1.m1.1.1.3.1a" xref="A3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A3.p1.1.m1.1.1.3.4" xref="A3.p1.1.m1.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><apply id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p1.1.m1.1.1.1.cmml" xref="A3.p1.1.m1.1.1">subscript</csymbol><ci id="A3.p1.1.m1.1.1.2.cmml" xref="A3.p1.1.m1.1.1.2">𝑟</ci><apply id="A3.p1.1.m1.1.1.3.cmml" xref="A3.p1.1.m1.1.1.3"><times id="A3.p1.1.m1.1.1.3.1.cmml" xref="A3.p1.1.m1.1.1.3.1"></times><cn type="integer" id="A3.p1.1.m1.1.1.3.2.cmml" xref="A3.p1.1.m1.1.1.3.2">1</cn><ci id="A3.p1.1.m1.1.1.3.3.cmml" xref="A3.p1.1.m1.1.1.3.3">…</ci><ci id="A3.p1.1.m1.1.1.3.4.cmml" xref="A3.p1.1.m1.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">r_{1\dots M}</annotation></semantics></math> are mixture proportions on <math id="A3.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A3.p1.2.m2.1a"><mi id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><ci id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">M</annotation></semantics></math> training domains, <math id="A3.p1.3.m3.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="A3.p1.3.m3.1a"><msub id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml"><mi id="A3.p1.3.m3.1.1.2" xref="A3.p1.3.m3.1.1.2.cmml">L</mi><mi id="A3.p1.3.m3.1.1.3" xref="A3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><apply id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A3.p1.3.m3.1.1.1.cmml" xref="A3.p1.3.m3.1.1">subscript</csymbol><ci id="A3.p1.3.m3.1.1.2.cmml" xref="A3.p1.3.m3.1.1.2">𝐿</ci><ci id="A3.p1.3.m3.1.1.3.cmml" xref="A3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">L_{i}</annotation></semantics></math> are validation loss on <math id="A3.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.p1.4.m4.1a"><mi id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.1b"><ci id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.1c">K</annotation></semantics></math> implicit domains with <math id="A3.p1.5.m5.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="A3.p1.5.m5.1a"><msub id="A3.p1.5.m5.1.1" xref="A3.p1.5.m5.1.1.cmml"><mi id="A3.p1.5.m5.1.1.2" xref="A3.p1.5.m5.1.1.2.cmml">s</mi><mi id="A3.p1.5.m5.1.1.3" xref="A3.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.5.m5.1b"><apply id="A3.p1.5.m5.1.1.cmml" xref="A3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A3.p1.5.m5.1.1.1.cmml" xref="A3.p1.5.m5.1.1">subscript</csymbol><ci id="A3.p1.5.m5.1.1.2.cmml" xref="A3.p1.5.m5.1.1.2">𝑠</ci><ci id="A3.p1.5.m5.1.1.3.cmml" xref="A3.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m5.1c">s_{i}</annotation></semantics></math> as their weight in the overall validation set, and <math id="A3.p1.6.m6.2" class="ltx_Math" alttext="c_{i},t_{ij}" display="inline"><semantics id="A3.p1.6.m6.2a"><mrow id="A3.p1.6.m6.2.2.2" xref="A3.p1.6.m6.2.2.3.cmml"><msub id="A3.p1.6.m6.1.1.1.1" xref="A3.p1.6.m6.1.1.1.1.cmml"><mi id="A3.p1.6.m6.1.1.1.1.2" xref="A3.p1.6.m6.1.1.1.1.2.cmml">c</mi><mi id="A3.p1.6.m6.1.1.1.1.3" xref="A3.p1.6.m6.1.1.1.1.3.cmml">i</mi></msub><mo id="A3.p1.6.m6.2.2.2.3" xref="A3.p1.6.m6.2.2.3.cmml">,</mo><msub id="A3.p1.6.m6.2.2.2.2" xref="A3.p1.6.m6.2.2.2.2.cmml"><mi id="A3.p1.6.m6.2.2.2.2.2" xref="A3.p1.6.m6.2.2.2.2.2.cmml">t</mi><mrow id="A3.p1.6.m6.2.2.2.2.3" xref="A3.p1.6.m6.2.2.2.2.3.cmml"><mi id="A3.p1.6.m6.2.2.2.2.3.2" xref="A3.p1.6.m6.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.6.m6.2.2.2.2.3.1" xref="A3.p1.6.m6.2.2.2.2.3.1.cmml">​</mo><mi id="A3.p1.6.m6.2.2.2.2.3.3" xref="A3.p1.6.m6.2.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.6.m6.2b"><list id="A3.p1.6.m6.2.2.3.cmml" xref="A3.p1.6.m6.2.2.2"><apply id="A3.p1.6.m6.1.1.1.1.cmml" xref="A3.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="A3.p1.6.m6.1.1.1.1.1.cmml" xref="A3.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="A3.p1.6.m6.1.1.1.1.2.cmml" xref="A3.p1.6.m6.1.1.1.1.2">𝑐</ci><ci id="A3.p1.6.m6.1.1.1.1.3.cmml" xref="A3.p1.6.m6.1.1.1.1.3">𝑖</ci></apply><apply id="A3.p1.6.m6.2.2.2.2.cmml" xref="A3.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="A3.p1.6.m6.2.2.2.2.1.cmml" xref="A3.p1.6.m6.2.2.2.2">subscript</csymbol><ci id="A3.p1.6.m6.2.2.2.2.2.cmml" xref="A3.p1.6.m6.2.2.2.2.2">𝑡</ci><apply id="A3.p1.6.m6.2.2.2.2.3.cmml" xref="A3.p1.6.m6.2.2.2.2.3"><times id="A3.p1.6.m6.2.2.2.2.3.1.cmml" xref="A3.p1.6.m6.2.2.2.2.3.1"></times><ci id="A3.p1.6.m6.2.2.2.2.3.2.cmml" xref="A3.p1.6.m6.2.2.2.2.3.2">𝑖</ci><ci id="A3.p1.6.m6.2.2.2.2.3.3.cmml" xref="A3.p1.6.m6.2.2.2.2.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m6.2c">c_{i},t_{ij}</annotation></semantics></math> are other parameters to fit.</p>
</div>
<figure id="A3.F10" class="ltx_figure ltx_align_floatright"><img src="/html/2403.16952/assets/figs/computation_graph.png" id="A3.F10.g1" class="ltx_graphics ltx_img_landscape" width="598" height="271" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>The computation graph of mixture law with implicit domain aggregation. We take an case of 3 training domains and 4 implicit validation domains as example.
The parameters correspond to the notations in Eqn.&nbsp;<a href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.
</figcaption>
</figure>
<div id="A3.p2" class="ltx_para ltx_noindent">
<p id="A3.p2.1" class="ltx_p">The mixture law boils down to a computation graph in Fig.&nbsp;<a href="#A3.F10" title="Figure 10 ‣ Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, which contains two layers.
The first layers predict the domain losses, while the second sums up the domain losses to obtain the overall validation loss.
In this way, the mixture law becomes a multilayer perception (MLP) with an exponential activation function.
In practice, we fit the mixture laws with implicit domain aggregation by fitting a multilayer perception with exponential activation and applying softmax to the output layer weights.
Additionally, considering the high variance of MLP, we further employ AdaBoost Regressor&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Drucker, <a href="#bib.bib16" title="" class="ltx_ref">1997</a>)</cite> for fitting the mixture laws to stabilize the predictions and improve their accuracy.</p>
</div>
<div id="A3.p3" class="ltx_para ltx_noindent">
<p id="A3.p3.1" class="ltx_p">Inspired by this perspective, we attribute the successful fitting of mixture law to two aspects.
First, the MLP with a sufficiently large hidden dimension is a universal approximator&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hornik et&nbsp;al., <a href="#bib.bib34" title="" class="ltx_ref">1989</a>)</cite> thus being able to fit the relationships between losses and mixture proportions.
Second, the mixture proportions are bounded between 0 and 1.
For this reason, predicting an unseen mixture is an interpolation problem, which is usually easier than extrapolation.</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.16951" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.16952" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+2403.16952">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.16952" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.16953" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 16:51:13 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>