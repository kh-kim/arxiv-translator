<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.16952] Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance</title><meta property="og:description" content="Pretraining data of large language models composes multiple domains (e.g., web texts, academic papers, codes), whose mixture proportions crucially impact the competence of outcome models.
While existing endeavors rely …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.16952">

<!--Generated on Fri Apr  5 16:51:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv-fonts.0.7.9.min.css"><link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv.0.7.9.min.css"><link media="all" rel="stylesheet" href="https://ar5iv.labs.arxiv.org/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jiasheng Ye<sup id="id9.9.id1" class="ltx_sup"><span id="id9.9.id1.1" class="ltx_text ltx_font_italic">1,</span></sup>  
Peiju Liu<sup id="id10.10.id2" class="ltx_sup"><span id="id10.10.id2.1" class="ltx_text ltx_font_italic">1,</span></sup><span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotemark: </span></span></span></span>  
Tianxiang Sun<sup id="id11.11.id3" class="ltx_sup"><span id="id11.11.id3.1" class="ltx_text ltx_font_italic">1</span></sup>  
Yunhua Zhou<sup id="id12.12.id4" class="ltx_sup">2</sup>  
Jun Zhan<sup id="id13.13.id5" class="ltx_sup"><span id="id13.13.id5.1" class="ltx_text ltx_font_italic">1</span></sup> 
Xipeng Qiu<sup id="id14.14.id6" class="ltx_sup"><span id="id14.14.id6.1" class="ltx_text ltx_font_italic">1,</span></sup>
<br class="ltx_break">
<br class="ltx_break"><span id="id15.15.id7" class="ltx_text ltx_font_typewriter">{jsye23,pjliu23}@m.fudan.edu.cn</span>&nbsp;&nbsp;&nbsp;<span id="id16.16.id8" class="ltx_text ltx_font_typewriter">zhouyunhua@pjlab.org.cn</span>&nbsp;&nbsp;
<span id="id17.17.id9" class="ltx_text ltx_font_typewriter">xpqiu@fudan.edu.cn
<br class="ltx_break"></span>
<sup id="id18.18.id10" class="ltx_sup"><span id="id18.18.id10.1" class="ltx_text ltx_font_italic">1</span></sup>Fudan University&nbsp;&nbsp;<sup id="id19.19.id11" class="ltx_sup"><span id="id19.19.id11.1" class="ltx_text ltx_font_italic">2</span></sup>Shanghai AI Laboratory
</span><span class="ltx_author_notes">Equal contribution.Corresponding author.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id20.id1">대형 언어 모델의 사전 훈련 데이터는 여러 도메인(예: 웹 텍스트, 학술 논문, 코드)을 구성하며, 그 혼합 비율은 결과 모델의 역량에 결정적인 영향을 미친다. 기존의 노력은 비율을 조정하기 위해 휴리스틱 또는 정성적 전략에 의존하지만, 우리는 함수 형태로 혼합 비율에 관한 모델 성능의 정량적 예측 가능성을 발견하며, 이를 <span class="ltx_text ltx_font_italic" id="id20.id1.1">데이터 혼합 법칙</span>이라고 한다. 샘플 혼합물에 이러한 기능을 피팅하면 실제 실행 전에 보이지 않는 혼합물에 대한 모델 성능이 공개되므로 이상적인 데이터 혼합물의 선택을 안내한다. 또한, 소규모 훈련만으로 다양한 혼합 환경에서 대규모 데이터에 대해 훈련된 대규모 모델의 성능을 예측할 수 있도록 훈련 단계, 모델 크기 및 데이터 혼합 법칙의 중첩 사용을 제안한다. 또한, 실험 결과는 RedPajama에서 100B 토큰에 대해 훈련된 1B 모델의 훈련 혼합물을 효과적으로 최적화하여 기본 혼합물에서 48% 더 많은 단계에 대해 훈련된 것과 유사한 성능을 달성함을 입증한다. 지속적인 훈련으로 데이터 혼합 법칙의 적용을 확장하면 치명적인 망각을 방지하고 동적 데이터 스케줄의 잠재력을 전망하는 임계 혼합 비율을 정확하게 예측한다. <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Codes and data are available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/yegcjs/mixinglaws" target="_blank" title="">https://github.com/yegcjs/mixinglaws</a>.</span></span></span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p1.1">대형 언어 모델(LLM)에 대한 사전 훈련 데이터는 일반적으로 영어에서 소수 언어 <cite class="ltx_cite ltx_citemacro_citep">(Doddapaneni et al., <a class="ltx_ref" href="#bib.bib14" title="">2021</a>; Li et al., <a class="ltx_ref" href="#bib.bib40" title="">2023</a>)</cite>, 캐주얼 대화에서 공식 학술 글 <cite class="ltx_cite ltx_citemacro_citep">(Taylor et al., <a class="ltx_ref" href="#bib.bib55" title="">2022</a>)</cite>, 텍스트에서 이미지 및 연설과 같은 양식 <cite class="ltx_cite ltx_citemacro_citep">(Zhan et al., <a class="ltx_ref" href="#bib.bib66" title="">2024</a>)</cite> 등 다양한 여러 도메인의 혼합물이다. 이러한 데이터는 서로 상호 작용하여 복잡한 상호 교환, 관련 없음 또는 모순 관계를 보여준다. <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="#bib.bib24" title="">2024</a>)</cite> 이는 광범위한 실무 경험 <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="#bib.bib22" title="">2020</a>; Gururangan et al., <a class="ltx_ref" href="#bib.bib25" title="">2020</a>; Zhou et al., <a class="ltx_ref" href="#bib.bib68" title="">2023</a>; Xie et al., <a class="ltx_ref" href="#bib.bib63" title="">2024a</a>)</cite>에 의해 강조된 바와 같이 모델 능력의 균형을 맞추면서 모델 능력의 균형을 맞추기 위해 훈련 데이터의 혼합 비율을 조정해야 하며, 따라서 결과 모델의 능력을 향상시킨다.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p2.1">그럼에도 불구하고 이상적인 훈련 데이터 혼합물을 파악하는 것은 여전히 어렵다. 대부분의 기존 관행은 구체적인 기준을 자세히 공개하지 않고 고품질 또는 과소 대표되는 데이터의 비율을 업샘플링하기 위해 휴리스틱을 통해 혼합물을 조정하며, 이러한 데이터 전략이 훈련 실행을 완료하기 전에 효과적인지 여부를 선행하기 어렵다. 주어진 평가 데이터 세트에 대한 모델 손실을 보여주는 스케일링 법칙의 발전에 힘입어 광범위한 변수에 대해 정량적으로 예측할 수 있습니다. <cite class="ltx_cite ltx_citemacro_citep">(Kaplan et al., <a class="ltx_ref" href="#bib.bib37" title="">2020</a>; Hoffmann et al., <a class="ltx_ref" href="#bib.bib33" title="">2022</a>)</cite> 혼합물 비율에도 이것이 적용되는지 여부를 궁금해합니다. 따라서 <span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p2.1.1">우리는 최소 손실에 도달하는 원하는 변수를 포함하여 실제로 혼합물에 대해 훈련하기 전에 어떤 혼합물이라도 주어진 결과 모델 성능을 추정할 수 있습니다. </span></p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p3.1">본 논문에서는 이 명제에 대해 긍정적으로 답변한다. 우리는 <math alttext="M" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">M</annotation></semantics></math> 도메인의 혼합물이 주어지면 비율의 선형 조합에 대한 지수 함수, 즉</p>
<table id="S1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E1.m1.2" class="ltx_Math" alttext="L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)}," display="block"><semantics id="S1.E1.m1.2a"><mrow id="S1.E1.m1.2.2.1" xref="S1.E1.m1.2.2.1.1.cmml"><mrow id="S1.E1.m1.2.2.1.1" xref="S1.E1.m1.2.2.1.1.cmml"><mrow id="S1.E1.m1.2.2.1.1.1" xref="S1.E1.m1.2.2.1.1.1.cmml"><msub id="S1.E1.m1.2.2.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.3.cmml"><mi id="S1.E1.m1.2.2.1.1.1.3.2" xref="S1.E1.m1.2.2.1.1.1.3.2.cmml">L</mi><mi id="S1.E1.m1.2.2.1.1.1.3.3" xref="S1.E1.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S1.E1.m1.2.2.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.E1.m1.2.2.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S1.E1.m1.2.2.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mrow id="S1.E1.m1.2.2.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="S1.E1.m1.2.2.1.1.1.1.1.1.3.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.1.1.1.1.3.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S1.E1.m1.2.2.1.1.1.1.1.1.3.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.1.1.1.1.3.1a" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.3.4" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S1.E1.m1.2.2.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.E1.m1.2.2.1.1.3" xref="S1.E1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S1.E1.m1.2.2.1.1.2" xref="S1.E1.m1.2.2.1.1.2.cmml"><msub id="S1.E1.m1.2.2.1.1.2.3" xref="S1.E1.m1.2.2.1.1.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.3.2" xref="S1.E1.m1.2.2.1.1.2.3.2.cmml">c</mi><mi id="S1.E1.m1.2.2.1.1.2.3.3" xref="S1.E1.m1.2.2.1.1.2.3.3.cmml">i</mi></msub><mo id="S1.E1.m1.2.2.1.1.2.2" xref="S1.E1.m1.2.2.1.1.2.2.cmml">+</mo><mrow id="S1.E1.m1.2.2.1.1.2.1" xref="S1.E1.m1.2.2.1.1.2.1.cmml"><msub id="S1.E1.m1.2.2.1.1.2.1.3" xref="S1.E1.m1.2.2.1.1.2.1.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.3.2" xref="S1.E1.m1.2.2.1.1.2.1.3.2.cmml">k</mi><mi id="S1.E1.m1.2.2.1.1.2.1.3.3" xref="S1.E1.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S1.E1.m1.2.2.1.1.2.1.2" xref="S1.E1.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml"><mi id="S1.E1.m1.1.1" xref="S1.E1.m1.1.1.cmml">exp</mi><mo id="S1.E1.m1.2.2.1.1.2.1.1.1a" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml">⁡</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml"><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml">(</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.cmml"><munderover id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><msub id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml">​</mo><msub id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S1.E1.m1.2.2.1.2" xref="S1.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.2b"><apply id="S1.E1.m1.2.2.1.1.cmml" xref="S1.E1.m1.2.2.1"><eq id="S1.E1.m1.2.2.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.3"></eq><apply id="S1.E1.m1.2.2.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1"><times id="S1.E1.m1.2.2.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.2"></times><apply id="S1.E1.m1.2.2.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.1.3.2">𝐿</ci><ci id="S1.E1.m1.2.2.1.1.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3"><times id="S1.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.1"></times><cn type="integer" id="S1.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.3">…</ci><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="S1.E1.m1.2.2.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2"><plus id="S1.E1.m1.2.2.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.2"></plus><apply id="S1.E1.m1.2.2.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.3.2">𝑐</ci><ci id="S1.E1.m1.2.2.1.1.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.3.3">𝑖</ci></apply><apply id="S1.E1.m1.2.2.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1"><times id="S1.E1.m1.2.2.1.1.2.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.2"></times><apply id="S1.E1.m1.2.2.1.1.2.1.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3.2">𝑘</ci><ci id="S1.E1.m1.2.2.1.1.2.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S1.E1.m1.2.2.1.1.2.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1"><exp id="S1.E1.m1.1.1.cmml" xref="S1.E1.m1.1.1"></exp><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1"><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1">subscript</csymbol><sum id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2"></sum><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3"><eq id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1"></eq><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2"><times id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1"></times><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3"><times id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1"></times><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.2c">L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S1.p3.6">고정 모델 크기 및 트레이닝 데이터의 양 하에서 트레이닝 도메인들 중 임의의 도메인들 <math alttext="i" class="ltx_Math" display="inline" id="S1.p3.3.m2.1"><semantics id="S1.p3.3.m2.1a"><mi id="S1.p3.3.m2.1.1" xref="S1.p3.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.p3.3.m2.1b"><ci id="S1.p3.3.m2.1.1.cmml" xref="S1.p3.3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m2.1c">i</annotation></semantics></math>에 대한 검증 손실 <math alttext="L_{i}" class="ltx_Math" display="inline" id="S1.p3.2.m1.1"><semantics id="S1.p3.2.m1.1a"><msub id="S1.p3.2.m1.1.1" xref="S1.p3.2.m1.1.1.cmml"><mi id="S1.p3.2.m1.1.1.2" xref="S1.p3.2.m1.1.1.2.cmml">L</mi><mi id="S1.p3.2.m1.1.1.3" xref="S1.p3.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.2.m1.1b"><apply id="S1.p3.2.m1.1.1.cmml" xref="S1.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m1.1.1.1.cmml" xref="S1.p3.2.m1.1.1">subscript</csymbol><ci id="S1.p3.2.m1.1.1.2.cmml" xref="S1.p3.2.m1.1.1.2">𝐿</ci><ci id="S1.p3.2.m1.1.1.3.cmml" xref="S1.p3.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m1.1c">L_{i}</annotation></semantics></math>를 정확하게 예측할 수 있고, 여기서, <math alttext="r_{1\dots M}" class="ltx_Math" display="inline" id="S1.p3.4.m3.1"><semantics id="S1.p3.4.m3.1a"><msub id="S1.p3.4.m3.1.1" xref="S1.p3.4.m3.1.1.cmml"><mi id="S1.p3.4.m3.1.1.2" xref="S1.p3.4.m3.1.1.2.cmml">r</mi><mrow id="S1.p3.4.m3.1.1.3" xref="S1.p3.4.m3.1.1.3.cmml"><mn id="S1.p3.4.m3.1.1.3.2" xref="S1.p3.4.m3.1.1.3.2.cmml">1</mn><mo id="S1.p3.4.m3.1.1.3.1" lspace="0em" rspace="0em" xref="S1.p3.4.m3.1.1.3.1.cmml">​</mo><mi id="S1.p3.4.m3.1.1.3.3" mathvariant="normal" xref="S1.p3.4.m3.1.1.3.3.cmml">…</mi><mo id="S1.p3.4.m3.1.1.3.1a" lspace="0em" rspace="0em" xref="S1.p3.4.m3.1.1.3.1.cmml">​</mo><mi id="S1.p3.4.m3.1.1.3.4" xref="S1.p3.4.m3.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p3.4.m3.1b"><apply id="S1.p3.4.m3.1.1.cmml" xref="S1.p3.4.m3.1.1"><csymbol cd="ambiguous" id="S1.p3.4.m3.1.1.1.cmml" xref="S1.p3.4.m3.1.1">subscript</csymbol><ci id="S1.p3.4.m3.1.1.2.cmml" xref="S1.p3.4.m3.1.1.2">𝑟</ci><apply id="S1.p3.4.m3.1.1.3.cmml" xref="S1.p3.4.m3.1.1.3"><times id="S1.p3.4.m3.1.1.3.1.cmml" xref="S1.p3.4.m3.1.1.3.1"></times><cn id="S1.p3.4.m3.1.1.3.2.cmml" type="integer" xref="S1.p3.4.m3.1.1.3.2">1</cn><ci id="S1.p3.4.m3.1.1.3.3.cmml" xref="S1.p3.4.m3.1.1.3.3">…</ci><ci id="S1.p3.4.m3.1.1.3.4.cmml" xref="S1.p3.4.m3.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m3.1c">r_{1\dots M}</annotation></semantics></math>는 <math alttext="M" class="ltx_Math" display="inline" id="S1.p3.5.m4.1"><semantics id="S1.p3.5.m4.1a"><mi id="S1.p3.5.m4.1.1" xref="S1.p3.5.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p3.5.m4.1b"><ci id="S1.p3.5.m4.1.1.cmml" xref="S1.p3.5.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m4.1c">M</annotation></semantics></math> 도메인의 비율이고, <math alttext="c_{i},k_{i},t_{ij}" class="ltx_Math" display="inline" id="S1.p3.6.m5.3"><semantics id="S1.p3.6.m5.3a"><mrow id="S1.p3.6.m5.3.3.3" xref="S1.p3.6.m5.3.3.4.cmml"><msub id="S1.p3.6.m5.1.1.1.1" xref="S1.p3.6.m5.1.1.1.1.cmml"><mi id="S1.p3.6.m5.1.1.1.1.2" xref="S1.p3.6.m5.1.1.1.1.2.cmml">c</mi><mi id="S1.p3.6.m5.1.1.1.1.3" xref="S1.p3.6.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="S1.p3.6.m5.3.3.3.4" xref="S1.p3.6.m5.3.3.4.cmml">,</mo><msub id="S1.p3.6.m5.2.2.2.2" xref="S1.p3.6.m5.2.2.2.2.cmml"><mi id="S1.p3.6.m5.2.2.2.2.2" xref="S1.p3.6.m5.2.2.2.2.2.cmml">k</mi><mi id="S1.p3.6.m5.2.2.2.2.3" xref="S1.p3.6.m5.2.2.2.2.3.cmml">i</mi></msub><mo id="S1.p3.6.m5.3.3.3.5" xref="S1.p3.6.m5.3.3.4.cmml">,</mo><msub id="S1.p3.6.m5.3.3.3.3" xref="S1.p3.6.m5.3.3.3.3.cmml"><mi id="S1.p3.6.m5.3.3.3.3.2" xref="S1.p3.6.m5.3.3.3.3.2.cmml">t</mi><mrow id="S1.p3.6.m5.3.3.3.3.3" xref="S1.p3.6.m5.3.3.3.3.3.cmml"><mi id="S1.p3.6.m5.3.3.3.3.3.2" xref="S1.p3.6.m5.3.3.3.3.3.2.cmml">i</mi><mo id="S1.p3.6.m5.3.3.3.3.3.1" lspace="0em" rspace="0em" xref="S1.p3.6.m5.3.3.3.3.3.1.cmml">​</mo><mi id="S1.p3.6.m5.3.3.3.3.3.3" xref="S1.p3.6.m5.3.3.3.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.6.m5.3b"><list id="S1.p3.6.m5.3.3.4.cmml" xref="S1.p3.6.m5.3.3.3"><apply id="S1.p3.6.m5.1.1.1.1.cmml" xref="S1.p3.6.m5.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.6.m5.1.1.1.1.1.cmml" xref="S1.p3.6.m5.1.1.1.1">subscript</csymbol><ci id="S1.p3.6.m5.1.1.1.1.2.cmml" xref="S1.p3.6.m5.1.1.1.1.2">𝑐</ci><ci id="S1.p3.6.m5.1.1.1.1.3.cmml" xref="S1.p3.6.m5.1.1.1.1.3">𝑖</ci></apply><apply id="S1.p3.6.m5.2.2.2.2.cmml" xref="S1.p3.6.m5.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.6.m5.2.2.2.2.1.cmml" xref="S1.p3.6.m5.2.2.2.2">subscript</csymbol><ci id="S1.p3.6.m5.2.2.2.2.2.cmml" xref="S1.p3.6.m5.2.2.2.2.2">𝑘</ci><ci id="S1.p3.6.m5.2.2.2.2.3.cmml" xref="S1.p3.6.m5.2.2.2.2.3">𝑖</ci></apply><apply id="S1.p3.6.m5.3.3.3.3.cmml" xref="S1.p3.6.m5.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.6.m5.3.3.3.3.1.cmml" xref="S1.p3.6.m5.3.3.3.3">subscript</csymbol><ci id="S1.p3.6.m5.3.3.3.3.2.cmml" xref="S1.p3.6.m5.3.3.3.3.2">𝑡</ci><apply id="S1.p3.6.m5.3.3.3.3.3.cmml" xref="S1.p3.6.m5.3.3.3.3.3"><times id="S1.p3.6.m5.3.3.3.3.3.1.cmml" xref="S1.p3.6.m5.3.3.3.3.3.1"></times><ci id="S1.p3.6.m5.3.3.3.3.3.2.cmml" xref="S1.p3.6.m5.3.3.3.3.3.2">𝑖</ci><ci id="S1.p3.6.m5.3.3.3.3.3.3.cmml" xref="S1.p3.6.m5.3.3.3.3.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m5.3c">c_{i},k_{i},t_{ij}</annotation></semantics></math>는 피팅할 파라미터이다. 평가된 모든 도메인에서 이러한 함수를 피팅하고 검증 데이터에서 비율에 따라 가중합을 계산하면 최종 검증 손실이 예측된다. 또한, 검증 비율을 학습 가능한 매개변수로 처리하면 검증 세트를 알려져 있는 도메인으로 명시적으로 분해하지 않고 종단 간에서 추정된 손실을 피팅할 수 있다.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p4.1">예측 가능성에도 불구하고 혼합물 비율과 유효성 검사 손실 간의 함수 또는 <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">데이터 혼합 법칙</span>은 단순화를 위해 서로 다른 혼합물을 사용하는 수많은 실행의 샘플을 필요로 합니다. 타겟 모델과 동일한 모델 크기 및 트레이닝 데이터의 양으로 이러한 실험을 실행하는 것은 불합리하게 비싸다. 다행히도 스케일링 법칙에 대한 유익한 연구는 작은 모델과 작은 데이터로 멱 법칙을 맞추는 것이 큰 모델과 데이터의 손실을 크기<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et al., <a class="ltx_ref" href="#bib.bib37" title="">2020</a>; Henighan et al., <a class="ltx_ref" href="#bib.bib30" title="">2020</a>; Hoffmann et al., <a class="ltx_ref" href="#bib.bib33" title="">2022</a>; Alabdulmohsin et al., <a class="ltx_ref" href="#bib.bib2" title="">2022</a>; OpenAI, <a class="ltx_ref" href="#bib.bib48" title="">2023</a>; Muennighoff et al., <a class="ltx_ref" href="#bib.bib47" title="">2024</a>; Bi et al., <a class="ltx_ref" href="#bib.bib7" title="">2024</a>)</cite> 순으로 효과적으로 예측한다는 인상적인 결과를 보여준다. 이를 기반으로 학습 단계, 모델 크기 및 데이터 혼합 법칙의 스케일링 법칙을 중첩 활용하는 파이프라인을 제안하여 저렴한 규모에서의 실험만으로 목표 모델 크기와 데이터 양에 대한 혼합 비율의 영향을 연구할 수 있다. <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="132" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">그림 1:</span>Illustration on our pipeline to optimize data mixture. <span class="ltx_text ltx_font_bold" id="S1.F1.3.1">Left:</span> 우리 파이프라인은 세 단계를 거칩니다. 세 단계는 소규모 훈련 결과에서 시작하여 훈련 단계, 모델 크기 및 데이터 혼합 법칙의 스케일링 법칙을 사용하여 각각 큰 단계, 큰 모델 및 보이지 않는 혼합물에 대한 모델 성능을 예측한다.</figcaption>
<span id="S1.F1.4.2" class="ltx_text ltx_font_bold">Right:</span> Visualization of the three-step pipeline to predict model performance on the target model size, training step, and mixtures.
</figcaption>
</figure>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p5.1">실험 결과는 데이터 혼합 법칙과 예측 파이프라인의 신뢰성을 검증한다. 전체 유효성 검사 손실을 예측하여 100B 토큰으로 훈련된 1B 모델에 대해 RedPajama의 훈련 혼합물을 최적화하고 48% 더 많은 단계에 대해 기본 혼합물에서 훈련된 모델과 유사한 성능을 달성한다. 도메인별 유효성 검사 세트에 대한 예측은 또한 모델 기능의 균형에 대한 그럴듯한 참조를 제공한다. 지속적인 사전 훈련에 우리의 데이터 혼합 법칙을 더 적용하면 재앙적인 망각 <cite class="ltx_cite ltx_citemacro_citep">(French, <a class="ltx_ref" href="#bib.bib20" title="">1999</a>; Kirkpatrick et al., <a class="ltx_ref" href="#bib.bib38" title="">2017</a>; Luo et al., <a class="ltx_ref" href="#bib.bib43" title="">2023</a>)</cite>를 피할 수 있는 비율을 정확하게 찾을 수 있으며, 다단계 관련 지침을 위한 데이터 혼합 법칙의 적용 가능성과 이에 따른 동적 데이터 일정을 밝힐 수 있다.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.p6.1">전반적으로 우리의 기여와 결과는 다음과 같다.</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i1.p1.1">데이터 혼합에 대한 모델 성능의 정량적 예측 가능성을 발견하고 이를 함수 관계, 즉 데이터 혼합 법칙으로 요약한다.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p class="ltx_p" id="S1.I1.i2.p1.1">다양한 혼합 비율에 대한 대규모 훈련의 모델 성능을 예측하는 파이프라인을 제안하지만, 훈련 단계, 모델 크기 및 데이터 혼합 법칙의 스케일링 법칙을 중첩하여 훈련 데이터가 적은 소규모 모델에 대해서만 실험한다.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S1.I1.i3.p1.1">데이터 믹싱 법칙과 예측 파이프라인의 신뢰성을 검증하여 모델 성능 최적화, 모델 성능 균형, 데이터 스케줄 설계 지침의 전망을 보여준다.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S2.p1.1">우리는 대규모 언어 모델의 사전 훈련 과정을 간략하게 검토하고 신경 스케일링 법칙의 주요 결과를 요약한 다음, 우리가 연구하는 문제를 공식화한다. 더 많은 관련 업무는 Sec을 참고하시기 바랍니다. <a class="ltx_ref" href="#S6" title="6 Related Work ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Pretraining large language models.</h4>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px1.p1.5" class="ltx_p">We consider the task of pretraining an autoregressive language model <math id="S2.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="p_{\theta}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">p</mi><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑝</ci><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">p_{\theta}</annotation></semantics></math> via next-token predictions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a href="#bib.bib50" title="" class="ltx_ref">2018</a>)</cite>. The training dataset <math id="S2.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mbox{train}}=\{\mathcal{D}_{i}\}_{i=1}^{M}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">𝒟</mi><mtext id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3a.cmml">train</mtext></msub><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">=</mo><msubsup id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1"><eq id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2"></eq><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2">𝒟</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3a.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3"><mtext mathsize="70%" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3">train</mtext></ci></apply><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1">subscript</csymbol><set id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1"><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3"><eq id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">\mathcal{D}_{\mbox{train}}=\{\mathcal{D}_{i}\}_{i=1}^{M}</annotation></semantics></math> composes <math id="S2.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">M</annotation></semantics></math> domains with mixture proportions <math id="S2.SS0.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="\bm{r}\in\Delta^{M-1}" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.4.m4.1a"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml">𝒓</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi mathvariant="normal" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">Δ</mi><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml">M</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml">−</mo><mn id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m4.1b"><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1"><in id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1"></in><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2">𝒓</ci><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2">Δ</ci><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3"><minus id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1"></minus><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2">𝑀</ci><cn type="integer" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m4.1c">\bm{r}\in\Delta^{M-1}</annotation></semantics></math>. In each training step, the task first samples a batch of domain indices according to the mixture proportions and then sample sequences of <math id="S2.SS0.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.5.m5.1a"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.5.m5.1b"><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.5.m5.1c">L</annotation></semantics></math> tokens from the sampled domains. Using the sampled data, it learns to optimize the negative log-likelihood of sampled data, i.e.,</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.3" class="ltx_Math" alttext="\mathcal{L}_{\theta}=\mathbb{E}_{i\sim\bm{r},x_{0\dots L}\sim D_{i}}\left[-\sum_{j=1}^{L}\log P_{\theta}(x_{j}|x_{0\dots j-1})\right]." display="block"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.3.3.1.1.3.2" xref="S2.E2.m1.3.3.1.1.3.2.cmml">ℒ</mi><mi id="S2.E2.m1.3.3.1.1.3.3" xref="S2.E2.m1.3.3.1.1.3.3.cmml">θ</mi></msub><mo id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.3.cmml"><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">∼</mo><mi id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3.cmml">𝒓</mi></mrow><mo id="S2.E2.m1.2.2.2.2.3" xref="S2.E2.m1.2.2.2.3a.cmml">,</mo><mrow id="S2.E2.m1.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.cmml"><msub id="S2.E2.m1.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.2.cmml">x</mi><mrow id="S2.E2.m1.2.2.2.2.2.2.3" xref="S2.E2.m1.2.2.2.2.2.2.3.cmml"><mn id="S2.E2.m1.2.2.2.2.2.2.3.2" xref="S2.E2.m1.2.2.2.2.2.2.3.2.cmml">0</mn><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.2.2.2.3.1" xref="S2.E2.m1.2.2.2.2.2.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S2.E2.m1.2.2.2.2.2.2.3.3" xref="S2.E2.m1.2.2.2.2.2.2.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.2.2.2.2.3.1a" xref="S2.E2.m1.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.E2.m1.2.2.2.2.2.2.3.4" xref="S2.E2.m1.2.2.2.2.2.2.3.4.cmml">L</mi></mrow></msub><mo id="S2.E2.m1.2.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.2.1.cmml">∼</mo><msub id="S2.E2.m1.2.2.2.2.2.3" xref="S2.E2.m1.2.2.2.2.2.3.cmml"><mi id="S2.E2.m1.2.2.2.2.2.3.2" xref="S2.E2.m1.2.2.2.2.2.3.2.cmml">D</mi><mi id="S2.E2.m1.2.2.2.2.2.3.3" xref="S2.E2.m1.2.2.2.2.2.3.3.cmml">i</mi></msub></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.1a" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><munderover id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">L</mi></munderover><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3a" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">0</mn><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1a" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml">​</mo><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4.cmml">j</mi></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E2.m1.3.3.1.2" xref="S2.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2"></eq><apply id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2">ℒ</ci><ci id="S2.E2.m1.3.3.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.3.3">𝜃</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.2"></times><apply id="S2.E2.m1.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.3a.cmml" xref="S2.E2.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">similar-to</csymbol><ci id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2">𝑖</ci><ci id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">𝒓</ci></apply><apply id="S2.E2.m1.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2"><csymbol cd="latexml" id="S2.E2.m1.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.1">similar-to</csymbol><apply id="S2.E2.m1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2.2">𝑥</ci><apply id="S2.E2.m1.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3"><times id="S2.E2.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.1"></times><cn type="integer" id="S2.E2.m1.2.2.2.2.2.2.3.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.2">0</cn><ci id="S2.E2.m1.2.2.2.2.2.2.3.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.3">…</ci><ci id="S2.E2.m1.2.2.2.2.2.2.3.4.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.4">𝐿</ci></apply></apply><apply id="S2.E2.m1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.2.3.1.cmml" xref="S2.E2.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.2.3.2.cmml" xref="S2.E2.m1.2.2.2.2.2.3.2">𝐷</ci><ci id="S2.E2.m1.2.2.2.2.2.3.3.cmml" xref="S2.E2.m1.2.2.2.2.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.E2.m1.3.3.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"><minus id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"></minus><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1"><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3"><eq id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3"><log id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1"></log><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2">𝑃</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2"><times id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1"></times><cn type="integer" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">0</cn><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">…</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4">𝑗</ci></apply><cn type="integer" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\mathcal{L}_{\theta}=\mathbb{E}_{i\sim\bm{r},x_{0\dots L}\sim D_{i}}\left[-\sum_{j=1}^{L}\log P_{\theta}(x_{j}|x_{0\dots j-1})\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS0.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.1">학습된 모델을 평가하기 위해 검증 데이터 <math alttext="\mathcal{D}_{\mbox{val}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p2.1.m1.1a"><msub id="S2.SS0.SSS0.Px1.p2.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3a.cmml">val</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2">𝒟</ci><ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3a.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3"><mtext id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3">val</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.1.m1.1c">\mathcal{D}_{\mbox{val}}</annotation></semantics></math>에 대한 손실을 계산한다.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Scaling laws.</h4>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.2">광범위한 팩터들 <math alttext="x" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.1.m1.1c">x</annotation></semantics></math>, 스케일링 법칙들 <cite class="ltx_cite ltx_citemacro_citep">(Kaplan et al., <a class="ltx_ref" href="#bib.bib37" title="">2020</a>; Henighan et al., <a class="ltx_ref" href="#bib.bib30" title="">2020</a>; Hoffmann et al., <a class="ltx_ref" href="#bib.bib33" title="">2022</a>)</cite>에 대해, 사전 트레이닝된 모델의 손실 <math alttext="L" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.2.m2.1c">L</annotation></semantics></math>에 대한 그들의 영향이 파워 법칙들을 따른다는 것을 보여준다.</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.1" class="ltx_Math" alttext="L=c+kx^{\alpha}," display="block"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml">L</mi><mo id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml">c</mi><mo id="S2.E3.m1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.3.2" xref="S2.E3.m1.1.1.1.1.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.3.3.1" xref="S2.E3.m1.1.1.1.1.3.3.1.cmml">​</mo><msup id="S2.E3.m1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.3.3.2" xref="S2.E3.m1.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.E3.m1.1.1.1.1.3.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.3.cmml">α</mi></msup></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"></eq><ci id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2">𝐿</ci><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><plus id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.1"></plus><ci id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2">𝑐</ci><apply id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3"><times id="S2.E3.m1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.1"></times><ci id="S2.E3.m1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2">𝑘</ci><apply id="S2.E3.m1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.E3.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3.3">𝛼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">L=c+kx^{\alpha},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.6">여기서, <math alttext="c" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.3.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.3.m1.1a"><mi id="S2.SS0.SSS0.Px2.p1.3.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.3.m1.1b"><ci id="S2.SS0.SSS0.Px2.p1.3.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.3.m1.1c">c</annotation></semantics></math>, <math alttext="k" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.4.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.4.m2.1a"><mi id="S2.SS0.SSS0.Px2.p1.4.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.4.m2.1b"><ci id="S2.SS0.SSS0.Px2.p1.4.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.4.m2.1c">k</annotation></semantics></math>, <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.5.m3.1"><semantics id="S2.SS0.SSS0.Px2.p1.5.m3.1a"><mi id="S2.SS0.SSS0.Px2.p1.5.m3.1.1" xref="S2.SS0.SSS0.Px2.p1.5.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.5.m3.1b"><ci id="S2.SS0.SSS0.Px2.p1.5.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.5.m3.1c">\alpha</annotation></semantics></math>는 피팅할 파라미터이고, <math alttext="x" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.6.m4.1"><semantics id="S2.SS0.SSS0.Px2.p1.6.m4.1a"><mi id="S2.SS0.SSS0.Px2.p1.6.m4.1.1" xref="S2.SS0.SSS0.Px2.p1.6.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.6.m4.1b"><ci id="S2.SS0.SSS0.Px2.p1.6.m4.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.6.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.6.m4.1c">x</annotation></semantics></math>는 모델 사이즈, 트레이닝 데이터의 수, 트레이닝 스텝<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span> The training step law <cite class="ltx_cite ltx_citemacro_citep">(Kaplan et al., <a class="ltx_ref" href="#bib.bib37" title="">2020</a>)</cite> refers to the function between the intermediate training step and its corresponding loss <span class="ltx_text ltx_font_italic" id="footnote2.1">in one single training run</span>. For clarity, we highlight its difference from the data scaling law that predicts the early exit loss <cite class="ltx_cite ltx_citemacro_citep">(Kaplan et al., <a class="ltx_ref" href="#bib.bib37" title="">2020</a>)</cite> or the loss obtained with optimal hyperparameters for each data budget <cite class="ltx_cite ltx_citemacro_citep">(Hoffmann et al., <a class="ltx_ref" href="#bib.bib33" title="">2022</a>)</cite>. </span></span></span>, 및 연산량일 수 있다. 이전 경험 <cite class="ltx_cite ltx_citemacro_citep">(Alabdulmohsin et al., <a class="ltx_ref" href="#bib.bib2" title="">2022</a>; OpenAI, <a class="ltx_ref" href="#bib.bib48" title="">2023</a>; Bi et al., <a class="ltx_ref" href="#bib.bib7" title="">2024</a>; Su et al., <a class="ltx_ref" href="#bib.bib54" title="">2024</a>)</cite>는 스케일링 법칙의 인상적인 예측 가능성을 강조한다. 구체적으로 Eqn. 작은 모델, 훈련 데이터 또는 계산의 모음에 장착된 <a class="ltx_ref" href="#S2.E3" title="In Scaling laws. ‣ 2 Background ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3</span></a>는 크기 순서에 따라 더 큰 경우의 테스트 손실을 정확하게 예측하기 위해 외삽할 수 있다. 이를 통해 실무자들은 고가의 실행을 실제로 끝내지 않고도 사전 훈련된 대형 언어 모델의 성능을 추정할 수 있다. 최근의 발전은 언어 모델의 성능과 더 나아가 전이 학습 <cite class="ltx_cite ltx_citemacro_citep">(Hernandez et al., <a class="ltx_ref" href="#bib.bib31" title="">2021</a>)</cite>, 희소 아키텍처 <cite class="ltx_cite ltx_citemacro_citep">(Frantar et al., <a class="ltx_ref" href="#bib.bib19" title="">2023</a>)</cite>, 반복 데이터 <cite class="ltx_cite ltx_citemacro_citep">(Muennighoff et al., <a class="ltx_ref" href="#bib.bib47" title="">2024</a>)</cite>와 같은 광범위한 요인 사이의 다양한 기능적 관계를 보여주며, 언어 모델 성능의 예측 가능성을 통합한다.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Problem formalization.</h4>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">우리는 대규모 언어 모델에 대한 사전 훈련 데이터의 혼합 비율 최적화를 연구한다. 기존 스케일링 법칙의 인상적인 예측 가능성에 동기되어 혼합물 비율이 주어진 손실을 예측하는 정량적 프레임워크를 설정하여 혼합물 최적화를 해결하려고 한다. 형식적으로 <math alttext="M" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px3.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.1.m1.1c">M</annotation></semantics></math> 도메인을 포함하는 훈련 데이터 세트의 경우 함수를 매개 변수화합니다.</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.2" class="ltx_Math" alttext="L=f_{\theta}(\bm{r})," display="block"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.2" xref="S2.E4.m1.2.2.1.1.2.cmml">L</mi><mo id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E4.m1.2.2.1.1.3" xref="S2.E4.m1.2.2.1.1.3.cmml"><msub id="S2.E4.m1.2.2.1.1.3.2" xref="S2.E4.m1.2.2.1.1.3.2.cmml"><mi id="S2.E4.m1.2.2.1.1.3.2.2" xref="S2.E4.m1.2.2.1.1.3.2.2.cmml">f</mi><mi id="S2.E4.m1.2.2.1.1.3.2.3" xref="S2.E4.m1.2.2.1.1.3.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.3.1" xref="S2.E4.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.3.3.2" xref="S2.E4.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.3.3.2.1" xref="S2.E4.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S2.E4.m1.2.2.1.1.3.3.2.2" xref="S2.E4.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><eq id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"></eq><ci id="S2.E4.m1.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2">𝐿</ci><apply id="S2.E4.m1.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.3"><times id="S2.E4.m1.2.2.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.3.1"></times><apply id="S2.E4.m1.2.2.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.2.1.cmml" xref="S2.E4.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.2.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2.2">𝑓</ci><ci id="S2.E4.m1.2.2.1.1.3.2.3.cmml" xref="S2.E4.m1.2.2.1.1.3.2.3">𝜃</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝒓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">L=f_{\theta}(\bm{r}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.3">고정 모델 크기 및 훈련 단계 수 하에서, <math alttext="\bm{r}=r_{1\dots M}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.2.m1.1"><semantics id="S2.SS0.SSS0.Px3.p1.2.m1.1a"><mrow id="S2.SS0.SSS0.Px3.p1.2.m1.1.1" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2.cmml">𝒓</mi><mo id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1.cmml">=</mo><msub id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2.cmml">r</mi><mrow id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.cmml"><mn id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1" lspace="0em" rspace="0em" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3.cmml">…</mi><mo id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1a" lspace="0em" rspace="0em" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4.cmml">M</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.2.m1.1b"><apply id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1"><eq id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1"></eq><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2">𝒓</ci><apply id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2">𝑟</ci><apply id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3"><times id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1"></times><cn id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2.cmml" type="integer" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2">1</cn><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3">…</ci><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.2.m1.1c">\bm{r}=r_{1\dots M}</annotation></semantics></math>는 <math alttext="M" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.3.m2.1"><semantics id="S2.SS0.SSS0.Px3.p1.3.m2.1a"><mi id="S2.SS0.SSS0.Px3.p1.3.m2.1.1" xref="S2.SS0.SSS0.Px3.p1.3.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.3.m2.1b"><ci id="S2.SS0.SSS0.Px3.p1.3.m2.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.3.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.3.m2.1c">M</annotation></semantics></math> 도메인의 비율이다. 이 기능을 활용하면 원하는 성능을 달성하는 혼합물을 추구합니다. 일반성의 손실 없이 최소 검증 손실에 도달하는 혼합물, 즉, 혼합물을 검색한다.</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.2" class="ltx_Math" alttext="\bm{r}^{*}={\arg\min}_{\bm{r}}f_{\theta}(\bm{r})." display="block"><semantics id="S2.E5.m1.2a"><mrow id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.1.cmml"><mrow id="S2.E5.m1.2.2.1.1" xref="S2.E5.m1.2.2.1.1.cmml"><msup id="S2.E5.m1.2.2.1.1.2" xref="S2.E5.m1.2.2.1.1.2.cmml"><mi id="S2.E5.m1.2.2.1.1.2.2" xref="S2.E5.m1.2.2.1.1.2.2.cmml">𝒓</mi><mo id="S2.E5.m1.2.2.1.1.2.3" xref="S2.E5.m1.2.2.1.1.2.3.cmml">∗</mo></msup><mo id="S2.E5.m1.2.2.1.1.1" xref="S2.E5.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E5.m1.2.2.1.1.3" xref="S2.E5.m1.2.2.1.1.3.cmml"><mrow id="S2.E5.m1.2.2.1.1.3.2" xref="S2.E5.m1.2.2.1.1.3.2.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.1" xref="S2.E5.m1.2.2.1.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E5.m1.2.2.1.1.3.2a" xref="S2.E5.m1.2.2.1.1.3.2.cmml">⁡</mo><mrow id="S2.E5.m1.2.2.1.1.3.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.cmml"><munder id="S2.E5.m1.2.2.1.1.3.2.2.1" xref="S2.E5.m1.2.2.1.1.3.2.2.1.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.2.1.2" xref="S2.E5.m1.2.2.1.1.3.2.2.1.2.cmml">min</mi><mi id="S2.E5.m1.2.2.1.1.3.2.2.1.3" xref="S2.E5.m1.2.2.1.1.3.2.2.1.3.cmml">𝒓</mi></munder><mo lspace="0.167em" id="S2.E5.m1.2.2.1.1.3.2.2a" xref="S2.E5.m1.2.2.1.1.3.2.2.cmml">⁡</mo><msub id="S2.E5.m1.2.2.1.1.3.2.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.2.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.2.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.2.2.cmml">f</mi><mi id="S2.E5.m1.2.2.1.1.3.2.2.2.3" xref="S2.E5.m1.2.2.1.1.3.2.2.2.3.cmml">θ</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.3.1" xref="S2.E5.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S2.E5.m1.2.2.1.1.3.3.2" xref="S2.E5.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S2.E5.m1.2.2.1.1.3.3.2.1" xref="S2.E5.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S2.E5.m1.2.2.1.1.3.3.2.2" xref="S2.E5.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E5.m1.2.2.1.2" xref="S2.E5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1"><eq id="S2.E5.m1.2.2.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1"></eq><apply id="S2.E5.m1.2.2.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.2.1.cmml" xref="S2.E5.m1.2.2.1.1.2">superscript</csymbol><ci id="S2.E5.m1.2.2.1.1.2.2.cmml" xref="S2.E5.m1.2.2.1.1.2.2">𝒓</ci><times id="S2.E5.m1.2.2.1.1.2.3.cmml" xref="S2.E5.m1.2.2.1.1.2.3"></times></apply><apply id="S2.E5.m1.2.2.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.3"><times id="S2.E5.m1.2.2.1.1.3.1.cmml" xref="S2.E5.m1.2.2.1.1.3.1"></times><apply id="S2.E5.m1.2.2.1.1.3.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2"><arg id="S2.E5.m1.2.2.1.1.3.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.1"></arg><apply id="S2.E5.m1.2.2.1.1.3.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2"><apply id="S2.E5.m1.2.2.1.1.3.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1">subscript</csymbol><min id="S2.E5.m1.2.2.1.1.3.2.2.1.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1.2"></min><ci id="S2.E5.m1.2.2.1.1.3.2.2.1.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1.3">𝒓</ci></apply><apply id="S2.E5.m1.2.2.1.1.3.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2.2">𝑓</ci><ci id="S2.E5.m1.2.2.1.1.3.2.2.2.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2.3">𝜃</ci></apply></apply></apply><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝒓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">\bm{r}^{*}={\arg\min}_{\bm{r}}f_{\theta}(\bm{r}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The proportions of data mixtures influence model losses in a quantitatively predictable way</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.p1.1">이 절에서는 데이터 혼합 법칙이라고 하는 함수 관계로 요약되는 데이터 혼합물에 대한 모델 손실의 예측 가능성에 대한 연구 결과를 제시한다.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.p2.1">데이터 혼합 법칙을 발견하기 위해 우리는 그들의 특성에 의해 제기되는 두 가지 문제에 직면한다.</p>
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(i)</span> 
<div id="S3.I1.ix1.p1" class="ltx_para">
<p class="ltx_p" id="S3.I1.ix1.p1.3"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.I1.ix1.p1.3.1">Multi-variables. </span> <math alttext="K" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.1.m1.1"><semantics id="S3.I1.ix1.p1.1.m1.1a"><mi id="S3.I1.ix1.p1.1.m1.1.1" xref="S3.I1.ix1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.1.m1.1b"><ci id="S3.I1.ix1.p1.1.m1.1.1.cmml" xref="S3.I1.ix1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.1.m1.1c">K</annotation></semantics></math> 도메인에 대한 데이터 혼합 법칙에 대해, 우리는 혼합 비율에서 <math alttext="K-1" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.2.m2.1"><semantics id="S3.I1.ix1.p1.2.m2.1a"><mrow id="S3.I1.ix1.p1.2.m2.1.1" xref="S3.I1.ix1.p1.2.m2.1.1.cmml"><mi id="S3.I1.ix1.p1.2.m2.1.1.2" xref="S3.I1.ix1.p1.2.m2.1.1.2.cmml">K</mi><mo id="S3.I1.ix1.p1.2.m2.1.1.1" xref="S3.I1.ix1.p1.2.m2.1.1.1.cmml">−</mo><mn id="S3.I1.ix1.p1.2.m2.1.1.3" xref="S3.I1.ix1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.2.m2.1b"><apply id="S3.I1.ix1.p1.2.m2.1.1.cmml" xref="S3.I1.ix1.p1.2.m2.1.1"><minus id="S3.I1.ix1.p1.2.m2.1.1.1.cmml" xref="S3.I1.ix1.p1.2.m2.1.1.1"></minus><ci id="S3.I1.ix1.p1.2.m2.1.1.2.cmml" xref="S3.I1.ix1.p1.2.m2.1.1.2">𝐾</ci><cn id="S3.I1.ix1.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.I1.ix1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.2.m2.1c">K-1</annotation></semantics></math> 자유도 및 이에 대응하여 타겟 함수에서 <math alttext="K-1" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.3.m3.1"><semantics id="S3.I1.ix1.p1.3.m3.1a"><mrow id="S3.I1.ix1.p1.3.m3.1.1" xref="S3.I1.ix1.p1.3.m3.1.1.cmml"><mi id="S3.I1.ix1.p1.3.m3.1.1.2" xref="S3.I1.ix1.p1.3.m3.1.1.2.cmml">K</mi><mo id="S3.I1.ix1.p1.3.m3.1.1.1" xref="S3.I1.ix1.p1.3.m3.1.1.1.cmml">−</mo><mn id="S3.I1.ix1.p1.3.m3.1.1.3" xref="S3.I1.ix1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.3.m3.1b"><apply id="S3.I1.ix1.p1.3.m3.1.1.cmml" xref="S3.I1.ix1.p1.3.m3.1.1"><minus id="S3.I1.ix1.p1.3.m3.1.1.1.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.1"></minus><ci id="S3.I1.ix1.p1.3.m3.1.1.2.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.2">𝐾</ci><cn id="S3.I1.ix1.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.I1.ix1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.3.m3.1c">K-1</annotation></semantics></math> 변수를 고려해야 한다. 변수의 증가는 잠재적인 함수의 범위를 상당히 확대시켜 함수 형태의 식별을 복잡하게 만든다.</p>
</div>
</li>
<li id="S3.I1.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(ii)</span> 
<div id="S3.I1.ix2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.I1.ix2.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.I1.ix2.p1.1.1">Nonmonotonicity. </span> 손실과 모든 도메인의 비율 사이의 단조 관계는 편향된 혼합물이 도메인 비율의 균형을 맞추기 위한 노력 없이 최소 손실을 달성할 수 있음을 나타내며, 이는 관행과 모순된다. 따라서 기존의 스케일링 법칙과는 달리, 본 연구에서 연구된 데이터 믹싱 법칙은 비단조 함수를 수용해야 한다. 이 비단조적 성질은 우리의 분석에 또 다른 복잡성을 추가한다.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S3.p2.2">이러한 문제를 탐색하기 위해 손실과 혼합물 비율 사이의 관계가 일변량 단조 함수에 맞는 시나리오를 연구하여 처음에 문제를 단순화한 다음 단순화를 점진적으로 철회한다. 특히, 다중 변수를 피하기 위해 두 도메인에서만 훈련하고, 비 단조성을 피하기 위해 훈련 도메인 중 하나에서 오는 검증 데이터만 고려하는 경우에 대해 연구를 시작한다(Sec.<a class="ltx_ref" href="#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.1</span></a>). 이어서, 우리는 다중 도메인들에 대한 트레이닝을 포함하도록 프레임워크를 확장한다.(Sec. <a class="ltx_ref" href="#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.2</span></a>) 또한 다양한 도메인(Sec.<a class="ltx_ref" href="#S3.SS3" title="3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.3</span></a>)을 포함하는 일반 검증 데이터에 대한 손실의 예측 가능성을 탐색한다.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Pilot Study on Domain Losses under Two-domain Mixtures</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS1.p1.1">우리는 두 영역의 혼합물에서만 배우고 두 영역에서 각각 모델을 평가하는 가장 간단한 경우로 탐색을 시작한다.</p>
</div>
<figure id="S3.F2" class="ltx_figure ltx_align_floatright"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/figs/2mix.png" id="S3.F2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">그림 2:</span> Github와 Pile-CC의 두 도메인에 대한 도메인 손실의 정량적 예측 가능성.</figcaption>
We train on the mixtures of these two domains and validate the outcome models on them separately.
We train 70M and 160M models on five different mixtures of Github and Pile-CC and obtain the reducible losses by subtracting the original losses with a constant shared across models of the same sizes and trained for the same number of steps.
The reducible losses in log scale show linear correlations to the domain proportions.
</figcaption>
</figure>
<section id="S3.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Setups</h4>

<div id="S3.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.1">우리는 Github에 대해 {0.25, 0.375, 0.5, 0.625, 0.75}의 다섯 가지 다른 혼합 비율을 가진 Pile 데이터셋 <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="#bib.bib22" title="">2020</a>)</cite>에서 Github와 Pile-CC 하위 집합의 혼합물에 대해 70M 및 160M 언어 모델을 훈련한다. 총 30B 토큰인 30k 단계에 대해 1M 토큰의 배치 크기를 가진 모든 모델을 훈련하고 GitHub 및 Pile-CC의 유효성 검사 세트의 다른 단계에서 검사점을 평가합니다.</p>
</div>
</section>
<section id="S3.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Findings</h4>

<div id="S3.SS1.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.7">결과는 다음과 같다. <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">2</span></a>는 도메인 비율이 주어진 도메인 손실의 정량적 예측 가능성을 드러낸다. 우리는 동일한 크기를 가지고 동일한 수의 단계로 훈련된 체크포인트의 경우 공유 상수 <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>The loss function of language models is lower bounded by the entropy of the evaluation data theoretically <cite class="ltx_cite ltx_citemacro_citep">(Bishop, <a class="ltx_ref" href="#bib.bib9" title="">2006</a>; Henighan et al., <a class="ltx_ref" href="#bib.bib30" title="">2020</a>)</cite>. Thus, it is common to have constant terms in scaling laws, known as irreducible loss. </span></span></span>을 뺀 후 로그 규모에서 도메인 손실이 도메인 비율에 선형 관계를 나타낸다는 것을 고무적으로 발견했다. 이것은 실험에서 두 도메인에 모두 적용된다. 결과는 다른 요인이 고정된 경우 도메인 비율에 대한 사전 훈련된 언어 모델의 도메인 손실이 지수 법칙에 정확하게 적합함을 나타낸다.</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.2" class="ltx_Math" alttext="L_{i}(r_{i})=c_{i}+k_{i}\exp{\left(t_{ii}r_{i}\right)}," display="block"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.3.2.cmml">L</mi><mi id="S3.E6.m1.2.2.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.2.cmml"><msub id="S3.E6.m1.2.2.1.1.2.3" xref="S3.E6.m1.2.2.1.1.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.3.2" xref="S3.E6.m1.2.2.1.1.2.3.2.cmml">c</mi><mi id="S3.E6.m1.2.2.1.1.2.3.3" xref="S3.E6.m1.2.2.1.1.2.3.3.cmml">i</mi></msub><mo id="S3.E6.m1.2.2.1.1.2.2" xref="S3.E6.m1.2.2.1.1.2.2.cmml">+</mo><mrow id="S3.E6.m1.2.2.1.1.2.1" xref="S3.E6.m1.2.2.1.1.2.1.cmml"><msub id="S3.E6.m1.2.2.1.1.2.1.3" xref="S3.E6.m1.2.2.1.1.2.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.3.2" xref="S3.E6.m1.2.2.1.1.2.1.3.2.cmml">k</mi><mi id="S3.E6.m1.2.2.1.1.2.1.3.3" xref="S3.E6.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.1.2" xref="S3.E6.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">exp</mi><mo id="S3.E6.m1.2.2.1.1.2.1.1.1a" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml">⁡</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml"><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml">t</mi><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1"><eq id="S3.E6.m1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3"></eq><apply id="S3.E6.m1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1"><times id="S3.E6.m1.2.2.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.2"></times><apply id="S3.E6.m1.2.2.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.3.2">𝐿</ci><ci id="S3.E6.m1.2.2.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2"><plus id="S3.E6.m1.2.2.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2"></plus><apply id="S3.E6.m1.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.3.2">𝑐</ci><ci id="S3.E6.m1.2.2.1.1.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1"><times id="S3.E6.m1.2.2.1.1.2.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.2"></times><apply id="S3.E6.m1.2.2.1.1.2.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3.2">𝑘</ci><ci id="S3.E6.m1.2.2.1.1.2.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1"><exp id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"></exp><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1"><times id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1"></times><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2">𝑡</ci><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3"><times id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1"></times><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">L_{i}(r_{i})=c_{i}+k_{i}\exp{\left(t_{ii}r_{i}\right)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS0.Px2.p1.6" class="ltx_p">where <math id="S3.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">L</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝐿</ci><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.1.m1.1c">L_{i}</annotation></semantics></math> and <math id="S3.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="r_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2">𝑟</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.2.m2.1c">r_{i}</annotation></semantics></math> are validation loss and training mixture proportion of domain <math id="S3.SS1.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.3.m3.1c">i</annotation></semantics></math>, respectively, while <math id="S3.SS1.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.4.m4.1a"><msub id="S3.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.cmml">c</mi><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2">𝑐</ci><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.4.m4.1c">c_{i}</annotation></semantics></math>, <math id="S3.SS1.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="k_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.5.m5.1a"><msub id="S3.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml">k</mi><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2">𝑘</ci><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.5.m5.1c">k_{i}</annotation></semantics></math>, and <math id="S3.SS1.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="t_{ii}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.6.m6.1a"><msub id="S3.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml">t</mi><mrow id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2">𝑡</ci><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3"><times id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.6.m6.1c">t_{ii}</annotation></semantics></math> are learnable parameters&nbsp;<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span> Despite a simple case, our findings on two domains have practical applications to continue pretraining&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gururangan et&nbsp;al., <a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite>, where we aim to enhance a pretrained model on a given domain by training it on a mixture of the original pretraining data and upcoming domain data. Please see Sec.&nbsp;<a href="#S5" title="5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> for details. </span></span></span>.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Extension to Domain Losses Trained on Multi-domain Mixtures</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.p1.1">대부분 두 개 이상의 영역을 포함하는 실제 사전 훈련 데이터를 수용하기 위해 조사를 여러 영역으로 확장한다. 단순성과 시각 자료의 용이성을 위해 세 영역의 경우부터 시작한다.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">표 1:</span>타겟 도메인 손실들을 예측하기 위한 상이한 후보 함수들의 평균 절대 에러들(MAE).</figcaption>
We also include random guesses that randomly predict between the maximum and minimum loss of the training samples for reference. In specific, we report the MAE of the expectation of this random guess which predicts the median of the maximum and minimum loss.
The training data contain <math id="S3.T1.2.m1.1" class="ltx_Math" alttext="M=3" display="inline"><semantics id="S3.T1.2.m1.1b"><mrow id="S3.T1.2.m1.1.1" xref="S3.T1.2.m1.1.1.cmml"><mi id="S3.T1.2.m1.1.1.2" xref="S3.T1.2.m1.1.1.2.cmml">M</mi><mo id="S3.T1.2.m1.1.1.1" xref="S3.T1.2.m1.1.1.1.cmml">=</mo><mn id="S3.T1.2.m1.1.1.3" xref="S3.T1.2.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.m1.1c"><apply id="S3.T1.2.m1.1.1.cmml" xref="S3.T1.2.m1.1.1"><eq id="S3.T1.2.m1.1.1.1.cmml" xref="S3.T1.2.m1.1.1.1"></eq><ci id="S3.T1.2.m1.1.1.2.cmml" xref="S3.T1.2.m1.1.1.2">𝑀</ci><cn type="integer" id="S3.T1.2.m1.1.1.3.cmml" xref="S3.T1.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.m1.1d">M=3</annotation></semantics></math> domains and we fit each function with the same 24 mixtures and validate on 8 other mixtures. The split is random.
The lowest error for each target domain are in <span id="S3.T1.5.1" class="ltx_text ltx_font_bold">bold</span> while the second lowest are <span id="S3.T1.6.2" class="ltx_text ltx_framed ltx_framed_underline">underlined</span>.
</figcaption>
<div id="S3.T1.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:424.9pt;height:137.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(17.8pt,-5.8pt) scale(1.09154587119699,1.09154587119699) ;">
<table id="S3.T1.7.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.7.1.1.1" class="ltx_tr">
<td id="S3.T1.7.1.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S3.T1.7.1.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S3.T1.7.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S3.T1.7.1.1.1.3.1" class="ltx_text ltx_font_bold">GitHub</span></th>
<th id="S3.T1.7.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S3.T1.7.1.1.1.4.1" class="ltx_text ltx_font_bold">Books3</span></th>
<th id="S3.T1.7.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S3.T1.7.1.1.1.5.1" class="ltx_text ltx_font_bold">Pile-CC</span></th>
</tr>
<tr id="S3.T1.7.1.2.2" class="ltx_tr">
<th id="S3.T1.7.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.7.1.2.2.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S3.T1.7.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.7.1.2.2.2.1" class="ltx_text ltx_font_bold"># Coeff.</span></th>
<th id="S3.T1.7.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Train</th>
<th id="S3.T1.7.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Validation</th>
<th id="S3.T1.7.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Train</th>
<th id="S3.T1.7.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Validation</th>
<th id="S3.T1.7.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Train</th>
<th id="S3.T1.7.1.2.2.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t">Validation</th>
</tr>
<tr id="S3.T1.7.1.3.3" class="ltx_tr">
<td id="S3.T1.7.1.3.3.1" class="ltx_td ltx_align_center ltx_border_t">Random</td>
<td id="S3.T1.7.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S3.T1.7.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">0.8895</td>
<td id="S3.T1.7.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">0.8758</td>
<td id="S3.T1.7.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">0.1291</td>
<td id="S3.T1.7.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">0.1331</td>
<td id="S3.T1.7.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">0.0768</td>
<td id="S3.T1.7.1.3.3.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">0.1045</td>
</tr>
<tr id="S3.T1.7.1.4.4" class="ltx_tr">
<td id="S3.T1.7.1.4.4.1" class="ltx_td ltx_align_center">M1</td>
<td id="S3.T1.7.1.4.4.2" class="ltx_td ltx_align_center">2M+1</td>
<td id="S3.T1.7.1.4.4.3" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.3.1" class="ltx_text ltx_font_bold">0.0292</span></td>
<td id="S3.T1.7.1.4.4.4" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.4.1" class="ltx_text ltx_font_bold">0.0312</span></td>
<td id="S3.T1.7.1.4.4.5" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.0082</span></td>
<td id="S3.T1.7.1.4.4.6" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.6.1" class="ltx_text ltx_framed ltx_framed_underline">0.0121</span></td>
<td id="S3.T1.7.1.4.4.7" class="ltx_td ltx_align_center"><span id="S3.T1.7.1.4.4.7.1" class="ltx_text ltx_framed ltx_framed_underline">0.0045</span></td>
<td id="S3.T1.7.1.4.4.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T1.7.1.4.4.8.1" class="ltx_text ltx_font_bold">0.0050</span></td>
</tr>
<tr id="S3.T1.7.1.5.5" class="ltx_tr">
<td id="S3.T1.7.1.5.5.1" class="ltx_td ltx_align_center">M2</td>
<td id="S3.T1.7.1.5.5.2" class="ltx_td ltx_align_center">M+2</td>
<td id="S3.T1.7.1.5.5.3" class="ltx_td ltx_align_center">0.1558</td>
<td id="S3.T1.7.1.5.5.4" class="ltx_td ltx_align_center">0.3327</td>
<td id="S3.T1.7.1.5.5.5" class="ltx_td ltx_align_center">0.0114</td>
<td id="S3.T1.7.1.5.5.6" class="ltx_td ltx_align_center">0.0119</td>
<td id="S3.T1.7.1.5.5.7" class="ltx_td ltx_align_center">0.0072</td>
<td id="S3.T1.7.1.5.5.8" class="ltx_td ltx_nopad_r ltx_align_center">0.0083</td>
</tr>
<tr id="S3.T1.7.1.6.6" class="ltx_tr">
<td id="S3.T1.7.1.6.6.1" class="ltx_td ltx_align_center">M3</td>
<td id="S3.T1.7.1.6.6.2" class="ltx_td ltx_align_center">M+2</td>
<td id="S3.T1.7.1.6.6.3" class="ltx_td ltx_align_center">0.3389</td>
<td id="S3.T1.7.1.6.6.4" class="ltx_td ltx_align_center">0.2177</td>
<td id="S3.T1.7.1.6.6.5" class="ltx_td ltx_align_center">0.0914</td>
<td id="S3.T1.7.1.6.6.6" class="ltx_td ltx_align_center">0.0465</td>
<td id="S3.T1.7.1.6.6.7" class="ltx_td ltx_align_center">0.0746</td>
<td id="S3.T1.7.1.6.6.8" class="ltx_td ltx_nopad_r ltx_align_center">0.0947</td>
</tr>
<tr id="S3.T1.7.1.7.7" class="ltx_tr" style="background-color:#FFEFEF;">
<td id="S3.T1.7.1.7.7.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.1.1" class="ltx_text" style="background-color:#FFEFEF;">M4</span></td>
<td id="S3.T1.7.1.7.7.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.2.1" class="ltx_text" style="background-color:#FFEFEF;">M+2</span></td>
<td id="S3.T1.7.1.7.7.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.3.1" class="ltx_text ltx_framed ltx_framed_underline" style="background-color:#FFEFEF;">0.0298</span></td>
<td id="S3.T1.7.1.7.7.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.4.1" class="ltx_text ltx_framed ltx_framed_underline" style="background-color:#FFEFEF;">0.0365</span></td>
<td id="S3.T1.7.1.7.7.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.5.1" class="ltx_text ltx_font_bold" style="background-color:#FFEFEF;">0.0062</span></td>
<td id="S3.T1.7.1.7.7.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.6.1" class="ltx_text ltx_font_bold" style="background-color:#FFEFEF;">0.0074</span></td>
<td id="S3.T1.7.1.7.7.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.7.1" class="ltx_text ltx_font_bold" style="background-color:#FFEFEF;">0.0036</span></td>
<td id="S3.T1.7.1.7.7.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S3.T1.7.1.7.7.8.1" class="ltx_text ltx_framed ltx_framed_underline" style="background-color:#FFEFEF;">0.0078</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section id="S3.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Setups</h4>

<div id="S3.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.1">총 30B 토큰에 대해 Pile에서 GitHub, Pile-CC 및 Books3 하위 집합의 혼합물을 훈련하고 세 도메인에 대해 각각 모델을 평가한다. 특정 혼합물의 경우 <math alttext="\{0,0.125,0.25,\dots,0.875,1\}^{3}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.6"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.6a"><msup id="S3.SS2.SSS0.Px1.p1.1.m1.6.7" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml"><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">{</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">0</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.cmml">0.125</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.3.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.3.3.cmml">0.25</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.4" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.1.m1.4.4" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.1.m1.4.4.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.5" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.5.5" xref="S3.SS2.SSS0.Px1.p1.1.m1.5.5.cmml">0.875</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.6" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.6.6" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.6.cmml">1</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.7" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">}</mo></mrow><mn id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.6b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7">superscript</csymbol><set id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2"><cn id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">0</cn><cn id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.cmml" type="float" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2">0.125</cn><cn id="S3.SS2.SSS0.Px1.p1.1.m1.3.3.cmml" type="float" xref="S3.SS2.SSS0.Px1.p1.1.m1.3.3">0.25</cn><ci id="S3.SS2.SSS0.Px1.p1.1.m1.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.4.4">…</ci><cn id="S3.SS2.SSS0.Px1.p1.1.m1.5.5.cmml" type="float" xref="S3.SS2.SSS0.Px1.p1.1.m1.5.5">0.875</cn><cn id="S3.SS2.SSS0.Px1.p1.1.m1.6.6.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.6">1</cn></set><cn id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.6c">\{0,0.125,0.25,\dots,0.875,1\}^{3}</annotation></semantics></math>에서 그리드를 검색하고 3개의 비율이 최대 1까지 합하고 도메인<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>The GitHub and Books3 subset in the Pile do not contain as many as 30B tokens after deduplication.</span></span></span>에서 모든 토큰을 사용하지 않는 유효한 항목을 유지하여 총 32개의 혼합물을 생성한다.</p>
</div>
<div id="S3.SS2.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.1">우리는 이러한 실험 혼합물에 대한 손실을 활용하여 추측과 검증을 통해 손실과 혼합물 비율 사이의 함수 형태를 식별한다. 특히, 우리는 가능한 형태에 대한 추측을 다음 두 가지 원칙에 기초한다.</p>
<ul id="S3.I2" class="ltx_itemize">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i1.p1" class="ltx_para">
<p id="S3.I2.i1.p1.1" class="ltx_p"><span id="S3.I2.i1.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Compatibility.</span> The form can reduce to Eqn.&nbsp;<a href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> if the number of domains <math id="S3.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="M=2" display="inline"><semantics id="S3.I2.i1.p1.1.m1.1a"><mrow id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml"><mi id="S3.I2.i1.p1.1.m1.1.1.2" xref="S3.I2.i1.p1.1.m1.1.1.2.cmml">M</mi><mo id="S3.I2.i1.p1.1.m1.1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.I2.i1.p1.1.m1.1.1.3" xref="S3.I2.i1.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.1b"><apply id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><eq id="S3.I2.i1.p1.1.m1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1.1"></eq><ci id="S3.I2.i1.p1.1.m1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2">𝑀</ci><cn type="integer" id="S3.I2.i1.p1.1.m1.1.1.3.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.1c">M=2</annotation></semantics></math>.</p>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.I2.i2.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.I2.i2.p1.1.1">Symmetry. </span> 변수의 교환은 함수 형태를 변경하지 않아야 합니다.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.2">두 번째 원리는 어떤 도메인 특정 편향도 도입하지 않기 위한 직관에서 비롯된다. 두 원리는 함께 Eqn의 지수 항을 복제하는 후보 함수로 이어진다. <a class="ltx_ref" href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a> 각 훈련 도메인에 대해 교환 법칙을 준수하는 연산을 통해 결합한다.</p>
</div>
<div id="S3.SS2.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p3.1">두 가지 원리에 따라, 우리는 다음과 같은 후보 함수들을 실험한다:</p>
<table id="S3.Ex1" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S3.Ex1X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex1X.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">M1:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1X.4.1.1.m1.1" class="ltx_Math" alttext="\displaystyle L_{i}(\bm{r})=" display="inline"><semantics id="S3.Ex1X.4.1.1.m1.1a"><mrow id="S3.Ex1X.4.1.1.m1.1.2" xref="S3.Ex1X.4.1.1.m1.1.2.cmml"><mrow id="S3.Ex1X.4.1.1.m1.1.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1X.4.1.1.m1.1.2.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1X.4.1.1.m1.1.2.2.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1X.4.1.1.m1.1.2.2.2.3" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.4.1.1.m1.1.2.2.1" xref="S3.Ex1X.4.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.Ex1X.4.1.1.m1.1.2.2.3.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.Ex1X.4.1.1.m1.1.2.2.3.2.1" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1X.4.1.1.m1.1.1" xref="S3.Ex1X.4.1.1.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S3.Ex1X.4.1.1.m1.1.2.2.3.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1X.4.1.1.m1.1.2.1" xref="S3.Ex1X.4.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1X.4.1.1.m1.1.2.3" xref="S3.Ex1X.4.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.4.1.1.m1.1b"><apply id="S3.Ex1X.4.1.1.m1.1.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2"><eq id="S3.Ex1X.4.1.1.m1.1.2.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.1"></eq><apply id="S3.Ex1X.4.1.1.m1.1.2.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2"><times id="S3.Ex1X.4.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1X.4.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1X.4.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1X.4.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1X.4.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1X.4.1.1.m1.1.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1X.4.1.1.m1.1.2.3.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.4.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1X.5.2.2.m1.2" class="ltx_Math" alttext="\displaystyle c_{i}+\sum_{j=1}^{M}\left[k_{ij}\exp\left(t_{ij}r_{j}\right)\right]," display="inline"><semantics id="S3.Ex1X.5.2.2.m1.2a"><mrow id="S3.Ex1X.5.2.2.m1.2.2.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.cmml"><munderover id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2a" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml">k</mi><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.5.2.2.m1.1.1" xref="S3.Ex1X.5.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.Ex1X.5.2.2.m1.2.2.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.5.2.2.m1.2b"><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1"><plus id="S3.Ex1X.5.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1"><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2"></sum><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3"><eq id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3">𝑀</ci></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2">𝑘</ci><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1"></times><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1"><exp id="S3.Ex1X.5.2.2.m1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.1.1"></exp><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝑡</ci><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.5.2.2.m1.2c">\displaystyle c_{i}+\sum_{j=1}^{M}\left[k_{ij}\exp\left(t_{ij}r_{j}\right)\right],</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex1X.7.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">M2:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1X.9.1.1.m1.1" class="ltx_Math" alttext="\displaystyle L_{i}(\bm{r})=" display="inline"><semantics id="S3.Ex1X.9.1.1.m1.1a"><mrow id="S3.Ex1X.9.1.1.m1.1.2" xref="S3.Ex1X.9.1.1.m1.1.2.cmml"><mrow id="S3.Ex1X.9.1.1.m1.1.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1X.9.1.1.m1.1.2.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1X.9.1.1.m1.1.2.2.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1X.9.1.1.m1.1.2.2.2.3" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.9.1.1.m1.1.2.2.1" xref="S3.Ex1X.9.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.Ex1X.9.1.1.m1.1.2.2.3.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.Ex1X.9.1.1.m1.1.2.2.3.2.1" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1X.9.1.1.m1.1.1" xref="S3.Ex1X.9.1.1.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S3.Ex1X.9.1.1.m1.1.2.2.3.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1X.9.1.1.m1.1.2.1" xref="S3.Ex1X.9.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1X.9.1.1.m1.1.2.3" xref="S3.Ex1X.9.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.9.1.1.m1.1b"><apply id="S3.Ex1X.9.1.1.m1.1.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2"><eq id="S3.Ex1X.9.1.1.m1.1.2.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.1"></eq><apply id="S3.Ex1X.9.1.1.m1.1.2.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2"><times id="S3.Ex1X.9.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1X.9.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1X.9.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1X.9.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1X.9.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1X.9.1.1.m1.1.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1X.9.1.1.m1.1.2.3.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.9.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1X.10.2.2.m1.2" class="ltx_Math" alttext="\displaystyle c_{i}+k_{i}\sum_{j=1}^{M}\exp\left(t_{ij}r_{j}\right)," display="inline"><semantics id="S3.Ex1X.10.2.2.m1.2a"><mrow id="S3.Ex1X.10.2.2.m1.2.2.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2.cmml">k</mi><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.cmml"><munderover id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2a" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.10.2.2.m1.1.1" xref="S3.Ex1X.10.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1a" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex1X.10.2.2.m1.2.2.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.10.2.2.m1.2b"><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1"><plus id="S3.Ex1X.10.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1"><times id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2">𝑘</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1"><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3"><eq id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1"><exp id="S3.Ex1X.10.2.2.m1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.1.1"></exp><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑡</ci><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><times id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.10.2.2.m1.2c">\displaystyle c_{i}+k_{i}\sum_{j=1}^{M}\exp\left(t_{ij}r_{j}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex1Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex1Xa.2.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">M3:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1Xa.4.1.1.m1.1" class="ltx_Math" alttext="\displaystyle L_{i}(\bm{r})=" display="inline"><semantics id="S3.Ex1Xa.4.1.1.m1.1a"><mrow id="S3.Ex1Xa.4.1.1.m1.1.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.cmml"><mrow id="S3.Ex1Xa.4.1.1.m1.1.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1Xa.4.1.1.m1.1.2.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.4.1.1.m1.1.2.2.1" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.Ex1Xa.4.1.1.m1.1.2.2.3.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.Ex1Xa.4.1.1.m1.1.2.2.3.2.1" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1Xa.4.1.1.m1.1.1" xref="S3.Ex1Xa.4.1.1.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S3.Ex1Xa.4.1.1.m1.1.2.2.3.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1Xa.4.1.1.m1.1.2.1" xref="S3.Ex1Xa.4.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1Xa.4.1.1.m1.1.2.3" xref="S3.Ex1Xa.4.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.4.1.1.m1.1b"><apply id="S3.Ex1Xa.4.1.1.m1.1.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2"><eq id="S3.Ex1Xa.4.1.1.m1.1.2.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.1"></eq><apply id="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2"><times id="S3.Ex1Xa.4.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1Xa.4.1.1.m1.1.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1Xa.4.1.1.m1.1.2.3.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.4.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1Xa.5.2.2.m1.2" class="ltx_Math" alttext="\displaystyle c_{i}+k_{i}\exp\left(\prod_{j=1}^{M}t_{ij}r_{j}\right)," display="inline"><semantics id="S3.Ex1Xa.5.2.2.m1.2a"><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2.cmml">k</mi><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.1.1" xref="S3.Ex1Xa.5.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1a" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">∏</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.5.2.2.m1.2b"><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1"><plus id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1"><times id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2">𝑘</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1"><exp id="S3.Ex1Xa.5.2.2.m1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.1.1"></exp><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1"><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><csymbol cd="latexml" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">product</csymbol><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><eq id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3"><times id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.5.2.2.m1.2c">\displaystyle c_{i}+k_{i}\exp\left(\prod_{j=1}^{M}t_{ij}r_{j}\right),</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex1Xa.7.1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">M4:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1Xa.9.1.1.m1.1" class="ltx_Math" alttext="\displaystyle L_{i}(\bm{r})=" display="inline"><semantics id="S3.Ex1Xa.9.1.1.m1.1a"><mrow id="S3.Ex1Xa.9.1.1.m1.1.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.cmml"><mrow id="S3.Ex1Xa.9.1.1.m1.1.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1Xa.9.1.1.m1.1.2.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.9.1.1.m1.1.2.2.1" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S3.Ex1Xa.9.1.1.m1.1.2.2.3.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S3.Ex1Xa.9.1.1.m1.1.2.2.3.2.1" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1Xa.9.1.1.m1.1.1" xref="S3.Ex1Xa.9.1.1.m1.1.1.cmml">𝒓</mi><mo stretchy="false" id="S3.Ex1Xa.9.1.1.m1.1.2.2.3.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1Xa.9.1.1.m1.1.2.1" xref="S3.Ex1Xa.9.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1Xa.9.1.1.m1.1.2.3" xref="S3.Ex1Xa.9.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.9.1.1.m1.1b"><apply id="S3.Ex1Xa.9.1.1.m1.1.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2"><eq id="S3.Ex1Xa.9.1.1.m1.1.2.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.1"></eq><apply id="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2"><times id="S3.Ex1Xa.9.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1Xa.9.1.1.m1.1.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1Xa.9.1.1.m1.1.2.3.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.9.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1Xa.10.2.2.m1.2" class="ltx_Math" alttext="\displaystyle c_{i}+k_{i}\exp\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)." display="inline"><semantics id="S3.Ex1Xa.10.2.2.m1.2a"><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2.cmml">k</mi><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.1.1" xref="S3.Ex1Xa.10.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1a" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex1Xa.10.2.2.m1.2.2.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.10.2.2.m1.2b"><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1"><plus id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1"><times id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2">𝑘</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1"><exp id="S3.Ex1Xa.10.2.2.m1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.1.1"></exp><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1"><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><eq id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3"><times id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.10.2.2.m1.2c">\displaystyle c_{i}+k_{i}\exp\left(\sum_{j=1}^{M}t_{ij}r_{j}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p3.2">우리는 Tab의 세 가지 대상 도메인에 대한 피팅 오류를 요약한다. <a class="ltx_ref" href="#S3.T1" title="Table 1 ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/x2.png" id="S3.F3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="130" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">그림 3:</span> 세 개의 도메인 혼합물, Github, Books3 및 Pile-CC에 대한 도메인 손실의 정량적 예측 가능성.</figcaption>
We train on the mixture of these three domains and validate the outcome models on them as well.
The surfaces show the predicted losses on (A) Github; (B) Books3; (C) Pile-CC; and (D) the overall validation set mixed with the three domains.
<math id="S3.F3.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.F3.3.m1.1b"><mo id="S3.F3.3.m1.1.1" xref="S3.F3.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F3.3.m1.1c"><times id="S3.F3.3.m1.1.1.cmml" xref="S3.F3.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.m1.1d">\times</annotation></semantics></math>: validation samples. <math id="S3.F3.4.m2.1" class="ltx_Math" alttext="{\star}" display="inline"><semantics id="S3.F3.4.m2.1b"><mo mathcolor="#FF0000" id="S3.F3.4.m2.1.1" xref="S3.F3.4.m2.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S3.F3.4.m2.1c"><ci id="S3.F3.4.m2.1.1.cmml" xref="S3.F3.4.m2.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m2.1d">{\star}</annotation></semantics></math>: the predicted minimum loss on the overall validation set.
</figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure ltx_align_floatright"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/x3.png" id="S3.F4.g1" class="ltx_graphics ltx_img_square" width="461" height="461" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">그림 4:</span></figcaption>
Prediction results on the domain losses and overall losses in the three-domain experiment. The domain losses are fitted with Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> and we obtain the total losses through explicit domain aggregation of Eqn.&nbsp;<a href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.
</figcaption>
</figure>
</section>
<section id="S3.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Findings</h4>

<div id="S3.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.6">탭의 결과입니다. <a class="ltx_ref" href="#S3.T1" title="Table 1 ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a>는 M1과 M4가 모두 신뢰할 수 있는 예측을 제공하는 반면 M4는 계수가 더 적음을 시사한다. 따라서 M4를 채택한다</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.3" class="ltx_Math" alttext="L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)}" display="block"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml"><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.cmml"><msub id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.2.2.1.3.cmml"><mi id="S3.E7.m1.2.2.1.3.2" xref="S3.E7.m1.2.2.1.3.2.cmml">L</mi><mi id="S3.E7.m1.2.2.1.3.3" xref="S3.E7.m1.2.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.2.cmml">r</mi><mrow id="S3.E7.m1.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.3.cmml"><mn id="S3.E7.m1.2.2.1.1.1.1.3.2" xref="S3.E7.m1.2.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.1.1.3.1" xref="S3.E7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E7.m1.2.2.1.1.1.1.3.3" xref="S3.E7.m1.2.2.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.1.1.3.1a" xref="S3.E7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E7.m1.2.2.1.1.1.1.3.4" xref="S3.E7.m1.2.2.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.3" xref="S3.E7.m1.3.3.3.cmml">=</mo><mrow id="S3.E7.m1.3.3.2" xref="S3.E7.m1.3.3.2.cmml"><msub id="S3.E7.m1.3.3.2.3" xref="S3.E7.m1.3.3.2.3.cmml"><mi id="S3.E7.m1.3.3.2.3.2" xref="S3.E7.m1.3.3.2.3.2.cmml">c</mi><mi id="S3.E7.m1.3.3.2.3.3" xref="S3.E7.m1.3.3.2.3.3.cmml">i</mi></msub><mo id="S3.E7.m1.3.3.2.2" xref="S3.E7.m1.3.3.2.2.cmml">+</mo><mrow id="S3.E7.m1.3.3.2.1" xref="S3.E7.m1.3.3.2.1.cmml"><msub id="S3.E7.m1.3.3.2.1.3" xref="S3.E7.m1.3.3.2.1.3.cmml"><mi id="S3.E7.m1.3.3.2.1.3.2" xref="S3.E7.m1.3.3.2.1.3.2.cmml">k</mi><mi id="S3.E7.m1.3.3.2.1.3.3" xref="S3.E7.m1.3.3.2.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E7.m1.3.3.2.1.2" xref="S3.E7.m1.3.3.2.1.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.2.1.1.1" xref="S3.E7.m1.3.3.2.1.1.2.cmml"><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">exp</mi><mo id="S3.E7.m1.3.3.2.1.1.1a" xref="S3.E7.m1.3.3.2.1.1.2.cmml">⁡</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.2.cmml"><mo id="S3.E7.m1.3.3.2.1.1.1.1.2" xref="S3.E7.m1.3.3.2.1.1.2.cmml">(</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.cmml"><munderover id="S3.E7.m1.3.3.2.1.1.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E7.m1.3.3.2.1.1.1.1.3" xref="S3.E7.m1.3.3.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"><eq id="S3.E7.m1.3.3.3.cmml" xref="S3.E7.m1.3.3.3"></eq><apply id="S3.E7.m1.2.2.1.cmml" xref="S3.E7.m1.2.2.1"><times id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.2"></times><apply id="S3.E7.m1.2.2.1.3.cmml" xref="S3.E7.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.3.1.cmml" xref="S3.E7.m1.2.2.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.3.2.cmml" xref="S3.E7.m1.2.2.1.3.2">𝐿</ci><ci id="S3.E7.m1.2.2.1.3.3.cmml" xref="S3.E7.m1.2.2.1.3.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2">𝑟</ci><apply id="S3.E7.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3"><times id="S3.E7.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.1"></times><cn type="integer" id="S3.E7.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.2">1</cn><ci id="S3.E7.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3">…</ci><ci id="S3.E7.m1.2.2.1.1.1.1.3.4.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="S3.E7.m1.3.3.2.cmml" xref="S3.E7.m1.3.3.2"><plus id="S3.E7.m1.3.3.2.2.cmml" xref="S3.E7.m1.3.3.2.2"></plus><apply id="S3.E7.m1.3.3.2.3.cmml" xref="S3.E7.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.3.1.cmml" xref="S3.E7.m1.3.3.2.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.3.2.cmml" xref="S3.E7.m1.3.3.2.3.2">𝑐</ci><ci id="S3.E7.m1.3.3.2.3.3.cmml" xref="S3.E7.m1.3.3.2.3.3">𝑖</ci></apply><apply id="S3.E7.m1.3.3.2.1.cmml" xref="S3.E7.m1.3.3.2.1"><times id="S3.E7.m1.3.3.2.1.2.cmml" xref="S3.E7.m1.3.3.2.1.2"></times><apply id="S3.E7.m1.3.3.2.1.3.cmml" xref="S3.E7.m1.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.3.1.cmml" xref="S3.E7.m1.3.3.2.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.3.2.cmml" xref="S3.E7.m1.3.3.2.1.3.2">𝑘</ci><ci id="S3.E7.m1.3.3.2.1.3.3.cmml" xref="S3.E7.m1.3.3.2.1.3.3">𝑖</ci></apply><apply id="S3.E7.m1.3.3.2.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1"><exp id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"></exp><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1"><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2"></sum><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3"><eq id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2"><times id="S3.E7.m1.3.3.2.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.1"></times><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3"><times id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px2.p1.5" class="ltx_p">as the function forms of our data mixing law, where <math id="S3.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">L</mi><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝐿</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">L_{i}</annotation></semantics></math> is the validation loss on <math id="S3.SS2.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">i</annotation></semantics></math>-th validation domain, <math id="S3.SS2.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="r_{j}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml">r</mi><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2">𝑟</ci><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">r_{j}</annotation></semantics></math> is the proportion of the <math id="S3.SS2.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.1c">j</annotation></semantics></math>-th training domain, and <math id="S3.SS2.SSS0.Px2.p1.5.m5.3" class="ltx_Math" alttext="c_{i},k_{i},t_{ij}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.5.m5.3a"><mrow id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml"><msub id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.4" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.5" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m5.3b"><list id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3"><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2">𝑡</ci><apply id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3"><times id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1"></times><ci id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m5.3c">c_{i},k_{i},t_{ij}</annotation></semantics></math> are learnable parameters. The fitting results are in Fig.&nbsp;<a href="#S3.F3" title="Figure 3 ‣ Setups ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and Fig.&nbsp;<a href="#S3.F4" title="Figure 4 ‣ Setups ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrates the prediction accuracy. The results indicate that Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> fits the given samples well and estimates the unseen ones accurately.</p>
</div>
<div id="S3.SS2.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS0.Px2.p2.11" class="ltx_p">To provide more intuition, we discuss the meanings of the coefficients in Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. In general, <math id="S3.SS2.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="k_{i}>0" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1"><gt id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1"></gt><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">k_{i}&gt;0</annotation></semantics></math>, thus the exponential term is always positive and the prediction loss is strictly greater than the constant <math id="S3.SS2.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">c</annotation></semantics></math>. Hereby, <math id="S3.SS2.SSS0.Px2.p2.3.m3.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.1a"><msub id="S3.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.1c">c_{i}</annotation></semantics></math> represents losses that are not reducible by adjusting the data mixture. <math id="S3.SS2.SSS0.Px2.p2.4.m4.1" class="ltx_Math" alttext="t_{ij}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.4.m4.1a"><msub id="S3.SS2.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2">𝑡</ci><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3"><times id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.4.m4.1c">t_{ij}</annotation></semantics></math>, depending on both training domain <math id="S3.SS2.SSS0.Px2.p2.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.5.m5.1a"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.5.m5.1b"><ci id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.5.m5.1c">i</annotation></semantics></math> and validation domain <math id="S3.SS2.SSS0.Px2.p2.6.m6.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.6.m6.1a"><mi id="S3.SS2.SSS0.Px2.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.6.m6.1b"><ci id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.6.m6.1c">j</annotation></semantics></math>, shows the interaction between them. A negative <math id="S3.SS2.SSS0.Px2.p2.7.m7.1" class="ltx_Math" alttext="t_{ij}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.7.m7.1a"><msub id="S3.SS2.SSS0.Px2.p2.7.m7.1.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.7.m7.1b"><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2">𝑡</ci><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3"><times id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.7.m7.1c">t_{ij}</annotation></semantics></math> indicates that training data of domain <math id="S3.SS2.SSS0.Px2.p2.8.m8.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.8.m8.1a"><mi id="S3.SS2.SSS0.Px2.p2.8.m8.1.1" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.8.m8.1b"><ci id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.8.m8.1c">j</annotation></semantics></math> helps reduce validation loss on domain <math id="S3.SS2.SSS0.Px2.p2.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.9.m9.1a"><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.9.m9.1b"><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.9.m9.1c">i</annotation></semantics></math> and vice versa. Besides, rewriting the coefficient <math id="S3.SS2.SSS0.Px2.p2.10.m10.1" class="ltx_Math" alttext="k_{i}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.10.m10.1a"><msub id="S3.SS2.SSS0.Px2.p2.10.m10.1.1" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.10.m10.1b"><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.10.m10.1c">k_{i}</annotation></semantics></math> into <math id="S3.SS2.SSS0.Px2.p2.11.m11.2" class="ltx_Math" alttext="\exp(\log k_{i})" display="inline"><semantics id="S3.SS2.SSS0.Px2.p2.11.m11.2a"><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.cmml">exp</mi><mo id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1a" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml">⁡</mo><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1a" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.cmml">⁡</mo><msub id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.3" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.11.m11.2b"><apply id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1"><exp id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1"></exp><apply id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1"><log id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1"></log><apply id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.11.m11.2c">\exp(\log k_{i})</annotation></semantics></math> makes it a bias term on the exponent which adjusts the aggregate effect of all training domains.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Predicting Losses of Any Validation Mixture</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS3.p1.1">우리는 Sec에서 제약을 더욱 완화한다. <a class="ltx_ref" href="#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.1</span></a> and Sec. <a class="ltx_ref" href="#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.2</span></a> 검증 데이터는 훈련 도메인 중 하나에서 가져온 것이다. 우리는 먼저 검증 세트를 훈련 도메인의 알려져 있는 구성으로 간주한 다음 임의 검증 세트의 보다 일반적인 경우에 대해 이 요구 사항을 해제한다. 이는 다음과 같이 자세히 설명하는 데이터 혼합 법칙에 맞는 두 가지 전략에 해당한다.</p>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Explicit domain aggregation.</h4>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.2">비율이 <math alttext="s_{1\dots K}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml">…</mi><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1a" lspace="0em" rspace="0em" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2">𝑠</ci><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3"><times id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1"></times><cn id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2">1</cn><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3">…</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">s_{1\dots K}</annotation></semantics></math>인 <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">K</annotation></semantics></math> 도메인으로 이루어진 검증 집합을 고려하면, 검증 손실은 도메인 손실의 가중 합으로 기입될 수 있다. qn의 발견 덕분에. <a class="ltx_ref" href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a>, 우리는 훈련 혼합이 주어진 여기에서 도메인 손실을 예측하기 위해 방정식을 적용할 수 있다. 따라서, 훈련 혼합물 비율에 대한 전체 검증 손실의 함수 관계는 속으로 확장된다.</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.2" class="ltx_Math" alttext="L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right]." display="block"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1a" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.3.4" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E8.m1.2.2.1.1.5" xref="S3.E8.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.1.2.cmml"><munderover id="S3.E8.m1.2.2.1.1.2.2" xref="S3.E8.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="S3.E8.m1.2.2.1.1.2.2.2.2" xref="S3.E8.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.2.2.2.3" xref="S3.E8.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.2.2.2.3.2" xref="S3.E8.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.1.1.2.2.2.3.1" xref="S3.E8.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.2.2.2.3.3" xref="S3.E8.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.2.2.3" xref="S3.E8.m1.2.2.1.1.2.2.3.cmml">K</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.2.1" xref="S3.E8.m1.2.2.1.1.2.1.cmml"><msub id="S3.E8.m1.2.2.1.1.2.1.3" xref="S3.E8.m1.2.2.1.1.2.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.3.2" xref="S3.E8.m1.2.2.1.1.2.1.3.2.cmml">s</mi><mi id="S3.E8.m1.2.2.1.1.2.1.3.3" xref="S3.E8.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.2" xref="S3.E8.m1.2.2.1.1.2.1.2.cmml">​</mo><msub id="S3.E8.m1.2.2.1.1.2.1.4" xref="S3.E8.m1.2.2.1.1.2.1.4.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.4.2" xref="S3.E8.m1.2.2.1.1.2.1.4.2.cmml">L</mi><mi id="S3.E8.m1.2.2.1.1.2.1.4.3" xref="S3.E8.m1.2.2.1.1.2.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.2a" xref="S3.E8.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.2.1.1.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.2.cmml">r</mi><mrow id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mn id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1a" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="S3.E8.m1.2.2.1.1.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="S3.E8.m1.2.2.1.1.6" xref="S3.E8.m1.2.2.1.1.6.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.3.cmml"><munderover id="S3.E8.m1.2.2.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.2.cmml"><mo movablelimits="false" id="S3.E8.m1.2.2.1.1.3.2.2.2" xref="S3.E8.m1.2.2.1.1.3.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.3.2.2.3" xref="S3.E8.m1.2.2.1.1.3.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.2.2.3.2" xref="S3.E8.m1.2.2.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.1.1.3.2.2.3.1" xref="S3.E8.m1.2.2.1.1.3.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.3.2.2.3.3" xref="S3.E8.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.3.2.3" xref="S3.E8.m1.2.2.1.1.3.2.3.cmml">K</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.3.1" xref="S3.E8.m1.2.2.1.1.3.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.3" xref="S3.E8.m1.2.2.1.1.3.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.3.2" xref="S3.E8.m1.2.2.1.1.3.1.3.2.cmml">s</mi><mi id="S3.E8.m1.2.2.1.1.3.1.3.3" xref="S3.E8.m1.2.2.1.1.3.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.3.1.2" xref="S3.E8.m1.2.2.1.1.3.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.2.1.cmml">[</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2.cmml">c</mi><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.2.cmml">+</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml">k</mi><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">exp</mi><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1a" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E8.m1.2.2.1.2" xref="S3.E8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1"><and id="S3.E8.m1.2.2.1.1a.cmml" xref="S3.E8.m1.2.2.1"></and><apply id="S3.E8.m1.2.2.1.1b.cmml" xref="S3.E8.m1.2.2.1"><eq id="S3.E8.m1.2.2.1.1.5.cmml" xref="S3.E8.m1.2.2.1.1.5"></eq><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><times id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2"></times><ci id="S3.E8.m1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3">𝐿</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1"></times><cn type="integer" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.3">…</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="S3.E8.m1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2"><apply id="S3.E8.m1.2.2.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3"><eq id="S3.E8.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E8.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.2.3">𝐾</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1"><times id="S3.E8.m1.2.2.1.1.2.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.2"></times><apply id="S3.E8.m1.2.2.1.1.2.1.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3.2">𝑠</ci><ci id="S3.E8.m1.2.2.1.1.2.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.4.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.4.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.4.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4.2">𝐿</ci><ci id="S3.E8.m1.2.2.1.1.2.1.4.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.2">𝑟</ci><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3"><times id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1"></times><cn type="integer" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2">1</cn><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3">…</ci><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4">𝑀</ci></apply></apply></apply></apply></apply><apply id="S3.E8.m1.2.2.1.1c.cmml" xref="S3.E8.m1.2.2.1"><eq id="S3.E8.m1.2.2.1.1.6.cmml" xref="S3.E8.m1.2.2.1.1.6"></eq><share href="#S3.E8.m1.2.2.1.1.2.cmml" id="S3.E8.m1.2.2.1.1d.cmml" xref="S3.E8.m1.2.2.1"></share><apply id="S3.E8.m1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3"><apply id="S3.E8.m1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.3.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3"><eq id="S3.E8.m1.2.2.1.1.3.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.3.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E8.m1.2.2.1.1.3.2.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.3.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.2.3">𝐾</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1"><times id="S3.E8.m1.2.2.1.1.3.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.2"></times><apply id="S3.E8.m1.2.2.1.1.3.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3.2">𝑠</ci><ci id="S3.E8.m1.2.2.1.1.3.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.3.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.2">delimited-[]</csymbol><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1"><plus id="S3.E8.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.2"></plus><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2">𝑐</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1"><times id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2"></times><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1"><exp id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"></exp><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1"><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3"><eq id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2"><times id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3"><times id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.3">Eqn을 이용하여 <a class="ltx_ref" href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a>, 각 유효성 검사 도메인 <math alttext="L_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.3.m1.1"><semantics id="S3.SS3.SSS0.Px1.p1.3.m1.1a"><msub id="S3.SS3.SSS0.Px1.p1.3.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2.cmml">L</mi><mi id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2">𝐿</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m1.1c">L_{i}</annotation></semantics></math>에 손실을 맞추고 이를 합산하여 전체 손실의 예측을 얻을 수 있다.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Implicit domain aggregation.</h4>

<div id="S3.SS3.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.3">나머지 제한 사항은 유효성 검사 데이터 <math alttext="s_{1\dots K}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1a" lspace="0em" rspace="0em" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2">𝑠</ci><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1"></times><cn id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2">1</cn><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3">…</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">s_{1\dots K}</annotation></semantics></math>의 구성 요소를 미리 획득해야 한다는 것이다. 이는 유효성 검사 세트가 훈련 세트와 별도로 수집되는 경우 불편할 수 있다. 예를 들어, 검증 데이터는 다양한 도메인의 알려지지 않은 구성을 포함하는 실제 사용자 쿼리로부터 나올 수 있다. 검증 구성 요소에 대한 제약을 제거하기 위해, 우리는 검증 데이터를 Eqn으로 손실이 예측 가능한 <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.1c">K</annotation></semantics></math> 암시적 도메인으로 분해할 수 있다고 가정한다. <a class="ltx_ref" href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a> 및 검증 데이터 <math alttext="s_{1\dots K}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1a" lspace="0em" rspace="0em" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2">𝑠</ci><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1"></times><cn id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2">1</cn><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3">…</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m3.1c">s_{1\dots K}</annotation></semantics></math>에서의 비율을 학습 가능한 파라미터로 취급한다. 이것은 우리의 데이터 혼합 법칙<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>We note that the final forms of our data mixing law resemble a multilayer perception (see the computation graph Fig. <a class="ltx_ref" href="#A3.F10" title="Figure 10 ‣ Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">10</span></a>). We include further discussion and implementation details in Appendix <a class="ltx_ref" href="#A3" title="Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">C</span></a>.</span></span></span>의 최종 형태로 이어진다. 이러한 관점에서 우리는 데이터 혼합 법칙을 전체 손실과 끝까지 맞추었다.</p>
</div>
<figure id="S3.F5" class="ltx_figure ltx_align_floatright"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/figs/5mix_end2end.png" id="S3.F5.g1" class="ltx_graphics ltx_img_landscape" width="598" height="299" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">그림 5:</span> 명시적 및 암시적 도메인 집계에 적합한 5-도메인 데이터 혼합 법칙의 예측 오류.</figcaption>
<span id="S3.F5.5.1" class="ltx_text ltx_font_italic">Explicit domain aggregation</span>: we fit Eqn.&nbsp;<a href="#S3.E7" title="In Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> for five domains respectively and sum them up according to their weight in the overall validation sets.
<span id="S3.F5.6.2" class="ltx_text ltx_font_italic">Implicit domain aggregation</span>: we fit the losses on overall validation with Eqn.&nbsp;<a href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, assuming different numbers of implicit domains <math id="S3.F5.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.F5.2.m1.1b"><mi id="S3.F5.2.m1.1.1" xref="S3.F5.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F5.2.m1.1c"><ci id="S3.F5.2.m1.1.1.cmml" xref="S3.F5.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.2.m1.1d">K</annotation></semantics></math> and treating the proportion of different implicit domains as learnable parameters.
</figcaption>
</figure>
<div id="S3.SS3.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p2.1">Fig. <a class="ltx_ref" href="#S3.F5" title="Figure 5 ‣ Implicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">5</span></a>는 Pile<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>The Pile contains 22 fine-grained domains which are collected into five coarse-grained domains, i.e., academic, internet, prose, dialogues, and misc, where misc include Github and the DeepMind Mathematics Dataset which are symbolic content. We do not experiment on fine-grained domains for their limited number of tokens available.</span></span></span>의 5개 조립 도메인에서 언어 모델을 훈련하고 이 5개 도메인과 혼합된 검증 세트를 평가하는 실험을 보여준다. 암시적 도메인 집합에 의해 얻은 오류와 다른 수의 암시적 도메인 집합에 의해 얻은 오류를 비교한다. 암시적 도메인 집합을 적용하고 암시적 도메인 수를 실제 도메인 집합보다 작지 않게 설정(실험의 경우 5개)하면 명시적 도메인 집합보다 낮은 오류가 발생함을 알 수 있다. 또한, 암시적 도메인의 수를 훨씬 더 크게 설정함에 따라 오류는 여전히 낮다. 이는 데이터 믹싱 법칙에 대한 우리의 암시적 도메인 집계 전략의 예측 정확도를 검증하고 암시적 도메인의 수 <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.1.m1.1c">K</annotation></semantics></math>는 주의 깊게 튜닝하지 않고 큰 수가 될 수 있다<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content">8</sup><span class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span>이 나머지 논문에서 언급되지 않은 경우 <math alttext="K=30" class="ltx_Math" display="inline" id="footnote8.m1.1"><semantics id="footnote8.m1.1b"><mrow id="footnote8.m1.1.1" xref="footnote8.m1.1.1.cmml"><mi id="footnote8.m1.1.1.2" xref="footnote8.m1.1.1.2.cmml">K</mi><mo id="footnote8.m1.1.1.1" xref="footnote8.m1.1.1.1.cmml">=</mo><mn id="footnote8.m1.1.1.3" xref="footnote8.m1.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote8.m1.1c"><apply id="footnote8.m1.1.1.cmml" xref="footnote8.m1.1.1"><eq id="footnote8.m1.1.1.1.cmml" xref="footnote8.m1.1.1.1"></eq><ci id="footnote8.m1.1.1.2.cmml" xref="footnote8.m1.1.1.2">𝐾</ci><cn id="footnote8.m1.1.1.3.cmml" type="integer" xref="footnote8.m1.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m1.1d">K=30</annotation></semantics></math>를 설정한다. </span></span></span></p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Nested scaling laws predict losses trained on various mixtures using only small-scale experiments</h2>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span></span> 소규모 훈련을 통해 대규모 데이터에 훈련된 대규모 모델에서 서로 다른 혼합 비율의 손실을 예측하는 파이프라인</figcaption>
<div id="alg1.3" class="ltx_listing ltx_align_center ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> Validation data <math id="alg1.l1.m1.1" class="ltx_Math" alttext="D_{val}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">D</mi><mrow id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.3.1" xref="alg1.l1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.3.1a" xref="alg1.l1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.3.4" xref="alg1.l1.m1.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝐷</ci><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><times id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.1"></times><ci id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2">𝑣</ci><ci id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">𝑎</ci><ci id="alg1.l1.m1.1.1.3.4.cmml" xref="alg1.l1.m1.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">D_{val}</annotation></semantics></math>, training data of <math id="alg1.l1.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">M</annotation></semantics></math> domains <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\{D_{m}\}_{m=1}^{M}" display="inline"><semantics id="alg1.l1.m3.1a"><msubsup id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mrow id="alg1.l1.m3.1.1.1.1.1" xref="alg1.l1.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m3.1.1.1.1.1.2" xref="alg1.l1.m3.1.1.1.1.2.cmml">{</mo><msub id="alg1.l1.m3.1.1.1.1.1.1" xref="alg1.l1.m3.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m3.1.1.1.1.1.1.2" xref="alg1.l1.m3.1.1.1.1.1.1.2.cmml">D</mi><mi id="alg1.l1.m3.1.1.1.1.1.1.3" xref="alg1.l1.m3.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="alg1.l1.m3.1.1.1.1.1.3" xref="alg1.l1.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m3.1.1.1.3" xref="alg1.l1.m3.1.1.1.3.cmml"><mi id="alg1.l1.m3.1.1.1.3.2" xref="alg1.l1.m3.1.1.1.3.2.cmml">m</mi><mo id="alg1.l1.m3.1.1.1.3.1" xref="alg1.l1.m3.1.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m3.1.1.1.3.3" xref="alg1.l1.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1">superscript</csymbol><apply id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.2.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><set id="alg1.l1.m3.1.1.1.1.2.cmml" xref="alg1.l1.m3.1.1.1.1.1"><apply id="alg1.l1.m3.1.1.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m3.1.1.1.1.1.1.2">𝐷</ci><ci id="alg1.l1.m3.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m3.1.1.1.1.1.1.3">𝑚</ci></apply></set><apply id="alg1.l1.m3.1.1.1.3.cmml" xref="alg1.l1.m3.1.1.1.3"><eq id="alg1.l1.m3.1.1.1.3.1.cmml" xref="alg1.l1.m3.1.1.1.3.1"></eq><ci id="alg1.l1.m3.1.1.1.3.2.cmml" xref="alg1.l1.m3.1.1.1.3.2">𝑚</ci><cn type="integer" id="alg1.l1.m3.1.1.1.3.3.cmml" xref="alg1.l1.m3.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\{D_{m}\}_{m=1}^{M}</annotation></semantics></math>, target training steps <math id="alg1.l1.m4.1" class="ltx_Math" alttext="S_{target}" display="inline"><semantics id="alg1.l1.m4.1a"><msub id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">S</mi><mrow id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml"><mi id="alg1.l1.m4.1.1.3.2" xref="alg1.l1.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.3" xref="alg1.l1.m4.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1a" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.4" xref="alg1.l1.m4.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1b" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.5" xref="alg1.l1.m4.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1c" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.6" xref="alg1.l1.m4.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1d" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.7" xref="alg1.l1.m4.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝑆</ci><apply id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3"><times id="alg1.l1.m4.1.1.3.1.cmml" xref="alg1.l1.m4.1.1.3.1"></times><ci id="alg1.l1.m4.1.1.3.2.cmml" xref="alg1.l1.m4.1.1.3.2">𝑡</ci><ci id="alg1.l1.m4.1.1.3.3.cmml" xref="alg1.l1.m4.1.1.3.3">𝑎</ci><ci id="alg1.l1.m4.1.1.3.4.cmml" xref="alg1.l1.m4.1.1.3.4">𝑟</ci><ci id="alg1.l1.m4.1.1.3.5.cmml" xref="alg1.l1.m4.1.1.3.5">𝑔</ci><ci id="alg1.l1.m4.1.1.3.6.cmml" xref="alg1.l1.m4.1.1.3.6">𝑒</ci><ci id="alg1.l1.m4.1.1.3.7.cmml" xref="alg1.l1.m4.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">S_{target}</annotation></semantics></math>, target model size <math id="alg1.l1.m5.1" class="ltx_Math" alttext="N_{target}" display="inline"><semantics id="alg1.l1.m5.1a"><msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">N</mi><mrow id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml"><mi id="alg1.l1.m5.1.1.3.2" xref="alg1.l1.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.3" xref="alg1.l1.m5.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1a" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.4" xref="alg1.l1.m5.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1b" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.5" xref="alg1.l1.m5.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1c" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.6" xref="alg1.l1.m5.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.3.1d" xref="alg1.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3.7" xref="alg1.l1.m5.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">subscript</csymbol><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">𝑁</ci><apply id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3"><times id="alg1.l1.m5.1.1.3.1.cmml" xref="alg1.l1.m5.1.1.3.1"></times><ci id="alg1.l1.m5.1.1.3.2.cmml" xref="alg1.l1.m5.1.1.3.2">𝑡</ci><ci id="alg1.l1.m5.1.1.3.3.cmml" xref="alg1.l1.m5.1.1.3.3">𝑎</ci><ci id="alg1.l1.m5.1.1.3.4.cmml" xref="alg1.l1.m5.1.1.3.4">𝑟</ci><ci id="alg1.l1.m5.1.1.3.5.cmml" xref="alg1.l1.m5.1.1.3.5">𝑔</ci><ci id="alg1.l1.m5.1.1.3.6.cmml" xref="alg1.l1.m5.1.1.3.6">𝑒</ci><ci id="alg1.l1.m5.1.1.3.7.cmml" xref="alg1.l1.m5.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">N_{target}</annotation></semantics></math>, target mixture to predict <math id="alg1.l1.m6.1" class="ltx_Math" alttext="\bm{r}_{target}" display="inline"><semantics id="alg1.l1.m6.1a"><msub id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml"><mi id="alg1.l1.m6.1.1.2" xref="alg1.l1.m6.1.1.2.cmml">𝒓</mi><mrow id="alg1.l1.m6.1.1.3" xref="alg1.l1.m6.1.1.3.cmml"><mi id="alg1.l1.m6.1.1.3.2" xref="alg1.l1.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.3" xref="alg1.l1.m6.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1a" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.4" xref="alg1.l1.m6.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1b" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.5" xref="alg1.l1.m6.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1c" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.6" xref="alg1.l1.m6.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m6.1.1.3.1d" xref="alg1.l1.m6.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m6.1.1.3.7" xref="alg1.l1.m6.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><apply id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1"><csymbol cd="ambiguous" id="alg1.l1.m6.1.1.1.cmml" xref="alg1.l1.m6.1.1">subscript</csymbol><ci id="alg1.l1.m6.1.1.2.cmml" xref="alg1.l1.m6.1.1.2">𝒓</ci><apply id="alg1.l1.m6.1.1.3.cmml" xref="alg1.l1.m6.1.1.3"><times id="alg1.l1.m6.1.1.3.1.cmml" xref="alg1.l1.m6.1.1.3.1"></times><ci id="alg1.l1.m6.1.1.3.2.cmml" xref="alg1.l1.m6.1.1.3.2">𝑡</ci><ci id="alg1.l1.m6.1.1.3.3.cmml" xref="alg1.l1.m6.1.1.3.3">𝑎</ci><ci id="alg1.l1.m6.1.1.3.4.cmml" xref="alg1.l1.m6.1.1.3.4">𝑟</ci><ci id="alg1.l1.m6.1.1.3.5.cmml" xref="alg1.l1.m6.1.1.3.5">𝑔</ci><ci id="alg1.l1.m6.1.1.3.6.cmml" xref="alg1.l1.m6.1.1.3.6">𝑒</ci><ci id="alg1.l1.m6.1.1.3.7.cmml" xref="alg1.l1.m6.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">\bm{r}_{target}</annotation></semantics></math>, training steps to fit the step laws <math id="alg1.l1.m7.1" class="ltx_Math" alttext="S_{0}" display="inline"><semantics id="alg1.l1.m7.1a"><msub id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml"><mi id="alg1.l1.m7.1.1.2" xref="alg1.l1.m7.1.1.2.cmml">S</mi><mn id="alg1.l1.m7.1.1.3" xref="alg1.l1.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><apply id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1"><csymbol cd="ambiguous" id="alg1.l1.m7.1.1.1.cmml" xref="alg1.l1.m7.1.1">subscript</csymbol><ci id="alg1.l1.m7.1.1.2.cmml" xref="alg1.l1.m7.1.1.2">𝑆</ci><cn type="integer" id="alg1.l1.m7.1.1.3.cmml" xref="alg1.l1.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">S_{0}</annotation></semantics></math>, model sizes to fit the size laws <math id="alg1.l1.m8.1" class="ltx_Math" alttext="\{N_{i}\}" display="inline"><semantics id="alg1.l1.m8.1a"><mrow id="alg1.l1.m8.1.1.1" xref="alg1.l1.m8.1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m8.1.1.1.2" xref="alg1.l1.m8.1.1.2.cmml">{</mo><msub id="alg1.l1.m8.1.1.1.1" xref="alg1.l1.m8.1.1.1.1.cmml"><mi id="alg1.l1.m8.1.1.1.1.2" xref="alg1.l1.m8.1.1.1.1.2.cmml">N</mi><mi id="alg1.l1.m8.1.1.1.1.3" xref="alg1.l1.m8.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l1.m8.1.1.1.3" xref="alg1.l1.m8.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m8.1b"><set id="alg1.l1.m8.1.1.2.cmml" xref="alg1.l1.m8.1.1.1"><apply id="alg1.l1.m8.1.1.1.1.cmml" xref="alg1.l1.m8.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m8.1.1.1.1.1.cmml" xref="alg1.l1.m8.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m8.1.1.1.1.2.cmml" xref="alg1.l1.m8.1.1.1.1.2">𝑁</ci><ci id="alg1.l1.m8.1.1.1.1.3.cmml" xref="alg1.l1.m8.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m8.1c">\{N_{i}\}</annotation></semantics></math>, and <math id="alg1.l1.m9.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l1.m9.1a"><mi id="alg1.l1.m9.1.1" xref="alg1.l1.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m9.1b"><ci id="alg1.l1.m9.1.1.cmml" xref="alg1.l1.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m9.1c">N</annotation></semantics></math> data mixtures <math id="alg1.l1.m10.1" class="ltx_Math" alttext="\{\bm{r}_{i}\}_{i=1}^{N}" display="inline"><semantics id="alg1.l1.m10.1a"><msubsup id="alg1.l1.m10.1.1" xref="alg1.l1.m10.1.1.cmml"><mrow id="alg1.l1.m10.1.1.1.1.1" xref="alg1.l1.m10.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m10.1.1.1.1.1.2" xref="alg1.l1.m10.1.1.1.1.2.cmml">{</mo><msub id="alg1.l1.m10.1.1.1.1.1.1" xref="alg1.l1.m10.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m10.1.1.1.1.1.1.2" xref="alg1.l1.m10.1.1.1.1.1.1.2.cmml">𝒓</mi><mi id="alg1.l1.m10.1.1.1.1.1.1.3" xref="alg1.l1.m10.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l1.m10.1.1.1.1.1.3" xref="alg1.l1.m10.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m10.1.1.1.3" xref="alg1.l1.m10.1.1.1.3.cmml"><mi id="alg1.l1.m10.1.1.1.3.2" xref="alg1.l1.m10.1.1.1.3.2.cmml">i</mi><mo id="alg1.l1.m10.1.1.1.3.1" xref="alg1.l1.m10.1.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m10.1.1.1.3.3" xref="alg1.l1.m10.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m10.1.1.3" xref="alg1.l1.m10.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m10.1b"><apply id="alg1.l1.m10.1.1.cmml" xref="alg1.l1.m10.1.1"><csymbol cd="ambiguous" id="alg1.l1.m10.1.1.2.cmml" xref="alg1.l1.m10.1.1">superscript</csymbol><apply id="alg1.l1.m10.1.1.1.cmml" xref="alg1.l1.m10.1.1"><csymbol cd="ambiguous" id="alg1.l1.m10.1.1.1.2.cmml" xref="alg1.l1.m10.1.1">subscript</csymbol><set id="alg1.l1.m10.1.1.1.1.2.cmml" xref="alg1.l1.m10.1.1.1.1.1"><apply id="alg1.l1.m10.1.1.1.1.1.1.cmml" xref="alg1.l1.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m10.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m10.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m10.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m10.1.1.1.1.1.1.2">𝒓</ci><ci id="alg1.l1.m10.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m10.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="alg1.l1.m10.1.1.1.3.cmml" xref="alg1.l1.m10.1.1.1.3"><eq id="alg1.l1.m10.1.1.1.3.1.cmml" xref="alg1.l1.m10.1.1.1.3.1"></eq><ci id="alg1.l1.m10.1.1.1.3.2.cmml" xref="alg1.l1.m10.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l1.m10.1.1.1.3.3.cmml" xref="alg1.l1.m10.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m10.1.1.3.cmml" xref="alg1.l1.m10.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m10.1c">\{\bm{r}_{i}\}_{i=1}^{N}</annotation></semantics></math> to fit.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><span id="alg1.l2.1" class="ltx_text ltx_font_bold">Output:</span> The validation loss of a <math id="alg1.l2.m1.1" class="ltx_Math" alttext="N_{target}" display="inline"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">N</mi><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1a" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.4" xref="alg1.l2.m1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1b" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.5" xref="alg1.l2.m1.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1c" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.6" xref="alg1.l2.m1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.3.1d" xref="alg1.l2.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.3.7" xref="alg1.l2.m1.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑁</ci><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><times id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"></times><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">𝑡</ci><ci id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">𝑎</ci><ci id="alg1.l2.m1.1.1.3.4.cmml" xref="alg1.l2.m1.1.1.3.4">𝑟</ci><ci id="alg1.l2.m1.1.1.3.5.cmml" xref="alg1.l2.m1.1.1.3.5">𝑔</ci><ci id="alg1.l2.m1.1.1.3.6.cmml" xref="alg1.l2.m1.1.1.3.6">𝑒</ci><ci id="alg1.l2.m1.1.1.3.7.cmml" xref="alg1.l2.m1.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">N_{target}</annotation></semantics></math> model trained for <math id="alg1.l2.m2.1" class="ltx_Math" alttext="S_{target}" display="inline"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">S</mi><mrow id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml"><mi id="alg1.l2.m2.1.1.3.2" xref="alg1.l2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.3" xref="alg1.l2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1a" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.4" xref="alg1.l2.m2.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1b" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.5" xref="alg1.l2.m2.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1c" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.6" xref="alg1.l2.m2.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.3.1d" xref="alg1.l2.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m2.1.1.3.7" xref="alg1.l2.m2.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑆</ci><apply id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3"><times id="alg1.l2.m2.1.1.3.1.cmml" xref="alg1.l2.m2.1.1.3.1"></times><ci id="alg1.l2.m2.1.1.3.2.cmml" xref="alg1.l2.m2.1.1.3.2">𝑡</ci><ci id="alg1.l2.m2.1.1.3.3.cmml" xref="alg1.l2.m2.1.1.3.3">𝑎</ci><ci id="alg1.l2.m2.1.1.3.4.cmml" xref="alg1.l2.m2.1.1.3.4">𝑟</ci><ci id="alg1.l2.m2.1.1.3.5.cmml" xref="alg1.l2.m2.1.1.3.5">𝑔</ci><ci id="alg1.l2.m2.1.1.3.6.cmml" xref="alg1.l2.m2.1.1.3.6">𝑒</ci><ci id="alg1.l2.m2.1.1.3.7.cmml" xref="alg1.l2.m2.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">S_{target}</annotation></semantics></math> steps on mixture <math id="alg1.l2.m3.1" class="ltx_Math" alttext="\bm{r}_{target}" display="inline"><semantics id="alg1.l2.m3.1a"><msub id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">𝒓</mi><mrow id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml"><mi id="alg1.l2.m3.1.1.3.2" xref="alg1.l2.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.3" xref="alg1.l2.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1a" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.4" xref="alg1.l2.m3.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1b" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.5" xref="alg1.l2.m3.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1c" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.6" xref="alg1.l2.m3.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.3.1d" xref="alg1.l2.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m3.1.1.3.7" xref="alg1.l2.m3.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">𝒓</ci><apply id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3"><times id="alg1.l2.m3.1.1.3.1.cmml" xref="alg1.l2.m3.1.1.3.1"></times><ci id="alg1.l2.m3.1.1.3.2.cmml" xref="alg1.l2.m3.1.1.3.2">𝑡</ci><ci id="alg1.l2.m3.1.1.3.3.cmml" xref="alg1.l2.m3.1.1.3.3">𝑎</ci><ci id="alg1.l2.m3.1.1.3.4.cmml" xref="alg1.l2.m3.1.1.3.4">𝑟</ci><ci id="alg1.l2.m3.1.1.3.5.cmml" xref="alg1.l2.m3.1.1.3.5">𝑔</ci><ci id="alg1.l2.m3.1.1.3.6.cmml" xref="alg1.l2.m3.1.1.3.6">𝑒</ci><ci id="alg1.l2.m3.1.1.3.7.cmml" xref="alg1.l2.m3.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\bm{r}_{target}</annotation></semantics></math>, i.e., <math id="alg1.l2.m4.3" class="ltx_Math" alttext="L(N_{target},S_{target},\bm{r}_{target})" display="inline"><semantics id="alg1.l2.m4.3a"><mrow id="alg1.l2.m4.3.3" xref="alg1.l2.m4.3.3.cmml"><mi id="alg1.l2.m4.3.3.5" xref="alg1.l2.m4.3.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.4" xref="alg1.l2.m4.3.3.4.cmml">​</mo><mrow id="alg1.l2.m4.3.3.3.3" xref="alg1.l2.m4.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l2.m4.3.3.3.3.4" xref="alg1.l2.m4.3.3.3.4.cmml">(</mo><msub id="alg1.l2.m4.1.1.1.1.1" xref="alg1.l2.m4.1.1.1.1.1.cmml"><mi id="alg1.l2.m4.1.1.1.1.1.2" xref="alg1.l2.m4.1.1.1.1.1.2.cmml">N</mi><mrow id="alg1.l2.m4.1.1.1.1.1.3" xref="alg1.l2.m4.1.1.1.1.1.3.cmml"><mi id="alg1.l2.m4.1.1.1.1.1.3.2" xref="alg1.l2.m4.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.3" xref="alg1.l2.m4.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1a" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.4" xref="alg1.l2.m4.1.1.1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1b" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.5" xref="alg1.l2.m4.1.1.1.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1c" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.6" xref="alg1.l2.m4.1.1.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.1.1.1.1.1.3.1d" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.7" xref="alg1.l2.m4.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l2.m4.3.3.3.3.5" xref="alg1.l2.m4.3.3.3.4.cmml">,</mo><msub id="alg1.l2.m4.2.2.2.2.2" xref="alg1.l2.m4.2.2.2.2.2.cmml"><mi id="alg1.l2.m4.2.2.2.2.2.2" xref="alg1.l2.m4.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l2.m4.2.2.2.2.2.3" xref="alg1.l2.m4.2.2.2.2.2.3.cmml"><mi id="alg1.l2.m4.2.2.2.2.2.3.2" xref="alg1.l2.m4.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.3" xref="alg1.l2.m4.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1a" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.4" xref="alg1.l2.m4.2.2.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1b" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.5" xref="alg1.l2.m4.2.2.2.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1c" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.6" xref="alg1.l2.m4.2.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.2.2.2.2.2.3.1d" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.7" xref="alg1.l2.m4.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l2.m4.3.3.3.3.6" xref="alg1.l2.m4.3.3.3.4.cmml">,</mo><msub id="alg1.l2.m4.3.3.3.3.3" xref="alg1.l2.m4.3.3.3.3.3.cmml"><mi id="alg1.l2.m4.3.3.3.3.3.2" xref="alg1.l2.m4.3.3.3.3.3.2.cmml">𝒓</mi><mrow id="alg1.l2.m4.3.3.3.3.3.3" xref="alg1.l2.m4.3.3.3.3.3.3.cmml"><mi id="alg1.l2.m4.3.3.3.3.3.3.2" xref="alg1.l2.m4.3.3.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.3" xref="alg1.l2.m4.3.3.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1a" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.4" xref="alg1.l2.m4.3.3.3.3.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1b" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.5" xref="alg1.l2.m4.3.3.3.3.3.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1c" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.6" xref="alg1.l2.m4.3.3.3.3.3.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m4.3.3.3.3.3.3.1d" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.7" xref="alg1.l2.m4.3.3.3.3.3.3.7.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg1.l2.m4.3.3.3.3.7" xref="alg1.l2.m4.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m4.3b"><apply id="alg1.l2.m4.3.3.cmml" xref="alg1.l2.m4.3.3"><times id="alg1.l2.m4.3.3.4.cmml" xref="alg1.l2.m4.3.3.4"></times><ci id="alg1.l2.m4.3.3.5.cmml" xref="alg1.l2.m4.3.3.5">𝐿</ci><vector id="alg1.l2.m4.3.3.3.4.cmml" xref="alg1.l2.m4.3.3.3.3"><apply id="alg1.l2.m4.1.1.1.1.1.cmml" xref="alg1.l2.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m4.1.1.1.1.1.1.cmml" xref="alg1.l2.m4.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m4.1.1.1.1.1.2.cmml" xref="alg1.l2.m4.1.1.1.1.1.2">𝑁</ci><apply id="alg1.l2.m4.1.1.1.1.1.3.cmml" xref="alg1.l2.m4.1.1.1.1.1.3"><times id="alg1.l2.m4.1.1.1.1.1.3.1.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.1"></times><ci id="alg1.l2.m4.1.1.1.1.1.3.2.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.3.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.4.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.5.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.5">𝑔</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.6.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.7.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l2.m4.2.2.2.2.2.cmml" xref="alg1.l2.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m4.2.2.2.2.2.1.cmml" xref="alg1.l2.m4.2.2.2.2.2">subscript</csymbol><ci id="alg1.l2.m4.2.2.2.2.2.2.cmml" xref="alg1.l2.m4.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l2.m4.2.2.2.2.2.3.cmml" xref="alg1.l2.m4.2.2.2.2.2.3"><times id="alg1.l2.m4.2.2.2.2.2.3.1.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.1"></times><ci id="alg1.l2.m4.2.2.2.2.2.3.2.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.3.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.4.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.5.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.6.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.7.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l2.m4.3.3.3.3.3.cmml" xref="alg1.l2.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l2.m4.3.3.3.3.3.1.cmml" xref="alg1.l2.m4.3.3.3.3.3">subscript</csymbol><ci id="alg1.l2.m4.3.3.3.3.3.2.cmml" xref="alg1.l2.m4.3.3.3.3.3.2">𝒓</ci><apply id="alg1.l2.m4.3.3.3.3.3.3.cmml" xref="alg1.l2.m4.3.3.3.3.3.3"><times id="alg1.l2.m4.3.3.3.3.3.3.1.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.1"></times><ci id="alg1.l2.m4.3.3.3.3.3.3.2.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.2">𝑡</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.3.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.3">𝑎</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.4.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.4">𝑟</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.5.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.5">𝑔</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.6.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.6">𝑒</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.7.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.7">𝑡</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m4.3c">L(N_{target},S_{target},\bm{r}_{target})</annotation></semantics></math>.

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span>&nbsp;Each mixture <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\bm{r}_{i}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝒓</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝒓</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\bm{r}_{i}</annotation></semantics></math>&nbsp;<span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span>&nbsp;Each model size <math id="alg1.l4.m1.1" class="ltx_Math" alttext="N_{j}" display="inline"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">N</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑁</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">N_{j}</annotation></semantics></math>&nbsp;<span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Train model of size <math id="alg1.l5.m1.1" class="ltx_Math" alttext="N_{j}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">N</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑁</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">N_{j}</annotation></semantics></math> on mixture <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\bm{r}_{i}" display="inline"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">𝒓</mi><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝒓</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\bm{r}_{i}</annotation></semantics></math> for <math id="alg1.l5.m3.1" class="ltx_Math" alttext="S_{0}" display="inline"><semantics id="alg1.l5.m3.1a"><msub id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><mi id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">S</mi><mn id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1">subscript</csymbol><ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">𝑆</ci><cn type="integer" id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">S_{0}</annotation></semantics></math> steps to obtain <math id="alg1.l5.m4.1" class="ltx_math_unparsed" alttext="L(N_{j},S<S_{0},\bm{r}_{i})" display="inline"><semantics id="alg1.l5.m4.1a"><mrow id="alg1.l5.m4.1b"><mi id="alg1.l5.m4.1.2">L</mi><mrow id="alg1.l5.m4.1.3"><mo stretchy="false" id="alg1.l5.m4.1.3.1">(</mo><msub id="alg1.l5.m4.1.3.2"><mi id="alg1.l5.m4.1.3.2.2">N</mi><mi id="alg1.l5.m4.1.3.2.3">j</mi></msub><mo id="alg1.l5.m4.1.3.3">,</mo><mi id="alg1.l5.m4.1.1">S</mi><mo id="alg1.l5.m4.1.3.4">&lt;</mo><msub id="alg1.l5.m4.1.3.5"><mi id="alg1.l5.m4.1.3.5.2">S</mi><mn id="alg1.l5.m4.1.3.5.3">0</mn></msub><mo id="alg1.l5.m4.1.3.6">,</mo><msub id="alg1.l5.m4.1.3.7"><mi id="alg1.l5.m4.1.3.7.2">𝒓</mi><mi id="alg1.l5.m4.1.3.7.3">i</mi></msub><mo stretchy="false" id="alg1.l5.m4.1.3.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l5.m4.1c">L(N_{j},S&lt;S_{0},\bm{r}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fit training step law to predict <math id="alg1.l6.m1.3" class="ltx_Math" alttext="L(N_{j},S_{target},\bm{r}_{i})" display="inline"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml"><mi id="alg1.l6.m1.3.3.5" xref="alg1.l6.m1.3.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.3.3.4" xref="alg1.l6.m1.3.3.4.cmml">​</mo><mrow id="alg1.l6.m1.3.3.3.3" xref="alg1.l6.m1.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l6.m1.3.3.3.3.4" xref="alg1.l6.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.2.cmml">N</mi><mi id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l6.m1.3.3.3.3.5" xref="alg1.l6.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l6.m1.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.3.2" xref="alg1.l6.m1.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.3" xref="alg1.l6.m1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1a" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.4" xref="alg1.l6.m1.2.2.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1b" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.5" xref="alg1.l6.m1.2.2.2.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1c" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.6" xref="alg1.l6.m1.2.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1d" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.7" xref="alg1.l6.m1.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l6.m1.3.3.3.3.6" xref="alg1.l6.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l6.m1.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.cmml"><mi id="alg1.l6.m1.3.3.3.3.3.2" xref="alg1.l6.m1.3.3.3.3.3.2.cmml">𝒓</mi><mi id="alg1.l6.m1.3.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l6.m1.3.3.3.3.7" xref="alg1.l6.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3"><times id="alg1.l6.m1.3.3.4.cmml" xref="alg1.l6.m1.3.3.4"></times><ci id="alg1.l6.m1.3.3.5.cmml" xref="alg1.l6.m1.3.3.5">𝐿</ci><vector id="alg1.l6.m1.3.3.3.4.cmml" xref="alg1.l6.m1.3.3.3.3"><apply id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2">𝑁</ci><ci id="alg1.l6.m1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l6.m1.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3"><times id="alg1.l6.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l6.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.7.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l6.m1.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.3.3.1.cmml" xref="alg1.l6.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l6.m1.3.3.3.3.3.2.cmml" xref="alg1.l6.m1.3.3.3.3.3.2">𝒓</ci><ci id="alg1.l6.m1.3.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">L(N_{j},S_{target},\bm{r}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg1.l7.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg1.l7.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fit model size scaling law to predict the loss <math id="alg1.l8.m1.3" class="ltx_Math" alttext="L(N_{target},S_{target},\bm{r}_{i})" display="inline"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml"><mi id="alg1.l8.m1.3.3.5" xref="alg1.l8.m1.3.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.3.3.4" xref="alg1.l8.m1.3.3.4.cmml">​</mo><mrow id="alg1.l8.m1.3.3.3.3" xref="alg1.l8.m1.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l8.m1.3.3.3.3.4" xref="alg1.l8.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.2.cmml">N</mi><mrow id="alg1.l8.m1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1a" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.4" xref="alg1.l8.m1.1.1.1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1b" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.5" xref="alg1.l8.m1.1.1.1.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1c" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.6" xref="alg1.l8.m1.1.1.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.3.1d" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.7" xref="alg1.l8.m1.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l8.m1.3.3.3.3.5" xref="alg1.l8.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.3.2" xref="alg1.l8.m1.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.3" xref="alg1.l8.m1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1a" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.4" xref="alg1.l8.m1.2.2.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1b" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.5" xref="alg1.l8.m1.2.2.2.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1c" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.6" xref="alg1.l8.m1.2.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.2.3.1d" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.7" xref="alg1.l8.m1.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l8.m1.3.3.3.3.6" xref="alg1.l8.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l8.m1.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.cmml"><mi id="alg1.l8.m1.3.3.3.3.3.2" xref="alg1.l8.m1.3.3.3.3.3.2.cmml">𝒓</mi><mi id="alg1.l8.m1.3.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l8.m1.3.3.3.3.7" xref="alg1.l8.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.3b"><apply id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3"><times id="alg1.l8.m1.3.3.4.cmml" xref="alg1.l8.m1.3.3.4"></times><ci id="alg1.l8.m1.3.3.5.cmml" xref="alg1.l8.m1.3.3.5">𝐿</ci><vector id="alg1.l8.m1.3.3.3.4.cmml" xref="alg1.l8.m1.3.3.3.3"><apply id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.2">𝑁</ci><apply id="alg1.l8.m1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3"><times id="alg1.l8.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.1"></times><ci id="alg1.l8.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.4.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.5.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.5">𝑔</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.6.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.7.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l8.m1.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l8.m1.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3"><times id="alg1.l8.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l8.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.7.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l8.m1.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.3.3.1.cmml" xref="alg1.l8.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l8.m1.3.3.3.3.3.2.cmml" xref="alg1.l8.m1.3.3.3.3.3.2">𝒓</ci><ci id="alg1.l8.m1.3.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">L(N_{target},S_{target},\bm{r}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span><span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>Fit the data mixing law to predict <math id="alg1.l10.m1.3" class="ltx_Math" alttext="L(N_{target},S_{target},\bm{r}_{target})" display="inline"><semantics id="alg1.l10.m1.3a"><mrow id="alg1.l10.m1.3.3" xref="alg1.l10.m1.3.3.cmml"><mi id="alg1.l10.m1.3.3.5" xref="alg1.l10.m1.3.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.4" xref="alg1.l10.m1.3.3.4.cmml">​</mo><mrow id="alg1.l10.m1.3.3.3.3" xref="alg1.l10.m1.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l10.m1.3.3.3.3.4" xref="alg1.l10.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.2.cmml">N</mi><mrow id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.3.2" xref="alg1.l10.m1.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.3" xref="alg1.l10.m1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1a" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.4" xref="alg1.l10.m1.1.1.1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1b" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.5" xref="alg1.l10.m1.1.1.1.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1c" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.6" xref="alg1.l10.m1.1.1.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.3.1d" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.7" xref="alg1.l10.m1.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l10.m1.3.3.3.3.5" xref="alg1.l10.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l10.m1.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.3.2" xref="alg1.l10.m1.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.3" xref="alg1.l10.m1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1a" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.4" xref="alg1.l10.m1.2.2.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1b" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.5" xref="alg1.l10.m1.2.2.2.2.2.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1c" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.6" xref="alg1.l10.m1.2.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.1d" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.7" xref="alg1.l10.m1.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l10.m1.3.3.3.3.6" xref="alg1.l10.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l10.m1.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.cmml"><mi id="alg1.l10.m1.3.3.3.3.3.2" xref="alg1.l10.m1.3.3.3.3.3.2.cmml">𝒓</mi><mrow id="alg1.l10.m1.3.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l10.m1.3.3.3.3.3.3.2" xref="alg1.l10.m1.3.3.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1a" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.4" xref="alg1.l10.m1.3.3.3.3.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1b" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.5" xref="alg1.l10.m1.3.3.3.3.3.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1c" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.6" xref="alg1.l10.m1.3.3.3.3.3.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.3.3.3.3.3.1d" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.7" xref="alg1.l10.m1.3.3.3.3.3.3.7.cmml">t</mi></mrow></msub><mo stretchy="false" id="alg1.l10.m1.3.3.3.3.7" xref="alg1.l10.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.3b"><apply id="alg1.l10.m1.3.3.cmml" xref="alg1.l10.m1.3.3"><times id="alg1.l10.m1.3.3.4.cmml" xref="alg1.l10.m1.3.3.4"></times><ci id="alg1.l10.m1.3.3.5.cmml" xref="alg1.l10.m1.3.3.5">𝐿</ci><vector id="alg1.l10.m1.3.3.3.4.cmml" xref="alg1.l10.m1.3.3.3.3"><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2">𝑁</ci><apply id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3"><times id="alg1.l10.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.1"></times><ci id="alg1.l10.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.4.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.5.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.5">𝑔</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.6.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.7.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l10.m1.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l10.m1.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3"><times id="alg1.l10.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l10.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.7.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l10.m1.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.3.3.3.1.cmml" xref="alg1.l10.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l10.m1.3.3.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.3.3.2">𝒓</ci><apply id="alg1.l10.m1.3.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3.3"><times id="alg1.l10.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.1"></times><ci id="alg1.l10.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.2">𝑡</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.3">𝑎</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.4.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.4">𝑟</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.5.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.5">𝑔</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.6.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.6">𝑒</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.7.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.7">𝑡</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.3c">L(N_{target},S_{target},\bm{r}_{target})</annotation></semantics></math>

</div>
</div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>A Pipeline for Loss Predictions</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS1.p1.1">데이터 혼합 법칙을 사용하면 보이지 않는 혼합물에 대해 훈련된 모델의 성능을 예측할 수 있지만, 법칙에 적합해야 하는 요구 사항은 대상 모델과 동일한 모델 크기 및 토큰 수를 가진 다양한 혼합물에 걸쳐 여러 모델을 훈련시키는 것을 포함한다. 또한 각 대상 모델 크기와 훈련 데이터 세트 <span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>An idea is to transfer the optimized training mixture on small models trained with few tokens to the training of large models and large volumes of training data. Nevertheless, in Appendix <a class="ltx_ref" href="#A1" title="Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">A</span></a>, we show that the partial order of data mixture concerning model performance varies as the model size and number of trained tokens change. Therefore, the optimal mixture at experimented scales can be suboptimal at the target scale. </span></span></span>에 대해 이 과정을 반복해야 한다. 이는 값비싼 비용을 초래하여 데이터 혼합법의 실질적인 가치를 저해한다.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS1.p2.2">따라서 우리는 대규모 훈련 없이 다양한 혼합물 비율의 손실을 얻을 수 있는지 궁금하다. 다행히도, 이 아이디어는 훈련 단계 및 모델 크기의 스케일링 법칙의 인상적인 외삽을 검증하는 기존 경험으로부터 지지를 얻는다. 특히, <cite class="ltx_cite ltx_citemacro_citet">OpenAI (<a class="ltx_ref" href="#bib.bib48" title="">2023</a>)</cite>는 단지 <math alttext="1,000\times" class="ltx_math_unparsed" display="inline" id="S4.SS1.p2.1.m1.2"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2b"><mn id="S4.SS1.p2.1.m1.1.1">1</mn><mo id="S4.SS1.p2.1.m1.2.3">,</mo><mn id="S4.SS1.p2.1.m1.2.2">000</mn><mo id="S4.SS1.p2.1.m1.2.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">1,000\times</annotation></semantics></math>–<math alttext="10,000\times" class="ltx_math_unparsed" display="inline" id="S4.SS1.p2.2.m2.2"><semantics id="S4.SS1.p2.2.m2.2a"><mrow id="S4.SS1.p2.2.m2.2b"><mn id="S4.SS1.p2.2.m2.1.1">10</mn><mo id="S4.SS1.p2.2.m2.2.3">,</mo><mn id="S4.SS1.p2.2.m2.2.2">000</mn><mo id="S4.SS1.p2.2.m2.2.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.2c">10,000\times</annotation></semantics></math> less compute로 타겟 모델의 손실을 예측한다. 결과적으로, 서로 다른 혼합물에 대한 훈련 단계가 적은 소규모 모델을 훈련할 수 있으며, 이에 대한 스케일링 법칙을 피팅하여 목표 모델 크기와 목표 훈련 단계 수의 손실을 추정할 수 있다. 그런 다음 예측된 손실을 사용하여 데이터 혼합 법칙을 적합시키고 최적의 혼합물을 검색할 수 있다. 제안된 파이프라인은 그림에 나와 있다. <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a> with details depicted in Alg. <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS1.p3.1">우리는 스케일링 법칙의 중첩 사용이 우리가 아는 한 기존 문헌에서 여전히 널리 채택된 전략이 아니라는 점에 주목한다. 대부분의 연구는 후자의 <cite class="ltx_cite ltx_citemacro_citep">(Hashimoto, <a class="ltx_ref" href="#bib.bib28" title="">2021</a>; Frantar et al., <a class="ltx_ref" href="#bib.bib19" title="">2023</a>; Aghajanyan et al., <a class="ltx_ref" href="#bib.bib1" title="">2023</a>)</cite>에 변수를 통합하여 새로 발견된 스케일링 법칙을 기존 법칙과 연결하려고 한다. 서로 다른 스케일링 법칙을 통합하는 것이 매력적이지만 여러 변수 간의 상호 작용에 추가된 복잡성으로 인해 함수 형태를 식별하는 것이 매우 어렵고 검증하기가 어렵다. 모델 크기와 훈련 데이터의 수에 관한 여러 가지 요인(모델 크기 및 훈련 데이터의 수)을 가지고 스케일링 법칙을 도출하는 선구적 노력<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et al., <a class="ltx_ref" href="#bib.bib37" title="">2020</a>; Hoffmann et al., <a class="ltx_ref" href="#bib.bib33" title="">2022</a>)</cite>는 오차 분해 이론을 가정하지만, 그 결과는 여전히 대규모 실무에서 널리 검증되지 않고 있다. 이러한 관점에서, 우리는 스케일링 법칙의 중첩된 사용이 스케일링 법칙을 사용하는 새로운 기술적 루틴을 제공하며, 이는 기존 법칙을 복잡하게 만드는 거대한 도전을 우회하여 스케일링 법칙의 발견 및 적용에 더 쉽게 접근할 수 있게 한다고 생각한다.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiment</h3>

<figure id="S4.F6" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/figs/optimize_loss_2.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="176" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">그림 6:</span>100B 토큰에 대한 RedPajama의 기본 혼합물 및 최적화된 혼합물에 대해 트레이닝된 1B 모델에 대한 파일 검증 세트에 대한 검증 복잡성.</figcaption>
Our optimized mixture achieves the performance of the default mixture only using 0.73 of the original number of training steps and eventually achieves a performance comparable to a default mixture trained with 1.48 times more tokens (estimated by the scaling law of training steps, shown as the dashed line).
The specific mixture proportions are in the right table.
</figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS2.p1.1">우리는 100B 토큰에 대해 훈련된 1B 모델의 검증 손실을 최소화하기 위한 실험을 통해 파이프라인의 효과를 검증한다.</p>
</div>
<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Setups.</h4>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">레드파자마의 혼합물에서 모델을 훈련하고 검증 데이터가 훈련 데이터와 별도로 수집되는 시나리오를 모방하도록 파일의 검증 세트를 검증한다. 훈련 단계 및 모델 크기의 스케일링 법칙에 적합하도록, 우리는 30B 토큰에 대해 일련의 70M, 160M, 305M 및 410M 모델을 훈련시킨다. 모든 모델에 대해 배치 크기를 1M 토큰으로 설정하여 1B 모델의 경우 100k 단계, 소형 모델의 경우 30k 단계로 변환한다. 우리는 100k 번째 단계에서 최대 학습률의 0.1로 감쇠하는 2k 단계의 웜업과 함께 코사인 학습률 감쇠를 적용한다.</p>
</div>
<div id="S4.SS2.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.1">제한된 수의 실험 실행으로 낮은 예측 오류에 도달하기 위해 혼합물 비율 항이 데이터 혼합 법칙 내에서 지수 함수로 표현된다는 사실을 활용하여 실험을 위한 혼합물을 선택한다. 특히, 모든 도메인 토큰을 사용하지 않는 최대 사용 가능한 것에서 시작하여 각 훈련 도메인에 대한 비율을 이중으로 감소시켜 후보 혼합물을 열거한다. 이러한 방식으로, 각각의 (암시적) 검증 도메인의 손실은 균등하게 분포된다. 그런 다음 모든 후보에서 40개의 혼합물을 샘플링하고 가장 작은 70M 모델을 훈련한다. 데이터 혼합 법칙에 맞게 20개의 혼합물 그룹을 다시 샘플링하고 40개 샘플 모두에서 최소 예측 오류에 도달하는 그룹을 파이프라인을 실행할 최종 혼합물 세트로 선택한다. 자세한 내용은 부록 <a class="ltx_ref" href="#A2.SS2" title="B.2 Fitting Mixture Laws ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">B.2</span></a>를 참조해 주십시오.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4>

<figure id="S4.F7" class="ltx_figure ltx_align_floatright"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/figs/predictions.png" id="S4.F7.g1" class="ltx_graphics ltx_img_landscape" width="598" height="449" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">그림 7:</span></figcaption>
Results of our loss prediction pipelines for the overall validation loss and domain losses.
Fitting data are from 70M to 410M models trained for 30B tokens, while the extrapolated points are from the default and optimized mixture for 1B models and 100B tokens.
</figcaption>
</figure>
<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">Fig. <a class="ltx_ref" href="#S4.F6" title="Figure 6 ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a>는 <cite class="ltx_cite ltx_citemacro_citet">Touvron et al. (<a class="ltx_ref" href="#bib.bib56" title="">2023a</a>)</cite>에서 사용된 RedPajama의 기본 혼합물과 Alg로부터 얻은 최적화된 혼합물을 나타낸다. <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a> with their performance on the validation data. 손실 예측은 그림 1에 나와 있다. <a class="ltx_ref" href="#S4.F7" title="Figure 7 ‣ Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a>. 그걸 발견하면...</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.I1.i1.p1.1.1">The pipeline optimizes performance effectively. </span> 최적화된 혼합물에 대해 훈련된 모델은 73% 단계만으로 기본 혼합물에 대해 훈련된 것과 유사한 성능을 달성할 수 있다. 기본 혼합물을 사용하여 훈련하면 결국 48% 더 많은 단계를 필요로 하는 성능을 달성합니다. 이는 혼합물 최적화에서 파이프라인의 효율성을 나타냅니다.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.I1.i2.p1.1.1">Predictions provides references for the balance of model capabilities. </span> 예측 결과. <a class="ltx_ref" href="#S4.F7" title="Figure 7 ‣ Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a>는 전체 검증 데이터 및 서로 다른 검증 도메인 모두에 대한 손실의 상대적 규모에 대한 그럴듯한 참조를 보여준다. 전체 손실이 전체 성능을 최적화하는 데 도움이 되지만, 다른 도메인의 손실은 다양한 측면에서 모델 기능을 보여줍니다. 우리는 이것이 모델 능력의 미묘한 균형을 위한 추가 혼합 큐레이팅을 용이하게 한다고 가정한다.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S5.p1.1">또한 데이터 혼합 법칙을 지속적인 사전 훈련에 적용하는 데 관심이 있으며, 이는 관련 패러다임과 동일한 패러다임을 공유하지만 무작위 초기화가 아닌 사전 훈련된 매개변수로 모델을 시작한다. 일반적으로, 연속 프리트레이닝은 기존의 프리트레이닝 모델을 향상시키기 위한 일반적인 기술이다. 분포 이동으로 인한 성능 저하를 방지하면서 최신 지식을 모델에 주입합니다. <cite class="ltx_cite ltx_citemacro_citep">(Gururangan et al., <a class="ltx_ref" href="#bib.bib25" title="">2020</a>; Xiong et al., <a class="ltx_ref" href="#bib.bib65" title="">2023</a>)</cite>. 또한, 연구자들은 다른 아키텍처의 모델을 구축하기 위해 기존 모델 매개변수를 재사용하기 위해 지속적인 사전 훈련을 적용한다.</p>
</div>
<figure id="S5.F8" class="ltx_figure"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/figs/continue_all.png" id="S5.F8.g1" class="ltx_graphics ltx_img_landscape" width="598" height="249" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">그림 8: </span>Loss predictions and training curve of continual pretraining Pythia-70M on the mixture of the Pile and python code. (A) 말뚝에 대한 손실 예측; (B) 비단뱀에 대한 손실 예측; (C) 말뚝에 대한 손실을 갖는 훈련 곡선; (D) 비단뱀에 대한 손실을 갖는 훈련 곡선. 우리는 Eqn으로 최종 손실을 예측한다. <a class="ltx_ref" href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a>. 법칙은 원래 도메인(즉, 파일)에서 모델 성능을 유지하는 임계 혼합 비율을 정확하게 찾는다.</figcaption>
</figcaption>
</figure>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S5.p2.1">연속적인 사전 훈련의 전형적인 시나리오에 대해 실험하며, 여기서 모델을 향상시키기 위해 원래 사전 훈련 데이터와 목표 도메인의 다가오는 데이터의 혼합에 대해 훈련한다. 예를 들어, 우리는 파일과 파이썬 코드가 혼합된 피티아-70M 모델을 지속적으로 사전 훈련하는데, 여기서 전자는 기본 모델의 원래 사전 훈련 데이터이다. 우리의 데이터 혼합 법칙이 지속적인 사전 훈련에 적용되는지 확인하기 위해 우리는 4개의 혼합물에서 10B 토큰에 대한 모델을 훈련하고 Eqn에 맞는다. 파일 및 파이썬 코드의 손실에 대한 <a class="ltx_ref" href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a>. 결과는 다음과 같다. <a class="ltx_ref" href="#S5.F8" title="Figure 8 ‣ 5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a> confirm that Eqn. <a class="ltx_ref" href="#S3.E6" title="In Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a>는 지속적인 사전 훈련의 손실에 들어맞는다.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S5.p3.1">지속적인 사전 훈련 동안 대상 데이터의 너무 큰 비율은 원본 데이터의 성능을 손상시킬 수 있다. 대표적인 혼합물 최적화 목표는 범용 능력(말뚝의 느슨함)을 변경하지 않고 유지하는 것이다. 이를 위해 적합 데이터 혼합 법칙을 사용하여 <span class="ltx_text ltx_font_italic" id="S5.p3.1.1">critical proportion</span>을 예측하여 연속 사전 훈련 전과 동일한 손실을 초래한다. Fig. <a class="ltx_ref" href="#S5.F8" title="Figure 8 ‣ 5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a>는 목표 도메인에서 개선을 얻으면서 지속적인 사전 훈련 전에 모델과 유사한 성능을 보이는 비율을 찾는 예측의 성공을 보여준다.</p>
</div>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.p4.1.1">Remarks. </span> 우리는 데이터 스케줄의 설계에 대한 지속적인 사전 훈련이 <cite class="ltx_cite ltx_citemacro_citep">(Albalak et al., <a class="ltx_ref" href="#bib.bib3" title="">2023</a>; Chen et al., <a class="ltx_ref" href="#bib.bib13" title="">2024b</a>)</cite>와 관련이 있다고 제안한다. 일반적으로 연속 사전 훈련은 사전 훈련된 모델에 적용되는 반면, 연속 사전 훈련된 모델, 즉 다단계 사전 훈련<cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="#bib.bib13" title="">2024b</a>)</cite>를 더 지속적으로 사전 훈련하는 것은 자연스럽다. 각각의 단계에서, 혼합 비율 또는 심지어 트레이닝 데이터의 도메인 컴포넌트들은 상이할 수 있다. 이는 훈련 단계의 수가 무한한 한계에 가까워짐에 따라 동적 데이터 스케줄이 된다. 따라서 지속적인 훈련에 대한 데이터 혼합 법칙의 성공적인 적용은 보다 포괄적인 데이터 큐레이팅 패러다임인 동적 데이터 스케줄을 설계하는 데 사용할 수 있는 유망한 전망을 나타낸다.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2>

<section id="S6.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Curating pretraining data for LLMs.</h4>

<div id="S6.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S6.SS0.SSS0.Px1.p1.1">수조 개의 토큰에 대한 대규모 변압기 아키텍처 훈련, 즉 사전 훈련은 인상적인 인간 유사 일반주의 능력을 나타내는 현대 대형 언어 모델을 구축하는 주요 단계이다. 모델 학습을 위한 대부분의 계산 자원을 차지하며 연구원들은 LLMs<cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="#bib.bib67" title="">2024</a>)</cite>에서 거의 모든 지식을 제공한다고 믿는다. 이러한 중요한 영향은 계산 비용을 줄이고 지식을 향상시키기 위한 데이터 큐레이팅 전략의 개발에 동기를 부여한다. 노력은 두 단계로 분류할 수 있다. 첫 번째 단계는 고품질 훈련 데이터 세트를 얻는 데 중점을 둡니다. 전형적인 절차는 상이한 도메인들을 구성하기 위해 데이터 소스들을 선택하는 것, 중복제거, 및 가장 복잡한 필터링 <cite class="ltx_cite ltx_citemacro_citep">(Wenzek et al., <a class="ltx_ref" href="#bib.bib62" title="">2019</a>; Penedo et al., <a class="ltx_ref" href="#bib.bib49" title="">2023</a>)</cite>를 포함한다. 기존의 많은 노력들은 다양한 필터들을 포함하고 있으며, 문자들 <cite class="ltx_cite ltx_citemacro_citep">(Rae et al., <a class="ltx_ref" href="#bib.bib51" title="">2021</a>; Xie et al., <a class="ltx_ref" href="#bib.bib64" title="">2024b</a>; Raffel et al., <a class="ltx_ref" href="#bib.bib52" title="">2020</a>)</cite>의 피상적인 특징들로부터 고품질 참조 말뭉치 <cite class="ltx_cite ltx_citemacro_citep">(Wenzek et al., <a class="ltx_ref" href="#bib.bib62" title="">2019</a>)</cite>와 독성 <cite class="ltx_cite ltx_citemacro_citep">(Longpre et al., <a class="ltx_ref" href="#bib.bib42" title="">2023</a>; Friedl, <a class="ltx_ref" href="#bib.bib21" title="">2023</a>)</cite>와의 유사성을 포함한 의미까지 문서들을 채점한다. 데이터 세트를 보류한 상태에서 두 번째 단계는 데이터 세트를 가장 잘 사용하는 것을 목표로 합니다. 여기에는 데이터 혼합물 <cite class="ltx_cite ltx_citemacro_citep">(Du et al., <a class="ltx_ref" href="#bib.bib17" title="">2022</a>; Touvron et al., <a class="ltx_ref" href="#bib.bib56" title="">2023a</a>; Xie et al., <a class="ltx_ref" href="#bib.bib63" title="">2024a</a>)</cite>를 튜닝하는 것과 데이터 스케줄 <cite class="ltx_cite ltx_citemacro_citep">(Mindermann et al., <a class="ltx_ref" href="#bib.bib46" title="">2022</a>; Albalak et al., <a class="ltx_ref" href="#bib.bib3" title="">2023</a>; Chen et al., <a class="ltx_ref" href="#bib.bib13" title="">2024b</a>; Fan et al., <a class="ltx_ref" href="#bib.bib18" title="">2024</a>)</cite>를 고안하는 것이 포함된다. 우리의 작업은 이러한 튜닝 데이터 혼합물 중 하나이며 사전 교육을 계속하는 확장은 일정 설계를 안내할 가능성을 나타낸다. 직관이나 질적 대상에 의존하는 기존의 시도와는 달리, 본 연구는 양적 해결 방안을 모색한다.</p>
</div>
</section>
<section id="S6.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Scaling laws</h4>

<div id="S6.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S6.SS0.SSS0.Px2.p1.1">는 관심 속성들(예를 들어, 테스트 손실 또는 다른 성능 메트릭들)과 최적화 프로세스 또는 아키텍처(예를 들어, 모델 크기들 및 트레이닝 샘플들의 수들)에 관한 제어가능한 인자들의 스케일들 사이의 기능적 관계들 ―<cite class="ltx_cite ltx_citemacro_citep">(Villalobos, <a class="ltx_ref" href="#bib.bib61" title="">2023</a>)</cite>. 머신러닝의 발달과 함께 스케일링 행동을 특성화하는 것은 학습 이론의 맥락에서 큰 연구 관심을 불러일으켰으며, 멱법칙<cite class="ltx_cite ltx_citemacro_citep">(Vapnik &amp; Chervonenkis, <a class="ltx_ref" href="#bib.bib59" title="">1971</a>; Valiant, <a class="ltx_ref" href="#bib.bib58" title="">1984</a>; Haussler, <a class="ltx_ref" href="#bib.bib29" title="">1988</a>; Amari et al., <a class="ltx_ref" href="#bib.bib4" title="">1992</a>)</cite> 형태의 훈련 샘플 수를 감안할 때 일반화 오류를 경계로 삼았다. 그럼에도 불구하고 지나치게 엄격한 가정은 실제 적용을 방해한다. 최근, 스케일링에 대한 통계적 추정은 심층 신경망에서 빠른 발전을 얻었고 스케일링 법칙의 도입을 낳았다. <cite class="ltx_cite ltx_citemacro_citet">Hestness et al. (<a class="ltx_ref" href="#bib.bib32" title="">2017</a>)</cite>는 추세를 개척하고 요인의 폭에 걸쳐 멱법칙 일반화 오차 스케일링을 보여주지만 멱법칙 지수는 이전의 이론적 분석과 다르다. <cite class="ltx_cite ltx_citemacro_citet">Kaplan et al. (<a class="ltx_ref" href="#bib.bib37" title="">2020</a>); Hoffmann et al. (<a class="ltx_ref" href="#bib.bib33" title="">2022</a>); Henighan et al. (<a class="ltx_ref" href="#bib.bib30" title="">2020</a>)</cite>는 Transformer 구조 <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a class="ltx_ref" href="#bib.bib60" title="">2017</a>)</cite>에 대해 보다 포괄적인 조사를 수행하여 모델 크기, 훈련 데이터 양 및 크기 순서에 따른 계산에 관한 테스트 손실에 대한 멱함수 관계를 더욱 강조한다. 이러한 연구 결과는 정량적 스케일링을 통해 성능 향상을 예측하고 더 큰 모델과 더 많은 훈련 데이터 간의 트레이드오프를 안내하여 나중에 대규모 언어 모델의 개발을 지향한다. <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a class="ltx_ref" href="#bib.bib10" title="">2020</a>; Hoffmann et al., <a class="ltx_ref" href="#bib.bib33" title="">2022</a>; OpenAI, <a class="ltx_ref" href="#bib.bib48" title="">2023</a>)</cite> 최근 진보적인 조사는 기존의 스케일링 법칙 <cite class="ltx_cite ltx_citemacro_citep">(Caballero et al., <a class="ltx_ref" href="#bib.bib11" title="">2022</a>; Alabdulmohsin et al., <a class="ltx_ref" href="#bib.bib2" title="">2022</a>)</cite>에 대한 수정, 경험적 공식 <cite class="ltx_cite ltx_citemacro_cite">Bahri et al. (<a class="ltx_ref" href="#bib.bib5" title="">2021</a>); Hutter (<a class="ltx_ref" href="#bib.bib35" title="">2021</a>); Michaud et al. (<a class="ltx_ref" href="#bib.bib45" title="">2024</a>)</cite>에 대한 이론적 설명을 찾고, 더 광범위한 시나리오 <cite class="ltx_cite ltx_citemacro_citep">(Hernandez et al., <a class="ltx_ref" href="#bib.bib31" title="">2021</a>; Frantar et al., <a class="ltx_ref" href="#bib.bib19" title="">2023</a>; Liu et al., <a class="ltx_ref" href="#bib.bib41" title="">2023</a>)</cite>에서 기능적 관계를 탐구하는 것을 제안한다. 우리의 연구와 가장 관련이 있는 연구는 여러 데이터 소스에서 성능 예측을 탐구하지만 소규모 지도 학습 작업에 국한된 <cite class="ltx_cite ltx_citemacro_citet">Hashimoto (<a class="ltx_ref" href="#bib.bib28" title="">2021</a>)</cite>이다.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussions</h2>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S7.p1.1">이 연구에서는 학습 데이터의 혼합 비율에 대한 모델 손실의 정량적 예측 가능성을 발견하며, 이는 데이터 혼합 법칙으로 귀결된다. 우리의 연구 결과는 두 도메인에서 여러 도메인으로의 훈련 데이터와 단일 도메인에서 알려지지 않은 구성으로의 검증 데이터를 포함한다. 데이터 혼합 법칙을 사용하면 실무자가 실제 훈련 전에 보이지 않는 혼합물 비율에 대한 모델 성능을 정량적으로 추정할 수 있어 이상적인 혼합물 비율의 조정을 용이하게 한다. 또한 훈련 단계, 모델 크기 및 데이터 혼합물의 스케일링 법칙을 사용하여 소규모의 실험만으로 예측을 하는 중첩 사용을 제안하여 기존 실험의 재사용을 가능하게 하고 계산 비용을 줄인다. 실험 결과는 이 방법이 데이터 혼합을 효과적으로 최적화하여 사전 훈련에서 더 나은 성능을 가져오고 지속적인 사전 훈련에서 사전 훈련 모델의 원래 능력을 유지한다는 것을 시사한다.</p>
</div>
<div id="S7.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S7.p2.1">물론 데이터 혼합이 모델 학습에 미치는 영향은 완전히 이해되지 않는다. 우리의 연구는 몇 가지 한계를 남기면서 정량적 프레임워크에 대한 예비 시도를 한다.</p>
</div>
<section id="S7.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On the clarification of domains.</h4>

<div id="S7.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S7.SS0.SSS0.Px1.p1.1">영역의 개념은 잘 정의되어 있지 않다. 본 논문에서는 관련 연구 <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a class="ltx_ref" href="#bib.bib63" title="">2024a</a>; Chen et al., <a class="ltx_ref" href="#bib.bib13" title="">2024b</a>; Albalak et al., <a class="ltx_ref" href="#bib.bib3" title="">2023</a>; Fan et al., <a class="ltx_ref" href="#bib.bib18" title="">2024</a>)</cite>와 유사하게 오픈 소스 학습 데이터에 미리 정의된 도메인을 직접 채택한다. 그럼에도 불구하고, 우리는 클러스터링 <cite class="ltx_cite ltx_citemacro_citep">(Gururangan et al., <a class="ltx_ref" href="#bib.bib26" title="">2023</a>; Shao et al., <a class="ltx_ref" href="#bib.bib53" title="">2024</a>)</cite>와 같이 더 조작적으로 정의된 훈련 도메인이 데이터 혼합 법칙의 예측 정확도와 결과 모델의 성능에 더 도움이 될 수 있다고 가정한다. 검증 도메인의 경우, 우리의 암묵적 도메인 집계 방법은 검증 데이터를 훈련 도메인과 명시적으로 정렬할 필요성을 제거한다. 검증 데이터가 일반적으로 훈련 도메인의 단순한 컴파일보다 신뢰할 수 있는 데이터 세트를 포함한다는 점을 감안할 때 이 요구 사항은 종종 발생한다. 그러나 우리는 암시적 도메인 집합이 명시적 접근법에 비해 덜 해석 가능하고 후속적으로 정교화되는 것처럼 정확성에 대한 우려를 제기할 수 있음을 인정한다.</p>
</div>
</section>
<section id="S7.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On the error analyses.</h4>

<div id="S7.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S7.SS0.SSS0.Px2.p1.1">스케일링 법칙을 활용하려면 함수에 맞는 샘플을 제공하는 실험이 필요하다. 결과적으로, 예측 오차를 가장 크게 줄이기 위해 실험할 피팅 샘플의 수와 이러한 샘플을 배포하는 방법을 결정하기 위해서는 실험<cite class="ltx_cite ltx_citemacro_citep">(Mead, <a class="ltx_ref" href="#bib.bib44" title="">1990</a>)</cite>의 신중한 설계가 필요하다. 본 연구에서는 저렴한 예산에 따라 수를 결정하고 데이터 샘플의 손실을 균등하게 분배하는 간단한 규칙을 활용하지만 이론적으로 더 정당화된 규칙을 고려하는 것이 필요하다. 또한, 스케일링 법칙의 중첩 사용은 각 단계에서 오류를 유발할 수 있다. 따라서 오류 누적을 완화하기 위한 추가 분석도 필요하다. 를 더 포함할 수 있다. <a class="ltx_ref" href="#S4.F7" title="Figure 7 ‣ Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a>에서 우리는 우리의 예측이 실제 손실보다 작음을 알 수 있으며, 이는 우리가 적합하는 단계 법칙과 모델 크기 법칙에서 과소 평가되기 때문이다. 추가적인 실제 경험은 스케일링 법칙<cite class="ltx_cite ltx_citemacro_citep">(Su et al., <a class="ltx_ref" href="#bib.bib54" title="">2024</a>)</cite>의 기술적 세부사항을 변형시켜 오류를 제거하는 데 도움이 될 수 있다.</p>
</div>
</section>
<section id="S7.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On joint laws of multiple factors.</h4>

<div id="S7.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S7.SS0.SSS0.Px3.p1.1">우리는 훈련 단계, 모델 크기 및 혼합 비율의 공동 법칙을 찾는 데 어려움을 피하기 위해 스케일링 법칙의 중첩 사용을 제안한다. 파이프라인으로 손실을 예측할 수 있지만 공동 법률은 다양한 요인의 명확한 시너지 효과를 공개합니다. 예를 들어, 이전 연구에서는 모델 크기와 훈련 데이터의 스케일링 법칙에서 멱함수 지수가 훈련 및 검증 데이터에 둔감하다는 것을 나타낸다. 데이터 혼합물로 그들의 공동 법칙을 알아내면 이 추측을 더 확인할 수 있다. 또한 공동법은 별도의 법률의 계수 공유도 시행하여 필요한 피팅 샘플의 수를 줄인다.</p>
</div>
</section>
<section id="S7.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On dynamic data curating.</h4>

<div id="S7.SS0.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S7.SS0.SSS0.Px4.p1.1">우리의 연구는 사전 훈련을 위한 고정된 혼합물 비율 그룹을 결정하기 위한 파이프라인을 제시한다. 보다 정교한 데이터 큐레이팅은 동적 비율 <cite class="ltx_cite ltx_citemacro_citep">(Albalak et al., <a class="ltx_ref" href="#bib.bib3" title="">2023</a>)</cite> 및 심지어 데이터 도메인 <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="#bib.bib13" title="">2024b</a>)</cite>를 변경하는 커리큘럼을 포함할 수 있다. The application of our data mixing laws in continuous pretraining (Sec. <a class="ltx_ref" href="#S5" title="5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">5</span></a>) 우리의 연구 결과를 이러한 설정으로 확장할 가능성을 암시한다. 여기에 역동적인 데이터 혼합 법칙을 추구하기 위해 추가 분석을 통합하는 것이 유망하다고 생각한다.</p>
</div>
</section>
<section id="S7.SS0.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">On theoretical understandings.</h4>

<div id="S7.SS0.SSS0.Px5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S7.SS0.SSS0.Px5.p1.1">우리의 데이터 혼합 법칙은 대부분의 스케일링 법칙과 유사하게 경험적 발견이다. 우리는 법칙을 형성하는 훈련 역학에 대한 이론적 이해가 더 확실한 정당성을 제공한다고 믿는다. 잠재적 관점은 기울기 추정 <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="#bib.bib24" title="">2024</a>; Gu et al., <a class="ltx_ref" href="#bib.bib23" title="">2024</a>)</cite>를 통해 혼합 비율 튜닝의 대상을 이해하는 것이다. 구체적으로, 혼합물 비율은 훈련 동안 상이한 도메인으로부터의 구배들의 선형 조합에 대한 가중치로 그 효과가 귀결되는 상이한 도메인으로부터의 중량 데이터를 비율화한다. 이 관점은 혼합 비율을 조정하는 대상을 이상적인 기울기 방향을 찾는 것으로 전환하고 데이터 샘플 간의 관계를 기울기 방향 <cite class="ltx_cite ltx_citemacro_citep">(Gu et al., <a class="ltx_ref" href="#bib.bib23" title="">2024</a>)</cite>로 공식화한다.</p>
</div>
<div id="S7.SS0.SSS0.Px5.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="S7.SS0.SSS0.Px5.p2.1">요약하면, 우리는 사전 훈련 데이터 큐레이션을 위한 정량적 예측 방법에 대한 조사를 시작한다. 데이터 엔지니어링에 대한 관심이 높아짐에 따라 본 연구의 탐색이 이 연구 영역에서 추가 양적 연구와 이론적 분석을 용이하게 하기를 바란다.</p>
</div>
</section>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="Sx1.p1.1">이 연구의 계산은 푸단 대학의 CFFF 플랫폼을 사용하여 수행되었다. 우리는 그들의 통찰력 있는 토론에 대해 보톈 장과 시두오 장에게 감사한다.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aghajanyan et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Armen Aghajanyan, Lili Yu, Alexis Conneau, Wei-Ning Hsu, Karen Hambardzumyan, Susan Zhang, Stephen Roller, Naman Goyal, Omer Levy, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Scaling laws for generative mixed-modal language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2301.03728</em>, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alabdulmohsin et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Ibrahim&nbsp;M Alabdulmohsin, Behnam Neyshabur, and Xiaohua Zhai.

</span>
<span class="ltx_bibblock">Revisiting neural scaling laws in language and vision.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:22300–22312, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Albalak et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Alon Albalak, Liangming Pan, Colin Raffel, and William&nbsp;Yang Wang.

</span>
<span class="ltx_bibblock">Efficient online data mixing for language model pre-training.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2312.02406</em>, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amari et&nbsp;al. (1992)</span>
<span class="ltx_bibblock">
Shun-ichi Amari, Naotake Fujita, and Shigeru Shinomoto.

</span>
<span class="ltx_bibblock">Four types of learning curves.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Neural Computation</em>, 4(4):605–618, 1992.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahri et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Yasaman Bahri, Ethan Dyer, Jared Kaplan, Jaehoon Lee, and Utkarsh Sharma.

</span>
<span class="ltx_bibblock">Explaining neural scaling laws.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.06701</em>, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu&nbsp;Han, Fei Huang, et&nbsp;al.

</span>
<span class="ltx_bibblock">Qwen technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.16609</em>, 2023.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bi et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Xiao Bi, Deli Chen, Guanting Chen, Shanhuang Chen, Damai Dai, Chengqi Deng, Honghui Ding, Kai Dong, Qiushi Du, Zhe Fu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Deepseek llm: Scaling open-source language models with longtermism.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.02954</em>, 2024.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Stella Biderman, Hailey Schoelkopf, Quentin&nbsp;Gregory Anthony, Herbie Bradley, Kyle O’Brien, Eric Hallahan, Mohammad&nbsp;Aflah Khan, Shivanshu Purohit, USVSN&nbsp;Sai Prashanth, Edward Raff, et&nbsp;al.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp; 2397–2430. PMLR, 2023.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bishop (2006)</span>
<span class="ltx_bibblock">
Christopher Bishop.

</span>
<span class="ltx_bibblock">Pattern recognition and machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Springer google schola</em>, 2:5–43, 2006.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared&nbsp;D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et&nbsp;al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 33:1877–1901, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caballero et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Ethan Caballero, Kshitij Gupta, Irina Rish, and David Krueger.

</span>
<span class="ltx_bibblock">Broken neural scaling laws.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.14891</em>, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024a)</span>
<span class="ltx_bibblock">
Daoyuan Chen, Yilun Huang, Zhijian Ma, Hesen Chen, Xuchen Pan, Ce&nbsp;Ge, Dawei Gao, Yuexiang Xie, Zhaoyang Liu, Jinyang Gao, Yaliang Li, Bolin Ding, and Jingren Zhou.

</span>
<span class="ltx_bibblock">Data-juicer: A one-stop data processing system for large language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">International Conference on Management of Data</em>, 2024a.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024b)</span>
<span class="ltx_bibblock">
Mayee Chen, Nicholas Roberts, Kush Bhatia, Jue Wang, Ce&nbsp;Zhang, Frederic Sala, and Christopher Ré.

</span>
<span class="ltx_bibblock">Skill-it! a data-driven skills framework for understanding and training language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024b.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Doddapaneni et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Sumanth Doddapaneni, Gowtham Ramesh, Mitesh&nbsp;M Khapra, Anoop Kunchukuttan, and Pratyush Kumar.

</span>
<span class="ltx_bibblock">A primer on pretrained multilingual language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.00676</em>, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Domingos (2000)</span>
<span class="ltx_bibblock">
Pedro Domingos.

</span>
<span class="ltx_bibblock">A unified bias-variance decomposition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of 17th international conference on machine learning</em>, pp.&nbsp; 231–238. Morgan Kaufmann Stanford, 2000.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Drucker (1997)</span>
<span class="ltx_bibblock">
Harris Drucker.

</span>
<span class="ltx_bibblock">Improving regressors using boosting techniques.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Icml</em>, volume&nbsp;97, pp.&nbsp; e115. Citeseer, 1997.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Nan Du, Yanping Huang, Andrew&nbsp;M Dai, Simon Tong, Dmitry Lepikhin, Yuanzhong Xu, Maxim Krikun, Yanqi Zhou, Adams&nbsp;Wei Yu, Orhan Firat, et&nbsp;al.

</span>
<span class="ltx_bibblock">Glam: Efficient scaling of language models with mixture-of-experts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp; 5547–5569. PMLR, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Simin Fan, Matteo Pagliardini, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Doge: Domain reweighting with generalization estimation, 2024.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Elias Frantar, Carlos Riquelme, Neil Houlsby, Dan Alistarh, and Utku Evci.

</span>
<span class="ltx_bibblock">Scaling laws for sparsely-connected foundation models.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.08520</em>, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">French (1999)</span>
<span class="ltx_bibblock">
Robert&nbsp;M French.

</span>
<span class="ltx_bibblock">Catastrophic forgetting in connectionist networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Trends in cognitive sciences</em>, 3(4):128–135, 1999.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Friedl (2023)</span>
<span class="ltx_bibblock">
Paul Friedl.

</span>
<span class="ltx_bibblock">Dis/similarities in the design and development of legal and algorithmic normative systems: the case of perspective api.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Law, Innovation and Technology</em>, 15(1):25–59, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Leo Gao, Stella Biderman, Sid Black, Laurence Golding, Travis Hoppe, Charles Foster, Jason Phang, Horace He, Anish Thite, Noa Nabeshima, et&nbsp;al.

</span>
<span class="ltx_bibblock">The pile: An 800gb dataset of diverse text for language modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2101.00027</em>, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Yuxian Gu, Li&nbsp;Dong, Yaru Hao, Qingxiu Dong, Minlie Huang, and Furu Wei.

</span>
<span class="ltx_bibblock">Towards optimal learning of language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.17759</em>, 2024.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Shangmin Guo, Yi&nbsp;Ren, Stefano&nbsp;V Albrecht, and Kenny Smith.

</span>
<span class="ltx_bibblock">Sample relationship from learning dynamics matters for generalisation.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2401.08808</em>, 2024.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gururangan et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Suchin Gururangan, Ana Marasović, Swabha Swayamdipta, Kyle Lo, Iz&nbsp;Beltagy, Doug Downey, and Noah&nbsp;A Smith.

</span>
<span class="ltx_bibblock">Don’t stop pretraining: Adapt language models to domains and tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2004.10964</em>, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gururangan et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Suchin Gururangan, Margaret Li, Mike Lewis, Weijia Shi, Tim Althoff, Noah&nbsp;A Smith, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Scaling expert language models with unsupervised domain discovery.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.14177</em>, 2023.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harville (1985)</span>
<span class="ltx_bibblock">
David&nbsp;A Harville.

</span>
<span class="ltx_bibblock">Decomposition of prediction error.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Journal of the American Statistical Association</em>, 80(389):132–138, 1985.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hashimoto (2021)</span>
<span class="ltx_bibblock">
Tatsunori Hashimoto.

</span>
<span class="ltx_bibblock">Model performance scaling with multiple data sources.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp; 4107–4116. PMLR, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haussler (1988)</span>
<span class="ltx_bibblock">
David Haussler.

</span>
<span class="ltx_bibblock">Quantifying inductive bias: Ai learning algorithms and valiant’s learning framework.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence</em>, 36(2):177–221, 1988.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Henighan et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Tom Henighan, Jared Kaplan, Mor Katz, Mark Chen, Christopher Hesse, Jacob Jackson, Heewoo Jun, Tom&nbsp;B Brown, Prafulla Dhariwal, Scott Gray, et&nbsp;al.

</span>
<span class="ltx_bibblock">Scaling laws for autoregressive generative modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.14701</em>, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hernandez et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Danny Hernandez, Jared Kaplan, Tom Henighan, and Sam McCandlish.

</span>
<span class="ltx_bibblock">Scaling laws for transfer.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.01293</em>, 2021.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hestness et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
Joel Hestness, Sharan Narang, Newsha Ardalani, Gregory Diamos, Heewoo Jun, Hassan Kianinejad, Md&nbsp;Mostofa&nbsp;Ali Patwary, Yang Yang, and Yanqi Zhou.

</span>
<span class="ltx_bibblock">Deep learning scaling is predictable, empirically.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1712.00409</em>, 2017.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Jordan Hoffmann, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza Rutherford, Diego de&nbsp;Las Casas, Lisa&nbsp;Anne Hendricks, Johannes Welbl, Aidan Clark, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training compute-optimal large language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.15556</em>, 2022.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hornik et&nbsp;al. (1989)</span>
<span class="ltx_bibblock">
Kurt Hornik, Maxwell Stinchcombe, and Halbert White.

</span>
<span class="ltx_bibblock">Multilayer feedforward networks are universal approximators.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Neural networks</em>, 2(5):359–366, 1989.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hutter (2021)</span>
<span class="ltx_bibblock">
Marcus Hutter.

</span>
<span class="ltx_bibblock">Learning curve theory.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.04074</em>, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Albert&nbsp;Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra&nbsp;Singh Chaplot, Diego de&nbsp;las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, et&nbsp;al.

</span>
<span class="ltx_bibblock">Mistral 7b.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.06825</em>, 2023.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaplan et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Jared Kaplan, Sam McCandlish, Tom Henighan, Tom&nbsp;B Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei.

</span>
<span class="ltx_bibblock">Scaling laws for neural language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2001.08361</em>, 2020.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel Veness, Guillaume Desjardins, Andrei&nbsp;A Rusu, Kieran Milan, John Quan, Tiago Ramalho, Agnieszka Grabska-Barwinska, et&nbsp;al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the national academy of sciences</em>, 114(13):3521–3526, 2017.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Komatsuzaki et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Aran Komatsuzaki, Joan Puigcerver, James Lee-Thorp, Carlos&nbsp;Riquelme Ruiz, Basil Mustafa, Joshua Ainslie, Yi&nbsp;Tay, Mostafa Dehghani, and Neil Houlsby.

</span>
<span class="ltx_bibblock">Sparse upcycling: Training mixture-of-experts from dense checkpoints.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2212.05055</em>, 2022.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Raymond Li, Loubna&nbsp;Ben Allal, Yangtian Zi, Niklas Muennighoff, Denis Kocetkov, Chenghao Mou, Marc Marone, Christopher Akiki, Jia Li, Jenny Chim, et&nbsp;al.

</span>
<span class="ltx_bibblock">Starcoder: may the source be with you!

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.06161</em>, 2023.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Xiaoran Liu, Hang Yan, Chenxin An, Xipeng Qiu, and Dahua Lin.

</span>
<span class="ltx_bibblock">Scaling laws of rope-based extrapolation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">The Twelfth International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Longpre et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Shayne Longpre, Gregory Yauney, Emily Reif, Katherine Lee, Adam Roberts, Barret Zoph, Denny Zhou, Jason Wei, Kevin Robinson, David Mimno, et&nbsp;al.

</span>
<span class="ltx_bibblock">A pretrainer’s guide to training data: Measuring the effects of data age, domain coverage, quality, &amp; toxicity.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.13169</em>, 2023.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Yun Luo, Zhen Yang, Fandong Meng, Yafu Li, Jie Zhou, and Yue Zhang.

</span>
<span class="ltx_bibblock">An empirical study of catastrophic forgetting in large language models during continual fine-tuning.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.08747</em>, 2023.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mead (1990)</span>
<span class="ltx_bibblock">
Roger Mead.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">The design of experiments: statistical principles for practical applications</em>.

</span>
<span class="ltx_bibblock">Cambridge university press, 1990.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Michaud et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Eric Michaud, Ziming Liu, Uzay Girit, and Max Tegmark.

</span>
<span class="ltx_bibblock">The quantization model of neural scaling.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mindermann et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Sören Mindermann, Jan&nbsp;M Brauner, Muhammed&nbsp;T Razzak, Mrinank Sharma, Andreas Kirsch, Winnie Xu, Benedikt Höltgen, Aidan&nbsp;N Gomez, Adrien Morisot, Sebastian Farquhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Prioritized training on points that are learnable, worth learning, and not yet learnt.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.&nbsp; 15630–15649. PMLR, 2022.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Muennighoff et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Niklas Muennighoff, Alexander Rush, Boaz Barak, Teven Le&nbsp;Scao, Nouamane Tazi, Aleksandra Piktus, Sampo Pyysalo, Thomas Wolf, and Colin&nbsp;A Raffel.

</span>
<span class="ltx_bibblock">Scaling data-constrained language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Penedo et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Guilherme Penedo, Quentin Malartic, Daniel Hesslow, Ruxandra Cojocaru, Alessandro Cappelli, Hamza Alobeidli, Baptiste Pannier, Ebtesam Almazrouei, and Julien Launay.

</span>
<span class="ltx_bibblock">The refinedweb dataset for falcon llm: outperforming curated corpora with web data, and web data only.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.01116</em>, 2023.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2018)</span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Improving language understanding with unsupervised learning.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rae et&nbsp;al. (2021)</span>
<span class="ltx_bibblock">
Jack&nbsp;W Rae, Sebastian Borgeaud, Trevor Cai, Katie Millican, Jordan Hoffmann, Francis Song, John Aslanides, Sarah Henderson, Roman Ring, Susannah Young, et&nbsp;al.

</span>
<span class="ltx_bibblock">Scaling language models: Methods, analysis &amp; insights from training gopher.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2112.11446</em>, 2021.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et&nbsp;al. (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter&nbsp;J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">The Journal of Machine Learning Research</em>, 21(1):5485–5551, 2020.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Yunfan Shao, Linyang Li, Zhaoye Fei, Hang Yan, Dahua Lin, and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Balanced data sampling for language model training with clustering.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2402.14526</em>, 2024.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Hui Su, Zhi Tian, Xiaoyu Shen, and Xunliang Cai.

</span>
<span class="ltx_bibblock">Unraveling the mystery of scaling laws: Part i.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.06563</em>, 2024.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taylor et&nbsp;al. (2022)</span>
<span class="ltx_bibblock">
Ross Taylor, Marcin Kardas, Guillem Cucurull, Thomas Scialom, Anthony Hartshorn, Elvis Saravia, Andrew Poulton, Viktor Kerkez, and Robert Stojnic.

</span>
<span class="ltx_bibblock">Galactica: A large language model for science.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.09085</em>, 2022.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.13971</em>, 2023a.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em>, 2023b.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Valiant (1984)</span>
<span class="ltx_bibblock">
Leslie&nbsp;G Valiant.

</span>
<span class="ltx_bibblock">A theory of the learnable.

</span>
<span class="ltx_bibblock"><em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Communications of the ACM</em>, 27(11):1134–1142, 1984.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vapnik &amp; Chervonenkis (1971)</span>
<span class="ltx_bibblock">
VN&nbsp;Vapnik and A&nbsp;Ya Chervonenkis.

</span>
<span class="ltx_bibblock">On the uniform convergence of relative frequencies of events to their probabilities.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Theory of Probability and its Applications</em>, 16(2):264, 1971.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan&nbsp;N Gomez, Ł&nbsp;ukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume&nbsp;30. Curran Associates, Inc., 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Villalobos (2023)</span>
<span class="ltx_bibblock">
Pablo Villalobos.

</span>
<span class="ltx_bibblock">Scaling laws literature review, 2023.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://epochai.org/blog/scaling-laws-literature-review" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://epochai.org/blog/scaling-laws-literature-review</a>.

</span>
<span class="ltx_bibblock">Accessed: 2024-02-27.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wenzek et&nbsp;al. (2019)</span>
<span class="ltx_bibblock">
Guillaume Wenzek, Marie-Anne Lachaux, Alexis Conneau, Vishrav Chaudhary, Francisco Guzmán, Armand Joulin, and Edouard Grave.

</span>
<span class="ltx_bibblock">Ccnet: Extracting high quality monolingual datasets from web crawl data.

</span>
<span class="ltx_bibblock"><em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.00359</em>, 2019.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et&nbsp;al. (2024a)</span>
<span class="ltx_bibblock">
Sang&nbsp;Michael Xie, Hieu Pham, Xuanyi Dong, Nan Du, Hanxiao Liu, Yifeng Lu, Percy&nbsp;S Liang, Quoc&nbsp;V Le, Tengyu Ma, and Adams&nbsp;Wei Yu.

</span>
<span class="ltx_bibblock">Doremi: Optimizing data mixtures speeds up language model pretraining.

</span>
<span class="ltx_bibblock"><em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024a.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et&nbsp;al. (2024b)</span>
<span class="ltx_bibblock">
Sang&nbsp;Michael Xie, Shibani Santurkar, Tengyu Ma, and Percy&nbsp;S Liang.

</span>
<span class="ltx_bibblock">Data selection for language models via importance resampling.

</span>
<span class="ltx_bibblock"><em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024b.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Wenhan Xiong, Jingyu Liu, Igor Molybog, Hejia Zhang, Prajjwal Bhargava, Rui Hou, Louis Martin, Rashi Rungta, Karthik&nbsp;Abinav Sankararaman, Barlas Oguz, et&nbsp;al.

</span>
<span class="ltx_bibblock">Effective long-context scaling of foundation models.

</span>
<span class="ltx_bibblock"><em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2309.16039</em>, 2023.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhan et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Jun Zhan, Junqi Dai, Jiasheng Ye, Yunhua Zhou, Dong Zhang, Zhigeng Liu, Xin Zhang, Ruibin Yuan, Ge&nbsp;Zhang, Linyang Li, Hang Yan, Jie Fu, Tao Gui, Tianxiang Sun, Yugang Jiang, and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Anygpt: Unified multimodal llm with discrete sequence modeling, 2024.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2024)</span>
<span class="ltx_bibblock">
Chunting Zhou, Pengfei Liu, Puxin Xu, Srinivasan Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, Lili Yu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Lima: Less is more for alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2023)</span>
<span class="ltx_bibblock">
Kun Zhou, Yutao Zhu, Zhipeng Chen, Wentong Chen, Wayne&nbsp;Xin Zhao, Xu&nbsp;Chen, Yankai Lin, Ji-Rong Wen, and Jiawei Han.

</span>
<span class="ltx_bibblock">Don’t make your llm an evaluation benchmark cheater.

</span>
<span class="ltx_bibblock"><em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2311.01964</em>, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>The relative qualities of data mixtures relate to model sizes and training steps.</h2>

<figure id="A1.F9" class="ltx_figure ltx_align_floatright"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/figs/rankings.png" id="A1.F9.g1" class="ltx_graphics ltx_img_landscape" width="598" height="465" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">그림 9:</span>RedPajama에서 훈련된 20개의 샘플 혼합물의 상대적 성능의 순위 및 파일에서 유효성을 검사합니다. <span class="ltx_text ltx_font_bold" id="A1.F9.3.1">(A)</span> 30k 단계에 대해 모두 훈련된 서로 다른 크기의 모델의 순위입니다. <span class="ltx_text ltx_font_bold" id="A1.F9.4.2">(B)</span> 다른 단계에 대해 훈련된 70M 모델에 대한 순위입니다.</figcaption>
</figure>
<div id="A1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A1.p1.1">작은 모델과 소수의 단계에서 최적의 데이터 혼합물을 찾은 다음 찾은 혼합물 비율을 대규모 훈련으로 옮길 수 있는지 궁금해할 수 있다. 이 질문에 답하기 위해 서로 다른 크기의 모델과 그림 1의 서로 다른 단계 수로 훈련된 모델의 상대적 성능을 비교한다. <a class="ltx_ref" href="#A1.F9" title="Figure 9 ‣ Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A1.p2.1">결과는 규모와 훈련 단계에 걸쳐 비교적 일관된 추세에도 불구하고 상대적 성과가 변동한다는 것을 보여준다. 이것은 혼합물이 작은 규모에서 더 우수하지만 항상 큰 규모에서 더 잘 수행되는 것은 아님을 나타낸다. 그림 20개의 혼합물 중 부분 순서의 가장 긴 공통 서열이다. <a class="ltx_ref" href="#A1.F9" title="Figure 9 ‣ Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">9</span></a>(A) 및 도. <a class="ltx_ref" href="#A1.F9" title="Figure 9 ‣ Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">9</span></a>(B)는 각각 10 및 11의 길이에만 도달한다.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Implementation Details</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Model Training</h3>

<div id="A2.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A2.SS1.p1.1">이 연구를 통해, 우리는 피티아 슈트 <cite class="ltx_cite ltx_citemacro_citep">(Biderman et al., <a class="ltx_ref" href="#bib.bib8" title="">2023</a>)</cite>를 모델 아키텍처로 사용하며, 구체적인 구성은 Tab에 있다. <a class="ltx_ref" href="#A2.T2" title="Table 2 ‣ B.1 Model Training ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">2</span></a>. 최대 시퀀스 길이는 처음부터 사전 훈련의 경우 4096이고 연속 사전 훈련의 경우 2048이며, 여기서 후자는 원래 사전 훈련 모델의 설정과 정렬된다. 모든 실험에서 우리는 1M 토큰의 배치 크기와 최대 학습률 1e-4로 모델을 훈련한다. 우리는 코사인 감쇠 스케줄을 사용하여 2000단계의 학습률을 예열하고 마지막 훈련 단계에서 최대 0.1로 감쇠한다. 지속적인 사전 훈련을 위해 피티아 70M 모델의 20k 단계 체크포인트로 모델을 초기화하고 학습률 워밍업을 적용하지 않는다.</p>
</div>
<figure id="A2.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">표 2:</span>본 논문의 실험을 위한 모델 아키텍처.</figcaption>
<div id="A2.T2.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:113.4pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.4pt,-2.2pt) scale(1.04040816268251,1.04040816268251) ;">
<table id="A2.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T2.1.1.1.1" class="ltx_tr">
<th id="A2.T2.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="A2.T2.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.2.1" class="ltx_text ltx_font_bold">70M</span></th>
<th id="A2.T2.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.3.1" class="ltx_text ltx_font_bold">160M</span></th>
<th id="A2.T2.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.4.1" class="ltx_text ltx_font_bold">305M</span></th>
<th id="A2.T2.1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.5.1" class="ltx_text ltx_font_bold">410M</span></th>
<th id="A2.T2.1.1.1.1.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T2.1.1.1.1.6.1" class="ltx_text ltx_font_bold">1B</span></th>
</tr>
<tr id="A2.T2.1.1.2.2" class="ltx_tr">
<th id="A2.T2.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Vocabulary Size</th>
<th id="A2.T2.1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
<th id="A2.T2.1.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
<th id="A2.T2.1.1.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
<th id="A2.T2.1.1.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
<th id="A2.T2.1.1.2.2.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t">50304</th>
</tr>
<tr id="A2.T2.1.1.3.3" class="ltx_tr">
<th id="A2.T2.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row">Non-embedding Params</th>
<th id="A2.T2.1.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_column">18,915,328</th>
<th id="A2.T2.1.1.3.3.3" class="ltx_td ltx_align_left ltx_th ltx_th_column">85,056,000</th>
<th id="A2.T2.1.1.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_column">201,541,632</th>
<th id="A2.T2.1.1.3.3.5" class="ltx_td ltx_align_left ltx_th ltx_th_column">302,311,424</th>
<th id="A2.T2.1.1.3.3.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column">805,736,448</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T2.1.1.4.1" class="ltx_tr">
<th id="A2.T2.1.1.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Layers</th>
<td id="A2.T2.1.1.4.1.2" class="ltx_td ltx_align_left">6</td>
<td id="A2.T2.1.1.4.1.3" class="ltx_td ltx_align_left">12</td>
<td id="A2.T2.1.1.4.1.4" class="ltx_td ltx_align_left">16</td>
<td id="A2.T2.1.1.4.1.5" class="ltx_td ltx_align_left">24</td>
<td id="A2.T2.1.1.4.1.6" class="ltx_td ltx_nopad_r ltx_align_left">16</td>
</tr>
<tr id="A2.T2.1.1.5.2" class="ltx_tr">
<th id="A2.T2.1.1.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Model Dimension</th>
<td id="A2.T2.1.1.5.2.2" class="ltx_td ltx_align_left">512</td>
<td id="A2.T2.1.1.5.2.3" class="ltx_td ltx_align_left">768</td>
<td id="A2.T2.1.1.5.2.4" class="ltx_td ltx_align_left">1024</td>
<td id="A2.T2.1.1.5.2.5" class="ltx_td ltx_align_left">1024</td>
<td id="A2.T2.1.1.5.2.6" class="ltx_td ltx_nopad_r ltx_align_left">2048</td>
</tr>
<tr id="A2.T2.1.1.6.3" class="ltx_tr">
<th id="A2.T2.1.1.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Heads</th>
<td id="A2.T2.1.1.6.3.2" class="ltx_td ltx_align_left ltx_border_bb">8</td>
<td id="A2.T2.1.1.6.3.3" class="ltx_td ltx_align_left ltx_border_bb">12</td>
<td id="A2.T2.1.1.6.3.4" class="ltx_td ltx_align_left ltx_border_bb">16</td>
<td id="A2.T2.1.1.6.3.5" class="ltx_td ltx_align_left ltx_border_bb">16</td>
<td id="A2.T2.1.1.6.3.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb">8</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A2.SS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A2.SS1.p2.1">데이터 세트의 경우 주로 파일 및 RedPajama를 사용하여 실험합니다. 파일의 경우 원시 데이터에서 중복을 발견하므로 중복 제거는 학습 전에 수행됩니다. 파일에는 5개의 조립질 도메인이 포함되어 있으며, 이는 22개의 세립질 영역으로 추가로 분해된다. 우리의 실험은 Sec. <a class="ltx_ref" href="#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.1</span></a> is on Github and Pile-CC domains while the experiment in Sec. <a class="ltx_ref" href="#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.2</span></a> is on Github, Pile-CC, and the Books. 이 모든 것들은 세밀한 영역들이다. Sec의 5개 도메인에 대한 실험을 위해. <a class="ltx_ref" href="#S3.SS3" title="3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.3</span></a> 우리는 학술, 인터넷, 산문, 대화, misc의 5개 조분류 영역을 채택한다. 여기서 misc는 Github와 기호 콘텐츠인 DeepMind Mathematics Dataset을 포함한다. 토큰이 충분한 5개의 세립도메인을 찾기 어렵기 때문에 우리는 세립도메인을 사용한다. RedPajama의 경우 <cite class="ltx_cite ltx_citemacro_citet">Chen et al. (<a class="ltx_ref" href="#bib.bib12" title="">2024a</a>)</cite>에서 제작 및 공유한 버전을 다운로드한다.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Fitting Mixture Laws</h3>

<div id="A2.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A2.SS2.p1.1">혼합물 법칙을 맞추려면 먼저 몇 가지 혼합물에 대한 실험을 하고 손실을 얻어야 한다. 피팅을 위해 선택된 샘플 혼합물은 예측 정확도에 크게 영향을 미칠 수 있다. 모든 표본 혼합물이 작은 영역을 중심으로 비율을 갖는 극단적인 경우를 생각해 보면, 전체 비율 공간을 확실하게 예측하는 법칙을 맞추는 것은 거의 불가능하다.</p>
</div>
<div id="A2.SS2.p2" class="ltx_para">
<p class="ltx_p" id="A2.SS2.p2.1">본 논문에서는 이러한 손실과 관련하여 혼합비율을 직관적으로 균등하게 배분하고자 한다. 특히, 손실들이 이들 혼합물들 사이에 고르게 분포되도록 각 도메인의 비율을 이중으로 감소시킴으로써 후보 혼합물들을 열거한다. 그런 다음, 사용 가능한 계산 예산에 따라 실험을 실행하기 위해 후보에서 특정 수의 혼합물을 샘플링한다. 샘플링 동안, 우리는 임의의 훈련 도메인에서 0 도메인 비율을 갖는 후보 혼합물이 후보의 대부분을 차지한다는 것을 발견한다. 이러한 후보가 모든 샘플을 구성하는 것을 피하기 위해 특별히 다운 샘플링합니다. 구체적인 알고리즘은 Alg에 있다. <a class="ltx_ref" href="#alg2" title="Algorithm 2 ‣ B.2 Fitting Mixture Laws ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">2</span></a>. 또한, AdaBoost Regressor <cite class="ltx_cite ltx_citemacro_citep">(Drucker, <a class="ltx_ref" href="#bib.bib16" title="">1997</a>)</cite>를 사용하여 혼합물 법칙을 피팅하여 예측을 안정화하고 정확도를 향상시켰다. 우리는 향후 연구가 이론적 지원을 통해 후보 혼합물 선택의 보다 신중한 설계에 뛰어들도록 권장한다.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span></span> 혼합 법칙을 맞추기 위한 샘플링 혼합 비율입니다.</figcaption>
<div id="alg2.3" class="ltx_listing ltx_align_center ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span><span id="alg2.l1.1" class="ltx_text ltx_font_bold">Input:</span> Maximum proportions of <math id="alg2.l1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">M</annotation></semantics></math> domains <math id="alg2.l1.m2.7" class="ltx_Math" alttext="\bm{r}_{max}=[r_{max,1},\dots,r_{max,M}]" display="inline"><semantics id="alg2.l1.m2.7a"><mrow id="alg2.l1.m2.7.7" xref="alg2.l1.m2.7.7.cmml"><msub id="alg2.l1.m2.7.7.4" xref="alg2.l1.m2.7.7.4.cmml"><mi id="alg2.l1.m2.7.7.4.2" xref="alg2.l1.m2.7.7.4.2.cmml">𝒓</mi><mrow id="alg2.l1.m2.7.7.4.3" xref="alg2.l1.m2.7.7.4.3.cmml"><mi id="alg2.l1.m2.7.7.4.3.2" xref="alg2.l1.m2.7.7.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.7.7.4.3.1" xref="alg2.l1.m2.7.7.4.3.1.cmml">​</mo><mi id="alg2.l1.m2.7.7.4.3.3" xref="alg2.l1.m2.7.7.4.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.7.7.4.3.1a" xref="alg2.l1.m2.7.7.4.3.1.cmml">​</mo><mi id="alg2.l1.m2.7.7.4.3.4" xref="alg2.l1.m2.7.7.4.3.4.cmml">x</mi></mrow></msub><mo id="alg2.l1.m2.7.7.3" xref="alg2.l1.m2.7.7.3.cmml">=</mo><mrow id="alg2.l1.m2.7.7.2.2" xref="alg2.l1.m2.7.7.2.3.cmml"><mo stretchy="false" id="alg2.l1.m2.7.7.2.2.3" xref="alg2.l1.m2.7.7.2.3.cmml">[</mo><msub id="alg2.l1.m2.6.6.1.1.1" xref="alg2.l1.m2.6.6.1.1.1.cmml"><mi id="alg2.l1.m2.6.6.1.1.1.2" xref="alg2.l1.m2.6.6.1.1.1.2.cmml">r</mi><mrow id="alg2.l1.m2.2.2.2.2" xref="alg2.l1.m2.2.2.2.3.cmml"><mrow id="alg2.l1.m2.2.2.2.2.1" xref="alg2.l1.m2.2.2.2.2.1.cmml"><mi id="alg2.l1.m2.2.2.2.2.1.2" xref="alg2.l1.m2.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.2.2.2.2.1.1" xref="alg2.l1.m2.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m2.2.2.2.2.1.3" xref="alg2.l1.m2.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.2.2.2.2.1.1a" xref="alg2.l1.m2.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m2.2.2.2.2.1.4" xref="alg2.l1.m2.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m2.2.2.2.2.2" xref="alg2.l1.m2.2.2.2.3.cmml">,</mo><mn id="alg2.l1.m2.1.1.1.1" xref="alg2.l1.m2.1.1.1.1.cmml">1</mn></mrow></msub><mo id="alg2.l1.m2.7.7.2.2.4" xref="alg2.l1.m2.7.7.2.3.cmml">,</mo><mi mathvariant="normal" id="alg2.l1.m2.5.5" xref="alg2.l1.m2.5.5.cmml">…</mi><mo id="alg2.l1.m2.7.7.2.2.5" xref="alg2.l1.m2.7.7.2.3.cmml">,</mo><msub id="alg2.l1.m2.7.7.2.2.2" xref="alg2.l1.m2.7.7.2.2.2.cmml"><mi id="alg2.l1.m2.7.7.2.2.2.2" xref="alg2.l1.m2.7.7.2.2.2.2.cmml">r</mi><mrow id="alg2.l1.m2.4.4.2.2" xref="alg2.l1.m2.4.4.2.3.cmml"><mrow id="alg2.l1.m2.4.4.2.2.1" xref="alg2.l1.m2.4.4.2.2.1.cmml"><mi id="alg2.l1.m2.4.4.2.2.1.2" xref="alg2.l1.m2.4.4.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.4.4.2.2.1.1" xref="alg2.l1.m2.4.4.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m2.4.4.2.2.1.3" xref="alg2.l1.m2.4.4.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.4.4.2.2.1.1a" xref="alg2.l1.m2.4.4.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m2.4.4.2.2.1.4" xref="alg2.l1.m2.4.4.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m2.4.4.2.2.2" xref="alg2.l1.m2.4.4.2.3.cmml">,</mo><mi id="alg2.l1.m2.3.3.1.1" xref="alg2.l1.m2.3.3.1.1.cmml">M</mi></mrow></msub><mo stretchy="false" id="alg2.l1.m2.7.7.2.2.6" xref="alg2.l1.m2.7.7.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.7b"><apply id="alg2.l1.m2.7.7.cmml" xref="alg2.l1.m2.7.7"><eq id="alg2.l1.m2.7.7.3.cmml" xref="alg2.l1.m2.7.7.3"></eq><apply id="alg2.l1.m2.7.7.4.cmml" xref="alg2.l1.m2.7.7.4"><csymbol cd="ambiguous" id="alg2.l1.m2.7.7.4.1.cmml" xref="alg2.l1.m2.7.7.4">subscript</csymbol><ci id="alg2.l1.m2.7.7.4.2.cmml" xref="alg2.l1.m2.7.7.4.2">𝒓</ci><apply id="alg2.l1.m2.7.7.4.3.cmml" xref="alg2.l1.m2.7.7.4.3"><times id="alg2.l1.m2.7.7.4.3.1.cmml" xref="alg2.l1.m2.7.7.4.3.1"></times><ci id="alg2.l1.m2.7.7.4.3.2.cmml" xref="alg2.l1.m2.7.7.4.3.2">𝑚</ci><ci id="alg2.l1.m2.7.7.4.3.3.cmml" xref="alg2.l1.m2.7.7.4.3.3">𝑎</ci><ci id="alg2.l1.m2.7.7.4.3.4.cmml" xref="alg2.l1.m2.7.7.4.3.4">𝑥</ci></apply></apply><list id="alg2.l1.m2.7.7.2.3.cmml" xref="alg2.l1.m2.7.7.2.2"><apply id="alg2.l1.m2.6.6.1.1.1.cmml" xref="alg2.l1.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.6.6.1.1.1.1.cmml" xref="alg2.l1.m2.6.6.1.1.1">subscript</csymbol><ci id="alg2.l1.m2.6.6.1.1.1.2.cmml" xref="alg2.l1.m2.6.6.1.1.1.2">𝑟</ci><list id="alg2.l1.m2.2.2.2.3.cmml" xref="alg2.l1.m2.2.2.2.2"><apply id="alg2.l1.m2.2.2.2.2.1.cmml" xref="alg2.l1.m2.2.2.2.2.1"><times id="alg2.l1.m2.2.2.2.2.1.1.cmml" xref="alg2.l1.m2.2.2.2.2.1.1"></times><ci id="alg2.l1.m2.2.2.2.2.1.2.cmml" xref="alg2.l1.m2.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l1.m2.2.2.2.2.1.3.cmml" xref="alg2.l1.m2.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l1.m2.2.2.2.2.1.4.cmml" xref="alg2.l1.m2.2.2.2.2.1.4">𝑥</ci></apply><cn type="integer" id="alg2.l1.m2.1.1.1.1.cmml" xref="alg2.l1.m2.1.1.1.1">1</cn></list></apply><ci id="alg2.l1.m2.5.5.cmml" xref="alg2.l1.m2.5.5">…</ci><apply id="alg2.l1.m2.7.7.2.2.2.cmml" xref="alg2.l1.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m2.7.7.2.2.2.1.cmml" xref="alg2.l1.m2.7.7.2.2.2">subscript</csymbol><ci id="alg2.l1.m2.7.7.2.2.2.2.cmml" xref="alg2.l1.m2.7.7.2.2.2.2">𝑟</ci><list id="alg2.l1.m2.4.4.2.3.cmml" xref="alg2.l1.m2.4.4.2.2"><apply id="alg2.l1.m2.4.4.2.2.1.cmml" xref="alg2.l1.m2.4.4.2.2.1"><times id="alg2.l1.m2.4.4.2.2.1.1.cmml" xref="alg2.l1.m2.4.4.2.2.1.1"></times><ci id="alg2.l1.m2.4.4.2.2.1.2.cmml" xref="alg2.l1.m2.4.4.2.2.1.2">𝑚</ci><ci id="alg2.l1.m2.4.4.2.2.1.3.cmml" xref="alg2.l1.m2.4.4.2.2.1.3">𝑎</ci><ci id="alg2.l1.m2.4.4.2.2.1.4.cmml" xref="alg2.l1.m2.4.4.2.2.1.4">𝑥</ci></apply><ci id="alg2.l1.m2.3.3.1.1.cmml" xref="alg2.l1.m2.3.3.1.1">𝑀</ci></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.7c">\bm{r}_{max}=[r_{max,1},\dots,r_{max,M}]</annotation></semantics></math>, where <math id="alg2.l1.m3.2" class="ltx_Math" alttext="r_{max,i}=\frac{D_{i}}{D_{target}}" display="inline"><semantics id="alg2.l1.m3.2a"><mrow id="alg2.l1.m3.2.3" xref="alg2.l1.m3.2.3.cmml"><msub id="alg2.l1.m3.2.3.2" xref="alg2.l1.m3.2.3.2.cmml"><mi id="alg2.l1.m3.2.3.2.2" xref="alg2.l1.m3.2.3.2.2.cmml">r</mi><mrow id="alg2.l1.m3.2.2.2.2" xref="alg2.l1.m3.2.2.2.3.cmml"><mrow id="alg2.l1.m3.2.2.2.2.1" xref="alg2.l1.m3.2.2.2.2.1.cmml"><mi id="alg2.l1.m3.2.2.2.2.1.2" xref="alg2.l1.m3.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.2.2.2.1.1" xref="alg2.l1.m3.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m3.2.2.2.2.1.3" xref="alg2.l1.m3.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.2.2.2.1.1a" xref="alg2.l1.m3.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m3.2.2.2.2.1.4" xref="alg2.l1.m3.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m3.2.2.2.2.2" xref="alg2.l1.m3.2.2.2.3.cmml">,</mo><mi id="alg2.l1.m3.1.1.1.1" xref="alg2.l1.m3.1.1.1.1.cmml">i</mi></mrow></msub><mo id="alg2.l1.m3.2.3.1" xref="alg2.l1.m3.2.3.1.cmml">=</mo><mfrac id="alg2.l1.m3.2.3.3" xref="alg2.l1.m3.2.3.3.cmml"><msub id="alg2.l1.m3.2.3.3.2" xref="alg2.l1.m3.2.3.3.2.cmml"><mi id="alg2.l1.m3.2.3.3.2.2" xref="alg2.l1.m3.2.3.3.2.2.cmml">D</mi><mi id="alg2.l1.m3.2.3.3.2.3" xref="alg2.l1.m3.2.3.3.2.3.cmml">i</mi></msub><msub id="alg2.l1.m3.2.3.3.3" xref="alg2.l1.m3.2.3.3.3.cmml"><mi id="alg2.l1.m3.2.3.3.3.2" xref="alg2.l1.m3.2.3.3.3.2.cmml">D</mi><mrow id="alg2.l1.m3.2.3.3.3.3" xref="alg2.l1.m3.2.3.3.3.3.cmml"><mi id="alg2.l1.m3.2.3.3.3.3.2" xref="alg2.l1.m3.2.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.3" xref="alg2.l1.m3.2.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1a" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.4" xref="alg2.l1.m3.2.3.3.3.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1b" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.5" xref="alg2.l1.m3.2.3.3.3.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1c" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.6" xref="alg2.l1.m3.2.3.3.3.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m3.2.3.3.3.3.1d" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m3.2.3.3.3.3.7" xref="alg2.l1.m3.2.3.3.3.3.7.cmml">t</mi></mrow></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.2b"><apply id="alg2.l1.m3.2.3.cmml" xref="alg2.l1.m3.2.3"><eq id="alg2.l1.m3.2.3.1.cmml" xref="alg2.l1.m3.2.3.1"></eq><apply id="alg2.l1.m3.2.3.2.cmml" xref="alg2.l1.m3.2.3.2"><csymbol cd="ambiguous" id="alg2.l1.m3.2.3.2.1.cmml" xref="alg2.l1.m3.2.3.2">subscript</csymbol><ci id="alg2.l1.m3.2.3.2.2.cmml" xref="alg2.l1.m3.2.3.2.2">𝑟</ci><list id="alg2.l1.m3.2.2.2.3.cmml" xref="alg2.l1.m3.2.2.2.2"><apply id="alg2.l1.m3.2.2.2.2.1.cmml" xref="alg2.l1.m3.2.2.2.2.1"><times id="alg2.l1.m3.2.2.2.2.1.1.cmml" xref="alg2.l1.m3.2.2.2.2.1.1"></times><ci id="alg2.l1.m3.2.2.2.2.1.2.cmml" xref="alg2.l1.m3.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l1.m3.2.2.2.2.1.3.cmml" xref="alg2.l1.m3.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l1.m3.2.2.2.2.1.4.cmml" xref="alg2.l1.m3.2.2.2.2.1.4">𝑥</ci></apply><ci id="alg2.l1.m3.1.1.1.1.cmml" xref="alg2.l1.m3.1.1.1.1">𝑖</ci></list></apply><apply id="alg2.l1.m3.2.3.3.cmml" xref="alg2.l1.m3.2.3.3"><divide id="alg2.l1.m3.2.3.3.1.cmml" xref="alg2.l1.m3.2.3.3"></divide><apply id="alg2.l1.m3.2.3.3.2.cmml" xref="alg2.l1.m3.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l1.m3.2.3.3.2.1.cmml" xref="alg2.l1.m3.2.3.3.2">subscript</csymbol><ci id="alg2.l1.m3.2.3.3.2.2.cmml" xref="alg2.l1.m3.2.3.3.2.2">𝐷</ci><ci id="alg2.l1.m3.2.3.3.2.3.cmml" xref="alg2.l1.m3.2.3.3.2.3">𝑖</ci></apply><apply id="alg2.l1.m3.2.3.3.3.cmml" xref="alg2.l1.m3.2.3.3.3"><csymbol cd="ambiguous" id="alg2.l1.m3.2.3.3.3.1.cmml" xref="alg2.l1.m3.2.3.3.3">subscript</csymbol><ci id="alg2.l1.m3.2.3.3.3.2.cmml" xref="alg2.l1.m3.2.3.3.3.2">𝐷</ci><apply id="alg2.l1.m3.2.3.3.3.3.cmml" xref="alg2.l1.m3.2.3.3.3.3"><times id="alg2.l1.m3.2.3.3.3.3.1.cmml" xref="alg2.l1.m3.2.3.3.3.3.1"></times><ci id="alg2.l1.m3.2.3.3.3.3.2.cmml" xref="alg2.l1.m3.2.3.3.3.3.2">𝑡</ci><ci id="alg2.l1.m3.2.3.3.3.3.3.cmml" xref="alg2.l1.m3.2.3.3.3.3.3">𝑎</ci><ci id="alg2.l1.m3.2.3.3.3.3.4.cmml" xref="alg2.l1.m3.2.3.3.3.3.4">𝑟</ci><ci id="alg2.l1.m3.2.3.3.3.3.5.cmml" xref="alg2.l1.m3.2.3.3.3.3.5">𝑔</ci><ci id="alg2.l1.m3.2.3.3.3.3.6.cmml" xref="alg2.l1.m3.2.3.3.3.3.6">𝑒</ci><ci id="alg2.l1.m3.2.3.3.3.3.7.cmml" xref="alg2.l1.m3.2.3.3.3.3.7">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.2c">r_{max,i}=\frac{D_{i}}{D_{target}}</annotation></semantics></math> with <math id="alg2.l1.m4.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg2.l1.m4.1a"><msub id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml"><mi id="alg2.l1.m4.1.1.2" xref="alg2.l1.m4.1.1.2.cmml">D</mi><mi id="alg2.l1.m4.1.1.3" xref="alg2.l1.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><apply id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1"><csymbol cd="ambiguous" id="alg2.l1.m4.1.1.1.cmml" xref="alg2.l1.m4.1.1">subscript</csymbol><ci id="alg2.l1.m4.1.1.2.cmml" xref="alg2.l1.m4.1.1.2">𝐷</ci><ci id="alg2.l1.m4.1.1.3.cmml" xref="alg2.l1.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">D_{i}</annotation></semantics></math> and <math id="alg2.l1.m5.1" class="ltx_Math" alttext="D_{target}" display="inline"><semantics id="alg2.l1.m5.1a"><msub id="alg2.l1.m5.1.1" xref="alg2.l1.m5.1.1.cmml"><mi id="alg2.l1.m5.1.1.2" xref="alg2.l1.m5.1.1.2.cmml">D</mi><mrow id="alg2.l1.m5.1.1.3" xref="alg2.l1.m5.1.1.3.cmml"><mi id="alg2.l1.m5.1.1.3.2" xref="alg2.l1.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.3" xref="alg2.l1.m5.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1a" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.4" xref="alg2.l1.m5.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1b" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.5" xref="alg2.l1.m5.1.1.3.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1c" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.6" xref="alg2.l1.m5.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m5.1.1.3.1d" xref="alg2.l1.m5.1.1.3.1.cmml">​</mo><mi id="alg2.l1.m5.1.1.3.7" xref="alg2.l1.m5.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><apply id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1"><csymbol cd="ambiguous" id="alg2.l1.m5.1.1.1.cmml" xref="alg2.l1.m5.1.1">subscript</csymbol><ci id="alg2.l1.m5.1.1.2.cmml" xref="alg2.l1.m5.1.1.2">𝐷</ci><apply id="alg2.l1.m5.1.1.3.cmml" xref="alg2.l1.m5.1.1.3"><times id="alg2.l1.m5.1.1.3.1.cmml" xref="alg2.l1.m5.1.1.3.1"></times><ci id="alg2.l1.m5.1.1.3.2.cmml" xref="alg2.l1.m5.1.1.3.2">𝑡</ci><ci id="alg2.l1.m5.1.1.3.3.cmml" xref="alg2.l1.m5.1.1.3.3">𝑎</ci><ci id="alg2.l1.m5.1.1.3.4.cmml" xref="alg2.l1.m5.1.1.3.4">𝑟</ci><ci id="alg2.l1.m5.1.1.3.5.cmml" xref="alg2.l1.m5.1.1.3.5">𝑔</ci><ci id="alg2.l1.m5.1.1.3.6.cmml" xref="alg2.l1.m5.1.1.3.6">𝑒</ci><ci id="alg2.l1.m5.1.1.3.7.cmml" xref="alg2.l1.m5.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">D_{target}</annotation></semantics></math> being numbers of available tokens in <math id="alg2.l1.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l1.m6.1a"><mi id="alg2.l1.m6.1.1" xref="alg2.l1.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m6.1b"><ci id="alg2.l1.m6.1.1.cmml" xref="alg2.l1.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m6.1c">i</annotation></semantics></math>-th domain and target number of training tokens, respectively, sorted in descending orders (i.e., <math id="alg2.l1.m7.6" class="ltx_Math" alttext="r_{max,1}\geq r_{max,2}\geq\cdots\geq r_{max,M}" display="inline"><semantics id="alg2.l1.m7.6a"><mrow id="alg2.l1.m7.6.7" xref="alg2.l1.m7.6.7.cmml"><msub id="alg2.l1.m7.6.7.2" xref="alg2.l1.m7.6.7.2.cmml"><mi id="alg2.l1.m7.6.7.2.2" xref="alg2.l1.m7.6.7.2.2.cmml">r</mi><mrow id="alg2.l1.m7.2.2.2.2" xref="alg2.l1.m7.2.2.2.3.cmml"><mrow id="alg2.l1.m7.2.2.2.2.1" xref="alg2.l1.m7.2.2.2.2.1.cmml"><mi id="alg2.l1.m7.2.2.2.2.1.2" xref="alg2.l1.m7.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.2.2.2.2.1.1" xref="alg2.l1.m7.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.2.2.2.2.1.3" xref="alg2.l1.m7.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.2.2.2.2.1.1a" xref="alg2.l1.m7.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.2.2.2.2.1.4" xref="alg2.l1.m7.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m7.2.2.2.2.2" xref="alg2.l1.m7.2.2.2.3.cmml">,</mo><mn id="alg2.l1.m7.1.1.1.1" xref="alg2.l1.m7.1.1.1.1.cmml">1</mn></mrow></msub><mo id="alg2.l1.m7.6.7.3" xref="alg2.l1.m7.6.7.3.cmml">≥</mo><msub id="alg2.l1.m7.6.7.4" xref="alg2.l1.m7.6.7.4.cmml"><mi id="alg2.l1.m7.6.7.4.2" xref="alg2.l1.m7.6.7.4.2.cmml">r</mi><mrow id="alg2.l1.m7.4.4.2.2" xref="alg2.l1.m7.4.4.2.3.cmml"><mrow id="alg2.l1.m7.4.4.2.2.1" xref="alg2.l1.m7.4.4.2.2.1.cmml"><mi id="alg2.l1.m7.4.4.2.2.1.2" xref="alg2.l1.m7.4.4.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.4.4.2.2.1.1" xref="alg2.l1.m7.4.4.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.4.4.2.2.1.3" xref="alg2.l1.m7.4.4.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.4.4.2.2.1.1a" xref="alg2.l1.m7.4.4.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.4.4.2.2.1.4" xref="alg2.l1.m7.4.4.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m7.4.4.2.2.2" xref="alg2.l1.m7.4.4.2.3.cmml">,</mo><mn id="alg2.l1.m7.3.3.1.1" xref="alg2.l1.m7.3.3.1.1.cmml">2</mn></mrow></msub><mo id="alg2.l1.m7.6.7.5" xref="alg2.l1.m7.6.7.5.cmml">≥</mo><mi mathvariant="normal" id="alg2.l1.m7.6.7.6" xref="alg2.l1.m7.6.7.6.cmml">⋯</mi><mo id="alg2.l1.m7.6.7.7" xref="alg2.l1.m7.6.7.7.cmml">≥</mo><msub id="alg2.l1.m7.6.7.8" xref="alg2.l1.m7.6.7.8.cmml"><mi id="alg2.l1.m7.6.7.8.2" xref="alg2.l1.m7.6.7.8.2.cmml">r</mi><mrow id="alg2.l1.m7.6.6.2.2" xref="alg2.l1.m7.6.6.2.3.cmml"><mrow id="alg2.l1.m7.6.6.2.2.1" xref="alg2.l1.m7.6.6.2.2.1.cmml"><mi id="alg2.l1.m7.6.6.2.2.1.2" xref="alg2.l1.m7.6.6.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.6.6.2.2.1.1" xref="alg2.l1.m7.6.6.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.6.6.2.2.1.3" xref="alg2.l1.m7.6.6.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m7.6.6.2.2.1.1a" xref="alg2.l1.m7.6.6.2.2.1.1.cmml">​</mo><mi id="alg2.l1.m7.6.6.2.2.1.4" xref="alg2.l1.m7.6.6.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m7.6.6.2.2.2" xref="alg2.l1.m7.6.6.2.3.cmml">,</mo><mi id="alg2.l1.m7.5.5.1.1" xref="alg2.l1.m7.5.5.1.1.cmml">M</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m7.6b"><apply id="alg2.l1.m7.6.7.cmml" xref="alg2.l1.m7.6.7"><and id="alg2.l1.m7.6.7a.cmml" xref="alg2.l1.m7.6.7"></and><apply id="alg2.l1.m7.6.7b.cmml" xref="alg2.l1.m7.6.7"><geq id="alg2.l1.m7.6.7.3.cmml" xref="alg2.l1.m7.6.7.3"></geq><apply id="alg2.l1.m7.6.7.2.cmml" xref="alg2.l1.m7.6.7.2"><csymbol cd="ambiguous" id="alg2.l1.m7.6.7.2.1.cmml" xref="alg2.l1.m7.6.7.2">subscript</csymbol><ci id="alg2.l1.m7.6.7.2.2.cmml" xref="alg2.l1.m7.6.7.2.2">𝑟</ci><list id="alg2.l1.m7.2.2.2.3.cmml" xref="alg2.l1.m7.2.2.2.2"><apply id="alg2.l1.m7.2.2.2.2.1.cmml" xref="alg2.l1.m7.2.2.2.2.1"><times id="alg2.l1.m7.2.2.2.2.1.1.cmml" xref="alg2.l1.m7.2.2.2.2.1.1"></times><ci id="alg2.l1.m7.2.2.2.2.1.2.cmml" xref="alg2.l1.m7.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l1.m7.2.2.2.2.1.3.cmml" xref="alg2.l1.m7.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l1.m7.2.2.2.2.1.4.cmml" xref="alg2.l1.m7.2.2.2.2.1.4">𝑥</ci></apply><cn type="integer" id="alg2.l1.m7.1.1.1.1.cmml" xref="alg2.l1.m7.1.1.1.1">1</cn></list></apply><apply id="alg2.l1.m7.6.7.4.cmml" xref="alg2.l1.m7.6.7.4"><csymbol cd="ambiguous" id="alg2.l1.m7.6.7.4.1.cmml" xref="alg2.l1.m7.6.7.4">subscript</csymbol><ci id="alg2.l1.m7.6.7.4.2.cmml" xref="alg2.l1.m7.6.7.4.2">𝑟</ci><list id="alg2.l1.m7.4.4.2.3.cmml" xref="alg2.l1.m7.4.4.2.2"><apply id="alg2.l1.m7.4.4.2.2.1.cmml" xref="alg2.l1.m7.4.4.2.2.1"><times id="alg2.l1.m7.4.4.2.2.1.1.cmml" xref="alg2.l1.m7.4.4.2.2.1.1"></times><ci id="alg2.l1.m7.4.4.2.2.1.2.cmml" xref="alg2.l1.m7.4.4.2.2.1.2">𝑚</ci><ci id="alg2.l1.m7.4.4.2.2.1.3.cmml" xref="alg2.l1.m7.4.4.2.2.1.3">𝑎</ci><ci id="alg2.l1.m7.4.4.2.2.1.4.cmml" xref="alg2.l1.m7.4.4.2.2.1.4">𝑥</ci></apply><cn type="integer" id="alg2.l1.m7.3.3.1.1.cmml" xref="alg2.l1.m7.3.3.1.1">2</cn></list></apply></apply><apply id="alg2.l1.m7.6.7c.cmml" xref="alg2.l1.m7.6.7"><geq id="alg2.l1.m7.6.7.5.cmml" xref="alg2.l1.m7.6.7.5"></geq><share href="#alg2.l1.m7.6.7.4.cmml" id="alg2.l1.m7.6.7d.cmml" xref="alg2.l1.m7.6.7"></share><ci id="alg2.l1.m7.6.7.6.cmml" xref="alg2.l1.m7.6.7.6">⋯</ci></apply><apply id="alg2.l1.m7.6.7e.cmml" xref="alg2.l1.m7.6.7"><geq id="alg2.l1.m7.6.7.7.cmml" xref="alg2.l1.m7.6.7.7"></geq><share href="#alg2.l1.m7.6.7.6.cmml" id="alg2.l1.m7.6.7f.cmml" xref="alg2.l1.m7.6.7"></share><apply id="alg2.l1.m7.6.7.8.cmml" xref="alg2.l1.m7.6.7.8"><csymbol cd="ambiguous" id="alg2.l1.m7.6.7.8.1.cmml" xref="alg2.l1.m7.6.7.8">subscript</csymbol><ci id="alg2.l1.m7.6.7.8.2.cmml" xref="alg2.l1.m7.6.7.8.2">𝑟</ci><list id="alg2.l1.m7.6.6.2.3.cmml" xref="alg2.l1.m7.6.6.2.2"><apply id="alg2.l1.m7.6.6.2.2.1.cmml" xref="alg2.l1.m7.6.6.2.2.1"><times id="alg2.l1.m7.6.6.2.2.1.1.cmml" xref="alg2.l1.m7.6.6.2.2.1.1"></times><ci id="alg2.l1.m7.6.6.2.2.1.2.cmml" xref="alg2.l1.m7.6.6.2.2.1.2">𝑚</ci><ci id="alg2.l1.m7.6.6.2.2.1.3.cmml" xref="alg2.l1.m7.6.6.2.2.1.3">𝑎</ci><ci id="alg2.l1.m7.6.6.2.2.1.4.cmml" xref="alg2.l1.m7.6.6.2.2.1.4">𝑥</ci></apply><ci id="alg2.l1.m7.5.5.1.1.cmml" xref="alg2.l1.m7.5.5.1.1">𝑀</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m7.6c">r_{max,1}\geq r_{max,2}\geq\cdots\geq r_{max,M}</annotation></semantics></math>), minimum proportion grid size <math id="alg2.l1.m8.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="alg2.l1.m8.1a"><mi id="alg2.l1.m8.1.1" xref="alg2.l1.m8.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m8.1b"><ci id="alg2.l1.m8.1.1.cmml" xref="alg2.l1.m8.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m8.1c">\delta</annotation></semantics></math>, number of mixture to run experiment <math id="alg2.l1.m9.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg2.l1.m9.1a"><mi id="alg2.l1.m9.1.1" xref="alg2.l1.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m9.1b"><ci id="alg2.l1.m9.1.1.cmml" xref="alg2.l1.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m9.1c">N</annotation></semantics></math>.

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><span id="alg2.l2.1" class="ltx_text ltx_font_bold">Output:</span> A set of <math id="alg2.l2.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg2.l2.m1.1a"><mi id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">N</annotation></semantics></math> mixtures to experiment <math id="alg2.l2.m2.1" class="ltx_Math" alttext="\{\bm{r}_{n}\}_{n=1}^{N}" display="inline"><semantics id="alg2.l2.m2.1a"><msubsup id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml"><mrow id="alg2.l2.m2.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l2.m2.1.1.1.1.1.2" xref="alg2.l2.m2.1.1.1.1.2.cmml">{</mo><msub id="alg2.l2.m2.1.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.1.1.cmml"><mi id="alg2.l2.m2.1.1.1.1.1.1.2" xref="alg2.l2.m2.1.1.1.1.1.1.2.cmml">𝒓</mi><mi id="alg2.l2.m2.1.1.1.1.1.1.3" xref="alg2.l2.m2.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="alg2.l2.m2.1.1.1.1.1.3" xref="alg2.l2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l2.m2.1.1.1.3" xref="alg2.l2.m2.1.1.1.3.cmml"><mi id="alg2.l2.m2.1.1.1.3.2" xref="alg2.l2.m2.1.1.1.3.2.cmml">n</mi><mo id="alg2.l2.m2.1.1.1.3.1" xref="alg2.l2.m2.1.1.1.3.1.cmml">=</mo><mn id="alg2.l2.m2.1.1.1.3.3" xref="alg2.l2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg2.l2.m2.1.1.3" xref="alg2.l2.m2.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><apply id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.2.cmml" xref="alg2.l2.m2.1.1">superscript</csymbol><apply id="alg2.l2.m2.1.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.2.cmml" xref="alg2.l2.m2.1.1">subscript</csymbol><set id="alg2.l2.m2.1.1.1.1.2.cmml" xref="alg2.l2.m2.1.1.1.1.1"><apply id="alg2.l2.m2.1.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l2.m2.1.1.1.1.1.1.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.2">𝒓</ci><ci id="alg2.l2.m2.1.1.1.1.1.1.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.3">𝑛</ci></apply></set><apply id="alg2.l2.m2.1.1.1.3.cmml" xref="alg2.l2.m2.1.1.1.3"><eq id="alg2.l2.m2.1.1.1.3.1.cmml" xref="alg2.l2.m2.1.1.1.3.1"></eq><ci id="alg2.l2.m2.1.1.1.3.2.cmml" xref="alg2.l2.m2.1.1.1.3.2">𝑛</ci><cn type="integer" id="alg2.l2.m2.1.1.1.3.3.cmml" xref="alg2.l2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="alg2.l2.m2.1.1.3.cmml" xref="alg2.l2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">\{\bm{r}_{n}\}_{n=1}^{N}</annotation></semantics></math>.

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>Candidate mixtures <math id="alg2.l3.m1.2" class="ltx_Math" alttext="\mathcal{C}\leftarrow\textsc{GetAllCandidates}(1,[])" display="inline"><semantics id="alg2.l3.m1.2a"><mrow id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.2.2.3" xref="alg2.l3.m1.2.2.3.cmml">𝒞</mi><mo stretchy="false" id="alg2.l3.m1.2.2.2" xref="alg2.l3.m1.2.2.2.cmml">←</mo><mrow id="alg2.l3.m1.2.2.1" xref="alg2.l3.m1.2.2.1.cmml"><mtext class="ltx_font_smallcaps" id="alg2.l3.m1.2.2.1.3" xref="alg2.l3.m1.2.2.1.3a.cmml">GetAllCandidates</mtext><mo lspace="0em" rspace="0em" id="alg2.l3.m1.2.2.1.2" xref="alg2.l3.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l3.m1.2.2.1.1.1" xref="alg2.l3.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.2.cmml">(</mo><mn id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">1</mn><mo id="alg2.l3.m1.2.2.1.1.1.3" xref="alg2.l3.m1.2.2.1.1.2.cmml">,</mo><mrow id="alg2.l3.m1.2.2.1.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.1.2.1" xref="alg2.l3.m1.2.2.1.1.1.1.1.cmml">[</mo><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.1.2.2" xref="alg2.l3.m1.2.2.1.1.1.1.1.cmml">]</mo></mrow><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.4" xref="alg2.l3.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.2b"><apply id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2"><ci id="alg2.l3.m1.2.2.2.cmml" xref="alg2.l3.m1.2.2.2">←</ci><ci id="alg2.l3.m1.2.2.3.cmml" xref="alg2.l3.m1.2.2.3">𝒞</ci><apply id="alg2.l3.m1.2.2.1.cmml" xref="alg2.l3.m1.2.2.1"><times id="alg2.l3.m1.2.2.1.2.cmml" xref="alg2.l3.m1.2.2.1.2"></times><ci id="alg2.l3.m1.2.2.1.3a.cmml" xref="alg2.l3.m1.2.2.1.3"><mtext class="ltx_font_smallcaps" id="alg2.l3.m1.2.2.1.3.cmml" xref="alg2.l3.m1.2.2.1.3">GetAllCandidates</mtext></ci><interval closure="open" id="alg2.l3.m1.2.2.1.1.2.cmml" xref="alg2.l3.m1.2.2.1.1.1"><cn type="integer" id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">1</cn><list id="alg2.l3.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.2.1"></list></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.2c">\mathcal{C}\leftarrow\textsc{GetAllCandidates}(1,[])</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>Split mixtures with 0 proportion in <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg2.l4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\mathcal{C}</annotation></semantics></math> into <math id="alg2.l4.m2.1" class="ltx_Math" alttext="\mathcal{C}_{0}" display="inline"><semantics id="alg2.l4.m2.1a"><msub id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m2.1.1.2" xref="alg2.l4.m2.1.1.2.cmml">𝒞</mi><mn id="alg2.l4.m2.1.1.3" xref="alg2.l4.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1">subscript</csymbol><ci id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1.2">𝒞</ci><cn type="integer" id="alg2.l4.m2.1.1.3.cmml" xref="alg2.l4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">\mathcal{C}_{0}</annotation></semantics></math> and the others into <math id="alg2.l4.m3.1" class="ltx_Math" alttext="\mathcal{C}_{1}" display="inline"><semantics id="alg2.l4.m3.1a"><msub id="alg2.l4.m3.1.1" xref="alg2.l4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m3.1.1.2" xref="alg2.l4.m3.1.1.2.cmml">𝒞</mi><mn id="alg2.l4.m3.1.1.3" xref="alg2.l4.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m3.1b"><apply id="alg2.l4.m3.1.1.cmml" xref="alg2.l4.m3.1.1"><csymbol cd="ambiguous" id="alg2.l4.m3.1.1.1.cmml" xref="alg2.l4.m3.1.1">subscript</csymbol><ci id="alg2.l4.m3.1.1.2.cmml" xref="alg2.l4.m3.1.1.2">𝒞</ci><cn type="integer" id="alg2.l4.m3.1.1.3.cmml" xref="alg2.l4.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m3.1c">\mathcal{C}_{1}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>Samples <math id="alg2.l5.m1.2" class="ltx_Math" alttext="\{\bm{r}_{n}\}_{n=1}^{\lfloor N/4\rfloor}" display="inline"><semantics id="alg2.l5.m1.2a"><msubsup id="alg2.l5.m1.2.2" xref="alg2.l5.m1.2.2.cmml"><mrow id="alg2.l5.m1.2.2.1.1.1" xref="alg2.l5.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l5.m1.2.2.1.1.1.2" xref="alg2.l5.m1.2.2.1.1.2.cmml">{</mo><msub id="alg2.l5.m1.2.2.1.1.1.1" xref="alg2.l5.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l5.m1.2.2.1.1.1.1.2" xref="alg2.l5.m1.2.2.1.1.1.1.2.cmml">𝒓</mi><mi id="alg2.l5.m1.2.2.1.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="alg2.l5.m1.2.2.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l5.m1.2.2.1.3" xref="alg2.l5.m1.2.2.1.3.cmml"><mi id="alg2.l5.m1.2.2.1.3.2" xref="alg2.l5.m1.2.2.1.3.2.cmml">n</mi><mo id="alg2.l5.m1.2.2.1.3.1" xref="alg2.l5.m1.2.2.1.3.1.cmml">=</mo><mn id="alg2.l5.m1.2.2.1.3.3" xref="alg2.l5.m1.2.2.1.3.3.cmml">1</mn></mrow><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.2.1.cmml">⌊</mo><mrow id="alg2.l5.m1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.cmml"><mi id="alg2.l5.m1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.2.cmml">N</mi><mo id="alg2.l5.m1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.cmml">/</mo><mn id="alg2.l5.m1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.3.cmml">4</mn></mrow><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.2.1.cmml">⌋</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.cmml" xref="alg2.l5.m1.2.2">superscript</csymbol><apply id="alg2.l5.m1.2.2.1.cmml" xref="alg2.l5.m1.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.2.cmml" xref="alg2.l5.m1.2.2">subscript</csymbol><set id="alg2.l5.m1.2.2.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1"><apply id="alg2.l5.m1.2.2.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.2">𝒓</ci><ci id="alg2.l5.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.3">𝑛</ci></apply></set><apply id="alg2.l5.m1.2.2.1.3.cmml" xref="alg2.l5.m1.2.2.1.3"><eq id="alg2.l5.m1.2.2.1.3.1.cmml" xref="alg2.l5.m1.2.2.1.3.1"></eq><ci id="alg2.l5.m1.2.2.1.3.2.cmml" xref="alg2.l5.m1.2.2.1.3.2">𝑛</ci><cn type="integer" id="alg2.l5.m1.2.2.1.3.3.cmml" xref="alg2.l5.m1.2.2.1.3.3">1</cn></apply></apply><apply id="alg2.l5.m1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1"><floor id="alg2.l5.m1.1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.2"></floor><apply id="alg2.l5.m1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1"><divide id="alg2.l5.m1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1"></divide><ci id="alg2.l5.m1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="alg2.l5.m1.1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">\{\bm{r}_{n}\}_{n=1}^{\lfloor N/4\rfloor}</annotation></semantics></math> from <math id="alg2.l5.m2.1" class="ltx_Math" alttext="\mathcal{C}_{0}" display="inline"><semantics id="alg2.l5.m2.1a"><msub id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">𝒞</mi><mn id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1">subscript</csymbol><ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">𝒞</ci><cn type="integer" id="alg2.l5.m2.1.1.3.cmml" xref="alg2.l5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">\mathcal{C}_{0}</annotation></semantics></math> and <math id="alg2.l5.m3.2" class="ltx_Math" alttext="\{\bm{r}_{n}\}_{n=\lceil N/4\rceil}^{N}" display="inline"><semantics id="alg2.l5.m3.2a"><msubsup id="alg2.l5.m3.2.2" xref="alg2.l5.m3.2.2.cmml"><mrow id="alg2.l5.m3.2.2.1.1.1" xref="alg2.l5.m3.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l5.m3.2.2.1.1.1.2" xref="alg2.l5.m3.2.2.1.1.2.cmml">{</mo><msub id="alg2.l5.m3.2.2.1.1.1.1" xref="alg2.l5.m3.2.2.1.1.1.1.cmml"><mi id="alg2.l5.m3.2.2.1.1.1.1.2" xref="alg2.l5.m3.2.2.1.1.1.1.2.cmml">𝒓</mi><mi id="alg2.l5.m3.2.2.1.1.1.1.3" xref="alg2.l5.m3.2.2.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="alg2.l5.m3.2.2.1.1.1.3" xref="alg2.l5.m3.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l5.m3.1.1.1" xref="alg2.l5.m3.1.1.1.cmml"><mi id="alg2.l5.m3.1.1.1.3" xref="alg2.l5.m3.1.1.1.3.cmml">n</mi><mo id="alg2.l5.m3.1.1.1.2" xref="alg2.l5.m3.1.1.1.2.cmml">=</mo><mrow id="alg2.l5.m3.1.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l5.m3.1.1.1.1.1.2" xref="alg2.l5.m3.1.1.1.1.2.1.cmml">⌈</mo><mrow id="alg2.l5.m3.1.1.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.1.1.cmml"><mi id="alg2.l5.m3.1.1.1.1.1.1.2" xref="alg2.l5.m3.1.1.1.1.1.1.2.cmml">N</mi><mo id="alg2.l5.m3.1.1.1.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.1.1.1.cmml">/</mo><mn id="alg2.l5.m3.1.1.1.1.1.1.3" xref="alg2.l5.m3.1.1.1.1.1.1.3.cmml">4</mn></mrow><mo stretchy="false" id="alg2.l5.m3.1.1.1.1.1.3" xref="alg2.l5.m3.1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow><mi id="alg2.l5.m3.2.2.3" xref="alg2.l5.m3.2.2.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l5.m3.2b"><apply id="alg2.l5.m3.2.2.cmml" xref="alg2.l5.m3.2.2"><csymbol cd="ambiguous" id="alg2.l5.m3.2.2.2.cmml" xref="alg2.l5.m3.2.2">superscript</csymbol><apply id="alg2.l5.m3.2.2.1.cmml" xref="alg2.l5.m3.2.2"><csymbol cd="ambiguous" id="alg2.l5.m3.2.2.1.2.cmml" xref="alg2.l5.m3.2.2">subscript</csymbol><set id="alg2.l5.m3.2.2.1.1.2.cmml" xref="alg2.l5.m3.2.2.1.1.1"><apply id="alg2.l5.m3.2.2.1.1.1.1.cmml" xref="alg2.l5.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m3.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m3.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m3.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m3.2.2.1.1.1.1.2">𝒓</ci><ci id="alg2.l5.m3.2.2.1.1.1.1.3.cmml" xref="alg2.l5.m3.2.2.1.1.1.1.3">𝑛</ci></apply></set><apply id="alg2.l5.m3.1.1.1.cmml" xref="alg2.l5.m3.1.1.1"><eq id="alg2.l5.m3.1.1.1.2.cmml" xref="alg2.l5.m3.1.1.1.2"></eq><ci id="alg2.l5.m3.1.1.1.3.cmml" xref="alg2.l5.m3.1.1.1.3">𝑛</ci><apply id="alg2.l5.m3.1.1.1.1.2.cmml" xref="alg2.l5.m3.1.1.1.1.1"><ceiling id="alg2.l5.m3.1.1.1.1.2.1.cmml" xref="alg2.l5.m3.1.1.1.1.1.2"></ceiling><apply id="alg2.l5.m3.1.1.1.1.1.1.cmml" xref="alg2.l5.m3.1.1.1.1.1.1"><divide id="alg2.l5.m3.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m3.1.1.1.1.1.1.1"></divide><ci id="alg2.l5.m3.1.1.1.1.1.1.2.cmml" xref="alg2.l5.m3.1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="alg2.l5.m3.1.1.1.1.1.1.3.cmml" xref="alg2.l5.m3.1.1.1.1.1.1.3">4</cn></apply></apply></apply></apply><ci id="alg2.l5.m3.2.2.3.cmml" xref="alg2.l5.m3.2.2.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m3.2c">\{\bm{r}_{n}\}_{n=\lceil N/4\rceil}^{N}</annotation></semantics></math> from <math id="alg2.l5.m4.1" class="ltx_Math" alttext="\mathcal{C}_{1}" display="inline"><semantics id="alg2.l5.m4.1a"><msub id="alg2.l5.m4.1.1" xref="alg2.l5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m4.1.1.2" xref="alg2.l5.m4.1.1.2.cmml">𝒞</mi><mn id="alg2.l5.m4.1.1.3" xref="alg2.l5.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m4.1b"><apply id="alg2.l5.m4.1.1.cmml" xref="alg2.l5.m4.1.1"><csymbol cd="ambiguous" id="alg2.l5.m4.1.1.1.cmml" xref="alg2.l5.m4.1.1">subscript</csymbol><ci id="alg2.l5.m4.1.1.2.cmml" xref="alg2.l5.m4.1.1.2">𝒞</ci><cn type="integer" id="alg2.l5.m4.1.1.3.cmml" xref="alg2.l5.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m4.1c">\mathcal{C}_{1}</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>
</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span><span id="alg2.l7.1" class="ltx_text ltx_font_bold">procedure</span>&nbsp;<span id="alg2.l7.2" class="ltx_text ltx_font_smallcaps">GetAllCandidates</span>(domain index <math id="alg2.l7.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l7.m1.1a"><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">i</annotation></semantics></math>, proportions of first <math id="alg2.l7.m2.1" class="ltx_Math" alttext="i-1" display="inline"><semantics id="alg2.l7.m2.1a"><mrow id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml"><mi id="alg2.l7.m2.1.1.2" xref="alg2.l7.m2.1.1.2.cmml">i</mi><mo id="alg2.l7.m2.1.1.1" xref="alg2.l7.m2.1.1.1.cmml">−</mo><mn id="alg2.l7.m2.1.1.3" xref="alg2.l7.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><apply id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1"><minus id="alg2.l7.m2.1.1.1.cmml" xref="alg2.l7.m2.1.1.1"></minus><ci id="alg2.l7.m2.1.1.2.cmml" xref="alg2.l7.m2.1.1.2">𝑖</ci><cn type="integer" id="alg2.l7.m2.1.1.3.cmml" xref="alg2.l7.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">i-1</annotation></semantics></math> domains <math id="alg2.l7.m3.1" class="ltx_Math" alttext="r_{1\dots i-1}" display="inline"><semantics id="alg2.l7.m3.1a"><msub id="alg2.l7.m3.1.1" xref="alg2.l7.m3.1.1.cmml"><mi id="alg2.l7.m3.1.1.2" xref="alg2.l7.m3.1.1.2.cmml">r</mi><mrow id="alg2.l7.m3.1.1.3" xref="alg2.l7.m3.1.1.3.cmml"><mrow id="alg2.l7.m3.1.1.3.2" xref="alg2.l7.m3.1.1.3.2.cmml"><mn id="alg2.l7.m3.1.1.3.2.2" xref="alg2.l7.m3.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l7.m3.1.1.3.2.1" xref="alg2.l7.m3.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l7.m3.1.1.3.2.3" xref="alg2.l7.m3.1.1.3.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m3.1.1.3.2.1a" xref="alg2.l7.m3.1.1.3.2.1.cmml">​</mo><mi id="alg2.l7.m3.1.1.3.2.4" xref="alg2.l7.m3.1.1.3.2.4.cmml">i</mi></mrow><mo id="alg2.l7.m3.1.1.3.1" xref="alg2.l7.m3.1.1.3.1.cmml">−</mo><mn id="alg2.l7.m3.1.1.3.3" xref="alg2.l7.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l7.m3.1b"><apply id="alg2.l7.m3.1.1.cmml" xref="alg2.l7.m3.1.1"><csymbol cd="ambiguous" id="alg2.l7.m3.1.1.1.cmml" xref="alg2.l7.m3.1.1">subscript</csymbol><ci id="alg2.l7.m3.1.1.2.cmml" xref="alg2.l7.m3.1.1.2">𝑟</ci><apply id="alg2.l7.m3.1.1.3.cmml" xref="alg2.l7.m3.1.1.3"><minus id="alg2.l7.m3.1.1.3.1.cmml" xref="alg2.l7.m3.1.1.3.1"></minus><apply id="alg2.l7.m3.1.1.3.2.cmml" xref="alg2.l7.m3.1.1.3.2"><times id="alg2.l7.m3.1.1.3.2.1.cmml" xref="alg2.l7.m3.1.1.3.2.1"></times><cn type="integer" id="alg2.l7.m3.1.1.3.2.2.cmml" xref="alg2.l7.m3.1.1.3.2.2">1</cn><ci id="alg2.l7.m3.1.1.3.2.3.cmml" xref="alg2.l7.m3.1.1.3.2.3">…</ci><ci id="alg2.l7.m3.1.1.3.2.4.cmml" xref="alg2.l7.m3.1.1.3.2.4">𝑖</ci></apply><cn type="integer" id="alg2.l7.m3.1.1.3.3.cmml" xref="alg2.l7.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m3.1c">r_{1\dots i-1}</annotation></semantics></math>)

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Candidate mixtures <math id="alg2.l8.m1.1" class="ltx_Math" alttext="\mathcal{C}=\emptyset" display="inline"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">𝒞</mi><mo id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">=</mo><mi mathvariant="normal" id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><eq id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1"></eq><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝒞</ci><emptyset id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\mathcal{C}=\emptyset</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l9.1" class="ltx_text ltx_font_bold">if</span>&nbsp;<math id="alg2.l9.m1.1" class="ltx_Math" alttext="i=M" display="inline"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml">i</mi><mo id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">=</mo><mi id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><eq id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1"></eq><ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">𝑖</ci><ci id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">i=M</annotation></semantics></math>&nbsp;<span id="alg2.l9.2" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l10.1" class="ltx_text ltx_font_bold">if</span>&nbsp;<math id="alg2.l10.m1.2" class="ltx_Math" alttext="0\leq 1-\sum_{j=1}^{i-1}r_{j}\leq r_{max,i}" display="inline"><semantics id="alg2.l10.m1.2a"><mrow id="alg2.l10.m1.2.3" xref="alg2.l10.m1.2.3.cmml"><mn id="alg2.l10.m1.2.3.2" xref="alg2.l10.m1.2.3.2.cmml">0</mn><mo id="alg2.l10.m1.2.3.3" xref="alg2.l10.m1.2.3.3.cmml">≤</mo><mrow id="alg2.l10.m1.2.3.4" xref="alg2.l10.m1.2.3.4.cmml"><mn id="alg2.l10.m1.2.3.4.2" xref="alg2.l10.m1.2.3.4.2.cmml">1</mn><mo rspace="0.055em" id="alg2.l10.m1.2.3.4.1" xref="alg2.l10.m1.2.3.4.1.cmml">−</mo><mrow id="alg2.l10.m1.2.3.4.3" xref="alg2.l10.m1.2.3.4.3.cmml"><msubsup id="alg2.l10.m1.2.3.4.3.1" xref="alg2.l10.m1.2.3.4.3.1.cmml"><mo id="alg2.l10.m1.2.3.4.3.1.2.2" xref="alg2.l10.m1.2.3.4.3.1.2.2.cmml">∑</mo><mrow id="alg2.l10.m1.2.3.4.3.1.2.3" xref="alg2.l10.m1.2.3.4.3.1.2.3.cmml"><mi id="alg2.l10.m1.2.3.4.3.1.2.3.2" xref="alg2.l10.m1.2.3.4.3.1.2.3.2.cmml">j</mi><mo id="alg2.l10.m1.2.3.4.3.1.2.3.1" xref="alg2.l10.m1.2.3.4.3.1.2.3.1.cmml">=</mo><mn id="alg2.l10.m1.2.3.4.3.1.2.3.3" xref="alg2.l10.m1.2.3.4.3.1.2.3.3.cmml">1</mn></mrow><mrow id="alg2.l10.m1.2.3.4.3.1.3" xref="alg2.l10.m1.2.3.4.3.1.3.cmml"><mi id="alg2.l10.m1.2.3.4.3.1.3.2" xref="alg2.l10.m1.2.3.4.3.1.3.2.cmml">i</mi><mo id="alg2.l10.m1.2.3.4.3.1.3.1" xref="alg2.l10.m1.2.3.4.3.1.3.1.cmml">−</mo><mn id="alg2.l10.m1.2.3.4.3.1.3.3" xref="alg2.l10.m1.2.3.4.3.1.3.3.cmml">1</mn></mrow></msubsup><msub id="alg2.l10.m1.2.3.4.3.2" xref="alg2.l10.m1.2.3.4.3.2.cmml"><mi id="alg2.l10.m1.2.3.4.3.2.2" xref="alg2.l10.m1.2.3.4.3.2.2.cmml">r</mi><mi id="alg2.l10.m1.2.3.4.3.2.3" xref="alg2.l10.m1.2.3.4.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="alg2.l10.m1.2.3.5" xref="alg2.l10.m1.2.3.5.cmml">≤</mo><msub id="alg2.l10.m1.2.3.6" xref="alg2.l10.m1.2.3.6.cmml"><mi id="alg2.l10.m1.2.3.6.2" xref="alg2.l10.m1.2.3.6.2.cmml">r</mi><mrow id="alg2.l10.m1.2.2.2.2" xref="alg2.l10.m1.2.2.2.3.cmml"><mrow id="alg2.l10.m1.2.2.2.2.1" xref="alg2.l10.m1.2.2.2.2.1.cmml"><mi id="alg2.l10.m1.2.2.2.2.1.2" xref="alg2.l10.m1.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.2.2.2.2.1.1" xref="alg2.l10.m1.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l10.m1.2.2.2.2.1.3" xref="alg2.l10.m1.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.2.2.2.2.1.1a" xref="alg2.l10.m1.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l10.m1.2.2.2.2.1.4" xref="alg2.l10.m1.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l10.m1.2.2.2.2.2" xref="alg2.l10.m1.2.2.2.3.cmml">,</mo><mi id="alg2.l10.m1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.cmml">i</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.2b"><apply id="alg2.l10.m1.2.3.cmml" xref="alg2.l10.m1.2.3"><and id="alg2.l10.m1.2.3a.cmml" xref="alg2.l10.m1.2.3"></and><apply id="alg2.l10.m1.2.3b.cmml" xref="alg2.l10.m1.2.3"><leq id="alg2.l10.m1.2.3.3.cmml" xref="alg2.l10.m1.2.3.3"></leq><cn type="integer" id="alg2.l10.m1.2.3.2.cmml" xref="alg2.l10.m1.2.3.2">0</cn><apply id="alg2.l10.m1.2.3.4.cmml" xref="alg2.l10.m1.2.3.4"><minus id="alg2.l10.m1.2.3.4.1.cmml" xref="alg2.l10.m1.2.3.4.1"></minus><cn type="integer" id="alg2.l10.m1.2.3.4.2.cmml" xref="alg2.l10.m1.2.3.4.2">1</cn><apply id="alg2.l10.m1.2.3.4.3.cmml" xref="alg2.l10.m1.2.3.4.3"><apply id="alg2.l10.m1.2.3.4.3.1.cmml" xref="alg2.l10.m1.2.3.4.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.4.3.1.1.cmml" xref="alg2.l10.m1.2.3.4.3.1">superscript</csymbol><apply id="alg2.l10.m1.2.3.4.3.1.2.cmml" xref="alg2.l10.m1.2.3.4.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.4.3.1.2.1.cmml" xref="alg2.l10.m1.2.3.4.3.1">subscript</csymbol><sum id="alg2.l10.m1.2.3.4.3.1.2.2.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.2"></sum><apply id="alg2.l10.m1.2.3.4.3.1.2.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3"><eq id="alg2.l10.m1.2.3.4.3.1.2.3.1.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3.1"></eq><ci id="alg2.l10.m1.2.3.4.3.1.2.3.2.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3.2">𝑗</ci><cn type="integer" id="alg2.l10.m1.2.3.4.3.1.2.3.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3.3">1</cn></apply></apply><apply id="alg2.l10.m1.2.3.4.3.1.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.3"><minus id="alg2.l10.m1.2.3.4.3.1.3.1.cmml" xref="alg2.l10.m1.2.3.4.3.1.3.1"></minus><ci id="alg2.l10.m1.2.3.4.3.1.3.2.cmml" xref="alg2.l10.m1.2.3.4.3.1.3.2">𝑖</ci><cn type="integer" id="alg2.l10.m1.2.3.4.3.1.3.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.3.3">1</cn></apply></apply><apply id="alg2.l10.m1.2.3.4.3.2.cmml" xref="alg2.l10.m1.2.3.4.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.4.3.2.1.cmml" xref="alg2.l10.m1.2.3.4.3.2">subscript</csymbol><ci id="alg2.l10.m1.2.3.4.3.2.2.cmml" xref="alg2.l10.m1.2.3.4.3.2.2">𝑟</ci><ci id="alg2.l10.m1.2.3.4.3.2.3.cmml" xref="alg2.l10.m1.2.3.4.3.2.3">𝑗</ci></apply></apply></apply></apply><apply id="alg2.l10.m1.2.3c.cmml" xref="alg2.l10.m1.2.3"><leq id="alg2.l10.m1.2.3.5.cmml" xref="alg2.l10.m1.2.3.5"></leq><share href="#alg2.l10.m1.2.3.4.cmml" id="alg2.l10.m1.2.3d.cmml" xref="alg2.l10.m1.2.3"></share><apply id="alg2.l10.m1.2.3.6.cmml" xref="alg2.l10.m1.2.3.6"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.6.1.cmml" xref="alg2.l10.m1.2.3.6">subscript</csymbol><ci id="alg2.l10.m1.2.3.6.2.cmml" xref="alg2.l10.m1.2.3.6.2">𝑟</ci><list id="alg2.l10.m1.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.2"><apply id="alg2.l10.m1.2.2.2.2.1.cmml" xref="alg2.l10.m1.2.2.2.2.1"><times id="alg2.l10.m1.2.2.2.2.1.1.cmml" xref="alg2.l10.m1.2.2.2.2.1.1"></times><ci id="alg2.l10.m1.2.2.2.2.1.2.cmml" xref="alg2.l10.m1.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l10.m1.2.2.2.2.1.3.cmml" xref="alg2.l10.m1.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l10.m1.2.2.2.2.1.4.cmml" xref="alg2.l10.m1.2.2.2.2.1.4">𝑥</ci></apply><ci id="alg2.l10.m1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1">𝑖</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.2c">0\leq 1-\sum_{j=1}^{i-1}r_{j}\leq r_{max,i}</annotation></semantics></math>&nbsp;<span id="alg2.l10.2" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l11.m1.2" class="ltx_Math" alttext="r_{1\dots i}\leftarrow[r_{1\dots i-1},1-\sum_{j=1}^{i-1}r_{j}]" display="inline"><semantics id="alg2.l11.m1.2a"><mrow id="alg2.l11.m1.2.2" xref="alg2.l11.m1.2.2.cmml"><msub id="alg2.l11.m1.2.2.4" xref="alg2.l11.m1.2.2.4.cmml"><mi id="alg2.l11.m1.2.2.4.2" xref="alg2.l11.m1.2.2.4.2.cmml">r</mi><mrow id="alg2.l11.m1.2.2.4.3" xref="alg2.l11.m1.2.2.4.3.cmml"><mn id="alg2.l11.m1.2.2.4.3.2" xref="alg2.l11.m1.2.2.4.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l11.m1.2.2.4.3.1" xref="alg2.l11.m1.2.2.4.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l11.m1.2.2.4.3.3" xref="alg2.l11.m1.2.2.4.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m1.2.2.4.3.1a" xref="alg2.l11.m1.2.2.4.3.1.cmml">​</mo><mi id="alg2.l11.m1.2.2.4.3.4" xref="alg2.l11.m1.2.2.4.3.4.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg2.l11.m1.2.2.3" xref="alg2.l11.m1.2.2.3.cmml">←</mo><mrow id="alg2.l11.m1.2.2.2.2" xref="alg2.l11.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l11.m1.2.2.2.2.3" xref="alg2.l11.m1.2.2.2.3.cmml">[</mo><msub id="alg2.l11.m1.1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.1.cmml"><mi id="alg2.l11.m1.1.1.1.1.1.2" xref="alg2.l11.m1.1.1.1.1.1.2.cmml">r</mi><mrow id="alg2.l11.m1.1.1.1.1.1.3" xref="alg2.l11.m1.1.1.1.1.1.3.cmml"><mrow id="alg2.l11.m1.1.1.1.1.1.3.2" xref="alg2.l11.m1.1.1.1.1.1.3.2.cmml"><mn id="alg2.l11.m1.1.1.1.1.1.3.2.2" xref="alg2.l11.m1.1.1.1.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l11.m1.1.1.1.1.1.3.2.1" xref="alg2.l11.m1.1.1.1.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l11.m1.1.1.1.1.1.3.2.3" xref="alg2.l11.m1.1.1.1.1.1.3.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m1.1.1.1.1.1.3.2.1a" xref="alg2.l11.m1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="alg2.l11.m1.1.1.1.1.1.3.2.4" xref="alg2.l11.m1.1.1.1.1.1.3.2.4.cmml">i</mi></mrow><mo id="alg2.l11.m1.1.1.1.1.1.3.1" xref="alg2.l11.m1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg2.l11.m1.1.1.1.1.1.3.3" xref="alg2.l11.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg2.l11.m1.2.2.2.2.4" xref="alg2.l11.m1.2.2.2.3.cmml">,</mo><mrow id="alg2.l11.m1.2.2.2.2.2" xref="alg2.l11.m1.2.2.2.2.2.cmml"><mn id="alg2.l11.m1.2.2.2.2.2.2" xref="alg2.l11.m1.2.2.2.2.2.2.cmml">1</mn><mo rspace="0.055em" id="alg2.l11.m1.2.2.2.2.2.1" xref="alg2.l11.m1.2.2.2.2.2.1.cmml">−</mo><mrow id="alg2.l11.m1.2.2.2.2.2.3" xref="alg2.l11.m1.2.2.2.2.2.3.cmml"><msubsup id="alg2.l11.m1.2.2.2.2.2.3.1" xref="alg2.l11.m1.2.2.2.2.2.3.1.cmml"><mo id="alg2.l11.m1.2.2.2.2.2.3.1.2.2" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="alg2.l11.m1.2.2.2.2.2.3.1.2.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.cmml"><mi id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2.cmml">j</mi><mo id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3.cmml">1</mn></mrow><mrow id="alg2.l11.m1.2.2.2.2.2.3.1.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.cmml"><mi id="alg2.l11.m1.2.2.2.2.2.3.1.3.2" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.2.cmml">i</mi><mo id="alg2.l11.m1.2.2.2.2.2.3.1.3.1" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.1.cmml">−</mo><mn id="alg2.l11.m1.2.2.2.2.2.3.1.3.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.3.cmml">1</mn></mrow></msubsup><msub id="alg2.l11.m1.2.2.2.2.2.3.2" xref="alg2.l11.m1.2.2.2.2.2.3.2.cmml"><mi id="alg2.l11.m1.2.2.2.2.2.3.2.2" xref="alg2.l11.m1.2.2.2.2.2.3.2.2.cmml">r</mi><mi id="alg2.l11.m1.2.2.2.2.2.3.2.3" xref="alg2.l11.m1.2.2.2.2.2.3.2.3.cmml">j</mi></msub></mrow></mrow><mo stretchy="false" id="alg2.l11.m1.2.2.2.2.5" xref="alg2.l11.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.2b"><apply id="alg2.l11.m1.2.2.cmml" xref="alg2.l11.m1.2.2"><ci id="alg2.l11.m1.2.2.3.cmml" xref="alg2.l11.m1.2.2.3">←</ci><apply id="alg2.l11.m1.2.2.4.cmml" xref="alg2.l11.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.4.1.cmml" xref="alg2.l11.m1.2.2.4">subscript</csymbol><ci id="alg2.l11.m1.2.2.4.2.cmml" xref="alg2.l11.m1.2.2.4.2">𝑟</ci><apply id="alg2.l11.m1.2.2.4.3.cmml" xref="alg2.l11.m1.2.2.4.3"><times id="alg2.l11.m1.2.2.4.3.1.cmml" xref="alg2.l11.m1.2.2.4.3.1"></times><cn type="integer" id="alg2.l11.m1.2.2.4.3.2.cmml" xref="alg2.l11.m1.2.2.4.3.2">1</cn><ci id="alg2.l11.m1.2.2.4.3.3.cmml" xref="alg2.l11.m1.2.2.4.3.3">…</ci><ci id="alg2.l11.m1.2.2.4.3.4.cmml" xref="alg2.l11.m1.2.2.4.3.4">𝑖</ci></apply></apply><interval closure="closed" id="alg2.l11.m1.2.2.2.3.cmml" xref="alg2.l11.m1.2.2.2.2"><apply id="alg2.l11.m1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l11.m1.1.1.1.1.1.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.2">𝑟</ci><apply id="alg2.l11.m1.1.1.1.1.1.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.3"><minus id="alg2.l11.m1.1.1.1.1.1.3.1.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.1"></minus><apply id="alg2.l11.m1.1.1.1.1.1.3.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2"><times id="alg2.l11.m1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.1"></times><cn type="integer" id="alg2.l11.m1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.2">1</cn><ci id="alg2.l11.m1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.3">…</ci><ci id="alg2.l11.m1.1.1.1.1.1.3.2.4.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.4">𝑖</ci></apply><cn type="integer" id="alg2.l11.m1.1.1.1.1.1.3.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.l11.m1.2.2.2.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2"><minus id="alg2.l11.m1.2.2.2.2.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.1"></minus><cn type="integer" id="alg2.l11.m1.2.2.2.2.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.2">1</cn><apply id="alg2.l11.m1.2.2.2.2.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3"><apply id="alg2.l11.m1.2.2.2.2.2.3.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.2.2.2.3.1.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1">superscript</csymbol><apply id="alg2.l11.m1.2.2.2.2.2.3.1.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.2.2.2.3.1.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1">subscript</csymbol><sum id="alg2.l11.m1.2.2.2.2.2.3.1.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.2"></sum><apply id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3"><eq id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1"></eq><ci id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3">1</cn></apply></apply><apply id="alg2.l11.m1.2.2.2.2.2.3.1.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3"><minus id="alg2.l11.m1.2.2.2.2.2.3.1.3.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.1"></minus><ci id="alg2.l11.m1.2.2.2.2.2.3.1.3.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.2">𝑖</ci><cn type="integer" id="alg2.l11.m1.2.2.2.2.2.3.1.3.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.3">1</cn></apply></apply><apply id="alg2.l11.m1.2.2.2.2.2.3.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.2.2.2.3.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2">subscript</csymbol><ci id="alg2.l11.m1.2.2.2.2.2.3.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2.2">𝑟</ci><ci id="alg2.l11.m1.2.2.2.2.2.3.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2.3">𝑗</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.2c">r_{1\dots i}\leftarrow[r_{1\dots i-1},1-\sum_{j=1}^{i-1}r_{j}]</annotation></semantics></math>

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l12.m1.1" class="ltx_Math" alttext="\mathcal{C}\leftarrow\mathcal{C}\bigcup\left\{r_{1\dots i}\right\}" display="inline"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">𝒞</mi><mo stretchy="false" id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">←</mo><mrow id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l12.m1.1.1.1.3" xref="alg2.l12.m1.1.1.1.3.cmml">𝒞</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1.2" xref="alg2.l12.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l12.m1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.cmml"><mo rspace="0em" id="alg2.l12.m1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.2.cmml">⋃</mo><mrow id="alg2.l12.m1.1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.2.cmml"><mo id="alg2.l12.m1.1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.2.cmml">{</mo><msub id="alg2.l12.m1.1.1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l12.m1.1.1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.1.1.2.cmml">r</mi><mrow id="alg2.l12.m1.1.1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.cmml"><mn id="alg2.l12.m1.1.1.1.1.1.1.1.3.2" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1.1.1.1.1.3.1" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l12.m1.1.1.1.1.1.1.1.3.3" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1.1.1.1.1.3.1a" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l12.m1.1.1.1.1.1.1.1.3.4" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.4.cmml">i</mi></mrow></msub><mo id="alg2.l12.m1.1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><ci id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">←</ci><ci id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">𝒞</ci><apply id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1"><times id="alg2.l12.m1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.2"></times><ci id="alg2.l12.m1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.3">𝒞</ci><apply id="alg2.l12.m1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1"><union id="alg2.l12.m1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.2"></union><set id="alg2.l12.m1.1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1"><apply id="alg2.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l12.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.2">𝑟</ci><apply id="alg2.l12.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3"><times id="alg2.l12.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.1"></times><cn type="integer" id="alg2.l12.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.2">1</cn><ci id="alg2.l12.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.3">…</ci><ci id="alg2.l12.m1.1.1.1.1.1.1.1.3.4.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.4">𝑖</ci></apply></apply></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">\mathcal{C}\leftarrow\mathcal{C}\bigcup\left\{r_{1\dots i}\right\}</annotation></semantics></math>

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l13.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg2.l13.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l14.1" class="ltx_text ltx_font_bold">else</span>
</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l15.m1.2" class="ltx_Math" alttext="\Gamma\leftarrow\delta*\lfloor\frac{r_{max,i}}{\delta}\rfloor" display="inline"><semantics id="alg2.l15.m1.2a"><mrow id="alg2.l15.m1.2.3" xref="alg2.l15.m1.2.3.cmml"><mi mathvariant="normal" id="alg2.l15.m1.2.3.2" xref="alg2.l15.m1.2.3.2.cmml">Γ</mi><mo stretchy="false" id="alg2.l15.m1.2.3.1" xref="alg2.l15.m1.2.3.1.cmml">←</mo><mrow id="alg2.l15.m1.2.3.3" xref="alg2.l15.m1.2.3.3.cmml"><mi id="alg2.l15.m1.2.3.3.2" xref="alg2.l15.m1.2.3.3.2.cmml">δ</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l15.m1.2.3.3.1" xref="alg2.l15.m1.2.3.3.1.cmml">∗</mo><mrow id="alg2.l15.m1.2.3.3.3.2" xref="alg2.l15.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="alg2.l15.m1.2.3.3.3.2.1" xref="alg2.l15.m1.2.3.3.3.1.1.cmml">⌊</mo><mfrac id="alg2.l15.m1.2.2" xref="alg2.l15.m1.2.2.cmml"><msub id="alg2.l15.m1.2.2.2" xref="alg2.l15.m1.2.2.2.cmml"><mi id="alg2.l15.m1.2.2.2.4" xref="alg2.l15.m1.2.2.2.4.cmml">r</mi><mrow id="alg2.l15.m1.2.2.2.2.2.2" xref="alg2.l15.m1.2.2.2.2.2.3.cmml"><mrow id="alg2.l15.m1.2.2.2.2.2.2.1" xref="alg2.l15.m1.2.2.2.2.2.2.1.cmml"><mi id="alg2.l15.m1.2.2.2.2.2.2.1.2" xref="alg2.l15.m1.2.2.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.2.2.2.2.2.2.1.1" xref="alg2.l15.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l15.m1.2.2.2.2.2.2.1.3" xref="alg2.l15.m1.2.2.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.2.2.2.2.2.2.1.1a" xref="alg2.l15.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="alg2.l15.m1.2.2.2.2.2.2.1.4" xref="alg2.l15.m1.2.2.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l15.m1.2.2.2.2.2.2.2" xref="alg2.l15.m1.2.2.2.2.2.3.cmml">,</mo><mi id="alg2.l15.m1.1.1.1.1.1.1" xref="alg2.l15.m1.1.1.1.1.1.1.cmml">i</mi></mrow></msub><mi id="alg2.l15.m1.2.2.4" xref="alg2.l15.m1.2.2.4.cmml">δ</mi></mfrac><mo stretchy="false" id="alg2.l15.m1.2.3.3.3.2.2" xref="alg2.l15.m1.2.3.3.3.1.1.cmml">⌋</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.2b"><apply id="alg2.l15.m1.2.3.cmml" xref="alg2.l15.m1.2.3"><ci id="alg2.l15.m1.2.3.1.cmml" xref="alg2.l15.m1.2.3.1">←</ci><ci id="alg2.l15.m1.2.3.2.cmml" xref="alg2.l15.m1.2.3.2">Γ</ci><apply id="alg2.l15.m1.2.3.3.cmml" xref="alg2.l15.m1.2.3.3"><times id="alg2.l15.m1.2.3.3.1.cmml" xref="alg2.l15.m1.2.3.3.1"></times><ci id="alg2.l15.m1.2.3.3.2.cmml" xref="alg2.l15.m1.2.3.3.2">𝛿</ci><apply id="alg2.l15.m1.2.3.3.3.1.cmml" xref="alg2.l15.m1.2.3.3.3.2"><floor id="alg2.l15.m1.2.3.3.3.1.1.cmml" xref="alg2.l15.m1.2.3.3.3.2.1"></floor><apply id="alg2.l15.m1.2.2.cmml" xref="alg2.l15.m1.2.2"><divide id="alg2.l15.m1.2.2.3.cmml" xref="alg2.l15.m1.2.2"></divide><apply id="alg2.l15.m1.2.2.2.cmml" xref="alg2.l15.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2">subscript</csymbol><ci id="alg2.l15.m1.2.2.2.4.cmml" xref="alg2.l15.m1.2.2.2.4">𝑟</ci><list id="alg2.l15.m1.2.2.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2.2.2.2"><apply id="alg2.l15.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1"><times id="alg2.l15.m1.2.2.2.2.2.2.1.1.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.1"></times><ci id="alg2.l15.m1.2.2.2.2.2.2.1.2.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l15.m1.2.2.2.2.2.2.1.3.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l15.m1.2.2.2.2.2.2.1.4.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.4">𝑥</ci></apply><ci id="alg2.l15.m1.1.1.1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1.1.1.1">𝑖</ci></list></apply><ci id="alg2.l15.m1.2.2.4.cmml" xref="alg2.l15.m1.2.2.4">𝛿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.2c">\Gamma\leftarrow\delta*\lfloor\frac{r_{max,i}}{\delta}\rfloor</annotation></semantics></math>

</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l16.1" class="ltx_text ltx_font_bold">for</span>&nbsp;<math id="alg2.l16.m1.1" class="ltx_Math" alttext="s=0\mbox{~{}~{}{To}~{}~{}}\lceil{\log_{2}{\frac{\Gamma}{\delta}}}\rceil" display="inline"><semantics id="alg2.l16.m1.1a"><mrow id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><mi id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml">s</mi><mo id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml">=</mo><mrow id="alg2.l16.m1.1.1.1" xref="alg2.l16.m1.1.1.1.cmml"><mn id="alg2.l16.m1.1.1.1.3" xref="alg2.l16.m1.1.1.1.3.cmml">0</mn><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.1.2" xref="alg2.l16.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l16.m1.1.1.1.4" xref="alg2.l16.m1.1.1.1.4d.cmml"><mtext id="alg2.l16.m1.1.1.1.4a" xref="alg2.l16.m1.1.1.1.4d.cmml">&nbsp;</mtext><mtext class="ltx_mathvariant_bold" id="alg2.l16.m1.1.1.1.4b" xref="alg2.l16.m1.1.1.1.4d.cmml">To</mtext><mtext id="alg2.l16.m1.1.1.1.4c" xref="alg2.l16.m1.1.1.1.4d.cmml">&nbsp;</mtext></mrow><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.1.2a" xref="alg2.l16.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l16.m1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l16.m1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.2.1.cmml">⌈</mo><mrow id="alg2.l16.m1.1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.1.cmml"><msub id="alg2.l16.m1.1.1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l16.m1.1.1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.1.1.2.cmml">log</mi><mn id="alg2.l16.m1.1.1.1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo lspace="0.167em" id="alg2.l16.m1.1.1.1.1.1.1a" xref="alg2.l16.m1.1.1.1.1.1.1.cmml">⁡</mo><mfrac id="alg2.l16.m1.1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="alg2.l16.m1.1.1.1.1.1.1.2.2" xref="alg2.l16.m1.1.1.1.1.1.1.2.2.cmml">Γ</mi><mi id="alg2.l16.m1.1.1.1.1.1.1.2.3" xref="alg2.l16.m1.1.1.1.1.1.1.2.3.cmml">δ</mi></mfrac></mrow><mo stretchy="false" id="alg2.l16.m1.1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><eq id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2"></eq><ci id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3">𝑠</ci><apply id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1"><times id="alg2.l16.m1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.2"></times><cn type="integer" id="alg2.l16.m1.1.1.1.3.cmml" xref="alg2.l16.m1.1.1.1.3">0</cn><ci id="alg2.l16.m1.1.1.1.4d.cmml" xref="alg2.l16.m1.1.1.1.4"><mrow id="alg2.l16.m1.1.1.1.4.cmml" xref="alg2.l16.m1.1.1.1.4"><mtext id="alg2.l16.m1.1.1.1.4a.cmml" xref="alg2.l16.m1.1.1.1.4">&nbsp;</mtext><mtext class="ltx_mathvariant_bold" id="alg2.l16.m1.1.1.1.4b.cmml" xref="alg2.l16.m1.1.1.1.4">To</mtext><mtext id="alg2.l16.m1.1.1.1.4c.cmml" xref="alg2.l16.m1.1.1.1.4">&nbsp;</mtext></mrow></ci><apply id="alg2.l16.m1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1"><ceiling id="alg2.l16.m1.1.1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.2"></ceiling><apply id="alg2.l16.m1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1"><apply id="alg2.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1">subscript</csymbol><log id="alg2.l16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1.2"></log><cn type="integer" id="alg2.l16.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="alg2.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2"><divide id="alg2.l16.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2"></divide><ci id="alg2.l16.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2.2">Γ</ci><ci id="alg2.l16.m1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2.3">𝛿</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">s=0\mbox{~{}~{}{To}~{}~{}}\lceil{\log_{2}{\frac{\Gamma}{\delta}}}\rceil</annotation></semantics></math>&nbsp;<span id="alg2.l16.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l17.m1.3" class="ltx_Math" alttext="r_{i}\leftarrow\max(0,\frac{\Gamma}{2^{s}})" display="inline"><semantics id="alg2.l17.m1.3a"><mrow id="alg2.l17.m1.3.4" xref="alg2.l17.m1.3.4.cmml"><msub id="alg2.l17.m1.3.4.2" xref="alg2.l17.m1.3.4.2.cmml"><mi id="alg2.l17.m1.3.4.2.2" xref="alg2.l17.m1.3.4.2.2.cmml">r</mi><mi id="alg2.l17.m1.3.4.2.3" xref="alg2.l17.m1.3.4.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.l17.m1.3.4.1" xref="alg2.l17.m1.3.4.1.cmml">←</mo><mrow id="alg2.l17.m1.3.4.3.2" xref="alg2.l17.m1.3.4.3.1.cmml"><mi id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml">max</mi><mo id="alg2.l17.m1.3.4.3.2a" xref="alg2.l17.m1.3.4.3.1.cmml">⁡</mo><mrow id="alg2.l17.m1.3.4.3.2.1" xref="alg2.l17.m1.3.4.3.1.cmml"><mo stretchy="false" id="alg2.l17.m1.3.4.3.2.1.1" xref="alg2.l17.m1.3.4.3.1.cmml">(</mo><mn id="alg2.l17.m1.2.2" xref="alg2.l17.m1.2.2.cmml">0</mn><mo id="alg2.l17.m1.3.4.3.2.1.2" xref="alg2.l17.m1.3.4.3.1.cmml">,</mo><mfrac id="alg2.l17.m1.3.3" xref="alg2.l17.m1.3.3.cmml"><mi mathvariant="normal" id="alg2.l17.m1.3.3.2" xref="alg2.l17.m1.3.3.2.cmml">Γ</mi><msup id="alg2.l17.m1.3.3.3" xref="alg2.l17.m1.3.3.3.cmml"><mn id="alg2.l17.m1.3.3.3.2" xref="alg2.l17.m1.3.3.3.2.cmml">2</mn><mi id="alg2.l17.m1.3.3.3.3" xref="alg2.l17.m1.3.3.3.3.cmml">s</mi></msup></mfrac><mo stretchy="false" id="alg2.l17.m1.3.4.3.2.1.3" xref="alg2.l17.m1.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.3b"><apply id="alg2.l17.m1.3.4.cmml" xref="alg2.l17.m1.3.4"><ci id="alg2.l17.m1.3.4.1.cmml" xref="alg2.l17.m1.3.4.1">←</ci><apply id="alg2.l17.m1.3.4.2.cmml" xref="alg2.l17.m1.3.4.2"><csymbol cd="ambiguous" id="alg2.l17.m1.3.4.2.1.cmml" xref="alg2.l17.m1.3.4.2">subscript</csymbol><ci id="alg2.l17.m1.3.4.2.2.cmml" xref="alg2.l17.m1.3.4.2.2">𝑟</ci><ci id="alg2.l17.m1.3.4.2.3.cmml" xref="alg2.l17.m1.3.4.2.3">𝑖</ci></apply><apply id="alg2.l17.m1.3.4.3.1.cmml" xref="alg2.l17.m1.3.4.3.2"><max id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"></max><cn type="integer" id="alg2.l17.m1.2.2.cmml" xref="alg2.l17.m1.2.2">0</cn><apply id="alg2.l17.m1.3.3.cmml" xref="alg2.l17.m1.3.3"><divide id="alg2.l17.m1.3.3.1.cmml" xref="alg2.l17.m1.3.3"></divide><ci id="alg2.l17.m1.3.3.2.cmml" xref="alg2.l17.m1.3.3.2">Γ</ci><apply id="alg2.l17.m1.3.3.3.cmml" xref="alg2.l17.m1.3.3.3"><csymbol cd="ambiguous" id="alg2.l17.m1.3.3.3.1.cmml" xref="alg2.l17.m1.3.3.3">superscript</csymbol><cn type="integer" id="alg2.l17.m1.3.3.3.2.cmml" xref="alg2.l17.m1.3.3.3.2">2</cn><ci id="alg2.l17.m1.3.3.3.3.cmml" xref="alg2.l17.m1.3.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.3c">r_{i}\leftarrow\max(0,\frac{\Gamma}{2^{s}})</annotation></semantics></math>

</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math id="alg2.l18.m1.2" class="ltx_Math" alttext="\mathcal{C}\leftarrow\mathcal{C}\bigcup\textsc{GetAllCandidates}(i+1,[r_{1\dots i}])" display="inline"><semantics id="alg2.l18.m1.2a"><mrow id="alg2.l18.m1.2.2" xref="alg2.l18.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l18.m1.2.2.4" xref="alg2.l18.m1.2.2.4.cmml">𝒞</mi><mo stretchy="false" id="alg2.l18.m1.2.2.3" xref="alg2.l18.m1.2.2.3.cmml">←</mo><mrow id="alg2.l18.m1.2.2.2" xref="alg2.l18.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l18.m1.2.2.2.4" xref="alg2.l18.m1.2.2.2.4.cmml">𝒞</mi><mo lspace="0em" rspace="0em" id="alg2.l18.m1.2.2.2.3" xref="alg2.l18.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l18.m1.2.2.2.2" xref="alg2.l18.m1.2.2.2.2.cmml"><mo id="alg2.l18.m1.2.2.2.2.3" xref="alg2.l18.m1.2.2.2.2.3.cmml">⋃</mo><mrow id="alg2.l18.m1.2.2.2.2.2" xref="alg2.l18.m1.2.2.2.2.2.cmml"><mtext class="ltx_font_smallcaps" id="alg2.l18.m1.2.2.2.2.2.4" xref="alg2.l18.m1.2.2.2.2.2.4a.cmml">GetAllCandidates</mtext><mo lspace="0em" rspace="0em" id="alg2.l18.m1.2.2.2.2.2.3" xref="alg2.l18.m1.2.2.2.2.2.3.cmml">​</mo><mrow id="alg2.l18.m1.2.2.2.2.2.2.2" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l18.m1.2.2.2.2.2.2.2.3" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml">(</mo><mrow id="alg2.l18.m1.1.1.1.1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l18.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg2.l18.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="alg2.l18.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg2.l18.m1.2.2.2.2.2.2.2.4" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml">,</mo><mrow id="alg2.l18.m1.2.2.2.2.2.2.2.2.1" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.2" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.2.1.cmml">[</mo><msub id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.cmml"><mi id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2.cmml">r</mi><mrow id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.cmml"><mn id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1a" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4.cmml">i</mi></mrow></msub><mo stretchy="false" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.3" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.2.1.cmml">]</mo></mrow><mo stretchy="false" id="alg2.l18.m1.2.2.2.2.2.2.2.5" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.2b"><apply id="alg2.l18.m1.2.2.cmml" xref="alg2.l18.m1.2.2"><ci id="alg2.l18.m1.2.2.3.cmml" xref="alg2.l18.m1.2.2.3">←</ci><ci id="alg2.l18.m1.2.2.4.cmml" xref="alg2.l18.m1.2.2.4">𝒞</ci><apply id="alg2.l18.m1.2.2.2.cmml" xref="alg2.l18.m1.2.2.2"><times id="alg2.l18.m1.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.3"></times><ci id="alg2.l18.m1.2.2.2.4.cmml" xref="alg2.l18.m1.2.2.2.4">𝒞</ci><apply id="alg2.l18.m1.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.2"><union id="alg2.l18.m1.2.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.2.3"></union><apply id="alg2.l18.m1.2.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.2.2"><times id="alg2.l18.m1.2.2.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.3"></times><ci id="alg2.l18.m1.2.2.2.2.2.4a.cmml" xref="alg2.l18.m1.2.2.2.2.2.4"><mtext class="ltx_font_smallcaps" id="alg2.l18.m1.2.2.2.2.2.4.cmml" xref="alg2.l18.m1.2.2.2.2.2.4">GetAllCandidates</mtext></ci><interval closure="open" id="alg2.l18.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2"><apply id="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1"><plus id="alg2.l18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="alg2.l18.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="alg2.l18.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1"><csymbol cd="latexml" id="alg2.l18.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2">𝑟</ci><apply id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3"><times id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1"></times><cn type="integer" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2">1</cn><ci id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3">…</ci><ci id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4">𝑖</ci></apply></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.2c">\mathcal{C}\leftarrow\mathcal{C}\bigcup\textsc{GetAllCandidates}(i+1,[r_{1\dots i}])</annotation></semantics></math>

</div>
<div id="alg2.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l19.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg2.l19.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l20.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg2.l20.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="alg2.l21.1" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l21.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="alg2.l21.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l21.m1.1.1" xref="alg2.l21.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.1b"><ci id="alg2.l21.m1.1.1.cmml" xref="alg2.l21.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.1c">\mathcal{C}</annotation></semantics></math>

</div>
<div id="alg2.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span><span id="alg2.l22.1" class="ltx_text ltx_font_bold">end</span>&nbsp;<span id="alg2.l22.2" class="ltx_text ltx_font_bold">procedure</span>
</div>
</div>
</figure>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Connections between Implicit Domain Aggregation and MLP</h2>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A3.p1.7">우리는 먼저 최종 혼합물 법칙(Eqn.<a class="ltx_ref" href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a>)을 반복한다. 여기서 편의상:</p>
<table id="A3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.Ex2.m1.2" class="ltx_Math" alttext="L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right]," display="block"><semantics id="A3.Ex2.m1.2a"><mrow id="A3.Ex2.m1.2.2.1" xref="A3.Ex2.m1.2.2.1.1.cmml"><mrow id="A3.Ex2.m1.2.2.1.1" xref="A3.Ex2.m1.2.2.1.1.cmml"><mrow id="A3.Ex2.m1.2.2.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.Ex2.m1.2.2.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex2.m1.2.2.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1a" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="A3.Ex2.m1.2.2.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A3.Ex2.m1.2.2.1.1.5" xref="A3.Ex2.m1.2.2.1.1.5.cmml">=</mo><mrow id="A3.Ex2.m1.2.2.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="A3.Ex2.m1.2.2.1.1.2.2.2.2" xref="A3.Ex2.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="A3.Ex2.m1.2.2.1.1.2.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.2.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.3.cmml">K</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.2.1" xref="A3.Ex2.m1.2.2.1.1.2.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.2.1.3" xref="A3.Ex2.m1.2.2.1.1.2.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.1.3.2" xref="A3.Ex2.m1.2.2.1.1.2.1.3.2.cmml">s</mi><mi id="A3.Ex2.m1.2.2.1.1.2.1.3.3" xref="A3.Ex2.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.2.1.2" xref="A3.Ex2.m1.2.2.1.1.2.1.2.cmml">​</mo><msub id="A3.Ex2.m1.2.2.1.1.2.1.4" xref="A3.Ex2.m1.2.2.1.1.2.1.4.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.1.4.2" xref="A3.Ex2.m1.2.2.1.1.2.1.4.2.cmml">L</mi><mi id="A3.Ex2.m1.2.2.1.1.2.1.4.3" xref="A3.Ex2.m1.2.2.1.1.2.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.2.1.2a" xref="A3.Ex2.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2.cmml">r</mi><mrow id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mn id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1a" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">​</mo><mi id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo stretchy="false" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="A3.Ex2.m1.2.2.1.1.6" xref="A3.Ex2.m1.2.2.1.1.6.cmml">=</mo><mrow id="A3.Ex2.m1.2.2.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.2.cmml"><mo movablelimits="false" id="A3.Ex2.m1.2.2.1.1.3.2.2.2" xref="A3.Ex2.m1.2.2.1.1.3.2.2.2.cmml">∑</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.2.2.3" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.2.cmml">i</mi><mo id="A3.Ex2.m1.2.2.1.1.3.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.3.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.3.2.3" xref="A3.Ex2.m1.2.2.1.1.3.2.3.cmml">K</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.3.1" xref="A3.Ex2.m1.2.2.1.1.3.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.3.2.cmml">s</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.3.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.2.cmml">​</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.2.1.cmml">[</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2.cmml">c</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2.cmml">+</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml">k</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mi id="A3.Ex2.m1.1.1" xref="A3.Ex2.m1.1.1.cmml">exp</mi><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1a" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.2" xref="A3.Ex2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex2.m1.2b"><apply id="A3.Ex2.m1.2.2.1.1.cmml" xref="A3.Ex2.m1.2.2.1"><and id="A3.Ex2.m1.2.2.1.1a.cmml" xref="A3.Ex2.m1.2.2.1"></and><apply id="A3.Ex2.m1.2.2.1.1b.cmml" xref="A3.Ex2.m1.2.2.1"><eq id="A3.Ex2.m1.2.2.1.1.5.cmml" xref="A3.Ex2.m1.2.2.1.1.5"></eq><apply id="A3.Ex2.m1.2.2.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1"><times id="A3.Ex2.m1.2.2.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.2"></times><ci id="A3.Ex2.m1.2.2.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.3">𝐿</ci><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3"><times id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1"></times><cn type="integer" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3">…</ci><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="A3.Ex2.m1.2.2.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2"><apply id="A3.Ex2.m1.2.2.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2">subscript</csymbol><sum id="A3.Ex2.m1.2.2.1.1.2.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.2"></sum><apply id="A3.Ex2.m1.2.2.1.1.2.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3"><eq id="A3.Ex2.m1.2.2.1.1.2.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.2.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.2">𝑖</ci><cn type="integer" id="A3.Ex2.m1.2.2.1.1.2.2.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.3">𝐾</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1"><times id="A3.Ex2.m1.2.2.1.1.2.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.2.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3.2">𝑠</ci><ci id="A3.Ex2.m1.2.2.1.1.2.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.1.4.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.1.4.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.1.4.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4.2">𝐿</ci><ci id="A3.Ex2.m1.2.2.1.1.2.1.4.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2">𝑟</ci><apply id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3"><times id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1"></times><cn type="integer" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2">1</cn><ci id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3">…</ci><ci id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4">𝑀</ci></apply></apply></apply></apply></apply><apply id="A3.Ex2.m1.2.2.1.1c.cmml" xref="A3.Ex2.m1.2.2.1"><eq id="A3.Ex2.m1.2.2.1.1.6.cmml" xref="A3.Ex2.m1.2.2.1.1.6"></eq><share href="#A3.Ex2.m1.2.2.1.1.2.cmml" id="A3.Ex2.m1.2.2.1.1d.cmml" xref="A3.Ex2.m1.2.2.1"></share><apply id="A3.Ex2.m1.2.2.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3"><apply id="A3.Ex2.m1.2.2.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.3.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2">subscript</csymbol><sum id="A3.Ex2.m1.2.2.1.1.3.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.2"></sum><apply id="A3.Ex2.m1.2.2.1.1.3.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3"><eq id="A3.Ex2.m1.2.2.1.1.3.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.3.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.2">𝑖</ci><cn type="integer" id="A3.Ex2.m1.2.2.1.1.3.2.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.3.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.3">𝐾</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1"><times id="A3.Ex2.m1.2.2.1.1.3.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.3.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3.2">𝑠</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1"><csymbol cd="latexml" id="A3.Ex2.m1.2.2.1.1.3.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.2">delimited-[]</csymbol><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1"><plus id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2"></plus><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2">𝑐</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1"><times id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2">𝑘</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1"><exp id="A3.Ex2.m1.1.1.cmml" xref="A3.Ex2.m1.1.1"></exp><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1"><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3"><eq id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2"><times id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3"><times id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex2.m1.2c">L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A3.p1.6" class="ltx_p">where <math id="A3.p1.1.m1.1" class="ltx_Math" alttext="r_{1\dots M}" display="inline"><semantics id="A3.p1.1.m1.1a"><msub id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml"><mi id="A3.p1.1.m1.1.1.2" xref="A3.p1.1.m1.1.1.2.cmml">r</mi><mrow id="A3.p1.1.m1.1.1.3" xref="A3.p1.1.m1.1.1.3.cmml"><mn id="A3.p1.1.m1.1.1.3.2" xref="A3.p1.1.m1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.p1.1.m1.1.1.3.1" xref="A3.p1.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="A3.p1.1.m1.1.1.3.3" xref="A3.p1.1.m1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="A3.p1.1.m1.1.1.3.1a" xref="A3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A3.p1.1.m1.1.1.3.4" xref="A3.p1.1.m1.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><apply id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p1.1.m1.1.1.1.cmml" xref="A3.p1.1.m1.1.1">subscript</csymbol><ci id="A3.p1.1.m1.1.1.2.cmml" xref="A3.p1.1.m1.1.1.2">𝑟</ci><apply id="A3.p1.1.m1.1.1.3.cmml" xref="A3.p1.1.m1.1.1.3"><times id="A3.p1.1.m1.1.1.3.1.cmml" xref="A3.p1.1.m1.1.1.3.1"></times><cn type="integer" id="A3.p1.1.m1.1.1.3.2.cmml" xref="A3.p1.1.m1.1.1.3.2">1</cn><ci id="A3.p1.1.m1.1.1.3.3.cmml" xref="A3.p1.1.m1.1.1.3.3">…</ci><ci id="A3.p1.1.m1.1.1.3.4.cmml" xref="A3.p1.1.m1.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">r_{1\dots M}</annotation></semantics></math> are mixture proportions on <math id="A3.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A3.p1.2.m2.1a"><mi id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><ci id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">M</annotation></semantics></math> training domains, <math id="A3.p1.3.m3.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="A3.p1.3.m3.1a"><msub id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml"><mi id="A3.p1.3.m3.1.1.2" xref="A3.p1.3.m3.1.1.2.cmml">L</mi><mi id="A3.p1.3.m3.1.1.3" xref="A3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><apply id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A3.p1.3.m3.1.1.1.cmml" xref="A3.p1.3.m3.1.1">subscript</csymbol><ci id="A3.p1.3.m3.1.1.2.cmml" xref="A3.p1.3.m3.1.1.2">𝐿</ci><ci id="A3.p1.3.m3.1.1.3.cmml" xref="A3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">L_{i}</annotation></semantics></math> are validation loss on <math id="A3.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.p1.4.m4.1a"><mi id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.1b"><ci id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.1c">K</annotation></semantics></math> implicit domains with <math id="A3.p1.5.m5.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="A3.p1.5.m5.1a"><msub id="A3.p1.5.m5.1.1" xref="A3.p1.5.m5.1.1.cmml"><mi id="A3.p1.5.m5.1.1.2" xref="A3.p1.5.m5.1.1.2.cmml">s</mi><mi id="A3.p1.5.m5.1.1.3" xref="A3.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.5.m5.1b"><apply id="A3.p1.5.m5.1.1.cmml" xref="A3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A3.p1.5.m5.1.1.1.cmml" xref="A3.p1.5.m5.1.1">subscript</csymbol><ci id="A3.p1.5.m5.1.1.2.cmml" xref="A3.p1.5.m5.1.1.2">𝑠</ci><ci id="A3.p1.5.m5.1.1.3.cmml" xref="A3.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m5.1c">s_{i}</annotation></semantics></math> as their weight in the overall validation set, and <math id="A3.p1.6.m6.2" class="ltx_Math" alttext="c_{i},t_{ij}" display="inline"><semantics id="A3.p1.6.m6.2a"><mrow id="A3.p1.6.m6.2.2.2" xref="A3.p1.6.m6.2.2.3.cmml"><msub id="A3.p1.6.m6.1.1.1.1" xref="A3.p1.6.m6.1.1.1.1.cmml"><mi id="A3.p1.6.m6.1.1.1.1.2" xref="A3.p1.6.m6.1.1.1.1.2.cmml">c</mi><mi id="A3.p1.6.m6.1.1.1.1.3" xref="A3.p1.6.m6.1.1.1.1.3.cmml">i</mi></msub><mo id="A3.p1.6.m6.2.2.2.3" xref="A3.p1.6.m6.2.2.3.cmml">,</mo><msub id="A3.p1.6.m6.2.2.2.2" xref="A3.p1.6.m6.2.2.2.2.cmml"><mi id="A3.p1.6.m6.2.2.2.2.2" xref="A3.p1.6.m6.2.2.2.2.2.cmml">t</mi><mrow id="A3.p1.6.m6.2.2.2.2.3" xref="A3.p1.6.m6.2.2.2.2.3.cmml"><mi id="A3.p1.6.m6.2.2.2.2.3.2" xref="A3.p1.6.m6.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A3.p1.6.m6.2.2.2.2.3.1" xref="A3.p1.6.m6.2.2.2.2.3.1.cmml">​</mo><mi id="A3.p1.6.m6.2.2.2.2.3.3" xref="A3.p1.6.m6.2.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.6.m6.2b"><list id="A3.p1.6.m6.2.2.3.cmml" xref="A3.p1.6.m6.2.2.2"><apply id="A3.p1.6.m6.1.1.1.1.cmml" xref="A3.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="A3.p1.6.m6.1.1.1.1.1.cmml" xref="A3.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="A3.p1.6.m6.1.1.1.1.2.cmml" xref="A3.p1.6.m6.1.1.1.1.2">𝑐</ci><ci id="A3.p1.6.m6.1.1.1.1.3.cmml" xref="A3.p1.6.m6.1.1.1.1.3">𝑖</ci></apply><apply id="A3.p1.6.m6.2.2.2.2.cmml" xref="A3.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="A3.p1.6.m6.2.2.2.2.1.cmml" xref="A3.p1.6.m6.2.2.2.2">subscript</csymbol><ci id="A3.p1.6.m6.2.2.2.2.2.cmml" xref="A3.p1.6.m6.2.2.2.2.2">𝑡</ci><apply id="A3.p1.6.m6.2.2.2.2.3.cmml" xref="A3.p1.6.m6.2.2.2.2.3"><times id="A3.p1.6.m6.2.2.2.2.3.1.cmml" xref="A3.p1.6.m6.2.2.2.2.3.1"></times><ci id="A3.p1.6.m6.2.2.2.2.3.2.cmml" xref="A3.p1.6.m6.2.2.2.2.3.2">𝑖</ci><ci id="A3.p1.6.m6.2.2.2.2.3.3.cmml" xref="A3.p1.6.m6.2.2.2.2.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m6.2c">c_{i},t_{ij}</annotation></semantics></math> are other parameters to fit.</p>
</div>
<figure id="A3.F10" class="ltx_figure ltx_align_floatright"><img src="https://ar5iv.labs.arxiv.org/html/2403.16952/assets/figs/computation_graph.png" id="A3.F10.g1" class="ltx_graphics ltx_img_landscape" width="598" height="271" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 10:</span>The computation graph of mixture law with implicit domain aggregation. 학습 도메인 3개와 암묵적 검증 도메인 4개를 예로 들어 설명한다.</figcaption>
The parameters correspond to the notations in Eqn.&nbsp;<a href="#S3.E8" title="In Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.
</figcaption>
</figure>
<div id="A3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A3.p2.1">혼합 법칙은 그림의 계산 그래프로 요약된다. <a class="ltx_ref" href="#A3.F10" title="Figure 10 ‣ Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">10</span></a>는 두 개의 레이어를 포함하고 있다. 첫 번째 계층은 도메인 손실을 예측하는 반면 두 번째 계층은 도메인 손실을 합산하여 전체 검증 손실을 얻는다. 이와 같이 혼합법칙은 지수활성함수를 갖는 다층지각(MLP)이 된다. 실제로, 우리는 지수 활성화와 함께 다층 인식을 피팅하고 출력 레이어 가중치에 소프트맥스를 적용하여 음함수 도메인 집계를 갖는 혼합 법칙을 피팅한다. 또한 MLP의 높은 분산을 고려하여 AdaBoost Regressor <cite class="ltx_cite ltx_citemacro_citep">(Drucker, <a class="ltx_ref" href="#bib.bib16" title="">1997</a>)</cite>를 사용하여 혼합물 법칙을 피팅하여 예측을 안정화하고 정확도를 개선한다.</p>
</div>
<div id="A3.p3" class="ltx_para ltx_noindent">
<p class="ltx_p" id="A3.p3.1">이러한 관점에서 영감을 받아 혼합물 법칙의 성공적인 적합을 두 가지 측면으로 돌린다. 첫째, 은닉 차원이 충분히 큰 MLP는 손실과 혼합물 비율 사이의 관계를 맞출 수 있는 보편적인 근사자<cite class="ltx_cite ltx_citemacro_citep">(Hornik et al., <a class="ltx_ref" href="#bib.bib34" title="">1989</a>)</cite>이다. 둘째, 혼합물 비율은 0과 1 사이에서 경계된다. 이러한 이유로, 보이지 않는 혼합물을 예측하는 것은 보간 문제이며, 이는 보통 외삽보다 쉽다.</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="https://ar5iv.labs.arxiv.org/html/2403.16951" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="https://ar5iv.labs.arxiv.org/"><img height="40" alt="ar5iv homepage" src="https://ar5iv.labs.arxiv.org/assets/ar5iv.png"></a>
    <a href="https://ar5iv.labs.arxiv.org/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="https://ar5iv.labs.arxiv.org/log/2403.16952" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+2403.16952">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.16952" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="https://ar5iv.labs.arxiv.org/html/2403.16953" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 16:51:13 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>