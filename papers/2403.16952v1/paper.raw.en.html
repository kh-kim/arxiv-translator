<html lang="en" data-theme="light"><head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance</title>
<!--Generated on Mon Mar 25 17:05:51 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css">
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2403.16952v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2403.16952v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
        <span class="color-scheme-icon" aria-label="Light mode"></span>
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="#myForm" onclick="event.preventDefault(); var modal = document.getElementById('myForm'); modal.style.display = 'block'; bugReportState.setInitiateWay('Header');">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2403.16952v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2403.16952v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
          <span class="color-scheme-icon"></span>
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S1" title="1 Introduction ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S2" title="2 Background ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S2.SS0.SSS0.Px1" title="Pretraining large language models. ‣ 2 Background ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Pretraining large language models.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S2.SS0.SSS0.Px2" title="Scaling laws. ‣ 2 Background ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Scaling laws.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S2.SS0.SSS0.Px3" title="Problem formalization. ‣ 2 Background ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Problem formalization.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3" title="3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>The proportions of data mixtures influence model losses in a quantitatively predictable way</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Pilot Study on Domain Losses under Two-domain Mixtures</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS1.SSS0.Px1" title="Setups ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Setups</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS1.SSS0.Px2" title="Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Findings</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Extension to Domain Losses Trained on Multi-domain Mixtures</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS2.SSS0.Px1" title="Setups ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Setups</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS2.SSS0.Px2" title="Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Findings</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS3" title="3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Predicting Losses of Any Validation Mixture</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS3.SSS0.Px1" title="Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Explicit domain aggregation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS3.SSS0.Px2" title="Implicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Implicit domain aggregation.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S4" title="4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Nested scaling laws predict losses trained on various mixtures using only small-scale experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S4.SS1" title="4.1 A Pipeline for Loss Predictions ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>A Pipeline for Loss Predictions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S4.SS2" title="4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S4.SS2.SSS0.Px1" title="Setups. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Setups.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S4.SS2.SSS0.Px2" title="Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S5" title="5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S6" title="6 Related Work ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S6.SS0.SSS0.Px1" title="Curating pretraining data for LLMs. ‣ 6 Related Work ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Curating pretraining data for LLMs.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S6.SS0.SSS0.Px2" title="Scaling laws ‣ 6 Related Work ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">Scaling laws</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S7" title="7 Discussions ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Discussions</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S7.SS0.SSS0.Px1" title="On the clarification of domains. ‣ 7 Discussions ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">On the clarification of domains.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S7.SS0.SSS0.Px2" title="On the error analyses. ‣ 7 Discussions ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">On the error analyses.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S7.SS0.SSS0.Px3" title="On joint laws of multiple factors. ‣ 7 Discussions ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">On joint laws of multiple factors.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S7.SS0.SSS0.Px4" title="On dynamic data curating. ‣ 7 Discussions ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">On dynamic data curating.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S7.SS0.SSS0.Px5" title="On theoretical understandings. ‣ 7 Discussions ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title">On theoretical understandings.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A1" title="Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>The relative qualities of data mixtures relate to model sizes and training steps.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A2" title="Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A2.SS1" title="B.1 Model Training ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Model Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A2.SS2" title="B.2 Fitting Mixture Laws ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Fitting Mixture Laws</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A3" title="Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Connections between Implicit Domain Aggregation and MLP</span></a></li>
</ol></nav>

<div class="ltx_page_content"><div class="section" id="target-section"><div id="license-tr">License: CC BY-NC-SA 4.0</div><div id="watermark-tr">arXiv:2403.16952v1 [cs.CL] 25 Mar 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jiasheng Ye<math alttext="{}^{1,}" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi id="id1.1.m1.1.1a" xref="id1.1.m1.1.1.cmml"></mi><mrow id="id1.1.m1.1.1.1.3" xref="id1.1.m1.1.1.1.2.cmml"><mn id="id1.1.m1.1.1.1.1" xref="id1.1.m1.1.1.1.1.cmml">1</mn><mo id="id1.1.m1.1.1.1.3.1" xref="id1.1.m1.1.1.1.2.cmml">,</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><list id="id1.1.m1.1.1.1.2.cmml" xref="id1.1.m1.1.1.1.3"><cn id="id1.1.m1.1.1.1.1.cmml" type="integer" xref="id1.1.m1.1.1.1.1">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">{}^{1,}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">start_FLOATSUPERSCRIPT 1 , end_FLOATSUPERSCRIPT</annotation></semantics></math>  
Peiju Liu<math alttext="{}^{1,}" class="ltx_Math" display="inline" id="id2.2.m2.1"><semantics id="id2.2.m2.1a"><msup id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml"><mi id="id2.2.m2.1.1a" xref="id2.2.m2.1.1.cmml"></mi><mrow id="id2.2.m2.1.1.1.3" xref="id2.2.m2.1.1.1.2.cmml"><mn id="id2.2.m2.1.1.1.1" xref="id2.2.m2.1.1.1.1.cmml">1</mn><mo id="id2.2.m2.1.1.1.3.1" xref="id2.2.m2.1.1.1.2.cmml">,</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><apply id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1"><list id="id2.2.m2.1.1.1.2.cmml" xref="id2.2.m2.1.1.1.3"><cn id="id2.2.m2.1.1.1.1.cmml" type="integer" xref="id2.2.m2.1.1.1.1">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">{}^{1,}</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.1d">start_FLOATSUPERSCRIPT 1 , end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotemark: </span></span></span></span>  
Tianxiang Sun<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id3.3.m3.1"><semantics id="id3.3.m3.1a"><msup id="id3.3.m3.1.1" xref="id3.3.m3.1.1.cmml"><mi id="id3.3.m3.1.1a" xref="id3.3.m3.1.1.cmml"></mi><mn id="id3.3.m3.1.1.1" xref="id3.3.m3.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id3.3.m3.1b"><apply id="id3.3.m3.1.1.cmml" xref="id3.3.m3.1.1"><cn id="id3.3.m3.1.1.1.cmml" type="integer" xref="id3.3.m3.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id3.3.m3.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>  
Yunhua Zhou<math alttext="{}^{2}" class="ltx_Math" display="inline" id="id4.4.m4.1"><semantics id="id4.4.m4.1a"><msup id="id4.4.m4.1.1" xref="id4.4.m4.1.1.cmml"><mi id="id4.4.m4.1.1a" xref="id4.4.m4.1.1.cmml"></mi><mn id="id4.4.m4.1.1.1" xref="id4.4.m4.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id4.4.m4.1b"><apply id="id4.4.m4.1.1.cmml" xref="id4.4.m4.1.1"><cn id="id4.4.m4.1.1.1.cmml" type="integer" xref="id4.4.m4.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.4.m4.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id4.4.m4.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>  
Jun Zhan<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id5.5.m5.1"><semantics id="id5.5.m5.1a"><msup id="id5.5.m5.1.1" xref="id5.5.m5.1.1.cmml"><mi id="id5.5.m5.1.1a" xref="id5.5.m5.1.1.cmml"></mi><mn id="id5.5.m5.1.1.1" xref="id5.5.m5.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id5.5.m5.1b"><apply id="id5.5.m5.1.1.cmml" xref="id5.5.m5.1.1"><cn id="id5.5.m5.1.1.1.cmml" type="integer" xref="id5.5.m5.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.5.m5.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id5.5.m5.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math> 
Xipeng Qiu<math alttext="{}^{1,}" class="ltx_Math" display="inline" id="id6.6.m6.1"><semantics id="id6.6.m6.1a"><msup id="id6.6.m6.1.1" xref="id6.6.m6.1.1.cmml"><mi id="id6.6.m6.1.1a" xref="id6.6.m6.1.1.cmml"></mi><mrow id="id6.6.m6.1.1.1.3" xref="id6.6.m6.1.1.1.2.cmml"><mn id="id6.6.m6.1.1.1.1" xref="id6.6.m6.1.1.1.1.cmml">1</mn><mo id="id6.6.m6.1.1.1.3.1" xref="id6.6.m6.1.1.1.2.cmml">,</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id6.6.m6.1b"><apply id="id6.6.m6.1.1.cmml" xref="id6.6.m6.1.1"><list id="id6.6.m6.1.1.1.2.cmml" xref="id6.6.m6.1.1.1.3"><cn id="id6.6.m6.1.1.1.1.cmml" type="integer" xref="id6.6.m6.1.1.1.1">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.6.m6.1c">{}^{1,}</annotation><annotation encoding="application/x-llamapun" id="id6.6.m6.1d">start_FLOATSUPERSCRIPT 1 , end_FLOATSUPERSCRIPT</annotation></semantics></math>
<br class="ltx_break">
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id9.9.id1">{jsye23,pjliu23}@m.fudan.edu.cn</span>&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_typewriter" id="id10.10.id2">zhouyunhua@pjlab.org.cn</span>&nbsp;&nbsp;
<span class="ltx_text ltx_font_typewriter" id="id11.11.id3">xpqiu@fudan.edu.cn
<br class="ltx_break"></span>
<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id7.7.m7.1"><semantics id="id7.7.m7.1a"><msup id="id7.7.m7.1.1" xref="id7.7.m7.1.1.cmml"><mi id="id7.7.m7.1.1a" xref="id7.7.m7.1.1.cmml"></mi><mn id="id7.7.m7.1.1.1" xref="id7.7.m7.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id7.7.m7.1b"><apply id="id7.7.m7.1.1.cmml" xref="id7.7.m7.1.1"><cn id="id7.7.m7.1.1.1.cmml" type="integer" xref="id7.7.m7.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.7.m7.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id7.7.m7.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>Fudan University&nbsp;&nbsp;<math alttext="{}^{2}" class="ltx_Math" display="inline" id="id8.8.m8.1"><semantics id="id8.8.m8.1a"><msup id="id8.8.m8.1.1" xref="id8.8.m8.1.1.cmml"><mi id="id8.8.m8.1.1a" xref="id8.8.m8.1.1.cmml"></mi><mn id="id8.8.m8.1.1.1" xref="id8.8.m8.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id8.8.m8.1b"><apply id="id8.8.m8.1.1.cmml" xref="id8.8.m8.1.1"><cn id="id8.8.m8.1.1.1.cmml" type="integer" xref="id8.8.m8.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.8.m8.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id8.8.m8.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>Shanghai AI Laboratory
</span><span class="ltx_author_notes">Equal contribution.Corresponding author.</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id12.id1">Pretraining data of large language models composes multiple domains (e.g., web texts, academic papers, codes), whose mixture proportions crucially impact the competence of outcome models.
While existing endeavors rely on heuristics or qualitative strategies to tune the proportions,
we discover the quantitative predictability of model performance regarding the mixture proportions in function forms, which we refer to as the <span class="ltx_text ltx_font_italic" id="id12.id1.1">data mixing laws</span>.
Fitting such functions on sample mixtures unveils model performance on unseen mixtures before actual runs, thus guiding the selection of an ideal data mixture. Furthermore, we propose nested use of the scaling laws of training steps, model sizes, and our data mixing law to enable predicting the performance of large models trained on massive data under various mixtures with only small-scale training.
Moreover, experimental results verify that our method effectively optimizes the training mixture of a 1B model trained for 100B tokens in RedPajama, reaching a performance comparable to the one trained for 48% more steps on the default mixture.
Extending the application of data mixing laws to continual training accurately predicts the critical mixture proportion that avoids catastrophic forgetting and outlooks the potential for dynamic data schedules.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Codes and data are available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/yegcjs/mixinglaws" title="">https://github.com/yegcjs/mixinglaws</a>.</span></span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Pretraining data for large language models (LLMs) are typically a mixture of multiple domains, varying from English to minority languages&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Doddapaneni et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib14" title="">2021</a>; Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib40" title="">2023</a>)</cite>, from casual dialogs to formal academic writings&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Taylor et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib55" title="">2022</a>)</cite>, and from texts to modalities like images and speeches&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib66" title="">2024</a>)</cite>, among others.
These data interplay with each other, showing complex interchangeable, unrelated, or contradictory relationships&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib24" title="">2024</a>)</cite>.
This necessitates adjusting the mixture proportions of training data to balance the model capabilities while harnessing synergies across domains, thus enhancing the competence of the outcome models, as highlighted by extensive practical experience&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib22" title="">2020</a>; Gururangan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib25" title="">2020</a>; Zhou et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib68" title="">2023</a>; Xie et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib63" title="">2024a</a>)</cite>.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Nonetheless, it remains elusive to figure out an ideal training data mixture.
Most existing practices tune the mixture through heuristics to upsample a proportion of high-quality or underrepresented data without disclosing the concrete criteria in detail&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib22" title="">2020</a>; Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib56" title="">2023a</a>; Bai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib6" title="">2023</a>; Bi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib7" title="">2024</a>)</cite> and it is hard to predate whether these data strategies are effective before finishing the training run. Encouraged by advances in scaling laws that show model losses on a given set of evaluation data are quantitatively predictable for a wide range of variables&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib37" title="">2020</a>; Hoffmann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib33" title="">2022</a>)</cite>, we wonder whether this also holds for mixture proportions,
so that <span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p2.1.1">we can estimate the outcome model performance given any mixture before actually training on them, including the desired one that reaches minimum loss.</span>
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this paper, we answer this proposition affirmatively.
We find that, given a mixture of <math alttext="M" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_M</annotation></semantics></math> domains, an exponential function over the linear combination of the proportions, i.e.,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S1.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)}," class="ltx_Math" display="block" id="S1.E1.m1.2"><semantics id="S1.E1.m1.2a"><mrow id="S1.E1.m1.2.2.1" xref="S1.E1.m1.2.2.1.1.cmml"><mrow id="S1.E1.m1.2.2.1.1" xref="S1.E1.m1.2.2.1.1.cmml"><mrow id="S1.E1.m1.2.2.1.1.1" xref="S1.E1.m1.2.2.1.1.1.cmml"><msub id="S1.E1.m1.2.2.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.3.cmml"><mi id="S1.E1.m1.2.2.1.1.1.3.2" xref="S1.E1.m1.2.2.1.1.1.3.2.cmml">L</mi><mi id="S1.E1.m1.2.2.1.1.1.3.3" xref="S1.E1.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="S1.E1.m1.2.2.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S1.E1.m1.2.2.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S1.E1.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S1.E1.m1.2.2.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mrow id="S1.E1.m1.2.2.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="S1.E1.m1.2.2.1.1.1.1.1.1.3.2" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S1.E1.m1.2.2.1.1.1.1.1.1.3.1" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml">…</mi><mo id="S1.E1.m1.2.2.1.1.1.1.1.1.3.1a" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S1.E1.m1.2.2.1.1.1.1.1.1.3.4" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo id="S1.E1.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S1.E1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.E1.m1.2.2.1.1.3" xref="S1.E1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S1.E1.m1.2.2.1.1.2" xref="S1.E1.m1.2.2.1.1.2.cmml"><msub id="S1.E1.m1.2.2.1.1.2.3" xref="S1.E1.m1.2.2.1.1.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.3.2" xref="S1.E1.m1.2.2.1.1.2.3.2.cmml">c</mi><mi id="S1.E1.m1.2.2.1.1.2.3.3" xref="S1.E1.m1.2.2.1.1.2.3.3.cmml">i</mi></msub><mo id="S1.E1.m1.2.2.1.1.2.2" xref="S1.E1.m1.2.2.1.1.2.2.cmml">+</mo><mrow id="S1.E1.m1.2.2.1.1.2.1" xref="S1.E1.m1.2.2.1.1.2.1.cmml"><msub id="S1.E1.m1.2.2.1.1.2.1.3" xref="S1.E1.m1.2.2.1.1.2.1.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.3.2" xref="S1.E1.m1.2.2.1.1.2.1.3.2.cmml">k</mi><mi id="S1.E1.m1.2.2.1.1.2.1.3.3" xref="S1.E1.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo id="S1.E1.m1.2.2.1.1.2.1.2" lspace="0.167em" xref="S1.E1.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml"><mi id="S1.E1.m1.1.1" xref="S1.E1.m1.1.1.cmml">exp</mi><mo id="S1.E1.m1.2.2.1.1.2.1.1.1a" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml">⁡</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml"><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml">(</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.cmml"><munderover id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.cmml"><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><msub id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml"><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S1.E1.m1.2.2.1.1.2.1.1.1.1.3" xref="S1.E1.m1.2.2.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S1.E1.m1.2.2.1.2" xref="S1.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.2b"><apply id="S1.E1.m1.2.2.1.1.cmml" xref="S1.E1.m1.2.2.1"><eq id="S1.E1.m1.2.2.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.3"></eq><apply id="S1.E1.m1.2.2.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1"><times id="S1.E1.m1.2.2.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.2"></times><apply id="S1.E1.m1.2.2.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.1.3.2">𝐿</ci><ci id="S1.E1.m1.2.2.1.1.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><apply id="S1.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3"><times id="S1.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.1"></times><cn id="S1.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.3">…</ci><ci id="S1.E1.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S1.E1.m1.2.2.1.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="S1.E1.m1.2.2.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2"><plus id="S1.E1.m1.2.2.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.2"></plus><apply id="S1.E1.m1.2.2.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.3.2">𝑐</ci><ci id="S1.E1.m1.2.2.1.1.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.3.3">𝑖</ci></apply><apply id="S1.E1.m1.2.2.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1"><times id="S1.E1.m1.2.2.1.1.2.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.2"></times><apply id="S1.E1.m1.2.2.1.1.2.1.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.1.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3.2">𝑘</ci><ci id="S1.E1.m1.2.2.1.1.2.1.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S1.E1.m1.2.2.1.1.2.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1"><exp id="S1.E1.m1.1.1.cmml" xref="S1.E1.m1.1.1"></exp><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1"><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1">subscript</csymbol><sum id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.2"></sum><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3"><eq id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.1"></eq><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2"><times id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.1"></times><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3"><times id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.1"></times><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.1.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml" xref="S1.E1.m1.2.2.1.1.2.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.2c">L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)},</annotation><annotation encoding="application/x-llamapun" id="S1.E1.m1.2d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT 1 … italic_M end_POSTSUBSCRIPT ) = italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S1.p3.6">can predict the validation loss <math alttext="L_{i}" class="ltx_Math" display="inline" id="S1.p3.2.m1.1"><semantics id="S1.p3.2.m1.1a"><msub id="S1.p3.2.m1.1.1" xref="S1.p3.2.m1.1.1.cmml"><mi id="S1.p3.2.m1.1.1.2" xref="S1.p3.2.m1.1.1.2.cmml">L</mi><mi id="S1.p3.2.m1.1.1.3" xref="S1.p3.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.2.m1.1b"><apply id="S1.p3.2.m1.1.1.cmml" xref="S1.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m1.1.1.1.cmml" xref="S1.p3.2.m1.1.1">subscript</csymbol><ci id="S1.p3.2.m1.1.1.2.cmml" xref="S1.p3.2.m1.1.1.2">𝐿</ci><ci id="S1.p3.2.m1.1.1.3.cmml" xref="S1.p3.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m1.1c">L_{i}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m1.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> on any of the training domains <math alttext="i" class="ltx_Math" display="inline" id="S1.p3.3.m2.1"><semantics id="S1.p3.3.m2.1a"><mi id="S1.p3.3.m2.1.1" xref="S1.p3.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.p3.3.m2.1b"><ci id="S1.p3.3.m2.1.1.cmml" xref="S1.p3.3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m2.1d">italic_i</annotation></semantics></math> accurately under a fixed model size and amount of training data, where <math alttext="r_{1\dots M}" class="ltx_Math" display="inline" id="S1.p3.4.m3.1"><semantics id="S1.p3.4.m3.1a"><msub id="S1.p3.4.m3.1.1" xref="S1.p3.4.m3.1.1.cmml"><mi id="S1.p3.4.m3.1.1.2" xref="S1.p3.4.m3.1.1.2.cmml">r</mi><mrow id="S1.p3.4.m3.1.1.3" xref="S1.p3.4.m3.1.1.3.cmml"><mn id="S1.p3.4.m3.1.1.3.2" xref="S1.p3.4.m3.1.1.3.2.cmml">1</mn><mo id="S1.p3.4.m3.1.1.3.1" xref="S1.p3.4.m3.1.1.3.1.cmml">⁢</mo><mi id="S1.p3.4.m3.1.1.3.3" mathvariant="normal" xref="S1.p3.4.m3.1.1.3.3.cmml">…</mi><mo id="S1.p3.4.m3.1.1.3.1a" xref="S1.p3.4.m3.1.1.3.1.cmml">⁢</mo><mi id="S1.p3.4.m3.1.1.3.4" xref="S1.p3.4.m3.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p3.4.m3.1b"><apply id="S1.p3.4.m3.1.1.cmml" xref="S1.p3.4.m3.1.1"><csymbol cd="ambiguous" id="S1.p3.4.m3.1.1.1.cmml" xref="S1.p3.4.m3.1.1">subscript</csymbol><ci id="S1.p3.4.m3.1.1.2.cmml" xref="S1.p3.4.m3.1.1.2">𝑟</ci><apply id="S1.p3.4.m3.1.1.3.cmml" xref="S1.p3.4.m3.1.1.3"><times id="S1.p3.4.m3.1.1.3.1.cmml" xref="S1.p3.4.m3.1.1.3.1"></times><cn id="S1.p3.4.m3.1.1.3.2.cmml" type="integer" xref="S1.p3.4.m3.1.1.3.2">1</cn><ci id="S1.p3.4.m3.1.1.3.3.cmml" xref="S1.p3.4.m3.1.1.3.3">…</ci><ci id="S1.p3.4.m3.1.1.3.4.cmml" xref="S1.p3.4.m3.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m3.1c">r_{1\dots M}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m3.1d">italic_r start_POSTSUBSCRIPT 1 … italic_M end_POSTSUBSCRIPT</annotation></semantics></math> are the proportions of the <math alttext="M" class="ltx_Math" display="inline" id="S1.p3.5.m4.1"><semantics id="S1.p3.5.m4.1a"><mi id="S1.p3.5.m4.1.1" xref="S1.p3.5.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p3.5.m4.1b"><ci id="S1.p3.5.m4.1.1.cmml" xref="S1.p3.5.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.m4.1d">italic_M</annotation></semantics></math> domains and <math alttext="c_{i},k_{i},t_{ij}" class="ltx_Math" display="inline" id="S1.p3.6.m5.3"><semantics id="S1.p3.6.m5.3a"><mrow id="S1.p3.6.m5.3.3.3" xref="S1.p3.6.m5.3.3.4.cmml"><msub id="S1.p3.6.m5.1.1.1.1" xref="S1.p3.6.m5.1.1.1.1.cmml"><mi id="S1.p3.6.m5.1.1.1.1.2" xref="S1.p3.6.m5.1.1.1.1.2.cmml">c</mi><mi id="S1.p3.6.m5.1.1.1.1.3" xref="S1.p3.6.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="S1.p3.6.m5.3.3.3.4" xref="S1.p3.6.m5.3.3.4.cmml">,</mo><msub id="S1.p3.6.m5.2.2.2.2" xref="S1.p3.6.m5.2.2.2.2.cmml"><mi id="S1.p3.6.m5.2.2.2.2.2" xref="S1.p3.6.m5.2.2.2.2.2.cmml">k</mi><mi id="S1.p3.6.m5.2.2.2.2.3" xref="S1.p3.6.m5.2.2.2.2.3.cmml">i</mi></msub><mo id="S1.p3.6.m5.3.3.3.5" xref="S1.p3.6.m5.3.3.4.cmml">,</mo><msub id="S1.p3.6.m5.3.3.3.3" xref="S1.p3.6.m5.3.3.3.3.cmml"><mi id="S1.p3.6.m5.3.3.3.3.2" xref="S1.p3.6.m5.3.3.3.3.2.cmml">t</mi><mrow id="S1.p3.6.m5.3.3.3.3.3" xref="S1.p3.6.m5.3.3.3.3.3.cmml"><mi id="S1.p3.6.m5.3.3.3.3.3.2" xref="S1.p3.6.m5.3.3.3.3.3.2.cmml">i</mi><mo id="S1.p3.6.m5.3.3.3.3.3.1" xref="S1.p3.6.m5.3.3.3.3.3.1.cmml">⁢</mo><mi id="S1.p3.6.m5.3.3.3.3.3.3" xref="S1.p3.6.m5.3.3.3.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.6.m5.3b"><list id="S1.p3.6.m5.3.3.4.cmml" xref="S1.p3.6.m5.3.3.3"><apply id="S1.p3.6.m5.1.1.1.1.cmml" xref="S1.p3.6.m5.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.6.m5.1.1.1.1.1.cmml" xref="S1.p3.6.m5.1.1.1.1">subscript</csymbol><ci id="S1.p3.6.m5.1.1.1.1.2.cmml" xref="S1.p3.6.m5.1.1.1.1.2">𝑐</ci><ci id="S1.p3.6.m5.1.1.1.1.3.cmml" xref="S1.p3.6.m5.1.1.1.1.3">𝑖</ci></apply><apply id="S1.p3.6.m5.2.2.2.2.cmml" xref="S1.p3.6.m5.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.6.m5.2.2.2.2.1.cmml" xref="S1.p3.6.m5.2.2.2.2">subscript</csymbol><ci id="S1.p3.6.m5.2.2.2.2.2.cmml" xref="S1.p3.6.m5.2.2.2.2.2">𝑘</ci><ci id="S1.p3.6.m5.2.2.2.2.3.cmml" xref="S1.p3.6.m5.2.2.2.2.3">𝑖</ci></apply><apply id="S1.p3.6.m5.3.3.3.3.cmml" xref="S1.p3.6.m5.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.6.m5.3.3.3.3.1.cmml" xref="S1.p3.6.m5.3.3.3.3">subscript</csymbol><ci id="S1.p3.6.m5.3.3.3.3.2.cmml" xref="S1.p3.6.m5.3.3.3.3.2">𝑡</ci><apply id="S1.p3.6.m5.3.3.3.3.3.cmml" xref="S1.p3.6.m5.3.3.3.3.3"><times id="S1.p3.6.m5.3.3.3.3.3.1.cmml" xref="S1.p3.6.m5.3.3.3.3.3.1"></times><ci id="S1.p3.6.m5.3.3.3.3.3.2.cmml" xref="S1.p3.6.m5.3.3.3.3.3.2">𝑖</ci><ci id="S1.p3.6.m5.3.3.3.3.3.3.cmml" xref="S1.p3.6.m5.3.3.3.3.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m5.3c">c_{i},k_{i},t_{ij}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.6.m5.3d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are parameters to fit.
Fitting such functions on all the evaluated domains and calculating the weighted sum according to their proportions in the validation data leads to the prediction of final validation loss.
Further, treating the validation proportions as learnable parameters allows fitting the estimated losses on a validation set end-to-end without explicitly decomposing it into known domains.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Despite the predictability, fitting the function between mixture proportions and validation loss, or the <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">data mixing laws</span> for simplicity, requires samples of numerous runs with different mixtures.
Running these experiments with the same model size and the amount of training data as the target model is unreasonably expensive.
Fortunately, fruitful research on scaling laws demonstrates impressive results that
fitting power laws with small models and small data effectively predicts the losses on larger models and data over orders of magnitudes&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib37" title="">2020</a>; Henighan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib30" title="">2020</a>; Hoffmann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib33" title="">2022</a>; Alabdulmohsin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib2" title="">2022</a>; OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib48" title="">2023</a>; Muennighoff et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib47" title="">2024</a>; Bi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib7" title="">2024</a>)</cite>.
On this basis, we propose a pipeline to nested utilize the scaling laws of training steps, model sizes, and our data mixing law, so that we can study the impact of mixture proportions for the target model sizes and data amount with only experiments at the affordable scales, illustrated in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="238" id="S1.F1.g1" src="x1.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration on our pipeline to optimize data mixture. <span class="ltx_text ltx_font_bold" id="S1.F1.3.1">Left:</span> Our pipeline takes three steps. Starting from small-scale training results, the three steps use the scaling laws of training steps, model sizes, and data mixing laws to predict model performance on large steps, large models, and unseen mixtures, respectively.
<span class="ltx_text ltx_font_bold" id="S1.F1.4.2">Right:</span> Visualization of the three-step pipeline to predict model performance on the target model size, training step, and mixtures.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Experimental results verify the reliability of our data mixing law and prediction pipeline.
By predicting the overall validation loss, we optimize the training mixture of RedPajama for a 1B model trained on 100B tokens and achieve performance comparable to a model trained on default mixture for 48% more steps.
The prediction on domain-specific validation sets also offers plausible references to the balance of model capabilities.
Further applying our data mixing law to continual pretraining can accurately find the proportion that avoids catastrophic forgetting&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(French, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib20" title="">1999</a>; Kirkpatrick et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib38" title="">2017</a>; Luo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib43" title="">2023</a>)</cite>, revealing the prospect of applying data mixing laws to guide a multi-stage pertaining, and thus a dynamic data schedule.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Overall, our contributions and findings are as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We discover the quantitative predictability of model performance regarding data mixture, and summarize this into a functional relationship, namely the data mixing laws.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a pipeline to predict model performance of large-scale training on different mixture proportions but only experiments on small models with few training data through nested use of scaling laws of training steps, model sizes, and data mixing laws.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We experiment to verify the reliability of our data mixing laws and prediction pipeline, showing its effectiveness in optimizing model performance, balancing model capabilities, and the prospects of guiding the design of the data schedule.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">We briefly review the pretraining process of large language models and summarize key findings from neural scaling laws, then we formalize the problem we study.
For more related work, please refer to Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S6" title="6 Related Work ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Pretraining large language models.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.5">We consider the task of pretraining an autoregressive language model <math alttext="p_{\theta}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">p</mi><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑝</ci><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">p_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> via next-token predictions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib50" title="">2018</a>)</cite>.
The training dataset <math alttext="\mathcal{D}_{\mbox{train}}=\{\mathcal{D}_{i}\}_{i=1}^{M}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">𝒟</mi><mtext id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3a.cmml">train</mtext></msub><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">=</mo><msubsup id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1"><eq id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.2"></eq><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.2">𝒟</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3a.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3"><mtext id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" mathsize="70%" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.3.3">train</mtext></ci></apply><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1">subscript</csymbol><set id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1"><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3"><eq id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.2">𝑖</ci><cn id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">\mathcal{D}_{\mbox{train}}=\{\mathcal{D}_{i}\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT = { caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> composes <math alttext="M" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.3.m3.1d">italic_M</annotation></semantics></math> domains with mixture proportions <math alttext="\bm{r}\in\Delta^{M-1}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.p1.4.m4.1a"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml">𝒓</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">Δ</mi><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml">M</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml">−</mo><mn id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m4.1b"><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1"><in id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.1"></in><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.2">𝒓</ci><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.2">Δ</ci><apply id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3"><minus id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.1"></minus><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.2">𝑀</ci><cn id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m4.1c">\bm{r}\in\Delta^{M-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.4.m4.1d">bold_italic_r ∈ roman_Δ start_POSTSUPERSCRIPT italic_M - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>.
In each training step, the task first samples a batch of domain indices according to the mixture proportions and then sample sequences of <math alttext="L" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.5.m5.1"><semantics id="S2.SS0.SSS0.Px1.p1.5.m5.1a"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.5.m5.1b"><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.5.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.5.m5.1d">italic_L</annotation></semantics></math> tokens from the sampled domains.
Using the sampled data, it learns to optimize the negative log-likelihood of sampled data, i.e.,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\theta}=\mathbb{E}_{i\sim\bm{r},x_{0\dots L}\sim D_{i}}\left[-%
\sum_{j=1}^{L}\log P_{\theta}(x_{j}|x_{0\dots j-1})\right]." class="ltx_Math" display="block" id="S2.E2.m1.3"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.3.3.1.1.3.2" xref="S2.E2.m1.3.3.1.1.3.2.cmml">ℒ</mi><mi id="S2.E2.m1.3.3.1.1.3.3" xref="S2.E2.m1.3.3.1.1.3.3.cmml">θ</mi></msub><mo id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.3.cmml"><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">∼</mo><mi id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3.cmml">𝒓</mi></mrow><mo id="S2.E2.m1.2.2.2.2.3" xref="S2.E2.m1.2.2.2.3a.cmml">,</mo><mrow id="S2.E2.m1.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.cmml"><msub id="S2.E2.m1.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.2.cmml">x</mi><mrow id="S2.E2.m1.2.2.2.2.2.2.3" xref="S2.E2.m1.2.2.2.2.2.2.3.cmml"><mn id="S2.E2.m1.2.2.2.2.2.2.3.2" xref="S2.E2.m1.2.2.2.2.2.2.3.2.cmml">0</mn><mo id="S2.E2.m1.2.2.2.2.2.2.3.1" xref="S2.E2.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.2.2.2.2.3.3" mathvariant="normal" xref="S2.E2.m1.2.2.2.2.2.2.3.3.cmml">…</mi><mo id="S2.E2.m1.2.2.2.2.2.2.3.1a" xref="S2.E2.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.2.2.2.2.3.4" xref="S2.E2.m1.2.2.2.2.2.2.3.4.cmml">L</mi></mrow></msub><mo id="S2.E2.m1.2.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.2.1.cmml">∼</mo><msub id="S2.E2.m1.2.2.2.2.2.3" xref="S2.E2.m1.2.2.2.2.2.3.cmml"><mi id="S2.E2.m1.2.2.2.2.2.3.2" xref="S2.E2.m1.2.2.2.2.2.3.2.cmml">D</mi><mi id="S2.E2.m1.2.2.2.2.2.3.3" xref="S2.E2.m1.2.2.2.2.2.3.3.cmml">i</mi></msub></mrow></mrow></msub><mo id="S2.E2.m1.3.3.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.1a" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><munderover id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">L</mi></munderover><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">0</mn><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml">⁢</mo><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" mathvariant="normal" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">…</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1a" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml">⁢</mo><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4.cmml">j</mi></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.2" lspace="0em" xref="S2.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2"></eq><apply id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2">ℒ</ci><ci id="S2.E2.m1.3.3.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.3.3">𝜃</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.2"></times><apply id="S2.E2.m1.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.3a.cmml" xref="S2.E2.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">similar-to</csymbol><ci id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2">𝑖</ci><ci id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">𝒓</ci></apply><apply id="S2.E2.m1.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2"><csymbol cd="latexml" id="S2.E2.m1.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.1">similar-to</csymbol><apply id="S2.E2.m1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2.2">𝑥</ci><apply id="S2.E2.m1.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3"><times id="S2.E2.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.1"></times><cn id="S2.E2.m1.2.2.2.2.2.2.3.2.cmml" type="integer" xref="S2.E2.m1.2.2.2.2.2.2.3.2">0</cn><ci id="S2.E2.m1.2.2.2.2.2.2.3.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.3">…</ci><ci id="S2.E2.m1.2.2.2.2.2.2.3.4.cmml" xref="S2.E2.m1.2.2.2.2.2.2.3.4">𝐿</ci></apply></apply><apply id="S2.E2.m1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.2.3.1.cmml" xref="S2.E2.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.2.3.2.cmml" xref="S2.E2.m1.2.2.2.2.2.3.2">𝐷</ci><ci id="S2.E2.m1.2.2.2.2.2.3.3.cmml" xref="S2.E2.m1.2.2.2.2.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.E2.m1.3.3.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"><minus id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"></minus><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1"><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3"><eq id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3"><log id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.1"></log><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.2">𝑃</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2"><times id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1"></times><cn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" type="integer" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">0</cn><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">…</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.2.4">𝑗</ci></apply><cn id="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\mathcal{L}_{\theta}=\mathbb{E}_{i\sim\bm{r},x_{0\dots L}\sim D_{i}}\left[-%
\sum_{j=1}^{L}\log P_{\theta}(x_{j}|x_{0\dots j-1})\right].</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.3d">caligraphic_L start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_i ∼ bold_italic_r , italic_x start_POSTSUBSCRIPT 0 … italic_L end_POSTSUBSCRIPT ∼ italic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ - ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT roman_log italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT 0 … italic_j - 1 end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.1">To evaluate the learned model, we compute the loss on validation data <math alttext="\mathcal{D}_{\mbox{val}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p2.1.m1.1a"><msub id="S2.SS0.SSS0.Px1.p2.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3a.cmml">val</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2">𝒟</ci><ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3a.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3"><mtext id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3">val</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.1.m1.1c">\mathcal{D}_{\mbox{val}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT val end_POSTSUBSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Scaling laws.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.2">For a wide range of factors <math alttext="x" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.1.m1.1d">italic_x</annotation></semantics></math>, scaling laws&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib37" title="">2020</a>; Henighan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib30" title="">2020</a>; Hoffmann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib33" title="">2022</a>)</cite> show that their effect on the loss <math alttext="L" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.2.m2.1d">italic_L</annotation></semantics></math> of a pretrained model follows power laws</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L=c+kx^{\alpha}," class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml">L</mi><mo id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml">c</mi><mo id="S2.E3.m1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.3.2" xref="S2.E3.m1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S2.E3.m1.1.1.1.1.3.3.1" xref="S2.E3.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msup id="S2.E3.m1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.3.3.2" xref="S2.E3.m1.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.E3.m1.1.1.1.1.3.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.3.cmml">α</mi></msup></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"></eq><ci id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2">𝐿</ci><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><plus id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.1"></plus><ci id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2">𝑐</ci><apply id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3"><times id="S2.E3.m1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.1"></times><ci id="S2.E3.m1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2">𝑘</ci><apply id="S2.E3.m1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.E3.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3.3">𝛼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">L=c+kx^{\alpha},</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">italic_L = italic_c + italic_k italic_x start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.6">where <math alttext="c" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.3.m1.1"><semantics id="S2.SS0.SSS0.Px2.p1.3.m1.1a"><mi id="S2.SS0.SSS0.Px2.p1.3.m1.1.1" xref="S2.SS0.SSS0.Px2.p1.3.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.3.m1.1b"><ci id="S2.SS0.SSS0.Px2.p1.3.m1.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.3.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.3.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.3.m1.1d">italic_c</annotation></semantics></math>, <math alttext="k" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.4.m2.1"><semantics id="S2.SS0.SSS0.Px2.p1.4.m2.1a"><mi id="S2.SS0.SSS0.Px2.p1.4.m2.1.1" xref="S2.SS0.SSS0.Px2.p1.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.4.m2.1b"><ci id="S2.SS0.SSS0.Px2.p1.4.m2.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.4.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.4.m2.1d">italic_k</annotation></semantics></math>, and <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.5.m3.1"><semantics id="S2.SS0.SSS0.Px2.p1.5.m3.1a"><mi id="S2.SS0.SSS0.Px2.p1.5.m3.1.1" xref="S2.SS0.SSS0.Px2.p1.5.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.5.m3.1b"><ci id="S2.SS0.SSS0.Px2.p1.5.m3.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.5.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.5.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.5.m3.1d">italic_α</annotation></semantics></math> are parameters to fit and <math alttext="x" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px2.p1.6.m4.1"><semantics id="S2.SS0.SSS0.Px2.p1.6.m4.1a"><mi id="S2.SS0.SSS0.Px2.p1.6.m4.1.1" xref="S2.SS0.SSS0.Px2.p1.6.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px2.p1.6.m4.1b"><ci id="S2.SS0.SSS0.Px2.p1.6.m4.1.1.cmml" xref="S2.SS0.SSS0.Px2.p1.6.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px2.p1.6.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px2.p1.6.m4.1d">italic_x</annotation></semantics></math> can be model sizes, numbers of training data, training steps<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>
The training step law&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib37" title="">2020</a>)</cite> refers to the function between the intermediate training step and its corresponding loss <span class="ltx_text ltx_font_italic" id="footnote2.1">in one single training run</span>.
For clarity, we highlight its difference from the data scaling law that predicts the early exit loss&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib37" title="">2020</a>)</cite> or the loss obtained with optimal hyperparameters for each data budget&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hoffmann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib33" title="">2022</a>)</cite>.
</span></span></span>, and the amount of computation.
Previous experience&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Alabdulmohsin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib2" title="">2022</a>; OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib48" title="">2023</a>; Bi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib7" title="">2024</a>; Su et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib54" title="">2024</a>)</cite> highlights the impressive predictability of scaling laws.
Specifically, Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S2.E3" title="3 ‣ Scaling laws. ‣ 2 Background ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3</span></a> fitted on a collection of small models, training data, or computation can extrapolate to precisely predict the test loss of larger cases over orders of magnitudes.
This enables practitioners to estimate the performance of a pretrained large language model without actually finishing the expensive runs.
Recent development further shows various functional relationships between the performance of language models and a broader range of factors, including transfer learning&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hernandez et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib31" title="">2021</a>)</cite>, sparse architectures&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Frantar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib19" title="">2023</a>)</cite>, and repeated data <cite class="ltx_cite ltx_citemacro_citep">(Muennighoff et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib47" title="">2024</a>)</cite>, consolidating the predictability of language model performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Problem formalization.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">We study optimizing the mixture proportions of pretraining data for large language models.
Motivated by the impressive predictability of existing scaling laws, we try to tackle mixture optimization by establishing a quantitative framework that predicts the loss given any mixture proportion.
Formally, for a training dataset comprising <math alttext="M" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px3.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.1.m1.1d">italic_M</annotation></semantics></math> domains, we parameterize the function</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L=f_{\theta}(\bm{r})," class="ltx_Math" display="block" id="S2.E4.m1.2"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.2" xref="S2.E4.m1.2.2.1.1.2.cmml">L</mi><mo id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E4.m1.2.2.1.1.3" xref="S2.E4.m1.2.2.1.1.3.cmml"><msub id="S2.E4.m1.2.2.1.1.3.2" xref="S2.E4.m1.2.2.1.1.3.2.cmml"><mi id="S2.E4.m1.2.2.1.1.3.2.2" xref="S2.E4.m1.2.2.1.1.3.2.2.cmml">f</mi><mi id="S2.E4.m1.2.2.1.1.3.2.3" xref="S2.E4.m1.2.2.1.1.3.2.3.cmml">θ</mi></msub><mo id="S2.E4.m1.2.2.1.1.3.1" xref="S2.E4.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E4.m1.2.2.1.1.3.3.2" xref="S2.E4.m1.2.2.1.1.3.cmml"><mo id="S2.E4.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E4.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">𝒓</mi><mo id="S2.E4.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><eq id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"></eq><ci id="S2.E4.m1.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2">𝐿</ci><apply id="S2.E4.m1.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.3"><times id="S2.E4.m1.2.2.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.3.1"></times><apply id="S2.E4.m1.2.2.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.3.2.1.cmml" xref="S2.E4.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.3.2.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2.2">𝑓</ci><ci id="S2.E4.m1.2.2.1.1.3.2.3.cmml" xref="S2.E4.m1.2.2.1.1.3.2.3">𝜃</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝒓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">L=f_{\theta}(\bm{r}),</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.2d">italic_L = italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_r ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.3">under the fixed model sizes and number of training steps, where <math alttext="\bm{r}=r_{1\dots M}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.2.m1.1"><semantics id="S2.SS0.SSS0.Px3.p1.2.m1.1a"><mrow id="S2.SS0.SSS0.Px3.p1.2.m1.1.1" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.cmml"><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2.cmml">𝒓</mi><mo id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1.cmml">=</mo><msub id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2.cmml">r</mi><mrow id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.cmml"><mn id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3" mathvariant="normal" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3.cmml">…</mi><mo id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1a" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4.cmml">M</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.2.m1.1b"><apply id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1"><eq id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.1"></eq><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.2">𝒓</ci><apply id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.2">𝑟</ci><apply id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3"><times id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.1"></times><cn id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2.cmml" type="integer" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.2">1</cn><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.3">…</ci><ci id="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4.cmml" xref="S2.SS0.SSS0.Px3.p1.2.m1.1.1.3.3.4">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.2.m1.1c">\bm{r}=r_{1\dots M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.2.m1.1d">bold_italic_r = italic_r start_POSTSUBSCRIPT 1 … italic_M end_POSTSUBSCRIPT</annotation></semantics></math> is the proportion of the <math alttext="M" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px3.p1.3.m2.1"><semantics id="S2.SS0.SSS0.Px3.p1.3.m2.1a"><mi id="S2.SS0.SSS0.Px3.p1.3.m2.1.1" xref="S2.SS0.SSS0.Px3.p1.3.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px3.p1.3.m2.1b"><ci id="S2.SS0.SSS0.Px3.p1.3.m2.1.1.cmml" xref="S2.SS0.SSS0.Px3.p1.3.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px3.p1.3.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px3.p1.3.m2.1d">italic_M</annotation></semantics></math> domains.
Harnessing this function, we seek a mixture that achieves the desired performance.
Without loss of generality, we search for the mixture that reaches minimum validation loss, i.e.,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{r}^{*}={\arg\min}_{\bm{r}}f_{\theta}(\bm{r})." class="ltx_Math" display="block" id="S2.E5.m1.2"><semantics id="S2.E5.m1.2a"><mrow id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.1.cmml"><mrow id="S2.E5.m1.2.2.1.1" xref="S2.E5.m1.2.2.1.1.cmml"><msup id="S2.E5.m1.2.2.1.1.2" xref="S2.E5.m1.2.2.1.1.2.cmml"><mi id="S2.E5.m1.2.2.1.1.2.2" xref="S2.E5.m1.2.2.1.1.2.2.cmml">𝒓</mi><mo id="S2.E5.m1.2.2.1.1.2.3" xref="S2.E5.m1.2.2.1.1.2.3.cmml">*</mo></msup><mo id="S2.E5.m1.2.2.1.1.1" xref="S2.E5.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E5.m1.2.2.1.1.3" xref="S2.E5.m1.2.2.1.1.3.cmml"><mrow id="S2.E5.m1.2.2.1.1.3.2" xref="S2.E5.m1.2.2.1.1.3.2.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.1" xref="S2.E5.m1.2.2.1.1.3.2.1.cmml">arg</mi><mo id="S2.E5.m1.2.2.1.1.3.2a" lspace="0.167em" xref="S2.E5.m1.2.2.1.1.3.2.cmml">⁡</mo><mrow id="S2.E5.m1.2.2.1.1.3.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.cmml"><munder id="S2.E5.m1.2.2.1.1.3.2.2.1" xref="S2.E5.m1.2.2.1.1.3.2.2.1.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.2.1.2" xref="S2.E5.m1.2.2.1.1.3.2.2.1.2.cmml">min</mi><mi id="S2.E5.m1.2.2.1.1.3.2.2.1.3" xref="S2.E5.m1.2.2.1.1.3.2.2.1.3.cmml">𝒓</mi></munder><mo id="S2.E5.m1.2.2.1.1.3.2.2a" lspace="0.167em" xref="S2.E5.m1.2.2.1.1.3.2.2.cmml">⁡</mo><msub id="S2.E5.m1.2.2.1.1.3.2.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.2.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.2.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.2.2.cmml">f</mi><mi id="S2.E5.m1.2.2.1.1.3.2.2.2.3" xref="S2.E5.m1.2.2.1.1.3.2.2.2.3.cmml">θ</mi></msub></mrow></mrow><mo id="S2.E5.m1.2.2.1.1.3.1" xref="S2.E5.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.1.1.3.3.2" xref="S2.E5.m1.2.2.1.1.3.cmml"><mo id="S2.E5.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E5.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">𝒓</mi><mo id="S2.E5.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.E5.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m1.2.2.1.2" lspace="0em" xref="S2.E5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1"><eq id="S2.E5.m1.2.2.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1"></eq><apply id="S2.E5.m1.2.2.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.2.1.cmml" xref="S2.E5.m1.2.2.1.1.2">superscript</csymbol><ci id="S2.E5.m1.2.2.1.1.2.2.cmml" xref="S2.E5.m1.2.2.1.1.2.2">𝒓</ci><times id="S2.E5.m1.2.2.1.1.2.3.cmml" xref="S2.E5.m1.2.2.1.1.2.3"></times></apply><apply id="S2.E5.m1.2.2.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.3"><times id="S2.E5.m1.2.2.1.1.3.1.cmml" xref="S2.E5.m1.2.2.1.1.3.1"></times><apply id="S2.E5.m1.2.2.1.1.3.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2"><arg id="S2.E5.m1.2.2.1.1.3.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.1"></arg><apply id="S2.E5.m1.2.2.1.1.3.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2"><apply id="S2.E5.m1.2.2.1.1.3.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1">subscript</csymbol><min id="S2.E5.m1.2.2.1.1.3.2.2.1.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1.2"></min><ci id="S2.E5.m1.2.2.1.1.3.2.2.1.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1.3">𝒓</ci></apply><apply id="S2.E5.m1.2.2.1.1.3.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2.2">𝑓</ci><ci id="S2.E5.m1.2.2.1.1.3.2.2.2.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2.3">𝜃</ci></apply></apply></apply><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝒓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">\bm{r}^{*}={\arg\min}_{\bm{r}}f_{\theta}(\bm{r}).</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.2d">bold_italic_r start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT bold_italic_r end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_r ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The proportions of data mixtures influence model losses in a quantitatively predictable way</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we present our findings on the predictability of model losses regarding data mixtures, which boils down to functional relationships we refer to as the data mixing laws.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">To discover the data mixing laws, we encounter two challenges posed by their characteristics. </p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(i)</span>
<div class="ltx_para" id="S3.I1.ix1.p1">
<p class="ltx_p" id="S3.I1.ix1.p1.3"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.I1.ix1.p1.3.1">Multi-variables.</span>
For a data mixing law for <math alttext="K" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.1.m1.1"><semantics id="S3.I1.ix1.p1.1.m1.1a"><mi id="S3.I1.ix1.p1.1.m1.1.1" xref="S3.I1.ix1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.1.m1.1b"><ci id="S3.I1.ix1.p1.1.m1.1.1.cmml" xref="S3.I1.ix1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.1.m1.1d">italic_K</annotation></semantics></math> domains, we should consider <math alttext="K-1" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.2.m2.1"><semantics id="S3.I1.ix1.p1.2.m2.1a"><mrow id="S3.I1.ix1.p1.2.m2.1.1" xref="S3.I1.ix1.p1.2.m2.1.1.cmml"><mi id="S3.I1.ix1.p1.2.m2.1.1.2" xref="S3.I1.ix1.p1.2.m2.1.1.2.cmml">K</mi><mo id="S3.I1.ix1.p1.2.m2.1.1.1" xref="S3.I1.ix1.p1.2.m2.1.1.1.cmml">−</mo><mn id="S3.I1.ix1.p1.2.m2.1.1.3" xref="S3.I1.ix1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.2.m2.1b"><apply id="S3.I1.ix1.p1.2.m2.1.1.cmml" xref="S3.I1.ix1.p1.2.m2.1.1"><minus id="S3.I1.ix1.p1.2.m2.1.1.1.cmml" xref="S3.I1.ix1.p1.2.m2.1.1.1"></minus><ci id="S3.I1.ix1.p1.2.m2.1.1.2.cmml" xref="S3.I1.ix1.p1.2.m2.1.1.2">𝐾</ci><cn id="S3.I1.ix1.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.I1.ix1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.2.m2.1c">K-1</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.2.m2.1d">italic_K - 1</annotation></semantics></math> degrees of freedom in the mixture proportions and, correspondingly, <math alttext="K-1" class="ltx_Math" display="inline" id="S3.I1.ix1.p1.3.m3.1"><semantics id="S3.I1.ix1.p1.3.m3.1a"><mrow id="S3.I1.ix1.p1.3.m3.1.1" xref="S3.I1.ix1.p1.3.m3.1.1.cmml"><mi id="S3.I1.ix1.p1.3.m3.1.1.2" xref="S3.I1.ix1.p1.3.m3.1.1.2.cmml">K</mi><mo id="S3.I1.ix1.p1.3.m3.1.1.1" xref="S3.I1.ix1.p1.3.m3.1.1.1.cmml">−</mo><mn id="S3.I1.ix1.p1.3.m3.1.1.3" xref="S3.I1.ix1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix1.p1.3.m3.1b"><apply id="S3.I1.ix1.p1.3.m3.1.1.cmml" xref="S3.I1.ix1.p1.3.m3.1.1"><minus id="S3.I1.ix1.p1.3.m3.1.1.1.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.1"></minus><ci id="S3.I1.ix1.p1.3.m3.1.1.2.cmml" xref="S3.I1.ix1.p1.3.m3.1.1.2">𝐾</ci><cn id="S3.I1.ix1.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.I1.ix1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix1.p1.3.m3.1c">K-1</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix1.p1.3.m3.1d">italic_K - 1</annotation></semantics></math> variables in the target function.
The increase of variables considerably enlarges the scope of potential functions thereby complicating the identification of the function form.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(ii)</span>
<div class="ltx_para ltx_noindent" id="S3.I1.ix2.p1">
<p class="ltx_p" id="S3.I1.ix2.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.I1.ix2.p1.1.1">Nonmonotonicity.</span> A monotonic relationship between losses and the proportion of any domain indicates that a lopsided mixture can achieve minimum loss without endeavors to balance domain proportions, which contradicts the practice.
Therefore, differing from existing scaling laws that loss monotonically decreases with the scale of concerning factors, the data mixing law we study should accommodate non-monotonic functions.
This nonmonotonic nature adds another layer of complexity to our analysis.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
<p class="ltx_p" id="S3.p2.2">To navigate these challenges, we initially simplify the problem by studying a scenario where the relationship between loss and mixture proportions fits into a univariate monotonic function then retracts the simplifications progressively.
In specific, we begin our study on the case where we only train on two domains thus avoiding multi-variables, and only consider the validation data coming from one of the training domains to circumvent the non-monotonicity (Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.1</span></a>).
Subsequently, we broaden our framework to encompass training on multiple domains&nbsp;(Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.2</span></a>) and explore the predictability of losses on general validation data that also comprises various domains (Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS3" title="3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.3</span></a>).
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Pilot Study on Domain Losses under Two-domain Mixtures</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We begin our exploration with the simplest case where we only learn on mixtures of two domains and evaluate our model on the two domains respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="337" id="S3.F2.g1" src="extracted/5490388/figs/2mix.png" width="598">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Quantitative predictability of domain losses on two domains, which are Github and Pile-CC.
We train on the mixtures of these two domains and validate the outcome models on them separately.
We train 70M and 160M models on five different mixtures of Github and Pile-CC and obtain the reducible losses by subtracting the original losses with a constant shared across models of the same sizes and trained for the same number of steps.
The reducible losses in log scale show linear correlations to the domain proportions.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Setups</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.1">We train 70M and 160M language models on the mixture of Github and Pile-CC subset from the Pile dataset&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib22" title="">2020</a>)</cite> with five different mixture proportions, which are {0.25, 0.375, 0.5, 0.625, 0.75} for Github.
We train all models with a batch size of 1M tokens for 30k steps, which is 30B tokens in total, and evaluate checkpoints at different steps on the validation set of GitHub and Pile-CC.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Findings</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.7">Results in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.F2" title="Figure 2 ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">2</span></a> reveal the quantitative predictability of domain losses given the domain proportions.
We encouragingly find that, for checkpoints with the same size and trained with the same number of steps, after subtracting a shared constant<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>The loss function of language models is lower bounded by the entropy of the evaluation data theoretically&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bishop, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib9" title="">2006</a>; Henighan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib30" title="">2020</a>)</cite>. Thus, it is common to have constant terms in scaling laws, known as irreducible loss. </span></span></span>, their domain losses in the log scale demonstrate a linear relationship to the domain proportion.
This holds for both domains in our experiments.
The result indicates that with other factors fixed, the domain losses of a pretrained language model regarding the domain proportion precisely fit into an exponential law</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{i}(r_{i})=c_{i}+k_{i}\exp{\left(t_{ii}r_{i}\right)}," class="ltx_Math" display="block" id="S3.E6.m1.2"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.3.2.cmml">L</mi><mi id="S3.E6.m1.2.2.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E6.m1.2.2.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.2.cmml"><msub id="S3.E6.m1.2.2.1.1.2.3" xref="S3.E6.m1.2.2.1.1.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.3.2" xref="S3.E6.m1.2.2.1.1.2.3.2.cmml">c</mi><mi id="S3.E6.m1.2.2.1.1.2.3.3" xref="S3.E6.m1.2.2.1.1.2.3.3.cmml">i</mi></msub><mo id="S3.E6.m1.2.2.1.1.2.2" xref="S3.E6.m1.2.2.1.1.2.2.cmml">+</mo><mrow id="S3.E6.m1.2.2.1.1.2.1" xref="S3.E6.m1.2.2.1.1.2.1.cmml"><msub id="S3.E6.m1.2.2.1.1.2.1.3" xref="S3.E6.m1.2.2.1.1.2.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.3.2" xref="S3.E6.m1.2.2.1.1.2.1.3.2.cmml">k</mi><mi id="S3.E6.m1.2.2.1.1.2.1.3.3" xref="S3.E6.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo id="S3.E6.m1.2.2.1.1.2.1.2" lspace="0.167em" xref="S3.E6.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">exp</mi><mo id="S3.E6.m1.2.2.1.1.2.1.1.1a" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml">⁡</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml"><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml">t</mi><mrow id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E6.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1"><eq id="S3.E6.m1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3"></eq><apply id="S3.E6.m1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1"><times id="S3.E6.m1.2.2.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.2"></times><apply id="S3.E6.m1.2.2.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.3.2">𝐿</ci><ci id="S3.E6.m1.2.2.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2"><plus id="S3.E6.m1.2.2.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2"></plus><apply id="S3.E6.m1.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.3.2">𝑐</ci><ci id="S3.E6.m1.2.2.1.1.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1"><times id="S3.E6.m1.2.2.1.1.2.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.2"></times><apply id="S3.E6.m1.2.2.1.1.2.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3.2">𝑘</ci><ci id="S3.E6.m1.2.2.1.1.2.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1"><exp id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"></exp><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1"><times id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.1"></times><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.2">𝑡</ci><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3"><times id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.1"></times><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">L_{i}(r_{i})=c_{i}+k_{i}\exp{\left(t_{ii}r_{i}\right)},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.2d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( italic_t start_POSTSUBSCRIPT italic_i italic_i end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.6">where <math alttext="L_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">L</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝐿</ci><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.1.m1.1c">L_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="r_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS1.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml">r</mi><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2">𝑟</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.2.m2.1c">r_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.2.m2.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are validation loss and training mixture proportion of domain <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.3.m3.1d">italic_i</annotation></semantics></math>, respectively, while <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS1.SSS0.Px2.p1.4.m4.1a"><msub id="S3.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.cmml">c</mi><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.2">𝑐</ci><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.4.m4.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.4.m4.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="k_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS1.SSS0.Px2.p1.5.m5.1a"><msub id="S3.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml">k</mi><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2">𝑘</ci><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.5.m5.1c">k_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.5.m5.1d">italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="t_{ii}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.6.m6.1"><semantics id="S3.SS1.SSS0.Px2.p1.6.m6.1a"><msub id="S3.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml">t</mi><mrow id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2.cmml">i</mi><mo id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2">𝑡</ci><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3"><times id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.6.m6.1c">t_{ii}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.6.m6.1d">italic_t start_POSTSUBSCRIPT italic_i italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are learnable parameters&nbsp;<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>
Despite a simple case, our findings on two domains have practical applications to continue pretraining&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gururangan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib25" title="">2020</a>)</cite>, where we aim to enhance a pretrained model on a given domain by training it on a mixture of the original pretraining data and upcoming domain data. Please see Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S5" title="5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">5</span></a> for details.
</span></span></span>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Extension to Domain Losses Trained on Multi-domain Mixtures</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">To accommodate real-world pretraining data that mostly contains more than two domains, we extend our investigation into multiple domains.
For simplicity and the ease of visual aids, we start with the case of three domains.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Mean absolute errors (MAE) of different candidate functions for predicting the target domain losses.
We also include random guesses that randomly predict between the maximum and minimum loss of the training samples for reference. In specific, we report the MAE of the expectation of this random guess which predicts the median of the maximum and minimum loss.
The training data contain <math alttext="M=3" class="ltx_Math" display="inline" id="S3.T1.2.m1.1"><semantics id="S3.T1.2.m1.1b"><mrow id="S3.T1.2.m1.1.1" xref="S3.T1.2.m1.1.1.cmml"><mi id="S3.T1.2.m1.1.1.2" xref="S3.T1.2.m1.1.1.2.cmml">M</mi><mo id="S3.T1.2.m1.1.1.1" xref="S3.T1.2.m1.1.1.1.cmml">=</mo><mn id="S3.T1.2.m1.1.1.3" xref="S3.T1.2.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.m1.1c"><apply id="S3.T1.2.m1.1.1.cmml" xref="S3.T1.2.m1.1.1"><eq id="S3.T1.2.m1.1.1.1.cmml" xref="S3.T1.2.m1.1.1.1"></eq><ci id="S3.T1.2.m1.1.1.2.cmml" xref="S3.T1.2.m1.1.1.2">𝑀</ci><cn id="S3.T1.2.m1.1.1.3.cmml" type="integer" xref="S3.T1.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.m1.1d">M=3</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.m1.1e">italic_M = 3</annotation></semantics></math> domains and we fit each function with the same 24 mixtures and validate on 8 other mixtures. The split is random.
The lowest error for each target domain are in <span class="ltx_text ltx_font_bold" id="S3.T1.5.1">bold</span> while the second lowest are <span class="ltx_text ltx_framed_underline" id="S3.T1.6.2">underlined</span>.
</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.7" style="width:424.9pt;height:178.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(62.8pt,-26.4pt) scale(1.41976853728926,1.41976853728926) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.7.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.7.1.1.1">
<td class="ltx_td ltx_border_tt" id="S3.T1.7.1.1.1.1"></td>
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S3.T1.7.1.1.1.2"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.7.1.1.1.3">
<span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.1.3.1">GitHub</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.7.1.1.1.4">
<span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.1.4.1">Books3</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.7.1.1.1.5">
<span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.1.5.1">Pile-CC</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T1.7.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.2.2.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T1.7.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.2.2.2.1"># Coeff.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.7.1.2.2.3">Train</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.7.1.2.2.4">Validation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.7.1.2.2.5">Train</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.7.1.2.2.6">Validation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.7.1.2.2.7">Train</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.7.1.2.2.8">Validation</th>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.3.3.1">Random</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.3.3.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.3.3.3">0.8895</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.3.3.4">0.8758</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.3.3.5">0.1291</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.3.3.6">0.1331</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.3.3.7">0.0768</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.1.3.3.8">0.1045</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.4.4">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.4.1">M1</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.4.2">2M+1</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.4.3"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.4.4.3.1">0.0292</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.4.4"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.4.4.4.1">0.0312</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.4.5"><span class="ltx_text ltx_framed_underline" id="S3.T1.7.1.4.4.5.1">0.0082</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.4.6"><span class="ltx_text ltx_framed_underline" id="S3.T1.7.1.4.4.6.1">0.0121</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.4.7"><span class="ltx_text ltx_framed_underline" id="S3.T1.7.1.4.4.7.1">0.0045</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.4.4.8"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.4.4.8.1">0.0050</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.5.5">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.5.1">M2</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.5.2">M+2</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.5.3">0.1558</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.5.4">0.3327</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.5.5">0.0114</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.5.6">0.0119</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.5.7">0.0072</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.5.5.8">0.0083</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.6.6">
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.6.1">M3</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.6.2">M+2</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.6.3">0.3389</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.6.4">0.2177</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.6.5">0.0914</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.6.6">0.0465</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.6.7">0.0746</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.1.6.6.8">0.0947</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.1.7.7" style="background-color:#FFEFEF;">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.1.7.7.1"><span class="ltx_text" id="S3.T1.7.1.7.7.1.1" style="background-color:#FFEFEF;">M4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.1.7.7.2"><span class="ltx_text" id="S3.T1.7.1.7.7.2.1" style="background-color:#FFEFEF;">M+2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.1.7.7.3"><span class="ltx_text ltx_framed_underline" id="S3.T1.7.1.7.7.3.1" style="background-color:#FFEFEF;">0.0298</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.1.7.7.4"><span class="ltx_text ltx_framed_underline" id="S3.T1.7.1.7.7.4.1" style="background-color:#FFEFEF;">0.0365</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.1.7.7.5"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.7.7.5.1" style="background-color:#FFEFEF;">0.0062</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.1.7.7.6"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.7.7.6.1" style="background-color:#FFEFEF;">0.0074</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.1.7.7.7"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.7.7.7.1" style="background-color:#FFEFEF;">0.0036</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.1.7.7.8"><span class="ltx_text ltx_framed_underline" id="S3.T1.7.1.7.7.8.1" style="background-color:#FFEFEF;">0.0078</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Setups</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.1">We train on the mixtures of GitHub, Pile-CC, and Books3 subset from the Pile for a total of 30B tokens and evaluate the model on the three domains, respectively.
For specific mixtures, we grid search from <math alttext="\{0,0.125,0.25,\dots,0.875,1\}^{3}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.6"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.6a"><msup id="S3.SS2.SSS0.Px1.p1.1.m1.6.7" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml"><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">{</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">0</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.cmml">0.125</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.3.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.3.3.cmml">0.25</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.4" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.1.m1.4.4" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.1.m1.4.4.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.5" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.5.5" xref="S3.SS2.SSS0.Px1.p1.1.m1.5.5.cmml">0.875</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.6" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.1.m1.6.6" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.6.cmml">1</mn><mo id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2.7" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml">}</mo></mrow><mn id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.6b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7">superscript</csymbol><set id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.2.2"><cn id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">0</cn><cn id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.cmml" type="float" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2">0.125</cn><cn id="S3.SS2.SSS0.Px1.p1.1.m1.3.3.cmml" type="float" xref="S3.SS2.SSS0.Px1.p1.1.m1.3.3">0.25</cn><ci id="S3.SS2.SSS0.Px1.p1.1.m1.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.4.4">…</ci><cn id="S3.SS2.SSS0.Px1.p1.1.m1.5.5.cmml" type="float" xref="S3.SS2.SSS0.Px1.p1.1.m1.5.5">0.875</cn><cn id="S3.SS2.SSS0.Px1.p1.1.m1.6.6.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.6">1</cn></set><cn id="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.1.m1.6.7.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.6c">\{0,0.125,0.25,\dots,0.875,1\}^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.6d">{ 0 , 0.125 , 0.25 , … , 0.875 , 1 } start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and retain valid ones in which three proportions sum up to 1 and do not use up all tokens in any of the domains<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>The GitHub and Books3 subset in the Pile do not contain as many as 30B tokens after deduplication.</span></span></span>, which results in 32 mixtures in total.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.1">We utilize the losses on these experimented mixtures to identify the function forms between losses and mixture proportions through conjecture and then verification.
In specific, we base our conjecture of possible forms on the following two principles.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.I2.i1.p1.1.1">Compatibility.</span> The form can reduce to Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E6" title="6 ‣ Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a> if the number of domains <math alttext="M=2" class="ltx_Math" display="inline" id="S3.I2.i1.p1.1.m1.1"><semantics id="S3.I2.i1.p1.1.m1.1a"><mrow id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml"><mi id="S3.I2.i1.p1.1.m1.1.1.2" xref="S3.I2.i1.p1.1.m1.1.1.2.cmml">M</mi><mo id="S3.I2.i1.p1.1.m1.1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.I2.i1.p1.1.m1.1.1.3" xref="S3.I2.i1.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.1b"><apply id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><eq id="S3.I2.i1.p1.1.m1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1.1"></eq><ci id="S3.I2.i1.p1.1.m1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2">𝑀</ci><cn id="S3.I2.i1.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.I2.i1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.1c">M=2</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.1.m1.1d">italic_M = 2</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.I2.i2.p1.1.1">Symmetry.</span> Any exchanging of variables should not change the functional form.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.2">The second principle stems from the intuition to avoid introducing any domain-specific bias.
Together, the two principles lead to candidate functions that replicate the exponential term in Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E6" title="6 ‣ Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a> for each training domain and combine them through operations that adhere to commutative law.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p3.1">According to the two principles, we experiment with the following candidate functions:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.Ex1">
<tbody id="S3.Ex1X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="S3.Ex1X.2.1.1.1">M1:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{i}(\bm{r})=" class="ltx_Math" display="inline" id="S3.Ex1X.4.1.1.m1.1"><semantics id="S3.Ex1X.4.1.1.m1.1a"><mrow id="S3.Ex1X.4.1.1.m1.1.2" xref="S3.Ex1X.4.1.1.m1.1.2.cmml"><mrow id="S3.Ex1X.4.1.1.m1.1.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1X.4.1.1.m1.1.2.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1X.4.1.1.m1.1.2.2.2.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1X.4.1.1.m1.1.2.2.2.3" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.Ex1X.4.1.1.m1.1.2.2.1" xref="S3.Ex1X.4.1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.Ex1X.4.1.1.m1.1.2.2.3.2" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml"><mo id="S3.Ex1X.4.1.1.m1.1.2.2.3.2.1" stretchy="false" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1X.4.1.1.m1.1.1" xref="S3.Ex1X.4.1.1.m1.1.1.cmml">𝒓</mi><mo id="S3.Ex1X.4.1.1.m1.1.2.2.3.2.2" stretchy="false" xref="S3.Ex1X.4.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1X.4.1.1.m1.1.2.1" xref="S3.Ex1X.4.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1X.4.1.1.m1.1.2.3" xref="S3.Ex1X.4.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.4.1.1.m1.1b"><apply id="S3.Ex1X.4.1.1.m1.1.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2"><eq id="S3.Ex1X.4.1.1.m1.1.2.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.1"></eq><apply id="S3.Ex1X.4.1.1.m1.1.2.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2"><times id="S3.Ex1X.4.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1X.4.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1X.4.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1X.4.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1X.4.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1X.4.1.1.m1.1.1.cmml" xref="S3.Ex1X.4.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1X.4.1.1.m1.1.2.3.cmml" xref="S3.Ex1X.4.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.4.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1X.4.1.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_r ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle c_{i}+\sum_{j=1}^{M}\left[k_{ij}\exp\left(t_{ij}r_{j}\right)%
\right]," class="ltx_Math" display="inline" id="S3.Ex1X.5.2.2.m1.2"><semantics id="S3.Ex1X.5.2.2.m1.2a"><mrow id="S3.Ex1X.5.2.2.m1.2.2.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.cmml"><munderover id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2a" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.cmml"><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2" movablelimits="false" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml">k</mi><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2" lspace="0.167em" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.5.2.2.m1.1.1" xref="S3.Ex1X.5.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mrow id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.Ex1X.5.2.2.m1.2.2.1.2" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.5.2.2.m1.2b"><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1"><plus id="S3.Ex1X.5.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1"><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.2"></sum><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3"><eq id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.2">𝑗</ci><cn id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.2.3">𝑀</ci></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.2">𝑘</ci><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.1"></times><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1"><exp id="S3.Ex1X.5.2.2.m1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.1.1"></exp><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝑡</ci><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.5.2.2.m1.2c">\displaystyle c_{i}+\sum_{j=1}^{M}\left[k_{ij}\exp\left(t_{ij}r_{j}\right)%
\right],</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1X.5.2.2.m1.2d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT [ italic_k start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT roman_exp ( italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="S3.Ex1X.7.1.1.1">M2:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{i}(\bm{r})=" class="ltx_Math" display="inline" id="S3.Ex1X.9.1.1.m1.1"><semantics id="S3.Ex1X.9.1.1.m1.1a"><mrow id="S3.Ex1X.9.1.1.m1.1.2" xref="S3.Ex1X.9.1.1.m1.1.2.cmml"><mrow id="S3.Ex1X.9.1.1.m1.1.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1X.9.1.1.m1.1.2.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1X.9.1.1.m1.1.2.2.2.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1X.9.1.1.m1.1.2.2.2.3" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.Ex1X.9.1.1.m1.1.2.2.1" xref="S3.Ex1X.9.1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.Ex1X.9.1.1.m1.1.2.2.3.2" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml"><mo id="S3.Ex1X.9.1.1.m1.1.2.2.3.2.1" stretchy="false" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1X.9.1.1.m1.1.1" xref="S3.Ex1X.9.1.1.m1.1.1.cmml">𝒓</mi><mo id="S3.Ex1X.9.1.1.m1.1.2.2.3.2.2" stretchy="false" xref="S3.Ex1X.9.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1X.9.1.1.m1.1.2.1" xref="S3.Ex1X.9.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1X.9.1.1.m1.1.2.3" xref="S3.Ex1X.9.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.9.1.1.m1.1b"><apply id="S3.Ex1X.9.1.1.m1.1.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2"><eq id="S3.Ex1X.9.1.1.m1.1.2.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.1"></eq><apply id="S3.Ex1X.9.1.1.m1.1.2.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2"><times id="S3.Ex1X.9.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1X.9.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1X.9.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1X.9.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1X.9.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1X.9.1.1.m1.1.1.cmml" xref="S3.Ex1X.9.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1X.9.1.1.m1.1.2.3.cmml" xref="S3.Ex1X.9.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.9.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1X.9.1.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_r ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle c_{i}+k_{i}\sum_{j=1}^{M}\exp\left(t_{ij}r_{j}\right)," class="ltx_Math" display="inline" id="S3.Ex1X.10.2.2.m1.2"><semantics id="S3.Ex1X.10.2.2.m1.2a"><mrow id="S3.Ex1X.10.2.2.m1.2.2.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2.cmml">k</mi><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.cmml"><munderover id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2a" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2" movablelimits="false" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.10.2.2.m1.1.1" xref="S3.Ex1X.10.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1a" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mrow id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex1X.10.2.2.m1.2.2.1.2" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1X.10.2.2.m1.2b"><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1"><plus id="S3.Ex1X.10.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1"><times id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.2">𝑘</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1"><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3"><eq id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1"><exp id="S3.Ex1X.10.2.2.m1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.1.1"></exp><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑡</ci><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><times id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1X.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1X.10.2.2.m1.2c">\displaystyle c_{i}+k_{i}\sum_{j=1}^{M}\exp\left(t_{ij}r_{j}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1X.10.2.2.m1.2d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT roman_exp ( italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex1Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="S3.Ex1Xa.2.1.1.1">M3:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{i}(\bm{r})=" class="ltx_Math" display="inline" id="S3.Ex1Xa.4.1.1.m1.1"><semantics id="S3.Ex1Xa.4.1.1.m1.1a"><mrow id="S3.Ex1Xa.4.1.1.m1.1.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.cmml"><mrow id="S3.Ex1Xa.4.1.1.m1.1.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1Xa.4.1.1.m1.1.2.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.4.1.1.m1.1.2.2.1" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.Ex1Xa.4.1.1.m1.1.2.2.3.2" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml"><mo id="S3.Ex1Xa.4.1.1.m1.1.2.2.3.2.1" stretchy="false" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1Xa.4.1.1.m1.1.1" xref="S3.Ex1Xa.4.1.1.m1.1.1.cmml">𝒓</mi><mo id="S3.Ex1Xa.4.1.1.m1.1.2.2.3.2.2" stretchy="false" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1Xa.4.1.1.m1.1.2.1" xref="S3.Ex1Xa.4.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1Xa.4.1.1.m1.1.2.3" xref="S3.Ex1Xa.4.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.4.1.1.m1.1b"><apply id="S3.Ex1Xa.4.1.1.m1.1.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2"><eq id="S3.Ex1Xa.4.1.1.m1.1.2.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.1"></eq><apply id="S3.Ex1Xa.4.1.1.m1.1.2.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2"><times id="S3.Ex1Xa.4.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1Xa.4.1.1.m1.1.1.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1Xa.4.1.1.m1.1.2.3.cmml" xref="S3.Ex1Xa.4.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.4.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1Xa.4.1.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_r ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle c_{i}+k_{i}\exp\left(\prod_{j=1}^{M}t_{ij}r_{j}\right)," class="ltx_Math" display="inline" id="S3.Ex1Xa.5.2.2.m1.2"><semantics id="S3.Ex1Xa.5.2.2.m1.2a"><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2.cmml">k</mi><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2" lspace="0.167em" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.1.1" xref="S3.Ex1Xa.5.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1a" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">∏</mo><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex1Xa.5.2.2.m1.2.2.1.2" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.5.2.2.m1.2b"><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1"><plus id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1"><times id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.2">𝑘</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1"><exp id="S3.Ex1Xa.5.2.2.m1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.1.1"></exp><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1"><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><csymbol cd="latexml" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">product</csymbol><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><eq id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3"><times id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.5.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.5.2.2.m1.2c">\displaystyle c_{i}+k_{i}\exp\left(\prod_{j=1}^{M}t_{ij}r_{j}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1Xa.5.2.2.m1.2d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( ∏ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="S3.Ex1Xa.7.1.1.1">M4:</span></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{i}(\bm{r})=" class="ltx_Math" display="inline" id="S3.Ex1Xa.9.1.1.m1.1"><semantics id="S3.Ex1Xa.9.1.1.m1.1a"><mrow id="S3.Ex1Xa.9.1.1.m1.1.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.cmml"><mrow id="S3.Ex1Xa.9.1.1.m1.1.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml"><msub id="S3.Ex1Xa.9.1.1.m1.1.2.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.cmml"><mi id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2.cmml">L</mi><mi id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.9.1.1.m1.1.2.2.1" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.Ex1Xa.9.1.1.m1.1.2.2.3.2" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml"><mo id="S3.Ex1Xa.9.1.1.m1.1.2.2.3.2.1" stretchy="false" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml">(</mo><mi id="S3.Ex1Xa.9.1.1.m1.1.1" xref="S3.Ex1Xa.9.1.1.m1.1.1.cmml">𝒓</mi><mo id="S3.Ex1Xa.9.1.1.m1.1.2.2.3.2.2" stretchy="false" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1Xa.9.1.1.m1.1.2.1" xref="S3.Ex1Xa.9.1.1.m1.1.2.1.cmml">=</mo><mi id="S3.Ex1Xa.9.1.1.m1.1.2.3" xref="S3.Ex1Xa.9.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.9.1.1.m1.1b"><apply id="S3.Ex1Xa.9.1.1.m1.1.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2"><eq id="S3.Ex1Xa.9.1.1.m1.1.2.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.1"></eq><apply id="S3.Ex1Xa.9.1.1.m1.1.2.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2"><times id="S3.Ex1Xa.9.1.1.m1.1.2.2.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.1"></times><apply id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.2">𝐿</ci><ci id="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex1Xa.9.1.1.m1.1.1.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.1">𝒓</ci></apply><csymbol cd="latexml" id="S3.Ex1Xa.9.1.1.m1.1.2.3.cmml" xref="S3.Ex1Xa.9.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.9.1.1.m1.1c">\displaystyle L_{i}(\bm{r})=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1Xa.9.1.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_r ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle c_{i}+k_{i}\exp\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)." class="ltx_Math" display="inline" id="S3.Ex1Xa.10.2.2.m1.2"><semantics id="S3.Ex1Xa.10.2.2.m1.2a"><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml"><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml"><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2.cmml">c</mi><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2.cmml">k</mi><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2" lspace="0.167em" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.1.1" xref="S3.Ex1Xa.10.2.2.m1.1.1.cmml">exp</mi><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1a" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover></mstyle><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex1Xa.10.2.2.m1.2.2.1.2" lspace="0em" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1Xa.10.2.2.m1.2b"><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1"><plus id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.2"></plus><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.2">𝑐</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1"><times id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.2">𝑘</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1"><exp id="S3.Ex1Xa.10.2.2.m1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.1.1"></exp><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1"><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3"><eq id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3"><times id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1Xa.10.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1Xa.10.2.2.m1.2c">\displaystyle c_{i}+k_{i}\exp\left(\sum_{j=1}^{M}t_{ij}r_{j}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1Xa.10.2.2.m1.2d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p3.2">We summarize their fitting errors on three target domains in Tab.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.T1" title="Table 1 ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="233" id="S3.F3.g1" src="x2.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Quantitative predictability of domain losses on three domain mixtures, Github, Books3, and Pile-CC.
We train on the mixture of these three domains and validate the outcome models on them as well.
The surfaces show the predicted losses on (A) Github; (B) Books3; (C) Pile-CC; and (D) the overall validation set mixed with the three domains.
<math alttext="\times" class="ltx_Math" display="inline" id="S3.F3.3.m1.1"><semantics id="S3.F3.3.m1.1b"><mo id="S3.F3.3.m1.1.1" xref="S3.F3.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F3.3.m1.1c"><times id="S3.F3.3.m1.1.1.cmml" xref="S3.F3.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.F3.3.m1.1e">×</annotation></semantics></math>: validation samples. <math alttext="{\star}" class="ltx_Math" display="inline" id="S3.F3.4.m2.1"><semantics id="S3.F3.4.m2.1b"><mo id="S3.F3.4.m2.1.1" mathcolor="#FF0000" xref="S3.F3.4.m2.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S3.F3.4.m2.1c"><ci id="S3.F3.4.m2.1.1.cmml" xref="S3.F3.4.m2.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m2.1d">{\star}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.4.m2.1e">⋆</annotation></semantics></math>: the predicted minimum loss on the overall validation set.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="830" id="S3.F4.g1" src="x3.png" width="830">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
Prediction results on the domain losses and overall losses in the three-domain experiment. The domain losses are fitted with Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E7" title="7 ‣ Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a> and we obtain the total losses through explicit domain aggregation of Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E8" title="8 ‣ Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a>.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Findings</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.6">The results in Tab.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.T1" title="Table 1 ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a> suggests both M1 and M4 gives reliable predictions while M4 has fewer coefficients.
Therefore we adopt M4</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)}" class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml"><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.cmml"><msub id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.2.2.1.3.cmml"><mi id="S3.E7.m1.2.2.1.3.2" xref="S3.E7.m1.2.2.1.3.2.cmml">L</mi><mi id="S3.E7.m1.2.2.1.3.3" xref="S3.E7.m1.2.2.1.3.3.cmml">i</mi></msub><mo id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mo id="S3.E7.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.2.cmml">r</mi><mrow id="S3.E7.m1.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.3.cmml"><mn id="S3.E7.m1.2.2.1.1.1.1.3.2" xref="S3.E7.m1.2.2.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E7.m1.2.2.1.1.1.1.3.1" xref="S3.E7.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E7.m1.2.2.1.1.1.1.3.3" mathvariant="normal" xref="S3.E7.m1.2.2.1.1.1.1.3.3.cmml">…</mi><mo id="S3.E7.m1.2.2.1.1.1.1.3.1a" xref="S3.E7.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E7.m1.2.2.1.1.1.1.3.4" xref="S3.E7.m1.2.2.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo id="S3.E7.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.3" xref="S3.E7.m1.3.3.3.cmml">=</mo><mrow id="S3.E7.m1.3.3.2" xref="S3.E7.m1.3.3.2.cmml"><msub id="S3.E7.m1.3.3.2.3" xref="S3.E7.m1.3.3.2.3.cmml"><mi id="S3.E7.m1.3.3.2.3.2" xref="S3.E7.m1.3.3.2.3.2.cmml">c</mi><mi id="S3.E7.m1.3.3.2.3.3" xref="S3.E7.m1.3.3.2.3.3.cmml">i</mi></msub><mo id="S3.E7.m1.3.3.2.2" xref="S3.E7.m1.3.3.2.2.cmml">+</mo><mrow id="S3.E7.m1.3.3.2.1" xref="S3.E7.m1.3.3.2.1.cmml"><msub id="S3.E7.m1.3.3.2.1.3" xref="S3.E7.m1.3.3.2.1.3.cmml"><mi id="S3.E7.m1.3.3.2.1.3.2" xref="S3.E7.m1.3.3.2.1.3.2.cmml">k</mi><mi id="S3.E7.m1.3.3.2.1.3.3" xref="S3.E7.m1.3.3.2.1.3.3.cmml">i</mi></msub><mo id="S3.E7.m1.3.3.2.1.2" lspace="0.167em" xref="S3.E7.m1.3.3.2.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.2.1.1.1" xref="S3.E7.m1.3.3.2.1.1.2.cmml"><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">exp</mi><mo id="S3.E7.m1.3.3.2.1.1.1a" xref="S3.E7.m1.3.3.2.1.1.2.cmml">⁡</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.2.cmml"><mo id="S3.E7.m1.3.3.2.1.1.1.1.2" xref="S3.E7.m1.3.3.2.1.1.2.cmml">(</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.cmml"><munderover id="S3.E7.m1.3.3.2.1.1.1.1.1.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E7.m1.3.3.2.1.1.1.1.1.2.1" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E7.m1.3.3.2.1.1.1.1.3" xref="S3.E7.m1.3.3.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"><eq id="S3.E7.m1.3.3.3.cmml" xref="S3.E7.m1.3.3.3"></eq><apply id="S3.E7.m1.2.2.1.cmml" xref="S3.E7.m1.2.2.1"><times id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.2"></times><apply id="S3.E7.m1.2.2.1.3.cmml" xref="S3.E7.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.3.1.cmml" xref="S3.E7.m1.2.2.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.3.2.cmml" xref="S3.E7.m1.2.2.1.3.2">𝐿</ci><ci id="S3.E7.m1.2.2.1.3.3.cmml" xref="S3.E7.m1.2.2.1.3.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2">𝑟</ci><apply id="S3.E7.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3"><times id="S3.E7.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.1"></times><cn id="S3.E7.m1.2.2.1.1.1.1.3.2.cmml" type="integer" xref="S3.E7.m1.2.2.1.1.1.1.3.2">1</cn><ci id="S3.E7.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.3">…</ci><ci id="S3.E7.m1.2.2.1.1.1.1.3.4.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="S3.E7.m1.3.3.2.cmml" xref="S3.E7.m1.3.3.2"><plus id="S3.E7.m1.3.3.2.2.cmml" xref="S3.E7.m1.3.3.2.2"></plus><apply id="S3.E7.m1.3.3.2.3.cmml" xref="S3.E7.m1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.3.1.cmml" xref="S3.E7.m1.3.3.2.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.3.2.cmml" xref="S3.E7.m1.3.3.2.3.2">𝑐</ci><ci id="S3.E7.m1.3.3.2.3.3.cmml" xref="S3.E7.m1.3.3.2.3.3">𝑖</ci></apply><apply id="S3.E7.m1.3.3.2.1.cmml" xref="S3.E7.m1.3.3.2.1"><times id="S3.E7.m1.3.3.2.1.2.cmml" xref="S3.E7.m1.3.3.2.1.2"></times><apply id="S3.E7.m1.3.3.2.1.3.cmml" xref="S3.E7.m1.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.3.1.cmml" xref="S3.E7.m1.3.3.2.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.3.2.cmml" xref="S3.E7.m1.3.3.2.1.3.2">𝑘</ci><ci id="S3.E7.m1.3.3.2.1.3.3.cmml" xref="S3.E7.m1.3.3.2.1.3.3">𝑖</ci></apply><apply id="S3.E7.m1.3.3.2.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1"><exp id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"></exp><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1"><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.2"></sum><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3"><eq id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2"><times id="S3.E7.m1.3.3.2.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.1"></times><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3"><times id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.2.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">L_{i}(r_{1\dots M})=c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}{t_{ij}r_{j}}\right)}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT 1 … italic_M end_POSTSUBSCRIPT ) = italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.5">as the function forms of our data mixing law, where <math alttext="L_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">L</mi><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝐿</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">L_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the validation loss on <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">italic_i</annotation></semantics></math>-th validation domain, <math alttext="r_{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml">r</mi><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2">𝑟</ci><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">r_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.3.m3.1d">italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the proportion of the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.4.m4.1d">italic_j</annotation></semantics></math>-th training domain, and <math alttext="c_{i},k_{i},t_{ij}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.5.m5.3"><semantics id="S3.SS2.SSS0.Px2.p1.5.m5.3a"><mrow id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml"><msub id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.4" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.5" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2.cmml">i</mi><mo id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m5.3b"><list id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.4.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3"><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.2">𝑡</ci><apply id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3"><times id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.1"></times><ci id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.3.3.3.3.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m5.3c">c_{i},k_{i},t_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.5.m5.3d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are learnable parameters.
The fitting results are in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.F3" title="Figure 3 ‣ Setups ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3</span></a> and Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.F4" title="Figure 4 ‣ Setups ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrates the prediction accuracy.
The results indicate that Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E7" title="7 ‣ Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a> fits the given samples well and estimates the unseen ones accurately.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.11">To provide more intuition, we discuss the meanings of the coefficients in Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E7" title="7 ‣ Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a>. In general, <math alttext="k_{i}>0" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1"><gt id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1"></gt><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3">𝑖</ci></apply><cn id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">k_{i}&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.1.m1.1d">italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT &gt; 0</annotation></semantics></math>, thus the exponential term is always positive and the prediction loss is strictly greater than the constant <math alttext="c" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.2.m2.1d">italic_c</annotation></semantics></math>.
Hereby, <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.1a"><msub id="S3.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml">c</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.2">𝑐</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.3.m3.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents losses that are not reducible by adjusting the data mixture.
<math alttext="t_{ij}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p2.4.m4.1a"><msub id="S3.SS2.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2">𝑡</ci><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3"><times id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.4.m4.1c">t_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.4.m4.1d">italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, depending on both training domain <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.5.m5.1"><semantics id="S3.SS2.SSS0.Px2.p2.5.m5.1a"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.5.m5.1b"><ci id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.5.m5.1d">italic_i</annotation></semantics></math> and validation domain <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.6.m6.1"><semantics id="S3.SS2.SSS0.Px2.p2.6.m6.1a"><mi id="S3.SS2.SSS0.Px2.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.6.m6.1b"><ci id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.6.m6.1d">italic_j</annotation></semantics></math>, shows the interaction between them.
A negative <math alttext="t_{ij}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.7.m7.1"><semantics id="S3.SS2.SSS0.Px2.p2.7.m7.1a"><msub id="S3.SS2.SSS0.Px2.p2.7.m7.1.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2.cmml">t</mi><mrow id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.7.m7.1b"><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2">𝑡</ci><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3"><times id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.1"></times><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.7.m7.1c">t_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.7.m7.1d">italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> indicates that training data of domain <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.8.m8.1"><semantics id="S3.SS2.SSS0.Px2.p2.8.m8.1a"><mi id="S3.SS2.SSS0.Px2.p2.8.m8.1.1" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.8.m8.1b"><ci id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.8.m8.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.8.m8.1d">italic_j</annotation></semantics></math> helps reduce validation loss on domain <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.9.m9.1"><semantics id="S3.SS2.SSS0.Px2.p2.9.m9.1a"><mi id="S3.SS2.SSS0.Px2.p2.9.m9.1.1" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.9.m9.1b"><ci id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.9.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.9.m9.1d">italic_i</annotation></semantics></math> and vice versa.
Besides, rewriting the coefficient <math alttext="k_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.10.m10.1"><semantics id="S3.SS2.SSS0.Px2.p2.10.m10.1a"><msub id="S3.SS2.SSS0.Px2.p2.10.m10.1.1" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.10.m10.1b"><apply id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.10.m10.1c">k_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.10.m10.1d">italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> into <math alttext="\exp(\log k_{i})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.11.m11.2"><semantics id="S3.SS2.SSS0.Px2.p2.11.m11.2a"><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1.cmml">exp</mi><mo id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1a" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml">⁡</mo><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml"><mo id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1.cmml">log</mi><mo id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1a" lspace="0.167em" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.cmml">⁡</mo><msub id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3.cmml">i</mi></msub></mrow><mo id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.11.m11.2b"><apply id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1"><exp id="S3.SS2.SSS0.Px2.p2.11.m11.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.1.1"></exp><apply id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1"><log id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.1"></log><apply id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.2">𝑘</ci><ci id="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.11.m11.2.2.1.1.1.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.11.m11.2c">\exp(\log k_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.11.m11.2d">roman_exp ( roman_log italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> makes it a bias term on the exponent which adjusts the aggregate effect of all training domains.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Predicting Losses of Any Validation Mixture</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">We further loosen constraints in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.1</span></a> and Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.2</span></a> that the validation data are from one of the training domains.
We first consider the validation set to be a known composition of the training domains and then free this requirement for more general cases of arbitrary validation sets.
These correspond to the two strategies we fit the data mixing laws, which we elaborate on as follows.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Explicit domain aggregation.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.2">Considering a validation set made up of <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.1.m1.1d">italic_K</annotation></semantics></math> domains with the proportions as <math alttext="s_{1\dots K}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3" mathvariant="normal" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml">…</mi><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1a" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2">𝑠</ci><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3"><times id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.1"></times><cn id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.2">1</cn><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.3">…</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">s_{1\dots K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT 1 … italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, the validation loss can be written into the weighted sum of domain losses.
Thanks to the discovery of Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E7" title="7 ‣ Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a>, we can apply the equation to predict domain losses herein given a training mixture.
Therefore, the functional relationship of the overall validation loss to the training mixture proportions expands into</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}%
\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right]." class="ltx_Math" display="block" id="S3.E8.m1.2"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.3.cmml">L</mi><mo id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.3.cmml">…</mi><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1a" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.3.4" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo id="S3.E8.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.5" rspace="0.111em" xref="S3.E8.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.1.2.cmml"><munderover id="S3.E8.m1.2.2.1.1.2.2" xref="S3.E8.m1.2.2.1.1.2.2.cmml"><mo id="S3.E8.m1.2.2.1.1.2.2.2.2" movablelimits="false" xref="S3.E8.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.2.2.2.3" xref="S3.E8.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.2.2.2.3.2" xref="S3.E8.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.1.1.2.2.2.3.1" xref="S3.E8.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.2.2.2.3.3" xref="S3.E8.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.2.2.3" xref="S3.E8.m1.2.2.1.1.2.2.3.cmml">K</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.2.1" xref="S3.E8.m1.2.2.1.1.2.1.cmml"><msub id="S3.E8.m1.2.2.1.1.2.1.3" xref="S3.E8.m1.2.2.1.1.2.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.3.2" xref="S3.E8.m1.2.2.1.1.2.1.3.2.cmml">s</mi><mi id="S3.E8.m1.2.2.1.1.2.1.3.3" xref="S3.E8.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.2.1.2" xref="S3.E8.m1.2.2.1.1.2.1.2.cmml">⁢</mo><msub id="S3.E8.m1.2.2.1.1.2.1.4" xref="S3.E8.m1.2.2.1.1.2.1.4.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.4.2" xref="S3.E8.m1.2.2.1.1.2.1.4.2.cmml">L</mi><mi id="S3.E8.m1.2.2.1.1.2.1.4.3" xref="S3.E8.m1.2.2.1.1.2.1.4.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.2.1.2a" xref="S3.E8.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.2.1.1.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml"><mo id="S3.E8.m1.2.2.1.1.2.1.1.1.2" stretchy="false" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.2.cmml">r</mi><mrow id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mn id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3" mathvariant="normal" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">…</mi><mo id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1a" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo id="S3.E8.m1.2.2.1.1.2.1.1.1.3" stretchy="false" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.6" rspace="0.111em" xref="S3.E8.m1.2.2.1.1.6.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.3.cmml"><munderover id="S3.E8.m1.2.2.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.2.cmml"><mo id="S3.E8.m1.2.2.1.1.3.2.2.2" movablelimits="false" xref="S3.E8.m1.2.2.1.1.3.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.3.2.2.3" xref="S3.E8.m1.2.2.1.1.3.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.2.2.3.2" xref="S3.E8.m1.2.2.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.1.1.3.2.2.3.1" xref="S3.E8.m1.2.2.1.1.3.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.3.2.2.3.3" xref="S3.E8.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.3.2.3" xref="S3.E8.m1.2.2.1.1.3.2.3.cmml">K</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.3.1" xref="S3.E8.m1.2.2.1.1.3.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.3" xref="S3.E8.m1.2.2.1.1.3.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.3.2" xref="S3.E8.m1.2.2.1.1.3.1.3.2.cmml">s</mi><mi id="S3.E8.m1.2.2.1.1.3.1.3.3" xref="S3.E8.m1.2.2.1.1.3.1.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.3.1.2" xref="S3.E8.m1.2.2.1.1.3.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.2.1.cmml">[</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2.cmml">c</mi><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.2.cmml">+</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml">k</mi><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2" lspace="0.167em" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">exp</mi><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1a" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.3.1.1.1.3" xref="S3.E8.m1.2.2.1.1.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.2" lspace="0em" xref="S3.E8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1"><and id="S3.E8.m1.2.2.1.1a.cmml" xref="S3.E8.m1.2.2.1"></and><apply id="S3.E8.m1.2.2.1.1b.cmml" xref="S3.E8.m1.2.2.1"><eq id="S3.E8.m1.2.2.1.1.5.cmml" xref="S3.E8.m1.2.2.1.1.5"></eq><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><times id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2"></times><ci id="S3.E8.m1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3">𝐿</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E8.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.1"></times><cn id="S3.E8.m1.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.3">…</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="S3.E8.m1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2"><apply id="S3.E8.m1.2.2.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3"><eq id="S3.E8.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2.2.3.2">𝑖</ci><cn id="S3.E8.m1.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.2.3">𝐾</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1"><times id="S3.E8.m1.2.2.1.1.2.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.2"></times><apply id="S3.E8.m1.2.2.1.1.2.1.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3.2">𝑠</ci><ci id="S3.E8.m1.2.2.1.1.2.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.4.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.4.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.4.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4.2">𝐿</ci><ci id="S3.E8.m1.2.2.1.1.2.1.4.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.4.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.2">𝑟</ci><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3"><times id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.1"></times><cn id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.2">1</cn><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.3">…</ci><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.3.4">𝑀</ci></apply></apply></apply></apply></apply><apply id="S3.E8.m1.2.2.1.1c.cmml" xref="S3.E8.m1.2.2.1"><eq id="S3.E8.m1.2.2.1.1.6.cmml" xref="S3.E8.m1.2.2.1.1.6"></eq><share href="#S3.E8.m1.2.2.1.1.2.cmml" id="S3.E8.m1.2.2.1.1d.cmml" xref="S3.E8.m1.2.2.1"></share><apply id="S3.E8.m1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3"><apply id="S3.E8.m1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.3.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3"><eq id="S3.E8.m1.2.2.1.1.3.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.3.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2.3.2">𝑖</ci><cn id="S3.E8.m1.2.2.1.1.3.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.3.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.2.3">𝐾</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1"><times id="S3.E8.m1.2.2.1.1.3.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.2"></times><apply id="S3.E8.m1.2.2.1.1.3.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3.2">𝑠</ci><ci id="S3.E8.m1.2.2.1.1.3.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.2.2.1.1.3.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.2">delimited-[]</csymbol><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1"><plus id="S3.E8.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.2"></plus><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.2">𝑐</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1"><times id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.2"></times><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1"><exp id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"></exp><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1"><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3"><eq id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2"><times id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3"><times id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}%
\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.2d">italic_L ( italic_r start_POSTSUBSCRIPT 1 … italic_M end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT 1 … italic_M end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.3">Using Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E8" title="8 ‣ Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a>, we can fit the loss on each validation domain <math alttext="L_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.3.m1.1"><semantics id="S3.SS3.SSS0.Px1.p1.3.m1.1a"><msub id="S3.SS3.SSS0.Px1.p1.3.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2.cmml">L</mi><mi id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.2">𝐿</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m1.1c">L_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.3.m1.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and sum them up to obtain the prediction of overall loss.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Implicit domain aggregation.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.3">A remaining limitation is that we still need to acquire the components of validation data <math alttext="s_{1\dots K}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.2">𝑠</ci><apply id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.1"></times><cn id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.2">1</cn><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.3">…</ci><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">s_{1\dots K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT 1 … italic_K end_POSTSUBSCRIPT</annotation></semantics></math> in advance.
This can be inconvenient if the validation set is collected separately from the training ones.
For instance, the validation data may come from real-world user queries that cover unknown compositions of various domains.
To remove the constraint on validation components, we assume that we can decompose the validation data into <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.2.m2.1d">italic_K</annotation></semantics></math> implicit domains whose losses are predictable with Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E7" title="7 ‣ Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a>, and we treat their proportions in the validation data <math alttext="s_{1\dots K}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml">s</mi><mrow id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mn id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">1</mn><mo id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1a" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2">𝑠</ci><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.1"></times><cn id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.2">1</cn><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.3">…</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m3.1c">s_{1\dots K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.3.m3.1d">italic_s start_POSTSUBSCRIPT 1 … italic_K end_POSTSUBSCRIPT</annotation></semantics></math> as learnable parameters.
This leads to the final form of our data mixing laws<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>We note that the final forms of our data mixing law resemble a multilayer perception (see the computation graph Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A3.F10" title="Figure 10 ‣ Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">10</span></a>). We include further discussion and implementation details in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A3" title="Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">C</span></a>.</span></span></span>.
With this perspective, we fit a data mixing law with the overall losses end to end.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="299" id="S3.F5.g1" src="extracted/5490388/figs/5mix_end2end.png" width="598">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Prediction errors of the five-domain data mixing laws fitted with explicit and implicit domain aggregation.
<span class="ltx_text ltx_font_italic" id="S3.F5.5.1">Explicit domain aggregation</span>: we fit Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E7" title="7 ‣ Findings ‣ 3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a> for five domains respectively and sum them up according to their weight in the overall validation sets.
<span class="ltx_text ltx_font_italic" id="S3.F5.6.2">Implicit domain aggregation</span>: we fit the losses on overall validation with Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E8" title="8 ‣ Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a>, assuming different numbers of implicit domains <math alttext="K" class="ltx_Math" display="inline" id="S3.F5.2.m1.1"><semantics id="S3.F5.2.m1.1b"><mi id="S3.F5.2.m1.1.1" xref="S3.F5.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F5.2.m1.1c"><ci id="S3.F5.2.m1.1.1.cmml" xref="S3.F5.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.2.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.F5.2.m1.1e">italic_K</annotation></semantics></math> and treating the proportion of different implicit domains as learnable parameters.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p2.1">Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.F5" title="Figure 5 ‣ Implicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">5</span></a> shows our experiments where we train language models on the 5 coarse-grained domains of Pile<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>The Pile contains 22 fine-grained domains which are collected into five coarse-grained domains, i.e., academic, internet, prose, dialogues, and misc, where misc include Github and the DeepMind Mathematics Dataset which are symbolic content. We do not experiment on fine-grained domains for their limited number of tokens available.</span></span></span> and evaluate a validation set mixed with these 5 domains.
We compare the errors obtained by implicit domain aggregation with different numbers of implicit domains to those obtained by explicit domain aggregation.
We find that applying implicit domain aggregation and setting the number of implicit domains no smaller than the actual one (5 in the experimented case) results in lower errors than explicit domain aggregation.
Moreover, the error remains low as we set the number of implicit domains much larger.
This verifies the prediction accuracy of our implicit domain aggregation strategy for data mixing law and the number of implicit domains <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.1.m1.1d">italic_K</annotation></semantics></math> can be a large number without careful tuning<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span>We set <math alttext="K=30" class="ltx_Math" display="inline" id="footnote8.m1.1"><semantics id="footnote8.m1.1b"><mrow id="footnote8.m1.1.1" xref="footnote8.m1.1.1.cmml"><mi id="footnote8.m1.1.1.2" xref="footnote8.m1.1.1.2.cmml">K</mi><mo id="footnote8.m1.1.1.1" xref="footnote8.m1.1.1.1.cmml">=</mo><mn id="footnote8.m1.1.1.3" xref="footnote8.m1.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote8.m1.1c"><apply id="footnote8.m1.1.1.cmml" xref="footnote8.m1.1.1"><eq id="footnote8.m1.1.1.1.cmml" xref="footnote8.m1.1.1.1"></eq><ci id="footnote8.m1.1.1.2.cmml" xref="footnote8.m1.1.1.2">𝐾</ci><cn id="footnote8.m1.1.1.3.cmml" type="integer" xref="footnote8.m1.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m1.1d">K=30</annotation><annotation encoding="application/x-llamapun" id="footnote8.m1.1e">italic_K = 30</annotation></semantics></math> if not stated in the rest of this paper.</span></span></span>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Nested scaling laws predict losses trained on various mixtures using only small-scale experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_float ltx_float_algorithm ltx_framed_top" id="alg1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> A pipeline to predict losses of different mixture proportions on large models trained on massive data through small-scale training</figcaption>
<div class="ltx_listing ltx_align_center ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg1.l1.1">Input:</span> Validation data <math alttext="D_{val}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">D</mi><mrow id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.3.2.cmml">v</mi><mo id="alg1.l1.m1.1.1.3.1" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml">a</mi><mo id="alg1.l1.m1.1.1.3.1a" xref="alg1.l1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3.4" xref="alg1.l1.m1.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝐷</ci><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><times id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.1"></times><ci id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2">𝑣</ci><ci id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">𝑎</ci><ci id="alg1.l1.m1.1.1.3.4.cmml" xref="alg1.l1.m1.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">D_{val}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_D start_POSTSUBSCRIPT italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, training data of <math alttext="M" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_M</annotation></semantics></math> domains <math alttext="\{D_{m}\}_{m=1}^{M}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><msubsup id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mrow id="alg1.l1.m3.1.1.1.1.1" xref="alg1.l1.m3.1.1.1.1.2.cmml"><mo id="alg1.l1.m3.1.1.1.1.1.2" stretchy="false" xref="alg1.l1.m3.1.1.1.1.2.cmml">{</mo><msub id="alg1.l1.m3.1.1.1.1.1.1" xref="alg1.l1.m3.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m3.1.1.1.1.1.1.2" xref="alg1.l1.m3.1.1.1.1.1.1.2.cmml">D</mi><mi id="alg1.l1.m3.1.1.1.1.1.1.3" xref="alg1.l1.m3.1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="alg1.l1.m3.1.1.1.1.1.3" stretchy="false" xref="alg1.l1.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m3.1.1.1.3" xref="alg1.l1.m3.1.1.1.3.cmml"><mi id="alg1.l1.m3.1.1.1.3.2" xref="alg1.l1.m3.1.1.1.3.2.cmml">m</mi><mo id="alg1.l1.m3.1.1.1.3.1" xref="alg1.l1.m3.1.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m3.1.1.1.3.3" xref="alg1.l1.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1">superscript</csymbol><apply id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.2.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><set id="alg1.l1.m3.1.1.1.1.2.cmml" xref="alg1.l1.m3.1.1.1.1.1"><apply id="alg1.l1.m3.1.1.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m3.1.1.1.1.1.1.2">𝐷</ci><ci id="alg1.l1.m3.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m3.1.1.1.1.1.1.3">𝑚</ci></apply></set><apply id="alg1.l1.m3.1.1.1.3.cmml" xref="alg1.l1.m3.1.1.1.3"><eq id="alg1.l1.m3.1.1.1.3.1.cmml" xref="alg1.l1.m3.1.1.1.3.1"></eq><ci id="alg1.l1.m3.1.1.1.3.2.cmml" xref="alg1.l1.m3.1.1.1.3.2">𝑚</ci><cn id="alg1.l1.m3.1.1.1.3.3.cmml" type="integer" xref="alg1.l1.m3.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\{D_{m}\}_{m=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">{ italic_D start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, target training steps <math alttext="S_{target}" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><msub id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">S</mi><mrow id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml"><mi id="alg1.l1.m4.1.1.3.2" xref="alg1.l1.m4.1.1.3.2.cmml">t</mi><mo id="alg1.l1.m4.1.1.3.1" xref="alg1.l1.m4.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m4.1.1.3.3" xref="alg1.l1.m4.1.1.3.3.cmml">a</mi><mo id="alg1.l1.m4.1.1.3.1a" xref="alg1.l1.m4.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m4.1.1.3.4" xref="alg1.l1.m4.1.1.3.4.cmml">r</mi><mo id="alg1.l1.m4.1.1.3.1b" xref="alg1.l1.m4.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m4.1.1.3.5" xref="alg1.l1.m4.1.1.3.5.cmml">g</mi><mo id="alg1.l1.m4.1.1.3.1c" xref="alg1.l1.m4.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m4.1.1.3.6" xref="alg1.l1.m4.1.1.3.6.cmml">e</mi><mo id="alg1.l1.m4.1.1.3.1d" xref="alg1.l1.m4.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m4.1.1.3.7" xref="alg1.l1.m4.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝑆</ci><apply id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3"><times id="alg1.l1.m4.1.1.3.1.cmml" xref="alg1.l1.m4.1.1.3.1"></times><ci id="alg1.l1.m4.1.1.3.2.cmml" xref="alg1.l1.m4.1.1.3.2">𝑡</ci><ci id="alg1.l1.m4.1.1.3.3.cmml" xref="alg1.l1.m4.1.1.3.3">𝑎</ci><ci id="alg1.l1.m4.1.1.3.4.cmml" xref="alg1.l1.m4.1.1.3.4">𝑟</ci><ci id="alg1.l1.m4.1.1.3.5.cmml" xref="alg1.l1.m4.1.1.3.5">𝑔</ci><ci id="alg1.l1.m4.1.1.3.6.cmml" xref="alg1.l1.m4.1.1.3.6">𝑒</ci><ci id="alg1.l1.m4.1.1.3.7.cmml" xref="alg1.l1.m4.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">S_{target}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_S start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, target model size <math alttext="N_{target}" class="ltx_Math" display="inline" id="alg1.l1.m5.1"><semantics id="alg1.l1.m5.1a"><msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">N</mi><mrow id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml"><mi id="alg1.l1.m5.1.1.3.2" xref="alg1.l1.m5.1.1.3.2.cmml">t</mi><mo id="alg1.l1.m5.1.1.3.1" xref="alg1.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m5.1.1.3.3" xref="alg1.l1.m5.1.1.3.3.cmml">a</mi><mo id="alg1.l1.m5.1.1.3.1a" xref="alg1.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m5.1.1.3.4" xref="alg1.l1.m5.1.1.3.4.cmml">r</mi><mo id="alg1.l1.m5.1.1.3.1b" xref="alg1.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m5.1.1.3.5" xref="alg1.l1.m5.1.1.3.5.cmml">g</mi><mo id="alg1.l1.m5.1.1.3.1c" xref="alg1.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m5.1.1.3.6" xref="alg1.l1.m5.1.1.3.6.cmml">e</mi><mo id="alg1.l1.m5.1.1.3.1d" xref="alg1.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m5.1.1.3.7" xref="alg1.l1.m5.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">subscript</csymbol><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">𝑁</ci><apply id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3"><times id="alg1.l1.m5.1.1.3.1.cmml" xref="alg1.l1.m5.1.1.3.1"></times><ci id="alg1.l1.m5.1.1.3.2.cmml" xref="alg1.l1.m5.1.1.3.2">𝑡</ci><ci id="alg1.l1.m5.1.1.3.3.cmml" xref="alg1.l1.m5.1.1.3.3">𝑎</ci><ci id="alg1.l1.m5.1.1.3.4.cmml" xref="alg1.l1.m5.1.1.3.4">𝑟</ci><ci id="alg1.l1.m5.1.1.3.5.cmml" xref="alg1.l1.m5.1.1.3.5">𝑔</ci><ci id="alg1.l1.m5.1.1.3.6.cmml" xref="alg1.l1.m5.1.1.3.6">𝑒</ci><ci id="alg1.l1.m5.1.1.3.7.cmml" xref="alg1.l1.m5.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">N_{target}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.1d">italic_N start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, target mixture to predict <math alttext="\bm{r}_{target}" class="ltx_Math" display="inline" id="alg1.l1.m6.1"><semantics id="alg1.l1.m6.1a"><msub id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml"><mi id="alg1.l1.m6.1.1.2" xref="alg1.l1.m6.1.1.2.cmml">𝒓</mi><mrow id="alg1.l1.m6.1.1.3" xref="alg1.l1.m6.1.1.3.cmml"><mi id="alg1.l1.m6.1.1.3.2" xref="alg1.l1.m6.1.1.3.2.cmml">t</mi><mo id="alg1.l1.m6.1.1.3.1" xref="alg1.l1.m6.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m6.1.1.3.3" xref="alg1.l1.m6.1.1.3.3.cmml">a</mi><mo id="alg1.l1.m6.1.1.3.1a" xref="alg1.l1.m6.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m6.1.1.3.4" xref="alg1.l1.m6.1.1.3.4.cmml">r</mi><mo id="alg1.l1.m6.1.1.3.1b" xref="alg1.l1.m6.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m6.1.1.3.5" xref="alg1.l1.m6.1.1.3.5.cmml">g</mi><mo id="alg1.l1.m6.1.1.3.1c" xref="alg1.l1.m6.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m6.1.1.3.6" xref="alg1.l1.m6.1.1.3.6.cmml">e</mi><mo id="alg1.l1.m6.1.1.3.1d" xref="alg1.l1.m6.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m6.1.1.3.7" xref="alg1.l1.m6.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><apply id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1"><csymbol cd="ambiguous" id="alg1.l1.m6.1.1.1.cmml" xref="alg1.l1.m6.1.1">subscript</csymbol><ci id="alg1.l1.m6.1.1.2.cmml" xref="alg1.l1.m6.1.1.2">𝒓</ci><apply id="alg1.l1.m6.1.1.3.cmml" xref="alg1.l1.m6.1.1.3"><times id="alg1.l1.m6.1.1.3.1.cmml" xref="alg1.l1.m6.1.1.3.1"></times><ci id="alg1.l1.m6.1.1.3.2.cmml" xref="alg1.l1.m6.1.1.3.2">𝑡</ci><ci id="alg1.l1.m6.1.1.3.3.cmml" xref="alg1.l1.m6.1.1.3.3">𝑎</ci><ci id="alg1.l1.m6.1.1.3.4.cmml" xref="alg1.l1.m6.1.1.3.4">𝑟</ci><ci id="alg1.l1.m6.1.1.3.5.cmml" xref="alg1.l1.m6.1.1.3.5">𝑔</ci><ci id="alg1.l1.m6.1.1.3.6.cmml" xref="alg1.l1.m6.1.1.3.6">𝑒</ci><ci id="alg1.l1.m6.1.1.3.7.cmml" xref="alg1.l1.m6.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">\bm{r}_{target}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m6.1d">bold_italic_r start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, training steps to fit the step laws <math alttext="S_{0}" class="ltx_Math" display="inline" id="alg1.l1.m7.1"><semantics id="alg1.l1.m7.1a"><msub id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml"><mi id="alg1.l1.m7.1.1.2" xref="alg1.l1.m7.1.1.2.cmml">S</mi><mn id="alg1.l1.m7.1.1.3" xref="alg1.l1.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><apply id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1"><csymbol cd="ambiguous" id="alg1.l1.m7.1.1.1.cmml" xref="alg1.l1.m7.1.1">subscript</csymbol><ci id="alg1.l1.m7.1.1.2.cmml" xref="alg1.l1.m7.1.1.2">𝑆</ci><cn id="alg1.l1.m7.1.1.3.cmml" type="integer" xref="alg1.l1.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">S_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m7.1d">italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, model sizes to fit the size laws <math alttext="\{N_{i}\}" class="ltx_Math" display="inline" id="alg1.l1.m8.1"><semantics id="alg1.l1.m8.1a"><mrow id="alg1.l1.m8.1.1.1" xref="alg1.l1.m8.1.1.2.cmml"><mo id="alg1.l1.m8.1.1.1.2" stretchy="false" xref="alg1.l1.m8.1.1.2.cmml">{</mo><msub id="alg1.l1.m8.1.1.1.1" xref="alg1.l1.m8.1.1.1.1.cmml"><mi id="alg1.l1.m8.1.1.1.1.2" xref="alg1.l1.m8.1.1.1.1.2.cmml">N</mi><mi id="alg1.l1.m8.1.1.1.1.3" xref="alg1.l1.m8.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l1.m8.1.1.1.3" stretchy="false" xref="alg1.l1.m8.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m8.1b"><set id="alg1.l1.m8.1.1.2.cmml" xref="alg1.l1.m8.1.1.1"><apply id="alg1.l1.m8.1.1.1.1.cmml" xref="alg1.l1.m8.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m8.1.1.1.1.1.cmml" xref="alg1.l1.m8.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m8.1.1.1.1.2.cmml" xref="alg1.l1.m8.1.1.1.1.2">𝑁</ci><ci id="alg1.l1.m8.1.1.1.1.3.cmml" xref="alg1.l1.m8.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m8.1c">\{N_{i}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m8.1d">{ italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>, and <math alttext="N" class="ltx_Math" display="inline" id="alg1.l1.m9.1"><semantics id="alg1.l1.m9.1a"><mi id="alg1.l1.m9.1.1" xref="alg1.l1.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m9.1b"><ci id="alg1.l1.m9.1.1.cmml" xref="alg1.l1.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m9.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m9.1d">italic_N</annotation></semantics></math> data mixtures <math alttext="\{\bm{r}_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="alg1.l1.m10.1"><semantics id="alg1.l1.m10.1a"><msubsup id="alg1.l1.m10.1.1" xref="alg1.l1.m10.1.1.cmml"><mrow id="alg1.l1.m10.1.1.1.1.1" xref="alg1.l1.m10.1.1.1.1.2.cmml"><mo id="alg1.l1.m10.1.1.1.1.1.2" stretchy="false" xref="alg1.l1.m10.1.1.1.1.2.cmml">{</mo><msub id="alg1.l1.m10.1.1.1.1.1.1" xref="alg1.l1.m10.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m10.1.1.1.1.1.1.2" xref="alg1.l1.m10.1.1.1.1.1.1.2.cmml">𝒓</mi><mi id="alg1.l1.m10.1.1.1.1.1.1.3" xref="alg1.l1.m10.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l1.m10.1.1.1.1.1.3" stretchy="false" xref="alg1.l1.m10.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m10.1.1.1.3" xref="alg1.l1.m10.1.1.1.3.cmml"><mi id="alg1.l1.m10.1.1.1.3.2" xref="alg1.l1.m10.1.1.1.3.2.cmml">i</mi><mo id="alg1.l1.m10.1.1.1.3.1" xref="alg1.l1.m10.1.1.1.3.1.cmml">=</mo><mn id="alg1.l1.m10.1.1.1.3.3" xref="alg1.l1.m10.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m10.1.1.3" xref="alg1.l1.m10.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m10.1b"><apply id="alg1.l1.m10.1.1.cmml" xref="alg1.l1.m10.1.1"><csymbol cd="ambiguous" id="alg1.l1.m10.1.1.2.cmml" xref="alg1.l1.m10.1.1">superscript</csymbol><apply id="alg1.l1.m10.1.1.1.cmml" xref="alg1.l1.m10.1.1"><csymbol cd="ambiguous" id="alg1.l1.m10.1.1.1.2.cmml" xref="alg1.l1.m10.1.1">subscript</csymbol><set id="alg1.l1.m10.1.1.1.1.2.cmml" xref="alg1.l1.m10.1.1.1.1.1"><apply id="alg1.l1.m10.1.1.1.1.1.1.cmml" xref="alg1.l1.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m10.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m10.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m10.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m10.1.1.1.1.1.1.2">𝒓</ci><ci id="alg1.l1.m10.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m10.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="alg1.l1.m10.1.1.1.3.cmml" xref="alg1.l1.m10.1.1.1.3"><eq id="alg1.l1.m10.1.1.1.3.1.cmml" xref="alg1.l1.m10.1.1.1.3.1"></eq><ci id="alg1.l1.m10.1.1.1.3.2.cmml" xref="alg1.l1.m10.1.1.1.3.2">𝑖</ci><cn id="alg1.l1.m10.1.1.1.3.3.cmml" type="integer" xref="alg1.l1.m10.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m10.1.1.3.cmml" xref="alg1.l1.m10.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m10.1c">\{\bm{r}_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m10.1d">{ bold_italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> to fit.

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg1.l2.1">Output:</span> The validation loss of a <math alttext="N_{target}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">N</mi><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l2.m1.1.1.3.1" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">a</mi><mo id="alg1.l2.m1.1.1.3.1a" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.4" xref="alg1.l2.m1.1.1.3.4.cmml">r</mi><mo id="alg1.l2.m1.1.1.3.1b" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.5" xref="alg1.l2.m1.1.1.3.5.cmml">g</mi><mo id="alg1.l2.m1.1.1.3.1c" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.6" xref="alg1.l2.m1.1.1.3.6.cmml">e</mi><mo id="alg1.l2.m1.1.1.3.1d" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.7" xref="alg1.l2.m1.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑁</ci><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><times id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"></times><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">𝑡</ci><ci id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">𝑎</ci><ci id="alg1.l2.m1.1.1.3.4.cmml" xref="alg1.l2.m1.1.1.3.4">𝑟</ci><ci id="alg1.l2.m1.1.1.3.5.cmml" xref="alg1.l2.m1.1.1.3.5">𝑔</ci><ci id="alg1.l2.m1.1.1.3.6.cmml" xref="alg1.l2.m1.1.1.3.6">𝑒</ci><ci id="alg1.l2.m1.1.1.3.7.cmml" xref="alg1.l2.m1.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">N_{target}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_N start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> model trained for <math alttext="S_{target}" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">S</mi><mrow id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml"><mi id="alg1.l2.m2.1.1.3.2" xref="alg1.l2.m2.1.1.3.2.cmml">t</mi><mo id="alg1.l2.m2.1.1.3.1" xref="alg1.l2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m2.1.1.3.3" xref="alg1.l2.m2.1.1.3.3.cmml">a</mi><mo id="alg1.l2.m2.1.1.3.1a" xref="alg1.l2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m2.1.1.3.4" xref="alg1.l2.m2.1.1.3.4.cmml">r</mi><mo id="alg1.l2.m2.1.1.3.1b" xref="alg1.l2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m2.1.1.3.5" xref="alg1.l2.m2.1.1.3.5.cmml">g</mi><mo id="alg1.l2.m2.1.1.3.1c" xref="alg1.l2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m2.1.1.3.6" xref="alg1.l2.m2.1.1.3.6.cmml">e</mi><mo id="alg1.l2.m2.1.1.3.1d" xref="alg1.l2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m2.1.1.3.7" xref="alg1.l2.m2.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑆</ci><apply id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3"><times id="alg1.l2.m2.1.1.3.1.cmml" xref="alg1.l2.m2.1.1.3.1"></times><ci id="alg1.l2.m2.1.1.3.2.cmml" xref="alg1.l2.m2.1.1.3.2">𝑡</ci><ci id="alg1.l2.m2.1.1.3.3.cmml" xref="alg1.l2.m2.1.1.3.3">𝑎</ci><ci id="alg1.l2.m2.1.1.3.4.cmml" xref="alg1.l2.m2.1.1.3.4">𝑟</ci><ci id="alg1.l2.m2.1.1.3.5.cmml" xref="alg1.l2.m2.1.1.3.5">𝑔</ci><ci id="alg1.l2.m2.1.1.3.6.cmml" xref="alg1.l2.m2.1.1.3.6">𝑒</ci><ci id="alg1.l2.m2.1.1.3.7.cmml" xref="alg1.l2.m2.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">S_{target}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_S start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> steps on mixture <math alttext="\bm{r}_{target}" class="ltx_Math" display="inline" id="alg1.l2.m3.1"><semantics id="alg1.l2.m3.1a"><msub id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">𝒓</mi><mrow id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml"><mi id="alg1.l2.m3.1.1.3.2" xref="alg1.l2.m3.1.1.3.2.cmml">t</mi><mo id="alg1.l2.m3.1.1.3.1" xref="alg1.l2.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m3.1.1.3.3" xref="alg1.l2.m3.1.1.3.3.cmml">a</mi><mo id="alg1.l2.m3.1.1.3.1a" xref="alg1.l2.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m3.1.1.3.4" xref="alg1.l2.m3.1.1.3.4.cmml">r</mi><mo id="alg1.l2.m3.1.1.3.1b" xref="alg1.l2.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m3.1.1.3.5" xref="alg1.l2.m3.1.1.3.5.cmml">g</mi><mo id="alg1.l2.m3.1.1.3.1c" xref="alg1.l2.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m3.1.1.3.6" xref="alg1.l2.m3.1.1.3.6.cmml">e</mi><mo id="alg1.l2.m3.1.1.3.1d" xref="alg1.l2.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m3.1.1.3.7" xref="alg1.l2.m3.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">𝒓</ci><apply id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3"><times id="alg1.l2.m3.1.1.3.1.cmml" xref="alg1.l2.m3.1.1.3.1"></times><ci id="alg1.l2.m3.1.1.3.2.cmml" xref="alg1.l2.m3.1.1.3.2">𝑡</ci><ci id="alg1.l2.m3.1.1.3.3.cmml" xref="alg1.l2.m3.1.1.3.3">𝑎</ci><ci id="alg1.l2.m3.1.1.3.4.cmml" xref="alg1.l2.m3.1.1.3.4">𝑟</ci><ci id="alg1.l2.m3.1.1.3.5.cmml" xref="alg1.l2.m3.1.1.3.5">𝑔</ci><ci id="alg1.l2.m3.1.1.3.6.cmml" xref="alg1.l2.m3.1.1.3.6">𝑒</ci><ci id="alg1.l2.m3.1.1.3.7.cmml" xref="alg1.l2.m3.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\bm{r}_{target}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">bold_italic_r start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, i.e., <math alttext="L(N_{target},S_{target},\bm{r}_{target})" class="ltx_Math" display="inline" id="alg1.l2.m4.3"><semantics id="alg1.l2.m4.3a"><mrow id="alg1.l2.m4.3.3" xref="alg1.l2.m4.3.3.cmml"><mi id="alg1.l2.m4.3.3.5" xref="alg1.l2.m4.3.3.5.cmml">L</mi><mo id="alg1.l2.m4.3.3.4" xref="alg1.l2.m4.3.3.4.cmml">⁢</mo><mrow id="alg1.l2.m4.3.3.3.3" xref="alg1.l2.m4.3.3.3.4.cmml"><mo id="alg1.l2.m4.3.3.3.3.4" stretchy="false" xref="alg1.l2.m4.3.3.3.4.cmml">(</mo><msub id="alg1.l2.m4.1.1.1.1.1" xref="alg1.l2.m4.1.1.1.1.1.cmml"><mi id="alg1.l2.m4.1.1.1.1.1.2" xref="alg1.l2.m4.1.1.1.1.1.2.cmml">N</mi><mrow id="alg1.l2.m4.1.1.1.1.1.3" xref="alg1.l2.m4.1.1.1.1.1.3.cmml"><mi id="alg1.l2.m4.1.1.1.1.1.3.2" xref="alg1.l2.m4.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l2.m4.1.1.1.1.1.3.1" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.3" xref="alg1.l2.m4.1.1.1.1.1.3.3.cmml">a</mi><mo id="alg1.l2.m4.1.1.1.1.1.3.1a" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.4" xref="alg1.l2.m4.1.1.1.1.1.3.4.cmml">r</mi><mo id="alg1.l2.m4.1.1.1.1.1.3.1b" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.5" xref="alg1.l2.m4.1.1.1.1.1.3.5.cmml">g</mi><mo id="alg1.l2.m4.1.1.1.1.1.3.1c" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.6" xref="alg1.l2.m4.1.1.1.1.1.3.6.cmml">e</mi><mo id="alg1.l2.m4.1.1.1.1.1.3.1d" xref="alg1.l2.m4.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.1.1.1.1.1.3.7" xref="alg1.l2.m4.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l2.m4.3.3.3.3.5" xref="alg1.l2.m4.3.3.3.4.cmml">,</mo><msub id="alg1.l2.m4.2.2.2.2.2" xref="alg1.l2.m4.2.2.2.2.2.cmml"><mi id="alg1.l2.m4.2.2.2.2.2.2" xref="alg1.l2.m4.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l2.m4.2.2.2.2.2.3" xref="alg1.l2.m4.2.2.2.2.2.3.cmml"><mi id="alg1.l2.m4.2.2.2.2.2.3.2" xref="alg1.l2.m4.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l2.m4.2.2.2.2.2.3.1" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.3" xref="alg1.l2.m4.2.2.2.2.2.3.3.cmml">a</mi><mo id="alg1.l2.m4.2.2.2.2.2.3.1a" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.4" xref="alg1.l2.m4.2.2.2.2.2.3.4.cmml">r</mi><mo id="alg1.l2.m4.2.2.2.2.2.3.1b" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.5" xref="alg1.l2.m4.2.2.2.2.2.3.5.cmml">g</mi><mo id="alg1.l2.m4.2.2.2.2.2.3.1c" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.6" xref="alg1.l2.m4.2.2.2.2.2.3.6.cmml">e</mi><mo id="alg1.l2.m4.2.2.2.2.2.3.1d" xref="alg1.l2.m4.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.2.2.2.2.2.3.7" xref="alg1.l2.m4.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l2.m4.3.3.3.3.6" xref="alg1.l2.m4.3.3.3.4.cmml">,</mo><msub id="alg1.l2.m4.3.3.3.3.3" xref="alg1.l2.m4.3.3.3.3.3.cmml"><mi id="alg1.l2.m4.3.3.3.3.3.2" xref="alg1.l2.m4.3.3.3.3.3.2.cmml">𝒓</mi><mrow id="alg1.l2.m4.3.3.3.3.3.3" xref="alg1.l2.m4.3.3.3.3.3.3.cmml"><mi id="alg1.l2.m4.3.3.3.3.3.3.2" xref="alg1.l2.m4.3.3.3.3.3.3.2.cmml">t</mi><mo id="alg1.l2.m4.3.3.3.3.3.3.1" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.3" xref="alg1.l2.m4.3.3.3.3.3.3.3.cmml">a</mi><mo id="alg1.l2.m4.3.3.3.3.3.3.1a" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.4" xref="alg1.l2.m4.3.3.3.3.3.3.4.cmml">r</mi><mo id="alg1.l2.m4.3.3.3.3.3.3.1b" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.5" xref="alg1.l2.m4.3.3.3.3.3.3.5.cmml">g</mi><mo id="alg1.l2.m4.3.3.3.3.3.3.1c" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.6" xref="alg1.l2.m4.3.3.3.3.3.3.6.cmml">e</mi><mo id="alg1.l2.m4.3.3.3.3.3.3.1d" xref="alg1.l2.m4.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l2.m4.3.3.3.3.3.3.7" xref="alg1.l2.m4.3.3.3.3.3.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l2.m4.3.3.3.3.7" stretchy="false" xref="alg1.l2.m4.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m4.3b"><apply id="alg1.l2.m4.3.3.cmml" xref="alg1.l2.m4.3.3"><times id="alg1.l2.m4.3.3.4.cmml" xref="alg1.l2.m4.3.3.4"></times><ci id="alg1.l2.m4.3.3.5.cmml" xref="alg1.l2.m4.3.3.5">𝐿</ci><vector id="alg1.l2.m4.3.3.3.4.cmml" xref="alg1.l2.m4.3.3.3.3"><apply id="alg1.l2.m4.1.1.1.1.1.cmml" xref="alg1.l2.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m4.1.1.1.1.1.1.cmml" xref="alg1.l2.m4.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m4.1.1.1.1.1.2.cmml" xref="alg1.l2.m4.1.1.1.1.1.2">𝑁</ci><apply id="alg1.l2.m4.1.1.1.1.1.3.cmml" xref="alg1.l2.m4.1.1.1.1.1.3"><times id="alg1.l2.m4.1.1.1.1.1.3.1.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.1"></times><ci id="alg1.l2.m4.1.1.1.1.1.3.2.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.3.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.4.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.5.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.5">𝑔</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.6.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.l2.m4.1.1.1.1.1.3.7.cmml" xref="alg1.l2.m4.1.1.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l2.m4.2.2.2.2.2.cmml" xref="alg1.l2.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m4.2.2.2.2.2.1.cmml" xref="alg1.l2.m4.2.2.2.2.2">subscript</csymbol><ci id="alg1.l2.m4.2.2.2.2.2.2.cmml" xref="alg1.l2.m4.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l2.m4.2.2.2.2.2.3.cmml" xref="alg1.l2.m4.2.2.2.2.2.3"><times id="alg1.l2.m4.2.2.2.2.2.3.1.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.1"></times><ci id="alg1.l2.m4.2.2.2.2.2.3.2.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.3.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.4.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.5.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.6.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l2.m4.2.2.2.2.2.3.7.cmml" xref="alg1.l2.m4.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l2.m4.3.3.3.3.3.cmml" xref="alg1.l2.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l2.m4.3.3.3.3.3.1.cmml" xref="alg1.l2.m4.3.3.3.3.3">subscript</csymbol><ci id="alg1.l2.m4.3.3.3.3.3.2.cmml" xref="alg1.l2.m4.3.3.3.3.3.2">𝒓</ci><apply id="alg1.l2.m4.3.3.3.3.3.3.cmml" xref="alg1.l2.m4.3.3.3.3.3.3"><times id="alg1.l2.m4.3.3.3.3.3.3.1.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.1"></times><ci id="alg1.l2.m4.3.3.3.3.3.3.2.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.2">𝑡</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.3.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.3">𝑎</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.4.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.4">𝑟</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.5.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.5">𝑔</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.6.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.6">𝑒</ci><ci id="alg1.l2.m4.3.3.3.3.3.3.7.cmml" xref="alg1.l2.m4.3.3.3.3.3.3.7">𝑡</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m4.3c">L(N_{target},S_{target},\bm{r}_{target})</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m4.3d">italic_L ( italic_N start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT , bold_italic_r start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><span class="ltx_text ltx_font_bold" id="alg1.l3.1">for</span>&nbsp;Each mixture <math alttext="\bm{r}_{i}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝒓</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝒓</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\bm{r}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">bold_italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l3.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span>&nbsp;Each model size <math alttext="N_{j}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">N</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑁</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">N_{j}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_N start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Train model of size <math alttext="N_{j}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">N</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑁</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">N_{j}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_N start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> on mixture <math alttext="\bm{r}_{i}" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">𝒓</mi><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝒓</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\bm{r}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">bold_italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="S_{0}" class="ltx_Math" display="inline" id="alg1.l5.m3.1"><semantics id="alg1.l5.m3.1a"><msub id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><mi id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">S</mi><mn id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1">subscript</csymbol><ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">𝑆</ci><cn id="alg1.l5.m3.1.1.3.cmml" type="integer" xref="alg1.l5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">S_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m3.1d">italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> steps to obtain <math alttext="L(N_{j},S<S_{0},\bm{r}_{i})" class="ltx_math_unparsed" display="inline" id="alg1.l5.m4.1"><semantics id="alg1.l5.m4.1a"><mrow id="alg1.l5.m4.1b"><mi id="alg1.l5.m4.1.2">L</mi><mrow id="alg1.l5.m4.1.3"><mo id="alg1.l5.m4.1.3.1" stretchy="false">(</mo><msub id="alg1.l5.m4.1.3.2"><mi id="alg1.l5.m4.1.3.2.2">N</mi><mi id="alg1.l5.m4.1.3.2.3">j</mi></msub><mo id="alg1.l5.m4.1.3.3">,</mo><mi id="alg1.l5.m4.1.1">S</mi><mo id="alg1.l5.m4.1.3.4">&lt;</mo><msub id="alg1.l5.m4.1.3.5"><mi id="alg1.l5.m4.1.3.5.2">S</mi><mn id="alg1.l5.m4.1.3.5.3">0</mn></msub><mo id="alg1.l5.m4.1.3.6">,</mo><msub id="alg1.l5.m4.1.3.7"><mi id="alg1.l5.m4.1.3.7.2">𝒓</mi><mi id="alg1.l5.m4.1.3.7.3">i</mi></msub><mo id="alg1.l5.m4.1.3.8" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l5.m4.1c">L(N_{j},S&lt;S_{0},\bm{r}_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m4.1d">italic_L ( italic_N start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_S &lt; italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fit training step law to predict <math alttext="L(N_{j},S_{target},\bm{r}_{i})" class="ltx_Math" display="inline" id="alg1.l6.m1.3"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml"><mi id="alg1.l6.m1.3.3.5" xref="alg1.l6.m1.3.3.5.cmml">L</mi><mo id="alg1.l6.m1.3.3.4" xref="alg1.l6.m1.3.3.4.cmml">⁢</mo><mrow id="alg1.l6.m1.3.3.3.3" xref="alg1.l6.m1.3.3.3.4.cmml"><mo id="alg1.l6.m1.3.3.3.3.4" stretchy="false" xref="alg1.l6.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.2.cmml">N</mi><mi id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l6.m1.3.3.3.3.5" xref="alg1.l6.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l6.m1.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.3.2" xref="alg1.l6.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l6.m1.2.2.2.2.2.3.1" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.3" xref="alg1.l6.m1.2.2.2.2.2.3.3.cmml">a</mi><mo id="alg1.l6.m1.2.2.2.2.2.3.1a" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.4" xref="alg1.l6.m1.2.2.2.2.2.3.4.cmml">r</mi><mo id="alg1.l6.m1.2.2.2.2.2.3.1b" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.5" xref="alg1.l6.m1.2.2.2.2.2.3.5.cmml">g</mi><mo id="alg1.l6.m1.2.2.2.2.2.3.1c" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.6" xref="alg1.l6.m1.2.2.2.2.2.3.6.cmml">e</mi><mo id="alg1.l6.m1.2.2.2.2.2.3.1d" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.7" xref="alg1.l6.m1.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l6.m1.3.3.3.3.6" xref="alg1.l6.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l6.m1.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.cmml"><mi id="alg1.l6.m1.3.3.3.3.3.2" xref="alg1.l6.m1.3.3.3.3.3.2.cmml">𝒓</mi><mi id="alg1.l6.m1.3.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.3.cmml">i</mi></msub><mo id="alg1.l6.m1.3.3.3.3.7" stretchy="false" xref="alg1.l6.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3"><times id="alg1.l6.m1.3.3.4.cmml" xref="alg1.l6.m1.3.3.4"></times><ci id="alg1.l6.m1.3.3.5.cmml" xref="alg1.l6.m1.3.3.5">𝐿</ci><vector id="alg1.l6.m1.3.3.3.4.cmml" xref="alg1.l6.m1.3.3.3.3"><apply id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2">𝑁</ci><ci id="alg1.l6.m1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l6.m1.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3"><times id="alg1.l6.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l6.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.7.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l6.m1.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.3.3.1.cmml" xref="alg1.l6.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l6.m1.3.3.3.3.3.2.cmml" xref="alg1.l6.m1.3.3.3.3.3.2">𝒓</ci><ci id="alg1.l6.m1.3.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">L(N_{j},S_{target},\bm{r}_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.3d">italic_L ( italic_N start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT , bold_italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l7.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l7.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fit model size scaling law to predict the loss <math alttext="L(N_{target},S_{target},\bm{r}_{i})" class="ltx_Math" display="inline" id="alg1.l8.m1.3"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml"><mi id="alg1.l8.m1.3.3.5" xref="alg1.l8.m1.3.3.5.cmml">L</mi><mo id="alg1.l8.m1.3.3.4" xref="alg1.l8.m1.3.3.4.cmml">⁢</mo><mrow id="alg1.l8.m1.3.3.3.3" xref="alg1.l8.m1.3.3.3.4.cmml"><mo id="alg1.l8.m1.3.3.3.3.4" stretchy="false" xref="alg1.l8.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.2.cmml">N</mi><mrow id="alg1.l8.m1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l8.m1.1.1.1.1.1.3.1" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.3.3.cmml">a</mi><mo id="alg1.l8.m1.1.1.1.1.1.3.1a" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.4" xref="alg1.l8.m1.1.1.1.1.1.3.4.cmml">r</mi><mo id="alg1.l8.m1.1.1.1.1.1.3.1b" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.5" xref="alg1.l8.m1.1.1.1.1.1.3.5.cmml">g</mi><mo id="alg1.l8.m1.1.1.1.1.1.3.1c" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.6" xref="alg1.l8.m1.1.1.1.1.1.3.6.cmml">e</mi><mo id="alg1.l8.m1.1.1.1.1.1.3.1d" xref="alg1.l8.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.1.1.1.3.7" xref="alg1.l8.m1.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l8.m1.3.3.3.3.5" xref="alg1.l8.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.3.2" xref="alg1.l8.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l8.m1.2.2.2.2.2.3.1" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.3" xref="alg1.l8.m1.2.2.2.2.2.3.3.cmml">a</mi><mo id="alg1.l8.m1.2.2.2.2.2.3.1a" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.4" xref="alg1.l8.m1.2.2.2.2.2.3.4.cmml">r</mi><mo id="alg1.l8.m1.2.2.2.2.2.3.1b" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.5" xref="alg1.l8.m1.2.2.2.2.2.3.5.cmml">g</mi><mo id="alg1.l8.m1.2.2.2.2.2.3.1c" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.6" xref="alg1.l8.m1.2.2.2.2.2.3.6.cmml">e</mi><mo id="alg1.l8.m1.2.2.2.2.2.3.1d" xref="alg1.l8.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.2.2.2.2.2.3.7" xref="alg1.l8.m1.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l8.m1.3.3.3.3.6" xref="alg1.l8.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l8.m1.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.cmml"><mi id="alg1.l8.m1.3.3.3.3.3.2" xref="alg1.l8.m1.3.3.3.3.3.2.cmml">𝒓</mi><mi id="alg1.l8.m1.3.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.3.cmml">i</mi></msub><mo id="alg1.l8.m1.3.3.3.3.7" stretchy="false" xref="alg1.l8.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.3b"><apply id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3"><times id="alg1.l8.m1.3.3.4.cmml" xref="alg1.l8.m1.3.3.4"></times><ci id="alg1.l8.m1.3.3.5.cmml" xref="alg1.l8.m1.3.3.5">𝐿</ci><vector id="alg1.l8.m1.3.3.3.4.cmml" xref="alg1.l8.m1.3.3.3.3"><apply id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.2">𝑁</ci><apply id="alg1.l8.m1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3"><times id="alg1.l8.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.1"></times><ci id="alg1.l8.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.4.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.5.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.5">𝑔</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.6.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.7.cmml" xref="alg1.l8.m1.1.1.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l8.m1.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l8.m1.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3"><times id="alg1.l8.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l8.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.7.cmml" xref="alg1.l8.m1.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l8.m1.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.3.3.1.cmml" xref="alg1.l8.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l8.m1.3.3.3.3.3.2.cmml" xref="alg1.l8.m1.3.3.3.3.3.2">𝒓</ci><ci id="alg1.l8.m1.3.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">L(N_{target},S_{target},\bm{r}_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.3d">italic_L ( italic_N start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT , bold_italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span><span class="ltx_text ltx_font_bold" id="alg1.l9.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l9.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>Fit the data mixing law to predict <math alttext="L(N_{target},S_{target},\bm{r}_{target})" class="ltx_Math" display="inline" id="alg1.l10.m1.3"><semantics id="alg1.l10.m1.3a"><mrow id="alg1.l10.m1.3.3" xref="alg1.l10.m1.3.3.cmml"><mi id="alg1.l10.m1.3.3.5" xref="alg1.l10.m1.3.3.5.cmml">L</mi><mo id="alg1.l10.m1.3.3.4" xref="alg1.l10.m1.3.3.4.cmml">⁢</mo><mrow id="alg1.l10.m1.3.3.3.3" xref="alg1.l10.m1.3.3.3.4.cmml"><mo id="alg1.l10.m1.3.3.3.3.4" stretchy="false" xref="alg1.l10.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.2.cmml">N</mi><mrow id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.3.2" xref="alg1.l10.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.1.1.1.3.1" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.3" xref="alg1.l10.m1.1.1.1.1.1.3.3.cmml">a</mi><mo id="alg1.l10.m1.1.1.1.1.1.3.1a" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.4" xref="alg1.l10.m1.1.1.1.1.1.3.4.cmml">r</mi><mo id="alg1.l10.m1.1.1.1.1.1.3.1b" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.5" xref="alg1.l10.m1.1.1.1.1.1.3.5.cmml">g</mi><mo id="alg1.l10.m1.1.1.1.1.1.3.1c" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.6" xref="alg1.l10.m1.1.1.1.1.1.3.6.cmml">e</mi><mo id="alg1.l10.m1.1.1.1.1.1.3.1d" xref="alg1.l10.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.3.7" xref="alg1.l10.m1.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l10.m1.3.3.3.3.5" xref="alg1.l10.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l10.m1.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.3.2" xref="alg1.l10.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l10.m1.2.2.2.2.2.3.1" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.3" xref="alg1.l10.m1.2.2.2.2.2.3.3.cmml">a</mi><mo id="alg1.l10.m1.2.2.2.2.2.3.1a" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.4" xref="alg1.l10.m1.2.2.2.2.2.3.4.cmml">r</mi><mo id="alg1.l10.m1.2.2.2.2.2.3.1b" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.5" xref="alg1.l10.m1.2.2.2.2.2.3.5.cmml">g</mi><mo id="alg1.l10.m1.2.2.2.2.2.3.1c" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.6" xref="alg1.l10.m1.2.2.2.2.2.3.6.cmml">e</mi><mo id="alg1.l10.m1.2.2.2.2.2.3.1d" xref="alg1.l10.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.2.3.7" xref="alg1.l10.m1.2.2.2.2.2.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l10.m1.3.3.3.3.6" xref="alg1.l10.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l10.m1.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.cmml"><mi id="alg1.l10.m1.3.3.3.3.3.2" xref="alg1.l10.m1.3.3.3.3.3.2.cmml">𝒓</mi><mrow id="alg1.l10.m1.3.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l10.m1.3.3.3.3.3.3.2" xref="alg1.l10.m1.3.3.3.3.3.3.2.cmml">t</mi><mo id="alg1.l10.m1.3.3.3.3.3.3.1" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.3.3.cmml">a</mi><mo id="alg1.l10.m1.3.3.3.3.3.3.1a" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.4" xref="alg1.l10.m1.3.3.3.3.3.3.4.cmml">r</mi><mo id="alg1.l10.m1.3.3.3.3.3.3.1b" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.5" xref="alg1.l10.m1.3.3.3.3.3.3.5.cmml">g</mi><mo id="alg1.l10.m1.3.3.3.3.3.3.1c" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.6" xref="alg1.l10.m1.3.3.3.3.3.3.6.cmml">e</mi><mo id="alg1.l10.m1.3.3.3.3.3.3.1d" xref="alg1.l10.m1.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.3.3.3.3.7" xref="alg1.l10.m1.3.3.3.3.3.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l10.m1.3.3.3.3.7" stretchy="false" xref="alg1.l10.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.3b"><apply id="alg1.l10.m1.3.3.cmml" xref="alg1.l10.m1.3.3"><times id="alg1.l10.m1.3.3.4.cmml" xref="alg1.l10.m1.3.3.4"></times><ci id="alg1.l10.m1.3.3.5.cmml" xref="alg1.l10.m1.3.3.5">𝐿</ci><vector id="alg1.l10.m1.3.3.3.4.cmml" xref="alg1.l10.m1.3.3.3.3"><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2">𝑁</ci><apply id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3"><times id="alg1.l10.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.1"></times><ci id="alg1.l10.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.3">𝑎</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.4.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.5.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.5">𝑔</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.6.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.6">𝑒</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.7.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l10.m1.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l10.m1.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3"><times id="alg1.l10.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l10.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.2">𝑡</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.3">𝑎</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.4">𝑟</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.5">𝑔</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.6.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.6">𝑒</ci><ci id="alg1.l10.m1.2.2.2.2.2.3.7.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.7">𝑡</ci></apply></apply><apply id="alg1.l10.m1.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.3.3.3.1.cmml" xref="alg1.l10.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l10.m1.3.3.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.3.3.2">𝒓</ci><apply id="alg1.l10.m1.3.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3.3"><times id="alg1.l10.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.1"></times><ci id="alg1.l10.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.2">𝑡</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.3">𝑎</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.4.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.4">𝑟</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.5.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.5">𝑔</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.6.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.6">𝑒</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.7.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.7">𝑡</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.3c">L(N_{target},S_{target},\bm{r}_{target})</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.3d">italic_L ( italic_N start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT , bold_italic_r start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>A Pipeline for Loss Predictions</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">While data mixing laws enable us to predict the performance of models trained on unseen mixtures, the requirement to fit the laws involves training multiple models across diverse mixtures with model sizes and token counts identical to the target ones.
Furthermore, we must repeat this process for each target model size and training dataset<span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>An idea is to transfer the optimized training mixture on small models trained with few tokens to the training of large models and large volumes of training data.
Nevertheless, in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A1" title="Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">A</span></a>, we show that the partial order of data mixture concerning model performance varies as the model size and number of trained tokens change.
Therefore, the optimal mixture at experimented scales can be suboptimal at the target scale.
</span></span></span>.
This results in expensive costs thus hindering the practical value of our data mixing laws.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.2">We thus wonder whether we can obtain the losses of different mixture proportions without training at large scales.
Fortunately, this idea gains endorsement from existing experiences that verify the impressive extrapolation of scaling laws of training steps and model sizes.
In particular, <cite class="ltx_cite ltx_citemacro_citet">OpenAI (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib48" title="">2023</a>)</cite> predicts the loss of the target model with merely <math alttext="1,000\times" class="ltx_math_unparsed" display="inline" id="S4.SS1.p2.1.m1.2"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2b"><mn id="S4.SS1.p2.1.m1.1.1">1</mn><mo id="S4.SS1.p2.1.m1.2.3">,</mo><mn id="S4.SS1.p2.1.m1.2.2">000</mn><mo id="S4.SS1.p2.1.m1.2.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">1,000\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.2d">1 , 000 ×</annotation></semantics></math>–<math alttext="10,000\times" class="ltx_math_unparsed" display="inline" id="S4.SS1.p2.2.m2.2"><semantics id="S4.SS1.p2.2.m2.2a"><mrow id="S4.SS1.p2.2.m2.2b"><mn id="S4.SS1.p2.2.m2.1.1">10</mn><mo id="S4.SS1.p2.2.m2.2.3">,</mo><mn id="S4.SS1.p2.2.m2.2.2">000</mn><mo id="S4.SS1.p2.2.m2.2.4" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.2c">10,000\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.2d">10 , 000 ×</annotation></semantics></math> less compute.
As a consequence, we can train small models with few training steps on different mixtures, and fitting scaling laws on them to estimate the losses of the target model size and the target number of training steps.
We can then use the predicted losses to fit a data mixing law and search for the optimal mixture.
The proposed pipeline is illustrated in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a> with details depicted in Alg.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#alg1" title="Algorithm 1 ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">We note that the nested use of scaling laws is still not a widely adopted strategy in existing literature to the best of our knowledge.
Most studies try connecting newly found scaling laws to existing ones by incorporating variables into the latter&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hashimoto, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib28" title="">2021</a>; Frantar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib19" title="">2023</a>; Aghajanyan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib1" title="">2023</a>)</cite>.
Although unifying of different scaling laws is attractive, the added complexity to the interaction among multiple variables makes identifying the function form extremely challenging and hard to verify.
Pioneering efforts that derive scaling laws with multiple concerning factors (model sizes and the numbers of training data)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kaplan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib37" title="">2020</a>; Hoffmann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib33" title="">2022</a>)</cite> make assumptions upon the theory of error decomposition&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Harville, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib27" title="">1985</a>; Domingos, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib15" title="">2000</a>)</cite> but their outcomes are still not widely verified in large-scale practice.
From this perspective, we consider that our nested use of scaling laws offers a new technical routine of using scaling laws, which circumvents the huge challenge of complicating existing laws, making the discovery and application of scaling laws more accessible.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiment</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="176" id="S4.F6.g1" src="extracted/5490388/figs/optimize_loss_2.png" width="538">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The validation perplexity on the Pile validation set for 1B models trained on the default mixture and the optimized mixture of RedPajama for 100B tokens.
Our optimized mixture achieves the performance of the default mixture only using 0.73 of the original number of training steps and eventually achieves a performance comparable to a default mixture trained with 1.48 times more tokens (estimated by the scaling law of training steps, shown as the dashed line).
The specific mixture proportions are in the right table.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We verify the effect of our pipeline with an experiment to minimize the validation loss of a 1B model trained on 100B tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Setups.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">We train our models on the mixture of RedPajama and validate the validation set of the Pile to mimic the scenario where validation data are collected separately from the training data.
To fit the scaling laws of training steps and model sizes, we train a series of 70M, 160M, 305M, and 410M models for 30B tokens.
For all the models, we set the batch size as 1M tokens thus translating into 100k steps for the 1B models and 30k steps for small models.
We apply a cosine learning rate decay with a warmup of 2k steps which decays to 0.1 of the maximum learning rate at the 100k-th steps.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.1">To reach low prediction errors with a limited number of experiment runs, we select the mixtures for experimentation by leveraging the fact that mixture proportion terms are represented as exponential functions within our data mixing law.
Specifically, we enumerate candidate mixtures by double-diminishing the proportion for each training domain, starting from the maximum available one that does not use up all the domain tokens.
In this way, the losses of each (implicit) validation domain are distributed evenly.
We then sample 40 mixtures from all the candidates and train the smallest 70M models.
We resample groups of 20 mixtures from them to fit the data mixing law and select the group that reaches minimum prediction errors on all 40 samples as our final set of mixtures to run our pipeline.
For more details, please refer to Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A2.SS2" title="B.2 Fitting Mixture Laws ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">B.2</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="449" id="S4.F7.g1" src="extracted/5490388/figs/predictions.png" width="598">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>
Results of our loss prediction pipelines for the overall validation loss and domain losses.
Fitting data are from 70M to 410M models trained for 30B tokens, while the extrapolated points are from the default and optimized mixture for 1B models and 100B tokens.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S4.F6" title="Figure 6 ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a> shows the default mixture of RedPajama used in <cite class="ltx_cite ltx_citemacro_citet">Touvron et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib56" title="">2023a</a>)</cite> and the optimized mixture obtained from Alg.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#alg1" title="Algorithm 1 ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">1</span></a> with their performance on the validation data.
The loss predictions are in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S4.F7" title="Figure 7 ‣ Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a>.
We find that:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.I1.i1.p1.1.1">The pipeline optimizes performance effectively.</span> The model trained on the optimized mixture can achieve a performance comparable to the one trained on the default mixture with only 73% steps. It eventually attains a performance that requires 48% more steps if trained using the default mixture. This indicates the effectiveness of our pipeline in mixture optimization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.I1.i2.p1.1.1">Predictions provide references for the balance of model capabilities.</span> Prediction results in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S4.F7" title="Figure 7 ‣ Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a> demonstrate plausible reference on the relative scale of losses on both the overall validation data and different validation domains. While the overall loss helps optimize the overall performance, losses on different domains show model capabilities in various aspects. We suppose that this facilitates further mixture curating for the nuanced balance of model capabilities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We are also interested in applying our data mixing laws to continual pretraining, which shares the same paradigm as pertaining but begins the model with pretrained parameters instead of random initialization.
Generally, continual pretraining is a common technique to enhance existing pretrained models.
It injects up-to-date knowledge into the model, avoiding performance degradation due to distribution shifts&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gururangan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib25" title="">2020</a>; Xiong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib65" title="">2023</a>)</cite>.
In addition, researchers also apply continual pretraining to reuse existing model parameters to build models of a different architecture&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Komatsuzaki et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib39" title="">2022</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S5.F8"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="249" id="S5.F8.g1" src="extracted/5490388/figs/continue_all.png" width="598">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Loss predictions and the training curve of continual pretraining Pythia-70M on a mixture of the Pile and python code. (A) Loss prediction on the Pile; (B) Loss prediction on python; (C) training curves with losses on the Pile; (D) training curves with losses on python. We predict final losses with Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E6" title="6 ‣ Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a>. The law accurately finds the critical mixture proportion that maintains model performance on the original domain (i.e., the Pile).
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">We experiment on a typical scenario of continual pretraining, where we train the model on the mixture of original pretraining data and upcoming data of a target domain to enhance.
For instance, we continually pretrain Pythia-70M models with a mixture of the Pile and Python codes, where the former is the original pretraining data of the base model.
To verify whether our data mixing laws apply to continual pretraining, we train the models for 10B tokens on 4 mixtures and fit the Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E6" title="6 ‣ Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a> on losses of the Pile and python codes.
Results in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S5.F8" title="Figure 8 ‣ 5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a> confirm that Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E6" title="6 ‣ Findings ‣ 3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">6</span></a> fits into the losses of continual pretraining.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">During continual pretraining, a too-large proportion of the target data can hurt the performance of the original data.
A representative mixture optimization target is to maintain the general-purpose ability (looses on the Pile) unchanged.
To this end, using the fitted data mixing laws, we predict the <span class="ltx_text ltx_font_italic" id="S5.p3.1.1">critical proportion</span> leading to the same loss as before continual pretraining.
Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S5.F8" title="Figure 8 ‣ 5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a> demonstrates the success of our prediction where the proportion we find results in similar performance compared to the model before continual pretraining while gaining improvement in the target domain.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.p4">
<p class="ltx_p" id="S5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.p4.1.1">Remarks.</span> We suggest continual pretraining is significant for its connection to the design of data schedules&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Albalak et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib3" title="">2023</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib13" title="">2024b</a>)</cite>.
Usually, continual pretraining applies to a pretrained model, while it is natural to further continually pretrain the continual pretrained models, i.e., multi-stage pretraining&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib13" title="">2024b</a>)</cite>.
In each stage, the mixture proportions or even the domain components of training data can be different.
This becomes a dynamic data schedule as the number of training stages approaches the infinite limit.
Therefore, the successful application of our data mixing laws on continual training signifies a promising prospect for using it to design dynamic data schedules, a more comprehensive data curating paradigm.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Curating pretraining data for LLMs.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px1.p1.1">Training massive transformer architecture on trillions of tokens, a.k.a. pretraining, is the primary step to building modern large language models that exhibit impressive human-like generalist abilities&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Brown et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib10" title="">2020</a>; OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib48" title="">2023</a>; Jiang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib36" title="">2023</a>; Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib57" title="">2023b</a>)</cite>).
It takes up most of the computation resources for model training and researchers believe it endows almost all the knowledge in LLMs&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhou et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib67" title="">2024</a>)</cite>.
Such critical impact motivates the development of data curating strategies to reduce computation costs and enhance knowledge&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Longpre et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib42" title="">2023</a>)</cite>.
The efforts can be categorized into two steps.
The first step focuses on obtaining a high-quality training dataset.
A typical procedure includes selecting data sources to constitute different domains, deduplication, and the most intricate filtering&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wenzek et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib62" title="">2019</a>; Penedo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib49" title="">2023</a>)</cite>.
A mass of endeavors in existing practice has involved multifarious filters, scoring the documents with from superficial features on characters&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rae et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib51" title="">2021</a>; Xie et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib64" title="">2024b</a>; Raffel et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib52" title="">2020</a>)</cite> to semantics including similarity to the high-quality reference corpus&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wenzek et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib62" title="">2019</a>)</cite> and toxicity&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Longpre et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib42" title="">2023</a>; Friedl, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib21" title="">2023</a>)</cite>.
With a dataset on hold, the second step aims to make the best use of it.
This includes tuning the data mixture&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Du et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib17" title="">2022</a>; Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib56" title="">2023a</a>; Xie et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib63" title="">2024a</a>)</cite> and devising data schedules&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mindermann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib46" title="">2022</a>; Albalak et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib3" title="">2023</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib13" title="">2024b</a>; Fan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib18" title="">2024</a>)</cite>.
Our work is among those tune data mixtures and our extension to continue pretraining signifies our prospect of guiding the schedule design.
Different from existing attempts that rely on intuition or qualitative targets, our study seeks a quantitative solution.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Scaling laws</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS0.SSS0.Px2.p1.1">are functional relationships between the properties of interests (e.g., test loss or other performance metrics) and the scales of controllable factors regarding the optimization process or architecture (e.g., model sizes and numbers of training samples)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Villalobos, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib61" title="">2023</a>)</cite>.
Along with the development of machine learning, characterizing scaling behaviors has garnered great research interest under the context of learning theories, bounding the generalization error given the number of training samples in the form of power laws&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vapnik &amp; Chervonenkis, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib59" title="">1971</a>; Valiant, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib58" title="">1984</a>; Haussler, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib29" title="">1988</a>; Amari et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib4" title="">1992</a>)</cite>.
Nevertheless, overly strict assumptions hinder their practical applications.
In recent years, statistical estimation on scaling gained fast progress for deep neural networks and spawns the introduction of scaling laws.
<cite class="ltx_cite ltx_citemacro_citet">Hestness et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib32" title="">2017</a>)</cite> pioneers the trend and demonstrates power-law generalization error scaling across a breadth of factors but the power-law exponents differ from previous theoretical analysis.
<cite class="ltx_cite ltx_citemacro_citet">Kaplan et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib37" title="">2020</a>); Hoffmann et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib33" title="">2022</a>); Henighan et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib30" title="">2020</a>)</cite> conduct more comprehensive investigations on Transformer architecture&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib60" title="">2017</a>)</cite>, further highlighting the power-law relationship on test loss regarding model sizes, the amount of training data and computation across orders of magnitudes.
These findings foretell the performance gain with scaling quantitatively and guide the trade-off between larger models and more training data, directing to the later development of large language models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Brown et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib10" title="">2020</a>; Hoffmann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib33" title="">2022</a>; OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib48" title="">2023</a>)</cite>.
Lately, progressive investigations propose amendments to existing scaling laws&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Caballero et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib11" title="">2022</a>; Alabdulmohsin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib2" title="">2022</a>)</cite>, seeking theoretical explanations on the empirical formulas&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Bahri et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib5" title="">2021</a>); Hutter (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib35" title="">2021</a>); Michaud et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib45" title="">2024</a>)</cite>, and exploring the functional relationships in broader scenarios&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hernandez et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib31" title="">2021</a>; Frantar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib19" title="">2023</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib41" title="">2023</a>)</cite>.
The most relevant study to ours is <cite class="ltx_cite ltx_citemacro_citet">Hashimoto (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib28" title="">2021</a>)</cite> which explores performance prediction under multiple data sources but is limited to small-scaled supervised learning tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussions</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this work, we discover the quantitative predictability of model losses regarding the mixture proportions of training data, which boils down to the data mixing laws.
Our findings cover training data from two domains to multiple domains, and validation data from a single domain to unknown compositions.
Using data mixing laws allows practitioners to quantitatively estimate the model performance on unseen mixture proportions before the actual training, facilitating the tuning of ideal mixture proportions.
We further propose the nested use of scaling laws of training steps, model sizes, and data mixture to make predictions with only experiments at small scales, which enables the reuse of existing experiments and reduces the computation costs.
Experimental results suggest that our method effectively optimizes the data mixture, which leads to better performance in pretraining and maintaining the original abilities of pretrained models in continual pretraining.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">Admittedly, how data mixtures affect model training is far from fully understood.
Our study makes preliminary attempts at a quantitative framework while leaving several limitations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S7.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">On the clarification of domains.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S7.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S7.SS0.SSS0.Px1.p1.1">The concept of domains is not well-defined.
In this paper, similar to related studies&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xie et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib63" title="">2024a</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib13" title="">2024b</a>; Albalak et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib3" title="">2023</a>; Fan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib18" title="">2024</a>)</cite>, we directly adopt the predefined domains in the open-source training data.
Nevertheless, we suppose that more operationally defined training domains, e.g., clustering&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gururangan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib26" title="">2023</a>; Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib53" title="">2024</a>)</cite>, could further benefit the prediction accuracy of data mixing laws and the performance of outcome models.
For the validation domains, our implicit domain aggregation method obviates the necessity of explicitly aligning validation data with training domains.
This requirement is often encountered, given that validation data typically comprises trustworthy datasets rather than mere compilations from training domains.
However, we acknowledge that implicit domain aggregation may be less interpretable compared to the explicit approach and may raise concerns regarding its accuracy, as elaborated subsequently.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S7.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">On the error analyses.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S7.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S7.SS0.SSS0.Px2.p1.1">Leveraging scaling laws requires experiments to provide samples to fit the functions.
Consequently, it requires careful design of experiments&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mead, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib44" title="">1990</a>)</cite> to decide the number of fitting samples to experiment with and how to distribute these samples to reduce prediction errors to the greatest extent.
In this study, we decide the number according to our affordable budget and leverage the simple rule that evenly distributes the losses of the data samples but considering more theoretically justified rules should be necessary.
Additionally, our nested use of scaling laws can introduce errors in each step.
Therefore, further analyses to mitigate the error accumulation are also demanding.
In Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S4.F7" title="Figure 7 ‣ Results. ‣ 4.2 Experiment ‣ 4 Nested scaling laws predict losses trained on various mixtures using only small-scale experiments ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">7</span></a>, we notice our predictions are smaller than the actual loss, which we attribute to the underestimation from the step laws and model size laws we fit.
Further practical experience demystifies the technical details of scaling laws&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Su et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib54" title="">2024</a>)</cite> can help eliminate the errors.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S7.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">On joint laws of multiple factors.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S7.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S7.SS0.SSS0.Px3.p1.1">We propose the nested use of scaling laws for circumventing the difficulties in finding a joint law of training steps, model sizes, and mixture proportions.
Although we can predict the losses with our pipeline, a joint law unveils clear synergies of different factors.
For instance, previous studies indicate the power-law exponent in the scaling laws of model sizes and training data are insensitive to training and validation data&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hestness et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib32" title="">2017</a>; Kaplan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib37" title="">2020</a>; Hashimoto, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib28" title="">2021</a>; Hoffmann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib33" title="">2022</a>; Frantar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib19" title="">2023</a>)</cite>.
Figuring out their joint laws with data mixture can further confirm this surmise.
Moreover, a joint law also implements coefficient-sharing of separate laws, reducing the number of required fitting samples.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S7.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">On dynamic data curating.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S7.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S7.SS0.SSS0.Px4.p1.1">Our study presents a pipeline to decide on a group of fixed mixture proportions for pretraining.
More sophisticated data curating can include dynamic proportions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Albalak et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib3" title="">2023</a>)</cite> and even a curriculum that changes data domains&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib13" title="">2024b</a>)</cite>.
The application of our data mixing laws in continual pretraining (Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S5" title="5 Application to Continual Pretraining Outlooks Data Schedule Driven by Data Mixing Laws ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">5</span></a>) implies the prospect of extending our findings to these settings.
On top of this, we believe that it is promising to incorporate further analysis to pursue a dynamic data mixing law.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S7.SS0.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">On theoretical understandings.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S7.SS0.SSS0.Px5.p1">
<p class="ltx_p" id="S7.SS0.SSS0.Px5.p1.1">Our data mixing laws, similar to most scaling laws, are empirical findings.
We believe a theoretical understanding of the training dynamics that form the laws provides a more solid justification.
A potential perspective is understanding the target of tuning mixture proportion through gradient estimation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib24" title="">2024</a>; Gu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib23" title="">2024</a>)</cite>.
Specifically, the mixture proportions weight data from different domains, whose effect boils down to the weight for the linear combination of gradients from different domains during training.
This perspective turns the target of tuning mixture proportions into finding an ideal gradient direction&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib23" title="">2024</a>)</cite> and the relationship between data samples is formalized with their gradient directions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib24" title="">2024</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S7.SS0.SSS0.Px5.p2">
<p class="ltx_p" id="S7.SS0.SSS0.Px5.p2.1">To sum up, we initiate an investigation into quantitative prediction methods for pretraining data curation.
With its increasing focus on data engineering, we hope our exploration facilitates further quantitative studies and theoretical analyses in this research area.

</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">The computations in this research were performed using the CFFF platform of Fudan University.
We thank Botian Jiang and Shiduo Zhang for their insightful discussions.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aghajanyan et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Armen Aghajanyan, Lili Yu, Alexis Conneau, Wei-Ning Hsu, Karen Hambardzumyan, Susan Zhang, Stephen Roller, Naman Goyal, Omer Levy, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Scaling laws for generative mixed-modal language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2301.03728</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alabdulmohsin et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ibrahim&nbsp;M Alabdulmohsin, Behnam Neyshabur, and Xiaohua Zhai.

</span>
<span class="ltx_bibblock">Revisiting neural scaling laws in language and vision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Advances in Neural Information Processing Systems</em>, 35:22300–22312, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Albalak et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alon Albalak, Liangming Pan, Colin Raffel, and William&nbsp;Yang Wang.

</span>
<span class="ltx_bibblock">Efficient online data mixing for language model pre-training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2312.02406</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amari et&nbsp;al. (1992)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shun-ichi Amari, Naotake Fujita, and Shigeru Shinomoto.

</span>
<span class="ltx_bibblock">Four types of learning curves.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Neural Computation</em>, 4(4):605–618, 1992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahri et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yasaman Bahri, Ethan Dyer, Jared Kaplan, Jaehoon Lee, and Utkarsh Sharma.

</span>
<span class="ltx_bibblock">Explaining neural scaling laws.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2102.06701</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu&nbsp;Han, Fei Huang, et&nbsp;al.

</span>
<span class="ltx_bibblock">Qwen technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2309.16609</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bi et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiao Bi, Deli Chen, Guanting Chen, Shanhuang Chen, Damai Dai, Chengqi Deng, Honghui Ding, Kai Dong, Qiushi Du, Zhe Fu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Deepseek llm: Scaling open-source language models with longtermism.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2401.02954</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stella Biderman, Hailey Schoelkopf, Quentin&nbsp;Gregory Anthony, Herbie Bradley, Kyle O’Brien, Eric Hallahan, Mohammad&nbsp;Aflah Khan, Shivanshu Purohit, USVSN&nbsp;Sai Prashanth, Edward Raff, et&nbsp;al.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 2397–2430. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bishop (2006)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Christopher Bishop.

</span>
<span class="ltx_bibblock">Pattern recognition and machine learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Springer google schola</em>, 2:5–43, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared&nbsp;D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et&nbsp;al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Advances in neural information processing systems</em>, 33:1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caballero et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ethan Caballero, Kshitij Gupta, Irina Rish, and David Krueger.

</span>
<span class="ltx_bibblock">Broken neural scaling laws.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2210.14891</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Daoyuan Chen, Yilun Huang, Zhijian Ma, Hesen Chen, Xuchen Pan, Ce&nbsp;Ge, Dawei Gao, Yuexiang Xie, Zhaoyang Liu, Jinyang Gao, Yaliang Li, Bolin Ding, and Jingren Zhou.

</span>
<span class="ltx_bibblock">Data-juicer: A one-stop data processing system for large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">International Conference on Management of Data</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mayee Chen, Nicholas Roberts, Kush Bhatia, Jue Wang, Ce&nbsp;Zhang, Frederic Sala, and Christopher Ré.

</span>
<span class="ltx_bibblock">Skill-it! a data-driven skills framework for understanding and training language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Doddapaneni et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sumanth Doddapaneni, Gowtham Ramesh, Mitesh&nbsp;M Khapra, Anoop Kunchukuttan, and Pratyush Kumar.

</span>
<span class="ltx_bibblock">A primer on pretrained multilingual language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2107.00676</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Domingos (2000)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pedro Domingos.

</span>
<span class="ltx_bibblock">A unified bias-variance decomposition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of 17th international conference on machine learning</em>, pp.&nbsp; 231–238. Morgan Kaufmann Stanford, 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Drucker (1997)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Harris Drucker.

</span>
<span class="ltx_bibblock">Improving regressors using boosting techniques.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Icml</em>, volume&nbsp;97, pp.&nbsp; e115. Citeseer, 1997.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nan Du, Yanping Huang, Andrew&nbsp;M Dai, Simon Tong, Dmitry Lepikhin, Yuanzhong Xu, Maxim Krikun, Yanqi Zhou, Adams&nbsp;Wei Yu, Orhan Firat, et&nbsp;al.

</span>
<span class="ltx_bibblock">Glam: Efficient scaling of language models with mixture-of-experts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 5547–5569. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Simin Fan, Matteo Pagliardini, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Doge: Domain reweighting with generalization estimation, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Elias Frantar, Carlos Riquelme, Neil Houlsby, Dan Alistarh, and Utku Evci.

</span>
<span class="ltx_bibblock">Scaling laws for sparsely-connected foundation models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2309.08520</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">French (1999)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Robert&nbsp;M French.

</span>
<span class="ltx_bibblock">Catastrophic forgetting in connectionist networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Trends in cognitive sciences</em>, 3(4):128–135, 1999.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Friedl (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Paul Friedl.

</span>
<span class="ltx_bibblock">Dis/similarities in the design and development of legal and algorithmic normative systems: the case of perspective api.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Law, Innovation and Technology</em>, 15(1):25–59, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Leo Gao, Stella Biderman, Sid Black, Laurence Golding, Travis Hoppe, Charles Foster, Jason Phang, Horace He, Anish Thite, Noa Nabeshima, et&nbsp;al.

</span>
<span class="ltx_bibblock">The pile: An 800gb dataset of diverse text for language modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2101.00027</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuxian Gu, Li&nbsp;Dong, Yaru Hao, Qingxiu Dong, Minlie Huang, and Furu Wei.

</span>
<span class="ltx_bibblock">Towards optimal learning of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2402.17759</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shangmin Guo, Yi&nbsp;Ren, Stefano&nbsp;V Albrecht, and Kenny Smith.

</span>
<span class="ltx_bibblock">Sample relationship from learning dynamics matters for generalisation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2401.08808</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gururangan et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Suchin Gururangan, Ana Marasović, Swabha Swayamdipta, Kyle Lo, Iz&nbsp;Beltagy, Doug Downey, and Noah&nbsp;A Smith.

</span>
<span class="ltx_bibblock">Don’t stop pretraining: Adapt language models to domains and tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2004.10964</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gururangan et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Suchin Gururangan, Margaret Li, Mike Lewis, Weijia Shi, Tim Althoff, Noah&nbsp;A Smith, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Scaling expert language models with unsupervised domain discovery.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2303.14177</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harville (1985)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
David&nbsp;A Harville.

</span>
<span class="ltx_bibblock">Decomposition of prediction error.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Journal of the American Statistical Association</em>, 80(389):132–138, 1985.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hashimoto (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tatsunori Hashimoto.

</span>
<span class="ltx_bibblock">Model performance scaling with multiple data sources.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 4107–4116. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haussler (1988)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
David Haussler.

</span>
<span class="ltx_bibblock">Quantifying inductive bias: Ai learning algorithms and valiant’s learning framework.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Artificial intelligence</em>, 36(2):177–221, 1988.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Henighan et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Henighan, Jared Kaplan, Mor Katz, Mark Chen, Christopher Hesse, Jacob Jackson, Heewoo Jun, Tom&nbsp;B Brown, Prafulla Dhariwal, Scott Gray, et&nbsp;al.

</span>
<span class="ltx_bibblock">Scaling laws for autoregressive generative modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2010.14701</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hernandez et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Danny Hernandez, Jared Kaplan, Tom Henighan, and Sam McCandlish.

</span>
<span class="ltx_bibblock">Scaling laws for transfer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2102.01293</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hestness et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Joel Hestness, Sharan Narang, Newsha Ardalani, Gregory Diamos, Heewoo Jun, Hassan Kianinejad, Md&nbsp;Mostofa&nbsp;Ali Patwary, Yang Yang, and Yanqi Zhou.

</span>
<span class="ltx_bibblock">Deep learning scaling is predictable, empirically.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:1712.00409</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jordan Hoffmann, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza Rutherford, Diego de&nbsp;Las Casas, Lisa&nbsp;Anne Hendricks, Johannes Welbl, Aidan Clark, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training compute-optimal large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2203.15556</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hornik et&nbsp;al. (1989)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kurt Hornik, Maxwell Stinchcombe, and Halbert White.

</span>
<span class="ltx_bibblock">Multilayer feedforward networks are universal approximators.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Neural networks</em>, 2(5):359–366, 1989.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hutter (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Marcus Hutter.

</span>
<span class="ltx_bibblock">Learning curve theory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2102.04074</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Albert&nbsp;Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra&nbsp;Singh Chaplot, Diego de&nbsp;las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, et&nbsp;al.

</span>
<span class="ltx_bibblock">Mistral 7b.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2310.06825</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaplan et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jared Kaplan, Sam McCandlish, Tom Henighan, Tom&nbsp;B Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei.

</span>
<span class="ltx_bibblock">Scaling laws for neural language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2001.08361</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel Veness, Guillaume Desjardins, Andrei&nbsp;A Rusu, Kieran Milan, John Quan, Tiago Ramalho, Agnieszka Grabska-Barwinska, et&nbsp;al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the national academy of sciences</em>, 114(13):3521–3526, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Komatsuzaki et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aran Komatsuzaki, Joan Puigcerver, James Lee-Thorp, Carlos&nbsp;Riquelme Ruiz, Basil Mustafa, Joshua Ainslie, Yi&nbsp;Tay, Mostafa Dehghani, and Neil Houlsby.

</span>
<span class="ltx_bibblock">Sparse upcycling: Training mixture-of-experts from dense checkpoints.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2212.05055</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Raymond Li, Loubna&nbsp;Ben Allal, Yangtian Zi, Niklas Muennighoff, Denis Kocetkov, Chenghao Mou, Marc Marone, Christopher Akiki, Jia Li, Jenny Chim, et&nbsp;al.

</span>
<span class="ltx_bibblock">Starcoder: may the source be with you!

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2305.06161</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiaoran Liu, Hang Yan, Chenxin An, Xipeng Qiu, and Dahua Lin.

</span>
<span class="ltx_bibblock">Scaling laws of rope-based extrapolation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">The Twelfth International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Longpre et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shayne Longpre, Gregory Yauney, Emily Reif, Katherine Lee, Adam Roberts, Barret Zoph, Denny Zhou, Jason Wei, Kevin Robinson, David Mimno, et&nbsp;al.

</span>
<span class="ltx_bibblock">A pretrainer’s guide to training data: Measuring the effects of data age, domain coverage, quality, &amp; toxicity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:2305.13169</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yun Luo, Zhen Yang, Fandong Meng, Yafu Li, Jie Zhou, and Yue Zhang.

</span>
<span class="ltx_bibblock">An empirical study of catastrophic forgetting in large language models during continual fine-tuning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2308.08747</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mead (1990)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Roger Mead.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">The design of experiments: statistical principles for practical applications</em>.

</span>
<span class="ltx_bibblock">Cambridge university press, 1990.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Michaud et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Eric Michaud, Ziming Liu, Uzay Girit, and Max Tegmark.

</span>
<span class="ltx_bibblock">The quantization model of neural scaling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mindermann et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sören Mindermann, Jan&nbsp;M Brauner, Muhammed&nbsp;T Razzak, Mrinank Sharma, Andreas Kirsch, Winnie Xu, Benedikt Höltgen, Aidan&nbsp;N Gomez, Adrien Morisot, Sebastian Farquhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Prioritized training on points that are learnable, worth learning, and not yet learnt.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 15630–15649. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Muennighoff et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Niklas Muennighoff, Alexander Rush, Boaz Barak, Teven Le&nbsp;Scao, Nouamane Tazi, Aleksandra Piktus, Sampo Pyysalo, Thomas Wolf, and Colin&nbsp;A Raffel.

</span>
<span class="ltx_bibblock">Scaling data-constrained language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Penedo et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guilherme Penedo, Quentin Malartic, Daniel Hesslow, Ruxandra Cojocaru, Alessandro Cappelli, Hamza Alobeidli, Baptiste Pannier, Ebtesam Almazrouei, and Julien Launay.

</span>
<span class="ltx_bibblock">The refinedweb dataset for falcon llm: outperforming curated corpora with web data, and web data only.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">arXiv preprint arXiv:2306.01116</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Improving language understanding with unsupervised learning.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rae et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jack&nbsp;W Rae, Sebastian Borgeaud, Trevor Cai, Katie Millican, Jordan Hoffmann, Francis Song, John Aslanides, Sarah Henderson, Roman Ring, Susannah Young, et&nbsp;al.

</span>
<span class="ltx_bibblock">Scaling language models: Methods, analysis &amp; insights from training gopher.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">arXiv preprint arXiv:2112.11446</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter&nbsp;J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">The Journal of Machine Learning Research</em>, 21(1):5485–5551, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yunfan Shao, Linyang Li, Zhaoye Fei, Hang Yan, Dahua Lin, and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Balanced data sampling for language model training with clustering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">arXiv preprint arXiv:2402.14526</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hui Su, Zhi Tian, Xiaoyu Shen, and Xunliang Cai.

</span>
<span class="ltx_bibblock">Unraveling the mystery of scaling laws: Part i.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">arXiv preprint arXiv:2403.06563</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taylor et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ross Taylor, Marcin Kardas, Guillem Cucurull, Thomas Scialom, Anthony Hartshorn, Elvis Saravia, Andrew Poulton, Viktor Kerkez, and Robert Stojnic.

</span>
<span class="ltx_bibblock">Galactica: A large language model for science.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:2211.09085</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:2302.13971</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">arXiv preprint arXiv:2307.09288</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Valiant (1984)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Leslie&nbsp;G Valiant.

</span>
<span class="ltx_bibblock">A theory of the learnable.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Communications of the ACM</em>, 27(11):1134–1142, 1984.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vapnik &amp; Chervonenkis (1971)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
VN&nbsp;Vapnik and A&nbsp;Ya Chervonenkis.

</span>
<span class="ltx_bibblock">On the uniform convergence of relative frequencies of events to their probabilities.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">Theory of Probability and its Applications</em>, 16(2):264, 1971.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan&nbsp;N Gomez, Ł&nbsp;ukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;30. Curran Associates, Inc., 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Villalobos (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pablo Villalobos.

</span>
<span class="ltx_bibblock">Scaling laws literature review, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://epochai.org/blog/scaling-laws-literature-review" title="">https://epochai.org/blog/scaling-laws-literature-review</a>.

</span>
<span class="ltx_bibblock">Accessed: 2024-02-27.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wenzek et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guillaume Wenzek, Marie-Anne Lachaux, Alexis Conneau, Vishrav Chaudhary, Francisco Guzmán, Armand Joulin, and Edouard Grave.

</span>
<span class="ltx_bibblock">Ccnet: Extracting high quality monolingual datasets from web crawl data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">arXiv preprint arXiv:1911.00359</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sang&nbsp;Michael Xie, Hieu Pham, Xuanyi Dong, Nan Du, Hanxiao Liu, Yifeng Lu, Percy&nbsp;S Liang, Quoc&nbsp;V Le, Tengyu Ma, and Adams&nbsp;Wei Yu.

</span>
<span class="ltx_bibblock">Doremi: Optimizing data mixtures speeds up language model pretraining.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sang&nbsp;Michael Xie, Shibani Santurkar, Tengyu Ma, and Percy&nbsp;S Liang.

</span>
<span class="ltx_bibblock">Data selection for language models via importance resampling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wenhan Xiong, Jingyu Liu, Igor Molybog, Hejia Zhang, Prajjwal Bhargava, Rui Hou, Louis Martin, Rashi Rungta, Karthik&nbsp;Abinav Sankararaman, Barlas Oguz, et&nbsp;al.

</span>
<span class="ltx_bibblock">Effective long-context scaling of foundation models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">arXiv preprint arXiv:2309.16039</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhan et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jun Zhan, Junqi Dai, Jiasheng Ye, Yunhua Zhou, Dong Zhang, Zhigeng Liu, Xin Zhang, Ruibin Yuan, Ge&nbsp;Zhang, Linyang Li, Hang Yan, Jie Fu, Tao Gui, Tianxiang Sun, Yugang Jiang, and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Anygpt: Unified multimodal llm with discrete sequence modeling, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chunting Zhou, Pengfei Liu, Puxin Xu, Srinivasan Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, Lili Yu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Lima: Less is more for alignment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kun Zhou, Yutao Zhu, Zhipeng Chen, Wentong Chen, Wayne&nbsp;Xin Zhao, Xu&nbsp;Chen, Yankai Lin, Ji-Rong Wen, and Jiawei Han.

</span>
<span class="ltx_bibblock">Don’t make your llm an evaluation benchmark cheater.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">arXiv preprint arXiv:2311.01964</em>, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>The relative qualities of data mixtures relate to model sizes and training steps.</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="A1.F9"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="465" id="A1.F9.g1" src="extracted/5490388/figs/rankings.png" width="598">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>The rankings of the relative performance of 20 sample mixtures trained on RedPajama and validate on the Pile. <span class="ltx_text ltx_font_bold" id="A1.F9.3.1">(A)</span> The rankings of models of different sizes all trained for 30k steps. <span class="ltx_text ltx_font_bold" id="A1.F9.4.2">(B)</span> The rankings for 70M models trained for different steps. </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">One may wonder whether we can find the optimal data mixtures on small models and few numbers of steps, and then transfer the found mixture proportions to large-scale training.
To answer this question, we compare the relative performance of models in different sizes and trained with different numbers of steps in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A1.F9" title="Figure 9 ‣ Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">9</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.p2">
<p class="ltx_p" id="A1.p2.1">Results show that the relative performance fluctuates despite a relatively consistent trend across sizes and training steps.
This indicates that a mixture is better at small scales probably but does not always perform better at large scales.
The longest common sequence of the partial orders among the 20 mixtures in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A1.F9" title="Figure 9 ‣ Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">9</span></a>(A) and Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A1.F9" title="Figure 9 ‣ Appendix A The relative qualities of data mixtures relate to model sizes and training steps. ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">9</span></a>(B) only reaches lengths of 10 and 11, respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Implementation Details</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Model Training</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">Throughout this study, we employ the Pythia Suit&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Biderman et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib8" title="">2023</a>)</cite> as our model architectures, the specific configurations are in Tab.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A2.T2" title="Table 2 ‣ B.1 Model Training ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">2</span></a>.
The maximum sequence length is 4096 for pretraining from scratch and 2048 for continual pretraining, where the latter aligns with the setting of the original pretrained models.
In all our experiments, we train the model with a batch size of 1M tokens and a maximum learning rate of 1e-4.
We warm up the learning rates for 2000 steps and decay it to 0.1 of the maximum at the last training step with a cosine decay schedule.
For continual pretraining, we initialize the models with the 20k-step checkpoint of the Pythia 70M model and do not apply a learning rate warmup.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A2.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Model architectures for experiments in this paper.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="A2.T2.1" style="width:433.6pt;height:132.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(39.8pt,-12.1pt) scale(1.22452760984058,1.22452760984058) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T2.1.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="A2.T2.1.1.1.1.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T2.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.T2.1.1.1.1.2.1">70M</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T2.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.T2.1.1.1.1.3.1">160M</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T2.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A2.T2.1.1.1.1.4.1">305M</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T2.1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="A2.T2.1.1.1.1.5.1">410M</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T2.1.1.1.1.6"><span class="ltx_text ltx_font_bold" id="A2.T2.1.1.1.1.6.1">1B</span></th>
</tr>
<tr class="ltx_tr" id="A2.T2.1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A2.T2.1.1.2.2.1">Vocabulary Size</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A2.T2.1.1.2.2.2">50304</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A2.T2.1.1.2.2.3">50304</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A2.T2.1.1.2.2.4">50304</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A2.T2.1.1.2.2.5">50304</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A2.T2.1.1.2.2.6">50304</th>
</tr>
<tr class="ltx_tr" id="A2.T2.1.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" id="A2.T2.1.1.3.3.1">Non-embedding Params</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="A2.T2.1.1.3.3.2">18,915,328</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="A2.T2.1.1.3.3.3">85,056,000</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="A2.T2.1.1.3.3.4">201,541,632</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="A2.T2.1.1.3.3.5">302,311,424</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="A2.T2.1.1.3.3.6">805,736,448</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T2.1.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T2.1.1.4.1.1">Layers</th>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.4.1.2">6</td>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.4.1.3">12</td>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.4.1.4">16</td>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.4.1.5">24</td>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.4.1.6">16</td>
</tr>
<tr class="ltx_tr" id="A2.T2.1.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T2.1.1.5.2.1">Model Dimension</th>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.5.2.2">512</td>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.5.2.3">768</td>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.5.2.4">1024</td>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.5.2.5">1024</td>
<td class="ltx_td ltx_align_left" id="A2.T2.1.1.5.2.6">2048</td>
</tr>
<tr class="ltx_tr" id="A2.T2.1.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T2.1.1.6.3.1">Heads</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T2.1.1.6.3.2">8</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T2.1.1.6.3.3">12</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T2.1.1.6.3.4">16</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T2.1.1.6.3.5">16</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T2.1.1.6.3.6">8</td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1">For datasets, we mainly experiment with the Pile and RedPajama.
For the Pile, we find duplicates in the raw data, so deduplication is performed before training with it.
The Pile contains 5 coarse-grained domains, which are further decomposed into 22 fine-grained domains.
Our experiment in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS1" title="3.1 Pilot Study on Domain Losses under Two-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.1</span></a> is on Github and Pile-CC domains while the experiment in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS2" title="3.2 Extension to Domain Losses Trained on Multi-domain Mixtures ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.2</span></a> is on Github, Pile-CC, and the Books.
All these are fine-grained domains.
For our experiments with 5 domains in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.SS3" title="3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">3.3</span></a> we adopt the five coarse-grained domains, i.e., academic, internet, prose, dialogues, and misc, where misc include Github and the DeepMind Mathematics Dataset which are symbolic content.
We use the coarse-grained domains because it is hard to find five fine-grained domains with sufficient tokens.
For the RedPajama, we download the version produced and shared by <cite class="ltx_cite ltx_citemacro_citet">Chen et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib12" title="">2024a</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Fitting Mixture Laws</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">Fitting the mixture law requires us to first experiment on a few mixtures and obtain their losses.
The sample mixture chosen for fitting could largely affect the prediction accuracy.
Consider an extreme case where all sample mixtures have proportions around a small region, it is hardly possible to fit a law that reliably predicts the whole proportion space.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.1">In this paper, we intuitively try evenly allocating the mixture proportions regarding their losses.
Specifically, we enumerate candidate mixtures by double-diminishing the proportion of each domain so that the losses are distributed evenly among these mixtures.
Then, according to the available computation budget, we sample a certain number of mixtures from the candidates to run experiments.
During sampling, we find candidate mixtures with a 0 domain proportion in any of the training domains take up a majority of the candidates.
To avoid these candidates making up all our samples, we specifically down-sample them.
The concrete algorithms are in Alg.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#alg2" title="Algorithm 2 ‣ B.2 Fitting Mixture Laws ‣ Appendix B Implementation Details ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">2</span></a>.
Additionally, we employ AdaBoost Regressor&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Drucker, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib16" title="">1997</a>)</cite> for fitting the mixture laws to stabilize the predictions and improve their accuracy.
We encourage future studies to dive into a more careful design of candidate mixture selection with theoretical support.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed_top" id="alg2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Sampling mixture proportions for fitting mixture laws.</figcaption>
<div class="ltx_listing ltx_align_center ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg2.l1.1">Input:</span> Maximum proportions of <math alttext="M" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">italic_M</annotation></semantics></math> domains <math alttext="\bm{r}_{max}=[r_{max,1},\dots,r_{max,M}]" class="ltx_Math" display="inline" id="alg2.l1.m2.7"><semantics id="alg2.l1.m2.7a"><mrow id="alg2.l1.m2.7.7" xref="alg2.l1.m2.7.7.cmml"><msub id="alg2.l1.m2.7.7.4" xref="alg2.l1.m2.7.7.4.cmml"><mi id="alg2.l1.m2.7.7.4.2" xref="alg2.l1.m2.7.7.4.2.cmml">𝒓</mi><mrow id="alg2.l1.m2.7.7.4.3" xref="alg2.l1.m2.7.7.4.3.cmml"><mi id="alg2.l1.m2.7.7.4.3.2" xref="alg2.l1.m2.7.7.4.3.2.cmml">m</mi><mo id="alg2.l1.m2.7.7.4.3.1" xref="alg2.l1.m2.7.7.4.3.1.cmml">⁢</mo><mi id="alg2.l1.m2.7.7.4.3.3" xref="alg2.l1.m2.7.7.4.3.3.cmml">a</mi><mo id="alg2.l1.m2.7.7.4.3.1a" xref="alg2.l1.m2.7.7.4.3.1.cmml">⁢</mo><mi id="alg2.l1.m2.7.7.4.3.4" xref="alg2.l1.m2.7.7.4.3.4.cmml">x</mi></mrow></msub><mo id="alg2.l1.m2.7.7.3" xref="alg2.l1.m2.7.7.3.cmml">=</mo><mrow id="alg2.l1.m2.7.7.2.2" xref="alg2.l1.m2.7.7.2.3.cmml"><mo id="alg2.l1.m2.7.7.2.2.3" stretchy="false" xref="alg2.l1.m2.7.7.2.3.cmml">[</mo><msub id="alg2.l1.m2.6.6.1.1.1" xref="alg2.l1.m2.6.6.1.1.1.cmml"><mi id="alg2.l1.m2.6.6.1.1.1.2" xref="alg2.l1.m2.6.6.1.1.1.2.cmml">r</mi><mrow id="alg2.l1.m2.2.2.2.2" xref="alg2.l1.m2.2.2.2.3.cmml"><mrow id="alg2.l1.m2.2.2.2.2.1" xref="alg2.l1.m2.2.2.2.2.1.cmml"><mi id="alg2.l1.m2.2.2.2.2.1.2" xref="alg2.l1.m2.2.2.2.2.1.2.cmml">m</mi><mo id="alg2.l1.m2.2.2.2.2.1.1" xref="alg2.l1.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m2.2.2.2.2.1.3" xref="alg2.l1.m2.2.2.2.2.1.3.cmml">a</mi><mo id="alg2.l1.m2.2.2.2.2.1.1a" xref="alg2.l1.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m2.2.2.2.2.1.4" xref="alg2.l1.m2.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m2.2.2.2.2.2" xref="alg2.l1.m2.2.2.2.3.cmml">,</mo><mn id="alg2.l1.m2.1.1.1.1" xref="alg2.l1.m2.1.1.1.1.cmml">1</mn></mrow></msub><mo id="alg2.l1.m2.7.7.2.2.4" xref="alg2.l1.m2.7.7.2.3.cmml">,</mo><mi id="alg2.l1.m2.5.5" mathvariant="normal" xref="alg2.l1.m2.5.5.cmml">…</mi><mo id="alg2.l1.m2.7.7.2.2.5" xref="alg2.l1.m2.7.7.2.3.cmml">,</mo><msub id="alg2.l1.m2.7.7.2.2.2" xref="alg2.l1.m2.7.7.2.2.2.cmml"><mi id="alg2.l1.m2.7.7.2.2.2.2" xref="alg2.l1.m2.7.7.2.2.2.2.cmml">r</mi><mrow id="alg2.l1.m2.4.4.2.2" xref="alg2.l1.m2.4.4.2.3.cmml"><mrow id="alg2.l1.m2.4.4.2.2.1" xref="alg2.l1.m2.4.4.2.2.1.cmml"><mi id="alg2.l1.m2.4.4.2.2.1.2" xref="alg2.l1.m2.4.4.2.2.1.2.cmml">m</mi><mo id="alg2.l1.m2.4.4.2.2.1.1" xref="alg2.l1.m2.4.4.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m2.4.4.2.2.1.3" xref="alg2.l1.m2.4.4.2.2.1.3.cmml">a</mi><mo id="alg2.l1.m2.4.4.2.2.1.1a" xref="alg2.l1.m2.4.4.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m2.4.4.2.2.1.4" xref="alg2.l1.m2.4.4.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m2.4.4.2.2.2" xref="alg2.l1.m2.4.4.2.3.cmml">,</mo><mi id="alg2.l1.m2.3.3.1.1" xref="alg2.l1.m2.3.3.1.1.cmml">M</mi></mrow></msub><mo id="alg2.l1.m2.7.7.2.2.6" stretchy="false" xref="alg2.l1.m2.7.7.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.7b"><apply id="alg2.l1.m2.7.7.cmml" xref="alg2.l1.m2.7.7"><eq id="alg2.l1.m2.7.7.3.cmml" xref="alg2.l1.m2.7.7.3"></eq><apply id="alg2.l1.m2.7.7.4.cmml" xref="alg2.l1.m2.7.7.4"><csymbol cd="ambiguous" id="alg2.l1.m2.7.7.4.1.cmml" xref="alg2.l1.m2.7.7.4">subscript</csymbol><ci id="alg2.l1.m2.7.7.4.2.cmml" xref="alg2.l1.m2.7.7.4.2">𝒓</ci><apply id="alg2.l1.m2.7.7.4.3.cmml" xref="alg2.l1.m2.7.7.4.3"><times id="alg2.l1.m2.7.7.4.3.1.cmml" xref="alg2.l1.m2.7.7.4.3.1"></times><ci id="alg2.l1.m2.7.7.4.3.2.cmml" xref="alg2.l1.m2.7.7.4.3.2">𝑚</ci><ci id="alg2.l1.m2.7.7.4.3.3.cmml" xref="alg2.l1.m2.7.7.4.3.3">𝑎</ci><ci id="alg2.l1.m2.7.7.4.3.4.cmml" xref="alg2.l1.m2.7.7.4.3.4">𝑥</ci></apply></apply><list id="alg2.l1.m2.7.7.2.3.cmml" xref="alg2.l1.m2.7.7.2.2"><apply id="alg2.l1.m2.6.6.1.1.1.cmml" xref="alg2.l1.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.6.6.1.1.1.1.cmml" xref="alg2.l1.m2.6.6.1.1.1">subscript</csymbol><ci id="alg2.l1.m2.6.6.1.1.1.2.cmml" xref="alg2.l1.m2.6.6.1.1.1.2">𝑟</ci><list id="alg2.l1.m2.2.2.2.3.cmml" xref="alg2.l1.m2.2.2.2.2"><apply id="alg2.l1.m2.2.2.2.2.1.cmml" xref="alg2.l1.m2.2.2.2.2.1"><times id="alg2.l1.m2.2.2.2.2.1.1.cmml" xref="alg2.l1.m2.2.2.2.2.1.1"></times><ci id="alg2.l1.m2.2.2.2.2.1.2.cmml" xref="alg2.l1.m2.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l1.m2.2.2.2.2.1.3.cmml" xref="alg2.l1.m2.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l1.m2.2.2.2.2.1.4.cmml" xref="alg2.l1.m2.2.2.2.2.1.4">𝑥</ci></apply><cn id="alg2.l1.m2.1.1.1.1.cmml" type="integer" xref="alg2.l1.m2.1.1.1.1">1</cn></list></apply><ci id="alg2.l1.m2.5.5.cmml" xref="alg2.l1.m2.5.5">…</ci><apply id="alg2.l1.m2.7.7.2.2.2.cmml" xref="alg2.l1.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m2.7.7.2.2.2.1.cmml" xref="alg2.l1.m2.7.7.2.2.2">subscript</csymbol><ci id="alg2.l1.m2.7.7.2.2.2.2.cmml" xref="alg2.l1.m2.7.7.2.2.2.2">𝑟</ci><list id="alg2.l1.m2.4.4.2.3.cmml" xref="alg2.l1.m2.4.4.2.2"><apply id="alg2.l1.m2.4.4.2.2.1.cmml" xref="alg2.l1.m2.4.4.2.2.1"><times id="alg2.l1.m2.4.4.2.2.1.1.cmml" xref="alg2.l1.m2.4.4.2.2.1.1"></times><ci id="alg2.l1.m2.4.4.2.2.1.2.cmml" xref="alg2.l1.m2.4.4.2.2.1.2">𝑚</ci><ci id="alg2.l1.m2.4.4.2.2.1.3.cmml" xref="alg2.l1.m2.4.4.2.2.1.3">𝑎</ci><ci id="alg2.l1.m2.4.4.2.2.1.4.cmml" xref="alg2.l1.m2.4.4.2.2.1.4">𝑥</ci></apply><ci id="alg2.l1.m2.3.3.1.1.cmml" xref="alg2.l1.m2.3.3.1.1">𝑀</ci></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.7c">\bm{r}_{max}=[r_{max,1},\dots,r_{max,M}]</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.7d">bold_italic_r start_POSTSUBSCRIPT italic_m italic_a italic_x end_POSTSUBSCRIPT = [ italic_r start_POSTSUBSCRIPT italic_m italic_a italic_x , 1 end_POSTSUBSCRIPT , … , italic_r start_POSTSUBSCRIPT italic_m italic_a italic_x , italic_M end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="r_{max,i}=\frac{D_{i}}{D_{target}}" class="ltx_Math" display="inline" id="alg2.l1.m3.2"><semantics id="alg2.l1.m3.2a"><mrow id="alg2.l1.m3.2.3" xref="alg2.l1.m3.2.3.cmml"><msub id="alg2.l1.m3.2.3.2" xref="alg2.l1.m3.2.3.2.cmml"><mi id="alg2.l1.m3.2.3.2.2" xref="alg2.l1.m3.2.3.2.2.cmml">r</mi><mrow id="alg2.l1.m3.2.2.2.2" xref="alg2.l1.m3.2.2.2.3.cmml"><mrow id="alg2.l1.m3.2.2.2.2.1" xref="alg2.l1.m3.2.2.2.2.1.cmml"><mi id="alg2.l1.m3.2.2.2.2.1.2" xref="alg2.l1.m3.2.2.2.2.1.2.cmml">m</mi><mo id="alg2.l1.m3.2.2.2.2.1.1" xref="alg2.l1.m3.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m3.2.2.2.2.1.3" xref="alg2.l1.m3.2.2.2.2.1.3.cmml">a</mi><mo id="alg2.l1.m3.2.2.2.2.1.1a" xref="alg2.l1.m3.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m3.2.2.2.2.1.4" xref="alg2.l1.m3.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m3.2.2.2.2.2" xref="alg2.l1.m3.2.2.2.3.cmml">,</mo><mi id="alg2.l1.m3.1.1.1.1" xref="alg2.l1.m3.1.1.1.1.cmml">i</mi></mrow></msub><mo id="alg2.l1.m3.2.3.1" xref="alg2.l1.m3.2.3.1.cmml">=</mo><mfrac id="alg2.l1.m3.2.3.3" xref="alg2.l1.m3.2.3.3.cmml"><msub id="alg2.l1.m3.2.3.3.2" xref="alg2.l1.m3.2.3.3.2.cmml"><mi id="alg2.l1.m3.2.3.3.2.2" xref="alg2.l1.m3.2.3.3.2.2.cmml">D</mi><mi id="alg2.l1.m3.2.3.3.2.3" xref="alg2.l1.m3.2.3.3.2.3.cmml">i</mi></msub><msub id="alg2.l1.m3.2.3.3.3" xref="alg2.l1.m3.2.3.3.3.cmml"><mi id="alg2.l1.m3.2.3.3.3.2" xref="alg2.l1.m3.2.3.3.3.2.cmml">D</mi><mrow id="alg2.l1.m3.2.3.3.3.3" xref="alg2.l1.m3.2.3.3.3.3.cmml"><mi id="alg2.l1.m3.2.3.3.3.3.2" xref="alg2.l1.m3.2.3.3.3.3.2.cmml">t</mi><mo id="alg2.l1.m3.2.3.3.3.3.1" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m3.2.3.3.3.3.3" xref="alg2.l1.m3.2.3.3.3.3.3.cmml">a</mi><mo id="alg2.l1.m3.2.3.3.3.3.1a" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m3.2.3.3.3.3.4" xref="alg2.l1.m3.2.3.3.3.3.4.cmml">r</mi><mo id="alg2.l1.m3.2.3.3.3.3.1b" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m3.2.3.3.3.3.5" xref="alg2.l1.m3.2.3.3.3.3.5.cmml">g</mi><mo id="alg2.l1.m3.2.3.3.3.3.1c" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m3.2.3.3.3.3.6" xref="alg2.l1.m3.2.3.3.3.3.6.cmml">e</mi><mo id="alg2.l1.m3.2.3.3.3.3.1d" xref="alg2.l1.m3.2.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m3.2.3.3.3.3.7" xref="alg2.l1.m3.2.3.3.3.3.7.cmml">t</mi></mrow></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.2b"><apply id="alg2.l1.m3.2.3.cmml" xref="alg2.l1.m3.2.3"><eq id="alg2.l1.m3.2.3.1.cmml" xref="alg2.l1.m3.2.3.1"></eq><apply id="alg2.l1.m3.2.3.2.cmml" xref="alg2.l1.m3.2.3.2"><csymbol cd="ambiguous" id="alg2.l1.m3.2.3.2.1.cmml" xref="alg2.l1.m3.2.3.2">subscript</csymbol><ci id="alg2.l1.m3.2.3.2.2.cmml" xref="alg2.l1.m3.2.3.2.2">𝑟</ci><list id="alg2.l1.m3.2.2.2.3.cmml" xref="alg2.l1.m3.2.2.2.2"><apply id="alg2.l1.m3.2.2.2.2.1.cmml" xref="alg2.l1.m3.2.2.2.2.1"><times id="alg2.l1.m3.2.2.2.2.1.1.cmml" xref="alg2.l1.m3.2.2.2.2.1.1"></times><ci id="alg2.l1.m3.2.2.2.2.1.2.cmml" xref="alg2.l1.m3.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l1.m3.2.2.2.2.1.3.cmml" xref="alg2.l1.m3.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l1.m3.2.2.2.2.1.4.cmml" xref="alg2.l1.m3.2.2.2.2.1.4">𝑥</ci></apply><ci id="alg2.l1.m3.1.1.1.1.cmml" xref="alg2.l1.m3.1.1.1.1">𝑖</ci></list></apply><apply id="alg2.l1.m3.2.3.3.cmml" xref="alg2.l1.m3.2.3.3"><divide id="alg2.l1.m3.2.3.3.1.cmml" xref="alg2.l1.m3.2.3.3"></divide><apply id="alg2.l1.m3.2.3.3.2.cmml" xref="alg2.l1.m3.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l1.m3.2.3.3.2.1.cmml" xref="alg2.l1.m3.2.3.3.2">subscript</csymbol><ci id="alg2.l1.m3.2.3.3.2.2.cmml" xref="alg2.l1.m3.2.3.3.2.2">𝐷</ci><ci id="alg2.l1.m3.2.3.3.2.3.cmml" xref="alg2.l1.m3.2.3.3.2.3">𝑖</ci></apply><apply id="alg2.l1.m3.2.3.3.3.cmml" xref="alg2.l1.m3.2.3.3.3"><csymbol cd="ambiguous" id="alg2.l1.m3.2.3.3.3.1.cmml" xref="alg2.l1.m3.2.3.3.3">subscript</csymbol><ci id="alg2.l1.m3.2.3.3.3.2.cmml" xref="alg2.l1.m3.2.3.3.3.2">𝐷</ci><apply id="alg2.l1.m3.2.3.3.3.3.cmml" xref="alg2.l1.m3.2.3.3.3.3"><times id="alg2.l1.m3.2.3.3.3.3.1.cmml" xref="alg2.l1.m3.2.3.3.3.3.1"></times><ci id="alg2.l1.m3.2.3.3.3.3.2.cmml" xref="alg2.l1.m3.2.3.3.3.3.2">𝑡</ci><ci id="alg2.l1.m3.2.3.3.3.3.3.cmml" xref="alg2.l1.m3.2.3.3.3.3.3">𝑎</ci><ci id="alg2.l1.m3.2.3.3.3.3.4.cmml" xref="alg2.l1.m3.2.3.3.3.3.4">𝑟</ci><ci id="alg2.l1.m3.2.3.3.3.3.5.cmml" xref="alg2.l1.m3.2.3.3.3.3.5">𝑔</ci><ci id="alg2.l1.m3.2.3.3.3.3.6.cmml" xref="alg2.l1.m3.2.3.3.3.3.6">𝑒</ci><ci id="alg2.l1.m3.2.3.3.3.3.7.cmml" xref="alg2.l1.m3.2.3.3.3.3.7">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.2c">r_{max,i}=\frac{D_{i}}{D_{target}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.2d">italic_r start_POSTSUBSCRIPT italic_m italic_a italic_x , italic_i end_POSTSUBSCRIPT = divide start_ARG italic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_D start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> with <math alttext="D_{i}" class="ltx_Math" display="inline" id="alg2.l1.m4.1"><semantics id="alg2.l1.m4.1a"><msub id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml"><mi id="alg2.l1.m4.1.1.2" xref="alg2.l1.m4.1.1.2.cmml">D</mi><mi id="alg2.l1.m4.1.1.3" xref="alg2.l1.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><apply id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1"><csymbol cd="ambiguous" id="alg2.l1.m4.1.1.1.cmml" xref="alg2.l1.m4.1.1">subscript</csymbol><ci id="alg2.l1.m4.1.1.2.cmml" xref="alg2.l1.m4.1.1.2">𝐷</ci><ci id="alg2.l1.m4.1.1.3.cmml" xref="alg2.l1.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">D_{i}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m4.1d">italic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="D_{target}" class="ltx_Math" display="inline" id="alg2.l1.m5.1"><semantics id="alg2.l1.m5.1a"><msub id="alg2.l1.m5.1.1" xref="alg2.l1.m5.1.1.cmml"><mi id="alg2.l1.m5.1.1.2" xref="alg2.l1.m5.1.1.2.cmml">D</mi><mrow id="alg2.l1.m5.1.1.3" xref="alg2.l1.m5.1.1.3.cmml"><mi id="alg2.l1.m5.1.1.3.2" xref="alg2.l1.m5.1.1.3.2.cmml">t</mi><mo id="alg2.l1.m5.1.1.3.1" xref="alg2.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg2.l1.m5.1.1.3.3" xref="alg2.l1.m5.1.1.3.3.cmml">a</mi><mo id="alg2.l1.m5.1.1.3.1a" xref="alg2.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg2.l1.m5.1.1.3.4" xref="alg2.l1.m5.1.1.3.4.cmml">r</mi><mo id="alg2.l1.m5.1.1.3.1b" xref="alg2.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg2.l1.m5.1.1.3.5" xref="alg2.l1.m5.1.1.3.5.cmml">g</mi><mo id="alg2.l1.m5.1.1.3.1c" xref="alg2.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg2.l1.m5.1.1.3.6" xref="alg2.l1.m5.1.1.3.6.cmml">e</mi><mo id="alg2.l1.m5.1.1.3.1d" xref="alg2.l1.m5.1.1.3.1.cmml">⁢</mo><mi id="alg2.l1.m5.1.1.3.7" xref="alg2.l1.m5.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><apply id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1"><csymbol cd="ambiguous" id="alg2.l1.m5.1.1.1.cmml" xref="alg2.l1.m5.1.1">subscript</csymbol><ci id="alg2.l1.m5.1.1.2.cmml" xref="alg2.l1.m5.1.1.2">𝐷</ci><apply id="alg2.l1.m5.1.1.3.cmml" xref="alg2.l1.m5.1.1.3"><times id="alg2.l1.m5.1.1.3.1.cmml" xref="alg2.l1.m5.1.1.3.1"></times><ci id="alg2.l1.m5.1.1.3.2.cmml" xref="alg2.l1.m5.1.1.3.2">𝑡</ci><ci id="alg2.l1.m5.1.1.3.3.cmml" xref="alg2.l1.m5.1.1.3.3">𝑎</ci><ci id="alg2.l1.m5.1.1.3.4.cmml" xref="alg2.l1.m5.1.1.3.4">𝑟</ci><ci id="alg2.l1.m5.1.1.3.5.cmml" xref="alg2.l1.m5.1.1.3.5">𝑔</ci><ci id="alg2.l1.m5.1.1.3.6.cmml" xref="alg2.l1.m5.1.1.3.6">𝑒</ci><ci id="alg2.l1.m5.1.1.3.7.cmml" xref="alg2.l1.m5.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">D_{target}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m5.1d">italic_D start_POSTSUBSCRIPT italic_t italic_a italic_r italic_g italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> being numbers of available tokens in <math alttext="i" class="ltx_Math" display="inline" id="alg2.l1.m6.1"><semantics id="alg2.l1.m6.1a"><mi id="alg2.l1.m6.1.1" xref="alg2.l1.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m6.1b"><ci id="alg2.l1.m6.1.1.cmml" xref="alg2.l1.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m6.1d">italic_i</annotation></semantics></math>-th domain and target number of training tokens, respectively, sorted in descending orders (i.e., <math alttext="r_{max,1}\geq r_{max,2}\geq\cdots\geq r_{max,M}" class="ltx_Math" display="inline" id="alg2.l1.m7.6"><semantics id="alg2.l1.m7.6a"><mrow id="alg2.l1.m7.6.7" xref="alg2.l1.m7.6.7.cmml"><msub id="alg2.l1.m7.6.7.2" xref="alg2.l1.m7.6.7.2.cmml"><mi id="alg2.l1.m7.6.7.2.2" xref="alg2.l1.m7.6.7.2.2.cmml">r</mi><mrow id="alg2.l1.m7.2.2.2.2" xref="alg2.l1.m7.2.2.2.3.cmml"><mrow id="alg2.l1.m7.2.2.2.2.1" xref="alg2.l1.m7.2.2.2.2.1.cmml"><mi id="alg2.l1.m7.2.2.2.2.1.2" xref="alg2.l1.m7.2.2.2.2.1.2.cmml">m</mi><mo id="alg2.l1.m7.2.2.2.2.1.1" xref="alg2.l1.m7.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m7.2.2.2.2.1.3" xref="alg2.l1.m7.2.2.2.2.1.3.cmml">a</mi><mo id="alg2.l1.m7.2.2.2.2.1.1a" xref="alg2.l1.m7.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m7.2.2.2.2.1.4" xref="alg2.l1.m7.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m7.2.2.2.2.2" xref="alg2.l1.m7.2.2.2.3.cmml">,</mo><mn id="alg2.l1.m7.1.1.1.1" xref="alg2.l1.m7.1.1.1.1.cmml">1</mn></mrow></msub><mo id="alg2.l1.m7.6.7.3" xref="alg2.l1.m7.6.7.3.cmml">≥</mo><msub id="alg2.l1.m7.6.7.4" xref="alg2.l1.m7.6.7.4.cmml"><mi id="alg2.l1.m7.6.7.4.2" xref="alg2.l1.m7.6.7.4.2.cmml">r</mi><mrow id="alg2.l1.m7.4.4.2.2" xref="alg2.l1.m7.4.4.2.3.cmml"><mrow id="alg2.l1.m7.4.4.2.2.1" xref="alg2.l1.m7.4.4.2.2.1.cmml"><mi id="alg2.l1.m7.4.4.2.2.1.2" xref="alg2.l1.m7.4.4.2.2.1.2.cmml">m</mi><mo id="alg2.l1.m7.4.4.2.2.1.1" xref="alg2.l1.m7.4.4.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m7.4.4.2.2.1.3" xref="alg2.l1.m7.4.4.2.2.1.3.cmml">a</mi><mo id="alg2.l1.m7.4.4.2.2.1.1a" xref="alg2.l1.m7.4.4.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m7.4.4.2.2.1.4" xref="alg2.l1.m7.4.4.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m7.4.4.2.2.2" xref="alg2.l1.m7.4.4.2.3.cmml">,</mo><mn id="alg2.l1.m7.3.3.1.1" xref="alg2.l1.m7.3.3.1.1.cmml">2</mn></mrow></msub><mo id="alg2.l1.m7.6.7.5" xref="alg2.l1.m7.6.7.5.cmml">≥</mo><mi id="alg2.l1.m7.6.7.6" mathvariant="normal" xref="alg2.l1.m7.6.7.6.cmml">⋯</mi><mo id="alg2.l1.m7.6.7.7" xref="alg2.l1.m7.6.7.7.cmml">≥</mo><msub id="alg2.l1.m7.6.7.8" xref="alg2.l1.m7.6.7.8.cmml"><mi id="alg2.l1.m7.6.7.8.2" xref="alg2.l1.m7.6.7.8.2.cmml">r</mi><mrow id="alg2.l1.m7.6.6.2.2" xref="alg2.l1.m7.6.6.2.3.cmml"><mrow id="alg2.l1.m7.6.6.2.2.1" xref="alg2.l1.m7.6.6.2.2.1.cmml"><mi id="alg2.l1.m7.6.6.2.2.1.2" xref="alg2.l1.m7.6.6.2.2.1.2.cmml">m</mi><mo id="alg2.l1.m7.6.6.2.2.1.1" xref="alg2.l1.m7.6.6.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m7.6.6.2.2.1.3" xref="alg2.l1.m7.6.6.2.2.1.3.cmml">a</mi><mo id="alg2.l1.m7.6.6.2.2.1.1a" xref="alg2.l1.m7.6.6.2.2.1.1.cmml">⁢</mo><mi id="alg2.l1.m7.6.6.2.2.1.4" xref="alg2.l1.m7.6.6.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l1.m7.6.6.2.2.2" xref="alg2.l1.m7.6.6.2.3.cmml">,</mo><mi id="alg2.l1.m7.5.5.1.1" xref="alg2.l1.m7.5.5.1.1.cmml">M</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m7.6b"><apply id="alg2.l1.m7.6.7.cmml" xref="alg2.l1.m7.6.7"><and id="alg2.l1.m7.6.7a.cmml" xref="alg2.l1.m7.6.7"></and><apply id="alg2.l1.m7.6.7b.cmml" xref="alg2.l1.m7.6.7"><geq id="alg2.l1.m7.6.7.3.cmml" xref="alg2.l1.m7.6.7.3"></geq><apply id="alg2.l1.m7.6.7.2.cmml" xref="alg2.l1.m7.6.7.2"><csymbol cd="ambiguous" id="alg2.l1.m7.6.7.2.1.cmml" xref="alg2.l1.m7.6.7.2">subscript</csymbol><ci id="alg2.l1.m7.6.7.2.2.cmml" xref="alg2.l1.m7.6.7.2.2">𝑟</ci><list id="alg2.l1.m7.2.2.2.3.cmml" xref="alg2.l1.m7.2.2.2.2"><apply id="alg2.l1.m7.2.2.2.2.1.cmml" xref="alg2.l1.m7.2.2.2.2.1"><times id="alg2.l1.m7.2.2.2.2.1.1.cmml" xref="alg2.l1.m7.2.2.2.2.1.1"></times><ci id="alg2.l1.m7.2.2.2.2.1.2.cmml" xref="alg2.l1.m7.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l1.m7.2.2.2.2.1.3.cmml" xref="alg2.l1.m7.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l1.m7.2.2.2.2.1.4.cmml" xref="alg2.l1.m7.2.2.2.2.1.4">𝑥</ci></apply><cn id="alg2.l1.m7.1.1.1.1.cmml" type="integer" xref="alg2.l1.m7.1.1.1.1">1</cn></list></apply><apply id="alg2.l1.m7.6.7.4.cmml" xref="alg2.l1.m7.6.7.4"><csymbol cd="ambiguous" id="alg2.l1.m7.6.7.4.1.cmml" xref="alg2.l1.m7.6.7.4">subscript</csymbol><ci id="alg2.l1.m7.6.7.4.2.cmml" xref="alg2.l1.m7.6.7.4.2">𝑟</ci><list id="alg2.l1.m7.4.4.2.3.cmml" xref="alg2.l1.m7.4.4.2.2"><apply id="alg2.l1.m7.4.4.2.2.1.cmml" xref="alg2.l1.m7.4.4.2.2.1"><times id="alg2.l1.m7.4.4.2.2.1.1.cmml" xref="alg2.l1.m7.4.4.2.2.1.1"></times><ci id="alg2.l1.m7.4.4.2.2.1.2.cmml" xref="alg2.l1.m7.4.4.2.2.1.2">𝑚</ci><ci id="alg2.l1.m7.4.4.2.2.1.3.cmml" xref="alg2.l1.m7.4.4.2.2.1.3">𝑎</ci><ci id="alg2.l1.m7.4.4.2.2.1.4.cmml" xref="alg2.l1.m7.4.4.2.2.1.4">𝑥</ci></apply><cn id="alg2.l1.m7.3.3.1.1.cmml" type="integer" xref="alg2.l1.m7.3.3.1.1">2</cn></list></apply></apply><apply id="alg2.l1.m7.6.7c.cmml" xref="alg2.l1.m7.6.7"><geq id="alg2.l1.m7.6.7.5.cmml" xref="alg2.l1.m7.6.7.5"></geq><share href="#alg2.l1.m7.6.7.4.cmml" id="alg2.l1.m7.6.7d.cmml" xref="alg2.l1.m7.6.7"></share><ci id="alg2.l1.m7.6.7.6.cmml" xref="alg2.l1.m7.6.7.6">⋯</ci></apply><apply id="alg2.l1.m7.6.7e.cmml" xref="alg2.l1.m7.6.7"><geq id="alg2.l1.m7.6.7.7.cmml" xref="alg2.l1.m7.6.7.7"></geq><share href="#alg2.l1.m7.6.7.6.cmml" id="alg2.l1.m7.6.7f.cmml" xref="alg2.l1.m7.6.7"></share><apply id="alg2.l1.m7.6.7.8.cmml" xref="alg2.l1.m7.6.7.8"><csymbol cd="ambiguous" id="alg2.l1.m7.6.7.8.1.cmml" xref="alg2.l1.m7.6.7.8">subscript</csymbol><ci id="alg2.l1.m7.6.7.8.2.cmml" xref="alg2.l1.m7.6.7.8.2">𝑟</ci><list id="alg2.l1.m7.6.6.2.3.cmml" xref="alg2.l1.m7.6.6.2.2"><apply id="alg2.l1.m7.6.6.2.2.1.cmml" xref="alg2.l1.m7.6.6.2.2.1"><times id="alg2.l1.m7.6.6.2.2.1.1.cmml" xref="alg2.l1.m7.6.6.2.2.1.1"></times><ci id="alg2.l1.m7.6.6.2.2.1.2.cmml" xref="alg2.l1.m7.6.6.2.2.1.2">𝑚</ci><ci id="alg2.l1.m7.6.6.2.2.1.3.cmml" xref="alg2.l1.m7.6.6.2.2.1.3">𝑎</ci><ci id="alg2.l1.m7.6.6.2.2.1.4.cmml" xref="alg2.l1.m7.6.6.2.2.1.4">𝑥</ci></apply><ci id="alg2.l1.m7.5.5.1.1.cmml" xref="alg2.l1.m7.5.5.1.1">𝑀</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m7.6c">r_{max,1}\geq r_{max,2}\geq\cdots\geq r_{max,M}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m7.6d">italic_r start_POSTSUBSCRIPT italic_m italic_a italic_x , 1 end_POSTSUBSCRIPT ≥ italic_r start_POSTSUBSCRIPT italic_m italic_a italic_x , 2 end_POSTSUBSCRIPT ≥ ⋯ ≥ italic_r start_POSTSUBSCRIPT italic_m italic_a italic_x , italic_M end_POSTSUBSCRIPT</annotation></semantics></math>), minimum proportion grid size <math alttext="\delta" class="ltx_Math" display="inline" id="alg2.l1.m8.1"><semantics id="alg2.l1.m8.1a"><mi id="alg2.l1.m8.1.1" xref="alg2.l1.m8.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m8.1b"><ci id="alg2.l1.m8.1.1.cmml" xref="alg2.l1.m8.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m8.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m8.1d">italic_δ</annotation></semantics></math>, number of mixture to run experiment <math alttext="N" class="ltx_Math" display="inline" id="alg2.l1.m9.1"><semantics id="alg2.l1.m9.1a"><mi id="alg2.l1.m9.1.1" xref="alg2.l1.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m9.1b"><ci id="alg2.l1.m9.1.1.cmml" xref="alg2.l1.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m9.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m9.1d">italic_N</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg2.l2.1">Output:</span> A set of <math alttext="N" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mi id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_N</annotation></semantics></math> mixtures to experiment <math alttext="\{\bm{r}_{n}\}_{n=1}^{N}" class="ltx_Math" display="inline" id="alg2.l2.m2.1"><semantics id="alg2.l2.m2.1a"><msubsup id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml"><mrow id="alg2.l2.m2.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.2.cmml"><mo id="alg2.l2.m2.1.1.1.1.1.2" stretchy="false" xref="alg2.l2.m2.1.1.1.1.2.cmml">{</mo><msub id="alg2.l2.m2.1.1.1.1.1.1" xref="alg2.l2.m2.1.1.1.1.1.1.cmml"><mi id="alg2.l2.m2.1.1.1.1.1.1.2" xref="alg2.l2.m2.1.1.1.1.1.1.2.cmml">𝒓</mi><mi id="alg2.l2.m2.1.1.1.1.1.1.3" xref="alg2.l2.m2.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="alg2.l2.m2.1.1.1.1.1.3" stretchy="false" xref="alg2.l2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l2.m2.1.1.1.3" xref="alg2.l2.m2.1.1.1.3.cmml"><mi id="alg2.l2.m2.1.1.1.3.2" xref="alg2.l2.m2.1.1.1.3.2.cmml">n</mi><mo id="alg2.l2.m2.1.1.1.3.1" xref="alg2.l2.m2.1.1.1.3.1.cmml">=</mo><mn id="alg2.l2.m2.1.1.1.3.3" xref="alg2.l2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg2.l2.m2.1.1.3" xref="alg2.l2.m2.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><apply id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.2.cmml" xref="alg2.l2.m2.1.1">superscript</csymbol><apply id="alg2.l2.m2.1.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.2.cmml" xref="alg2.l2.m2.1.1">subscript</csymbol><set id="alg2.l2.m2.1.1.1.1.2.cmml" xref="alg2.l2.m2.1.1.1.1.1"><apply id="alg2.l2.m2.1.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l2.m2.1.1.1.1.1.1.2.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.2">𝒓</ci><ci id="alg2.l2.m2.1.1.1.1.1.1.3.cmml" xref="alg2.l2.m2.1.1.1.1.1.1.3">𝑛</ci></apply></set><apply id="alg2.l2.m2.1.1.1.3.cmml" xref="alg2.l2.m2.1.1.1.3"><eq id="alg2.l2.m2.1.1.1.3.1.cmml" xref="alg2.l2.m2.1.1.1.3.1"></eq><ci id="alg2.l2.m2.1.1.1.3.2.cmml" xref="alg2.l2.m2.1.1.1.3.2">𝑛</ci><cn id="alg2.l2.m2.1.1.1.3.3.cmml" type="integer" xref="alg2.l2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="alg2.l2.m2.1.1.3.cmml" xref="alg2.l2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">\{\bm{r}_{n}\}_{n=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m2.1d">{ bold_italic_r start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Candidate mixtures <math alttext="\mathcal{C}\leftarrow\textsc{GetAllCandidates}(1,[])" class="ltx_Math" display="inline" id="alg2.l3.m1.2"><semantics id="alg2.l3.m1.2a"><mrow id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.2.2.3" xref="alg2.l3.m1.2.2.3.cmml">𝒞</mi><mo id="alg2.l3.m1.2.2.2" stretchy="false" xref="alg2.l3.m1.2.2.2.cmml">←</mo><mrow id="alg2.l3.m1.2.2.1" xref="alg2.l3.m1.2.2.1.cmml"><mtext class="ltx_font_smallcaps" id="alg2.l3.m1.2.2.1.3" mathvariant="normal" xref="alg2.l3.m1.2.2.1.3a.cmml">GetAllCandidates</mtext><mo id="alg2.l3.m1.2.2.1.2" xref="alg2.l3.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l3.m1.2.2.1.1.1" xref="alg2.l3.m1.2.2.1.1.2.cmml"><mo id="alg2.l3.m1.2.2.1.1.1.2" stretchy="false" xref="alg2.l3.m1.2.2.1.1.2.cmml">(</mo><mn id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">1</mn><mo id="alg2.l3.m1.2.2.1.1.1.3" xref="alg2.l3.m1.2.2.1.1.2.cmml">,</mo><mrow id="alg2.l3.m1.2.2.1.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.2.cmml"><mo id="alg2.l3.m1.2.2.1.1.1.1.2.1" stretchy="false" xref="alg2.l3.m1.2.2.1.1.1.1.1.cmml">[</mo><mo id="alg2.l3.m1.2.2.1.1.1.1.2.2" stretchy="false" xref="alg2.l3.m1.2.2.1.1.1.1.1.cmml">]</mo></mrow><mo id="alg2.l3.m1.2.2.1.1.1.4" stretchy="false" xref="alg2.l3.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.2b"><apply id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2"><ci id="alg2.l3.m1.2.2.2.cmml" xref="alg2.l3.m1.2.2.2">←</ci><ci id="alg2.l3.m1.2.2.3.cmml" xref="alg2.l3.m1.2.2.3">𝒞</ci><apply id="alg2.l3.m1.2.2.1.cmml" xref="alg2.l3.m1.2.2.1"><times id="alg2.l3.m1.2.2.1.2.cmml" xref="alg2.l3.m1.2.2.1.2"></times><ci id="alg2.l3.m1.2.2.1.3a.cmml" xref="alg2.l3.m1.2.2.1.3"><mtext class="ltx_font_smallcaps" id="alg2.l3.m1.2.2.1.3.cmml" mathvariant="normal" xref="alg2.l3.m1.2.2.1.3">GetAllCandidates</mtext></ci><interval closure="open" id="alg2.l3.m1.2.2.1.1.2.cmml" xref="alg2.l3.m1.2.2.1.1.1"><cn id="alg2.l3.m1.1.1.cmml" type="integer" xref="alg2.l3.m1.1.1">1</cn><list id="alg2.l3.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.2.1"></list></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.2c">\mathcal{C}\leftarrow\textsc{GetAllCandidates}(1,[])</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.2d">caligraphic_C ← GetAllCandidates ( 1 , [ ] )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>Split mixtures with 0 proportion in <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">caligraphic_C</annotation></semantics></math> into <math alttext="\mathcal{C}_{0}" class="ltx_Math" display="inline" id="alg2.l4.m2.1"><semantics id="alg2.l4.m2.1a"><msub id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m2.1.1.2" xref="alg2.l4.m2.1.1.2.cmml">𝒞</mi><mn id="alg2.l4.m2.1.1.3" xref="alg2.l4.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1">subscript</csymbol><ci id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1.2">𝒞</ci><cn id="alg2.l4.m2.1.1.3.cmml" type="integer" xref="alg2.l4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">\mathcal{C}_{0}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m2.1d">caligraphic_C start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and the others into <math alttext="\mathcal{C}_{1}" class="ltx_Math" display="inline" id="alg2.l4.m3.1"><semantics id="alg2.l4.m3.1a"><msub id="alg2.l4.m3.1.1" xref="alg2.l4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m3.1.1.2" xref="alg2.l4.m3.1.1.2.cmml">𝒞</mi><mn id="alg2.l4.m3.1.1.3" xref="alg2.l4.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m3.1b"><apply id="alg2.l4.m3.1.1.cmml" xref="alg2.l4.m3.1.1"><csymbol cd="ambiguous" id="alg2.l4.m3.1.1.1.cmml" xref="alg2.l4.m3.1.1">subscript</csymbol><ci id="alg2.l4.m3.1.1.2.cmml" xref="alg2.l4.m3.1.1.2">𝒞</ci><cn id="alg2.l4.m3.1.1.3.cmml" type="integer" xref="alg2.l4.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m3.1c">\mathcal{C}_{1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m3.1d">caligraphic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>Samples <math alttext="\{\bm{r}_{n}\}_{n=1}^{\lfloor N/4\rfloor}" class="ltx_Math" display="inline" id="alg2.l5.m1.2"><semantics id="alg2.l5.m1.2a"><msubsup id="alg2.l5.m1.2.2" xref="alg2.l5.m1.2.2.cmml"><mrow id="alg2.l5.m1.2.2.1.1.1" xref="alg2.l5.m1.2.2.1.1.2.cmml"><mo id="alg2.l5.m1.2.2.1.1.1.2" stretchy="false" xref="alg2.l5.m1.2.2.1.1.2.cmml">{</mo><msub id="alg2.l5.m1.2.2.1.1.1.1" xref="alg2.l5.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l5.m1.2.2.1.1.1.1.2" xref="alg2.l5.m1.2.2.1.1.1.1.2.cmml">𝒓</mi><mi id="alg2.l5.m1.2.2.1.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.1.1.3.cmml">n</mi></msub><mo id="alg2.l5.m1.2.2.1.1.1.3" stretchy="false" xref="alg2.l5.m1.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l5.m1.2.2.1.3" xref="alg2.l5.m1.2.2.1.3.cmml"><mi id="alg2.l5.m1.2.2.1.3.2" xref="alg2.l5.m1.2.2.1.3.2.cmml">n</mi><mo id="alg2.l5.m1.2.2.1.3.1" xref="alg2.l5.m1.2.2.1.3.1.cmml">=</mo><mn id="alg2.l5.m1.2.2.1.3.3" xref="alg2.l5.m1.2.2.1.3.3.cmml">1</mn></mrow><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.2.cmml"><mo id="alg2.l5.m1.1.1.1.1.2" stretchy="false" xref="alg2.l5.m1.1.1.1.2.1.cmml">⌊</mo><mrow id="alg2.l5.m1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.cmml"><mi id="alg2.l5.m1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.2.cmml">N</mi><mo id="alg2.l5.m1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.cmml">/</mo><mn id="alg2.l5.m1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.3.cmml">4</mn></mrow><mo id="alg2.l5.m1.1.1.1.1.3" stretchy="false" xref="alg2.l5.m1.1.1.1.2.1.cmml">⌋</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.cmml" xref="alg2.l5.m1.2.2">superscript</csymbol><apply id="alg2.l5.m1.2.2.1.cmml" xref="alg2.l5.m1.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.2.cmml" xref="alg2.l5.m1.2.2">subscript</csymbol><set id="alg2.l5.m1.2.2.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1"><apply id="alg2.l5.m1.2.2.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.2">𝒓</ci><ci id="alg2.l5.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.3">𝑛</ci></apply></set><apply id="alg2.l5.m1.2.2.1.3.cmml" xref="alg2.l5.m1.2.2.1.3"><eq id="alg2.l5.m1.2.2.1.3.1.cmml" xref="alg2.l5.m1.2.2.1.3.1"></eq><ci id="alg2.l5.m1.2.2.1.3.2.cmml" xref="alg2.l5.m1.2.2.1.3.2">𝑛</ci><cn id="alg2.l5.m1.2.2.1.3.3.cmml" type="integer" xref="alg2.l5.m1.2.2.1.3.3">1</cn></apply></apply><apply id="alg2.l5.m1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1"><floor id="alg2.l5.m1.1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.2"></floor><apply id="alg2.l5.m1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1"><divide id="alg2.l5.m1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1"></divide><ci id="alg2.l5.m1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.2">𝑁</ci><cn id="alg2.l5.m1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l5.m1.1.1.1.1.1.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">\{\bm{r}_{n}\}_{n=1}^{\lfloor N/4\rfloor}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.2d">{ bold_italic_r start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⌊ italic_N / 4 ⌋ end_POSTSUPERSCRIPT</annotation></semantics></math> from <math alttext="\mathcal{C}_{0}" class="ltx_Math" display="inline" id="alg2.l5.m2.1"><semantics id="alg2.l5.m2.1a"><msub id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">𝒞</mi><mn id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1">subscript</csymbol><ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">𝒞</ci><cn id="alg2.l5.m2.1.1.3.cmml" type="integer" xref="alg2.l5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">\mathcal{C}_{0}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m2.1d">caligraphic_C start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\{\bm{r}_{n}\}_{n=\lceil N/4\rceil}^{N}" class="ltx_Math" display="inline" id="alg2.l5.m3.2"><semantics id="alg2.l5.m3.2a"><msubsup id="alg2.l5.m3.2.2" xref="alg2.l5.m3.2.2.cmml"><mrow id="alg2.l5.m3.2.2.1.1.1" xref="alg2.l5.m3.2.2.1.1.2.cmml"><mo id="alg2.l5.m3.2.2.1.1.1.2" stretchy="false" xref="alg2.l5.m3.2.2.1.1.2.cmml">{</mo><msub id="alg2.l5.m3.2.2.1.1.1.1" xref="alg2.l5.m3.2.2.1.1.1.1.cmml"><mi id="alg2.l5.m3.2.2.1.1.1.1.2" xref="alg2.l5.m3.2.2.1.1.1.1.2.cmml">𝒓</mi><mi id="alg2.l5.m3.2.2.1.1.1.1.3" xref="alg2.l5.m3.2.2.1.1.1.1.3.cmml">n</mi></msub><mo id="alg2.l5.m3.2.2.1.1.1.3" stretchy="false" xref="alg2.l5.m3.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l5.m3.1.1.1" xref="alg2.l5.m3.1.1.1.cmml"><mi id="alg2.l5.m3.1.1.1.3" xref="alg2.l5.m3.1.1.1.3.cmml">n</mi><mo id="alg2.l5.m3.1.1.1.2" xref="alg2.l5.m3.1.1.1.2.cmml">=</mo><mrow id="alg2.l5.m3.1.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.2.cmml"><mo id="alg2.l5.m3.1.1.1.1.1.2" stretchy="false" xref="alg2.l5.m3.1.1.1.1.2.1.cmml">⌈</mo><mrow id="alg2.l5.m3.1.1.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.1.1.cmml"><mi id="alg2.l5.m3.1.1.1.1.1.1.2" xref="alg2.l5.m3.1.1.1.1.1.1.2.cmml">N</mi><mo id="alg2.l5.m3.1.1.1.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.1.1.1.cmml">/</mo><mn id="alg2.l5.m3.1.1.1.1.1.1.3" xref="alg2.l5.m3.1.1.1.1.1.1.3.cmml">4</mn></mrow><mo id="alg2.l5.m3.1.1.1.1.1.3" stretchy="false" xref="alg2.l5.m3.1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow><mi id="alg2.l5.m3.2.2.3" xref="alg2.l5.m3.2.2.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l5.m3.2b"><apply id="alg2.l5.m3.2.2.cmml" xref="alg2.l5.m3.2.2"><csymbol cd="ambiguous" id="alg2.l5.m3.2.2.2.cmml" xref="alg2.l5.m3.2.2">superscript</csymbol><apply id="alg2.l5.m3.2.2.1.cmml" xref="alg2.l5.m3.2.2"><csymbol cd="ambiguous" id="alg2.l5.m3.2.2.1.2.cmml" xref="alg2.l5.m3.2.2">subscript</csymbol><set id="alg2.l5.m3.2.2.1.1.2.cmml" xref="alg2.l5.m3.2.2.1.1.1"><apply id="alg2.l5.m3.2.2.1.1.1.1.cmml" xref="alg2.l5.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m3.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m3.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m3.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m3.2.2.1.1.1.1.2">𝒓</ci><ci id="alg2.l5.m3.2.2.1.1.1.1.3.cmml" xref="alg2.l5.m3.2.2.1.1.1.1.3">𝑛</ci></apply></set><apply id="alg2.l5.m3.1.1.1.cmml" xref="alg2.l5.m3.1.1.1"><eq id="alg2.l5.m3.1.1.1.2.cmml" xref="alg2.l5.m3.1.1.1.2"></eq><ci id="alg2.l5.m3.1.1.1.3.cmml" xref="alg2.l5.m3.1.1.1.3">𝑛</ci><apply id="alg2.l5.m3.1.1.1.1.2.cmml" xref="alg2.l5.m3.1.1.1.1.1"><ceiling id="alg2.l5.m3.1.1.1.1.2.1.cmml" xref="alg2.l5.m3.1.1.1.1.1.2"></ceiling><apply id="alg2.l5.m3.1.1.1.1.1.1.cmml" xref="alg2.l5.m3.1.1.1.1.1.1"><divide id="alg2.l5.m3.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m3.1.1.1.1.1.1.1"></divide><ci id="alg2.l5.m3.1.1.1.1.1.1.2.cmml" xref="alg2.l5.m3.1.1.1.1.1.1.2">𝑁</ci><cn id="alg2.l5.m3.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l5.m3.1.1.1.1.1.1.3">4</cn></apply></apply></apply></apply><ci id="alg2.l5.m3.2.2.3.cmml" xref="alg2.l5.m3.2.2.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m3.2c">\{\bm{r}_{n}\}_{n=\lceil N/4\rceil}^{N}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m3.2d">{ bold_italic_r start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_n = ⌈ italic_N / 4 ⌉ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> from <math alttext="\mathcal{C}_{1}" class="ltx_Math" display="inline" id="alg2.l5.m4.1"><semantics id="alg2.l5.m4.1a"><msub id="alg2.l5.m4.1.1" xref="alg2.l5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m4.1.1.2" xref="alg2.l5.m4.1.1.2.cmml">𝒞</mi><mn id="alg2.l5.m4.1.1.3" xref="alg2.l5.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m4.1b"><apply id="alg2.l5.m4.1.1.cmml" xref="alg2.l5.m4.1.1"><csymbol cd="ambiguous" id="alg2.l5.m4.1.1.1.cmml" xref="alg2.l5.m4.1.1">subscript</csymbol><ci id="alg2.l5.m4.1.1.2.cmml" xref="alg2.l5.m4.1.1.2">𝒞</ci><cn id="alg2.l5.m4.1.1.3.cmml" type="integer" xref="alg2.l5.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m4.1c">\mathcal{C}_{1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m4.1d">caligraphic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span><span class="ltx_text ltx_font_bold" id="alg2.l7.1">procedure</span>&nbsp;<span class="ltx_text ltx_font_smallcaps" id="alg2.l7.2">GetAllCandidates</span>(domain index <math alttext="i" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">italic_i</annotation></semantics></math>, proportions of first <math alttext="i-1" class="ltx_Math" display="inline" id="alg2.l7.m2.1"><semantics id="alg2.l7.m2.1a"><mrow id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml"><mi id="alg2.l7.m2.1.1.2" xref="alg2.l7.m2.1.1.2.cmml">i</mi><mo id="alg2.l7.m2.1.1.1" xref="alg2.l7.m2.1.1.1.cmml">−</mo><mn id="alg2.l7.m2.1.1.3" xref="alg2.l7.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><apply id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1"><minus id="alg2.l7.m2.1.1.1.cmml" xref="alg2.l7.m2.1.1.1"></minus><ci id="alg2.l7.m2.1.1.2.cmml" xref="alg2.l7.m2.1.1.2">𝑖</ci><cn id="alg2.l7.m2.1.1.3.cmml" type="integer" xref="alg2.l7.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">i-1</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m2.1d">italic_i - 1</annotation></semantics></math> domains <math alttext="r_{1\dots i-1}" class="ltx_Math" display="inline" id="alg2.l7.m3.1"><semantics id="alg2.l7.m3.1a"><msub id="alg2.l7.m3.1.1" xref="alg2.l7.m3.1.1.cmml"><mi id="alg2.l7.m3.1.1.2" xref="alg2.l7.m3.1.1.2.cmml">r</mi><mrow id="alg2.l7.m3.1.1.3" xref="alg2.l7.m3.1.1.3.cmml"><mrow id="alg2.l7.m3.1.1.3.2" xref="alg2.l7.m3.1.1.3.2.cmml"><mn id="alg2.l7.m3.1.1.3.2.2" xref="alg2.l7.m3.1.1.3.2.2.cmml">1</mn><mo id="alg2.l7.m3.1.1.3.2.1" xref="alg2.l7.m3.1.1.3.2.1.cmml">⁢</mo><mi id="alg2.l7.m3.1.1.3.2.3" mathvariant="normal" xref="alg2.l7.m3.1.1.3.2.3.cmml">…</mi><mo id="alg2.l7.m3.1.1.3.2.1a" xref="alg2.l7.m3.1.1.3.2.1.cmml">⁢</mo><mi id="alg2.l7.m3.1.1.3.2.4" xref="alg2.l7.m3.1.1.3.2.4.cmml">i</mi></mrow><mo id="alg2.l7.m3.1.1.3.1" xref="alg2.l7.m3.1.1.3.1.cmml">−</mo><mn id="alg2.l7.m3.1.1.3.3" xref="alg2.l7.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l7.m3.1b"><apply id="alg2.l7.m3.1.1.cmml" xref="alg2.l7.m3.1.1"><csymbol cd="ambiguous" id="alg2.l7.m3.1.1.1.cmml" xref="alg2.l7.m3.1.1">subscript</csymbol><ci id="alg2.l7.m3.1.1.2.cmml" xref="alg2.l7.m3.1.1.2">𝑟</ci><apply id="alg2.l7.m3.1.1.3.cmml" xref="alg2.l7.m3.1.1.3"><minus id="alg2.l7.m3.1.1.3.1.cmml" xref="alg2.l7.m3.1.1.3.1"></minus><apply id="alg2.l7.m3.1.1.3.2.cmml" xref="alg2.l7.m3.1.1.3.2"><times id="alg2.l7.m3.1.1.3.2.1.cmml" xref="alg2.l7.m3.1.1.3.2.1"></times><cn id="alg2.l7.m3.1.1.3.2.2.cmml" type="integer" xref="alg2.l7.m3.1.1.3.2.2">1</cn><ci id="alg2.l7.m3.1.1.3.2.3.cmml" xref="alg2.l7.m3.1.1.3.2.3">…</ci><ci id="alg2.l7.m3.1.1.3.2.4.cmml" xref="alg2.l7.m3.1.1.3.2.4">𝑖</ci></apply><cn id="alg2.l7.m3.1.1.3.3.cmml" type="integer" xref="alg2.l7.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m3.1c">r_{1\dots i-1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m3.1d">italic_r start_POSTSUBSCRIPT 1 … italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Candidate mixtures <math alttext="\mathcal{C}=\emptyset" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">𝒞</mi><mo id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">=</mo><mi id="alg2.l8.m1.1.1.3" mathvariant="normal" xref="alg2.l8.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><eq id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1"></eq><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝒞</ci><emptyset id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\mathcal{C}=\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">caligraphic_C = ∅</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l9.1">if</span>&nbsp;<math alttext="i=M" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml">i</mi><mo id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">=</mo><mi id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><eq id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1"></eq><ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">𝑖</ci><ci id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">i=M</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">italic_i = italic_M</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l9.2">then</span>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l10.1">if</span>&nbsp;<math alttext="0\leq 1-\sum_{j=1}^{i-1}r_{j}\leq r_{max,i}" class="ltx_Math" display="inline" id="alg2.l10.m1.2"><semantics id="alg2.l10.m1.2a"><mrow id="alg2.l10.m1.2.3" xref="alg2.l10.m1.2.3.cmml"><mn id="alg2.l10.m1.2.3.2" xref="alg2.l10.m1.2.3.2.cmml">0</mn><mo id="alg2.l10.m1.2.3.3" xref="alg2.l10.m1.2.3.3.cmml">≤</mo><mrow id="alg2.l10.m1.2.3.4" xref="alg2.l10.m1.2.3.4.cmml"><mn id="alg2.l10.m1.2.3.4.2" xref="alg2.l10.m1.2.3.4.2.cmml">1</mn><mo id="alg2.l10.m1.2.3.4.1" rspace="0.055em" xref="alg2.l10.m1.2.3.4.1.cmml">−</mo><mrow id="alg2.l10.m1.2.3.4.3" xref="alg2.l10.m1.2.3.4.3.cmml"><msubsup id="alg2.l10.m1.2.3.4.3.1" xref="alg2.l10.m1.2.3.4.3.1.cmml"><mo id="alg2.l10.m1.2.3.4.3.1.2.2" xref="alg2.l10.m1.2.3.4.3.1.2.2.cmml">∑</mo><mrow id="alg2.l10.m1.2.3.4.3.1.2.3" xref="alg2.l10.m1.2.3.4.3.1.2.3.cmml"><mi id="alg2.l10.m1.2.3.4.3.1.2.3.2" xref="alg2.l10.m1.2.3.4.3.1.2.3.2.cmml">j</mi><mo id="alg2.l10.m1.2.3.4.3.1.2.3.1" xref="alg2.l10.m1.2.3.4.3.1.2.3.1.cmml">=</mo><mn id="alg2.l10.m1.2.3.4.3.1.2.3.3" xref="alg2.l10.m1.2.3.4.3.1.2.3.3.cmml">1</mn></mrow><mrow id="alg2.l10.m1.2.3.4.3.1.3" xref="alg2.l10.m1.2.3.4.3.1.3.cmml"><mi id="alg2.l10.m1.2.3.4.3.1.3.2" xref="alg2.l10.m1.2.3.4.3.1.3.2.cmml">i</mi><mo id="alg2.l10.m1.2.3.4.3.1.3.1" xref="alg2.l10.m1.2.3.4.3.1.3.1.cmml">−</mo><mn id="alg2.l10.m1.2.3.4.3.1.3.3" xref="alg2.l10.m1.2.3.4.3.1.3.3.cmml">1</mn></mrow></msubsup><msub id="alg2.l10.m1.2.3.4.3.2" xref="alg2.l10.m1.2.3.4.3.2.cmml"><mi id="alg2.l10.m1.2.3.4.3.2.2" xref="alg2.l10.m1.2.3.4.3.2.2.cmml">r</mi><mi id="alg2.l10.m1.2.3.4.3.2.3" xref="alg2.l10.m1.2.3.4.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="alg2.l10.m1.2.3.5" xref="alg2.l10.m1.2.3.5.cmml">≤</mo><msub id="alg2.l10.m1.2.3.6" xref="alg2.l10.m1.2.3.6.cmml"><mi id="alg2.l10.m1.2.3.6.2" xref="alg2.l10.m1.2.3.6.2.cmml">r</mi><mrow id="alg2.l10.m1.2.2.2.2" xref="alg2.l10.m1.2.2.2.3.cmml"><mrow id="alg2.l10.m1.2.2.2.2.1" xref="alg2.l10.m1.2.2.2.2.1.cmml"><mi id="alg2.l10.m1.2.2.2.2.1.2" xref="alg2.l10.m1.2.2.2.2.1.2.cmml">m</mi><mo id="alg2.l10.m1.2.2.2.2.1.1" xref="alg2.l10.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.2.2.1.3" xref="alg2.l10.m1.2.2.2.2.1.3.cmml">a</mi><mo id="alg2.l10.m1.2.2.2.2.1.1a" xref="alg2.l10.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.2.2.1.4" xref="alg2.l10.m1.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l10.m1.2.2.2.2.2" xref="alg2.l10.m1.2.2.2.3.cmml">,</mo><mi id="alg2.l10.m1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.cmml">i</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.2b"><apply id="alg2.l10.m1.2.3.cmml" xref="alg2.l10.m1.2.3"><and id="alg2.l10.m1.2.3a.cmml" xref="alg2.l10.m1.2.3"></and><apply id="alg2.l10.m1.2.3b.cmml" xref="alg2.l10.m1.2.3"><leq id="alg2.l10.m1.2.3.3.cmml" xref="alg2.l10.m1.2.3.3"></leq><cn id="alg2.l10.m1.2.3.2.cmml" type="integer" xref="alg2.l10.m1.2.3.2">0</cn><apply id="alg2.l10.m1.2.3.4.cmml" xref="alg2.l10.m1.2.3.4"><minus id="alg2.l10.m1.2.3.4.1.cmml" xref="alg2.l10.m1.2.3.4.1"></minus><cn id="alg2.l10.m1.2.3.4.2.cmml" type="integer" xref="alg2.l10.m1.2.3.4.2">1</cn><apply id="alg2.l10.m1.2.3.4.3.cmml" xref="alg2.l10.m1.2.3.4.3"><apply id="alg2.l10.m1.2.3.4.3.1.cmml" xref="alg2.l10.m1.2.3.4.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.4.3.1.1.cmml" xref="alg2.l10.m1.2.3.4.3.1">superscript</csymbol><apply id="alg2.l10.m1.2.3.4.3.1.2.cmml" xref="alg2.l10.m1.2.3.4.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.4.3.1.2.1.cmml" xref="alg2.l10.m1.2.3.4.3.1">subscript</csymbol><sum id="alg2.l10.m1.2.3.4.3.1.2.2.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.2"></sum><apply id="alg2.l10.m1.2.3.4.3.1.2.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3"><eq id="alg2.l10.m1.2.3.4.3.1.2.3.1.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3.1"></eq><ci id="alg2.l10.m1.2.3.4.3.1.2.3.2.cmml" xref="alg2.l10.m1.2.3.4.3.1.2.3.2">𝑗</ci><cn id="alg2.l10.m1.2.3.4.3.1.2.3.3.cmml" type="integer" xref="alg2.l10.m1.2.3.4.3.1.2.3.3">1</cn></apply></apply><apply id="alg2.l10.m1.2.3.4.3.1.3.cmml" xref="alg2.l10.m1.2.3.4.3.1.3"><minus id="alg2.l10.m1.2.3.4.3.1.3.1.cmml" xref="alg2.l10.m1.2.3.4.3.1.3.1"></minus><ci id="alg2.l10.m1.2.3.4.3.1.3.2.cmml" xref="alg2.l10.m1.2.3.4.3.1.3.2">𝑖</ci><cn id="alg2.l10.m1.2.3.4.3.1.3.3.cmml" type="integer" xref="alg2.l10.m1.2.3.4.3.1.3.3">1</cn></apply></apply><apply id="alg2.l10.m1.2.3.4.3.2.cmml" xref="alg2.l10.m1.2.3.4.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.4.3.2.1.cmml" xref="alg2.l10.m1.2.3.4.3.2">subscript</csymbol><ci id="alg2.l10.m1.2.3.4.3.2.2.cmml" xref="alg2.l10.m1.2.3.4.3.2.2">𝑟</ci><ci id="alg2.l10.m1.2.3.4.3.2.3.cmml" xref="alg2.l10.m1.2.3.4.3.2.3">𝑗</ci></apply></apply></apply></apply><apply id="alg2.l10.m1.2.3c.cmml" xref="alg2.l10.m1.2.3"><leq id="alg2.l10.m1.2.3.5.cmml" xref="alg2.l10.m1.2.3.5"></leq><share href="#alg2.l10.m1.2.3.4.cmml" id="alg2.l10.m1.2.3d.cmml" xref="alg2.l10.m1.2.3"></share><apply id="alg2.l10.m1.2.3.6.cmml" xref="alg2.l10.m1.2.3.6"><csymbol cd="ambiguous" id="alg2.l10.m1.2.3.6.1.cmml" xref="alg2.l10.m1.2.3.6">subscript</csymbol><ci id="alg2.l10.m1.2.3.6.2.cmml" xref="alg2.l10.m1.2.3.6.2">𝑟</ci><list id="alg2.l10.m1.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.2"><apply id="alg2.l10.m1.2.2.2.2.1.cmml" xref="alg2.l10.m1.2.2.2.2.1"><times id="alg2.l10.m1.2.2.2.2.1.1.cmml" xref="alg2.l10.m1.2.2.2.2.1.1"></times><ci id="alg2.l10.m1.2.2.2.2.1.2.cmml" xref="alg2.l10.m1.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l10.m1.2.2.2.2.1.3.cmml" xref="alg2.l10.m1.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l10.m1.2.2.2.2.1.4.cmml" xref="alg2.l10.m1.2.2.2.2.1.4">𝑥</ci></apply><ci id="alg2.l10.m1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1">𝑖</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.2c">0\leq 1-\sum_{j=1}^{i-1}r_{j}\leq r_{max,i}</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.2d">0 ≤ 1 - ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i - 1 end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ≤ italic_r start_POSTSUBSCRIPT italic_m italic_a italic_x , italic_i end_POSTSUBSCRIPT</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l10.2">then</span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="r_{1\dots i}\leftarrow[r_{1\dots i-1},1-\sum_{j=1}^{i-1}r_{j}]" class="ltx_Math" display="inline" id="alg2.l11.m1.2"><semantics id="alg2.l11.m1.2a"><mrow id="alg2.l11.m1.2.2" xref="alg2.l11.m1.2.2.cmml"><msub id="alg2.l11.m1.2.2.4" xref="alg2.l11.m1.2.2.4.cmml"><mi id="alg2.l11.m1.2.2.4.2" xref="alg2.l11.m1.2.2.4.2.cmml">r</mi><mrow id="alg2.l11.m1.2.2.4.3" xref="alg2.l11.m1.2.2.4.3.cmml"><mn id="alg2.l11.m1.2.2.4.3.2" xref="alg2.l11.m1.2.2.4.3.2.cmml">1</mn><mo id="alg2.l11.m1.2.2.4.3.1" xref="alg2.l11.m1.2.2.4.3.1.cmml">⁢</mo><mi id="alg2.l11.m1.2.2.4.3.3" mathvariant="normal" xref="alg2.l11.m1.2.2.4.3.3.cmml">…</mi><mo id="alg2.l11.m1.2.2.4.3.1a" xref="alg2.l11.m1.2.2.4.3.1.cmml">⁢</mo><mi id="alg2.l11.m1.2.2.4.3.4" xref="alg2.l11.m1.2.2.4.3.4.cmml">i</mi></mrow></msub><mo id="alg2.l11.m1.2.2.3" stretchy="false" xref="alg2.l11.m1.2.2.3.cmml">←</mo><mrow id="alg2.l11.m1.2.2.2.2" xref="alg2.l11.m1.2.2.2.3.cmml"><mo id="alg2.l11.m1.2.2.2.2.3" stretchy="false" xref="alg2.l11.m1.2.2.2.3.cmml">[</mo><msub id="alg2.l11.m1.1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.1.cmml"><mi id="alg2.l11.m1.1.1.1.1.1.2" xref="alg2.l11.m1.1.1.1.1.1.2.cmml">r</mi><mrow id="alg2.l11.m1.1.1.1.1.1.3" xref="alg2.l11.m1.1.1.1.1.1.3.cmml"><mrow id="alg2.l11.m1.1.1.1.1.1.3.2" xref="alg2.l11.m1.1.1.1.1.1.3.2.cmml"><mn id="alg2.l11.m1.1.1.1.1.1.3.2.2" xref="alg2.l11.m1.1.1.1.1.1.3.2.2.cmml">1</mn><mo id="alg2.l11.m1.1.1.1.1.1.3.2.1" xref="alg2.l11.m1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.1.3.2.3" mathvariant="normal" xref="alg2.l11.m1.1.1.1.1.1.3.2.3.cmml">…</mi><mo id="alg2.l11.m1.1.1.1.1.1.3.2.1a" xref="alg2.l11.m1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.1.3.2.4" xref="alg2.l11.m1.1.1.1.1.1.3.2.4.cmml">i</mi></mrow><mo id="alg2.l11.m1.1.1.1.1.1.3.1" xref="alg2.l11.m1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg2.l11.m1.1.1.1.1.1.3.3" xref="alg2.l11.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg2.l11.m1.2.2.2.2.4" xref="alg2.l11.m1.2.2.2.3.cmml">,</mo><mrow id="alg2.l11.m1.2.2.2.2.2" xref="alg2.l11.m1.2.2.2.2.2.cmml"><mn id="alg2.l11.m1.2.2.2.2.2.2" xref="alg2.l11.m1.2.2.2.2.2.2.cmml">1</mn><mo id="alg2.l11.m1.2.2.2.2.2.1" rspace="0.055em" xref="alg2.l11.m1.2.2.2.2.2.1.cmml">−</mo><mrow id="alg2.l11.m1.2.2.2.2.2.3" xref="alg2.l11.m1.2.2.2.2.2.3.cmml"><msubsup id="alg2.l11.m1.2.2.2.2.2.3.1" xref="alg2.l11.m1.2.2.2.2.2.3.1.cmml"><mo id="alg2.l11.m1.2.2.2.2.2.3.1.2.2" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="alg2.l11.m1.2.2.2.2.2.3.1.2.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.cmml"><mi id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2.cmml">j</mi><mo id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3.cmml">1</mn></mrow><mrow id="alg2.l11.m1.2.2.2.2.2.3.1.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.cmml"><mi id="alg2.l11.m1.2.2.2.2.2.3.1.3.2" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.2.cmml">i</mi><mo id="alg2.l11.m1.2.2.2.2.2.3.1.3.1" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.1.cmml">−</mo><mn id="alg2.l11.m1.2.2.2.2.2.3.1.3.3" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.3.cmml">1</mn></mrow></msubsup><msub id="alg2.l11.m1.2.2.2.2.2.3.2" xref="alg2.l11.m1.2.2.2.2.2.3.2.cmml"><mi id="alg2.l11.m1.2.2.2.2.2.3.2.2" xref="alg2.l11.m1.2.2.2.2.2.3.2.2.cmml">r</mi><mi id="alg2.l11.m1.2.2.2.2.2.3.2.3" xref="alg2.l11.m1.2.2.2.2.2.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="alg2.l11.m1.2.2.2.2.5" stretchy="false" xref="alg2.l11.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.2b"><apply id="alg2.l11.m1.2.2.cmml" xref="alg2.l11.m1.2.2"><ci id="alg2.l11.m1.2.2.3.cmml" xref="alg2.l11.m1.2.2.3">←</ci><apply id="alg2.l11.m1.2.2.4.cmml" xref="alg2.l11.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.4.1.cmml" xref="alg2.l11.m1.2.2.4">subscript</csymbol><ci id="alg2.l11.m1.2.2.4.2.cmml" xref="alg2.l11.m1.2.2.4.2">𝑟</ci><apply id="alg2.l11.m1.2.2.4.3.cmml" xref="alg2.l11.m1.2.2.4.3"><times id="alg2.l11.m1.2.2.4.3.1.cmml" xref="alg2.l11.m1.2.2.4.3.1"></times><cn id="alg2.l11.m1.2.2.4.3.2.cmml" type="integer" xref="alg2.l11.m1.2.2.4.3.2">1</cn><ci id="alg2.l11.m1.2.2.4.3.3.cmml" xref="alg2.l11.m1.2.2.4.3.3">…</ci><ci id="alg2.l11.m1.2.2.4.3.4.cmml" xref="alg2.l11.m1.2.2.4.3.4">𝑖</ci></apply></apply><interval closure="closed" id="alg2.l11.m1.2.2.2.3.cmml" xref="alg2.l11.m1.2.2.2.2"><apply id="alg2.l11.m1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l11.m1.1.1.1.1.1.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.2">𝑟</ci><apply id="alg2.l11.m1.1.1.1.1.1.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.3"><minus id="alg2.l11.m1.1.1.1.1.1.3.1.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.1"></minus><apply id="alg2.l11.m1.1.1.1.1.1.3.2.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2"><times id="alg2.l11.m1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.1"></times><cn id="alg2.l11.m1.1.1.1.1.1.3.2.2.cmml" type="integer" xref="alg2.l11.m1.1.1.1.1.1.3.2.2">1</cn><ci id="alg2.l11.m1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.3">…</ci><ci id="alg2.l11.m1.1.1.1.1.1.3.2.4.cmml" xref="alg2.l11.m1.1.1.1.1.1.3.2.4">𝑖</ci></apply><cn id="alg2.l11.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg2.l11.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.l11.m1.2.2.2.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2"><minus id="alg2.l11.m1.2.2.2.2.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.1"></minus><cn id="alg2.l11.m1.2.2.2.2.2.2.cmml" type="integer" xref="alg2.l11.m1.2.2.2.2.2.2">1</cn><apply id="alg2.l11.m1.2.2.2.2.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3"><apply id="alg2.l11.m1.2.2.2.2.2.3.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.2.2.2.3.1.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1">superscript</csymbol><apply id="alg2.l11.m1.2.2.2.2.2.3.1.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.2.2.2.3.1.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1">subscript</csymbol><sum id="alg2.l11.m1.2.2.2.2.2.3.1.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.2"></sum><apply id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3"><eq id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.1"></eq><ci id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.2">𝑗</ci><cn id="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3.cmml" type="integer" xref="alg2.l11.m1.2.2.2.2.2.3.1.2.3.3">1</cn></apply></apply><apply id="alg2.l11.m1.2.2.2.2.2.3.1.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3"><minus id="alg2.l11.m1.2.2.2.2.2.3.1.3.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.1"></minus><ci id="alg2.l11.m1.2.2.2.2.2.3.1.3.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.2">𝑖</ci><cn id="alg2.l11.m1.2.2.2.2.2.3.1.3.3.cmml" type="integer" xref="alg2.l11.m1.2.2.2.2.2.3.1.3.3">1</cn></apply></apply><apply id="alg2.l11.m1.2.2.2.2.2.3.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.2.2.2.3.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2">subscript</csymbol><ci id="alg2.l11.m1.2.2.2.2.2.3.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2.2">𝑟</ci><ci id="alg2.l11.m1.2.2.2.2.2.3.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.2.3.2.3">𝑗</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.2c">r_{1\dots i}\leftarrow[r_{1\dots i-1},1-\sum_{j=1}^{i-1}r_{j}]</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.2d">italic_r start_POSTSUBSCRIPT 1 … italic_i end_POSTSUBSCRIPT ← [ italic_r start_POSTSUBSCRIPT 1 … italic_i - 1 end_POSTSUBSCRIPT , 1 - ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i - 1 end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\mathcal{C}\leftarrow\mathcal{C}\bigcup\left\{r_{1\dots i}\right\}" class="ltx_Math" display="inline" id="alg2.l12.m1.1"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">𝒞</mi><mo id="alg2.l12.m1.1.1.2" stretchy="false" xref="alg2.l12.m1.1.1.2.cmml">←</mo><mrow id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l12.m1.1.1.1.3" xref="alg2.l12.m1.1.1.1.3.cmml">𝒞</mi><mo id="alg2.l12.m1.1.1.1.2" xref="alg2.l12.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l12.m1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.cmml"><mo id="alg2.l12.m1.1.1.1.1.2" rspace="0em" xref="alg2.l12.m1.1.1.1.1.2.cmml">⋃</mo><mrow id="alg2.l12.m1.1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.2.cmml"><mo id="alg2.l12.m1.1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.2.cmml">{</mo><msub id="alg2.l12.m1.1.1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l12.m1.1.1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.1.1.2.cmml">r</mi><mrow id="alg2.l12.m1.1.1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.cmml"><mn id="alg2.l12.m1.1.1.1.1.1.1.1.3.2" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="alg2.l12.m1.1.1.1.1.1.1.1.3.1" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg2.l12.m1.1.1.1.1.1.1.1.3.3" mathvariant="normal" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.3.cmml">…</mi><mo id="alg2.l12.m1.1.1.1.1.1.1.1.3.1a" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg2.l12.m1.1.1.1.1.1.1.1.3.4" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.4.cmml">i</mi></mrow></msub><mo id="alg2.l12.m1.1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><ci id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">←</ci><ci id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">𝒞</ci><apply id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1"><times id="alg2.l12.m1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.2"></times><ci id="alg2.l12.m1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.3">𝒞</ci><apply id="alg2.l12.m1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1"><union id="alg2.l12.m1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.2"></union><set id="alg2.l12.m1.1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1"><apply id="alg2.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l12.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.2">𝑟</ci><apply id="alg2.l12.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3"><times id="alg2.l12.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.1"></times><cn id="alg2.l12.m1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.2">1</cn><ci id="alg2.l12.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.3">…</ci><ci id="alg2.l12.m1.1.1.1.1.1.1.1.3.4.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1.3.4">𝑖</ci></apply></apply></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">\mathcal{C}\leftarrow\mathcal{C}\bigcup\left\{r_{1\dots i}\right\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m1.1d">caligraphic_C ← caligraphic_C ⋃ { italic_r start_POSTSUBSCRIPT 1 … italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l13.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l13.2">if</span>
</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l14.1">else</span>
</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\Gamma\leftarrow\delta*\lfloor\frac{r_{max,i}}{\delta}\rfloor" class="ltx_Math" display="inline" id="alg2.l15.m1.2"><semantics id="alg2.l15.m1.2a"><mrow id="alg2.l15.m1.2.3" xref="alg2.l15.m1.2.3.cmml"><mi id="alg2.l15.m1.2.3.2" mathvariant="normal" xref="alg2.l15.m1.2.3.2.cmml">Γ</mi><mo id="alg2.l15.m1.2.3.1" stretchy="false" xref="alg2.l15.m1.2.3.1.cmml">←</mo><mrow id="alg2.l15.m1.2.3.3" xref="alg2.l15.m1.2.3.3.cmml"><mi id="alg2.l15.m1.2.3.3.2" xref="alg2.l15.m1.2.3.3.2.cmml">δ</mi><mo id="alg2.l15.m1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.l15.m1.2.3.3.1.cmml">*</mo><mrow id="alg2.l15.m1.2.3.3.3.2" xref="alg2.l15.m1.2.3.3.3.1.cmml"><mo id="alg2.l15.m1.2.3.3.3.2.1" stretchy="false" xref="alg2.l15.m1.2.3.3.3.1.1.cmml">⌊</mo><mfrac id="alg2.l15.m1.2.2" xref="alg2.l15.m1.2.2.cmml"><msub id="alg2.l15.m1.2.2.2" xref="alg2.l15.m1.2.2.2.cmml"><mi id="alg2.l15.m1.2.2.2.4" xref="alg2.l15.m1.2.2.2.4.cmml">r</mi><mrow id="alg2.l15.m1.2.2.2.2.2.2" xref="alg2.l15.m1.2.2.2.2.2.3.cmml"><mrow id="alg2.l15.m1.2.2.2.2.2.2.1" xref="alg2.l15.m1.2.2.2.2.2.2.1.cmml"><mi id="alg2.l15.m1.2.2.2.2.2.2.1.2" xref="alg2.l15.m1.2.2.2.2.2.2.1.2.cmml">m</mi><mo id="alg2.l15.m1.2.2.2.2.2.2.1.1" xref="alg2.l15.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l15.m1.2.2.2.2.2.2.1.3" xref="alg2.l15.m1.2.2.2.2.2.2.1.3.cmml">a</mi><mo id="alg2.l15.m1.2.2.2.2.2.2.1.1a" xref="alg2.l15.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="alg2.l15.m1.2.2.2.2.2.2.1.4" xref="alg2.l15.m1.2.2.2.2.2.2.1.4.cmml">x</mi></mrow><mo id="alg2.l15.m1.2.2.2.2.2.2.2" xref="alg2.l15.m1.2.2.2.2.2.3.cmml">,</mo><mi id="alg2.l15.m1.1.1.1.1.1.1" xref="alg2.l15.m1.1.1.1.1.1.1.cmml">i</mi></mrow></msub><mi id="alg2.l15.m1.2.2.4" xref="alg2.l15.m1.2.2.4.cmml">δ</mi></mfrac><mo id="alg2.l15.m1.2.3.3.3.2.2" stretchy="false" xref="alg2.l15.m1.2.3.3.3.1.1.cmml">⌋</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.2b"><apply id="alg2.l15.m1.2.3.cmml" xref="alg2.l15.m1.2.3"><ci id="alg2.l15.m1.2.3.1.cmml" xref="alg2.l15.m1.2.3.1">←</ci><ci id="alg2.l15.m1.2.3.2.cmml" xref="alg2.l15.m1.2.3.2">Γ</ci><apply id="alg2.l15.m1.2.3.3.cmml" xref="alg2.l15.m1.2.3.3"><times id="alg2.l15.m1.2.3.3.1.cmml" xref="alg2.l15.m1.2.3.3.1"></times><ci id="alg2.l15.m1.2.3.3.2.cmml" xref="alg2.l15.m1.2.3.3.2">𝛿</ci><apply id="alg2.l15.m1.2.3.3.3.1.cmml" xref="alg2.l15.m1.2.3.3.3.2"><floor id="alg2.l15.m1.2.3.3.3.1.1.cmml" xref="alg2.l15.m1.2.3.3.3.2.1"></floor><apply id="alg2.l15.m1.2.2.cmml" xref="alg2.l15.m1.2.2"><divide id="alg2.l15.m1.2.2.3.cmml" xref="alg2.l15.m1.2.2"></divide><apply id="alg2.l15.m1.2.2.2.cmml" xref="alg2.l15.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l15.m1.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2">subscript</csymbol><ci id="alg2.l15.m1.2.2.2.4.cmml" xref="alg2.l15.m1.2.2.2.4">𝑟</ci><list id="alg2.l15.m1.2.2.2.2.2.3.cmml" xref="alg2.l15.m1.2.2.2.2.2.2"><apply id="alg2.l15.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1"><times id="alg2.l15.m1.2.2.2.2.2.2.1.1.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.1"></times><ci id="alg2.l15.m1.2.2.2.2.2.2.1.2.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.2">𝑚</ci><ci id="alg2.l15.m1.2.2.2.2.2.2.1.3.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.3">𝑎</ci><ci id="alg2.l15.m1.2.2.2.2.2.2.1.4.cmml" xref="alg2.l15.m1.2.2.2.2.2.2.1.4">𝑥</ci></apply><ci id="alg2.l15.m1.1.1.1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1.1.1.1">𝑖</ci></list></apply><ci id="alg2.l15.m1.2.2.4.cmml" xref="alg2.l15.m1.2.2.4">𝛿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.2c">\Gamma\leftarrow\delta*\lfloor\frac{r_{max,i}}{\delta}\rfloor</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.2d">roman_Γ ← italic_δ * ⌊ divide start_ARG italic_r start_POSTSUBSCRIPT italic_m italic_a italic_x , italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_δ end_ARG ⌋</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l16.1">for</span>&nbsp;<math alttext="s=0\mbox{~{}~{}{To}~{}~{}}\lceil{\log_{2}{\frac{\Gamma}{\delta}}}\rceil" class="ltx_Math" display="inline" id="alg2.l16.m1.1"><semantics id="alg2.l16.m1.1a"><mrow id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><mi id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml">s</mi><mo id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml">=</mo><mrow id="alg2.l16.m1.1.1.1" xref="alg2.l16.m1.1.1.1.cmml"><mn id="alg2.l16.m1.1.1.1.3" xref="alg2.l16.m1.1.1.1.3.cmml">0</mn><mo id="alg2.l16.m1.1.1.1.2" xref="alg2.l16.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l16.m1.1.1.1.4" xref="alg2.l16.m1.1.1.1.4d.cmml"><mtext id="alg2.l16.m1.1.1.1.4a" xref="alg2.l16.m1.1.1.1.4d.cmml">&nbsp;</mtext><mtext id="alg2.l16.m1.1.1.1.4b" xref="alg2.l16.m1.1.1.1.4d.cmml">𝐓𝐨</mtext><mtext id="alg2.l16.m1.1.1.1.4c" xref="alg2.l16.m1.1.1.1.4d.cmml">&nbsp;</mtext></mrow><mo id="alg2.l16.m1.1.1.1.2a" xref="alg2.l16.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l16.m1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.2.cmml"><mo id="alg2.l16.m1.1.1.1.1.1.2" stretchy="false" xref="alg2.l16.m1.1.1.1.1.2.1.cmml">⌈</mo><mrow id="alg2.l16.m1.1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.1.cmml"><msub id="alg2.l16.m1.1.1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l16.m1.1.1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.1.1.2.cmml">log</mi><mn id="alg2.l16.m1.1.1.1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="alg2.l16.m1.1.1.1.1.1.1a" lspace="0.167em" xref="alg2.l16.m1.1.1.1.1.1.1.cmml">⁡</mo><mfrac id="alg2.l16.m1.1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l16.m1.1.1.1.1.1.1.2.2" mathvariant="normal" xref="alg2.l16.m1.1.1.1.1.1.1.2.2.cmml">Γ</mi><mi id="alg2.l16.m1.1.1.1.1.1.1.2.3" xref="alg2.l16.m1.1.1.1.1.1.1.2.3.cmml">δ</mi></mfrac></mrow><mo id="alg2.l16.m1.1.1.1.1.1.3" stretchy="false" xref="alg2.l16.m1.1.1.1.1.2.1.cmml">⌉</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><eq id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2"></eq><ci id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3">𝑠</ci><apply id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1"><times id="alg2.l16.m1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.2"></times><cn id="alg2.l16.m1.1.1.1.3.cmml" type="integer" xref="alg2.l16.m1.1.1.1.3">0</cn><ci id="alg2.l16.m1.1.1.1.4d.cmml" xref="alg2.l16.m1.1.1.1.4"><mrow id="alg2.l16.m1.1.1.1.4.cmml" xref="alg2.l16.m1.1.1.1.4"><mtext id="alg2.l16.m1.1.1.1.4a.cmml" xref="alg2.l16.m1.1.1.1.4">&nbsp;</mtext><mtext id="alg2.l16.m1.1.1.1.4b.cmml" xref="alg2.l16.m1.1.1.1.4">𝐓𝐨</mtext><mtext id="alg2.l16.m1.1.1.1.4c.cmml" xref="alg2.l16.m1.1.1.1.4">&nbsp;</mtext></mrow></ci><apply id="alg2.l16.m1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1"><ceiling id="alg2.l16.m1.1.1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.2"></ceiling><apply id="alg2.l16.m1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1"><apply id="alg2.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1">subscript</csymbol><log id="alg2.l16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1.2"></log><cn id="alg2.l16.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l16.m1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="alg2.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2"><divide id="alg2.l16.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2"></divide><ci id="alg2.l16.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2.2">Γ</ci><ci id="alg2.l16.m1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.2.3">𝛿</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">s=0\mbox{~{}~{}{To}~{}~{}}\lceil{\log_{2}{\frac{\Gamma}{\delta}}}\rceil</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.m1.1d">italic_s = 0 bold_To ⌈ roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT divide start_ARG roman_Γ end_ARG start_ARG italic_δ end_ARG ⌉</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l16.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="r_{i}\leftarrow\max(0,\frac{\Gamma}{2^{s}})" class="ltx_Math" display="inline" id="alg2.l17.m1.3"><semantics id="alg2.l17.m1.3a"><mrow id="alg2.l17.m1.3.4" xref="alg2.l17.m1.3.4.cmml"><msub id="alg2.l17.m1.3.4.2" xref="alg2.l17.m1.3.4.2.cmml"><mi id="alg2.l17.m1.3.4.2.2" xref="alg2.l17.m1.3.4.2.2.cmml">r</mi><mi id="alg2.l17.m1.3.4.2.3" xref="alg2.l17.m1.3.4.2.3.cmml">i</mi></msub><mo id="alg2.l17.m1.3.4.1" stretchy="false" xref="alg2.l17.m1.3.4.1.cmml">←</mo><mrow id="alg2.l17.m1.3.4.3.2" xref="alg2.l17.m1.3.4.3.1.cmml"><mi id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml">max</mi><mo id="alg2.l17.m1.3.4.3.2a" xref="alg2.l17.m1.3.4.3.1.cmml">⁡</mo><mrow id="alg2.l17.m1.3.4.3.2.1" xref="alg2.l17.m1.3.4.3.1.cmml"><mo id="alg2.l17.m1.3.4.3.2.1.1" stretchy="false" xref="alg2.l17.m1.3.4.3.1.cmml">(</mo><mn id="alg2.l17.m1.2.2" xref="alg2.l17.m1.2.2.cmml">0</mn><mo id="alg2.l17.m1.3.4.3.2.1.2" xref="alg2.l17.m1.3.4.3.1.cmml">,</mo><mfrac id="alg2.l17.m1.3.3" xref="alg2.l17.m1.3.3.cmml"><mi id="alg2.l17.m1.3.3.2" mathvariant="normal" xref="alg2.l17.m1.3.3.2.cmml">Γ</mi><msup id="alg2.l17.m1.3.3.3" xref="alg2.l17.m1.3.3.3.cmml"><mn id="alg2.l17.m1.3.3.3.2" xref="alg2.l17.m1.3.3.3.2.cmml">2</mn><mi id="alg2.l17.m1.3.3.3.3" xref="alg2.l17.m1.3.3.3.3.cmml">s</mi></msup></mfrac><mo id="alg2.l17.m1.3.4.3.2.1.3" stretchy="false" xref="alg2.l17.m1.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.3b"><apply id="alg2.l17.m1.3.4.cmml" xref="alg2.l17.m1.3.4"><ci id="alg2.l17.m1.3.4.1.cmml" xref="alg2.l17.m1.3.4.1">←</ci><apply id="alg2.l17.m1.3.4.2.cmml" xref="alg2.l17.m1.3.4.2"><csymbol cd="ambiguous" id="alg2.l17.m1.3.4.2.1.cmml" xref="alg2.l17.m1.3.4.2">subscript</csymbol><ci id="alg2.l17.m1.3.4.2.2.cmml" xref="alg2.l17.m1.3.4.2.2">𝑟</ci><ci id="alg2.l17.m1.3.4.2.3.cmml" xref="alg2.l17.m1.3.4.2.3">𝑖</ci></apply><apply id="alg2.l17.m1.3.4.3.1.cmml" xref="alg2.l17.m1.3.4.3.2"><max id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"></max><cn id="alg2.l17.m1.2.2.cmml" type="integer" xref="alg2.l17.m1.2.2">0</cn><apply id="alg2.l17.m1.3.3.cmml" xref="alg2.l17.m1.3.3"><divide id="alg2.l17.m1.3.3.1.cmml" xref="alg2.l17.m1.3.3"></divide><ci id="alg2.l17.m1.3.3.2.cmml" xref="alg2.l17.m1.3.3.2">Γ</ci><apply id="alg2.l17.m1.3.3.3.cmml" xref="alg2.l17.m1.3.3.3"><csymbol cd="ambiguous" id="alg2.l17.m1.3.3.3.1.cmml" xref="alg2.l17.m1.3.3.3">superscript</csymbol><cn id="alg2.l17.m1.3.3.3.2.cmml" type="integer" xref="alg2.l17.m1.3.3.3.2">2</cn><ci id="alg2.l17.m1.3.3.3.3.cmml" xref="alg2.l17.m1.3.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.3c">r_{i}\leftarrow\max(0,\frac{\Gamma}{2^{s}})</annotation><annotation encoding="application/x-llamapun" id="alg2.l17.m1.3d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← roman_max ( 0 , divide start_ARG roman_Γ end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="\mathcal{C}\leftarrow\mathcal{C}\bigcup\textsc{GetAllCandidates}(i+1,[r_{1%
\dots i}])" class="ltx_Math" display="inline" id="alg2.l18.m1.2"><semantics id="alg2.l18.m1.2a"><mrow id="alg2.l18.m1.2.2" xref="alg2.l18.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l18.m1.2.2.4" xref="alg2.l18.m1.2.2.4.cmml">𝒞</mi><mo id="alg2.l18.m1.2.2.3" stretchy="false" xref="alg2.l18.m1.2.2.3.cmml">←</mo><mrow id="alg2.l18.m1.2.2.2" xref="alg2.l18.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l18.m1.2.2.2.4" xref="alg2.l18.m1.2.2.2.4.cmml">𝒞</mi><mo id="alg2.l18.m1.2.2.2.3" xref="alg2.l18.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg2.l18.m1.2.2.2.2" xref="alg2.l18.m1.2.2.2.2.cmml"><mo id="alg2.l18.m1.2.2.2.2.3" xref="alg2.l18.m1.2.2.2.2.3.cmml">⋃</mo><mrow id="alg2.l18.m1.2.2.2.2.2" xref="alg2.l18.m1.2.2.2.2.2.cmml"><mtext class="ltx_font_smallcaps" id="alg2.l18.m1.2.2.2.2.2.4" mathvariant="normal" xref="alg2.l18.m1.2.2.2.2.2.4a.cmml">GetAllCandidates</mtext><mo id="alg2.l18.m1.2.2.2.2.2.3" xref="alg2.l18.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="alg2.l18.m1.2.2.2.2.2.2.2" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml"><mo id="alg2.l18.m1.2.2.2.2.2.2.2.3" stretchy="false" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml">(</mo><mrow id="alg2.l18.m1.1.1.1.1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l18.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg2.l18.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="alg2.l18.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg2.l18.m1.2.2.2.2.2.2.2.4" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml">,</mo><mrow id="alg2.l18.m1.2.2.2.2.2.2.2.2.1" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.2.cmml"><mo id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.2" stretchy="false" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.2.1.cmml">[</mo><msub id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.cmml"><mi id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2.cmml">r</mi><mrow id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.cmml"><mn id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2.cmml">1</mn><mo id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3" mathvariant="normal" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3.cmml">…</mi><mo id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1a" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4.cmml">i</mi></mrow></msub><mo id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.3" stretchy="false" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.2.1.cmml">]</mo></mrow><mo id="alg2.l18.m1.2.2.2.2.2.2.2.5" stretchy="false" xref="alg2.l18.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.2b"><apply id="alg2.l18.m1.2.2.cmml" xref="alg2.l18.m1.2.2"><ci id="alg2.l18.m1.2.2.3.cmml" xref="alg2.l18.m1.2.2.3">←</ci><ci id="alg2.l18.m1.2.2.4.cmml" xref="alg2.l18.m1.2.2.4">𝒞</ci><apply id="alg2.l18.m1.2.2.2.cmml" xref="alg2.l18.m1.2.2.2"><times id="alg2.l18.m1.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.3"></times><ci id="alg2.l18.m1.2.2.2.4.cmml" xref="alg2.l18.m1.2.2.2.4">𝒞</ci><apply id="alg2.l18.m1.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.2"><union id="alg2.l18.m1.2.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.2.3"></union><apply id="alg2.l18.m1.2.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.2.2"><times id="alg2.l18.m1.2.2.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.3"></times><ci id="alg2.l18.m1.2.2.2.2.2.4a.cmml" xref="alg2.l18.m1.2.2.2.2.2.4"><mtext class="ltx_font_smallcaps" id="alg2.l18.m1.2.2.2.2.2.4.cmml" mathvariant="normal" xref="alg2.l18.m1.2.2.2.2.2.4">GetAllCandidates</mtext></ci><interval closure="open" id="alg2.l18.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2"><apply id="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1"><plus id="alg2.l18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2">𝑖</ci><cn id="alg2.l18.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="alg2.l18.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1"><csymbol cd="latexml" id="alg2.l18.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.2">𝑟</ci><apply id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3"><times id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.1"></times><cn id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2.cmml" type="integer" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.2">1</cn><ci id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.3">…</ci><ci id="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4.cmml" xref="alg2.l18.m1.2.2.2.2.2.2.2.2.1.1.3.4">𝑖</ci></apply></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.2c">\mathcal{C}\leftarrow\mathcal{C}\bigcup\textsc{GetAllCandidates}(i+1,[r_{1%
\dots i}])</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.m1.2d">caligraphic_C ← caligraphic_C ⋃ GetAllCandidates ( italic_i + 1 , [ italic_r start_POSTSUBSCRIPT 1 … italic_i end_POSTSUBSCRIPT ] )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l19.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l19.2">for</span>
</div>
<div class="ltx_listingline" id="alg2.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l20.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l20.2">if</span>
</div>
<div class="ltx_listingline" id="alg2.l21">
<span class="ltx_tag ltx_tag_listingline">21:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l21.1">return</span> <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg2.l21.m1.1"><semantics id="alg2.l21.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l21.m1.1.1" xref="alg2.l21.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.1b"><ci id="alg2.l21.m1.1.1.cmml" xref="alg2.l21.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg2.l21.m1.1d">caligraphic_C</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l22">
<span class="ltx_tag ltx_tag_listingline">22:</span><span class="ltx_text ltx_font_bold" id="alg2.l22.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg2.l22.2">procedure</span>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Connections between Implicit Domain Aggregation and MLP</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.7">We first repeat our final mixture law (Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E8" title="8 ‣ Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a>) here for convenience:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}%
\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right]," class="ltx_Math" display="block" id="A3.Ex2.m1.2"><semantics id="A3.Ex2.m1.2a"><mrow id="A3.Ex2.m1.2.2.1" xref="A3.Ex2.m1.2.2.1.1.cmml"><mrow id="A3.Ex2.m1.2.2.1.1" xref="A3.Ex2.m1.2.2.1.1.cmml"><mrow id="A3.Ex2.m1.2.2.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.3.cmml">L</mi><mo id="A3.Ex2.m1.2.2.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex2.m1.2.2.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml">r</mi><mrow id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3" mathvariant="normal" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3.cmml">…</mi><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1a" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo id="A3.Ex2.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.5" rspace="0.111em" xref="A3.Ex2.m1.2.2.1.1.5.cmml">=</mo><mrow id="A3.Ex2.m1.2.2.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.2.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.2.2.2.2" movablelimits="false" xref="A3.Ex2.m1.2.2.1.1.2.2.2.2.cmml">∑</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.2.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.2.cmml">i</mi><mo id="A3.Ex2.m1.2.2.1.1.2.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.2.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.2.2.3.cmml">K</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.2.1" xref="A3.Ex2.m1.2.2.1.1.2.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.2.1.3" xref="A3.Ex2.m1.2.2.1.1.2.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.1.3.2" xref="A3.Ex2.m1.2.2.1.1.2.1.3.2.cmml">s</mi><mi id="A3.Ex2.m1.2.2.1.1.2.1.3.3" xref="A3.Ex2.m1.2.2.1.1.2.1.3.3.cmml">i</mi></msub><mo id="A3.Ex2.m1.2.2.1.1.2.1.2" xref="A3.Ex2.m1.2.2.1.1.2.1.2.cmml">⁢</mo><msub id="A3.Ex2.m1.2.2.1.1.2.1.4" xref="A3.Ex2.m1.2.2.1.1.2.1.4.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.1.4.2" xref="A3.Ex2.m1.2.2.1.1.2.1.4.2.cmml">L</mi><mi id="A3.Ex2.m1.2.2.1.1.2.1.4.3" xref="A3.Ex2.m1.2.2.1.1.2.1.4.3.cmml">i</mi></msub><mo id="A3.Ex2.m1.2.2.1.1.2.1.2a" xref="A3.Ex2.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.1.1.2.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml"><mo id="A3.Ex2.m1.2.2.1.1.2.1.1.1.2" stretchy="false" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2.cmml">r</mi><mrow id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mn id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">1</mn><mo id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3" mathvariant="normal" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">…</mi><mo id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1a" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">M</mi></mrow></msub><mo id="A3.Ex2.m1.2.2.1.1.2.1.1.1.3" stretchy="false" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.6" rspace="0.111em" xref="A3.Ex2.m1.2.2.1.1.6.cmml">=</mo><mrow id="A3.Ex2.m1.2.2.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.3.2.2.2" movablelimits="false" xref="A3.Ex2.m1.2.2.1.1.3.2.2.2.cmml">∑</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.2.2.3" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.2.cmml">i</mi><mo id="A3.Ex2.m1.2.2.1.1.3.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.3.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.3.2.3" xref="A3.Ex2.m1.2.2.1.1.3.2.3.cmml">K</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.3.1" xref="A3.Ex2.m1.2.2.1.1.3.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.3.2.cmml">s</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.3.3.cmml">i</mi></msub><mo id="A3.Ex2.m1.2.2.1.1.3.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.2.1.cmml">[</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2.cmml">c</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2.cmml">+</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml">k</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2" lspace="0.167em" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mi id="A3.Ex2.m1.1.1" xref="A3.Ex2.m1.1.1.cmml">exp</mi><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1a" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml"><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml"><munderover id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">t</mi><mrow id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.1.3.1.1.1.3" xref="A3.Ex2.m1.2.2.1.1.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex2.m1.2.2.1.2" xref="A3.Ex2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex2.m1.2b"><apply id="A3.Ex2.m1.2.2.1.1.cmml" xref="A3.Ex2.m1.2.2.1"><and id="A3.Ex2.m1.2.2.1.1a.cmml" xref="A3.Ex2.m1.2.2.1"></and><apply id="A3.Ex2.m1.2.2.1.1b.cmml" xref="A3.Ex2.m1.2.2.1"><eq id="A3.Ex2.m1.2.2.1.1.5.cmml" xref="A3.Ex2.m1.2.2.1.1.5"></eq><apply id="A3.Ex2.m1.2.2.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1"><times id="A3.Ex2.m1.2.2.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.2"></times><ci id="A3.Ex2.m1.2.2.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.3">𝐿</ci><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.2">𝑟</ci><apply id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3"><times id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.1"></times><cn id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.3">…</ci><ci id="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="A3.Ex2.m1.2.2.1.1.1.1.1.1.3.4">𝑀</ci></apply></apply></apply><apply id="A3.Ex2.m1.2.2.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2"><apply id="A3.Ex2.m1.2.2.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2">subscript</csymbol><sum id="A3.Ex2.m1.2.2.1.1.2.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.2"></sum><apply id="A3.Ex2.m1.2.2.1.1.2.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3"><eq id="A3.Ex2.m1.2.2.1.1.2.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.2.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.2">𝑖</ci><cn id="A3.Ex2.m1.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.2.3">𝐾</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1"><times id="A3.Ex2.m1.2.2.1.1.2.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.2.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3.2">𝑠</ci><ci id="A3.Ex2.m1.2.2.1.1.2.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.1.4.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.1.4.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.1.4.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4.2">𝐿</ci><ci id="A3.Ex2.m1.2.2.1.1.2.1.4.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.4.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.2">𝑟</ci><apply id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3"><times id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.1"></times><cn id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.2">1</cn><ci id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.3">…</ci><ci id="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4.cmml" xref="A3.Ex2.m1.2.2.1.1.2.1.1.1.1.3.4">𝑀</ci></apply></apply></apply></apply></apply><apply id="A3.Ex2.m1.2.2.1.1c.cmml" xref="A3.Ex2.m1.2.2.1"><eq id="A3.Ex2.m1.2.2.1.1.6.cmml" xref="A3.Ex2.m1.2.2.1.1.6"></eq><share href="#A3.Ex2.m1.2.2.1.1.2.cmml" id="A3.Ex2.m1.2.2.1.1d.cmml" xref="A3.Ex2.m1.2.2.1"></share><apply id="A3.Ex2.m1.2.2.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3"><apply id="A3.Ex2.m1.2.2.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.3.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2">subscript</csymbol><sum id="A3.Ex2.m1.2.2.1.1.3.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.2"></sum><apply id="A3.Ex2.m1.2.2.1.1.3.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3"><eq id="A3.Ex2.m1.2.2.1.1.3.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.3.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.2">𝑖</ci><cn id="A3.Ex2.m1.2.2.1.1.3.2.2.3.3.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.3.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.2.3">𝐾</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1"><times id="A3.Ex2.m1.2.2.1.1.3.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.3.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3.2">𝑠</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1"><csymbol cd="latexml" id="A3.Ex2.m1.2.2.1.1.3.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.2">delimited-[]</csymbol><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1"><plus id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.2"></plus><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.2">𝑐</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1"><times id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.2"></times><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.2">𝑘</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1"><exp id="A3.Ex2.m1.1.1.cmml" xref="A3.Ex2.m1.1.1"></exp><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1"><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3"><eq id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2"><times id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.2">𝑡</ci><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3"><times id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A3.Ex2.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex2.m1.2c">L(r_{1\dots M})=\sum_{i=1}^{K}s_{i}L_{i}(r_{1\dots M})=\sum_{i=1}^{K}s_{i}%
\left[c_{i}+k_{i}\exp{\left(\sum_{j=1}^{M}t_{ij}r_{j}\right)}\right],</annotation><annotation encoding="application/x-llamapun" id="A3.Ex2.m1.2d">italic_L ( italic_r start_POSTSUBSCRIPT 1 … italic_M end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT 1 … italic_M end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p1.6">where <math alttext="r_{1\dots M}" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><msub id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml"><mi id="A3.p1.1.m1.1.1.2" xref="A3.p1.1.m1.1.1.2.cmml">r</mi><mrow id="A3.p1.1.m1.1.1.3" xref="A3.p1.1.m1.1.1.3.cmml"><mn id="A3.p1.1.m1.1.1.3.2" xref="A3.p1.1.m1.1.1.3.2.cmml">1</mn><mo id="A3.p1.1.m1.1.1.3.1" xref="A3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A3.p1.1.m1.1.1.3.3" mathvariant="normal" xref="A3.p1.1.m1.1.1.3.3.cmml">…</mi><mo id="A3.p1.1.m1.1.1.3.1a" xref="A3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A3.p1.1.m1.1.1.3.4" xref="A3.p1.1.m1.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><apply id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p1.1.m1.1.1.1.cmml" xref="A3.p1.1.m1.1.1">subscript</csymbol><ci id="A3.p1.1.m1.1.1.2.cmml" xref="A3.p1.1.m1.1.1.2">𝑟</ci><apply id="A3.p1.1.m1.1.1.3.cmml" xref="A3.p1.1.m1.1.1.3"><times id="A3.p1.1.m1.1.1.3.1.cmml" xref="A3.p1.1.m1.1.1.3.1"></times><cn id="A3.p1.1.m1.1.1.3.2.cmml" type="integer" xref="A3.p1.1.m1.1.1.3.2">1</cn><ci id="A3.p1.1.m1.1.1.3.3.cmml" xref="A3.p1.1.m1.1.1.3.3">…</ci><ci id="A3.p1.1.m1.1.1.3.4.cmml" xref="A3.p1.1.m1.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">r_{1\dots M}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">italic_r start_POSTSUBSCRIPT 1 … italic_M end_POSTSUBSCRIPT</annotation></semantics></math> are mixture proportions on <math alttext="M" class="ltx_Math" display="inline" id="A3.p1.2.m2.1"><semantics id="A3.p1.2.m2.1a"><mi id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><ci id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="A3.p1.2.m2.1d">italic_M</annotation></semantics></math> training domains, <math alttext="L_{i}" class="ltx_Math" display="inline" id="A3.p1.3.m3.1"><semantics id="A3.p1.3.m3.1a"><msub id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml"><mi id="A3.p1.3.m3.1.1.2" xref="A3.p1.3.m3.1.1.2.cmml">L</mi><mi id="A3.p1.3.m3.1.1.3" xref="A3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><apply id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A3.p1.3.m3.1.1.1.cmml" xref="A3.p1.3.m3.1.1">subscript</csymbol><ci id="A3.p1.3.m3.1.1.2.cmml" xref="A3.p1.3.m3.1.1.2">𝐿</ci><ci id="A3.p1.3.m3.1.1.3.cmml" xref="A3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">L_{i}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.3.m3.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are validation loss on <math alttext="K" class="ltx_Math" display="inline" id="A3.p1.4.m4.1"><semantics id="A3.p1.4.m4.1a"><mi id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.1b"><ci id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="A3.p1.4.m4.1d">italic_K</annotation></semantics></math> implicit domains with <math alttext="s_{i}" class="ltx_Math" display="inline" id="A3.p1.5.m5.1"><semantics id="A3.p1.5.m5.1a"><msub id="A3.p1.5.m5.1.1" xref="A3.p1.5.m5.1.1.cmml"><mi id="A3.p1.5.m5.1.1.2" xref="A3.p1.5.m5.1.1.2.cmml">s</mi><mi id="A3.p1.5.m5.1.1.3" xref="A3.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.5.m5.1b"><apply id="A3.p1.5.m5.1.1.cmml" xref="A3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A3.p1.5.m5.1.1.1.cmml" xref="A3.p1.5.m5.1.1">subscript</csymbol><ci id="A3.p1.5.m5.1.1.2.cmml" xref="A3.p1.5.m5.1.1.2">𝑠</ci><ci id="A3.p1.5.m5.1.1.3.cmml" xref="A3.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m5.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.5.m5.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as their weight in the overall validation set, and <math alttext="c_{i},t_{ij}" class="ltx_Math" display="inline" id="A3.p1.6.m6.2"><semantics id="A3.p1.6.m6.2a"><mrow id="A3.p1.6.m6.2.2.2" xref="A3.p1.6.m6.2.2.3.cmml"><msub id="A3.p1.6.m6.1.1.1.1" xref="A3.p1.6.m6.1.1.1.1.cmml"><mi id="A3.p1.6.m6.1.1.1.1.2" xref="A3.p1.6.m6.1.1.1.1.2.cmml">c</mi><mi id="A3.p1.6.m6.1.1.1.1.3" xref="A3.p1.6.m6.1.1.1.1.3.cmml">i</mi></msub><mo id="A3.p1.6.m6.2.2.2.3" xref="A3.p1.6.m6.2.2.3.cmml">,</mo><msub id="A3.p1.6.m6.2.2.2.2" xref="A3.p1.6.m6.2.2.2.2.cmml"><mi id="A3.p1.6.m6.2.2.2.2.2" xref="A3.p1.6.m6.2.2.2.2.2.cmml">t</mi><mrow id="A3.p1.6.m6.2.2.2.2.3" xref="A3.p1.6.m6.2.2.2.2.3.cmml"><mi id="A3.p1.6.m6.2.2.2.2.3.2" xref="A3.p1.6.m6.2.2.2.2.3.2.cmml">i</mi><mo id="A3.p1.6.m6.2.2.2.2.3.1" xref="A3.p1.6.m6.2.2.2.2.3.1.cmml">⁢</mo><mi id="A3.p1.6.m6.2.2.2.2.3.3" xref="A3.p1.6.m6.2.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.6.m6.2b"><list id="A3.p1.6.m6.2.2.3.cmml" xref="A3.p1.6.m6.2.2.2"><apply id="A3.p1.6.m6.1.1.1.1.cmml" xref="A3.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="A3.p1.6.m6.1.1.1.1.1.cmml" xref="A3.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="A3.p1.6.m6.1.1.1.1.2.cmml" xref="A3.p1.6.m6.1.1.1.1.2">𝑐</ci><ci id="A3.p1.6.m6.1.1.1.1.3.cmml" xref="A3.p1.6.m6.1.1.1.1.3">𝑖</ci></apply><apply id="A3.p1.6.m6.2.2.2.2.cmml" xref="A3.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="A3.p1.6.m6.2.2.2.2.1.cmml" xref="A3.p1.6.m6.2.2.2.2">subscript</csymbol><ci id="A3.p1.6.m6.2.2.2.2.2.cmml" xref="A3.p1.6.m6.2.2.2.2.2">𝑡</ci><apply id="A3.p1.6.m6.2.2.2.2.3.cmml" xref="A3.p1.6.m6.2.2.2.2.3"><times id="A3.p1.6.m6.2.2.2.2.3.1.cmml" xref="A3.p1.6.m6.2.2.2.2.3.1"></times><ci id="A3.p1.6.m6.2.2.2.2.3.2.cmml" xref="A3.p1.6.m6.2.2.2.2.3.2">𝑖</ci><ci id="A3.p1.6.m6.2.2.2.2.3.3.cmml" xref="A3.p1.6.m6.2.2.2.2.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m6.2c">c_{i},t_{ij}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.6.m6.2d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are other parameters to fit.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="A3.F10"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="271" id="A3.F10.g1" src="extracted/5490388/figs/computation_graph.png" width="598">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>The computation graph of mixture law with implicit domain aggregation. We take an case of 3 training domains and 4 implicit validation domains as example.
The parameters correspond to the notations in Eqn.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#S3.E8" title="8 ‣ Explicit domain aggregation. ‣ 3.3 Predicting Losses of Any Validation Mixture ‣ 3 The proportions of data mixtures influence model losses in a quantitatively predictable way ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">8</span></a>.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.1">The mixture law boils down to a computation graph in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#A3.F10" title="Figure 10 ‣ Appendix C Connections between Implicit Domain Aggregation and MLP ‣ Data Mixing Laws: Optimizing Data Mixtures by Predicting Language Modeling Performance"><span class="ltx_text ltx_ref_tag">10</span></a>, which contains two layers.
The first layers predict the domain losses, while the second sums up the domain losses to obtain the overall validation loss.
In this way, the mixture law becomes a multilayer perception (MLP) with an exponential activation function.
In practice, we fit the mixture laws with implicit domain aggregation by fitting a multilayer perception with exponential activation and applying softmax to the output layer weights.
Additionally, considering the high variance of MLP, we further employ AdaBoost Regressor&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Drucker, <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib16" title="">1997</a>)</cite> for fitting the mixture laws to stabilize the predictions and improve their accuracy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.p3">
<p class="ltx_p" id="A3.p3.1">Inspired by this perspective, we attribute the successful fitting of mixture law to two aspects.
First, the MLP with a sufficiently large hidden dimension is a universal approximator&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hornik et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2403.16952v1#bib.bib34" title="">1989</a>)</cite> thus being able to fit the relationships between losses and mixture proportions.
Second, the mixture proportions are bounded between 0 and 1.
For this reason, predicting an unseen mixture is an interpolation problem, which is usually easier than extrapolation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</article>
</div>

</div>


<div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated on Wed Dec 14 18:01:44 2022 by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer><button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button></body></html>